<html>
<head>
<title>Write better and more readable Golang code by grouping similar declarations</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过对相似的声明进行分组，编写更好、可读性更强的 Golang 代码</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/write-better-golang-code-by-grouping-similar-declarations-2dc6145f9277?source=collection_archive---------1-----------------------#2021-09-08">https://blog.devgenius.io/write-better-golang-code-by-grouping-similar-declarations-2dc6145f9277?source=collection_archive---------1-----------------------#2021-09-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/262e9c209672abec3b57e9d5fb8d4ab7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S-vgKTGUnfwHeQ2TJqNyWg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">迈克尔·魏德曼在<a class="ae kc" href="https://unsplash.com/photos/oGhTfu1UrOY" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的原始照片；Golang 的 Gopher。</figcaption></figure><p id="2f9c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将学习一个简单的技巧来编写更好的 go 代码。</p><p id="5b3f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当编写 Go 代码时，您希望确保您的方法是一致的，同时也鼓励可读性。这是一个平衡的行为，所以确保你和你的团队成员，如果适用的话，遵守某些风格指南是很重要的。</p><p id="f289" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对 Go 代码的一个简单改进是将常量、变量甚至类型常量的声明组合在一起。我的意思是 Go 支持以下内容:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="4e9d" class="lk ll iq lg b gy lm ln l lo lp">var (<br/>   a = 5<br/>   b = 10<br/>)</span></pre><p id="b5fc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这个代码块中，我们声明了两个变量，<code class="fe lq lr ls lg b">a</code>和<code class="fe lq lr ls lg b">b</code>。这里的改进是我们将它们组合在一个声明中。您也可以用其他语言的声明看起来更熟悉的常用方式来声明它们:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="3f57" class="lk ll iq lg b gy lm ln l lo lp">var a = 5<br/>var b = 10</span></pre><p id="5a43" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从技术上来说，组合在一起并不能节省代码行(尽管它确实删除了关键字<code class="fe lq lr ls lg b">var</code>的一个声明)，所以你可能会想为什么这样更好。真正的改进来自于您添加的推论，即该语法允许您将相关或相似的变量逻辑地分组在一起。想象一下，我们有两个变量叫做<code class="fe lq lr ls lg b">revenue</code>和<code class="fe lq lr ls lg b">expenses</code>，而不是<code class="fe lq lr ls lg b">a</code>和<code class="fe lq lr ls lg b">b</code>。它们很相似，所以我们可以把它们归为一类:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="4ea2" class="lk ll iq lg b gy lm ln l lo lp">var (<br/>   revenue = 1000000<br/>   expenses = 50000000<br/>)</span></pre><p id="b203" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">撇开该业务的粗略数字不谈，变量的逻辑分组可以在代码中的其他变量声明中脱颖而出，如下例所示:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="bf0f" class="lk ll iq lg b gy lm ln l lo lp">var (<br/>   revenue = 1000000<br/>   expenses = 50000000  <br/>)</span><span id="a928" class="lk ll iq lg b gy lt ln l lo lp">var colorBuilding = red<br/>var ownerName = "Mr. Anderson"</span></pre><p id="3b3e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如你所看到的，分组更清楚地表明那些变量与财务有关，而其余的与财务无关。这个例子有点傻，但希望它能说明问题。</p><p id="8bf7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请注意，您可以将这种分组语法应用于<code class="fe lq lr ls lg b">const</code>值:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="de35" class="lk ll iq lg b gy lm ln l lo lp">const (<br/>   red = "#FF0000"<br/>   green = "#008000"<br/>)</span></pre><p id="dbd9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您经常会在 Go 文件顶部的导入分组中看到这种结构。与前面的不同，这种分组并不是由一般的导入来安排的，但是语法至少是相同的，供您参考。让我们看看 Kelsey Hightower 的<a class="ae kc" href="https://github.com/kelseyhightower/envconfig" rel="noopener ugc nofollow" target="_blank"> envconfig </a> Go 存储库中的<code class="fe lq lr ls lg b"><a class="ae kc" href="https://raw.githubusercontent.com/kelseyhightower/envconfig/master/usage.go" rel="noopener ugc nofollow" target="_blank">usage.go</a></code>中的真实例子:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="b873" class="lk ll iq lg b gy lm ln l lo lp">import (<br/>	"encoding"<br/>	"fmt"<br/>	"io"<br/>	"os"<br/>	"reflect"<br/>	"strconv"<br/>	"strings"<br/>	"text/tabwriter"<br/>	"text/template"<br/>)</span></pre><p id="97c7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">说，当我们在做的时候，我们有一些在这篇文章中给出的建议的好例子！凯尔西<em class="lu"/>知道他在做什么吗，所以我很乐意把它作为你可以模仿的东西来分享:</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="8391" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我也非常推荐阅读有效围棋；<a class="ae kc" href="https://golang.org/doc/effective_go#commentary" rel="noopener ugc nofollow" target="_blank">以下是他们对分组话题的看法</a>:</p><blockquote class="lx ly lz"><p id="60c2" class="kd ke lu kf b kg kh ki kj kk kl km kn ma kp kq kr mb kt ku kv mc kx ky kz la ij bi translated">Go 的声明语法允许对声明进行分组。单个文档注释可以引入一组相关的常量或变量。由于整个申报都已提交，这样的评论往往是敷衍了事。</p><p id="751c" class="kd ke lu kf b kg kh ki kj kk kl km kn ma kp kq kr mb kt ku kv mc kx ky kz la ij bi translated">//解析表达式失败时返回的错误代码。<br/> var ( <br/> ErrInternal =错误。New("regexp:内部错误")<br/> ErrUnmatchedLpar = errors。new(" regexp:unmatched '(')"<br/>ErrUnmatchedRpar = errors。new(" regexp:unmatched ")' "<br/>...<br/>)</p><p id="ebb2" class="kd ke lu kf b kg kh ki kj kk kl km kn ma kp kq kr mb kt ku kv mc kx ky kz la ij bi translated">分组还可以表示项目之间的关系，例如一组变量受互斥体保护的事实。</p><p id="f9d9" class="kd ke lu kf b kg kh ki kj kk kl km kn ma kp kq kr mb kt ku kv mc kx ky kz la ij bi translated">var ( <br/> countLock 同步。互斥体<br/>输入计数 uint32 <br/>输出计数 uint32 <br/>错误计数 uint32 <br/></p></blockquote><p id="416f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">关于能够注释一个声明块的说明确实是一个非常强大的功能，您应该利用它来使您的代码更加可读和可理解。</p><p id="6aa9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在你有了:一个简单的风格技巧，你可以用它来使你的代码更易读，并且随着时间的推移可能更易维护。再说一次，如果你有一个团队，最好在这一点上达成一致，否则随着时间的推移，你会发现拉请求有些脱节。</p><div class="md me gp gr mf mg"><a href="https://tremaineeto.medium.com/membership" rel="noopener follow" target="_blank"><div class="mh ab fo"><div class="mi ab mj cl cj mk"><h2 class="bd ir gy z fp ml fr fs mm fu fw ip bi translated">通过我的推荐链接加入媒体</h2><div class="mn l"><h3 class="bd b gy z fp ml fr fs mm fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="mo l"><p class="bd b dl z fp ml fr fs mm fu fw dk translated">tremaineeto.medium.com</p></div></div><div class="mp l"><div class="mq l mr ms mt mp mu jw mg"/></div></div></a></div></div></div>    
</body>
</html>