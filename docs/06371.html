<html>
<head>
<title>How is security managed in Kubernetes clusters?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Kubernetes集群中的安全性是如何管理的？</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-is-security-managed-in-kubernetes-clusters-addefffd2b0?source=collection_archive---------12-----------------------#2022-01-03">https://blog.devgenius.io/how-is-security-managed-in-kubernetes-clusters-addefffd2b0?source=collection_archive---------12-----------------------#2022-01-03</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="efe0" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">在Kubernetes中不同层次管理安全性的最佳实践</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/c61cc92e90ff55885c5e10726b3c1716.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*juK6gRhIva1ZfiNzCMug5Q.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">在<a class="ae ks" href="https://unsplash.com/s/photos/cyber-security?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae ks" href="https://unsplash.com/@towfiqu999999?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Towfiqu barb huya</a>拍摄的照片</figcaption></figure><p id="0c55" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在Log4j漏洞影响生产站点上运行的数千个java应用程序的新闻铺天盖地之后的几个星期里，安全性吸引了所有软件开发人员、架构师和产品所有者的注意。这个log4shell漏洞被证明是全球大多数CVSS分数为10的工程师的噩梦，因为它允许进行RCE。关于这个漏洞的更多细节可以在这个<a class="ae ks" href="https://www.youtube.com/watch?v=uyq8yxWO1ls" rel="noopener ugc nofollow" target="_blank">视频</a>中看到。</p><p id="97c0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">安全性是组织中任何产品或应用程序的一个非常重要的方面。当在云中部署应用程序时，安全性变得更加重要，因为它是应用程序开发人员和云提供商之间的共同责任。云安全实际上是不同级别(即应用程序、集群和主机操作系统)的安全控制的组合。显然，它是一组控件和最佳实践，而不仅仅是一个单独的设置或复选框。</p><p id="966c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">主要是在应用安全性方面，据说集群级别和底层主机操作系统级别的安全性应该由托管云提供商负责，例如GCP、AWS或Azure。</p><p id="bb42" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">下面是一些可用于保护所有3层安全性的最佳实践，首先是应用程序级，然后是集群级，最后是主机级操作系统。</p><h1 id="e713" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">应用层安全性</h1><p id="fe16" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">安全性的最高层是在应用程序级别，由应用程序开发人员来考虑。容器化提供了将应用程序数据和资源相互隔离的能力，但是对于安全隔离来说，这还不够。作为应用程序开发人员或系统工程师，我们需要确保我们的容器化应用程序只能访问它需要的内容，仅此而已。</p><p id="490d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">应用程序级别的一些最佳安全实践如下</p><ul class=""><li id="1d68" class="mm mn in kv b kw kx kz la lc mo lg mp lk mq lo mr ms mt mu bi translated"><strong class="kv io"> <em class="mv">使用秘密</em> </strong> —所有与应用程序相关的敏感数据都应该存储在一个<a class="ae ks" href="https://kubernetes.io/docs/concepts/configuration/secret/" rel="noopener ugc nofollow" target="_blank"> Kubernetes秘密</a>中，如密码、任何密钥或连接到API的令牌。这样，应用程序代码中就不会暴露任何敏感数据，并且可以安全地将其推送到版本控制存储库中。</li><li id="36df" class="mm mn in kv b kw mw kz mx lc my lg mz lk na lo mr ms mt mu bi translated"><strong class="kv io"><em class="mv"/></strong>—基于角色的访问控制(Role-based access control，RBAC)是一种在roles、clusterrole、rolebindings、clusterrolebindings的帮助下，基于k8s集群内各个用户的角色来管理对资源的访问的方法。</li><li id="57ae" class="mm mn in kv b kw mw kz mx lc my lg mz lk na lo mr ms mt mu bi translated"><strong class="kv io"> <em class="mv">集群强化</em> </strong> —保护k8s集群内部署的应用程序的最佳方式之一是通过在pod定义的部署YAML文件中指定<strong class="kv io"> <em class="mv">运行为用户</em> </strong>来限制用户访问。</li><li id="66d1" class="mm mn in kv b kw mw kz mx lc my lg mz lk na lo mr ms mt mu bi translated"><strong class="kv io"> <em class="mv">漏洞扫描</em> </strong> —应该对应用程序中使用的库进行定期检查，并且应该在应用程序中定期修补任何CVE状态为“高”或“严重”的库。<a class="ae ks" href="https://twitter.com/vdoosecurity?lang=en" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> Vdoo </strong> </a>是捕捉软件内部此类安全风险的绝佳工具。</li></ul></div><div class="ab cl nb nc hr nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="ig ih ii ij ik"><h1 id="056a" class="lp lq in bd lr ls ni lu lv lw nj ly lz jt nk ju mb jw nl jx md jz nm ka mf mg bi translated">集群级安全性</h1><p id="cea6" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">这是安装Kubernetes的主机操作系统的顶层，是k8s集群的所有组件相互交互的中心位置。</p><p id="0ed4" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">集群级别的一些最佳安全实践如下</p><ul class=""><li id="6c2f" class="mm mn in kv b kw kx kz la lc mo lg mp lk mq lo mr ms mt mu bi translated"><strong class="kv io"> <em class="mv">在网络层限制对etcd和apiserver的访问</em> </strong> <em class="mv"> — </em>在工作节点上运行的pod不应与etcd建立直接网络，而应置于安全网络中。除此之外，到etcd的流量应该加密。etcd是集群的重要组成部分，因为它是k8s集群的CPU，存储着集群中正在运行的pod的所有秘密和完整状态，因此它必须始终受到保护。</li><li id="7dc0" class="mm mn in kv b kw mw kz mx lc my lg mz lk na lo mr ms mt mu bi translated"><strong class="kv io"> <em class="mv">授权和认证</em> </strong> —在防火墙后面设置etcd，使用认证到达API服务器，可以将集群从攻击者手中解救出来，使其更加安全。</li><li id="127b" class="mm mn in kv b kw mw kz mx lc my lg mz lk na lo mr ms mt mu bi translated"><strong class="kv io"> <em class="mv">准入控制器</em> </strong> —这可以以两种方式实现，一种是使用节点限制，例如限制对具有API服务器的节点的访问，第二种是通过编写定制的<a class="ae ks" href="https://kubernetes.io/docs/concepts/services-networking/network-policies/" rel="noopener ugc nofollow" target="_blank">网络策略</a>来限制pod和k8s集群内的其他网络实体之间的通信。</li></ul></div><div class="ab cl nb nc hr nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="ig ih ii ij ik"><h1 id="991d" class="lp lq in bd lr ls ni lu lv lw nj ly lz jt nk ju mb jw nl jx md jz nm ka mf mg bi translated">主机级安全性</h1><p id="29c9" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">这是安装Kubernetes的级别，并且只能用于这一个目的，即提供Kubernetes。通常，主机操作系统可以是RHEL 7.x，Ubuntu 20.x</p><p id="89bb" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">主机级操作系统的一些最佳安全实践如下</p><ul class=""><li id="0661" class="mm mn in kv b kw kx kz la lc mo lg mp lk mq lo mr ms mt mu bi translated"><strong class="kv io"> <em class="mv">最低权限访问</em> </strong> <em class="mv"> </em> —主机级操作系统不应暴露于ssh，以便通过应用程序箱远程执行任何命令。</li><li id="7991" class="mm mn in kv b kw mw kz mx lc my lg mz lk na lo mr ms mt mu bi translated"><strong class="kv io"> <em class="mv">设置IAM策略— </em> </strong> <em class="mv">可以创建IAM角色并将其绑定到Kubernetes服务帐户，然后可以限制该帐户访问某些k8s资源。</em></li><li id="d8f8" class="mm mn in kv b kw mw kz mx lc my lg mz lk na lo mr ms mt mu bi translated"><strong class="kv io">除此之外，始终建议使用Kubernetes的最新版本。</strong></li></ul><h1 id="031b" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">结论:</h1><p id="34a0" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">只要我们坚持上述一些安全实践，并在讨论和开发特定产品或应用程序的软件工具和技术时，在架构设计和讨论的一开始就在应用程序的安全方面投入一些时间，我们就可以确保我们开发和交付的安全产品和应用程序是最好的，在整个生态系统中没有任何最薄弱的环节。</p></div></div>    
</body>
</html>