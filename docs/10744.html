<html>
<head>
<title>TypeScript Integration with NodeJS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TypeScript 与 NodeJS 的集成</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/typescript-integration-with-nodejs-a2c49247e21f?source=collection_archive---------10-----------------------#2022-11-26">https://blog.devgenius.io/typescript-integration-with-nodejs-a2c49247e21f?source=collection_archive---------10-----------------------#2022-11-26</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/e044799eb731e0d594f859dcc039f3a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tJHrR3EEhXqnLe3y.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">Pic 信用开发至</figcaption></figure><h2 id="d5e1" class="jz ka in bd kb kc kd dn ke kf kg dp kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">什么是 TypeScript？</h2><p id="6ff6" class="pw-post-body-paragraph kv kw in kx b ky kz la lb lc ld le lf ki lg lh li km lj lk ll kq lm ln lo lp ig bi translated">如您所知，JavaScript 不是一种强类型语言。因此，TypeScript 过去常常在 JavaScript 之上添加静态类型。TypeScript 是 JavaScript 的语法超集，增加了静态类型。</p><p id="45fa" class="pw-post-body-paragraph kv kw in kx b ky lq la lb lc lr le lf ki ls lh li km lt lk ll kq lu ln lo lp ig bi translated">这基本上意味着 TypeScript 在 JavaScript 之上添加了语法，允许开发人员添加<strong class="kx io">类型</strong>。</p><p id="311f" class="pw-post-body-paragraph kv kw in kx b ky lq la lb lc lr le lf ki ls lh li km lt lk ll kq lu ln lo lp ig bi translated"><strong class="kx io">为什么要使用 TypeScript？</strong></p><p id="3ed5" class="pw-post-body-paragraph kv kw in kx b ky lq la lb lc lr le lf ki ls lh li km lt lk ll kq lu ln lo lp ig bi translated">JavaScript 是一种松散类型的语言。很难理解 JavaScript 中传递的是什么类型的数据。</p><p id="5f2c" class="pw-post-body-paragraph kv kw in kx b ky lq la lb lc lr le lf ki ls lh li km lt lk ll kq lu ln lo lp ig bi translated">在 JavaScript 中，函数参数和变量没有任何信息。所以开发者需要看文档，或者根据实现来猜测。</p><p id="9c0a" class="pw-post-body-paragraph kv kw in kx b ky lq la lb lc lr le lf ki ls lh li km lt lk ll kq lu ln lo lp ig bi translated">TypeScript 允许指定在代码中传递的数据类型，并且能够在类型不匹配时报告错误。</p><h2 id="39b0" class="jz ka in bd kb kc kd dn ke kf kg dp kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">TypeScript 项目设置</h2><p id="3c90" class="pw-post-body-paragraph kv kw in kx b ky kz la lb lc ld le lf ki lg lh li km lj lk ll kq lm ln lo lp ig bi translated">首先用以下命令初始化 NodeJS 项目</p><pre class="lv lw lx ly gt lz ma mb bn mc md bi"><span id="8e45" class="me ka in ma b be mf mg l mh mi">npm init -y</span></pre><p id="2b7f" class="pw-post-body-paragraph kv kw in kx b ky lq la lb lc lr le lf ki ls lh li km lt lk ll kq lu ln lo lp ig bi translated">现在将 typescript 安装为开发依赖项</p><pre class="lv lw lx ly gt lz ma mb bn mc md bi"><span id="1921" class="me ka in ma b be mf mg l mh mi">npm install typescript --save-dev</span></pre><p id="f889" class="pw-post-body-paragraph kv kw in kx b ky lq la lb lc lr le lf ki ls lh li km lt lk ll kq lu ln lo lp ig bi translated">您可以通过键入以下命令来验证是否安装了 typescript。通过运行以下命令，您将在系统中安装 typescript 版本。</p><pre class="lv lw lx ly gt lz ma mb bn mc md bi"><span id="9c19" class="me ka in ma b be mf mg l mh mi">npx tsc --version</span></pre><p id="a0fc" class="pw-post-body-paragraph kv kw in kx b ky lq la lb lc lr le lf ki ls lh li km lt lk ll kq lu ln lo lp ig bi translated">现在，您必须通过键入以下命令来启动 typescript 项目</p><pre class="lv lw lx ly gt lz ma mb bn mc md bi"><span id="215f" class="me ka in ma b be mf mg l mh mi">npx tsc --init</span></pre><p id="cd35" class="pw-post-body-paragraph kv kw in kx b ky lq la lb lc lr le lf ki ls lh li km lt lk ll kq lu ln lo lp ig bi translated">上述命令将生成<code class="fe mj mk ml ma b">tsconfig.json</code>文件，该文件将指定编译项目所需的根文件和编译器选项。你可以在这里了解这个文件<a class="ae mm" href="https://www.typescriptlang.org/docs/handbook/tsconfig-json.html" rel="noopener ugc nofollow" target="_blank">的更多信息。</a></p><h2 id="ed94" class="jz ka in bd kb kc kd dn ke kf kg dp kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">安装所需的 Npm 依赖项</h2><p id="b2a7" class="pw-post-body-paragraph kv kw in kx b ky kz la lb lc ld le lf ki lg lh li km lj lk ll kq lm ln lo lp ig bi translated">因为我们要使用 express 来开发 rest API，所以让我们先安装 express。</p><pre class="lv lw lx ly gt lz ma mb bn mc md bi"><span id="f665" class="me ka in ma b be mf mg l mh mi">npm install --save express<br/>npm install --save-dev @types/express</span></pre><p id="8255" class="pw-post-body-paragraph kv kw in kx b ky lq la lb lc lr le lf ki ls lh li km lt lk ll kq lu ln lo lp ig bi translated">在这里，我还安装了 express for typescript，这是在 typescript 应用程序中使用所必需的。如果您不安装@types/express，那么在应用程序中导入 express 时，您将会得到 package not found 错误。</p><p id="81c7" class="pw-post-body-paragraph kv kw in kx b ky lq la lb lc lr le lf ki ls lh li km lt lk ll kq lu ln lo lp ig bi translated">现在安装<code class="fe mj mk ml ma b">ts-node-dev</code>,它用于观察应用程序中的变化，并在我们做出任何改变时自动重启。这与<code class="fe mj mk ml ma b">nodemon</code>的工作原理相同。你可以在这里了解这个包<a class="ae mm" href="https://www.npmjs.com/package/ts-node-dev" rel="noopener ugc nofollow" target="_blank">的更多信息。</a></p><p id="55f0" class="pw-post-body-paragraph kv kw in kx b ky lq la lb lc lr le lf ki ls lh li km lt lk ll kq lu ln lo lp ig bi translated">完成以上安装后，你的<code class="fe mj mk ml ma b">project.json</code>看起来会像这样</p><pre class="lv lw lx ly gt lz ma mb bn mc md bi"><span id="9f56" class="me ka in ma b be mf mg l mh mi">{<br/>  "name": "tsc_tuts",<br/>  "version": "1.0.0",<br/>  "description": "",<br/>  "main": "index.js",<br/>  "scripts": {<br/>    "start": "ts-node-dev --respawn --transpile-only app.ts"<br/>  },<br/>  "keywords": [],<br/>  "author": "",<br/>  "license": "ISC",<br/>  "devDependencies": {<br/>    "ts-node-dev": "^2.0.0",<br/>    "typescript": "^4.9.3"<br/>  },<br/>  "dependencies": {<br/>    "@types/express": "^4.17.14",<br/>    "express": "^4.18.2"<br/>  }<br/>}</span></pre><p id="5823" class="pw-post-body-paragraph kv kw in kx b ky lq la lb lc lr le lf ki ls lh li km lt lk ll kq lu ln lo lp ig bi translated">请注意这里的开始命令，我在<code class="fe mj mk ml ma b">node-dev</code>文档中添加了建议的命令。你可以参考我上面提到的链接。</p><p id="a61e" class="pw-post-body-paragraph kv kw in kx b ky lq la lb lc lr le lf ki ls lh li km lt lk ll kq lu ln lo lp ig bi translated">用以下代码更新<code class="fe mj mk ml ma b">app.js</code>文件</p><pre class="lv lw lx ly gt lz ma mb bn mc md bi"><span id="15d1" class="me ka in ma b be mf mg l mh mi">import express from 'express';<br/>const app = express();<br/>const PORT = 3000;<br/><br/>app.get("/", (req, res) =&gt; {<br/>    res.send({message: "Hello World!"});<br/>});<br/><br/>app.listen(PORT, () =&gt; {<br/>    console.log(`Server is listening to port: ${PORT}`);<br/>})</span></pre><p id="c582" class="pw-post-body-paragraph kv kw in kx b ky lq la lb lc lr le lf ki ls lh li km lt lk ll kq lu ln lo lp ig bi translated">这里，我们的应用程序运行在 3000 端口上。尝试用<code class="fe mj mk ml ma b">npm start</code>命令运行项目。现在可以打开<a class="ae mm" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank">http://localhost:3000</a>/。您将获得以下输出</p><figure class="lv lw lx ly gt jo gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/517d17e19eb15dce8e7ac041c7f74d02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*21omLtlMCLni4xsVA6d9ZQ.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">产出 1</figcaption></figure><h2 id="dda7" class="jz ka in bd kb kc kd dn ke kf kg dp kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">用 MVCS 架构构建一个简单的任务 API</h2><p id="5b69" class="pw-post-body-paragraph kv kw in kx b ky kz la lb lc ld le lf ki lg lh li km lj lk ll kq lm ln lo lp ig bi translated">现在为 Api 创建三个文件夹<code class="fe mj mk ml ma b">controllers</code>、<code class="fe mj mk ml ma b">routes</code>和<code class="fe mj mk ml ma b">services</code>。现在你的文件夹结构看起来像这样。</p><figure class="lv lw lx ly gt jo gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/71a05e7f1b3d4bce99dff668d9943aea.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*qpY9vpdVYYPP_WTc1qG31Q.png"/></div></figure><p id="0d16" class="pw-post-body-paragraph kv kw in kx b ky lq la lb lc lr le lf ki ls lh li km lt lk ll kq lu ln lo lp ig bi translated">现在在<code class="fe mj mk ml ma b">routes </code>文件夹中添加<code class="fe mj mk ml ma b">task.route.ts</code>。</p><pre class="lv lw lx ly gt lz ma mb bn mc md bi"><span id="612d" class="me ka in ma b be mf mg l mh mi">// task.route.ts<br/>import express from "express";<br/>import { TaskController } from "../controllers";<br/><br/>const router = express.Router();<br/><br/>router.route('/task').post(TaskController.createTask);<br/><br/><br/>export default router;</span></pre><p id="98d5" class="pw-post-body-paragraph kv kw in kx b ky lq la lb lc lr le lf ki ls lh li km lt lk ll kq lu ln lo lp ig bi translated">如果你能注意到我已经从控制器文件夹中导入了任务控制器。所以我们也必须创建控制器。所以现在让我们创建<code class="fe mj mk ml ma b">task.controller.ts</code>和<code class="fe mj mk ml ma b">index.ts</code></p><pre class="lv lw lx ly gt lz ma mb bn mc md bi"><span id="0332" class="me ka in ma b be mf mg l mh mi">// task.controller.ts<br/>import { Express, Request, Response, NextFunction } from "express"<br/>import { TaskService } from "../services";<br/><br/>const createTask = async (req: Request, res: Response, next: NextFunction) =&gt; {<br/>    const task = TaskService.createTask();<br/>    res.json({ status: 'success', task });<br/>};<br/><br/>export default { createTask };</span></pre><p id="4d6d" class="pw-post-body-paragraph kv kw in kx b ky lq la lb lc lr le lf ki ls lh li km lt lk ll kq lu ln lo lp ig bi translated">在<strong class="kx io">异步函数</strong>中，我们像往常一样传递了三个参数，但这里有一点需要注意。我已经添加了参数类型。对于<code class="fe mj mk ml ma b">req</code>我添加了类型<strong class="kx io">请求</strong>，对于<code class="fe mj mk ml ma b">res</code>添加了类型<strong class="kx io">响应</strong>，对于<code class="fe mj mk ml ma b">next</code>函数添加了类型<strong class="kx io">下一个函数</strong>。这是 typescript 定义变量或对象类型的主要用例。</p><p id="6a67" class="pw-post-body-paragraph kv kw in kx b ky lq la lb lc lr le lf ki ls lh li km lt lk ll kq lu ln lo lp ig bi translated">在 typescript 中，类型有两种定义方式</p><ol class=""><li id="53b9" class="mp mq in kx b ky lq lc lr ki mr km ms kq mt lp mu mv mw mx bi translated">使用<code class="fe mj mk ml ma b"><strong class="kx io">type</strong></code></li></ol><pre class="lv lw lx ly gt lz ma mb bn mc md bi"><span id="eb84" class="me ka in ma b be mf mg l mh mi">// type declaration<br/>type Person = {<br/>    name: string,<br/>    age: number<br/>}<br/><br/>// example 1<br/>const person1: Person = {name: 'ajay', age: 25};<br/><br/>// example 2<br/>const person2: Person = {name: 'ajay', age: "25"}; // will show following error<br/>// Error Type 'string' is not assignable to type 'number'.ts(2322)</span></pre><p id="4724" class="pw-post-body-paragraph kv kw in kx b ky lq la lb lc lr le lf ki ls lh li km lt lk ll kq lu ln lo lp ig bi translated">2.使用<code class="fe mj mk ml ma b"><strong class="kx io">interface</strong></code></p><pre class="lv lw lx ly gt lz ma mb bn mc md bi"><span id="7d5d" class="me ka in ma b be mf mg l mh mi">interface Person {<br/>    name: string,<br/>    age: number<br/>}<br/><br/>// example 1<br/>const person1: Person = {name: 'ajay', age: 25};<br/><br/>// example 2<br/>const person2: Person = {name: 'ajay', age: "25"}; // will show following error<br/>// Error Type 'string' is not assignable to type 'number'.ts(2322)</span></pre><p id="30f2" class="pw-post-body-paragraph kv kw in kx b ky lq la lb lc lr le lf ki ls lh li km lt lk ll kq lu ln lo lp ig bi translated">这里我们已经看到了如何给对象分配类型。你也可以用同样的方式给变量赋值。但是有一点你必须记住，你不能分配使用<strong class="kx io">接口</strong>创建的类型，你只能分配使用<strong class="kx io"> type </strong>关键字创建的类型。这就是类型和接口的不同。</p><p id="8e9e" class="pw-post-body-paragraph kv kw in kx b ky lq la lb lc lr le lf ki ls lh li km lt lk ll kq lu ln lo lp ig bi translated">现在让我们为控制器创建<code class="fe mj mk ml ma b">index.ts</code>,以直接从<code class="fe mj mk ml ma b">controllers</code>文件夹中访问它</p><pre class="lv lw lx ly gt lz ma mb bn mc md bi"><span id="52fe" class="me ka in ma b be mf mg l mh mi">// index.ts<br/>export {default as TaskController} from './task.controller';</span></pre><p id="923a" class="pw-post-body-paragraph kv kw in kx b ky lq la lb lc lr le lf ki ls lh li km lt lk ll kq lu ln lo lp ig bi translated">如果您在 task.controller.ts 文件中注意到我们正在使用 TaskService。所以现在让我们创建<code class="fe mj mk ml ma b">task.service.ts</code>和<code class="fe mj mk ml ma b">index.ts</code></p><pre class="lv lw lx ly gt lz ma mb bn mc md bi"><span id="9a6a" class="me ka in ma b be mf mg l mh mi">// task.service.ts<br/>const createTask = () =&gt; {<br/>    // write your logic here. You can write all DB related operations here and any third party connections also<br/>    return { name: 'New Task' };<br/>}<br/><br/>export default { createTask };</span></pre><pre class="my lz ma mb bn mc md bi"><span id="17a4" class="me ka in ma b be mf mg l mh mi">// index.ts<br/>export {default as TaskService} from './task.service';</span></pre><p id="0a7a" class="pw-post-body-paragraph kv kw in kx b ky lq la lb lc lr le lf ki ls lh li km lt lk ll kq lu ln lo lp ig bi translated">现在将<code class="fe mj mk ml ma b">task </code> route 添加到<code class="fe mj mk ml ma b">app.ts</code>中，并将<code class="fe mj mk ml ma b">/api/v1</code>添加到我们已经创建的 api 中。所以现在我们更新的<code class="fe mj mk ml ma b">app.ts</code>文件看起来会像这样。</p><pre class="lv lw lx ly gt lz ma mb bn mc md bi"><span id="3109" class="me ka in ma b be mf mg l mh mi">import express from 'express';<br/>// added this line<br/>import taskRoute from "./routes/task.route";<br/><br/>const app = express();<br/>const PORT = 3000;<br/><br/>app.get("/", (req, res) =&gt; {<br/>    res.send({ message: "Hello World!" });<br/>});<br/><br/>// added this line<br/>app.use("/api/v1", taskRoute);<br/><br/>app.listen(PORT, () =&gt; {<br/>    console.log(`Server is listening to port: ${PORT}`);<br/>})</span></pre><p id="7a7d" class="pw-post-body-paragraph kv kw in kx b ky lq la lb lc lr le lf ki ls lh li km lt lk ll kq lu ln lo lp ig bi translated">现在你可以使用<code class="fe mj mk ml ma b">npm start</code>命令运行项目。要测试 API 是否工作，你可以使用 postman 或 curl。我在这里添加了 curl 命令</p><pre class="lv lw lx ly gt lz ma mb bn mc md bi"><span id="7a52" class="me ka in ma b be mf mg l mh mi">curl -XPOST http://localhost:3000/api/v1/task</span></pre><p id="9387" class="pw-post-body-paragraph kv kw in kx b ky lq la lb lc lr le lf ki ls lh li km lt lk ll kq lu ln lo lp ig bi translated">您将获得以下输出</p><pre class="lv lw lx ly gt lz ma mb bn mc md bi"><span id="be8c" class="me ka in ma b be mf mg l mh mi">{<br/>    "status": "success",<br/>    "task": {<br/>        "name": "New Task"<br/>    }<br/>}</span></pre><p id="396f" class="pw-post-body-paragraph kv kw in kx b ky lq la lb lc lr le lf ki ls lh li km lt lk ll kq lu ln lo lp ig bi translated"><strong class="kx io">结论</strong></p><p id="d850" class="pw-post-body-paragraph kv kw in kx b ky lq la lb lc lr le lf ki ls lh li km lt lk ll kq lu ln lo lp ig bi translated">在这篇博客中，我们看到了如何将 typescript 集成到 NodeJS 应用程序中。在这里，我使用 MVCS 架构构建了简单的任务 API。</p><p id="edf2" class="pw-post-body-paragraph kv kw in kx b ky lq la lb lc lr le lf ki ls lh li km lt lk ll kq lu ln lo lp ig bi translated">感谢你阅读这篇博客，希望你会喜欢。如果是的话，请鼓掌并跟随我看更多这样的博客。<strong class="kx io">我有自己的 YouTube 频道，我在那里创建基于 NodeJS 的项目，你可以在这里查看</strong><a class="ae mm" href="https://www.youtube.com/channel/UCvEB7wXUEXGFE9lCx0USR3Q" rel="noopener ugc nofollow" target="_blank"><strong class="kx io"/></a><strong class="kx io">。同样的博客也将在 https://ajaykrp.me/<a class="ae mm" href="https://ajaykrp.me/" rel="noopener ugc nofollow" target="_blank">发布</a></strong></p></div></div>    
</body>
</html>