<html>
<head>
<title>R tips for every data scientist with Tidyverse and four additional packages</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">r 使用 Tidyverse 和四个额外的软件包给每个数据科学家的提示</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/r-tips-for-every-data-scientist-with-tidyverse-and-four-additional-packages-b8ed7018691f?source=collection_archive---------1-----------------------#2022-07-26">https://blog.devgenius.io/r-tips-for-every-data-scientist-with-tidyverse-and-four-additional-packages-b8ed7018691f?source=collection_archive---------1-----------------------#2022-07-26</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="1333" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">从这些 R 函数中获益，使您的下一个数据科学项目变得更加容易</h2></div><p id="cce3" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Tidyverse 是 R 包的集合，主要用于数据工程和数据科学。这些包是<strong class="ke io"> ggplot2 </strong>、<strong class="ke io"> purrr </strong>、<strong class="ke io">tible</strong>、<strong class="ke io"> dplyr </strong>、<strong class="ke io"> tidyr </strong>、<strong class="ke io"> stringr </strong>、<strong class="ke io"> readr </strong>和<strong class="ke io">forcas</strong>。所有这些都结合了相同的语言、设计和“语法”结构，使数据科学更简单、更容易、更快速。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi ky"><img src="../Images/7385f1e51227816cd012591d2629b2d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6tdNpA2JtfV9BWU2"/></div></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk translated">由<a class="ae lo" href="https://unsplash.com/@maxcodes?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">麦克斯韦·纳尔逊</a>在<a class="ae lo" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="3ed9" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">动机</h1><p id="ae8c" class="pw-post-body-paragraph kc kd in ke b kf mh jo kh ki mi jr kk kl mj kn ko kp mk kr ks kt ml kv kw kx ig bi translated">数据准备、数据争论和数据工程有助于提高所有数据科学任务的数据可用性。但是在进入数据科学之前，需要以易于阅读、重复和分析的方式准备数据。</p><p id="a5b1" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Tidyverse 包涵盖了所有重要的争论和工程师的任务。还有许多功能往往如此强大，却不为社区所知。</p><p id="8e4c" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这篇文章将引导你通过八个 Tidyverse 函数和四个 four 提示语(包:<strong class="ke io">马格里特</strong>、<strong class="ke io">看门人</strong>、<strong class="ke io"> ggforce </strong>、<strong class="ke io"> Esquirre </strong>)，让数据科学变得更容易。</p><p id="6d64" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">以下 R 提示基于<a class="ae lo" href="https://github.com/tidyverse/nycflights13/tree/main/data" rel="noopener ugc nofollow" target="_blank">航班</a>和<a class="ae lo" href="https://github.com/tidyverse/nycflights13/tree/main/data" rel="noopener ugc nofollow" target="_blank">航空公司</a>的两个公开数据集。两者都可以在 R 包 nycflights13 中获得，并且可以通过调用一个库()函数附加到您的环境中。除非另有说明，所有图片均为作者所有。</p><h1 id="ae7f" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">1.使用管道“%&gt;%”实现管道内的嵌套功能</h1><p id="3d1c" class="pw-post-body-paragraph kc kd in ke b kf mh jo kh ki mi jr kk kl mj kn ko kp mk kr ks kt ml kv kw kx ig bi translated">管道(或链接)是链接数据操作函数而不存储中间结果的好方法。</p><figure class="kz la lb lc gt ld"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="bb7b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">尽管大量使用了 REGEX 和 str_replace_all 函数，但这段代码清晰易读、易于理解且易于管理。如果我们用普通的函数包装来替换内部管道，那么“name_short”的 mutate 将会变得相当难读。</p><figure class="kz la lb lc gt ld"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="76e5" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">两个代码片段返回相同的结果，并使用基本相同的函数。然而，第一个使用管道智能地做到了这一点。</p><h1 id="66ba" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">2.一次跨多列操作</h1><p id="61af" class="pw-post-body-paragraph kc kd in ke b kf mh jo kh ki mi jr kk kl mj kn ko kp mk kr ks kt ml kv kw kx ig bi translated">Tidyverse 为同时跨多个列操作提供了一些很棒的函数。cross 是一个函数，它使得在<em class="mo">summary()</em>和<em class="mo"> mutate() </em>函数中对多个列应用相同的转换变得容易。</p><p id="a555" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">cross 接受两个参数；a)列的数组和 b)要应用于所选列的函数或函数列表。</p><figure class="kz la lb lc gt ld"><div class="bz fp l di"><div class="mm mn l"/></div></figure><h1 id="4bae" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">3.Case 语句根据条件创建列</h1><p id="be2c" class="pw-post-body-paragraph kc kd in ke b kf mh jo kh ki mi jr kk kl mj kn ko kp mk kr ks kt ml kv kw kx ig bi translated">创建 case 语句通常是一项必需的任务，而<em class="mo"> case_when() </em>函数可以实现简单、快速的转换。只需在其他 tidyverse 函数的顶部添加一个新列；例如 group_by 和 count。</p><figure class="kz la lb lc gt ld"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="b2e0" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">并通过使用<em class="mo"> case_when() </em>函数创建的变量 new_classification 创建一个带有分组的 tibble。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/dc8e346d0afd75021b85d3125c234987.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*CgfYjUfRJ0D92LAAvBO5KA.png"/></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk translated">按 case 语句分组</figcaption></figure><h1 id="ac9c" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">4.使用转化</h1><p id="c25f" class="pw-post-body-paragraph kc kd in ke b kf mh jo kh ki mi jr kk kl mj kn ko kp mk kr ks kt ml kv kw kx ig bi translated">该函数执行与 mutate 相同的功能—创建一个新列。但是<em class="mo">transduce()</em>添加新变量并删除现有变量，而<em class="mo"> mutate() </em>保留现有变量。</p><figure class="kz la lb lc gt ld"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="85db" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">上面的例子返回了基本相同的结果集，而<em class="mo">transduce()</em>更加清晰易读。如果从第一个示例中删除<em class="mo"> select() </em>函数，就会得到完整的数据集，以及一个新列。</p><h1 id="7f9c" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">5.集总水平</h1><p id="65c5" class="pw-post-body-paragraph kc kd in ke b kf mh jo kh ki mi jr kk kl mj kn ko kp mk kr ks kt ml kv kw kx ig bi translated">当有许多级别，但人们只对最频繁出现的级别感兴趣时，对给定因子变量的级别进行汇总是一个非常强大的功能。</p><p id="8a98" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">给定 15 个字母的向量和它们的频率，人们可以立即看到，在 15 个不同的字母中，大约 80%的观察值属于 5 个字母。</p><figure class="kz la lb lc gt ld"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="09bc" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在，显示不同级别的低频长尾被归入“其他”，这对于可视化数据非常有用。</p><figure class="kz la lb lc gt ld"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="8df4" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">该脚本生成了一个简单而有效的图表，显示了前 5 个最常使用的运营商，并将其他运营商归为一组。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/3a1cb5aa99d2f76b7d9594bb9c7c8b82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zNJ0d2NKT_Xfkm83.png"/></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk translated">使用 fct_lump_n()函数的快速概览图</figcaption></figure><h1 id="8244" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">6.生成所有可能的组合</h1><p id="1399" class="pw-post-body-paragraph kc kd in ke b kf mh jo kh ki mi jr kk kl mj kn ko kp mk kr ks kt ml kv kw kx ig bi translated">从一组变量中产生所有可能的组合不是你的日常场景。但是 Tidyverse 提供了名为<em class="mo"> crossing() </em>或<em class="mo"> expand() </em>的函数来完成这项工作。</p><p id="e758" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">使用<em class="mo">航班</em>数据集，让我们为几个选定的变量创建所有可能的组合。我们可以使用函数<em class="mo"> expand() </em>。但是找到所有现有的唯一组合<em class="mo"> crossing() </em>函数就可以了。</p><figure class="kz la lb lc gt ld"><div class="bz fp l di"><div class="mm mn l"/></div></figure><h1 id="69f0" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">7.通过透视和展开重塑数据</h1><p id="2677" class="pw-post-body-paragraph kc kd in ke b kf mh jo kh ki mi jr kk kl mj kn ko kp mk kr ks kt ml kv kw kx ig bi translated">另一项通常与数据准备相关的重要任务是数据整形。</p><p id="8b67" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">第一个功能一个人必须(！)理解并舒服地工作是<strong class="ke io"><em class="mo">pivot _ wider()</em></strong>。该函数从一个变量(在本例中为变量:origin)获取值，并针对给定的统计数据(平均值)转置(整形/透视)数据(dep_time 和 arr_time)。</p><figure class="kz la lb lc gt ld"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="d61b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">此转换基于平均时间(出发和到达)的起点为可变承运人创建统计数据。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi mr"><img src="../Images/34c30cdd6bda1962bfbc00d30038e177.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N6CeWpFp_GN-qwC5k4PS_w.png"/></div></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk translated">从较长的数据集旋转到较宽的数据集</figcaption></figure><p id="84f6" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Contra to <em class="mo"> pivot_wider() </em>是函数<strong class="ke io"> <em class="mo"> pivot_longer() </em> </strong>。这个函数正好相反。较宽的函数增加更多的列并减少行数，而较长的函数减少列数并创建新的数据行。</p><p id="41dd" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们持久化 pivot_wider 示例中的数据帧，并将数据帧命名为 flights_wider。</p><figure class="kz la lb lc gt ld"><div class="bz fp l di"><div class="mm mn l"/></div></figure><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi ms"><img src="../Images/dfc592d20b907755c435dd00d3f11978.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y-F-FmO9ObX91lwG_MekRQ.png"/></div></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk translated">将数据集从宽旋转到长</figcaption></figure><p id="7f56" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这两个函数都以这样的方式透视数据集，即可以在较长的数据集中创建作为键:值变量的列，并且可以将键:值对透视到更宽的数据集。许多数据分析场景将受益于这两个函数。</p><h1 id="21e4" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">8.向数据帧添加运行 ID</h1><p id="f3bb" class="pw-post-body-paragraph kc kd in ke b kf mh jo kh ki mi jr kk kl mj kn ko kp mk kr ks kt ml kv kw kx ig bi translated">最后一个技巧是最简单的，但是可以节省大量的时间。向数据帧的每一行添加一个运行 ID。这个 ID 将为给定的行创建“唯一性”整体属性(列)。这可以为您节省大量过滤和编写代码的时间，然而，您可以说，给我一个 ID = 42 的行。</p><figure class="kz la lb lc gt ld"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="c0f9" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这份名单绝不是最终的名单，人们可以添加许多光荣的提及。尽管如此，这份名单是经过长期策划的，这份精选是基于工作和对 Tidyverse 的使用。</p><h1 id="9348" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">荣誉提名</h1><p id="9572" class="pw-post-body-paragraph kc kd in ke b kf mh jo kh ki mi jr kk kl mj kn ko kp mk kr ks kt ml kv kw kx ig bi translated">Tidyverse 列表中增加了四个额外的函数——每个来自不同的包。这些都是做数据探索时值得记住的。</p><p id="d528" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">包<a class="ae lo" href="https://cran.r-project.org/web/packages/magrittr/index.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io">马格里特</strong> </a>带强力赋值管<em class="mo">%&lt;%</em>。它将修改重新分配给同一个数据帧。这将产生双重效果。当处理更大的数据集和更整洁的环境时，它将节省本地内存。</p><figure class="kz la lb lc gt ld"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="e5e6" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">包<a class="ae lo" href="https://cran.r-project.org/web/packages/janitor/index.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io">看门人</strong> </a>有一颗隐藏的宝石。函数<em class="mo"> tably() </em>让创建统计表变得简单、干净、整洁。这些表格可以包括按行或列的百分比和累计。</p><figure class="kz la lb lc gt ld"><div class="bz fp l di"><div class="mm mn l"/></div></figure><figure class="kz la lb lc gt ld gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/01f0c26aa761cfc58b5a417c2db7949d.png" data-original-src="https://miro.medium.com/v2/resize:fit:606/format:webp/1*pKS6U04JZvWC56uNiQS2AQ.png"/></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk translated">包含三个变量和百分比的表格|按行计数</figcaption></figure><figure class="kz la lb lc gt ld gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/c79d996a34b8644babbfc629c4567b85.png" data-original-src="https://miro.medium.com/v2/resize:fit:606/format:webp/1*rA8xXvKqU_cwxeY2KyME1Q.png"/></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk translated">包含两个变量和百分比的表格|按行计数</figcaption></figure><p id="915a" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">软件包管理员还将帮助您清理数据(因此有了软件包名称)。值得一提的函数还有<em class="mo"> remove_empty() </em>、<em class="mo"> get_dupes() </em>和<em class="mo"> compare_df_cols() </em>。第一个函数将移除空的列或行，第二个函数将查找重复项，第三个函数将比较数据集以查找重复项。</p><p id="6cf7" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">使用<a class="ae lo" href="https://cran.r-project.org/web/packages/ggforce/index.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> ggforce </strong> </a>包中的<em class="mo"> zoom_facet() </em>函数在图表的特定部分创建焦点(缩放)。</p><figure class="kz la lb lc gt ld"><div class="bz fp l di"><div class="mm mn l"/></div></figure><figure class="kz la lb lc gt ld gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/4262e495ad424bdc1ba08891f943f98b.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/0*3UPt9SmQLCn-OCRG"/></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk translated">使用 zoom_facet()缩放图形的部分</figcaption></figure><p id="5f9c" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">使用<a class="ae lo" href="https://cran.r-project.org/web/packages/esquisse/vignettes/get-started.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> esquisse </strong> </a>软件包，交互式地探索和可视化您的数据。浏览和过滤数据集。软件包(插件)帮助您绘制绘图，曲线，散点图，直方图，箱线图等。和许多其他类型。</p><figure class="kz la lb lc gt ld"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="7c13" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">将创建一个对话窗口，使数据浏览变得容易。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/34e3db1660f6047e627cb04ec3e26597.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*IkwLHmU_DBxbTywk"/></div></figure><p id="bb18" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">此外，生成<strong class="ke io"> ggplot2 </strong>代码，可以复制并进一步用于分析。</p><h1 id="62d9" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">结论</h1><p id="7f77" class="pw-post-body-paragraph kc kd in ke b kf mh jo kh ki mi jr kk kl mj kn ko kp mk kr ks kt ml kv kw kx ig bi translated">Tidyverse 函数和其他四个软件包(Magrittr、gate er、ggforce 和 esquisse)中的函数列表非常有用，可以帮助任何数据科学家处理数据。此外，这将使他们的代码可读和可复制，仅仅因为它将更容易理解和管理。</p></div></div>    
</body>
</html>