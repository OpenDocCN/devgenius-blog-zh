<html>
<head>
<title>Most efficient way of generating uuid in C++</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 C++中生成 uuid 的最有效方法</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/most-efficient-way-of-generating-uuid-in-c-a10242a77946?source=collection_archive---------0-----------------------#2021-07-08">https://blog.devgenius.io/most-efficient-way-of-generating-uuid-in-c-a10242a77946?source=collection_archive---------0-----------------------#2021-07-08</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><figure class="im in gp gr io ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/b1b1a5d6ae91bd6d87dc09112114a1ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yt8vTh_qKXifpCCz-5gR_w.jpeg"/></div></div><figcaption class="iw ix gj gh gi iy iz bd b be z dk translated">由<a class="ae ja" href="https://unsplash.com/s/photos/identity-card?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae ja" href="https://unsplash.com/@cardmapr?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> CardMapr.nl </a>拍摄的照片</figcaption></figure><div class=""/><p id="dc2a" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">最近，我被分配了一项任务，寻找提高应用程序函数路径效率的方法。我使用 Vallgrind 宏来计算函数的 CPU 周期。我们最初在实现中使用 drogon HTTP 应用框架的 getUUID 函数。</p><p id="0f8a" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在我的侧写过程中，我发现</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="486c" class="lh li jd ld b gy lj lk l ll lm"><a class="ae ja" href="https://drogon.docsforge.com/master/api/drogon/utils/getUuid/" rel="noopener ugc nofollow" target="_blank">drogon::utils::getUuid()</a></span></pre><p id="52b8" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">消耗了调用该特定方法的函数的 50%以上的 CPU。我去谷歌搜索生成 UUID 的更好方法，发现有许多其他开源库在做同样的工作，并声称它们比其他库更有效。我发现了这个开源库，它的基准测试结果对我来说很有希望。这个库被称为<a class="ae ja" href="https://github.com/crashoz/uuid_v4" rel="noopener ugc nofollow" target="_blank"> uuid_v4 </a>。该库正在用以下其他 uuid 生成方法进行基准测试。</p><figure class="ky kz la lb gt ip gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/19fe415fd66d5299964886754bfb6efb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*7PIR07T4bOdYeLIa1iWpIg.png"/></div></figure><p id="3916" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">git 库中也提到过，这个库用伪随机数生成 UUIDs，由真(硬件)随机数作为种子。这是<em class="lo">而不是</em>一种生成 UUIDs 的加密安全方式。这是它速度快的一个主要原因。但是尽管如此，如果有人的目标是提高性能，这是值得一试。</p><p id="861e" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">看着 github 的结果，我决定用我们自己当前的实现对它进行基准测试，我发现当用 Valgrind 的宏计算它时，这个特殊的函数比 drogon::utils::getUuid()快 35 倍。</p><figure class="ky kz la lb gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi lp"><img src="../Images/4511ddaccf628a353783329b72d31c98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rJZuP_BvTr75Y5OxOx1Wag.png"/></div></div></figure><p id="468f" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">以下代码片段来自新库中:</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="6b22" class="lh li jd ld b gy lj lk l ll lm">#include "uuid_v4"</span><span id="4678" class="lh li jd ld b gy lq lk l ll lm">UUID::UUIDGenerator&lt;std::mt19937_64&gt; uuidGenerator;<br/>UUID::UUID uuid = uuidGenerator.getUUID();<br/>std::string s = uuid.str();</span></pre><p id="27b4" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">要了解如何实现这个库，你可以访问 git 页面<a class="ae ja" href="https://github.com/crashoz/uuid_v4" rel="noopener ugc nofollow" target="_blank">这里</a>。如果在执行中有任何困难，留下评论。</p><h1 id="4d52" class="lr li jd bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">结论:</h1><p id="f79e" class="pw-post-body-paragraph ka kb jd kc b kd mo kf kg kh mp kj kk kl mq kn ko kp mr kr ks kt ms kv kw kx ig bi translated">如上所述，从函数库本身和 Valgrind 的分析工具的基准测试结果来看，我可以自信地说，如果你的目标是提高应用程序的效率，那么试试这个函数库并分享你的结果。通过从 drogon 的 getUUID 迁移到 uuid_v4 的 getUUId，我们的整体端到端功能在 CPU 使用方面的效率提高了三倍。</p></div></div>    
</body>
</html>