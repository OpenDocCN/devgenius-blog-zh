<html>
<head>
<title>Linear Regression using Automobile mpg Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用汽车 mpg 数据的线性回归</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/linear-regression-using-automobile-mpg-data-46ccc09a04cc?source=collection_archive---------4-----------------------#2022-10-28">https://blog.devgenius.io/linear-regression-using-automobile-mpg-data-46ccc09a04cc?source=collection_archive---------4-----------------------#2022-10-28</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="835e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">本文将讨论以下内容。我们将使用线性回归模型来发现汽车 mpg 数据集中两个变量之间的关系。</p><ul class=""><li id="fd3c" class="ki kj in jm b jn jo jr js jv kk jz kl kd km kh kn ko kp kq bi translated">线性回归</li><li id="129f" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kn ko kp kq bi translated">最小二乘法</li><li id="7753" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kn ko kp kq bi translated">汽车 mpg 数据集</li><li id="a955" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kn ko kp kq bi translated">实施简单线性回归</li><li id="9229" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kn ko kp kq bi translated">实现分段线性回归</li></ul><h1 id="86a0" class="kw kx in bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">线性回归</h1><p id="574a" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv lw jx jy jz lx kb kc kd ly kf kg kh ig bi translated"><a class="ae lz" href="http://www.stat.yale.edu/Courses/1997-98/101/linreg.htm" rel="noopener ugc nofollow" target="_blank">线性回归</a>通过将一个线性方程与观察到的数据相拟合来模拟两个变量之间的关系。</p><p id="0061" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">或者，正如<a class="ae lz" href="https://www.youtube.com/watch?v=nk2CQITm_eo" rel="noopener ugc nofollow" target="_blank">乔希·斯塔默</a>解释的那样，线性回归背后的概念就是<strong class="jm io">用最小二乘法和 R 平方拟合数据</strong>。</p><h1 id="9fc5" class="kw kx in bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">最小二乘法</h1><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi ma"><img src="../Images/85b1a3475c74432bbb095200c3072519.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c6pLm8nEg1uPKFuGIrmrrA.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk translated">credit:<a class="ae lz" href="https://www.jmp.com/en_in/statistics-knowledge-portal/what-is-regression/the-method-of-least-squares.html" rel="noopener ugc nofollow" target="_blank">https://www . jmp . com/en _ in/statistics-knowledge-portal/what-is-regression/the-method-of-least-squares . html</a></figcaption></figure><p id="9e09" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae lz" href="http://www.stat.yale.edu/Courses/1997-98/101/linreg.htm" rel="noopener ugc nofollow" target="_blank">最小二乘法</a>通过最小化每个数据点到直线的垂直偏差的平方和来计算观察数据的最佳拟合直线。</p><p id="ea2c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将使用这些方法来找出汽车 mpg 数据中两个变量之间的关系。</p><h1 id="f4a9" class="kw kx in bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">汽车 mpg 数据集</h1><p id="22e0" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv lw jx jy jz lx kb kc kd ly kf kg kh ig bi translated">汽车 mpg 数据集来自<strong class="jm io">加州大学欧文分校机器学习知识库</strong>，该知识库<strong class="jm io"> </strong>维护 622 个数据集作为对机器学习社区的服务。</p><p id="1df2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae lz" href="https://archive.ics.uci.edu/ml/datasets/auto+mpg" rel="noopener ugc nofollow" target="_blank">https://archive.ics.uci.edu/ml/datasets/auto+mpg</a></p><p id="cc02" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如在网站上找到的数据集的详细描述所示，有 398 行和 9 列以及缺失值。这 9 个属性信息描述如下。</p><p id="393a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">1.mpg:连续<br/> 2。气缸:多值离散<br/> 3。排量:连续<br/> 4。马力:连续<br/> 5。重量:连续<br/> 6。加速:连续<br/> 7。年款:多值离散<br/> 8。原点:多值离散<br/> 9。汽车名称:字符串(对于每个实例是唯一的)</p><p id="86a4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">该数据涉及以英里/加仑为单位的城市循环油耗，根据 3 个多值离散属性和 5 个连续属性进行预测(<a class="ae lz" href="https://archive.ics.uci.edu/ml/datasets/auto+mpg" rel="noopener ugc nofollow" target="_blank"> Quinlan </a>，1993)。</p><h1 id="abe9" class="kw kx in bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">实施简单线性回归</h1><p id="1ffa" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv lw jx jy jz lx kb kc kd ly kf kg kh ig bi translated">在导入<strong class="jm io"> Matplotlib、Pandas </strong>和<strong class="jm io"> Numpy </strong>包之后，我们加载数据集。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi mq"><img src="../Images/f4a9464a90bd433c5589d5c5a9342196.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zaJBsHMVGOEDh-_ysNAQDg.png"/></div></div></figure><p id="ec02" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">使用 head()函数，我们可以看到数据集的前 6 行，并检查 dataframe 是否正确加载。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi mr"><img src="../Images/9527349f530241b92f841991424fa25e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DtxiAODJL2PAHIt3D984vA.png"/></div></div></figure><p id="27c8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">使用 columns、shape 和 index 函数，我们可以检查列名、行数(索引)和列数。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi ms"><img src="../Images/7d2f850cb44ce0f0b30960c6d47dec25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EY6GaOZyJwKd9QIdxz0AhQ.png"/></div></div></figure><p id="fe76" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">将数据帧转换为 NumPy 数组，我们可以直观地看到汽车的<strong class="jm io">重量和 mpg </strong>之间的关系。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi mt"><img src="../Images/78eb5c08021c369102f39146f735e237.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OqQn-LjXQbvIB1Fq_-dxVg.png"/></div></div></figure><p id="6d02" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">平均重量和平均 mpg 也可以使用以下代码进行研究。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi mu"><img src="../Images/79d0ca81fa9e87a58a291c1a46668537.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2d0-YmgtAxDkMhhysZ5N1w.png"/></div></div></figure><h2 id="1d86" class="mv kx in bd ky mw mx dn lc my mz dp lg jv na nb lk jz nc nd lo kd ne nf ls ng bi translated">绘制线性拟合</h2><p id="fe6a" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv lw jx jy jz lx kb kc kd ly kf kg kh ig bi translated">我们将探索不同特性<strong class="jm io">马力</strong>和<strong class="jm io">英里/加仑</strong>之间的关系。</p><p id="84ea" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">由于马力有一些丢失的数据，我们将使用<strong class="jm io"> dropna </strong>方法来删除它们。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi nh"><img src="../Images/6621aba8e119ef46a971ba11c878ca39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FzjtY2shjeUeXtLl-wZH6Q.png"/></div></div></figure><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi ni"><img src="../Images/87805428df63e6bc7611f7e562823a3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CCQn_6E4AuA3lgLIR_59AQ.png"/></div></div></figure><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi nj"><img src="../Images/9ac98225854cfd296a640cb04ea6e039.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TTnBZdzMN1w7D1kVDspbKQ.png"/></div></div></figure><figure class="mb mc md me gt mf gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/45986e730e354474e47c37a06c6625e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*PsSu5KmPzFhfG7WejnCPYQ.png"/></div></figure><figure class="mb mc md me gt mf gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/7eb46cb3484bf1b5f0c8e01889c8af56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*iaMGUe4wLnduSj00qyaDVg.png"/></div></figure><p id="59b4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> 𝑥棒线</strong>和<strong class="jm io"> 𝑦棒线</strong>为样本均值，<strong class="jm io"> 𝑠𝑦𝑥 </strong>和<strong class="jm io"> 𝑠𝑥𝑥 </strong>为协方差和方差。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi nm"><img src="../Images/0ecff00b597b2a846caff7f2012dec81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1WH9_f6w7Icf_S8qfZTOKA.png"/></div></div></figure><p id="8292" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们绘制 x 和 y(实际值)以及 x 和 ypred(预测值),以确定预测值与实际数据集的拟合程度。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi nn"><img src="../Images/4868e853a50caacb27828cf1d7ae3f8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZBTPcSc9_yBPajjESwdBPQ.png"/></div></div></figure><p id="088b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">平方损失(RSS 或 L2 损失)是测量预测值(yhat)和实际值(y)之间差异的最常用方法之一。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi no"><img src="../Images/620c7893614bcb0395e12f96548b8b38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RCqLROlf_ZlFLqe8nNU2bA.png"/></div></div></figure><h1 id="b56b" class="kw kx in bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">实现分段线性回归</h1><p id="8c13" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv lw jx jy jz lx kb kc kd ly kf kg kh ig bi translated">由于当马力在 50-100 之间时，mpg 更高，我们将看到如何通过使用分段线性回归来提高拟合度。</p><p id="7787" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将遵循这个分段函数。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi np"><img src="../Images/2a6096f0a4f56fa25399eb68c0d19f42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jNJ_ilMsBRJJjNBYf__GWA.png"/></div></div></figure><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi nq"><img src="../Images/759d275f466cb6ae5649fd002771b012.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f3VTyyI1RDNOss6_2b2wIA.png"/></div></div></figure><p id="d8b0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因为马力在 50-100 之间有较高的 mpg，我们将把 lambda 设置为 100。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi nr"><img src="../Images/5a95d6480c0542454cd48224a41ba44d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lWWTs-HsWHtJ3AqmUVQNFA.png"/></div></div></figure><p id="b9d6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">新的 X 矩阵将如下所示。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi ns"><img src="../Images/61625572e25ee02e431b5ba221f4f9c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qu7Tapw0Sw6GpxdYqIOjWg.png"/></div></div></figure><p id="ebb5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">然后，我们使用以下公式和函数找到最佳β。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi nt"><img src="../Images/29f0075022732c9d6c8db7cd00a15ca3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FI_sKPX-bNA9Hn8XtORNlA.png"/></div></div></figure><p id="73de" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">然后，我们可以基于最优β找到 yhat(预测的)。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi nu"><img src="../Images/ae7f5b5803d0ec8e6f984f329f67d31a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i-VwwoCGSwSE8EhCMaUeaw.png"/></div></div></figure><p id="5428" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">通过再次绘制 x 和 y(实际值)以及 x 和 Yhat(预测值)，我们可以直观地看到预测值与实际数据集的吻合程度。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi nv"><img src="../Images/30dae60661c6f0ef10f078ef4c1ebb8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yNIThlhEDbz8UZ6tBn4TeQ.png"/></div></div></figure><p id="03e0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">损耗减少了接近 2000，这比第一次线性拟合好得多。</p><p id="a894" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">感谢你花时间阅读这篇文章！</p></div></div>    
</body>
</html>