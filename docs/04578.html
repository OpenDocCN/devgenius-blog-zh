<html>
<head>
<title>Add Box Plots into Our React App with the Visx Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Visx库将箱线图添加到React应用程序中</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/add-box-plots-into-our-react-app-with-the-visx-library-1f8ed9a093c2?source=collection_archive---------9-----------------------#2021-04-05">https://blog.devgenius.io/add-box-plots-into-our-react-app-with-the-visx-library-1f8ed9a093c2?source=collection_archive---------9-----------------------#2021-04-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/649a040d424565f1b16b3e3042ca9c12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EL75omhPYfKL72c2"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">由<a class="ae kc" href="https://unsplash.com/@mildlee?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">在</a><a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="1094" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Visx是一个库，让我们可以轻松地将图形添加到React应用程序中。</p><p id="ee07" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解如何使用它来将盒状图添加到React应用程序中。</p><h1 id="396e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">安装所需的软件包</h1><p id="2968" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们必须安装一些模块。</p><p id="61e8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们运行:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="89df" class="mn lc iq mj b gy mo mp l mq mr">npm i @visx/gradient @visx/group @visx/mock-data @visx/pattern @visx/responsive @visx/scale @visx/stats @visx/tooltip</span></pre><p id="8e2b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">安装软件包。</p><h1 id="dd73" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">添加方框图</h1><p id="2486" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">现在，我们可以使用以下内容添加箱线图:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="c9fc" class="mn lc iq mj b gy mo mp l mq mr">import React from "react";<br/>import { Group } from "@visx/group";<br/>import { ViolinPlot, BoxPlot } from "@visx/stats";<br/>import { LinearGradient } from "@visx/gradient";<br/>import { scaleBand, scaleLinear } from "@visx/scale";<br/>import genStats from "@visx/mock-data/lib/generators/genStats";<br/>import {<br/>  Tooltip,<br/>  defaultStyles as defaultTooltipStyles,<br/>  useTooltip<br/>} from "@visx/tooltip";<br/>import { PatternLines } from "@visx/pattern";</span><span id="50c0" class="mn lc iq mj b gy ms mp l mq mr">const data = genStats(5);<br/>const x = (d) =&gt; d.boxPlot.x;<br/>const min = (d) =&gt; d.boxPlot.min;<br/>const max = (d) =&gt; d.boxPlot.max;<br/>const median = (d) =&gt; d.boxPlot.median;<br/>const firstQuartile = (d) =&gt; d.boxPlot.firstQuartile;<br/>const thirdQuartile = (d) =&gt; d.boxPlot.thirdQuartile;<br/>const outliers = (d) =&gt; d.boxPlot.outliers;</span><span id="e3d7" class="mn lc iq mj b gy ms mp l mq mr">const Example = ({ width, height }) =&gt; {<br/>  const {<br/>    tooltipOpen,<br/>    tooltipLeft,<br/>    tooltipTop,<br/>    tooltipData,<br/>    hideTooltip,<br/>    showTooltip<br/>  } = useTooltip();</span><span id="ebfe" class="mn lc iq mj b gy ms mp l mq mr">  const xMax = width;<br/>  const yMax = height - 120;<br/>  const xScale = scaleBand({<br/>    range: [0, xMax],<br/>    round: true,<br/>    domain: data.map(x),<br/>    padding: 0.4<br/>  });</span><span id="3bec" class="mn lc iq mj b gy ms mp l mq mr">  const values = data.reduce((allValues, { boxPlot }) =&gt; {<br/>    allValues.push(boxPlot.min, boxPlot.max);<br/>    return allValues;<br/>  }, []);<br/>  const minYValue = Math.min(...values);<br/>  const maxYValue = Math.max(...values);</span><span id="b381" class="mn lc iq mj b gy ms mp l mq mr">  const yScale = scaleLinear({<br/>    range: [yMax, 0],<br/>    round: true,<br/>    domain: [minYValue, maxYValue]<br/>  });</span><span id="7ca7" class="mn lc iq mj b gy ms mp l mq mr">  const boxWidth = xScale.bandwidth();<br/>  const constrainedWidth = Math.min(40, boxWidth);</span><span id="b1b5" class="mn lc iq mj b gy ms mp l mq mr">  return width &lt; 10 ? null : (<br/>    &lt;div style={{ position: "relative" }}&gt;<br/>      &lt;svg width={width} height={height}&gt;<br/>        &lt;LinearGradient id="statsplot" to="#8b6ce7" from="#87f2d4" /&gt;<br/>        &lt;rect<br/>          x={0}<br/>          y={0}<br/>          width={width}<br/>          height={height}<br/>          fill="url(#statsplot)"<br/>          rx={14}<br/>        /&gt;<br/>        &lt;PatternLines<br/>          id="hViolinLines"<br/>          height={3}<br/>          width={3}<br/>          stroke="#ced4da"<br/>          strokeWidth={1}<br/>          orientation={["horizontal"]}<br/>        /&gt;<br/>        &lt;Group top={40}&gt;<br/>          {data.map((d, i) =&gt; (<br/>            &lt;g key={i}&gt;<br/>              &lt;ViolinPlot<br/>                data={d.binData}<br/>                stroke="#dee2e6"<br/>                left={xScale(x(d))}<br/>                width={constrainedWidth}<br/>                valueScale={yScale}<br/>                fill="url(#hViolinLines)"<br/>              /&gt;<br/>              &lt;BoxPlot<br/>                min={min(d)}<br/>                max={max(d)}<br/>                left={xScale(x(d)) + 0.3 * constrainedWidth}<br/>                firstQuartile={firstQuartile(d)}<br/>                thirdQuartile={thirdQuartile(d)}<br/>                median={median(d)}<br/>                boxWidth={constrainedWidth * 0.4}<br/>                fill="#FFFFFF"<br/>                fillOpacity={0.3}<br/>                stroke="#FFFFFF"<br/>                strokeWidth={2}<br/>                valueScale={yScale}<br/>                outliers={outliers(d)}<br/>                minProps={{<br/>                  onMouseOver: () =&gt; {<br/>                    showTooltip({<br/>                      tooltipTop: yScale(min(d)) ?? 0 + 40,<br/>                      tooltipLeft: xScale(x(d)) + constrainedWidth + 5,<br/>                      tooltipData: {<br/>                        min: min(d),<br/>                        name: x(d)<br/>                      }<br/>                    });<br/>                  },<br/>                  onMouseLeave: () =&gt; {<br/>                    hideTooltip();<br/>                  }<br/>                }}<br/>                maxProps={{<br/>                  onMouseOver: () =&gt; {<br/>                    showTooltip({<br/>                      tooltipTop: yScale(max(d)) ?? 0 + 40,<br/>                      tooltipLeft: xScale(x(d)) + constrainedWidth + 5,<br/>                      tooltipData: {<br/>                        max: max(d),<br/>                        name: x(d)<br/>                      }<br/>                    });<br/>                  },<br/>                  onMouseLeave: () =&gt; {<br/>                    hideTooltip();<br/>                  }<br/>                }}<br/>                boxProps={{<br/>                  onMouseOver: () =&gt; {<br/>                    showTooltip({<br/>                      tooltipTop: yScale(median(d)) ?? 0 + 40,<br/>                      tooltipLeft: xScale(x(d)) + constrainedWidth + 5,<br/>                      tooltipData: {<br/>                        ...d.boxPlot,<br/>                        name: x(d)<br/>                      }<br/>                    });<br/>                  },<br/>                  onMouseLeave: () =&gt; {<br/>                    hideTooltip();<br/>                  }<br/>                }}<br/>                medianProps={{<br/>                  style: {<br/>                    stroke: "white"<br/>                  },<br/>                  onMouseOver: () =&gt; {<br/>                    showTooltip({<br/>                      tooltipTop: yScale(median(d)) ?? 0 + 40,<br/>                      tooltipLeft: xScale(x(d)) + constrainedWidth + 5,<br/>                      tooltipData: {<br/>                        median: median(d),<br/>                        name: x(d)<br/>                      }<br/>                    });<br/>                  },<br/>                  onMouseLeave: () =&gt; {<br/>                    hideTooltip();<br/>                  }<br/>                }}<br/>              /&gt;<br/>            &lt;/g&gt;<br/>          ))}<br/>        &lt;/Group&gt;<br/>      &lt;/svg&gt;</span><span id="2094" class="mn lc iq mj b gy ms mp l mq mr">      {tooltipOpen &amp;&amp; tooltipData &amp;&amp; (<br/>        &lt;Tooltip<br/>          top={tooltipTop}<br/>          left={tooltipLeft}<br/>          style={{<br/>            ...defaultTooltipStyles,<br/>            backgroundColor: "#283238",<br/>            color: "white"<br/>          }}<br/>        &gt;<br/>          &lt;div&gt;<br/>            &lt;strong&gt;{tooltipData.name}&lt;/strong&gt;<br/>          &lt;/div&gt;<br/>          &lt;div style={{ marginTop: "5px", fontSize: "12px" }}&gt;<br/>            {tooltipData.max &amp;&amp; &lt;div&gt;max: {tooltipData.max}&lt;/div&gt;}<br/>            {tooltipData.thirdQuartile &amp;&amp; (<br/>              &lt;div&gt;third quartile: {tooltipData.thirdQuartile}&lt;/div&gt;<br/>            )}<br/>            {tooltipData.median &amp;&amp; &lt;div&gt;median: {tooltipData.median}&lt;/div&gt;}<br/>            {tooltipData.firstQuartile &amp;&amp; (<br/>              &lt;div&gt;first quartile: {tooltipData.firstQuartile}&lt;/div&gt;<br/>            )}<br/>            {tooltipData.min &amp;&amp; &lt;div&gt;min: {tooltipData.min}&lt;/div&gt;}<br/>          &lt;/div&gt;<br/>        &lt;/Tooltip&gt;<br/>      )}<br/>    &lt;/div&gt;<br/>  );<br/>};</span><span id="7969" class="mn lc iq mj b gy ms mp l mq mr">export default function App() {<br/>  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;Example width={500} height={300} /&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="fe02" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">data</code>变量包含箱线图的数据。</p><p id="e128" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们在它下面添加getter方法。</p><p id="a1ec" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe mt mu mv mj b">Example</code>组件中，我们调用<code class="fe mt mu mv mj b">useTooltip</code>钩子，当鼠标悬停在箱线图上时显示工具提示。</p><p id="aa84" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">showTooltip</code>显示工具提示。<code class="fe mt mu mv mj b">hideTooltip</code>隐藏工具提示。</p><p id="2bae" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们添加了<code class="fe mt mu mv mj b">values</code>变量来收集箱线图所需的值。</p><p id="586d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">yScale</code>具有y轴的刻度。</p><p id="6e21" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了添加盒图，我们调用<code class="fe mt mu mv mj b">data.map</code>来映射数据值盒图组件。</p><p id="a3de" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们使用<code class="fe mt mu mv mj b">ViolinPlot</code>组件来渲染盒子图周围的小提琴图。</p><p id="0bb9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们使用<code class="fe mt mu mv mj b">BoxPlot</code>组件来呈现箱线图。</p><p id="405f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将所有的getter方法作为道具传入<code class="fe mt mu mv mj b">ViolinPlot</code>和<code class="fe mt mu mv mj b">BoxPlot</code>。</p><p id="b209" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们调用<code class="fe mt mu mv mj b">onMouseOver</code>方法中的<code class="fe mt mu mv mj b">showTooltip</code>来显示一个工具提示。</p><p id="8c80" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe mt mu mv mj b">onMouseLeave</code>处理程序中，我们调用<code class="fe mt mu mv mj b">hideTooltip</code>来隐藏工具提示。</p><p id="3ed6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">minProps</code>获取当我们悬停在箱线图底部时运行的处理程序。</p><p id="1be4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">maxProps</code>获取当我们悬停在箱线图顶部时运行的处理程序。</p><p id="90f0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">boxProps</code>获取当我们悬停在盒状图的盒子上时运行的处理程序。</p><p id="2e4f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">medianProps</code>获取当我们悬停在箱线图中点上时运行的处理程序。</p><p id="70b9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们用<code class="fe mt mu mv mj b">Tooltip</code>组件添加工具提示内容。</p><p id="e9f2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们应该看到一个盒子和小提琴情节。当我们将鼠标悬停在胡须或方框上时，我们会看到一个带有值的工具提示。</p><h1 id="1009" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="3096" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用Visx库将盒子和小提琴图添加到React应用程序中。</p></div></div>    
</body>
</html>