<html>
<head>
<title>Facial Expression Recognition with TensorFlow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¼ é‡æµäººè„¸è¡¨æƒ…è¯†åˆ«</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://blog.devgenius.io/facial-expression-recognition-with-tensorflow-90f6174163c3?source=collection_archive---------1-----------------------#2022-03-20">https://blog.devgenius.io/facial-expression-recognition-with-tensorflow-90f6174163c3?source=collection_archive---------1-----------------------#2022-03-20</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div class="gh gi jk"><img src="../Images/751ab3fb815b9474ca3a086da0541e90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*XidkH_SxYmLT3VeN0oPqfg.png"/></div></figure><p id="898a" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">æˆ‘å¼€å§‹äº†ä½œä¸ºæœºå™¨å­¦ä¹ å·¥ç¨‹å¸ˆçš„æ—…ç¨‹ï¼Œè¯•å›¾å°½å¯èƒ½å¤šåœ°è¿›è¡Œå®è·µï¼Œä¸å…¶ä»–äººå»ºç«‹è”ç³»ï¼Œå¹¶æ¥æ”¶ä¸€äº›åé¦ˆä»¥è¿›è¡Œæ”¹è¿›ã€‚æ‰€ä»¥å¦‚æœä½ æƒ³è°ˆè°ˆæˆ–ç»™æˆ‘ä¸€äº›åé¦ˆï¼Œæˆ‘ä¼šå¾ˆæ„Ÿæ¿€ï¼Œæˆ‘ä¼šè®©æˆ‘çš„ LinkedIn å’Œ GitHub åœ¨æ–‡æœ«ã€‚</p><p id="1884" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">æ‰€ä»¥é¦–å…ˆï¼Œæˆ‘æƒ³åšä¸€äº›å›¾åƒåˆ†ç±»å™¨é¡¹ç›®ï¼Œç„¶åæˆ‘åšäº†ä¸€äº›ç ”ç©¶ï¼Œå‘ç°äº†è¿™ä¸ªâ€œæ£€æµ‹æƒ…ç»ªâ€çš„æƒ³æ³•ï¼Œæˆ‘è®¤ä¸ºå®ƒéå¸¸é…·ã€‚æ‰€ä»¥åœ¨æœç´¢äº†ä¸€äº›å…³äºè¿™ä¸ªç‰¹å®šé—®é¢˜çš„æ•°æ®é›†åï¼Œæˆ‘é€‰æ‹©äº†è¿™ä¸ª<a class="ae kp" href="https://www.kaggle.com/c/challenges-in-representation-learning-facial-expression-recognition-challenge" rel="noopener ugc nofollow" target="_blank">è¡¨å¾å­¦ä¹ çš„æŒ‘æˆ˜:æ¥è‡ª<a class="ae kp" href="https://www.kaggle.com" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>çš„é¢éƒ¨è¡¨æƒ…è¯†åˆ«æŒ‘æˆ˜</a>ã€‚</p><p id="c851" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">æˆ‘ä»¬å°†åœ¨æ•°æ®åˆ†æã€æ•°æ®é¢„å¤„ç†å’Œå»ºæ¨¡çš„è¿™äº›è¿‡ç¨‹ä¸­ä½¿ç”¨ Google Colabã€‚ä½†æ˜¯ï¼Œè®©æˆ‘ä»¬è°ˆè°ˆæˆ‘ä»¬çš„æ•°æ®ï¼Œæ•°æ®é›†ä¸ºæˆ‘ä»¬æä¾›äº† 7 ä¸ªç±»ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><figure class="kr ks kt ku gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kq"><img src="../Images/e75b5116dc8adfc7ce8a7b1385b33f3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*77XItkVczWPfLb-J3QDo9g.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">æƒ…æ„Ÿ</figcaption></figure><p id="a3b9" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">ä½ çœ‹åˆ°çš„å’Œæˆ‘ä¸€æ ·å—ï¼Ÿæˆ‘ä»¬æœ‰ä¸€ä¸ªä¸å¹³è¡¡æ•°æ®çš„é—®é¢˜â€¦æ˜¯çš„ï¼Œé‚£å¾ˆç³Ÿç³•ã€‚ä½†æ˜¯ä¸ºäº†â€œè§£å†³â€è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°†åªä½¿ç”¨ 4 ä¸ªç±»ï¼Œå› ä¸ºæŸäº›ç±»çš„å›¾åƒæ˜¯ç³Ÿç³•çš„ï¼Œå¹¶ä¸”ä¸ä¼šå¯¹æˆ‘ä»¬çš„æ¨¡å‹æœ‰å¥½å¤„ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ç±»å°†æ˜¯æ„¤æ€’ã€å¿«ä¹ã€æ‚²ä¼¤å’ŒæƒŠè®¶çš„ã€‚</p><p id="c44c" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">è®©æˆ‘ä»¬å»æ‰ä¸€äº›æˆ‘ä»¬ä¸ä¼šç”¨åˆ°çš„å€¼ã€‚</p><pre class="kr ks kt ku gt ld le lf lg aw lh bi"><span id="68ca" class="li lj in le b gy lk ll l lm ln">data = data[data["emotion"] != 1]</span><span id="c043" class="li lj in le b gy lo ll l lm ln">data = data[data["emotion"] != 2]</span><span id="e9b8" class="li lj in le b gy lo ll l lm ln">data = data[data["emotion"] != 6]</span><span id="8f6d" class="li lj in le b gy lo ll l lm ln">data["emotion"].value_counts().reset_index(drop=True, inplace=True)</span></pre><p id="6ac1" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">æ‰€ä»¥ï¼Œè®©æˆ‘ä»¬æŠŠæ•°æ®åˆ†æˆ X å’Œ yã€‚</p><pre class="kr ks kt ku gt ld le lf lg aw lh bi"><span id="053b" class="li lj in le b gy lk ll l lm ln"># Split data into X &amp; y</span><span id="da7f" class="li lj in le b gy lo ll l lm ln">X = data.drop("emotion", axis=1)</span><span id="753d" class="li lj in le b gy lo ll l lm ln">y = data["emotion"]</span><span id="bb5c" class="li lj in le b gy lo ll l lm ln"># Concat train sets into one</span><span id="88f3" class="li lj in le b gy lo ll l lm ln">df = pd.concat([X, y], axis=1)</span></pre><p id="4a76" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">ä¸‹ä¸€æ­¥æ˜¯å¤„ç†æˆ‘ä»¬çš„å›¾åƒï¼Œå› ä¸ºå®ƒä»¬æ˜¯å­—ç¬¦ä¸²æ ¼å¼ã€‚</p><pre class="kr ks kt ku gt ld le lf lg aw lh bi"><span id="09ec" class="li lj in le b gy lk ll l lm ln">def pixels_to_array(pixels):</span><span id="7a67" class="li lj in le b gy lo ll l lm ln">array = np.array(pixels.split(),'float64')</span><span id="2e3a" class="li lj in le b gy lo ll l lm ln">return array<br/></span><span id="6968" class="li lj in le b gy lo ll l lm ln">df['pixels'] = df["pixels"].apply(pixels_to_array)</span></pre><p id="10b6" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">å°†æ•°æ®åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†ã€‚</p><pre class="kr ks kt ku gt ld le lf lg aw lh bi"><span id="731d" class="li lj in le b gy lk ll l lm ln">data_train = df[df["Usage"] == "Training"]</span><span id="2945" class="li lj in le b gy lo ll l lm ln">data_test1 = df[df["Usage"] == "PublicTest"]</span><span id="9a13" class="li lj in le b gy lo ll l lm ln">data_test2 = df[df["Usage"] == "PrivateTest"]</span><span id="d5a6" class="li lj in le b gy lo ll l lm ln">data_test = pd.concat([data_test1, data_test2])</span></pre><p id="fe31" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">ç„¶åï¼Œæˆ‘ä»¬å°†é‡å¡‘æˆ‘ä»¬çš„å›¾åƒï¼Œæˆä¸º RGB æ ¼å¼å’Œå½¢çŠ¶(48ï¼Œ48ï¼Œ3)ã€‚</p><pre class="kr ks kt ku gt ld le lf lg aw lh bi"><span id="ab10" class="li lj in le b gy lk ll l lm ln">def image_reshape(data):</span><span id="1c43" class="li lj in le b gy lo ll l lm ln">image = np.reshape(data.to_list(),(data.shape[0],48,48,1))</span><span id="1d35" class="li lj in le b gy lo ll l lm ln">image = np.repeat(image, 3, -1)</span><span id="4255" class="li lj in le b gy lo ll l lm ln">return image<br/></span><span id="ebca" class="li lj in le b gy lo ll l lm ln">X_train = image_reshape(data_train["pixels"])</span><span id="33c8" class="li lj in le b gy lo ll l lm ln">X_test = image_reshape(data_test["pixels"])</span><span id="1a34" class="li lj in le b gy lo ll l lm ln">y_train = data_train["emotion"]</span><span id="488b" class="li lj in le b gy lo ll l lm ln">y_test = data_test["emotion"]</span></pre><p id="c432" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">å°†ç±»åè®¾ç½®ä¸ºå˜é‡:</p><pre class="kr ks kt ku gt ld le lf lg aw lh bi"><span id="53f5" class="li lj in le b gy lk ll l lm ln">class_names = ["Angry", "Happy", "Sad", "Surprise"]</span></pre><p id="e141" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦è§£å†³å¦ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºæˆ‘ä»¬ä¸¢å¼ƒäº†ä¸€äº›æƒ…ç»ªï¼Œæˆ‘ä»¬æƒ…ç»ªçš„å€¼æ˜¯è¿ç»­çš„ï¼Œå®ƒä»¬ç°åœ¨æ˜¯è¿™æ ·çš„â€œ0ï¼Œ3ï¼Œ5ï¼Œ7â€ã€‚è¿™å°†æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨ä¸‹ä¸€æ­¥ï¼Œå½“æˆ‘ä»¬å¾—åˆ°å›¾åƒï¼Œå¹¶æŠŠå®ƒä»¬æ”¾å…¥å„è‡ªçš„ç›®å½•ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><pre class="kr ks kt ku gt ld le lf lg aw lh bi"><span id="ea97" class="li lj in le b gy lk ll l lm ln"># Do the same for y_test<br/>for i in range(len(y_train)):</span><span id="3edd" class="li lj in le b gy lo ll l lm ln">if y_train[i] == 3:</span><span id="1667" class="li lj in le b gy lo ll l lm ln">y_train[i] = 1</span><span id="3380" class="li lj in le b gy lo ll l lm ln">elif y_train[i] == 4:</span><span id="502a" class="li lj in le b gy lo ll l lm ln">y_train[i] = 2</span><span id="1ce8" class="li lj in le b gy lo ll l lm ln">elif y_train[i] == 5:</span><span id="1da9" class="li lj in le b gy lo ll l lm ln">y_train[i] = 3</span><span id="4ff1" class="li lj in le b gy lo ll l lm ln">for label in range(len(classes)):</span><span id="ca04" class="li lj in le b gy lo ll l lm ln">os.makedirs("/content/data/train/" + classes[label], exist_ok=True)</span><span id="d33c" class="li lj in le b gy lo ll l lm ln">os.makedirs("/content/data/test/" + classes[label], exist_ok=True)<br/></span><span id="3976" class="li lj in le b gy lo ll l lm ln">for i in range(len(X_train)):</span><span id="e236" class="li lj in le b gy lo ll l lm ln">emotion = classes[y_train[i]]</span><span id="68ef" class="li lj in le b gy lo ll l lm ln">cv2.imwrite(f"/content/data/train/{emotion}/{emotion}{i}.png", X_train[i])</span><span id="96b7" class="li lj in le b gy lo ll l lm ln">for j in range(len(X_test)):</span><span id="2ec7" class="li lj in le b gy lo ll l lm ln">emotion = classes[y_test[j]]</span><span id="236e" class="li lj in le b gy lo ll l lm ln">cv2.imwrite(f"/content/data/test/{emotion}/{emotion}{j}.png", X_test[j])</span></pre><p id="5200" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">æˆ‘ä»¬æ¥ä¸‹æ¥çš„æ­¥éª¤å¾ˆé‡è¦ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†æ ‡å‡†åŒ–æˆ‘ä»¬çš„æ•°æ®(å°†å€¼è½¬æ¢ä¸º 0 åˆ° 1 ä¹‹é—´çš„å€¼)ï¼Œè¿™æœ‰åŠ©äºæˆ‘ä»¬çš„æ¨¡å‹æ›´å¥½åœ°å­¦ä¹ å’Œæ‰§è¡Œã€‚å…¶æ¬¡ï¼Œæ‰§è¡Œä¸€äº›æ•°æ®æ‰©å……(é€šè¿‡å¯¹ç°æœ‰æ•°æ®è¿›è¡Œç»†å¾®çš„æ›´æ”¹æ¥æ·»åŠ æ›´å¤šæ•°æ®çš„æŠ€æœ¯)ã€‚æœ€åï¼Œä½†ä»ç„¶é‡è¦çš„æ˜¯ï¼Œå°†æˆ‘ä»¬çš„æ•°æ®åˆ†æ‰¹è½¬æ¢(åŸºæœ¬ä¸Šå°†æˆ‘ä»¬çš„æ•°æ®åˆ†æˆ<strong class="jt io">ç»„</strong>ï¼Œä»¥ä¾¿æˆ‘ä»¬çš„æ¨¡å‹æƒé‡ä»…åœ¨æ¯ä¸ª<strong class="jt io">ç»„</strong>ä¹‹åæ›´æ–°)ã€‚</p><pre class="kr ks kt ku gt ld le lf lg aw lh bi"><span id="993b" class="li lj in le b gy lk ll l lm ln">from tensorflow.keras.preprocessing.image import ImageDataGenerator</span><span id="813d" class="li lj in le b gy lo ll l lm ln">IMAGE_SHAPE = (48, 48)</span><span id="d108" class="li lj in le b gy lo ll l lm ln">BATCH_SIZE = 64</span><span id="e55d" class="li lj in le b gy lo ll l lm ln">train_dir = "/content/data/train/"</span><span id="16d5" class="li lj in le b gy lo ll l lm ln">test_dir =  "/content/data/test/"</span><span id="97ef" class="li lj in le b gy lo ll l lm ln">train_datagen = ImageDataGenerator(rescale=1/255.,</span><span id="33e6" class="li lj in le b gy lo ll l lm ln">rotation_range=0.1,</span><span id="3dfe" class="li lj in le b gy lo ll l lm ln">zoom_range=0.1)</span><span id="6e10" class="li lj in le b gy lo ll l lm ln">test_datagen = ImageDataGenerator(rescale=1/255.)<br/></span><span id="5f7a" class="li lj in le b gy lo ll l lm ln">train_data = train_datagen.flow_from_directory(train_dir,</span><span id="43a9" class="li lj in le b gy lo ll l lm ln">target_size=IMAGE_SHAPE,</span><span id="275e" class="li lj in le b gy lo ll l lm ln">batch_size=BATCH_SIZE,</span><span id="1c25" class="li lj in le b gy lo ll l lm ln">class_mode="categorical",</span><span id="bd00" class="li lj in le b gy lo ll l lm ln">shuffle=True)</span><span id="6c72" class="li lj in le b gy lo ll l lm ln">test_data = test_datagen.flow_from_directory(test_dir,</span><span id="f3cd" class="li lj in le b gy lo ll l lm ln">target_size=IMAGE_SHAPE,</span><span id="ee41" class="li lj in le b gy lo ll l lm ln">batch_size=BATCH_SIZE,</span><span id="c0b4" class="li lj in le b gy lo ll l lm ln">class_mode="categorical")</span></pre><p id="d247" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">è®©æˆ‘ä»¬æƒ³è±¡ä¸€ä¸‹æˆ‘ä»¬çš„ç«è½¦åœºæ™¯ä¸­çš„ä¸€ä¸ªå›¾åƒ:</p><figure class="kr ks kt ku gt jo gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/cdb1cfadb50bfa94cff5aae4fba94859.png" data-original-src="https://miro.medium.com/v2/resize:fit:96/format:webp/1*sRXfgvAsJ0LFOpK3Sa1jVw.png"/></div></figure><p id="49f5" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">æˆ‘ä»¬åšäº†æ‰€æœ‰éœ€è¦çš„æ•°æ®å¤„ç†ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬å»ºç«‹æˆ‘ä»¬çš„æ¨¡å‹ã€‚ç»è¿‡ä¸€äº›æµ‹è¯•ï¼Œè¿™ç§æ¶æ„è¾¾åˆ°äº†æœ€ä½³æ•ˆæœ:</p><pre class="kr ks kt ku gt ld le lf lg aw lh bi"><span id="642f" class="li lj in le b gy lk ll l lm ln"># Import packages</span><span id="a3f6" class="li lj in le b gy lo ll l lm ln">import tensorflow as tf</span><span id="c5bf" class="li lj in le b gy lo ll l lm ln">from tensorflow.keras import Sequential</span><span id="2a33" class="li lj in le b gy lo ll l lm ln">from tensorflow.keras.callbacks import ReduceLROnPlateau</span><span id="fd14" class="li lj in le b gy lo ll l lm ln">from tensorflow.keras.layers import BatchNormalization<br/></span><span id="823a" class="li lj in le b gy lo ll l lm ln">tf.random.set_seed(42)</span><span id="0c0e" class="li lj in le b gy lo ll l lm ln"># Create the model</span><span id="cd0f" class="li lj in le b gy lo ll l lm ln">model_1 = Sequential([</span><span id="6547" class="li lj in le b gy lo ll l lm ln">tf.keras.layers.Input(shape=(48, 48, 3)),</span><span id="18ff" class="li lj in le b gy lo ll l lm ln">tf.keras.layers.Conv2D(512, (3,3), activation="relu", padding="same"),</span><span id="18e3" class="li lj in le b gy lo ll l lm ln">BatchNormalization(),</span><span id="9252" class="li lj in le b gy lo ll l lm ln">tf.keras.layers.Conv2D(256, (3,3), activation="relu", padding="same"),</span><span id="07c1" class="li lj in le b gy lo ll l lm ln">BatchNormalization(),</span><span id="52fe" class="li lj in le b gy lo ll l lm ln">tf.keras.layers.MaxPool2D(2),</span><span id="0053" class="li lj in le b gy lo ll l lm ln">tf.keras.layers.Dropout(0.5),</span><span id="f674" class="li lj in le b gy lo ll l lm ln">tf.keras.layers.Conv2D(128, (3,3), activation="relu", padding="same"),</span><span id="19cd" class="li lj in le b gy lo ll l lm ln">BatchNormalization(),</span><span id="7e4f" class="li lj in le b gy lo ll l lm ln">tf.keras.layers.Conv2D(64, (3,3), activation="relu", padding="same"),</span><span id="eaff" class="li lj in le b gy lo ll l lm ln">BatchNormalization(),</span><span id="ae9a" class="li lj in le b gy lo ll l lm ln">tf.keras.layers.MaxPool2D(2),</span><span id="b7ef" class="li lj in le b gy lo ll l lm ln">tf.keras.layers.Dropout(0.5),</span><span id="e81a" class="li lj in le b gy lo ll l lm ln">tf.keras.layers.Conv2D(32, (3,3), activation="relu", padding="same"),</span><span id="52ed" class="li lj in le b gy lo ll l lm ln">tf.keras.layers.MaxPool2D(2),</span><span id="2bc2" class="li lj in le b gy lo ll l lm ln">tf.keras.layers.Dropout(0.5),</span><span id="3e1a" class="li lj in le b gy lo ll l lm ln">tf.keras.layers.Flatten(),</span><span id="5fb9" class="li lj in le b gy lo ll l lm ln">tf.keras.layers.Dense(4, activation="softmax")</span><span id="63bc" class="li lj in le b gy lo ll l lm ln">])</span></pre><p id="b32b" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">ç¼–è¯‘å’Œè®­ç»ƒæˆ‘ä»¬çš„æ¨¡å‹ã€‚</p><pre class="kr ks kt ku gt ld le lf lg aw lh bi"><span id="58b6" class="li lj in le b gy lk ll l lm ln"># Compile the model</span><span id="3784" class="li lj in le b gy lo ll l lm ln">model_1.compile(loss="categorical_crossentropy",</span><span id="2c10" class="li lj in le b gy lo ll l lm ln">optimizer=tf.keras.optimizers.Adam(),</span><span id="ec48" class="li lj in le b gy lo ll l lm ln">metrics=["accuracy"])</span><span id="3ab6" class="li lj in le b gy lo ll l lm ln">checkpoint_callback = tf.keras.callbacks.ModelCheckpoint(filepath="checkpoint/",</span><span id="1add" class="li lj in le b gy lo ll l lm ln">save_weights_only=False,</span><span id="c306" class="li lj in le b gy lo ll l lm ln">save_best_only=True,</span><span id="cb1a" class="li lj in le b gy lo ll l lm ln">save_freq="epoch",</span><span id="491e" class="li lj in le b gy lo ll l lm ln">verbose=1)</span><span id="3e1f" class="li lj in le b gy lo ll l lm ln">reduce_lr = ReduceLROnPlateau(monitor='val_accuracy', factor=0.2,</span><span id="96fb" class="li lj in le b gy lo ll l lm ln">patience=8, min_lr=0.00001)</span><span id="aa90" class="li lj in le b gy lo ll l lm ln"># Fit the model</span><span id="58a8" class="li lj in le b gy lo ll l lm ln">model_1.fit(train_data, epochs=80, callbacks=[reduce_lr, checkpoint_callback], validation_data=test_data)</span></pre><p id="dde7" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">å¯¹äºè®­ç»ƒé›†ï¼Œæˆ‘ä»¬å¾—åˆ°äº†å¤§çº¦ 83%çš„ ACCï¼Œå¯¹äºæµ‹è¯•é›†ï¼Œæˆ‘ä»¬å¾—åˆ°äº†å¤§çº¦ 79%çš„ ACCï¼Œè€ƒè™‘åˆ°æˆ‘ä»¬çš„å›¾åƒå­˜åœ¨çš„ä¸€äº›é—®é¢˜ï¼Œè¿™å·²ç»ç›¸å½“ä¸é”™äº†ï¼Œæ¯”å¦‚:<br/> -æ°´å°<br/> -ä¸€äº›å›¾åƒç”¨æ•°å­—å­—ç¬¦(ä¸æ˜¯äºº)<br/> -å°‘é‡æ•°æ®ã€‚ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥æœç´¢å…¶ä»–ç”¨äºé¢éƒ¨æƒ…æ„Ÿè¯†åˆ«çš„æ•°æ®é›†ï¼Œåˆ é™¤ä¸€äº›ä¸å¥½çš„å›¾åƒï¼Œæˆ–è€…æ·»åŠ æˆ‘ä»¬å¯ä»¥åœ¨æŸä¸ªåœ°æ–¹è·å¾—çš„å›¾åƒã€‚</p><p id="3852" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">å› æ­¤ï¼Œæˆ‘ä»¬åˆ†ææˆ‘ä»¬çš„æ•°æ®ï¼Œå¤„ç†å®ƒï¼Œæ‰§è¡Œå»ºæ¨¡å’Œè®­ç»ƒã€‚ä¸‹ä¸€æ­¥æ˜¯ä»€ä¹ˆï¼Ÿçœ‹åˆ°ç°å®ç”Ÿæ´»ä¸­çš„ç»“æœï¼Œæœ€ç²¾å½©çš„éƒ¨åˆ†â€¦</p><div class="kr ks kt ku gt ab cb"><figure class="lq jo lr ls lt lu lv paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><img src="../Images/4bac960f091336bf37838a89c0fd7db9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*tpASb2lfZ-WhRkORBmK78g.png"/></div></figure><figure class="lq jo lw ls lt lu lv paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><img src="../Images/830e6745591894a4f95cf0692f212eee.png" data-original-src="https://miro.medium.com/v2/resize:fit:930/format:webp/1*FN-QBfOVEvMC6eDsYwQyHA.png"/></div></figure></div><div class="ab cb"><figure class="lq jo lx ls lt lu lv paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><img src="../Images/1acfd287bb957958adb69c856a3ccb4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*_fx6gScmk6dUFuzK8jbXjQ.png"/></div></figure><figure class="lq jo ly ls lt lu lv paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><img src="../Images/a37f4194aaec1cb16d1f176349825045.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*JAR0xQt3_w8l4FsJH6EIFQ.png"/></div></figure></div><p id="607a" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">å¯¹æˆ‘æ¥è¯´ï¼ŒI.A æœ€ä»¤äººå…´å¥‹çš„éƒ¨åˆ†æ˜¯æ·±åº¦å­¦ä¹ ï¼Œæ‰€ä»¥åšè¿™ä¸ªå…³äºé¢éƒ¨è¡¨æƒ…è¯†åˆ«çš„å°é¡¹ç›®éå¸¸é…·ï¼Œæˆ‘å­¦åˆ°äº†å¾ˆå¤šä¸œè¥¿ã€‚</p><p id="929e" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">å¦‚æœä½ æœ‰ä»»ä½•åé¦ˆï¼Œæƒ³è°ˆè°ˆï¼Œæˆ–è€…åªæ˜¯è·Ÿéšæˆ‘åœ¨è¿™ä¸ªæ—…ç¨‹ä¸­ï¼Œæˆ‘ä¼šè®©æˆ‘çš„ LinkedIn å’Œé‚£äº›æƒ³çœ‹å®Œæ•´ä»£ç çš„äººï¼Œæˆ‘çš„ GitHub åœ¨ä¸‹é¢ğŸ˜</p><p id="84b7" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">é¢†è‹±:<a class="ae kp" href="https://www.linkedin.com/in/joaopdss/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/joaopdss/</a></p><p id="05bf" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">GitHub:<a class="ae kp" href="https://github.com/joaopdss" rel="noopener ugc nofollow" target="_blank">https://github.com/joaopdss</a></p></div></div>    
</body>
</html>