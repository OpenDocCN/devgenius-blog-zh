<html>
<head>
<title>Part Two: Dockerizing for production a TypeScript React App with NGINX using WSL2 Alpine Linux on Windows 10</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">第二部分:Dockerizing for production 在 Windows 10 上使用 WSL2 Alpine Linux，使用 NGINX 开发一个 TypeScript React 应用程序</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/part-two-dockerizing-for-production-a-typescript-react-app-with-nginx-with-wsl2-alpine-linux-on-85660be3956?source=collection_archive---------2-----------------------#2022-11-27">https://blog.devgenius.io/part-two-dockerizing-for-production-a-typescript-react-app-with-nginx-with-wsl2-alpine-linux-on-85660be3956?source=collection_archive---------2-----------------------#2022-11-27</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="012f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">1.0 版本<br/>日期 2022/11/27 <br/>作者 Nicolas Barlatier</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/71bcac04a9b3c009247b48faa0cf9a56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AwKRB4QAcWIHTkw4X5JKYA.png"/></div></div></figure><p id="2376" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">大家好，我希望你们一切都好。在我们现在生活的艰难时期，你是安全的。</p><h1 id="6bb5" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">介绍</h1><p id="2f7c" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">今天，我将向您展示如何为生产构建<strong class="jm io">React 应用程序容器。</strong></p><p id="3b0a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">再读最后一句，是关于<strong class="jm io">造一个生产就绪的容器</strong>。<br/>它不是关于构建一个生产就绪的 react 应用程序，其中我们使用了前端 web 应用程序的最佳实践和安全性。</p><p id="840c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我将在以后写一篇文章，介绍使用 React 制作生产就绪的前端 web 应用程序的最佳实践。</p><p id="7af2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上一篇文章中，我展示了如何在开发机器上构建和运行与本地 React 应用程序代码库同步的容器。</p><p id="1a65" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你想看，就在下面:</p><p id="fbac" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae lx" href="https://medium.com/@barlatiernicolas/dockerizing-the-typescript-react-app-with-nodejs-vs-nginx-with-wsl2-alpine-linux-on-windows-10-8dddd447f43a" rel="noopener">第一部分在 Windows 10 上用 NodeJS 与 NGINX 对接 TypeScript React 应用程序与 wsl 2 Alpine Linux</a></p><p id="d7af" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">React 应用程序由 JWT 和 Keycloak 保护。</p><p id="e1d5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你可以分四部分阅读这篇文章:</p><p id="5b12" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae lx" href="https://medium.com/p/1d076777a979" rel="noopener">第一部分:用 Docker 和 Administration 安装 key cloak</a></p><p id="4bf0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae lx" href="https://medium.com/@barlatiernicolas/security-in-react-and-webapi-in-asp-net-core-c-with-authentification-and-authorization-by-keycloak-89ba14be7e5a" rel="noopener">第二部分:保护前端 React 应用</a></p><p id="c067" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae lx" href="https://medium.com/@barlatiernicolas/security-in-react-and-webapi-in-asp-net-core-c-with-authentification-and-authorization-by-keycloak-f890d340d093" rel="noopener">第三部分:保护 ASP.NET 核心 C# REST Web </a></p><p id="176b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae lx" href="https://medium.com/@barlatiernicolas/part-four-security-in-react-and-webapi-in-asp-net-b6dffd3b7624" rel="noopener">第四部分:使用访问 JWT 令牌载体授权从 React SPA 调用受保护的 Web API</a></p><p id="d16e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们的项目可以在 GitHub 的子目录<a class="ae lx" href="https://github.com/nicoclau/reactwebapiaspnetcorekeycloak/tree/main/reactwebapikeycloak" rel="noopener ugc nofollow" target="_blank">reactwebapikeycoap</a>中找到</p><div class="ly lz gp gr ma mb"><a href="https://github.com/nicoclau/reactwebapiaspnetcorekeycloak" rel="noopener  ugc nofollow" target="_blank"><div class="mc ab fo"><div class="md ab me cl cj mf"><h2 class="bd io gy z fp mg fr fs mh fu fw im bi translated">GitHub-nicoclau/reactwebapiaspnetcorekeycloak:React 和 REST 受 keycloak 保护的 Web API 与…</h2><div class="mi l"><h3 class="bd b gy z fp mg fr fs mh fu fw dk translated">React 和 REST Web API 受 Keycloak 保护，带授权码流和 JWT 令牌- GitHub …</h3></div><div class="mj l"><p class="bd b dl z fp mg fr fs mh fu fw dk translated">github.com</p></div></div><div class="mk l"><div class="ml l mm mn mo mk mp ks mb"/></div></div></a></div><h1 id="4651" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">为什么我们在 Docker 容器中使用 NGINX 来托管生产中的 React 应用程序？</h1><p id="3c72" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">在行动之前，我们需要了解我们的选择。为什么我们要使用<strong class="jm io"> NGINX </strong>来托管我们为生产而构建的 React 应用程序？为什么呢？</p><p id="f8f0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">React 是一个开源的前端 JavaScript 库，它最终构建了静态资产。所以我们需要一个服务器来服务他们。</p><p id="b958" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将看到为什么 NGINX 发音的 Engine-X 如此受欢迎，并且几乎总是在生产中部署一个 React 应用程序时使用。</p><p id="b935" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">当我仔细思考这个问题时，我认为可用的主要解决方案有:</p><ul class=""><li id="15b1" class="mq mr in jm b jn jo jr js jv ms jz mt kd mu kh mv mw mx my bi translated">NGINX</li><li id="f13d" class="mq mr in jm b jn mz jr na jv nb jz nc kd nd kh mv mw mx my bi translated">表达</li><li id="4fa9" class="mq mr in jm b jn mz jr na jv nb jz nc kd nd kh mv mw mx my bi translated"><a class="ae lx" href="https://github.com/vercel/serve" rel="noopener ugc nofollow" target="_blank">发球</a>由维尔塞尔发球</li></ul><p id="6ad1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">此外，<a class="ae lx" href="https://create-react-app.dev/" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> Create React App </strong> </a>的官方网站上关于如何在生产上部署我们的 React 应用程序的链接建议使用像 Serve 或 use Express 这样的静态服务器。</p><div class="ly lz gp gr ma mb"><a href="https://create-react-app.dev/docs/deployment/" rel="noopener  ugc nofollow" target="_blank"><div class="mc ab fo"><div class="md ab me cl cj mf"><h2 class="bd io gy z fp mg fr fs mh fu fw im bi translated">部署|创建 React 应用</h2><div class="mi l"><h3 class="bd b gy z fp mg fr fs mh fu fw dk translated">npm 运行构建创建一个包含应用程序生产版本的构建目录。设置您最喜欢的 HTTP 服务器，以便…</h3></div><div class="mj l"><p class="bd b dl z fp mg fr fs mh fu fw dk translated">创建-反应-应用程序.开发</p></div></div><div class="mk l"><div class="ne l mm mn mo mk mp ks mb"/></div></div></a></div><p id="531d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">但老实说，当它要在产品上使用我们的 React 应用程序时，我们需要的不仅仅是交付静态内容的更多功能，如认证、授权、负载平衡，</p><p id="d62c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">此外，它是最快的，低于基准测试，表明对于一台资源较少的服务器，Nginx 每秒处理的请求要多得多:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/71c8c8d6206fc6c68624ffb3c94721a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UkyvUdLfzhMGhv0A.jpg"/></div></div></figure><p id="7227" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">它使用更少的内存:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/5b472bd56d4ce9be6b718bc67b7f3900.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NepEiIiTKgUdR1kn.jpg"/></div></div></figure><p id="438b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">同样，让我们比较 NGINX 的使用和其他技术</p><div class="ly lz gp gr ma mb"><a href="https://www.wappalyzer.com/compare/nginx-vs-express" rel="noopener  ugc nofollow" target="_blank"><div class="mc ab fo"><div class="md ab me cl cj mf"><h2 class="bd io gy z fp mg fr fs mh fu fw im bi translated">瓦帕里斯</h2><div class="mi l"><h3 class="bd b gy z fp mg fr fs mh fu fw dk translated">编辑描述</h3></div><div class="mj l"><p class="bd b dl z fp mg fr fs mh fu fw dk translated">www.wappalyzer.com</p></div></div></div></a></div><div class="ly lz gp gr ma mb"><a href="https://www.wappalyzer.com/compare/nginx-vs-varnish/" rel="noopener  ugc nofollow" target="_blank"><div class="mc ab fo"><div class="md ab me cl cj mf"><h2 class="bd io gy z fp mg fr fs mh fu fw im bi translated">瓦帕里斯</h2><div class="mi l"><h3 class="bd b gy z fp mg fr fs mh fu fw dk translated">编辑描述</h3></div><div class="mj l"><p class="bd b dl z fp mg fr fs mh fu fw dk translated">www.wappalyzer.com</p></div></div></div></a></div><div class="ly lz gp gr ma mb"><a href="https://www.wappalyzer.com/compare/nginx-vs-lightspeed-ecom/" rel="noopener  ugc nofollow" target="_blank"><div class="mc ab fo"><div class="md ab me cl cj mf"><h2 class="bd io gy z fp mg fr fs mh fu fw im bi translated">瓦帕里斯</h2><div class="mi l"><h3 class="bd b gy z fp mg fr fs mh fu fw dk translated">编辑描述</h3></div><div class="mj l"><p class="bd b dl z fp mg fr fs mh fu fw dk translated">www.wappalyzer.com</p></div></div></div></a></div><p id="d01d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们马上就能看到 NGINX 比其他的使用得更频繁。</p><p id="ff96" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">所以现在我们确信并理解了为什么要用 NGINX 来部署 React。</p><p id="7697" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将使用 Docker 做两件事:</p><ul class=""><li id="bfa1" class="mq mr in jm b jn jo jr js jv ms jz mt kd mu kh mv mw mx my bi translated">构建我们的生产反应应用程序</li><li id="6c54" class="mq mr in jm b jn mz jr na jv nb jz nc kd nd kh mv mw mx my bi translated">在 Nginx 容器中托管我们的 production react 应用程序</li></ul><p id="b72f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">生产反应应用的 Docker 文件:</strong></p><p id="20e2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">它将分为两个部分:</p><ul class=""><li id="975c" class="mq mr in jm b jn jo jr js jv ms jz mt kd mu kh mv mw mx my bi translated">建筑物</li><li id="8f73" class="mq mr in jm b jn mz jr na jv nb jz nc kd nd kh mv mw mx my bi translated">主办；主持</li></ul><p id="7ef2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将调用 docker 文件:dockerfileprod，并将内容:</p><pre class="kj kk kl km gt ng nh ni bn nj nk bi"><span id="583b" class="nl kv in nh b be nm nn l no np"># building<br/><br/>FROM node:19-alpine3.15 AS builder<br/>ENV NODE_ENV production<br/># Add a work directory<br/>WORKDIR /app<br/># Cache and Install dependencies<br/>COPY package.json .<br/>COPY package-lock.json .<br/>RUN npm install --production<br/># Copy app files<br/>COPY . .<br/># Build the app<br/>RUN npm run build<br/><br/># hosting<br/><br/># Bundle static assets with nginx<br/>FROM nginx:1.23-alpine as production<br/>ENV NODE_ENV production<br/># Copy built assets from builder<br/>COPY --from=builder /app/build /usr/share/nginx/html<br/># Add your nginx.conf<br/>COPY nginx.conf /etc/nginx/conf.d/default.conf<br/># Expose port<br/>EXPOSE 80<br/># Start nginx<br/>CMD ["nginx", "-g", "daemon off;"]</span></pre><p id="ac5d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">注意:我使用 npm，但是你可以更新 docker 文件来使用 yarn。</p><p id="ab78" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们使用 alpine 发行版的 node sdk 来构建我们的 production react 应用程序。</p><p id="621a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">然后我们在 alpine 发行版中使用 nginx，尽可能做到最轻。<br/>我们将 production react 应用程序复制到 nginx 使用的目录中。<br/>我们将现在要创建的配置文件 nginx.conf 复制到 nginx 使用的目录中。</p><p id="26e8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">最后，我们给出了用 docker 运行应用程序映像时 docker 容器使用的命令。</p><p id="b1f6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们添加 nginx.conf 文件:</p><pre class="kj kk kl km gt ng nh ni bn nj nk bi"><span id="e4c7" class="nl kv in nh b be nm nn l nq np">server {<br/>  listen 80;<br/><br/>  location / {<br/>    root /usr/share/nginx/html/;<br/>    include /etc/nginx/mime.types;<br/>    try_files $uri $uri/ /index.html;<br/>  }<br/>}</span></pre><p id="d03d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">非常简单，只有最后一行是 interresting，它说当 url 与任何资源都不匹配时，我们转到 root /index.html。它将由 react 路由器处理:)</p><p id="d53d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们看看我们的项目目录结构。</p><pre class="kj kk kl km gt ng nh ni bn nj nk bi"><span id="ffec" class="nl kv in nh b be nm nn l no np">λ tree /f<br/>Folder PATH listing for volume OS<br/>Volume serial number is C0000100 8021:2C9C<br/>C:.<br/>│   .dockerignore<br/>│   .gitignore<br/>│   Dockerfile<br/>│   dockerfileprod<br/>│   nginx.conf<br/>│   package-lock.json<br/>│   package.json<br/>│   README.md<br/>│   tsconfig.json<br/>│<br/>├───public<br/>│       favicon.ico<br/>│       index.html<br/>│       keycloak.json<br/>│       logo192.png<br/>│       logo512.png<br/>│       manifest.json<br/>│       robots.txt<br/>│<br/>└───src<br/>    │   App.css<br/>    │   App.test.tsx<br/>    │   App.tsx<br/>    │   index.css<br/>    │   index.tsx<br/>    │   logo.svg<br/>    │   react-app-env.d.ts<br/>    │   reportWebVitals.ts<br/>    │   setupTests.ts<br/>    │<br/>    ├───security<br/>    │       KeyCloakService.tsx<br/>    │<br/>    └───services<br/>            HttpServices.ts</span></pre><p id="cd4c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在让我们构建我们的容器映像，安装所有的依赖项需要一些时间。</p><pre class="kj kk kl km gt ng nh ni bn nj nk bi"><span id="bfbf" class="nl kv in nh b be nm nn l no np">C:\Tutorial\keycloak\reactwebapikeycloak\reactonlywithkeycloak\myapp (main -&gt; origin)<br/>λ docker build -f dockerfileprod -t myreactnginx:1 .<br/>[+] Building 115.4s (16/16) FINISHED<br/> =&gt; [internal] load build definition from dockerfileprod                                                                                                                                                                                 0.1s  =&gt; =&gt; transferring dockerfile: 36B                                                                                                                                                                                                      0.0s  =&gt; [internal] load .dockerignore                                                                                                                                                                                                        0.1s  =&gt; =&gt; transferring context: 35B                                                                                                                                                                                                         0.0s  =&gt; [internal] load metadata for docker.io/library/nginx:1.23-alpine                                                                                                                                                                     0.7s  =&gt; [internal] load metadata for docker.io/library/node:19-alpine3.15                                                                                                                                                                    0.9s  =&gt; [builder 1/7] FROM docker.io/library/node:19-alpine3.15@sha256:8d87f28bd6f8a6c717e0be1defc297b22672b79820c83a7087a80548fa13d2b4                                                                                                      0.0s  =&gt; [internal] load build context                                                                                                                                                                                                        0.1s  =&gt; =&gt; transferring context: 965B                                                                                                                                                                                                        0.0s  =&gt; CACHED [production 1/3] FROM docker.io/library/nginx:1.23-alpine@sha256:455c39afebd4d98ef26dd70284aa86e6810b0485af5f4f222b19b89758cabf1e                                                                                             0.0s  =&gt; CACHED [builder 2/7] WORKDIR /app                                                                                                                                                                                                    0.0s  =&gt; [builder 3/7] COPY package.json .                                                                                                                                                                                                    0.2s  =&gt; [builder 4/7] COPY package-lock.json .                                                                                                                                                                                               0.3s  =&gt; [builder 5/7] RUN npm install --production                                                                                                                                                                                          92.8s  =&gt; [builder 6/7] COPY . .                                                                                                                                                                                                               0.1s  =&gt; [builder 7/7] RUN npm run build                                                                                                                                                                                                     19.9s  =&gt; [production 2/3] COPY --from=builder /app/build /usr/share/nginx/html                                                                                                                                                                0.1s  =&gt; [production 3/3] COPY nginx.conf /etc/nginx/conf.d/default.conf                                                                                                                                                                      0.1s  =&gt; exporting to image                                                                                                                                                                                                                   0.2s  =&gt; =&gt; exporting layers                                                                                                                                                                                                                  0.2s  =&gt; =&gt; writing image sha256:6e6ceb15aa23c2d92a540a1493494ed2129c56ad0701c6fa889c09a7881d660b                                                                                                                                             0.0s  =&gt; =&gt; naming to docker.io/library/myreactnginx:1                                                                                                                                                                                        0.0s<br/>.....<br/>Use 'docker scan' to run Snyk tests against images to find vulnerabilities and learn how to fix them</span></pre><p id="226f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">第一次花了 2 分钟，但下一次我们在缓存层的帮助下只需要 20 秒。</p><p id="b7eb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们检查一下我们的容器图像:</p><pre class="kj kk kl km gt ng nh ni bn nj nk bi"><span id="dd63" class="nl kv in nh b be nm nn l no np">λ docker images<br/>REPOSITORY    TAG               IMAGE ID       CREATED          SIZE<br/>myreactnginx  1                 6e6ceb15aa23   6 minutes ago    24.4MB</span></pre><p id="60ee" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">只有 24 Mb:)</p><p id="609e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，我们已经准备好运行托管在 Nginx 容器中的 production react 应用程序。</p><p id="38bc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要阅读关于如何运行 nginx 容器的文档，请访问:</p><div class="ly lz gp gr ma mb"><a href="https://docs.nginx.com/nginx/admin-guide/installing-nginx/installing-nginx-docker/" rel="noopener  ugc nofollow" target="_blank"><div class="mc ab fo"><div class="md ab me cl cj mf"><h2 class="bd io gy z fp mg fr fs mh fu fw im bi translated">在 Docker 上部署 NGINX 和 NGINX Plus</h2><div class="mi l"><h3 class="bd b gy z fp mg fr fs mh fu fw dk translated">将 NGINX 和 NGINX Plus 部署为 Docker 容器。NGINX Plus，高性能应用交付平台…</h3></div><div class="mj l"><p class="bd b dl z fp mg fr fs mh fu fw dk translated">docs.nginx.com</p></div></div><div class="mk l"><div class="nr l mm mn mo mk mp ks mb"/></div></div></a></div><p id="77d7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">主要命令是:</p><pre class="kj kk kl km gt ng nh ni bn nj nk bi"><span id="fc0c" class="nl kv in nh b be nm nn l no np">docker run --name mynginx1 -p 80:80 -d nginx</span></pre><p id="d518" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在我们的例子中，我们不使用端口 80，我们将使用端口 8081，我们的容器映像名是:myreactnginx:1</p><p id="00d4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">所以我们做到了:</p><pre class="kj kk kl km gt ng nh ni bn nj nk bi"><span id="12a0" class="nl kv in nh b be nm nn l no np">docker run --name myreactnginx -p 8081:80 -d myreactnginx:1</span></pre><p id="b7f8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们得到:</p><pre class="kj kk kl km gt ng nh ni bn nj nk bi"><span id="8fd7" class="nl kv in nh b be nm nn l no np"><br/>C:\Tutorial\keycloak\reactwebapikeycloak\reactonlywithkeycloak\myapp (main -&gt; origin)<br/>λ docker run --name myreactnginx -p 8081:80 -d myreactnginx:1<br/>9339c4b1b50498861c4401b27b7c78cd97879e8ebc0874b950b920e7fddefb8b</span></pre><p id="4768" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们检查一下我们的运行容器:</p><pre class="kj kk kl km gt ng nh ni bn nj nk bi"><span id="801f" class="nl kv in nh b be nm nn l no np">C:\Tutorial\keycloak\reactwebapikeycloak\reactonlywithkeycloak\myapp (main -&gt; origin)<br/>λ docker ps<br/>CONTAINER ID   IMAGE            COMMAND                  CREATED          STATUS          PORTS                  NAMES<br/>9339c4b1b504   myreactnginx:1   "/docker-entrypoint.…"   33 seconds ago   Up 32 seconds   0.0.0.0:8081-&gt;80/tcp   myreactnginx</span></pre><p id="4767" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们看到可以在端口 8081 上调用我们的应用程序，我们得到:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/be51b2fa142bee5cace7c7273e274699.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iDWEbhAobdncaBaLTxVaLQ.png"/></div></div></figure><p id="d644" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">请确保 keycloak 在端口 8080 上与 docker 一起运行:</p><pre class="kj kk kl km gt ng nh ni bn nj nk bi"><span id="6a95" class="nl kv in nh b be nm nn l no np">C:\Tutorial\keycloak\reactwebapikeycloak\reactonlywithkeycloak\myapp (main -&gt; origin)<br/>λ docker ps<br/>CONTAINER ID   IMAGE                              COMMAND                  CREATED          STATUS          PORTS                              NAMES<br/>e6cf7557d52e   quay.io/keycloak/keycloak:18.0.0   "/opt/keycloak/bin/k…"   8 minutes ago    Up 8 minutes    0.0.0.0:8080-&gt;8080/tcp, 8443/tcp   trusting_burnell<br/>9339c4b1b504   myreactnginx:1                     "/docker-entrypoint.…"   11 minutes ago   Up 11 minutes   0.0.0.0:8081-&gt;80/tcp               myreactnginx</span></pre><p id="e5ef" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果您需要关于 keycloak 和 react 的帮助，可以通过阅读我的文章的前两部分来找到:</p><div class="ly lz gp gr ma mb"><a href="https://systemweakness.com/security-in-react-and-webapi-in-asp-net-core-c-with-authentification-and-authorization-by-keycloak-1d076777a979" rel="noopener  ugc nofollow" target="_blank"><div class="mc ab fo"><div class="md ab me cl cj mf"><h2 class="bd io gy z fp mg fr fs mh fu fw im bi translated">第一部分:React 中的 Keycloak 和 ASP 中的 Web Api 的安全性。网</h2><div class="mi l"><h3 class="bd b gy z fp mg fr fs mh fu fw dk translated">第一部分:用 Docker 和 Administration 安装 Keycloak</h3></div><div class="mj l"><p class="bd b dl z fp mg fr fs mh fu fw dk translated">systemweakness.com</p></div></div><div class="mk l"><div class="nt l mm mn mo mk mp ks mb"/></div></div></a></div><div class="ly lz gp gr ma mb"><a rel="noopener  ugc nofollow" target="_blank" href="/security-in-react-and-webapi-in-asp-net-core-c-with-authentification-and-authorization-by-keycloak-89ba14be7e5a"><div class="mc ab fo"><div class="md ab me cl cj mf"><h2 class="bd io gy z fp mg fr fs mh fu fw im bi translated">ASP.NET 核心 C#中 React 和 WebApi 的安全性，通过 KeyCloak 进行身份验证和授权</h2><div class="mi l"><h3 class="bd b gy z fp mg fr fs mh fu fw dk translated">第二部分:确保前端 React 应用程序 1.0 版本的安全</h3></div><div class="mj l"><p class="bd b dl z fp mg fr fs mh fu fw dk translated">blog.devgenius.io</p></div></div><div class="mk l"><div class="nu l mm mn mo mk mp ks mb"/></div></div></a></div><p id="9d20" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">登录后，我们会看到:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/0bbbf12e74d97fae49ac80ade5ad6de0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k5IN8tpNyZH7OKErQhPRcA.png"/></div></div></figure><h1 id="f199" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">结论</h1><p id="c22e" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">恭喜您，现在您已经知道如何通过在您的定制容器映像中托管非常强大的 nginx 来构建 react 应用程序以用于生产了！</p><p id="4e36" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你需要帮助，或者有任何问题，请问我。如果你喜欢我的文章，你可以关注我并给我一些掌声:)</p></div></div>    
</body>
</html>