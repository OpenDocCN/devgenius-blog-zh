<html>
<head>
<title>Named Entity Recognition (NER)[NLP, Python]</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">命名实体识别(NER)[NLP，Python]</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/named-entity-recognition-ner-nlp-python-6504d5843f98?source=collection_archive---------3-----------------------#2022-03-28">https://blog.devgenius.io/named-entity-recognition-ner-nlp-python-6504d5843f98?source=collection_archive---------3-----------------------#2022-03-28</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/e6747a31fc85dc3e0bdf14163ec59b2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FkkQGcIAqYy5rij2qq5dpg.png"/></div></div></figure><p id="0d4d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">命名实体识别是信息抽取的子任务之一。NER 的主要目的是定位文档中的实体。实体可以是人名、地点名、组织名或任何其他特定的字符串，如日期、故事/文章的名称/数量、产品等等..</p><h2 id="49e3" class="kt ku in bd kv kw kx dn ky kz la dp lb kg lc ld le kk lf lg lh ko li lj lk ll bi translated"><strong class="ak">应用</strong>:</h2><ul class=""><li id="ad1b" class="lm ln in jx b jy lo kc lp kg lq kk lr ko ls ks lt lu lv lw bi translated">内容分类</li><li id="4b98" class="lm ln in jx b jy lx kc ly kg lz kk ma ko mb ks lt lu lv lw bi translated">Ques-Ans 发动机</li><li id="a777" class="lm ln in jx b jy lx kc ly kg lz kk ma ko mb ks lt lu lv lw bi translated">新闻/文章推荐</li><li id="56a9" class="lm ln in jx b jy lx kc ly kg lz kk ma ko mb ks lt lu lv lw bi translated">用于搜索引擎和许多其他…</li></ul><p id="25c6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">一种简单的实现方法是维护一个包含所有已知实体的字典，并进行查找(一种普通的分类器)。但是这里有一个问题…..<br/>假设“苹果股价正在上涨”,如果我们进行查找，我们可能会得到<em class="mc">苹果</em>作为<strong class="jx io">水果</strong>而不是<strong class="jx io">公司</strong>,如果我们不分析环境或考虑背景，这就是问题产生的原因。序列分类器怎么样..？</p><h2 id="0ece" class="kt ku in bd kv kw kx dn ky kz la dp lb kg lc ld le kk lf lg lh ko li lj lk ll bi translated">让我们使用 sklearn-crfsuite 实现我们自己的序列分类器</h2><p id="e4ed" class="pw-post-body-paragraph jv jw in jx b jy lo ka kb kc lp ke kf kg md ki kj kk me km kn ko mf kq kr ks ig bi translated">更好的方法是使用<strong class="jx io">序列分类器</strong>。序列分类是一个预测性的建模问题，在这个问题中，你在空间或时间上有一些输入序列，任务是预测这个序列的类别。</p><p id="ebff" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们实现我们的序列分类器—</p><p id="961b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">CRFs、HMM 是一些流行的序列分类算法。</p><p id="ec89" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们将使用开源序列标签库<strong class="jx io"> sklean-crfsuite </strong>以及标记化的文本(与句子顺序相同以保留上下文)和提供上下文信息的 pos 标签。我们将在 CONLL-03 数据集上训练它。下面是数据集的预览:</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="8394" class="kt ku in ml b gy mp mq l mr ms">EU NNP B-NP B-ORG<br/>rejects VBZ B-VP O<br/>German JJ B-NP B-MISC<br/>call NN I-NP O<br/>to TO B-VP O<br/>boycott VB I-VP O<br/>British JJ B-NP B-MISC<br/>lamb NN I-NP O<br/>. . O O</span><span id="23d0" class="kt ku in ml b gy mt mq l mr ms">Peter NNP B-NP B-PER<br/>Blackburn NNP I-NP I-PER</span><span id="178a" class="kt ku in ml b gy mt mq l mr ms">BRUSSELS NNP B-NP B-LOC<br/>1996-08-22 CD I-NP O.........</span></pre><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/307f025315298223899639125e700fe7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*iBmi_UKhHsRJN6v1yXQLAw.png"/></div><figcaption class="mv mw gj gh gi mx my bd b be z dk translated">对于杂项，是<strong class="bd kv">杂项</strong></figcaption></figure><p id="4381" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe mz na nb ml b">"B"</code>表示一个实体的开始，<code class="fe mz na nb ml b">"I"</code>表示它在一个实体内部，<code class="fe mz na nb ml b">"O"</code>表示在一个命名的实体<br/>之外，所以如果<code class="fe mz na nb ml b">B-ORG</code>表示它是一个实体的开始，这个组织同样适用于其他组织</p><figure class="mg mh mi mj gt jo"><div class="bz fp l di"><div class="nc nd l"/></div></figure><h2 id="91c1" class="kt ku in bd kv kw kx dn ky kz la dp lb kg lc ld le kk lf lg lh ko li lj lk ll bi translated">空间实现</h2><p id="5d85" class="pw-post-body-paragraph jv jw in jx b jy lo ka kb kc lp ke kf kg md ki kj kk me km kn ko mf kq kr ks ig bi translated">spacy 使用的标签列表</p><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ne"><img src="../Images/429b74a3450e868137f07a84aa22281f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/0*ZlBft0yWPe7Vqr2F.png"/></div></div></figure><p id="f93d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">您可以在 Notes (第 21–22 页)或<a class="ae nf" href="https://github.com/explosion/spaCy/blob/master/spacy/glossary.py" rel="noopener ugc nofollow" target="_blank"> glossary.py </a>(来自第 321 行)上查看<a class="ae nf" href="https://catalog.ldc.upenn.edu/docs/LDC2013T19/OntoNotes-Release-5.0.pdf" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="mg mh mi mj gt jo"><div class="bz fp l di"><div class="nc nd l"/></div></figure><h2 id="76dd" class="kt ku in bd kv kw kx dn ky kz la dp lb kg lc ld le kk lf lg lh ko li lj lk ll bi translated">使用预训练的 maxent_ne_chunker 实现 NLTK</h2><figure class="mg mh mi mj gt jo"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="2c10" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">spacy 和 nltk 实现都有一些问题，比如应该在 spaCy 中检测到<code class="fe mz na nb ml b">Indian</code>，应该在 nltk 中检测到<code class="fe mz na nb ml b">2022</code>作为日期等等..让我们看看 StanfordNERTagger。</p><h2 id="0b35" class="kt ku in bd kv kw kx dn ky kz la dp lb kg lc ld le kk lf lg lh ko li lj lk ll bi translated">使用训练有素的 StanfordNERTagger 实现</h2><p id="c829" class="pw-post-body-paragraph jv jw in jx b jy lo ka kb kc lp ke kf kg md ki kj kk me km kn ko mf kq kr ks ig bi translated">斯坦福 NER 也被称为分类器。该软件提供了(任意阶)线性链条件随机场(CRF)序列模型的一般实现。</p><figure class="mg mh mi mj gt jo"><div class="bz fp l di"><div class="nc nd l"/></div></figure><h2 id="8c8c" class="kt ku in bd kv kw kx dn ky kz la dp lb kg lc ld le kk lf lg lh ko li lj lk ll bi translated">使用预先训练的变压器模型实现</h2><p id="bd03" class="pw-post-body-paragraph jv jw in jx b jy lo ka kb kc lp ke kf kg md ki kj kk me km kn ko mf kq kr ks ig bi translated">我们使用了基于 BERT 的 ner tagger，你可以在这里读到这个<a class="ae nf" href="https://huggingface.co/dslim/bert-base-NER" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="14ae" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">伯特-基-NER 是一个微调的伯特模型，可用于命名实体识别，并实现了 NER 任务的最先进的性能。它已经被训练识别四种类型的实体:位置(LOC)、组织(ORG)、人(PER)和杂项(MISC)。</p><p id="7766" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这个模型是一个基于<em class="mc"> bert 的</em>模型，它是在标准<a class="ae nf" href="https://www.aclweb.org/anthology/W03-0419.pdf" rel="noopener ugc nofollow" target="_blank"> CoNLL-2003 命名实体识别</a>数据集的英文版本上进行微调的。</p><div class="ng nh gp gr ni nj"><a href="https://nbviewer.org/gist/yashj302/4154d5635e08b97c9bdd6d52c34e6568" rel="noopener  ugc nofollow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd io gy z fp no fr fs np fu fw im bi translated">nbviewer 笔记本</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">nlp = pipeline ( "ner "，model = model，tokenizer = tokenizer ) example = " "克什米尔文件是 2022 年印度…</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">nbviewer.org</p></div></div><div class="ns l"><div class="nt l nu nv nw ns nx jt nj"/></div></div></a></div><p id="bd56" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我希望这有助于澄清一些关于 NER 的想法</p><p id="2248" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">显然，要使用或制作 NER 标记器，我们需要大量带注释的数据，像 conll-03 这样的数据集仅限于一些实体，如个人、组织、位置和其他。还有其他像 OntoNotes 这样的数据集，它们要大得多，涵盖了不同类型的文本，但它们不是免费的。</p><p id="ac5d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">你还应该检查 Azure 认知服务，它们有文档摘要、语义分析、实体检测等功能。在这里检查 ner <a class="ae nf" href="https://docs.microsoft.com/en-us/azure/cognitive-services/language-service/named-entity-recognition/quickstart?pivots=programming-language-python" rel="noopener ugc nofollow" target="_blank">的 sdk。这里还列出了它支持的实体</a><a class="ae nf" href="https://docs.microsoft.com/en-us/azure/cognitive-services/language-service/named-entity-recognition/concepts/named-entity-categories" rel="noopener ugc nofollow" target="_blank"/>。</p></div></div>    
</body>
</html>