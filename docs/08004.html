<html>
<head>
<title>The Complete Modern React Developer 2022</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">完整的现代 React 开发人员 2022</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/the-complete-modern-react-developer-2022-9ecf0ae8d63f?source=collection_archive---------1-----------------------#2022-05-10">https://blog.devgenius.io/the-complete-modern-react-developer-2022-9ecf0ae8d63f?source=collection_archive---------1-----------------------#2022-05-10</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/c08162f6efc650f5c8b7edd64741af3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q7HZY3xIizOBmeUNREfLfA.png"/></div></div></figure><h1 id="db49" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">介绍</h1><p id="41e2" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">这将是一个在 2022 年成为一个完整的现代 React 开发者的课程。本课程中唯一没有涉及的三个主题是<a class="ae lr" href="https://redux.js.org/" rel="noopener ugc nofollow" target="_blank"> Redux </a>、<a class="ae lr" href="https://graphql.org/" rel="noopener ugc nofollow" target="_blank"> GraphQL </a>和<a class="ae lr" href="https://docs.expo.dev/" rel="noopener ugc nofollow" target="_blank"> React Native </a>，它们可以在以后的课程中涉及。TypeScript 将是主要的编程语言，但是如果你已经知道 JavaScript，你会发现它很容易理解，因为语法没有太大的不同。</p><p id="e141" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">我们将建立一个超级基本的 Twitter 克隆，具有发布，阅读和删除推文的 CRUD 功能。</p><p id="9322" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">本课程将为您提供成为全栈软件开发人员的技能和知识。在本课程中，您将学习:</p><ul class=""><li id="1ea0" class="lx ly in kv b kw ls la lt le lz li ma lm mb lq mc md me mf bi translated"><a class="ae lr" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank">node . js</a>(<a class="ae lr" href="https://expressjs.com/" rel="noopener ugc nofollow" target="_blank">express . js</a>和<a class="ae lr" href="https://nestjs.com/" rel="noopener ugc nofollow" target="_blank"> nest.js </a>)</li><li id="84c2" class="lx ly in kv b kw mg la mh le mi li mj lm mk lq mc md me mf bi translated"><a class="ae lr" href="https://www.mongodb.com/" rel="noopener ugc nofollow" target="_blank"> MongoDB </a>和<a class="ae lr" href="https://www.postgresql.org/" rel="noopener ugc nofollow" target="_blank"> PostgreSQL </a></li><li id="5a96" class="lx ly in kv b kw mg la mh le mi li mj lm mk lq mc md me mf bi translated"><a class="ae lr" href="https://www.docker.com/" rel="noopener ugc nofollow" target="_blank">码头工人</a></li><li id="f887" class="lx ly in kv b kw mg la mh le mi li mj lm mk lq mc md me mf bi translated"><a class="ae lr" href="https://www.typescriptlang.org/" rel="noopener ugc nofollow" target="_blank">打字稿</a></li><li id="8953" class="lx ly in kv b kw mg la mh le mi li mj lm mk lq mc md me mf bi translated"><a class="ae lr" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank">反应</a>(钩子和上下文 API)</li><li id="2a44" class="lx ly in kv b kw mg la mh le mi li mj lm mk lq mc md me mf bi translated"><a class="ae lr" href="https://storybook.js.org/" rel="noopener ugc nofollow" target="_blank"> Storybook.js </a></li><li id="aaf7" class="lx ly in kv b kw mg la mh le mi li mj lm mk lq mc md me mf bi translated"><a class="ae lr" href="https://jestjs.io/" rel="noopener ugc nofollow" target="_blank"> Jest </a>、<a class="ae lr" href="https://testing-library.com/" rel="noopener ugc nofollow" target="_blank"> React 测试库</a>和<a class="ae lr" href="https://www.cypress.io/" rel="noopener ugc nofollow" target="_blank"> Cypress </a>(单元测试、集成测试、端到端测试)</li></ul><h1 id="9a93" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">先决条件</h1><p id="a1f1" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">确保您已经设置了开发环境，并安装了简介中列出的所有工具/库。我在 Mac 上工作，所以我提到的一些工具将只适用于 macOS，但是如果您使用 Windows 或 Linux，您应该能够找到替代工具并能够跟随。</p><h1 id="d839" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">MongoDB 设置</h1><p id="eb7d" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">您需要安装以下工具来使用 MongoDB NoSQL 数据库。MongoDB Compass 是一个使用 MongoDB 数据库的 GUI。mongosh 是一个 MongoDB shell，用于使用命令行处理 MongoDB 数据库。</p><p id="ec1c" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><a class="ae lr" href="https://www.mongodb.com/products/compass" rel="noopener ugc nofollow" target="_blank">蒙古罗盘</a> <br/> <a class="ae lr" href="https://www.mongodb.com/docs/mongodb-shell/" rel="noopener ugc nofollow" target="_blank">蒙古文</a></p><h1 id="0cd6" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">PostgreSQL 设置</h1><p id="c8c6" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">您需要安装以下工具来使用 PostgreSQL 数据库。Postgres.app 是一款管理 PostgreSQL 数据库的 app。Pgcli 是 Postgres 的命令行界面，带有自动完成和语法突出显示功能。它相当于 mongosh 的 PostgreSQL。</p><p id="449e" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">说到使用 GUI 处理 PostgreSQL 数据库，我更喜欢 Valentina Studio。这是一个很棒的工具，因为它甚至可以连接到 MongoDB 和 MySQL 数据库。尽管有像<a class="ae lr" href="https://www.pgadmin.org/" rel="noopener ugc nofollow" target="_blank"> PgAdmin </a>这样的选择，所以只要用你觉得舒服的就行了。</p><p id="183a" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><a class="ae lr" href="https://postgresapp.com/" rel="noopener ugc nofollow" target="_blank">postgres . app</a><br/><a class="ae lr" href="https://www.pgcli.com/" rel="noopener ugc nofollow" target="_blank">pg CLI</a><br/><a class="ae lr" href="https://www.valentina-db.com/en/" rel="noopener ugc nofollow" target="_blank">Valentina 工作室</a></p><h1 id="0d1f" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">设置后端</h1><p id="4d83" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">在本节中，您将学习如何使用 Express.js 和 Nest.js 设置节点后端。这两个框架都将使用不同的端点连接到 MongoDB 和 PostgreSQL 数据库。另外，当我们将 MongoDB 和 PostgreSQL 数据库放入 Docker 容器时，您还会学到一些 DevOps。</p><p id="791e" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">Docker 基本上让开发人员能够将应用程序打包到容器中。所以本质上你可以在 Docker 容器中有一个数据库，任何外部应用程序都可以连接到它。使用这种类型的设置，您甚至不需要在本地机器上安装或设置数据库。你可以在 Docker 容器中运行所有的东西，这种设置在任何机器上都是一样的。</p><p id="6dc3" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">我认为这是本地安装的一个很好的替代方案，有了这个知识，它为您提供了与数据库交互的另一个选择。这个工作流不需要大量的设置，您可以使用 GUI 或命令行与 Docker 容器中的数据库进行交互，就像在本地或在线一样。</p><h1 id="eaf6" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">本地数据库设置</h1><p id="7689" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated"><a class="ae lr" href="https://www.pgcli.com/commands" rel="noopener ugc nofollow" target="_blank"> Pgcli 命令</a> <br/> <a class="ae lr" href="https://www.mongodb.com/docs/mongodb-shell/run-commands/" rel="noopener ugc nofollow" target="_blank"> mongosh 命令</a></p><h2 id="c648" class="ml jw in bd jx mm mn dn kb mo mp dp kf le mq mr kj li ms mt kn lm mu mv kr mw bi translated">MongoDB 本地</h2><p id="5f42" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">打开你的命令行工具，我将使用<a class="ae lr" href="https://hyper.is/" rel="noopener ugc nofollow" target="_blank"> Hyper </a>，运行下面的命令连接到你的本地 MongoDB 安装。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="4989" class="ml jw in nc b gy ng nh l ni nj">mongosh</span></pre><p id="8c09" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">首先运行这个命令，它将显示您正在使用哪个数据库。它应该返回默认数据库<code class="fe nk nl nm nc b">test</code>。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="2f52" class="ml jw in nc b gy ng nh l ni nj">db</span></pre><p id="6a3b" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">现在运行下面的命令，它将显示您当前已经创建了哪些数据库。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="b4ed" class="ml jw in nc b gy ng nh l ni nj">show dbs;</span></pre><p id="e07b" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">接下来运行命令创建一个名为<strong class="kv io"> twitter </strong>的数据库。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="28ee" class="ml jw in nc b gy ng nh l ni nj">use twitter;</span></pre><p id="4406" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">最后使用下面的命令创建一个集合，当你在命令行中再次使用命令<code class="fe nk nl nm nc b">show dbs;</code>时，你应该会看到你创建的名为<code class="fe nk nl nm nc b">twitter</code>的数据库。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="8bab" class="ml jw in nc b gy ng nh l ni nj">db.createCollection('contents');</span></pre><p id="5c99" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">最后，我们将添加一些起始数据拷贝，并将下面的代码粘贴到您的命令行中。如果您在插入数据后在命令行中运行这个命令<code class="fe nk nl nm nc b">db.contents.find().pretty()</code>，那么您将能够在表中看到数据。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="3d4b" class="ml jw in nc b gy ng nh l ni nj">db.contents.insertMany([ {tweet: "Hello World!", img: ""}, {tweet: "Content creation and programming are basically full time jobs. I have enough projects and work to keep me busy for years. Working in tech is definitely going to entertain you for a long time which is why so many people want to transition into this field.", img: ""}, {tweet: "JavaScript developers are forever in high demand", img: ""} ])</span></pre><p id="1e5d" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">如果您在计算机上打开 MongoDB Compass 应用程序，并使用连接字符串<code class="fe nk nl nm nc b">mongodb://localhost:27017</code>连接到您的本地安装，那么您应该能够看到您的所有数据库，包括我们刚刚在 GUI 中创建的数据库。现在，您可以使用命令行或 GUI 与数据库进行交互。</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nn"><img src="../Images/495e233eb40e10eb4927e1897685a0bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*72GwcptrrqqrwxdP.jpg"/></div></div></figure><h2 id="6127" class="ml jw in bd jx mm mn dn kb mo mp dp kf le mq mr kj li ms mt kn lm mu mv kr mw bi translated">PostgreSQL 本地</h2><p id="4978" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">在执行任何操作之前，请检查 PostgreSQL 数据库是否正在本地运行。如果它没有运行，那么当您运行命令<code class="fe nk nl nm nc b">pgcli</code>时，可能会在命令行中得到一个错误。在 macOS 上，我将使用 Postgres.app，所以让它在你的机器上运行，然后它应该会出现在你的操作系统顶部的菜单栏中。</p><p id="fe7f" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">现在转到命令行并运行下面的命令来连接到您的本地 PostgreSQL 安装。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="b73f" class="ml jw in nc b gy ng nh l ni nj">pgcli</span></pre><p id="6545" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">运行下面的命令将显示您所有的 PostgreSQL 数据库。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="c95c" class="ml jw in nc b gy ng nh l ni nj">\l</span></pre><p id="df7c" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">将下面的 SQL 查询复制并粘贴到您的 pgcli 命令行窗口中，创建一个名为<strong class="kv io"> twitter </strong>的数据库。现在，如果您在同一个窗口中再次运行命令<code class="fe nk nl nm nc b">\l</code>，您应该会看到所有的数据库，包括我们刚刚创建的数据库。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="3b5a" class="ml jw in nc b gy ng nh l ni nj">CREATE DATABASE twitter;</span></pre><p id="5637" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">接下来，我们需要在同一个窗口中连接到数据库，所以使用下面的命令来完成。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="57b6" class="ml jw in nc b gy ng nh l ni nj">\c twitter</span></pre><p id="4a70" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">接下来，我们必须创建一个表，并添加一些数据，这些数据将进入数据库<strong class="kv io"> twitter </strong>。将下面的 SQL 代码复制并粘贴到命令行窗口中。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="9d30" class="ml jw in nc b gy ng nh l ni nj">CREATE TABLE contents (</span><span id="c3b1" class="ml jw in nc b gy no nh l ni nj">id UUID DEFAULT gen_random_uuid (),</span><span id="ee41" class="ml jw in nc b gy no nh l ni nj">tweet VARCHAR(280) NOT NULL,</span><span id="5296" class="ml jw in nc b gy no nh l ni nj">img VARCHAR(500) NOT NULL</span><span id="0e55" class="ml jw in nc b gy no nh l ni nj">);</span><span id="756b" class="ml jw in nc b gy no nh l ni nj">INSERT INTO contents (tweet, img)</span><span id="b90c" class="ml jw in nc b gy no nh l ni nj">VALUES ('Hello World!', ''), ('Content creation and programming are basically full time jobs. I have enough projects and work to keep me busy for years. Working in tech is definitely going to entertain you for a long time which is why so many people want to transition into this field.', ''), ('JavaScript developers are forever in high demand', '');</span></pre><p id="c135" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">如果您在计算机上打开 Postgres.app 应用程序，您应该会看到所有数据库，包括我们刚刚创建的数据库。</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nn"><img src="../Images/4e4f291b3e77d1b39124194a60aaa927.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2q0dyTnky3CKq2DG.jpg"/></div></div></figure><p id="2894" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">如果您连接到 Valentina Studio 或您选择的数据库 GUI，您应该能够看到您创建的数据库。</p><p id="81db" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">PostgreSQL 数据库连接设置</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nn"><img src="../Images/78e53a745f1779edc8bd51be2dd187ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZmaJR5nIBHnDSALQ.jpg"/></div></div></figure><p id="c692" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">瓦伦蒂娜工作室</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nn"><img src="../Images/3cd3c942f186e6c0e0a9a326a96a8b16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*bGQh0COHfGeNUKVc.jpg"/></div></div></figure><h1 id="262e" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">Docker 数据库设置</h1><p id="d69d" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">在您的计算机上启动 Docker 应用程序，并对每个数据库执行以下步骤。首先在本地机器上创建一个名为<strong class="kv io">complete-react-developer</strong><br/>的文件夹，然后使用命令行进入<code class="fe nk nl nm nc b">cd</code>。</p><h2 id="7162" class="ml jw in bd jx mm mn dn kb mo mp dp kf le mq mr kj li ms mt kn lm mu mv kr mw bi translated">MongoDB Docker</h2><p id="a469" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">仔细检查您是否在<strong class="kv io">complete-react-developer</strong>的根文件夹中，然后运行下面的命令来设置项目。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="1747" class="ml jw in nc b gy ng nh l ni nj">mkdir docker-twitter-mongodb<br/>cd docker-twitter-mongodb<br/>touch docker-compose.yml</span></pre><p id="a1a2" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">在代码编辑器中打开该文件夹，并将以下代码添加到<code class="fe nk nl nm nc b">docker-compose.yml</code>文件中。</p><p id="fc85" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">docker-compose.yml</code></p><p id="7c82" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">小心 yaml 代码的格式，如果缩进不正确，就会出现错误。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="7f68" class="ml jw in nc b gy ng nh l ni nj">version: '3.9'<br/>services:<br/>  mongo_db:<br/>    container_name: db_container<br/>    image: 'mongo:latest'<br/>    restart: always<br/>    ports:<br/>      - '2717:27017'<br/>    volumes:<br/>      - 'mongo_db:/data/db'<br/>volumes:<br/>  mongo_db: {}</span></pre><p id="2311" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">现在运行下面的代码，用 MongoDB 数据库启动 docker 容器。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="77b1" class="ml jw in nc b gy ng nh l ni nj">docker compose up</span></pre><p id="8609" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">假设一切顺利，您应该有一个运行在 Docker 容器中的 MongoDB 数据库。</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nn"><img src="../Images/8cacf826c15d1bec37a2864e0905a535.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-P-9BscYNJCYJUwq.jpg"/></div></div></figure><p id="3ce5" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">连接到 Docker 容器中的 MongoDB 数据库</p><p id="d9e0" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">现在可以同时连接到本地 MongoDB 数据库和 MongoDB Docker 数据库，因为它们都被配置为在不同的端口上运行。</p><p id="f5da" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">本地 mongodb 数据库位于端口 27017 上，因此使用下面的命令连接到本地 MongoDB 数据库。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="0447" class="ml jw in nc b gy ng nh l ni nj">mongosh --port 27017</span></pre><p id="4bfa" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">MongoDB Compass 的连接字符串如下。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="922b" class="ml jw in nc b gy ng nh l ni nj">mongodb://localhost:27017</span></pre><p id="fa53" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">MongoDB Docker 数据库位于端口 2717 上，因此使用下面的命令连接到 Docker MongoDB 数据库。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="714d" class="ml jw in nc b gy ng nh l ni nj">mongosh --port 2717</span></pre><p id="bac1" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">MongoDB Compass 的连接字符串如下。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="b447" class="ml jw in nc b gy ng nh l ni nj">mongodb://localhost:2717</span></pre><p id="7646" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">所以现在您有两个用于 Twitter 的 MongoDB 数据库，一个在本地，一个在 Docker 容器中。让我们向数据库中添加一些数据，即使您删除了容器，这些数据也将持续存在。</p><p id="1790" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">在命令行中，打开一个到 Docker 容器中的 mongosh 数据库的连接。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="bec1" class="ml jw in nc b gy ng nh l ni nj">mongosh --port 2717</span></pre><p id="f8a6" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">运行下面的命令。您正在创建一个名为<strong class="kv io"> twitter </strong>的数据库，其中包含一个名为<strong class="kv io"> contents </strong>的集合。然后将一些数据插入数据库。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="5336" class="ml jw in nc b gy ng nh l ni nj">use twitter;</span><span id="4a4a" class="ml jw in nc b gy no nh l ni nj">db.createCollection('contents');</span><span id="c7e6" class="ml jw in nc b gy no nh l ni nj">db.contents.insertMany([ {tweet: "Hello World!", img: ""}, {tweet: "Content creation and programming are basically full time jobs. I have enough projects and work to keep me busy for years. Working in tech is definitely going to entertain you for a long time which is why so many people want to transition into this field.", img: ""}, {tweet: "JavaScript developers are forever in high demand", img: ""} ]);</span></pre><p id="23bb" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">现在，当您在命令行中运行命令<code class="fe nk nl nm nc b">db.contents.find().pretty();</code>时，它应该会返回您刚刚插入的数据。如果你去 MongoDB compass 并使用这个连接字符串<code class="fe nk nl nm nc b">mongodb://localhost:2717</code>，你应该会看到包含数据的<strong class="kv io"> twitter </strong>数据库。</p><h2 id="16ec" class="ml jw in bd jx mm mn dn kb mo mp dp kf le mq mr kj li ms mt kn lm mu mv kr mw bi translated">PostgreSQL Docker</h2><p id="f3ed" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">检查你是否在<strong class="kv io">complete-react-developer</strong>的根文件夹中，然后运行下面的命令来设置这个项目。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="e5a9" class="ml jw in nc b gy ng nh l ni nj">mkdir docker-twitter-postgresql<br/>cd docker-twitter-postgresql<br/>touch docker-compose.yml<br/>mkdir sql<br/>cd sql<br/>touch twitter.sql<br/>cd ..</span></pre><p id="3e33" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">在代码编辑器中打开该文件夹，并将以下代码添加到<code class="fe nk nl nm nc b">docker-compose.yml</code>和<code class="fe nk nl nm nc b">twitter.sql</code>文件中。</p><p id="f65c" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">docker-compose.yml</code></p><p id="8cc1" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">小心 yaml 代码的格式，如果缩进不正确，就会出现错误。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="719b" class="ml jw in nc b gy ng nh l ni nj">version: '3.7'<br/>services:<br/>  postgres:<br/>    image: postgres:latest<br/>    restart: always<br/>    environment:<br/>      - POSTGRES_USER=twitter<br/>      - POSTGRES_PASSWORD=twitter<br/>      - POSTGRES_DB=twitter<br/>    ports:<br/>      - '5433:5432'<br/>    volumes:<br/>      - ./postgres-data:/var/lib/postgresql/data<br/>      # copy the sql script to create tables<br/>      - ./sql/twitter.sql:/docker-entrypoint-initdb.d/twitter.sql</span></pre><p id="945b" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">twitter.sql</code></p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="a4bb" class="ml jw in nc b gy ng nh l ni nj">CREATE TABLE contents (</span><span id="c38a" class="ml jw in nc b gy no nh l ni nj">id UUID DEFAULT gen_random_uuid (),</span><span id="f597" class="ml jw in nc b gy no nh l ni nj">tweet VARCHAR(280) NOT NULL,</span><span id="6bd8" class="ml jw in nc b gy no nh l ni nj">img VARCHAR(500) NOT NULL</span><span id="d551" class="ml jw in nc b gy no nh l ni nj">);</span><span id="017c" class="ml jw in nc b gy no nh l ni nj">INSERT INTO contents (tweet, img)</span><span id="b5e4" class="ml jw in nc b gy no nh l ni nj">VALUES ('Hello World!', ''), ('Content creation and programming are basically full time jobs. I have enough projects and work to keep me busy for years. Working in tech is definitely going to entertain you for a long time which is why so many people want to transition into this field.', ''), ('JavaScript developers are forever in high demand', '');</span></pre><p id="d444" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">现在运行下面的代码，用 PostgreSQL 数据库启动 Docker 容器。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="9ec5" class="ml jw in nc b gy ng nh l ni nj">docker compose up</span></pre><p id="c13e" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">当您看到日志说<strong class="kv io">数据库系统准备好接受连接</strong>时，您将知道它正在工作。这也可以在 Docker 桌面应用程序中验证，如果你检查它，你应该看到容器正在运行。</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nn"><img src="../Images/0521fb37f6d8b11d4030a9dd7abb2b4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fizCI03wp5PQvrgs.jpg"/></div></div></figure><p id="b93d" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">我们刚刚做的是设置一个 PostgreSQL 数据库，它将驻留在 Docker 容器中。这个数据库甚至会有一些来自我们创建的 SQL 脚本的预构建数据。</p><p id="9914" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">连接到 Docker 容器中的 PostgreSQL 数据库</p><p id="f0c8" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><strong class="kv io">docker-Twitter-PostgreSQL</strong>文件夹内的<code class="fe nk nl nm nc b">docker-compose.yml</code>文件有一个端口映射<strong class="kv io"> 5433:5432 </strong>。5433 是本地端口，5432 是 docker 端口，这也是 Postgres 的默认端口。我这样做是为了让我们可以在本地端口 5432 上使用 Postgres 应用程序，同时在端口 5433 上运行 Docker 数据库。</p><p id="dca2" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">这就是奇迹发生的地方！使用下图中的连接凭证，您应该能够连接到 docker 容器中的 PostgreSQL 数据库！</p><p id="41b6" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">顺便说一下，密码是<strong class="kv io"> twitter </strong>，您可以在<code class="fe nk nl nm nc b">docker-compose.yml</code>文件中找到凭证。</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nn"><img src="../Images/ca9efe2ab1a16274236df9cc1d55597f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vcWJUzq3nKAM-I6O.jpg"/></div></div></figure><p id="a975" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">或者，您也可以使用下面的命令，在命令行中使用<code class="fe nk nl nm nc b">pgcli</code>连接到数据库。密码和之前一样是<strong class="kv io"> twitter </strong>。</p><pre class="mx my mz na gt nb nc np bn nq nr bi"><span id="d4ee" class="ns jw in nc b be nt nu l ni nj">pgcli -h localhost -p 5433 -u twitter -d twitter</span></pre><p id="1c7b" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">所以现在我们在端口 5432 上有了一个名为<strong class="kv io"> twitter </strong>的本地 PostgreSQL 数据库。以及一个在端口 5433 上名为<strong class="kv io"> twitter </strong>的 Docker PostgreSQL 数据库。Valentina Studio 可以同时连接到它们，您可以运行所有的 SQL 查询。此外，Docker 容器中的 PostgreSQL 数据库可以保存其数据。如果您删除正在运行的 Docker 容器，然后再次运行命令<code class="fe nk nl nm nc b">docker compose up</code>，一切都将保持不变！</p><p id="9895" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">如果需要，使用命令<code class="fe nk nl nm nc b">docker compose down</code>停止 Docker 容器的运行。</p><p id="603e" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">恭喜你刚刚学习了 MongoDB、PostgreSQL 和 Docker 的基础知识！</p><h1 id="ec68" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">节点后端设置</h1><p id="cea2" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">这将分为两个部分。一个用于使用 Express.js 和 TypeScript 创建后端。另一个用于使用 Nest.js 和 TypeScript 创建后端，这样您就可以看到两者之间的区别，并了解在 Node 中开发后端的替代方法。</p><p id="f9f1" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">因此，将有 4 个节点后端可供使用:</p><ul class=""><li id="bf2f" class="lx ly in kv b kw ls la lt le lz li ma lm mb lq mc md me mf bi translated">后端-快速-mongodb</li><li id="2acf" class="lx ly in kv b kw mg la mh le mi li mj lm mk lq mc md me mf bi translated">后端-快速-postgresql</li><li id="c5dc" class="lx ly in kv b kw mg la mh le mi li mj lm mk lq mc md me mf bi translated">后端-嵌套-mongodb</li><li id="d600" class="lx ly in kv b kw mg la mh le mi li mj lm mk lq mc md me mf bi translated">后端嵌套 postgresql</li></ul><p id="fcc9" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">将需要一个 REST API 测试工具，以便您可以测试各种路由和端点。这些是我最喜欢的 3 个，如果你想的话，可以随意使用其他的。</p><p id="f64f" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><a class="ae lr" href="https://www.postman.com/" rel="noopener ugc nofollow" target="_blank">邮递员</a> <br/> <a class="ae lr" href="https://www.thunderclient.com/" rel="noopener ugc nofollow" target="_blank">迅雷客户端</a> <br/> <a class="ae lr" href="https://insomnia.rest/" rel="noopener ugc nofollow" target="_blank">失眠</a></p><p id="fbfd" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">您不需要创建所有这些后端，因为当我们创建 React 前端时，它只需要一个后端，但这仍然是值得学习的好知识。显然，您可以只拥有一个连接到 MongoDB 和 PostgreSQL 的后端，这在这些示例中更容易解释。</p><h2 id="9180" class="ml jw in bd jx mm mn dn kb mo mp dp kf le mq mr kj li ms mt kn lm mu mv kr mw bi translated">快速应用程序</h2><p id="a643" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">后端 Express MongoDB</p><p id="183c" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">确保您在文件夹<strong class="kv io">complete-react-developer</strong>中。</p><p id="02bc" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">运行下面的命令来搭建您的项目。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="d9f0" class="ml jw in nc b gy ng nh l ni nj">mkdir backend-express-mongodb<br/>cd backend-express-mongodb<br/>tsc --init<br/>npm init -y<br/>npm i express @types/express @types/node ts-node cors @types/cors mongoose @types/mongoose typescript rimraf copy-files dotenv nodemon<br/>touch .env<br/>mkdir src<br/>cd src<br/>touch app.ts<br/>mkdir controllers models routes<br/>touch controllers/Admin.ts<br/>touch models/Twitter.ts<br/>touch routes/Admin.ts<br/>cd ..</span></pre><p id="3d82" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">在代码编辑器中打开项目，转到根文件夹中的<code class="fe nk nl nm nc b">tsconfig.json</code>文件，并启用这些属性。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="a7b0" class="ml jw in nc b gy ng nh l ni nj">"rootDir": "./src" /* Specify the root folder within your source files. */,<br/>"moduleResolution": "node" /* Specify how TypeScript looks up a file from a given module specifier. */,<br/>"outDir": "./dist/src" /* Specify an output folder for all emitted files. */,</span></pre><p id="8c0e" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">在下一步中，打开<code class="fe nk nl nm nc b">package.json</code>文件并添加这些运行脚本。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="58d4" class="ml jw in nc b gy ng nh l ni nj">"scripts": {</span><span id="4300" class="ml jw in nc b gy no nh l ni nj">"start": "node dist/src/app.js",</span><span id="3c69" class="ml jw in nc b gy no nh l ni nj">"dev": "nodemon src/app.ts",</span><span id="1472" class="ml jw in nc b gy no nh l ni nj">"clean": "rimraf dist/",</span><span id="241a" class="ml jw in nc b gy no nh l ni nj">"build": "npm run clean &amp;&amp; tsc &amp;&amp; npm run copy-files",</span><span id="5c72" class="ml jw in nc b gy no nh l ni nj">"copy-files": "copyfiles -u 1 src/**/*.html src/**/*.css src/**/*.json dist/src"</span><span id="08a4" class="ml jw in nc b gy no nh l ni nj">},</span></pre><p id="44d8" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">运行脚本</p><p id="247e" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><strong class="kv io">启动</strong> <br/>当文件有更新时，启动脚本使用 Node 运行应用程序，无需自动重新加载。</p><p id="5862" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><strong class="kv io">dev</strong><br/>dev 脚本使用 nodemon 在发生变化时自动重新加载和更新文件。</p><p id="36bf" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><strong class="kv io">清理</strong> <br/>清理脚本删除<strong class="kv io"> dist </strong>文件夹。</p><p id="d1e8" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><strong class="kv io">构建</strong> <br/>构建脚本删除<strong class="kv io"> dist </strong>文件夹，然后自动复制所有文件，并将它们放回<strong class="kv io"> dist </strong>文件夹。</p><p id="5a38" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><strong class="kv io">复制文件</strong> <br/>复制文件脚本用于将文件从一个目录复制到另一个目录。</p><p id="e94d" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">添加代码</p><p id="2e3c" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">最后，将下面的代码添加到相应的文件中。</p><p id="cac5" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">controllers/Admin.ts</code></p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="217d" class="ml jw in nc b gy ng nh l ni nj">import { Response, Request } from 'express';</span><span id="27fc" class="ml jw in nc b gy no nh l ni nj">import mongoose from 'mongoose';</span><span id="5cdf" class="ml jw in nc b gy no nh l ni nj">import Twitter from '../models/Twitter';</span><span id="b5a1" class="ml jw in nc b gy no nh l ni nj">export const getTweets = (req: Request, res: Response): void =&gt; {<br/>    Twitter.find((err, data) =&gt; {<br/>        console.log(data);</span><span id="028a" class="ml jw in nc b gy no nh l ni nj">        res.json(data);</span><span id="38d9" class="ml jw in nc b gy no nh l ni nj">        if (err) {<br/>            console.log(err);<br/>        }<br/>    });<br/>};</span><span id="3570" class="ml jw in nc b gy no nh l ni nj">export const getTweet = async (req: Request, res: Response): Promise&lt;any&gt; =&gt; {<br/>    const tweetId = req.params.tweetId;</span><span id="a485" class="ml jw in nc b gy no nh l ni nj">    console.log('Tweet ID', tweetId);</span><span id="58f1" class="ml jw in nc b gy no nh l ni nj">    // This line of code fixes the CastError: Cast to ObjectId failed for value "favicon.ico" (type string) at path "_id" for model "contents"</span><span id="b83a" class="ml jw in nc b gy no nh l ni nj">    if (!mongoose.Types.ObjectId.isValid(tweetId)) return false;</span><span id="f188" class="ml jw in nc b gy no nh l ni nj">    await Twitter.findById(tweetId).exec();</span><span id="0b3d" class="ml jw in nc b gy no nh l ni nj">    Twitter.findById(tweetId, (err: any, tweet: any) =&gt; {<br/>        console.log(tweet);</span><span id="e096" class="ml jw in nc b gy no nh l ni nj">        res.json(tweet);</span><span id="9c75" class="ml jw in nc b gy no nh l ni nj">        if (err) {<br/>            console.log(err);<br/>        }<br/>    });<br/>};</span><span id="17d9" class="ml jw in nc b gy no nh l ni nj">export const postTweet = (req: Request, res: Response) =&gt; {<br/>    const { tweet, img } = req.body;</span><span id="315e" class="ml jw in nc b gy no nh l ni nj">    const twitter = new Twitter({ tweet: tweet, img: img });</span><span id="cb79" class="ml jw in nc b gy no nh l ni nj">    twitter.save();</span><span id="2bcf" class="ml jw in nc b gy no nh l ni nj">    console.log('Tweet Created');</span><span id="e25e" class="ml jw in nc b gy no nh l ni nj">    res.status(201).json({ msg: 'Tweet Created' });<br/>};</span><span id="08f6" class="ml jw in nc b gy no nh l ni nj">export const updateTweet = (req: Request, res: Response) =&gt; {<br/>    const tweetId = req.params.tweetId;</span><span id="109b" class="ml jw in nc b gy no nh l ni nj">    const { tweet, img } = req.body;</span><span id="d08f" class="ml jw in nc b gy no nh l ni nj">    Twitter.findByIdAndUpdate(tweetId, { tweet: tweet, img: img }).then(() =&gt; {<br/>        console.log(`Tweet ${tweetId} Updated`);</span><span id="2ce3" class="ml jw in nc b gy no nh l ni nj">        res.json({ msg: `Tweet ${tweetId} Updated` });<br/>    });<br/>};</span><span id="0fbe" class="ml jw in nc b gy no nh l ni nj">export const deleteTweet = (req: Request, res: Response) =&gt; {<br/>    const tweetId = req.body.tweetId;</span><span id="3cd3" class="ml jw in nc b gy no nh l ni nj">    Twitter.findByIdAndRemove(tweetId, () =&gt; {<br/>        res.json({ msg: `Tweet ${tweetId} Deleted` });<br/>    });<br/>};</span></pre><p id="2f9d" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">models/Twitter.ts</code></p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="135e" class="ml jw in nc b gy ng nh l ni nj">import { Schema, model } from 'mongoose';</span><span id="d603" class="ml jw in nc b gy no nh l ni nj">interface Twitter {<br/>    tweet: string;</span><span id="baba" class="ml jw in nc b gy no nh l ni nj">    img: string;<br/>}</span><span id="afab" class="ml jw in nc b gy no nh l ni nj">const schema = new Schema&lt;Twitter&gt;({<br/>    tweet: { type: String, required: true },</span><span id="a5e6" class="ml jw in nc b gy no nh l ni nj">    img: { type: String, required: false },<br/>});</span><span id="9846" class="ml jw in nc b gy no nh l ni nj">const TwitterModel = model&lt;Twitter&gt;('contents', schema);</span><span id="b619" class="ml jw in nc b gy no nh l ni nj">export default TwitterModel;</span></pre><p id="2ee6" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">routes/Admin.ts</code></p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="70c9" class="ml jw in nc b gy ng nh l ni nj">import express from 'express';</span><span id="5c2c" class="ml jw in nc b gy no nh l ni nj">import { getTweets, getTweet, postTweet, updateTweet, deleteTweet } from '../controllers/Admin';</span><span id="83d8" class="ml jw in nc b gy no nh l ni nj">const router = express.Router();</span><span id="1e20" class="ml jw in nc b gy no nh l ni nj">router.get('/', getTweets);</span><span id="9d3f" class="ml jw in nc b gy no nh l ni nj">router.get('/:tweetId', getTweet);</span><span id="462e" class="ml jw in nc b gy no nh l ni nj">router.post('/delete', deleteTweet);</span><span id="105a" class="ml jw in nc b gy no nh l ni nj">router.post('/tweet', postTweet);</span><span id="0457" class="ml jw in nc b gy no nh l ni nj">router.post('/:tweetId', updateTweet);</span><span id="f2e9" class="ml jw in nc b gy no nh l ni nj">export default router;</span></pre><p id="4ea8" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">app.ts</code></p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="bd89" class="ml jw in nc b gy ng nh l ni nj">import dotenv from 'dotenv';</span><span id="3901" class="ml jw in nc b gy no nh l ni nj">dotenv.config();</span><span id="ac68" class="ml jw in nc b gy no nh l ni nj">console.log(process.env.DB_HOST);</span><span id="8f02" class="ml jw in nc b gy no nh l ni nj">import express from 'express';</span><span id="cb72" class="ml jw in nc b gy no nh l ni nj">import cors from 'cors';</span><span id="fc0d" class="ml jw in nc b gy no nh l ni nj">import mongoose from 'mongoose';</span><span id="979e" class="ml jw in nc b gy no nh l ni nj">import adminRoute from './routes/Admin';</span><span id="6416" class="ml jw in nc b gy no nh l ni nj">const app = express();</span><span id="7342" class="ml jw in nc b gy no nh l ni nj">app.use(cors());</span><span id="4215" class="ml jw in nc b gy no nh l ni nj">app.use(express.urlencoded({ extended: false }));</span><span id="7203" class="ml jw in nc b gy no nh l ni nj">app.use(express.json());</span><span id="e69e" class="ml jw in nc b gy no nh l ni nj">app.use('/', adminRoute);</span><span id="ccc9" class="ml jw in nc b gy no nh l ni nj">const port = process.env.PORT || 8080;</span><span id="6db5" class="ml jw in nc b gy no nh l ni nj">mongoose</span><span id="4761" class="ml jw in nc b gy no nh l ni nj">    // Use DB_HOST_DOCKER to connect to the MongoDB Database in the Docker Container</span><span id="5c17" class="ml jw in nc b gy no nh l ni nj">    .connect(`${process.env.DB_HOST_LOCAL}`)</span><span id="452b" class="ml jw in nc b gy no nh l ni nj">    .then(() =&gt; {<br/>        app.listen(port, () =&gt; console.log(`Server and database running on port ${port}, http://localhost:${port}`));<br/>    })</span><span id="835d" class="ml jw in nc b gy no nh l ni nj">    .catch((err: any) =&gt; {<br/>        console.log(err);<br/>    });</span></pre><p id="d4c5" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">.env</code></p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="9534" class="ml jw in nc b gy ng nh l ni nj">DB_HOST_LOCAL="mongodb://127.0.0.1:27017/twitter"</span><span id="4e12" class="ml jw in nc b gy no nh l ni nj">DB_HOST_DOCKER="mongodb://127.0.0.1:2717/twitter"</span></pre><p id="c714" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">应用程序被设置为连接到本地 MongoDB 数据库，但是您可以在<code class="fe nk nl nm nc b">app.ts</code>文件中对此进行更改，并且可以在<code class="fe nk nl nm nc b">.env</code>文件中找到数据库连接字符串。</p><p id="6df7" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">使用下面的命令启动服务器。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="79b8" class="ml jw in nc b gy ng nh l ni nj">npm run dev</span></pre><p id="ccc2" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">测试 API</p><p id="1b50" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">我将使用 Postman，但你可以使用任何你想要的 API 测试工具。如果你想看到它完全工作，你必须做的第一件事是添加一些数据到数据库，如果你还没有这样做。为此使用创建 tweet 路线，并查看下面截图中的示例。</p><p id="176b" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">获取所有推文</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nn"><img src="../Images/f1b495bd54abc4ec85f1bbf870fc6e40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BLdHkpU-t2rBKpLR.jpg"/></div></div></figure><p id="44ab" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">通过 ID 获取推文</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nn"><img src="../Images/e82e4679c41f55f948f08ed39ea34760.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6jAPqnYVxzRgOaeY.jpg"/></div></div></figure><p id="78a8" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">创建推文</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nn"><img src="../Images/b488f80db8dac09f9ad0e379d9f36137.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Y9Qp1Iw_-EZXPalg.jpg"/></div></div></figure><p id="2c05" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">按 ID 更新推文</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nn"><img src="../Images/773caa3a6849ed5dd1cccf12ef1eed25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Uo0K4iUQSFuPiyvX.jpg"/></div></div></figure><p id="8c28" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">删除推文</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nn"><img src="../Images/a40bca85b284ea4faa9fc38b8e53e214.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cC3s4GpNa8qT3olq.jpg"/></div></div></figure><p id="1a2c" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">后端快速 PostgreSQL</p><p id="1547" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">我们将使用<a class="ae lr" href="https://typeorm.io/" rel="noopener ugc nofollow" target="_blank">https://typeorm.io/</a>来创建一个连接到 PostgreSQL 数据库的 Express.js 应用程序。</p><p id="3741" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">你应该在文件夹<strong class="kv io">完成-反应-开发者</strong>里面。</p><p id="395b" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">运行下面的命令来搭建您的项目。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="f817" class="ml jw in nc b gy ng nh l ni nj">mkdir backend-express-postgresql<br/>cd backend-express-postgresql<br/>tsc --init<br/>npm init -y<br/>npm i express @types/express @types/node ts-node cors @types/cors typescript rimraf copy-files dotenv nodemon pg reflect-metadata typeorm<br/>mkdir src<br/>cd src<br/>touch app.ts app-data-source.ts<br/>mkdir entity<br/>cd entity<br/>touch Tweet.ts<br/>cd ../..</span></pre><p id="e3fb" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">在代码编辑器中打开项目，找到<code class="fe nk nl nm nc b">tsconfig.json</code>文件，用下面的代码替换其中的所有代码。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="66d3" class="ml jw in nc b gy ng nh l ni nj">{<br/>    "compilerOptions": {<br/>        "lib": ["es5", "es6", "dom"],</span><span id="5026" class="ml jw in nc b gy no nh l ni nj">        "target": "es5",</span><span id="8461" class="ml jw in nc b gy no nh l ni nj">        "module": "commonjs",</span><span id="7708" class="ml jw in nc b gy no nh l ni nj">        "moduleResolution": "node",</span><span id="f924" class="ml jw in nc b gy no nh l ni nj">        "emitDecoratorMetadata": true,</span><span id="1ce1" class="ml jw in nc b gy no nh l ni nj">        "experimentalDecorators": true,</span><span id="7f60" class="ml jw in nc b gy no nh l ni nj">        "rootDir": "./src",</span><span id="cfba" class="ml jw in nc b gy no nh l ni nj">        "outDir": "./dist/src"<br/>    }<br/>}</span></pre><p id="af85" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">在下一步中，打开<code class="fe nk nl nm nc b">package.json</code>文件并添加这些运行脚本。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="e35f" class="ml jw in nc b gy ng nh l ni nj">"scripts": {</span><span id="06ce" class="ml jw in nc b gy no nh l ni nj">"start": "node dist/src/app.js",</span><span id="3f5c" class="ml jw in nc b gy no nh l ni nj">"dev": "nodemon src/app.ts",</span><span id="11cf" class="ml jw in nc b gy no nh l ni nj">"clean": "rimraf dist/",</span><span id="23d7" class="ml jw in nc b gy no nh l ni nj">"build": "npm run clean &amp;&amp; tsc &amp;&amp; npm run copy-files",</span><span id="2d4d" class="ml jw in nc b gy no nh l ni nj">"copy-files": "copyfiles -u 1 src/**/*.html src/**/*.css src/**/*.json dist/src"</span><span id="df70" class="ml jw in nc b gy no nh l ni nj">},</span></pre><p id="5189" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">将下面的代码添加到相应的文件中。</p><p id="f972" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">entity/Tweet.ts</code></p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="c82b" class="ml jw in nc b gy ng nh l ni nj">import { Entity, Column, PrimaryGeneratedColumn } from 'typeorm';</span><span id="f9d2" class="ml jw in nc b gy no nh l ni nj">@Entity()<br/>export class Tweet {<br/>    @PrimaryGeneratedColumn('uuid')<br/>    id: string;</span><span id="d35e" class="ml jw in nc b gy no nh l ni nj">    @Column()<br/>    tweet: string;</span><span id="5362" class="ml jw in nc b gy no nh l ni nj">    @Column()<br/>    img: string;<br/>}</span></pre><p id="e45c" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">app-data-source.ts</code></p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="bafe" class="ml jw in nc b gy ng nh l ni nj">import { DataSource } from 'typeorm';</span><span id="8546" class="ml jw in nc b gy no nh l ni nj">export const myDataSource = new DataSource({<br/>    type: 'postgres',</span><span id="db74" class="ml jw in nc b gy no nh l ni nj">    host: 'localhost',</span><span id="cc56" class="ml jw in nc b gy no nh l ni nj">    port: 5432,</span><span id="f4a6" class="ml jw in nc b gy no nh l ni nj">    username: 'postgres',</span><span id="0570" class="ml jw in nc b gy no nh l ni nj">    password: '',</span><span id="439e" class="ml jw in nc b gy no nh l ni nj">    database: 'twitter',</span><span id="ab60" class="ml jw in nc b gy no nh l ni nj">    entities: ['dist/src/entity/*.js'],</span><span id="0695" class="ml jw in nc b gy no nh l ni nj">    logging: true,</span><span id="ae99" class="ml jw in nc b gy no nh l ni nj">    synchronize: true,<br/>});</span></pre><p id="e1d2" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">app.ts</code></p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="f9bc" class="ml jw in nc b gy ng nh l ni nj">import * as express from 'express';</span><span id="4d8c" class="ml jw in nc b gy no nh l ni nj">import { Request, Response } from 'express';</span><span id="352c" class="ml jw in nc b gy no nh l ni nj">import { Tweet } from './entity/Tweet';</span><span id="e9c8" class="ml jw in nc b gy no nh l ni nj">import { myDataSource } from './app-data-source';</span><span id="e0b7" class="ml jw in nc b gy no nh l ni nj">// establish database connection</span><span id="e8c6" class="ml jw in nc b gy no nh l ni nj">myDataSource</span><span id="ad5a" class="ml jw in nc b gy no nh l ni nj">    .initialize()</span><span id="983c" class="ml jw in nc b gy no nh l ni nj">    .then(() =&gt; {<br/>        console.log('Data Source has been initialized!');<br/>    })</span><span id="44ea" class="ml jw in nc b gy no nh l ni nj">    .catch((err) =&gt; {<br/>        console.error('Error during Data Source initialization:', err);<br/>    });</span><span id="6107" class="ml jw in nc b gy no nh l ni nj">// create and setup express app</span><span id="7054" class="ml jw in nc b gy no nh l ni nj">const app = express();</span><span id="7fc6" class="ml jw in nc b gy no nh l ni nj">app.use(express.json());</span><span id="0869" class="ml jw in nc b gy no nh l ni nj">app.use(express.urlencoded({ extended: false }));</span><span id="91f4" class="ml jw in nc b gy no nh l ni nj">// register CRUD routes</span><span id="5a60" class="ml jw in nc b gy no nh l ni nj">// CREATE</span><span id="4d7d" class="ml jw in nc b gy no nh l ni nj">// READ</span><span id="9e9c" class="ml jw in nc b gy no nh l ni nj">// UPDATE</span><span id="69ed" class="ml jw in nc b gy no nh l ni nj">// DELETE</span><span id="1c0d" class="ml jw in nc b gy no nh l ni nj">// READ: All tweets</span><span id="c979" class="ml jw in nc b gy no nh l ni nj">app.get('/tweets', async function (req: Request, res: Response) {<br/>    const tweets = await myDataSource.getRepository(Tweet).find();</span><span id="852e" class="ml jw in nc b gy no nh l ni nj">    res.json(tweets);<br/>});</span><span id="2bac" class="ml jw in nc b gy no nh l ni nj">// READ: Tweet by ID</span><span id="edd1" class="ml jw in nc b gy no nh l ni nj">app.get('/tweets/:id', async function (req: Request, res: Response) {<br/>    const results = await myDataSource.getRepository(Tweet).findOneBy({<br/>        id: req.params.id,<br/>    });</span><span id="942f" class="ml jw in nc b gy no nh l ni nj">    return res.send(results);<br/>});</span><span id="8baf" class="ml jw in nc b gy no nh l ni nj">// CREATE: New tweet</span><span id="503e" class="ml jw in nc b gy no nh l ni nj">app.post('/tweets', async function (req: Request, res: Response) {<br/>    const tweet = await myDataSource.getRepository(Tweet).create(req.body);</span><span id="92d5" class="ml jw in nc b gy no nh l ni nj">    const results = await myDataSource.getRepository(Tweet).save(tweet);</span><span id="7f5b" class="ml jw in nc b gy no nh l ni nj">    return res.send(results);<br/>});</span><span id="df5f" class="ml jw in nc b gy no nh l ni nj">// UPDATE: Tweet by ID</span><span id="710c" class="ml jw in nc b gy no nh l ni nj">app.put('/tweets/:id', async function (req: Request, res: Response) {<br/>    const tweet = await myDataSource.getRepository(Tweet).findOneBy({<br/>        id: req.body.id,<br/>    });</span><span id="2c68" class="ml jw in nc b gy no nh l ni nj">    myDataSource.getRepository(Tweet).merge(tweet, req.body);</span><span id="cc9c" class="ml jw in nc b gy no nh l ni nj">    const results = await myDataSource.getRepository(Tweet).save(tweet);</span><span id="e4f8" class="ml jw in nc b gy no nh l ni nj">    return res.send(results);<br/>});</span><span id="82ef" class="ml jw in nc b gy no nh l ni nj">// DELETE: Tweet by ID</span><span id="edb5" class="ml jw in nc b gy no nh l ni nj">app.delete('/tweets/:id', async function (req: Request, res: Response) {<br/>    const results = await myDataSource.getRepository(Tweet).delete(req.body.id);</span><span id="a863" class="ml jw in nc b gy no nh l ni nj">    return res.send(results);<br/>});</span><span id="3390" class="ml jw in nc b gy no nh l ni nj">const port = process.env.PORT || 8080;</span><span id="2cd0" class="ml jw in nc b gy no nh l ni nj">// start express server</span><span id="bb3e" class="ml jw in nc b gy no nh l ni nj">app.listen(port, () =&gt; console.log(`Server and database running on port ${port}, <a class="ae lr" href="http://localhost:${port}`));" rel="noopener ugc nofollow" target="_blank">http://localhost:${port}`));</a></span></pre><p id="f558" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">应用程序被设置为连接到本地 PostgreSQL 数据库，但是您可以在<code class="fe nk nl nm nc b">app-data-source.ts</code>文件中对此进行更改。如果你需要的话，可以在 Docker 部分找到 Docker 连接设置。不要忘记，在连接到 PostgreSQL 数据库之前，您需要安装并运行它。</p><p id="e4c1" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">使用下面的命令运行应用程序。</p><p id="e6f1" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">警告:如果您试图使用命令<code class="fe nk nl nm nc b">npm run dev</code>来启动应用程序，您可能会得到错误<code class="fe nk nl nm nc b">EntityMetadataNotFoundError: No metadata for "Tweet" was found.</code>。我认为这与静态和动态数据以及 nodemon 自动重载的事实有关。因此，使用下面的命令更安全，只需使用节点服务器进行一次干净的构建，直到您手动重启它，它才会更新。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="20ee" class="ml jw in nc b gy ng nh l ni nj">npm run build<br/>npm run start</span></pre><p id="3788" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">现在您应该熟悉使用 REST API 工具了，但是在这个例子中，路由和 CRUD 请求略有不同。参见下面的例子，不要忘记使用 CREATE tweet 路径将一些数据添加到数据库中，以便您可以看到一些数据。</p><p id="5953" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">获取所有推文</p><p id="03e2" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">请求:获取<br/>路线:<a class="ae lr" href="http://localhost:8080/tweets" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/tweets</a></p><p id="0e64" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">通过 ID 获取推文</p><p id="f42b" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">请求:获取<br/>路线:<a class="ae lr" href="http://localhost:8080/tweets/d5d29839-788f-4d23-99ee-82b49ff1bbf1" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/tweets/d5d 29839-788 f-4d 23-99ee-82 b49 f1 bbf 1</a></p><p id="489e" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">创建推文</p><p id="5cac" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">请求:帖子<br/>路线:<a class="ae lr" href="http://localhost:8080/tweets" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/tweets</a><br/>Body raw:{ " tweet ":' Hello World '，img: ""}</p><p id="6b87" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">按 ID 更新推文</p><p id="1e8b" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">请求:放<br/>路线:<a class="ae lr" href="http://localhost:8080/tweets/d5d29839-788f-4d23-99ee-82b49ff1bbf1" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/tweets/d5d 29839-788 f-4d 23-99ee-82 b49 ff 1 bbf 1</a><br/>Body raw:{ " tweet ":' Hello Moon '，img: ""}</p><p id="09b9" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">按 ID 删除推文</p><p id="d712" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">请求:删除<br/>路由:<a class="ae lr" href="http://localhost:8080/tweets/d5d29839-788f-4d23-99ee-82b49ff1bbf1" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/tweets/d5d 29839-788 f-4d 23-99ee-82 b49 f1 bbf 1</a><br/>Body:x-www-form-urlencoded<br/>KEY:id<br/>VALUE:您的 id</p><h2 id="3545" class="ml jw in bd jx mm mn dn kb mo mp dp kf le mq mr kj li ms mt kn lm mu mv kr mw bi translated">Nest 应用</h2><p id="72b2" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">后端嵌套 MongoDB</p><p id="b425" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">是时候创建将连接到 MongoDB 的 Nest 后端了。进入文件夹<strong class="kv io">complete-react-developer</strong>并运行下面的命令。选择您首选的软件包管理器，我将选择 npm。如果您选择了不同的选项，记得稍后运行正确的命令。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="0c9f" class="ml jw in nc b gy ng nh l ni nj">nest new backend-nest-mongodb</span></pre><p id="161d" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">在代码编辑器中打开项目，准备生成一些控制器和服务文件。我们还将首先在命令行中把 mongose<code class="fe nk nl nm nc b">cd</code>安装到<strong class="kv io">后端-nest-mongodb </strong>文件夹中，并运行下面的命令。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="0396" class="ml jw in nc b gy ng nh l ni nj">cd backend-nest-mongodb<br/>npm install --save @nestjs/mongoose mongoose<br/>nest g controller twitter<br/>nest g service twitter</span></pre><p id="ca7b" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">在我们创建其他项目文件之前，让我们做一些文件清理。删除以下文件:</p><p id="8c71" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">app.service.ts</code><br/><code class="fe nk nl nm nc b">app.controller.ts</code><br/>T3】</p><p id="e9d3" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">现在是时候为这个项目创建其余的文件了。进入<strong class="kv io"> backend-nest-mongodb </strong>的根文件夹，运行下面的命令。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="7a67" class="ml jw in nc b gy ng nh l ni nj">touch src/twitter/twitter.module.ts<br/>mkdir src/twitter/{dto,schemas}<br/>touch src/twitter/dto/create-twitter.dto.ts<br/>touch src/twitter/schemas/twitter.schema.ts</span></pre><p id="3d0c" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">我们已经创建了该项目所需的所有文件，现在让我们添加代码。用下面的代码添加或替换现有文件中的代码:</p><p id="af19" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">app.module.ts</code></p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="569e" class="ml jw in nc b gy ng nh l ni nj">import { Module } from '@nestjs/common';</span><span id="dd9b" class="ml jw in nc b gy no nh l ni nj">import { MongooseModule } from '@nestjs/mongoose';</span><span id="5476" class="ml jw in nc b gy no nh l ni nj">import { TwitterController } from './twitter/twitter.controller';</span><span id="47b4" class="ml jw in nc b gy no nh l ni nj">import { TwitterService } from './twitter/twitter.service';</span><span id="8930" class="ml jw in nc b gy no nh l ni nj">import { TwitterModule } from './twitter/twitter.module';</span><span id="fc99" class="ml jw in nc b gy no nh l ni nj">@Module({<br/>    imports: [<br/>        TwitterModule,</span><span id="d253" class="ml jw in nc b gy no nh l ni nj">        // Local MongoDb database</span><span id="dff7" class="ml jw in nc b gy no nh l ni nj">        // Change the port to 127.0.0.1:2717 to connect to Docker</span><span id="8150" class="ml jw in nc b gy no nh l ni nj">        MongooseModule.forRoot('mongodb://127.0.0.1:27017/twitter'),<br/>    ],</span><span id="25dc" class="ml jw in nc b gy no nh l ni nj">    controllers: [TwitterController],</span><span id="3abe" class="ml jw in nc b gy no nh l ni nj">    providers: [TwitterService],<br/>})<br/>export class AppModule {}</span></pre><p id="4b7a" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">twitter.service.ts</code></p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="eada" class="ml jw in nc b gy ng nh l ni nj">import { Model } from 'mongoose';</span><span id="d626" class="ml jw in nc b gy no nh l ni nj">import { Injectable } from '@nestjs/common';</span><span id="0c9c" class="ml jw in nc b gy no nh l ni nj">import { InjectModel } from '@nestjs/mongoose';</span><span id="f4e5" class="ml jw in nc b gy no nh l ni nj">import { Twitter, TwitterDocument } from './schemas/twitter.schema';</span><span id="6b44" class="ml jw in nc b gy no nh l ni nj">import { CreateTwitterDto } from './dto/create-twitter.dto';</span><span id="1e80" class="ml jw in nc b gy no nh l ni nj">@Injectable()<br/>export class TwitterService {<br/>    constructor(@InjectModel(Twitter.name) private twitterModel: Model&lt;TwitterDocument&gt;) {}</span><span id="88b5" class="ml jw in nc b gy no nh l ni nj">    async create(createTwitterDto: CreateTwitterDto): Promise&lt;Twitter&gt; {<br/>        const createdTwitter = new this.twitterModel(createTwitterDto);</span><span id="c6ab" class="ml jw in nc b gy no nh l ni nj">        return createdTwitter.save();<br/>    }</span><span id="059c" class="ml jw in nc b gy no nh l ni nj">    async findAll(): Promise&lt;Twitter[]&gt; {<br/>        return this.twitterModel.find().exec();<br/>    }</span><span id="dd14" class="ml jw in nc b gy no nh l ni nj">    async findOne(id: string): Promise&lt;Twitter&gt; {<br/>        return this.twitterModel.findOne({ _id: id });<br/>    }</span><span id="1dd5" class="ml jw in nc b gy no nh l ni nj">    async update(id: string, twitter: Twitter): Promise&lt;Twitter&gt; {<br/>        return this.twitterModel.findByIdAndUpdate(id, twitter, { new: true });<br/>    }</span><span id="1337" class="ml jw in nc b gy no nh l ni nj">    async delete(id: string): Promise&lt;Twitter&gt; {<br/>        return this.twitterModel.findByIdAndRemove({ _id: id });<br/>    }<br/>}</span></pre><p id="d92e" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">twitter.module.ts</code></p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="ec6f" class="ml jw in nc b gy ng nh l ni nj">import { Module } from '@nestjs/common';</span><span id="5618" class="ml jw in nc b gy no nh l ni nj">import { MongooseModule } from '@nestjs/mongoose';</span><span id="d140" class="ml jw in nc b gy no nh l ni nj">import { Twitter, TwitterSchema } from './schemas/twitter.schema';</span><span id="f084" class="ml jw in nc b gy no nh l ni nj">@Module({<br/>    imports: [MongooseModule.forFeature([{ name: Twitter.name, schema: TwitterSchema }])],</span><span id="b6c3" class="ml jw in nc b gy no nh l ni nj">    exports: [MongooseModule],<br/>})<br/>export class TwitterModule {}</span></pre><p id="da31" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">twitter.controller.ts</code></p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="7da4" class="ml jw in nc b gy ng nh l ni nj">import { Controller, Get, Post, Body, Param, Put, Delete } from '@nestjs/common';</span><span id="7a76" class="ml jw in nc b gy no nh l ni nj">import { CreateTwitterDto, TwitterDto } from './dto/create-twitter.dto';</span><span id="fb6f" class="ml jw in nc b gy no nh l ni nj">import { TwitterService } from './twitter.service';</span><span id="2052" class="ml jw in nc b gy no nh l ni nj">@Controller('tweets')<br/>export class TwitterController {<br/>    constructor(private twitterService: TwitterService) {}</span><span id="9182" class="ml jw in nc b gy no nh l ni nj">    @Post()<br/>    async create(@Body() createTwitterDto: CreateTwitterDto) {<br/>        this.twitterService.create(createTwitterDto);<br/>    }</span><span id="a7fd" class="ml jw in nc b gy no nh l ni nj">    @Get()<br/>    async findAll(): Promise&lt;TwitterDto[]&gt; {<br/>        return this.twitterService.findAll();<br/>    }</span><span id="06da" class="ml jw in nc b gy no nh l ni nj">    @Get(':id')<br/>    async findOne(@Param('id') id): Promise&lt;TwitterDto&gt; {<br/>        return this.twitterService.findOne(id);<br/>    }</span><span id="7764" class="ml jw in nc b gy no nh l ni nj">    @Put(':id')<br/>    update(<br/>        @Body() updateTwitterDto: CreateTwitterDto,</span><span id="50d5" class="ml jw in nc b gy no nh l ni nj">        @Param('id') id<br/>    ): Promise&lt;TwitterDto&gt; {<br/>        return this.twitterService.update(id, updateTwitterDto);<br/>    }</span><span id="b8a6" class="ml jw in nc b gy no nh l ni nj">    @Delete(':id')<br/>    delete(@Param('id') id): Promise&lt;TwitterDto&gt; {<br/>        return this.twitterService.delete(id);<br/>    }<br/>}</span></pre><p id="94fb" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">schemas/twitter.schema.ts</code></p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="dff3" class="ml jw in nc b gy ng nh l ni nj">import { Prop, Schema, SchemaFactory } from '@nestjs/mongoose';</span><span id="54f1" class="ml jw in nc b gy no nh l ni nj">import { Document } from 'mongoose';</span><span id="d42c" class="ml jw in nc b gy no nh l ni nj">export type TwitterDocument = Twitter &amp; Document;</span><span id="d292" class="ml jw in nc b gy no nh l ni nj">@Schema()<br/>export class Twitter {<br/>    @Prop()<br/>    tweet: string;</span><span id="de45" class="ml jw in nc b gy no nh l ni nj">    @Prop()<br/>    img: string;<br/>}</span><span id="beb9" class="ml jw in nc b gy no nh l ni nj">export const TwitterSchema = SchemaFactory.createForClass(Twitter);</span></pre><p id="a3ef" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">dto/create-twitter.dto.ts</code></p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="c994" class="ml jw in nc b gy ng nh l ni nj">export class CreateTwitterDto {<br/>    id?: string;</span><span id="d0fe" class="ml jw in nc b gy no nh l ni nj">    tweet: string;</span><span id="6b98" class="ml jw in nc b gy no nh l ni nj">    img: string;<br/>}</span><span id="a4d3" class="ml jw in nc b gy no nh l ni nj">export class TwitterDto {<br/>    id?: string;</span><span id="e626" class="ml jw in nc b gy no nh l ni nj">    tweet: string;</span><span id="4fcc" class="ml jw in nc b gy no nh l ni nj">    img: string;<br/>}</span></pre><p id="82b7" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">现在一切都应该设置好了，后端被配置为连接到本地 MongoDB 数据库。您可以通过编辑<code class="fe nk nl nm nc b">app.module.ts</code>文件中的连接字符串将其更改为 Docker。</p><p id="c5f2" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">运行下面的命令以监视模式启动应用程序。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="6fd2" class="ml jw in nc b gy ng nh l ni nj">npm run start:dev</span></pre><p id="07f9" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">值得一提的是，默认情况下，NestJS 应用程序运行在端口 3000 上，这是我们的 React 应用程序将要使用的默认端口。因此，为了保持一致性，您可能希望将其更改为 8080 或不同的端口。您可以在<code class="fe nk nl nm nc b">main.ts</code>文件中完成此操作。你还需要启用 CORS，否则当你试图连接后端到前端时，你会得到那个烦人的 CORS 错误。</p><p id="a372" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">main.ts</code></p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="6115" class="ml jw in nc b gy ng nh l ni nj">import { NestFactory } from '@nestjs/core';</span><span id="4fe1" class="ml jw in nc b gy no nh l ni nj">import { AppModule } from './app.module';</span><span id="b9c8" class="ml jw in nc b gy no nh l ni nj">async function bootstrap() {<br/>    const app = await NestFactory.create(AppModule);</span><span id="204c" class="ml jw in nc b gy no nh l ni nj">    app.enableCors();</span><span id="b45e" class="ml jw in nc b gy no nh l ni nj">    await app.listen(8080);<br/>}</span><span id="9682" class="ml jw in nc b gy no nh l ni nj">bootstrap();</span></pre><p id="ca12" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">路由应该和以前一样，这里是一个复习，你可以在 Postman 或者你正在使用的任何 REST API 工具中测试:</p><p id="92cc" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">获取所有推文</p><p id="a63c" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">请求:获取<br/>路线:<a class="ae lr" href="http://localhost:8080/tweets" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/tweets</a></p><p id="26f6" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">通过 ID 获取推文</p><p id="ce8c" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">请求:获取<br/>路线:<a class="ae lr" href="http://localhost:8080/tweets/d5d29839-788f-4d23-99ee-82b49ff1bbf1" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/tweets/d5d 29839-788 f-4d 23-99ee-82 b49 f1 bbf 1</a></p><p id="0dc4" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">创建推文</p><p id="c85f" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">请求:发布<br/>路线:<a class="ae lr" href="http://localhost:8080/tweets" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/tweets</a><br/>Body raw:{ " tweet ":' Hello World '，img: ""}</p><p id="4b16" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">按 ID 更新推文</p><p id="d191" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">请求:放<br/>路线:<a class="ae lr" href="http://localhost:8080/tweets/d5d29839-788f-4d23-99ee-82b49ff1bbf1" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/tweets/d5d 29839-788 f-4d 23-99ee-82 b49 f1 bbf 1</a><br/>Body raw:{ " tweet ":' Hello Moon '，img: ""}</p><p id="31e5" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">按 ID 删除推文</p><p id="9f5a" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">请求:删除<br/>路线:<a class="ae lr" href="http://localhost:8080/tweets/d5d29839-788f-4d23-99ee-82b49ff1bbf1" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/tweets/d5d 29839-788 f-4d 23-99ee-82 b49 f1 bbf 1</a></p><p id="9802" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">后端嵌套 PostgreSQL</p><p id="2ff3" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">最后，我们现在将创建连接到 PostgreSQL 的嵌套后端。在这个阶段之后，我们将最终转移到 React 前端。确保您在文件夹<strong class="kv io">complete-react-developer</strong>中，并运行下面的命令。与上一章选择您的首选软件包管理器一样，我将选择 npm。如果您选择了不同的选项，记得稍后运行正确的命令。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="9b90" class="ml jw in nc b gy ng nh l ni nj">nest new backend-nest-postgresql</span></pre><p id="2f49" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">在代码编辑器中打开项目，准备生成一些控制器和服务文件。我们还将安装 PostgreSQL 和<a class="ae lr" href="https://github.com/typeorm/typeorm" rel="noopener ugc nofollow" target="_blank"> TypeORM </a>，这样我们就可以连接到 PostgreSQL 数据库。首先<code class="fe nk nl nm nc b">cd</code>进入命令行中的<strong class="kv io">back end-nest-PostgreSQL</strong>文件夹，运行下面的命令。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="bd5d" class="ml jw in nc b gy ng nh l ni nj">cd backend-nest-postgresql<br/>npm install --save pg @nestjs/typeorm typeorm<br/>nest g controller twitter<br/>nest g service twitter</span></pre><p id="adf8" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">在我们创建其他项目文件之前，让我们做一些文件清理。删除以下文件:</p><p id="486f" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">app.service.ts</code><br/><code class="fe nk nl nm nc b">app.controller.ts</code><br/>T3】</p><p id="0ed2" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">现在是时候为这个项目创建其余的文件了。当你在<strong class="kv io">back end-nest-PostgreSQL</strong>的根文件夹中时，运行下面的命令。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="3715" class="ml jw in nc b gy ng nh l ni nj">touch src/twitter/{twitter.module.ts,twitter.entity.ts}<br/>mkdir src/twitter/dto<br/>touch src/twitter/dto/twitter.dto.ts</span></pre><p id="9d0c" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">我们已经创建了该项目所需的所有文件，现在让我们添加代码。用下面的代码添加或替换现有文件中的代码:</p><p id="bbb1" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">app.module.ts</code></p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="1778" class="ml jw in nc b gy ng nh l ni nj">import { Module } from '@nestjs/common';</span><span id="36f0" class="ml jw in nc b gy no nh l ni nj">import { TypeOrmModule } from '@nestjs/typeorm';</span><span id="68e9" class="ml jw in nc b gy no nh l ni nj">import { TwitterController } from './twitter/twitter.controller';</span><span id="e794" class="ml jw in nc b gy no nh l ni nj">import { TwitterService } from './twitter/twitter.service';</span><span id="b02d" class="ml jw in nc b gy no nh l ni nj">import { TwitterModule } from './twitter/twitter.module';</span><span id="6332" class="ml jw in nc b gy no nh l ni nj">import { Connection } from 'typeorm';</span><span id="8a34" class="ml jw in nc b gy no nh l ni nj">@Module({<br/>    imports: [<br/>        TypeOrmModule.forRoot({<br/>            type: 'postgres',</span><span id="a542" class="ml jw in nc b gy no nh l ni nj">            host: 'localhost',</span><span id="d01c" class="ml jw in nc b gy no nh l ni nj">            port: 5432,</span><span id="5bb8" class="ml jw in nc b gy no nh l ni nj">            username: 'postgres',</span><span id="bb75" class="ml jw in nc b gy no nh l ni nj">            password: '',</span><span id="10ef" class="ml jw in nc b gy no nh l ni nj">            database: 'twitter',</span><span id="f559" class="ml jw in nc b gy no nh l ni nj">            entities: ['dist/**/*.entity{.ts,.js}'],</span><span id="36e2" class="ml jw in nc b gy no nh l ni nj">            synchronize: false,<br/>        }),</span><span id="f740" class="ml jw in nc b gy no nh l ni nj">        TwitterModule,<br/>    ],</span><span id="365c" class="ml jw in nc b gy no nh l ni nj">    controllers: [TwitterController],</span><span id="74aa" class="ml jw in nc b gy no nh l ni nj">    providers: [TwitterService],<br/>})<br/>export class AppModule {<br/>    constructor(private connection: Connection) {}<br/>}</span></pre><p id="ee85" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">twitter.service.ts</code></p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="11d5" class="ml jw in nc b gy ng nh l ni nj">import { Injectable, NotFoundException } from '@nestjs/common';</span><span id="e4ce" class="ml jw in nc b gy no nh l ni nj">import { InjectRepository } from '@nestjs/typeorm';</span><span id="c4ce" class="ml jw in nc b gy no nh l ni nj">import { DeleteResult, InsertResult, Repository } from 'typeorm';</span><span id="234e" class="ml jw in nc b gy no nh l ni nj">import { Twitter } from './twitter.entity';</span><span id="0b74" class="ml jw in nc b gy no nh l ni nj">@Injectable()<br/>export class TwitterService {<br/>    constructor(<br/>        @InjectRepository(Twitter)<br/>        private twitterRepository: Repository&lt;Twitter&gt;<br/>    ) {}</span><span id="718a" class="ml jw in nc b gy no nh l ni nj">    async addTwitter(twitter: Twitter): Promise&lt;InsertResult&gt; {<br/>        return this.twitterRepository.insert(twitter);<br/>    }</span><span id="f48e" class="ml jw in nc b gy no nh l ni nj">    async findAll(): Promise&lt;Twitter[]&gt; {<br/>        return this.twitterRepository.find();<br/>    }</span><span id="893a" class="ml jw in nc b gy no nh l ni nj">    async findOne(id: string): Promise&lt;Twitter&gt; {<br/>        return this.twitterRepository.findOne(id);<br/>    }</span><span id="59a3" class="ml jw in nc b gy no nh l ni nj">    async update(id: string, twitter: Twitter): Promise&lt;Twitter&gt; {<br/>        const twitterUpdate = await this.findOne(id);</span><span id="549d" class="ml jw in nc b gy no nh l ni nj">        if (twitterUpdate === undefined) {<br/>            throw new NotFoundException();<br/>        }</span><span id="f651" class="ml jw in nc b gy no nh l ni nj">        await this.twitterRepository.update(id, twitter);</span><span id="3d1a" class="ml jw in nc b gy no nh l ni nj">        return this.twitterRepository.findOne(id);<br/>    }</span><span id="4912" class="ml jw in nc b gy no nh l ni nj">    async delete(id: string): Promise&lt;DeleteResult&gt; {<br/>        const twitterUpdate = await this.findOne(id);</span><span id="a9e5" class="ml jw in nc b gy no nh l ni nj">        if (twitterUpdate === undefined) {<br/>            throw new NotFoundException();<br/>        }</span><span id="570d" class="ml jw in nc b gy no nh l ni nj">        return this.twitterRepository.delete(id);<br/>    }<br/>}</span></pre><p id="b169" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">twitter.module.ts</code></p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="900b" class="ml jw in nc b gy ng nh l ni nj">import { Module } from '@nestjs/common';</span><span id="e0c0" class="ml jw in nc b gy no nh l ni nj">import { TypeOrmModule } from '@nestjs/typeorm';</span><span id="1d25" class="ml jw in nc b gy no nh l ni nj">import { TwitterController } from './twitter.controller';</span><span id="d033" class="ml jw in nc b gy no nh l ni nj">import { TwitterService } from './twitter.service';</span><span id="e85f" class="ml jw in nc b gy no nh l ni nj">import { Twitter } from './twitter.entity';</span><span id="bfe5" class="ml jw in nc b gy no nh l ni nj">@Module({<br/>    imports: [TypeOrmModule.forFeature([Twitter])],</span><span id="fe0d" class="ml jw in nc b gy no nh l ni nj">    controllers: [TwitterController],</span><span id="f1ea" class="ml jw in nc b gy no nh l ni nj">    providers: [TwitterService],</span><span id="9c43" class="ml jw in nc b gy no nh l ni nj">    exports: [TypeOrmModule],<br/>})<br/>export class TwitterModule {}</span></pre><p id="fbd5" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">twitter.entity.ts</code></p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="3253" class="ml jw in nc b gy ng nh l ni nj">import { Entity, Column, PrimaryGeneratedColumn } from 'typeorm';</span><span id="8a24" class="ml jw in nc b gy no nh l ni nj">@Entity()<br/>export class Twitter {<br/>    @PrimaryGeneratedColumn('uuid')<br/>    id: string;</span><span id="4454" class="ml jw in nc b gy no nh l ni nj">    @Column()<br/>    tweet: string;</span><span id="104f" class="ml jw in nc b gy no nh l ni nj">    @Column()<br/>    img: string;<br/>}</span></pre><p id="641a" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">twitter.controller.ts</code></p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="9a94" class="ml jw in nc b gy ng nh l ni nj">import { Controller, Get, Post, Patch, Delete, Param, Body } from '@nestjs/common';</span><span id="a443" class="ml jw in nc b gy no nh l ni nj">import { TwitterService } from './twitter.service';</span><span id="48c6" class="ml jw in nc b gy no nh l ni nj">import { TwitterDto } from './dto/twitter.dto';</span><span id="f536" class="ml jw in nc b gy no nh l ni nj">import { Twitter } from './twitter.entity';</span><span id="2a15" class="ml jw in nc b gy no nh l ni nj">@Controller('tweets')<br/>export class TwitterController {<br/>    constructor(private twitterService: TwitterService) {}</span><span id="0244" class="ml jw in nc b gy no nh l ni nj">    @Post()<br/>    create(@Body() twitter: Twitter) {<br/>        return this.twitterService.addTwitter(twitter);<br/>    }</span><span id="efc1" class="ml jw in nc b gy no nh l ni nj">    @Get()<br/>    findAll(): Promise&lt;TwitterDto[]&gt; {<br/>        return this.twitterService.findAll();<br/>    }</span><span id="86b1" class="ml jw in nc b gy no nh l ni nj">    @Get(':id')<br/>    getOneTwitter(@Param('id') id: string): Promise&lt;Twitter&gt; {<br/>        return this.twitterService.findOne(id);<br/>    }</span><span id="5b0e" class="ml jw in nc b gy no nh l ni nj">    @Patch(':id')<br/>    updateTwitter(<br/>        @Param('id') id: string,</span><span id="3bb0" class="ml jw in nc b gy no nh l ni nj">        @Body() twitter: Twitter<br/>    ): Promise&lt;Twitter&gt; {<br/>        return this.twitterService.update(id, twitter);<br/>    }</span><span id="41fb" class="ml jw in nc b gy no nh l ni nj">    @Delete(':id')<br/>    deleteTwitter(@Param('id') id: string) {<br/>        return this.twitterService.delete(id);<br/>    }<br/>}</span></pre><p id="caed" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">dto/twitter.dto.ts</code></p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="f020" class="ml jw in nc b gy ng nh l ni nj">export class TwitterDto {<br/>    tweet: string;</span><span id="2e81" class="ml jw in nc b gy no nh l ni nj">    img: string;<br/>}</span></pre><p id="420d" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">现在一切都应该设置好了，后端被配置为连接到本地 PostgreSQL 数据库。您可以通过编辑<code class="fe nk nl nm nc b">app.module.ts</code>文件中的连接细节将其更改为 Docker。</p><p id="26ac" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">有一点值得注意，尽管这个应用程序使用了一个名为<strong class="kv io"> twitter </strong>的数据库表。查看示例 SQL，您可以使用它来生成一些快速测试数据。如果你得到一个错误，可能是因为它期望找到一个名为<strong class="kv io"> twitter </strong>的表。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="6d7f" class="ml jw in nc b gy ng nh l ni nj">CREATE TABLE twitter (</span><span id="aa67" class="ml jw in nc b gy no nh l ni nj">id UUID DEFAULT gen_random_uuid (),</span><span id="0ee0" class="ml jw in nc b gy no nh l ni nj">tweet VARCHAR(280) NOT NULL,</span><span id="f21c" class="ml jw in nc b gy no nh l ni nj">img VARCHAR(500) NOT NULL</span><span id="99c9" class="ml jw in nc b gy no nh l ni nj">);</span><span id="4e7b" class="ml jw in nc b gy no nh l ni nj">INSERT INTO twitter (tweet, img)</span><span id="fe41" class="ml jw in nc b gy no nh l ni nj">VALUES ('Hello World!', ''), ('Content creation and programming are basically full time jobs. I have enough projects and work to keep me busy for years. Working in tech is definitely going to entertain you for a long time which is why so many people want to transition into this field.', ''), ('JavaScript developers are forever in high demand', '');</span></pre><p id="097a" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">运行下面的命令以监视模式启动应用程序。像以前一样，这些路线非常相似，但也有一些不同。另外不要忘记在<code class="fe nk nl nm nc b">main.ts</code>文件中把端口改成 8080。像以前一样，你将需要启用 CORS，否则当你试图连接后端到前端时，你会得到那个恼人的 CORS 错误。</p><p id="3a8f" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">main.ts</code></p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="75ba" class="ml jw in nc b gy ng nh l ni nj">import { NestFactory } from '@nestjs/core';</span><span id="a0ca" class="ml jw in nc b gy no nh l ni nj">import { AppModule } from './app.module';</span><span id="0d3d" class="ml jw in nc b gy no nh l ni nj">async function bootstrap() {<br/>    const app = await NestFactory.create(AppModule);</span><span id="ffc8" class="ml jw in nc b gy no nh l ni nj">    app.enableCors();</span><span id="57ed" class="ml jw in nc b gy no nh l ni nj">    await app.listen(8080);<br/>}</span><span id="d935" class="ml jw in nc b gy no nh l ni nj">bootstrap();</span><span id="13a7" class="ml jw in nc b gy no nh l ni nj">npm run start:dev</span></pre><p id="e890" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">您可以在 Postman 或您正在使用的任何 REST API 工具中进行测试:</p><p id="1895" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">获取所有推文</p><p id="b753" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">请求:获取<br/>路线:<a class="ae lr" href="http://localhost:8080/tweets" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/tweets</a></p><p id="7bc0" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">通过 ID 获取推文</p><p id="2ef6" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">请求:获取<br/>路线:<a class="ae lr" href="http://localhost:8080/tweets/d5d29839-788f-4d23-99ee-82b49ff1bbf1" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/tweets/d5d 29839-788 f-4d 23-99ee-82 b49 f1 bbf 1</a></p><p id="48e1" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">创建推文</p><p id="ed4c" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">请求:发布<br/>路线:<a class="ae lr" href="http://localhost:8080/tweets" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/tweets</a><br/>Body raw:{ " tweet ":' Hello World '，img: ""}</p><p id="c717" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">按 ID 更新推文</p><p id="09c5" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">请求:补丁<br/>路由:<a class="ae lr" href="http://localhost:8080/tweets/d5d29839-788f-4d23-99ee-82b49ff1bbf1" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/tweets/d5d 29839-788 f-4d 23-99ee-82 b49 ff 1 bbf 1</a><br/>Body raw:{ " tweet ":' Hello Moon '，img: ""}</p><p id="05b8" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">按 ID 删除推文</p><p id="b207" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">请求:删除<br/>路线:<a class="ae lr" href="http://localhost:8080/tweets/d5d29839-788f-4d23-99ee-82b49ff1bbf1" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/tweets/d5d 29839-788 f-4d 23-99ee-82 b49 f1 bbf 1</a><br/>正文:x-www-form-urlencoded<br/>KEY:id<br/>VALUE:您的 id</p><h1 id="b7e4" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">设置前端</h1><p id="3f72" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">我们终于到达了前端部分！它不会像我们刚刚完成的后端部分那么长，因为只有一个 React 前端！</p><h1 id="9cc3" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">构建 Twitter 克隆应用</h1><p id="763a" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">该应用程序将是一个非常简单的 Twitter 克隆。你可以创建、阅读和删除推文。没有更新/编辑推文的选项，反正现在就是这样😂然而，用于更新的端点已经存在于后端，所以如果您愿意，您可以实现它。顺便说一下，这不是一个 Twitter 的克隆课程，所以不要指望它是像素完美和 100%准确😁</p><p id="0148" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">代码库非常大，所以我没有复制和粘贴代码十几次，也没有经历漫长的项目设置，而是创建了应用程序，并将其放在 GitHub 上。因此，您需要做的就是克隆/下载代码库并运行安装脚本。</p><p id="e818" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">【https://github.com/andrewbaisden/complete-react-developer T4】</p><p id="6664" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">接下来，在代码编辑器中打开项目，查看代码库，并在各自的根文件夹中使用下面的命令。安装说明也在自述文件中。</p><h1 id="e63e" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">设置</h1><p id="bb27" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">在你的电脑上启动 Docker 桌面应用程序</p><p id="c005" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">cd</code>放入根文件夹中的<strong class="kv io"> backend-nest-mongodb </strong>和<strong class="kv io"> frontend </strong>，然后运行下面的命令来安装依赖项。在这种情况下，当试图安装前端 React 应用程序的依赖项时，您可能需要强制安装，否则它可能会给你一个错误。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="5139" class="ml jw in nc b gy ng nh l ni nj"># Run this command inside of the backend-nest-mongodb folder<br/>npm install</span><span id="8ce5" class="ml jw in nc b gy no nh l ni nj"># Run this command inside of the frontend folder<br/>npm install --force</span></pre><p id="11a9" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">cd</code>到根文件夹<strong class="kv io"> docker-twitter-mongodb </strong>中，运行下面的命令在 docker 容器中启动 mongodb 数据库。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="517a" class="ml jw in nc b gy ng nh l ni nj">docker compose up</span></pre><p id="5bed" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">cd</code>到根文件夹<strong class="kv io"> backend-nest-mongodb </strong>，运行下面的命令启动后端 NestJS 服务器。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="62d1" class="ml jw in nc b gy ng nh l ni nj">npm run start:dev</span></pre><p id="48e8" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">cd</code>进入<strong class="kv io">前端</strong>的根文件夹，运行下面的命令启动前端 React 服务器。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="554c" class="ml jw in nc b gy ng nh l ni nj">npm run start</span></pre><p id="1335" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">如果您想在 REST API 工具中测试它们，请使用来自<strong class="kv io">后端 Nest MongoDB </strong>部分的路由。</p><h1 id="4858" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">Twitter 克隆应用</h1><p id="e81c" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">您应该看到您的数据库在 Docker 容器中运行，您的 Twitter 克隆 React 应用程序在浏览器中打开。</p><p id="e49b" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">在 frontend 的根文件夹中运行这些命令，这是 React 所在的位置。下面的命令启动故事书。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="75b0" class="ml jw in nc b gy ng nh l ni nj"># Starts Storybook<br/>npm run storybook</span></pre><p id="f0f6" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">您应该会看到浏览器中打开了一个故事书组件库，其中有一个用于撰写 tweets 的组件。您可以尝试更改控件中的名称，看看它在演示中是什么样子。下面的命令运行单元和集成测试。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="400b" class="ml jw in nc b gy ng nh l ni nj"># Runs the React testing library unit and integration tests<br/>npm run test</span></pre><p id="db14" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">您可能需要按下<strong class="kv io"> a </strong>或<strong class="kv io"> Enter </strong>来触发新的测试运行。所有的测试都应该在你的控制台上通过。下面的命令启动 Cypress。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="9c30" class="ml jw in nc b gy ng nh l ni nj"># Runs the Cypress End-To-End tests<br/>npx cypress open</span></pre><p id="3ca3" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">应该会打开一扇新的柏树窗户。运行集成测试，准备好大吃一惊吧，它会自动为你发布 3 条推文！用 React 应用程序重新加载网页，你也会看到新的推文！</p><h1 id="4ed1" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">上下文 API</h1><p id="56c6" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">这个应用程序使用全局状态的上下文 API。如果您想让应用程序连接到您的 MongoDB、PostgreSQL 或 Docker 数据库，那么您需要更改 API 路由和端口号<a class="ae lr" href="http://localhost:8080/tweets" rel="noopener ugc nofollow" target="_blank">。这同样适用于方法，不要忘记他们中的一些使用 POST，PUT，PATCH，DELETE 等。这取决于你使用的后端。</a></p><p id="d17c" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">src/contexts/TwitterContext.tsx</code></p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="b1df" class="ml jw in nc b gy ng nh l ni nj">import { useEffect, useState, createContext, useContext } from 'react';</span><span id="72f2" class="ml jw in nc b gy no nh l ni nj">interface ContextProps {<br/>    data: any;</span><span id="76f5" class="ml jw in nc b gy no nh l ni nj">    loading: boolean;</span><span id="5ea9" class="ml jw in nc b gy no nh l ni nj">    handleToggleComposetweet: any;</span><span id="9be9" class="ml jw in nc b gy no nh l ni nj">    toggleComposeTweet: boolean;</span><span id="3350" class="ml jw in nc b gy no nh l ni nj">    tweet: string;</span><span id="f5bf" class="ml jw in nc b gy no nh l ni nj">    setTweet: any;</span><span id="f416" class="ml jw in nc b gy no nh l ni nj">    postTweet: any;</span><span id="5a31" class="ml jw in nc b gy no nh l ni nj">    deleteTweet: any;<br/>}</span><span id="293f" class="ml jw in nc b gy no nh l ni nj">const TwitterContext = createContext({} as ContextProps);</span><span id="f3b0" class="ml jw in nc b gy no nh l ni nj">export const useTwitter = () =&gt; useContext(TwitterContext);</span><span id="3424" class="ml jw in nc b gy no nh l ni nj">const TwitterContextProvider = (props: any): any =&gt; {<br/>    useEffect(() =&gt; {<br/>        const getTweets = () =&gt; {<br/>            const API = 'http://localhost:8080/tweets';</span><span id="0a81" class="ml jw in nc b gy no nh l ni nj">            fetch(API)<br/>                .then((response) =&gt; {<br/>                    console.log(response);</span><span id="4f41" class="ml jw in nc b gy no nh l ni nj">                    return response.json();<br/>                })</span><span id="dbf7" class="ml jw in nc b gy no nh l ni nj">                .then((data) =&gt; {<br/>                    console.log(data);</span><span id="1c21" class="ml jw in nc b gy no nh l ni nj">                    setLoading(false);</span><span id="c15a" class="ml jw in nc b gy no nh l ni nj">                    setData(data);<br/>                })</span><span id="80c5" class="ml jw in nc b gy no nh l ni nj">                .catch((err) =&gt; {<br/>                    console.log(err);<br/>                });<br/>        };</span><span id="e3ae" class="ml jw in nc b gy no nh l ni nj">        getTweets();<br/>    }, []);</span><span id="d3bb" class="ml jw in nc b gy no nh l ni nj">    const [data, setData] = useState([]);</span><span id="fffb" class="ml jw in nc b gy no nh l ni nj">    const [loading, setLoading] = useState(true);</span><span id="bfef" class="ml jw in nc b gy no nh l ni nj">    const [toggleComposeTweet, setToggleComposeTweet] = useState(false);</span><span id="e14a" class="ml jw in nc b gy no nh l ni nj">    const [tweet, setTweet] = useState('');</span><span id="c044" class="ml jw in nc b gy no nh l ni nj">    const handleToggleComposetweet = () =&gt; {<br/>        toggleComposeTweet === true ? setToggleComposeTweet(false) : setToggleComposeTweet(true);<br/>    };</span><span id="15c6" class="ml jw in nc b gy no nh l ni nj">    const postTweet = () =&gt; {<br/>        if (tweet === '') {<br/>            let myHeaders = new Headers();</span><span id="34a5" class="ml jw in nc b gy no nh l ni nj">            myHeaders.append('Content-Type', 'application/json');</span><span id="a995" class="ml jw in nc b gy no nh l ni nj">            let raw = JSON.stringify({<br/>                tweet: 'Congratulations this is what happens when you post an empty tweet 🤪 Create some validation 🙃',</span><span id="f453" class="ml jw in nc b gy no nh l ni nj">                img: '',<br/>            });</span><span id="d54d" class="ml jw in nc b gy no nh l ni nj">            fetch('http://localhost:8080/tweets', { method: 'POST', headers: myHeaders, body: raw, redirect: 'follow' })<br/>                .then((response) =&gt; response.text())</span><span id="09fa" class="ml jw in nc b gy no nh l ni nj">                .then((result) =&gt; console.log(result))</span><span id="cdcb" class="ml jw in nc b gy no nh l ni nj">                .catch((error) =&gt; console.log('error', error));<br/>        } else {<br/>            let myHeaders = new Headers();</span><span id="b28d" class="ml jw in nc b gy no nh l ni nj">            myHeaders.append('Content-Type', 'application/json');</span><span id="e49f" class="ml jw in nc b gy no nh l ni nj">            let raw = JSON.stringify({<br/>                tweet: tweet,</span><span id="614a" class="ml jw in nc b gy no nh l ni nj">                img: '',<br/>            });</span><span id="2504" class="ml jw in nc b gy no nh l ni nj">            fetch('http://localhost:8080/tweets', { method: 'POST', headers: myHeaders, body: raw, redirect: 'follow' })<br/>                .then((response) =&gt; response.text())</span><span id="cb8f" class="ml jw in nc b gy no nh l ni nj">                .then((result) =&gt; console.log(result))</span><span id="743e" class="ml jw in nc b gy no nh l ni nj">                .catch((error) =&gt; console.log('error', error));<br/>        }<br/>    };</span><span id="3b8b" class="ml jw in nc b gy no nh l ni nj">    const deleteTweet = (tweetId: string) =&gt; {<br/>        console.log('Deleted', tweetId);</span><span id="bfed" class="ml jw in nc b gy no nh l ni nj">        let urlencoded = new URLSearchParams();</span><span id="7630" class="ml jw in nc b gy no nh l ni nj">        fetch(`http://localhost:8080/tweets/${tweetId}`, {<br/>            method: 'DELETE',</span><span id="5ba8" class="ml jw in nc b gy no nh l ni nj">            body: urlencoded,</span><span id="136e" class="ml jw in nc b gy no nh l ni nj">            redirect: 'follow',<br/>        })<br/>            .then((response) =&gt; response.text())</span><span id="1d8f" class="ml jw in nc b gy no nh l ni nj">            .then((result) =&gt; console.log(result))</span><span id="6a0d" class="ml jw in nc b gy no nh l ni nj">            .catch((error) =&gt; console.log('error', error));</span><span id="68dd" class="ml jw in nc b gy no nh l ni nj">        window.location.reload();<br/>    };</span><span id="bba1" class="ml jw in nc b gy no nh l ni nj">    const value = {<br/>        data,</span><span id="379c" class="ml jw in nc b gy no nh l ni nj">        loading,</span><span id="60f1" class="ml jw in nc b gy no nh l ni nj">        toggleComposeTweet,</span><span id="9a45" class="ml jw in nc b gy no nh l ni nj">        handleToggleComposetweet,</span><span id="9de2" class="ml jw in nc b gy no nh l ni nj">        postTweet,</span><span id="150a" class="ml jw in nc b gy no nh l ni nj">        tweet,</span><span id="66b7" class="ml jw in nc b gy no nh l ni nj">        setTweet,</span><span id="5491" class="ml jw in nc b gy no nh l ni nj">        deleteTweet,<br/>    };</span><span id="465c" class="ml jw in nc b gy no nh l ni nj">    return &lt;TwitterContext.Provider value={value}&gt;{props.children}&lt;/TwitterContext.Provider&gt;;<br/>};</span><span id="4275" class="ml jw in nc b gy no nh l ni nj">export default TwitterContextProvider;</span></pre><h1 id="c2b4" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">使用 React 测试库和 Jest 进行测试</h1><p id="f363" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">有两个测试文件，一个用于<code class="fe nk nl nm nc b">App.test.tsx</code>，一个用于<code class="fe nk nl nm nc b">TwitterMenu.test.tsx</code>。</p><p id="a17d" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">我将展示<code class="fe nk nl nm nc b">App.test.tsx</code>的例子。这些测试只是测试所需的文本是否显示在页面上。每个组件都应该有一个测试文件。</p><p id="da15" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">App.test.tsx</code></p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="5838" class="ml jw in nc b gy ng nh l ni nj">import { render, screen } from '@testing-library/react';</span><span id="7dd7" class="ml jw in nc b gy no nh l ni nj">import App from './App';</span><span id="104c" class="ml jw in nc b gy no nh l ni nj">describe('&lt;App /&gt;', () =&gt; {<br/>    it('has a following text label', () =&gt; {<br/>        render(&lt;App /&gt;);</span><span id="e186" class="ml jw in nc b gy no nh l ni nj">        const el = screen.getByText(/Following/i);</span><span id="4fab" class="ml jw in nc b gy no nh l ni nj">        expect(el).toBeTruthy();<br/>    });</span><span id="5e04" class="ml jw in nc b gy no nh l ni nj">    it('has a followers text label', () =&gt; {<br/>        render(&lt;App /&gt;);</span><span id="e4ca" class="ml jw in nc b gy no nh l ni nj">        const el = screen.getByText(/Followers/i);</span><span id="8ef9" class="ml jw in nc b gy no nh l ni nj">        expect(el).toBeTruthy();<br/>    });</span><span id="32cc" class="ml jw in nc b gy no nh l ni nj">    it('has a you might like heading', () =&gt; {<br/>        render(&lt;App /&gt;);</span><span id="4c13" class="ml jw in nc b gy no nh l ni nj">        const el = screen.getByText(/You might like/i);</span><span id="2809" class="ml jw in nc b gy no nh l ni nj">        expect(el.innerHTML).toBe('You might like');<br/>    });</span><span id="5c7a" class="ml jw in nc b gy no nh l ni nj">    it('has a whats happening heading', () =&gt; {<br/>        render(&lt;App /&gt;);</span><span id="8b37" class="ml jw in nc b gy no nh l ni nj">        const el = screen.getByText(/Whats happening/i);</span><span id="2ed9" class="ml jw in nc b gy no nh l ni nj">        expect(el.innerHTML).toBe('Whats happening');<br/>    });<br/>});</span></pre><h1 id="675c" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">使用 Cypress 进行端到端测试</h1><p id="b4a1" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">这个 Cypress 测试将自动发布 3 条推文。这一切都是实时完成的，推文将显示在您的数据库和实时应用程序中。</p><p id="c69c" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated"><code class="fe nk nl nm nc b">cypress/integratioin/tweet.spec.js</code></p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="2794" class="ml jw in nc b gy ng nh l ni nj">describe('user form flow', () =&gt; {<br/>    beforeEach(() =&gt; {<br/>        cy.viewport(1600, 900);</span><span id="2072" class="ml jw in nc b gy no nh l ni nj">        cy.visit('http://localhost:3000/');<br/>    });</span><span id="3a46" class="ml jw in nc b gy no nh l ni nj">    it('user posts a tweet', () =&gt; {<br/>        // Post a tweet</span><span id="74a9" class="ml jw in nc b gy no nh l ni nj">        cy.get('.compose-tweet-btn').click();</span><span id="625c" class="ml jw in nc b gy no nh l ni nj">        cy.get('textarea[name="tweet"]').type(<br/>            'What happened to all that fun you were having?! Come on, lets try to enjoy this!'<br/>        );</span><span id="991a" class="ml jw in nc b gy no nh l ni nj">        cy.wait(3000);</span><span id="20a6" class="ml jw in nc b gy no nh l ni nj">        cy.get('.post-tweet-btn').click();<br/>    });</span><span id="5d37" class="ml jw in nc b gy no nh l ni nj">    it('user posts a second tweet', () =&gt; {<br/>        // Post a tweet</span><span id="f7d5" class="ml jw in nc b gy no nh l ni nj">        cy.get('.compose-tweet-btn').click();</span><span id="d5e0" class="ml jw in nc b gy no nh l ni nj">        cy.get('textarea[name="tweet"]').type('That was an Attack on Titan easter egg 🥚 😄');</span><span id="50d2" class="ml jw in nc b gy no nh l ni nj">        cy.wait(3000);</span><span id="6cf5" class="ml jw in nc b gy no nh l ni nj">        cy.get('.post-tweet-btn').click();<br/>    });</span><span id="dffc" class="ml jw in nc b gy no nh l ni nj">    it('user posts a third tweet', () =&gt; {<br/>        // Post a tweet</span><span id="9e9a" class="ml jw in nc b gy no nh l ni nj">        cy.get('.compose-tweet-btn').click();</span><span id="dea1" class="ml jw in nc b gy no nh l ni nj">        cy.get('textarea[name="tweet"]').type(<br/>            'The Rumbling arrives on Marley 😱 https://www.youtube.com/watch?v=wT2H68kEmi8'<br/>        );</span><span id="2c82" class="ml jw in nc b gy no nh l ni nj">        cy.wait(3000);</span><span id="a4e3" class="ml jw in nc b gy no nh l ni nj">        cy.get('.post-tweet-btn').click();<br/>    });<br/>});</span></pre><h1 id="c61c" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">部署</h1><p id="4597" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">完成应用程序的构建后，最后一步是部署。你需要把你的申请放到网上，这样每个人都能看到。有几十个平台，但这里是我排名前五的平台，排名不分先后。</p><ol class=""><li id="2715" class="lx ly in kv b kw ls la lt le lz li ma lm mb lq nv md me mf bi translated"><a class="ae lr" href="https://www.netlify.com/" rel="noopener ugc nofollow" target="_blank">网络生活</a></li><li id="41ce" class="lx ly in kv b kw mg la mh le mi li mj lm mk lq nv md me mf bi translated"><a class="ae lr" href="https://vercel.com/" rel="noopener ugc nofollow" target="_blank">维尔塞尔</a></li><li id="670e" class="lx ly in kv b kw mg la mh le mi li mj lm mk lq nv md me mf bi translated"><a class="ae lr" href="https://www.heroku.com/" rel="noopener ugc nofollow" target="_blank"> Heroku </a></li><li id="1436" class="lx ly in kv b kw mg la mh le mi li mj lm mk lq nv md me mf bi translated"><a class="ae lr" href="https://www.digitalocean.com/" rel="noopener ugc nofollow" target="_blank">数字海洋</a></li><li id="434f" class="lx ly in kv b kw mg la mh le mi li mj lm mk lq nv md me mf bi translated"><a class="ae lr" href="https://aws.amazon.com/" rel="noopener ugc nofollow" target="_blank"> AWS </a></li></ol><h1 id="f88d" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">最后的想法</h1><p id="0eb6" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">我们涵盖了所有的 MERN 堆栈，包括 TypeScript、SQL、测试驱动开发、端到端测试甚至 Docker！恭喜你，你变得超级棒，因为你提升了你的技能和工作前景🔥🚀</p><p id="5d9b" class="pw-post-body-paragraph kt ku in kv b kw ls ky kz la lt lc ld le lu lg lh li lv lk ll lm lw lo lp lq ig bi translated">摆弄数据库和反应前端，你可以用它做很多事情。例如，创建更多故事书组件、集成测试、添加编辑推文的功能，以及让图片和视频等媒体显示在推文中。</p></div></div>    
</body>
</html>