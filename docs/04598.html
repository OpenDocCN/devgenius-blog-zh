<html>
<head>
<title>Snowflake and Python : The Beginning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">雪花和Python:开始</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/snowflake-and-python-the-beginning-95a9c317acbe?source=collection_archive---------3-----------------------#2021-04-08">https://blog.devgenius.io/snowflake-and-python-the-beginning-95a9c317acbe?source=collection_archive---------3-----------------------#2021-04-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/73273ce2b61a3a233d3b62ac0c4cd259.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xuYbbSzqDrCz2ZUQLtZheg.png"/></div></div></figure><p id="019d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这篇博客是关于如何开始为雪花使用Python的基础。</p><h2 id="ab57" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">先决条件</h2><ul class=""><li id="c918" class="lp lq iq ka b kb lr kf ls kj lt kn lu kr lv kv lw lx ly lz bi translated">熟悉Python。</li></ul><p id="cc08" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">本博客将包含以下内容:</strong></p><ul class=""><li id="dac8" class="lp lq iq ka b kb kc kf kg kj ma kn mb kr mc kv lw lx ly lz bi translated">如何在Windows中安装Python</li><li id="2e1c" class="lp lq iq ka b kb md kf me kj mf kn mg kr mh kv lw lx ly lz bi translated">测试已安装的Python版本。</li><li id="8f2c" class="lp lq iq ka b kb md kf me kj mf kn mg kr mh kv lw lx ly lz bi translated">如何为雪花设置Python连接器</li><li id="66a6" class="lp lq iq ka b kb md kf me kj mf kn mg kr mh kv lw lx ly lz bi translated">测试你和雪花的联系。</li><li id="c56a" class="lp lq iq ka b kb md kf me kj mf kn mg kr mh kv lw lx ly lz bi translated">如果账户中启用了MFA，如何从Python连接雪花？</li><li id="af4e" class="lp lq iq ka b kb md kf me kj mf kn mg kr mh kv lw lx ly lz bi translated">如何使用Python创建仓库、数据库、模式、表以及用数据填充表？</li><li id="c6d6" class="lp lq iq ka b kb md kf me kj mf kn mg kr mh kv lw lx ly lz bi translated">如何用table stage填充雪花表，用Python上传本地文件？</li></ul><p id="d449" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">步骤1: </strong>如果你已经在电脑上安装了Python，那么你可以跳过这一步，否则你可以从下面的链接下载Python并安装在你的电脑上。</p><p id="11eb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">下载Python:</strong>T9】https://www.python.org/downloads/</p><p id="d9b5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你使用的是微软Windows 10，你可以直接从微软商店下载Python 3.9(它是免费的)。</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mj"><img src="../Images/cead06005c732a41369ead25d4e80479.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SXARpbU5joVLmB5hqZ98pA.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk">.</figcaption></figure><p id="01b7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">步骤2: </strong>检查是否安装了正确的版本，并在windows CLI中运行以下命令。如果它输出3.5或更高，你就可以走了！如果没有，你需要安装一个新版本的Python。</p><p id="5b31" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> python -V </strong></p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/10bb205e9d103d98d29d18fb5b4cd88b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1358/format:webp/1*Qq3SYKu-7IH1Cm9qjGkx5A.png"/></div></figure></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><p id="6164" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一旦您获得了Python的最新版本，您就可以为Python安装雪花连接器了。您将通过Python包安装程序pip并通过运行以下命令来完成此操作:</p><p id="c65a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> pip安装—升级雪花-连接器-python </strong></p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/0ffa46ddef9faaa8b5b742db8b26321f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bw-2RRf6ccbnqJuNpwOFnw.png"/></div></div></figure><p id="fbee" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果上述步骤成功完成，那么你就可以开始第三步了。</p><p id="94fa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">步骤3: </strong>您可以编写简单的<strong class="ka ir"> validate.py </strong> python脚本来测试您与雪花的连接。请参见下面的示例代码片段。</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nb"><img src="../Images/bf9ae0bcf369f40bd1d6591888201093.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0hMxTdhCrkm0TkP5CuZbKA.png"/></div></div></figure><p id="9808" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第四步:</strong> <strong class="ka ir">如果你的雪花账户开通了MFA如何连接？</strong></p><p id="e681" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">上面的代码将在应用程序中推送DUO通知，然后你必须从应用程序中手动批准才能连接。</p><h2 id="9883" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">用Python使用MFA<strong class="ak">(来源:雪花)</strong></h2><p id="423e" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj nc kl km kn nd kp kq kr ne kt ku kv ij bi translated">MFA可用于通过雪花Python连接器连接到雪花。默认情况下，当用户在MFA中注册时，使用双推身份验证机制；不需要对Python API调用进行任何更改。</p><p id="4472" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要使用阿朵生成的密码而不是推送机制，必须在to connect()方法中为驱动程序指定以下参数之一:</p><blockquote class="nf ng nh"><p id="8c39" class="jy jz ni ka b kb kc kd ke kf kg kh ki nj kk kl km nk ko kp kq nl ks kt ku kv ij bi translated"><code class="fe nm nn no np b"><em class="iq">passcode=&lt;passcode_string&gt;</em></code> <em class="iq">或</em> <code class="fe nm nn no np b"><em class="iq">passcode_in_password=True</em></code></p></blockquote><p id="9bdb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">其中:</p><ul class=""><li id="d840" class="lp lq iq ka b kb kc kf kg kj ma kn mb kr mc kv lw lx ly lz bi translated"><code class="fe nm nn no np b"><em class="ni">passcode_string</em></code>是阿朵为正在连接的用户生成的密码。这可以是由Duo移动应用程序生成的密码，也可以是SMS密码。</li><li id="28e6" class="lp lq iq ka b kb md kf me kj mf kn mg kr mh kv lw lx ly lz bi translated">如果为<code class="fe nm nn no np b">passcode_in_password=True</code>，则密码和通行码以<code class="fe nm nn no np b">&lt;password_string&gt;&lt;passcode_string&gt;</code>的形式连接在一起。</li></ul><p id="53c5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我在连接脚本中提供了“密码”作为额外的参数，以避免通过应用程序手动批准。请参见示例代码。</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nq"><img src="../Images/985a073b9e038315f67832d16b080ba5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Xhmt4m3b9lSjAiiv7EQkA.png"/></div></div></figure><p id="a622" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">关于雪花MFA的更多详情:</strong></p><div class="nr ns gp gr nt nu"><a href="https://docs.snowflake.com/en/user-guide/security-mfa.html#connecting-to-snowflake-with-mfa" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">多因素认证(MFA) -雪花文档</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">雪花支持多因素身份验证(即MFA ),为连接到的用户提供更高的登录安全性</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">docs.snowflake.com</p></div></div><div class="od l"><div class="oe l of og oh od oi jw nu"/></div></div></a></div><p id="cc96" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在你知道如何使用Python连接到雪花，让我们使用Python脚本创建仓库、数据库、模式和表。</p><p id="ebee" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第五步:</strong>连接雪花，如果不存在，创建自定义仓库。使用同一个仓库创建一个名为“RAJIVDB”的新数据库，然后创建一个名为“DUMMYSCHEMA”的模式。创建一个名为EMP的表，并用2条记录填充它。获取1条记录并显示它们。</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oj"><img src="../Images/59cf3a0a69536fd5d6a2bb0defe9f49e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XEPs28DUurzgrv_YBSp20Q.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">填充_数据库. py</figcaption></figure><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ok"><img src="../Images/ab66fc9d65d379e9a3a05b72fc36a8f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pSk7ckC5gLItvHsWylkikQ.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">输出截图</figcaption></figure><p id="7836" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">步骤6:如何使用表阶段&amp;复制命令填充EMP表？</strong></p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/d97b63537b7bc041878ae3153f63d1ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:386/format:webp/1*rWfgUS8wE54oaDRSzpid8Q.png"/></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">抽样资料</figcaption></figure><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi om"><img src="../Images/5d3add6d463f3ac928eb8f6cab13db7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jlc2iEmvwTgXexoA-ov2yg.png"/></div></div></figure><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi on"><img src="../Images/2e2ed7875dc473d1d32af9a01d156298.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5R0xN6FkwdPBRf7BUY70lg.png"/></div></div></figure><p id="d1f3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">希望这篇博客能帮助你深入了解如何在雪花中使用python。如果你对此有任何疑问，欢迎在评论区提问。如果你喜欢这个博客，请鼓掌。保持联系，看到更多这样的酷东西。谢谢你的支持。</p><p id="54f1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">你看了我下面的博客了吗:</strong></p><p id="8aae" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">雪花雪景:炒作还是真的？</p><p id="c704" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae mi" href="https://rajivgupta780184.medium.com/why-snowflake-is-getting-traction-in-cloud-world-7ecc610c8020" rel="noopener">为什么雪花在云世界获得牵引力？</a></p><p id="a69a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">你可以找我:</strong></p><p id="5097" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">跟我上媒:</strong><a class="ae mi" href="https://rajivgupta780184.medium.com/" rel="noopener">https://rajivgupta780184.medium.com/</a></p><p id="2bad" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">在推特上关注我:【https://twitter.com/RAJIVGUPTA780】T22</strong></p><p id="17a8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">在LinkedIn跟我连线:</strong><a class="ae mi" href="https://www.linkedin.com/in/rajiv-gupta-618b0228/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/rajiv-gupta-618b0228/</a></p><p id="1136" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">订阅我的YouTube频道:</strong><a class="ae mi" href="https://www.youtube.com/channel/UC8Fwkdf2d6-hnNvcrzovktg" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/channel/UC8Fwkdf2d6-hnNvcrzovktg</a></p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/f5d39a229aefd3f4eb42587270bf2094.png" data-original-src="https://miro.medium.com/v2/resize:fit:946/format:webp/0*MlQi3Kwk1HZjK8dl.png"/></div></figure><p id="01e1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">#坚持学习#坚持分享#每天学习。</p><h1 id="1f72" class="op kx iq bd ky oq or os lb ot ou ov le ow ox oy lh oz pa pb lk pc pd pe ln pf bi translated">参考资料:-</h1><ul class=""><li id="ec5a" class="lp lq iq ka b kb lr kf ls kj lt kn lu kr lv kv lw lx ly lz bi translated"><a class="ae mi" href="https://www.snowflake.com/" rel="noopener ugc nofollow" target="_blank">https://www.snowflake.com/</a></li></ul></div></div>    
</body>
</html>