<html>
<head>
<title>Bluetooth LE based LCD messenger : send message to LCD display from web browser using Bluetooth and STM32</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于蓝牙 LE 的 LCD messenger:使用蓝牙和 STM32 从网络浏览器向 LCD 显示器发送消息</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/bluetooth-le-based-lcd-messenger-using-stm32-and-bleuio-76e240367e55?source=collection_archive---------17-----------------------#2022-03-03">https://blog.devgenius.io/bluetooth-le-based-lcd-messenger-using-stm32-and-bleuio-76e240367e55?source=collection_archive---------17-----------------------#2022-03-03</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div class="gh gi jk"><img src="../Images/229749bea4f75d0f65c4342fabf27d09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/0*QDSYCqMJMh-a_HgQ.jpg"/></div></figure><p id="c456" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">这个项目的目的是使用网络浏览器或智能手机通过蓝牙向连接到 STM32 板的 LCD 显示器发送消息。</p><h1 id="cbad" class="kp kq in bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">1.介绍</h1><p id="c60d" class="pw-post-body-paragraph jr js in jt b ju ln jw jx jy lo ka kb kc lp ke kf kg lq ki kj kk lr km kn ko ig bi translated">该项目基于 STM 32 Nucleo-144 T1，使用 BleuIO 控制 T2 液晶显示器 T3。</p><p id="d83e" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">对于这个项目，我们需要两个 BleuIO USB 加密狗，一个连接到 Nucleo 板，另一个连接到计算机，运行 web 脚本。<br/>当 BleuIO 加密狗连接到 Nucleo boards USB 端口时，STM32 将识别它并直接开始广告。这允许计算机端口上的加密狗与 web 脚本连接。</p><p id="f084" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">通过电脑上的 web 脚本，我们可以使用 BleuIO 将消息发送到与 STM32 相连的 LCD 屏幕上。</p><p id="9126" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">在本例中，我们使用了一个带 STM32H743ZI MCU 的 STM32 Nucleo-144 开发板(STM 32h 743 zi micro mbed-Enabled Development Nucleo-144 series ARM Cortex-M7 MCU 32 位嵌入式评估板)。该开发板有一个 USB 主机，我们可以通过它连接 BleuIO 加密狗。</p><p id="117c" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">如果您想使用另一种设置，您必须确保它支持 USB 主机，并注意 GPIO 设置可能会有所不同，可能需要在中重新配置。国际奥委会文件。</p><h1 id="5680" class="kp kq in bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">我们需要什么</h1><ul class=""><li id="ebc3" class="ls lt in jt b ju ln jy lo kc lu kg lv kk lw ko lx ly lz ma bi translated">两个蓝色加密狗(<a class="ae mb" href="https://www.bleuio.com/" rel="noopener ugc nofollow" target="_blank">https://www.bleuio.com/</a>)</li><li id="e54f" class="ls lt in jt b ju mc jy md kc me kg mf kk mg ko lx ly lz ma bi translated">带有带 USB 端口的 STM32 微控制器的电路板。(使用 Nucleo-144 开发板:NUCLEO-H743ZI2 来开发本示例。(<a class="ae mb" href="https://www.st.com/en/evaluation-tools/nucleo-h743zi.html" rel="noopener ugc nofollow" target="_blank">https://www.st.com/en/evaluation-tools/nucleo-h743zi.html</a>)<br/>要将加密狗连接到 Nucleo 板，可以使用带有 USB A 母到母适配器的“USB A 到 Micro USB B”电缆。)</li></ul><figure class="mi mj mk ml gt jo gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/0f0943024cde75fbb56794922407167c.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/0*jmKMvVsx1Muy9mtR.jpg"/></div></figure><ul class=""><li id="7d8a" class="ls lt in jt b ju jv jy jz kc mm kg mn kk mo ko lx ly lz ma bi translated">STM 32 库贝德(<a class="ae mb" href="https://www.st.com/en/development-tools/stm32cubeide.html" rel="noopener ugc nofollow" target="_blank">https://www.st.com/en/development-tools/stm32cubeide.html</a>)</li><li id="01c6" class="ls lt in jt b ju mc jy md kc me kg mf kk mg ko lx ly lz ma bi translated">液晶显示模块—NHD-0420 d3z-NSW-BBW-V3(<a class="ae mb" href="https://www.digikey.com/en/products/detail/newhaven-display-intl/NHD-0420D3Z-NSW-BBW-V3/2626390?s=N4IgTCBcDaIHIAkAiBaADAFjGpBmAWinAMoDqKAQheQGq4gC6AvkA" rel="noopener ugc nofollow" target="_blank">https://www . digikey . com/en/products/detail/new haven-Display-intl/NHD-0420 d3z-NSW-BBW-V3/2626390？s = n 4 igtcbcdaihiakaibaadafjgpbmawinamodqkaqheqgq 4 GC 6 avka</a></li></ul><h1 id="49d2" class="kp kq in bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">关于代码</h1><p id="2d4c" class="pw-post-body-paragraph jr js in jt b ju ln jw jx jy lo ka kb kc lp ke kf kg lq ki kj kk lr km kn ko ig bi translated">Github 提供了项目源代码。</p><p id="5b57" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated"><a class="ae mb" href="https://github.com/smart-sensor-devices-ab/stm32_bleuio_lcd.git" rel="noopener ugc nofollow" target="_blank">https://github . com/smart-sensor-devices-ab/STM 32 _ bleuio _ LCD . git</a></p><p id="748c" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">要么克隆这个项目，要么将其下载为 zip 文件并解压缩到您的 STM32CubeIDE 工作空间中。</p><p id="e2c4" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">如果您将项目下载为 zip 文件，您需要将项目文件夹从“stm32_bleuio_lcd-master”重命名为“stm32_bleuio_lcd”</p><figure class="mi mj mk ml gt jo gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/f9feb61ef6fbf3fb444b9e6249d07b72.png" data-original-src="https://miro.medium.com/v2/resize:fit:952/format:webp/0*q5KoyU-TQGQbSCEo.jpg"/></div></figure><p id="3098" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">将 SDA 连接到 Nucleo 板上的 PF0，将 SCL 连接到 PF1。</p><p id="1d01" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">然后在 STM32Cube ioc 文件中设置 I2C2，如下所示。(确保根据 LCD 显示要求，将 I2C 速度频率更改为 50 KHz。)</p><figure class="mi mj mk ml gt jo gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/ee090e6437fe5273d86b75e8458eb4b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/0*hX6zEbPBvEsnDAb5.png"/></div></figure><figure class="mi mj mk ml gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mr"><img src="../Images/d9b3c9097dba498eb394264e20d2b605.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/0*hxtqeUPi8DWihV4i.png"/></div></div></figure><figure class="mi mj mk ml gt jo gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/0b4e7880caf1830a9c4a5c090cc263fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/0*ANQKKnjlMccmgZJg.jpg"/></div></figure><p id="d52a" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">在 USB_HOST\usb_host.c 中的 USBH_CDC_ReceiveCallback 函数中，我们将 CDC_RX_Buffer 复制到一个名为 dongle_response 的外部变量中，该变量可从 main.c 文件中访问。</p><pre class="mi mj mk ml gt mx my mz na aw nb bi"><span id="799e" class="nc kq in my b gy nd ne l nf ng">void USBH_CDC_ReceiveCallback(USBH_HandleTypeDef *phost)<br/>{<br/>  	if(phost == &amp;hUsbHostFS)<br/>  	{<br/>  		// Handles the data recived from the USB CDC host, here just printing it out to UART<br/>  		rx_size = USBH_CDC_GetLastReceivedDataSize(phost);<br/>		HAL_UART_Transmit(&amp;huart3, CDC_RX_Buffer, rx_size, HAL_MAX_DELAY);</span><span id="6a22" class="nc kq in my b gy nh ne l nf ng">		// Copy buffer to external dongle_response buffer<br/>		strcpy((char *)dongle_response, (char *)CDC_RX_Buffer);</span><span id="ab51" class="nc kq in my b gy nh ne l nf ng">		// Reset buffer and restart the callback function to receive more data<br/>		memset(CDC_RX_Buffer,0,RX_BUFF_SIZE);<br/>		USBH_CDC_Receive(phost, CDC_RX_Buffer, RX_BUFF_SIZE);<br/>  	}</span><span id="fc13" class="nc kq in my b gy nh ne l nf ng">  	return;<br/>}</span></pre><p id="9466" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">在 main.c 中，我们创建了一个简单的解释器，这样我们就可以对从加密狗接收到的数据做出反应。</p><pre class="mi mj mk ml gt mx my mz na aw nb bi"><span id="a113" class="nc kq in my b gy nd ne l nf ng">void dongle_interpreter(uint8_t * input)<br/>{</span><span id="22f8" class="nc kq in my b gy nh ne l nf ng">	if(strlen((char *)input) != 0)<br/>	{<br/>		if(strstr((char *)input, "\r\nADVERTISING...") != NULL)<br/>		{<br/>			isAdvertising = true;<br/>		}<br/>		if(strstr((char *)input, "\r\nADVERTISING STOPPED") != NULL)<br/>		{<br/>			isAdvertising = false;<br/>		}<br/>		if(strstr((char *)input, "\r\nCONNECTED") != NULL)<br/>		{<br/>			isConnected = true;<br/>			HAL_GPIO_WritePin(GPIOE, GPIO_PIN_1, GPIO_PIN_SET);<br/>		}<br/>		if(strstr((char *)input, "\r\nDISCONNECTED") != NULL)<br/>		{<br/>			isConnected = false;<br/>			HAL_GPIO_WritePin(GPIOE, GPIO_PIN_1, GPIO_PIN_RESET);<br/>		}<br/></span><span id="6093" class="nc kq in my b gy nh ne l nf ng">		if(strstr((char *)input, "L=0") != NULL)<br/>		{</span><span id="a9a3" class="nc kq in my b gy nh ne l nf ng">			isLightBulbOn = false;<br/>			//HAL_GPIO_WritePin(Lightbulb_GPIO_Port, Lightbulb_Pin, GPIO_PIN_RESET);<br/>			lcd_clear();</span><span id="df48" class="nc kq in my b gy nh ne l nf ng">			writeToDongle((uint8_t*)DONGLE_SEND_LIGHT_OFF);</span><span id="ef79" class="nc kq in my b gy nh ne l nf ng">			uart_buf_len = sprintf(uart_tx_buf, "\r\nClear screen\r\n");<br/>			HAL_UART_Transmit(&amp;huart3, (uint8_t *)uart_tx_buf, uart_buf_len, HAL_MAX_DELAY);<br/>		}</span><span id="4196" class="nc kq in my b gy nh ne l nf ng">		if(strstr((char *)input, "L=1") != NULL)<br/>		{<br/>				isLightBulbOn = true;<br/>				writeToDongle((uint8_t*)DONGLE_SEND_LIGHT_ON);<br/></span><span id="4a41" class="nc kq in my b gy nh ne l nf ng">				lcd_clear();</span><span id="2872" class="nc kq in my b gy nh ne l nf ng">				lcd_write(input);</span><span id="89b3" class="nc kq in my b gy nh ne l nf ng">		}</span><span id="4d96" class="nc kq in my b gy nh ne l nf ng">	}<br/>	memset(&amp;dongle_response, 0, RSP_SIZE);<br/>}</span></pre><p id="d561" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">我们将解释器函数放在主循环中。</p><pre class="mi mj mk ml gt mx my mz na aw nb bi"><span id="e555" class="nc kq in my b gy nd ne l nf ng">/* Infinite loop */<br/>  /* USER CODE BEGIN WHILE */<br/>  while (1)<br/>  {<br/>    /* USER CODE END WHILE */<br/>    MX_USB_HOST_Process();</span><span id="f376" class="nc kq in my b gy nh ne l nf ng">    /* USER CODE BEGIN 3 */<br/>    // Simple handler for uart input<br/>    handleUartInput(uartStatus);</span><span id="4f86" class="nc kq in my b gy nh ne l nf ng">    // Inteprets the dongle data<br/>    dongle_interpreter(dongle_response);</span><span id="dbb1" class="nc kq in my b gy nh ne l nf ng">	// Starts advertising as soon as the Dongle is ready.<br/>	if(!isAdvertising &amp;&amp; !isConnected &amp;&amp; isBleuIOReady)<br/>	{<br/>		HAL_Delay(200);<br/>		writeToDongle((uint8_t*)DONGLE_CMD_AT_ADVSTART);<br/>		isAdvertising = true;<br/>	}<br/>  }<br/>  /* USER CODE END 3 */</span></pre><h1 id="2f13" class="kp kq in bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">使用示例项目</h1><h1 id="7534" class="kp kq in bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">作为现有项目导入</h1><p id="586e" class="pw-post-body-paragraph jr js in jt b ju ln jw jx jy lo ka kb kc lp ke kf kg lq ki kj kk lr km kn ko ig bi translated">从 STM32CubeIDE 中选择文件&gt;导入…</p><figure class="mi mj mk ml gt jo gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/08512e71a9ff8b8c115612186fb5b375.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/0*Ovm3lb-Cyph8Oj4O.png"/></div></figure><p id="6574" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">然后选择常规&gt;将现有项目放入工作区，然后单击“下一步&gt;”</p><figure class="mi mj mk ml gt jo gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/d0429d7156ff77a4152fedf9157204d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/0*vH4sv__xfKYsPIvI.png"/></div></figure><p id="0213" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">确保您已经在“选择根目录:”中选择了您的工作空间</p><p id="d323" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">您应该看到项目“stm32_bleuio_SHT85_example”，选中它并单击“Finish”。</p><figure class="mi mj mk ml gt jo gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/47878126f1dbb8452c8d9a0c7894669d.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/0*qjXQkOPjKLE3jEoe.png"/></div></figure><h1 id="35a6" class="kp kq in bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">运行示例</h1><p id="bf66" class="pw-post-body-paragraph jr js in jt b ju ln jw jx jy lo ka kb kc lp ke kf kg lq ki kj kk lr km kn ko ig bi translated">将代码上传到 STM32 并运行示例。连接到 STM32 的 USB 加密狗将自动开始广告。</p><h1 id="8e49" class="kp kq in bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">从网络浏览器向 LCD 屏幕发送消息</h1><p id="cb58" class="pw-post-body-paragraph jr js in jt b ju ln jw jx jy lo ka kb kc lp ke kf kg lq ki kj kk lr km kn ko ig bi translated">将 BleuIO 加密狗连接到电脑。运行 web 脚本以连接 STM32 上的另一个 BleuIO 加密狗。现在你可以向液晶显示屏发送信息了。</p><p id="ca10" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">为了让这个脚本工作，我们需要</p><ul class=""><li id="f86f" class="ls lt in jt b ju jv jy jz kc mm kg mn kk mo ko lx ly lz ma bi translated"><a class="ae mb" href="https://www.bleuio.com/" rel="noopener ugc nofollow" target="_blank"> BleuIO USB 加密狗</a>连接到电脑。</li><li id="1451" class="ls lt in jt b ju mc jy md kc me kg mf kk mg ko lx ly lz ma bi translated"><a class="ae mb" href="https://www.npmjs.com/package/bleuio" rel="noopener ugc nofollow" target="_blank"> BleuIO javascript 库</a></li><li id="a600" class="ls lt in jt b ju mc jy md kc me kg mf kk mg ko lx ly lz ma bi translated">Chrome 78 或更高版本，并且需要启用 chrome://flags 中的<strong class="jt io"># enable-experimental-we B- platform-features</strong>标志</li><li id="0dde" class="ls lt in jt b ju mc jy md kc me kg mf kk mg ko lx ly lz ma bi translated">卷筒纸捆扎机— ( <a class="ae mb" href="https://parceljs.org/" rel="noopener ugc nofollow" target="_blank">包裹 js </a>)</li></ul><p id="7a9d" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">创建一个名为 index.html 的简单 Html 文件，它将作为脚本的前端。这个 Html 文件包含一些按钮，帮助连接和读取来自连接到 stm32 的远程加密狗的广告数据。</p><pre class="mi mj mk ml gt mx my mz na aw nb bi"><span id="1752" class="nc kq in my b gy nd ne l nf ng">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;meta charset="UTF-8" /&gt;<br/>    &lt;meta http-equiv="X-UA-Compatible" content="IE=edge" /&gt;<br/>    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0" /&gt;<br/>    &lt;link<br/>      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"<br/>      rel="stylesheet"<br/>      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"<br/>      crossorigin="anonymous"<br/>    /&gt;<br/>    &lt;title&gt;Send message to STM32 LCD display using Bluetooth LE&lt;/title&gt;<br/>  &lt;/head&gt;<br/>  &lt;body class="mt-5"&gt;<br/>    &lt;div class="container mt-5"&gt;<br/>      &lt;h1 class="mb-5"&gt;Send message to STM32 LCD display using Bluetooth LE&lt;/h1&gt;<br/>      &lt;button class="btn btn-success" id="connect"&gt;Connect&lt;/button&gt;<br/>      &lt;div class="row"&gt;<br/>        &lt;div class="col-md-4"&gt;<br/>          &lt;form method="post" id="sendMsgForm" name="sendMsgForm"&gt;<br/>            &lt;div class="mb-3"&gt;<br/>              &lt;label for="msgToSend" class="form-label"&gt;Your Message&lt;/label&gt;<br/>              &lt;input<br/>                type="text"<br/>                class="form-control"<br/>                name="msgToSend"<br/>                id="msgToSend"<br/>                required<br/>                maxlength="60"<br/>              /&gt;<br/>            &lt;/div&gt;</span><span id="08e9" class="nc kq in my b gy nh ne l nf ng">            &lt;button type="submit" class="btn btn-primary"&gt;Submit&lt;/button&gt;<br/>          &lt;/form&gt;<br/>        &lt;/div&gt;<br/>      &lt;/div&gt;</span><span id="882f" class="nc kq in my b gy nh ne l nf ng">      &lt;br /&gt;<br/>      &lt;button class="btn btn-danger" id="clearScreen" disabled&gt;<br/>        Clear screen<br/>      &lt;/button&gt;<br/>    &lt;/div&gt;</span><span id="1d2c" class="nc kq in my b gy nh ne l nf ng">    &lt;script src="script.js"&gt;&lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="42aa" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">创建一个名为 script.js 的 js 文件，并将其包含在 Html 文件的底部。这个 js 文件使用 BleuIO js 库来编写 AT 命令并与其他加密狗通信。</p><pre class="mi mj mk ml gt mx my mz na aw nb bi"><span id="e49a" class="nc kq in my b gy nd ne l nf ng">import * as my_dongle from 'bleuio'<br/>const dongleToConnect='[0]40:48:FD:E5:2F:17'<br/>document.getElementById('connect').addEventListener('click', function(){<br/>  my_dongle.at_connect()<br/>  document.getElementById("clearScreen").disabled=false;<br/>  document.getElementById("connect").disabled=true;<br/>  document.getElementById("sendMsgForm").hidden=false;<br/>})</span><span id="6808" class="nc kq in my b gy nh ne l nf ng">document.getElementById("sendMsgForm").addEventListener("submit", function(event){<br/>    event.preventDefault()<br/>    console.log('here')</span><span id="4280" class="nc kq in my b gy nh ne l nf ng">    <br/>    my_dongle.ati().then((data)=&gt;{<br/>        //make central if not<br/>        if(JSON.stringify(data).includes("Peripheral")){<br/>            console.log('peripheral')<br/>            my_dongle.at_central().then((x)=&gt;{<br/>                console.log('central now')<br/>            })<br/>        }        <br/>    })<br/>    .then(()=&gt;{<br/>        // connect to dongle<br/>        my_dongle.at_getconn().then((y)=&gt;{<br/>            if(JSON.stringify(y).includes(dongleToConnect)){<br/>                console.log('already connected')<br/>            }else{<br/>                my_dongle.at_gapconnect(dongleToConnect).then(()=&gt;{<br/>                    console.log('connected successfully')<br/>                })<br/>            }<br/>        })<br/>        .then(()=&gt;{<br/>            var theVal = "L=1 " + document.getElementById('msgToSend').value;<br/>            console.log('Message Send 1 '+theVal)<br/>            // send command to show data<br/>            my_dongle.at_spssend(theVal).then(()=&gt;{<br/>                console.log('Message Send '+theVal)<br/>            })<br/>        })<br/>        <br/>    })<br/>  });</span><span id="5bd9" class="nc kq in my b gy nh ne l nf ng">document.getElementById('clearScreen').addEventListener('click', function(){<br/>    my_dongle.ati().then((data)=&gt;{<br/>        //make central if not<br/>        if(JSON.stringify(data).includes("Peripheral")){<br/>            console.log('peripheral')<br/>            my_dongle.at_central().then((x)=&gt;{<br/>                console.log('central now')<br/>            })<br/>        }<br/>    })<br/>    .then(()=&gt;{<br/>        // connect to dongle<br/>        my_dongle.at_getconn().then((y)=&gt;{<br/>            if(JSON.stringify(y).includes(dongleToConnect)){<br/>                console.log('already connected')<br/>            }else{<br/>                my_dongle.at_gapconnect(dongleToConnect).then(()=&gt;{<br/>                    console.log('connected successfully')<br/>                })<br/>            }<br/>        })<br/>        .then(()=&gt;{<br/>            // send command to clear the screen<br/>            my_dongle.at_spssend('L=0').then(()=&gt;{<br/>                console.log('Screen Cleared')<br/>            })<br/>        })<br/>        <br/>    })<br/>})</span></pre><p id="aef8" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">该脚本有一个连接到计算机 COM 端口的按钮。有一个文本字段，你可以在那里写你的信息。您的信息将显示在连接到 STM32 板的 LCD 屏幕上。</p><p id="28b5" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">要连接到 STM32 上的 BleuIO 加密狗，请确保 STM32 已通电且已连接了 BleuIO 加密狗。</p><h1 id="06a8" class="kp kq in bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">获取 MAC 地址</h1><p id="e6d1" class="pw-post-body-paragraph jr js in jt b ju ln jw jx jy lo ka kb kc lp ke kf kg lq ki kj kk lr km kn ko ig bi translated">按照步骤获取连接到 STM32 的加密狗的 MAC 地址</p><pre class="mi mj mk ml gt mx my mz na aw nb bi"><span id="996d" class="nc kq in my b gy nd ne l nf ng">- Open this site https://bleuio.com/web_terminal.html and click connect to dongle.<br/>- Select the appropriate port to connect.<br/>- Once it says connected, type ATI. This will show dongle information and current status.<br/>- If the dongle is on peripheral role, set it to central by typing AT+CENTRAL<br/>- Now do a gap scan by typing AT+GAPSCAN<br/>- Once you see your dongle on the list ,stop the scan by pressing control+c<br/>- Copy the ID and paste it into the script (script.js) line #2</span></pre><figure class="mi mj mk ml gt jo gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/4a070696a60b516e9d9f9ae735d96ed4.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/0*J6AUa4_3OK_hecX3.gif"/></div></figure><h1 id="1e7c" class="kp kq in bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">运行 web 脚本</h1><p id="2e43" class="pw-post-body-paragraph jr js in jt b ju ln jw jx jy lo ka kb kc lp ke kf kg lq ki kj kk lr km kn ko ig bi translated">你需要一个网络捆扎机。可以使用<a class="ae mb" href="https://parceljs.org/" rel="noopener ugc nofollow" target="_blank"> parcel.js </a></p><p id="6d14" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">一旦安装了包 js，转到 web 脚本的根目录并键入<strong class="jt io">" package index . html "</strong>。这将启动您的开发环境。</p><figure class="mi mj mk ml gt jo gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/e310851690c0d3de03bfa0d7a61549d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/0*Xbm-DYbIoGoNwZvq.jpg"/></div></figure><p id="938c" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">在浏览器上打开脚本。对于这个例子，我们打开了<a class="ae mb" href="http://localhost:1234" rel="noopener ugc nofollow" target="_blank"> http://localhost:1234 </a></p><p id="692d" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">您可以轻松地连接到加密狗，并将您的信息发送到 LCD 屏幕。响应将显示在浏览器控制台屏幕上。</p><p id="91f6" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">web 脚本如下所示</p><figure class="mi mj mk ml gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi nn"><img src="../Images/39a150f683df041969a76702e2333c16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ra-RZ-HdF-NmMUC5.png"/></div></div></figure><h1 id="ecb5" class="kp kq in bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">输出</h1><p id="f6c6" class="pw-post-body-paragraph jr js in jt b ju ln jw jx jy lo ka kb kc lp ke kf kg lq ki kj kk lr km kn ko ig bi translated">该信息将显示在 LCD 屏幕上。</p><figure class="mi mj mk ml gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi nn"><img src="../Images/a5dc6c3c3c8c4e317ebecd93b96b0977.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rh8v29SuHX01_ay8"/></div></div></figure><h1 id="72e8" class="kp kq in bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">工作项目视频</h1><figure class="mi mj mk ml gt jo"><div class="bz fp l di"><div class="no np l"/></div></figure></div></div>    
</body>
</html>