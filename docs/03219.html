<html>
<head>
<title>CORS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">克-奥二氏分级量表</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/cors-34e947046600?source=collection_archive---------4-----------------------#2020-10-13">https://blog.devgenius.io/cors-34e947046600?source=collection_archive---------4-----------------------#2020-10-13</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="7a43" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">它是什么，你需要知道什么</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi kc"><img src="../Images/bc1f54e7c3d4686c41e2b61b47dd6068.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/0*V1C7I3Y9xVDyt6vx"/></div></figure><h2 id="18c8" class="kk kl in bd km kn ko dn kp kq kr dp ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">重要术语</h2><p id="ccae" class="pw-post-body-paragraph lg lh in li b lj lk jo ll lm ln jr lo kt lp lq lr kx ls lt lu lb lv lw lx ly ig bi translated"><em class="lz">来源</em>由协议、主机和 URL 描述。</p><p id="082a" class="pw-post-body-paragraph lg lh in li b lj ma jo ll lm mb jr lo kt mc lq lr kx md lt lu lb me lw lx ly ig bi translated">相同的起源:</p><pre class="kd ke kf kg gt mf mg mh mi aw mj bi"><span id="edf0" class="kk kl in mg b gy mk ml l mm mn">http://example.com/app1/index.html<br/>http://example.com/app2/index.html<br/></span></pre><p id="75e5" class="pw-post-body-paragraph lg lh in li b lj ma jo ll lm mb jr lo kt mc lq lr kx md lt lu lb me lw lx ly ig bi translated">不同的原产地方案:</p><pre class="kd ke kf kg gt mf mg mh mi aw mj bi"><span id="7467" class="kk kl in mg b gy mk ml l mm mn">http://example.com/app1<br/>https://example.com/app2</span></pre><p id="68fb" class="pw-post-body-paragraph lg lh in li b lj ma jo ll lm mb jr lo kt mc lq lr kx md lt lu lb me lw lx ly ig bi translated">不同的原始主机:</p><pre class="kd ke kf kg gt mf mg mh mi aw mj bi"><span id="574b" class="kk kl in mg b gy mk ml l mm mn">http://example.com<br/>http://www.example.com<br/>http://myapp.example.com</span></pre><p id="101d" class="pw-post-body-paragraph lg lh in li b lj ma jo ll lm mb jr lo kt mc lq lr kx md lt lu lb me lw lx ly ig bi translated">不同的始发港:</p><pre class="kd ke kf kg gt mf mg mh mi aw mj bi"><span id="dd28" class="kk kl in mg b gy mk ml l mm mn">http://example.com<br/>http://example.com:8080</span></pre><p id="ef41" class="pw-post-body-paragraph lg lh in li b lj ma jo ll lm mb jr lo kt mc lq lr kx md lt lu lb me lw lx ly ig bi translated"><em class="lz">CORS</em>——跨来源资源共享允许共享来自外部来源的数据，如果允许的话。</p><p id="1a26" class="pw-post-body-paragraph lg lh in li b lj ma jo ll lm mb jr lo kt mc lq lr kx md lt lu lb me lw lx ly ig bi translated"><em class="lz"> SOP </em> -同源策略只允许来源是相同的方案/协议、主机和端口号的内容共享。</p><p id="4c21" class="pw-post-body-paragraph lg lh in li b lj ma jo ll lm mb jr lo kt mc lq lr kx md lt lu lb me lw lx ly ig bi translated">AJAX  -异步 JavaScript 和 XML 是发生在客户端的请求，web 应用程序可以在不干扰加载内容或行为的情况下发送和接收数据。</p><h2 id="62ef" class="kk kl in bd km kn ko dn kp kq kr dp ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">什么先出现</h2><p id="6f09" class="pw-post-body-paragraph lg lh in li b lj lk jo ll lm ln jr lo kt lp lq lr kx ls lt lu lb lv lw lx ly ig bi translated">在互联网的初期，1995 年采用的第一个协议是网景公司的同源策略。SOP 至今仍被用作一种安全特性，以帮助保护站点免受未经身份验证的会话的攻击。例如，用户登录了他们的银行帐户，离开了页面，但没有注销。该用户访问一个在后台运行 Javascript 代码的恶意网站。使用 SOP，该网站将无法从银行网站上获得任何信息。如果没有使用 SOP，Javascript 代码可以获得用户的银行信息、交易列表，甚至创建新的交易。</p><p id="1dda" class="pw-post-body-paragraph lg lh in li b lj ma jo ll lm mb jr lo kt mc lq lr kx md lt lu lb me lw lx ly ig bi translated">当网站开始变大时，SOP 就成了问题。为了帮助 SOP 变得更加动态，比如数据污点、document.domain 属性、JSONP、WebSockets 和其他一些。这是 CORS 到达现场的地方。</p><h2 id="1cf2" class="kk kl in bd km kn ko dn kp kq kr dp ks kt ku kv kw kx ky kz la lb lc ld le lf bi">2004</h2><p id="708f" class="pw-post-body-paragraph lg lh in li b lj lk jo ll lm ln jr lo kt lp lq lr kx ls lt lu lb lv lw lx ly ig bi translated">马特·奥什利、布拉德·波特和迈克尔·博德尔提出了跨产地支持。他们正在开发 VoiceXML，这是一种计算机和人类语音交互媒体和对话。他们需要能够在浏览器之间共享媒体。CORS 的第一份工作草案于 2006 年提交，但最终在 2014 年被推荐。Cors 是 JSONP 的现代替代品。JSONP 只允许 HTTP GET 请求，没有很好地处理错误，并且不太安全。</p><h2 id="179a" class="kk kl in bd km kn ko dn kp kq kr dp ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">使用 CORS</h2><p id="d2a1" class="pw-post-body-paragraph lg lh in li b lj lk jo ll lm ln jr lo kt lp lq lr kx ls lt lu lb lv lw lx ly ig bi translated">当用户访问一个网页时，该页面会进行跨原点提取。假设向 API 发出一个获取请求。浏览器将尝试发送一个 GET 请求，该请求带有一个额外的包含为父页面提供服务的域的源 HTTP 头。服务器可能会以两种方式之一做出响应。</p><p id="22d1" class="pw-post-body-paragraph lg lh in li b lj ma jo ll lm mb jr lo kt mc lq lr kx md lt lu lb me lw lx ly ig bi translated">1.允许来自原点的请求数据和报头访问控制允许原点请求。这可能是一张百搭牌</p><pre class="kd ke kf kg gt mf mg mh mi aw mj bi"><span id="ace0" class="kk kl in mg b gy mk ml l mm mn">Access-Control-Allow-Origin: *</span></pre><p id="be94" class="pw-post-body-paragraph lg lh in li b lj ma jo ll lm mb jr lo kt mc lq lr kx md lt lu lb me lw lx ly ig bi translated">这实质上使内容完全公开，每个人都可以使用，包括任何站点上服务器站点的代码。这方面的一个例子是谷歌字体。</p><pre class="kd ke kf kg gt mf mg mh mi aw mj bi"><span id="f5d3" class="kk kl in mg b gy mk ml l mm mn">Access-Control-Allow-Origin: http://example.com</span></pre><p id="7d15" class="pw-post-body-paragraph lg lh in li b lj ma jo ll lm mb jr lo kt mc lq lr kx md lt lu lb me lw lx ly ig bi translated">第二个例子意味着只有这个源的网站可以访问这些数据。使请求数据更加私密。</p><p id="484b" class="pw-post-body-paragraph lg lh in li b lj ma jo ll lm mb jr lo kt mc lq lr kx md lt lu lb me lw lx ly ig bi translated">2.如果页面不允许跨来源请求，或者没有声明 Access-Control-Allow-Origin，将会返回一个 CORS 错误，并带有如下承诺:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mo"><img src="../Images/2057361ca21b9277e8df450b22b558aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*om90XfxJkcZVMroc"/></div></div></figure><h2 id="ba1e" class="kk kl in bd km kn ko dn kp kq kr dp ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">避开 CORS 错误</h2><p id="d592" class="pw-post-body-paragraph lg lh in li b lj lk jo ll lm ln jr lo kt lp lq lr kx ls lt lu lb lv lw lx ly ig bi translated">解决 CORS 误差有三种不同的方法。</p><ol class=""><li id="7d07" class="mt mu in li b lj ma lm mb kt mv kx mw lb mx ly my mz na nb bi translated">添加 chrome 扩展</li></ol><p id="1ea2" class="pw-post-body-paragraph lg lh in li b lj ma jo ll lm mb jr lo kt mc lq lr kx md lt lu lb me lw lx ly ig bi translated">最快的解决方法是添加一个名为<a class="ae nc" href="https://chrome.google.com/webstore/detail/moesif-origin-cors-change/digfbfaphojjndkpccljibejjbppifbc?hl=en-US" rel="noopener ugc nofollow" target="_blank"> Moesif Origin &amp; CORS 改变者</a>的 chrome 扩展。这里的问题是，这只对开发有好处，但只能在你的 chrome 浏览器中工作。如果你正在寻找一个快速的方法来看看你是否能得到数据，这绝对是一个好的选择。虽然从长远来看，你会想寻找一个不同的选择。</p><p id="5983" class="pw-post-body-paragraph lg lh in li b lj ma jo ll lm mb jr lo kt mc lq lr kx md lt lu lb me lw lx ly ig bi translated">2.使用代理</p><p id="1a2e" class="pw-post-body-paragraph lg lh in li b lj ma jo ll lm mb jr lo kt mc lq lr kx md lt lu lb me lw lx ly ig bi translated">代理是充当浏览器和端点服务器之间网关的服务器。有一个名为<a class="ae nc" href="https://github.com/Rob--W/cors-anywhere/#documentation" rel="noopener ugc nofollow" target="_blank"> cors-anywhere </a>的开源代理服务器，它将 cors 报头添加到请求中。它使用起来非常简单，你甚至可以用源代码创建自己的 Heroku 应用程序。你所需要做的就是在你发送请求的 URL 前面加上 https://cors-anywhere.herokuapp.com/的 T4。</p><pre class="kd ke kf kg gt mf mg mh mi aw mj bi"><span id="1f0e" class="kk kl in mg b gy mk ml l mm mn">https://cors-anywhere.herokuapp.com/{add source url here}</span></pre><p id="1675" class="pw-post-body-paragraph lg lh in li b lj ma jo ll lm mb jr lo kt mc lq lr kx md lt lu lb me lw lx ly ig bi translated">好的一面是，这适用于应用程序中的开发和生产，不需要做任何更改。一个缺点是 Heroku 应用程序可能会有一点延迟响应。</p><p id="6729" class="pw-post-body-paragraph lg lh in li b lj ma jo ll lm mb jr lo kt mc lq lr kx md lt lu lb me lw lx ly ig bi translated">3.构建您自己的代理</p><p id="1ed2" class="pw-post-body-paragraph lg lh in li b lj ma jo ll lm mb jr lo kt mc lq lr kx md lt lu lb me lw lx ly ig bi translated">Google 有很好的文档介绍如何将代理脚本添加到多种编码语言中。</p><h1 id="9e64" class="nd kl in bd km ne nf ng kp nh ni nj ks jt nk ju kw jw nl jx la jz nm ka le nn bi translated">结论</h1><p id="0bfd" class="pw-post-body-paragraph lg lh in li b lj lk jo ll lm ln jr lo kt lp lq lr kx ls lt lu lb lv lw lx ly ig bi translated">CORS 错误可能会令人沮丧，但当你理解它们来自哪里，并且它们允许我们作为开发者共享数据和发展互联网时，它们就不会那么令人沮丧了。想象一下，如果我们仍然使用 SOP，并且不得不用我们通常导入的所有代码来构建网站。想象一下互联网会有多慢。我自己知道，了解技术来源的根源有助于我理解它的用处，并对正在发生的事情有所了解。希望 CORS 对你来说更有意义。如果有另一种解决 CORS 问题的方法，我很想听听。感谢阅读！</p></div></div>    
</body>
</html>