<html>
<head>
<title>How to Create a VPC and Auto Scaling Group in CloudFormation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在 CloudFormation 中创建 VPC 和自动缩放组</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-create-a-vpc-and-auto-scaling-group-in-cloudformation-e3211b8ded5a?source=collection_archive---------4-----------------------#2022-03-08">https://blog.devgenius.io/how-to-create-a-vpc-and-auto-scaling-group-in-cloudformation-e3211b8ded5a?source=collection_archive---------4-----------------------#2022-03-08</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/c5cc98875f3d44fd4ea070bf22d1dfee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mlWUJ53Quiz-SCp-RMLekw.png"/></div></div></figure><p id="716c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">CloudFormation 是 AWS 提供的一项服务，它允许您以代码的形式提供基础设施。通过 CloudFormation 模板可以轻松创建资源，实现无缝自动化。</p><p id="8179" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">本教程将提供一个云形成模板，可用于创建一个 VPC 和自动缩放组。VPC 将包括两个公共和私有子网，以及一个允许通过互联网访问 EC2 实例的互联网网关。自动缩放组配置有最少两个、三个所需实例和最多五个实例。Auto Scaling 组的启动模板由 EC2 实例和用户数据组成，用于安装 Apache Web 服务器和压力工具。</p><p id="7f37" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">先决条件:</strong></p><ul class=""><li id="9756" class="kt ku in jx b jy jz kc kd kg kv kk kw ko kx ks ky kz la lb bi translated">完成本教程需要一个 AWS 帐户。</li><li id="3d25" class="kt ku in jx b jy lc kc ld kg le kk lf ko lg ks ky kz la lb bi translated">代码编辑器，如 Visual Studio。</li></ul><p id="4813" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">第一步:保存云形成模板</strong></p><p id="3fb6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">将下面的 CloudFormation 模板以. yml 文件的形式复制并保存在您的计算机上。</p><figure class="lh li lj lk gt jo"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="fbdf" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">第二步:创建云形成堆栈</strong></p><p id="3929" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在 AWS 控制台中，导航到 CloudFormation 仪表板。点击<strong class="jx io">创建堆栈。</strong></p><p id="3c76" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">选择<strong class="jx io">模板就绪</strong>选项。</p><p id="23af" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在模板源下，选择<strong class="jx io">上传模板文件。</strong>上传您在上一步中创建的 YAML 文件。</p><p id="e4d4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">点击下一个的<strong class="jx io">。</strong></p><figure class="lh li lj lk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ln"><img src="../Images/ce3928074ca1e92995adbd297b0708da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RAhIdmrB2rxgz6vjSszn9w.png"/></div></div></figure><p id="71ec" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">输入一个<strong class="jx io">堆栈名</strong>。</p><p id="eec3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">默认情况下，自动扩展组的 CPU 目标跟踪利用率设置为 80。这可以调整或保持不变。这是目标跟踪策略的扩展指标。将根据此指标添加或删除容量。</p><p id="bbd6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">滚动到底部并点击下一个的<strong class="jx io">。</strong></p><figure class="lh li lj lk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lo"><img src="../Images/8450885c223c9f590a68006122f1f7d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2ZfHeMiPFlXt3Lf54hxPaQ.png"/></div></div></figure><p id="d7cd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在配置堆栈选项页面上，点击下一个按钮<strong class="jx io">。</strong></p><p id="cb83" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在查看页面上，点击<strong class="jx io">创建堆栈</strong>。</p><p id="d7ee" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">资源将需要几分钟的时间来调配。等待堆栈完成，然后继续执行步骤 3。</p><p id="ff90" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">步骤 3:压力测试 EC2 实例</strong></p><p id="2967" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="lp">堆栈创建完成后，再等几分钟，Apache Web 服务器和压力测试工具就会安装完毕。</em></p><p id="0994" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">导航至 EC2 仪表板。</p><p id="f2e6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">点击</strong>实例查看您的实例。</p><p id="1da9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">选中其中一个新创建的实例旁边的框，然后单击<strong class="jx io">连接</strong>。</p><figure class="lh li lj lk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lq"><img src="../Images/e5b1a95cf32c5c4e302599d194077700.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YyoZ7IQgfYTbiU6Dm1Vc5w.png"/></div></div></figure><p id="4cec" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">因为没有创建 KeyPair，所以您将使用 EC2 Instance Connect 连接到 EC2 实例。</p><p id="2539" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">点击<strong class="jx io">连接</strong>。</p><figure class="lh li lj lk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lr"><img src="../Images/5279decba5ba361a6f067fb61741c388.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XIWCs4JtSSh-hcr4KvKXew.png"/></div></div></figure><p id="6e58" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">由于压力工具是在引导时安装的，因此您可以使用以下命令运行该实用程序:</p><pre class="lh li lj lk gt ls lt lu lv aw lw bi"><span id="0825" class="lx ly in lt b gy lz ma l mb mc">stress --cpu 80 --timeout 20000</span></pre><p id="9e1d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">对其他 EC2 实例重复上述步骤。</p><p id="3183" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">自动缩放组的默认冷却时间为 300 秒。五分钟后，您的自动扩展策略将生效，并将启动其他实例。</p></div></div>    
</body>
</html>