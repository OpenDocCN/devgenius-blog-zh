<html>
<head>
<title>More fun with Medium story stats, JSON, Python, Pandas, and Oracle SQL Developer Web</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Medium story stats、JSON、Python、Pandas 和 Oracle SQL Developer Web 带来更多乐趣</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/more-fun-with-medium-story-stats-json-python-pandas-and-oracle-sql-developer-web-e3f9f5c7a86e?source=collection_archive---------7-----------------------#2022-11-22">https://blog.devgenius.io/more-fun-with-medium-story-stats-json-python-pandas-and-oracle-sql-developer-web-e3f9f5c7a86e?source=collection_archive---------7-----------------------#2022-11-22</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="7182" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">没错；我又回来了，这是致力于与 Medium.com 故事统计的持续系列的另一部分。我在以前的一篇文章中首次介绍了这个话题。也许你看到了。如果没有，可以在这里找到<a class="ae ki" href="https://followthecoffee.com/fun-with-python-get-requests-medium-stats-and-the-oracle-autonomous-database/" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="7d80" class="kj kk in bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">概述</h1><p id="3c08" class="pw-post-body-paragraph jk jl in jm b jn lh jp jq jr li jt ju jv lj jx jy jz lk kb kc kd ll kf kg kh ig bi translated">我的最终目标是从我的中型账户中收集所有的故事统计数据，并将它们放入我的自治数据库中。我想练习一下我的 SQL，看看我是否能从数据中获得洞察力。不幸的是，收集这些数据很复杂。</p><p id="007e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一旦我知道在哪里可以找到这些故事统计数据，提取数据就变得轻而易举了。我必须破译我在 Medium REST API 中看到的东西(我想这有点棘手)。我的搜索主要是对耐心的锻炼(有<em class="lm">很多</em>的尝试和错误)。</p><p id="a42f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我在之前的帖子上传了一个快速视频。但是我将把它嵌入到这里，这样您就可以看到我如何找到特定 JSON 有效负载的过程。</p><figure class="ln lo lp lq gt lr"><div class="bz fp l di"><div class="ls lt l"/></div></figure><h1 id="df9d" class="kj kk in bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">获取原始 JSON</h1><p id="dca8" class="pw-post-body-paragraph jk jl in jm b jn lh jp jq jr li jt ju jv lj jx jy jz lk kb kc kd ll kf kg kh ig bi translated">找到那个 URL 后，我将这个 json 保存为一个. JSON 文件。下图显示了用 JSON 的其余部分捕获的 JavaScript 函数的残余部分。我不是 JavaScript 专家，所以我不知道这个函数是做什么的。但在我将它加载到我的自治数据库之前(我使用的是 OCI 自由层账户，如果你好奇，你可以在这里查看<a class="ae ki" href="https://www.oracle.com/cloud/free/" rel="noopener ugc nofollow" target="_blank"/>),它需要消失。</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi lu"><img src="../Images/c743864026fb6ba6799c9087c622075a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dmLWpy1htqCK9gFcQ_BC1A.png"/></div></div><figcaption class="mb mc gj gh gi md me bd b be z dk translated">JSON 响应错误</figcaption></figure><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi lu"><img src="../Images/4c815320c5a5d6f0a7f2e8c7e801482b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Evp43Kv_OjUEMo5MwBdkDA.png"/></div></div><figcaption class="mb mc gj gh gi md me bd b be z dk translated">更好的 JSON 演示</figcaption></figure><blockquote class="mf mg mh"><p id="a6da" class="jk jl lm jm b jn jo jp jq jr js jt ju mi jw jx jy mj ka kb kc mk ke kf kg kh ig bi translated"><strong class="jm io">自述</strong></p><p id="4479" class="jk jl lm jm b jn jo jp jq jr js jt ju mi jw jx jy mj ka kb kc mk ke kf kg kh ig bi translated">我在这里指出一些看起来复杂和不必要的事情。请花时间阅读这一节，这样你就能更好地理解我的疯狂。</p><p id="45b4" class="jk jl lm jm b jn jo jp jq jr js jt ju mi jw jx jy mj ka kb kc mk ke kf kg kh ig bi translated"><strong class="jm io">首先:</strong>是的，您可以手动删除与主要 JSON 有效负载一起保存的[大概] JavaScript(参见以上段落)。作为一个实践练习，我将展示如何用 Python 来做这件事。但是我也为未来的自动化留下了机会(因为它与清理数据有关)。</p><p id="d9ee" class="jk jl lm jm b jn jo jp jq jr js jt ju mi jw jx jy mj ka kb kc mk ke kf kg kh ig bi translated"><strong class="jm io">其次:</strong>说到熊猫数据框的步骤，当然，你可以在 Excel、Numbers 或 Sheets 中完成所有这些！同样，这里的想法是向您展示我如何在 Python 中清理和处理它。有时在 Excel、Numbers 和 Sheets 中做这样的事情是不可能的(在这里考虑企业安全性)。</p><p id="46e0" class="jk jl lm jm b jn jo jp jq jr js jt ju mi jw jx jy mj ka kb kc mk ke kf kg kh ig bi translated"><strong class="jm io">第三:</strong>无可否认，日期时间转换是令人捧腹和费解的。<em class="in">当然</em>，我可以在电子表格应用程序中这样做。这不是重点。我实际展示了这个功能，并为未来潜在的自动化做好了准备。</p><p id="d83b" class="jk jl lm jm b jn jo jp jq jr js jt ju mi jw jx jy mj ka kb kc mk ke kf kg kh ig bi translated"><strong class="jm io">第四:</strong>我第一个承认 JSON &gt; TXT &gt; JSON &gt; CSV 文件转换很滑稽。所以如果你有什么建议，在这里或者在我的 GitHub 知识库上留下评论(下面我会链接)，我会给你归属！</p></blockquote><h1 id="d56e" class="kj kk in bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">代码</h1><p id="4895" class="pw-post-body-paragraph jk jl in jm b jn lh jp jq jr li jt ju jv lj jx jy jz lk kb kc kd ll kf kg kh ig bi translated">用嵌入的注释在上下文中解释代码将是最有启发性的。</p><p id="988a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我已经尽可能按字面意义命名了代码中的所有内容。在生产中，这似乎不切实际；<em class="lm">然而，</em>代码到底在做什么是毫无疑问的！更加文字化对于调试和代码维护来说是理想的。</p><p id="6928" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">下面是整个代码块(所以 CTRL+C/CTRL+V 随心所欲😘).我仍然会把它分成几个独立的部分来回顾。</p><pre class="ln lo lp lq gt ml mm mn bn mo mp bi"><span id="ba8a" class="mq kk in mm b be mr ms l mt mu">import csv<br/>import json<br/>import pandas as pd<br/>import datetime<br/>from pathlib import Path<br/><br/># You'll first need to sign in to your account, then you can access this <br/># URL without issues:<br/># https://medium.com/@chrishoina/stats/total/1548525600000/1668776608433<br/># NOTES:<br/># Replace the "@chrishoina" with your username<br/># The two numbers you see are Unix Epochs; you can modify those as <br/># needed; in my case, I wanted to see the following:<br/># * 1548525600000 - At the time of this post, this seems to be<br/># whenever your first post was published or when<br/># you first created a Medium account. In this case, for me, this<br/># was Sat, Jan/26/2019, 6:00:00PM - GMT<br/># * 1665670606216 - You shouldn't need to change this since it will <br/># just default to the current date.<br/># For the conversion, I an Epoch Converter tool I found <br/># online: https://www.epochconverter.com/<br/><br/># Step 1 - Convert this to a,(.txt) file<br/><br/>p = Path("/Users/choina/Documents/socialstats/1668776608433.json")<br/>p.rename(p.with_suffix('.txt'))<br/><br/># Step 2 - "read" in that text file, and remove those pesky<br/># characters/artifacts from position 0 through position 15.<br/># I'm only retaining the JSON payload from position 16 onward.<br/><br/>with open("/Users/choina/Documents/socialstats/1668776608433.txt", "r") as f:<br/>  stats_in_text_file_format = f.read()<br/><br/># This [16:] essentially means grabbing everything in this range. Since<br/># there is nothing after the colon; it will just default to the end (which is<br/># what I want in this case).<br/><br/>cleansed_stats_from_txt_file = stats_in_text_file_format[16:]<br/>print(cleansed_stats_from_txt_file)<br/><br/># This took me a day to figure out, but this text file needs to be encoded<br/># properly, so I can save it as a JSON file (which is about to happen). I<br/># always need to remember this, but I know that the json.dumps = dump<br/># string, which json.dump = dump object. There is a difference, I'm not<br/># the expert, but the docs were helpful.<br/><br/>json.dumps(cleansed_stats_from_txt_file)<br/><br/># Step 3 - Here, I create a new file, then indicate we will "w"rite to it. <br/># Here we take the progress from Step 2 and apply it here.<br/><br/>with open('medium_stats_ready_for_pandas.json', 'w') as f:<br/>  f.write(cleansed_stats_from_txt_file)<br/><br/># Step 4 - Onto Pandas! We've already imported the pandas library as "pd."<br/># We first create a data frame and name the columns. I kept the names<br/># very similar to avoid confusion. I feared that timestampMs might be a<br/># reserved word in Oracle DB or too close, so I renamed it.<br/><br/>df = pd.DataFrame(columns=['USERID', 'FLAGGEDSPAM', 'STATSDATE', <br/>'UPVOTES', 'READS', 'VIEWS', 'CLAPS', 'SUBSCRIBERS'])<br/><br/>with open("/Users/choina/Documents/socialstats/medium_stats_ready_for_pandas.json", "r") as f:<br/>  data = json.load(f)<br/>  data = data['payload']['value']<br/>  print(data)<br/><br/>for i in range(0, len(data)):<br/>  df.loc[i] = [data[i]['userId'], data[i]['flaggedSpam'],<br/>  data[i]['timestampMs'], data[i]['upvotes'], data[i]['reads'], <br/>  data[i]['views'], data[i]['claps'], data[i]['updateNotificationSubscribers']]<br/>  <br/>df['STATSDATE'] = pd.to_datetime(df['STATSDATE'], unit="ms")<br/>print(df.columns)<br/><br/># Step 5 - use the Pandas' df.to_csv function and save the data frame as<br/># a CSV file<br/><br/>with open("medium_stats_ready_for_database_update.csv", "w") as f:<br/>  df.to_csv(f, index=False, header=True)</span></pre><p id="f0df" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我在这个脚本中使用了几个 Python 库:</p><p id="4f5e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae ki" href="https://docs.python.org/3/library/csv.html" rel="noopener ugc nofollow" target="_blank"> CSV </a></p><p id="56d0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae ki" href="https://docs.python.org/3/library/json.html" rel="noopener ugc nofollow" target="_blank"> JSON </a></p><p id="7cc6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae ki" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">熊猫</a>(进口为“pd”)</p><p id="273d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae ki" href="https://docs.python.org/3/library/datetime.html" rel="noopener ugc nofollow" target="_blank">日期时间</a></p><p id="d44e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Path(从<a class="ae ki" href="https://docs.python.org/3/library/pathlib.html" rel="noopener ugc nofollow" target="_blank"> Pathlib </a>导入的文件路径库)</p><h1 id="ec25" class="kj kk in bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">第一步</h1><pre class="ln lo lp lq gt ml mm mn bn mo mp bi"><span id="e57a" class="mq kk in mm b be mr ms l mt mu">p = Path("/Users/choina/Documents/socialstats/1668776608433.json")<br/>p.rename(p.with_suffix('.txt')</span></pre><p id="bb37" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">路径库允许您将文件的路径分配给“p”。从那以后，我改变了。json 文件扩展名为. txt 扩展名。</p><blockquote class="mf mg mh"><p id="dd65" class="jk jl lm jm b jn jo jp jq jr js jt ju mi jw jx jy mj ka kb kc mk ke kf kg kh ig bi translated">同样，我确信有更好的方法来做到这一点，所以如果你正在阅读，请在这里或我的 GitHub 知识库上留下评论，这样我就可以把它归功于你🙃。</p></blockquote><p id="d341" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这一步的前后看起来是这样的:</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi mv"><img src="../Images/9ef926bfdc1e5fb3a886eb2a54290c05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K95T-K-QHUjiqCSCP4Ap9Q.png"/></div></div><figcaption class="mb mc gj gh gi md me bd b be z dk translated">在之前的 JSON <em class="mw"/></figcaption></figure><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi mx"><img src="../Images/fa10e82fd75dc882d1f89b7f9ab79607.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n-gzPGqjrTcqRJ3rNnx-Ew.png"/></div></div><figcaption class="mb mc gj gh gi md me bd b be z dk translated">在之后的 TXT <em class="mw"/></figcaption></figure><p id="5aa1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这样一来，我需要删除文件中的 JavaScript“前缀”。我在第二步中这样做(我想得太多了，可能达到了收益递减)。我的方法很有效，我也可以将它用于其他应用程序！</p><h1 id="bde1" class="kj kk in bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">第二步:</h1><pre class="ln lo lp lq gt ml mm mn bn mo mp bi"><span id="b134" class="mq kk in mm b be mr ms l mt mu"># Step 2 - "read" in that text file, and remove those pesky<br/># characters/artifacts from position 0 through position 15. Or in other<br/># words, you'll retain everything from position 16 onward because that's<br/># where the actual JSON payload is.<br/><br/>with open("/Users/choina/Documents/socialstats/1668776608433.txt", "r") as f:<br/>  stats_in_text_file_format = f.read()<br/><br/># This [16:] essentially means grabbing everything in this range. Since<br/># there is nothing after the colon; it will just default to the end (which is<br/># what I want in this case).<br/><br/>cleansed_stats_from_txt_file = stats_in_text_file_format[16:]<br/>print(cleansed_stats_from_txt_file)<br/><br/># This took me a day to figure out, but this text file needs to be<br/># appropriately encoded to save as a JSON file (which is about to<br/># happen). I always forget the difference between "dump" and "dumps";<br/># json.dumps = dump string, whereas json.dump = dump object. There is<br/># a difference, I'm not the expert, but the docs were helpful (you should<br/># read them).<br/><br/>json.dumps(cleansed_stats_from_txt_file)</span></pre><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi mx"><img src="../Images/8894fc40738e7135764b7f24a4602950.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3aYo8MCDkhpfkacTyZW7Pg.png"/></div></div><figcaption class="mb mc gj gh gi md me bd b be z dk translated">我需要从中等 JSON 响应中移除这些残余</figcaption></figure><p id="36a1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">虽然这最初是作为 JSON 有效负载出现的，但前 0-15 个字符必须删除。</p><blockquote class="mf mg mh"><p id="215d" class="jk jl lm jm b jn jo jp jq jr js jt ju mi jw jx jy mj ka kb kc mk ke kf kg kh ig bi translated"><strong class="jm io">完整声明:</strong>当它还是一个 JSON 文件时，我不知道如何删除它，所以我把它转换成了文本文件(这是我唯一能找到的方法)。</p></blockquote><p id="0510" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我将位置 16 捕获到无穷远处(或者文件的结尾，无论哪个先出现)，然后将文件重新编码为 JSON(我将此解释为“目标机器可以读取并理解为 JSON 的东西”)。</p><blockquote class="mf mg mh"><p id="0257" class="jk jl lm jm b jn jo jp jq jr js jt ju mi jw jx jy mj ka kb kc mk ke kf kg kh ig bi translated"><strong class="jm io">开季:</strong> CompSci 乡亲们，如果我说错了，请在评论里烤我。</p></blockquote><h1 id="fac4" class="kj kk in bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">第三步</h1><pre class="ln lo lp lq gt ml mm mn bn mo mp bi"><span id="34f9" class="mq kk in mm b be mr ms l mt mu"># Step 3 - I create a new file, then I'll "w"rite to it. I took the result<br/># from Step 2 and applied it here.<br/><br/>with open('medium_stats_ready_for_pandas.json', 'w') as f:<br/>  f.write(cleansed_stats_from_txt_file)</span></pre><p id="5f4d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我仍然处在这个旅程的数据争论阶段，但是我已经接近尾声了。我将创建一个新的 JSON 文件，获取(新编码的)文本文件中我需要的部分，然后将它们保存为新的 JSON 文件。</p><h1 id="9ea4" class="kj kk in bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">第四步</h1><pre class="ln lo lp lq gt ml mm mn bn mo mp bi"><span id="e402" class="mq kk in mm b be mr ms l mt mu"># Step 4 - Onto Pandas! We've already imported the pandas library as "pd"<br/># I first create a data frame and name the columns. I kept the names<br/># similar to avoid confusion. I feared that timestampMs might be a<br/># reserved word in Oracle DB or too close, so I renamed it.<br/><br/>df = pd.DataFrame(columns=['USERID', 'FLAGGEDSPAM', 'STATSDATE', <br/>'UPVOTES', 'READS', 'VIEWS', 'CLAPS', 'SUBSCRIBERS'])<br/><br/>with open("/Users/choina/Documents/socialstats/medium_stats_ready_for_pandas.json", "r") as f:<br/>  data = json.load(f)<br/>  data = data['payload']['value']<br/>  print(data)<br/><br/>for i in range(0, len(data)):<br/>  df.loc[i] = [data[i]['userId'], data[i]['flaggedSpam'], <br/>  data[i]['timestampMs'], data[i]['upvotes'],<br/>  data[i]['reads'], data[i]['views'], data[i]['claps'], <br/>  data[i]['updateNotificationSubscribers']]<br/><br/>df['STATSDATE'] = pd.to_datetime(df['STATSDATE'], unit="ms")<br/>print(df.columns)</span></pre><p id="e94a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我不会教熊猫(老实说，你做<strong class="jm io"> <em class="lm">而不是</em> </strong>想让我教你熊猫)，但我会尽力解释我的过程。我首先创建了数据框的结构(在本例中是“df”)。然后，我命名了所有的列标题(这些可以是任何东西，但是我把它们保持得非常接近原始 JSON 有效负载中的标题)。</p><p id="895e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">然后，我打开新保存的 JSON 文件，提取我需要的内容。</p><blockquote class="mf mg mh"><p id="1c30" class="jk jl lm jm b jn jo jp jq jr js jt ju mi jw jx jy mj ka kb kc mk ke kf kg kh ig bi translated"><strong class="jm io">注:</strong>我在这里卡了大概一天半，我来解释一下这部分。</p></blockquote><p id="12b0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">数据['有效载荷']['值']指的是这个特定{key: value}对中的键和值。这种方法让我抓住了“价值”的所有价值。这张图片解释了我的开始(左边)和结束(右边)。</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi mx"><img src="../Images/215122034a9cd0e81b979d053dc46ab6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6AncSZX_kSP1tcVH4lNNig.png"/></div></div><figcaption class="mb mc gj gh gi md me bd b be z dk translated">之前和之后的<code class="fe my mz na mm b"> JSON </code>有效负载</figcaption></figure><p id="db87" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">您会注意到一个{"success": true}键:值对。通过这种方法，我在 JSON 有效载荷的末尾去掉了这一对，并去掉了其他的。</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi nb"><img src="../Images/8e345513b2b81a4c55488e80230e96d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*khJNcf-MKU-uDa0k4_N-Rw.png"/></div></div><figcaption class="mb mc gj gh gi md me bd b be z dk translated">清除大量垃圾</figcaption></figure><p id="871b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我不能因为<em class="lm">有机地</em>想出了下一部分而邀功；YouTube 上的 Kidson 是我的救世主。我会看这个视频来完全理解这段代码中发生了什么:</p><figure class="ln lo lp lq gt lr"><div class="bz fp l di"><div class="ls lt l"/></div></figure><pre class="ln lo lp lq gt ml mm mn bn mo mp bi"><span id="68aa" class="mq kk in mm b be mr ms l mt mu">for i in range(0, len(data)):<br/>  df.loc[i] = [data[i]['userId'], data[i]['flaggedSpam'], <br/>  data[i]['timestampMs'], data[i]['upvotes'],data[i]['reads'], <br/>  data[i]['views'], data[i]['claps'], data[i]['updateNotificationSubscribers']]</span></pre><p id="17a0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">简而言之，您从 JSON 文件(如上)的列中获取值，然后将它们放入这段代码中指定的列位置:</p><pre class="ln lo lp lq gt ml mm mn bn mo mp bi"><span id="bea3" class="mq kk in mm b be mr ms l mt mu">df = pd.DataFrame(columns=['USERID', 'FLAGGEDSPAM', 'STATSDATE', <br/>'UPVOTES', 'READS', 'VIEWS', 'CLAPS', 'SUBSCRIBERS'])</span></pre><p id="510d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">例如，JSON 文件中的“USERID”值将全部放入 Pandas 数据框中的“userId”列。对于其他值和相关联的(Pandas 数据框)列，也会发生同样的事情。</p><p id="b690" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">最后，我用 Datetime 库将日期(如果您还记得的话，在这个纪元格式中仍然是<em class="lm">还是</em>)更改为一个更友好的、可读的日期。使用此代码:</p><pre class="ln lo lp lq gt ml mm mn bn mo mp bi"><span id="936f" class="mq kk in mm b be mr ms l mt mu">df['STATSDATE'] = pd.to_datetime(df['STATSDATE'], unit="ms")</span></pre><h1 id="69dd" class="kj kk in bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">第五步</h1><pre class="ln lo lp lq gt ml mm mn bn mo mp bi"><span id="7099" class="mq kk in mm b be mr ms l mt mu">with open("medium_stats_ready_for_database_update.csv", "w") as f:<br/>  df.to_csv(f, index=False, header=True)</span></pre><p id="66f6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我现在在最后冲刺阶段。我把我在熊猫里做的所有东西都存成 CSV 文件。我想保留标题，但放弃任何索引。干净的 CSV 文件将如下所示:</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi nc"><img src="../Images/b88b6609bb9af51c69d3099414265703.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s7ET3xADxxFObViYgFDObA.png"/></div></div><figcaption class="mb mc gj gh gi md me bd b be z dk translated">干净整洁的 CSV，可通过 SQL Developer Web 加载数据</figcaption></figure><h1 id="a1ed" class="kj kk in bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">第六步</h1><p id="8657" class="pw-post-body-paragraph jk jl in jm b jn lh jp jq jr li jt ju jv lj jx jy jz lk kb kc kd ll kf kg kh ig bi translated">最后，我登录到 SQL Developer Web 并点击 new Data Load 按钮(在<a class="ae ki" href="https://www.oracle.com/database/technologies/appdev/rest.html" rel="noopener ugc nofollow" target="_blank"> Oracle REST 数据服务</a>版本 22.3 中引入)将 CSV 文件上传到一个新表中。自治数据库自动推断列名和数据类型。我稍微修改了“statsdate”一栏(老实说，我本来可以不去管它，但它很容易修改)。</p><figure class="ln lo lp lq gt lr"><div class="bz fp l di"><div class="ls lt l"/></div></figure><h1 id="f23d" class="kj kk in bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">之前和之后</h1><p id="0480" class="pw-post-body-paragraph jk jl in jm b jn lh jp jq jr li jt ju jv lj jx jy jz lk kb kc kd ll kf kg kh ig bi translated">就是这样！一旦上传，我可以比较我以前做的和我最近完成的。而且两种方式都是正确的。例如，根据您的需求，您可以将 JSON 有效负载保留为 CLOB(如第一幅图所示)或更传统的表格格式(如第二幅图所示)。</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi nd"><img src="../Images/ba9749674b4528d5202422e14709dcd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5ESiLnOVcQnu0nG9E_N2Iw.png"/></div></div><figcaption class="mb mc gj gh gi md me bd b be z dk translated">作为 CLOB 的中等统计</figcaption></figure><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi ne"><img src="../Images/d72e7ad2b22955476bf3012fdd0cb42d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZeEptNoN2BDoVTRLuVoNsQ.png"/></div></div></figure><h1 id="4b9a" class="kj kk in bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">包裹</h1><p id="9955" class="pw-post-body-paragraph jk jl in jm b jn lh jp jq jr li jt ju jv lj jx jy jz lk kb kc kd ll kf kg kh ig bi translated">如果你已经做到了这一步，恭喜你！现在，您应该有两种方法将中等统计数据存储在一个表中(位于 Oracle 自治数据库中),分别是:</p><ul class=""><li id="7f5a" class="nf ng in jm b jn jo jr js jv nh jz ni kd nj kh nk nl nm nn bi translated">一个小丑</li><li id="748d" class="nf ng in jm b jn no jr np jv nq jz nr kd ns kh nk nl nm nn bi translated">一张桌子</li></ul><p id="1030" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你想回顾代码，你可以在这里找到它。</p><p id="5580" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">下次再见，🫠，快乐查询。</p><h1 id="1584" class="kj kk in bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">别忘了跟着</h1><p id="f107" class="pw-post-body-paragraph jk jl in jm b jn lh jp jq jr li jt ju jv lj jx jy jz lk kb kc kd ll kf kg kh ig bi translated">如果您还没有分享或关注，请务必分享或关注:</p><ul class=""><li id="e6e3" class="nf ng in jm b jn jo jr js jv nh jz ni kd nj kh nk nl nm nn bi translated"><a class="ae ki" href="https://twitter.com/chrishoina" rel="noopener ugc nofollow" target="_blank">推特</a></li><li id="a020" class="nf ng in jm b jn no jr np jv nq jz nr kd ns kh nk nl nm nn bi translated"><a class="ae ki" href="http://followthecoffee.com" rel="noopener ugc nofollow" target="_blank">我的博客</a></li><li id="72e2" class="nf ng in jm b jn no jr np jv nq jz nr kd ns kh nk nl nm nn bi translated"><a class="ae ki" href="https://www.youtube.com/user/chrishoina/" rel="noopener ugc nofollow" target="_blank"> YouTube </a></li><li id="59cf" class="nf ng in jm b jn no jr np jv nq jz nr kd ns kh nk nl nm nn bi translated"><a class="ae ki" href="https://www.tiktok.com/@chrishoina" rel="noopener ugc nofollow" target="_blank">抖音</a></li><li id="48e2" class="nf ng in jm b jn no jr np jv nq jz nr kd ns kh nk nl nm nn bi translated"><a class="ae ki" href="https://github.com/chrishoina" rel="noopener ugc nofollow" target="_blank"> GitHub </a></li><li id="e2d1" class="nf ng in jm b jn no jr np jv nq jz nr kd ns kh nk nl nm nn bi translated"><a class="ae ki" href="https://www.linkedin.com/in/chrishoina/" rel="noopener ugc nofollow" target="_blank">领英</a></li><li id="f6e0" class="nf ng in jm b jn no jr np jv nq jz nr kd ns kh nk nl nm nn bi translated"><a class="ae ki" href="https://mastodon.technology/web/@chrishoina" rel="noopener ugc nofollow" target="_blank">乳齿象</a></li><li id="e801" class="nf ng in jm b jn no jr np jv nq jz nr kd ns kh nk nl nm nn bi translated"><a class="ae ki" href="https://discord.gg/seYeAPgq9E" rel="noopener ugc nofollow" target="_blank">不和谐</a></li><li id="5e49" class="nf ng in jm b jn no jr np jv nq jz nr kd ns kh nk nl nm nn bi translated"><a class="ae ki" href="https://stackoverflow.com/users/9552864/chris-hoina" rel="noopener ugc nofollow" target="_blank">堆栈溢出</a></li></ul></div></div>    
</body>
</html>