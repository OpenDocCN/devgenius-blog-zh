<html>
<head>
<title>How to use Zustand which is react state management library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用状态管理库 Zustand</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-use-zustand-which-is-react-state-management-library-648f55a0455f?source=collection_archive---------1-----------------------#2022-05-15">https://blog.devgenius.io/how-to-use-zustand-which-is-react-state-management-library-648f55a0455f?source=collection_archive---------1-----------------------#2022-05-15</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/51520d8adee0b58f35d239ba911b2a2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fAiGgH1sMbHu67wGpJIUjQ.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">图片来自<a class="ae jz" href="https://github.com/pmndrs/zustand" rel="noopener ugc nofollow" target="_blank">https://github.com/pmndrs/zustand</a></figcaption></figure><h1 id="95d2" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">目的</h1><p id="c342" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">由于我在工作期间研究了 Zustand，关于这个库的例子并不多，所以我将它分享给你。</p><h1 id="1e55" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">Zustand 是什么？</h1><p id="f359" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">Zustand 是 JS 中使用简化 flux 原理的状态管理库之一，在 github 上有 16.8k stars。您可以在 react 或任何其他 JS 框架(如 Angular 或 Vue)中使用这个库，甚至可以在 Vanilla JS 中使用。</p><p id="af9e" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">如果你有使用 Redux 的经验，这个库很容易理解，因为它和 Redux 很相似。</p><h1 id="0cee" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">利弊</h1><h2 id="132a" class="mb kb in bd kc mc md dn kg me mf dp kk lj mg mh ko ln mi mj ks lr mk ml kw mm bi translated">赞成的意见</h2><ul class=""><li id="71ca" class="mn mo in la b lb lc lf lg lj mp ln mq lr mr lv ms mt mu mv bi translated">与 Redux 相比，代码更少</li></ul><p id="afaf" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">正如你可能知道的，redux 是一个非常有用的状态管理库，但是他们需要很多样板文件。因此，一般来说，Redux 非常适合相对较大的项目或应用程序，这些项目或应用程序应该有几个不同的状态，并且经常改变状态的状态。另一方面，Zustand 不需要太多样板文件，即使你不需要你的父母提供服务。</p><ul class=""><li id="c630" class="mn mo in la b lb lw lf lx lj mw ln mx lr my lv ms mt mu mv bi translated">简单的文档</li></ul><p id="e33e" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">基本上，redux 有一个主要的方法来编写，其中包含代码示例和官方文档中的许多说明。这很好用，但是在一个小项目中可能用过头了。相反，Zustand 有基础教程，有中等量的代码示例作为菜谱，就这样。这对于简单项目是可搜索的。</p><ul class=""><li id="654a" class="mn mo in la b lb lw lf lx lj mw ln mx lr my lv ms mt mu mv bi translated">灵活性</li></ul><p id="d183" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">正如我提到的，这个库包含了大量的代码示例，这些示例包含了几种编写方法。你可以写得更简单，或者你可以集成一些中间件，比如 immer，以实现不变性，或者你甚至可以写你的代码，比如 redux way，它有 reducer，dispatch。redux 有一个大型全球商店，但 Zustand 允许您独立创建多个商店。当然，您可以创建一个全局商店，也可以将不同的商店创建为几个部分并进行组合。此外，这个库也支持 TypeScript。这个库非常灵活。</p><h2 id="767c" class="mb kb in bd kc mc md dn kg me mf dp kk lj mg mh ko ln mi mj ks lr mk ml kw mm bi translated">骗局</h2><ul class=""><li id="de9e" class="mn mo in la b lb lc lf lg lj mp ln mq lr mr lv ms mt mu mv bi translated">信息不多</li></ul><p id="efa6" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">没有太多关于 Zustand 的信息，因为国家管理系统存在几个。由于 redux 是最受欢迎的库之一，你可以很容易地在文档中甚至在堆栈溢出中找到解决方案，因为已经有很多人在为同样的问题或错误而奋斗。然而，那不是给 Zustand 的。你需要更多的尝试和失误来找到解决方案。</p><ul class=""><li id="8465" class="mn mo in la b lb lw lf lx lj mw ln mx lr my lv ms mt mu mv bi translated">很多括号</li></ul><p id="2a4f" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">在我看来，你需要有很多括号来节省代码量。特别是如果你想在没有任何其他库的情况下获取一些数据，你需要写更多的代码，因为你应该用括号写状态变化。这是一种个人偏好，因为至少你可以保存你的代码，避免滚动。</p><ul class=""><li id="45de" class="mn mo in la b lb lw lf lx lj mw ln mx lr my lv ms mt mu mv bi translated">难以找到最佳实践</li></ul><p id="354c" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">正如我提到的，这个库具有非常好的灵活性。另一方面，您需要选择如何编写代码来使用 Zustand 创建您的应用程序。换句话说，很容易“使用”Zustand，但是很难“高效使用”Zustand。在我看来，在实际项目中使用时，你需要“试错”。</p><p id="cb19" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">这是足够的基本信息，让我们探索一些例子。</p><h1 id="1c68" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">示例 1(计数器应用程序)</h1><p id="e84e" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">这是我在 src 目录下的文件夹结构(只包含必要的)。</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="033d" class="mb kb in ne b gy ni nj l nk nl">src<br/>├── App.css<br/>├── App.js<br/>├── app<br/>│   └── store.js<br/>├── features<br/>│   └── counter<br/>│       └── Counter.js<br/>├── index.css<br/>├── index.js</span></pre><h2 id="c6b8" class="mb kb in bd kc mc md dn kg me mf dp kk lj mg mh ko ln mi mj ks lr mk ml kw mm bi translated">步伐</h2><ol class=""><li id="1205" class="mn mo in la b lb lc lf lg lj mp ln mq lr mr lv nm mt mu mv bi translated">创建一个基本的 react 应用程序</li></ol><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="c6af" class="mb kb in ne b gy ni nj l nk nl">npx create-react-app zustand-counter(this name is app to you)<br/>cd zustand-counter</span></pre><p id="9417" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">2.安装 Zustand</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="f8a2" class="mb kb in ne b gy ni nj l nk nl">npm install zustand</span></pre><p id="2fc2" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">3.在 features/counter 文件夹中创建“Counter.js ”(创建文件夹是可选的)。我只是专注于意义。</p><p id="5a33" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">4.在 App.js 中导入您的 Counter.js</p><figure class="mz na nb nc gt jo"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="c017" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">5.在 app 文件夹内创建“store.js”(创建文件夹部分是可选的)。您需要导入 zustand，并将其用作 useStore。您应该创建 store，并设置像 count 这样的默认值，并且您可以通过使用 callback 来创建一些方法。您可以设置像 1 这样的实数值，或者您可以设置 payload 来更动态地使用。这个“有效载荷”的名称由你决定，因为官方文件在这部分写着“by”。然而，我对 redux 很熟悉，所以我把 payload 放在这里是有意义的。</p><figure class="mz na nb nc gt jo"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="708f" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">6.将这个“useStore”导入 Counter.js，并使用它。你可以在 redux 中使用某种 useSelector，你需要用 useStore 选择(oldValue) =&gt; (newValue)。如果要使用 payload，需要注意回调，因为调用的时机问题。</p><figure class="mz na nb nc gt jo"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="3ac9" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">7.就是这样！这是应用程序屏幕，它应该工作。您可以使用任何组件来注入状态，即使它们具有深度嵌套的文件夹结构。</p><figure class="mz na nb nc gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi np"><img src="../Images/70922fbca50fbe2e2767665e8bb43bba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*7FGXjne2YxxzapqlfqbVIA.gif"/></div></div></figure><h1 id="c092" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">示例 2(获取信息应用程序)</h1><p id="3658" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">这是我在 src 目录下的文件夹结构(仅包含必要的文件夹，类似于示例 1)。</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="8b82" class="mb kb in ne b gy ni nj l nk nl">src<br/>├── App.css<br/>├── App.js<br/>├── app<br/>│   └── store.js<br/>├── features<br/>│   └── fetchData<br/>│       └── FetchDataZustand.js<br/>├── index.css<br/>├── index.js</span></pre><h2 id="deef" class="mb kb in bd kc mc md dn kg me mf dp kk lj mg mh ko ln mi mj ks lr mk ml kw mm bi translated">步骤(1 和 2 与示例 1 相同)</h2><ol class=""><li id="b282" class="mn mo in la b lb lc lf lg lj mp ln mq lr mr lv nm mt mu mv bi translated">创建一个基本的 react 应用程序</li></ol><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="0550" class="mb kb in ne b gy ni nj l nk nl">npx create-react-app zustand-fetch-data(this name is app to you)<br/>cd zustand-fetch-data</span></pre><p id="4cac" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">2.安装 Zustand 和 axios(使用 axios 获取数据)</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="c870" class="mb kb in ne b gy ni nj l nk nl">npm install zustand axios</span></pre><p id="3482" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">3.在 features/fetchData 文件夹中创建“FetchDataZustand.js”(创建文件夹是可选的)。</p><p id="29f5" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">4.在 App.js 中导入“FetchDataZustand.js”</p><figure class="mz na nb nc gt jo"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="d433" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">5.在 app 文件夹内创建“store.js”(创建文件夹部分是可选的)。你需要从“zustand”和 axios 导入 create，并使用它。比如 redux 例子，我准备了三种不同类型的 state 值，分别用来获取确切的数据、加载和获取错误(名字由你决定)。并创建一个带有回调的获取方法。您可以为数据提取的每个部分设置主导和错误状态。出于演示目的，我使用了 jsonplaceholder 的端点，但是您可以使用任何想要的端点。</p><figure class="mz na nb nc gt jo"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="5ecc" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">6.将这个“useStore”导入到 FetchDataZutand.js，并使用它。与第一个例子相同，您可以使用“useStore”，如 redux“use selector”。“陈述本身”和“动作”都可以用。</p><figure class="mz na nb nc gt jo"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="bbce" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">7.就是这样。下面是实际屏幕，你可以看到加载状态。这个数据量很小，所以你几乎看不到加载状态，但是加载和数据读取状态是工作的。</p><figure class="mz na nb nc gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi np"><img src="../Images/35e666de93dcff777c5151f6042f6b43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*rWQS0vb4UzsXB9fkTXYtGg.gif"/></div></div></figure><p id="371c" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">下面是我故意拼错端点错误版本。您可以清楚地看到加载和错误信息。</p><figure class="mz na nb nc gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi np"><img src="../Images/940d68d79aefd4d88c9910efb0092045.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*0cFYUnyRXkrUf9nRibtNRA.gif"/></div></div></figure><h1 id="ff78" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">结论</h1><p id="1b1e" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">Zustand 是最有用的状态管理库之一，与 Redux 相比，它非常灵活且代码更少。如果你需要一些全局语句库，我推荐你考虑这个库。</p><h1 id="6c6d" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">参考</h1><p id="f947" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">官方文件:<a class="ae jz" href="https://docs.pmnd.rs/zustand/introduction" rel="noopener ugc nofollow" target="_blank">https://docs.pmnd.rs/zustand/introduction</a></p><p id="7aa6" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">切片示例:<a class="ae jz" href="https://github-wiki-see.page/m/pmndrs/zustand/wiki/Splitting-the-store-into-separate-slices" rel="noopener ugc nofollow" target="_blank">https://github-wiki-see . page/m/pm ndrs/zustand/wiki/Splitting-the-store-into-separate-slices</a></p><p id="65eb" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">Zustand 简单状态管理指南:<a class="ae jz" href="https://blog.bitsrc.io/zustands-guide-to-simple-state-management-12c654c69990" rel="noopener ugc nofollow" target="_blank">https://blog . bitsrc . io/zustands-Guide-to-Simple-State-Management-12c 654 c 69990</a></p><p id="d777" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi">Reactで状態管理 初心者でも簡単 Zustandの設定方法：<a class="ae jz" href="https://reffect.co.jp/react/zustand" rel="noopener ugc nofollow" target="_blank">https://reffect.co.jp/react/zustand</a></p><p id="f233" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">感谢您的阅读！！</p></div></div>    
</body>
</html>