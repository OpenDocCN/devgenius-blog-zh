<html>
<head>
<title>Using Constructors The Right Way</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">正确使用构造函数</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-use-constructors-509cd867010a?source=collection_archive---------3-----------------------#2022-09-27">https://blog.devgenius.io/how-to-use-constructors-509cd867010a?source=collection_archive---------3-----------------------#2022-09-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0d72" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">新手程序员创建对象时的五大通病。避免这些错误，像专家一样编码。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/efea0946560421526cfe592a1d67e415.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z2jAWH_00Wle1kppjsBgeA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">图片由<a class="ae kv" href="https://www.pexels.com/@olly/" rel="noopener ugc nofollow" target="_blank">安德里亚·皮亚卡迪奥</a>拍摄</figcaption></figure><blockquote class="kw kx ky"><p id="be8a" class="kz la lb lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">本出版物中的示例是用 PHP 编写的，但是代码对于任何程序员来说都应该很容易理解；另一方面，这些规则适用于任何编程语言(几乎是)。)</p></blockquote></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><p id="f1c6" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">你写面向对象的代码吗？你可能听说过<strong class="lc ir">建造者</strong>。构造函数的目的是初始化新创建的对象。来自<a class="ae kv" href="https://www.php.net/manual/en/language.oop5.decon.php" rel="noopener ugc nofollow" target="_blank"> PHP 手册</a>:</p><blockquote class="mg"><p id="b6f4" class="mh mi iq bd mj mk ml mm mn mo mp lv dk translated">具有构造函数方法的类在每个新创建的对象上调用这个方法，因此它适用于对象在使用前可能需要的任何初始化。</p></blockquote><p id="e810" class="pw-post-body-paragraph kz la iq lc b ld mq jr lf lg mr ju li md ms ll lm me mt lp lq mf mu lt lu lv ij bi translated">构造者打算只参与<strong class="lc ir">他行动所必需的逻辑；虽然我经常遇到构造函数被过度使用的代码。</strong></p><p id="c46a" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">这里有一个精选的列表，列出了开发新手在面向对象编程中应该避免的最常见的错误。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="d013" class="mv mw iq bd mx my mz na nb nc nd ne nf jw ng jx nh jz ni ka nj kc nk kd nl nm bi translated">避免过多的争论</h1><p id="eba9" class="pw-post-body-paragraph kz la iq lc b ld nn jr lf lg no ju li md np ll lm me nq lp lq mf nr lt lu lv ij bi translated">对于大型构造函数，普遍接受的限制是七个参数。我相信这个限制无论如何都太高了。</p><p id="a1f6" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">拥有大量的参数是一种代码味道。代码做了太多的指示符。考虑把它分成更小的班级。</p><p id="7766" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">我在控制器中多次看到这种模式。一个控制器类有许多动作；每一个都可能需要一组不同的依赖关系:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="4128" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated"><strong class="lc ir">解决方案:</strong>最好尽量<strong class="lc ir">不要超过 3–4 个参数</strong>。总是问自己是否需要所有的依赖。通过做得更少，代码会变得更干净，并且它的可维护性和可测试性会增加。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="3311" class="mv mw iq bd mx my mz na nb nc nd ne nf jw ng jx nh jz ni ka nj kc nk kd nl nm bi translated">避免访问运行时对象</h1><p id="ef47" class="pw-post-body-paragraph kz la iq lc b ld nn jr lf lg no ju li md np ll lm me nq lp lq mf nr lt lu lv ij bi translated">运行时对象是仅在代码运行期间可访问的对象。在 HTTP 上下文中，可能是<code class="fe nu nv nw nx b">RequestStack</code>；否则，它可能是表示当前已通过身份验证的用户的对象。</p><p id="5714" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">这是一个在实例化过程中可能中断的简单代码示例。如果在 HTTP 上下文之外(即在<em class="lb"> CLI </em>命令中)请求该类，而用户服务尚未初始化，则可能会出现这种情况:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="4120" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">构造函数中其他可能错误的用法包括:</p><ul class=""><li id="8a45" class="ny nz iq lc b ld le lg lh md oa me ob mf oc lv od oe of og bi translated">远程 API 调用，</li><li id="8cd2" class="ny nz iq lc b ld oh lg oi md oj me ok mf ol lv od oe of og bi translated">调用其他类方法，</li><li id="45a7" class="ny nz iq lc b ld oh lg oi md oj me ok mf ol lv od oe of og bi translated">调用服务(其中包括:数据库、缓存提供者)</li></ul><p id="bcd5" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated"><strong class="lc ir">解决方案:</strong>不依赖构造函数中的运行时对象。坚持对象分配，将逻辑转移到调用类的方法调用上。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="e39e" class="mv mw iq bd mx my mz na nb nc nd ne nf jw ng jx nh jz ni ka nj kc nk kd nl nm bi translated">避免做得太多</h1><p id="c8b6" class="pw-post-body-paragraph kz la iq lc b ld nn jr lf lg no ju li md np ll lm me nq lp lq mf nr lt lu lv ij bi translated">避免构造函数中不必要的代码，并且<strong class="lc ir">坚持最少的</strong>。除了分配依赖项之外，可接受的最低要求是对输入进行验证。例如:</p><blockquote class="kw kx ky"><p id="1ca7" class="kz la lb lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">一个类至少需要十个正整数才能正常工作。</p></blockquote><p id="5a3d" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">让我们强调这个不变量的正确性:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ns nt l"/></div></figure></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="6f25" class="mv mw iq bd mx my mz na nb nc nd ne nf jw ng jx nh jz ni ka nj kc nk kd nl nm bi translated">避免繁重的计算</h1><p id="203f" class="pw-post-body-paragraph kz la iq lc b ld nn jr lf lg no ju li md np ll lm me nq lp lq mf nr lt lu lv ij bi translated">一个构造函数的执行时间应该是<strong class="lc ir">快如闪电</strong>！运行时间长的构造函数会降低应用程序及其单元测试的速度(这也应该非常快。)</p><p id="597e" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">如果您将自己局限于分配依赖项和可能的简单输入验证，您将避免犯这个错误。</p><p id="aea1" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">我曾多次使用第三方库，它的构造函数非常慢。我不得不使用代理模式来解决对象初始化缓慢的问题。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="75bc" class="mv mw iq bd mx my mz na nb nc nd ne nf jw ng jx nh jz ni ka nj kc nk kd nl nm bi translated">根本不使用构造函数</h1><p id="2849" class="pw-post-body-paragraph kz la iq lc b ld nn jr lf lg no ju li md np ll lm me nq lp lq mf nr lt lu lv ij bi translated">一个常见的误用是在构造函数上使用 setters 依赖注入(请不要在这一点上击败我😊)</p><p id="4d10" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">施工方是你的<strong class="lc ir">保障</strong>；<strong class="lc ir">保证</strong>代码<strong class="lc ir">在被调用时将</strong>包含所有必要的依赖项。</p><p id="f044" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">这个公式经常在 Java Spring 框架中使用，在这个框架中，应用程序服务被注入了<code class="fe nu nv nw nx b">@Autowired</code>注释。</p><p id="7a1c" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">在 PHP 中，我在控制器中反复看到这种模式，依赖关系被直接注入到动作中。</p><p id="f08a" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">我个人更喜欢清晰的契约，而不是框架魔法和捷径。最终，你会做你喜欢的事情。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi om"><img src="../Images/d535786fc8a35de87b90d58a67e5e639.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*F8xkFL0dKRFlRQDF"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">Cheezburger.com<a class="ae kv" href="https://cheezburger.com" rel="noopener ugc nofollow" target="_blank">的好意</a></figcaption></figure><p id="7b0d" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">你喜欢这个列表吗？你同意关键点吗？也许我们应该扩大名单？请在评论中给我留言。另外，请务必阅读我的其他出版物《如何成为更好的开发人员》:</p><div class="on oo gp gr op"><div role="button" tabindex="0" class="ab bv gv cb fp oq or bn os kp ex"><div class="ot l"><div class="ab q"><div class="l di"><img alt=".com software" class="l de bw ou ov fe" src="../Images/3f349f31fce5e546b0eb66af9066295d.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*CSnnNOzWPE0AU6QWZKtYGQ.jpeg"/><div class="fb bw l ou ov fc n aw fd"/></div><div class="hh l fo"><p class="bd b dl z fp fq fr fs ft fu fv fw dk translated"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" href="https://medium.com/@dotcom.software?source=post_page-----509cd867010a--------------------------------" rel="noopener follow" target="_top">。com 软件</a></p></div></div><div class="oy oz gw l"><h2 class="bd ir ui ny fp uj fr fs uk fu fw ip bi translated">编写异常代码</h2></div><div class="ab q"><div class="l fo"><a class="bd b be z bi ul au um un uo qt up an eh ei uq ur us el em eo de bk ep" href="https://medium.com/@dotcom.software/list/writing-exceptional-code-b75471cea909?source=post_page-----509cd867010a--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="ut l fo"><span class="bd b dl z dk">7 stories</span></div></div></div><div class="pl dh pm fp ab pn fo di"><div class="di pd bv pe pf"><div class="dh l"><img alt="" class="dh" src="../Images/0f6a44e151e01241892fe88fed01e358.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*Z2jAWH_00Wle1kppjsBgeA.png"/></div></div><div class="di pd bv pg ph pi"><div class="dh l"><img alt="" class="dh" src="../Images/c5d74809eb34bc1c6ef81a45887d7ba0.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*FDwxVMSy8fX5t3Gl2gXR5A.jpeg"/></div></div><div class="di bv pj pk pi"><div class="dh l"><img alt="" class="dh" src="../Images/b0d07f4cd028d6e569384bb5eb9e0e8d.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*U32iy8K-gvujvUg1"/></div></div></div></div></div></div></div>    
</body>
</html>