<html>
<head>
<title>ESLint for React Testing Library and why YOU should use it!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React 测试库的 ESLint 和为什么你应该使用它！</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/eslint-for-react-testing-library-and-why-you-should-use-it-822c957318e2?source=collection_archive---------5-----------------------#2022-12-23">https://blog.devgenius.io/eslint-for-react-testing-library-and-why-you-should-use-it-822c957318e2?source=collection_archive---------5-----------------------#2022-12-23</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="cfae" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">React 测试库用于在 React 应用中编写单元测试。React 测试库侧重于可访问性，这意味着我们更像真实用户一样测试功能。</p><p id="200c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要编写优秀的单元测试，需要遵循一些最佳实践。为了确保我们用最佳实践编写单元测试，我们应该使用 ESLint 来帮助我们实现最佳实践。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/55f0f473f25b96964f85eb9d8e80fd4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6Ls_SE0PMNxSsssz"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@helloimnik?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">你好我是尼克</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></figcaption></figure></div><div class="ab cl kz la hr lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="ig ih ii ij ik"><h2 id="b67f" class="lg lh in bd li lj lk dn ll lm ln dp lo jv lp lq lr jz ls lt lu kd lv lw lx ly bi translated">埃斯林特</h2><p id="0f21" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">ESLint 静态地分析代码库，以发现问题或没有遵循最佳实践的代码。静态分析的代码库帮助我们使代码库在团队成员之间保持一致。</p><p id="05f0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ESLint 可以配置的一些规则示例:</p><ul class=""><li id="6fa5" class="me mf in jm b jn jo jr js jv mg jz mh kd mi kh mj mk ml mm bi translated">没有影子变量命名。</li><li id="890a" class="me mf in jm b jn mn jr mo jv mp jz mq kd mr kh mj mk ml mm bi translated">没有未使用的变量。</li><li id="4ddb" class="me mf in jm b jn mn jr mo jv mp jz mq kd mr kh mj mk ml mm bi translated">在定义变量和方法之前没有用。</li><li id="36d8" class="me mf in jm b jn mn jr mo jv mp jz mq kd mr kh mj mk ml mm bi translated">React 组件中没有无用的碎片。</li><li id="7071" class="me mf in jm b jn mn jr mo jv mp jz mq kd mr kh mj mk ml mm bi translated">React 组件内没有道具传播。</li><li id="3522" class="me mf in jm b jn mn jr mo jv mp jz mq kd mr kh mj mk ml mm bi translated">在 TypeScript 中没有使用任何类型。</li><li id="531b" class="me mf in jm b jn mn jr mo jv mp jz mq kd mr kh mj mk ml mm bi translated">在 TypeScript 中强制返回类型。</li></ul><p id="a923" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">上面的列表只是数百个可配置规则中的几个。将 eslint 与规则结合使用的好处是确保团队中的所有开发人员都遵循相同的模式。这样做的结果是一个一致的代码库，更易于维护和接纳新的团队成员。</p><p id="4c0d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我不打算在本文中详细解释 ESLint。请在 https://eslint.org/docs/latest<a class="ae ky" href="https://eslint.org/docs/latest/" rel="noopener ugc nofollow" target="_blank"/>的文档中阅读更多关于 ESLint 的信息。</p><h1 id="7337" class="ms lh in bd li mt mu mv ll mw mx my lo mz na nb lr nc nd ne lu nf ng nh lx ni bi translated">React 测试库的 ESLint</h1><p id="8105" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">ESLint 有一个测试库插件，可以帮助开发人员遵循最佳实践并预测编写单元测试时的常见错误。</p><p id="bdbf" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"><em class="nj">est lint-plugin-testing-library</em></strong><em class="nj"/>包括以下内容。</p><ul class=""><li id="dcf7" class="me mf in jm b jn jo jr js jv mg jz mh kd mi kh mj mk ml mm bi translated">林挺测试库特定代码的若干规则。</li><li id="587f" class="me mf in jm b jn mn jr mo jv mp jz mq kd mr kh mj mk ml mm bi translated">推荐规则的可共享配置。</li><li id="93ff" class="me mf in jm b jn mn jr mo jv mp jz mq kd mr kh mj mk ml mm bi translated">通过框架 Angular、React 和 Vue 共享特定规则的配置。</li><li id="1b64" class="me mf in jm b jn mn jr mo jv mp jz mq kd mr kh mj mk ml mm bi translated">一些可自动修复的规则。</li></ul><h2 id="80b7" class="lg lh in bd li lj lk dn ll lm ln dp lo jv lp lq lr jz ls lt lu kd lv lw lx ly bi translated">React 测试库的推荐配置</h2><p id="bc1f" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">Testing Library eslint-plugin 导出了几个可共享的配置来实施最佳实践。每个可共享的配置都属于一个框架。在本文中，我们将研究<strong class="jm io"> <em class="nj">插件:testing-library/react。</em>T15】</strong></p><p id="c714" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们看看从插件:testing-library/react 导出的 React-Testing-Library 的 19 条推荐规则中的 7 条。</p><h2 id="623c" class="lg lh in bd li lj lk dn ll lm ln dp lo jv lp lq lr jz ls lt lu kd lv lw lx ly bi translated"><strong class="ak"> 1。测试库/等待异步查询</strong></h2><p id="9766" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">该规则确保开发人员正确处理异步查询的承诺。请看下面的例子:</p><pre class="kj kk kl km gt nk nl nm bn nn no bi"><span id="9c2c" class="np lh in nl b be nq nr l ns nt">// async query without handling the promise.<br/>test('should display button with text-value "Save"', () =&gt; {<br/>  const button = findByRole('button');<br/>  expect(button).toHaveTextContent("Save");<br/>})<br/><br/>// use the await operator to handle the promise<br/>test('should display button with text-value "Save"', async() =&gt; {<br/>  const button = await findByRole('button');<br/>  expect(button).toHaveTextContent("Save");<br/>})</span></pre><p id="7460" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">请随意在文档中阅读有关该规则的更多信息，<a class="ae ky" href="https://github.com/testing-library/eslint-plugin-testing-library/blob/main/docs/rules/await-async-query.md" rel="noopener ugc nofollow" target="_blank">https://github . com/testing-library/eslint-plugin-testing-library/blob/main/docs/rules/await-async-query . MD</a></p><h2 id="a59b" class="lg lh in bd li lj lk dn ll lm ln dp lo jv lp lq lr jz ls lt lu kd lv lw lx ly bi translated"><strong class="ak"> 2。测试库/等待异步实用程序</strong></h2><p id="4a28" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">该规则确保 utils 返回的承诺得到正确处理。测试库提供了多个 utils 方法，如 waitFor 和 waitForElementToBeRemoved。</p><pre class="kj kk kl km gt nk nl nm bn nn no bi"><span id="c706" class="np lh in nl b be nq nr l ns nt">// incorrect because we are not handling the promise return by waitFor<br/>waitFor(() =&gt; getByLabelText('First name'));<br/><br/>// use the await operator to handle the promise correctly<br/>await waitFor(() =&gt; getByLabelText('First name'));</span></pre><p id="02dc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">请随意阅读更多关于规则的文档，<a class="ae ky" href="https://github.com/testing-library/eslint-plugin-testing-library/blob/main/docs/rules/await-async-utils.md" rel="noopener ugc nofollow" target="_blank">https://github . com/testing-library/eslint-plugin-testing-library/blob/main/docs/rules/await-async-utils . MD</a></p><h2 id="0fca" class="lg lh in bd li lj lk dn ll lm ln dp lo jv lp lq lr jz ls lt lu kd lv lw lx ly bi translated"><strong class="ak"> 3。测试库/无等待同步查询</strong></h2><p id="c1cc" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">该规则确保 await 操作符不会等待同步查询。像 getBy*、getByAll*、queryBy*和 queryAllBy*这样的方法是同步的，不需要 await 操作符。</p><pre class="kj kk kl km gt nk nl nm bn nn no bi"><span id="35a8" class="np lh in nl b be nq nr l ns nt">// incorrect because we are using await on synchronous methods.<br/>const firstNameInput = await getByLabelText('First name');<br/><br/>// correct because we are not using await on synchronous methods.<br/>const firstNameInput = getByLabelText('First name');</span></pre><p id="90c4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">可能会混淆哪些方法是同步的，哪些是异步的，因此这条规则将非常有助于避免错误。</p><p id="06e1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">请随意在文档中阅读关于该规则的更多信息，<a class="ae ky" href="https://github.com/testing-library/eslint-plugin-testing-library/blob/main/docs/rules/no-await-sync-query.md" rel="noopener ugc nofollow" target="_blank">https://github . com/testing-library/eslint-plugin-testing-library/blob/main/docs/rules/no-await-sync-query . MD</a></p><h2 id="bf1e" class="lg lh in bd li lj lk dn ll lm ln dp lo jv lp lq lr jz ls lt lu kd lv lw lx ly bi translated"><strong class="ak"> 4。测试库/无容器</strong></h2><p id="8955" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">该规则确保避免使用容器，因为真实用户可能无法访问您正在查询的元素。通过使用容器，我们能够通过 CSS 类查询 DOM 元素，这样做破坏了可访问性测试。CSS 类名更改时，单元测试可能会更频繁地中断。</p><pre class="kj kk kl km gt nk nl nm bn nn no bi"><span id="3697" class="np lh in nl b be nq nr l ns nt">// Using contianer is incorrect<br/>const page = render(&lt;MyPage/&gt;);<br/>const button = page.container.getElementByClassName('primary-button');<br/><br/>// Correct<br/>render(&lt;MyPage/&gt;);<br/>const button = screen.getByRole('button', { name: 'Save' }); </span></pre><p id="beaa" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">请随意在文档中阅读有关该规则的更多信息，<a class="ae ky" href="https://github.com/testing-library/eslint-plugin-testing-library/blob/main/docs/rules/no-container.md" rel="noopener ugc nofollow" target="_blank">https://github . com/testing-library/eslint-plugin-testing-library/blob/main/docs/rules/no-container . MD</a></p><h2 id="e1fa" class="lg lh in bd li lj lk dn ll lm ln dp lo jv lp lq lr jz ls lt lu kd lv lw lx ly bi translated"><strong class="ak"> 5。测试库/无调试工具</strong></h2><p id="7f68" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">该规则确保不提交调试实用程序。调试工具只是用于调试测试，因此不应该被推送到代码库中。调试工具会污染测试输出。</p><pre class="kj kk kl km gt nk nl nm bn nn no bi"><span id="6cd2" class="np lh in nl b be nq nr l ns nt">// Codeexample for debugging<br/>const { debug } = render(&lt;MyPage /&gt;);<br/>debug();</span></pre><p id="320b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">请随意在文档中阅读关于该规则的更多信息，<a class="ae ky" href="https://github.com/testing-library/eslint-plugin-testing-library/blob/main/docs/rules/no-debugging-utils.md" rel="noopener ugc nofollow" target="_blank">https://github . com/testing-library/eslint-plugin-testing-library/blob/main/docs/rules/no-debugging-utils . MD</a></p><h2 id="b599" class="lg lh in bd li lj lk dn ll lm ln dp lo jv lp lq lr jz ls lt lu kd lv lw lx ly bi translated"><strong class="ak"> 6。testing-library/no-DOM-import</strong></h2><p id="8c1c" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">确保没有来自<code class="fe nu nv nw nl b">@testing-library/dom</code>或<code class="fe nu nv nw nl b">dom-testing-library.</code>的直接进口，进口应为<code class="fe nu nv nw nl b">@testing-library/react</code>。</p><pre class="kj kk kl km gt nk nl nm bn nn no bi"><span id="2bb3" class="np lh in nl b be nq nr l ns nt">// Incorrect<br/>import { fireEvent } from 'dom-testing-library';<br/><br/>// Correct<br/>import { fireEvent } from 'testing-library/react';</span></pre><p id="6590" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">请随意在文档中阅读有关该规则的更多信息，<a class="ae ky" href="https://github.com/testing-library/eslint-plugin-testing-library/blob/main/docs/rules/no-dom-import.md" rel="noopener ugc nofollow" target="_blank">https://github . com/testing-library/eslint-plugin-testing-library/blob/main/docs/rules/no-DOM-import . MD</a></p><h2 id="91db" class="lg lh in bd li lj lk dn ll lm ln dp lo jv lp lq lr jz ls lt lu kd lv lw lx ly bi translated"><strong class="ak"> 7。测试库/无节点访问</strong></h2><p id="714f" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">此规则确保不允许使用本机 HTML 方法和属性(如 parentElement、children、lastChild 和 HTML 树中节点元素的所有其他属性)遍历 DOM。</p><pre class="kj kk kl km gt nk nl nm bn nn no bi"><span id="e80c" class="np lh in nl b be nq nr l ns nt">// Incorrect because the test is acccessing .lastChild which is a node elment.<br/>const buttons = screen.getAllByRole('button');<br/>expect(buttons.lastChild).toBeInTheDocument();</span></pre><p id="5d32" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">请随意在文档中阅读关于规则的更多信息，<a class="ae ky" href="https://github.com/testing-library/eslint-plugin-testing-library/blob/main/docs/rules/no-node-access.md" rel="noopener ugc nofollow" target="_blank">https://github . com/testing-library/eslint-plugin-testing-library/blob/main/docs/rules/no-node-access . MD</a></p><h2 id="92bb" class="lg lh in bd li lj lk dn ll lm ln dp lo jv lp lq lr jz ls lt lu kd lv lw lx ly bi translated">所有推荐的规则</h2><p id="1775" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">要查看为 testing-library/react 导出的所有 19 个规则，请访问源代码，<a class="ae ky" href="https://github.com/testing-library/eslint-plugin-testing-library/blob/main/lib/configs/react.ts" rel="noopener ugc nofollow" target="_blank">https://github . com/testing-library/eslint-plugin-testing-library/blob/main/lib/configs/react . ts</a></p><h2 id="239c" class="lg lh in bd li lj lk dn ll lm ln dp lo jv lp lq lr jz ls lt lu kd lv lw lx ly bi translated">结论</h2><p id="95ff" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">应该在所有团队中使用 ESLint 测试库，以确保单元测试遵循最佳实践，并避免错误导致不可靠的测试。通过使用 ESLint，团队可以确保代码库语法和模式在开发人员之间保持一致。结果是可靠的测试和可维护的代码库。</p><p id="b4df" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">请随意鼓掌、分享或评论！:)</p></div></div>    
</body>
</html>