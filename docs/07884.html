<html>
<head>
<title>Cache, Cookies and Web Storage in a Nutshell</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">简而言之，缓存、Cookies 和网络存储</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/cache-cookies-and-web-storage-in-a-nutshell-11f9dc02bacc?source=collection_archive---------3-----------------------#2022-04-30">https://blog.devgenius.io/cache-cookies-and-web-storage-in-a-nutshell-11f9dc02bacc?source=collection_archive---------3-----------------------#2022-04-30</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="35ea" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">在<a class="ae kc" href="https://yumingchang1991.medium.com/technical-article-structure-on-medium-954850e1ef4d" rel="noopener">我的技术文章</a>中查看我所有的其他帖子</h2></div><p id="932f" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">好了，是时候回顾一些必须知道的 web 术语了:缓存、cookies、本地存储和会话存储。</p><h2 id="f9e8" class="kz la in bd lb lc ld dn le lf lg dp lh km li lj lk kq ll lm ln ku lo lp lq lr bi translated">隐藏物</h2><p id="33b1" class="pw-post-body-paragraph kd ke in kf b kg ls jo ki kj lt jr kl km lu ko kp kq lv ks kt ku lw kw kx ky ig bi translated">缓存用于存储 web 资源，以便用户下次再次访问同一个站点时，可以更快地完成加载。</p><p id="465a" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">就网络资源而言，它可以是 HTML 文件、JavaScript 文件、网站中使用的照片、背景中播放的音频或品牌视频/动画等。</p><p id="819f" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">如果有客户端缓存，来自客户端的 HTTP 请求会带来一条消息，告诉服务器该用户可以随时访问特定的资源。因此，服务器不必再次发送该资源。</p><p id="f02d" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">换句话说，缓存不仅通过加快加载速度改善了用户体验，还降低了服务器负载。</p></div><div class="ab cl lx ly hr lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ig ih ii ij ik"><h2 id="8e45" class="kz la in bd lb lc ld dn le lf lg dp lh km li lj lk kq ll lm ln ku lo lp lq lr bi translated">饼干</h2><p id="1a23" class="pw-post-body-paragraph kd ke in kf b kg ls jo ki kj lt jr kl km lu ko kp kq lv ks kt ku lw kw kx ky ig bi translated">Cookies 只是一小段信息，每次都会随 HTTP 请求一起发送。它保存在服务器端和客户端，这样服务器可以识别用户当前的浏览会话是否与他们之前的相同。</p><p id="b0bd" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">它的容量是 4 KB，存储用户的信息。通过查看 cookies 中的信息，网站能够识别用户的行为，从而提供更加个性化的内容。例如，cookies 可能包括:</p><ul class=""><li id="70a0" class="me mf in kf b kg kh kj kk km mg kq mh ku mi ky mj mk ml mm bi translated"><strong class="kf io">用户偏好</strong>:浏览语言</li><li id="0e2a" class="me mf in kf b kg mn kj mo km mp kq mq ku mr ky mj mk ml mm bi translated"><strong class="kf io">浏览会话</strong>:让服务器知道这个用户是否登录</li><li id="5ef0" class="me mf in kf b kg mn kj mo km mp kq mq ku mr ky mj mk ml mm bi translated">添加到购物车的商品</li><li id="549e" class="me mf in kf b kg mn kj mo km mp kq mq ku mr ky mj mk ml mm bi translated">访问的页面</li><li id="bd25" class="me mf in kf b kg mn kj mo km mp kq mq ku mr ky mj mk ml mm bi translated">国际电脑互联网地址</li><li id="bb89" class="me mf in kf b kg mn kj mo km mp kq mq ku mr ky mj mk ml mm bi translated">任何可以用来描述用户行为的东西</li></ul><p id="d906" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">Cookies 的过期时间由其创建者控制，通常只有很短的一段时间。</p></div><div class="ab cl lx ly hr lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ig ih ii ij ik"><h1 id="5b7b" class="ms la in bd lb mt mu mv le mw mx my lh jt mz ju lk jw na jx ln jz nb ka lq nc bi translated">网络存储</h1><h2 id="3cb7" class="kz la in bd lb lc ld dn le lf lg dp lh km li lj lk kq ll lm ln ku lo lp lq lr bi translated">局部存储器</h2><p id="e518" class="pw-post-body-paragraph kd ke in kf b kg ls jo ki kj lt jr kl km lu ko kp kq lv ks kt ku lw kw kx ky ig bi translated">本地存储是一种更现代的网页存储空间。根据浏览器的不同，它的容量可以达到 5MB/10MB。</p><p id="83d8" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">存储在本地存储中的信息不会被删除。必须手动删除它们，或者等待 JavaScript 调用<code class="fe nd ne nf ng b">localStorage.clear()</code>或<code class="fe nd ne nf ng b">localStorage.removeItem(<em class="nh">key</em>)</code>。</p><p id="726d" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">但是，存储在本地存储中的数据不会通过 HTTP 请求自动发送到服务器。</p><h2 id="7c90" class="kz la in bd lb lc ld dn le lf lg dp lh km li lj lk kq ll lm ln ku lo lp lq lr bi translated">会话存储</h2><p id="e159" class="pw-post-body-paragraph kd ke in kf b kg ls jo ki kj lt jr kl km lu ko kp kq lv ks kt ku lw kw kx ky ig bi translated">与本地存储不同，会话存储中的信息将在会话结束时被删除，例如关闭浏览器。</p><h2 id="df3e" class="kz la in bd lb lc ld dn le lf lg dp lh km li lj lk kq ll lm ln ku lo lp lq lr bi translated">检查浏览器兼容性</h2><p id="682a" class="pw-post-body-paragraph kd ke in kf b kg ls jo ki kj lt jr kl km lu ko kp kq lv ks kt ku lw kw kx ky ig bi translated">由于 web 存储相对较新，所以在实际使用之前检查它的兼容性是一个好习惯。</p><pre class="ni nj nk nl gt nm ng nn no aw np bi"><span id="e23e" class="kz la in ng b gy nq nr l ns nt"><strong class="ng io">if (typeof(Storage) !== 'undefined')</strong> {<br/>  // do something with web storage</span><span id="0746" class="kz la in ng b gy nu nr l ns nt"><strong class="ng io">} else {</strong><br/>  // do something to let user know their browser does not support web storage</span><span id="208e" class="kz la in ng b gy nu nr l ns nt"><strong class="ng io">}</strong>  </span></pre></div><div class="ab cl lx ly hr lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ig ih ii ij ik"><h2 id="41e4" class="kz la in bd lb lc ld dn le lf lg dp lh km li lj lk kq ll lm ln ku lo lp lq lr bi translated">本地存储、会话存储和 Cookies 之间的区别</h2><figure class="ni nj nk nl gt nw gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi nv"><img src="../Images/17bfc236053b7a2bdebd457150f7a9eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1_EkcfM2Jrejwapm_luVnA.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk translated">该表由 Geeksforgeeks 创建并拥有</figcaption></figure><figure class="ni nj nk nl gt nw gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi oh"><img src="../Images/5a1668280f5229a85a990cdf0d1cdfca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NsU51me-dYGw1HEMt6wcDg.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk translated">该表由 Geeksforgeek 创建并拥有</figcaption></figure></div><div class="ab cl lx ly hr lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ig ih ii ij ik"><h1 id="581e" class="ms la in bd lb mt mu mv le mw mx my lh jt mz ju lk jw na jx ln jz nb ka lq nc bi translated">决定何时使用哪个的简单方法</h1><p id="7c72" class="pw-post-body-paragraph kd ke in kf b kg ls jo ki kj lt jr kl km lu ko kp kq lv ks kt ku lw kw kx ky ig bi translated">缓存存储资源，因此当您希望通过将资源推送到客户端存储来改善用户体验时，请使用缓存。</p><p id="1548" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">另一方面，Cookies 和网络存储是用来存储数据的。</p><ul class=""><li id="704e" class="me mf in kf b kg kh kj kk km mg kq mh ku mi ky mj mk ml mm bi translated">如果数据需要发送到服务器，使用 cookie<strong class="kf io"/></li><li id="15a7" class="me mf in kf b kg mn kj mo km mp kq mq ku mr ky mj mk ml mm bi translated">使用网络存储，<strong class="kf io">如果服务器不需要知道存储的数据</strong></li></ul></div><div class="ab cl lx ly hr lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ig ih ii ij ik"><h1 id="69c9" class="ms la in bd lb mt mu mv le mw mx my lh jt mz ju lk jw na jx ln jz nb ka lq nc bi translated">快速浏览如何操作每一个</h1><h2 id="0bf0" class="kz la in bd lb lc ld dn le lf lg dp lh km li lj lk kq ll lm ln ku lo lp lq lr bi translated">操纵现代网络存储</h2><p id="2a50" class="pw-post-body-paragraph kd ke in kf b kg ls jo ki kj lt jr kl km lu ko kp kq lv ks kt ku lw kw kx ky ig bi translated">网络存储更加现代化；因此，它有很好的界面供我们使用。我们可以只调用<code class="fe nd ne nf ng b">localStorage</code>或<code class="fe nd ne nf ng b">sessionStorage</code>，然后访问我们想要使用的方法:</p><ul class=""><li id="42fe" class="me mf in kf b kg kh kj kk km mg kq mh ku mi ky mj mk ml mm bi translated"><code class="fe nd ne nf ng b">.setItem(key, valiue)</code></li><li id="1d89" class="me mf in kf b kg mn kj mo km mp kq mq ku mr ky mj mk ml mm bi translated"><code class="fe nd ne nf ng b">.getItem(key)</code></li><li id="9dd9" class="me mf in kf b kg mn kj mo km mp kq mq ku mr ky mj mk ml mm bi translated"><code class="fe nd ne nf ng b">.removeItem(key)</code></li><li id="566d" class="me mf in kf b kg mn kj mo km mp kq mq ku mr ky mj mk ml mm bi translated"><code class="fe nd ne nf ng b">.clear()</code>:这将删除网络存储器中的所有项目</li></ul><p id="561e" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated"><strong class="kf io">注意</strong> : web 存储只保存在客户端；因此，我们不能从 NodeJS 访问本地存储。</p><p id="7071" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">如果我们需要在前端和后端之间传递数据，请发送 JSON 或使用 cookies。(参见<a class="ae kc" href="https://stackoverflow.com/questions/37182573/saving-into-localstorage-with-nodejs" rel="noopener ugc nofollow" target="_blank">堆栈溢出的公认答案</a></p><h2 id="7f20" class="kz la in bd lb lc ld dn le lf lg dp lh km li lj lk kq ll lm ln ku lo lp lq lr bi translated">操纵 cookies</h2><p id="2667" class="pw-post-body-paragraph kd ke in kf b kg ls jo ki kj lt jr kl km lu ko kp kq lv ks kt ku lw kw kx ky ig bi translated">对于 cookies 来说，就很难处理了。好消息是我们大部分时间不需要使用 cookies。</p><p id="bb28" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated"><strong class="kf io">客户端脚本</strong></p><ol class=""><li id="0910" class="me mf in kf b kg kh kj kk km mg kq mh ku mi ky oi mk ml mm bi translated">我们可以从<code class="fe nd ne nf ng b">document.cookies</code>访问 cookies</li><li id="6ac6" class="me mf in kf b kg mn kj mo km mp kq mq ku mr ky oi mk ml mm bi translated">我们在纯字符串中将键-值对直接赋值给<code class="fe nd ne nf ng b">document.cookies</code>，这意味着我们需要解析结果以供进一步分析</li></ol><pre class="ni nj nk nl gt nm ng nn no aw np bi"><span id="a720" class="kz la in ng b gy nq nr l ns nt">document.cookie = 'name=YuMing'<br/>document.cookie = 'lastName=Chang'</span><span id="d65b" class="kz la in ng b gy nu nr l ns nt">console.log(document.cookie)<br/>// it prints out below:<br/>// name=YuMing; lastName=Chang</span></pre><p id="ebda" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated"><strong class="kf io">服务器端脚本(ExpressJS) </strong></p><p id="10bd" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">对于后端开发人员来说，好消息是已经有了 cookie 解析器。</p><p id="ec76" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated"><code class="fe nd ne nf ng b">const cookieParser = require(cookie-parser)</code></p><p id="33c5" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">然后，只需添加 cookieParser 作为所有应用程序可用的资源:</p><p id="4231" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated"><code class="fe nd ne nf ng b">app.use(cookieParser())</code></p><p id="4b7c" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">之后，我们可以很容易地按照我们定义的路线访问 cookies:</p><pre class="ni nj nk nl gt nm ng nn no aw np bi"><span id="0c8d" class="kz la in ng b gy nq nr l ns nt">// to Set cookie<br/><strong class="ng io">res.cookie(key, value)</strong></span><span id="4a14" class="kz la in ng b gy nu nr l ns nt">// to access a key in a cookie<br/><strong class="ng io">res.cookie.</strong><em class="nh">key</em></span><span id="c8bd" class="kz la in ng b gy nu nr l ns nt">// to clear a key in a cookie<br/><strong class="ng io">res.clearCookie(key)</strong></span></pre><p id="b6f1" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">我们在使用 cookies 时需要格外注意；否则，用户可以通过在浏览器控制台中直接键入<code class="fe nd ne nf ng b">document.cookie</code>来访问 cookie 的内容。</p><p id="7c22" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">为了加强安全性，请在设置 cookies 时添加以下属性作为对象</p><pre class="ni nj nk nl gt nm ng nn no aw np bi"><span id="565a" class="kz la in ng b gy nq nr l ns nt">res.cookie(key, value, {<br/>  <strong class="ng io">secure: true,<br/>  httpOnly: true,<br/>  sameSite: 'lax'</strong><br/>}</span></pre><p id="f574" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">查看<a class="ae kc" href="https://expressjs.com/en/5x/api.html#res.cookie" rel="noopener ugc nofollow" target="_blank">快递公文</a>了解更多关于<code class="fe nd ne nf ng b">res.cookie(key, value [, options])</code>的信息</p></div><div class="ab cl lx ly hr lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ig ih ii ij ik"><h2 id="db89" class="kz la in bd lb lc ld dn le lf lg dp lh km li lj lk kq ll lm ln ku lo lp lq lr bi translated">参考</h2><ul class=""><li id="434d" class="me mf in kf b kg ls kj lt km oj kq ok ku ol ky mj mk ml mm bi translated"><strong class="kf io">Youtube</strong>:<a class="ae kc" href="https://www.youtube.com/watch?v=GihQAC1I39Q" rel="noopener ugc nofollow" target="_blank"><em class="nh">JavaScript Cookies vs 本地存储 vs Session </em> </a>由 Web Dev 简化</li><li id="7e1c" class="me mf in kf b kg mn kj mo km mp kq mq ku mr ky mj mk ml mm bi translated"><strong class="kf io">文章</strong> : <a class="ae kc" href="https://www.geeksforgeeks.org/difference-between-local-storage-session-storage-and-cookies/" rel="noopener ugc nofollow" target="_blank"> <em class="nh">本地存储、会话存储和 cookies 的区别</em> </a>由 Geeksforgeek</li><li id="8465" class="me mf in kf b kg mn kj mo km mp kq mq ku mr ky mj mk ml mm bi translated"><strong class="kf io">文章</strong> : <a class="ae kc" href="https://www.geeksforgeeks.org/difference-between-cache-and-cookies/" rel="noopener ugc nofollow" target="_blank"> <em class="nh">缓存与 cookies 的区别</em> </a>由 Geeksforgeek</li><li id="2d2c" class="me mf in kf b kg mn kj mo km mp kq mq ku mr ky mj mk ml mm bi translated"><strong class="kf io">文章</strong>:BYJU 的<a class="ae kc" href="https://byjus.com/gate/difference-between-cache-and-cookies/" rel="noopener ugc nofollow" target="_blank"> <em class="nh">缓存和 cookies 的区别</em> </a></li><li id="dbd6" class="me mf in kf b kg mn kj mo km mp kq mq ku mr ky mj mk ml mm bi translated"><strong class="kf io">文章</strong> : <a class="ae kc" href="https://www.section.io/engineering-education/what-are-cookies-nodejs/" rel="noopener ugc nofollow" target="_blank"> <em class="nh">理解 Cookies 并在 Node.js </em> </a>中实现</li><li id="bafd" class="me mf in kf b kg mn kj mo km mp kq mq ku mr ky mj mk ml mm bi translated"><strong class="kf io">stack overflow</strong>:<a class="ae kc" href="https://stackoverflow.com/questions/37366457/node-js-cookie-parser-not-working" rel="noopener ugc nofollow" target="_blank"><em class="nh">NodeJS cookie 解析器不工作</em> </a> <em class="nh"> </em>作者 Gregory-turtle</li></ul></div></div>    
</body>
</html>