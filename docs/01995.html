<html>
<head>
<title>AutoComplete with Amazon CloudSearch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Amazon CloudSearch 自动完成</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/autocomplete-with-amazon-cloudsearch-8503b606c90d?source=collection_archive---------6-----------------------#2020-07-16">https://blog.devgenius.io/autocomplete-with-amazon-cloudsearch-8503b606c90d?source=collection_archive---------6-----------------------#2020-07-16</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/04169ca469e079a705e0f08d39f3636c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XKYTxRrGbkhKe9wy"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">在<a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae jz" href="https://unsplash.com/@austindistel?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Austin Distel </a>拍摄的照片</figcaption></figure><p id="3adf" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">你好！首先，让我们稍微讨论一下什么是 CloudSearch，然后让我们继续讨论一个示例实现。</p><h2 id="9633" class="ky kz in bd la lb lc dn ld le lf dp lg kl lh li lj kp lk ll lm kt ln lo lp lq bi translated">亚马逊云搜索</h2><p id="1483" class="pw-post-body-paragraph ka kb in kc b kd lr kf kg kh ls kj kk kl lt kn ko kp lu kr ks kt lv kv kw kx ig bi translated">这是一项简单、可扩展、经济高效、高性能的托管服务，是 web 或移动应用中搜索解决方案的首选服务。</p><p id="4d32" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">它的设置和管理相当简单。它与 Amazon Api 网关服务直接集成，这使得它很容易作为端点公开。</p><h2 id="959c" class="ky kz in bd la lb lc dn ld le lf dp lg kl lh li lj kp lk ll lm kt ln lo lp lq bi translated">使用案例</h2><p id="0752" class="pw-post-body-paragraph ka kb in kc b kd lr kf kg kh ls kj kk kl lt kn ko kp lu kr ks kt lv kv kw kx ig bi translated">我们想为 FAQ 建立一个自动完成的功能，根据受欢迎程度来显示它们。为此，我们使用了一个 csv，它有一个 FAQ 列表和一个预定义的流行度。根据用户的选择，我们将提高该问题的受欢迎程度，使其在列表中不断上升。</p><h2 id="56b3" class="ky kz in bd la lb lc dn ld le lf dp lg kl lh li lj kp lk ll lm kt ln lo lp lq bi translated">实施</h2><p id="a7e3" class="pw-post-body-paragraph ka kb in kc b kd lr kf kg kh ls kj kk kl lt kn ko kp lu kr ks kt lv kv kw kx ig bi translated">让我们看看我们的 csv。我有 10 个问题和一个预定义的流行度。</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/a1c9c63d8f6ce4138b38c161412c1b76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/1*0fr0katMqd7zq1mtd6tGug.png"/></div></figure><h2 id="4737" class="ky kz in bd la lb lc dn ld le lf dp lg kl lh li lj kp lk ll lm kt ln lo lp lq bi translated"><strong class="ak">让我们在云搜索上创建我们的域名</strong></h2><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mb"><img src="../Images/69fa789ea9cdb49d5ae81e4bc00f4afa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wedHh9xoCvXTF2rdFbDj7A.png"/></div></div></figure><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mc"><img src="../Images/917d28216aa9f7e65e0f7e6dfc2142eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ds1dFoQbbdNug6lVJOofkA.png"/></div></div></figure><p id="9d67" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我选择了最小的实例类型和最低的复制数量。根据您的需求增加或选择默认值，因为 CloudSearch 会根据数据量和流量自动增加或减少。</p><p id="c8b8" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">选择我们用来分析数据的同一个文件</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div class="gh gi md"><img src="../Images/f5572c380bd3606b7969e0ed225e830f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*uNtvm-KUIkSw2K9pbbyKPA.png"/></div></figure><p id="7930" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">索引字段是自动识别的(如下所示)。它们可以根据需要进行编辑。例如，您可以选择不“返回”搜索结果中的属性字段，或者选择不根据“常见问题”字段对结果进行“排序”，因为我们将根据“受欢迎程度”进行排序。</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi me"><img src="../Images/91e71c3f260a04831d0852fe01d806e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jnVHnXxympQrhyBfkNyqBw.png"/></div></div></figure><p id="8903" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">您可以将访问策略留空，因为我们稍后会添加它们。</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mf"><img src="../Images/507571e029302d23d4415606f18f7200.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*50lsJTHv99swScS--_axeQ.png"/></div></div></figure><p id="8a06" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">确认所有的更改，域将被创建。</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mg"><img src="../Images/522b320795053457bef4d38e6e4add21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1XS4U-zWNNqF18PQv8LZSQ.png"/></div></div></figure><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mh"><img src="../Images/5914b0167c5804ccc5d6c62bdf5c012f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_u3ZnI9gnjnigSCfSxF2mQ.png"/></div></div></figure><p id="5ebb" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">状态将保持“正在加载”一段时间。这通常也会随着未来的所有变化而发生。</p><p id="fc9b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">创建完成后，继续上传您的文档</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mi"><img src="../Images/8af90e8fa78933006b6f9a50c3274353.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D60G1S-HAlsRB3UWulU0NA.png"/></div></div></figure><p id="f609" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在上传文档时，您可以下载批处理生成的文件来查看正在上传的 json。</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/d2c279bf63c2eb630fbe305be7fee597.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*W0fTW_mJZ79RFOefgklJPg.png"/></div></figure><p id="e744" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">您会注意到，仪表板上可搜索文档的数量现在增加到了 9 个</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/21d5775329ce61c873c43348a5726e16.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*KtpJhDOFULOOjZNVJVxYeQ.png"/></div></figure><p id="61a7" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">运行样本搜索:</strong></p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ml"><img src="../Images/1b7ade897ae74ff4de79dfd9d7127dfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LJ3FpVcAYSy5fac04p5PAA.png"/></div></div></figure><p id="8dc7" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">你会注意到很多事情。<br/> 1。每个文档(条目)都有一个定义的分数。分数根据查询(部分或完整)和条目的查询数量而变化。这是由 CloudSearch 内部定义的</p><p id="2b1a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">2.您可以根据受欢迎程度进行筛选(在右侧)</p><p id="a707" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">3.默认排序基于该分数，并且是降序。</p><p id="c1b1" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">然而，这是一个简单的查询。我们也可以做<strong class="kc io"> </strong>一个<strong class="kc io">‘结构化</strong>’查询。让我们现在试试。使用' matchall '返回所有文档</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mm"><img src="../Images/cccecfb49d855695ba09440f27ca2ae5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CW-Bgfh2guHI9QmW5b-_3g.png"/></div></div></figure><p id="2c9a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">基于不同的查询解析器，这里有很多运行搜索查询的选项。</p><p id="61f9" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">您的云搜索服务现已准备就绪。让我们继续创建其他组件</p><h2 id="1367" class="ky kz in bd la lb lc dn ld le lf dp lg kl lh li lj kp lk ll lm kt ln lo lp lq bi translated">创建 Api 网关集成来公开您的搜索端点</h2><p id="7b9c" class="pw-post-body-paragraph ka kb in kc b kd lr kf kg kh ls kj kk kl lt kn ko kp lu kr ks kt lv kv kw kx ig bi translated">如果你需要更多关于 Api Gateway 的信息，请查看这篇 文章。</p><p id="35f0" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在创建 api 之前，创建一个角色来提供对 Api 网关服务的访问，以访问 CloudSearch</p><p id="9a23" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">转到 IAM 仪表板</strong>，使用下图创建一个新角色。</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mn"><img src="../Images/5405903bcbc2400e717520f5ae19356e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mB7p1IJhRFF9HWHzHsjo_w.png"/></div></div></figure><p id="e32d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在示例中选择 API Gateway</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mo"><img src="../Images/f7538c09330746426151e5784293ab5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RsxW-M4eVR01HLZUCmmCqw.png"/></div></div></figure><p id="3b41" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在随后的“策略”和“标记”屏幕中，使用默认值创建一个角色。然后提供角色名称并创建角色</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mp"><img src="../Images/3e959f51ab9c18ec4a8e7ac2c3531da0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cEDtsguYEJSQRregRCLS4w.png"/></div></div></figure><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mq"><img src="../Images/ba3de24cc89caa1d11f52cdde89b49db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UYlvBWFYRHSh-oXsUnVlJA.png"/></div></div></figure><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mr"><img src="../Images/8952158e653f9ef2724384db992ed513.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XeV8h-T5ZfAh_ZKAkAYeXA.png"/></div></div></figure><p id="48f1" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在，您已经有了一个可以在 api gateway 中使用的角色，请将它添加到 CloudSearch 的“访问策略”部分，以便您的 api 可以访问“搜索”和“建议”选项。</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/1379cd4eae27ec5f862894581e648e6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ny0I0KKAJqL6RN29XeXM8Q.png"/></div></div></figure><p id="0243" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这需要一些时间。等待策略部分从“正在处理”变为“活动”</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/919850fe8e049a117e45c311bf7b5cb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:822/format:webp/1*hym82T8rMlqUpdrIdEynCQ.png"/></div></figure><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/a3b829322829ab449c1b0aeabe8b2eb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:732/format:webp/1*a0y_eSmXGD8T4MQPNIGSHw.png"/></div></figure><p id="ee1c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">让我们从 api 网关创建开始</strong></p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mv"><img src="../Images/1e5c7bddcb5163dd00545ebe921d0f8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rGx1Uh96BIbRdQpDwxIXqw.png"/></div></div></figure><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mw"><img src="../Images/fc59a5f074ee1b1314d5a6e3e06d86f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CJIz5Xv-hsjx9K2S-ls30A.png"/></div></div></figure><p id="1076" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">创建名为/getfaqs 的资源并启用 CORS。我们需要它来从我们的 webapp 访问 api。</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mx"><img src="../Images/e68509c70f503c1f0a9f67697e5c4fcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rlFp2zUYfaOOI7V-LOBV8g.png"/></div></div></figure><p id="908e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">使用以下配置在资源内创建一个 get 方法</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi my"><img src="../Images/ad326ed89da936b37bc6fc695e411a10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*efHli0wloebh9LPH8cJJOA.png"/></div></div></figure><p id="1238" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在，在将 api 部署到一个阶段之前，我们将对其进行一些更改。<br/>我们将更改“方法请求”和“集成请求”部分。</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mz"><img src="../Images/10f52389b9c5ccd8aa01d108efd7b3d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vAnOYYN7-OkHAGB2W2eW-g.png"/></div></div></figure><p id="aa32" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在方法请求部分，添加这些查询参数并更改“请求验证器”</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi na"><img src="../Images/1b21b7a4530c10d44ccab2e69c7b8598.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KlOhXTquc74mf1qT5siR1g.png"/></div></div></figure><p id="ea68" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在“集成请求”部分，添加以下参数和值</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nb"><img src="../Images/ee3b94cb3761620502b3c356c31af68a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dftfvzb2lYXk0-QPOb6kOw.png"/></div></div></figure><p id="c666" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">继续并部署 api</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/09b517be9a6db416f7836329f57dd111.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*SPEZgsHdupz3WAa_R9WXVw.png"/></div></figure><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nd"><img src="../Images/5a36369ca3d280fe4aff2adc4651b130.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8xsJAgV1Ne5brvNbpoalPw.png"/></div></div></figure><p id="7cdb" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在，使用下面的 curl 测试您的 api。你会看到你所有的结果。</p><p id="286b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io"><em class="ne">curl—location—request GET ' https://{ unique-id }。execute-api.us-east-1.amazonaws.com/dev/getfaqs?q = match all&amp;q . parser = structured&amp;size = 10 '</em></strong></p><h2 id="3f25" class="ky kz in bd la lb lc dn ld le lf dp lg kl lh li lj kp lk ll lm kt ln lo lp lq bi translated">Lambda 来更新 FAQ 被选中时的流行度。</h2><p id="970f" class="pw-post-body-paragraph ka kb in kc b kd lr kf kg kh ls kj kk kl lt kn ko kp lu kr ks kt lv kv kw kx ig bi translated">让我们用 Python 3.8 创建一个 lambda。转到“权限”选项卡，打开与 lambda 关联的角色</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nf"><img src="../Images/df352ffb05719ad7be69b682ce419f2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*twVr3mXF3alB-vct__qXXw.png"/></div></div></figure><blockquote class="ng nh ni"><p id="c44e" class="ka kb ne kc b kd ke kf kg kh ki kj kk nj km kn ko nk kq kr ks nl ku kv kw kx ig bi translated"><em class="in">获取λ的代码</em> <a class="ae jz" href="https://github.com/rohitsharma23/cloudsearch-lambda-function" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io">此处</strong> </a> <strong class="kc io">。</strong>代码搜索特定的文档，然后将其流行度更新 1。</p></blockquote><p id="57c7" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">复制这个角色的 arn，<strong class="kc io">在 CloudSearch </strong>仪表板中添加权限，这样我们就可以在 CloudSearch 中搜索和更新文档。更新文档的参数是“cloudsearch:document”</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nm"><img src="../Images/ea898ae0e3e50a8a2de4899fee882e7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9TVFjEq8zOIrVNi1McRomQ.png"/></div></div></figure><p id="40c6" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在让我们继续为您的 lambda 创建一个 api 网关端点。创建一个 POST 方法/updatepopularity 并将其连接到您的 lambda，如下所示。记得在你的 api 上启用 CORS。当您第一次创建它时或以后从“操作”中创建它。</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nn"><img src="../Images/1a31a2de7bdf083c89e387e064751d73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hfYDWr2ZfIVxHWGdnUwMmw.png"/></div></div></figure><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi no"><img src="../Images/d263ea3c98c1e86760ced996b8890fdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pwH0SWnKF9lAJx8uG86gUg.png"/></div></div></figure><p id="876b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">继续部署 api。使用下面的卷曲来测试它。</p><p id="0d82" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">curl-location-request POST ' https://{ unique-id }。execute-api.us-east-1.amazonaws.com/dev/updatepopularity' \</strong></p><p id="25ed" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">—header ' Content-Type:application/JSON ' \</strong></p><p id="01f6" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">—data-raw“{ FAQ”:“我的订单在哪里？" }' </strong></p><p id="be29" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果你在 CloudSearch 仪表板上搜索 faq，你会看到受欢迎程度增加了一个。</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi np"><img src="../Images/0681c2016d57733a52e9d101f5d24598.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AT5pvHGn_QAH3rfzXvVOOQ.png"/></div></div></figure><h1 id="3665" class="nq kz in bd la nr ns nt ld nu nv nw lg nx ny nz lj oa ob oc lm od oe of lp og bi translated">前端组件</h1><blockquote class="ng nh ni"><p id="58ff" class="ka kb ne kc b kd ke kf kg kh ki kj kk nj km kn ko nk kq kr ks nl ku kv kw kx ig bi translated">你可以在这里找到代码<a class="ae jz" href="https://github.com/rohitsharma23/autocomplete-jquery-node-sample" rel="noopener ugc nofollow" target="_blank"><strong class="kc io"/></a><strong class="kc io"/>。</p></blockquote><p id="8a21" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这是一个简单的节点应用程序，使用 jquery 来迎合下拉菜单及其功能，如过滤，高亮显示等。一旦 FAQ 被选中，它的受欢迎程度会随着对 lambda 的 POST 调用而增加。</p><p id="4194" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们对搜索和更新调用使用不同的端点。</p><p id="7e64" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">当我开始在我的下拉列表中输入时，它显示了一个按受欢迎程度降序排列的列表(请记住，由于我们之前的测试,“我的订单在哪里”目前的受欢迎程度为 2)。对于匹配值，它们按照上传的顺序排列。</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oh"><img src="../Images/f82b4ad555c0eb24935a669deff67625.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2tJtGPitwCE_E1Nib5-beQ.png"/></div></div></figure><p id="6d2e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在，让我们继续选择“什么是退货政策”问题几次(准确地说是 3 次，将其放在顶部)</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oi"><img src="../Images/db1090b1c8c1d666c3c755f5d5971f5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZXxoGFpqeYk0lpbtf3wAXw.png"/></div></div></figure><p id="4523" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这是这样做的结果。这个问题是现在最热门的问题。</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oj"><img src="../Images/1c688e7d4d4e4f128ff55ec7a023f1a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FL3Vgz2M09fTjon-XMHjyw.png"/></div></div></figure><p id="8ab1" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">因此，你已经成功地根据受欢迎程度将你的答案排在了最前面。当你继续输入 I 并突出显示选项(蓝色)时，还有实时过滤功能。如果你的 js 不支持的话，你也可以点击搜索每一个完整的单词来进行实时过滤。你也可以通过这个来提供答案。</strong></p><p id="e740" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">总之，我选择了 CloudSearch api，因为它速度很快，扩展性很强。这是一个非常可靠的搜索服务。</p></div></div>    
</body>
</html>