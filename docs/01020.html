<html>
<head>
<title>How to use EFS with AWS Lambda?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将 EFS 与 AWS Lambda 配合使用？</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-use-efs-with-aws-lambda-a06e85882c4?source=collection_archive---------8-----------------------#2020-06-22">https://blog.devgenius.io/how-to-use-efs-with-aws-lambda-a06e85882c4?source=collection_archive---------8-----------------------#2020-06-22</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div class="gh gi jk"><img src="../Images/1012a32830a25f584d96172ebe00b621.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*5FjfJc1NrNKQ8nNoKWoFHQ.png"/></div></figure><p id="9113" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">AWS 最近推出了一个新功能，让客户制作一个与 Lambda 兼容的 EFS(弹性文件系统)。这真的很酷！但是，为什么是 EFS？</p><p id="b75c" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">EFS 是一个独立存在于机器内部的存储单元。这个文件可以附加到 EC2 等其他服务上，并且可以从多个实例中同时访问。可以从任何连接的实例或 Lambda 访问该存储单元内的文件。</p><p id="3eff" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">为什么我们需要这样的东西来使用 Lambda？额外复杂的步骤？</p><p id="d757" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">实际上，如果你从不同的角度来看，这个特性是很神奇的，让我们从其中的一些开始:</p><p id="c287" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated"><em class="kp"> 1-一致性:</em></p><p id="3bc7" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">如果你需要多个 Lambdas 来使用(读和写)大文件，你会需要它们在一个不延迟函数获取资源的地方，这样导致计算能力和时间更少-&gt;钱更少。</p><p id="b967" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated"><em class="kp"> 2-更多空间:</em></p><p id="f9fa" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">当您处理来自 S3 的文件时，您的最大存储容量为 512 MiB。这在某些情况下是不够的。另外，您可能需要在不同的过程阶段处理这个文件，比如清理、分段、处理和导出这个文件的可读报告/格式。想象一下这个场景中包含的代码量。</p><p id="841e" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated"><em class="kp"> 3-更多空间 2: </em></p><p id="cc8e" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">使用层将在函数之间共享资源，但是层有时不能处理您调用来运行这个函数的资源和二进制文件的大小。使用 EFS 会给你更多的空间来存储这些资源，并在需要时调用。</p><p id="160d" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">我可以列出更多的要点。但是，你明白了。让我们深入了解如何在 lambda 中使用它。</p><h1 id="db88" class="kq kr in bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">创造 EFS:</h1><p id="65d3" class="pw-post-body-paragraph jr js in jt b ju lo jw jx jy lp ka kb kc lq ke kf kg lr ki kj kk ls km kn ko ig bi translated">1-打开 AWS 控制台，搜索“EFS”。</p><figure class="lu lv lw lx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi lt"><img src="../Images/8e190d29df8b4aaedc2a3ad0b219a99f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3BGl3vG-iVneWZ0eRRrGDg.png"/></div></div></figure><p id="082b" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">2-单击“创建文件系统”。</p><p id="7b37" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">3-在步骤 1 中，选择您的 VPC。如果你的 lambda 是在 VPC 内配置的，选择它，如果不是，记住当你选择 VPC 时。</p><figure class="lu lv lw lx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mc"><img src="../Images/ade020d5983fe04ef5432a3ca264a7e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OjlhKAK9bzrpdnEuSFmmaw.png"/></div></div></figure><p id="9062" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">第 4 步，为您的文件系统添加描述性名称。然后单击下一步。</p><figure class="lu lv lw lx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mc"><img src="../Images/fd53b7f37e3b5724ccef5ab665d41d09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7GyzRF8EQNiLE39QU4ZjUA.png"/></div></div></figure><p id="940b" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">5-在步骤 3 中，向下点击“添加接入点”。然后用图像里的东西填充。</p><figure class="lu lv lw lx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi md"><img src="../Images/0b999b4aeb671c4345939b32a8203a71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cp2-0rkqs1vutGowA5ziDg.png"/></div></div></figure><p id="168c" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">6-检查配置，然后单击“创建文件系统”。</p><figure class="lu lv lw lx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi me"><img src="../Images/a9141f2c2f7a6940e31c93e8ec316f03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eQJfZAp7sYZbwRCXuJkAyQ.png"/></div></div></figure><p id="4d56" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">7-搞定！等待几秒钟，您的 EFS 将被激活。</p><figure class="lu lv lw lx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mf"><img src="../Images/fc556e1793617faeb782931596240d4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cp4Yj3rlX6uOWVuqb187jg.png"/></div></div></figure><h1 id="8861" class="kq kr in bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">用 Lambda 连接它:</h1><p id="4530" class="pw-post-body-paragraph jr js in jt b ju lo jw jx jy lp ka kb kc lq ke kf kg lr ki kj kk ls km kn ko ig bi translated">1-点击服务并搜索“Lambda”。</p><figure class="lu lv lw lx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mc"><img src="../Images/c1551b419830a53959ca656ac2348781.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7tOU8Td6siKhJ717QjTByg.png"/></div></div></figure><p id="5cf8" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">2-创建一个新函数，并选择您喜欢的运行时语言。在本文中，我将使用 Python。</p><figure class="lu lv lw lx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mg"><img src="../Images/7c0caef32b35c3c3995b6bbfaaab3ce9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r4nCUb8ZcxrN0U0X94-yaQ.png"/></div></div></figure><p id="0016" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">向下一点，你会看到一个叫做“VPC”的部分，点击“编辑”。</p><figure class="lu lv lw lx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mh"><img src="../Images/fbf6307a41543e50d6ef44cc57fde89d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KkvOTkqAHJjOK19Cy_Se-A.png"/></div></div></figure><p id="53ab" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">4-选择您的 VPC，并选择子网和安全组。然后保存。</p><figure class="lu lv lw lx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mc"><img src="../Images/2c128778f2ba7adc3057d8620e08ddc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mOdkUhNJsrvwULn1CxJYGQ.png"/></div></div></figure><p id="bc2a" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">5-在“VPC”部分，从“文件系统”部分单击“添加文件系统”。</p><figure class="lu lv lw lx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mi"><img src="../Images/7b291327de61022c37498c929a1a503d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KBAXtETas4RRoRsGoRpjbQ.png"/></div></div></figure><p id="c178" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">6-选择我们创建的 EFS 文件系统，记住我们给了它一个描述性的名称。然后选择与接入点相关联的接入点，最后给它一个路径。</p><blockquote class="mj mk ml"><p id="2a96" class="jr js kp jt b ju jv jw jx jy jz ka kb mm kd ke kf mn kh ki kj mo kl km kn ko ig bi translated">注意:该路径需要以“/mnt/”开头。你可以保持原样，或者如果你想有一个自定义文件夹，你可以挑战。</p></blockquote><figure class="lu lv lw lx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mp"><img src="../Images/431d5ac4c775db8fb8f6a63d0ed8fa11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c0_zULoAmqHVT4pnAnUq1Q.png"/></div></div></figure><p id="ab13" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">7-测试文件系统是否附加到函数的一小段代码。</p><figure class="lu lv lw lx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mq"><img src="../Images/75936fb21e5f352ee57583035e57683b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eJ2PQ_mLGpYhxnRc9vUIpg.png"/></div></div></figure><p id="d25a" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">8-答对了！！我们成功了！</p><figure class="lu lv lw lx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mr"><img src="../Images/573090e5f016fd04fe7a51dc8724198d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GCFr7ohO5qKDmk1wUdpCyw.png"/></div></div></figure><h1 id="94f7" class="kq kr in bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">结论:</h1><p id="12a4" class="pw-post-body-paragraph jr js in jt b ju lo jw jx jy lp ka kb kc lq ke kf kg lr ki kj kk ls km kn ko ig bi translated">将 EFS 加入 Lambda 是无服务器架构中一个巨大的新里程碑。你可以有新的用例，这些用例是可行的，而以前完成起来是一场噩梦。简单的步骤和低廉的价格使 Lambda 成为一种选择，可以在一些新的现代用例中与 EC2 竞争。</p></div></div>    
</body>
</html>