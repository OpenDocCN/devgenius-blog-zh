<html>
<head>
<title>Web Scraping with Microsoft Excel</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Microsoft Excel 进行网页抓取</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/web-scraping-with-microsoft-excel-82bebf426a15?source=collection_archive---------7-----------------------#2022-10-15">https://blog.devgenius.io/web-scraping-with-microsoft-excel-82bebf426a15?source=collection_archive---------7-----------------------#2022-10-15</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="74c2" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated"><strong class="ak">提取变换和主【E T L】</strong></h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi kc"><img src="../Images/6d8fa25efcefa30bc2034f05a5334209.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/1*8y-VpYzeWB1JPcc4Mf-B7A.jpeg"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated"><a class="ae ko" href="https://stock.adobe.com/search?k=etl" rel="noopener ugc nofollow" target="_blank">土坯股票图片</a></figcaption></figure><p id="e095" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">让我们面对现实吧，科技领域的许多技术词汇听起来远比实际复杂。也许它有一个“高峰混乱”的缩写。然而，如果你仔细分析这个想法，它非常有意义。</p><p id="fbba" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">其中一个词是 ETL，即提取、转换和加载。你会听到数据工程师和数据库管理员滔滔不绝地吹嘘他们的“ETL 管道”和“ETL 工具”。这听起来像是一个训练有素的数据极客的工作，你不这样认为吗？</p><p id="75e2" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated"><strong class="kr io"> Power Query </strong>由于集成到 Excel 中，它真正有助于 ETL 过程的民主化。</p><h2 id="47bb" class="ll lm in bd ln lo lp dn lq lr ls dp lt ky lu lv lw lc lx ly lz lg ma mb mc md bi translated"><strong class="ak">什么是 ETL？</strong></h2><p id="8306" class="pw-post-body-paragraph kp kq in kr b ks me jo ku kv mf jr kx ky mg la lb lc mh le lf lg mi li lj lk ig bi translated">ETL 是<strong class="kr io"> E </strong> xtract、<strong class="kr io">T</strong>transform、<strong class="kr io"> L </strong> oad 的缩写。我们将以更实际、更有条理的方式对此进行更多的讨论。不过，在此之前，我们先来看看“Power Quary”到底是怎么回事。</p><h2 id="4c51" class="ll lm in bd ln lo lp dn lq lr ls dp lt ky lu lv lw lc lx ly lz lg ma mb mc md bi translated"><strong class="ak">动力广场</strong></h2><p id="44a0" class="pw-post-body-paragraph kp kq in kr b ks me jo ku kv mf jr kx ky mg la lb lc mh le lf lg mi li lj lk ig bi translated">Power Query 是一个数据准备和转换 ETL 引擎，允许您连接到各种数据源。使用 Power Query <strong class="kr io">(在 Excel 中称为 Get &amp;转换)</strong>，您可以导入或连接到外部数据，然后以符合您需求的方式调整数据。例如，您可以删除列、更改数据类型或合并表。然后，您可以将查询加载到 Excel 中以创建图表和报告。</p><p id="105d" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">值得注意的是，Power Query 在 Microsoft Excel、Power BI、Power BI dataflow、Azure data factory wrangling data flow、SQL Server Analysis Services 等中可用。</p><p id="e800" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">在我们讨论过程“ETL”之前，让我给你看一下我们将要抓取的网站。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><a href="https://en.wikipedia.org/wiki/World_Happiness_Report"><div class="gh gi mj"><img src="../Images/b6fa51a6ca2a62d742e2734ee2dd32e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gOPZF1NRUsUf-Gj-UXIkQg.png"/></div></a></figure><p id="230e" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">维基百科上一篇题为“世界幸福报告”的文章您可以点击<a class="ae ko" href="https://en.wikipedia.org/wiki/World_Happiness_Report" rel="noopener ugc nofollow" target="_blank"> <strong class="kr io">这里</strong> </a>查看网站。让我们看看如何为我们的<strong class="kr io"> web 抓取</strong>、<strong class="kr io"> web 采集、</strong>或<strong class="kr io"> web 数据提取探索 power query 的强大功能。</strong></p><h1 id="fb4b" class="mk lm in bd ln ml mm mn lq mo mp mq lt jt mr ju lw jw ms jx lz jz mt ka mc mu bi translated"><strong class="ak">提取转换并加载</strong></h1><h2 id="fa6d" class="ll lm in bd ln lo lp dn lq lr ls dp lt ky lu lv lw lc lx ly lz lg ma mb mc md bi translated">第一步:提取</h2><p id="0cf1" class="pw-post-body-paragraph kp kq in kr b ks me jo ku kv mf jr kx ky mg la lb lc mh le lf lg mi li lj lk ig bi translated">从各种数据源提取数据并导入到 Power Query 中。目前，Power Query 有相当多的连接器，包括简单的平面文件、网页、CSV 或文本文档、数据库等。</p><p id="8e59" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">要使用 power query 来收集维基百科世界幸福报告数据，我们将转到我们的<strong class="kr io">数据选项卡</strong>，然后转到<strong class="kr io">获取数据。</strong></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi mv"><img src="../Images/0faf2dd7d5c5a3de9a1e8b13b5346d29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JPFHH-eGCEAcDgjvKNWqfQ.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">获取数据图像</figcaption></figure><p id="6437" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">单击“获取数据”下拉箭头，让我们将鼠标指针移动到“<strong class="kr io">来自其他来源”</strong>，因为我们有兴趣从 Web“<strong class="kr io">”</strong>获取我们的数据</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi na"><img src="../Images/942ca0a10bbab267f4f1123eb0e1855b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JCgSJ23zj3YPoLl3HFlCRg.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">连接到数据源图像</figcaption></figure><p id="2a2b" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">当我们点击“来自网络”时，会出现一个对话框，让我们从维基百科世界幸福报告文章中复制并粘贴我们的<a class="ae ko" href="https://en.wikipedia.org/wiki/World_Happiness_Report" rel="noopener ugc nofollow" target="_blank"> <strong class="kr io"> URL 链接</strong> </a> <strong class="kr io"> </strong>。如下图所示。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nb"><img src="../Images/85c877bee6fdabc51b2a084a3e6a6910.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k1LKTzHPtTJo-QSTyrfTFg.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">正在连接 URL 网页图像</figcaption></figure><p id="9400" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">嘣，我们准备好获取数据了。有趣的是，Power query Navigator 对话框出现加载链接中的内容，我们可以看到为“<strong class="kr io">表格视图”</strong>和“<strong class="kr io">网络视图”</strong></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nc"><img src="../Images/895a07dcedc46d5b7420b82e5f004260.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SbJESfxGSq2uoGyDkIgMiA.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">表格视图图像</figcaption></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nd"><img src="../Images/98c1790e8de4f630a4462793160f595a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S9_ORoPv2OXqsF3OelFUFA.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">网络视图图像</figcaption></figure><p id="b774" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">此外，检查这些表，发现表 10、12、14、16 和 18 分别包含 2020、2019、2018、2017 和 2016 年的数据。</p><p id="665b" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">下面是 2020 年世界幸福报告表 10 的预览图。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi ne"><img src="../Images/8d2f3067921797cfc8d7e23ac58de66d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vGOexzSoeTUeVoq3vj4wDg.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">2020 年数据预览图</figcaption></figure><p id="8299" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">现在，我们将点击<strong class="kr io">多选</strong>来选择其他年份的数据。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nf"><img src="../Images/4e4aeb1d28df95558c362ea0916effd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XxDVgYJBmob7Ox7NFL7dwg.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">选择多个表格图像</figcaption></figure><p id="af92" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated"><strong class="kr io">点击转换数据开始转换我们的数据。</strong></p><p id="e198" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated"><strong class="kr io">转换数据</strong>按钮引导我们进入<strong class="kr io"> Power Quary 编辑器</strong>。<strong class="kr io">查询编辑器</strong>扮演一个中间数据容器的角色，您可以通过选择行和列、拆分行和列、旋转和取消旋转列等来修改数据。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi mj"><img src="../Images/ce56a74bb6b90e47f909ceeeebbc445b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u6hZQ3YqD3IdR0DhPKFRYw.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">超级查询编辑器图像</figcaption></figure><p id="1d6a" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">注意<strong class="kr io">电源查询编辑器</strong>用户界面。我们的<strong class="kr io">查询</strong>、<strong class="kr io">查询设置</strong>带有“属性”和“应用步骤”，然后我们的数据显示行和列。最重要的是，我们有 File、Home、Transform、Add Column 和 View 选项卡，它们帮助我们转换数据。更重要的是，我们有公式栏。</p></div><div class="ab cl ng nh hr ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ig ih ii ij ik"><h2 id="4ac8" class="ll lm in bd ln lo lp dn lq lr ls dp lt ky lu lv lw lc lx ly lz lg ma mb mc md bi translated"><strong class="ak">第二步:变换</strong></h2><p id="cb24" class="pw-post-body-paragraph kp kq in kr b ks me jo ku kv mf jr kx ky mg la lb lc mh le lf lg mi li lj lk ig bi translated">数据被清理并经过一些转换成为更有用的数据。删除重复项，形成或拆分新列，并进行更多的转换。您可以通过编写 R 或 Python 脚本、M 语言或 Power Query 的 350 多个预建数据转换按钮之一来进行转换。</p><p id="05f1" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated"><strong class="kr io">其中一些转换操作如下。</strong></p><ul class=""><li id="fea8" class="nn no in kr b ks kt kv kw ky np lc nq lg nr lk ns nt nu nv bi translated">检查是否丢失或重复。</li><li id="42ad" class="nn no in kr b ks nw kv nx ky ny lc nz lg oa lk ns nt nu nv bi translated">删除和保留行和列。</li><li id="0cf4" class="nn no in kr b ks nw kv nx ky ny lc nz lg oa lk ns nt nu nv bi translated">拆分列。</li><li id="16fa" class="nn no in kr b ks nw kv nx ky ny lc nz lg oa lk ns nt nu nv bi translated">分组。</li><li id="2227" class="nn no in kr b ks nw kv nx ky ny lc nz lg oa lk ns nt nu nv bi translated">更改数据类型。</li><li id="9827" class="nn no in kr b ks nw kv nx ky ny lc nz lg oa lk ns nt nu nv bi translated">合并和追加查询。</li><li id="c489" class="nn no in kr b ks nw kv nx ky ny lc nz lg oa lk ns nt nu nv bi translated">文本分析。</li><li id="f43f" class="nn no in kr b ks nw kv nx ky ny lc nz lg oa lk ns nt nu nv bi translated">透视和取消透视。</li><li id="5cf6" class="nn no in kr b ks nw kv nx ky ny lc nz lg oa lk ns nt nu nv bi translated">查找并替换。</li><li id="cb9c" class="nn no in kr b ks nw kv nx ky ny lc nz lg oa lk ns nt nu nv bi translated">提取字符。</li><li id="e1e1" class="nn no in kr b ks nw kv nx ky ny lc nz lg oa lk ns nt nu nv bi translated">格式化。</li><li id="c080" class="nn no in kr b ks nw kv nx ky ny lc nz lg oa lk ns nt nu nv bi translated">运行 R 和 Python 脚本。</li><li id="513d" class="nn no in kr b ks nw kv nx ky ny lc nz lg oa lk ns nt nu nv bi translated">验证以确保数据质量。</li><li id="983e" class="nn no in kr b ks nw kv nx ky ny lc nz lg oa lk ns nt nu nv bi translated">创建条件列。</li></ul><p id="dfe1" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">让我们现在开始转换我们的数据。首先，让我们将<strong class="kr io">“查询”</strong>下的表 10、12、14、16 和 18 分别更改或重命名为 2020、2019、2018、2017 和 2016 年。为此，双击表 10 并输入 2020 年。对每个表也进行同样的操作，如下所示。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi ob"><img src="../Images/d5767fde6e4c8e839dda77e73401159e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tslBfArOWDQldJt4GBeS9Q.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">将表格重命名为年份图像</figcaption></figure><p id="2001" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">现在，我们已经重命名了所有的表，如下所示。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi oc"><img src="../Images/d3553b8e1168b5b43f486b38df0c3c91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-L6MSR0ja6c-rgJUuomVPA.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">2016 年至 2020 年数据图像</figcaption></figure><h2 id="28ff" class="ll lm in bd ln lo lp dn lq lr ls dp lt ky lu lv lw lc lx ly lz lg ma mb mc md bi translated"><strong class="ak">探索每年的世界幸福记录</strong></h2><h2 id="e766" class="ll lm in bd ln lo lp dn lq lr ls dp lt ky lu lv lw lc lx ly lz lg ma mb mc md bi translated">【2020 年</h2><p id="c6bf" class="pw-post-body-paragraph kp kq in kr b ks me jo ku kv mf jr kx ky mg la lb lc mh le lf lg mi li lj lk ig bi translated">2020 年世界幸福记录如下图。让我们通过大写和正确书写变量名的拼写来对变量名进行一些转换。为此，只需双击您想要重命名或更改的变量。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi mj"><img src="../Images/167cccf53bfc15fa684ab9560218fda4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LUdTlV0PM6QscyWRENL18g.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">转换 2020 年图像的列名</figcaption></figure><p id="10a1" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">【2020 年有以下变量:</p><p id="81d0" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">“总体排名”、“国家或地区”、“得分”、“人均 GDP”、“社会支持”、“健康预期寿命”、“做出人生选择的自由”、“慷慨程度”、“对腐败的看法”。</p><p id="bcf8" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">【2020 年总共有 9 列 153 行数据。</p><blockquote class="od oe of"><p id="326d" class="kp kq og kr b ks kt jo ku kv kw jr kx oh kz la lb oi ld le lf oj lh li lj lk ig bi translated">根据维基百科，2020 年的报告显示了 2017 年至 2019 年的平均幸福分数。<strong class="kr io">芬兰</strong>是世界上“最幸福”的国家，其次是<strong class="kr io">丹麦、</strong> <strong class="kr io">瑞士、</strong> <strong class="kr io">冰岛、</strong>和<strong class="kr io">挪威。数据来自盖洛普世界民意测验，完全基于调查分数和对民意测验中主要生活评价问题的回答。</strong></p></blockquote></div><div class="ab cl ng nh hr ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ig ih ii ij ik"><h2 id="c616" class="ll lm in bd ln lo lp dn lq lr ls dp lt ky lu lv lw lc lx ly lz lg ma mb mc md bi translated">2019 年</h2><p id="ae86" class="pw-post-body-paragraph kp kq in kr b ks me jo ku kv mf jr kx ky mg la lb lc mh le lf lg mi li lj lk ig bi translated">2019 年如下图所示。让我们重复应用于 2020 数据集的转换步骤。数据集包含以下变量名</p><p id="2e1e" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">“总体排名”、“国家或地区”、“得分”、“人均 GDP”、“社会支持”、“健康预期寿命”、“做出人生选择的自由”、“慷慨程度”、“对腐败的看法”。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi ok"><img src="../Images/f4c7124e35bc7fe8707f7af943e0af7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z-rbXARCXIFwxZsPDt6AnA.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">转换 2019 年图像的列名</figcaption></figure><p id="5ea3" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated"><strong class="kr io">2019 年世界幸福记录包含 9 列 156 行数据。</strong></p><blockquote class="od oe of"><p id="2391" class="kp kq og kr b ks kt jo ku kv kw jr kx oh kz la lb oi ld le lf oj lh li lj lk ig bi translated">然而，根据维基百科，2019 年的报告显示了 2016-2018 年的平均幸福分数。根据 2019 年幸福指数，<strong class="kr io">芬兰</strong>是世界上“最幸福”的国家。丹麦、挪威、冰岛和荷兰位居其后。该报告由联合国于 2019 年 3 月 20 日发布。《世界幸福报告》是一项具有里程碑意义的全球幸福状况调查。</p></blockquote></div><div class="ab cl ng nh hr ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ig ih ii ij ik"><h2 id="72fe" class="ll lm in bd ln lo lp dn lq lr ls dp lt ky lu lv lw lc lx ly lz lg ma mb mc md bi translated"><strong class="ak">2018 年</strong></h2><p id="a142" class="pw-post-body-paragraph kp kq in kr b ks me jo ku kv mf jr kx ky mg la lb lc mh le lf lg mi li lj lk ig bi translated">2018 年也有 9 列 156 行数据。<strong class="kr io">" Perceptions of Corruption "</strong>变量的数据类型从文本更改为十进制，列名也相应更改。因此，这些列现在在数据类型和列布局方面与 2019 年和 2020 年的列相匹配。然而，重要的是要记住 2018 年的因素还包括:</p><p id="58d0" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">“总体排名”、“国家或地区”、“得分”、“人均 GDP”、“社会支持”、“健康预期寿命”、“做出人生选择的自由”、“慷慨程度”、“对腐败的看法”。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi mj"><img src="../Images/a67c00190d0a40397f21591daab877e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Znrip6-uw0B6qwv0PaLs7g.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">转换 2018 年度图像的列名</figcaption></figure><blockquote class="od oe of"><p id="1a65" class="kp kq og kr b ks kt jo ku kv kw jr kx oh kz la lb oi ld le lf oj lh li lj lk ig bi translated">根据维基百科，2018 年的报告显示了 2015 年至 2017 年的平均幸福分数。根据 2018 年幸福指数，<strong class="kr io">芬兰</strong>是世界上“最幸福”的国家。<strong class="kr io">挪威</strong>、<strong class="kr io">丹麦</strong>、<strong class="kr io">冰岛</strong>和<strong class="kr io">瑞士</strong>位居其后。该报告由联合国于 2018 年 3 月 14 日发布。<strong class="kr io">2018 年世界幸福报告</strong>于 3 月 14 日在梵蒂冈教廷科学院的发布会上发布，该报告根据幸福水平对 156 个国家进行了排名，并根据移民幸福程度对 117 个国家进行了排名。</p></blockquote></div><div class="ab cl ng nh hr ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ig ih ii ij ik"><h2 id="c5d8" class="ll lm in bd ln lo lp dn lq lr ls dp lt ky lu lv lw lc lx ly lz lg ma mb mc md bi translated"><strong class="ak">2017 年</strong></h2><p id="aa3a" class="pw-post-body-paragraph kp kq in kr b ks me jo ku kv mf jr kx ky mg la lb lc mh le lf lg mi li lj lk ig bi translated">令人惊讶的是，2017 年在变量命名和排列方面采取了不同的维度。在转换数据集之前，有 12 列和 156 行数据，如下所示。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi mj"><img src="../Images/8f2471bd6dacbaddf679dacdecac03f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W_Y35OOUfiXjchLDgpi5-w.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">转型前 2017 年数据预览</figcaption></figure><p id="3bf9" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">让我们通过改变一些变量的拼写和相应的数据类型来转换数据。2017 年的数据包含以下变量名称</p><p id="f96d" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">"总体排名"、"排名变化"、"国家"、"得分"、"得分变化"、"人均国内生产总值"、"社会支持"、"健康预期寿命"、"做出生活选择的自由"、"慷慨"、"信任"、"剩余"</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi mj"><img src="../Images/700575f631c3b7ea23f992844c5a091c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SVcZEsW5BmClqlKNJDHEQA.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">转型后的 2017 年数据预览</figcaption></figure><blockquote class="od oe of"><p id="b42e" class="kp kq og kr b ks kt jo ku kv kw jr kx oh kz la lb oi ld le lf oj lh li lj lk ig bi translated">更重要的是，根据维基百科，2017 年的报告显示了 2014 年至 2016 年的平均幸福分数。在这段时间里，挪威是世界上总体上“最幸福”的国家，尽管油价已经下跌。<strong class="kr io">丹麦、</strong> <strong class="kr io">冰岛、</strong>和<strong class="kr io">瑞士</strong>紧紧的包在一起。排名前五的国家中有四个遵循<a class="ae ko" href="https://en.wikipedia.org/wiki/Nordic_model" rel="noopener ugc nofollow" target="_blank"> <strong class="kr io">北欧模式</strong> </a>。所有排名前十的国家在这六个方面都得了高分。排名前十的后续国家是:芬兰、荷兰、加拿大、新西兰、澳大利亚和瑞典。</p></blockquote></div><div class="ab cl ng nh hr ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ig ih ii ij ik"><h2 id="109b" class="ll lm in bd ln lo lp dn lq lr ls dp lt ky lu lv lw lc lx ly lz lg ma mb mc md bi translated"><strong class="ak">2016 年</strong></h2><p id="0a5c" class="pw-post-body-paragraph kp kq in kr b ks me jo ku kv mf jr kx ky mg la lb lc mh le lf lg mi li lj lk ig bi translated">要转换 2016 年的数据，首先，我们必须使用第一行作为标题，并且格式化变量名。在此之前，我们先来看看下面截图中的数据预览。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi mj"><img src="../Images/94bbef85b7f2e57c734baffe298a29ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rT08Zrcm_yV38d0nQk0xkg.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">转型前 2016 年数据预览图</figcaption></figure><p id="cd28" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">2016 年的数据包含 10 列 158 行数据。然而，我们发现，像“人均国内生产总值”、“社会支持”、“健康预期寿命”、“做出生活选择的自由”、“慷慨度”和“信任度”等栏目中的一些数据是空的，如下所示。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi mv"><img src="../Images/f024ee35ee8ed26d9f80381cf0891cea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2ej6qszAPnrCHTXJODtJyA.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">带空列图像的 2016 年数据</figcaption></figure><p id="087f" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">重要的是，我们要看看在从网上搜集数据的过程中肯定出了什么问题。</p><p id="4e62" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated"><strong class="kr io">让我们直接从 web 上查看数据，看看数据的结构。</strong></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi ol"><img src="../Images/993a36fbf724ac03f56ca840998dd214.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V8hlZ9ke-BZp2wXqYBDUzA.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">2016 年数据图片网络预览</figcaption></figure><p id="c695" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">从上图中我们可以看到，这些列利用图表对各自的变量进行了评分。因此，Power Quary 无法将它们识别为数据类型。因此，这将返回一个空列。</p><p id="80e5" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">我想我们对此无能为力😃——lol。</p><p id="d385" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">然而，如果我们对数据感兴趣，我们可以找到任何其他平台或网页来收集相同类型的数据。</p><p id="6f68" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated"><strong class="kr io">我们已经走了这么远；该是我们加载数据的时候了。这将自动保存我们对数据所做的更改或转换。</strong></p></div><div class="ab cl ng nh hr ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ig ih ii ij ik"><h2 id="0ef1" class="ll lm in bd ln lo lp dn lq lr ls dp lt ky lu lv lw lc lx ly lz lg ma mb mc md bi translated"><strong class="ak">第三步:加载</strong></h2><p id="0487" class="pw-post-body-paragraph kp kq in kr b ks me jo ku kv mf jr kx ky mg la lb lc mh le lf lg mi li lj lk ig bi translated">在这里，转换后的数据被加载到数据仓库或像 Microsoft Excel 这样的分析工具中。</p><p id="da0a" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">为了加载数据，我们将转到查询编辑器左上角的<strong class="kr io">主页选项卡</strong>下，单击<strong class="kr io">关闭&amp;主页面。</strong></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi mv"><img src="../Images/fea0d996cb47be857d7edb683bc1015e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vRf7z5vr14LS0UmuZUG68w.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">将转换后的数据加载到 MS Excel 电子表格图像中</figcaption></figure><p id="e268" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">如下图，我们的数据和我们各自所有年份的<strong class="kr io">世界幸福报告</strong>数据<strong class="kr io">一起载入 Excel。</strong></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi mj"><img src="../Images/ce92312c38d309afdba9c2de98c3a445.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y77yXYjnLAEci6uztfujLw.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">MS Excel 电子表格中的 2020 年数据预览</figcaption></figure><p id="146c" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">我们的<strong class="kr io">Microsoft Excel【ETL】</strong>Web 抓取项目到此结束。</p><p id="9cf5" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated"><a class="ae ko" href="https://github.com/abbeynet77/Web-Scraping-with-Excel-ETL" rel="noopener ugc nofollow" target="_blank"> <strong class="kr io">点击此处下载</strong> </a>两个<strong class="kr io">中的抓取数据集。xlsx </strong>和<strong class="kr io"> CSV </strong>格式</p><p id="457d" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">关于这个项目，请随时问我任何问题。你的贡献也将受到高度赞赏。</p><p id="892d" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">随着时间的推移，我将使用 R 编程来抓取相同的网页。</p><h1 id="f2ca" class="mk lm in bd ln ml mm mn lq mo mp mq lt jt mr ju lw jw ms jx lz jz mt ka mc mu bi translated">感谢您的阅读！！！</h1></div></div>    
</body>
</html>