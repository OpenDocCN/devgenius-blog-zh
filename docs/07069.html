<html>
<head>
<title>JS Series #12: First-class functions &amp; Higher Order functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JS 系列#12:一级函数和高阶函数</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/js-series-12-first-class-functions-higher-order-functions-b69537d4612?source=collection_archive---------9-----------------------#2022-02-22">https://blog.devgenius.io/js-series-12-first-class-functions-higher-order-functions-b69537d4612?source=collection_archive---------9-----------------------#2022-02-22</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="7b4a" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">现代写作方式的功能</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/8fd8dcce656570269207db0ddc540f0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GlQfcQuYLj_ByciI"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">照片由<a class="ae ks" href="https://unsplash.com/@mjtangonan?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> MJ Tangonan </a>在<a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="3f42" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">到目前为止，我们一直遵循传统的写作风格，如下例所示…</p><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="57a4" class="lx ly in ls b gy lz ma l mb mc">function square(x) {<br/>    return x * x<br/>}</span><span id="a74e" class="lx ly in ls b gy md ma l mb mc">Square(5) // 25</span></pre><p id="22b0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">还有另一种书写或定义<code class="fe lp lq lr ls b">function</code>的方式叫做<code class="fe lp lq lr ls b">function expression</code>。请参见下面的示例…</p><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="db3a" class="lx ly in ls b gy lz ma l mb mc">const square = function(x) {<br/>    return x * x<br/>}</span><span id="1887" class="lx ly in ls b gy md ma l mb mc">// square(5)</span></pre><p id="19d5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在上面的例子中，我们已经移除了<code class="fe lp lq lr ls b">function name</code>并创建了一个<code class="fe lp lq lr ls b">anonymous function</code>，它被分配给一个名为<code class="fe lp lq lr ls b">square</code>的变量。</p><p id="7d0c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在一个变量中，我们可以分配一个<code class="fe lp lq lr ls b">Number</code>、<code class="fe lp lq lr ls b">String</code>、<code class="fe lp lq lr ls b"> array</code>和<code class="fe lp lq lr ls b">objects</code>，但是函数如何分配给一个变量呢？所以答案是，<code class="fe lp lq lr ls b">functions</code>在 JavaScript 中都是<code class="fe lp lq lr ls b">objects</code>。</p><p id="d788" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们看更多的例子来理解<code class="fe lp lq lr ls b">function expression</code> …</p><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="9dc7" class="lx ly in ls b gy lz ma l mb mc">function(a,b) {<br/>    return a + b<br/>}</span></pre><p id="5c39" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在上面的代码片段中，创建了一个没有名字的<code class="fe lp lq lr ls b">function</code>，甚至它也没有在<code class="fe lp lq lr ls b">variable</code>中赋值。所以这种类型的<code class="fe lp lq lr ls b">function</code>被称为<code class="fe lp lq lr ls b">anonymous function</code>。<br/>所以避免创作<code class="fe lp lq lr ls b">anonymous function</code>。</p><p id="db51" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">但是如果将<code class="fe lp lq lr ls b">anonymous function</code>赋给一个变量，它就变成了<code class="fe lp lq lr ls b">function expression</code>，可以像<code class="fe lp lq lr ls b">function</code>一样使用。请参见下面的示例…</p><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="6fcb" class="lx ly in ls b gy lz ma l mb mc">const add = function(a,b) {<br/>    return a + b;<br/>}</span><span id="fb28" class="lx ly in ls b gy md ma l mb mc">add(5,6); // 11</span></pre><p id="ea3c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">但是，如果我们给一个<code class="fe lp lq lr ls b">function</code>命名，同时又给它分配一个<code class="fe lp lq lr ls b">variable</code>会发生什么呢？请参见下面的代码片段…</p><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="b618" class="lx ly in ls b gy lz ma l mb mc">const product = function multiply(a,b) {<br/>    return a * b;<br/>}</span><span id="c53c" class="lx ly in ls b gy md ma l mb mc">product(4,5) // 20<br/>multiply(3,4) // ReferenceError: multiply is not defined</span></pre><p id="b332" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">一旦在<code class="fe lp lq lr ls b">variable</code>中赋值了<code class="fe lp lq lr ls b">function</code>，它就会被<code class="fe lp lq lr ls b">variable</code>引用，而<code class="fe lp lq lr ls b">function name</code>没有任何意义。所以把<code class="fe lp lq lr ls b">function name</code>写在<code class="fe lp lq lr ls b">function expression</code>里是个馊主意。</p></div><div class="ab cl me mf hr mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ig ih ii ij ik"><h1 id="77bb" class="ml ly in bd mm mn mo mp mq mr ms mt mu jt mv ju mw jw mx jx my jz mz ka na nb bi translated">一级功能</h1><p id="b978" class="pw-post-body-paragraph kt ku in kv b kw nc jo ky kz nd jr lb lc ne le lf lg nf li lj lk ng lm ln lo ig bi translated">当一种编程语言中的函数可以被视为类似于<code class="fe lp lq lr ls b">variable</code>时，该编程语言被称为具有<code class="fe lp lq lr ls b">First-class Function</code>。例如，如果一个函数可以存储在一个<code class="fe lp lq lr ls b">variable</code>中，作为一个<code class="fe lp lq lr ls b">argument</code>在一个<code class="fe lp lq lr ls b">function</code>中传递，而作为<code class="fe lp lq lr ls b">returned</code>由另一个<code class="fe lp lq lr ls b">function</code>传递。</p><h2 id="1c92" class="lx ly in bd mm nh ni dn mq nj nk dp mu lc nl nm mw lg nn no my lk np nq na nr bi translated">将函数存储到变量中</h2><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="1c9d" class="lx ly in ls b gy lz ma l mb mc">const add = function(a,b) {<br/>    return a + b;<br/>}</span><span id="da96" class="lx ly in ls b gy md ma l mb mc">const sub = function(a,b) {<br/>    return a - b; <br/>}</span><span id="864e" class="lx ly in ls b gy md ma l mb mc">const mult = function(a,b) {<br/>    return a * b;<br/>}<br/>const divide = function(a,b) {<br/>    return a / b;<br/>}</span></pre><p id="eef8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在上面的例子中，我们创建了 4 个函数，并将它们存储到变量中，如<code class="fe lp lq lr ls b">add</code>、<code class="fe lp lq lr ls b">sub</code>、<code class="fe lp lq lr ls b">mult</code>、<code class="fe lp lq lr ls b">divide</code>。</p><p id="8e59" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">对于更复杂的例子，这些变量可以存储到数组和对象中。</p><h2 id="ddd5" class="lx ly in bd mm nh ni dn mq nj nk dp mu lc nl nm mw lg nn no my lk np nq na nr bi translated">示例|存储在数组中的函数</h2><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="2942" class="lx ly in ls b gy lz ma l mb mc">const ops = [add,sub,mult,divide]</span><span id="db02" class="lx ly in ls b gy md ma l mb mc">for(let i = 0; i &lt; ops.length; i++) {<br/>    console.log(ops[i](20,10));<br/>}</span><span id="76e8" class="lx ly in ls b gy md ma l mb mc"><strong class="ls io">Output:<br/></strong>30<br/>10<br/>200<br/>2</span></pre><h2 id="c9eb" class="lx ly in bd mm nh ni dn mq nj nk dp mu lc nl nm mw lg nn no my lk np nq na nr bi translated">示例|存储在对象中的函数</h2><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="a206" class="lx ly in ls b gy lz ma l mb mc">const obj = {<br/>  add: add,<br/>  sub: sub,<br/>  mult: mult,<br/>  divide: divide<br/>}</span><span id="eec9" class="lx ly in ls b gy md ma l mb mc">obj.add(10,5)<br/>obj.sub(10,5)<br/>obj.mult(10,5)<br/>obj.divide(10,5)</span><span id="b73c" class="lx ly in ls b gy md ma l mb mc"><strong class="ls io">Output:<br/></strong>15<br/>5<br/>50<br/>2</span></pre></div><div class="ab cl me mf hr mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ig ih ii ij ik"><h1 id="38f8" class="ml ly in bd mm mn mo mp mq mr ms mt mu jt mv ju mw jw mx jx my jz mz ka na nb bi translated">高阶函数</h1><p id="041d" class="pw-post-body-paragraph kt ku in kv b kw nc jo ky kz nd jr lb lc ne le lf lg nf li lj lk ng lm ln lo ig bi translated">操作其他功能的<code class="fe lp lq lr ls b">function</code>。他们可以:</p><ol class=""><li id="2cfc" class="ns nt in kv b kw kx kz la lc nu lg nv lk nw lo nx ny nz oa bi translated">接受其他函数作为参数</li><li id="55be" class="ns nt in kv b kw ob kz oc lc od lg oe lk of lo nx ny nz oa bi translated">返回一个函数</li></ol><h2 id="1397" class="lx ly in bd mm nh ni dn mq nj nk dp mu lc nl nm mw lg nn no my lk np nq na nr bi translated">Example | Function 接受其他函数作为参数</h2><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="a627" class="lx ly in ls b gy lz ma l mb mc">const wishMe = function(action) {<br/>   action()<br/>}</span><span id="79bf" class="lx ly in ls b gy md ma l mb mc">const sayGoodMorning = function () {<br/>   console.log('Good morning');<br/>}</span><span id="dffb" class="lx ly in ls b gy md ma l mb mc">const sayGoodEvening = function() {<br/>   console.log('Good Evening');<br/>}</span><span id="3cb2" class="lx ly in ls b gy md ma l mb mc"><br/>wishMe(sayGoodMorning); // Good Morning<br/>wishMe(sayGoodEvening); // Good Evening</span></pre><h2 id="a78d" class="lx ly in bd mm nh ni dn mq nj nk dp mu lc nl nm mw lg nn no my lk np nq na nr bi translated">示例|函数返回其他函数</h2><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="81ff" class="lx ly in ls b gy lz ma l mb mc">function multiplyBy(num) {<br/>   return function(x) {<br/>        return num * x;<br/>   }<br/>}</span><span id="10e5" class="lx ly in ls b gy md ma l mb mc"><br/>const double = multiplyBy(2);<br/>const triple = multiplyBy(3);</span><span id="8f5c" class="lx ly in ls b gy md ma l mb mc">console.log(double(10)) // 20<br/>console.log(triple(7)) // 21</span></pre><blockquote class="og oh oi"><p id="5b71" class="kt ku oj kv b kw kx jo ky kz la jr lb ok ld le lf ol lh li lj om ll lm ln lo ig bi translated"><strong class="kv io">示例:</strong>创建一个范围函数工厂，通过返回一个函数<strong class="kv io">来检查任意范围。</strong></p></blockquote><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="3cdb" class="lx ly in ls b gy lz ma l mb mc">function makeRange(min,max) {<br/>    return function(x) {<br/>       return x &gt;= min &amp;&amp; x &lt;= max;<br/>    }<br/>}</span><span id="8d12" class="lx ly in ls b gy md ma l mb mc">const isChild = makeRange(0,18)<br/>const isEighties = makeRange(1981,1989)<br/>const isPleasentWeather = makeRange(15,25)</span><span id="e051" class="lx ly in ls b gy md ma l mb mc">//Check the output with above created function<br/>console.log(isChild(22)) // false<br/>console.log(isEighties(1986)) // true<br/>console.log(isPleasentWeather(18)) // true</span></pre></div><div class="ab cl me mf hr mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ig ih ii ij ik"><h1 id="625c" class="ml ly in bd mm mn mo mp mq mr ms mt mu jt mv ju mw jw mx jx my jz mz ka na nb bi translated">回调函数</h1><p id="51da" class="pw-post-body-paragraph kt ku in kv b kw nc jo ky kz nd jr lb lc ne le lf lg nf li lj lk ng lm ln lo ig bi on translated"><span class="l oo op oq bm or os ot ou ov di"> C </span> allback 是作为<code class="fe lp lq lr ls b">argument</code>传递给另一个函数并由<code class="fe lp lq lr ls b">outer function</code>调用的函数。</p><p id="d116" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">实际上，我们已经在本文中练习了<code class="fe lp lq lr ls b">callback</code>的例子，但是<code class="fe lp lq lr ls b">callback</code>在 JavaScript 中是如此的<code class="fe lp lq lr ls b">buzzword</code>，所以最好再修改一次。</p><h2 id="da56" class="lx ly in bd mm nh ni dn mq nj nk dp mu lc nl nm mw lg nn no my lk np nq na nr bi translated">修订后的回拨示例</h2><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="4085" class="lx ly in ls b gy lz ma l mb mc">const wishMe = function(action) {<br/>   action()<br/>}</span><span id="339d" class="lx ly in ls b gy md ma l mb mc">const sayGoodMorning = function () {<br/>   console.log('Good morning');<br/>}</span><span id="df93" class="lx ly in ls b gy md ma l mb mc">const sayGoodEvening = function() {<br/>   console.log('Good Evening');<br/>}</span><span id="b239" class="lx ly in ls b gy md ma l mb mc">wishMe(sayGoodMorning); // Good Morning<br/>wishMe(sayGoodEvening); // Good Evening</span></pre><p id="100d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在上面的例子中，<code class="fe lp lq lr ls b">sayGoodMorning()</code>和<code class="fe lp lq lr ls b">sayGoodEvening()</code>是回调函数，它们被传入<code class="fe lp lq lr ls b">wishMe()</code>函数并在其中被调用。</p><p id="4949" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果你有一点使用<code class="fe lp lq lr ls b">JavaScript</code>的经验，你应该已经体验过常用的<code class="fe lp lq lr ls b">callback</code>功能。下面讨论一些常见的<code class="fe lp lq lr ls b">callback</code>函数的例子。</p><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="b5e1" class="lx ly in ls b gy lz ma l mb mc"><strong class="ls io">Example-1:</strong><br/>setTimeOut(function() {<br/>   alert('Hey!!! Time up')}<br/>,1000);</span><span id="8ffd" class="lx ly in ls b gy md ma l mb mc"><strong class="ls io">Example-2:<br/></strong>const btn = document.querySelector('button');<br/>btn.addEventListener('click',function(evt){<br/>    console.log('Button Clicked');<br/>});</span></pre></div><div class="ab cl me mf hr mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ig ih ii ij ik"><h1 id="8971" class="ml ly in bd mm mn mo mp mq mr ms mt mu jt mv ju mw jw mx jx my jz mz ka na nb bi translated">提升</h1><p id="a3d8" class="pw-post-body-paragraph kt ku in kv b kw nc jo ky kz nd jr lb lc ne le lf lg nf li lj lk ng lm ln lo ig bi translated"><code class="fe lp lq lr ls b">Hoisting</code>是一个过程，其中所有的声明无论是<code class="fe lp lq lr ls b">variable declaration</code>还是<code class="fe lp lq lr ls b">function declaration</code>，都自动移动到程序的顶部。但这只发生在<code class="fe lp lq lr ls b">var</code>关键字上。</p><p id="59e5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">所以，不要浪费一分一秒的时间，快速进入一些例子…</p><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="cd29" class="lx ly in ls b gy lz ma l mb mc">var car = 'BMW';<br/>console.log(car); // BMW</span></pre><p id="46fd" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在上面的代码片段中，创建并打印了一个<code class="fe lp lq lr ls b">variable</code>,但是如果我们交换上面两个语句的顺序会发生什么呢？</p><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="924d" class="lx ly in ls b gy lz ma l mb mc">console.log(car); // undefined<br/>var car = 'BMW';</span></pre><p id="4dc3" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们用 Let 试试上面的代码片段，了解一下有什么区别。</p><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="35a4" class="lx ly in ls b gy lz ma l mb mc">console.log(car); // ReferenceError: car is not defined<br/>let car = 'BMW';</span></pre><p id="7942" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">正如你所看到的，如果一个<code class="fe lp lq lr ls b">variable</code>没有被定义但是被使用了，它应该产生一个<code class="fe lp lq lr ls b">error</code>而不是<code class="fe lp lq lr ls b">“variable is not defined”</code>。</p><p id="923a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">但是在<code class="fe lp lq lr ls b">var</code>的情况下，结果是未定义的，因为<code class="fe lp lq lr ls b">hoisting</code>发生了，所有的变量声明都被移到了顶部，看起来像下面的代码片段…</p><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="27d4" class="lx ly in ls b gy lz ma l mb mc">var car;<br/>console.log(car); //undefined<br/>car = 'BMW';</span></pre><p id="ff66" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">当您定义<code class="fe lp lq lr ls b">functions</code>时，同样的事情也会发生。所有的函数声明都自动移动到顶部。</p><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="70f1" class="lx ly in ls b gy lz ma l mb mc">greet() // Hi!!!</span><span id="1c74" class="lx ly in ls b gy md ma l mb mc">function greet() {<br/>    console.log('Hi!!!');<br/>}</span></pre><p id="bf15" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">普通函数是<code class="fe lp lq lr ls b">hoisted</code>，但函数表达式不是<code class="fe lp lq lr ls b">hoisted</code>。</p><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="5b8c" class="lx ly in ls b gy lz ma l mb mc">welcome(); // TypeError: welcome is not a function<br/>var welcome = function(){<br/>    console.log('Welcome');<br/>}</span></pre></div><div class="ab cl me mf hr mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ig ih ii ij ik"><p id="e775" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果你喜欢这篇文章，请关注我:</p><p id="0af2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">中:</strong><a class="ae ks" href="https://medium.com/@maheshshittlani" rel="noopener">https://medium.com/@maheshshittlani</a><br/><strong class="kv io">Github:</strong><a class="ae ks" href="https://github.com/maheshshittlani" rel="noopener ugc nofollow" target="_blank">https://github.com/maheshshittlani</a><br/><strong class="kv io">LinkedIn:</strong><a class="ae ks" href="https://in.linkedin.com/in/mahesh-shittlani-638b7429" rel="noopener ugc nofollow" target="_blank">https://in.linkedin.com/in/mahesh-shittlani-638b7429</a></p></div></div>    
</body>
</html>