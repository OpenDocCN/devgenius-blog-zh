<html>
<head>
<title>PHP — P83: MySQL DB Connection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PHP — P83: MySQL 数据库连接</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/php-p83-mysql-db-connection-8a34c4056863?source=collection_archive---------5-----------------------#2022-10-28">https://blog.devgenius.io/php-p83-mysql-db-connection-8a34c4056863?source=collection_archive---------5-----------------------#2022-10-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/9272562895bfb0c849f2e0b6b24bb656.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0h37-gYpCGL1i9M_9lyihg.jpeg"/></div></div></figure><p id="c72d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">读取或插入数据的第一步是建立与服务器/数据库的连接。这是一个相当简单的过程，不会改变。步骤总是一样的。一旦你连接到它，你就可以每次都重复使用代码。您唯一需要修改的是您的服务器、用户名、密码和数据库名称。</p><h1 id="9d25" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">创建数据库</h1><p id="dd0d" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">我假设你正在跟随这个系列。我们有一个 Docker 容器，这个容器有传统的 LAMP 设置(Linux、Apache、MySQL 和 PHP)。它还附带了 phpMyAdmin</p><p id="6552" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当您第一次运行 docker 容器时，它会为您生成一个用户名和密码。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="2afc" class="mi kx iq me b gy mj mk l ml mm">docker run -i -t -p "80:80" -v ${PWD}/app:/app -v ${PWD}/mysql:/var/lib/mysql mattrayner/lamp:latest</span></pre><p id="a1cd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您应该看到类似这样的带有您自己的唯一密码的内容。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="27bc" class="mi kx iq me b gy mj mk l ml mm">====================================================================<br/>You can now connect to this MySQL Server with OOwfvsr2soGW</span><span id="0d23" class="mi kx iq me b gy mn mk l ml mm">mysql -uadmin -pE9bIyRDwzidT -h&lt;host&gt; -P&lt;port&gt;</span><span id="3fc1" class="mi kx iq me b gy mn mk l ml mm">Please remember to change the above password as soon as possible!<br/>MySQL user 'root' has no password but only allows local connections</span><span id="d1da" class="mi kx iq me b gy mn mk l ml mm">enjoy!</span></pre><p id="affb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这将是我们可以用来访问 phpMyAdmin 的用户名/密码。</p><ul class=""><li id="6b35" class="mo mp iq ka b kb kc kf kg kj mq kn mr kr ms kv mt mu mv mw bi translated"><code class="fe mx my mz me b">admin</code></li><li id="50e1" class="mo mp iq ka b kb na kf nb kj nc kn nd kr ne kv mt mu mv mw bi translated"><code class="fe mx my mz me b">E9bIyRDwzidT</code></li></ul><p id="d84e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你看不到它，很可能是因为你以前做过，并且你的目录中已经有一个<code class="fe mx my mz me b">mysql</code>文件夹。删除<code class="fe mx my mz me b">mysql</code>目录，再次运行 docker 命令。<strong class="ka ir">记住，这只是针对测试环境。如果您正在生产环境中工作，请不要删除任何内容。我强烈建议您不要在生产环境中进行实验。</strong></p><h2 id="7787" class="mi kx iq bd ky nf ng dn lc nh ni dp lg kj nj nk lk kn nl nm lo kr nn no ls np bi translated">通过 phpMyAdmin 创建数据库</h2><p id="0a83" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">转到您的本地主机 phpMyAdmin 安装。对我来说，它是<code class="fe mx my mz me b">http://0.0.0.0/phpmyadmin</code>。</p><figure class="lz ma mb mc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nq"><img src="../Images/92f13d8ef38beffd2be100628980c03a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Mt9CNnUkEm4kOGvBpx5MQ.png"/></div></div></figure><p id="80a2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">输入您的凭据，然后单击“开始”。您将进入 phpMyAdmin 主站点。</p><figure class="lz ma mb mc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nr"><img src="../Images/222451e19c55a235220fba67c8ce1d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2AAkVefsYmZOX4RibnCKWg.png"/></div></div></figure><p id="4336" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">点击<code class="fe mx my mz me b">Databases</code>选项卡，输入数据库名称。我进入了<code class="fe mx my mz me b">dino_test_db</code>。点击<code class="fe mx my mz me b">Create</code>按钮创建数据库。</p><figure class="lz ma mb mc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ns"><img src="../Images/72405d85d56693e5a788b786240a3f74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ysk8Jxr--r8mOgjkcRSi8g.png"/></div></div></figure><p id="7c48" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您将被重定向到您的数据库，在那里您可以开始添加表。在本教程中，我们不会这样做。</p><figure class="lz ma mb mc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/6eaec18c59973cb9260dcdd8e33c1832.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ql8vgNJfa-o1T-uB52ssoA.png"/></div></div></figure><h2 id="e5b2" class="mi kx iq bd ky nf ng dn lc nh ni dp lg kj nj nk lk kn nl nm lo kr nn no ls np bi translated">通过服务器创建数据库</h2><p id="2b3b" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">如果您没有 phpMyAdmin 的访问权限，您可以登录到您的容器并执行一个脚本。你已经被提供如何做这件事。首先，访问 Docker 并点击你的容器。</p><figure class="lz ma mb mc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nu"><img src="../Images/b1318adf19357593ad4bca6cbe7516b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V4Vf73QPm_qsbBECGfRg1Q.png"/></div></div></figure><p id="6645" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">接下来，复制到 mysql 脚本的连接。对我来说是:</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="4360" class="mi kx iq me b gy mj mk l ml mm">mysql -uadmin -pE9bIyRDwzidT</span></pre><p id="9eb8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">单击 CLI 选项卡并粘贴脚本。</p><figure class="lz ma mb mc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nv"><img src="../Images/b8f0c3d1f004c819f04438e037db2760.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sr7nm78NP_1GrxuyTMusMg.png"/></div></div></figure><p id="0ef8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您已连接到 MySQL 服务器。要查看您目前拥有哪些数据库，请键入:<code class="fe mx my mz me b">show databases;</code></p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="ee16" class="mi kx iq me b gy mj mk l ml mm">mysql&gt; show databases;<br/>+--------------------+<br/>| Database           |<br/>+--------------------+<br/>| dino_test_db       |<br/>| information_schema |<br/>| mysql              |<br/>| performance_schema |<br/>| sys                |<br/>+--------------------+<br/>5 rows in set (0.00 sec)</span><span id="e09f" class="mi kx iq me b gy mn mk l ml mm">mysql&gt;</span></pre><p id="2afe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是我们刚刚通过 phpMyAdmin 创建的数据库。要创建新的数据库，请键入:<code class="fe mx my mz me b">create database dino_test_db_2;</code></p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="73db" class="mi kx iq me b gy mj mk l ml mm">mysql&gt; create database dino_test_db_2;<br/>Query OK, 1 row affected (0.00 sec)</span><span id="d438" class="mi kx iq me b gy mn mk l ml mm">mysql&gt; show databases;<br/>+--------------------+<br/>| Database           |<br/>+--------------------+<br/>| dino_test_db       |<br/>| dino_test_db_2     |<br/>| information_schema |<br/>| mysql              |<br/>| performance_schema |<br/>| sys                |<br/>+--------------------+<br/>6 rows in set (0.00 sec)</span><span id="5f76" class="mi kx iq me b gy mn mk l ml mm">mysql&gt;</span></pre><p id="8624" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">就是这样。您已经创建了一个没有 phpMyAdmin 的数据库。</p><h2 id="c520" class="mi kx iq bd ky nf ng dn lc nh ni dp lg kj nj nk lk kn nl nm lo kr nn no ls np bi translated">通过 PHP 脚本创建数据库</h2><p id="146b" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">是的。还有另一种方法可以做到这一点。我不建议你经常这么做，因为你可能会忘记删除脚本。但绝对管用。</p><figure class="lz ma mb mc gt jr"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="2c84" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们只是像之前一样运行<code class="fe mx my mz me b">CREATE DATABASE db_name</code>脚本。我们将它传递给<code class="fe mx my mz me b">query</code>方法。如果查询正确执行，它将返回<code class="fe mx my mz me b">true</code>。数据库创建成功。</p><p id="fada" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">不要被我们刚刚讲述的内容弄得不知所措。我们刚刚讨论了三种不同的方法来做同样的事情:创建数据库。</p><h1 id="0e95" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">连接到服务器</h1><p id="d13d" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">是时候连接到您的服务器了。我们将用面向对象的方法来做这件事。也有一个过程化的方法，但是我们知道 OOP PHP，所以我们就这样做。在连接到数据库之前，您需要这样做。</p><figure class="lz ma mb mc gt jr"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="2d7d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将使用<code class="fe mx my mz me b">mysqli</code>类来创建<code class="fe mx my mz me b">$connection</code>对象。<code class="fe mx my mz me b">mysqli</code>构造函数期望在实例化时有 3 个参数传递给它。</p><ul class=""><li id="685a" class="mo mp iq ka b kb kc kf kg kj mq kn mr kr ms kv mt mu mv mw bi translated">服务器名称。在大多数情况下，如果你的 MySQL 数据库在同一个服务器上，这将是<code class="fe mx my mz me b">localhost</code>。</li><li id="df0c" class="mo mp iq ka b kb na kf nb kj nc kn nd kr ne kv mt mu mv mw bi translated">用户名。我们知道这是<code class="fe mx my mz me b">admin</code>。</li><li id="a1b5" class="mo mp iq ka b kb na kf nb kj nc kn nd kr ne kv mt mu mv mw bi translated">密码。我们也知道密码是什么:<code class="fe mx my mz me b">E9bIyRDwzidT</code>。</li></ul><p id="13a2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">仅此而已。您将检查<code class="fe mx my mz me b">$connection-&gt;connect_error</code>属性是否有任何连接错误。如果有一个错误，你杀死脚本。如果没有错误，您应该会得到一条<code class="fe mx my mz me b">Connection established successfully</code>消息。</p><h1 id="c0dd" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">连接到数据库</h1><p id="bc3b" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">现在我们已经创建了一个数据库，我们可以连接到它。我们只需要稍微修改一下我们的脚本。</p><figure class="lz ma mb mc gt jr"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="412d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mx my mz me b">mysqli</code>构造函数也可以接受数据库名。我们会把它作为最后一个论点。运行代码，您会看到您将得到<code class="fe mx my mz me b">Connection established successfully</code>消息。</p><p id="befe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这就是全部了。</p></div><div class="ab cl ny nz hu oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="ij ik il im in"><figure class="lz ma mb mc gt jr gh gi paragraph-image"><div class="gh gi of"><img src="../Images/02a6b11f56b770000ee160812e4c66be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qR85JBTjv6BL5LB0.jpeg"/></div></figure><p id="89db" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Dino Cajic 目前是<a class="ae og" href="http://absolutebiotech.com/" rel="noopener ugc nofollow" target="_blank"> Absolute Biotech </a>的 IT 负责人，该公司是<a class="ae og" href="https://www.lsbio.com/" rel="noopener ugc nofollow" target="_blank"> LSBio(寿命生物科学公司)</a>、<a class="ae og" href="https://absoluteantibody.com/" rel="noopener ugc nofollow" target="_blank"> Absolute 抗体</a>、<a class="ae og" href="https://www.kerafast.com/" rel="noopener ugc nofollow" target="_blank"> Kerafast </a>、<a class="ae og" href="https://everestbiotech.com/" rel="noopener ugc nofollow" target="_blank"> Everest BioTech </a>、<a class="ae og" href="https://www.nordicmubio.com/" rel="noopener ugc nofollow" target="_blank"> Nordic MUbio </a>和<a class="ae og" href="https://www.exalpha.com/" rel="noopener ugc nofollow" target="_blank"> Exalpha </a>的母公司。他还担任我的自动系统的首席执行官。他拥有计算机科学学士学位，辅修生物学，并拥有十多年的软件工程经验。他的背景包括创建企业级电子商务应用程序、执行基于研究的软件开发，以及通过写作促进知识的传播。</p><p id="15ab" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以在<a class="ae og" href="https://www.linkedin.com/in/dinocajic/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上联系他，在<a class="ae og" href="https://instagram.com/think.dino" rel="noopener ugc nofollow" target="_blank"> Instagram </a>上关注他，或者<a class="ae og" href="https://dinocajic.medium.com/subscribe" rel="noopener">订阅他的媒体出版物</a>。</p><p id="a684" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">阅读 Dino Cajic(以及 Medium 上成千上万的其他作家)的每一个故事。你的会员费直接支持迪诺·卡吉克和你阅读的其他作家。你也可以在媒体上看到所有的故事。T25】</p></div></div>    
</body>
</html>