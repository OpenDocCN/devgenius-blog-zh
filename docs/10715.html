<html>
<head>
<title>Django CSV Uploader</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Django CSV 上传程序</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/django-csv-uploader-d28537874f4e?source=collection_archive---------7-----------------------#2022-11-24">https://blog.devgenius.io/django-csv-uploader-d28537874f4e?source=collection_archive---------7-----------------------#2022-11-24</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="ef95" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这里，您将看到如何将数据从. CSV 文件导入到 Django 模型中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/30df5e16654bbfb785cf34ba803bb4fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sfkmeqaUs9AzJXUyBYtPpA.png"/></div></div></figure><p id="3f29" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这里，我们将创建一个视图。csv 文件并上传到我们的模型。我们还将创建一个 HTML 模板并上传。csv 文件。</p><h1 id="259f" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">源代码</h1><p id="e87f" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">如果你只是想要源代码，可以在这里得到<em class="lx">(</em><a class="ae ly" href="https://github.com/Priyank010/Django-Csv-Uploader" rel="noopener ugc nofollow" target="_blank"><em class="lx"/></a><em class="lx">)</em>。</p><h1 id="da53" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">Django 项目。</h1><p id="30fb" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">开始一个新的 Django 项目。首先创建 python 环境。</p><pre class="kj kk kl km gt lz ma mb bn mc md bi"><span id="f83a" class="me kv in ma b be mf mg l mh mi">pip install virtualenv<br/>virtualenv MyFirstApp<br/>MyFirstApp\scripts\activate</span></pre><p id="fe84" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">安装 Django、Django REST 框架和 Django 核心头文件。</p><pre class="kj kk kl km gt lz ma mb bn mc md bi"><span id="af55" class="me kv in ma b be mf mg l mh mi">pip install django djangorestframework django-cors-headers pandas</span></pre><p id="e930" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在创建一个新的 Django 项目。</p><pre class="kj kk kl km gt lz ma mb bn mc md bi"><span id="9943" class="me kv in ma b be mf mg l mh mi">django-admin startproject djangoCsvUploader</span></pre><p id="f64b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要检查一切是否正常，运行<strong class="jm io"> migrate </strong>命令。</p><pre class="kj kk kl km gt lz ma mb bn mc md bi"><span id="5a3f" class="me kv in ma b be mf mg l mh mi">python manage.py migrate</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mj"><img src="../Images/2f90ed0c77b9219b544083db266f092c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TOcWpaE5GUVzfRTdDPlJOg.png"/></div></div></figure><p id="6aba" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">迁移</strong>后，运行服务器，在浏览器中打开<a class="ae ly" href="http://127.0.0.1:8000/" rel="noopener ugc nofollow" target="_blank"><strong class="jm io">http://127 . 0 . 0 . 1:8000/</strong></a><strong class="jm io"/>链接进行检查。</p><pre class="kj kk kl km gt lz ma mb bn mc md bi"><span id="53f7" class="me kv in ma b be mf mg l mh mi">python manage.py runserver</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mk"><img src="../Images/498324d5ce1f8047c2d6519422371eb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Z4jkkP1L76NhTA8a.png"/></div></div></figure><p id="17b8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你在打开链接后看到这个页面，那就意味着一切正常。</p><p id="ea59" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在让我们在项目中启动一个新的应用程序</p><pre class="kj kk kl km gt lz ma mb bn mc md bi"><span id="da9d" class="me kv in ma b be mf mg l mh mi">cd djangoRedis<br/>django-admin startapp mainApp</span></pre><p id="ef3a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">完成后，让我们将应用程序名称添加到<strong class="jm io"> INSTALLED_APPS 内的 setting.py 文件中。</strong></p><p id="f467" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">之后，让我们为应用程序创建一个模型。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="165e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这个模型需要序列化程序，为此我们必须在 app 文件夹中创建一个 serializers.py 文件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="7551" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将为我们的学生模型创建视图集，这将帮助我们执行<strong class="jm io"> CRUD </strong> <em class="lx">(创建、读取、更新和删除)</em>操作。打开<strong class="jm io"> views.py </strong>，添加以下代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="f89c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">最后，我们将创建<strong class="jm io">URL</strong>来从浏览器访问我们的模型。打开 urls.py 并添加以下代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="9fab" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在让我们将这个模型添加到数据库中并访问它们。为此，我们首先必须创建一些迁移，并将它们迁移到我们的数据库中，然后再次运行项目。</p><pre class="kj kk kl km gt lz ma mb bn mc md bi"><span id="dcea" class="me kv in ma b be mf mg l mh mi">python manage.py makemigrations<br/>python manage.py migrate<br/>python manage.py runserver</span></pre><p id="3d1b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在打开<a class="ae ly" href="http://127.0.0.1:8000/api/" rel="noopener ugc nofollow" target="_blank"><strong class="jm io">http://127 . 0 . 0 . 1:8000/API</strong>/</a>看看你的模型。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mn"><img src="../Images/ac2493e59f69a97cc64f9aea5180c5b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ypNtc1iizBr3lUvYF5WuLA.png"/></div></div></figure><p id="65b4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">您可以点击其名称旁边的链接来执行<strong class="jm io"> CRUD </strong> <em class="lx">(创建、读取、更新和删除)</em>操作。向数据库添加一些数据以查看结果。</p><h1 id="6227" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">创建 CSV 上传程序</h1><p id="3819" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">一旦你的模型被创建，你现在可以开始创建 CSV 上传。</p><h2 id="1dcd" class="mo kv in bd kw mp mq dn la mr ms dp le jv mt mu li jz mv mw lm kd mx my lq mz bi translated">HTML 模板</h2><p id="4ba2" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">首先，创建两个新的文件夹模板来存储 HTML 文件和静态来保存 CSS 文件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi na"><img src="../Images/11c686e5a1035d0f354a1fec0103407f.png" data-original-src="https://miro.medium.com/v2/resize:fit:634/format:webp/1*KEoKGeUB8VKqociWMyuAlg.png"/></div></figure><p id="18e8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">创建一个名为 csv_uploader.html 的新文件，并添加以下数据。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="d9f7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在打开静态文件夹，创建一个名为 app.css 的新文件，并向其中添加以下代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="4eb2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">完成后，打开 views.py 并创建一个新的 TemplateView 类。这将打开 HTML 文件并在 POST 时处理 CSV 数据。这是您最终的 view.py 外观。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="5e40" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要打开 HTML 文件，我们必须将其添加到这个 TemplateView 类中。我们还必须创建一个 POST 函数来接收 CSV 文件，并读取和解码它。一旦完成，我们将通过 CSV 运行一个 for 循环并创建新的对象。</p><p id="0e40" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">最后，我们必须将这个视图添加到<strong class="jm io"> URLs.py </strong>文件中。这就是最终的 URLs.py 文件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="7251" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在打开<a class="ae ly" href="http://127.0.0.1:8000/csv-uploader/" rel="noopener ugc nofollow" target="_blank"><strong class="jm io">http://127 . 0 . 0 . 1:8000/CSV-uploader/</strong></a>查看模板。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mn"><img src="../Images/b54a1469a8b3bd29794ebc66568a596e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yc325u41Gb7XHlBnZ0kdjg.png"/></div></div></figure><p id="305c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在让我们创建一个 csv 文件并上传它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/dcf6186340e21c82a20ecfb15bb98643.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*pB7HMqYNKfOCPYoBFakutA.png"/></div></figure><p id="0075" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这就是文件的外观。除此之外的任何格式都将引发错误。</p><p id="0b49" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">打开学生 API<a class="ae ly" href="http://127.0.0.1:8000/api/students/" rel="noopener ugc nofollow" target="_blank"><strong class="jm io">http://127 . 0 . 0 . 1:8000/API/students/</strong></a>查看结果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mn"><img src="../Images/9813ea9b089383fd44e111737c7286ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pBHiLU4lTP3XfApZogLb_Q.png"/></div></div></figure><h1 id="0912" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">结论</h1><p id="0a31" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">如果您想要为您的项目创建一个 CSV 上传，那么请确保在您的 CSV 中使用与您的模型中相同的字段名称。你可以从这里得到源代码<em class="lx">(</em><a class="ae ly" href="https://github.com/Priyank010/Django-Csv-Uploader" rel="noopener ugc nofollow" target="_blank"><em class="lx">https://github.com/Priyank010/Django-Csv-Uploader</em></a><em class="lx">)</em></p></div></div>    
</body>
</html>