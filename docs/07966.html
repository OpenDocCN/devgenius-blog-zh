<html>
<head>
<title>BarCodeReader App using React Native Vision Camera.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 React 本机视觉摄像头的条形码阅读器应用程序。</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/barcodereader-app-using-react-native-vision-camera-2cb812763393?source=collection_archive---------0-----------------------#2022-05-07">https://blog.devgenius.io/barcodereader-app-using-react-native-vision-camera-2cb812763393?source=collection_archive---------0-----------------------#2022-05-07</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="8c66" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你可以找到许多博客反应原生条码阅读器应用程序，但所有这些都很旧，其中一些表现很差。不久前，我有机会为一家公司设计了一个，在这家公司里，性能是一个关键因素。在做了大量的研究、基准测试和大量的头脑风暴之后，我们可以做出一个性能非常好的应用。让我们开始吧。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b246347c95cc4504a00471d6c001ed91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*08FFPPQFPK_ZAQKijFA8WQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">介绍图像</figcaption></figure><p id="1d5c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">首先，我假设您已经准备好了标准的 react 本地模板。我将不涉及这一点，因为这是众所周知的。</p><p id="01ac" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，让我们继续进行所需的安装。我们将使用一个名为:react-native-vision-camera 的库。它是 react-native-camera 的替代品，现在是社区建议的标准相机。在这里阅读<a class="ae ky" href="https://github.com/react-native-camera/react-native-camera" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="6c2e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要安装:</p><pre class="kj kk kl km gt kz la lb lc aw ld bi"><span id="6b27" class="le lf in la b gy lg lh l li lj">yarn add react-native-vision-camera</span><span id="64e7" class="le lf in la b gy lk lh l li lj">or</span><span id="5573" class="le lf in la b gy lk lh l li lj">npm install react-native-vision-camera</span><span id="eee1" class="le lf in la b gy lk lh l li lj">or</span><span id="0fd9" class="le lf in la b gy lk lh l li lj">expo install react-native-vision-camera</span></pre><p id="3b8f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">对于 ios 应用程序:</p><pre class="kj kk kl km gt kz la lb lc aw ld bi"><span id="a074" class="le lf in la b gy lg lh l li lj">cd ios &amp;&amp; pod install &amp;&amp; cd ../</span></pre><p id="5472" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">更新清单:</p><p id="fafa" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">安卓:</strong></p><p id="8220" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">打开项目的<code class="fe ll lm ln la b">AndroidManifest.xml</code>，在<code class="fe ll lm ln la b">&lt;manifest&gt;</code>标签中添加以下几行:</p><pre class="kj kk kl km gt kz la lb lc aw ld bi"><span id="6107" class="le lf in la b gy lg lh l li lj">&lt;uses-permission android:name="android.permission.CAMERA" /&gt;</span></pre><p id="4411" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> iOS: </strong></p><p id="c30e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">打开项目的<code class="fe ll lm ln la b">Info.plist</code>，在最外面的<code class="fe ll lm ln la b">&lt;dict&gt;</code>标签中添加以下代码行:</p><pre class="kj kk kl km gt kz la lb lc aw ld bi"><span id="20b5" class="le lf in la b gy lg lh l li lj">&lt;key&gt;NSCameraUsageDescription&lt;/key&gt;<br/>&lt;string&gt;$(PRODUCT_NAME) needs access to your Camera.&lt;/string&gt;</span><span id="64e6" class="le lf in la b gy lk lh l li lj">&lt;!-- optionally, if you want to record audio: --&gt;<br/>&lt;key&gt;NSMicrophoneUsageDescription&lt;/key&gt;<br/>&lt;string&gt;$(PRODUCT_NAME) needs access to your Microphone.&lt;/string&gt;</span></pre><p id="c926" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">管理博览会:</strong></p><p id="bbbe" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">将 VisionCamera 插件添加到您的 Expo 配置(<code class="fe ll lm ln la b">app.json</code>、<code class="fe ll lm ln la b">app.config.json</code>或<code class="fe ll lm ln la b">app.config.js</code>):</p><pre class="kj kk kl km gt kz la lb lc aw ld bi"><span id="344a" class="le lf in la b gy lg lh l li lj">{<br/>  "name": "my app",<br/>  "plugins": [<br/>    [<br/>      "react-native-vision-camera",<br/>      {<br/>        "cameraPermissionText": "$(PRODUCT_NAME) needs access to your Camera."<br/>      }<br/>    ]<br/>  ]<br/>}</span></pre><p id="4267" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">最后，编译 mods:</p><pre class="kj kk kl km gt kz la lb lc aw ld bi"><span id="ce49" class="le lf in la b gy lg lh l li lj">expo prebuild</span></pre><p id="8538" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要应用这些更改，用 EAS 构建一个新的二进制文件:</p><pre class="kj kk kl km gt kz la lb lc aw ld bi"><span id="d3b8" class="le lf in la b gy lg lh l li lj">eas build</span></pre><p id="5434" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">由于我们将使用帧处理器来构建我们的条形码阅读器，我们将需要 react-native-reactive。让我们也安装它。</p><pre class="kj kk kl km gt kz la lb lc aw ld bi"><span id="3615" class="le lf in la b gy lg lh l li lj">yarn add react-native-reanimated</span><span id="60a4" class="le lf in la b gy lk lh l li lj">or </span><span id="128e" class="le lf in la b gy lk lh l li lj">npm install react-native-reanimated</span></pre><p id="44f2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在按照入门指南<a class="ae ky" href="https://docs.swmansion.com/react-native-reanimated/docs/fundamentals/installation/" rel="noopener ugc nofollow" target="_blank">进行所需的配置。</a></p><p id="05aa" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了避免相机由于权限而重新渲染，尽快请求权限总是一个好主意。比如，在主屏幕上询问权限，而不是在扫描屏幕上询问。我希望你明白我想表达的意思。</p><p id="c43a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因此，在应用程序的主屏幕上，添加以下几行。</p><pre class="kj kk kl km gt kz la lb lc aw ld bi"><span id="c85c" class="le lf in la b gy lg lh l li lj">import {Camera} from 'react-native-vision-camera';</span><span id="e30a" class="le lf in la b gy lk lh l li lj">/* Inside your component */</span><span id="9345" class="le lf in la b gy lk lh l li lj">const checkCameraPermission = async () =&gt; {<br/>  let status = await Camera.getCameraPermissionStatus();<br/>  if (status !== 'authorized') {<br/>    await Camera.requestCameraPermission();<br/>    status = await Camera.getCameraPermissionStatus();<br/>    if (status === 'denied') {<br/>      showToast(<br/>        'You will not be able to scan if you do not allow camera access',<br/>      );<br/>    }<br/>  }<br/>};</span><span id="932e" class="le lf in la b gy lk lh l li lj">// class based components<br/>componentDidMount() {<br/>    .....<br/>    .....<br/>    checkCameraPermission();<br/>  }</span><span id="e67a" class="le lf in la b gy lk lh l li lj">// functional components</span><span id="9bde" class="le lf in la b gy lk lh l li lj">useEffect(() =&gt; {<br/>   checkCameraPermission();<br/>}, []);</span></pre><p id="39da" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，让我们转到实际的 ScanScreen，展示一些 UI 和逻辑部分。</p><p id="440a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将使用视觉摄像头代码扫描仪。还有其他可用的，但从我遇到的，这可能是最好的一个。然而，你也可以检查其他人。</p><p id="93c2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了更好的 UI 外观，我们也将使用 react-native-hole-view。让我们安装它们。</p><pre class="kj kk kl km gt kz la lb lc aw ld bi"><span id="7b1c" class="le lf in la b gy lg lh l li lj">yarn add vision-camera-code-scanner react-native-hole-view</span><span id="09c9" class="le lf in la b gy lk lh l li lj">or</span><span id="747c" class="le lf in la b gy lk lh l li lj">npm install vision-camera-code-scanner react-native-hole-view</span><span id="9849" class="le lf in la b gy lk lh l li lj">// For iOS apps:</span><span id="6610" class="le lf in la b gy lk lh l li lj">cd ios &amp;&amp; pod install &amp;&amp; cd ../</span></pre><p id="0040" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在将下面几行代码添加到您的代码中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lo lp l"/></div></figure><p id="b034" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你现在都做完了。这既简单又高效。<strong class="jm io">关注</strong>我获取更多此类内容。谢了。祝你有美好的一天！</p><p id="5b7e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">干杯。✌🏻</p></div></div>    
</body>
</html>