<html>
<head>
<title>Load Balancing: 101</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">负载平衡:101</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/load-balancing-101-8251350c033f?source=collection_archive---------3-----------------------#2022-03-25">https://blog.devgenius.io/load-balancing-101-8251350c033f?source=collection_archive---------3-----------------------#2022-03-25</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="06f1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这篇博客是我们从零开始讨论<strong class="jm io">云</strong>概念的系列文章的一部分，面向的是入门知识有限的读者。这篇文章属于<em class="ki">中级</em>系列，因为它涉及构建一般的负载平衡原则。</p><p id="fe85" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">云系列中的一些早期博客如下。</p><p id="5642" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae kj" rel="noopener ugc nofollow" target="_blank" href="/disaster-recovery-on-aws-cloud-building-blocks-e013bffd6244"><strong class="jm io">AWS 云上容灾</strong></a><strong class="jm io"><br/></strong><a class="ae kj" rel="noopener ugc nofollow" target="_blank" href="/disaster-recovery-on-azure-cloud-building-blocks-6ff826adbc8b"><strong class="jm io">Azure 云上容灾</strong></a><strong class="jm io"><br/></strong><a class="ae kj" rel="noopener ugc nofollow" target="_blank" href="/disaster-recovery-on-google-cloud-building-blocks-b2a232a9ec"><strong class="jm io">Google 云上容灾</strong> </a></p><h1 id="9378" class="kk kl in bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">什么是负载平衡</h1><p id="21c6" class="pw-post-body-paragraph jk jl in jm b jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc kd lm kf kg kh ig bi translated">负载平衡的概念是将传入的客户流量分配到多个后端服务器。负载平衡器在后端服务器间使用有效的流量路由算法，确保后端层的性能和弹性在动态流量需求间得到维护。</p><p id="3945" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">使用适当的<a class="ae kj" href="https://cloud.google.com/load-balancing/docs/health-check-concepts" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io">健康检查</strong> </a> <em class="ki"> </em>来确定正在运行的服务的可用性，负载平衡器将客户与任何不健康的下游隔离。此外，配合基于系统指标的正确的<a class="ae kj" href="https://en.wikipedia.org/wiki/Autoscaling" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io">自动扩展</strong> </a>规则，负载平衡器提供了动态添加或删除服务器的功能。</p><h1 id="f1c0" class="kk kl in bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">端到端流量是如何工作的</h1><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ln"><img src="../Images/757dd4cd9b220bb1d537b604a0bf3399.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l6fQwUv8Or5Yj-AKiv3Kbw.png"/></div></div></figure><h1 id="73bb" class="kk kl in bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">顺序流程</h1><ol class=""><li id="1020" class="lz ma in jm b jn li jr lj jv mb jz mc kd md kh me mf mg mh bi translated">最终用户在端口 443 上的浏览器中点击 https 端点<a class="ae kj" href="http://www.abc.com" rel="noopener ugc nofollow" target="_blank"><strong class="jm io"><em class="ki">【www.abc.com】</em></strong></a><strong class="jm io"><em class="ki"/></strong>。</li><li id="efdf" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">使用客户端<a class="ae kj" href="http://www.abc.com" rel="noopener ugc nofollow" target="_blank"><strong class="jm io"><em class="ki">www.abc.com</em></strong></a><strong class="jm io"><em class="ki"/></strong>中的 DNS 解析映射到负载平衡器的内部 DNS<strong class="jm io"><em class="ki">xyz.c5d56d116072-ilb.com。</em>T55】</strong></li><li id="f275" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">负载平衡器定期对端口 80 进行健康检查，以确定健康的后端服务器。</li><li id="74e8" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">负载平衡器 IP 端口 443 上的流量被重定向到端口 80 上的健康后端。</li></ol><h1 id="1ba3" class="kk kl in bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">负载平衡器的分类</h1><h2 id="c591" class="mn kl in bd km mo mp dn kq mq mr dp ku jv ms mt ky jz mu mv lc kd mw mx lg my bi translated">OSI 模型</h2><p id="05b0" class="pw-post-body-paragraph jk jl in jm b jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc kd lm kf kg kh ig bi translated">基于<a class="ae kj" href="https://www.geeksforgeeks.org/layers-of-osi-model/" rel="noopener ugc nofollow" target="_blank"> OSI </a>模型，任何给定网络上两个节点之间的通信分为 7 层。负载平衡器通常在这 7 层中的两层运行，即<strong class="jm io"> L4 负载平衡器(传输层)</strong>和<strong class="jm io"> L7 负载平衡器(应用层)</strong>。</p><h2 id="f592" class="mn kl in bd km mo mp dn kq mq mr dp ku jv ms mt ky jz mu mv lc kd mw mx lg my bi translated"><strong class="ak"> L4 负载均衡器</strong></h2><p id="9539" class="pw-post-body-paragraph jk jl in jm b jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc kd lm kf kg kh ig bi translated">这些 LB 使用由客户端创建的相同 TCP 连接来与上游服务器建立连接。传输中的数据在传输层被隔离，路由决策只能基于使用<em class="ki"> IP 和端口</em></p><h2 id="9ee6" class="mn kl in bd km mo mp dn kq mq mr dp ku jv ms mt ky jz mu mv lc kd mw mx lg my bi translated"><strong class="ak"> L7 负载平衡器</strong></h2><p id="b69a" class="pw-post-body-paragraph jk jl in jm b jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc kd lm kf kg kh ig bi translated">这些 LB 使用两个 TCP 连接，一个由客户端在发出请求时创建，另一个由负载平衡器在与上游服务器建立连接时创建。在这种情况下，可以使用传输中的数据和诸如<strong class="jm io"> <em class="ki">认证、智能路由和 TLS 终止等功能做出路由决策。</em>T15】</strong></p><h1 id="bca8" class="kk kl in bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">流量路由规则</h1><p id="55e8" class="pw-post-body-paragraph jk jl in jm b jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc kd lm kf kg kh ig bi translated">根据用于将流量定向到后端服务器的流量路由算法，负载平衡器可以进一步分为</p><h2 id="8312" class="mn kl in bd km mo mp dn kq mq mr dp ku jv ms mt ky jz mu mv lc kd mw mx lg my bi translated"><strong class="ak">循环算法</strong></h2><p id="9a53" class="pw-post-body-paragraph jk jl in jm b jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc kd lm kf kg kh ig bi translated">将每个服务器视为同质实体，流量在后端服务器之间平均轮换。</p><h2 id="a001" class="mn kl in bd km mo mp dn kq mq mr dp ku jv ms mt ky jz mu mv lc kd mw mx lg my bi translated"><strong class="ak">加权循环算法</strong></h2><p id="e89b" class="pw-post-body-paragraph jk jl in jm b jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc kd lm kf kg kh ig bi translated">每台服务器都分配有一个加权分数，负载平衡器根据分配的权重按比例将流量分配给后端。</p><h2 id="4fa2" class="mn kl in bd km mo mp dn kq mq mr dp ku jv ms mt ky jz mu mv lc kd mw mx lg my bi translated"><strong class="ak">最少连接算法。</strong></h2><p id="7c55" class="pw-post-body-paragraph jk jl in jm b jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc kd lm kf kg kh ig bi translated">流量被从负载平衡器转发到具有最少活动连接的服务器。</p><h2 id="60b1" class="mn kl in bd km mo mp dn kq mq mr dp ku jv ms mt ky jz mu mv lc kd mw mx lg my bi translated"><strong class="ak">最小响应时间算法。</strong></h2><p id="07cb" class="pw-post-body-paragraph jk jl in jm b jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc kd lm kf kg kh ig bi translated">除了最少的连接，在这个负载平衡算法中，流量被定向到具有最低响应的服务器，作为最高优先级。</p><h1 id="198b" class="kk kl in bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">摘要</h1><p id="5905" class="pw-post-body-paragraph jk jl in jm b jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc kd lm kf kg kh ig bi translated">负载平衡是公共云或私有云上的分布式可扩展部署的基本构建块。每个云供应商都提供了一系列负载平衡解决方案，这些解决方案结合使用了上述规则。其中比较流行的有以下几种——<strong class="jm io"/><a class="ae kj" href="https://docs.aws.amazon.com/AmazonECS/latest/developerguide/load-balancer-types.html" rel="noopener ugc nofollow" target="_blank"><strong class="jm io">AWS 负载均衡</strong></a><strong class="jm io"/><a class="ae kj" href="https://docs.microsoft.com/en-us/azure/architecture/guide/technology-choices/load-balancing-overview" rel="noopener ugc nofollow" target="_blank"><strong class="jm io">Azure 负载均衡</strong></a><a class="ae kj" href="https://cloud.google.com/load-balancing" rel="noopener ugc nofollow" target="_blank"><strong class="jm io">GCP 负载均衡</strong> </a></p><p id="6b64" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="ki">如需反馈，请留言至</em><strong class="jm io"><em class="ki">Amit[dot]894[at]Gmail[dot]com</em></strong><em class="ki">或联系 https://about.me/amit_raj</em><em class="ki">的任意链接。</em></p></div></div>    
</body>
</html>