<html>
<head>
<title>How to Launch AWS CloudFormation using Lamba function</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用 Lamba 函数启动 AWS CloudFormation</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-launch-aws-cloudformation-using-lamba-function-3182101fa1da?source=collection_archive---------4-----------------------#2021-01-27">https://blog.devgenius.io/how-to-launch-aws-cloudformation-using-lamba-function-3182101fa1da?source=collection_archive---------4-----------------------#2021-01-27</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="3736" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">基础设施代码简介| AWS 自动化| Python 3</p><p id="9283" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果您经常设置需要随需应变的环境 AWS 和资源，并且希望有某种方法来自动化该过程。基本上，调出那些 AWS 资源，如 EC2 实例、数据库等；并在不需要的时候把它们拆掉；这篇博客文章可能适合你。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/73eee2407236489f699fd93193925f4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W1FxX_xmGtqsXrEhllyLhg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AWS CloudFormation &amp; Lambda 徽标</figcaption></figure><p id="cb69" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">出于本文的目的，我假设您熟悉 AWS 平台及其服务。以及用 Python 编码。</p><p id="5ae6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">但是让我们简单回顾一下术语和定义:</p><h2 id="ed63" class="ky kz in bd la lb lc dn ld le lf dp lg jv lh li lj jz lk ll lm kd ln lo lp lq bi translated"><strong class="ak">基础设施即代码| IaC </strong></h2><p id="9fb0" class="pw-post-body-paragraph jk jl in jm b jn lr jp jq jr ls jt ju jv lt jx jy jz lu kb kc kd lv kf kg kh ig bi translated">IaC 就是管理和供应资源和基础设施(如网络、虚拟机、负载平衡器、连接拓扑等)的过程。)通过格式化的机器可读文件——使用与<strong class="jm io"> DevOps </strong>团队使用的源代码相同的版本。</p><p id="a464" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这些基础设施的管理和供应也可以通过自动化来完成；而不是物理硬件配置或交互式配置工具。</p><p id="71ad" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">此外，这些基础设施的管理和供应被定义为代码。通过版本控制，代码变得可重用和可跟踪，并且可以根据需要轻松地更新、提炼或修改。</p><blockquote class="lw"><p id="ce0f" class="lx ly in bd lz ma mb mc md me mf kh dk translated"><strong class="ak"> Chef </strong>、<strong class="ak"> Puppet </strong>和 Ansible 都是配置管理工具，旨在安装和管理现有服务器上的软件，而【CloudFormation 和<strong class="ak"> Terraform </strong>是供应工具，旨在供应服务器本身(以及其余的基础设施，如负载平衡器、数据库、网络等)。)—资料来源:<a class="ae mg" href="https://k21academy.com/terraform-iac/why-terraform-not-chef-ansible-puppet-cloudformation/" rel="noopener ugc nofollow" target="_blank">k21academy.com</a></p></blockquote><blockquote class="mh mi mj"><p id="30e9" class="jk jl mk jm b jn ml jp jq jr mm jt ju mn mo jx jy mp mq kb kc mr ms kf kg kh ig bi translated"><strong class="jm io">云的形成</strong></p></blockquote><p id="0ca2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">AWS <strong class="jm io"> CloudFormation </strong>是一项服务，它为开发人员提供了一种创建相关 AWS 和第三方资源集合的简单方法。然后他们可以按照自己的需要或要求进行调配和管理。</p><p id="e0e0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">使用 AWS CloudFormation 涉及到使用<strong class="jm io"> <em class="mk">模板</em> </strong>和<strong class="jm io"> <em class="mk">堆栈</em> </strong>。创建一个模板来描述 AWS 资源及其属性。因此，创建了一个堆栈，然后 CloudFormation 提供模板中描述的资源。在这里了解更多<a class="ae mg" href="https://aws.amazon.com/cloudformation/faqs/" rel="noopener ugc nofollow" target="_blank"/>—<em class="mk">来源:AWS 网站。</em></p><blockquote class="mh mi mj"><p id="d466" class="jk jl mk jm b jn jo jp jq jr js jt ju mn jw jx jy mp ka kb kc mr ke kf kg kh ig bi translated"><strong class="jm io">堆栈</strong></p></blockquote><p id="227d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一个<strong class="jm io">栈</strong>是 AWS 资源的集合，可以作为一个单元来管理。堆栈中的所有资源都由堆栈的 AWS CloudFormation 模板定义。例如，堆栈可以包括运行 web 应用程序所需的所有资源，如 web 服务器、数据库和网络规则。如果您不再需要这个 web 应用程序，您可以简单地删除这个堆栈，它的所有相关资源都会被删除。CloudFormation 确保所有堆栈资源都被适当地创建或删除。在这里了解更多<a class="ae mg" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stacks.html" rel="noopener ugc nofollow" target="_blank"><strong class="jm io"><em class="mk"/></strong></a><strong class="jm io"><em class="mk">——</em></strong><em class="mk">来源:AWS 网站。</em></p><blockquote class="mh mi mj"><p id="ded1" class="jk jl mk jm b jn jo jp jq jr js jt ju mn jw jx jy mp ka kb kc mr ke kf kg kh ig bi translated"><strong class="jm io">模板——云形成模板</strong></p></blockquote><p id="8597" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一个<strong class="jm io">模板</strong>是组成堆栈的<strong class="jm io"> AWS </strong>资源的声明。<strong class="jm io">模板</strong>存储为文本文件，其格式符合 JavaScript 对象符号(JSON)或 YAML 标准。因为它们只是文本文件，所以您可以在任何文本编辑器中创建和编辑它们，并在您的源代码控制系统中使用其余的源代码来管理它们。</p><p id="2e64" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">CloudFormation 模板提供了额外的功能，可用于构建复杂的资源集。这些模板也可以在多个上下文中重用。在这里了解更多<a class="ae mg" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/gettingstarted.templatebasics.html" rel="noopener ugc nofollow" target="_blank"><strong class="jm io"><em class="mk"/></strong></a><strong class="jm io"><em class="mk">——</em></strong><em class="mk">来源:AWS 网站。</em></p><p id="d4b1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在<strong class="jm io">模板</strong>中，您声明想要创建和配置的<strong class="jm io"> AWS </strong>资源。以下是一个 Web 服务器云信息模板的示例:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Web 服务器— EC2 CF 模板</figcaption></figure></div><div class="ab cl mv mw hr mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ig ih ii ij ik"><h1 id="871e" class="nc kz in bd la nd ne nf ld ng nh ni lg nj nk nl lj nm nn no lm np nq nr lp ns bi translated">希腊字母的第 11 个</h1><p id="c116" class="pw-post-body-paragraph jk jl in jm b jn lr jp jq jr ls jt ju jv lt jx jy jz lu kb kc kd lv kf kg kh ig bi translated">AWS <strong class="jm io"> Lambda </strong>于 2014 年 11 月推出。它是一种无服务器计算服务，运行您的代码以响应事件，并自动为您管理底层计算资源。</p><p id="9170" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">您可以使用 AWS <strong class="jm io"> Lambda </strong>通过定制逻辑扩展其他 AWS 服务，或者创建自己的后端服务，在 AWS 规模、性能和安全性方面进行操作。</p><ul class=""><li id="acc4" class="nt nu in jm b jn jo jr js jv nv jz nw kd nx kh ny nz oa ob bi translated">你在 AWS Lambda 上运行的代码叫做<strong class="jm io"> <em class="mk"> Lambda 函数</em> </strong></li><li id="45e5" class="nt nu in jm b jn oc jr od jv oe jz of kd og kh ny nz oa ob bi translated">Lambda 函数是<strong class="jm io"> <em class="mk">无状态的— </em> </strong> Lambda 可以快速启动所需数量的函数副本，以适应传入事件的速率。</li></ul><p id="c2ff" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">将代码上传到 AWS Lambda 后，您可以将您的功能与特定的 AWS 资源相关联(例如，特定的亚马逊 S3 桶、亚马逊 DynamoDB 表、亚马逊 Kinesis 流或亚马逊 SNS 通知)。然后，当资源改变时，Lambda 将执行您的函数，并根据需要管理计算资源，以便跟上传入的请求。在这里了解更多<a class="ae mg" href="https://aws.amazon.com/lambda/features/" rel="noopener ugc nofollow" target="_blank"><strong class="jm io"><em class="mk"/></strong></a><strong class="jm io"><em class="mk">——</em></strong><em class="mk">来源:AWS 网站。</em></p><p id="b08c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，下面是我编写的一个 python 脚本，用于设置一个 Lambda 函数，该函数在给定模板和包含模板中定义的资源属性的其他参数的情况下部署 CloudFormation 堆栈:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="7e83" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">上面的 Lambda 函数是用两个变量建立的:</p><ul class=""><li id="df56" class="nt nu in jm b jn jo jr js jv nv jz nw kd nx kh ny nz oa ob bi translated">模板 Url</li><li id="75a7" class="nt nu in jm b jn oc jr od jv oe jz of kd og kh ny nz oa ob bi translated">参数文件</li></ul><p id="225b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这些参数是指向输入模板 URL 和参数文件的 URL。</p><p id="bf6b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果将来您想要使用不同的模板和输入参数进行测试，您可以使用 Lambda 控制台来更新 Lambda 函数的环境变量。</p><blockquote class="mh mi mj"><p id="c5fb" class="jk jl mk jm b jn jo jp jq jr js jt ju mn jw jx jy mp ka kb kc mr ke kf kg kh ig bi translated"><strong class="jm io">Lambda 函数已被授予管理员角色，允许 AWS CloudFormation 创建您的模板中定义的任何 AWS 资源。</strong></p></blockquote><p id="0467" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你想更进一步，设置一切运行在底部和从你的手机推；发布在 AWS 上的初始教程可以在这里找到:<a class="ae mg" href="https://aws.amazon.com/blogs/infrastructure-and-automation/deploy-cloudformation-stacks-at-the-click-of-a-button/" rel="noopener ugc nofollow" target="_blank">点击按钮部署 CloudFormation 堆栈</a></p><blockquote class="mh mi mj"><p id="6beb" class="jk jl mk jm b jn jo jp jq jr js jt ju mn jw jx jy mp ka kb kc mr ke kf kg kh ig bi translated"><em class="in">如果你喜欢这篇文章；你可能也喜欢</em> <a class="ae mg" href="https://blog.usejournal.com/aws-security-monitoring-services-health-status-with-python-6d5ffce790ee" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> AWS 安全:用 Python </strong> </a>监控服务健康状态</p></blockquote><blockquote class="lw"><p id="81a8" class="lx ly in bd lz ma oh oi oj ok ol kh dk translated">干杯！！！</p></blockquote></div></div>    
</body>
</html>