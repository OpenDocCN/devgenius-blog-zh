<html>
<head>
<title>Auto Updating and Resizing Map — Multiple Markers on Google Maps with Wix Velo</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自动更新和调整地图大小——使用 Wix Velo 在谷歌地图上添加多个标记</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/auto-updating-and-resizing-map-multiple-markers-on-google-maps-with-wix-velo-874b68c77483?source=collection_archive---------12-----------------------#2022-06-22">https://blog.devgenius.io/auto-updating-and-resizing-map-multiple-markers-on-google-maps-with-wix-velo-874b68c77483?source=collection_archive---------12-----------------------#2022-06-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="51b9" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">与 Wix Velo 一起冒险</h2><div class=""/><figure class="gl gn jx jy jz ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi jw"><img src="../Images/f718c66f27deb02356f7849c3c81440c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O1gne09IZhc_04D1NChoMg.jpeg"/></div></div></figure><p id="5108" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">欢迎回到我用 Wix Velo 在谷歌地图上显示多个位置系列的最后一集！</p><p id="f54f" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">我们已经完成了这个系列，从零开始建立了一个网站，我们终于准备好把它带回家了！</p><h2 id="a03e" class="lf lg iq bd lh li lj dn lk ll lm dp ln ks lo lp lq kw lr ls lt la lu lv lw iw bi translated">让我们开始吧！！！</h2><h1 id="e3d3" class="lx lg iq bd lh ly lz ma lk mb mc md ln me mf mg lq mh mi mj lt mk ml mm lw mn bi translated">我们这个系列的目标</h1><p id="29e4" class="pw-post-body-paragraph kh ki iq kj b kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ms lc ld le ij bi translated">我们这个系列的目标是建立一个网站，将多个动态地图数据点的显示完全集成到一个谷歌地图显示中。我们希望能够更新一个位置，并让它几乎立即显示在我们的网站上。如果你想了解为什么这很重要，这里是我的介绍。</p><p id="127c" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kj ja">工作示例:</strong>我们将使用的示例显示在<a class="ae mt" href="https://www.creativeappnologies.com/multi-location-maps" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="be73" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kj ja"> Github / Code Repo: </strong>对于觉得有用的人来说，这里的<a class="ae mt" href="https://github.com/jimtin/dynamic-multi-location-maps-wix-velo" rel="noopener ugc nofollow" target="_blank">是公开的 Github Repo</a>。</p><p id="a8d3" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">在这一过程中，我将分享一些关于安全性考虑的技巧，以及一些有帮助的观察，希望能为您节省大量的故障排除时间。每集的完整列表可以在每集的底部找到。</p><p id="7a5b" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">一如既往，希望这些内容有所帮助。当你花时间为一集鼓掌、订阅我的故事或使用<a class="ae mt" href="https://appnologyjames.medium.com/membership" rel="noopener">我的推荐链接</a>注册 Medium 时，这对我意味着绝对的世界。它让我知道我的故事正在帮助你❤️.</p><p id="9d26" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">尽情享受，随时在 twitter 上给我发<a class="ae mt" href="https://twitter.com/blockchainvalu1" rel="noopener ugc nofollow" target="_blank"> DM，在</a><a class="ae mt" href="https://www.linkedin.com/in/jameshinton84/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>/<a class="ae mt" href="https://github.com/jimtin" rel="noopener ugc nofollow" target="_blank">Github</a>上发表想法和评论😃</p><h1 id="8786" class="lx lg iq bd lh ly lz ma lk mb mc md ln me mf mg lq mh mi mj lt mk ml mm lw mn bi translated">在这一集中</h1><p id="99f0" class="pw-post-body-paragraph kh ki iq kj b kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ms lc ld le ij bi translated">这一集是最后一集。顶点石。一个所有事情都汇集在一起的地方。我们一起做了大量的工作，现在我们将完成它。</p><p id="9f55" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">以下是我们将要讨论的内容:</p><ol class=""><li id="144f" class="mu mv iq kj b kk kl ko kp ks mw kw mx la my le mz na nb nc bi translated">提交表单时触发地图更新</li><li id="aa90" class="mu mv iq kj b kk nd ko ne ks nf kw ng la nh le mz na nb nc bi translated">调整地图大小以确保所有位置都在框架内</li></ol><p id="ba0c" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">太棒了。</p><h1 id="eb2d" class="lx lg iq bd lh ly lz ma lk mb mc md ln me mf mg lq mh mi mj lt mk ml mm lw mn bi translated">触发地图更新</h1><p id="18a3" class="pw-post-body-paragraph kh ki iq kj b kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ms lc ld le ij bi translated">我们需要两样东西来动态更新我们的 HTML 元素。</p><ol class=""><li id="1d93" class="mu mv iq kj b kk kl ko kp ks mw kw mx la my le mz na nb nc bi translated"><strong class="kj ja">触发。</strong>我们需要一个事件来触发下一个动作的发生。</li><li id="aad1" class="mu mv iq kj b kk nd ko ne ks nf kw ng la nh le mz na nb nc bi translated"><strong class="kj ja">数据。</strong>我们需要知道要传递给 HTML 框架的数据。幸运的是，我们在之前的剧集中已经完成了所有这些工作。</li></ol><p id="c158" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">当检查我们的触发器时，我们需要考虑一些事情。</p><ol class=""><li id="b337" class="mu mv iq kj b kk kl ko kp ks mw kw mx la my le mz na nb nc bi translated">确保我们仅在信息成功输入后捕获信息<em class="ni"/></li><li id="2bcb" class="mu mv iq kj b kk nd ko ne ks nf kw ng la nh le mz na nb nc bi translated">确保每次提交新位置时，触发器只触发<em class="ni">一次</em>(否则，我们会得到一个不断刷新的地图)</li><li id="2dfa" class="mu mv iq kj b kk nd ko ne ks nf kw ng la nh le mz na nb nc bi translated">确保总是能够<em class="ni">输入新位置</em></li></ol><p id="a508" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">这意味着我们不能使用标准的触发器，如“页面加载”或“当提交按钮被按下时”。这两种选择都会违背我们的一个考虑。“页面加载”只会在页面第一次被浏览或者我们刷新整个页面时加载地图(这很麻烦)“当提交按钮被按下时”,在新条目被输入之前就有加载我们的位置的风险。虽然我们当然可以设计我们的代码流来绕过这些问题，但这很容易出错，并可能引入更多的错误。</p><p id="3587" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">幸运的是，<a class="ae mt" href="https://www.wix.com/velo/reference/wix-crm" rel="noopener ugc nofollow" target="_blank"> Wix CRM API </a>有如下功能:<code class="fe nj nk nl nm b">onWixFormSubmitted</code>。阅读这个函数的文档，我们会发现如下内容:<em class="ni">“当站点访问者单击</em> <code class="fe nj nk nl nm b"><em class="ni">WixForms</em></code> <em class="ni">元素上的 submit 按钮并且 Wix 表单被成功提交到服务器时触发的事件。”</em></p><p id="50ba" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">赢了！</p><p id="c204" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">这个优秀的小 API 函数符合我们的标准:</p><ol class=""><li id="d614" class="mu mv iq kj b kk kl ko kp ks mw kw mx la my le mz na nb nc bi translated">只有成功提交后才会触发<em class="ni"/></li><li id="cf41" class="mu mv iq kj b kk nd ko ne ks nf kw ng la nh le mz na nb nc bi translated">每次成功提交时，它触发一次</li><li id="6064" class="mu mv iq kj b kk nd ko ne ks nf kw ng la nh le mz na nb nc bi translated">这是内置在表单中的，所以<em class="ni">总是</em>可用</li></ol><p id="9922" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">记住这一点，让我们更新我们的<code class="fe nj nk nl nm b">$w.onReady</code>函数，以包含一个处理 Wix 表单提交的方法。</p><p id="f1da" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">代码如下:</p><figure class="nn no np nq gt ka"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="a64d" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">如果您正在阅读本系列教程，您可能会注意到，我们现在已经将 Wix 表单触发连接到检索位置数据的函数。</p><p id="e071" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">那有多好！</p><p id="66ac" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">如果你现在“预览”你的网站，你应该注意到你已经可以看到这个工作。</p><p id="d765" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kj ja">太酷了！</strong></p><h1 id="4901" class="lx lg iq bd lh ly lz ma lk mb mc md ln me mf mg lq mh mi mj lt mk ml mm lw mn bi translated">调整谷歌地图的大小</h1><p id="67e7" class="pw-post-body-paragraph kh ki iq kj b kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ms lc ld le ij bi translated">我们的下一个挑战是确保我们的地图总是调整大小，以包括所有的标记。</p><p id="3fa2" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">我们可以再次通读我们的文档。<a class="ae mt" href="https://developers.google.com/maps/documentation/javascript/overview" rel="noopener ugc nofollow" target="_blank">谷歌地图 Javascript API </a>有一个<a class="ae mt" href="https://developers.google.com/maps/documentation/javascript/reference/coordinates" rel="noopener ugc nofollow" target="_blank">很棒的小功能</a>叫做<code class="fe nj nk nl nm b">LatLngBounds()</code>，它是这个目的的救命稻草。</p><p id="f85b" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">它允许我们将一个位置数组传递给函数，然后要求它适应地图的边界以包含所有的位置。几乎正是我们需要的。</p><p id="2a74" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">将它添加到您的 HTML 元素代码中，直接在<code class="fe nj nk nl nm b">locations.forEach(location =&gt;</code>部分下:</p><figure class="nn no np nq gt ka"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="2128" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">在你的编辑代码上点击“更新”,就应该完成了。</p><h1 id="521c" class="lx lg iq bd lh ly lz ma lk mb mc md ln me mf mg lq mh mi mj lt mk ml mm lw mn bi translated">非常激动人心的时刻</h1><p id="70f1" class="pw-post-body-paragraph kh ki iq kj b kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ms lc ld le ij bi translated">我们已经到了一个非常激动人心的关键时刻！</p><p id="2919" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">在这一点上，如果你发布你的网站，你应该有一个功能齐全的谷歌地图，它会随着新位置的输入而更新。更好的是，你已经定制了你在地图上使用的图标。</p><p id="d41c" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">恭喜你😃</p><p id="72e6" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">以下是完整的代码文件供参考:</p><ol class=""><li id="f61b" class="mu mv iq kj b kk kl ko kp ks mw kw mx la my le mz na nb nc bi translated"><a class="ae mt" href="https://github.com/jimtin/dynamic-multi-location-maps-wix-velo" rel="noopener ugc nofollow" target="_blank"> Github 回购</a></li><li id="8d50" class="mu mv iq kj b kk nd ko ne ks nf kw ng la nh le mz na nb nc bi translated"><a class="ae mt" href="https://github.com/jimtin/dynamic-multi-location-maps-wix-velo/tree/main" rel="noopener ugc nofollow" target="_blank">父页面代码</a></li><li id="802f" class="mu mv iq kj b kk nd ko ne ks nf kw ng la nh le mz na nb nc bi translated"><a class="ae mt" href="https://github.com/jimtin/dynamic-multi-location-maps-wix-velo/blob/main/queryLastTenLocations.jsw" rel="noopener ugc nofollow" target="_blank">querylasttenlocations . jsw</a></li><li id="6d33" class="mu mv iq kj b kk nd ko ne ks nf kw ng la nh le mz na nb nc bi translated"><a class="ae mt" href="https://github.com/jimtin/dynamic-multi-location-maps-wix-velo/blob/main/htmlframe.html" rel="noopener ugc nofollow" target="_blank"> HTML 元素</a></li></ol><h1 id="a592" class="lx lg iq bd lh ly lz ma lk mb mc md ln me mf mg lq mh mi mj lt mk ml mm lw mn bi translated">更进一步</h1><p id="910a" class="pw-post-body-paragraph kh ki iq kj b kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ms lc ld le ij bi translated">从这一点来看，我们肯定可以走得更远。我们可以这样做:</p><ol class=""><li id="b09a" class="mu mv iq kj b kk kl ko kp ks mw kw mx la my le mz na nb nc bi translated">使用一些谷歌优秀的定制选项来定制地图本身的外观</li><li id="6a1f" class="mu mv iq kj b kk nd ko ne ks nf kw ng la nh le mz na nb nc bi translated">进一步定制标记，也许可以区分中点和激动人心的位置</li></ol><p id="8580" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">我相信你能想到更多，我也很想听听！</p><p id="066d" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">为什么不花点时间把它们写在下面的评论里呢？如果你在 twitter 上给我一个完整代码的截图，我也会很高兴——我会和你一起庆祝的！</p><h1 id="ac35" class="lx lg iq bd lh ly lz ma lk mb mc md ln me mf mg lq mh mi mj lt mk ml mm lw mn bi translated">结束第五集</h1><p id="7cc1" class="pw-post-body-paragraph kh ki iq kj b kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ms lc ld le ij bi translated">完成这个系列做得很好！我希望它能帮助你解决你所面临的任何挑战！</p><h2 id="1559" class="lf lg iq bd lh li lj dn lk ll lm dp ln ks lo lp lq kw lr ls lt la lu lv lw iw bi translated">剧集列表:</h2><p id="19a3" class="pw-post-body-paragraph kh ki iq kj b kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ms lc ld le ij bi translated">这一系列剧集的完整列表链接如下，帮助你快速浏览❤</p><ol class=""><li id="3b6b" class="mu mv iq kj b kk kl ko kp ks mw kw mx la my le mz na nb nc bi translated"><a class="ae mt" href="https://appnologyjames.medium.com/setting-up-our-website-multiple-markers-on-google-maps-with-wix-velo-d110a3542994" rel="noopener">建立我们的网站</a></li><li id="c00d" class="mu mv iq kj b kk nd ko ne ks nf kw ng la nh le mz na nb nc bi translated"><a class="ae mt" href="https://appnologyjames.medium.com/querying-location-collection-and-calculating-midpoint-multiple-markers-on-google-maps-with-wix-d93e3389a12a" rel="noopener">查询位置集合并计算中点</a></li><li id="b86b" class="mu mv iq kj b kk nd ko ne ks nf kw ng la nh le mz na nb nc bi translated"><a class="ae mt" href="https://appnologyjames.medium.com/displaying-map-marker-multiple-markers-on-google-maps-with-wix-velo-7a9f2209fc7a" rel="noopener">显示地图&amp;标记</a></li><li id="2cf3" class="mu mv iq kj b kk nd ko ne ks nf kw ng la nh le mz na nb nc bi translated"><a class="ae mt" href="https://appnologyjames.medium.com/html-elements-and-sending-data-multiple-markers-on-google-maps-with-wix-velo-2f4e8a6f3336" rel="noopener"> HTML 元素&amp;发送数据</a></li><li id="85d4" class="mu mv iq kj b kk nd ko ne ks nf kw ng la nh le mz na nb nc bi translated"><a class="ae mt" href="https://appnologyjames.medium.com/auto-updating-and-resizing-map-multiple-markers-on-google-maps-with-wix-velo-874b68c77483" rel="noopener">自动更新和调整地图大小</a></li></ol></div></div>    
</body>
</html>