# Node.js 最佳实践—自动化

> 原文：<https://blog.devgenius.io/node-js-best-practices-automation-bdcac9a78b69?source=collection_archive---------7----------------------->

![](img/4f06fbfcc5ee119ae27ff0fe2cf71292.png)

安迪·凯利在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

像任何类型的应用程序一样，JavaScript 应用程序也必须写得很好。

否则，我们以后会遇到各种各样的问题。

在本文中，我们将看看在编写节点应用程序时应该遵循的一些最佳实践。

# **使用 APM 产品**

APM 产品让我们发现应用程序的性能问题。

它超越了传统的监控，测量用户的体验。

它可以突出我们的应用程序中的问题的根本原因。

停机时间也可以测量。

# **创建一个维护端点**

我们可以创建一个维护端点来显示应用程序的运行状况。

此外，我们可以用它来监控我们的应用程序。

我们不想用我们的应用程序来试验我们关于他们的数据。

# **安全**

我们应该考虑许多明显与安全相关的事情。

例如，我们可以使用虚拟专用网来访问不应该暴露给公众的东西。

此外，我们应该使用 SSL/TLS 来保护商业交易。

对于存储过程和参数化查询，也应该避免 SQL 注入。

也应该避免暴露太多系统内部数据的 HTTP 头和 cookies。

# **将前端资产移出节点**

前端资产应该从我们的节点应用程序中移出，因为服务前端资产会使我们的应用程序陷入困境。

单线程模型将使这成为一个负担。

如果我们从前端提供资产，节点线程将继续忙于向用户传输文件。

它不会有太多的生产动态内容的能力。

# **几乎天天杀服务器**

几乎每天都要杀服务器。

为此，我们需要使用外部数据存储来存储应用程序的状态。

我们不能依赖本地应用程序状态。

杀死服务器会定期释放资源。

# **测量和保护内存使用量**

我们应该在应用程序中寻找内存泄漏。

这样，我们的应用程序将为其他进程释放内存。

我们必须监控它，这样我们的应用程序就不会泄漏兆字节的内存。

单节点应用程序实例的最大内存量为 1.5GB，因此提高效率是个好主意。

# **为每个日志语句分配事务 ID**

使用事务 ID 进行日志记录可以让我们跟踪应用程序经历的工作流。

由于节点应用程序的异步特性，这一点尤其重要。

有了这个 id，我们可以更容易地跟踪我们的应用程序的活动，因为它不是异步的。

# **自动检测漏洞的工具**

漏洞让攻击者攻击我们的应用程序。

对于维护的依赖关系，安全漏洞是定期修复的，所以我们应该经常更新它们，以便我们可以修补它们。

如果我们看到威胁，我们应该密切关注它们，直到它们被修复。

使用像[dependent bot](https://dependabot.com/)这样的各种工具很容易实现自动化。

# **自动化、原子化和零停机部署**

自动化、原子化和零停机部署非常重要。

这降低了每次部署的风险，因此我们可以更频繁地进行部署。

如果点击一个按钮就能完成，那么我们在做的时候就不会有压力。

原子部署使它们在出现任何问题时都很容易逆转。

我们可以用 Docker 和 CI 工具轻松做到这一点。

它们已经成为行业标准。

![](img/8eb47c1a7feb205ad6184c4c5b3a9347.png)

[亚历山大·奈特](https://unsplash.com/@agkdesign?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍照

# 结论

我们可以使用一些工具来帮助我们进行监控和部署。

此外，减轻我们的节点应用程序的负担也很重要，因为它是单线程的。