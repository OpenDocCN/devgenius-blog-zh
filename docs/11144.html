<html>
<head>
<title>startActivityForResult() and onActivityResult() methods are deprecated, what is the alternative? (Kotlin)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不推荐使用 startActivityForResult()和 onActivityResult()方法，替代方法是什么？(科特林)</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/startactivityforresult-and-onactivityresult-methods-are-deprecated-what-is-the-alternative-bb9da3dbe59d?source=collection_archive---------1-----------------------#2022-12-21">https://blog.devgenius.io/startactivityforresult-and-onactivityresult-methods-are-deprecated-what-is-the-alternative-bb9da3dbe59d?source=collection_archive---------1-----------------------#2022-12-21</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jp jq jr js gh gi paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="gh gi jo"><img src="../Images/da0b622c73ebc7a1da7dc55287fb6cc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KuMmsIegzJyTh6tNts66sg.png"/></div></div></figure><h1 id="fde6" class="jz ka in bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">AndroidX <code class="fe jk jl jm jn b">ActivityResult</code>库提供了一种更加灵活和强大的方式来启动活动并在您的 Android 应用程序中接收结果。它取代了不推荐使用的<code class="fe jk jl jm jn b">startActivityForResult()</code>和<code class="fe jk jl jm jn b">onActivityResult()</code>方法，这两个方法以前用于启动一个新的活动，并在活动结束时从该活动接收结果。</h1><p id="21bb" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">要使用 Kotlin 中的<code class="fe jk jl jm jn b">ActivityResult</code>库，您需要将它添加到 build.gradle 文件中的应用程序依赖项中:</p><pre class="lv lw lx ly gt lz jn ma bn mb mc bi"><span id="e30e" class="md ka in jn b be me mf l mg mh">dependencies {<br/>  // ...<br/>  implementation 'androidx.activity:activity:1.2.0-alpha01'<br/>  // ...<br/>}</span></pre><p id="4ec9" class="pw-post-body-paragraph kx ky in kz b la mi lc ld le mj lg lh li mk lk ll lm ml lo lp lq mm ls lt lu ig bi translated">接下来，您可以使用<code class="fe jk jl jm jn b">registerForActivityResult()</code>方法注册一个回调来接收已启动活动的结果。这个方法有两个参数:一个<code class="fe jk jl jm jn b">contract</code>和一个<code class="fe jk jl jm jn b">callback</code>。<code class="fe jk jl jm jn b">contract</code>指定您想要接收的结果的类型，而<code class="fe jk jl jm jn b">callback</code>是一个 lambda 函数，当结果返回时将调用它。</p><p id="993d" class="pw-post-body-paragraph kx ky in kz b la mi lc ld le mj lg lh li mk lk ll lm ml lo lp lq mm ls lt lu ig bi translated">例如，要开始一个活动并使用<code class="fe jk jl jm jn b">StartActivityForResult</code>契约接收结果，您可以使用下面的代码:</p><pre class="lv lw lx ly gt lz jn ma bn mb mc bi"><span id="800b" class="md ka in jn b be me mf l mg mh">val launcher = registerForActivityResult(ActivityResultContracts.StartActivityForResult()) { result -&gt;<br/>    // Handle the result here<br/>}</span></pre><p id="94b8" class="pw-post-body-paragraph kx ky in kz b la mi lc ld le mj lg lh li mk lk ll lm ml lo lp lq mm ls lt lu ig bi translated">要启动活动，您可以在<code class="fe jk jl jm jn b">ActivityResultLauncher</code>对象上使用<code class="fe jk jl jm jn b">launch()</code>方法，为您想要启动的活动传入<code class="fe jk jl jm jn b">Intent</code>:</p><pre class="lv lw lx ly gt lz jn ma bn mb mc bi"><span id="06c7" class="md ka in jn b be me mf l mg mh">val intent = Intent(this, SecondActivity::class.java)<br/>launcher.launch(intent)</span></pre><p id="464c" class="pw-post-body-paragraph kx ky in kz b la mi lc ld le mj lg lh li mk lk ll lm ml lo lp lq mm ls lt lu ig bi translated">当第二个活动完成时，结果将被传递到您用<code class="fe jk jl jm jn b">registerForActivityResult()</code>注册的回调函数。传递给回调函数的<code class="fe jk jl jm jn b">ActivityResult</code>对象包含请求代码、结果代码和第二个活动返回的数据。</p><p id="9cc1" class="pw-post-body-paragraph kx ky in kz b la mi lc ld le mj lg lh li mk lk ll lm ml lo lp lq mm ls lt lu ig bi translated">在<code class="fe jk jl jm jn b">ActivityResult</code>库中还有许多其他类型的契约可用，包括用定制数据启动活动并接收结果的契约、用片段启动结果的活动，以及用定制选项启动活动。你可以在<a class="ae mn" href="https://developer.android.com/jetpack/androidx/releases/activity" rel="noopener ugc nofollow" target="_blank"> AndroidX 活动文档</a>中找到更多关于<code class="fe jk jl jm jn b">ActivityResult</code>库的信息。</p><p id="e44c" class="pw-post-body-paragraph kx ky in kz b la mi lc ld le mj lg lh li mk lk ll lm ml lo lp lq mm ls lt lu ig bi translated">谢谢你。</p></div></div>    
</body>
</html>