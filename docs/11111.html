<html>
<head>
<title>Modify Ajax URL in DataTables (Vue/Laravel/Options API)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">修改数据表中的 Ajax URL(Vue/Laravel/Options API)</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/modify-ajax-url-in-datatables-vue-laravel-options-api-fb0a9dc90576?source=collection_archive---------8-----------------------#2022-12-19">https://blog.devgenius.io/modify-ajax-url-in-datatables-vue-laravel-options-api-fb0a9dc90576?source=collection_archive---------8-----------------------#2022-12-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d147559e8d595a6cf6064a9a93156aa7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xUOgBu1JTB3R-JUwwMST5w.jpeg"/></div></div></figure><p id="c896" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一个并不完全不正常的请求进来了，但是却难倒了我几个小时。这不是什么革命性的东西。这是我以前用不同类型的实现做过的事情，但从来没有像这样。</p><p id="963a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请求是，“我们能不能添加一个下拉列表，这样当我们选择一个选项时，它只会将这些项目加载到数据表中。我们希望首先加载所有项目，然后如果我们需要进一步缩小范围，我们希望有这种能力。”</p><p id="de79" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用 Vue/jQuery 实现这一点非常简单。事实证明，用 Options API 实现它没有那么多好处。</p><div class="kw kx gp gr ky kz"><a href="https://datatables.net/blog/2022-06-22-vue" rel="noopener  ugc nofollow" target="_blank"><div class="la ab fo"><div class="lb ab lc cl cj ld"><h2 class="bd ir gy z fp le fr fs lf fu fw ip bi translated">Vue3 组件</h2><div class="lg l"><h3 class="bd b gy z fp le fr fs lf fu fw dk translated">2022 年 11 月 11 日更新-为了与数据表 1.13 兼容，此处显示的组件已更新为…</h3></div><div class="lh l"><p class="bd b dl z fp le fr fs lf fu fw dk translated">datatables.net</p></div></div></div></a></div><p id="3f34" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">根据概述的文档，我们能够将数据表安装到我们的 Laravel/Vue 应用程序中。如果你想看的话，我写了一整篇文章。</p><div class="kw kx gp gr ky kz"><a rel="noopener  ugc nofollow" target="_blank" href="/setting-up-laravel-9-x-with-vue-js-and-datatables-the-vue-approach-fb52dfc74f36"><div class="la ab fo"><div class="lb ab lc cl cj ld"><h2 class="bd ir gy z fp le fr fs lf fu fw ip bi translated">使用 Vue.js 和数据表设置 Laravel 9.x 方法)</h2><div class="lg l"><h3 class="bd b gy z fp le fr fs lf fu fw dk translated">上次我们看了使用数据表 CDN 设置数据表。如果您阅读了数据表 Vue 文档…</h3></div><div class="lh l"><p class="bd b dl z fp le fr fs lf fu fw dk translated">blog.devgenius.io</p></div></div><div class="li l"><div class="lj l lk ll lm li ln jw kz"/></div></div></a></div><h1 id="d01c" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">代码现在是什么样子</h1><p id="da06" class="pw-post-body-paragraph jy jz iq ka b kb mm kd ke kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv ij bi translated">在我开始添加任何修改之前，这是代码的当前状态。</p><pre class="mr ms mt mu gt mv mw mx bn my mz bi"><span id="01fb" class="na lp iq mw b be nb nc l nd ne">&lt;template&gt;<br/>    &lt;div class="p-6"&gt;<br/>        &lt;DataTable<br/>            class="display"<br/>            id="datatable"<br/>            :columns="columns"<br/>            ajax="api/users"<br/>            ref="table"<br/>            :options="{<br/>                select: true,<br/>                serverSide: true,<br/>            }"<br/>        &gt;<br/>            &lt;thead&gt;<br/>            &lt;tr&gt;<br/>                &lt;th&gt;ID&lt;/th&gt;<br/>                &lt;th&gt;Name&lt;/th&gt;<br/>                &lt;th&gt;Email&lt;/th&gt;<br/>                &lt;th&gt;Action&lt;/th&gt;<br/>            &lt;/tr&gt;<br/>            &lt;/thead&gt;<br/>            &lt;tbody&gt;<br/>            &lt;/tbody&gt;<br/>        &lt;/DataTable&gt;<br/>    &lt;/div&gt;<br/>&lt;/template&gt;<br/><br/>&lt;script&gt;<br/>import DataTable from 'datatables.net-vue3'<br/>import DataTablesLib from 'datatables.net';<br/>import 'datatables.net-select';<br/><br/>DataTable.use(DataTablesLib);<br/><br/>export default {<br/>    name: 'DataTableComponent',<br/>    components: {DataTable},<br/>    data(){<br/>        return {<br/>            columns: [<br/>                {"data": "id"},<br/>                {"data": "name"},<br/>                {"data": "email"},<br/>                {"data": "action", "sortable": false},<br/>            ]<br/>        }<br/>    }<br/>}<br/>&lt;/script&gt;<br/><br/>&lt;style&gt;<br/>@import 'datatables.net-dt';<br/>&lt;/style&gt;</span></pre><p id="6ec4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它从 api 加载数据，API 只从数据库表和编辑链接返回用户。</p><figure class="mr ms mt mu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nf"><img src="../Images/c64de1e53f05b3ff895ff7dd27138a48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T954BqdzGVJWlVLYFo130Q.png"/></div></div></figure><h1 id="a7a2" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">我们需要什么</h1><p id="f7d7" class="pw-post-body-paragraph jy jz iq ka b kb mm kd ke kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv ij bi translated">读完这篇博文后，我意识到我需要使用<code class="fe ng nh ni mw b">ajax.reload()</code>或者类似的东西。我发现可以用<code class="fe ng nh ni mw b">ajax.url('api/route').load()</code>来改变数据内容。</p><p id="9705" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">文件指出:</p><pre class="mr ms mt mu gt mv mw mx bn my mz bi"><span id="263c" class="na lp iq mw b be nb nc l nd ne">let dt;<br/>const table = ref(); // This variable is used in the `ref` attribute for the component<br/> <br/>onMounted(function () {<br/>  dt = table.value.dt();<br/>});</span></pre><p id="d4da" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">他们有一个从数据表中删除一行的例子。类似的概念，我需要什么。我可以看到他们使用<code class="fe ng nh ni mw b">dt.remove</code>。我只需要用<code class="fe ng nh ni mw b">dt.ajax.url('api/route').load()</code>。</p><pre class="mr ms mt mu gt mv mw mx bn my mz bi"><span id="029b" class="na lp iq mw b be nb nc l nd ne">function remove() {<br/>  dt.rows({ selected: true }).every(function () {<br/>    let idx = data.value.indexOf(this.data());<br/>    data.value.splice(idx, 1);<br/>  });<br/>}</span></pre><p id="eef5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">整个事情中最大的问题是它是用组合 API 而不是选项 API 编写的。在 StackOverflow 甚至 DataTables 的论坛上花了一些时间才拼凑出一个答案。我将与你分享的答案。</p><p id="bd2e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">简单的测试是一个名为 Change It 的按钮，当按下该按钮时会改变 ajax 端点，并将数据重新加载到数据表中。</p><h1 id="d027" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">解决方案</h1><p id="9a7c" class="pw-post-body-paragraph jy jz iq ka b kb mm kd ke kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv ij bi translated">需要进行的修改包括:</p><ul class=""><li id="a14c" class="nj nk iq ka b kb kc kf kg kj nl kn nm kr nn kv no np nq nr bi translated">将<code class="fe ng nh ni mw b">ref() </code>替换为<code class="fe ng nh ni mw b">this.$refs</code></li><li id="6585" class="nj nk iq ka b kb ns kf nt kj nu kn nv kr nw kv no np nq nr bi translated">使用<code class="fe ng nh ni mw b">mounted()</code>方法代替<code class="fe ng nh ni mw b">onMounted()</code></li><li id="3ec3" class="nj nk iq ka b kb ns kf nt kj nu kn nv kr nw kv no np nq nr bi translated">在<code class="fe ng nh ni mw b">mounted</code>方法中，使用<code class="fe ng nh ni mw b">this.dt = this.$refs.table.dt()</code>。我在<code class="fe ng nh ni mw b">data()</code>中添加了<code class="fe ng nh ni mw b">dt</code>变量，这就是我需要使用<code class="fe ng nh ni mw b">this.dt</code>的原因。</li><li id="a851" class="nj nk iq ka b kb ns kf nt kj nu kn nv kr nw kv no np nq nr bi translated">创建一个名为 changeIt 的方法，它可以导致 url 发生变化，<code class="fe ng nh ni mw b">this.dt.ajax.url(‘api/users/user’).load()</code>。</li><li id="f007" class="nj nk iq ka b kb ns kf nt kj nu kn nv kr nw kv no np nq nr bi translated">创建一个按钮。</li></ul><p id="a313" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">代码:</p><pre class="mr ms mt mu gt mv mw mx bn my mz bi"><span id="e75f" class="na lp iq mw b be nb nc l nd ne">&lt;template&gt;<br/>    &lt;div&gt;<br/>        &lt;h1&gt;Simple table&lt;/h1&gt;<br/>        &lt;button @click="changeIt"&gt;Change It&lt;/button&gt;<br/><br/>        &lt;DataTable<br/>            class="display"<br/>            id="datatable"<br/>            :columns="columns"<br/>            ajax="api/users"<br/>            ref="table"<br/>            :options="{<br/>                select: true,<br/>                serverSide: true,<br/>            }"<br/>        &gt;<br/>            &lt;thead&gt;<br/>            &lt;tr&gt;<br/>                &lt;th&gt;ID&lt;/th&gt;<br/>                &lt;th&gt;Name&lt;/th&gt;<br/>                &lt;th&gt;Email&lt;/th&gt;<br/>                &lt;th&gt;Action&lt;/th&gt;<br/>            &lt;/tr&gt;<br/>            &lt;/thead&gt;<br/>            &lt;tbody&gt;<br/>            &lt;/tbody&gt;<br/>        &lt;/DataTable&gt;<br/>    &lt;/div&gt;<br/>&lt;/template&gt;<br/><br/>&lt;script&gt;<br/>import DataTable from 'datatables.net-vue3';<br/>import DataTablesLib from 'datatables.net';<br/>import 'datatables.net-select';<br/><br/>DataTable.use(DataTablesLib);<br/><br/>export default {<br/>    name: "DataTableComponent",<br/>    components: {DataTable},<br/>    data(){<br/>        return {<br/>            columns: [<br/>                {"data": "id"},<br/>                {"data": "name"},<br/>                {"data": "email"},<br/>                {"data": "action", "sortable": false},<br/>            ],<br/>            dt: null,<br/>        }<br/>    },<br/>    mounted() {<br/>        this.dt = this.$refs.table.dt();<br/>    },<br/>    methods: {<br/>        changeIt() {<br/>            this.dt.ajax.url('api/users/user').load();<br/>        }<br/>    }<br/>}<br/><br/>&lt;/script&gt;<br/><br/>&lt;style&gt;<br/>@import 'datatables.net-dt';<br/>&lt;/style&gt;</span></pre><p id="e5d3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">只是想我会分享这个，因为答案在网上任何地方都不清楚。</p></div><div class="ab cl nx ny hu nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="ij ik il im in"><figure class="mr ms mt mu gt jr gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/0758ce129c21ef4fec29cfb57e8121a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qULJrRG629GTKJk-.jpeg"/></div></figure><p id="8437" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Dino Cajic 目前是<a class="ae of" href="http://absolutebiotech.com/" rel="noopener ugc nofollow" target="_blank"> Absolute Biotech </a>的 IT 主管，该公司是<a class="ae of" href="https://www.lsbio.com/" rel="noopener ugc nofollow" target="_blank"> LSBio(寿命生物科学公司)</a>、<a class="ae of" href="https://absoluteantibody.com/" rel="noopener ugc nofollow" target="_blank"> Absolute Antibody </a>、<a class="ae of" href="https://www.kerafast.com/" rel="noopener ugc nofollow" target="_blank"> Kerafast </a>、<a class="ae of" href="https://everestbiotech.com/" rel="noopener ugc nofollow" target="_blank"> Everest BioTech </a>、<a class="ae of" href="https://www.nordicmubio.com/" rel="noopener ugc nofollow" target="_blank"> Nordic MUbio </a>和<a class="ae of" href="https://www.exalpha.com/" rel="noopener ugc nofollow" target="_blank"> Exalpha </a>的母公司。他还担任我的自动系统的首席执行官。他拥有计算机科学学士学位，辅修生物学，并拥有十多年的软件工程经验。他的背景包括创建企业级电子商务应用程序、执行基于研究的软件开发，以及通过写作促进知识的传播。</p><p id="c9fa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以在<a class="ae of" href="https://www.linkedin.com/in/dinocajic/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上联系他，在<a class="ae of" href="https://instagram.com/think.dino" rel="noopener ugc nofollow" target="_blank"> Instagram </a>上关注他，或者<a class="ae of" href="https://dinocajic.medium.com/subscribe" rel="noopener">订阅他的媒体出版物</a>。</p><p id="bf41" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">阅读 Dino Cajic(以及 Medium 上成千上万的其他作家)的每一个故事。你的会员费直接支持迪诺·卡吉克和你阅读的其他作家。你也可以在媒体上看到所有的故事。 </p></div></div>    
</body>
</html>