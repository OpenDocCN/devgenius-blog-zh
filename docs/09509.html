<html>
<head>
<title>Top 5 Big Data Processing Examples in Apache Beam</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Apache Beam 中五大数据处理示例</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/top-5-big-data-processing-examples-in-apache-beam-ff31100bd702?source=collection_archive---------7-----------------------#2022-08-25">https://blog.devgenius.io/top-5-big-data-processing-examples-in-apache-beam-ff31100bd702?source=collection_archive---------7-----------------------#2022-08-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="3e92" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">软件工程之旅</h2><div class=""/><div class=""><h2 id="b231" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">从 SQL 示例到 Apache Beam Java 代码</h2></div><h1 id="56bd" class="ko kp iq bd kq kr ks kt ku kv kw kx ky kf kz kg la ki lb kj lc kl ld km le lf bi translated">概观</h1><p id="2acb" class="pw-post-body-paragraph lg lh iq li b lj lk ka ll lm ln kd lo lp lq lr ls lt lu lv lw lx ly lz ma mb ij bi translated">作为软件工程师，SQL 是一种非常流行的语言，用于为应用程序从我们的后端数据库中查询数据。在这篇文章中，我想通过分享现在比较流行的数据处理，来分享一下如何用 SQL 后台学习大数据处理。我认为许多具有 SQL 背景的人可以很容易地了解使用 Apache Beam 进行大数据处理，如果需要，您可以在阅读本文之前看看这些关于 Apache 的主题，以获得基本知识:</p><ul class=""><li id="ac71" class="mc md iq li b lj me lm mf lp mg lt mh lx mi mb mj mk ml mm bi translated"><a class="ae mn" href="https://medium.com/@techisbeautiful/the-journey-to-big-data-engineering-apache-beam-overview-part-1-685e8bfefb15" rel="noopener">大数据工程之旅:Apache Beam 概述</a></li><li id="5fa6" class="mc md iq li b lj mo lm mp lp mq lt mr lx ms mb mj mk ml mm bi translated"><a class="ae mn" rel="noopener ugc nofollow" target="_blank" href="/3-must-know-approaches-to-join-datasets-in-apache-beam-934228de2d4e"> 3 必须知道在 Apache Beam 中连接数据集的方法</a></li><li id="5445" class="mc md iq li b lj mo lm mp lp mq lt mr lx ms mb mj mk ml mm bi translated"><a class="ae mn" rel="noopener ugc nofollow" target="_blank" href="/how-i-test-my-big-data-pipeline-in-apache-beam-28d2f7e6d311">我如何在 Apache Beam 中测试我的大数据管道</a></li></ul><h1 id="60b0" class="ko kp iq bd kq kr ks kt ku kv kw kx ky kf kz kg la ki lb kj lc kl ld km le lf bi translated">场景和样本数据集</h1><p id="ce52" class="pw-post-body-paragraph lg lh iq li b lj lk ka ll lm ln kd lo lp lq lr ls lt lu lv lw lx ly lz ma mb ij bi translated">我们设想我们需要一个数据库，它包含一个小型企业的关键领域。该数据库包含两个表，可以帮助我们管理商店中的产品。我们将把它们分解成结构化的表格:</p><p id="4902" class="pw-post-body-paragraph lg lh iq li b lj me ka ll lm mf kd lo lp mt lr ls lt mu lv lw lx mv lz ma mb ij bi translated"><strong class="li ja">产品表</strong>:汇集所有产品信息的表，例如产品 Id、产品名称、产品类型 Id、价格</p><p id="ed04" class="pw-post-body-paragraph lg lh iq li b lj me ka ll lm mf kd lo lp mt lr ls lt mu lv lw lx mv lz ma mb ij bi translated"><strong class="li ja">产品类型表</strong>:该表将存储产品需要的类别，如产品类型标识、产品类型名称</p><p id="61ea" class="pw-post-body-paragraph lg lh iq li b lj me ka ll lm mf kd lo lp mt lr ls lt mu lv lw lx mv lz ma mb ij bi translated">为了展示使用数据集进行测试的例子，也为了使它更具可读性，我们展示了来自两个表的数据，它们是一种相互关系表。见下文:每个表将存储信息:</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi mw"><img src="../Images/da2bcb2fc2cefcd70ff6fc2fa76129e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gzw5gHZSXB1S60kZ0hoxyA.png"/></div></div><figcaption class="ni nj gj gh gi nk nl bd b be z dk translated">抽样资料</figcaption></figure><h1 id="f743" class="ko kp iq bd kq kr ks kt ku kv kw kx ky kf kz kg la ki lb kj lc kl ld km le lf bi translated">通过 SQL 示例学习大数据</h1><p id="265a" class="pw-post-body-paragraph lg lh iq li b lj lk ka ll lm ln kd lo lp lq lr ls lt lu lv lw lx ly lz ma mb ij bi translated">现在我们将使用一些 SQL 主题，通过实现编码将它们转换成 Apache Beam</p><p id="9df6" class="pw-post-body-paragraph lg lh iq li b lj me ka ll lm mf kd lo lp mt lr ls lt mu lv lw lx mv lz ma mb ij bi translated">让我们从 sql 概念的角度来看，有一些流行的 SQL 主题，我们一直在与他们合作，或者我们曾经不时地与他们合作:</p><h2 id="8a88" class="nm kp iq bd kq nn no dn ku np nq dp ky lp nr ns la lt nt nu lc lx nv nw le iw bi translated">#1 Group By With Sum(或任何聚合函数)</h2><p id="f2cf" class="pw-post-body-paragraph lg lh iq li b lj lk ka ll lm ln kd lo lp lq lr ls lt lu lv lw lx ly lz ma mb ij bi translated">GROUP BY 语句用于将相同的数据排列到具有相同值的行组中。GROUP BY 语句通常用于聚合函数，例如 COUNT()、MAX()、SUM()、AVG()等。</p><p id="b121" class="pw-post-body-paragraph lg lh iq li b lj me ka ll lm mf kd lo lp mt lr ls lt mu lv lw lx mv lz ma mb ij bi translated">现在我们将在 SQL 和 Apache Beam 中应用 GROUP BY 查询。让我们看看，我们得到的 product 表有许多记录，其中一些记录的 ProductTypeId 列具有相同的值，但也有一些记录具有不同的值。我们将决定使用 ProductTypeId 列来根据该列对行进行分组。现在，我们再次希望获得每种产品类型的产品价格总额，我们可以使用聚合函数 SUM()对每种产品进行求和。例如:</p><p id="eafb" class="pw-post-body-paragraph lg lh iq li b lj me ka ll lm mf kd lo lp mt lr ls lt mu lv lw lx mv lz ma mb ij bi translated">SQL:</p><figure class="mx my mz na gt nb"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="2fc3" class="pw-post-body-paragraph lg lh iq li b lj me ka ll lm mf kd lo lp mt lr ls lt mu lv lw lx mv lz ma mb ij bi translated">阿帕奇波束:</p><figure class="mx my mz na gt nb"><div class="bz fp l di"><div class="nx ny l"/></div></figure><h2 id="cacc" class="nm kp iq bd kq nn no dn ku np nq dp ky lp nr ns la lt nt nu lc lx nv nw le iw bi translated">#2 选择和位置</h2><p id="7e46" class="pw-post-body-paragraph lg lh iq li b lj lk ka ll lm ln kd lo lp lq lr ls lt lu lv lw lx ly lz ma mb ij bi translated">SELECT 语句用于从表中选择某些列，它将返回一个结果表，称为结果集。</p><p id="e0a0" class="pw-post-body-paragraph lg lh iq li b lj me ka ll lm mf kd lo lp mt lr ls lt mu lv lw lx mv lz ma mb ij bi translated">除了 SELECT 语句，我们还使用 WHERE 子句来过滤记录。它用于只提取那些满足指定条件的记录。</p><p id="25b7" class="pw-post-body-paragraph lg lh iq li b lj me ka ll lm mf kd lo lp mt lr ls lt mu lv lw lx mv lz ma mb ij bi translated">在本例中，我们将使用 SELECT 语句从 product 表中检索数据，然后使用 WHERE 子句在 ProductName 列的任何位置查找以“rice”开头的任何产品。请参见下面的示例:</p><p id="3b06" class="pw-post-body-paragraph lg lh iq li b lj me ka ll lm mf kd lo lp mt lr ls lt mu lv lw lx mv lz ma mb ij bi translated">SQL:</p><figure class="mx my mz na gt nb"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="91f4" class="pw-post-body-paragraph lg lh iq li b lj me ka ll lm mf kd lo lp mt lr ls lt mu lv lw lx mv lz ma mb ij bi translated">阿帕奇波束:</p><p id="437c" class="pw-post-body-paragraph lg lh iq li b lj me ka ll lm mf kd lo lp mt lr ls lt mu lv lw lx mv lz ma mb ij bi translated">示例 1:</p><figure class="mx my mz na gt nb"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="a77e" class="pw-post-body-paragraph lg lh iq li b lj me ka ll lm mf kd lo lp mt lr ls lt mu lv lw lx mv lz ma mb ij bi translated">示例 2:</p><figure class="mx my mz na gt nb"><div class="bz fp l di"><div class="nx ny l"/></div></figure><h2 id="b048" class="nm kp iq bd kq nn no dn ku np nq dp ky lp nr ns la lt nt nu lc lx nv nw le iw bi translated">#3 加入</h2><p id="b4aa" class="pw-post-body-paragraph lg lh iq li b lj lk ka ll lm ln kd lo lp lq lr ls lt lu lv lw lx ly lz ma mb ij bi translated">有许多方法可以连接 Apache Beam。你可以阅读我写的这篇文章<a class="ae mn" rel="noopener ugc nofollow" target="_blank" href="/3-must-know-approaches-to-join-datasets-in-apache-beam-934228de2d4e"> 3 必须知道在 Apache Beam 中连接数据集的方法</a></p><h2 id="577f" class="nm kp iq bd kq nn no dn ku np nq dp ky lp nr ns la lt nt nu lc lx nv nw le iw bi translated">#4 联合并消除重复</h2><p id="17e6" class="pw-post-body-paragraph lg lh iq li b lj lk ka ll lm ln kd lo lp lq lr ls lt lu lv lw lx ly lz ma mb ij bi translated">在 SQL 中，我们使用 union 操作符，以防多个表具有相同的列，并且我们想要组合对不同表的列执行的两个或多个 select 命令的结果。</p><p id="debf" class="pw-post-body-paragraph lg lh iq li b lj me ka ll lm mf kd lo lp mt lr ls lt mu lv lw lx mv lz ma mb ij bi translated">Apache Beam 提供了 Flatten 类，该类与 SQL 中的 Union 操作符相同，因此 Flatten 可以将多个 PCollection 对象合并成一个逻辑 PCollection。</p><p id="2465" class="pw-post-body-paragraph lg lh iq li b lj me ka ll lm mf kd lo lp mt lr ls lt mu lv lw lx mv lz ma mb ij bi translated">实际上，我们有两个包含许多记录的产品表:</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi nz"><img src="../Images/ee0e458c29476d01a0d0f3ee7b7711e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qbVGYRo_SrdhV87kz589Rg.png"/></div></div><figcaption class="ni nj gj gh gi nk nl bd b be z dk translated">第一个产品表的示例数据</figcaption></figure><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi oa"><img src="../Images/e6efc12c20e3eebd632dc08afa26e8c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_WdbjuMxnQqEk5XWb8Duwg.png"/></div></div><figcaption class="ni nj gj gh gi nk nl bd b be z dk translated">第二个产品表的示例数据</figcaption></figure><p id="85d5" class="pw-post-body-paragraph lg lh iq li b lj me ka ll lm mf kd lo lp mt lr ls lt mu lv lw lx mv lz ma mb ij bi translated">现在，假设我们想将它们合并成一个数据，那么一个方便的解决方案是填充两个产品集合，基于它创建一个 PCollectionList，然后进行扁平化。除此之外，正如您从上面的数据中看到的，我们从两个表中获得了许多重复的记录，因此为了防止重复，我们需要删除，并且在两个表都有重复记录的情况下，只取表 product 2 中表示的记录。这是我们解决问题的例子:</p><p id="22a1" class="pw-post-body-paragraph lg lh iq li b lj me ka ll lm mf kd lo lp mt lr ls lt mu lv lw lx mv lz ma mb ij bi translated">SQL:</p><figure class="mx my mz na gt nb"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="07f6" class="pw-post-body-paragraph lg lh iq li b lj me ka ll lm mf kd lo lp mt lr ls lt mu lv lw lx mv lz ma mb ij bi translated">阿帕奇波束</p><figure class="mx my mz na gt nb"><div class="bz fp l di"><div class="nx ny l"/></div></figure><h2 id="d987" class="nm kp iq bd kq nn no dn ku np nq dp ky lp nr ns la lt nt nu lc lx nv nw le iw bi translated">#5 将数据分成 2 路输出:</h2><p id="f9ed" class="pw-post-body-paragraph lg lh iq li b lj lk ka ll lm ln kd lo lp lq lr ls lt lu lv lw lx ly lz ma mb ij bi translated">为了将产品分割成 2 个输出，我们将设想这样一个场景，我们将根据条件分割它们，这取决于那些产品的价格，如果产品价格大于 100 美元，可能它们将被推入输出 1，但是相反，那些价格小于或等于 100 美元的产品将被推入输出 2。</p><p id="1ece" class="pw-post-body-paragraph lg lh iq li b lj me ka ll lm mf kd lo lp mt lr ls lt mu lv lw lx mv lz ma mb ij bi translated">Apache Beam 提供了一个 Partition 类，帮助我们将一个集合中的元素分成多个输出集合。分区函数包含确定如何将输入集合的元素分成每个结果分区输出集合的逻辑。</p><p id="0279" class="pw-post-body-paragraph lg lh iq li b lj me ka ll lm mf kd lo lp mt lr ls lt mu lv lw lx mv lz ma mb ij bi translated">这是一个将产品集合分成价格组的示例:</p><figure class="mx my mz na gt nb"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="415a" class="pw-post-body-paragraph lg lh iq li b lj me ka ll lm mf kd lo lp mt lr ls lt mu lv lw lx mv lz ma mb ij bi translated"><em class="ob">注意:SQL 没有 split 函数，但如果您在大数据工程中工作，将数据分成两个或多个不同的输出数据集，您可能会多次看到这种操作。</em></p><h1 id="5407" class="ko kp iq bd kq kr ks kt ku kv kw kx ky kf kz kg la ki lb kj lc kl ld km le lf bi translated">摘要</h1><p id="d4bf" class="pw-post-body-paragraph lg lh iq li b lj lk ka ll lm ln kd lo lp lq lr ls lt lu lv lw lx ly lz ma mb ij bi translated">本文特别分享了开发中最常用的 SQL 命令，它们也在 Apache Beam 中实现。除此之外，本文还为每个 SQL 命令提供了一个简要的理论，并提供了一些例子来帮助您通过编码更容易地将 SQL 命令转换成 Apache Beam。</p></div><div class="ab cl oc od hu oe" role="separator"><span class="of bw bk og oh oi"/><span class="of bw bk og oh oi"/><span class="of bw bk og oh"/></div><div class="ij ik il im in"><p id="8bb8" class="pw-post-body-paragraph lg lh iq li b lj me ka ll lm mf kd lo lp mt lr ls lt mu lv lw lx mv lz ma mb ij bi translated"><em class="ob">如果你喜欢这篇文章，你也会喜欢我的阿帕奇光束文章:</em></p><ul class=""><li id="9044" class="mc md iq li b lj me lm mf lp mg lt mh lx mi mb mj mk ml mm bi translated"><a class="ae mn" href="https://medium.com/@techisbeautiful/the-journey-to-big-data-engineering-apache-beam-overview-part-1-685e8bfefb15" rel="noopener"> <em class="ob">大数据工程之旅:Apache Beam 概述</em> </a></li><li id="ef31" class="mc md iq li b lj mo lm mp lp mq lt mr lx ms mb mj mk ml mm bi translated"><a class="ae mn" rel="noopener ugc nofollow" target="_blank" href="/3-must-know-approaches-to-join-datasets-in-apache-beam-934228de2d4e"> <em class="ob"> 3 必须知道 Apache Beam 中连接数据集的方法</em> </a></li><li id="4295" class="mc md iq li b lj mo lm mp lp mq lt mr lx ms mb mj mk ml mm bi translated"><a class="ae mn" rel="noopener ugc nofollow" target="_blank" href="/how-i-test-my-big-data-pipeline-in-apache-beam-28d2f7e6d311"> <em class="ob">我如何在 Apache Beam 中测试我的大数据管道</em> </a></li></ul></div><div class="ab cl oc od hu oe" role="separator"><span class="of bw bk og oh oi"/><span class="of bw bk og oh oi"/><span class="of bw bk og oh"/></div><div class="ij ik il im in"><p id="1472" class="pw-post-body-paragraph lg lh iq li b lj me ka ll lm mf kd lo lp mt lr ls lt mu lv lw lx mv lz ma mb ij bi translated"><em class="ob">喜欢这篇文章？给我拿一个</em><a class="ae mn" href="https://ko-fi.com/techisbeautiful" rel="noopener ugc nofollow" target="_blank"><em class="ob">Ko-fi</em></a><em class="ob">。</em></p><p id="4f68" class="pw-post-body-paragraph lg lh iq li b lj me ka ll lm mf kd lo lp mt lr ls lt mu lv lw lx mv lz ma mb ij bi translated"><em class="ob">爱我的文字？加入我的</em> <a class="ae mn" href="https://medium.com/subscribe/@techisbeautiful" rel="noopener"> <em class="ob">邮箱列表</em> </a> <em class="ob">。</em></p><p id="e7b2" class="pw-post-body-paragraph lg lh iq li b lj me ka ll lm mf kd lo lp mt lr ls lt mu lv lw lx mv lz ma mb ij bi translated"><em class="ob">爱读书？加入</em> <a class="ae mn" href="https://medium.com/@techisbeautiful/membership" rel="noopener"> <em class="ob">中等</em> </a> <em class="ob">(如果你用这个链接，也是支持我的，因为我有来自中等的小提成)。</em></p></div></div>    
</body>
</html>