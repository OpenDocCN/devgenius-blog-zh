<html>
<head>
<title>Simple REST API with Django using TDD — Part I.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Django 使用 TDD 的简单 REST API 第一部分</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/simple-rest-api-with-django-using-tdd-part-i-579c8e71334e?source=collection_archive---------1-----------------------#2021-07-12">https://blog.devgenius.io/simple-rest-api-with-django-using-tdd-part-i-579c8e71334e?source=collection_archive---------1-----------------------#2021-07-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d7122d51b567b0f99d4e792d80a3a2f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4DhAaFebH-ST9q0w"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@gohrhyyan?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">吴礼仁</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><blockquote class="kd ke kf"><p id="73e6" class="kg kh ki kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">TDD 代表测试驱动开发，这是一个软件开发过程，依赖于在软件完全开发之前将软件需求转换为测试用例。这与先开发软件，后创建测试用例是相对的<em class="iq">。— </em>维基百科</p></blockquote><p id="159e" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">大多数独立软件开发人员——包括我在内——因为这样或那样的原因不写测试。每当我构建一个简单的 REST API 或任何应用程序时，我都认为启动 Postman 或浏览器来测试你的端点就足以让我验证功能了。</p><p id="2ace" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">在多年采用相同的软件开发方法后，我真的厌倦了相同的例行程序，尽管我不是公司的一部分——因为我认为所有这些方法和实践都是在这里进行的——作为一个思想实验，我决定稍微改变一下，看看整个周期是如何呈现的，以及可以提取出什么。</p><p id="fa20" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">作为概念验证，我们将通过 TDD 使用<strong class="kj ir"> Django </strong>和<strong class="kj ir"> Djangorestframework </strong>实现一个简单的租赁服务 REST API。请记住，这里最重要的不是内部结构或系统设计，而是方法，所以让我们深入了解一下。我还假设读者对姜戈和 DRF 很熟悉。</p><p id="990d" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">API 将由几个端点组成:</p><ul class=""><li id="4899" class="li lj iq kj b kk kl ko kp lf lk lg ll lh lm le ln lo lp lq bi translated">可出租房屋的列表视图端点</li><li id="60af" class="li lj iq kj b kk lr ko ls lf lt lg lu lh lv le ln lo lp lq bi translated">所选房屋的详细视图</li><li id="2e62" class="li lj iq kj b kk lr ko ls lf lt lg lu lh lv le ln lo lp lq bi translated">处理添加的新房屋的 Post 端点。</li></ul><p id="b224" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">首先，让我们创建我们的模型。打开您的<code class="fe lw lx ly lz b">models.py</code>文件并添加以下代码。</p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="39f5" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">这是我们完整的<code class="fe lw lx ly lz b"><strong class="kj ir">House</strong></code>模型。对于其他模型的外键引用(<code class="fe lw lx ly lz b"><strong class="kj ir">District</strong></code> &amp; <code class="fe lw lx ly lz b"><strong class="kj ir">Options</strong></code>)，不要担心，我会提供完整 git 回购的链接。我们现在感兴趣的属性是<code class="fe lw lx ly lz b"><strong class="kj ir">('title', 'price', 'description', 'status', 'furnished')</strong></code> <strong class="kj ir">。</strong></p><p id="70a9" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">进行并应用迁移，然后我们将直接进入<code class="fe lw lx ly lz b">tests.py</code>。打开文件并添加以下内容。</p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="964d" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">现在让我解释一下这是怎么回事。</p><ul class=""><li id="8c8e" class="li lj iq kj b kk kl ko kp lf lk lg ll lh lm le ln lo lp lq bi translated"><code class="fe lw lx ly lz b"><strong class="kj ir">Class ModelTest(TestCase):</strong></code>创建一个从 Django 测试用例继承而来的<code class="fe lw lx ly lz b"><strong class="kj ir">ModelTest</strong></code>测试用例。</li><li id="45a2" class="li lj iq kj b kk lr ko ls lf lt lg lu lh lv le ln lo lp lq bi translated"><code class="fe lw lx ly lz b"><strong class="kj ir">test_house_title_str():</strong></code>验证<code class="fe lw lx ly lz b"><strong class="kj ir">House</strong></code>模型的字符串表示的测试函数。我们创建一个<code class="fe lw lx ly lz b"><strong class="kj ir">House</strong></code>对象，将它存储在<code class="fe lw lx ly lz b"><strong class="kj ir">house</strong></code>变量中，然后断言该对象的字符串表示恰好等于其<code class="fe lw lx ly lz b"><strong class="kj ir">name</strong></code>属性。很简单的函数，对吧？顺便说一下，字符串表示就是你希望你的对象以字符串形式返回的值。它在你的<code class="fe lw lx ly lz b"><strong class="kj ir">models.py</strong></code>中的<code class="fe lw lx ly lz b"><strong class="kj ir">__str__()</strong></code>中定义，以防你想知道。</li><li id="701e" class="li lj iq kj b kk lr ko ls lf lt lg lu lh lv le ln lo lp lq bi translated"><code class="fe lw lx ly lz b"><strong class="kj ir">test_no_of_rooms_less_than_or_equal_to_five():</strong></code>验证房间的数量是否小于或等于 5，因为我们提到<code class="fe lw lx ly lz b"><strong class="kj ir">5</strong></code> <strong class="kj ir"> </strong>是房间的最大数量。也要尽最大努力记录你的函数用 Docstring 做了什么，这是我从来不习惯的做法，但我本能地发现自己现在记录了我的函数。</li></ul><p id="7705" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">现在使用命令:<code class="fe lw lx ly lz b"><strong class="kj ir">python manage.py test</strong></code>运行您的测试并查看结果，您的测试应该通过了。</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mg"><img src="../Images/15f4218aa44289925ad0e98f7b298ef7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*87vZ69grYlG5bLQmBK6urQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">末端的</figcaption></figure><p id="41cb" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">这就完成了我们的第一部分。在下一部分中，我们将把重点放在 API 实现上，首先从测试开始。</p><p id="d24e" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">如果有任何问题，请随时给我发电子邮件，我很乐意帮忙。</p><p id="3d88" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">干杯。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><p id="6140" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated"><strong class="kj ir"> <em class="ki">第二部分</em></strong>:<a class="ae kc" href="https://python.plainenglish.io/simple-rest-api-with-django-using-tdd-approach-part-ii-bfc03d62bdfb" rel="noopener ugc nofollow" target="_blank">https://python . plain English . io/simple-rest-API-with-django-using-TDD-approach-Part-ii-bfc 03d 62 bdfb</a></p><p id="983e" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">https://github.com/godfather68/rental-app-api<strong class="kj ir"><em class="ki">GitHub 回购:</em> </strong> <a class="ae kc" href="https://github.com/godfather68/rental-app-api" rel="noopener ugc nofollow" target="_blank"/></p></div></div>    
</body>
</html>