<html>
<head>
<title>Service Tagging in Laravel</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Laravel 中的服务标记</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/service-tagging-in-laravel-a114533eaae?source=collection_archive---------7-----------------------#2022-09-04">https://blog.devgenius.io/service-tagging-in-laravel-a114533eaae?source=collection_archive---------7-----------------------#2022-09-04</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="2aae" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">通过 Laravel 应用程序中的标记服务，将您的代码提升到新的高度。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/9e888259fbd0dc4d290714cab702ce8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JzvuNo-YpIt3Sa21"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">奥斯卡·伊尔迪兹在<a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><p id="f0e1" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">写得好的代码的一个标志是坚持可靠编程技术的开闭原则。</p><p id="bd7d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Laravel 中依赖容器的一个便利特性是用名称标记服务的<a class="ae ks" href="https://laravel.com/docs/9.x/container#tagging" rel="noopener ugc nofollow" target="_blank">能力。通过标记，可以将所有使用特定标记注册的服务注入到另一个服务中，从而允许您创建松散耦合的组件。</a></p><p id="4f61" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果您的应用程序是以模块化方式构建的，这种技术尤其有用。</p></div><div class="ab cl lp lq hr lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ig ih ii ij ik"><p id="77b1" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们假设我们在一个分成几个独立模块的大型 CRM 系统中工作。我们有员工、客户、会计和集成模块。每个模块都由一个独立的团队处理，团队成员都是出色的程序员。</p><p id="92b3" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="lw">集成团队</em>刚刚设计了允许其他模块监听来自云电子邮件服务提供商的电子邮件消息的功能。根据团队的记录，要开始接收电子邮件，模块需要创建一个服务:</p><ul class=""><li id="3fdc" class="lx ly in kv b kw kx kz la lc lz lg ma lk mb lo mc md me mf bi translated">是一个接受电子邮件有效负载的可调用函数，</li><li id="cd47" class="lx ly in kv b kw mg kz mh lc mi lg mj lk mk lo mc md me mf bi translated">在容器中标记有<code class="fe ml mm mn mo b">integrations.email_processor</code>标签。</li></ul></div><div class="ab cl lp lq hr lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ig ih ii ij ik"><p id="7738" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">你是一个来自客户团队的年轻聪明的程序员。产品所有者为您创建了一个任务，为客户保存收到的电子邮件。</p><p id="3b18" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">你已经有了一个型号<code class="fe ml mm mn mo b">CustomerEmail</code>和一个工厂。要完成这项任务，您需要从电子邮件处理器开始。</p><p id="330d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">按照另一个团队的指导方针，您已经创建了一个接受消息的 invokable。消息的格式是众所周知的，在文档中有描述:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="eb89" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">功能简洁明了:</p><ul class=""><li id="d6a9" class="lx ly in kv b kw kx kz la lc lz lg ma lk mb lo mc md me mf bi translated">接受电子邮件有效负载，</li><li id="0978" class="lx ly in kv b kw mg kz mh lc mi lg mj lk mk lo mc md me mf bi translated">如果没有找到客户的电子邮件地址，则退出，</li><li id="61cd" class="lx ly in kv b kw mg kz mh lc mi lg mj lk mk lo mc md me mf bi translated">否则创建<code class="fe ml mm mn mo b">CustomerEmail</code>对象并保存在数据库中。</li></ul><p id="25d6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在，服务需要在依赖注入容器中声明并标记:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="f9ab" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">你的任务完成了。您已经成功创建了一个服务，并对其进行了相应的标记。</p><p id="8d5e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">集成团队中负责向监听服务传播消息的假想服务可能如下所示:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="2757" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在神奇的部分，使用<code class="fe ml mm mn mo b">$app-&gt;tagged()</code>方法从容器中收集所有监听服务:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="b02e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我假设<code class="fe ml mm mn mo b">EmailPusher</code>类可以在<a class="ae ks" href="https://laravel.com/docs/9.x/artisan#generating-commands" rel="noopener ugc nofollow" target="_blank">控制台命令</a>中执行:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="25ee" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">或者使用 REST API 端点:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mp mq l"/></div></figure></div><div class="ab cl lp lq hr lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ig ih ii ij ik"><p id="3502" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">服务标记是一种有用的技术，它允许您轻松地创建松散耦合的服务。只需创建一个类并为其设置一个标签，就可以轻松地扩展功能。</p><p id="5bd0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">你怎么看，你会尝试这个功能吗？请在评论中告诉我。</p></div></div>    
</body>
</html>