<html>
<head>
<title>MySpace From Scratch — Part 4: Photo Uploads</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从零开始的 MySpace 第 4 部分:照片上传</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/myspace-from-scratch-part-4-profile-photos-audio-6ce69871669b?source=collection_archive---------6-----------------------#2021-03-19">https://blog.devgenius.io/myspace-from-scratch-part-4-profile-photos-audio-6ce69871669b?source=collection_archive---------6-----------------------#2021-03-19</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><figure class="im in gp gr io ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/568449f6292e27a594da1cd192a7e7c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BKQdQ0Kv5GSrGZAkxoHJBA.png"/></div></div></figure><div class=""/><p id="35c4" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在最后一部分，我谈到了认证。今天我们将讨论一些 MySpace 的东西，我想从照片上传开始。</p><h1 id="f01b" class="kt ku iy bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">照片上传</h1><p id="9e21" class="pw-post-body-paragraph jv jw iy jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">这将如何工作的要点是，我们将在前端有一个文件输入，这将被传递给 API，文件将被存储在一个公共的 S3 桶中。保存图像后，我们将把文件路径存储在用户模式的照片数组中。然后，在前端侧，我们将显示个人资料照片，将有一个链接，点击查看更多照片</p><p id="90dc" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx iz">前端</strong></p><p id="273d" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">前端相当简单。我们正在做一些基本的复古 myspace 风格，或尽可能接近我可以使用顺风。那么它只是一个 api 调用。但以下是步骤:</p><ol class=""><li id="31b3" class="lw lx iy jx b jy jz kc kd kg ly kk lz ko ma ks mb mc md me bi translated">文件输入</li><li id="4775" class="lw lx iy jx b jy mf kc mg kg mh kk mi ko mj ks mb mc md me bi translated">向 API 发出存储图像的请求</li><li id="29cb" class="lw lx iy jx b jy mf kc mg kg mh kk mi ko mj ks mb mc md me bi translated">显示个人资料照片</li><li id="6d0d" class="lw lx iy jx b jy mf kc mg kg mh kk mi ko mj ks mb mc md me bi translated">在“图片”页面显示图片</li></ol><p id="f067" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx iz">这是目前的情况— </strong></p><figure class="ml mm mn mo gt ip gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/526ae9d4584ae52fed7c1e156487db84.png" data-original-src="https://miro.medium.com/v2/resize:fit:490/format:webp/1*iL1s6dyhSrV-gci4l1bfOA.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">轮廓图像周围的经典方框</figcaption></figure><figure class="ml mm mn mo gt ip gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/14a2e5c89cac3d10e03780589e448639.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*74pnf3xFNNI71avND7pGWw.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">你的“照片”页面上的旧学校照片库。</figcaption></figure><p id="baef" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">下面是实现“Pics”页面和向 API 发送照片的能力的代码:</p><figure class="ml mm mn mo gt ip"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="513a" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">^这是所有这是照片上传在前端的事情。后端就有点复杂了</p><p id="c04b" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx iz">后端</strong></p><p id="9d4a" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在后端，我们需要做更多的事情</p><ol class=""><li id="482c" class="lw lx iy jx b jy jz kc kd kg ly kk lz ko ma ks mb mc md me bi translated">为用户路由创建中间件:这样我们可以将<code class="fe mw mx my mz b">user</code>附加到每个授权的请求上，使事情变得更容易</li><li id="7b53" class="lw lx iy jx b jy mf kc mg kg mh kk mi ko mj ks mb mc md me bi translated">为存储新照片创建新路线/控制器</li><li id="0db7" class="lw lx iy jx b jy mf kc mg kg mh kk mi ko mj ks mb mc md me bi translated"><code class="fe mw mx my mz b">npm install busyboy-connect</code>并使用它，以便我们可以通过请求文件</li><li id="5375" class="lw lx iy jx b jy mf kc mg kg mh kk mi ko mj ks mb mc md me bi translated">使用 AWS SDK 将照片上传到 S3</li><li id="18e6" class="lw lx iy jx b jy mf kc mg kg mh kk mi ko mj ks mb mc md me bi translated">在用户模式中存储图像数组</li></ol><p id="7604" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">**我是人，我栈溢出如何在节点流文件。这是我在那里读到的一些不同线索的组合。</p><p id="e202" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">下面是使用 busboy 处理文件的文件上传功能。我为 S3 写了一个包装器，但这不足以分享，它所做的只是让 S3 调用一个 1 liner，这样它在控制器中看起来更好。</p><p id="c44a" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">无论如何，这是后台魔术:</p><figure class="ml mm mn mo gt ip"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="41d4" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在我们可以上传照片到我们的个人资料。现在，图片数组中的第一个索引。因此，当我们想要将一张照片作为我们的“个人资料图片”时，我们只需将它移动到照片数组的前面。</p><p id="48a4" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这就是这篇文章的全部内容。在下一篇文章中，我将关注“朋友”和朋友之间的关系。请在接下来的一周中寻找答案！</p><p id="4ee5" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx iz">本系列往期文章:</strong> <br/> <a class="ae na" href="https://andyhartnett.medium.com/myspace-from-scratch-with-node-vue-part-1-18a55931ddc6?source=your_stories_page-------------------------------------" rel="noopener">第一部分—简介</a> <br/> <a class="ae na" href="https://andyhartnett.medium.com/myspace-from-scratch-part-2-setting-up-the-environment-127eb4a6e3ac?source=your_stories_page-------------------------------------" rel="noopener">第二部分—设置环境</a> <br/> <a class="ae na" href="https://andyhartnett.medium.com/myspace-from-scratch-part-3-authentication-6a48eabef24" rel="noopener">第三部分—认证</a></p><h1 id="8ddc" class="kt ku iy bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">当你在这里的时候，考虑一下在 twitter 上关注我吧！</h1></div></div>    
</body>
</html>