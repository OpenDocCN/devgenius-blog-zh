<html>
<head>
<title>How to Create an Animated Countdown Timer with Vue</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用 Vue 创建一个动画倒计时器</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/animated-countdown-timer-vue-93fc6709e03b?source=collection_archive---------15-----------------------#2022-08-17">https://blog.devgenius.io/animated-countdown-timer-vue-93fc6709e03b?source=collection_archive---------15-----------------------#2022-08-17</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/cd73e1fd21fbedcb81fba59a3f27f34f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SdTgIQCp9yOIdDgstQVd_g.png"/></div></div></figure><p id="b2d5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">计时器应用无处不在，它们都有自己独特的外观和设计。有些人选择极简设计，仅使用文本来指示剩余时间，而其他人试图通过显示缓慢减少的饼形或甚至定期播放音频来通知剩余时间，从而更加直观。</p><p id="f55a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这是我们将在本文中构建的一种计时器:</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi kt"><img src="../Images/afffe9f8874c6f05582b79838f850ca7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5cFe-XgvKaPlHzrn.gif"/></div></div></figure><p id="f0c4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">它用长度、文本和颜色来指示剩余时间，这使得它非常具有描述性。</p><p id="f3b4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们将使用 Vue，所以设置您的项目，让我们开始吧！</p><h1 id="ea95" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">创建计时器环</h1><p id="b641" class="pw-post-body-paragraph jv jw in jx b jy lw ka kb kc lx ke kf kg ly ki kj kk lz km kn ko ma kq kr ks ig bi translated">我们将从使用一个<a class="ae mb" href="https://developer.mozilla.org/pl/docs/Web/SVG/Element/svg" rel="noopener ugc nofollow" target="_blank"> svg </a>元素创建定时器环开始。它将包含一个<a class="ae mb" href="https://developer.mozilla.org/en-US/docs/Web/SVG/Element/circle" rel="noopener ugc nofollow" target="_blank"> circle </a>元素，我们将使用它来创建计时器环。这个圆将被画在<code class="fe mc md me mf b">svg</code>容器的中心，半径为 45 像素。</p><p id="16c4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">src/components/apptimer . vue</strong></p><pre class="ku kv kw kx gt mg mf mh mi aw mj bi"><span id="d6c5" class="mk kz in mf b gy ml mm l mn mo">&lt;template&gt;<br/>  &lt;div class="root"&gt;<br/>    &lt;svg class="svg" viewBox="0 0 100 100" &gt;<br/>      &lt;g class="circle"&gt;<br/>        &lt;circle class="time-elapsed-path" cx="50" cy="50" r="45" /&gt;<br/>      &lt;/g&gt;<br/>    &lt;/svg&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span></pre><p id="8ee7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们将把<code class="fe mc md me mf b">circle</code>元素包装在一个<code class="fe mc md me mf b">g</code>元素中，这样我们就能够将<code class="fe mc md me mf b">circle</code>与本教程稍后将添加的其他元素组合在一起。</p><p id="f896" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们已经创建了基本的 HTML 标记，现在让我们添加显示戒指的 CSS。</p><p id="afb0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">src/components/apptimer . vue</strong></p><pre class="ku kv kw kx gt mg mf mh mi aw mj bi"><span id="1c69" class="mk kz in mf b gy ml mm l mn mo">...<br/>&lt;style&gt;<br/>/* Sets the container's height and width */<br/>.root {<br/>  height: 300px;<br/>  width: 300px;<br/>  position: relative;<br/>}</span><span id="1205" class="mk kz in mf b gy mp mm l mn mo">/* Removes SVG styling that would hide the time label */<br/>.circle {<br/>  fill: none;<br/>  stroke: none;<br/>}</span><span id="f9c8" class="mk kz in mf b gy mp mm l mn mo">/* The SVG path that displays the timer's progress */<br/>.time-elapsed-path {<br/>  stroke-width: 7px;<br/>  stroke: #424242;<br/>}<br/>&lt;/style&gt;</span></pre><p id="7788" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们在<code class="fe mc md me mf b">App.vue</code>中注册<code class="fe mc md me mf b">AppTimer</code>组件并显示它:</p><p id="0e1d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> src/App.vue </strong></p><pre class="ku kv kw kx gt mg mf mh mi aw mj bi"><span id="d295" class="mk kz in mf b gy ml mm l mn mo">&lt;template&gt;<br/>  &lt;AppTimer /&gt;<br/>&lt;/template&gt;</span><span id="7252" class="mk kz in mf b gy mp mm l mn mo">&lt;script&gt;<br/>import AppTimer from './components/AppTimer.vue';</span><span id="bcb8" class="mk kz in mf b gy mp mm l mn mo">export default {<br/>  name: 'App',<br/>  components: {<br/>    AppTimer,<br/>  },<br/>};<br/>&lt;/script&gt;</span></pre><p id="d3d1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这就是我们现在所拥有的。只是一枚普通的戒指。让我们继续前进。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/ada30bb1a6c88416ad7d0a9f4aa2de59.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/0*dYs0VqnaBYSYlUml.png"/></div></figure><h1 id="d302" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">显示计时器标签</h1><p id="2954" class="pw-post-body-paragraph jv jw in jx b jy lw ka kb kc lx ke kf kg ly ki kj kk lz km kn ko ma kq kr ks ig bi translated">创建计时器环后要做的下一件事是显示指示剩余时间的标签。</p><p id="53b5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">src/components/apptimer . vue</strong></p><pre class="ku kv kw kx gt mg mf mh mi aw mj bi"><span id="7569" class="mk kz in mf b gy ml mm l mn mo">&lt;template&gt;<br/>  &lt;div class="root"&gt;<br/>    ...<br/>    &lt;div class="time-left-container"&gt;<br/>      &lt;span class="time-left-label"&gt;{{ timeLeftString }}&lt;/span&gt;<br/>    &lt;/div&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="d43c" class="mk kz in mf b gy mp mm l mn mo">&lt;script&gt;<br/>export default {<br/>  methods: {<br/>    padToTwo(num) {<br/>      // e.g. 4 -&gt; '04'<br/>      return String(num).padStart(2, '0');<br/>    },<br/>  },<br/>  computed: {<br/>    // e.g. timeLeft of 100 -&gt; '01:40'<br/>    timeLeftString() {<br/>      const timeLeft = this.timeLeft;<br/>      const minutes = Math.floor(timeLeft / 60);<br/>      const seconds = timeLeft % 60;<br/>      return `${this.padToTwo(minutes)}:${this.padToTwo(seconds)}`;<br/>    },<br/>    timeLeft() {<br/>      return this.limit - this.elapsed;<br/>    },<br/>  },<br/>  // Register props to be set from App.vue<br/>  props: {<br/>    elapsed: {<br/>      type: Number,<br/>      required: true,<br/>    },<br/>    limit: {<br/>      type: Number,<br/>      required: true,<br/>    },<br/>  },<br/>};<br/>&lt;/script&gt;<br/>...</span></pre><p id="b2c3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在<code class="fe mc md me mf b">AppTimer</code>有了两个道具。<code class="fe mc md me mf b">elapsed</code>属性将用于设置已经过去的时间，而<code class="fe mc md me mf b">limit</code>属性将指定总时间。</p><p id="535b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe mc md me mf b">timeLeft()</code>是一个计算属性，当<code class="fe mc md me mf b">elapsed</code>改变时将自动更新。</p><p id="e2c9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe mc md me mf b">timeLeftString()</code>是另一个计算属性，它将以<code class="fe mc md me mf b">MM:SS</code>格式返回一个字符串，指示定时器剩余时间。每当<code class="fe mc md me mf b">timeLeft()</code>改变时，其值将被更新。</p><p id="0a36" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们将下面的 CSS 添加到<code class="fe mc md me mf b">AppTimer.vue</code>，它将样式化标签并将其覆盖在计时器环的顶部:</p><p id="17b1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">src/components/apptimer . vue</strong></p><pre class="ku kv kw kx gt mg mf mh mi aw mj bi"><span id="e05f" class="mk kz in mf b gy ml mm l mn mo">...<br/>&lt;style&gt;<br/>...<br/>.time-left-container {<br/>  /* Size should be the same as that of parent container */<br/>  height: inherit;<br/>  width: inherit;</span><span id="992e" class="mk kz in mf b gy mp mm l mn mo">/* Place container on top of circle ring */<br/>  position: absolute;<br/>  top: 0;</span><span id="4cc4" class="mk kz in mf b gy mp mm l mn mo">/* Center content (label) vertically and horizontally  */<br/>  display: flex;<br/>  align-items: center;<br/>  justify-content: center;<br/>}</span><span id="a644" class="mk kz in mf b gy mp mm l mn mo">.time-left-label {<br/>  font-size: 70px;<br/>  font-family: 'Segoe UI';<br/>  color: black;<br/>}<br/>&lt;/style&gt;</span></pre><p id="402e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们从<code class="fe mc md me mf b">App.vue</code>开始设置我们创建的<code class="fe mc md me mf b">AppTimer</code>道具:</p><p id="5b63" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> src/App.vue </strong></p><pre class="ku kv kw kx gt mg mf mh mi aw mj bi"><span id="38c8" class="mk kz in mf b gy ml mm l mn mo">&lt;template&gt;<br/>  &lt;AppTimer :elapsed="0" :limit="10" /&gt;<br/>&lt;/template&gt;<br/>...</span></pre><p id="f6a9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在我们可以看到标签了。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/8873e347af6a71ff3b15aef40aef89d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/0*U3Vs1faj3MEbNn1o.png"/></div></figure><h1 id="784a" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">启用计时器倒计时</h1><p id="bb3c" class="pw-post-body-paragraph jv jw in jx b jy lw ka kb kc lx ke kf kg ly ki kj kk lz km kn ko ma kq kr ks ig bi translated">计时器如果不能倒计时就没有用了，让我们添加一些逻辑来启用这个功能。</p><p id="faee" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们将使用一个状态变量(<code class="fe mc md me mf b">timeElapsed</code>)来记录到目前为止以秒为单位的总时间。使用<code class="fe mc md me mf b">setInterval()</code>方法，我们将这个变量每 1000 毫秒(1 秒)递增 1。我们还将使用<code class="fe mc md me mf b">clearInterval()</code>方法，确保一旦所有的计时器都结束了，我们就停止常规的递增。</p><p id="1daf" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">所有这些逻辑都将包含在<code class="fe mc md me mf b">startTimer()</code>方法中。我们将在<code class="fe mc md me mf b">mounted()</code>钩子中调用<code class="fe mc md me mf b">startTimer()</code>，以便在页面加载后立即开始倒计时。</p><p id="0f2a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> src/App.vue </strong></p><pre class="ku kv kw kx gt mg mf mh mi aw mj bi"><span id="7f26" class="mk kz in mf b gy ml mm l mn mo">&lt;template&gt;<br/>  &lt;AppTimer<br/>    :elapsed="timeElapsed"<br/>    :limit="timeLimit"<br/>  /&gt;<br/>&lt;/template&gt;</span><span id="a33e" class="mk kz in mf b gy mp mm l mn mo">&lt;script&gt;<br/>import AppTimer from './components/AppTimer.vue';</span><span id="baa8" class="mk kz in mf b gy mp mm l mn mo">export default {<br/>  name: 'App',<br/>  data() {<br/>    return {<br/>      timeElapsed: 0,<br/>      timerInterval: undefined,<br/>      timeLimit: 10,<br/>    };<br/>  },<br/>  methods: {<br/>    startTimer() {<br/>      this.timerInterval = setInterval(() =&gt; {<br/>        // Stop counting when there is no more time left<br/>        if (++this.timeElapsed === this.timeLimit) {<br/>          clearInterval(this.timerInterval);<br/>        }<br/>      }, 1000);<br/>    },<br/>  },<br/>  // Start timer immediately<br/>  mounted() {<br/>    this.startTimer();<br/>  },<br/>  components: {<br/>    AppTimer,<br/>  },<br/>};<br/>&lt;/script&gt;</span></pre><p id="764c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在我们有了一个功能计时器。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/daa215d5ad0683c751c5993ceb6d4932.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/0*YITxNVNHsCTlFBI9.gif"/></div></figure><h1 id="208f" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">创建计时器进度环</h1><p id="a27d" class="pw-post-body-paragraph jv jw in jx b jy lw ka kb kc lx ke kf kg ly ki kj kk lz km kn ko ma kq kr ks ig bi translated">现在我们需要添加一个将被动画化的环来可视化剩余的时间。我们会给这个戒指一个与众不同的颜色，把它放在灰色的戒指上。久而久之它将动画显示越来越多的灰色环，直到没有剩余时间时，只有灰色环是可见的。</p><p id="3717" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们将使用一个<a class="ae mb" href="https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths" rel="noopener ugc nofollow" target="_blank">路径</a>元素创建一个环，并用 CSS 对其进行样式化:</p><p id="b02c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">src/components/apptimer . vue</strong></p><pre class="ku kv kw kx gt mg mf mh mi aw mj bi"><span id="27bb" class="mk kz in mf b gy ml mm l mn mo">&lt;template&gt;<br/>  &lt;div class="root"&gt;<br/>    &lt;svg<br/>      class="svg"<br/>      viewBox="0 0 100 100"<br/>      <br/>    &gt;<br/>      &lt;g class="circle"&gt;<br/>        ...<br/>        &lt;path<br/>          class="time-left-path"<br/>          d="<br/>            M 50, 50<br/>            m -45, 0<br/>            a 45,45 0 1,0 90,0<br/>            a 45,45 0 1,0 -90,0<br/>          "<br/>        &gt;&lt;/path&gt;<br/>      &lt;/g&gt;<br/>    &lt;/svg&gt;<br/>    ...<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="41e5" class="mk kz in mf b gy mp mm l mn mo">&lt;script&gt;<br/>...<br/>&lt;/script&gt;</span><span id="5733" class="mk kz in mf b gy mp mm l mn mo">&lt;style&gt;<br/>...<br/>.time-left-path {<br/>  /* Same thickness as the original ring */<br/>  stroke-width: 7px;</span><span id="be8a" class="mk kz in mf b gy mp mm l mn mo">/* Rounds the path endings  */<br/>  stroke-linecap: round;</span><span id="2ade" class="mk kz in mf b gy mp mm l mn mo">/* Makes sure the animation starts at the top of the circle */<br/>  transform: rotate(90deg);<br/>  transform-origin: center;</span><span id="30ac" class="mk kz in mf b gy mp mm l mn mo">/* One second aligns with the speed of the countdown timer */<br/>  transition: 1s linear all;</span><span id="dac3" class="mk kz in mf b gy mp mm l mn mo">/* Colors the ring */<br/>  stroke: blue;<br/>}</span><span id="330d" class="mk kz in mf b gy mp mm l mn mo">.svg {<br/>  /* Flips the svg and makes the animation to move left-to-right */<br/>  transform: scaleX(-1);<br/>}<br/>&lt;/style&gt;</span></pre><p id="cd1d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">所以现在这个蓝环覆盖了灰环。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/47d62a9e1f8673ada50f4d2a198a6323.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/0*fVZIRAR9t7F93Zta.png"/></div></figure><h1 id="d798" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">制作计时器进度环的动画</h1><p id="5829" class="pw-post-body-paragraph jv jw in jx b jy lw ka kb kc lx ke kf kg ly ki kj kk lz km kn ko ma kq kr ks ig bi translated">为了制作戒指的动画，我们将使用<code class="fe mc md me mf b">path</code>的<a class="ae mb" href="https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/stroke-dasharray" rel="noopener ugc nofollow" target="_blank">笔画-仪表板阵列</a>属性。</p><p id="f49e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">以下是不同<code class="fe mc md me mf b">stroke-dasharray</code>值的戒指外观:</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mu"><img src="../Images/5c9c17d65181063faaf8607a19fa56b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*dP4h3BrepCM7KWTE.png"/></div></div></figure><p id="c015" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们可以看到，将<code class="fe mc md me mf b">stroke-dasharray</code>设置为单个值会创建一个长度相同的破折号(蓝色弧线)和间隙(破折号之间的空间)的模式。<code class="fe mc md me mf b">stroke-dasharray</code>添加尽可能多的破折号，以填满路径的整个长度。</p><p id="b8ee" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">顾名思义，<code class="fe mc md me mf b">stroke-dasharray</code>也可以取多个值。让我们看看当我们指定两个时会发生什么:</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/827db40fbf7b12544a1e008ea567ae91.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/0*6Hy5hHAURdrCznGL.png"/></div></figure><p id="3f7e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">当指定两个值时，第一个值将决定虚线的长度，第二个值将决定间隙的长度。</p><p id="665c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们可以用这个行为让蓝色路径可视化剩余时间。为此，首先，让我们使用圆周长公式(<code class="fe mc md me mf b">2πr</code>)计算蓝色路径形成的圆的总长度:</p><pre class="ku kv kw kx gt mg mf mh mi aw mj bi"><span id="1199" class="mk kz in mf b gy ml mm l mn mo">Full path length = 2 x π x r = 2 x π x 45 = 282.6 ≈ 283</span></pre><p id="8f97" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">因此，为了显示路径剩余的时间，我们将指定两个值，第一个值将从<code class="fe mc md me mf b">283</code>开始并逐渐减少到<code class="fe mc md me mf b">0</code>，而第二个值将在<code class="fe mc md me mf b">283</code>保持不变。这确保了始终只有一个破折号和一个缺口，因为<code class="fe mc md me mf b">283</code>与整个路径一样长。</p><p id="f522" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">下面是第一个值改变时路径长度的变化:</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mu"><img src="../Images/19ff895c952dc8d65e28b6251eda6f8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jDjFRZgCzEG1EBaX.png"/></div></div></figure><p id="5e67" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们在代码中实现它:</p><p id="51e8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">src/components/apptimer . vue</strong></p><pre class="ku kv kw kx gt mg mf mh mi aw mj bi"><span id="e379" class="mk kz in mf b gy ml mm l mn mo">&lt;template&gt;<br/>  &lt;div class="root"&gt;<br/>    &lt;svg<br/>      class="svg"<br/>      viewBox="0 0 100 100"<br/>      <br/>    &gt;<br/>      &lt;g class="circle"&gt;<br/>        ...<br/>        &lt;path<br/>          class="time-left-path"<br/>          v-if="timeLeft &gt; 0"<br/>          d="<br/>            M 50, 50<br/>            m -45, 0<br/>            a 45,45 0 1,0 90,0<br/>            a 45,45 0 1,0 -90,0<br/>          "<br/>          :style="{ strokeDasharray }"<br/>        &gt;&lt;/path&gt;<br/>      &lt;/g&gt;<br/>    &lt;/svg&gt;<br/>    ...<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="8f8c" class="mk kz in mf b gy mp mm l mn mo">&lt;script&gt;<br/>export default {<br/>  ...<br/>  computed: {<br/>    ...<br/>    strokeDasharray() {<br/>      const radius = 45;<br/>      const totalLength = 2 * Math.PI * radius;<br/>      const timeFraction = this.timeLeft / this.limit;<br/>      const elapsedDash = Math.floor(timeFraction * totalLength);<br/>      return `${elapsedDash} ${totalLength}`;<br/>    },<br/>  },<br/>  ...<br/>};<br/>&lt;/script&gt;</span><span id="d5d4" class="mk kz in mf b gy mp mm l mn mo">&lt;style&gt;<br/>...<br/>&lt;/style&gt;</span></pre><p id="3068" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">每当剩余时间改变时，我们使用一个计算属性(<code class="fe mc md me mf b">strokeDasharray</code>)来计算<code class="fe mc md me mf b">stroke-dasharray</code>属性的新值。</p><p id="5bac" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">当没有剩余时间时，我们使用<code class="fe mc md me mf b">v-if</code>完全停止显示蓝色环。</p><p id="d7b0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在蓝色的环会随着标签移动来指示剩余时间。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/291fe6af894e8804efbebb335efc6813.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/0*QE86NfU5nES5LmFg.gif"/></div></figure><p id="193b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">不过有一个问题:如果你仔细观察，当计时器到达零时，蓝色的环会突然消失。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/23ba548d62a5c811bec3c4d85498c502.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/0*DxVpp1Xk6pghOqJX.png"/></div></figure><p id="63eb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这是因为动画持续时间设定为一秒钟。当剩余时间的值设置为零时，仍然需要一秒钟的时间来将蓝色圆环的动画设置为零。</p><p id="7279" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">要解决这个问题，我们可以使用一个公式，每过一秒钟，环的长度就会减少一个额外的量(独立于动画)。让我们修改<code class="fe mc md me mf b">AppTimer.vue</code>来做到这一点:</p><p id="ca5e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> src/AppTimer.vue </strong></p><pre class="ku kv kw kx gt mg mf mh mi aw mj bi"><span id="6790" class="mk kz in mf b gy ml mm l mn mo">&lt;template&gt;<br/>...<br/>&lt;/template&gt;</span><span id="f224" class="mk kz in mf b gy mp mm l mn mo">&lt;script&gt;<br/>export default {<br/>  ...<br/>  computed: {<br/>    ...<br/>    strokeDasharray() {<br/>      const radius = 45;<br/>      const total = 2 * Math.PI * radius;<br/>      const timeFraction = this.timeLeft / this.limit;<br/>      const adjTimeFraction = timeFraction - (1 - timeFraction) / this.limit;<br/>      const elapsedDash = Math.floor(adjTimeFraction * total);<br/>      return `${elapsedDash} ${total}`;<br/>    },<br/>  },<br/>  ...<br/>};<br/>&lt;/script&gt;</span><span id="60fa" class="mk kz in mf b gy mp mm l mn mo">&lt;style&gt;<br/>...<br/>&lt;/style&gt;</span></pre><p id="1e1a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在蓝色圆环在被<code class="fe mc md me mf b">v-if</code>移除之前被还原到末端:</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/b6d768c665f9f9016979d84fada68493.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/0*m0OmOqKGPejPy_GW.gif"/></div></figure><h1 id="8504" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">创建背景</h1><p id="bf0e" class="pw-post-body-paragraph jv jw in jx b jy lw ka kb kc lx ke kf kg ly ki kj kk lz km kn ko ma kq kr ks ig bi translated">我们已经完成了计时器，所以我们需要在后台工作。我们将在<code class="fe mc md me mf b">App.vue</code>中创建并样式化它:</p><p id="6b57" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> src/App.vue </strong></p><pre class="ku kv kw kx gt mg mf mh mi aw mj bi"><span id="2b56" class="mk kz in mf b gy ml mm l mn mo">&lt;template&gt;<br/>  &lt;div class="background"&gt;<br/>    &lt;div<br/>      class="elapsed"<br/>      :style="{ height: '100%', backgroundColor: 'blue' }"<br/>    &gt;&lt;/div&gt;<br/>  &lt;/div&gt;<br/>  &lt;AppTimer<br/>    :elapsed="timeElapsed"<br/>    :limit="timeLimit"<br/>  /&gt;<br/>&lt;/template&gt;</span><span id="afae" class="mk kz in mf b gy mp mm l mn mo">&lt;script&gt;<br/>...<br/>&lt;/script&gt;</span><span id="e082" class="mk kz in mf b gy mp mm l mn mo">&lt;style scoped&gt;<br/>.background {<br/>  height: 100%;<br/>  position: absolute;<br/>  top: 0;<br/>  width: 100%;<br/>  display: flex;<br/>  flex-direction: column;<br/>  justify-content: end;<br/>  background-color: black;<br/>}</span><span id="7137" class="mk kz in mf b gy mp mm l mn mo">.background .elapsed {<br/>  /* For the height animation */<br/>  transition: all 1s linear;<br/>}<br/>&lt;/style&gt;</span><span id="9ed7" class="mk kz in mf b gy mp mm l mn mo">&lt;style&gt;<br/>html,<br/>body,<br/>#app {<br/>  height: 100%;<br/>  margin: 0;<br/>}</span><span id="fe23" class="mk kz in mf b gy mp mm l mn mo">#app {</span><span id="d9ae" class="mk kz in mf b gy mp mm l mn mo">/* Center timer vertically and horizontally */<br/>  display: flex;<br/>  justify-content: center;<br/>  align-items: center;</span><span id="9a9e" class="mk kz in mf b gy mp mm l mn mo">position: relative;<br/>}<br/>&lt;/style&gt;</span></pre><p id="88af" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">因为我们将背景颜色设置为蓝色，所以我们需要更改计时器环和计时器标签的颜色，使它们保持可见。</p><p id="194c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们将使用白色:</p><p id="0931" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">src/components/apptimer . vue</strong></p><pre class="ku kv kw kx gt mg mf mh mi aw mj bi"><span id="fc94" class="mk kz in mf b gy ml mm l mn mo">...<br/>&lt;style&gt;<br/>...<br/>.time-left-label {<br/>  ...<br/>  color: white;<br/>}</span><span id="0895" class="mk kz in mf b gy mp mm l mn mo">.time-left-path {<br/>  ...<br/>  /* Colors the ring */<br/>  stroke: white;<br/>}<br/>...<br/>&lt;/style&gt;</span></pre><p id="2db5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们现在可以看到背景:</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mw"><img src="../Images/6727d3091bc38bf1f95a4e9946e09c9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zUc9pWwxByZQywJP.png"/></div></div></figure><h1 id="867c" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">制作背景动画</h1><p id="05c8" class="pw-post-body-paragraph jv jw in jx b jy lw ka kb kc lx ke kf kg ly ki kj kk lz km kn ko ma kq kr ks ig bi translated">背景很好看，但是只是静态的。让我们添加一些代码，以动画其高度久而久之。</p><p id="4754" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> src/App.vue </strong></p><pre class="ku kv kw kx gt mg mf mh mi aw mj bi"><span id="9456" class="mk kz in mf b gy ml mm l mn mo">&lt;template&gt;<br/>  &lt;div class="background"&gt;<br/>    &lt;div<br/>      class="elapsed"<br/>      :style="{ height: backgroundHeight, backgroundColor: 'blue' }"<br/>      v-if="timeLeft &gt; 0"<br/>    &gt;&lt;/div&gt;<br/>  &lt;/div&gt;<br/>  &lt;AppTimer<br/>    :elapsed="timeElapsed"<br/>    :limit="timeLimit"<br/>  /&gt;<br/>&lt;/template&gt;</span><span id="b2ba" class="mk kz in mf b gy mp mm l mn mo">&lt;script&gt;<br/>...<br/>export default {<br/>  ...<br/>  computed: {<br/>    timeLeft() {<br/>      return this.timeLimit - this.timeElapsed;<br/>    },<br/>    timeFraction() {<br/>      return this.timeLeft / this.timeLimit;<br/>    },<br/>    backgroundHeight() {<br/>      const timeFraction = this.timeFraction;</span><span id="2bed" class="mk kz in mf b gy mp mm l mn mo">// Adjust time fraction to prevent lag when the time left<br/>      // is 0, like we did for the time left progress ring<br/>      const adjTimeFraction =<br/>        timeFraction - (1 - timeFraction) / this.timeLimit;</span><span id="e62d" class="mk kz in mf b gy mp mm l mn mo">const height = Math.floor(adjTimeFraction * 100);</span><span id="e2a1" class="mk kz in mf b gy mp mm l mn mo">return `${height}%`;<br/>    },<br/>  },<br/>  ...<br/>};<br/>&lt;/script&gt;<br/>...</span></pre><p id="7e92" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在我们有了一个背景动画，作为剩余时间的另一个指示器。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi kt"><img src="../Images/ec5d5caac64c2ef906153b6ae1a8f6ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Le9y1kGP0eOJn0US.gif"/></div></div></figure><h1 id="1a37" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">在特定时间点更改背景颜色</h1><p id="87ef" class="pw-post-body-paragraph jv jw in jx b jy lw ka kb kc lx ke kf kg ly ki kj kk lz km kn ko ma kq kr ks ig bi translated">如果还能用颜色来表示剩余时间，那就太好了。</p><p id="dfd8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们将使用一个<code class="fe mc md me mf b">thresholds</code>数组定义背景颜色改变的时间点。倒计时开始时，背景颜色为蓝色。总时间的 50%会变成橙色，总时间的 20%会变成红色。</p><p id="1c22" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> src/components/App.vue </strong></p><pre class="ku kv kw kx gt mg mf mh mi aw mj bi"><span id="0c5e" class="mk kz in mf b gy ml mm l mn mo">...<br/>&lt;script&gt;<br/>...<br/>export default {<br/>  ...<br/>  data() {<br/>    return {<br/>      ...<br/>      thresholds: [<br/>        {<br/>          color: 'blue',<br/>          threshold: 1,<br/>        },<br/>        {<br/>          color: 'orange',<br/>          threshold: 0.5,<br/>        },<br/>        {<br/>          color: 'red',<br/>          threshold: 0.2,<br/>        },<br/>      ],<br/>    };<br/>  },<br/>  ...<br/>};<br/>&lt;/script&gt;<br/>...</span></pre><p id="9d3e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们将使用<a class="ae mb" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce" rel="noopener ugc nofollow" target="_blank"> reduce() </a>方法从<code class="fe mc md me mf b">thresholds</code>数组中获取当前时间的颜色。</p><p id="baa3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> src/components/App.vue </strong></p><pre class="ku kv kw kx gt mg mf mh mi aw mj bi"><span id="5b43" class="mk kz in mf b gy ml mm l mn mo">&lt;template&gt;<br/>  &lt;div class="background"&gt;<br/>    &lt;div<br/>      class="elapsed"<br/>      :style="{ height: backgroundHeight, backgroundColor }"<br/>      v-if="timeLeft &gt; 0"<br/>    &gt;&lt;/div&gt;<br/>  &lt;/div&gt;<br/>  ...<br/>&lt;/template&gt;</span><span id="fb29" class="mk kz in mf b gy mp mm l mn mo">&lt;script&gt;<br/>...<br/>export default {<br/>  ...<br/>  computed: {<br/>    ...<br/>    backgroundColor() {<br/>      return this.thresholds.reduce(<br/>        (color, item) =&gt;<br/>          item.threshold &gt;= this.timeFraction ? item.color : color,<br/>        undefined<br/>      );<br/>    },<br/>  },<br/>  ...<br/>};<br/>&lt;/script&gt;<br/>...</span></pre><p id="2bc6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们完事了。我们有一个功能计时器，倒计时，并以 4 种不同的方式显示还剩多少时间。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi kt"><img src="../Images/d8f58cf4d91eef88eb2ab01365209a4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*joSkJ76DMu0IIF4x.gif"/></div></div></figure><h1 id="1443" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">探索这个应用程序的源代码</h1><p id="1235" class="pw-post-body-paragraph jv jw in jx b jy lw ka kb kc lx ke kf kg ly ki kj kk lz km kn ko ma kq kr ks ig bi translated">你可以在 GitHub 上点击查看这个迷你应用<a class="ae mb" href="https://github.com/tariibaba/CB-Animated-Timer-Countdown-Vue" rel="noopener ugc nofollow" target="_blank">的完整源代码。</a></p></div><div class="ab cl mx my hr mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ig ih ii ij ik"><p id="6b8c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="ne">原载于</em><a class="ae mb" href="https://cbdev.link/00d67a" rel="noopener ugc nofollow" target="_blank"><em class="ne">codingbeautydev.com</em></a></p><h1 id="1bdd" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">JavaScript 做的每一件疯狂的事情</h1><p id="e18c" class="pw-post-body-paragraph jv jw in jx b jy lw ka kb kc lx ke kf kg ly ki kj kk lz km kn ko ma kq kr ks ig bi translated"><a class="ae mb" href="https://cbdev.link/d3c4eb" rel="noopener ugc nofollow" target="_blank">注册</a>并立即免费获得这本引人入胜的指南，了解 JavaScript 微妙的注意事项和鲜为人知的部分。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/143ee152ba78025ea8643ba5b9726a20.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*YS5Oub8REWy8vnOEqBnsyQ.png"/></div></figure></div></div>    
</body>
</html>