<html>
<head>
<title>Nuxt.js — Vuex</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Nuxt.js — Vuex</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/nuxt-js-vuex-c984c54161eb?source=collection_archive---------5-----------------------#2020-12-29">https://blog.devgenius.io/nuxt-js-vuex-c984c54161eb?source=collection_archive---------5-----------------------#2020-12-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/6be1f130036d3fc4934fa5a8cb93ea67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZoPQzoL58Nct58pB"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">由<a class="ae kc" href="https://unsplash.com/@paulgilmore_?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">保罗·吉尔摩</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="bf84" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Nuxt.js 是一个基于 Vue.js 的应用框架。</p><p id="28fa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用它来创建服务器端渲染应用和静态站点。</p><p id="392c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看如何使用 Vuex 和 Nuxt。</p><h1 id="4b0a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">激活商店</h1><p id="b55e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">Vuex 内置在 Nuxt 中。</p><p id="02ac" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以导入它并将<code class="fe me mf mg mh b">store</code>选项添加到根 Vue 实例中。</p><p id="e57b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要添加商店，我们可以写:</p><p id="d653" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">store/index.js</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="388c" class="mq lc iq mh b gy mr ms l mt mu">export const state = () =&gt; ({<br/>  counter: 0<br/>})</span><span id="cd19" class="mq lc iq mh b gy mv ms l mt mu">export const mutations = {<br/>  increment(state) {<br/>    state.counter++<br/>  }<br/>}</span></pre><p id="7102" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们为 Vuex 商店创建了一个根模块，因为代码在<code class="fe me mf mg mh b">index.js</code>文件中。</p><p id="2323" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以通过写来使用它:</p><p id="88f9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">page/counter.vue</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="02c0" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div class="container"&gt;<br/>    &lt;button @click="increment"&gt;increment&lt;/button&gt;<br/>    &lt;p&gt;{{counter}}&lt;/p&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="389d" class="mq lc iq mh b gy mv ms l mt mu">&lt;script&gt;<br/>export default {<br/>  computed: {<br/>    counter() {<br/>      return this.$store.state.counter;<br/>    },<br/>  },<br/>  methods: {<br/>    increment() {<br/>      this.$store.commit('increment');<br/>    },<br/>  },<br/>};<br/>&lt;/script&gt;</span></pre><p id="bfe1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以访问<code class="fe me mf mg mh b">this.$store</code>对象。</p><p id="da76" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">state</code>属性具有状态。</p><p id="9f32" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">而<code class="fe me mf mg mh b">commit</code>方法让我们运行一个突变。</p><p id="0358" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要创建命名空间模块，我们可以更改存储文件的名称。</p><p id="1e8f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以创建一个<code class="fe me mf mg mh b">store/counter.js</code>文件并编写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="f2c9" class="mq lc iq mh b gy mr ms l mt mu">export const state = () =&gt; ({<br/>  count: 0<br/>})</span><span id="a1a4" class="mq lc iq mh b gy mv ms l mt mu">export const mutations = {<br/>  increment(state) {<br/>    state.count++<br/>  }<br/>}</span></pre><p id="3ac1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们可以通过编写以下内容来访问<code class="fe me mf mg mh b">counter</code>模块:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="3b2a" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div class="container"&gt;<br/>    &lt;button @click="increment"&gt;increment&lt;/button&gt;<br/>    &lt;p&gt;{{count}}&lt;/p&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="fd2f" class="mq lc iq mh b gy mv ms l mt mu">&lt;script&gt;<br/>import { mapMutations } from "vuex";</span><span id="459a" class="mq lc iq mh b gy mv ms l mt mu">export default {<br/>  computed: {<br/>    count() {<br/>      return this.$store.state.counter.count;<br/>    },<br/>  },<br/>  methods: {<br/>    increment() {<br/>      this.$store.commit('counter/increment');<br/>    },<br/>  },<br/>};<br/>&lt;/script&gt;</span></pre><p id="c513" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们添加名称空间来访问状态并提交我们的操作。</p><p id="850e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以使用 Vuex 中的 map 方法将 getters、mutations 和 actions 映射到组件中的属性。</p><p id="21b8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="0b4a" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div class="container"&gt;<br/>    &lt;button @click="increment"&gt;increment&lt;/button&gt;<br/>    &lt;p&gt;{{count}}&lt;/p&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="5406" class="mq lc iq mh b gy mv ms l mt mu">&lt;script&gt;<br/>import { mapMutations } from "vuex";</span><span id="b699" class="mq lc iq mh b gy mv ms l mt mu">export default {<br/>  computed: {<br/>    count() {<br/>      return this.$store.state.counter.count;<br/>    },<br/>  },<br/>  methods: {<br/>    ...mapMutations({<br/>      increment: "counter/increment",<br/>    }),<br/>  },<br/>};<br/>&lt;/script&gt;</span></pre><p id="75ca" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">用<code class="fe me mf mg mh b">mapMutations</code>方法将我们的<code class="fe me mf mg mh b">counter/increment</code>突变映射到<code class="fe me mf mg mh b">increment</code>方法。</p><h1 id="9779" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">插件</h1><p id="00b4" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以添加 Vuex 插件到我们的 Vuex 商店。</p><p id="dde5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以通过编写以下代码将 Vuex 记录器添加到我们的应用程序中:</p><p id="d7d1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">store/index.js</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="7764" class="mq lc iq mh b gy mr ms l mt mu">import createLogger from 'vuex/dist/logger'</span><span id="beeb" class="mq lc iq mh b gy mv ms l mt mu">export const plugins = [createLogger()]</span><span id="7f4f" class="mq lc iq mh b gy mv ms l mt mu">export const state = () =&gt; ({<br/>  count: 0<br/>})</span><span id="85eb" class="mq lc iq mh b gy mv ms l mt mu">export const mutations = {<br/>  increment(state) {<br/>    state.count++<br/>  }<br/>}</span></pre><p id="cd56" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们只是导出<code class="fe me mf mg mh b">plugins</code>数组来添加我们的插件。</p><h1 id="7d24" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">nuxtServerInit 操作</h1><p id="2ff1" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated"><code class="fe me mf mg mh b">nuxtServerInit</code>动作在商店中定义。</p><p id="de9b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这可以在任何环境下运行。</p><p id="6c9c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要使用它，我们可以通过编写以下内容将其添加到我们的商店:</p><p id="7079" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">store/index.js</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="dc0c" class="mq lc iq mh b gy mr ms l mt mu">export const actions = {<br/>  nuxtServerInit({ commit }, { req }) {<br/>    commit('core/load', { foo: 'bar' })<br/>  }<br/>}</span></pre><p id="06ca" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">store/core.js</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="f94b" class="mq lc iq mh b gy mr ms l mt mu">export const state = () =&gt; ({<br/>  obj: {}<br/>})</span><span id="247b" class="mq lc iq mh b gy mv ms l mt mu">export const mutations = {<br/>  load(state, payload) {<br/>    state.obj = payload;<br/>  }<br/>}</span></pre><p id="c17e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">foo.vue</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="1196" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div class="container"&gt;{{obj}}&lt;/div&gt;<br/>&lt;/template&gt;</span><span id="f505" class="mq lc iq mh b gy mv ms l mt mu">&lt;script&gt;<br/>export default {<br/>  computed: {<br/>    obj() {<br/>      return this.$store.state.core.obj;<br/>    },<br/>  },<br/>};<br/>&lt;/script&gt;</span></pre><p id="5360" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在根模块中有<code class="fe me mf mg mh b">nuxtServerInit</code>动作。</p><p id="1ef9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它有<code class="fe me mf mg mh b">commit</code>功能让我们提交突变。</p><p id="cd3d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">req</code>是请求对象。</p><h1 id="095b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="3475" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以将 Vuex 商店添加到 Nuxt 应用程序中，只需做一些更改。</p></div></div>    
</body>
</html>