<html>
<head>
<title>Pandemic Modeling with Python: The SIR Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Python 进行疫情建模:SIR 模型</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/pandemic-modeling-with-python-the-sir-model-16b5f8348e85?source=collection_archive---------3-----------------------#2021-11-26">https://blog.devgenius.io/pandemic-modeling-with-python-the-sir-model-16b5f8348e85?source=collection_archive---------3-----------------------#2021-11-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/8272940acd4e466b323d6f2c0357ab37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VbjkMwo23X-bcozOKNKuaA.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://news.cnrs.fr/articles/covid-19-how-are-epidemic-models-designed" rel="noopener ugc nofollow" target="_blank">(图片来源)</a></figcaption></figure><p id="68cd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">数据科学家，特别是医疗保健领域的数据科学家，可能要做的事情之一是模拟我们目前正在经历的传染病、流行病或疫情的传播。模拟实际上并没有看起来那么复杂。SIR 模型是一种相当简单但有效的模型。</p><p id="5784" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">爵士模型</strong></p><p id="12c1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">SIR 在一个缩写中表示易感、感染和清除(认为痊愈)。该模型假设人口保持不变，在传播过程中的任何时间点，都有易受感染但尚未感染的人、已感染的人和已经感染的人。你还假设人群从易受感染到被感染再到被清除(康复或死亡)。</p><p id="099c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">SIR 方程式:</strong></p><p id="67dd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在任何时候，易感人群都是尚未被感染或移除的群体。假设我们从第 1 天开始，n，我们可以代表 S 人口如下:</p><p id="41e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">S=S-I-R</p><p id="8bdc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在向前看，在每一步中，我们必须从易感人群中剔除被感染的人数。现在每个被感染者可以感染 S 的一部分，这个部分用 b 来表示，这样被感染者感染的人数就是 BXS。下一步受感染的总人数将是 I x β x S(n)。因此，如果起点在 n，则在下一步 S 人口中，n+1 将表示为:</p><p id="4720" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">S(n+1) = S(n) - I(n) x β x S(n)</p><p id="c1d6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">S(n+1) = S(n) - I(n) x β x S(n)</p><p id="d92f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">保持同样的逻辑，我们可以计算下一步的恢复人数。考虑感染人群的γ分数每天恢复。所以第二天，恢复的人数会增加γ x I(n)，所以我们可以计算 R 为:</p><p id="866e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">R(n+1) = R(n) + γ x I(n)</p><p id="b55d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下一个部分是计算感染人数。这有点复杂，因为新感染的要加上，恢复的要减去。每天，I 的每个成员感染 S 的β部分，因此 I 增加 I x β x S，而 I 的γ部分恢复。</p><p id="61bb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">I(n+1) = I(n) + I x β x S(n) - γ x I(n)</p><p id="8dd6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们知道了人群是如何从 S 发展到 I 再到 R 的，我们可以绘制出一段时间内这种变化的人群类型，并预测疾病在人群中传播的过程。</p><p id="70aa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">接种疫苗</strong></p><p id="1abf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接种疫苗将保护一部分 S 人群，因此我们将他们从 S 人群中移除并添加到 R 人群中。接种疫苗的这部分人由 kvacc 代表。因此，我们可以将等式改为:</p><p id="cddc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">S(n+1)= S(n)-I(n)xβx S(n)-kv ACC x S(n)x I(n+1)</p><p id="1ed5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">= I(n)+I xβx S(n)-γx I(n)+kv ACC x S(n)</p><p id="f0c1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">用 python 编写 SIR 模型的代码 SIR 模型的目的是绘制疾病在人群中传播的过程。我们可以编写一个函数，取β、γ和人口中的人数，并绘制出在参数 days 指定的一段时间内 S、I 和 R 的每日数量。</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="8f72" class="lk ll iq lg b gy lm ln l lo lp">from matplotlib import pyplot as plt<br/>def sir(beta, gamma, population, days, kvacc=0):<br/>    plt.clf <br/>    N=population<br/>    I=[1/N]<br/>    S=[1.0-I[0]]<br/>    R=[0]<br/>    T=[0]<br/>    <br/>    for t in range(days):<br/>        s=S[t]-I[t]*beta*S[t]-kvacc*S[t]<br/>        i=I[t]+I[t]*beta*S[t]-I[t]*gamma<br/>        r=R[t]+I[t]*gamma+kvacc*S[t]<br/>        <br/>        S.append(s)<br/>        I.append(i)<br/>        R.append(r)<br/>        T.append(t+1)<br/>        <br/>    _ = plt.figure(figsize=(6,4))<br/>    plt.plot(T,S, 'green', label='Susceptible')<br/>    plt.plot(T,I, 'red', label='Infected')<br/>    plt.plot(T,R, 'black', label='Recovered')<br/>    plt.xlabel('Days')<br/>    plt.ylabel('Fraction')<br/>    plt.title('SIR Model')<br/>    plt.grid(True)</span></pre><p id="0236" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">标绘的数据 1/β代表一个感染者会继续传染他人的天数，所以如果我们说，一个感染者在传染期为 10 天，β=1/10 或 0.1。同样，如果我们说恢复需要 20 天，那么 1/γ就是 20，γ=1/20 或者γ= 0.05。我们可以绘制这个模型，想象我们有 10 万人口。我们希望显示一年或 365 天的数据。</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="1fe2" class="lk ll iq lg b gy lm ln l lo lp">sir(0.1, 0.05, 100000, 365)</span></pre><figure class="lb lc ld le gt jr gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/01f5b6286fe51de3b8f12bf695980524.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*4q2KNTtcTAU8U5Y0lMjSjA.png"/></div></figure><p id="d3d3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，疾病过程的进展受到β和γ的影响。任何加速恢复的东西都会增加γ，任何降低传染性或提供感染保护的东西都会降低β。</p><p id="457b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">疫苗接种:</strong>假设我们有一个疫苗，我们每天为 0.15%的人口接种疫苗。所以我们可以画出图表，看看是否有所不同。我们的 kvacc 是 0.0015%。</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="92a8" class="lk ll iq lg b gy lm ln l lo lp">sir(0.1, 0.05, 100000, 365, 0.0015)</span></pre><figure class="lb lc ld le gt jr gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/3c2fc7ddce9a3082c8ea50f21bd9e671.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*ERXt46NCFxilqyFETsnCdw.png"/></div></figure><p id="f9c7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可以看到这是如何“拉平”曲线并阻止峰值的。</p><p id="e9b5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">药物/治疗:</strong>假设我们想出了一种可以将恢复时间缩短一半的治疗方法。所以现在我们的γ是 1/10 或者 0.1。让我们绘制数据。</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="f91d" class="lk ll iq lg b gy lm ln l lo lp">sir(0.1, 0.06, 100000, 365, 0.0015)</span></pre><figure class="lb lc ld le gt jr gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/413bf0bd13711a0be5f047273bf646e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*lA6tDXY4tSq4XeZxyJlsiw.png"/></div></figure><p id="21c3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是一个非常基本的 SIR 模型。显然，它不能 100%适用于任何人群。该模型假设人口是静态的，但实际上，没有人口是静态的，而是动态的，人们进出人口。在 SIR 模型中可以考虑许多其他参数，如最初感染的数量、潜伏期等。但是一个基本的 SIR 模型是一个好的开始。</p></div></div>    
</body>
</html>