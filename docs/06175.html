<html>
<head>
<title>How to make a Cypress test for prefers-color-scheme: dark</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何做一个柏树测试的偏好-配色方案:黑暗</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-make-a-cypress-test-for-prefers-color-scheme-dark-42337138f727?source=collection_archive---------7-----------------------#2021-12-19">https://blog.devgenius.io/how-to-make-a-cypress-test-for-prefers-color-scheme-dark-42337138f727?source=collection_archive---------7-----------------------#2021-12-19</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/d5c3eb1e224ae68a8b28c97d5b63167c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OSoCoERmRKSY9plRyBQlhA.jpeg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">特里·维里斯迪斯在<a class="ae jz" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><p id="5758" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在页面加载之前考虑用户的偏好变得越来越重要，以提供开箱即用的最佳体验。其中一个选项是<code class="fe ky kz la lb b">prefers-color-scheme</code>的CSS <a class="ae jz" href="https://developer.mozilla.org/en-US/docs/Web/CSS/@media/prefers-color-scheme" rel="noopener ugc nofollow" target="_blank">媒体功能</a>。这可以通过操作系统或用户代理设置来设置。</p><p id="13ea" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">下面是一个如何通过CSS设置黑暗模式的例子:</p><figure class="ld le lf lg gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lc"><img src="../Images/0b812b3a59b033ee8f598804a7eb2868.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UmghPgAX-35EuM6X"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">CSS黑暗模式</figcaption></figure><p id="0323" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">作为题外话，我还有一篇关于如何在React中使用CSS变量快速设置黑暗模式的文章，点击<a class="ae jz" href="https://relatablecode.com/how-to-easily-add-dark-mode-to-a-react-app/" rel="noopener ugc nofollow" target="_blank">查看。</a></p><h1 id="4509" class="lh li in bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">柏树试验</h1><p id="9541" class="pw-post-body-paragraph ka kb in kc b kd mf kf kg kh mg kj kk kl mh kn ko kp mi kr ks kt mj kv kw kx ig bi translated"><a class="ae jz" href="https://www.cypress.io/" rel="noopener ugc nofollow" target="_blank"> Cypress </a>是一个测试框架，让开发端到端测试变得超级简单有趣！Cypress提供了一个在页面加载前设置变量的函数！我们可以用它来提前设置黑暗模式的偏好。</p><figure class="ld le lf lg gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mk"><img src="../Images/92ffe1b2f2f2bab1546a7c2738337e0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6tOjBSJl8DKtx7UE"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">赛普拉斯黑暗模式测试</figcaption></figure><p id="5cdb" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">当我们访问根页面时使用<code class="fe ky kz la lb b">onBeforeLoad</code>函数，我们可以改变与<code class="fe ky kz la lb b">matchMedia</code>函数交互时发生的事情。<a class="ae jz" href="https://developer.mozilla.org/en-US/docs/Web/API/Window/matchMedia" rel="noopener ugc nofollow" target="_blank"> matchMedia </a>是window对象上的一个方法，可以检查配色方案是否为深色。在我的应用程序中，当应用黑暗模式时，我使用一个钩子来检查这一点，因为它被设置为我的全局存储中的一个变量:</p><figure class="ld le lf lg gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mk"><img src="../Images/630c334f3b133f16289acaa797e7f435.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZwBJEy1D6PKUcn3N"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">设置黑暗模式的挂钩</figcaption></figure><p id="8e20" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">整洁！好了，Cypress测试的以下部分可以直接查看页面的不同CSS属性，以确保所有内容都被正确应用:</p><figure class="ld le lf lg gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mk"><img src="../Images/ce47d7744cf29a6fcfe1c933176e50fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EpK0PKdTWB2eEZTf"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">CSS属性的附加测试</figcaption></figure><p id="cb23" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">举个例子，这个应用是我的应用的整体包装。给它一个数据测试id，然后我测试我的黑暗模式的颜色。对于正在设置的所有不同类型的黑暗模式属性，这可以重复几次！</p><p id="49bd" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">就是这样！如果你有任何问题或任何其他测试黑暗模式的首选方法，请在下面的评论中告诉我！</p><p id="1185" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">更多内容见<a class="ae jz" href="https://relatablecode.com/" rel="noopener ugc nofollow" target="_blank">相关代码</a></p></div><div class="ab cl ml mm hr mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ig ih ii ij ik"><p id="8dc3" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="ms">原载于2021年12月19日</em><a class="ae jz" href="https://relatablecode.com/how-to-make-a-cypress-test-for-prefers-color-scheme-dark/" rel="noopener ugc nofollow" target="_blank"><em class="ms">【https://relatablecode.com】</em></a><em class="ms">。</em></p></div></div>    
</body>
</html>