<html>
<head>
<title>The Memoirs of Swift: The Enigma called Unit Testing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Swift回忆录:单元测试之谜</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/the-memoirs-of-swift-the-enigma-called-unit-testing-c800d77c8e5b?source=collection_archive---------22-----------------------#2020-07-12">https://blog.devgenius.io/the-memoirs-of-swift-the-enigma-called-unit-testing-c800d77c8e5b?source=collection_archive---------22-----------------------#2020-07-12</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/42ab5427b7aefba60063f802635c3fe6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vf2SoJiV0riUyWCQXJbsNw.jpeg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">图片来自<a class="ae jz" href="https://electrical-engineering-portal.com/4-test-instruments-most-frequently-used-by-electricians" rel="noopener ugc nofollow" target="_blank"> EEP </a></figcaption></figure><p id="cba5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我多次听到关于单元测试这一伟大探索的神话故事。我听到开发人员说“单元测试是这样的…..而单元测试就是….”<br/>我甚至曾经听说，200名全副武装的开发人员在几个世纪前接受了这项任务，没有一个人回来。然后我坐下来问我谦卑的自己“他们所说的这个术语是什么？，请把我的工资给我”。带着谷歌和一本pdf格式的书，我进入了测试的黑暗洞穴，不知道我是否会回来，这些话在我脑海中回响“如果我灭亡了，我就灭亡了”。</p><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="lc ld l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">我跳进黑暗的测试洞穴。</figcaption></figure><p id="5774" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在我告诉你我在洞穴中的发现之前，你可能想知道单元测试到底是什么，🧐.在我探索之前，我对单元测试的定义是这样的:</p><blockquote class="le"><p id="79d8" class="lf lg in bd lh li lj lk ll lm ln kx dk translated">“单元测试是邪恶的开发者创造的一个术语，让你花更多的时间在代码上，写不必要的术语，同时占用你的网飞和游戏时间。”</p></blockquote><p id="2fe2" class="pw-post-body-paragraph ka kb in kc b kd lo kf kg kh lp kj kk kl lq kn ko kp lr kr ks kt ls kv kw kx ig bi translated">我的意思是为什么测试代码明显有效😡。当应用程序已经在商店里并且运行良好时，为什么还要紧张呢？首先，软件测试人员的工作是什么💁🏿‍♂️.它在我的模拟器上运行“没人有时间做这个”。我可以继续咆哮，因为我确信无论是T4艾伦图灵还是马克扎克伯格都没有写过测试，但是我想我必须学会它，因为我希望有一天能在M onzo工作🤷🏿‍♀️".</p><p id="9c15" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在回到我的任务。黑暗中几个小时后，我看到远处有一个发光的实体。我开始问自己，这是一个神，一个人吗？这个实体会给我永生吗？它会给我我所寻找的答案吗？。随着我越走越近，我开始问自己其他问题，“嗯，这可能是一个希腊神吗？这是宙斯吗？这是哈迪斯还是奎托斯？”。由于山洞里没有手机信号，我无法给我的朋友和家人打电话，告诉他们我有多爱他们，所以我一直靠近他们。我拿出我的剑(Xcode👨🏿‍💻)向这个未知实体冲锋。至少“如果我死了，我就在战斗中死去”。突然，我被一道眩目的光击中，失去了行动能力，"我听到一个声音说，"你在找谁？"".我回答道:“我没有特别找谁，大人，我只是在寻找测试的黑暗艺术”。然后那个声音回应道:“起来吧，我的孩子，你来对地方了，因为我是库比蒂诺神，在我身上你会找到你需要知道的一切”。</p></div><div class="ab cl lt lu hr lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ig ih ii ij ik"><p id="2832" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我是不是听到你问什么是<strong class="kc io"> XCTest？</strong>。XCTest是apple提供的一个框架，用于为您的Xcode项目编写单元测试。有了这个框架，苹果可以很容易地向你的xcode项目添加测试，并执行不同的操作，比如创建测试用例、UI测试、异步测试等等。对于本文的范围，我们将把它限制在少数几件事情上。</p><h1 id="8563" class="ma mb in bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated"><strong class="ak">我们在学什么</strong></h1><ol class=""><li id="351d" class="my mz in kc b kd na kh nb kl nc kp nd kt ne kx nf ng nh ni bi translated">从一开始就将测试添加到项目中，或者添加到现有项目中</li><li id="728d" class="my mz in kc b kd nj kh nk kl nl kp nm kt nn kx nf ng nh ni bi translated">XCTestCase是什么？</li><li id="dc3d" class="my mz in kc b kd nj kh nk kl nl kp nm kt nn kx nf ng nh ni bi translated">测试断言</li><li id="27c3" class="my mz in kc b kd nj kh nk kl nl kp nm kt nn kx nf ng nh ni bi translated">测试覆盖率</li></ol><h2 id="c660" class="no mb in bd mc np nq dn mg nr ns dp mk kl nt nu mo kp nv nw ms kt nx ny mw nz bi translated">陪审团的女士们先生们，在我们开始这篇文章之前，请消毒你们的手🌚。</h2></div><div class="ab cl lt lu hr lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ig ih ii ij ik"><div class="ky kz la lb gt oa"><a href="https://github.com/m0ji/EnigmaTest" rel="noopener  ugc nofollow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd io gy z fp of fr fs og fu fw im bi translated">m0ji/EnigmaTest</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">在swift中演示单元测试的项目。创建一个帐户，为m0ji/EnigmaTest的开发做出贡献…</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">github.com</p></div></div><div class="oj l"><div class="ok l ol om on oj oo jt oa"/></div></div></a></div><h1 id="46cf" class="ma mb in bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">向Xcode项目添加测试</h1><p id="1bcd" class="pw-post-body-paragraph ka kb in kc b kd na kf kg kh nb kj kk kl op kn ko kp oq kr ks kt or kv kw kx ig bi translated">对于新的Xcode项目，它非常简单</p><ol class=""><li id="5cf0" class="my mz in kc b kd ke kh ki kl os kp ot kt ou kx nf ng nh ni bi translated">创建一个新项目，</li><li id="76c4" class="my mz in kc b kd nj kh nk kl nl kp nm kt nn kx nf ng nh ni bi translated">选择“包含单元测试”选项。</li><li id="d6f6" class="my mz in kc b kd nj kh nk kl nl kp nm kt nn kx nf ng nh ni bi translated">单击下一步，然后单击创建。</li></ol><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ov"><img src="../Images/c446abd46cdc716bf9ae0c05672066bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j2aTz1bxRUFmNYJ6HzyXlA.png"/></div></div></figure><p id="237a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为了确认你这样做是否正确，你应该在你的导航器中看到一个带有<nameofyourproject>测试的文件夹。</nameofyourproject></p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/3f3dd633e4139de1593fde043fb33c78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*o4x-NpNSLSHBwB-SUjlBYw.png"/></div></figure><p id="4755" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">对于现有项目</p><ol class=""><li id="8445" class="my mz in kc b kd ke kh ki kl os kp ot kt ou kx nf ng nh ni bi translated">从Xcode菜单中，单击文件&gt;新建&gt;目标</li><li id="c9be" class="my mz in kc b kd nj kh nk kl nl kp nm kt nn kx nf ng nh ni bi translated">从给定的模板中选择单元测试包</li><li id="0ef3" class="my mz in kc b kd nj kh nk kl nl kp nm kt nn kx nf ng nh ni bi translated">确保选择了要测试的目标(项目的名称)</li><li id="fe32" class="my mz in kc b kd nj kh nk kl nl kp nm kt nn kx nf ng nh ni bi translated">单击完成。</li></ol><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ox"><img src="../Images/b2e16d0becce934dddf81d9e98bedf2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*htr5Rj7Y483aO1eXBkKV6w.png"/></div></div></figure><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oy"><img src="../Images/0581d298067318639fb19da9a1be2a02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lEJfQ6LebtF3BO5uzA8EGw.png"/></div></div></figure><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oz"><img src="../Images/39398ab1ad60ceb408ef8824ca778ddd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-ujPXJSOiRYS8QyO4UC86w.png"/></div></div></figure><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi pa"><img src="../Images/b89836d49aad1bfa3c049e6292b7175f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D7xmjC-8D2qYr-WjsJnVAg.png"/></div></div></figure></div><div class="ab cl lt lu hr lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ig ih ii ij ik"><h1 id="3168" class="ma mb in bd mc md pb mf mg mh pc mj mk ml pd mn mo mp pe mr ms mt pf mv mw mx bi translated">XCTestCase是什么？</h1><p id="dcea" class="pw-post-body-paragraph ka kb in kc b kd na kf kg kh nb kj kk kl op kn ko kp oq kr ks kt or kv kw kx ig bi translated">XCTestCase是一个类，它为我们提供了用来编写测试用例的方法。您通常会通过创建一个新类来使用它，这个新类将是XCTestCase的子类。</p><p id="7ad5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在导航窗格中，您会看到一个包含测试文件的文件夹。打开文件时，您应该看到:</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi pg"><img src="../Images/1ba21bb05d5a35fc84675de47f4d2617.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VAPLDMilAqPmw19yTJsCFQ.png"/></div></div></figure><p id="7ee2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">默认情况下，XCTestCase附带了这些方法，也请注意我添加的编号(1，2，3)，它显示了测试运行的顺序。</p><p id="4b07" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io"> setupWithError </strong>:设置类似于viewDidLoad。这是第一个运行的方法。您通常会在这里实例化您的类，并执行所有的初始设置。</p><p id="db6c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io"> tearDownWithError </strong>:这个方法在每个测试用例完成后被调用。您通常会使用它来初始化您的实例化对象，并执行任何其他清理，就像为视图控制器定义一样。这个方法在每个测试用例之后立即运行。所以如果你有50个测试用例，这个方法也将运行50次。</p><p id="9d40" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这是你的测试用例。你可以在这里做任何你想做的测试。请记住，我们可以在您的类中有一个以上的这种方法。此外，您可以像在swift中重命名任何功能一样重命名该功能。您可以使用testLoginFailedLogic()、testNetworkRequestResponse()等。为了验证测试是否通过，你使用断言。</p><p id="c271" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">testPerformanceExample:</strong>这也是一个测试用例，但是这里的主要区别在于其中使用了<strong class="kc io"> measure </strong>方法。此方法测量代码性能。</p><p id="b533" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">菱形按钮</strong>:在屏幕左侧，你会看到一个钻石心形，实际上是一个按钮。点击它将开始测试。如果测试通过，它变成绿色，如果测试失败，它变成红色。</p><div class="ky kz la lb gt ab cb"><figure class="ph jo pi pj pk pl pm paragraph-image"><img src="../Images/6149364904ce200ad7534650d06b9fe4.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/1*_ymnRdmDOyQhMY_pLLuuRQ.png"/></figure><figure class="ph jo pn pj pk pl pm paragraph-image"><img src="../Images/5595113d47b8ea1a0fcedb3395509797.png" data-original-src="https://miro.medium.com/v2/resize:fit:572/format:webp/1*rDlB7kXGkjXA57hWshl9bw.png"/></figure><figure class="ph jo po pj pk pl pm paragraph-image"><img src="../Images/9b83c9c192d0a83972e8a2a023d04ce3.png" data-original-src="https://miro.medium.com/v2/resize:fit:532/format:webp/1*F8Hzh6XLJ8SabbycRFQJ3Q.png"/></figure></div><p id="362b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">💡照原样运行测试会通过，因为默认情况下每个测试用例都会通过。要编写一个合适的测试用例来决定成功或失败，你需要使用断言</p></div><div class="ab cl lt lu hr lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ig ih ii ij ik"><h1 id="c526" class="ma mb in bd mc md pb mf mg mh pc mj mk ml pd mn mo mp pe mr ms mt pf mv mw mx bi translated">测试断言</h1><p id="eed4" class="pw-post-body-paragraph ka kb in kc b kd na kf kg kh nb kj kk kl op kn ko kp oq kr ks kt or kv kw kx ig bi translated">为了知道一个特定的测试是通过还是失败，你使用断言。断言方法由XCTestCase类提供。为了理解断言，我们将测试这个仿形函数。</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi pp"><img src="../Images/191af363a1eafa17bfc78185f5a55a86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eGpucq8jox5UeeP41vt1Yg.png"/></div></div></figure><p id="a07d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">嗯，仔细观察这个算术函数，你会发现加法和除法的情况是不正确的🚨。如果你没有看到这一点，那么你就会明白为什么你需要写测试了🌚。我敢肯定，开发者可能急于玩<a class="ae jz" href="https://www.callofduty.com/warzone" rel="noopener ugc nofollow" target="_blank">使命召唤:战区</a>，没有耐心去完成，因为我的意思是，他/她为什么会犯这样一个愚蠢的错误💁🏿‍♂️.<br/>快进到应用程序进入应用程序商店，用户开始给出负面评价和评论，或者最差用户开始在交易进行时获得成倍的余额。哦，好吧，一旦你公司的财务部门开始发现他们拥有比平时更多的百万富翁用户或破产，你应该肯定会在第二天早上被解雇。总之，法庭上见。附注:当然是你和那个QA人员🏃🏿‍♂️.</p><p id="73b0" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">好了，回到断言！你如何避免这种尴尬？Swift为我们提供了不同的断言功能，包括:</p><pre class="ky kz la lb gt pq pr ps pt aw pu bi"><span id="d5f0" class="no mb in pr b gy pv pw l px py"><em class="pz">XCTAssert</em>(expression: Bool)<br/>// Assert that a certain expression is true. If the expression is false then the test fails ❌</span><span id="969a" class="no mb in pr b gy qa pw l px py">XCTAssertEqual(expression1: Equatable, expression2: Equatable)<br/>// Assert that expression 1 is equal to expression 2. If false you know the drill ❌</span><span id="3270" class="no mb in pr b gy qa pw l px py">XCTFail()<br/>//Assert an outright failure ❌</span><span id="6936" class="no mb in pr b gy qa pw l px py">XCTAssertNil(expression: Any?)<br/>// Assert an expression is Nil. If otherwise ❌.</span></pre><p id="f50b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在苹果XCTest文档中还有更多。现在让我们测试某个开发人员编写的灾难并保存他的工作。</p><h2 id="6a58" class="no mb in bd mc np nq dn mg nr ns dp mk kl nt nu mo kp nv nw ms kt nx ny mw nz bi translated">1)设置您的测试类</h2><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi pg"><img src="../Images/b716579925b0f8788b3e4362da01af0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9PAkPrrxmDQKiQ6zFSfuRA.png"/></div></div></figure><h2 id="ec2e" class="no mb in bd mc np nq dn mg nr ns dp mk kl nt nu mo kp nv nw ms kt nx ny mw nz bi translated">2)为减法设置您的测试用例</h2><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi qb"><img src="../Images/44182424d9cc0ff833e2dfb9101f05df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2Hw_hlO5BPVOZoa2187DBg.png"/></div></div></figure><p id="97c1" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">对于这个测试用例，我们使用了XCTAssertEqual。</p><p id="709f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">首先定义两个表达式，然后将预期结果传递给XCTAssertEqual，以确定您的测试是通过还是失败。</p><p id="bed5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">请注意，这里的命名约定是在snake的情况下🤔。在编写测试时，这通常是可以接受的，因为我们希望函数名尽可能具有描述性。</p><p id="d586" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在让我们以第一个方法为例，我们正在检查(10-5)应该是5。所以将它传递给XCTAssertEqual将决定它是否真的是5，否则测试失败。</p><p id="b8b5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这一点非常重要，因为如果将来另一个开发人员或您自己篡改了算术方法，您的测试将会失败，因此您要么重写测试以通过测试，要么撤销导致测试失败的原因。</p><p id="278c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">还要注意如何在navigator面板上测试单个测试用例😃。</p><h2 id="9b86" class="no mb in bd mc np nq dn mg nr ns dp mk kl nt nu mo kp nv nw ms kt nx ny mw nz bi translated">3)为添加设置您的测试用例</h2><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi qc"><img src="../Images/73f41d21aa1290736e275ec8b5f1fb21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ITP2H7fGF1ehpq35JwZsMw.png"/></div></div></figure><p id="c240" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">万岁，我们的测试失败了💃🏿。现在是时候挽救你的工作了。嗯，我倾向于放弃一些深刻的报价👴🏿。</p><blockquote class="qd qe qf"><p id="f746" class="ka kb pz kc b kd ke kf kg kh ki kj kk qg km kn ko qh kq kr ks qi ku kv kw kx ig bi translated">失败不是你的测试失败了多少次，而是你根本不写测试</p></blockquote><p id="72f5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">嗯，有意义吗🌚。</p><p id="5f59" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在让我们集中注意力。看方法<strong class="kc io">test _算术_加法_for_two_positive_numbers() </strong>我们可以看到它明显失败了。但是为什么呢？因为它的期望值是(10 <br/> + 5 = 15)，但在这种情况下是50！。那场灾难无法投入生产。还要注意精心制作的错误消息💁🏿‍♂️告诉开发商到底发生了什么。</p><p id="6bd4" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">像这样的测试失败将帮助我们重新评估我们的代码来解决问题。</p><h2 id="352a" class="no mb in bd mc np nq dn mg nr ns dp mk kl nt nu mo kp nv nw ms kt nx ny mw nz bi translated">测试失败时要做的三件事</h2><p id="33f1" class="pw-post-body-paragraph ka kb in kc b kd na kf kg kh nb kj kk kl op kn ko kp oq kr ks kt or kv kw kx ig bi translated"><strong class="kc io"> A) </strong>首先问问自己为什么要写这个测试，因为一个从未写过的测试是不可能失败的。完全移除它🤝。知道这一点，就知道和平😉。</p><p id="8dda" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">B)重新评估你的代码逻辑:在大多数情况下，这就是问题的来源。在这种情况下，如果您检查加法情况，您会注意到实际上执行的是乘法而不是加法。</p><pre class="ky kz la lb gt pq pr ps pt aw pu bi"><span id="c194" class="no mb in pr b gy pv pw l px py"><strong class="pr io">case</strong> .addition:</span><span id="b1a8" class="no mb in pr b gy qa pw l px py"><strong class="pr io">return</strong> expression1 * expression2 // using * instead of +</span></pre><p id="9ba7" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">C)重新评估你的测试用例逻辑:编写错误的测试用例是有可能的。如果您的断言预期10 + 5是15，但您提供了55作为预期结果，即使代码逻辑实际上是正确的，测试也会失败。</p><h2 id="25dd" class="no mb in bd mc np nq dn mg nr ns dp mk kl nt nu mo kp nv nw ms kt nx ny mw nz bi translated">仍然是断言</h2><p id="61fc" class="pw-post-body-paragraph ka kb in kc b kd na kf kg kh nb kj kk kl op kn ko kp oq kr ks kt or kv kw kx ig bi translated">让我们在算术结构中定义另外两个方法来检查一个数是奇数还是偶数。</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi qj"><img src="../Images/15927186112994241c56dc40a81bbafe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ttr6D6bU1e1hoErB8QsMsQ.png"/></div></div></figure><p id="7460" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们将使用XCTAssert和XCTAssertFalse</p><pre class="ky kz la lb gt pq pr ps pt aw pu bi"><span id="34c7" class="no mb in pr b gy pv pw l px py"><em class="pz">XCTAssert</em>(expression: Bool)<br/>// Assert that a certain expression is true. If the expression is false then the test fails ❌</span><span id="0568" class="no mb in pr b gy qa pw l px py"><em class="pz">XCTAssertFalse</em>(expression: Bool)<br/>// Assert that a certain expression is false. If the expression is true then the test fails ❌</span></pre><p id="4896" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">仔细观察isEvenNumber函数，可以明显看出逻辑是错误的。通过测试，这种错误可以被及早发现，但有一个转折！</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi qk"><img src="../Images/7be98be0dadc121ad8c791b03c413fff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rjNLjDf7HYkk1xefDhNHAQ.png"/></div></div></figure><p id="b769" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">test _ if _ number _ is _ even _ true()失败，因为我们断言偶数中的4 as应该为真，但在这种情况下它为假。</p><p id="1935" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">嗯，但也有问题，<strong class="kc io">test _ if _ number _ is _ even _ false()</strong>通过🤔。你会说是的，当然应该，但是因为11不是一个偶数。</p><p id="5edd" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">虽然这是正确的。也不是因为理想情况下两项测试都应该通过。这是因为判断数字是否为偶数的底层代码逻辑是错误的，它总是返回false。因此，在isEvenNumber方法只有一个测试用例(<strong class="kc io">test _ if _ number _ is _ even _ false()</strong>)的情况下，我们会认为一切正常。</p><p id="5190" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">💡所以我在这里想说的是，对于一个特定的逻辑，总是有不止一个测试用例，因为一个通过的测试也可能是误导性的。两个测试用例比一个要好。*智慧💆🏿‍♂️*</p></div><div class="ab cl lt lu hr lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ig ih ii ij ik"><h1 id="ed61" class="ma mb in bd mc md pb mf mg mh pc mj mk ml pd mn mo mp pe mr ms mt pf mv mw mx bi translated">测试覆盖率</h1><p id="0939" class="pw-post-body-paragraph ka kb in kc b kd na kf kg kh nb kj kk kl op kn ko kp oq kr ks kt or kv kw kx ig bi translated">简而言之，测试覆盖率是一个向你展示你的代码有多少已经被测试的指标。</p><p id="e867" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">默认情况下，Xcode不会显示测试覆盖率，所以您必须手动启用它。</p><ol class=""><li id="9be2" class="my mz in kc b kd ke kh ki kl os kp ot kt ou kx nf ng nh ni bi translated">想办法编辑方案⌥⌘U</li><li id="ba95" class="my mz in kc b kd nj kh nk kl nl kp nm kt nn kx nf ng nh ni bi translated">选择测试&gt;选项&gt;勾选代码覆盖率选项</li><li id="426c" class="my mz in kc b kd nj kh nk kl nl kp nm kt nn kx nf ng nh ni bi translated">再次运行您的测试以获得生成的报告</li><li id="905c" class="my mz in kc b kd nj kh nk kl nl kp nm kt nn kx nf ng nh ni bi translated">打开报表浏览器并选择保险</li></ol><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ql"><img src="../Images/3dfd61535f24aacc2e8bd8c669e79527.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sAhRq0_sjjpaBw9eaYv8Ng.png"/></div></div></figure><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi qm"><img src="../Images/41cfba2e807c7201bd5a988d53acc51e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e3c0ODyFXRvKBhqEolUXKw.png"/></div></div></figure><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi qn"><img src="../Images/48fda28e9add8be3d876db2768337bdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q0tojnQm4SdhajJ_qtrZ6w.png"/></div></div></figure><p id="c516" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">启用测试覆盖后，您可以打开项目中的单个文件，查看哪些部分尚未测试。</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi qo"><img src="../Images/35c84aee307faaba773bc6c735a7dfa0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LmxODub5FmyxZu4XOBvjWQ.png"/></div></div></figure><p id="4fde" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在这里，我们可以推断出isOddNumber方法、乘法和除法案例没有经过测试，因为它们以红色突出显示😭。</p><p id="9084" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">因为我们是人，我们不可能是完美的，达到100%的测试覆盖率可能并不总是可行的，这取决于你来定义标准。我想是0.5%🌚。</p></div><div class="ab cl lt lu hr lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ig ih ii ij ik"><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="qp ld l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">我相信你累了，🛌</figcaption></figure><h1 id="5914" class="ma mb in bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">结论</h1><p id="1402" class="pw-post-body-paragraph ka kb in kc b kd na kf kg kh nb kj kk kl op kn ko kp oq kr ks kt or kv kw kx ig bi translated">我们了解到:</p><ul class=""><li id="3c43" class="my mz in kc b kd ke kh ki kl os kp ot kt ou kx qq ng nh ni bi translated">单元测试是为了给你的生活增加压力而创建的，为了避免这种压力，不要写它😉</li><li id="c2cf" class="my mz in kc b kd nj kh nk kl nl kp nm kt nn kx qq ng nh ni bi translated">要在Xcode中创建单元测试，您需要子类化XCTestCase</li><li id="548d" class="my mz in kc b kd nj kh nk kl nl kp nm kt nn kx qq ng nh ni bi translated">断言用于确定测试是通过还是失败</li><li id="4d25" class="my mz in kc b kd nj kh nk kl nl kp nm kt nn kx qq ng nh ni bi translated">要访问您的项目类，您可以使用<strong class="kc io">@ testable import&lt;project name&gt;</strong>来访问您的测试类中的变量和方法</li><li id="7beb" class="my mz in kc b kd nj kh nk kl nl kp nm kt nn kx qq ng nh ni bi translated">默认情况下，所有测试用例都通过</li><li id="4e78" class="my mz in kc b kd nj kh nk kl nl kp nm kt nn kx qq ng nh ni bi translated"><strong class="kc io"> setupWithError </strong>首先运行，然后是您的<strong class="kc io">测试用例</strong>，最后是<strong class="kc io"> tearDownWithError </strong></li><li id="b2fb" class="my mz in kc b kd nj kh nk kl nl kp nm kt nn kx qq ng nh ni bi translated">测试覆盖率向您展示了您的代码已经测试了多少</li><li id="fe40" class="my mz in kc b kd nj kh nk kl nl kp nm kt nn kx qq ng nh ni bi translated">用两个或更多的测试用例来测试你的代码逻辑比一个要好</li></ul></div><div class="ab cl lt lu hr lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ig ih ii ij ik"><p id="7291" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">因此，在与库比蒂诺神XCTest一起在洞穴里呆了50天50夜之后，除了用0和1装饰的振动什么也没吃，我胜利了🎉。</p><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="qr ld l"/></div></figure><p id="3881" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">找我吗，🕵🏿‍♂️?你可以通过<a class="ae jz" href="https://twitter.com/_m0jisola" rel="noopener ugc nofollow" target="_blank"> Twitter </a>或<a class="ae jz" href="http://linkedin.com/in/adebiyi-mojisola-674034144" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>联系我。</p><p id="940c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">阿桑特·萨那🤗</p></div></div>    
</body>
</html>