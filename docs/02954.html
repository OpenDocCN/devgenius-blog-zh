<html>
<head>
<title>TypeScript 4.0 — Breaking Changes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TypeScript 4.0 —突破性更改</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/typescript-4-0-breaking-changes-6197c5599520?source=collection_archive---------1-----------------------#2020-09-15">https://blog.devgenius.io/typescript-4-0-breaking-changes-6197c5599520?source=collection_archive---------1-----------------------#2020-09-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/9cbc301caeafc9401de78e167f67a6b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BYkTtbSKK7X-kqDz"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">哈维尔·阿莱格·巴罗斯<a class="ae kc" href="https://unsplash.com/@soymeraki?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">在</a><a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="0448" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">TypeScript 4.0提供了许多新特性，使得JavaScript开发更加容易。</p><p id="d07e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究TypeScript 4的最佳特性。</p><h1 id="274f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">定制JSX工厂</h1><p id="eb3b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">TypeScript 4.0允许我们用<code class="fe me mf mg mh b">jsxFragmentFactory</code>选项定制片段工厂。</p><p id="e14d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以通过编写以下内容来设置<code class="fe me mf mg mh b">tsconfig.json</code>中的设置:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="ce7c" class="mq lc iq mh b gy mr ms l mt mu">{<br/>  compilerOptions: {<br/>    target: "esnext",<br/>    module: "commonjs",<br/>    jsx: "react",<br/>    jsxFactory: "h",<br/>    jsxFragmentFactory: "Fragment",<br/>  },<br/>}</span></pre><p id="44fd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以基于每个文件设置工厂:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="4c9c" class="mq lc iq mh b gy mr ms l mt mu">/** @jsx h */<br/>/** @jsxFrag Fragment */</span></pre><p id="2a90" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">jsxFactory</code>是将JSX渲染成JavaScript的函数。</p><p id="7216" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">并且<code class="fe me mf mg mh b">jsxFragmentFactory</code>让我们将JSX片段呈现给JavaScript。</p><h1 id="6245" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用<code class="fe me mf mg mh b">--noEmitOnError</code>提高<code class="fe me mf mg mh b">build</code>模式下的速度</h1><p id="dca4" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated"><code class="fe me mf mg mh b">noEmitError</code>选项允许我们通过在<code class="fe me mf mg mh b">.tsbuildinfo</code>文件中缓存数据来进行增量编译。</p><p id="3c28" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这将给我们一个使用<code class="fe me mf mg mh b">--incremental</code>旗帜建造时的性能。</p><h1 id="69c0" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><code class="fe me mf mg mh b">--incremental</code>同<code class="fe me mf mg mh b">--noEmit</code></h1><p id="4d34" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated"><code class="fe me mf mg mh b">--noEmit</code>标志现在可以和<code class="fe me mf mg mh b">--incremental</code>标志一起使用来加速增量构建。</p><h1 id="4a71" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">编辑器改进</h1><p id="1ce4" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">有了TypeScript 4.0，Visual Studio代码和Visual Studio变得更加智能。</p><p id="d503" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它能做的一件事是将长串未定义的检查收缩到可选的链接或nullish coaslescing表达式中。</p><p id="cd64" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，如果可以收缩:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="67f7" class="mq lc iq mh b gy mr ms l mt mu">a &amp;&amp; a.b &amp;&amp; a.b.c</span></pre><p id="19e5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">变成:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="e51a" class="mq lc iq mh b gy mr ms l mt mu">a?.b?.c</span></pre><p id="b70b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它还增加了对<code class="fe me mf mg mh b">/** @deprecated */</code>标志的支持，以将代码标记为不推荐使用。</p><p id="b413" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么代码将显示为被删除。</p><h1 id="787f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">启动时的部分语义模式</h1><p id="769f" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">部分语义模式通过在启动期间部分解析代码而不是解析所有内容来加快Visual Studio代码和Visual Studio的启动时间。</p><p id="779a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，现在启动延迟应该只有几秒钟。</p><p id="f5b8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这意味着我们将立即获得编辑的丰富经验。</p><h1 id="7219" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">更智能的自动导入</h1><p id="ac1a" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">自动导入现在更智能了，因为它可以处理自带类型的包。</p><p id="cef4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">TypeScript 4.0可以在<code class="fe me mf mg mh b">package.json</code>中列出的包中搜索类型，这样它就可以找到类型，并让我们在这些包中进行自动导入。</p><p id="c64f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将<code class="fe me mf mg mh b">typescript.preferences.includePackageJsonAutoImports</code>设置为<code class="fe me mf mg mh b">true</code>，让我们进行自动导入。</p><h1 id="cc60" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">属性重写访问器(反之亦然)是错误的</h1><p id="8449" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">在TypeScript 4.0中，重写访问器的属性是一个错误，反之亦然。</p><p id="13a6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，如果我们有:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="1d16" class="mq lc iq mh b gy mr ms l mt mu">class Base {<br/>  get foo() {<br/>    return 100;<br/>  }<br/>  set foo(value) {<br/>    // ...<br/>  }<br/>}</span><span id="7bee" class="mq lc iq mh b gy mv ms l mt mu">class Derived extends Base {<br/>  foo = 10;<br/>}</span></pre><p id="236d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们会得到一个错误，因为我们将<code class="fe me mf mg mh b">this.foo</code>设置为一个新值。</p><h1 id="84d0" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><code class="fe me mf mg mh b">delete</code>的操作数必须是可选的</h1><p id="4739" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated"><code class="fe me mf mg mh b">delete</code>的操作数必须是可选的，因为它们可以被删除。</p><p id="4a34" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以如果我们有这样的东西:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="2a8f" class="mq lc iq mh b gy mr ms l mt mu">interface Thing {<br/>  prop: string;<br/>}</span><span id="ad34" class="mq lc iq mh b gy mv ms l mt mu">function f(x: Thing) {<br/>  delete x.prop;<br/>}</span></pre><p id="28bf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们得到一个错误，因为<code class="fe me mf mg mh b">Thing</code>需要<code class="fe me mf mg mh b">props</code>。</p><h1 id="ec37" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="2a19" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">TypeScript 4.0带来了一些突破性的变化。</p><p id="e499" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，它还有更多设置JSX工厂和自动转换语法的功能。</p></div></div>    
</body>
</html>