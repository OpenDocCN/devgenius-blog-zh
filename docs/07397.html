<html>
<head>
<title>PostgreSQL — The Difference Between HAVING Vs WHERE</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PostgreSQL—HAVING 和 WHERE 之间的区别</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/postgresql-the-difference-between-having-vs-where-94348933afe9?source=collection_archive---------15-----------------------#2022-03-21">https://blog.devgenius.io/postgresql-the-difference-between-having-vs-where-94348933afe9?source=collection_archive---------15-----------------------#2022-03-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/a7c150cce68bd167362607bbd865230d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MIAiBU-kXxnmdOCL.png"/></div></div></figure><h1 id="025a" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">动机</h1><p id="9610" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">这个 Jupyter 笔记本是我的 PostgreSQL 系列的第四个，之前的博客文章可以在这里找到。这篇文章的目的是解释 PostgreSQL 中 HAVING 和 WHERE 语句之间的区别。本指南使用了一个名为“dvdrental”的示例数据库，这是一个用于学习 PostgreSQL 的常见资源，可以从<a class="ae lu" href="https://www.postgresqltutorial.com/postgresql-sample-database/" rel="noopener ugc nofollow" target="_blank">这里</a>下载。</p><p id="7e31" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated"><strong class="ky ir">这个 Jupyter 笔记本也驻留在我的 GitHub 上——可以从</strong> <a class="ae lu" href="https://github.com/ConanMercer/PostgreSQL/blob/master/postgresSQL_HavingWhere.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">这里</strong> </a>查看</p><h1 id="b816" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">在哪里</h1><p id="d88a" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><code class="fe ma mb mc md b">WHERE</code>语句是过滤数据的最基本的方法之一。在下面的例子中，使用<code class="fe ma mb mc md b">WHERE</code>语句从支付表中查询具体金额。这将筛选出金额列中小于 11 欧元的任何值。换句话说，返回的是金额大于 11 欧元的任何行。</p><pre class="me mf mg mh gt mi md mj mk aw ml bi"><span id="b39a" class="mm jz iq md b gy mn mo l mp mq"><strong class="md ir">SELECT</strong> <strong class="md ir">*</strong><br/><strong class="md ir">FROM</strong> payment<br/><strong class="md ir">WHERE</strong> amount <strong class="md ir">&gt;</strong> 11;</span></pre><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/f2f4b0370acb3394e1e2aedb8c1a0426.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*RRAWH2_gvTIlGA5sux06ew.png"/></div></figure><h1 id="1f57" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">拥有</h1><p id="f693" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><code class="fe ma mb mc md b">HAVING</code>语句只能在聚合函数中使用。聚合函数是指将多行的值组合在一起形成一个汇总值。聚合函数的一个很好的例子是<code class="fe ma mb mc md b">GROUP BY</code>语句，它根据特定的标准对一组行的值进行分组。<code class="fe ma mb mc md b">HAVING</code>和<code class="fe ma mb mc md b">WHERE</code>的区别在于<code class="fe ma mb mc md b">HAVING</code>适用于<code class="fe ma mb mc md b">GROUP BY</code>运算的结果，<code class="fe ma mb mc md b">WHERE</code>适用于数据被<code class="fe ma mb mc md b">GROUP BY</code>分组之前。</p><p id="2dbb" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">以下示例返回每个客户 id 的总消费金额:</p><pre class="me mf mg mh gt mi md mj mk aw ml bi"><span id="c536" class="mm jz iq md b gy mn mo l mp mq"><strong class="md ir">SELECT</strong> customer_id, <strong class="md ir">sum</strong>(amount) <br/><strong class="md ir">FROM</strong> payment<br/><strong class="md ir">GROUP</strong> <strong class="md ir">BY</strong> customer_id<br/><strong class="md ir">LIMIT</strong> 10;</span></pre><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/080a0dfb271198207828ed8a33a1257b.png" data-original-src="https://miro.medium.com/v2/resize:fit:282/format:webp/1*JZMi7TTXBFZSDp8yGbrIcg.png"/></div></figure><p id="ad87" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">然而，一个更现实的问题可能会问，哪些顾客花了超过 170 欧元？在按 customer_id 对数据进行分组后，可以在这里使用<code class="fe ma mb mc md b">HAVING</code>语句，以过滤掉总支出少于 170 欧元的任何行。</p><pre class="me mf mg mh gt mi md mj mk aw ml bi"><span id="d782" class="mm jz iq md b gy mn mo l mp mq"><strong class="md ir">SELECT</strong> customer_id, <strong class="md ir">sum</strong>(amount) <br/><strong class="md ir">FROM</strong> payment<br/><strong class="md ir">GROUP</strong> <strong class="md ir">BY</strong> customer_id<br/><strong class="md ir">HAVING</strong> <strong class="md ir">sum</strong>(amount) <strong class="md ir">&gt;</strong> 170;</span></pre><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/adada5a5856bd44b98300153c1fd2081.png" data-original-src="https://miro.medium.com/v2/resize:fit:272/format:webp/1*FUqyBdjZR1i1i_vms0gvuA.png"/></div></figure><h1 id="af84" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">哪里和拥有的区别</h1><p id="765d" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">主要区别在于<code class="fe ma mb mc md b">HAVING</code>语句只能在聚合函数之后使用，而<code class="fe ma mb mc md b">WHERE</code>语句可以在非聚合数据上使用。</p><p id="e36e" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">简而言之，<code class="fe ma mb mc md b">HAVING</code>总是放在<code class="fe ma mb mc md b">WHERE</code>和<code class="fe ma mb mc md b">GROUP BY</code>子句之后。</p><p id="598b" class="pw-post-body-paragraph kw kx iq ky b kz lv lb lc ld lw lf lg lh lx lj lk ll ly ln lo lp lz lr ls lt ij bi translated">这方面的一个例子如下:</p><pre class="me mf mg mh gt mi md mj mk aw ml bi"><span id="7ef9" class="mm jz iq md b gy mn mo l mp mq"><strong class="md ir">SELECT</strong> customer_id, <strong class="md ir">sum</strong>(amount) <br/><strong class="md ir">FROM</strong> payment<br/><strong class="md ir">WHERE</strong> customer_id <strong class="md ir">&gt;</strong> 400<br/><strong class="md ir">GROUP</strong> <strong class="md ir">BY</strong> customer_id<br/><strong class="md ir">HAVING</strong> <strong class="md ir">sum</strong>(amount) <strong class="md ir">&gt;</strong> 170;</span></pre><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/1361c0776b7c461e852735fa138e4097.png" data-original-src="https://miro.medium.com/v2/resize:fit:276/format:webp/1*ny5wUmxnbtZ_RUxAkV6nPQ.png"/></div></figure><h1 id="3c9d" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">结论</h1><p id="80f8" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">这篇文章解释了 PostgreSQL 中 HAVING 和 WHERE 语句之间的重要区别。将来我会写更多关于 PostgreSQL 的文章，重点是数据科学，以及收集特定信息用于进一步数据分析的技术。</p></div></div>    
</body>
</html>