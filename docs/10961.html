<html>
<head>
<title>Scrape Data Online using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 在线抓取数据</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/scrape-data-online-using-python-libraries-5a667958c12b?source=collection_archive---------11-----------------------#2022-12-10">https://blog.devgenius.io/scrape-data-online-using-python-libraries-5a667958c12b?source=collection_archive---------11-----------------------#2022-12-10</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/3c3c05fafbd720ea4b081092ca9916c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IZIn7Nq1q7cuuDOQ"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">马文·迈耶在<a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="6e1d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">有时候我们没有确切的数据来回答我们需要知道的。你可以进行一次调查，但是如果你想让你的回答成为一个更大群体的<a class="ae jz" href="https://www.alchemer.com/resources/blog/representative-sample/" rel="noopener ugc nofollow" target="_blank">代表</a>，那就要费时、费钱，并且需要更高的执行能力。当针对代表性不足的群体时，您可能会问不同组织已经反复问过的相同问题，这可能会导致<a class="ae jz" href="https://www.sciencedirect.com/science/article/pii/S0304387821001073" rel="noopener ugc nofollow" target="_blank">响应疲劳</a>。</p><p id="92d5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">有很好的理由进行调查，但也存在创造性的选择，以使我们的生活和他人的生活更容易。其中一种方法是直接从网站上搜集信息。当站点包含文本、数字或项目符号模式时，Web 抓取特别有用，您可以将这些模式组合成一种数据集格式。</p><p id="cb4b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在本文中，我将通过一个示例，使用 Python 中的库<a class="ae jz" href="https://pypi.org/project/requests/" rel="noopener ugc nofollow" target="_blank"> Requests </a>和<a class="ae jz" href="https://pypi.org/project/beautifulsoup4/" rel="noopener ugc nofollow" target="_blank"> BeautifulSoup4 </a>来代理每个国家的<strong class="kc io">学习评估研究</strong> <strong class="kc io">的数量。<em class="ky">请求</em>允许您发送一个 HTTP/请求(将您连接到 web 链接)。Beautiful Soup 可以解析 HTML 或 XML 来搜索或修改其中的内容。</strong></p><p id="3dab" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我将在这篇文章中详述这些步骤。你可以在 Github 上找到完整的脚本。</p><p id="65b6" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">步骤一。建立你的环境</strong></p><p id="02b4" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">除了<em class="ky">请求</em>和<em class="ky"> BeautifulSoup，</em>我还导入了<a class="ae jz" href="https://docs.python.org/3/library/os.html#module-os" rel="noopener ugc nofollow" target="_blank"> <em class="ky"> os </em> </a>，帮助你设置相对路径<em class="ky">。当其他操作系统复制您的代码时，这很有用。在这里，我设置了依赖于用户的 Github 克隆的路径。</em></p><figure class="kz la lb lc gt jo"><div class="bz fp l di"><div class="ld le l"/></div></figure><p id="01b6" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">第二步。设置对所有国家的搜索</strong></p><p id="be0e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在这篇文章中，我将结合“学习评估”这一术语来查看每个国家的谷歌学术结果的数量(这是要跟随的<a class="ae jz" href="https://scholar.google.com/scholar?hl=en&amp;as_sdt=0%2C9&amp;q=%28United+States%29+AND+%28learning+assessment%29&amp;btnG=" rel="noopener ugc nofollow" target="_blank">查询</a>的链接)。你会得到这样的东西:</p><figure class="kz la lb lc gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lf"><img src="../Images/5209a054c0244257d46823155bc48468.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s26fu6gFTvO8ArgIEaOqeg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">谷歌学术结果</figcaption></figure><p id="6569" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们想要的数据是搜索词的结果的<strong class="kc io">数量</strong>，我将在下一步中用到它。首先，我们将创建一个链接列表，返回每个国家的搜索结果。请注意，在这个例子中，链接的变化部分将只在“<em class="ky">美国+美国</em>”中，这将根据国家的不同而变化。</p><figure class="kz la lb lc gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lg"><img src="../Images/97b95d3ab2c7b92cb6e94405867f2b67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M41vgOFQxM-uu-PMnARL6g.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">搜索的链接结构</figcaption></figure><p id="5d74" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们基于通用链接结构创建一个字符串，并在一个循环中将它连接到每个国家。结果是包含每个国家的学习评估查询结果的链接列表。</p><figure class="kz la lb lc gt jo"><div class="bz fp l di"><div class="ld le l"/></div></figure><p id="244a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">第三步。识别要解析的内容</strong></p><p id="8622" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在我们已经有了我们要请求的所有页面，我们要为 Beautiful Soup 确定要解析的页面部分。返回谷歌学术页面，右键单击—选择“检查”。在右侧，您会看到“elements”选项卡，这是该页面的 HTML 脚本。这些页面通常由 CSS 组织。对元素、id、类有一个<a class="ae jz" href="http://Here's an intro to CSS classes." rel="noopener ugc nofollow" target="_blank">基本了解</a>对有效使用美汤很有帮助。</p><p id="2e4a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">滚动脚本，直到找到突出显示结果栏的<em class="ky"> div </em>元素。识别的<em class="ky">类</em>为<em class="ky"> gs_ab_st. </em></p><figure class="kz la lb lc gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lh"><img src="../Images/bef6b327f481fbc8b383e6482a1386e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7FzXddkuUcqRjvTvMuC8ow.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">查询结果的页面检查</figcaption></figure><p id="d20f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">第四步。解析每个请求中的选择</strong></p><p id="9d10" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">设置好一切后，我们将使用<em class="ky">请求</em>和<em class="ky">美汤</em>库来获取数据。我们为<em class="ky">请求</em>设置了一个通用头，并在命令<em class="ky"> requests.get() </em>中输入搜索的链接。然后，使用<em class="ky"> bs() </em>解析请求响应中的文本。最后，soup.find_all()返回包含类<em class="ky"> gs_ab_st </em>的文本。</p><p id="c752" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我通过一个循环运行每个搜索，并将输出附加到一个列表中。</p><figure class="kz la lb lc gt jo"><div class="bz fp l di"><div class="ld le l"/></div></figure><p id="1eff" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">您可能需要进行一些清理，以提取字符串中不需要的部分。我将我的结果组合成一个<a class="ae jz" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> <em class="ky">熊猫</em> </a>数据框，并包含了网络抓取的日期作为参考。最终输出被写入。csv 格式:</p><figure class="kz la lb lc gt jo gh gi paragraph-image"><div class="gh gi li"><img src="../Images/2aa56f4329aed3a0a5df0b951f7afcdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*NeMkNxkviZWYWKh7BmonNg.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">最终输出的快照</figcaption></figure><p id="89c7" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">奖励:将数据可视化</strong></p><p id="75c5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">国家一级的数据通常对全球或区域比较有用。最后，这里有两个例子来展示这些结果是如何可视化的。</p><p id="b8ef" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io"> A) </strong> <a class="ae jz" href="https://medium.com/dev-genius/data-visualization-for-economics-using-wdi-package-in-r-d2da5a542f8b" rel="noopener"> <strong class="kc io">泡沫图</strong> </a> <strong class="kc io">谷歌学术的成绩和人均 GDP。按地区划分颜色，按人口划分尺寸(10-14 岁)。</strong></p><p id="e208" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们可以用财富(人均 GDP)作为参考点，观察任何预期的趋势以及谁做得更好或更差。联合国人口数据按年龄提供了预测和历史数据。我选择了 10-14 岁的学生作为研究对象。人均国内生产总值(2015 年不变美元)可从<a class="ae jz" href="https://data.worldbank.org/indicator/NY.GDP.PCAP.KD" rel="noopener ugc nofollow" target="_blank">世界发展指标</a>中获得。</p><figure class="kz la lb lc gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lj"><img src="../Images/4407dfa1842aa0bfbf376f0f646a676c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vcAXQ0dyYSBe4T8R1D2Lmg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">查询结果和人均 GDP 的气泡图</figcaption></figure><p id="d92e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io"> B)条形图结果，区域比较</strong></p><p id="1902" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">着眼于区域趋势，洞察力来自频率和结果分布的并排比较。这里不包括人口和财富维度。</p><figure class="kz la lb lc gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lk"><img src="../Images/40e77c82e2654df60e1611b4dd4a2f16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Eyym-ashE9AgwB3bFx0wyA.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">谷歌学术结果的水平条形图</figcaption></figure><p id="c898" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">最后的想法</strong></p><p id="1a9f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">美丽的汤和请求都是强大的库，因为它们使用灵活。<a class="ae jz" href="https://twitter.com/nomadj1s/status/1294390370499952640" rel="noopener ugc nofollow" target="_blank">这个来自达蒙·琼斯教授的例子</a>自 2015 年以来，从芝加哥大学警察局(UCPD)刮擦每一个交通站和搜索，发现 UCPD 不成比例地在海德公园拦住更多的黑人。</p><p id="c5b8" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">你能想到其他可以通过网络抓取开始处理的数据吗？什么样的数据组合加强了你的结果的初步发现？</p><p id="44d7" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">一如既往的感谢您的阅读！</p></div></div>    
</body>
</html>