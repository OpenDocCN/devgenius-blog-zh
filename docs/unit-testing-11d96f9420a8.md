# 单元测试

> 原文：<https://blog.devgenius.io/unit-testing-11d96f9420a8?source=collection_archive---------1----------------------->

![](img/4ce22b5649daa3315a6652d15bd4cfb3.png)

# 什么是单元测试？

**单元测试**是一种软件测试，其中测试软件的单个单元或组件。目的是验证软件代码的每个单元都如预期的那样执行。单元测试由开发人员在应用程序的开发(编码阶段)过程中完成。单元测试隔离一段代码并验证其正确性。单元可以是单独的函数、方法、过程、模块或对象。

在 SDLC、STLC、V 模型中，单元测试是集成测试之前完成的第一级测试。单元测试是一种通常由开发人员执行的白盒测试技术。然而，在现实世界中，由于时间紧迫或开发人员不愿意测试，QA 工程师也做单元测试。

# 为什么要进行单元测试？

**单元测试**很重要，因为软件开发人员有时试图节省时间进行最小的单元测试，这是一个神话，因为不适当的单元测试会导致高成本。在系统测试、集成测试甚至是应用程序构建后的 Beta 测试期间修复缺陷。如果在开发的早期就进行适当的单元测试，那么最终会节省时间和金钱。

以下是执行单元测试的主要原因:

1.  单元测试有助于在开发周期的早期修复错误并节省成本。
2.  它有助于开发人员理解代码库，并使他们能够快速做出更改
3.  好的单元测试作为项目文档
4.  单元测试有助于代码重用。将代码和测试都迁移到新项目中。调整代码，直到测试再次运行。

# 如何进行单元测试

为了让**进行单元测试**，开发人员编写一段代码来测试软件应用中的特定功能。开发人员还可以隔离这个函数来进行更严格的测试，这可以揭示被测试的函数和其他单元之间不必要的依赖关系，从而可以消除依赖关系。开发人员通常使用 UnitTest 框架来开发单元测试的自动化测试用例。

单元测试有两种类型

*   指南
*   自动化的

单元测试通常是自动化的，但是仍然可以手动执行。软件工程并不偏爱其中之一，但自动化是首选。单元测试的手动方法可能会使用分步指导文档。

在自动化方法下-

*   开发人员在应用程序中编写一段代码来测试功能。他们随后会注释掉并最终在部署应用程序时删除测试代码。
*   开发人员也可以隔离功能，以便更严格地测试它。这是一种更彻底的单元测试实践，包括将代码复制并粘贴到它自己的测试环境中，而不是自然环境中。隔离代码有助于揭示被测试代码和产品中其他单元或数据空间之间不必要的依赖关系。这些依赖性可以被消除。
*   程序员通常使用 UnitTest 框架来开发自动化测试用例。使用自动化框架，开发人员将标准编码到测试中，以验证代码的正确性。在测试用例的执行过程中，框架记录失败的测试用例。总之，许多框架也会自动标记和报告这些失败的测试用例。根据失败的严重程度，框架可能会暂停后续测试。
*   单元测试的工作流程是 1)创建测试用例 2)评审/返工 3)基线 4)执行测试用例。

# 如何编写单元测试

1.  将你的程序映射成单元。好的单元测试的关键在于它只检查程序的一部分。无论你是想测试一个现有的程序，还是计划测试一个还没写好的程序，你都需要把它分解成离散的部分(“单元”)。然后你将为每一个写一个单元测试。

*   “单元”的定义根据您正在开发的程序的类型有很大的不同。一个单元可以是一个类，也可以是一个函数或过程。

2.**确定你是否需要基于状态或者基于交互的测试。**单元测试可以用来检查两种场景。基于状态的测试用于查看程序单元是否产生正确的或预期的结果。另一方面，基于交互的测试被用来观察一个单元是否将预期的方法付诸行动。要编写一个好的测试，你需要确定你要测试的是什么，所以记住这些方法中的一个作为模型。

3.**设计简单易读的测试。请记住，你需要编写大量的单元测试。你需要对程序的每个部分进行单元测试。保持测试简单有几个好处:**

*   简单的测试将有助于确保你一次只测试一个单元。
*   测试的代码将是可靠的。如果你有复杂的测试代码，它将更容易出现问题，使你更难发现你正在测试的程序代码中的错误。
*   测试将会更快，从而减少测试所需的总时间。
*   一个简单的测试将是可读的，这意味着你可以通过查看代码本身来发现一些潜在的问题。

4.区分单元测试和集成测试。经验丰富的开发人员知道有不同的方法来测试一个程序。单元测试是狭窄的、特定的，并且只关注程序的一部分。另一方面，集成测试在真实的环境中观察整个程序。换句话说，单元测试确保程序的各个部分能够工作，而集成测试则验证各个部分能够一起工作。

*   集成测试通常还需要外部元素，比如 web 服务器或数据库。为了保持单元测试受控，编写单元测试时不需要外部元素。

# 单元测试工具

有几个自动化工具可以帮助单元测试。我们将在下面提供几个例子:

1.  Junit 是一个免费的测试工具，用于 Java 编程语言。它提供断言来识别测试方法。这个工具首先测试数据，然后插入到代码中。
2.  [NUnit](https://nunit.org/) : NUnit 是一个广泛使用的单元测试框架。网络语言。它是一个开源工具，允许手动编写脚本。它支持可以并行运行的数据驱动测试。
3.  [JMockit](http://jmockit.github.io/index.html) : JMockit 是一个开源的单元测试工具。这是一个代码覆盖工具，具有行和路径度量。它允许用记录和验证语法模仿 API。此工具提供线覆盖、路径覆盖和数据覆盖。
4.  EMMA : EMMA 是一个开源工具包，用于分析和报告用 Java 语言编写的代码。Emma 支持覆盖类型，如方法、行、基本块。它是基于 Java 的，所以它没有外部库依赖，可以访问源代码。
5.  [PHPUnit](https://phpunit.de/) : PHPUnit 是 PHP 程序员的单元测试工具。它取一小部分被称为单元的代码，并分别测试它们。该工具还允许开发人员使用预定义的断言方法来断言系统以某种方式运行。

这些只是可用的单元测试工具中的一部分。还有很多，特别是对于 C 语言和 Java，但是不管你使用什么语言，你一定会找到一个单元测试工具来满足你的编程需求。

# 测试驱动开发(TDD)和单元测试

TDD 中的单元测试涉及到测试框架的广泛使用。使用单元测试框架是为了创建自动化单元测试。单元测试框架并不是 TDD 所独有的，但是对它来说却是必不可少的。下面我们看看 TDD 给单元测试世界带来了什么:

*   测试是在代码之前编写的
*   严重依赖测试框架
*   应用程序中的所有类都经过了测试
*   快速简单的集成成为可能

# 优势

*   希望了解单元提供了什么功能以及如何使用它的开发人员可以查看单元测试，以获得对单元 API 的基本理解。
*   单元测试允许程序员在以后重构代码，并确保模块仍然正确工作(即回归测试)。这个过程是为所有的函数和方法编写测试用例，这样每当一个变化导致一个错误时，它可以被快速地识别和修复。
*   由于单元测试的模块化本质，我们可以测试项目的一部分，而不必等待其他部分完成。

# 不足之处

*   不能指望单元测试能捕捉到程序中的每个错误。即使在最简单的程序中，也不可能评估所有的执行路径
*   单元测试本质上关注于一个代码单元。因此，它不能捕捉集成错误或广泛的系统级错误。

建议将单元测试与其他测试活动结合使用。

# 最佳实践

*   单元测试用例应该是独立的。如果需求有任何增强或变更，单元测试用例不应该受到影响。
*   一次只测试一个代码。
*   为您的单元测试遵循清晰一致的命名约定
*   如果任何模块中的代码发生更改，请确保该模块有相应的单元测试用例，并且该模块在更改实现之前通过了测试
*   在进行 SDLC 的下一个阶段之前，必须修复单元测试中发现的错误
*   采用“测试作为你的代码”的方法。您编写的未经测试的代码越多，您需要检查错误的路径就越多。

# 利益

单元测试提供了许多好处，包括尽早发现软件错误、促进变更、简化集成、提供文档来源以及许多其他好处，我们现在将更详细地研究这些好处。

1.**使流程敏捷**

单元测试的主要好处之一是它使编码过程更加敏捷。当你给软件添加越来越多的特性时，你有时需要改变旧的设计和代码。然而，改变已经测试过的代码既有风险又昂贵。如果我们有合适的单元测试，那么我们就可以自信地进行重构。

单元测试实际上与各种风格的敏捷编程密切相关，因为它建立在测试中，允许你更容易地做出改变。换句话说，单元测试有助于安全重构。

2.**代码质量**

单元测试提高了代码的质量。在代码被进一步发送进行集成测试之前，它识别出每个可能出现的缺陷。在实际编码之前编写测试会让你更加努力地思考问题。它暴露了边缘情况，让你写出更好的代码。

3.**及早发现软件漏洞**

问题是在早期发现的。由于单元测试是由开发人员执行的，他们在集成之前测试单独的代码，所以问题可以很早就被发现，并且可以在不影响代码的其他部分的情况下被解决。这既包括程序员实现中的错误，也包括单元规范中的缺陷或缺失部分。

4.**促进变化并简化集成**

单元测试允许程序员在以后重构代码或升级系统库，并确保模块仍然正常工作。单元测试检测可能破坏设计契约的变更。他们帮助维护和更改代码。

单元测试减少了新开发特性中的缺陷，或者减少了更改现有功能时的错误。

单元测试验证每个单元的准确性。之后，通过单元测试来测试应用程序的各个部分，从而将单元集成到应用程序中。由于对单个单元的验证，集成过程中应用程序的后续测试更加容易。

5.**提供文档**

单元测试提供了系统的文档。想要了解单元提供了什么功能以及如何使用它的开发人员可以查看单元测试，以获得对单元接口(API)的基本理解。

6.**调试过程**

单元测试有助于简化调试过程。如果测试失败，那么只需要调试代码中最新的更改。

7.**设计**

在编写代码之前，首先编写测试迫使您仔细考虑您的设计以及它必须完成什么。这不仅让你保持专注；它让你创造更好的设计。测试一段代码迫使你定义这段代码负责什么。如果你能很容易地做到这一点，这意味着代码的责任是明确的，因此它有很高的内聚性。

8.**降低成本**

由于错误发现得早，单元测试有助于降低错误修复的成本。想象一下在开发的后期阶段发现一个 bug 的代价，比如在系统测试或者验收测试期间。当然，更早检测到的错误更容易修复，因为后来检测到的错误通常是许多更改的结果，并且您并不真正知道是哪一个导致了错误。

# 结束报价

> “你数完了所有的树，并不意味着你见过森林。”—匿名

如果您正在寻找我们的服务，请点击下面的网站:

[StackedQA 网站](https://www.stackedqa.com/)

查看我们的社交媒体:

[脸书](https://www.facebook.com/StackedQA)，[推特](https://twitter.com/stackedqa)， [Instagram](https://instagram.com/stackedqa) ，&Linkedin