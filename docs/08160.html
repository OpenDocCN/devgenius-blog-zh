<html>
<head>
<title>Storage API in Javascript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Javascript 中的存储 API</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/storage-api-in-javascript-a18ad8d7f125?source=collection_archive---------3-----------------------#2022-05-22">https://blog.devgenius.io/storage-api-in-javascript-a18ad8d7f125?source=collection_archive---------3-----------------------#2022-05-22</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/9df09c12933d5560c83b831a1c9820b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CKp01v3HvjutgZ24Sm7e0Q.png"/></div></div></figure><p id="7c6d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">存储 API 方便了我们开发人员在客户端存储数据。以前，cookies 用于此目的，但它有自己的缺点。与 cookies 相比，Storage API 更加安全，允许我们在浏览器上本地存储大量数据。</p><p id="1b0c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">数据存储在 String 类型的键值对中。存储 API 为我们提供了两个存储数据的选项:</p><p id="a027" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">1-会话存储<br/>2-本地存储</p><p id="ac57" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">您可以从应用程序选项卡下的开发工具中查看您的本地和会话存储，如下所示:</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi kt"><img src="../Images/a9e74443cc3f20fc4bd40a7294c8405f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*muhry6jPoeKLKzSCnscG6A.png"/></div></div></figure><h2 id="3cf8" class="ky kz in bd la lb lc dn ld le lf dp lg kg lh li lj kk lk ll lm ko ln lo lp lq bi translated">会话存储</h2><p id="192d" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">存储在会话存储中的数据不是持久的。只要浏览器或标签打开，它就在那里，包括页面重新加载和恢复。关闭浏览器或选项卡时，会话存储中的数据将被清除。它的最大存储容量为 5MB。</p><p id="87cc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">代码示例:</p><figure class="ku kv kw kx gt jo"><div class="bz fp l di"><div class="lw lx l"/></div></figure><h2 id="a198" class="ky kz in bd la lb lc dn ld le lf dp lg kg lh li lj kk lk ll lm ko ln lo lp lq bi translated">局部存储器</h2><p id="8352" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">另一方面，本地存储中的数据可以保存更长时间。它是持久的，即使浏览器关闭，它仍然存在于浏览器中。数据没有过期时间。我们可以使用 Javascript 或通过清除浏览器缓存来清除本地存储数据。与会话存储相比，本地存储具有更大的存储容量。</p><p id="415c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">代码示例:</p><figure class="ku kv kw kx gt jo"><div class="bz fp l di"><div class="lw lx l"/></div></figure><h2 id="7d24" class="ky kz in bd la lb lc dn ld le lf dp lg kg lh li lj kk lk ll lm ko ln lo lp lq bi translated">同源策略</h2><p id="2274" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">存储 API 遵循同源策略。起源有三个定义:</p><ul class=""><li id="910c" class="ly lz in jx b jy jz kc kd kg ma kk mb ko mc ks md me mf mg bi translated">使用的协议，即 HTTP，HTTPS。</li><li id="f6f7" class="ly lz in jx b jy mh kc mi kg mj kk mk ko ml ks md me mf mg bi translated">主机或域名，即 www.google.com</li><li id="3b0e" class="ly lz in jx b jy mh kc mi kg mj kk mk ko ml ks md me mf mg bi translated">托管 web 应用程序的端口。</li></ul><p id="fb7b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">因此，具有相同协议、主机和端口号(如果指定)的 URL 具有相同的来源。</p><p id="5be4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">出于安全原因，存储 API 遵循同源策略。在特定原点定义的数据只能在定义它的原点访问和操作。考虑一下原点<code class="fe mm mn mo mp b">https://www.example.com</code>，让我们假设一些数据是在原点的本地或会话存储中定义的。</p><p id="b3bd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果我要从 URL<code class="fe mm mn mo mp b">https://www.example.com/blogs</code>或<code class="fe mm mn mo mp b">https://www.example.com/users</code>访问这些数据，我将能够访问它，因为两个 URL 的来源是相同的。但是，对于 URL<code class="fe mm mn mo mp b">https://www.example.com:5656</code>或<code class="fe mm mn mo mp b">https://www.example2.com</code>，我们将无法访问本地或会话存储中的数据，因为 origin 的值已经改变。第一个 URL 具有不同的端口号<code class="fe mm mn mo mp b">5656</code>，而第二个 URL 具有不同的主机值<code class="fe mm mn mo mp b">www.example2.com</code></p><h2 id="5841" class="ky kz in bd la lb lc dn ld le lf dp lg kg lh li lj kk lk ll lm ko ln lo lp lq bi translated">在存储 API 中存储对象</h2><p id="7815" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">如上所述，存储 API 将数据存储为 String 类型的键值对。我们试图存储在本地或会话存储中的任何值都被本地和会话存储的<code class="fe mm mn mo mp b">setItem</code>方法转换成一个字符串。</p><p id="5e10" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们将一个对象存储在本地存储中，如下所示:</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi kt"><img src="../Images/91a9fb388b938a6a0ecf13434f8b51e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PjRzwfQgHwhjb-SDBZxWSw.png"/></div></div></figure><p id="2d56" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如你所见，我们遇到了一个问题。下面的<code class="fe mm mn mo mp b">setItem</code>通过<code class="fe mm mn mo mp b">String(obj)</code>将对象<code class="fe mm mn mo mp b">obj</code>转换成一个字符串，该字符串返回<code class="fe mm mn mo mp b">[object Object]</code>，该值存储在本地存储器中，如上图所示。这不是我们想要的。我们希望存储对象内部的实际值。</p><p id="f3c5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">事实证明，有一种方法。使用<code class="fe mm mn mo mp b">JSON.stringify()</code>，我们可以将 Javascript 对象转换成 JSON 字符串。然后，可以将该字符串存储在本地或会话存储中，如下所示:</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mq"><img src="../Images/35527d1128061f8d64bcbe8499174dd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Q0YD3_ni6xa3a3NiQIk-Q.png"/></div></div></figure><p id="9016" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在，我们能够在本地或会话存储中存储对象。但是有一个问题。当我们需要访问对象的值时，本地存储的<code class="fe mm mn mo mp b">getItem</code>方法会返回一个字符串。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/40a51ecc73a17c7c90052d9b2f4e07af.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*HuV0QH7N8djjKnq8ZJqSmQ.png"/></div></figure><p id="0569" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">要解决这个问题并将这个字符串转换回一个对象，我们可以如下使用<code class="fe mm mn mo mp b">JSON.parse()</code>:</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/af89114b1328ed6bc345c1e577f5c8e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*s5CoDZfZzOo4cYZc7KFlGw.png"/></div></figure><p id="dabc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在，我们正在获取存储在本地存储中的相同对象。并且解决了与从本地或会话存储中存储和检索对象相关的问题。</p><p id="56cb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">感谢您阅读帖子。希望你觉得有用。:)</p><p id="52c0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们来连线:<br/><a class="ae mt" href="https://www.linkedin.com/in/rabi-siddique-b6b4971a0/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a><br/><a class="ae mt" href="https://twitter.com/rabisiddique234" rel="noopener ugc nofollow" target="_blank">Twitter</a></p></div></div>    
</body>
</html>