# Node.js 最佳实践—测试和箭头函数

> 原文：<https://blog.devgenius.io/node-js-best-practices-test-and-arrow-functions-b7a8210fd3b2?source=collection_archive---------10----------------------->

![](img/0f936c432a9b2aa8d735797dc35566e8.png)

Gabriel Griego 在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片

像任何类型的应用程序一样，JavaScript 应用程序也必须写得很好。

否则，我们以后会遇到各种各样的问题。

在本文中，我们将看看在编写节点应用程序时应该遵循的一些最佳实践。

# 使用箭头函数表达式

箭头函数是现代 JavaScript 的一大特色。

它允许我们编写回调函数，而无需绑定到回调函数中的新值`this`。

而且，它更紧凑。

我们应该使用它来避免错误，让代码更容易阅读。

# 编写 API 测试

API 测试让我们检查 API 的结果。

如果我们没有得到我们想要的，我们会马上从测试中知道。

它们速度很快，所以我们不用动一根手指就能测试。

此外，它们非常适合记录如何调用我们的 API。

还有其他种类的测试，如性能测试、数据库测试等。我们也能做到。

# 每个测试名称包含 3 个部分

我们的测试应该一目了然。

所以我们应该在测试名称中说明测试的内容。

此外，我们应该说明测试的环境以及预期的结果。

这样，没有人会对我们测试的内容感到困惑。

例如，我们可以写:

```
describe('Item Service', () => {
  describe('Add new item', () => {
    it('When no price is specified, then the item status rejected', () => {
      const item = new ItemService().add(...);
      expect(item.status).to.equal('rejected');
    });
  });
});
```

我们用`describe` s 标记我们正在测试的单元。

我们传递给`it`的字符串包含我们正在测试的场景。

`expect`的叫声和`it`的弦声有了期待。

# 检测 Linter 的代码问题

我们可以用 linter 检测代码问题，这样我们就可以尽早检测到反模式。

为了使这变得简单，我们可以添加一个预提交钩子，它在提交之前运行来进行检查。

# 避免全局测试夹具和种子，并在每个测试中添加数据

每次测试都应该添加测试夹具。

并且在每次测试后都应该清理数据。

这样，我们就不会有相互依赖的测试。

完成这些后，每个测试都应该独立运行，这样我们就可以按任何顺序运行它们。

# 检查易受攻击的依赖项

我们应该检查易受攻击的依赖项，以便更新它们。

这样，我们可以更新它们，并避免攻击者利用这些漏洞攻击我们的应用程序。

为此，我们可以运行`npm audit`或其他工具。

# 标记我们的测试

我们可以标记我们的测试，以便它们在提交之前运行。

我们运行必须运行的程序，以防止任何破坏代码的行为。

否则，我们将一直运行所有测试，这对于提交之前的大多数应用程序来说可能太慢了。

# 检查测试覆盖率

检查测试覆盖率可以让我们识别任何减少，并检查我们在测试中遗漏的东西。

像伊斯坦布尔/纽约这样的工具可以检查我们代码中的测试覆盖率，这样我们就可以清楚地知道需要测试什么。

![](img/bb76ec216bbc68f66884486868d5eb83.png)

安德烈科·波迪尔尼克在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片

# 结论

我们应该使用箭头函数。

我们应该在代码中有良好的测试覆盖率。