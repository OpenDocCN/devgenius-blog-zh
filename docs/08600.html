<html>
<head>
<title>New Features in ECMAScript 2022 for Class Elements</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ECMAScript 2022 中针对类元素的新功能</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/new-features-in-ecmascript-2022-for-class-elements-b4a8f4a26659?source=collection_archive---------0-----------------------#2022-06-27">https://blog.devgenius.io/new-features-in-ecmascript-2022-for-class-elements-b4a8f4a26659?source=collection_archive---------0-----------------------#2022-06-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b472" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">它带来了什么便利？</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/42399ba92baa017efd44d4ef6c9b2cf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EEqKr9KBbZVUVi2N"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@jeswinthomas?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">杰斯温·托马斯</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="9c55" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这篇文章是 ECMAScript 2022 中一系列新特性的第二篇，主要关注类元素。第一个在这里:</p><div class="ls lt gp gr lu lv"><a rel="noopener  ugc nofollow" target="_blank" href="/ecmascript-2022-is-officially-released-what-should-we-pay-attention-to-5e207ed61a46"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">ECMAScript 2022 正式发布，需要注意什么？</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">有没有带来什么有趣的东西？</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">blog.devgenius.io</p></div></div><div class="me l"><div class="mf l mg mh mi me mj kp lv"/></div></div></a></div></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="6b04" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">公共和私有实例字段</h1><p id="fea6" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">实例字段允许使用<code class="fe no np nq nr b">=</code>将属性添加到类定义中。默认情况下所有属性都是公共的，你可以在字段前使用<code class="fe no np nq nr b">#</code>来定义一个私有字段。</p><pre class="kg kh ki kj gt ns nr nt nu aw nv bi"><span id="4887" class="nw ms iq nr b gy nx ny l nz oa">class Person {<br/>  name = 'A';<br/>  #age = 35;</span><span id="30e4" class="nw ms iq nr b gy ob ny l nz oa">  getName = () =&gt; this.name;<br/>  getAge = () =&gt; this.#age;<br/>}</span><span id="92a0" class="nw ms iq nr b gy ob ny l nz oa">const test = new Person();</span><span id="6a47" class="nw ms iq nr b gy ob ny l nz oa">console.log(test.name); // A<br/>console.log(test.getName()); // A</span><span id="bffd" class="nw ms iq nr b gy ob ny l nz oa"><em class="oc">// SyntaxError: Private field '#age' must be declared in an enclosing class</em><br/>console.log(test.#age);<br/>console.log(test.getAge()); // 35</span></pre><h1 id="1eaa" class="mr ms iq bd mt mu od mw mx my oe na nb jw of jx nd jz og ka nf kc oh kd nh ni bi translated">公共和私有静态字段</h1><p id="f980" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">添加了<code class="fe no np nq nr b">static</code>关键字来声明静态字段，这些字段只能通过类本身来访问，也可以被继承。</p><pre class="kg kh ki kj gt ns nr nt nu aw nv bi"><span id="eb19" class="nw ms iq nr b gy nx ny l nz oa">class Person {<br/>  static name = 'A';<br/>  static #age = 35;</span><span id="c8c6" class="nw ms iq nr b gy ob ny l nz oa">  getStaticAge = () =&gt; Person.#age;<br/>  getAge = () =&gt; this.#age;<br/>}</span><span id="6761" class="nw ms iq nr b gy ob ny l nz oa">const test = new Person();</span><span id="ebaf" class="nw ms iq nr b gy ob ny l nz oa"><em class="oc">// SyntaxError: Private field '#age' must be declared in an enclosing class</em><br/>console.log(Person.#age);<br/>console.log(Person.name); // 'A'</span><span id="e473" class="nw ms iq nr b gy ob ny l nz oa"><em class="oc">// TypeError: Cannot read private member #age from an object whose class did not declare it</em><br/>console.log(test.getAge());<br/>console.log(test.getStaticAge()); // 35</span></pre><h1 id="0016" class="mr ms iq bd mt mu od mw mx my oe na nb jw of jx nd jz og ka nf kc oh kd nh ni bi translated">私有实例方法和访问器</h1><p id="5763" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">类似地，私有实例的方法和访问器也可以使用<code class="fe no np nq nr b">#</code>来声明:</p><pre class="kg kh ki kj gt ns nr nt nu aw nv bi"><span id="9c50" class="nw ms iq nr b gy nx ny l nz oa">class Person {<br/>  #getAge = () =&gt; 35;<br/>  getAge = () =&gt; this.#getAge() + 1;</span><span id="9780" class="nw ms iq nr b gy ob ny l nz oa">  get #age() {<br/>    return 35;<br/>  }</span><span id="2d9f" class="nw ms iq nr b gy ob ny l nz oa">  get age() {<br/>    return this.#age;<br/>  }<br/>}</span><span id="2469" class="nw ms iq nr b gy ob ny l nz oa">const test = new Person();</span><span id="f5b5" class="nw ms iq nr b gy ob ny l nz oa">console.log(test.getAge()); // 36<br/>console.log(test.age); // 35</span></pre><h1 id="a4c3" class="mr ms iq bd mt mu od mw mx my oe na nb jw of jx nd jz og ka nf kc oh kd nh ni bi translated">私有静态方法和访问器</h1><pre class="kg kh ki kj gt ns nr nt nu aw nv bi"><span id="5f92" class="nw ms iq nr b gy nx ny l nz oa">class Person {<br/>  static #getAge = () =&gt; 35;<br/>  static getAge = () =&gt; this.#getAge() + 1;</span><span id="1350" class="nw ms iq nr b gy ob ny l nz oa">  static get #age() {<br/>    return 35;<br/>  }</span><span id="6148" class="nw ms iq nr b gy ob ny l nz oa">  static get age() {<br/>    return this.#age;<br/>  }<br/>}</span><span id="7128" class="nw ms iq nr b gy ob ny l nz oa">const test = new Person();</span><span id="20a4" class="nw ms iq nr b gy ob ny l nz oa">console.log(Person.getAge()); // 36<br/>console.log(Person.age); // 35</span><span id="9a5a" class="nw ms iq nr b gy ob ny l nz oa"><em class="oc">// TypeError: test.getAge is not a function</em><br/>console.log(test.getAge());<br/>console.log(test.age); // undefined</span></pre><h1 id="7137" class="mr ms iq bd mt mu od mw mx my oe na nb jw of jx nd jz og ka nf kc oh kd nh ni bi translated">类内部的静态块</h1><p id="0a15" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">在此之前，如果您需要在初始化期间评估语句(如<code class="fe no np nq nr b">try..catch</code>)，或者从一个值设置两个字段，您必须在类定义之外执行该逻辑。像下面这样:</p><pre class="kg kh ki kj gt ns nr nt nu aw nv bi"><span id="914e" class="nw ms iq nr b gy nx ny l nz oa">// without static blocks:<br/>class C {<br/>  static x = ...;<br/>  static y;<br/>  static z;<br/>}</span><span id="47ba" class="nw ms iq nr b gy ob ny l nz oa">try {<br/>  const obj = doSomethingWith(C.x);<br/>  C.y = obj.y<br/>  C.z = obj.z;<br/>}<br/>catch {<br/>  C.y = ...;<br/>  C.z = ...;<br/>}</span></pre><p id="a151" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是现在我们可以使用下面的语法:</p><pre class="kg kh ki kj gt ns nr nt nu aw nv bi"><span id="c414" class="nw ms iq nr b gy nx ny l nz oa">class C {<br/>  static {<br/>    // statements<br/>  }<br/>}</span></pre><p id="055d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里有一个例子:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/2538af6d9a327d9ad7209e128ca72cd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZtloY2xI2NVQXaHwMIopyw.png"/></div></div></figure><h1 id="7ff9" class="mr ms iq bd mt mu od mw mx my oe na nb jw of jx nd jz og ka nf kc oh kd nh ni bi translated"><code class="fe no np nq nr b">#x in obj</code>语法</h1><p id="45c6" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">使用<code class="fe no np nq nr b">#x in obj</code>语法，我们可以测试对象上私有字段的存在:</p><pre class="kg kh ki kj gt ns nr nt nu aw nv bi"><span id="8bd2" class="nw ms iq nr b gy nx ny l nz oa">class A {<br/>  #age = 35;</span><span id="7627" class="nw ms iq nr b gy ob ny l nz oa">  static isAInstance(obj) {<br/>    return #age in obj;<br/>  }<br/>}</span><span id="3ab0" class="nw ms iq nr b gy ob ny l nz oa">class B extends A {}</span><span id="51c7" class="nw ms iq nr b gy ob ny l nz oa">const test0 = new A();<br/>const test1 = new B();</span><span id="8ff9" class="nw ms iq nr b gy ob ny l nz oa">console.log(A.isAInstance(test0)); // true<br/>console.log(A.isAInstance(test1)); // true<br/>console.log(A.isAInstance(Object.create(null))); // false</span></pre><h1 id="600c" class="mr ms iq bd mt mu od mw mx my oe na nb jw of jx nd jz og ka nf kc oh kd nh ni bi translated">结论</h1><p id="f316" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">这是关于类元素的新特性，那么你觉得哪个最有用？</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><p id="38d3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="oc">感谢阅读。如果你喜欢这样的故事，想支持我，请考虑成为</em> <a class="ae kv" href="https://medium.com/@islizeqiang/membership" rel="noopener"> <em class="oc">中会员</em> </a> <em class="oc">。每月 5 美元，你可以无限制地访问媒体内容。如果你通过</em> <a class="ae kv" href="https://medium.com/@islizeqiang/membership" rel="noopener"> <em class="oc">我的链接</em> </a> <em class="oc">报名，我会得到一点佣金。</em></p><p id="2b61" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你的支持对我很重要——谢谢。</p></div></div>    
</body>
</html>