<html>
<head>
<title>Building Your Own Search Engine From Scratch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从头开始构建自己的搜索引擎</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/building-your-own-search-engine-from-scratch-e542a1068c44?source=collection_archive---------0-----------------------#2021-07-20">https://blog.devgenius.io/building-your-own-search-engine-from-scratch-e542a1068c44?source=collection_archive---------0-----------------------#2021-07-20</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="ac4f" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">现代搜索的基础是什么？简单的概念。</h2></div><p id="627b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">你每天在网上搜索多少次？5, 20, 50?如果谷歌是你选择的搜索引擎，你可以在这里查看你的搜索历史。</p><p id="0ba4" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">尽管搜索深深地隐藏在我们的日常活动和与世界的互动中，但很少有人了解它是如何工作的。在这篇文章中，我致力于阐明搜索的基础。这是从实现一个搜索引擎，基于<a class="ae ky" href="https://research.google/pubs/pub334/" rel="noopener ugc nofollow" target="_blank">最初的谷歌实现。</a></p><figure class="la lb lc ld gt le gh gi paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="gh gi kz"><img src="../Images/56df49e22e3e5b09b588a3793ff28a6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wtSh126OuojKCmbt"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@dadaben_?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">本杰明达达</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="d090" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">首先，我们来看一个预备步骤:<strong class="ke io">了解 web 服务器</strong>。什么是<em class="lp">客户端-服务器</em> <em class="lp">基础设施</em>？您的电脑如何连接到网站？</p><p id="fedd" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">你将会看到当一个搜索引擎连接到你的电脑、网站或其他任何东西时会发生什么。</p><p id="635b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">然后，我们将浏览搜索引擎的三个基本部分:爬虫、索引器和 PageRank 算法。这些都会让你对构成互联网的<em class="lp">蜘蛛网的连接有更深刻的理解。</em></p><p id="cb58" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">最后，我们将看看这些组件是如何组合起来产生我们的最终奖品:搜索引擎！准备好开始了吗？我们走吧！</p></div><div class="ab cl lq lr hr ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ig ih ii ij ik"><h1 id="4754" class="lx ly in bd lz ma mb mc md me mf mg mh jt mi ju mj jw mk jx ml jz mm ka mn mo bi translated">第 0 部分:Web 服务器</h1><p id="b2d0" class="pw-post-body-paragraph kc kd in ke b kf mp jo kh ki mq jr kk kl mr kn ko kp ms kr ks kt mt kv kw kx ig bi translated">强大的网络服务器！每当您在浏览器中搜索 URL 时，您的计算机都会联系 web 服务器。您的浏览器充当客户端，发送请求，类似于业务客户端。服务器是接受所有这些请求的销售代表，并行处理它们。</p><p id="6f18" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">请求是文本。服务器知道如何读取它们，因为它希望它们具有特定的结构(现在最常见的协议/结构是<a class="ae ky" href="https://datatracker.ietf.org/doc/html/rfc2616" rel="noopener ugc nofollow" target="_blank"> HTTP/1.1 </a>)。</p><p id="9e68" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">示例请求:</p><pre class="la lb lc ld gt mu mv mw mx aw my bi"><span id="d3e5" class="mz ly in mv b gy na nb l nc nd">GET /hello HTTP/1.1<br/>User-Agent: Mozilla/4.0 (compatible; MSIE5.01; Windows NT)<br/>Host: <a class="ae ky" href="http://www.sample-why-david-y.com" rel="noopener ugc nofollow" target="_blank">www.sample-why-david-y.com</a><br/>Accept-Language: en-us<br/>Accept-Encoding: gzip, deflate<br/>Connection: Keep-Alive<br/>Cookie: user=why-david-y</span></pre><p id="718b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">请求可以有参数，由它的 cookies 列表给出。它可能有一个包含更多信息的主体。响应遵循类似的格式，允许服务器返回参数和主体供客户端读取。随着互联网变得越来越互动，所有生成内容的艰苦工作都在服务器上完成。</p><p id="f9bb" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果您想对 web 服务器或客户机进行编程，有许多库可供您完成大部分解析和底层工作。请记住，客户端请求和服务器响应只是一种组织文本的方式。这意味着我们都在说一种共同的语言！</p></div><div class="ab cl lq lr hr ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ig ih ii ij ik"><h1 id="7e87" class="lx ly in bd lz ma mb mc md me mf mg mh jt mi ju mj jw mk jx ml jz mm ka mn mo bi translated">第 1 部分:爬行器</h1><p id="32b0" class="pw-post-body-paragraph kc kd in ke b kf mp jo kh ki mq jr kk kl mr kn ko kp ms kr ks kt mt kv kw kx ig bi translated">如果你正在构建一个搜索引擎，爬虫是你花费大量时间的地方。爬虫浏览开放的互联网，从预定义的种子列表开始(例如 Wikipedia.com、NYT.com、NYT.com)。它将读取每一页，保存它，并将新链接添加到它的 URL 边界，这是它要抓取的链接队列</p><figure class="la lb lc ld gt le gh gi paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="gh gi ne"><img src="../Images/0cb671d33cbccc58ce54822c2ec80ac4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UWUbrKjZd3txrfbZ"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@grievek1610begur?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">凯文悲伤</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></figcaption></figure><p id="9e0d" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">许多域名也有一个<strong class="ke io"> robots.txt 文件</strong>，比如 google.com/robots.txt.这个页面规定了爬虫必须遵守的规则，以避免违反任何法律或被视为垃圾邮件制造者。例如，某些子域不能被抓取，每次抓取之间可能有一个最短时间。</p><p id="bc02" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为什么这么多时间花在这里？互联网非常松散，是无政府主义者的梦想。当然，我们可能有一些达成一致的规范，但是<strong class="ke io">直到你写了一个爬虫</strong>你才会意识到它们被破坏了多少。</p><p id="3fc8" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">例如，假设你的爬虫读取 HTML 页面，因为它们是有结构的。例如，作者仍然可以将非链接放在链接标签中，破坏程序中的一些隐含逻辑。可能会有电子邮件(test@test.com)、句子和其他文本被您的验证遗漏。</p><p id="cd18" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">你可能在爬一个每次看起来都不一样但实际上生成动态内容的页面，比如包括当前时间？如果页面 A 重定向到 B，B 重定向到 C，C 重定向到 A 怎么办？如果一个日历有无数个未来年份或日子的链接呢？</p><p id="be91" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这些是爬行数百万页面时可能出现的许多情况中的一些<strong class="ke io"/>，并且<strong class="ke io">每个边缘情况都需要被覆盖或可恢复</strong>。</p></div><div class="ab cl lq lr hr ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ig ih ii ij ik"><h1 id="e3f5" class="lx ly in bd lz ma mb mc md me mf mg mh jt mi ju mj jw mk jx ml jz mm ka mn mo bi translated">第 2 部分:索引</h1><p id="95de" class="pw-post-body-paragraph kc kd in ke b kf mp jo kh ki mq jr kk kl mr kn ko kp ms kr ks kt mt kv kw kx ig bi translated">一旦你将抓取的内容保存在数据库中，接下来就是索引了！当用户搜索一个术语时，他们希望快速得到准确的结果。这就是索引如此重要的地方。您决定哪些指标对您最重要，然后从抓取的文档中提取它们。以下是一些常见的:</p><ul class=""><li id="5884" class="nf ng in ke b kf kg ki kj kl nh kp ni kt nj kx nk nl nm nn bi translated"><strong class="ke io">前向索引</strong>:这是一个数据结构，按顺序保存一个文档列表及其相关单词。例如:</li></ul><pre class="la lb lc ld gt mu mv mw mx aw my bi"><span id="bada" class="mz ly in mv b gy na nb l nc nd">document1, &lt;word1, word2, word3&gt;<br/>document2, &lt;word2, word3&gt;</span></pre><ul class=""><li id="8fc9" class="nf ng in ke b kf kg ki kj kl nh kp ni kt nj kx nk nl nm nn bi translated"><strong class="ke io">倒排索引</strong>:这是一个保存单词列表的数据结构，文档中包含这个单词。例如:</li></ul><pre class="la lb lc ld gt mu mv mw mx aw my bi"><span id="9f26" class="mz ly in mv b gy na nb l nc nd">word1, &lt;document2, document3, document4&gt;<br/>word2, &lt;document1, document2&gt;</span></pre><ul class=""><li id="8625" class="nf ng in ke b kf kg ki kj kl nh kp ni kt nj kx nk nl nm nn bi translated"><strong class="ke io">词频(TF) </strong>:这是为每个文档中的每个唯一单词存储的度量。它通常计算为该单词出现的次数除以文档中的单词数，得到一个介于 0 和 1 之间的值。一些单词可能被赋予更大的权重(例如特殊标签)，并且 TF 可能被标准化，以防止极端值。</li><li id="9d04" class="nf ng in ke b kf no ki np kl nq kp nr kt ns kx nk nl nm nn bi translated"><strong class="ke io">逆文档频率(IDF) </strong>:这是为每个唯一单词存储的度量。它通常计算为包含该单词的文档数除以文档总数。考虑到它需要文档的数量，通常在爬行之后或在查询时计算。它可以被标准化以防止极端值。</li></ul><p id="b0c3" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="ke io">有了这四个值，你可以设计一个索引器来返回准确的结果。</strong>随着当前数据库的优化，结果也将<strong class="ke io">相当快</strong>。<em class="lp">使用 MongoDB，我们的项目使用这些在大约 2 秒内返回结果，甚至对于更长的查询。仅用这四个指标，您就可以做得更多——例如，允许精确匹配查询。</em></p><p id="41ae" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这些是早期搜索引擎使用的基本指标。现在，搜索引擎使用这些以及更多的工具来进一步微调他们的搜索结果。</p><p id="5dd9" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们如何将这些结合起来产生结果？我们将在集成部分讨论这一点。</p></div><div class="ab cl lq lr hr ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ig ih ii ij ik"><h1 id="1a22" class="lx ly in bd lz ma mb mc md me mf mg mh jt mi ju mj jw mk jx ml jz mm ka mn mo bi translated">第 3 部分:PageRank</h1><p id="6fbc" class="pw-post-body-paragraph kc kd in ke b kf mp jo kh ki mq jr kk kl mr kn ko kp ms kr ks kt mt kv kw kx ig bi translated">PageRank 是一种算法，用于确定互联网上某个页面的<strong class="ke io">权威性。假设有人在搜索“地球日”我们需要看看一个页面有多可信。如果我们不这样做，我们的搜索引擎会把它们发送到一个随机的博客页面，上面反复写着“地球日”，而不是维基百科或 EarthDay.org 页面。<strong class="ke io">随着搜索引擎优化和营销人员试图增加页面流量的盛行，我们如何确保用户获得高质量的结果？</strong></strong></p><p id="80a7" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">PageRank 查看页面之间的链接，将它们视为一个图<em class="lp">(一组节点和顶点)</em>。每个顶点是它所指向的方向上的两个节点之间的连接<em class="lp">(源 URL 到目的 URL) </em></p><p id="7a6e" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">比如说 Google.com，在每次迭代中，算法都会查看所有指向一个页面的 URL。根据这些网页还指向多少其他网址，它会给谷歌一定比例的推荐人的网页排名。几次迭代后，PageRank 值相对稳定，算法终止。</p><figure class="la lb lc ld gt le gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/d5b0654569af71fba6696b370b7e7975.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*yi0dFYM11I8DTg9Rq3GXjA.png"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">来源:<a class="ae ky" href="https://en.wikipedia.org/wiki/PageRank#/media/File:PageRanks-Example.jpg" rel="noopener ugc nofollow" target="_blank">https://en . Wikipedia . org/wiki/page rank #/media/File:page ranks-example . jpg</a></figcaption></figure><p id="2231" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">还使用了其他技巧，如<a class="ae ky" href="https://en.wikipedia.org/wiki/Random_surfing_model" rel="noopener ugc nofollow" target="_blank">随机冲浪者</a>，它假设用户在某个百分比的时间里感到无聊并点击进入一个新页面。这些技巧旨在避免 PageRank 的死角。例如，由于没有出站链接，接收器是可以吸收所有 PageRank 的页面。</p></div><div class="ab cl lq lr hr ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ig ih ii ij ik"><h1 id="ac61" class="lx ly in bd lz ma mb mc md me mf mg mh jt mi ju mj jw mk jx ml jz mm ka mn mo bi translated">把所有的放在一起</h1><p id="fa9b" class="pw-post-body-paragraph kc kd in ke b kf mp jo kh ki mq jr kk kl mr kn ko kp ms kr ks kt mt kv kw kx ig bi translated"><em class="lp">你现在已经拥有了搜索引擎的主要部分。</em></p><p id="1b98" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">当用户搜索一个短语时，您可以查找哪些文档中包含每个查询词。您的数据库返回匹配所有术语的文档。</p><p id="74c0" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">对于每个文档，您可以获取每个查询词的 TFIDF (TF * IDF ),并将它们加在一起。然后，将总和与该页面的页面排名<em class="lp">(例如，将它们相乘)</em>。这与其说是一门科学，不如说是一门艺术，所以留下时间来看看什么是有效的，并在过程中进行微调。</p><p id="b632" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在，只要客户端向您的服务器的 URL 发出请求，您的引擎就可以返回排序后的结果。正如在第 0 部分中所讨论的，所有这些工作都是在服务器中完成的。<strong class="ke io">客户端发出请求，服务器以预期的格式将结果返回给客户端。</strong></p><p id="fa6d" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">从这里，您可以:</p><ul class=""><li id="6073" class="nf ng in ke b kf kg ki kj kl nh kp ni kt nj kx nk nl nm nn bi translated">向数据库添加新的索引指标，以创建更高质量的结果</li><li id="21aa" class="nf ng in ke b kf no ki np kl nq kp nr kt ns kx nk nl nm nn bi translated">优化您的查询以加快查询速度</li><li id="87d1" class="nf ng in ke b kf no ki np kl nq kp nr kt ns kx nk nl nm nn bi translated">在您的引擎中构建新功能</li></ul><p id="03c5" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="ke io"> <em class="lp">恭喜你，你现在可以构建自己的搜索引擎了！</em>T13】</strong></p><figure class="la lb lc ld gt le gh gi paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="gh gi nu"><img src="../Images/13b8ce2076b5b06afb4d8c526de7c48d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7jRm76rujKxHWxuu"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">马库斯·温克勒在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure></div></div>    
</body>
</html>