# ä½¿ç”¨ Swift 5 ä¸º iOS è®¾è®¡ä¸€ä¸ªæ¼‚äº®çš„æ°´å¹³æ»‘åŠ¨æ¼”ç¤º

> åŸæ–‡ï¼š<https://blog.devgenius.io/design-a-nice-horizontal-sliding-presentation-for-ios-using-swift-5-79706e27a087?source=collection_archive---------3----------------------->

## æ»šåŠ¨æœŸé—´åŠ¨ç”»è§†å›¾çš„å¤§å°å’Œä½ç½®â€”ç¬¬ 3a éƒ¨åˆ†

![](img/2b6bea8a5128d321ff6b3541ebe76fd2.png)

æœ€åæ˜¯æ•™ç¨‹çš„æœ€åä¸€éƒ¨åˆ†:è§†å›¾çš„åŠ¨ç”»ï¼å¦‚æœä½ æ˜¯æ–°æ¥çš„ï¼Œè¯·åœ¨è¿™é‡Œæ‰¾åˆ°æˆ‘ä»¥å‰çš„æ•™ç¨‹:

*   [ç¬¬ä¸€éƒ¨åˆ†](https://betterprogramming.pub/design-a-nice-horizontal-sliding-presentation-for-ios-using-uiscrollview-and-uipagecontrol-swift-2c4fa1b11403)
*   [ç¬¬äºŒéƒ¨åˆ†](https://medium.com/@margels/design-a-nice-horizontal-sliding-presentation-for-ios-using-swift-5-b312b9b1bbbc)

å‡†å¤‡å¥½é‡æ–°å¼€å§‹äº†å—ï¼Ÿ

# ç¬¬ 3 éƒ¨åˆ†:æ»šåŠ¨è§†å›¾æ—¶åˆ¶ä½œåŠ¨ç”»

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†äº†è§£å¦‚ä½•:

*   ç¿»é¡µæŸ¥çœ‹æˆ‘ä»¬çš„æ»šåŠ¨è§†å›¾ï¼Œ
*   ç”¨æˆ‘ä»¬çš„å¹»ç¯ç‰‡å¡«å……å®ƒï¼Œ
*   æ»šåŠ¨æ—¶åŠ¨ç”»æ˜¾ç¤ºå®ƒä»¬ã€‚

è¿™å°†æ˜¯ä¸€ä¸ªå†—é•¿çš„è§£é‡Šï¼Œæ‰€ä»¥å°†æœ‰ä¸€ä¸ª 3b éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†é€šè¿‡ç…§ç‰‡ä¸­çš„åŠ¨ç”»çš„å…¶ä½™éƒ¨åˆ†ã€‚

è¯´å¤Ÿäº†ï¼Œæˆ‘ä»¬å¼€å§‹å§ï¼

## ç¬¬ä¸€æ­¥:å‡†å¤‡å¹»ç¯ç‰‡

é¦–å…ˆ:å¹»ç¯ç‰‡ï¼ç°åœ¨ï¼Œæˆ‘ä»¬åªæœ‰ä¸€ä¸ªåœ¨è§†å›¾æ§åˆ¶å™¨ä¸­è®¾ç½®çš„æ»šåŠ¨è§†å›¾ï¼Œé‡Œé¢æ²¡æœ‰è§†å›¾ã€‚æˆ‘ä»¬å·²ç»å»ºç«‹äº†æ¯ä¸ªè§†å›¾çš„æ¡†æ¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åšçš„æ˜¯ä½¿ç”¨å®ƒæ¥åˆ›å»ºå¤šä¸ªå¹»ç¯ç‰‡ã€‚

åˆ›å»ºä¸€ä¸ªåä¸º`getSlides`çš„å‡½æ•°æ¥åˆ›å»ºå¹»ç¯ç‰‡ã€‚åœ¨æ­¤åŠŸèƒ½ä¸­ï¼Œæˆ‘ä»¬å°†:

*   ä½¿ç”¨å®Œæˆå¤„ç†ç¨‹åºæ¥ä¼ é€’ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œä»¥ç¡®è®¤å¹»ç¯ç‰‡ä½•æ—¶å‡†å¤‡å¥½ï¼›
*   ä½¿ç”¨ for-in å¾ªç¯ä¸ºæˆ‘ä»¬åœ¨æœ¬æ•™ç¨‹ç¬¬ 2 éƒ¨åˆ†ä¸­å®šä¹‰çš„æ¯ä¸ª`slides`åˆ›å»ºä¸€ä¸ªå¹»ç¯ç‰‡ï¼›
*   ç”¨æ¯å¼ å¹»ç¯ç‰‡çš„æ ‡é¢˜å’Œå‰¯æ ‡é¢˜å€¼å¡«å……å¹»ç¯ç‰‡çš„æ ‡é¢˜å’Œå‰¯æ ‡é¢˜ï¼›
*   å°†å¹»ç¯ç‰‡è§†å›¾æ·»åŠ åˆ°æ•°ç»„`presentationSlides`ã€‚

è¯¥å‡½æ•°å°†å¦‚ä¸‹æ‰€ç¤º:

è¿”å›åˆ°æ‚¨çš„`viewDidLoad()`å‡½æ•°ï¼Œæ·»åŠ å‡½æ•°`getSlides`ï¼Œè¿™æ ·è§†å›¾å°†å¼€å§‹åŠ è½½å¹»ç¯ç‰‡:

```
// prepare slides
self.getSlides { success in}
```

æˆåŠŸå€¼å°†å†³å®šæ‰€æœ‰å¹»ç¯ç‰‡ä½•æ—¶å®Œæˆï¼Œä»¥åŠä½•æ—¶è¿è¡Œä»£ç çš„ä¸‹ä¸€éƒ¨åˆ†ã€‚

## ç¬¬äºŒæ­¥:è®¡ç®—æ—¶é—´é—´éš”

æ»šåŠ¨è§†å›¾çš„å†…å®¹å®½åº¦åº”è¯¥å¯¹åº”äºè§†å›¾å®½åº¦ä¹˜ä»¥å¹»ç¯ç‰‡æ•°é‡ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœä½ çš„è§†å›¾çš„å®½åº¦æ˜¯ 100ï¼Œä½ æœ‰ 5 å¼ åŒæ ·å¤§å°çš„å¹»ç¯ç‰‡ï¼Œå½“ä»£ç ç¼–è¯‘æ—¶ï¼Œæ»šåŠ¨è§†å›¾çš„å†…å®¹å®½åº¦åº”è¯¥æ˜¯ 500ã€‚

![](img/19ead4a63673ae20b91e9101bf32ade3.png)

ç°åœ¨æˆ‘ä»¬çŸ¥é“ï¼Œå¯¹äºæ¯ 100 ä¸ªåƒç´ ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª 100 åƒç´ å®½çš„å¹»ç¯ç‰‡ï¼æ‰€ä»¥ï¼Œå‡†ç¡®çš„è¯´â€¦

*   ç¬¬ä¸€å¼ å¹»ç¯ç‰‡å°†ä»åƒç´  0 å¼€å§‹ï¼›
*   ç¬¬äºŒï¼Œåœ¨åƒç´  100 å¤„ï¼›
*   ç¬¬ä¸‰ï¼Œåœ¨åƒç´  200 å¤„ï¼›
*   ç¬¬å››ï¼Œåœ¨åƒç´  300 å¤„ï¼Œ
*   æœ€åï¼Œç¬¬äº”ä¸ªåœ¨åƒç´  400 å¤„(æ³¨æ„ï¼Œåœ¨åƒç´  500 å¤„ï¼Œé™¤äº†æœ€åä¸€å¼ å¹»ç¯ç‰‡çš„å³è¾¹ç¼˜ï¼Œæˆ‘ä»¬ä¸åº”è¯¥æœ‰ä»»ä½•ä¸œè¥¿ï¼Œå› ä¸ºé‚£æ˜¯æˆ‘ä»¬å†…å®¹è§†å›¾çš„ç»“å°¾)ã€‚

å¬èµ·æ¥å¾ˆå®¹æ˜“ï¼å¦å¤–ï¼Œè°ä¸çˆ±ç®€å•çš„ï¼Œæ•´æ•°å‘¢ï¼Ÿâ€¦å¯æƒœå®ƒä»¬åœ¨ç°å®ä¸­å¹¶ä¸å­˜åœ¨ã€‚ä¸ç”µè§†æœºçš„éŸ³é‡ä¸åŒï¼Œå¤§å¤šæ•°è§†å›¾çš„å¤§å°å¯ä»¥ç”¨ä¸èƒ½è¢« 2 æˆ– 5 æ•´é™¤çš„æ•°å­—æ¥è¡¨ç¤ºã€‚å»æƒ³æƒ³â€¦

é‚£ä¹ˆï¼Œæˆ‘ä»¬å¦‚ä½•åœ¨ä¸ä½¿ç”¨è®¡ç®—å™¨çš„æƒ…å†µä¸‹ï¼Œä»å¥‡æ€ªéš¾çœ‹çš„æ•°å­—ä¸­å¾—åˆ°è¿™äº›åŒºé—´å‘¢ï¼Ÿå¾ˆç®€å•ï¼é¦–å…ˆï¼Œä½ éœ€è¦ä¸€ä»½å¤§è·¨æ­¥çš„å£°æ˜ã€‚

> stride è¯­å¥]è¿”å›ä¸€ä¸ªåºåˆ—ï¼Œä»èµ·å§‹å€¼å‘ç»“æŸå€¼(å¯èƒ½åŒ…æ‹¬ç»“æŸå€¼)æ­¥è¿›æŒ‡å®šçš„é‡ã€‚

ä½ å¯¹å®ƒç†Ÿæ‚‰å—ï¼Ÿæœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥ä½¿ç”¨ stride è¯­å¥:

*   `stride(from:through:by:)`å¦‚æœæ‚¨å¸Œæœ›åºåˆ—åŒ…æ‹¬ç»“æŸå€¼ï¼Œå¹¶ä¸”
*   `stride(from:to:by:)`å¦‚æœå¸Œæœ›åºåˆ—æ’é™¤ç»“æŸå€¼ã€‚

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†è®¡ç®—ä» 0(ç¬¬ä¸€å¼ å¹»ç¯ç‰‡çš„èµ·å§‹ x ç‚¹)åˆ° 1(æœ€åä¸€å¼ å¹»ç¯ç‰‡çš„èµ·å§‹ x ç‚¹)çš„é—´éš”ï¼Œä½¿ç”¨æ•°å­— 1 é™¤ä»¥å¹»ç¯ç‰‡çš„æ•°é‡ï¼Œå‡å» 1ã€‚

å¥½å§ï¼Œæˆ‘æ˜ç™½äº†ï¼Œå¬èµ·æ¥å¥½åƒæˆ‘åœ¨è§£é‡Šé‡å­åŠ›å­¦ã€‚ä¸è¿‡ï¼Œæˆ‘çŸ¥é“å¦‚ä½•å˜å¾—ä¸é‚£ä¹ˆæ— èŠï¼Œæ‰€ä»¥è¿™é‡Œæœ‰æ›´å¤šçš„å›¾ç”»:

![](img/c2f9dd770d95fd95701d6bd000aedcf7.png)

è¯·æ³¨æ„ï¼Œè¯¥é™¤æ³•æ˜¯ç”¨æ€»å¹»ç¯ç‰‡æ•°å‡ä¸€æ¥è®¡ç®—çš„ã€‚è¿™æ˜¯å› ä¸ºä½ éœ€è¦çš„åªæ˜¯ä¸­é—´ç©ºæ ¼çš„åç§»é‡ï¼Œè€Œè¿™äº›ç©ºæ ¼æ€»æ˜¯æ¯”å¹»ç¯ç‰‡çš„æ€»æ•°å°‘ä¸€ä¸ªã€‚è¿·èŒ«ï¼Ÿæƒ³æƒ³äº”å£°éŸ³é˜¶:5 è¡Œï¼Œ4 æ ¼ã€‚ç”šè‡³ç­‰å·:`=`ã€‚ä¸¤è¡Œä¹‹é—´æœ‰å¤šå°‘ç©ºæ ¼ï¼Ÿ

> å¯¹äºä»ç„¶å›°æƒ‘çš„ã€Šç”Ÿæ´»å¤§çˆ†ç‚¸ã€‹ç²‰ä¸æ¥è¯´:ä½ çŸ¥é“ä½©å¦®ä¹Ÿæœ‰ä½ åŒæ ·çš„ç–‘é—®å—ï¼Ÿçœ‹çœ‹ç¬¬ 12 å­£ç¬¬ 5 é›† 9.22 åˆ†é’Ÿï¼Œçœ‹çœ‹ç§‘å­¦å®¶çš„è§£é‡Šæ˜¯å¦èƒ½æ¶ˆé™¤æ‰€æœ‰ç–‘é—®ã€‚

æˆ‘ä»¬æƒ³åšçš„æ˜¯æ‰¾å‡º:

*   å¹»ç¯ç‰‡ä½•æ—¶åº”è¯¥ç¼©å°å’Œæ”¾å¤§ï¼Œå–å†³äºæ²¿ç€æ»šåŠ¨è§†å›¾çš„ä½ç½®ï¼Œä»¥åŠæ”¾å¤§å¤šå°‘ï¼›
*   é¡µé¢æ§ä»¶ä¸Šåº”è¯¥æ˜¾ç¤ºå“ªä¸€é¡µ(æ‰“èµŒä½ å¿˜äº†é‚£ä¸€é¡µï¼Œæˆ‘ä¸€ç›´åœ¨ç»™ä½ çŒè¾“è¿™ä¹ˆå¤šä¿¡æ¯å’Œå…¬å¼)ã€‚

ä»¥æˆ‘ä»¬ä¹‹å‰çš„ä¾‹å­ä¸ºä¾‹ï¼Œæˆ‘ä»¬çš„æ­¥å¹…å…¬å¼åº”è¯¥æ˜¯è¿™æ ·çš„

```
stride(from: 0.0, through: 1.0, by: (1/(slides.count-1)))
```

è¾“å‡ºåº”è¯¥æ˜¯[0ï¼Œ0.25ï¼Œ0.5ï¼Œ0.75ï¼Œ1]ï¼Œå®ƒä»¬è¡¨ç¤ºæˆ‘ä»¬çš„æ»šåŠ¨è§†å›¾å†…å®¹è§†å›¾ä¸­ 5 å¼ å¹»ç¯ç‰‡çš„èµ·å§‹ x ç‚¹çš„æ¯”ç‡ã€‚

ä¸‹é¢æ˜¯æ•´ä¸ªå‡½æ•°:

åœ¨æˆ‘ä»¬ç»§ç»­ä¹‹å‰ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º`intervals`çš„å±æ€§ï¼ŒåŒ…å«æˆ‘ä»¬å°†ä»`getIntervals`å‡½æ•°ä¸­è·å¾—çš„ CGFloats æ•°ç»„:

```
var intervals: [CGFloat] = []
```

å½“ç„¶ï¼Œç°åœ¨æˆ‘ä»¬éœ€è¦å‘Šè¯‰æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæ»šåŠ¨è§†å›¾åº”è¯¥:

*   å®½åº¦è¶³ä»¥å®¹çº³æˆ‘ä»¬çš„ 6 å¼ å¹»ç¯ç‰‡(æˆ–å¤šæˆ–å°‘ï¼Œå¦‚æœä½ æ„¿æ„)ï¼›
*   å¯ç”¨åˆ†é¡µä»¥å®šä¹‰ç”¨æˆ·æ»šåŠ¨å¹»ç¯ç‰‡çš„æ–¹å¼ï¼›
*   æ·»åŠ å®é™…å¹»ç¯ç‰‡ï¼ŒæŒ‰ç…§ä¸Šè¿°æ ‡å‡†å®šä¹‰ä½ç½®å’Œå¤§å°ã€‚

åœ¨ä»£ç ä¸­:

ç°åœ¨å›åˆ°ä½ çš„`viewDidLoad`å¹¶åœ¨`getSlides`å‡½æ•°ä¸­ï¼Œæ·»åŠ æˆ‘ä»¬çš„ä¸¤ä¸ªæ–°å‡½æ•°å’Œä¸€è¡Œä»£ç æ¥è®¾ç½®æˆ‘ä»¬çš„æ»šåŠ¨è§†å›¾çš„ä»£ç†ä¸º selfã€‚

```
// prepare slides
self.getSlides { success in// calculate x position of each slide and set up pages
   self.intervals = self.getIntervals(pages: self**.**slides.count)
   self.presentationScrollView.delegate = selfself.setupSlideScrollView(slides: self.presentationSlides)
}
```

æ²¡æœ‰äº†è¡Œ`self.presentationScrollView.delegate = self`,æˆ‘ä»¬çš„æ»šåŠ¨è§†å›¾å°†ä¸èƒ½ä¼ è¾¾æ»šåŠ¨è§†å›¾ä¸Šçš„ä»»ä½•å˜åŒ–ï¼Œå› æ­¤ï¼Œä¸èƒ½åœ¨æˆ‘ä»¬çš„è§†å›¾ä¸Šæ‰§è¡Œä»»ä½•æ“ä½œã€‚

ç°åœ¨ä¸€åˆ‡éƒ½åº”è¯¥çœ‹èµ·æ¥ä¸é”™ï¼Œé™¤äº†ä¸€ä»¶äº‹:æˆ‘ä»¬çš„æ»šåŠ¨è§†å›¾å§”æ‰˜è¡Œä¸Šçš„çº¢è‰²é”™è¯¯æ˜¯ä»€ä¹ˆï¼Ÿ

## æ­¥éª¤ 3:è®¾ç½®æ»šåŠ¨è§†å›¾ä»£ç†

ç®€å•çš„è§£å†³æ–¹æ³•:åœ¨è§†å›¾æ§åˆ¶å™¨çš„æœ«å°¾æ·»åŠ ä¸‹é¢å‡ è¡Œä»£ç ï¼Œç”¨`UIScrollViewDelegate`åˆ›å»ºå®ƒçš„æ‰©å±•ï¼Œå¹¶æ·»åŠ æ–¹æ³•`scrollViewDidScroll`ï¼Œä»¥ä¾¿åœ¨ç”¨æˆ·æ»šåŠ¨æ—¶ä¸æˆ‘ä»¬çš„è§†å›¾è¿›è¡Œé€šä¿¡ã€‚

```
extension **ViewController**: UIScrollViewDelegate { func **scrollViewDidScroll**(_ scrollView: UIScrollView) { }}
```

åœ¨æ‚¨çš„`scrollViewDidScroll`å‡½æ•°ä¸­ï¼Œæ·»åŠ  [Anitaa Murthy](https://medium.com/u/b69ba9cd4ff2?source=post_page-----79706e27a087--------------------------------) æ•™ç¨‹ä¸­çš„ä»¥ä¸‹ä»£ç è¡Œï¼Œè®¡ç®—æ‚¨æ»šåŠ¨æ—¶è§†å›¾çš„åç§»é‡:

```
 // get the current scrolling offset
    let **maximumHorizontalOffset**: CGFloat = scrollView.contentSize.width - scrollView.frame.width
    let **currentHorizontalOffset**: CGFloat = scrollView.contentOffset.x
    let **maximumVerticalOffset**: CGFloat = scrollView.contentSize.height - view.frame.height
    let **currentVerticalOffset**: CGFloat = scrollView.contentOffset.y
    let **percentageHorizontalOffset**: CGFloat = currentHorizontalOffset / maximumHorizontalOffset
    let **percentageVerticalOffset**: CGFloat = currentVerticalOffset / maximumVerticalOffset
    let **percentOffset**: CGPoint = CGPoint(x: percentageHorizontalOffset, y: percentageVerticalOffset)
```

ä¸é”™ï¼ç°åœ¨ï¼Œæˆ‘ä»¬æ¯æ»šåŠ¨ä¸€æ¬¡ï¼Œ`scrollViewDidScroll`å‡½æ•°å°±ä¼šè®¡ç®—æˆ‘ä»¬è§†å›¾çš„åç§»é‡ã€‚æˆ‘ä»¬æƒ³è¦çš„æ˜¯`x`å€¼ï¼Œå› ä¸ºæˆ‘ä»¬çš„å¹»ç¯ç‰‡å°†æ°´å¹³æ»šåŠ¨ã€‚

ä¸ºäº†æµ‹è¯•å®ƒï¼Œç”¨æ»šåŠ¨è§†å›¾çš„`percentOffset.x`å€¼åšä¸€ä¸ª`print`è¯­å¥:

![](img/7af8803b12595e1d80dfd4a89cdce82e.png)

å¦‚æ‚¨æ‰€è§ï¼Œå½“æ‚¨æ»šåŠ¨æ—¶ï¼Œæ§åˆ¶å°å°†æ‰“å°æ‚¨çš„`x`ä½ç½®çš„åç§»ã€‚æ‚¨æ‰€è¦åšçš„å°±æ˜¯å°†å®ƒè¿æ¥åˆ°è§†å›¾ä¸­çš„å…ƒç´ ï¼Œä»¥å®šä¹‰å®ƒä»¬çš„ä½ç½®å’Œå¤§å°ï¼

åœ¨æˆ‘ä»¬è¿™æ ·åšä¹‹å‰ï¼Œè¿›å…¥æ‚¨çš„`viewDidLoad`æ–¹æ³•å†…éƒ¨ï¼Œå…·ä½“æ¥è¯´ï¼Œè¿›å…¥æ–¹æ³•`self.getSlides`çš„é—­åŒ…å†…éƒ¨ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹ä»£ç è¡Œæ¥è®¾ç½®æ‚¨çš„`UIPageControl`ä½¿å…¶ä¸å¹»ç¯ç‰‡åŒæ­¥:

```
// set up page control and bring to front
self.presentationPageControl.numberOfPages = self.slides.count
self.presentationPageControl.currentPage = 0
self.presentationPageControl.isUserInteractionEnabled = falseself.view.bringSubviewToFront(self.presentationPageControl)
```

ä»Šå¤©å°±åˆ°è¿™é‡Œï¼Œä½†æ˜¯ä¸è¦æ‹…å¿ƒ:ç¬¬ä¸‰ç¯‡æ•™ç¨‹çš„ B éƒ¨åˆ†å¾ˆå¿«å°±ä¼šå‡ºæ¥ã€‚è¯·ç»§ç»­å…³æ³¨æˆ‘çš„å†…å®¹ï¼Œæˆ‘çš„æ–°æ•™ç¨‹ä¼šåŠæ—¶æ›´æ–°ï¼Œè¯·åœ¨ä¸‹é¢çš„è¯„è®ºä¸­å‘Šè¯‰æˆ‘ä½ çš„åé¦ˆï¼

ä½ å–œæ¬¢è¿™ä¸ªæ•™ç¨‹å—ï¼Ÿå®ƒå’Œä½ çš„é¡¹ç›®åˆä½œå¾—å¥½å—ï¼Ÿ

```
**Want to Connect?** Follow me onâ€¦
â¤ï¸ [YouTube](https://www.youtube.com/channel/UC5hqYiHxie458KSO1PAnA8Q)
ğŸ’– [Dribbble](https://dribbble.com/margelss)
ğŸ’œ [Instagram](https://www.instagram.com/itsmargels/)
ğŸ’™ [Ko-Fi](https://ko-fi.com/margelss)
ğŸ–¤ [GitHub](https://github.com/Margels)
```