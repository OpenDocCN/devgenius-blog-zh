<html>
<head>
<title>Vee-Validate — Validation States and Form Validation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Vee-Validate —验证状态和表单验证</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/vee-validate-validation-states-and-form-validation-404c82541cda?source=collection_archive---------7-----------------------#2020-07-01">https://blog.devgenius.io/vee-validate-validation-states-and-form-validation-404c82541cda?source=collection_archive---------7-----------------------#2020-07-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/0ffd6a627ebeb02f284c864722eaebe1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-Md64zwGqYC5XopX"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@paige_cody?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Paige Cody </a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="4e94" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">表单验证是Vue.js没有内置的功能。</p><p id="5a03" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是，我们还是非常需要这个功能。</p><p id="c93e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解如何使用检查和显示验证状态。</p><p id="ff9b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们看看如何验证整个表单。</p><h1 id="1c74" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">验证状态</h1><p id="4079" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">除了显示<code class="fe me mf mg mh b">errors</code>，我们还可以检查表单的验证状态。</p><h1 id="9f40" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">旗帜</h1><p id="c25a" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">有许多可用的验证标志。它们包括:</p><ul class=""><li id="4551" class="mi mj iq kf b kg kh kk kl ko mk ks ml kw mm la mn mo mp mq bi translated"><code class="fe me mf mg mh b">valid</code> —检查字段是否有效</li><li id="69ac" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated"><code class="fe me mf mg mh b">invalid</code> —检查字段是否无效</li><li id="d86f" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated"><code class="fe me mf mg mh b">changed</code> —检查字段是否被更改</li><li id="3dec" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated"><code class="fe me mf mg mh b">touched</code> —检查某个区域是否被模糊了</li><li id="ca8c" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated"><code class="fe me mf mg mh b">untouched</code> —检查字段是否模糊</li><li id="97e8" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated"><code class="fe me mf mg mh b">pristine</code> —检查字段值是否未被操纵</li><li id="61cb" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated"><code class="fe me mf mg mh b">dirty</code> —检查字段值是否被操纵</li><li id="212c" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated"><code class="fe me mf mg mh b">pending</code> —指示字段验证是否正在进行</li><li id="7176" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated"><code class="fe me mf mg mh b">required</code> —检查字段是否为必填字段</li><li id="adb8" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated"><code class="fe me mf mg mh b">validated</code> —检查字段是否至少验证一次</li><li id="abc4" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated"><code class="fe me mf mg mh b">passed</code> —检查字段是否已经过验证，是否有效</li><li id="8420" class="mi mj iq kf b kg mr kk ms ko mt ks mu kw mv la mn mo mp mq bi translated"><code class="fe me mf mg mh b">failed</code> —检查字段是否已经过验证，是否无效</li></ul><p id="cf12" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它们可以作为吃角子老虎机道具。</p><p id="86e4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们可以通过书写来使用它们:</p><p id="aa0e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">main.js</code></p><pre class="mw mx my mz gt na mh nb nc aw nd bi"><span id="7d41" class="ne lc iq mh b gy nf ng l nh ni">import Vue from "vue";<br/>import App from "./App.vue";<br/>import { ValidationProvider, extend } from "vee-validate";<br/>import { required } from "vee-validate/dist/rules";</span><span id="8d04" class="ne lc iq mh b gy nj ng l nh ni">extend("required", required);<br/>Vue.component("ValidationProvider", ValidationProvider);</span><span id="6ed8" class="ne lc iq mh b gy nj ng l nh ni">Vue.config.productionTip = false;</span><span id="6c22" class="ne lc iq mh b gy nj ng l nh ni">new Vue({<br/>  render: h =&gt; h(App)<br/>}).$mount("#app");</span></pre><p id="a72c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">App.vue</code></p><pre class="mw mx my mz gt na mh nb nc aw nd bi"><span id="5c68" class="ne lc iq mh b gy nf ng l nh ni">&lt;template&gt;<br/>  &lt;div id="app"&gt;<br/>    &lt;ValidationProvider rules="required" v-slot="{ valid }"&gt;<br/>      &lt;input v-model="value" type="text"&gt;<br/>      &lt;span&gt;{{ valid }}&lt;/span&gt;<br/>    &lt;/ValidationProvider&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="1c1b" class="ne lc iq mh b gy nj ng l nh ni">&lt;script&gt;<br/>export default {<br/>  name: "App",<br/>  data() {<br/>    return {<br/>      value: ""<br/>    };<br/>  }<br/>};<br/>&lt;/script&gt;</span></pre><p id="5f12" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们只是从<code class="fe me mf mg mh b">v-slot</code>得到<code class="fe me mf mg mh b">valid</code>，并在它下面显示它的值。</p><h1 id="25e2" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">处理表单</h1><p id="7ddd" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">除了检查表单验证状态，我们还可以在提交之前检查表单的所有值是否都有效。</p><p id="57dd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><p id="10be" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">main.js</code></p><pre class="mw mx my mz gt na mh nb nc aw nd bi"><span id="085d" class="ne lc iq mh b gy nf ng l nh ni">import Vue from "vue";<br/>import App from "./App.vue";<br/>import { ValidationProvider, ValidationObserver, extend } from "vee-validate";<br/>import { required, alpha } from "vee-validate/dist/rules";</span><span id="a1b8" class="ne lc iq mh b gy nj ng l nh ni">extend("required", required);<br/>extend("alpha", alpha);</span><span id="5a79" class="ne lc iq mh b gy nj ng l nh ni">Vue.component("ValidationProvider", ValidationProvider);<br/>Vue.component("ValidationObserver", ValidationObserver);</span><span id="eff3" class="ne lc iq mh b gy nj ng l nh ni">Vue.config.productionTip = false;</span><span id="b50c" class="ne lc iq mh b gy nj ng l nh ni">new Vue({<br/>  render: h =&gt; h(App)<br/>}).$mount("#app");</span></pre><p id="027e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">App.vue</code></p><pre class="mw mx my mz gt na mh nb nc aw nd bi"><span id="921e" class="ne lc iq mh b gy nf ng l nh ni">&lt;template&gt;<br/>  &lt;div id="app"&gt;<br/>    &lt;ValidationObserver v-slot="{ handleSubmit }"&gt;<br/>      &lt;form <a class="ae kc" href="http://twitter.com/submit" rel="noopener ugc nofollow" target="_blank">@submit</a>.prevent="handleSubmit(onSubmit)"&gt;<br/>        &lt;ValidationProvider rules="required|alpha" v-slot="{ errors }"&gt;<br/>          &lt;input v-model="name" name="name" type="text"&gt;<br/>          &lt;span&gt;{{ errors[0] }}&lt;/span&gt;<br/>        &lt;/ValidationProvider&gt;<br/>        &lt;input type="submit" value="submit"&gt;<br/>      &lt;/form&gt;<br/>    &lt;/ValidationObserver&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="df53" class="ne lc iq mh b gy nj ng l nh ni">&lt;script&gt;<br/>export default {<br/>  name: "App",<br/>  data() {<br/>    return {<br/>      name: ""<br/>    };<br/>  },<br/>  methods: {<br/>    onSubmit() {<br/>      alert("submitted");<br/>    }<br/>  }<br/>};<br/>&lt;/script&gt;</span></pre><p id="127c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们导入了<code class="fe me mf mg mh b">required</code>和<code class="fe me mf mg mh b">alpha</code>规则。</p><p id="0d0e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，除了<code class="fe me mf mg mh b">ValidationProvider</code>之外，我们还导入了<code class="fe me mf mg mh b">ValidationObserver</code>组件。</p><p id="9ce8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将<code class="fe me mf mg mh b">ValidationProvider</code>嵌套在<code class="fe me mf mg mh b">ValidationObserver</code>中，以观察所有字段的验证状态。</p><p id="d7dc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">form</code>标签有提交处理程序，它是通过获取<code class="fe me mf mg mh b">handleSubmit</code>函数创建的。</p><p id="29ae" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们将自己的<code class="fe me mf mg mh b">onSubmit</code>方法传递给它。</p><p id="59d3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，当我们输入字母数据时，我们会看到“已提交”警报。</p><p id="f0b1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这意味着<code class="fe me mf mg mh b">onSubmit</code>被调用。</p><p id="537c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">否则，<code class="fe me mf mg mh b">onSubmit</code>就不会被称为。</p><p id="d479" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果它没有被调用，那么至少某些表单值是无效的。</p><h1 id="d348" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用$refs进行编程访问</h1><p id="c5ae" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过引用来访问表单验证状态。</p><p id="fda0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以通过编写以下代码来重写示例:</p><pre class="mw mx my mz gt na mh nb nc aw nd bi"><span id="4430" class="ne lc iq mh b gy nf ng l nh ni">&lt;template&gt;<br/>  &lt;div id="app"&gt;<br/>    &lt;ValidationObserver ref="form"&gt;<br/>      &lt;form <a class="ae kc" href="http://twitter.com/submit" rel="noopener ugc nofollow" target="_blank">@submit</a>.prevent="onSubmit"&gt;<br/>        &lt;ValidationProvider rules="required|alpha" v-slot="{ errors }"&gt;<br/>          &lt;input v-model="name" name="name" type="text"&gt;<br/>          &lt;span&gt;{{ errors[0] }}&lt;/span&gt;<br/>        &lt;/ValidationProvider&gt;<br/>        &lt;input type="submit" value="submit"&gt;<br/>      &lt;/form&gt;<br/>    &lt;/ValidationObserver&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="1be8" class="ne lc iq mh b gy nj ng l nh ni">&lt;script&gt;<br/>export default {<br/>  name: "App",<br/>  data() {<br/>    return {<br/>      name: ""<br/>    };<br/>  },<br/>  methods: {<br/>    async onSubmit() {<br/>      const success = await this.$refs.form.validate();<br/>      if (!success) {<br/>        return;<br/>      }<br/>      alert("submitted");<br/>      this.$nextTick(() =&gt; {<br/>        this.$refs.form.reset();<br/>      });<br/>    }<br/>  }<br/>};<br/>&lt;/script&gt;</span></pre><p id="f36d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将<code class="fe me mf mg mh b">ref</code>设为<code class="fe me mf mg mh b">'form'</code>。</p><p id="10fe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我们点击表单上的提交时，我们的<code class="fe me mf mg mh b">onSubmit</code>方法。</p><p id="782d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在<code class="fe me mf mg mh b">onSubmit</code>中，我们通过在<code class="fe me mf mg mh b">this.$refs.form</code>上运行<code class="fe me mf mg mh b">validate</code>方法来检查表单的有效性。</p><p id="5e65" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它返回一个具有<code class="fe me mf mg mh b">success</code>值的承诺。如果表单有效，则解析为<code class="fe me mf mg mh b">true</code>。</p><p id="3f12" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">否则就是<code class="fe me mf mg mh b">false</code>。</p><p id="91a7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，是<code class="fe me mf mg mh b">success</code>是<code class="fe me mf mg mh b">false</code>，我们停止运行<code class="fe me mf mg mh b">onSubmit</code>。</p><p id="2d9e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果表单有效，我们会显示“已提交”警告。</p><p id="ae22" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们重置<code class="fe me mf mg mh b">this.name</code>的值。</p><p id="eacf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在下一次使用<code class="fe me mf mg mh b">this.$nextTick</code>的渲染迭代中，我们使用<code class="fe me mf mg mh b">this.$refs.form.reset();</code>重置表单验证状态。</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/74db87d9639779ff954b95b288146d13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IBp5YZUjW9fm5hE7"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">由<a class="ae kc" href="https://unsplash.com/@memoreno?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马丁·莫雷诺</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="f1fa" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="a7fa" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用Vee-Validate来检查整个表单的验证状态。</p><p id="d77b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们使用<code class="fe me mf mg mh b">ValidationObserver</code>组件来观察表单的验证状态。</p><p id="4ba1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用内置的<code class="fe me mf mg mh b">handleSubmit</code>函数或者通过给<code class="fe me mf mg mh b">ValidationObserver</code>分配一个参考来检查。</p></div></div>    
</body>
</html>