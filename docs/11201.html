<html>
<head>
<title>Data Transformation in ETL Process</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ETL 过程中的数据转换</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/data-transformation-in-etl-process-d8efc8cf5338?source=collection_archive---------11-----------------------#2022-12-24">https://blog.devgenius.io/data-transformation-in-etl-process-d8efc8cf5338?source=collection_archive---------11-----------------------#2022-12-24</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/998cb09066e402093f282f75d12049aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_XVZf9-_CCyzw6OlWjgvjw.png"/></div></div></figure><p id="7247" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">当我们转换数据时，我们正在以某种方式修改它，以使它更适合特定的目的，或者从中提取更有意义的信息。转换数据的一些常见原因包括:</p><ol class=""><li id="b73a" class="kt ku in jx b jy jz kc kd kg kv kk kw ko kx ks ky kz la lb bi translated"><strong class="jx io">数据清理和预处理</strong>:转换数据有助于识别和修复错误或不一致，并为进一步分析准备数据。</li><li id="84b1" class="kt ku in jx b jy lc kc ld kg le kk lf ko lg ks ky kz la lb bi translated"><strong class="jx io">数据可视化</strong>:转换数据可以更容易地可视化数据中的模式或趋势，这有助于确定可能不会立即显现的关系和见解。</li><li id="e33d" class="kt ku in jx b jy lc kc ld kg le kk lf ko lg ks ky kz la lb bi translated"><strong class="jx io">特征工程</strong>:转换数据可用于创建新的特征或变量，这些特征或变量对特定任务或分析更有用或更相关。</li><li id="3b17" class="kt ku in jx b jy lc kc ld kg le kk lf ko lg ks ky kz la lb bi translated"><strong class="jx io">数据标准化</strong>:转换数据有助于标准化数据的规模或范围，这对于某些类型的分析或机器学习算法非常重要。</li><li id="9f83" class="kt ku in jx b jy lc kc ld kg le kk lf ko lg ks ky kz la lb bi translated"><strong class="jx io">数据聚合</strong>:转换数据可用于组合或汇总来自多个来源或不同粒度级别的数据，以便更容易分析或解释。</li></ol><p id="85c8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="lh">在本文中，您将了解以下与 ETL(提取、转换、加载)过程中的数据转换相关的主题:</em></p><ol class=""><li id="f689" class="kt ku in jx b jy jz kc kd kg kv kk kw ko kx ks ky kz la lb bi translated"><strong class="jx io"> <em class="lh">数据转换的定义及其在 ETL 过程中的作用</em> </strong></li><li id="8c58" class="kt ku in jx b jy lc kc ld kg le kk lf ko lg ks ky kz la lb bi translated"><strong class="jx io"><em class="lh">ETL 和 ELT 的区别</em> </strong></li><li id="187e" class="kt ku in jx b jy lc kc ld kg le kk lf ko lg ks ky kz la lb bi translated"><strong class="jx io"> <em class="lh">可以进行的各种类型的数据转换</em> </strong></li><li id="f747" class="kt ku in jx b jy lc kc ld kg le kk lf ko lg ks ky kz la lb bi translated"><strong class="jx io"> <em class="lh">如何为特定用例选择合适的数据转换</em> </strong></li></ol><blockquote class="li lj lk"><p id="c994" class="jv jw lh jx b jy jz ka kb kc kd ke kf ll kh ki kj lm kl km kn ln kp kq kr ks ig bi translated">数据转换是修改数据以使其对特定用途更有用或更有意义的过程。这通常作为 ETL(提取、转换、加载)或 ELT(提取、加载、转换)过程的一部分来完成，该过程涉及从多个源提取数据，根据需要转换数据，并将其加载到目标系统中。不同类型的数据转换包括数据清理、数据可视化、特征工程、数据规范化和数据聚合。要应用的适当的数据转换取决于手头的分析或任务的目标。</p></blockquote><h1 id="ea8a" class="lo lp in bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">数据转换及其在 ETL 过程中的作用</h1><p id="76ce" class="pw-post-body-paragraph jv jw in jx b jy mm ka kb kc mn ke kf kg mo ki kj kk mp km kn ko mq kq kr ks ig bi translated">数据转换是 ETL(提取、转换、加载)过程中的一个重要步骤，ETL 是将来自多个源的数据移动和集成到目标系统中的一种常用方法。数据转换的目标是以某种方式修改数据，使其更适合特定的目的，或者从中提取更有意义的信息。</p><p id="3b54" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在 ETL 过程的转换步骤中，数据以满足目标系统需求的方式被清理、转换和结构化。这可能涉及以下任务:</p><ul class=""><li id="a35e" class="kt ku in jx b jy jz kc kd kg kv kk kw ko kx ks mr kz la lb bi translated"><em class="lh">消除数据中的错误或不一致</em></li><li id="a7b6" class="kt ku in jx b jy lc kc ld kg le kk lf ko lg ks mr kz la lb bi translated"><em class="lh">数据格式标准化</em></li><li id="cbc8" class="kt ku in jx b jy lc kc ld kg le kk lf ko lg ks mr kz la lb bi translated"><em class="lh">对数据进行过滤或子集化，仅包含相关信息</em></li><li id="e927" class="kt ku in jx b jy lc kc ld kg le kk lf ko lg ks mr kz la lb bi translated"><em class="lh">合并或汇总来自多个来源的数据</em></li><li id="3186" class="kt ku in jx b jy lc kc ld kg le kk lf ko lg ks mr kz la lb bi translated"><em class="lh">基于现有数据创建新变量或特征</em></li><li id="a1ae" class="kt ku in jx b jy lc kc ld kg le kk lf ko lg ks mr kz la lb bi translated"><em class="lh">归一化数据的比例或范围</em></li></ul><p id="38a4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">数据转换是 ETL 过程的一个重要部分，因为它确保加载到目标系统中的数据是准确的、一致的，并为进一步的分析或处理做好准备。通过仔细规划和执行数据转换步骤，组织可以提高其数据的质量和有用性，并使其更适合各种业务目的。</p><h1 id="948c" class="lo lp in bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated"><strong class="ak"><em class="ms">ETL 与 ELT 的区别</em> </strong></h1><figure class="mu mv mw mx gt jo gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/dce19f1fef7f548e06e86a4a045e59e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/1*c77MbjfOCxijKIOZ0z3KFw.gif"/></div></figure><p id="2314" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">ETL(提取、转换、加载)和 ELT(提取、加载、转换)是将来自多个来源的数据移动和集成到目标系统中的两种方法。虽然它们有相似的目标，但是它们在过程的各个步骤的执行顺序上有所不同。</p><p id="3b86" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> <em class="lh">在一个 ETL 过程</em> </strong>中，提取、转换、加载步骤是按顺序执行的。首先，从各种来源提取数据，如数据库、文件或 web APIs。接下来，数据被转换以满足目标系统的需求，这可能涉及诸如清理、格式化、过滤或创建新变量之类的任务。最后，转换后的数据被加载到目标系统中，在那里可以存储、分析或用于各种业务目的。</p><p id="4e0e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> <em class="lh">在 ELT 流程</em> </strong>中，提取、加载和转换步骤按顺序执行。首先，从各种来源提取数据并加载到目标系统中。然后，使用目标系统中的工具和流程，根据需要转换数据。这种方法允许组织利用目标系统的可伸缩性和处理能力，而不是依赖外部 ETL 工具或过程。</p><h1 id="f5b0" class="lo lp in bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated"><em class="ms">可以执行的数据转换类型</em></h1><p id="c093" class="pw-post-body-paragraph jv jw in jx b jy mm ka kb kc mn ke kf kg mo ki kj kk mp km kn ko mq kq kr ks ig bi translated">有许多不同类型的数据转换可以执行，以使数据对特定目的更有用或更有意义。一些常见的数据转换类型包括:</p><h2 id="4dfa" class="my lp in bd lq mz na dn lu nb nc dp ly kg nd ne mc kk nf ng mg ko nh ni mk nj bi translated"><strong class="ak"> <em class="ms">数据清理:</em> </strong></h2><p id="2ac9" class="pw-post-body-paragraph jv jw in jx b jy mm ka kb kc mn ke kf kg mo ki kj kk mp km kn ko mq kq kr ks ig bi translated">这包括识别和纠正数据中的错误或不一致，如缺少或不正确的值、重复或格式问题。数据清理是数据转换过程中的一个重要步骤，因为它有助于确保数据的准确性和可靠性。</p><p id="9869" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">假设我们有一个名为<code class="fe nk nl nm nn b">customers</code>的表，其中包含以下数据:</p><pre class="mu mv mw mx gt no nn np bn nq nr bi"><span id="b032" class="ns lp in nn b be nt nu l nv nw"><br/>+-------------+-------+-------------------+--------------+<br/>| customer_id | name  |       email       |    phone     |<br/>+-------------+-------+-------------------+--------------+<br/>|           1 | Alice | alice@example.com | 555-555-1212 |<br/>|           2 | Bob   | bob@example.com   | 555-555-1212 |<br/>|           3 | Carol | carol@example.com | 555-555-1213 |<br/>|           4 | Dave  | dave@example.com  | 555-555-121  |<br/>+-------------+-------+-------------------+--------------+<br/><br/>-- The table contains some errors or inconsistencies, such as:<br/>-- 1. Alice and Bob have the same phone number<br/>-- 2. Dave's phone number is missing a digit<br/><br/>-- We can use the following SQL query to clean the data:<br/><br/>UPDATE customers<br/>SET phone = '555-555-1211'<br/>WHERE customer_id = 1;<br/><br/>UPDATE customers<br/>SET phone = '555-555-1214'<br/>WHERE customer_id = 4;<br/><br/>-- This query updates the phone numbers for Alice and Dave, correcting the<br/>-- errors in the data. After running the query,<br/>-- the table would look like this:<br/><br/><br/>+-------------+-------+-------------------+--------------+<br/>| customer_id | name  |       email       |    phone     |<br/>+-------------+-------+-------------------+--------------+<br/>|           1 | Alice | alice@example.com | 555-555-1211 |<br/>|           2 | Bob   | bob@example.com   | 555-555-1212 |<br/>|           3 | Carol | carol@example.com | 555-555-1213 |<br/>|           4 | Dave  | dave@example.com  | 555-555-1214 |<br/>+-------------+-------+-------------------+--------------+</span></pre><h2 id="9dc0" class="my lp in bd lq mz na dn lu nb nc dp ly kg nd ne mc kk nf ng mg ko nh ni mk nj bi translated">数据格式:</h2><p id="e1ea" class="pw-post-body-paragraph jv jw in jx b jy mm ka kb kc mn ke kf kg mo ki kj kk mp km kn ko mq kq kr ks ig bi translated">这包括更改数据的外观或结构，以使其更一致或更适合特定的任务。例如，数据可能被格式化为符合特定的日期或时间格式，或者使用一致的分隔符或分隔符。</p><p id="7c97" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">假设我们有一个名为<code class="fe nk nl nm nn b">customers</code>的表，包含以下数据:</p><pre class="mu mv mw mx gt no nn np bn nq nr bi"><span id="d687" class="ns lp in nn b be nt nu l nv nw"><br/><br/>+-------------+-------+-------------------+----------------+<br/>| customer_id | name  |       email       |     phone      |<br/>+-------------+-------+-------------------+----------------+<br/>|           1 | Alice | alice@example.com | (555) 555-1211 |<br/>|           2 | Bob   | bob@example.com   | (555) 555-1212 |<br/>|           3 | Carol | carol@example.com | (555) 555-1213 |<br/>|           4 | Dave  | dave@example.com  | (555) 555-1214 |<br/>+-------------+-------+-------------------+----------------+<br/><br/>-- The table contains phone numbers that are formatted with parentheses and<br/>-- hyphens, which may not be suitable for certain types of analysis or <br/>-- processing. We can use the following SQL query to reformat the data:<br/><br/>UPDATE customers<br/>SET phone = REPLACE(phone, '(', '')<br/>SET phone = REPLACE(phone, ')', '')<br/>SET phone = REPLACE(phone, '-', '');<br/><br/><br/>+-------------+-------+-------------------+------------+<br/>| customer_id | name  |       email       |   phone    |<br/>+-------------+-------+-------------------+------------+<br/>|           1 | Alice | alice@example.com | 5555551211 |<br/>|           2 | Bob   | bob@example.com   | 5555551212 |<br/>|           3 | Carol | carol@example.com | 5555551213 |<br/>|           4 | Dave  | dave@example.com  | 5555551214 |<br/>+-------------+-------+-------------------+------------+</span></pre><h2 id="75b0" class="my lp in bd lq mz na dn lu nb nc dp ly kg nd ne mc kk nf ng mg ko nh ni mk nj bi translated"><strong class="ak">数据丰富:</strong></h2><p id="5534" class="pw-post-body-paragraph jv jw in jx b jy mm ka kb kc mn ke kf kg mo ki kj kk mp km kn ko mq kq kr ks ig bi translated">这包括向数据中添加额外的信息或上下文，以使其更有价值或更有用。这可能涉及将数据链接到外部信息源，如参考数据或元数据，或者基于数据添加派生变量或功能。</p><p id="b054" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">下面是一个使用 SQL 丰富数据的简单示例:</p><pre class="mu mv mw mx gt no nn np bn nq nr bi"><span id="9e27" class="ns lp in nn b be nt nu l nv nw">-- Suppose we have a table of customer data, with the following structure:<br/><br/>+-------------+-------+-------------------+--------------+<br/>| customer_id | name  |       email       |    phone     |<br/>+-------------+-------+-------------------+--------------+<br/>|           1 | Alice | alice@example.com | 555-555-1211 |<br/>|           2 | Bob   | bob@example.com   | 555-555-1212 |<br/>|           3 | Carol | carol@example.com | 556-555-1213 |<br/>|           4 | Dave  | dave@example.com  | 557-555-1214 |<br/>+-------------+-------+-------------------+--------------+<br/><br/>-- We have another table that contains information about the geographic <br/>-- location of each phone number prefix:<br/><br/>+--------+-------------+-------+<br/>| prefix |    city     | state |<br/>+--------+-------------+-------+<br/>|    555 | New York    | NY    |<br/>|    556 | Los Angeles | CA    |<br/>|    557 | Chicago     | IL    |<br/>+--------+-------------+-------+<br/><br/>-- We can use the following SQL query to enrich the customer data with <br/>-- the location information:<br/><br/>UPDATE customers c<br/>SET city = (SELECT city FROM phone_prefixes p WHERE <br/>            p.prefix = SUBSTRING(c.phone, 1, 3));<br/>SET state = (SELECT state FROM phone_prefixes p WHERE<br/>            p.prefix = SUBSTRING(c.phone, 1, 3));<br/><br/>-- After running the query, the customer table would look like this:<br/><br/>+-------------+-------+-------------------+--------------+-------------+-------+<br/>| customer_id | name  |       email       |    phone     |    city     | state |<br/>+-------------+-------+-------------------+--------------+-------------+-------+<br/>|           1 | Alice | alice@example.com | 555-555-1211 | New York    | NY    |<br/>|           2 | Bob   | bob@example.com   | 555-555-1212 | New York    | NY    |<br/>|           3 | Carol | carol@example.com | 556-555-1213 | Los Angeles | CA    |<br/>|           4 | Dave  | dave@example.com  | 557-555-1214 | Chicago     | IL    |<br/>+-------------+-------+-------------------+--------------+-------------+-------+</span></pre><h2 id="2d0d" class="my lp in bd lq mz na dn lu nb nc dp ly kg nd ne mc kk nf ng mg ko nh ni mk nj bi translated">数据标准化:</h2><p id="7afc" class="pw-post-body-paragraph jv jw in jx b jy mm ka kb kc mn ke kf kg mo ki kj kk mp km kn ko mq kq kr ks ig bi translated">数据规范化是以最小化冗余和依赖性并最大化数据完整性的方式组织数据库的过程。这是数据转换过程中的一个重要步骤，因为它有助于确保数据以一致和有效的方式存储，并且不容易出现错误或不一致。</p><p id="dfed" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">下面是一个使用 SQL 进行数据规范化的简单示例:</p><pre class="mu mv mw mx gt no nn np bn nq nr bi"><span id="ad20" class="ns lp in nn b be nt nu l nv nw">-- Suppose we have a table that stores customer data, along with the products<br/>-- that each customer has purchased. The table has the following structure:<br/><br/>+-------------+-------+-------------------+--------------+------------+--------------+<br/>| customer_id | name  |       email       |    phone     | product_id | product_name |<br/>+-------------+-------+-------------------+--------------+------------+--------------+<br/>|           1 | Alice | alice@example.com | 555-555-1211 |          1 | Tablet       |<br/>|           1 | Alice | alice@example.com | 555-555-1211 |          2 | Laptop       |<br/>|           2 | Bob   | bob@example.com   | 555-555-1212 |          2 | Laptop       |<br/>|           3 | Carol | carol@example.com | 555-555-1213 |          3 | Smartphone   |<br/>+-------------+-------+-------------------+--------------+------------+--------------+</span></pre><p id="a95a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> <em class="lh">此表未规格化，因为它包含冗余和依赖。例如，对于客户已经购买的每个产品，客户数据是重复的，这是低效的，并且增加了数据错误的风险。</em> </strong></p><p id="f739" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们可以使用以下 SQL 查询来规范化数据:</p><pre class="mu mv mw mx gt no nn np bn nq nr bi"><span id="e1d1" class="ns lp in nn b be nt nu l nv nw">CREATE TABLE customers (<br/>  customer_id INT PRIMARY KEY,<br/>  name VARCHAR(255),<br/>  email VARCHAR(255),<br/>  phone VARCHAR(255)<br/>);<br/><br/>CREATE TABLE products (<br/>  product_id INT PRIMARY KEY,<br/>  product_name VARCHAR(255)<br/>);<br/><br/>CREATE TABLE purchases (<br/>  purchase_id INT PRIMARY KEY,<br/>  customer_id INT,<br/>  product_id INT,<br/>  FOREIGN KEY (customer_id) REFERENCES customers (customer_id),<br/>  FOREIGN KEY (product_id) REFERENCES products (product_id)<br/>);<br/><br/>These queries create three separate tables: <br/>-- one for customers, <br/>-- one for products, <br/>-- one for purchases. <br/><br/>The purchases table contains a foreign key to the customers and products<br/>tables, which allows us to track which customers have purchased which products.<br/><br/>-- After running these queries, we can insert the data into the new tables<br/>-- like this:<br/><br/>INSERT INTO customers (customer_id, name, email, phone)<br/>VALUES (1, 'Alice', 'alice@example.com', '555-555-1211'),<br/>       (2, 'Bob', 'bob@example.com', '555-555-1212'),<br/>       (3, 'Carol', 'carol@example.com', '555-555-1213');<br/><br/>INSERT INTO products (product_id, product_name)<br/>VALUES (1, 'Tablet'),<br/>       (2, 'Laptop'),<br/>       (3, 'Smartphone');<br/><br/>INSERT INTO purchases (purchase_id, customer_id, product_id)<br/>VALUES (1, 1, 1),<br/>       (2, 1, 2),<br/>       (3, 2, 2),<br/>       (4, 3, 3);</span></pre><p id="7755" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> <em class="lh">下面是运行数据规范化示例后客户、产品和采购表的外观:</em> </strong></p><pre class="mu mv mw mx gt no nn np bn nq nr bi"><span id="d1d7" class="ns lp in nn b be nt nu l nv nw">Customers table:<br/>+-------------+-------+-------------------+--------------+<br/>| customer_id | name  |       email       |    phone     |<br/>+-------------+-------+-------------------+--------------+<br/>|           1 | Alice | alice@example.com | 555-555-1211 |<br/>|           2 | Bob   | bob@example.com   | 555-555-1212 |<br/>|           3 | Carol | carol@example.com | 555-555-1213 |<br/>+-------------+-------+-------------------+--------------+<br/><br/>Products table:<br/>+------------+--------------+<br/>| product_id | product_name |<br/>+------------+--------------+<br/>|          1 | Tablet       |<br/>|          2 | Laptop       |<br/>|          3 | Smartphone   |<br/>+------------+--------------+<br/><br/>Purchases table:<br/>+-------------+-------------+------------+<br/>| purchase_id | customer_id | product_id |<br/>+-------------+-------------+------------+<br/>|           1 |           1 |          1 |<br/>|           2 |           1 |          2 |<br/>|           3 |           2 |          2 |<br/>|           4 |           3 |          3 |<br/>+-------------+-------------+------------+</span></pre><p id="cb46" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="lh">在这些表中，每个客户和产品都由一个单独的行表示，并且 purchases 表包含一个每次购买的记录，以及一个购买中涉及的客户和产品的外键。这使我们能够跟踪哪些客户购买了哪些产品，而无需重复客户或产品数据。</em></p><h2 id="613d" class="my lp in bd lq mz na dn lu nb nc dp ly kg nd ne mc kk nf ng mg ko nh ni mk nj bi translated">数据集成:</h2><p id="662d" class="pw-post-body-paragraph jv jw in jx b jy mm ka kb kc mn ke kf kg mo ki kj kk mp km kn ko mq kq kr ks ig bi translated">这包括将来自多个来源的数据合并成一个单一的、有凝聚力的数据集，以便于分析或与其他系统集成。这可能涉及合并数据集、协调不同来源的数据或创建新的变量或要素来合并不同来源的数据等任务。</p><p id="45ae" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">下面是一个使用 SQL 进行数据集成的简单示例:</p><pre class="mu mv mw mx gt no nn np bn nq nr bi"><span id="33fd" class="ns lp in nn b be nt nu l nv nw">-- Suppose we have two tables that contain customer data, with the <br/>-- following structure:<br/><br/>Customers table 1:<br/>+-------------+-------+-------------------+--------------+<br/>| customer_id | name  |       email       |    phone     |<br/>+-------------+-------+-------------------+--------------+<br/>|           1 | Alice | alice@example.com | 555-555-1211 |<br/>|           2 | Bob   | bob@example.com   | 555-555-1212 |<br/>|           3 | Carol | carol@example.com | 555-555-1213 |<br/>+-------------+-------+-------------------+--------------+<br/><br/>Customers table 2:<br/>+-------------+-------+---------------+---------------+<br/>| customer_id | name  |    address    |     city      |<br/>+-------------+-------+---------------+---------------+<br/>|           1 | Alice | 123 Main St   | New York      |<br/>|           2 | Bob   | 456 Park Ave  | Los Angeles   |<br/>|           4 | Dave  | 789 Market St | San Francisco |<br/>+-------------+-------+---------------+---------------+<br/><br/>-- We can use the following SQL query to integrate the data from these <br/>-- two tables into a single table:<br/><br/>SELECT c1.customer_id, c1.name, c1.email, c1.phone, c2.address, c2.city<br/>FROM customers_1 c1<br/>LEFT JOIN customers_2 c2 ON c1.customer_id = c2.customer_id<br/><br/>-- Query uses a LEFT JOIN to combine the data from the two tables, based on <br/>-- the customer_id column. The LEFT JOIN includes all rows from the left <br/>-- (customers_1) table, and matching rows from the right (customers_2) table. <br/>-- If there is no match, NULL values are returned for the right table's columns.<br/><br/>-- The query would return the following result:<br/>+-------------+-------+-------------------+--------------+---------------+---------------+<br/>| customer_id | name  |       email       |    phone     |    address    |     city      |<br/>+-------------+-------+-------------------+--------------+---------------+---------------+<br/>|           1 | Alice | alice@example.com | 555-555-1211 | 123 Main St   | New York      |<br/>|           2 | Bob   | bob@example.com   | 555-555-1212 | 456 Park Ave  | Los Angeles   |<br/>|           3 | Carol | carol@example.com | 555-555-1213 | NULL          | NULL          |<br/>|           4 | Dave  | NULL              | NULL         | 789 Market St | San Francisco |<br/>+-------------+-------+-------------------+--------------+---------------+---------------+</span></pre><h2 id="c201" class="my lp in bd lq mz na dn lu nb nc dp ly kg nd ne mc kk nf ng mg ko nh ni mk nj bi translated">数据聚合:</h2><p id="adb9" class="pw-post-body-paragraph jv jw in jx b jy mm ka kb kc mn ke kf kg mo ki kj kk mp km kn ko mq kq kr ks ig bi translated">这包括组合或汇总来自多个来源或不同粒度级别的数据，以便更容易分析或解释。数据聚合可用于创建数据的汇总或聚合，如总计、平均值或计数。</p><p id="a3cd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> <em class="lh">数据聚合有许多不同的方法，而合适的方法将取决于具体的需求和手头分析或任务的目标。一些常见的技巧包括:</em> </strong></p><ul class=""><li id="b2d6" class="kt ku in jx b jy jz kc kd kg kv kk kw ko kx ks mr kz la lb bi translated"><strong class="jx io"> <em class="lh">数据透视表</em> </strong>:这涉及到将数据组织成表格格式，用行和列表示不同维度或类别的数据。数据透视表通常用于通过将数据分成不同的类别来汇总和分析数据，或者创建交叉表格。</li><li id="7209" class="kt ku in jx b jy lc kc ld kg le kk lf ko lg ks mr kz la lb bi translated"><strong class="jx io"><em class="lh"/></strong>分组:将数据按一列或多列分组，并对分组后的数据应用函数或聚合运算符。Group by 通常用于通过计算统计数据(如平均值、总和或计数)来汇总数据。</li><li id="c580" class="kt ku in jx b jy lc kc ld kg le kk lf ko lg ks mr kz la lb bi translated"><strong class="jx io"> <em class="lh"> Rollup </em> </strong>:将数据按一列或多列分组，并为每组创建小计或总计。汇总通常用于创建汇总报告或分析不同粒度级别的数据。</li></ul><p id="a51a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">下面是一个使用 SQL 进行数据聚合的简单示例:</p><pre class="mu mv mw mx gt no nn np bn nq nr bi"><span id="d920" class="ns lp in nn b be nt nu l nv nw">-- Suppose we have a table that contains sales data, with <br/>-- the following structure:<br/><br/>-- Sales table:<br/>+------------+------------+--------+-------+<br/>|    date    |  product   | region | sales |<br/>+------------+------------+--------+-------+<br/>| 2021-01-01 | Tablet     | North  |   100 |<br/>| 2021-01-01 | Laptop     | North  |   200 |<br/>| 2021-01-01 | Smartphone | North  |    50 |<br/>| 2021-01-01 | Tablet     | South  |    50 |<br/>| 2021-01-02 | Laptop     | South  |   100 |<br/>| 2021-01-02 | Smartphone | South  |   150 |<br/>| 2021-01-02 | Tablet     | North  |   100 |<br/>| 2021-01-02 | Laptop     | North  |   200 |<br/>| 2021-01-02 | Smartphone | North  |    50 |<br/>+------------+------------+--------+-------+<br/><br/>-- We can use the following SQL query to aggregate the data by product and region:<br/>SELECT product, region, SUM(sales) as total_sales<br/>FROM sales<br/>GROUP BY product, region<br/><br/>-- This query groups the data by the product and region columns, and applies <br/>-- the SUM function to the sales column. The query would return the following<br/>-- result:<br/><br/>+------------+--------+-------------+<br/>|  product   | region | total_sales |<br/>+------------+--------+-------------+<br/>| Tablet     | North  |         200 |<br/>| Laptop     | North  |         400 |<br/>| Smartphone | North  |         100 |<br/>| Tablet     | South  |          50 |<br/>| Laptop     | South  |         100 |<br/>| Smartphone | South  |         150 |<br/>+------------+--------+-------------+<br/><br/>-- This result shows the total sales for each product and region combination. <br/>-- We can use additional functions or operators to calculate other statistics, <br/>-- such as averages, counts, or minimum and maximum values.</span></pre><h2 id="47ca" class="my lp in bd lq mz na dn lu nb nc dp ly kg nd ne mc kk nf ng mg ko nh ni mk nj bi translated">数据映射:</h2><p id="622f" class="pw-post-body-paragraph jv jw in jx b jy mm ka kb kc mn ke kf kg mo ki kj kk mp km kn ko mq kq kr ks ig bi translated">这包括在两个不同数据集中的元素之间建立对应关系，以便于集成或分析。这可能涉及一些任务，例如基于公共标识符字段匹配记录，或者创建一个查找表，将一个数据集中的值映射到另一个数据集中的相应值。</p><p id="ea69" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">下面是一个使用 SQL 进行数据映射的简单示例:</p><pre class="mu mv mw mx gt no nn np bn nq nr bi"><span id="e818" class="ns lp in nn b be nt nu l nv nw">-- Suppose we have two tables that contain customer data, with the following <br/>-- structure:<br/><br/>-- Customers table 1:<br/>+-------------+-------+-------------------+--------------+<br/>| customer_id | name  |       email       |    phone     |<br/>+-------------+-------+-------------------+--------------+<br/>|           1 | Alice | alice@example.com | 555-555-1211 |<br/>|           2 | Bob   | bob@example.com   | 555-555-1212 |<br/>|           3 | Carol | carol@example.com | 555-555-1213 |<br/>+-------------+-------+-------------------+--------------+<br/><br/>-- Customers table 2:<br/>+-------------+-------+---------------+---------------+<br/>| customer_id | name  |    address    |     city      |<br/>+-------------+-------+---------------+---------------+<br/>|           1 | Alice | 123 Main St   | New York      |<br/>|           2 | Bob   | 456 Park Ave  | Los Angeles   |<br/>|           4 | Dave  | 789 Market St | San Francisco |<br/>+-------------+-------+---------------+---------------+<br/><br/>-- We can use the following SQL query to map the data from these two tables <br/>-- based on the customer_id column:<br/><br/>SELECT c1.customer_id, c1.name, c1.email, c1.phone, c2.address, c2.city<br/>FROM customers_1 c1<br/>JOIN customers_2 c2 ON c1.customer_id = c2.customer_id<br/><br/>-- This query uses an INNER JOIN to map the data from the two tables, based on <br/>-- the customer_id column. The INNER JOIN only includes rows that have a match<br/>-- in both tables.<br/><br/>-- The query would return the following result:<br/><br/>+-------------+-------+-------------------+--------------+--------------+-------------+<br/>| customer_id | name  |       email       |    phone     |   address    |    city     |<br/>+-------------+-------+-------------------+--------------+--------------+-------------+<br/>|           1 | Alice | alice@example.com | 555-555-1211 | 123 Main St  | New York    |<br/>|           2 | Bob   | bob@example.com   | 555-555-1212 | 456 Park Ave | Los Angeles |<br/>+-------------+-------+-------------------+--------------+--------------+-------------+</span></pre><h2 id="59a7" class="my lp in bd lq mz na dn lu nb nc dp ly kg nd ne mc kk nf ng mg ko nh ni mk nj bi translated">重复数据消除:</h2><p id="b296" class="pw-post-body-paragraph jv jw in jx b jy mm ka kb kc mn ke kf kg mo ki kj kk mp km kn ko mq kq kr ks ig bi translated">这包括识别和删除数据集中的重复记录，以确保数据的准确性和一致性。这可能涉及一些任务，例如基于公共标识符字段或其他标准来比较记录，并选择一个有代表性的记录来保留，同时丢弃其他记录。</p><p id="9425" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">下面是一个使用 SQL 进行重复数据消除的简单示例:</p><pre class="mu mv mw mx gt no nn np bn nq nr bi"><span id="9dc6" class="ns lp in nn b be nt nu l nv nw">-- Suppose we have a table that contains customer data, with the following <br/>-- structure:<br/><br/>-- Customers table:<br/>+-------------+-------+-------------------+--------------+<br/>| customer_id | name  |       email       |    phone     |<br/>+-------------+-------+-------------------+--------------+<br/>|           1 | Alice | alice@example.com | 555-555-1211 |<br/>|           2 | Bob   | bob@example.com   | 555-555-1212 |<br/>|           3 | Carol | carol@example.com | 555-555-1213 |<br/>|           4 | Alice | alice@example.com | 555-555-1211 |<br/>|           5 | Bob   | bob@example.com   | 555-555-1212 |<br/>|           6 | Carol | carol@example.com | 555-555-1213 |<br/>+-------------+-------+-------------------+--------------+<br/><br/>-- We can use the following SQL query to de-duplicate the data based on the <br/>-- name and email columns:<br/><br/>SELECT DISTINCT name, email, phone<br/>FROM customers<br/><br/>-- This query uses the DISTINCT keyword to remove duplicate rows from the result <br/>-- set. The DISTINCT keyword compares the values in the selected columns and <br/>-- removes rows that have duplicate values.<br/><br/>-- The query would return the following result:<br/><br/>+-------+-------------------+--------------+<br/>| name  |       email       |    phone     |<br/>+-------+-------------------+--------------+<br/>| Alice | alice@example.com | 555-555-1211 |<br/>| Bob   | bob@example.com   | 555-555-1212 |<br/>| Carol | carol@example.com | 555-555-1213 |<br/>+-------+-------------------+--------------+</span></pre><h2 id="9667" class="my lp in bd lq mz na dn lu nb nc dp ly kg nd ne mc kk nf ng mg ko nh ni mk nj bi translated">数据清理:</h2><p id="3bac" class="pw-post-body-paragraph jv jw in jx b jy mm ka kb kc mn ke kf kg mo ki kj kk mp km kn ko mq kq kr ks ig bi translated">这包括识别和纠正数据质量问题，如错误、不一致或缺失值，以提高数据的整体质量。这可能涉及一些任务，例如对照外部来源验证数据值、输入缺失值或应用规则或算法来纠正错误。</p><p id="cba4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">下面是一个使用 SQL 清理数据的示例:</p><pre class="mu mv mw mx gt no nn np bn nq nr bi"><span id="7ff6" class="ns lp in nn b be nt nu l nv nw">-- Suppose we have a table that contains customer data, with the following <br/>-- structure:<br/><br/>-- Customers table:<br/>+-------------+-------+------------------+--------------+<br/>| customer_id | name  |      email       |    phone     |<br/>+-------------+-------+------------------+--------------+<br/>|           1 | Alice | aliceexample.com | 555-555-1211 |<br/>|           2 | Bob   | example.com      | 555-555-1212 |<br/>|           3 | Carol | Bob@example.com  | 555-555-1213 |<br/>|           4 | Dave  | dave@example.com | 555-555-1214 |<br/>|           5 | Eve   | EVEE@example.com | 555-555-1215 |<br/>|           6 | Frank | fk@example.com   | 555-555-1216 |<br/>+-------------+-------+------------------+--------------+<br/><br/>-- We notice that the email addresses of several customers are incorrect or <br/>-- missing. We can use the following SQL query to scrub the data and correct <br/>-- the email addresses:<br/><br/>UPDATE customers<br/>SET email = CASE<br/>  WHEN name = 'Alice' THEN 'alice@example.com'<br/>  WHEN name = 'Bob' THEN 'bob@example.com'<br/>  WHEN name = 'Carol' THEN 'carol@example.com'<br/>  WHEN name = 'Dave' THEN 'dave@example.com'<br/>  WHEN name = 'Eve' THEN 'eve@example.com'<br/>  WHEN name = 'Frank' THEN 'frank@example.com'<br/>END<br/><br/>-- This query uses the UPDATE statement to update the email column in the <br/>-- customers table. The SET clause uses a CASE expression to assign the <br/>-- correct email address to each customer based on their name. The CASE <br/>-- expression evaluates each WHEN clause in order, and returns the value of <br/>-- the first matching THEN clause.<br/><br/>-- After running this query, the customers table would be updated as follows:<br/>+-------------+-------+-------------------+--------------+<br/>| customer_id | name  |       email       |    phone     |<br/>+-------------+-------+-------------------+--------------+<br/>|           1 | Alice | alice@example.com | 555-555-1211 |<br/>|           2 | Bob   | bob@example.com   | 555-555-1212 |<br/>|           3 | Carol | carol@example.com | 555-555-1213 |<br/>|           4 | Dave  | dave@example.com  | 555-555-1214 |<br/>|           5 | Eve   | eve@example.com   | 555-555-1215 |<br/>|           6 | Frank | frank@example.com | 555-555-1216 |<br/>+-------------+-------+-------------------+--------------+</span></pre><blockquote class="li lj lk"><p id="9431" class="jv jw lh jx b jy jz ka kb kc kd ke kf ll kh ki kj lm kl km kn ln kp kq kr ks ig bi translated"><strong class="jx io">注意:这只是一个使用 SQL 进行数据转换的简单例子，但是在实践中，这些可能涉及更复杂的任务。数据转换可以包含各种各样的活动和技术，用于修改数据，以使其对于特定的目的更有用或更有意义。通过仔细选择和应用正确的数据转换技术，组织可以提高其数据的质量和有用性，并使其更适合各种业务目的。</strong></p></blockquote><h1 id="d22d" class="lo lp in bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">特定用例的数据转换:</h1><p id="684e" class="pw-post-body-paragraph jv jw in jx b jy mm ka kb kc mn ke kf kg mo ki kj kk mp km kn ko mq kq kr ks ig bi translated">在为特定用例选择适当的数据转换时，有几个因素需要考虑:</p><ol class=""><li id="ccf2" class="kt ku in jx b jy jz kc kd kg kv kk kw ko kx ks ky kz la lb bi translated">数据质量:在选择数据转换时，数据质量是一个关键的考虑因素，因为它决定了转换数据的准确性和可靠性。重要的是要评估源数据的质量，并确定在转换过程之前或期间需要解决的任何问题。</li><li id="0d30" class="kt ku in jx b jy lc kc ld kg le kk lf ko lg ks ky kz la lb bi translated">数据需求:目标系统或分析的特定需求也会影响数据转换的选择。例如，如果目标系统需要特定格式或结构的数据，您可能需要应用转换来使数据符合这些要求。</li><li id="e7dc" class="kt ku in jx b jy lc kc ld kg le kk lf ko lg ks ky kz la lb bi translated">数据量和复杂性:数据量和复杂性也会影响数据转换的选择。对于大型或复杂的数据集，您可能需要应用更高级的转换，如数据聚合或要素工程，以提取有意义的见解或使数据更具可操作性。</li><li id="5f1d" class="kt ku in jx b jy lc kc ld kg le kk lf ko lg ks ky kz la lb bi translated">数据目标和目的:手头的分析或任务的总体目标和目的也会影响数据转换的选择。例如，如果目标是识别数据中的趋势或模式，您可能需要应用数据聚合或数据可视化等转换，以使数据更易于分析。</li></ol><p id="85c9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">通过考虑这些因素，您可以为您的特定用例选择适当的数据转换，并确保转换后的数据满足目标系统或分析的需要和要求。</p><figure class="mu mv mw mx gt jo gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/81a735204b59f23c7d71b626486a7d9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/1*eNunApuOn1dswN0DHm7QOw.gif"/></div></figure><blockquote class="li lj lk"><p id="ec97" class="jv jw lh jx b jy jz ka kb kc kd ke kf ll kh ki kj lm kl km kn ln kp kq kr ks ig bi translated">感谢你阅读这篇文章。如果你觉得它有帮助，请关注我的更多内容，并随时更新我的新文章。我将继续分享关于数据工程和管理的宝贵见解和技巧。再次感谢您的支持，我期待着将来再次与您联系。</p></blockquote></div></div>    
</body>
</html>