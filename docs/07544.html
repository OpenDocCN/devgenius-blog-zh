<html>
<head>
<title>Deploying shiny apps through shinyproxy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过 shinyproxy 部署闪亮的应用程序</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/deploying-shiny-apps-through-shinyproxy-df28cca1e137?source=collection_archive---------8-----------------------#2022-04-04">https://blog.devgenius.io/deploying-shiny-apps-through-shinyproxy-df28cca1e137?source=collection_archive---------8-----------------------#2022-04-04</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div class="gh gi jk"><img src="../Images/e0aadf94ecd031e306e7497a7f7185ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/format:webp/1*hpIXk8Y1e5tX2AJrJB-72A.jpeg"/></div><figcaption class="jr js gj gh gi jt ju bd b be z dk translated">照片来自<a class="ae jv" href="https://www.simplus.com/choose-right-deployment-strategy/" rel="noopener ugc nofollow" target="_blank"> simplus </a></figcaption></figure><p id="ac21" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">Shinyproxy 是一个开源系统，它使得部署 dockerized 应用程序成为可能。用 shinyproxy 部署您的应用程序的美妙之处在于，它为您提供了开源环境中的企业特性。</p><p id="edda" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">使用 shinyproxy 系统的一些好处是:</p><p id="aa95" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">*每个应用程序会话的工作空间隔离。<br/> *你可以拥有尽可能多的用户。<br/> *你不仅可以部署闪亮的应用，甚至可以部署 django、flask 等。<br/> *你可以使用 docker API 来控制内存和 cpu 的使用</p><p id="273f" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">然而，该系统有一些缺点:</p><p id="e34a" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">*用户必须等待容器旋转起来。<br/> *设置 shinyproxy 系统需要一些努力和 docker 的高级知识。</p><p id="08f4" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">说到这里，我们现在可以看一些关于如何在你的电脑上设置 shinyproxy 平台的七步指南。</p><ol class=""><li id="199a" class="ku kv in jy b jz ka kd ke kh kw kl kx kp ky kt kz la lb lc bi translated"><strong class="jy io">安装 java </strong> <br/>访问该网站并下载 Java:<a class="ae jv" href="https://www.azul.com/downloads/?package=jdk" rel="noopener ugc nofollow" target="_blank"><em class="ld">https://www.azul.com/downloads/?package=jdk</em></a><br/>从终端导航到您下载文件的位置并运行:</li></ol><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="633c" class="ln lo in lj b gy lp lq l lr ls">sudo apt install ./zulu17.30.15-ca-jdk17.0.1-linux_amd64.deb</span></pre><p id="8299" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated"><strong class="jy io"> 2。下载 shinyproxy </strong> <br/>从他们的网站下载 shiny proxy:<a class="ae jv" href="https://www.shinyproxy.io/downloads/" rel="noopener ugc nofollow" target="_blank"><em class="ld">https://www.shinyproxy.io/downloads/</em></a><em class="ld"/><br/>挑文件用。jar 扩展<br/>在你的电脑上创建一个文件夹，命名为 shinyproxy，然后将 jar 文件复制到这个文件夹中。</p><p id="a960" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated"><strong class="jy io"> 3。Docker+shinyproxy</strong><br/>shiny proxy 将需要与 docker 守护进程对话，以便运行闪亮的应用程序容器，默认情况下，shiny proxy 通过端口 2375 连接。因此，我们必须对 docker 启动选项进行一些调整，以确保两个系统能够连接。</p><p id="f576" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">如果您的机器使用 systemd (ubuntu 16.04 LTS 及更高版本)，请使用以下内容:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="b0c8" class="ln lo in lj b gy lp lq l lr ls"><br/> sudo systemctl edit docker</span></pre><p id="478d" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">打开编辑器后，将以下几行添加到文件中:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="da52" class="ln lo in lj b gy lp lq l lr ls">[Service]<br/>      ExecStart = <br/>      ExexStart = /usr/bin/dockerd -H unix:// -D -H tcp://127.0.0.1:2375</span></pre><p id="5bb2" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">保存文件，关闭编辑器，然后重启 docker</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="772e" class="ln lo in lj b gy lp lq l lr ls">sudo systemctl restart docker</span></pre><p id="262a" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated"><strong class="jy io"> 4。从 openanalytics 下载演示图片:</strong></p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="b6e9" class="ln lo in lj b gy lp lq l lr ls">sudo docker pull openanalytics/shinyproxy-demo</span></pre><p id="0915" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated"><strong class="jy io"> 5。创建 application.yml 文件</strong> <br/>导航到你的 shinyproxy 文件夹，然后点击 application.yml</p><p id="78f8" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">将以下内容复制到。yml 文件并保存更改:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="7db0" class="ln lo in lj b gy lp lq l lr ls"><strong class="lj io">proxy:</strong><br/>  <strong class="lj io">title:</strong> Open Analytics Shiny Proxy<br/>  <strong class="lj io">logo-url:</strong> https://www.openanalytics.eu/shinyproxy/logo.png<br/>  <strong class="lj io">landing-page:</strong> /<br/>  <strong class="lj io">heartbeat-rate:</strong> <strong class="lj io">10000</strong><br/>  <strong class="lj io">heartbeat-timeout:</strong> <strong class="lj io">60000</strong><br/>  <strong class="lj io">port:</strong> <strong class="lj io">8080</strong><br/>  <strong class="lj io">authentication:</strong> ldap<br/>  <strong class="lj io">admin-groups:</strong> scientists<br/>  <em class="ld"># Example: 'simple' authentication configuration</em><br/>  <strong class="lj io">users:</strong><br/>  - <strong class="lj io">name:</strong> jack<br/>    <strong class="lj io">password:</strong> password<br/>    <strong class="lj io">groups:</strong> scientists<br/>  - <strong class="lj io">name:</strong> jeff<br/>    <strong class="lj io">password:</strong> password<br/>    <strong class="lj io">groups:</strong> mathematicians<br/>  <em class="ld"># Example: 'ldap' authentication configuration</em><br/>  <strong class="lj io">ldap:</strong><br/>    <strong class="lj io">url:</strong> ldap://ldap.forumsys.com:389/dc=example,dc=com<br/>    <strong class="lj io">user-dn-pattern:</strong> uid={0}<br/>    <strong class="lj io">group-search-base:</strong><br/>    <strong class="lj io">group-search-filter:</strong> (uniqueMember={0})<br/>    <strong class="lj io">manager-dn:</strong> cn=read-only-admin,dc=example,dc=com<br/>    <strong class="lj io">manager-password:</strong> password<br/>  <em class="ld"># Docker configuration</em><br/>  <strong class="lj io">docker:</strong><br/>    <strong class="lj io">cert-path:</strong> /home/none<br/>    <strong class="lj io">url:</strong> http://localhost:2375<br/>    <strong class="lj io">port-range-start:</strong> <strong class="lj io">20000</strong><br/>  <strong class="lj io">specs:</strong><br/>  - <strong class="lj io">id:</strong> 01_hello<br/>    <strong class="lj io">display-name:</strong> Hello Application<br/>    <strong class="lj io">description:</strong> Application which demonstrates the basics of a Shiny app<br/>    <strong class="lj io">container-cmd:</strong> <strong class="lj io">[</strong>"R"<strong class="lj io">,</strong> "-e"<strong class="lj io">,</strong> "shinyproxy::run_01_hello()"<strong class="lj io">]</strong><br/>    <strong class="lj io">container-image:</strong> openanalytics/shinyproxy-demo<br/>    <strong class="lj io">access-groups:</strong> <strong class="lj io">[</strong>scientists, mathematicians]<br/>  - <strong class="lj io">id:</strong> 06_tabsets<br/>    <strong class="lj io">container-cmd:</strong> <strong class="lj io">[</strong>"R"<strong class="lj io">,</strong> "-e"<strong class="lj io">,</strong> "shinyproxy::run_06_tabsets()"<strong class="lj io">]</strong><br/>    <strong class="lj io">container-image:</strong> openanalytics/shinyproxy-demo<br/>    <strong class="lj io">access-groups:</strong> scientists<br/><br/><strong class="lj io">logging:</strong><br/>  <strong class="lj io">file:</strong><br/>    <strong class="lj io">name:</strong> shinyproxy.log</span></pre><p id="e6d3" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">至此，您已经创建了 application.yml 文件，shinyproxy 使用它来启动和管理您的 docker 映像。</p><p id="b80c" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated"><em class="ld">不适用:将认证从 ldap 更改为简单。您可以删除 ldap 验证配置部分</em></p><p id="123a" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated"><strong class="jy io"> 6。启动 shinyproxy </strong> <br/>要启动 shinyproxy，请导航到您创建的 shinyproxy 文件夹并运行以下命令:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="f282" class="ln lo in lj b gy lp lq l lr ls">java -jar shinyproxy-2.6.0.jar</span></pre><p id="05ab" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated"><em class="ld">注意:根据您的版本更改 jar 文件名，即您的版本可以是 shinyproxy-2.5.0.jar </em></p><p id="1d4d" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">现在你可以进入你的浏览器，输入地址:<a class="ae jv" href="http://127.0.0.1:8080" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:8080 </a>就会出现下面的页面:</p><figure class="le lf lg lh gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lt"><img src="../Images/6e2ee452ff684c7f2cda2302054648e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M2PFC2fGnreqAQVshBrAXw.png"/></div></div></figure><p id="616f" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">使用 application.yml 文件中提供的凭据登录:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="1107" class="ln lo in lj b gy lp lq l lr ls">            username: jack<br/>            password: password<br/>  <br/>            username: jeff<br/>            password: password</span></pre><p id="8613" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated"><em class="ld">不适用:您可以根据自己的喜好更改登录凭证</em></p><p id="b148" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">7.将您的 dockerized 应用程序添加到 shinyproxy</p><p id="727e" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">如果你能够与演示图像进行交互，那么我们知道我们的 shinyproxy 和 docker 系统目前工作正常。如果是这样的话，那么我们可以继续添加我们的 dockerized 应用程序，只是有一个过程是如何工作的感觉。</p><p id="91d4" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">为此，我们需要编辑放在 shinyproxy 文件夹中的 application.yml 文件。导航到该文件夹并运行以下命令:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="fd8a" class="ln lo in lj b gy lp lq l lr ls">sudo nano application.yml</span></pre><p id="d43d" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated"><strong class="jy io"> <em class="ld"> nano </em> </strong> <em class="ld">是我们用来编辑文本文件的编辑器。</em></p><p id="5242" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">运行上述命令后，编辑器将打开 application.yml 文件。转到 specs:下的部分，并添加您的应用程序，如下所示:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="938e" class="ln lo in lj b gy lp lq l lr ls">             specs: <br/>             - id: myapp<br/>               display-name: Student profile application<br/>               description: This is an application the has details of students and their performance<br/>               container-cmd: ["R","-e","shiny::runApp('/shiny/dashboard')"]<br/>               container-image: yourname/appimage</span></pre><p id="3740" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated"><em class="ld"> N/B 相应调整容器-cmd 和容器-图像。此外，确保 container-cmd 命令与 dockefile 中的一样，否则您的容器将无法启动。</em></p><p id="977d" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">一旦你做了调整，你现在可以回到运行 shinyproxy 的终端。用<strong class="jy io"> <em class="ld"> control + c </em> </strong>终止该进程，然后再次重启 shinyproxy，以便它拾取 yml 文件上的编辑。</p><p id="99b6" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">像以前一样打开你的浏览器，输入地址<a class="ae jv" href="http://127.0.0.1:8080*" rel="noopener ugc nofollow" target="_blank"><strong class="jy io"><em class="ld">http://127 . 0 . 0 . 1:8080</em></strong></a>。使用适当的凭证登录，您将在列表中看到您的应用程序。</p><p id="7322" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated"><strong class="jy io">还有 huuuurrrraaaaay！！我们已经设法建立了一个本地的 shinyproxy 系统。</strong></p><p id="f4a8" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">参考</p><ol class=""><li id="43a8" class="ku kv in jy b jz ka kd ke kh kw kl kx kp ky kt kz la lb lc bi translated"><a class="ae jv" href="https://www.shinyproxy.io/documentation" rel="noopener ugc nofollow" target="_blank"> shinyproxy 文档</a></li><li id="bb1d" class="ku kv in jy b jz ly kd lz kh ma kl mb kp mc kt kz la lb lc bi translated"><a class="ae jv" href="https://lukesingham.com/shiny-containers-with-shinyproxy/" rel="noopener ugc nofollow" target="_blank">https://lukesingham.com/shiny-containers-with-shinyproxy/</a></li><li id="adb4" class="ku kv in jy b jz ly kd lz kh ma kl mb kp mc kt kz la lb lc bi translated"><a class="ae jv" href="https://hub.analythium.io/docs/shinyproxy/" rel="noopener ugc nofollow" target="_blank">https://hub.analythium.io/docs/shinyproxy/</a></li></ol></div></div>    
</body>
</html>