<html>
<head>
<title>Automation is Easy — Reading Interactive PDF using PyPDF2 : AIE2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自动化很容易—使用 PyPDF2 : AIE2 阅读交互式 PDF</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/automation-is-easy-reading-interactive-pdf-using-pypdf2-aie2-e26f462e9429?source=collection_archive---------3-----------------------#2022-04-17">https://blog.devgenius.io/automation-is-easy-reading-interactive-pdf-using-pypdf2-aie2-e26f462e9429?source=collection_archive---------3-----------------------#2022-04-17</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="a1b6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi ki translated"><span class="l kj kk kl bm km kn ko kp kq di"> T </span> <em class="kr">他的是第</em> <strong class="jm io"> <em class="kr">第二</em> </strong> <em class="kr">条的</em> <strong class="jm io"> <em class="kr">自动化很容易</em> </strong> <em class="kr">系列。本系列旨在帮助/指导那些想要将日常业务活动自动化的人，这些日常业务活动是枯燥乏味的，是您探索各种工具/技术的第一步。</em></p></div><div class="ab cl ks kt hr ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ig ih ii ij ik"><p id="1e30" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在我们之前的<a class="ae kz" rel="noopener ugc nofollow" target="_blank" href="/automation-is-easy-how-to-use-pypdf2-package-in-python-9133bb3ab42a"> <strong class="jm io">文章</strong> </a>中，我们探讨了 python 的 PyPDF2 包的各种方法和类。在本文中，让我们了解如何从交互式 PDF 表单中提取数据(<a class="ae kz" href="https://www.slideshare.net/NagarajVaidya2/oopdfformexamplepdf" rel="noopener ugc nofollow" target="_blank">下载此处</a>)以及它与<code class="fe la lb lc ld b"><strong class="jm io">PyPDF2</strong></code>的<code class="fe la lb lc ld b"><strong class="jm io">extractText()</strong></code>方法有何不同。</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="lj lk l"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">本文中使用的带有表单域的 PDF</figcaption></figure></div><div class="ab cl ks kt hr ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ig ih ii ij ik"><h2 id="9eac" class="lp lq in bd lr ls lt dn lu lv lw dp lx jv ly lz ma jz mb mc md kd me mf mg mh bi translated">📖介绍</h2><p id="0705" class="pw-post-body-paragraph jk jl in jm b jn mi jp jq jr mj jt ju jv mk jx jy jz ml kb kc kd mm kf kg kh ig bi translated">PyPDF2 包的<code class="fe la lb lc ld b"><strong class="jm io">extractText()</strong></code>方法足以删除 PDF 并提取文本。但是如果<a class="ae kz" href="https://www.slideshare.net/NagarajVaidya2/oopdfformexamplepdf" rel="noopener ugc nofollow" target="_blank"> pdf </a>有交互表单域，如果没有表单域的特定锚点，如何从下图所示的<code class="fe la lb lc ld b"><strong class="jm io">extractText()</strong></code>方法的输出中区分 pdf 数据和表单域数据？(关于如何使用<code class="fe la lb lc ld b"><strong class="jm io">extractText()</strong></code>方法，请参考<a class="ae kz" rel="noopener ugc nofollow" target="_blank" href="/automation-is-easy-how-to-use-pypdf2-package-in-python-9133bb3ab42a">上一篇文章</a>)</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi mn"><img src="../Images/0025a5d9d6a69165bfa8ce2c1ede850b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y1uUCKQFzX8IBZTt5nY9AQ.png"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">extractText()方法的 pdf 输出</figcaption></figure><p id="59b7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了解决这个问题，PyPDF2 包的<code class="fe la lb lc ld b"><strong class="jm io">PdfFileReader</strong></code>类有两个方法</p><p id="6fee" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="kr"/><code class="fe la lb lc ld b"><strong class="jm io"><em class="kr">getFormTextFields()</em></strong></code><em class="kr">→给出带有表单输入字段的输出字典。<br/></em><code class="fe la lb lc ld b"><strong class="jm io"><em class="kr">getFields()</em></strong></code><em class="kr">→给出带有表单输入、下拉菜单、复选框数据的字典。</em></p><p id="1e74" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们详细了解一下这两种方法。</p></div><div class="ab cl ks kt hr ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ig ih ii ij ik"><h2 id="4cbd" class="lp lq in bd lr ls lt dn lu lv lw dp lx jv ly lz ma jz mb mc md kd me mf mg mh bi translated">📙了解 getFormTextFields()方法</h2><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="mu lk l"/></div></figure><p id="134b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上面的代码片段中，我们在第 1 行<strong class="jm io">从 PyPDF2 包中导入</strong>类。</p><p id="177d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">★改变<strong class="jm io">线 3 </strong>的 PDF 路径。你也可以使用绝对路径，如<strong class="jm io">r ' c:\ Users \ Automation is Easy \ your pdf . pdf</strong></p><p id="25ad" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">★ <strong class="jm io">第 6–8 行</strong> —通过创建<code class="fe la lb lc ld b"><strong class="jm io">PdfFileReader</strong></code> <strong class="jm io"> </strong>类的对象读取 PDF，调用该类的<code class="fe la lb lc ld b"><strong class="jm io">getFormTextFields()</strong></code> <strong class="jm io"> </strong>方法得到作为字典的输出。</p><p id="56c9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">★在打印如<strong class="jm io">第 9 行所示的输出时，</strong>输出将如下所示</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi mv"><img src="../Images/6537ffb5db5180c8f106c091365f8f92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JXecLenrSTcOmQvJGmEZEw.png"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">给定 pdf 的 getFormTextFields()输出</figcaption></figure><p id="9862" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">可以解析这个字典，通过传递适当的键值来获取特定的输入字段值，比如— <br/> <code class="fe la lb lc ld b"><strong class="jm io"><em class="kr">print(pdf_form_fields[‘Family Name Text Box’])</em></strong></code></p><p id="06bc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">其输出为<strong class="jm io"> </strong> —</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/52dba923bb5e27f5f43b16d232c2100b.png" data-original-src="https://miro.medium.com/v2/resize:fit:394/format:webp/1*-6BkW7TxB8kj-fP2EYk2Eg.png"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated"><code class="fe la lb lc ld b"><strong class="bd lr"><em class="mx">print(pdf_form_fields[‘Family Name Text Box’])</em></strong></code>的产量</figcaption></figure><p id="7f2b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> <em class="kr">🔥注意:</em> </strong> <code class="fe la lb lc ld b"><strong class="jm io"><em class="kr">getFormTextFields()</em></strong></code> <strong class="jm io"> <em class="kr">方法只会获取文本输入字段，不会获取下拉框或复选框。</em> </strong></p></div><div class="ab cl ks kt hr ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ig ih ii ij ik"><h2 id="8c70" class="lp lq in bd lr ls lt dn lu lv lw dp lx jv ly lz ma jz mb mc md kd me mf mg mh bi translated">📙了解 getFields()方法</h2><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="mu lk l"/></div></figure><p id="284e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上面的代码片段中，我们在第 1 行<strong class="jm io">从 PyPDF2 包中导入</strong>类。</p><p id="1fde" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">★变更<strong class="jm io">线 3 </strong>的 PDF 路径。你也可以使用绝对路径，比如—<strong class="jm io">r ' c:\ Users \ Automation is Easy \ your pdf . pdf</strong></p><p id="4a27" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">★ <strong class="jm io">第 6–8 行</strong> —通过创建<code class="fe la lb lc ld b"><strong class="jm io">PdfFileReader</strong></code> <strong class="jm io"> </strong>类对象并调用<code class="fe la lb lc ld b"><strong class="jm io">getFields()</strong></code> <strong class="jm io"> </strong>方法读取 PDF，得到作为字典的输出。</p><p id="182e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">★在<strong class="jm io">线 9 </strong>的输出看起来像这样—</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi mv"><img src="../Images/8ed79a65bc4d6243a3ac746678bb7449.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VMnZ-hAyaViqBaXrqr1KsA.png"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">给定 pdf 的 getFields()输出</figcaption></figure><p id="b999" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这个输出中，我们可以看到与文本字段、下拉框、复选框相关的数据被存储为一个<strong class="jm io">字典，其属性在一个嵌套字典</strong>中。为 PDF 中每个字段选择或填充的值存储在标签<strong class="jm io"> '/V '中。</strong></p><p id="4844" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了获取 pdf 中“最喜欢的颜色”字段的值，我们可以通过传递键'<strong class="jm io">最喜欢的颜色列表框</strong>和<strong class="jm io"> '/V' </strong>来解析这个嵌套的字典，以这种方式- <br/> <code class="fe la lb lc ld b"><strong class="jm io"><em class="kr">print(pdf_form_fields[“Favourite Colour List Box”][‘/V’])</em></strong></code></p><p id="d800" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这将获取如下所示的输出—</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi my"><img src="../Images/f6696c65fffcf848e64c32b53e5ef3e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:412/format:webp/1*fwScWUi2ImFOGnw6lmU0Kw.png"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">— <code class="fe la lb lc ld b"><strong class="bd lr"><em class="mx">print(pdf_form_fields[“Favourite Colour List Box”][‘/V’])</em></strong></code>的输出</figcaption></figure></div><div class="ab cl ks kt hr ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ig ih ii ij ik"><h2 id="0041" class="lp lq in bd lr ls lt dn lu lv lw dp lx jv ly lz ma jz mb mc md kd me mf mg mh bi translated">👢包扎</h2><p id="0794" class="pw-post-body-paragraph jk jl in jm b jn mi jp jq jr mj jt ju jv mk jx jy jz ml kb kc kd mm kf kg kh ig bi translated">因此，除了我们在这里讨论的<a class="ae kz" rel="noopener ugc nofollow" target="_blank" href="/automation-is-easy-how-to-use-pypdf2-package-in-python-9133bb3ab42a">和</a>专门处理交互式 PDF 的方法之外，我们了解了 PyPDF2 包中的另外两种方法。此外，我们理解了为什么这些方法比<code class="fe la lb lc ld b"><strong class="jm io">extractText()</strong></code> <strong class="jm io"> </strong>方法更好地获取 PDF 表单字段。</p></div><div class="ab cl ks kt hr ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ig ih ii ij ik"><h1 id="8b00" class="mz lq in bd lr na nb nc lu nd ne nf lx ng nh ni ma nj nk nl md nm nn no mg np bi translated">感谢阅读❤️继续分享📚</h1><blockquote class="nq nr ns"><p id="8170" class="jk jl kr jm b jn jo jp jq jr js jt ju nt jw jx jy nu ka kb kc nv ke kf kg kh ig bi translated"><strong class="jm io"># automation easy</strong></p></blockquote><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/a431cf77368314b38b5aeceba72d6337.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/1*ul5nNnTxrEp6TaSX0EcUsw.jpeg"/></div></figure></div></div>    
</body>
</html>