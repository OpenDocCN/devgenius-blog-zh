<html>
<head>
<title>How to Configure an AWS DynamoDB Table and IAM Role</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何配置 AWS DynamoDB 表和 IAM 角色</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-configure-an-aws-dynamodb-table-and-iam-role-5c705a50230d?source=collection_archive---------19-----------------------#2022-12-12">https://blog.devgenius.io/how-to-configure-an-aws-dynamodb-table-and-iam-role-5c705a50230d?source=collection_archive---------19-----------------------#2022-12-12</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/72f1bfa2e7370a8dd93a8273ea89c2d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xhsKbGifjh9IFej0m3U3ig.png"/></div></div></figure><p id="89f0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在这个项目中，我们将创建一个 DynamoDB 表，并用十大畅销弹球机填充它。然后，我们将应用基于角色的策略来允许来自 EC2 实例的读访问。</p><h2 id="b1c3" class="kt ku in bd kv kw kx dn ky kz la dp lb kg lc ld le kk lf lg lh ko li lj lk ll bi translated">项目目标</h2><ul class=""><li id="61d3" class="lm ln in jx b jy lo kc lp kg lq kk lr ko ls ks lt lu lv lw bi translated">创建一个 DynamoDB 表。</li><li id="d13b" class="lm ln in jx b jy lx kc ly kg lz kk ma ko mb ks lt lu lv lw bi translated">使用 IAM 角色和最小特权原则，授予 EC2 实例对 DynamoDB 的读取权限。</li><li id="1035" class="lm ln in jx b jy lx kc ly kg lz kk ma ko mb ks lt lu lv lw bi translated">在 EC2 实例中使用 AWS CLI 扫描 DynamoDB 表。</li><li id="a1e5" class="lm ln in jx b jy lx kc ly kg lz kk ma ko mb ks lt lu lv lw bi translated">在 EC2 实例中使用 AWS CLI 来验证您不能将项目写入 DynamoDB 表。</li></ul><h2 id="7118" class="kt ku in bd kv kw kx dn ky kz la dp lb kg lc ld le kk lf lg lh ko li lj lk ll bi translated">先决条件</h2><ul class=""><li id="96a9" class="lm ln in jx b jy lo kc lp kg lq kk lr ko ls ks lt lu lv lw bi translated">AWS 自由层帐户</li><li id="42ee" class="lm ln in jx b jy lx kc ly kg lz kk ma ko mb ks lt lu lv lw bi translated">EC2 实例</li></ul><h2 id="00ad" class="kt ku in bd kv kw kx dn ky kz la dp lb kg lc ld le kk lf lg lh ko li lj lk ll bi translated">什么是 DynamoDB？</h2><p id="72ee" class="pw-post-body-paragraph jv jw in jx b jy lo ka kb kc lp ke kf kg mc ki kj kk md km kn ko me kq kr ks ig bi translated">DynamoDB 是由 Amazon Web Services 提供的完全托管的 NoSQL 数据库服务，以其低延迟和可伸缩性而闻名。</p><p id="364c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">使用 DynamoDB，您可以以一种简单而经济的方式存储和检索任意数量的数据，并为任意级别的请求流量提供服务。固态硬盘提供高 I/O 性能，能够更高效地处理大量请求。用户通过 AWS 管理控制台或 DynamoDB API 与服务进行交互。</p><p id="d3e6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">DynamoDB 数据库使用非关系的 NoSQL 数据库模型，因此可以在其数据模型之间操作文档、图形和列关系。DynamoDB 支持条件操作以及基本的 CRUD 操作。每个 DynamoDB 查询都使用一个唯一标识每个项目的主键。</p><h2 id="e23e" class="kt ku in bd kv kw kx dn ky kz la dp lb kg lc ld le kk lf lg lh ko li lj lk ll bi translated">步骤 1:创建表格</h2><p id="a52f" class="pw-post-body-paragraph jv jw in jx b jy lo ka kb kc lp ke kf kg mc ki kj kk md km kn ko me kq kr ks ig bi translated">在 AWS 控制台中导航到<strong class="jx io"> <em class="mf"> DynamoDB </em> </strong>，点击<strong class="jx io"> <em class="mf">创建</em> </strong> <em class="mf"> </em> <strong class="jx io"> <em class="mf">表</em> </strong>。</p><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mg"><img src="../Images/5862a91a3956be7c2edbfbec7f3e9eb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LIvO2sMFG17tNm2sTAqUag.png"/></div></div></figure><p id="7494" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我将表命名为“<strong class="jx io"> <em class="mf"> Pinball </em> </strong>”，并将值“<strong class="jx io"> <em class="mf"> name </em> </strong>”用作分区键。不需要排序键，因为弹球机的名称将是唯一的。</p><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ml"><img src="../Images/8fea513ba1ac9c43d9e776433080a3d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qG0bSY4JBxtWtYkPHv3_jQ.png"/></div></div></figure><p id="6b64" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">保留默认值然后点击<strong class="jx io"> <em class="mf">创建表格</em> </strong></p><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mm"><img src="../Images/10e8abce859766e90df612225867956d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jBTkKTV5KPT5KaGSzu_WoQ.png"/></div></div></figure><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mn"><img src="../Images/5dc6583b211a3363c2290c0294c77e91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e4LH68J1xS6FwFRSu2kroA.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">显示 DynamoDB 表</figcaption></figure><p id="c31c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在让我们用十大最畅销的弹球机填充表格。点击表格然后从操作下拉菜单中选择“<strong class="jx io"> <em class="mf">创建项目</em> </strong>”。</p><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/bc914c0a5a0ea5a28a579607403f4757.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*soM5Jy5bbyrUR1pKqnTJQg.png"/></div></div></figure><p id="b3ea" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">点击“添加新属性”下拉菜单，选择“<strong class="jx io">编号</strong>，命名为“<strong class="jx io">单位</strong>”。我们将在这里输入每台弹球机售出的数量。填写适当的信息并选择“<strong class="jx io">创建项目</strong>”。重复接下来的九个项目。</p><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mt"><img src="../Images/e32b74373b667d484381a0090c32403c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TBWkYHdTi8-_jNc4g5KbZQ.png"/></div></div></figure><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mu"><img src="../Images/77dc4683e50641c840435df89358fcda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f_oWbslP0InoF6uuwix5dQ.png"/></div></div></figure><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mv"><img src="../Images/86a344bd1d46543027d580b736171d9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*My96ZCWnpao5AfnGXQdjag.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">显示完成的表格</figcaption></figure><h2 id="4563" class="kt ku in bd kv kw kx dn ky kz la dp lb kg lc ld le kk lf lg lh ko li lj lk ll bi translated">步骤 2:创建 IAM 角色</h2><p id="fad6" class="pw-post-body-paragraph jv jw in jx b jy lo ka kb kc lp ke kf kg mc ki kj kk md km kn ko me kq kr ks ig bi translated">在身份与访问管理仪表盘中，点击<strong class="jx io"> <em class="mf">【角色】</em></strong><strong class="jx io"><em class="mf">【创建角色】</em> </strong>。为可信实体选择“<strong class="jx io"> <em class="mf"> AWS 服务</em> </strong>”，为用例选择“<strong class="jx io"> <em class="mf"> EC2 </em> </strong>”。</p><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mw"><img src="../Images/ea42ba38f19f2997b8a5266a05fceb6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BkqiPFZ2MQwJjDtMuDMbVA.png"/></div></div></figure><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mx"><img src="../Images/297b75742b9ad11cc8e4a5c86ce10abd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hqxNMCxHISDhE06vFeXhsg.png"/></div></div></figure><p id="d719" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在下一个屏幕上，在搜索框中键入<strong class="jx io"><em class="mf">DynamoDBReadOnlyAccess</em></strong>并选择策略。</p><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi my"><img src="../Images/a0425428479a8a0995aeb2dca64e1005.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bsT8nwn5PXknyHo5nxY2nw.png"/></div></div></figure><p id="e975" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">给角色起个名字然后点击<strong class="jx io"> <em class="mf">创建角色</em> </strong>。</p><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mz"><img src="../Images/d140e066a0de91f25c7582827f1f5632.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9KdwqPPCSnabtRfUo5176w.png"/></div></div></figure><h2 id="81ef" class="kt ku in bd kv kw kx dn ky kz la dp lb kg lc ld le kk lf lg lh ko li lj lk ll bi translated">步骤 3:应用 IAM 角色</h2><p id="ab3b" class="pw-post-body-paragraph jv jw in jx b jy lo ka kb kc lp ke kf kg mc ki kj kk md km kn ko me kq kr ks ig bi translated">在控制台中导航到您的 EC2 实例。从<strong class="jx io"> <em class="mf">【动作】</em> </strong>【下拉转到<strong class="jx io"> <em class="mf">【安全】</em></strong>&gt;<strong class="jx io"><em class="mf">修改 IAM 角色</em> </strong></p><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div class="gh gi na"><img src="../Images/2f8914fb855ef596688eb16b936ced15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/1*VEuqVARTrhKvnUQsD7mN2A.png"/></div></figure><p id="b815" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在下一个屏幕上，选择我们的 IAM 角色，然后单击“<strong class="jx io"> <em class="mf">更新 IAM 角色</em> </strong>”。</p><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nb"><img src="../Images/cde959cff0000ad80150db886fac01a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*627Rkl9Z1hAQdPxL99xEqw.png"/></div></div></figure><h2 id="552a" class="kt ku in bd kv kw kx dn ky kz la dp lb kg lc ld le kk lf lg lh ko li lj lk ll bi translated">步骤 4:扫描 DynamoDB 表</h2><p id="b4bb" class="pw-post-body-paragraph jv jw in jx b jy lo ka kb kc lp ke kf kg mc ki kj kk md km kn ko me kq kr ks ig bi translated">连接到 EC2 实例，使用各自的表名运行下面的命令。</p><pre class="mh mi mj mk gt nc nd ne bn nf ng bi"><span id="8614" class="nh ku in nd b be ni nj l nk nl">aws dynamodb scan --table-name Pinball --region us-east-1</span></pre><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nm"><img src="../Images/14c2974a21c6e3a936ab07ad60c347b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uZwZM8hYQ4S5an9cao9TrA.png"/></div></div></figure><p id="3e7b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">看起来我们成功了，可以从 EC2 实例中读取数据了。</p><h2 id="623d" class="kt ku in bd kv kw kx dn ky kz la dp lb kg lc ld le kk lf lg lh ko li lj lk ll bi translated">步骤 5:测试权限</h2><p id="a5f9" class="pw-post-body-paragraph jv jw in jx b jy lo ka kb kc lp ke kf kg mc ki kj kk md km kn ko me kq kr ks ig bi translated">如果我们正确地设置了我们的角色，我们应该只能读表，不能写表。让我们通过尝试添加另一个项目来测试这一点。我将输入以下命令。</p><pre class="mh mi mj mk gt nc nd ne bn nf ng bi"><span id="9581" class="nh ku in nd b be ni nj l nk nl">aws dynamodb put-item — table-name Pinball — item ‘{“name”: {“S”: “Twilight Zone”},”units”: {“N”: “15235”}}’ — region us-east-1</span></pre><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nn"><img src="../Images/4e4fe182060cd8bd267dad89931c9e89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZwIIQXatwp7-1toXvRn30A.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">显示拒绝访问</figcaption></figure><p id="0bd0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">成功！我们收到一个拒绝访问的错误。我们的 IAM 角色正在工作，不允许我们对表进行写操作。</p></div></div>    
</body>
</html>