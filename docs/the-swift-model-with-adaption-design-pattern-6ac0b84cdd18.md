# 适应设计模式的 swift 模型

> 原文：<https://blog.devgenius.io/the-swift-model-with-adaption-design-pattern-6ac0b84cdd18?source=collection_archive---------12----------------------->

尽管确保 API 数据格式良好是后端开发人员的责任，但是在模型层中添加一点自适应逻辑并没有什么坏处

![](img/60125023ae18457ebdfcf640dd995174.png)

凯文·Ku 在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

作为一名 iOS 应用程序开发人员，当我们从 API 接收数据时，最好总是处理 JSON 数据中的一些例外情况，如行丢失、空值和字符串转换等。

就我个人而言，我总是在模型层添加额外的代码来过滤或转换一些特殊情况，以确保逻辑/视图模型层可以接收正确的数据

假设我们有一堆 JSON，其中缺少一些行。

与最后一个对象(" id": "390 ")相比，第一个(" id": "1 ")和第二个(" id": "2") JSON 对象缺少" year "和" mass "行。另外，第四个对象(“id”:“370”)缺少“地理位置”JSON 对象。

除此之外，我们可能需要拆分字符串(“year”:“1951–01–01t 00:00:00.000”)。虽然这些工作可以发生在 Logic/ViewModel 层，但是如果简单的操作可以在模型层完成，那就更有意义了。

此外，Swift 鼓励节省大量代码的函数式编程。因此，即使我们在模型中应用了很多逻辑，它看起来仍然很干净。

总的来说，我认为卸下一点责任来避免大量的 ViewModel/Logic 类是合理的。

下面是我处理这个特殊 JSON 的代码:

1:我们有一个协议向逻辑/视图模型层呈现必要的数据，因为有时我们不需要处理所有的 API 数据。同时，如果有必要，我们可以只设置对值的“get”访问。

2:我们让模型实现可解码的协议，为转换 API 数据做好准备。我强烈建议将 API 数据复制到这个网站，以获得您需要的模型:

 [## 即时解析任何语言的| quicktype

### 无论您使用的是 C#、Swift、TypeScript、Go、C++还是其他语言，quicktype 都会生成模型和辅助代码，用于…

app.quicktype.io](https://app.quicktype.io/) 

这将为您节省大量时间来检查所有 JSON 属性以找到特殊情况。

3:从 API 中检索数据后，我们扩展实现了陨石协议，以应用一些轻逻辑。正如我们从上面看到的，我们可以将逻辑绑定到值来处理空、缺失和字符串处理。

以下是应用这种模式的优势:

*   在逻辑/视图模型层，我们只初始化陨石对象来获得常规数据
*   如果 API 得到了更新，我们就不必麻烦 ViewModel 代码了。我们可以只更新模型层中的代码。
*   通过这样做，我们遵循了一个可靠的原则——接口分离原则，因为我们只向上层提供必要的方法和变量

如果你了解设计模式，你会发现这是一种自适应设计模式，它允许现有类的接口被用作另一个接口，而无需修改源代码。

如果你有兴趣阅读我的其他文章，欢迎查看我的[个人资料](https://medium.com/@lee5187415)。如果您有任何问题、意见或建议，请通过 [Linkedin](https://www.linkedin.com/in/lee-qi/) 联系我。