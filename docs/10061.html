<html>
<head>
<title>Laravel-Excel — P4: Importing Multiple Sheets Conditional Loading</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">laravel-Excel-P4:导入多张工作表条件加载</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/laravel-excel-p4-importing-multiple-sheets-conditional-loading-d70db3ae1409?source=collection_archive---------4-----------------------#2022-10-04">https://blog.devgenius.io/laravel-excel-p4-importing-multiple-sheets-conditional-loading-d70db3ae1409?source=collection_archive---------4-----------------------#2022-10-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/50b2ade28ac2d470fd5a17a6539db91f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zGf5hsS_YFLcdJbYe23E6g.jpeg"/></div></div></figure><p id="501e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用 Laravel Excel 可以解决多个工作表导入的一些问题。如果创建者改变了格式，你当然就没那么幸运了，你必须修改你的代码。然而，还有一些事情可能有助于理解，比如:</p><ul class=""><li id="69e6" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated">创建特定的导入，但只使用其中的一部分</li><li id="939e" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">以及理解如何处理公式</li></ul><p id="527b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将在本文中讨论有条件的工作表加载，在下一篇文章中讨论处理公式。</p><div class="lk ll gp gr lm ln"><a rel="noopener  ugc nofollow" target="_blank" href="/laravel-excel-p3-importing-multiple-sheets-and-handling-unknown-defined-sheets-749dbc1ec089"><div class="lo ab fo"><div class="lp ab lq cl cj lr"><h2 class="bd ir gy z fp ls fr fs lt fu fw ip bi translated">P3:导入多个工作表并处理未知的已定义工作表</h2><div class="lu l"><h3 class="bd b gy z fp ls fr fs lt fu fw dk translated">理想情况下，您会收到格式正确的 Excel 表格，这对于创建您的导入来说是小菜一碟…</h3></div><div class="lv l"><p class="bd b dl z fp ls fr fs lt fu fw dk translated">blog.devgenius.io</p></div></div><div class="lw l"><div class="lx l ly lz ma lw mb jw ln"/></div></div></a></div><h1 id="2158" class="mc md iq bd me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz bi translated">使用特定进口商</h1><p id="e665" class="pw-post-body-paragraph jy jz iq ka b kb na kd ke kf nb kh ki kj nc kl km kn nd kp kq kr ne kt ku kv ij bi translated">您可能有一个 excel 工作表，其中包含多个需要导入的工作表。因此，您需要花费必要的时间来编写导入每个工作表所需的代码。一切似乎都很好。但是，当数据只在一张表上发生变化时，会发生什么情况呢？您仍然想要导入所有其他工作表还是只导入那张工作表？这能做到吗？是的，它可以。</p><p id="80e0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，让我们回顾一下定义所有表的导入的导入器。</p><figure class="nf ng nh ni gt jr"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="400a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">该进口商希望装载三种不同的纸张，<code class="fe nl nm nn no b">user_data_1</code>、<code class="fe nl nm nn no b">user_data_2</code>和<code class="fe nl nm nn no b">user_data_3</code>。</p><p id="f766" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果只在<code class="fe nl nm nn no b">user_data_1</code>上有变化，我们可以指定只使用那个。我们的代码需要做一些修改。首先，我们需要在我们的进口商中使用<code class="fe nl nm nn no b">WithConditionalSheets</code>特征。接下来，我们需要用所需的<code class="fe nl nm nn no b">conditionalSheets()</code>方法替换我们的<code class="fe nl nm nn no b">sheets()</code>方法。</p><figure class="nf ng nh ni gt jr"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="03be" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们创建我们的路由，并将方法添加到我们的<code class="fe nl nm nn no b">UserController</code>中，以便调用进口商。</p><figure class="nf ng nh ni gt jr"><div class="bz fp l di"><div class="nj nk l"/></div></figure><figure class="nf ng nh ni gt jr"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="bf81" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您一直在关注前面的文章，您会注意到<code class="fe nl nm nn no b">Excel::import</code>方法的第一个参数有所不同。我们需要指定我们这次只使用特定的表。在这个例子中，我们声明我们只希望传递<code class="fe nl nm nn no b">user_data_1</code>工作表，但是我们也可以像这样指定多个工作表:<code class="fe nl nm nn no b">-&gt;onlySheets('user_data_1', 'user_data_2')</code>。</p><p id="c196" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此外，您可以像这样编写以下示例:</p><pre class="nf ng nh ni gt np no nq nr aw ns bi"><span id="e648" class="nt md iq no b gy nu nv l nw nx">$import = new MultiSheetSelectSpecificSheet();<br/>$import-&gt;onlySheets('user_data_1');</span><span id="1577" class="nt md iq no b gy ny nv l nw nx">Excel::import($import, 'mock_data/MOCK_DATA_3.xlsx');</span></pre><p id="4c46" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我这边一切顺利。希望你的电脑也一切正常。</p><div class="lk ll gp gr lm ln"><a href="https://github.com/dinocajic/package-laravel-excel" rel="noopener  ugc nofollow" target="_blank"><div class="lo ab fo"><div class="lp ab lq cl cj lr"><h2 class="bd ir gy z fp ls fr fs lt fu fw ip bi translated">GitHub-dinocajic/package-Laravel-Excel:显示了 Laravel Excel 的示例功能</h2><div class="lu l"><h3 class="bd b gy z fp ls fr fs lt fu fw dk translated">Laravel 是一个 web 应用程序框架，具有丰富、优雅的语法。我们相信发展必须是令人愉快的…</h3></div><div class="lv l"><p class="bd b dl z fp ls fr fs lt fu fw dk translated">github.com</p></div></div><div class="lw l"><div class="nz l ly lz ma lw mb jw ln"/></div></div></a></div></div><div class="ab cl oa ob hu oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="ij ik il im in"><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/4e849973f5e716b26b1c214511d81438.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9ztYM02j9y8yZ1Oc.jpeg"/></div></figure><p id="0c3f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">迪诺·卡伊奇目前是<a class="ae oi" href="https://www.lsbio.com/" rel="noopener ugc nofollow" target="_blank"> LSBio(生命周期生物科学公司)</a>、<a class="ae oi" href="https://absoluteantibody.com/" rel="noopener ugc nofollow" target="_blank">绝对抗体</a>、<a class="ae oi" href="https://www.kerafast.com/" rel="noopener ugc nofollow" target="_blank"> Kerafast </a>、<a class="ae oi" href="https://everestbiotech.com/" rel="noopener ugc nofollow" target="_blank">珠穆朗玛生物</a>、<a class="ae oi" href="https://www.nordicmubio.com/" rel="noopener ugc nofollow" target="_blank">北欧 MUbio </a>和<a class="ae oi" href="https://www.exalpha.com/" rel="noopener ugc nofollow" target="_blank"> Exalpha </a>的 IT 主管。他还担任我的自动系统的首席执行官。他有十多年的软件工程经验。他拥有计算机科学学士学位，辅修生物学。他的背景包括创建企业级电子商务应用程序、执行基于研究的软件开发，以及通过写作促进知识的传播。</p><p id="60f9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以在<a class="ae oi" href="https://www.linkedin.com/in/dinocajic/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上联系他，在<a class="ae oi" href="https://instagram.com/think.dino" rel="noopener ugc nofollow" target="_blank"> Instagram </a>上关注他，或者<a class="ae oi" href="https://dinocajic.medium.com/subscribe" rel="noopener">订阅他的媒体出版物</a>。</p><p id="dc62" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae oi" href="https://dinocajic.medium.com/membership" rel="noopener"> <em class="oj">阅读迪诺·卡吉克(以及媒体上成千上万其他作家)的每一个故事。你的会员费直接支持迪诺·卡吉克和你阅读的其他作家。你也可以在媒体上看到所有的故事。</em> </a></p></div></div>    
</body>
</html>