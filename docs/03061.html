<html>
<head>
<title>Easily Add Drawing Capabilities to your iOS app with PencilKit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用PencilKit轻松将绘图功能添加到您的iOS应用程序</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/easily-add-drawing-capabilities-to-your-ios-app-with-pencilkit-c0d07e976bd9?source=collection_archive---------0-----------------------#2020-09-25">https://blog.devgenius.io/easily-add-drawing-capabilities-to-your-ios-app-with-pencilkit-c0d07e976bd9?source=collection_archive---------0-----------------------#2020-09-25</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="0de7" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">惊人的功能，最少的代码。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/991ccafd1b95e7f64cab04cbb3dabdb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kObMHLf9NG6nBDf4"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">托尼·塞巴斯蒂安在<a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="db6b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">PencilKit框架是苹果在iOS 13中推出的。它让开发人员能够通过Apple Pencil或touch轻松地将书写和绘图功能添加到自己的应用程序中。这与苹果在他们的应用程序(如Notes)中使用的低延迟框架相同。</p><blockquote class="lp lq lr"><p id="db08" class="kt ku ls kv b kw kx jo ky kz la jr lb lt ld le lf lu lh li lj lv ll lm ln lo ig bi translated">PencilKit可以轻松地将手绘内容整合到您的iPadOS或macOS应用程序中。PencilKit为您的iOS应用程序提供了一个绘图环境，该环境接收来自Apple Pencil或用户手指的输入，并将其转换为您在iPadOS、iOS或macOS中显示的图像。该环境附带了用于创建、擦除和选择线的工具。— <a class="ae ks" href="https://developer.apple.com/documentation/pencilkit" rel="noopener ugc nofollow" target="_blank">苹果开发者pencil kit</a></p></blockquote></div><div class="ab cl lw lx hr ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ig ih ii ij ik"><p id="a78b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">开始时你只需要三行代码</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="aa52" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">PKCanvasView 处理所有通过Apple Pencil添加到应用程序的信息，并通过指定的工具进行触摸。所有这些信息和数据都存储在一个<a class="ae ks" href="https://developer.apple.com/documentation/pencilkit/pkdrawing" rel="noopener ugc nofollow" target="_blank"> PKDrawing </a>对象中，您可以在应用程序中保存和加载该对象，或者导出为图像。你既可以设置自己的工具，也可以使用苹果的原生<a class="ae ks" href="https://developer.apple.com/documentation/pencilkit/pktoolpicker" rel="noopener ugc nofollow" target="_blank"> PKToolPicker </a>。</p><p id="acab" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在画布上绘图是无缝的，是一种非常愉快的用户体验。</p></div><div class="ab cl lw lx hr ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ig ih ii ij ik"><p id="5147" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">一个简单的例子:一个可爱的绘画应用程序，针对有创造力的孩子。</p><p id="968f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在Xcode 12中创建新项目，选择界面的<strong class="kv io"> App </strong>模板和<strong class="kv io">故事板</strong>。在项目的目标常规选项卡中，将<strong class="kv io">设备方向</strong>设置为<strong class="kv io">横向向左</strong>。</p><p id="769f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们将使用<strong class="kv io">资产目录</strong>来管理颜色。向您的项目添加一个新文件，滚动到Resources部分并选择Asset Catalog。命名为颜色。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mf"><img src="../Images/cc1fc86bad93620e84d736ffbdc26c4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fil1EF0bSFfQs8hEV4Hjaw.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">选择资产目录</figcaption></figure><p id="5ecf" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在颜色资产目录的底部，单击添加标志并选择<strong class="kv io">颜色集。</strong></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mg"><img src="../Images/b9d89151711d5339be44326e5bc7b8ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JojRnYVKBxHaCh22fJLgaw.png"/></div></div></figure><p id="6a03" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">将创建两个空颜色集。这些是为了管理你的应用程序中亮暗模式的颜色。然而，由于我们正在创建一个旨在绘图的应用程序，我们不需要以这种方式管理颜色(除非你想😊).</p><p id="3574" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">点击<strong class="kv io">属性的检查器</strong>。命名你的新颜色，然后在<strong class="kv io">外观</strong>部分选择<strong class="kv io">无。</strong>在<strong class="kv io">颜色</strong>部分，将输入法设置为<strong class="kv io"> 8位(0–255)</strong>或<strong class="kv io"> 8位十六进制</strong>(如果看不到颜色部分，点击颜色设置)。我想为应用程序的彩色调色板，并使用以下名称和十六进制值:</p><ul class=""><li id="ad8b" class="mh mi in kv b kw kx kz la lc mj lg mk lk ml lo mm mn mo mp bi translated">婴儿蓝(<strong class="kv io"> 6EB5FF </strong></li><li id="f236" class="mh mi in kv b kw mq kz mr lc ms lg mt lk mu lo mm mn mo mp bi translated">毛茛(<strong class="kv io"> FFF5BA </strong>)</li><li id="3ce8" class="mh mi in kv b kw mq kz mr lc ms lg mt lk mu lo mm mn mo mp bi translated">丁香(<strong class="kv io"> DCD3FF </strong>)</li><li id="402e" class="mh mi in kv b kw mq kz mr lc ms lg mt lk mu lo mm mn mo mp bi translated">草甸(<strong class="kv io"> BFFCC6 </strong>)</li><li id="1694" class="mh mi in kv b kw mq kz mr lc ms lg mt lk mu lo mm mn mo mp bi translated">罗斯(<strong class="kv io"> FFABAB </strong></li></ul><p id="f341" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在您的ViewController中导入<strong class="kv io"> PencilKit </strong>框架。创建颜色的可迭代枚举。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="b596" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在ViewController中创建以下属性。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="c5b5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们创建一个<strong class="kv io"> PKCanvasView </strong>，通过<strong class="kv io"> PKInkingTool </strong>创建三种钢笔类型，通过<strong class="kv io"> PKEraserTool </strong>创建一个橡皮擦。如你所见，我正在使用<strong class="kv io">。铅笔</strong>类型适用于蜡笔和铅笔。没有<strong class="kv io">。蜡笔</strong>型(虽然也有<strong class="kv io">)。笔</strong>类型)所以我决定改变这两支笔的宽度，以产生蜡笔🖍和铅笔✏️的效果。</p><p id="b85e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们将以编程方式创建UI。我将把它分解成三个步骤。第一步是将PKCanvasView添加到ViewController中。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="8831" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">画布将与我们的视图大小相同，我们将它的<strong class="kv io">绘制策略</strong>设置为<strong class="kv io">。anyInput </strong>所以孩子们可以用苹果铅笔或手指画画。我们画布的默认工具是蜡笔。</p><p id="f8bd" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">第二步是创建调色板按钮。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="dce5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们遍历Colors枚举，为每种情况创建一个按钮，并将原始整数值指定为按钮的标记。按钮的标签将用于确定在<strong class="kv io"> updatePens </strong>函数中点击了哪种颜色。</p><p id="159d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">然后，我们创建一个水平的UIStackView，并将所有按钮作为子视图添加到其中。最后，我在stackview上指定约束，使它位于视图的底部。</p><p id="cadd" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我使用一个助手函数，通过扩展UIButton使我的按钮变圆。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="9c64" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">最后一步是创建工具。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="182b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们使用一个助手函数来创建名为<strong class="kv io"> createButton </strong>的工具按钮。</p><p id="3cee" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">当点击工具按钮时，我们将适当的工具设置到画布上。我们将使用<a class="ae ks" href="https://developer.apple.com/documentation/foundation/undomanager" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io">撤销管理器</strong> </a>来管理绘图操作。</p><p id="4445" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">然后，我们创建一个垂直的stackview，向它添加工具按钮，并设置它在屏幕左侧的约束。</p><p id="85e9" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">回到调色板按钮，我提到过当点击这些按钮时调用<strong class="kv io"> updatePens </strong>函数。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="18fc" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">该函数获取被点击的按钮，并使用其标签来计算选择了哪种颜色。然后，它将画布使用的工具更新为新的颜色(如果可能的话)以及其他钢笔。</p></div><div class="ab cl lw lx hr ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ig ih ii ij ik"><p id="cf8b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这是正在运行的应用程序。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mv"><img src="../Images/0b1de0c7156af37d38ae3570f35cd17c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e8fW4lXzy7fV4PdYH24TBg.jpeg"/></div></div></figure><p id="0f9c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">用最少的代码实现强大的功能！😄</p></div></div>    
</body>
</html>