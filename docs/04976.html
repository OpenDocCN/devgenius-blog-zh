<html>
<head>
<title>Add a Diff Display into a React App with the jsdiff Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 jsdiff 库将比较显示添加到 React 应用程序中</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/add-a-diff-display-into-a-react-app-with-the-jsdiff-library-5df6fe85f66d?source=collection_archive---------6-----------------------#2021-05-29">https://blog.devgenius.io/add-a-diff-display-into-a-react-app-with-the-jsdiff-library-5df6fe85f66d?source=collection_archive---------6-----------------------#2021-05-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/0603c5e67098d6078a09be24d42c43bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-RJwlyuRWsB37cy-"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@miracleday?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">埃琳娜·莫日维洛</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="58bf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有时，我们可能想向用户展示两段文本之间的区别。</p><p id="7383" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以通过 jsdiff 库轻松做到这一点。</p><p id="45bf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解如何在 React 中使用 jsdiff 库。</p><h1 id="4fc7" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">装置</h1><p id="d207" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过运行以下命令来安装该库:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="defe" class="mn lc iq mj b gy mo mp l mq mr">npm install diff --save</span></pre><h1 id="d9ab" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">添加差异显示</h1><p id="e47f" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过编写以下代码将差异显示添加到 React 应用程序中:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="7425" class="mn lc iq mj b gy mo mp l mq mr">import React from "react";<br/>const Diff = require("diff");</span><span id="f994" class="mn lc iq mj b gy ms mp l mq mr">const one = "beep boop";<br/>const other = "beep boob blah";</span><span id="79b7" class="mn lc iq mj b gy ms mp l mq mr">const diff = Diff.diffChars(one, other);<br/>export default function App() {<br/>  return (<br/>    &lt;div className="App"&gt;<br/>      {diff.map((part) =&gt; {<br/>        const color = part.added ? "green" : part.removed ? "red" : "grey";<br/>        return &lt;span style={{ color }}&gt;{part.value}&lt;/span&gt;;<br/>      })}<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="7cde" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">one</code>和<code class="fe mt mu mv mj b">other</code>字符串是我们想要区分的。</p><p id="2922" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用它们两个调用<code class="fe mt mu mv mj b">Diff.diffChars</code>来创建<code class="fe mt mu mv mj b">diff</code>数组。</p><p id="7cfc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们调用<code class="fe mt mu mv mj b">diff.map</code>将不同的部分映射到<code class="fe mt mu mv mj b">span</code>元素。</p><p id="339c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当零件在第二串而不是第一串时,<code class="fe mt mu mv mj b">part.added</code>是<code class="fe mt mu mv mj b">true</code>。</p><p id="2826" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">part.removed</code>是<code class="fe mt mu mv mj b">true</code>当零件不在第二串中但在第一串中。</p><p id="0944" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">part.value</code>具有部分的价值。</p><p id="83c6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们应该看到显示的比较。</p><p id="5400" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">显示屏将显示第二串，即<code class="fe mt mu mv mj b">other</code>串，添加到第一串的零件为绿色，从第一串中移除的零件为红色。</p><p id="8599" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用<code class="fe mt mu mv mj b">diffJson</code>方法显示不同的 JSON 对象。</p><p id="2787" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了使用它，我们写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="f4a1" class="mn lc iq mj b gy mo mp l mq mr">import React from "react";<br/>const Diff = require("diff");</span><span id="3b87" class="mn lc iq mj b gy ms mp l mq mr">const one = { foo: "bar", bar: "baz" };<br/>const other = { foo: "bar", bar: "bar" };</span><span id="a999" class="mn lc iq mj b gy ms mp l mq mr">const diff = Diff.diffJson(one, other);<br/>export default function App() {<br/>  return (<br/>    &lt;div className="App"&gt;<br/>      {diff.map((part) =&gt; {<br/>        const color = part.added ? "green" : part.removed ? "red" : "grey";<br/>        return &lt;span style={{ color }}&gt;{part.value}&lt;/span&gt;;<br/>      })}<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="b8ff" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它将用我们设置的相同颜色显示添加、删除或保持不变的属性。</p><p id="9275" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其他方法包括<code class="fe mt mu mv mj b">diffTrimmedLines</code>方法来逐行比较文本，忽略前导和尾随空白。</p><p id="01cb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">diffSentences</code>逐句比较两个文本块。</p><p id="3927" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">diffCss</code>比较 2 个 CSS 标记。</p><p id="e482" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">diffArrays</code>用<code class="fe mt mu mv mj b">===</code>操作符比较 2 个数组的条目。</p><p id="9e50" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它们都返回与示例中属性相同的对象数组。</p><h1 id="83e5" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="3d71" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以将 jsdiff 库与 React 一起使用，轻松地向用户显示文本差异。</p></div></div>    
</body>
</html>