<html>
<head>
<title>Creating an EC2 Autoscaling Group with an Application Load Balancer</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用应用程序负载平衡器创建 EC2 自动扩展组</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/creating-an-ec2-autoscaling-group-with-an-application-load-balancer-5e54dc15337d?source=collection_archive---------14-----------------------#2022-12-03">https://blog.devgenius.io/creating-an-ec2-autoscaling-group-with-an-application-load-balancer-5e54dc15337d?source=collection_archive---------14-----------------------#2022-12-03</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="e3ed" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Apache web 服务器的自动化供应和扩展</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f7c0767c6cb01a7743e5b52e83daee21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F_GtA5YDZCu9Vujtrq8qzQ.png"/></div></div></figure><p id="872a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在本教程中，我们将为您的 Apache web 服务器创建一个自动伸缩组，并将其置于应用程序负载平衡器之后。</p><h1 id="0089" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">要求</h1><ul class=""><li id="5264" class="ls lt in jm b jn lu jr lv jv lw jz lx kd ly kh lz ma mb mc bi translated">AWS 自由层</li></ul><h1 id="ecf2" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">步骤 1:创建 VPC</h1><p id="1523" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv md jx jy jz me kb kc kd mf kf kg kh ig bi translated">第一步是创建一个新的 VPC 来划分我们的 web 应用资源。我们将在三个不同的可用性区域中创建三个公共子网，以确保高可用性。</p><p id="b745" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">登录控制台后，从仪表板中找到 VPC 服务。点击<strong class="jm io">创建 VPC </strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mg"><img src="../Images/4cd50c4a731398476dce84d08f172e8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ow8KhLfgD8aXvj3WMe3qmg.png"/></div></div></figure><p id="9015" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将利用 AWS 新的<strong class="jm io"> <em class="mh">创建 VPC 体验</em> </strong> <em class="mh"> </em>来为我们的资源自动生成名称，并为我们创建子网、路由表和互联网网关。</p><p id="167d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们将我们的项目命名为"<strong class="jm io"> Web-App </strong>"并将<strong class="jm io"> 10.10.0.0/16 </strong>网络用于我们的 VPC，并将其划分为以下公共子网:<strong class="jm io"> 10.10.1.0/24 </strong>、<strong class="jm io"> 10.10.2.0/24 </strong>和<strong class="jm io"> 10.10.1.0/24 </strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mi"><img src="../Images/d7abf5a8d9cca96af1237fd88dd41f28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OZdDCMY4RCUZ11r8oKK4kA.png"/></div></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk translated">展示新的创造 VPC 体验</figcaption></figure><p id="51a0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">将可用性区域的数量更改为 3，将专用子网的数量更改为 0。使用我们指定的填充自定义的子网 CIDR 块，并将 VPC 端点更改为无。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/0baa703c1397e7b2fac348d3fc6f4e2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/1*_oQBUzh4mS-B6l9-NmV7Zw.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mo"><img src="../Images/c8cc18c4d19b89822789e0333241fc0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WOEt_U9aRjhfB5yIpAzjcQ.png"/></div></div></figure><h1 id="1da8" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">步骤 2:创建启动模板</h1><p id="712a" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv md jx jy jz me kb kc kd mf kf kg kh ig bi translated">现在，我们的 VPC 和网络资源已经创建，我们可以创建一个启动模板，将用于我们的自动缩放组。</p><p id="8f69" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">首先，让我们创建一个安全组来允许 web 流量。导航到 VPC &gt;安全组，然后点击“创建安全组”。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mp"><img src="../Images/8922f4669c3bdc505dc3a3c46458e115.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xp1JiANxslU4sIOd9qt5VA.png"/></div></div></figure><p id="6973" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">创建以下安全组，以允许来自任何来源的 TCP 端口 80 和 443 的入站流量。姑且称之为“允许-Web-访问”。在下拉列表中选择我们刚刚创建的 VPC。然后单击“创建安全组”</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mq"><img src="../Images/81b56dc8345d010fa232a98c6da1030f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FS4FmIvEfx87EXbke2oPvw.png"/></div></div></figure><p id="db53" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">导航到实例&gt;启动模板，然后单击“创建启动模板”</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mr"><img src="../Images/1e681e97bdc6b215f2026ac3d4ab68bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xiBEI8j4nMshNZGuRmiHVg.png"/></div></div></figure><p id="bbc5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">给出一个模板名，并从自由层和 t2.micro 实例中选择一个 Amazon AMI。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/d1a8a17118087cd8b127ae0c4092e45e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N0iYaoTHrNM3EAGOCMO_5g.png"/></div></div></figure><p id="d13c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">分配一个预先存在的密钥对和我们刚刚创建的安全组。在“高级网络配置”下，将“自动分配公共 IP”更改为启用<strong class="jm io"/>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/18bb3a32fd5397be9caec58093176caf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gYE_HyHuNgRYiql1IjbQIw.png"/></div></div></figure><p id="e948" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">点击“高级详细信息”箭头，向下滚动到“用户数据”字段。输入下面的代码，这些代码将用于在启动时提供我们的 Apache web 服务器。然后单击创建。</p><pre class="kj kk kl km gt mu mv mw bn mx my bi"><span id="ab1f" class="mz kv in mv b be na nb l nc nd">#!/bin/bash<br/>yum update -y<br/>yum install -y httpd<br/>systemctl start httpd<br/>systemctl enable httpd<br/>EC2AZ=$(curl -s http://169.254.169.254/latest/meta-data/placement/availability-zone) <br/>echo '&lt;center&gt;&lt;h1&gt;This Amazon EC2 instance is located in Availability Zone: AZID &lt;/h1&gt;&lt;/center&gt;' &gt; /var/www/html/index.txt<br/>sed "s/AZID/$EC2AZ/" /var/www/html/index.txt &gt; /var/www/html/index.html</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/e95cff80b70524c81806ce1ddfe5f36c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wowFCM9BKi1mwXd90v3gZA.png"/></div></div></figure><h1 id="091f" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">步骤 3:创建自动缩放组</h1><p id="3008" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv md jx jy jz me kb kc kd mf kf kg kh ig bi translated">导航到自动缩放&gt;自动缩放组，然后单击“创建自动缩放组”</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/45eae3c59a652ed929070d5be60524ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XAFsnQqibPaAbzwRSBfQcA.png"/></div></div></figure><p id="12dc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">给它起个名字，然后选择我们刚刚创建的模板。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/0fc464420c14e64f74778f892e873003.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b_pwkio4FyDuYOKs8txAIw.png"/></div></div></figure><p id="848b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在下一页上，从下拉列表中选择我们新创建的 VPC，并选中所有 3 个子网的复选框。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/7dc3f5d6034e901d9e9d62ee9d4d4700.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WL0T5jRg-woKLWWvbN9KFw.png"/></div></div></figure><p id="3ff0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">选择“连接到新的负载平衡器”选项，然后选择“面向互联网”。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/3d24b9d1b554ac31727f1ec762275fee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wIP1zLVyG8YQsE83Vri0SA.png"/></div></div></figure><p id="0bbb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">选择“监听器和路由”下的“创建目标组”,保留默认值。单击下一步。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/927814ff67d67475f15c02e5a19cdb20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dJnQI-pmb8CVhUTeDMaHzQ.png"/></div></div></figure><p id="6e3f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">将组大小更改为如下所示的设置，然后单击“跳过查看”，然后单击“创建自动缩放组”。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/c8a52adb47a7f721feb95f658ce8f58d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0KfywJ7VB2Pe5ibNTA1TFQ.png"/></div></div></figure><p id="fbc0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你现在应该看到我们的自动缩放组列出。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/71e40814cc0510d5039f2c568194ee25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hb_I0tgLDs7_Py2mZtAwmg.png"/></div></div></figure><p id="fa46" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">您可以到控制台中的 EC2 实例部分进行确认。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/9f8fe99ffe264a5ea9ef303256edf0ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*75nlT1apKuDgPtffmp2Ifw.png"/></div></div></figure><p id="aa41" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">目前，我们的 web 应用可以通过我们创建的安全组接收入站流量。但是我们的负载平衡没有应用安全组。让我们转到我们的负载平衡器并应用该组。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/1ff31fe657294f92389fc9c8bd10dc1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lh_WA9zbJKFSsrrc0aMDFA.png"/></div></div></figure><p id="5b22" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在我们的负载平衡器配置中，转到 security 选项卡，然后单击 edit 添加我们的“Allow-Web-Access”安全组。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/8dda4ffedd33edc771d3eb6589e95734.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_SUVVPANQZgfiJVG07S3Uw.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/a1d06f153960ca831c1803e8d1d961d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zaEv_-qxWgiWdjDRLM3yBw.png"/></div></div></figure><p id="066a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">保存更改后，复制我们的负载平衡器的 DNS 名称，并将其输入到 web 浏览器中以测试我们的 web 服务器。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/c39b00fe00e30a685b0f1520a0d31bc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vy5yUmynldkFvXZX6vA3iw.png"/></div></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk translated">显示负载平衡器 DNS 名称</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/c8337020d792db89dfcdeca8e6e4efd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yKoYYwbgYg0SS8gnsww1CA.png"/></div></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk translated">显示工作的 web 服务器</figcaption></figure><p id="2e0e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">成功！就是这样。</p></div></div>    
</body>
</html>