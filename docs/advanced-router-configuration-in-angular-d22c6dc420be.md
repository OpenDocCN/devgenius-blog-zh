# Angular 中的高级路由器配置

> 原文：<https://blog.devgenius.io/advanced-router-configuration-in-angular-d22c6dc420be?source=collection_archive---------1----------------------->

![](img/c139cca154ec0fbad90000e7165dcc15.png)

**由** [**马库斯·斯皮斯克**](https://unsplash.com/@markusspiske) 从 Unsplash 中编码图像

我们所有人都将路由作为一个或另一个应用程序的一部分，以允许用户通过路由从一个页面导航到另一个页面。Angular 附带了一个默认的解决方案，称为 **RouterModule** ，用于在应用中实现路由。

**RouterModule** 使用和添加到您的应用程序中非常简单。在最简单的方法中，它只是在应用程序的模块中导入您想要的路线及其各自的组件。例如:-

因此，我们在应用程序模块导入中使用了路由器模块，并给了它一个路由数组，现在，考虑到您在应用程序组件模板中有路由器出口标签，您的路由可用于到达这些组件。但是我们也看到了使用**作为根**方法，所以让我们通过 **RouterModule** 的接口来看看 **RouterModule** 可用的不同方法。

所以只有两种方法可用，即 Root 和 forChild。从定义中我们可以看到，forRoot 接受两个参数，即 routes 和一个可选的配置对象，而 forChild 只接受 routes。

> forRoot 通常用在应用程序的根模块中，因为它注册了提供者/指令/路由器服务等。RouterModule 需要。
> 
> forChild 用于为其他模块(如惰性加载模块)定义路由。唯一的区别是它没有重新注册路由器服务。

我们这里要讨论的是 forRoot 方法中的第二个 config 对象。因为它允许我们通过我们可能想要使用的路线实现各种事情。所以让我们先看看它的接口，即 ExtraOptions。

这些我们一个一个来讨论吧。

1.  **启用跟踪**

当此标志为真时，angular 会将所有内部导航事件记录到控制台，如路由器何时激活、导航何时开始、导航何时结束等。当面临路由配置问题时，这对于调试非常有用。

**2。使用哈希**

这个标志在非常特殊的情况下会有所帮助。让我们来看一个场景，您在 tomcat 服务器上部署了一个 angular 应用程序。您的角度应用程序中有一条路线，即/仪表盘。现在你在浏览器中点击**www.abc.com/dashboard**。在这种情况下，浏览器转到服务器，服务器开始检查此 URL 并返回 404(未找到),因为此 URL 在服务器上不存在，因为这是一条角度路由。因此有两种方法来解决这个问题，即:-配置您的服务器在这些情况下返回 index.html 或使用 **useHash** 策略。

www.abc.com/#/dashboard**使用哈希**做的是你的网址现在会变成**。现在，当你点击 URL 时，浏览器不会发送散列后的 URL，现在你会得到**index.html**的服务，angular 会处理仪表板路线。但是在这种情况下，配置服务器是更好的方法。因为#也用于**定位滚动**，我们将在下一点中讨论。**

****3。锚点滚动****

**当设置为“启用”时，当 URL 有片段时，滚动到定位元素。默认情况下，锁定滚动是禁用的。也就是说，当你点击仪表板路径时，页面将被移动以聚焦这个锚定标签，无论它在页面上的位置在哪里。你一定遇到过这样的网页，所有的内容都在同一个页面上，但是通过 URL 它们会把你带到特定的部分。通过这种技术，你可以达到同样的角度。**

****4。初始导航****

**当设置为`enabled`时，初始导航在根组件创建之前开始。在初始导航完成之前，引导会被阻止。该值是服务器端呈现工作所必需的。当设置为`disabled`时，不执行初始导航。位置侦听器是在创建根组件之前设置的。**

**在大多数应用程序中，这是不需要的，除非由于复杂的情况，需要对导航进行更多的控制。**

****5。错误处理器****

**ErrorHandler 是我们在应用程序中实现的一个类，用于全局处理错误。一种方法是使用一个处理程序并检查其中的错误类型，然后用您想要实现的任何行为来相应地处理它。但是，假设您希望路由器有一个单独的错误处理程序，只处理特定于路由器的错误，这样您就可以有一个错误处理程序的实现类，并将其传递给 error handler 属性，如下所示。**

****6。预加载策略****

**如果您想在用户导航到 route 之前预加载惰性加载的模块，预加载策略基本上有助于配置策略。角度提供器内置两种策略，即**预加载所有模块**或**不预加载**(默认)。您可以找到用于制定自定义预加载策略的文章数量，并将其传递给该属性。**

**7。onsameurlnaviation**

**尝试一件事，尝试通过 router.navigate 导航到当前激活 angular 应用程序中相同 url。您将看到 angular 忽略了这一点，并且没有重新激活该路由。这是因为这个属性的默认值为**忽略**，如果你把它的值作为**重载**传递，那么这个行为将会改变，你的路线将被重新激活。**

****8。滚动位置恢复****

**假设用户在某个页面上时处于某个滚动位置，然后他导航到其他页面。现在，他按下浏览器中的后退按钮，您希望滚动位置与他离开的位置相同。一种方法是自己写代码。但是 angular 给了我们这个属性来配置它。它接受以下值。**

*   **' disabled'-(默认值)不执行任何操作。导航时保持滚动位置。**
*   **' top'-在所有导航中将滚动位置设置为 x = 0，y = 0。**
*   **' enabled'-在向后导航时恢复上一个滚动位置，否则将位置设置为锚点(如果提供了锚点)，或者将滚动位置设置为[0，0](向前导航)。该选项将成为未来的默认选项。**

**您还可以自定义滚动恢复行为，这可以在官方文档中找到。**

****9。scrollOffset****

**配置滚动到元素时路由器将使用的滚动偏移量。**

**当给定一个具有 x 和 y 位置值的元组时，路由器每次滚动时都使用该偏移量。当给定一个函数时，路由器每次恢复滚动位置时都会调用该函数。**

****10。paramsInheritanceStrategy****

**定义路由器如何将参数、数据和解析的数据从父路由合并到子路由。默认情况下(' emptyOnly ')，仅继承无路径或无元件布线的父参数。设置为“始终”以启用父参数的无条件继承。**

****11。malformedUriErrorHandler****

**比方说，如果用户在 url 中输入了无效的字符序列，导致 encodeURI 失败，那么您希望实现特定的行为。Angular 有一个默认行为，即路由到根 URL 并释放所有参数。您可以将函数传递给此属性，以实现覆盖默认行为的自定义行为。该函数将接收三个参数，即**

*   **URIError -解析错误的 URL 时引发的错误。**
*   **UrlSerializer -使用路由器配置的 UrlSerializer。**
*   **url -导致 URIError 的格式错误的 url**

**在你的功能的基础上，这三个参数你可以执行各种活动，以达到预期的行为。**

****12。urlUpdateStrategy****

**定义路由器何时更新浏览器 URL。默认情况下(“延迟”)，导航成功后更新。如果希望在导航开始时更新 URL，请设置为“急切”。尽早更新 URL 允许您通过显示包含失败 URL 的错误消息来处理导航失败。**

**13。相对分辨率**

**启用一个错误修复程序，该程序更正了路径为空的组件中的相对链接解析。示例:**

**假设您有这样的路由配置:-**

**现在在你的 **HomeComponent** 模板中，你有了下面的锚标签**

**这将不起作用，因为此字段的默认值是支持向后兼容性的传统值。在 legacy 中，要使它工作，你必须使用如下所示的锚标记。**

**启用修复并像**一样使用它。/** 而不是**../** 您可以将此选项的值设为“已更正”来启用修复。**

> **这些选项允许我们处理任何 web 应用程序中可能遇到的大多数常见场景。如果我们不了解它们，我们可能最终会编写一个自定义的实现，这就像重新发明轮子一样。因此，了解它们是非常重要的，并为你在 Angular 方面的专业知识再添一根羽毛。**

**希望这对您有所帮助，并希望您在使用这些选项的应用中取得更大的成就。**