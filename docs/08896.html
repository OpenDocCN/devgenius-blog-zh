<html>
<head>
<title>Relational Database Management System (RDBMS)Architecture — (2)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关系数据库管理系统(RDBMS)体系结构(二)</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/relational-database-management-system-rdbms-architecture-2-6a88d5c014ce?source=collection_archive---------6-----------------------#2022-07-17">https://blog.devgenius.io/relational-database-management-system-rdbms-architecture-2-6a88d5c014ce?source=collection_archive---------6-----------------------#2022-07-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/849a2f041fbf84490247fe880213c5e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AtG0m4Xzml77MfCt"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">Pawel Czerwinski 在<a class="ae jd" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><div class=""/><div class=""><h2 id="6a12" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">关系数据库管理系统是一个用于存储、操作和管理表中数据的大型软件。</h2></div></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><p id="e0c6" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">这是关于这个主题的第二个系列。本文将继续介绍其他细节。</p><div class="ip iq gp gr ir ly"><a href="https://jinlow.medium.com/relational-database-management-system-rdbms-architecture-1-1ba5e64b190a" rel="noopener follow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd jh gy z fp md fr fs me fu fw jf bi translated">关系数据库管理系统(RDBMS)体系结构——(1)</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">关系数据库管理系统是一个大规模的软件，用于存储、操作和管理数据库中的数据</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">jinlow.medium.com</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm ix ly"/></div></div></a></div></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><figure class="mo mp mq mr gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mn"><img src="../Images/9a945d73acbd6e63af954b22f6b88ea6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qU9ScqP4cJraF_jO.PNG"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated"><a class="ae jd" href="https://payasr.github.io/redbase-spatial/post/architect-dbms/" rel="noopener ugc nofollow" target="_blank">https://pay ASR . github . io/red base-spatial/post/architect-DBMS/</a></figcaption></figure><h1 id="0f89" class="ms mt jg bd mu mv mw mx my mz na nb nc km nd kn ne kp nf kq ng ks nh kt ni nj bi translated"><strong class="ak">事务存储管理器</strong></h1><p id="2945" class="pw-post-body-paragraph lc ld jg le b lf nk kh lh li nl kk lk ll nm ln lo lp nn lr ls lt no lv lw lx ij bi translated"><strong class="le jh">访问方法</strong></p><p id="87da" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">访问磁盘数据结构的最底层操作符，通常是<a class="ae jd" href="https://pages.cs.wisc.edu/~dbbook/openAccess/Minibase/spaceMgr/heap_file.html" rel="noopener ugc nofollow" target="_blank"> <strong class="le jh">堆文件</strong> </a>和<a class="ae jd" href="https://en.wikipedia.org/wiki/Database_index" rel="noopener ugc nofollow" target="_blank"> <strong class="le jh">索引</strong> </a>。访问数据有两个注意事项:</p><ol class=""><li id="1292" class="np nq jg le b lf lg li lj ll nr lp ns lt nt lx nu nv nw nx bi translated">使用索引</li><li id="83f4" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated">批量固定/取消固定或复制/删除符合条件的元组以提高性能</li></ol><p id="d875" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated"><strong class="le jh">指标</strong></p><ol class=""><li id="56f8" class="np nq jg le b lf lg li lj ll nr lp ns lt nt lx nu nv nw nx bi translated"><strong class="le jh"> B 树索引— </strong>创建一个多级树结构，将数据库分成固定大小的块或页面</li><li id="6fc4" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated"><strong class="le jh"> R 树索引</strong> —用于空间访问方法的树数据结构</li><li id="dde5" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated"><strong class="le jh"> T 树索引</strong> —一种平衡的索引树数据结构</li><li id="94ac" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated"><strong class="le jh">哈希索引</strong> —该索引包含唯一值</li><li id="2b5e" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated"><strong class="le jh"> Patricia Trie 索引</strong> —它表示一个空间优化的 Trie(前缀树)，其中每个节点都是唯一的子节点，并与其父节点合并</li><li id="28d1" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated"><strong class="le jh"> RD-Tree 索引</strong> —动态空间访问方法</li><li id="0b78" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated"><strong class="le jh">多维聚集(MDC)索引</strong> —以灵活、连续和自动的方式沿多维聚集表中的数据</li><li id="ba1d" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated"><strong class="le jh">位图索引</strong> —使用位图或位数组</li><li id="9ca7" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated"><strong class="le jh">学习索引</strong> —使用从深度神经网络到简单回归的机器学习技术，以便对排序数组的累积分布函数建模</li></ol><ul class=""><li id="3c2d" class="np nq jg le b lf lg li lj ll nr lp ns lt nt lx od nv nw nx bi translated">访问方法的基本 API 是迭代器 API。参数(查询条件、搜索参数、SARG)用于查询，get_next()用于返回满足条件的行，或者在不满足条件时返回 NULL。</li><li id="93dd" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx od nv nw nx bi translated">行 ID (RID)直接用于表示行在磁盘上的位置，因为它直接且易于读取。然而，当行大小变大时，位图索引(B+树)被分割或者元组必须被移动，这是不合适的。</li><li id="689a" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx od nv nw nx bi translated">另一种方法是使用主键作为辅助索引中的行 ID。它通过索引找到主键值，然后返回到表中查询原始行。但是，牺牲了查询性能，却避免了行移动带来的问题。</li></ul></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><p id="72c4" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated"><strong class="le jh">数据仓库</strong></p><p id="90af" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">数据仓库场景是联机分析处理场景，但不是联机事务处理场景，因为它用于数据分析。数据通常由 ETL(提取、转换、加载)和几乎所有的只读查询处理。有一些扩展可以在 OLAP 场景中获得更好的性能。</p><ol class=""><li id="5a29" class="np nq jg le b lf lg li lj ll nr lp ns lt nt lx nu nv nw nx bi translated"><strong class="le jh">批量加载</strong> —可以跳过 SQL 解析等步骤，直接操作底层存储引擎以获得更好的性能</li><li id="d198" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated"><strong class="le jh">位图索引</strong> —有些列只有固定值。例如，性别和年龄。通过使用位图索引，它可以获得更好的性能。</li><li id="2e70" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated"><strong class="le jh">物化视图</strong> —创建一个视图。一旦更新了原始表，视图也会相应地更新。</li><li id="301a" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated"><strong class="le jh"> OLAP &amp;特定查询支持</strong> —类似于预计算的数据立方体可以支持固定查询场景，例如 SQL 语句的定期执行。</li></ol><p id="7d2a" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated"><strong class="le jh">数据库扩展性</strong></p><ol class=""><li id="370d" class="np nq jg le b lf lg li lj ll nr lp ns lt nt lx nu nv nw nx bi translated"><a class="ae jd" href="https://www.ibm.com/docs/en/i/7.3?topic=types-user-defined" rel="noopener ugc nofollow" target="_blank"><strong class="le jh"/></a><strong class="le jh">/</strong><a class="ae jd" href="https://en.wikipedia.org/wiki/User-defined_function" rel="noopener ugc nofollow" target="_blank"><strong class="le jh">UDF</strong></a></li><li id="ebc0" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated"><a class="ae jd" href="https://en.wikipedia.org/wiki/JSON" rel="noopener ugc nofollow" target="_blank"><strong class="le jh">JSON</strong></a>/<a class="ae jd" href="https://en.wikipedia.org/wiki/XML" rel="noopener ugc nofollow" target="_blank">/XML</a></li><li id="197c" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated"><a class="ae jd" href="https://en.wikipedia.org/wiki/Full-text_search" rel="noopener ugc nofollow" target="_blank"> <strong class="le jh">全文搜索</strong> </a></li></ol></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><p id="7dd1" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated"><strong class="le jh">仓储管理</strong></p><p id="89ec" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">DBMS 访问存储有两种方式</p><ol class=""><li id="9bc6" class="np nq jg le b lf lg li lj ll nr lp ns lt nt lx nu nv nw nx bi translated">直接与块设备交互</li><li id="5fc5" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated">与操作系统文件系统交互，这会影响数据库控制存储空间和时间的能力</li></ol><p id="34ad" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">直接控制放置比通过 OS 文件系统更好，因为数据库系统可以更好地分配自己的工作负载。</p><p id="ea28" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated"><strong class="le jh">空间控制</strong></p><p id="b81d" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">顺序存取比随机存取快得多。数据库系统要控制数据如何排列，数据库系统比底层操作系统懂得多，做得比操作系统好。</p><p id="5fdf" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated"><strong class="le jh">时间控制—缓冲</strong></p><p id="fc5f" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">为了控制数据的位置，由于两个方面，数据库系统必须控制数据是否被正确地写入永久存储设备</p><ol class=""><li id="ff75" class="np nq jg le b lf lg li lj ll nr lp ns lt nt lx nu nv nw nx bi translated">为了确保正确</li><li id="f89b" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated">为了减少操作系统由于缓存机制而产生的开销</li></ol><p id="2a02" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated"><strong class="le jh">缓冲管理</strong></p><p id="31b3" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">数据库通常使用内存空间来一一映射硬盘上的内容。这种映射不涉及数据内容的转换，以避免额外的 CPU 开销。此外，数据库还管理映射关系、脏标志和元数据等信息。</p><ol class=""><li id="dbf0" class="np nq jg le b lf lg li lj ll nr lp ns lt nt lx nu nv nw nx bi translated">可以根据脏标志将数据内容写回磁盘。</li><li id="ff40" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated">固定/取消固定决定了数据内容是否可以根据特定的替换策略换出到磁盘</li></ol><p id="d219" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated"><a class="ae jd" href="https://en.wikipedia.org/wiki/Cache_replacement_policies" rel="noopener ugc nofollow" target="_blank"> <strong class="le jh">算法</strong> </a> <strong class="le jh"> : </strong></p><ol class=""><li id="36f8" class="np nq jg le b lf lg li lj ll nr lp ns lt nt lx nu nv nw nx bi translated">最近最少使用(LRU)</li><li id="2971" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated">时钟</li><li id="a5a6" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated">LRU-2</li><li id="0267" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated">先进先出。比较 LIFO</li><li id="eea3" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated">后进先出/后进先出法</li><li id="9595" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated">最近使用的(MRU)</li><li id="e8b1" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated">最不常用(LFU)</li></ol></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><h1 id="0457" class="ms mt jg bd mu mv oe mx my mz of nb nc km og kn ne kp oh kq ng ks oi kt ni nj bi translated"><strong class="ak">交易</strong></h1><p id="d2ea" class="pw-post-body-paragraph lc ld jg le b lf nk kh lh li nl kk lk ll nm ln lo lp nn lr ls lt no lv lw lx ij bi translated">责任:</p><ol class=""><li id="5c28" class="np nq jg le b lf lg li lj ll nr lp ns lt nt lx nu nv nw nx bi translated"><strong class="le jh">协调各种资源的事务</strong>。例如，两阶段提交协议、XA 协议等。</li><li id="ef9e" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated"><strong class="le jh">从故障中恢复</strong> —在系统或应用程序出现故障时，保持资源处于一致状态</li><li id="c6d4" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated"><strong class="le jh">控制事务上下文</strong> —监控事务</li><li id="5722" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated"><strong class="le jh">划分</strong> —开始、提交和回滚方法</li></ol><p id="0473" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated"><strong class="le jh">并发控制和恢复</strong></p><p id="8ada" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">数据库系统较大，事务存储管理没有明确定义的功能，通常由以下 4 个相互纠缠的模块组成。</p><ol class=""><li id="1351" class="np nq jg le b lf lg li lj ll nr lp ns lt nt lx nu nv nw nx bi translated">并发控制中的锁管理器</li><li id="c2dc" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated">错误恢复中的日志管理器</li><li id="9825" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated">用于分离 I/O 的缓冲池</li><li id="1fd7" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated">管理底层磁盘上数据的访问方法</li></ol><p id="d7d0" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated"><strong class="le jh">交易特征(酸性)</strong></p><ol class=""><li id="c0a6" class="np nq jg le b lf lg li lj ll nr lp ns lt nt lx nu nv nw nx bi translated"><strong class="le jh">原子性:</strong>要么是事务成功时的整个执行，要么是事务失败时的整个回滚</li><li id="8db8" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated"><a class="ae jd" href="https://aws.plainenglish.io/distributed-system-cap-theorem-3ca7d933f5e7" rel="noopener ugc nofollow" target="_blank"> <strong class="le jh">一致性</strong> </a> <strong class="le jh"> : </strong>交易必须保证整体数据库数据的完整性和一致性。在执行事务之前和之后，数据库必须处于一致状态。比如做多表操作时，多个表要么是事务后的新值，要么是事务前的旧值<br/> <strong class="le jh">强一致性:</strong>更新完成后，任何后续的访问(通过 A、B 或 C)都会返回更新后的值。<br/> <strong class="le jh">弱一致性</strong>:系统不保证后续访问会返回更新后的值。在返回值之前，需要满足许多条件。<br/> <strong class="le jh">最终一致性:</strong>弱一致性的一种特殊形式；数据库保证如果没有对数据项进行新的更新，最终所有的访问将返回最后更新的值。<br/> <strong class="le jh">因果一致性</strong>:如果进程 A 通知进程 B 数据项已经更新，进程 B 后续的访问将返回更新后的值，写操作保证取代之前的写操作。对于与进程 A 没有因果关系的进程 C 的访问，将应用最终的一致性规则。<br/> <strong class="le jh"> Read-your-writes 一致性</strong>:进程 A 更新数据项后，总是访问更新后的值，永远看不到更老的值。<br/> <strong class="le jh">会话一致性</strong>:进程 A 在一个会话的上下文中访问数据库。只要会话存在，系统就会保证读写操作的一致性。如果会话由于某些故障情况而终止，则需要创建新的会话，并保证没有重叠的会话。<br/> <strong class="le jh">单调读取一致性</strong>:如果一个进程已经看到了一个对象的特定值，那么任何后续的访问都不会返回任何之前的值。<br/> <strong class="le jh">单调写入一致性</strong>:系统保证以相同的进程对写入进行序列化。</li><li id="f39f" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated"><strong class="le jh">隔离:</strong>两个事务的执行是独立隔离的。当多个事务操作一个对象时，第二个事务只能在第一个事务完成后执行。因此，并发性将被最小化。</li><li id="5a4a" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated"><strong class="le jh">持久性:</strong>持久性是指交易一旦提交成功，修改后的数据将是不可逆的、持久的，不会因异常或停机造成数据错误或数据丢失。</li></ol><p id="3b6e" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated"><strong class="le jh">可串行化</strong></p><figure class="mo mp mq mr gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oj"><img src="../Images/a9df2f4f5bebd5721a7e9db67509e53c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*PcycZlonTtTTbwX4.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated"><a class="ae jd" href="https://docs.pingcap.com/tidb/stable/dev-guide-transaction-restraints" rel="noopener ugc nofollow" target="_blank">https://docs . pingcap . com/tidb/stable/dev-guide-transaction-constraints</a></figcaption></figure><p id="5ec7" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">为了实现隔离和一致性，必须考虑并发控制。它主要基于锁和时间戳的两种实现。数据库中有 3 种主流的并发控制技术:</p><p id="1547" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated"><strong class="le jh">锁定协议&amp;时间戳</strong></p><ol class=""><li id="f891" class="np nq jg le b lf lg li lj ll nr lp ns lt nt lx nu nv nw nx bi translated"><a class="ae jd" href="https://en.wikipedia.org/wiki/Two-phase_locking" rel="noopener ugc nofollow" target="_blank"> <strong class="le jh">严格两阶段锁</strong></a>【2PL】—事务在使用锁之前必须获得锁，并且必须持有锁，直到事务完成或中止。</li><li id="7689" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated"><a class="ae jd" href="https://en.wikipedia.org/wiki/Multiversion_concurrency_control" rel="noopener ugc nofollow" target="_blank"> <strong class="le jh">多版本并发控制</strong></a><strong class="le jh"/>【MVCC】—每个事务都有自己的快照，这样只读事务就可以根据时间戳直接被快照读取，而不需要获取锁。只写事务不会受到影响。每个事务包含两个时间戳，即开始时间和提交时间。</li><li id="8a94" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated"><a class="ae jd" href="https://en.wikipedia.org/wiki/Optimistic_concurrency_control" rel="noopener ugc nofollow" target="_blank"> <strong class="le jh">乐观并发控制</strong></a>【OCC】—多个事务可以频繁完成而互不干扰。事务使用数据资源，但不获取这些资源的锁。在提交之前，每个事务都会验证没有其他事务修改过数据。如果检查发现有冲突的修改，事务将回滚并可以重新启动。</li></ol><p id="d469" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated"><strong class="le jh">锁定&amp;闭锁</strong></p><p id="d4f4" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">数据库将维护一个锁表来记录事务/锁/对象之间的关系，因此当事务完成或中止时，可以释放与该事务相关联的所有锁。死锁也是特征之一。当用户访问数据结构时，数据库系统也使用锁来保护数据和数据结构，这称为锁存。但是，使用锁存可以避免死锁。锁存由操作系统或硬件指令提供。</p><p id="aaa9" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated"><strong class="le jh">了解隔离等级的程度</strong></p><figure class="mo mp mq mr gt is gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/c894a71fe690371b383779e8e2812d71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/0*RNX_XePMkQV-XRLl.png"/></div></figure><p id="f881" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">由于使用了 MVCC 和 OCC，一些数据库系统还提供了其他隔离级别。</p><ol class=""><li id="0447" class="np nq jg le b lf lg li lj ll nr lp ns lt nt lx nu nv nw nx bi translated">光标稳定性</li><li id="0549" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated">快照隔离</li><li id="b5af" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated">读取一致性</li></ol></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><p id="6a71" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated"><strong class="le jh">日志管理器</strong></p><p id="e151" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">一般数据库系统使用<a class="ae jd" href="https://en.wikipedia.org/wiki/Write-ahead_logging" rel="noopener ugc nofollow" target="_blank"><strong class="le jh">【WAL】</strong></a><strong class="le jh"/>来实现事务持久化。有 3 条规则:</p><ol class=""><li id="952e" class="np nq jg le b lf lg li lj ll nr lp ns lt nt lx nu nv nw nx bi translated">对数据源的每次修改都应该生成一个日志，该日志必须放在磁盘上</li><li id="7a1b" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated">原木必须按顺序摆放</li><li id="5706" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated">只有在放置日志后，才能对成功的事务做出响应</li></ol><p id="e04b" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">尽管这 3 条规则非常简单，但实际实现往往比这些规则复杂得多。数据库系统必须提供一定的回滚/中止性能，同时在事务提交的快速路径上保持高性能。此外，数据库系统必须考虑查询优化场景。日志系统将变得更加复杂。</p><p id="9a49" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">在数据库系统中使用了 3 个原则:<em class="ol">直接、窃取/非强制。</em></p><ol class=""><li id="3608" class="np nq jg le b lf lg li lj ll nr lp ns lt nt lx nu nv nw nx bi translated">直接更新数据</li><li id="0846" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated">使用撤消日志来撤消对未提交/中止事务的更改</li><li id="38b0" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated">提交事务时使用重做日志</li></ol><p id="29dc" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated"><strong class="le jh">提升业绩的战略</strong></p><ol class=""><li id="9913" class="np nq jg le b lf lg li lj ll nr lp ns lt nt lx nu nv nw nx bi translated">减小日志的大小可以提高日志系统的性能</li><li id="bddb" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated">只有逻辑操作可以被记录，而物理操作数据可以被丢弃，以便在事务提交后进一步减小日志大小</li><li id="4bec" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx nu nv nw nx bi translated">物理操作记录在撤消日志中，逻辑操作记录在重做日志中</li></ol><ul class=""><li id="d5e6" class="np nq jg le b lf lg li lj ll nr lp ns lt nt lx od nv nw nx bi translated">系统异常关机后，系统会使用恢复日志序列号(恢复 LSN)记录日志的顺序，并使用检查点定期记录恢复 LSN，以获取最新的恢复进程。</li><li id="6b22" class="np nq jg le b lf ny li nz ll oa lp ob lt oc lx od nv nw nx bi translated">当事务回滚时，保留一部分磁盘空间</li></ul></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><p id="6042" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated"><strong class="le jh">事务存储管理的相互依赖性</strong></p><p id="7516" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">事务存储管理是 DBMS 的最低层。</p><p id="ca5e" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated"><a class="ae jd" href="https://en.wikipedia.org/wiki/Write-ahead_logging" rel="noopener ugc nofollow" target="_blank"><strong class="le jh">【WAL】</strong></a><strong class="le jh"/>协议在日志系统中依赖于并发控制的实现方法。如果使用了非严格的 2 阶段锁定，并且已经释放了锁，那么在回滚期间执行撤销日志时，可能无法重新获得锁。当考虑子系统(访问方法)时，它变得更加复杂。</p><p id="6a3b" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">并发控制和错误恢复机制必须与其独特的数据结构紧密结合。这就是为什么数据库系统一般会实现 B+树和堆文件。每个数据结构都有自己的并发控制或错误恢复机制优化技术。将不同的并发控制方法混合到同一个访问方法中是非常困难的，因为其他并发控制方法如 OCC 和 MVCC 可能没有考虑访问方法的特征。</p></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><p id="1131" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated"><strong class="le jh">我的相关文章</strong></p><div class="ip iq gp gr ir ly"><a href="https://jinlow.medium.com/sql-basic-eb50b69e7164" rel="noopener follow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd jh gy z fp md fr fs me fu fw jf bi translated">SQL 的概念及其清单</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">SQL 通用语法</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">jinlow.medium.com</p></div></div><div class="mh l"><div class="om l mj mk ml mh mm ix ly"/></div></div></a></div><div class="ip iq gp gr ir ly"><a href="https://experiencestack.co/11-sql-query-optimization-techniques-commonly-used-in-projects-ed45c31c45cd" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd jh gy z fp md fr fs me fu fw jf bi translated">项目中常用的 11 种 SQL 查询优化技术</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">随着数据量的持续增长，it 将需要精通 SQL 的专业人员，而不仅仅是入门级的…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">经验堆栈。总裁</p></div></div><div class="mh l"><div class="on l mj mk ml mh mm ix ly"/></div></div></a></div><div class="ip iq gp gr ir ly"><a href="https://medium.com/geekculture/the-core-knowledge-of-sql-database-development-1-1d48cd4b732e" rel="noopener follow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd jh gy z fp md fr fs me fu fw jf bi translated">SQL 数据库开发的核心知识(1)</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">掌握 SQL 数据库是开发人员的一项基本功。SQL 是一种简单而强大的语言，广泛应用于许多领域</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">medium.com</p></div></div><div class="mh l"><div class="oo l mj mk ml mh mm ix ly"/></div></div></a></div><div class="ip iq gp gr ir ly"><a href="https://experiencestack.co/the-core-knowledge-of-sql-database-development-2-29304458eaf3" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd jh gy z fp md fr fs me fu fw jf bi translated">SQL 数据库开发的核心知识(2)</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">随着互联网技术的不断发展，数据库变得越来越复杂。几乎所有的 IT 公司…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">经验堆栈。总裁</p></div></div><div class="mh l"><div class="op l mj mk ml mh mm ix ly"/></div></div></a></div></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><p id="478c" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated"><strong class="le jh">参考文献</strong></p><div class="ip iq gp gr ir ly"><a href="https://15415.courses.cs.cmu.edu/fall2016/syllabus.html" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd jh gy z fp md fr fs me fu fw jf bi translated">教学大纲::CMU-CS 15-415/615 数据库应用(2016 年秋季)</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">15-415/615 数据库应用程序(2016 年秋季)</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">15415.courses.cs.cmu.edu</p></div></div></div></a></div><div class="ip iq gp gr ir ly"><a href="https://lwn.net/Articles/368493/" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd jh gy z fp md fr fs me fu fw jf bi translated">MVCC 实施</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">1.任何行的最新版本都存储在主数据块中，还有一些与事务相关的元数据。2…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">lwn.net</p></div></div><div class="mh l"><div class="oq l mj mk ml mh mm ix ly"/></div></div></a></div><div class="ip iq gp gr ir ly"><a href="https://www.geeksforgeeks.org/rdbms-architecture/" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd jh gy z fp md fr fs me fu fw jf bi translated">RDBMS 架构-极客论坛</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">RDBMS 代表关系数据库管理系统，它实现 SQL。在现实世界中，人们使用…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">www.geeksforgeeks.org</p></div></div><div class="mh l"><div class="or l mj mk ml mh mm ix ly"/></div></div></a></div><div class="ip iq gp gr ir ly"><a href="https://www.oracle.com/database/what-is-a-relational-database/" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd jh gy z fp md fr fs me fu fw jf bi translated">什么是关系数据库？</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">关系数据库是一种数据库，它存储并提供对与一个数据库相关的数据点的访问</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">www.oracle.com</p></div></div><div class="mh l"><div class="os l mj mk ml mh mm ix ly"/></div></div></a></div><p id="95bc" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">https://jimgray.azurewebsites.net/JimGrayPublications.htm<a class="ae jd" href="https://jimgray.azurewebsites.net/JimGrayPublications.htm" rel="noopener ugc nofollow" target="_blank"/></p><div class="ip iq gp gr ir ly"><a href="https://www.studytonight.com/advanced-data-structures/b-plus-trees-data-structure" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd jh gy z fp md fr fs me fu fw jf bi translated">B+树数据结构</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">B+树是 B 树的扩展，它使得搜索、插入和删除操作更加有效。我们知道…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">www.studytonight.com</p></div></div></div></a></div><div class="ip iq gp gr ir ly"><a href="https://blog.acolyer.org/2015/01/20/architecture-of-a-database-system/" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd jh gy z fp md fr fs me fu fw jf bi translated">数据库系统的体系结构</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">数据库系统的架构- Hellerstein，Stonebraker &amp; Hamilton，2007。这是一个较长的阅读(因此…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">blog.acolyer.org</p></div></div><div class="mh l"><div class="ot l mj mk ml mh mm ix ly"/></div></div></a></div><div class="ip iq gp gr ir ly"><a href="https://vladmihalcea.com/relational-database-sql-prepared-statements/" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd jh gy z fp md fr fs me fu fw jf bi translated">关系数据库如何执行 SQL 语句和准备好的语句</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">在本文中，我们将了解关系数据库如何执行 SQL 语句和预处理语句。的…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">vladmihalcea.com</p></div></div><div class="mh l"><div class="ou l mj mk ml mh mm ix ly"/></div></div></a></div><p id="3a18" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated"><a class="ae jd" href="https://drive.google.com/viewerng/viewer?url=https://courses.cs.washington.edu/courses/cse444/20sp/lectures/lecture07-execution.pdf" rel="noopener ugc nofollow" target="_blank">https://courses . cs . Washington . edu/courses/CSE 444/20sp/lectures/lectures 07-execution . pdf</a></p></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><p id="b6c7" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">如果你发现我的任何文章有帮助或有用，那么请考虑给我一杯咖啡，帮助支持我的工作或给我赞助😊，通过使用和</p><p id="9fa4" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated"><a class="ae jd" href="https://www.patreon.com/jinlowmedium" rel="noopener ugc nofollow" target="_blank"> <strong class="le jh"> Patreon </strong> </a></p><p id="a469" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated"><a class="ae jd" href="https://ko-fi.com/jinlowmedium" rel="noopener ugc nofollow" target="_blank"><strong class="le jh">Ko-fi.com</strong></a></p><p id="7ee3" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated"><a class="ae jd" href="https://www.buymeacoffee.com/jinlowmedium" rel="noopener ugc nofollow" target="_blank"><strong class="le jh"/></a></p><p id="021b" class="pw-post-body-paragraph lc ld jg le b lf lg kh lh li lj kk lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">最后但同样重要的是，如果你还不是灵媒会员，并打算成为灵媒会员，我恳请你使用以下链接。我将收取你的一部分会员费，不增加你的额外费用。</p><div class="ip iq gp gr ir ly"><a href="https://jinlow.medium.com/membership" rel="noopener follow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd jh gy z fp md fr fs me fu fw jf bi translated">用我的引荐链接-金加入 Medium</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">阅读金(以及其他成千上万的作家)的每一篇小说。你的会费直接支持金和…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">jinlow.medium.com</p></div></div><div class="mh l"><div class="ov l mj mk ml mh mm ix ly"/></div></div></a></div></div></div>    
</body>
</html>