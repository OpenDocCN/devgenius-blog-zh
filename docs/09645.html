<html>
<head>
<title>*clic* 📸 Taking pictures (Unity/C#)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">*clic*📸拍照(Unity/C#)</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/clic-taking-pictures-unity-c-9c743ed83cf9?source=collection_archive---------15-----------------------#2022-09-02">https://blog.devgenius.io/clic-taking-pictures-unity-c-9c743ed83cf9?source=collection_archive---------15-----------------------#2022-09-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a8e0" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">让我们看看如何做游戏中的截图，以永生你的野生冒险！</h2></div><p id="7c55" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在过去的几年里，有相当多的大型电子游戏为我们提供了疯狂的好故事，不可思议的图形和一些奇怪但有趣的功能。在这些意想不到的增加中，照片模式似乎是一个非常受欢迎的模式。</p><p id="0830" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，虽然<em class="lb">漫威的《蜘蛛侠》</em>和<em class="lb">魔多的阴影</em>是在完全不同的背景下拍摄的，但这两个游戏都提供了精致有趣的图片模式，可以定格动作，让你可以在动作场景中间拍照。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lc"><img src="../Images/65eb47e29bf43ee0f2cbfb2409ba0002.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NEy_l173l7PLmFYury3--w.png"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">照片拍摄于漫威的蜘蛛侠 PS4 游戏，使用照片模式(作者:ITANI(@ ITANI)——2018 年 9 月 5 日)</figcaption></figure><p id="c2e1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您也可以在自己的 Unity 游戏中做到这一点，该怎么办？实施起来困难吗？剧透提示:不完全是！:)</p><p id="1d89" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">今天，我们将看到:</p><ul class=""><li id="219a" class="ls lt iq kh b ki kj kl km ko lu ks lv kw lw la lx ly lz ma bi translated">🛠如何设置照片模式</li><li id="b9cf" class="ls lt iq kh b ki mb kl mc ko md ks me kw mf la lx ly lz ma bi translated">🔍如何使用基本的用户界面进入和退出该模式</li><li id="8195" class="ls lt iq kh b ki mb kl mc ko md ks me kw mf la lx ly lz ma bi translated">📷如何拍摄截图并保存到磁盘</li></ul><p id="368f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你准备好了吗？那我们走吧！</p><h1 id="79c2" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">🛠正在设置我们的照片模式</h1><p id="a61f" class="pw-post-body-paragraph kf kg iq kh b ki my jr kk kl mz ju kn ko na kq kr ks nb ku kv kw nc ky kz la ij bi translated">好吧，首先，在我们深入研究编码之前，让我们快速讨论一下捕捉和保存游戏截图的过程。</p><p id="8846" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">需要注意的一点是，当摄像机在您的屏幕上显示图像时，实际上只是因为您告诉它将三维场景渲染成 2D 图像，然后将该图像粘贴到您当前的整个显示器上。但是你完全可以要求它进行渲染，然后以其他方式使用这个 2D 图像的内容…</p><p id="f793" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">…例如，在我们的案例中，您可以要求它只需将图像保存在磁盘上的某个位置！:)</p><p id="c110" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设我的 Unity 场景中有一个主摄像机，用来渲染一些基本的演示场景，还有一个简单的 FPS 控制器(这是从 Unity 的基本 FPS 启动包中直接获取的，这里免费提供<a class="ae nd" href="https://assetstore.unity.com/packages/essentials/starter-assets-first-person-character-controller-196525" rel="noopener ugc nofollow" target="_blank"/>):</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi ne"><img src="../Images/e05c466d5f3831f54f0e4da862f82b18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NG5Ir0f6ZLL_0SjlFd4Rtw.jpeg"/></div></div></figure><p id="e5a5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">演示控制器允许我用键盘移动，用鼠标旋转相机，所以我们假设整个“游戏逻辑”部分已经处理好了。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi nf"><img src="../Images/00f91c7b29440cfa3638025840a5317e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*fuIDUEg66S_iJ9ynY2kWfg.gif"/></div></div></figure><p id="df7d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在这里想要的是能够按下一些键，例如<code class="fe ng nh ni nj b">&lt;P&gt;</code>(对于“图片”)进入照片模式。在这种模式下，相机将被锁定在其当前位置，我们将有两个按钮来拍摄截图(并离开照片模式)或直接离开照片模式。</p><p id="456f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们制作一个名为<code class="fe ng nh ni nj b">PhotoMode</code>的 C#脚本，并将其添加到我们的玩家预置中:它是演示场景中名为“PlayerCapsule”的游戏对象。如果您在 IDE 中打开它，您会看到，目前，它包含 Unity 为任何新脚本自动生成的默认<code class="fe ng nh ni nj b">MonoBehaviour</code>类:</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="11af" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，让我们修改我们的<code class="fe ng nh ni nj b">Update()</code>函数，以便它检查我们的<code class="fe ng nh ni nj b">&lt;P&gt;</code>键输入。如果我们真的按下了这个键，那么我们想通过<code class="fe ng nh ni nj b">_EnterPhotoMode()</code>功能进入拍照模式:</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="9e9d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">注意:Unity 的入门包使用新的输入系统。如果你不熟悉的话，可以看一下</em> <a class="ae nd" href="https://docs.unity3d.com/Packages/com.unity.inputsystem@1.4/manual/" rel="noopener ugc nofollow" target="_blank"> <em class="lb">文档</em> </a> <em class="lb">来了解得到按键，或者更进一步定义动作。</em></p><p id="5568" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，要冻结摄像机，我们实际上要做两件事:</p><ul class=""><li id="6bcb" class="ls lt iq kh b ki kj kl km ko lu ks lv kw lw la lx ly lz ma bi translated">第一，我们将完全禁用 FPS 控制器脚本。这将阻止我们移动播放器或摄像机，并模拟这种“冻结”。</li><li id="af9a" class="ls lt iq kh b ki mb kl mc ko md ks me kw mf la lx ly lz ma bi translated">第二，我们将把<code class="fe ng nh ni nj b">Time.timeScale</code>全局变量设置为<code class="fe ng nh ni nj b">0</code>。如果你不知道这个变量到底是做什么的，可以看看<a class="ae nd" href="https://medium.com/codex/dring-taming-time-unity-c-cf5846628533" rel="noopener">我最近写的关于这个话题的文章【T21:)</a></li></ul><p id="0893" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了能够禁用我们的控制器脚本，我们首先需要获得对它的引用。既然它和我们的<code class="fe ng nh ni nj b">PhotoMode</code>脚本在同一个游戏对象上，我们可以用<a class="ae nd" href="https://docs.unity3d.com/ScriptReference/GameObject.GetComponent.html" rel="noopener ugc nofollow" target="_blank"/><code class="fe ng nh ni nj b"><a class="ae nd" href="https://docs.unity3d.com/ScriptReference/GameObject.GetComponent.html" rel="noopener ugc nofollow" target="_blank">GetComponent()</a></code><a class="ae nd" href="https://docs.unity3d.com/ScriptReference/GameObject.GetComponent.html" rel="noopener ugc nofollow" target="_blank">内置的</a>来做这件事。鉴于这个引用在整个游戏过程中不会改变，我们可以在开始时在<code class="fe ng nh ni nj b">Start()</code>钩子中获取一次，然后在代码中重用它。</p><p id="2b76" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另外，因为 starter pack 脚本在一个<code class="fe ng nh ni nj b">StarterAssets</code>名称空间中，我们需要首先用<code class="fe ng nh ni nj b">using</code>关键字导入它:</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="9ff3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你尝试一下，你会发现只要你一按下<code class="fe ng nh ni nj b">&lt;P&gt;</code>键，屏幕就像预期的那样冻结了！除此之外，目前，我们没有办法退出这种模式…</p><h1 id="a1bf" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">🔍添加用户界面并退出照片模式</h1><p id="1889" class="pw-post-body-paragraph kf kg iq kh b ki my jr kk kl mz ju kn ko na kq kr ks nb ku kv kw nc ky kz la ij bi translated">幸运的是，这很容易解决:)</p><p id="05bc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们首先需要在画布中添加两个按钮(在这里，我使用了 starter pack UI 精灵并添加了一些额外的图标):</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi ne"><img src="../Images/b1221e02890ac40547c7426c5820dda7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EVzNSCl4pljwr3QJqV6t2g.jpeg"/></div></div></figure><p id="e14f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们可以在我们的<code class="fe ng nh ni nj b">PhotoMode</code>脚本中为每个按钮准备两个公共函数:</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="a286" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，回到编辑器，我们可以转到每个按钮的检查器，并添加一个带有匹配函数的回调:</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi nm"><img src="../Images/1649ad3fe7c792299249636783d63349.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LBrgci5NK6qN1eZbITZE2A.jpeg"/></div></div></figure><p id="c69c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，在我们的<code class="fe ng nh ni nj b">PhotoMode</code>脚本中，我们将向我们的“PhotoMode”父 UI 面板添加一个公共引用:这将使显示或隐藏整个 UI 变得容易，一次完成。</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="e545" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">注意:重新编译脚本后，不要忘记将引用拖到检查器中！:)</em></p><p id="ae31" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后但同样重要的是:因为 FPS 控制器控制鼠标，默认情况下它隐藏指针。因此，即使我们有一个用户界面可以点击，我们目前没有鼠标悬停它！为了解决这个问题，我们需要在输入/退出函数中添加一行代码:</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="693e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">确保首先禁用 UI 面板——然后，如果您开始游戏，您将看到按下<code class="fe ng nh ni nj b">&lt;P&gt;</code>调出 UI 并冻结游戏，然后单击右下角的十字按钮返回正常模式:</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi nf"><img src="../Images/3e866c2e2392b1a1a17457debcba4b70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*xBJU_RIfb_GA4pYBOdSCsg.gif"/></div></div></figure><h1 id="16dc" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">📷说“茄子”！</h1><p id="1ce8" class="pw-post-body-paragraph kf kg iq kh b ki my jr kk kl mz ju kn ko na kq kr ks nb ku kv kw nc ky kz la ij bi translated">好了，我们终于到了:我们需要处理屏幕截图。</p><p id="663a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">简而言之，这个想法是:</p><ul class=""><li id="a828" class="ls lt iq kh b ki kj kl km ko lu ks lv kw lw la lx ly lz ma bi translated">首先，准备一些临时丢弃的纹理供相机渲染</li><li id="ca59" class="ls lt iq kh b ki mb kl mc ko md ks me kw mf la lx ly lz ma bi translated">然后，在这个纹理上捕捉当前的相机视图</li><li id="19f6" class="ls lt iq kh b ki mb kl mc ko md ks me kw mf la lx ly lz ma bi translated">然后，获取纹理的内容，并将其保存为图像文件</li><li id="6e17" class="ls lt iq kh b ki mb kl mc ko md ks me kw mf la lx ly lz ma bi translated">最后，清理我们的临时变量，以避免混乱的内存</li></ul><p id="edab" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">可以使用<a class="ae nd" href="https://docs.unity3d.com/Manual/class-RenderTexture.html" rel="noopener ugc nofollow" target="_blank"/><code class="fe ng nh ni nj b"><a class="ae nd" href="https://docs.unity3d.com/Manual/class-RenderTexture.html" rel="noopener ugc nofollow" target="_blank">RenderTexture</a></code><a class="ae nd" href="https://docs.unity3d.com/Manual/class-RenderTexture.html" rel="noopener ugc nofollow" target="_blank">变量</a>创建临时纹理。要将我们的摄像机渲染到这个纹理中，我们只需要将我们的渲染纹理指定为摄像机的当前目标，然后调用一个可用于手动渲染的函数:<code class="fe ng nh ni nj b"><a class="ae nd" href="https://docs.unity3d.com/ScriptReference/Camera.Render.html" rel="noopener ugc nofollow" target="_blank">Camera.Render()</a></code>。</p><p id="195c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第三步主要是将数据从一种格式转换为另一种格式——我不会在这里详细介绍，但是可以看看网上讨论这种转换的各种帖子；)</p><p id="2d45" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">总而言之，下面是会截图的功能:</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="3015" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在方法的后半部分，我有几行代码专门用于准备我的截图文件夹(在我的主目录中的某个地方)，这就是为什么我需要在顶部添加新的<code class="fe ng nh ni nj b">System.IO</code>导入。当然，你应该根据自己的喜好调整这条道路。请注意，该脚本会根据给定文件夹中已经存在的文件数量，自动为图像计算一个带有递增数字的 0 填充后缀。</p><p id="44a9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，清理主要是破坏我们的渲染纹理和纹理。还有一个小调试，以确保一切顺利。</p><p id="9180" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我试试这个，塔达！我得到了我当前视图的一个很好的截图:)</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi nn"><img src="../Images/409c42c916fd79834746f0fec2b42886.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*u67buTkjA034uEmAWyUD7Q.gif"/></div></div></figure><h1 id="1214" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">最终剧本</h1><p id="92a0" class="pw-post-body-paragraph kf kg iq kh b ki my jr kk kl mz ju kn ko na kq kr ks nb ku kv kw nc ky kz la ij bi translated">如果你想自己尝试一下，下面是需要添加到“PlayerCapsule”游戏对象中的最后一个<code class="fe ng nh ni nj b">PhotoMode</code> C#脚本:</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="nk nl l"/></div></figure><h1 id="3bc3" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">结论📸</h1><p id="b48b" class="pw-post-body-paragraph kf kg iq kh b ki my jr kk kl mz ju kn ko na kq kr ks nb ku kv kw nc ky kz la ij bi translated">在本文中，我们看到了如何为 Unity 游戏快速创建一个基本的照片模式，允许拍摄游戏中的图片并将其存储在磁盘上。</p><p id="5766" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是我们仍然有很多可以改进的地方，比如添加像相机一样的边框，也许是一些光屏效果，和一个“clic”声音…如果你想让我用这些特性写另一篇文章，请在评论中告诉我！；)</p><p id="6397" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我希望你喜欢这个教程，像往常一样，非常感谢你的阅读:)</p><p id="bb27" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">阅读更多我的内容，以及许多其他伟大作家的自媒体文章，</em> <strong class="kh ir"> <em class="lb">考虑成为会员吧！</em> </strong> <em class="lb">你的会员费直接支持你阅读的作家。</em></p><div class="no np gp gr nq nr"><a href="https://mina-pecheux.medium.com/membership" rel="noopener follow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd ir gy z fp nw fr fs nx fu fw ip bi translated">通过我的推荐链接加入媒体</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">阅读 Mina Pêcheux(以及媒体上成千上万的其他作家)的每一个故事。您的会员费直接支持…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">mina-pecheux.medium.com</p></div></div><div class="oa l"><div class="ob l oc od oe oa of lm nr"/></div></div></a></div></div></div>    
</body>
</html>