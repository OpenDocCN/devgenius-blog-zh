<html>
<head>
<title>DCA Trading Bot Part Two</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">DCA 交易机器人第二部分</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/dca-trading-bot-part-two-9cfacaa8a359?source=collection_archive---------6-----------------------#2022-04-26">https://blog.devgenius.io/dca-trading-bot-part-two-9cfacaa8a359?source=collection_archive---------6-----------------------#2022-04-26</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="e391" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">之前，我们创建了两个 DCA 机器人，一个用 Python，一个用 Julia。你可以在这里找到那个<a class="ae ki" href="https://medium.com/@nultinator/dca-trading-bot-in-julia-and-python-3efe9422ccc3" rel="noopener">的链接。我们的第一批机器人有几个问题需要解决。首先，如果没有足够的平衡，这些机器人就会崩溃。第二，如果有人抬高了订单价格，机器人仍然会以任何价格购买 1 个 YEC，不管有多贵。在这篇文章中，我们将让我们的机器人变得更聪明一点，我们将让它们告诉我们关于低平衡的信息。在 python bot 中，我们只让它在本地控制台上打印。如果你愿意，可以直接跳到第一部分。</a></p><p id="077e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你正在构建 Julia bot，你有一个内置的外壳，我们将利用它。我们将安装<a class="ae ki" href="https://github.com/yecdev/yecshell" rel="noopener ugc nofollow" target="_blank"> yecshell </a>，并用它向<a class="ae ki" href="https://ywallet.app/" rel="noopener ugc nofollow" target="_blank"> Ywallet </a>发送低余额警报。汉最近在 Ywallet 上增加了一个消息标签，我认为这是一个很好的利用方式。当前版本的 yecshell 需要一些更新，但是分支“177”几乎包含了所有需要的更改。除了“177”的变化，它还需要一个服务器的变化。我把它放在不同的服务器上，并在这里合并了这些修改<a class="ae ki" href="https://github.com/nultinator/yecshell" rel="noopener ugc nofollow" target="_blank">https://github.com/nultinator/yecshell</a>。</p><p id="73db" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们可以设置电子邮件或短信提醒，但这对我来说听起来并不神秘。1 YEC 可以被分割成 100，000，000 个单位，我们通常称之为 yoshis。我们可以只发送一个 yoshi，我们的区块链上的屏蔽交易可以用备忘录发送。因此，这条消息的成本(在撰写本文时)大约是 0.26 美元除以 100，000，000 加上交易费(0.00001 YEC)。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/500d2d9f73cd575867ad36158831175a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zzhq4K31nC7zLpfg-OkGsw.png"/></div></div></figure><p id="453e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果您没有安装 rust 和 cargo，您将需要安装它们。你可以在这里找到说明<a class="ae ki" href="https://www.rust-lang.org/tools/install" rel="noopener ugc nofollow" target="_blank">https://www.rust-lang.org/tools/install</a>。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi kv"><img src="../Images/958df2d481dc0bfac3fc1116e6aee916.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/1*PRxWw01UP2efEYlZ6OwyGw.png"/></div></figure><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi kw"><img src="../Images/4aa6a2f2527a802bdc7c86043d5dd0a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*h6b6br_nV4WPO0O9haz5UQ.png"/></div></figure><p id="e593" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">有许多外部依赖，所以需要一些时间来建立货物。接下来，我们将“cd”回我们的主目录，并将我们新构建的二进制文件复制到我们的“bot”目录中。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi kx"><img src="../Images/b74d2f7df9b59e05eca7b3b84e59d565.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*ntGVxQeOJbSoxH0k51Iipg.png"/></div></figure><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi ky"><img src="../Images/91d4c3d69bdc8504002a584da1b2a7a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*amFL6X69200xnBd_QLYIzA.png"/></div></div></figure><p id="20fa" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">接下来(可选)，为了节省空间，我将删除我们克隆到的 yecshell 目录，我不需要它做任何事情。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi kz"><img src="../Images/d21053f5c5624af58c4cbdda4720dd33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*hWDL5QEzbqlxuYW0LSeIrg.png"/></div></figure><p id="8289" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这是非常简单的，所以我们现在就开始设置。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi la"><img src="../Images/6afda44860dc8ec9aeb014a798d53090.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*WItB9aFcfi2CiFEk9pEVNw.png"/></div></figure><p id="9113" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这将在交互模式下启动 yecshell，您可以使用您的种子或您的私钥备份您的钱包。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/47deee3dd106d806b0e826cafb5c1a99.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*pKuKO3zOkrkSnQ-6loMZpg.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">这显示了你的种子</figcaption></figure><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi lg"><img src="../Images/52a1ba1a97abd3e132e36ec495044b43.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*ay5b750z6Ef7AzuftuEIsw.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">这将显示您的私钥</figcaption></figure><p id="7086" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一旦您保存了种子和/或私钥，您的钱包就备份好了，随时可以使用。向您刚刚创建的钱包中发送少量 YEC。您可以使用“地址”命令查看新的接收地址。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi lh"><img src="../Images/9b484b64e47253dce691d2856eb25774.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*-ZGQtl1cr9184xX4YFzYPw.png"/></div></figure><p id="bf59" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">第一部分:Python 机器人</p></div><div class="ab cl li lj hr lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="ig ih ii ij ik"><p id="7211" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们在文本编辑器中打开“bot.py ”,并做一些修改。我们要告诉机器人找到我们的 BTC 平衡。然后，我们会告诉它，只有当我们的余额大于 1 YEC 的价格时才购买。为此，我们将更改“getbalances()”函数，返回我们查询的任何硬币的价格。然后，我们更改购买功能，在购买前检查我们的 BTC 余额。“if”语句告诉它，如果能买得起一整枚硬币，就只买 1 YEC。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi lp"><img src="../Images/a8058186991fe9c8bdebfa209b8ddf9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zJvXC1hSidNeAmp7VRA8Bg.png"/></div></div></figure><p id="c10c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">尝试用低平衡和…</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/d6921c071164c2e929da5146b92a2ca8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*zXh72U81cgkBUivzFGuPOA.png"/></div></figure><p id="89df" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这正是我们想要的。我个人认为这还不够。正如我之前所说的，机器人容易受到价格飙升的影响。让我们添加一些代码来计算平均七天高点和平均七天低点。为此，我们将导入另一个模块“datetime”。然后，我们需要为 Unix 时间添加一些代码，以毫秒为单位。公平的警告，它是丑陋的。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/d97c8d0cb8240fd8adc7004dcd764e38.png" data-original-src="https://miro.medium.com/v2/resize:fit:336/format:webp/1*5OL1TZcjyHNy5JscdzMvAA.png"/></div></figure><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/b8ec2cb0db28231e5d486f24dfddaa0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*W20mZl6kMOxXgicF1IyysA.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">我没有拿丑陋开玩笑。这实际上并没有放在第 11 行，我只是把它放在那里进行测试。</figcaption></figure><p id="526c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在我们必须添加一个函数来返回我们的平均高点和低点。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi lt"><img src="../Images/53ffa88692b639090cf025e2c8396261.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4RVWDyuYq8qr7u6hw3XWxw.png"/></div></div></figure><p id="0ea2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要测试它，在函数定义后添加一个简单的“print(hilo())”。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/014d22542ccf26b337cdd5af96dcb180.png" data-original-src="https://miro.medium.com/v2/resize:fit:358/format:webp/1*pxZ4F9OXMl4BjMqHYqQ4UA.png"/></div></figure><p id="7083" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这个函数应该会返回如下所示的输出…</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/6591029a3d5604448f4d0fa62100e1a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*xACJhSB44MtLCZIGWoj5nQ.png"/></div></figure><p id="1e1e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在我们的输出中，左边是平均高点，右边是平均低点。最后，我们必须让它根据输出做一些事情。如果价格比我们的平均高点高出 10%，机器人就会注意到价格飙升，并拒绝购买。如果价格低于平均低价，并且它能负担得起，机器人将购买 2 YEC。其他情况将遵从我们之前的购买策略。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi lw"><img src="../Images/3f66fb77fdb11a7111adfc0bdf2bd473.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X2mckvArYq95U1nNVl851g.png"/></div></div></figure><p id="9ebb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们来试试吧！</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/15cbd6fcd20b5b4033132bdc8e1612b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*noxlhYQsEQ3xpyHUlN6W3g.png"/></div></figure><p id="a60e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">成功！</p></div><div class="ab cl li lj hr lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="ig ih ii ij ik"><p id="d0c4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">第二部:茱莉亚机器人</strong></p><p id="1e9a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">所以这里我们给“bot.jl”加一些类似的台词。请注意我们是如何结束“for”和“if”语句的，就像使用“end”关键字的函数一样。注意我是如何在“getbalances()”函数中注释 coin 的数据类型的。这不是必需的，我们的编译器通常可以在编译时猜测类型。然而，我在测试它的时候有 50%的时间会出错，所以我添加了“String”类型，这样编译器就不必猜测了。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi ly"><img src="../Images/3e96233d513eb7afbc8c34be9a57bf48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PjpZvA7qQny_zo_3NSdJgg.png"/></div></div></figure><p id="e9f6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">还有…</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/cbd0684e4c5d6722790dfda38bd2aa22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*1nKzRBMcHfxyQ5m4EhoeQA.png"/></div></figure><p id="ce4f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们得到正确的信息。现在添加我们添加到“bot.py”中的购买策略…使用 PyCall，当将两个计算值传递到“Markets.history()”时，我得到一个错误，为了解决这个问题，我需要获取完整的历史记录，并在我的本地机器上过滤日期。为了计算我们的平均值，我们还将添加“统计”包。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/8d2d965949e76a93f4180a05e65335b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:380/format:webp/1*XVTS_gdI7r7r-jwAyjkU3A.png"/></div></figure><p id="0cae" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在我们将添加我们的“hilo()”函数。我原本打算在“hilo()”中使用“Markets.history()”，但是我在编译时遇到了转义错误(这个错误也是由于 PyCall 造成的)，所以我单独定义了它。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/efd219052ae3bfada3bbd9cf55dea232.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*oyoKWJGa215fXvz2tipevw.png"/></div></figure><p id="131a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在本地过滤日期(如你所见)并不是太困难的工作，Julia 非常适合这样的任务，我想这就是数据科学家喜欢它的原因。请注意我们的字典在语法上的不同。接下来，我们将添加新的购买代码。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi mc"><img src="../Images/9932697a1b0d75745c3e6c71d5e4fc19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qy4m7JI5o6vl_IV_PhGJ5A.png"/></div></div></figure><p id="e769" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">好了，有趣的部分来了。首先我们要告诉朱莉娅如何与耶切尔互动。在 Julia 中使用“run()”函数时，反勾号告诉 REPL 这是一个 shell 命令。要在非交互模式下运行 yecshell，我们只需将命令作为参数传递。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi md"><img src="../Images/f514309e8cff57e6ad4f819276e1d82a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RVZlm5MpbgDE57mtlcH1pA.png"/></div></div></figure><p id="a817" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们最终的“buy()”函数如下所示。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi me"><img src="../Images/8c4f24a6caf0e491ee5d16eff245f369.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3ZHFD_aeionAfFIM1DRlXA.png"/></div></div></figure><p id="7345" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">运行低余额的机器人，并…</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi mc"><img src="../Images/18813759cbe5e5a29b551ffbcbe7fc26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aqGuCRwg0oN866B3xDewxw.png"/></div></div></figure><p id="f755" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">打开 Ywallet，点击“信息”标签，然后…</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi mf"><img src="../Images/a91cfd59cee0549a94ed70864681ad94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*slWOlV-zBkHt4yOJ5PNRKw.jpeg"/></div></div></figure><p id="44e3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我有一个消息通知。看看我的信息怎么说。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi mf"><img src="../Images/22d165fd1b7f31f4cf959bc5c17b03e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*etKnANLpiIQPfZzK7CTSzw.jpeg"/></div></div></figure><p id="94b0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这就是了。低余额警报一直传到 Ywallet。</p><p id="253d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你可以在这里找到我们机器人的完整源代码。</p></div></div>    
</body>
</html>