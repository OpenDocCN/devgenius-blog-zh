<html>
<head>
<title>Mixture, Component, Zero-Inflated, and Hurdle models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">混合物、成分、零膨胀和栅栏模型</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/mixture-component-zero-inflated-and-hurdle-models-44c5e6fe5d7f?source=collection_archive---------4-----------------------#2022-01-13">https://blog.devgenius.io/mixture-component-zero-inflated-and-hurdle-models-44c5e6fe5d7f?source=collection_archive---------4-----------------------#2022-01-13</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="32be" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">当单一分布不再足够时</h2></div><p id="7a23" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi ky translated"><span class="l kz la lb bm lc ld le lf lg di">我</span>一直对组合分布或者混合模型很着迷。我的第一个混合模型是<a class="ae lh" href="https://medium.com/@marc.jacobs012/analysis-of-repeated-count-data-in-r-the-poisson-quasi-poisson-negative-binomial-e62aff528309" rel="noopener">负二项分布</a>，也就是伽玛-泊松分布。然后，当然，我很快就遇到了零膨胀泊松模型(由于某种原因，常规泊松似乎永远不会在计数数据上完成交易)和障碍模型。它们都是由至少两种成分组成的模型。有些人甚至有更多，他们是必要的，以适应分布的颠簸，你没有足够的变量来解释颠簸(例如，当绘制男性和女性的长度没有性别变量)。</p><p id="d7ce" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们使用可用的R和数据集来仔细看看这些混合模型。</p></div><div class="ab cl li lj hr lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="ig ih ii ij ik"><p id="a56b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi ky translated">首先，我们加载所有必要的库，然后从混合正态分布开始。模拟这种成分或混合物模型实际上很容易。你只需从不同的正态分布中抽取三个样本，然后将它们合并成一个向量。这将导致类似骆驼驼峰的分布。</p><p id="a4e1" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">下面，你会看到我用多种方法来做，最后拟合出一个三组件模型。</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="92ea" class="ly lz in lu b gy ma mb l mc md">rm(list = ls())<br/>library(mixtools)<br/>library(extraDistr)<br/>library(flexmix)<br/>library(tidyverse)<br/>library(mixR)<br/>library(INLA)<br/>library(gridExtra)<br/>library(MASS)<br/>library(fitdistrplus)<br/>library(actuar)<br/>library(compounding)<br/>library(gamlss)<br/>library(iZid)<br/>library(glmmTMB)<br/>library(bbmle) <br/>library(GLMMadaptive)</span><span id="bd34" class="ly lz in lu b gy me mb l mc md">### LETS SIMULATE MIXTURE MODELS #### <br/>x &lt;- rmixnorm(1e5, c(0.5, 3, 6), c(3, 1, 1), c(1/3, 1/3, 1/3))<br/>hist(x, 100, freq = FALSE)<br/>curve(dmixnorm(x, c(0.5, 3, 6), c(3, 1, 1), c(1/3, 1/3, 1/3)),<br/>      -20, 20, n = 500, col = "red", add = TRUE)</span><span id="bf76" class="ly lz in lu b gy me mb l mc md">hist(pmixnorm(x, c(0.5, 3, 6), c(3, 1, 1), c(1/3, 1/3, 1/3)))<br/>plot(ecdf(x))<br/>curve(pmixnorm(x, c(0.5, 3, 6), c(3, 1, 1), c(1/3, 1/3, 1/3)),<br/>      -20, 20, n = 500, col = "red", lwd = 2, add = TRUE)</span><span id="ec25" class="ly lz in lu b gy me mb l mc md">norm1&lt;-normalmixEM(x, <br/>                   lambda = c(0.3,0.3,0.3), <br/>                   mu = c(0.5,3,6), <br/>                   sigma = c(3,1,1))<br/>par(mfrow = c(2, 1))<br/>plot(norm1, density=TRUE, cex.axis=1.4, cex.lab=1.4, cex.main=1.8,<br/>     main2="Mixture of Normal Distributions (0.5, 3, 6)")<br/>mod1 = mixfit(x, ncomp = 3); mod1<br/>plot(mod1, title = 'Mixture of Normal Distributions (0.5, 3, 6)')</span></pre><div class="lp lq lr ls gt ab cb"><figure class="mf mg mh mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/7287f9c542625ad0362da19aa2a1271d.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Uhv0Vm9XvF3lEu2tNyvtvQ.png"/></div></figure><figure class="mf mg mh mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/b682d218f1222bb01f401a76b246ed64.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*HKLtYL25WvECdpjIUc9TxA.png"/></div></figure><figure class="mf mg mh mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/1c659733336981515f7ed78fd9f409e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*yRECp3Jt5Zya1Q3bDjdXOA.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk mw di mx my translated">图片作者。</figcaption></figure></div><figure class="lp lq lr ls gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi mz"><img src="../Images/4d61dc0962bb1eaeb84f0d63114a86ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rcRyNS3aF0O-NtKMEQHo-w.png"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk translated">图片作者。</figcaption></figure><p id="22ed" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这并不难，是吗？您可以通过硬编码或使用许多已有的软件包和内置函数来创建正态分布的混合模型。</p><p id="e371" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在，让我们建立一个来自泊松的混合模型。我会试着用一个正常的混合物来解释我所看到的。</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="a6c2" class="ly lz in lu b gy ma mb l mc md">y &lt;- rmixpois(1e5, c(5, 12, 19), c(1/3, 1/3, 1/3))<br/>plot(density(y))</span><span id="572b" class="ly lz in lu b gy me mb l mc md">xx &lt;- seq(-1, 50)<br/>plot(prop.table(table(y)))<br/>lines(xx, dmixpois(xx, c(5, 12, 19), c(1/3, 1/3, 1/3)), col = "red")<br/>hist(pmixpois(y, c(5, 12, 19), c(1/3, 1/3, 1/3)))</span><span id="ee3a" class="ly lz in lu b gy me mb l mc md">xx &lt;- seq(0, 50, by = 0.01)<br/>plot(ecdf(x))<br/>lines(xx, pmixpois(xx, c(5, 12, 19), c(1/3, 1/3, 1/3)), col = "red", lwd = 2)</span><span id="b05f" class="ly lz in lu b gy me mb l mc md">mod1 = mixfit(y, ncomp = 2); mod1<br/>plot(mod1, title = 'Mixture of Normal Distributions (4.8, 14.7)')</span></pre><div class="lp lq lr ls gt ab cb"><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/71e069c7e8d23d96cc3c373c00d35ad9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*3Cn3mvY2c-G-c8v65qQpsg.png"/></div></figure><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/619e51f731140278820ba546a11c98ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*OSj2xEKgW6C1d7DXAjKP2w.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk nb di nc my translated">你可以看到泊松的微观分布，包括经验CDF函数。混合泊松线似乎没有重叠。图片作者。</figcaption></figure></div><figure class="lp lq lr ls gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi nd"><img src="../Images/e1d0d24977876b09d9efe0ef0ef854c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sBAjYmSyCTaCsa1dl24ppw.png"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk translated">然后，自动两组分正态分布混合在混合泊松之上。正态分布是一个真正的变色龙，所以尝试这个并不奇怪，也不会完全失败。但我也不认为这是一个合适的选择。图片作者。</figcaption></figure><p id="41a9" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">接下来，我将展示我模拟混合分布的多个例子，然后通过各种库和工具拟合它们。这是有点相同的，但最后，你应该得到它的窍门。</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="b508" class="ly lz in lu b gy ma mb l mc md">mix.dist.alt2 &lt;- function(n, mix.par, mu1, sigma1, mu2, df) {<br/>  k &lt;- rbinom(1, n, mix.par)<br/>  sample(c(rnorm(k, mu1, sigma1), mu2+rt(n-k, df))) #shuffle the values<br/>}<br/>y&lt;-mix.dist.alt2(1000,0.6,10,5,15,30)<br/>plot(density(y))<br/>norm1&lt;-normalmixEM(y, <br/>                   lambda = 0.5, <br/>                   mu = c(10,15), <br/>                   sigma = c(10,5))<br/>par(mfrow = c(2, 1))<br/>plot(norm1, density=TRUE, cex.axis=1.4, cex.lab=1.4, cex.main=1.8,<br/>     main2="Mixture of Normal Distributions (10, 15)")<br/>summary(norm1)<br/>plot(norm1)<br/>mod1 = mixfit(y, ncomp = 2); mod1<br/>plot(mod1, title = 'Mixture of Normal Distributions (10, 15)')</span></pre><div class="lp lq lr ls gt ab cb"><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/c1609ddbe3e0e96abc4b9991684eee9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*ZQ5ne8NsLO-Q7ltMJudv-Q.png"/></div></figure><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/b4cb8f09df32a5dfc5be9df1b4514450.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*GEbmTMiXBTXxMwKAR4y-tA.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk nb di nc my translated">图片作者。</figcaption></figure></div><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="38a1" class="ly lz in lu b gy ma mb l mc md">set.seed(100)<br/>n &lt;- 500<br/>lambda &lt;- rep(1, 2)/2<br/>mu &lt;- c(0, 5)<br/>sigma &lt;- rep(1, 2)<br/>mixnorm.data &lt;- mixtools::rnormmix(n, lambda, mu, sigma)<br/>hist(mixnorm.data)<br/>mod1 = mixfit(waiting, ncomp = 2); mod1<br/>plot(mod1, title = 'Mixture of Normal Distributions (0, 5)')</span></pre><div class="lp lq lr ls gt ab cb"><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/b8271afd7cede94edb8695ea3d77c270.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*tdAgqa_COWtHRnyoYVnM8w.png"/></div></figure><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/ff9b4353cd5cb3e40d529f8c8fd0be64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*VQeDQQ2mxgJxw_Oc4LsJMQ.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk nb di nc my translated">图片作者。</figcaption></figure></div><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="be2a" class="ly lz in lu b gy ma mb l mc md">attach(faithful)<br/>hist(waiting, main="Time between Old Faithful eruptions",<br/>xlab="Minutes", ylab="", cex.main=1.5, cex.lab=1.5, cex.axis=1.4)<br/>wait1 &lt;- normalmixEM(waiting, lambda = .5, mu = c(55, 80), sigma = 5)</span><span id="0faf" class="ly lz in lu b gy me mb l mc md">summary(wait1)<br/>summary of normalmixEM object:<br/>         comp 1   comp 2<br/>lambda  0.36085  0.63915<br/>mu     54.61364 80.09031<br/>sigma   5.86909  5.86909<br/>loglik at estimate:  -1034.002</span><span id="507f" class="ly lz in lu b gy me mb l mc md">par(mfrow = c(3, 1))<br/>plot(wait1, density=TRUE, cex.axis=1.4, cex.lab=1.4, cex.main=1.8,<br/>     main2="Time between Old Faithful eruptions", xlab2="Minutes")<br/>wait2 &lt;- spEMsymloc(waiting, mu0 = c(55, 80))<br/>plot(wait2, lty = 2, newplot = FALSE, addlegend = FALSE)<br/>wait2a &lt;- spEMsymloc(waiting, mu0 = c(55, 80), bw = 1)<br/>wait2b &lt;- spEMsymloc(waiting, mu0 = c(55, 80), bw = 6)<br/>plot(wait2a, lty = 1, addlegend = FALSE, cex.axis = 1.4,<br/>       cex.lab = 1.4, cex.main = 1.8, xlab = "Minutes",<br/>       title = "Time between Old Faithful eruptions")<br/>plot(wait2b, lty = 2, newplot = FALSE, addlegend = FALSE)</span><span id="792f" class="ly lz in lu b gy me mb l mc md">mod1 = mixfit(waiting, ncomp = 2); mod1<br/><br/>Normal mixture model with 2 components<br/>        comp1      comp2<br/>pi  0.3608973  0.6391027<br/>mu 54.6152288 80.0913054<br/>sd  5.8715381  5.8674987</span><span id="a4ea" class="ly lz in lu b gy me mb l mc md">EM iterations: 15 AIC: 2078 BIC: 2096.03 log-likelihood: -1034</span><span id="b1d7" class="ly lz in lu b gy me mb l mc md">plot(mod1, title = 'Mixture of Normal Distributions (55, 80)')</span></pre><div class="lp lq lr ls gt ab cb"><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/b77043923ddb986c974753c4ca346098.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*tw-CHtGTzOe2MmZIL7nfpQ.png"/></div></figure><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/999c986b6a5e13e7c789f7456101b7aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*6pfKDYRp5ESHm7ETN6aIiw.png"/></div></figure></div><div class="ab cb"><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/0bff9b73c4badd8840261ef31360ca2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*fIG3MG4w6aznF_6HrLu0CA.png"/></div></figure><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/e8e64fd1431df1dfde56c5e4d3cff10d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*pZ58QLyiRJjUcE86EooSeQ.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk nb di nc my translated">图片作者。</figcaption></figure></div><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="c6a6" class="ly lz in lu b gy ma mb l mc md">m1 &lt;- 0<br/>m2 &lt;- 50<br/>sd1 &lt;- sd2 &lt;- 5<br/>N1 &lt;- 100<br/>N2 &lt;- 10<br/>a &lt;- rnorm(n=N1, mean=m1, sd=sd1)<br/>b &lt;- rnorm(n=N2, mean=m2, sd=sd2)<br/>x &lt;- c(a,b)<br/>plot(density(x))<br/>class &lt;- c(rep('a', N1), rep('b', N2))<br/>data &lt;- data.frame(cbind(x=as.numeric(x), class=as.factor(class)))<br/>p &lt;- ggplot(data, aes(x = x)) + <br/>  geom_histogram(aes(x, ..density..), binwidth = 1, colour = "black", fill = "white") +<br/>  geom_vline(xintercept = m1, col = "red", size = 2) + <br/>  geom_vline(xintercept = m2, col = "blue", size = 2)+theme_bw()<br/>p<br/>set.seed(0)<br/>mo1 &lt;- FLXMRglm(family = "gaussian")<br/>mo2 &lt;- FLXMRglm(family = "gaussian")<br/>flexfit &lt;- flexmix(x ~ 1, <br/>                   data = data, <br/>                   k = 2, <br/>                   model = list(mo1, mo2))<br/>plot(flexfit)<br/>plot_mix_comps &lt;- function(x, mu, sigma, lam) {<br/>  lam * dnorm(x, mu, sigma)<br/>}<br/>lam &lt;- table(clusters(flexfit))<br/>c1 &lt;- parameters(flexfit, component=1)[[1]]<br/>c2 &lt;- parameters(flexfit, component=2)[[1]]<br/>ggplot(data) +<br/>  geom_histogram(aes(x, ..density..), binwidth = 1, colour = "black", fill = "white") +<br/>  stat_function(geom = "line", fun = plot_mix_comps,<br/>                args = list(c1[1], c1[2], lam[1]/sum(lam)),<br/>                colour = "red", lwd = 1.5) +<br/>  stat_function(geom = "line", fun = plot_mix_comps,<br/>                args = list(c2[1], c2[2], lam[2]/sum(lam)),<br/>                colour = "blue", lwd = 1.5) +<br/>  ylab("Density") +theme_bw()<br/>flex1 &lt;- normalmixEM(data$x, <br/>                     lambda = .5, <br/>                     mu = c(0, 50), <br/>                     sigma = c(5,5))<br/>par(mfrow = c(2, 1))<br/>plot(flex1, density=TRUE, cex.axis=1.4, cex.lab=1.4, cex.main=1.8,<br/>     main2="Normal Mixture (0,50)")<br/>mod1 = mixfit(x, ncomp = 2); mod1<br/>plot(mod1, title = 'Mixture of Normal Distributions (0, 50)')</span></pre><div class="lp lq lr ls gt ab cb"><figure class="mf mg ne mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/6472e230f004bc17ca9806635c18884b.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/1*7HXYngRwMlO3Woo3dyPYsw.png"/></div></figure><figure class="mf mg nf mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/5037ab166d076c5ee7b40b9811823882.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*HC13PPI3FjaIQREgDiBCOA.png"/></div></figure><figure class="mf mg ne mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/7c7df29f732ed065096fb8c2ba909de0.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/1*4UZag-aAVutoRAVkP4QsIQ.png"/></div></figure></div><div class="ab cb"><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/c7e154df13cc867da471f03157943e55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*cI4SvPsQ7g6xw9nUGYQ5dA.png"/></div></figure><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/49500b71551ac6887beaac0ab812fb3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*fz_OBm7n6oG4FvKJUphi9Q.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk nb di nc my translated">图片作者。</figcaption></figure></div><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="2bb2" class="ly lz in lu b gy ma mb l mc md">m1 &lt;- 20<br/>m2 &lt;- 40<br/>sd1 &lt;- 5<br/>sd2 &lt;- 10<br/>N1 &lt;- 100<br/>N2 &lt;- 100<br/>a &lt;- rnorm(n=N1, mean=m1, sd=sd1)<br/>b &lt;- rnorm(n=N2, mean=m2, sd=sd2)<br/>x &lt;- c(a,b)<br/>class &lt;- c(rep('a', N1), rep('b', N2))<br/>data &lt;- data.frame(cbind(x=as.numeric(x), class=as.factor(class)))<br/>p &lt;- ggplot(data, aes(x = x)) + <br/>  geom_histogram(aes(x, ..density..), binwidth = 1, colour = "black", fill = "white") +<br/>  geom_vline(xintercept = m1, col = "red", size = 2) + <br/>  geom_vline(xintercept = m2, col = "blue", size = 2) +theme_bw();p<br/>mo1 &lt;- FLXMRglm(family = "gaussian")<br/>mo2 &lt;- FLXMRglm(family = "gaussian")<br/>flexfit &lt;- flexmix(x ~ 1, data = data, k = 2, model = list(mo1, mo2))<br/>print(table(clusters(flexfit), data$class))<br/>c1 &lt;- parameters(flexfit, component=1)[[1]]<br/>c2 &lt;- parameters(flexfit, component=2)[[1]]<br/>lam &lt;- table(clusters(flexfit))<br/>ggplot(data) +<br/>  geom_histogram(aes(x, ..density..), binwidth = 1, colour = "black", fill = "white") +<br/>  stat_function(geom = "line", fun = plot_mix_comps,<br/>                args = list(c1[1], c1[2], lam[1]/sum(lam)),<br/>                colour = "red", lwd = 1.5) +<br/>  stat_function(geom = "line", fun = plot_mix_comps,<br/>                args = list(c2[1], c2[2], lam[2]/sum(lam)),<br/>                colour = "blue", lwd = 1.5) +<br/>  ylab("Density") +theme_bw()<br/>flex1 &lt;- normalmixEM(data$x, <br/>                     lambda = .5, <br/>                     mu = c(20,40), <br/>                     sigma = c(5,10))<br/>par(mfrow = c(2, 1))<br/>plot(flex1, density=TRUE, cex.axis=1.4, cex.lab=1.4, cex.main=1.8,<br/>     main2="Normal Mixture (20,40)")<br/>mod1 = mixfit(data$x, ncomp = 2); mod1<br/>plot(mod1, title = 'Mixture of Normal Distributions (20, 40)')</span></pre><div class="lp lq lr ls gt ab cb"><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/4d1beb92097a3ec930db43dba013eb36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*88nZIgyBmGjhis5OVLxfBg.png"/></div></figure><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/5f57d0abfdbee57600823c4558179b9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*AbOo4df43OmlmuKz7sFZSQ.png"/></div></figure></div><div class="ab cb"><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/ba1d9cd422b4aa0abb0cc457fc99687f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*KsKMNyVuuHb81vPOn4Kmkg.png"/></div></figure><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/dd2407c9eb1a9eded38bbf2a6a872e10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*-Dkg3AdMrv_4u_BbWwPLXg.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk nb di nc my translated">图片作者。</figcaption></figure></div><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="8d0f" class="ly lz in lu b gy ma mb l mc md">data(iris);attach(iris)<br/>p &lt;- ggplot(iris, aes(x = Petal.Width)) + <br/>  geom_histogram(aes(x = Petal.Width, ..density..),<br/>                 binwidth = 0.1, colour = "black", fill = "white") + theme_bw();p<br/>set.seed(0)<br/>mo1 &lt;- FLXMRglm(family = "gaussian")<br/>mo2 &lt;- FLXMRglm(family = "gaussian")<br/>mo3 &lt;- FLXMRglm(family = "gaussian")<br/>flexfit &lt;- flexmix(Petal.Width ~ 1, <br/>                   data = iris, <br/>                   k = 3, model = list(mo1, mo2, mo3))<br/>c1 &lt;- parameters(flexfit, component=1)[[1]]<br/>c2 &lt;- parameters(flexfit, component=2)[[1]]<br/>c3 &lt;- parameters(flexfit, component=3)[[1]]<br/>lam &lt;- table(clusters(flexfit))<br/>ggplot(iris) +<br/>  geom_histogram(aes(x = Petal.Width, ..density..), binwidth = 0.1, colour = "black", fill = "white") +<br/>  stat_function(geom = "line", fun = plot_mix_comps,<br/>                args = list(c1[1], c1[2], lam[1]/sum(lam)),<br/>                colour = "red", lwd = 1.5) +<br/>  stat_function(geom = "line", fun = plot_mix_comps,<br/>                args = list(c2[1], c2[2], lam[2]/sum(lam)),<br/>                colour = "blue", lwd = 1.5) +<br/>  stat_function(geom = "line", fun = plot_mix_comps,<br/>                args = list(c3[1], c3[2], lam[3]/sum(lam)),<br/>                colour = "green", lwd = 1.5) + theme_bw() +  ylab("Density")<br/>flex1 &lt;- normalmixEM(iris$Petal.Width, <br/>                     lambda = c(0.333,0.320,0.347), <br/>                     mu = c(c1[[1]],c2[[1]],c3[[1]]), <br/>                     sigma = c(c1[[2]],c2[[2]],c3[[2]]))<br/>par(mfrow = c(2, 1))<br/>plot(flex1, density=TRUE, cex.axis=1.4, cex.lab=1.4, cex.main=1.8,<br/>     main2="Normal Mixture (0.2,2.1,1.4)")<br/>mod1 = mixfit(iris$Petal.Width, ncomp = 3); mod1<br/>plot(mod1, title = 'Mixture of Normal Distributions (0.2,2.1,1.4)')</span></pre><div class="lp lq lr ls gt ab cb"><figure class="mf mg mh mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/64f1f4b1af4115b425b60aaa104f7e7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*xw8pz2TryaBHAwcCOoao5w.png"/></div></figure><figure class="mf mg mh mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/cd56176aca3023391f3281a4acb20142.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*-Qg_3fFZCMbXJt4ub5RM0w.png"/></div></figure><figure class="mf mg mh mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/a67e1f9c79dd12434d607f00db3a3e6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*8lGDV6QYM5DCoFNbepXoww.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk mw di mx my translated">图片作者。</figcaption></figure></div><p id="1689" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">好了，现在您已经阅读了模拟正态分布混合模型和拟合混合模型的几个示例，以评估每个分布的组成部分——它们的比例、平均值和标准偏差。</p><p id="b67c" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">接下来是一些不同的东西——包含多项式回归的混合模型，用于处理泊松数据。在这里，我使用了<a class="ae lh" href="https://cran.r-project.org/web/packages/flexmix/index.html" rel="noopener ugc nofollow" target="_blank"> flexmix包</a>。我也看了一下<a class="ae lh" href="https://www.rdocumentation.org/packages/mixtools/versions/1.2.0/topics/normalmixEM" rel="noopener ugc nofollow" target="_blank">的mixtools包。</a></p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="fe27" class="ly lz in lu b gy ma mb l mc md">par(mfrow = c(1, 1))<br/>data("patent")<br/>plot(density(patent$Patents))<br/>plot(density(patent$RDS))<br/>plot(density(patent$lgRD))<br/>plot(patent$Patents, patent$RDS)<br/>plot(patent$Patents, patent$lgRD)</span><span id="4760" class="ly lz in lu b gy me mb l mc md">pat_mix &lt;- flexmix(Patents ~ lgRD,<br/>                   k = 3, data = patent,<br/>                   model = FLXMRglm(family = "poisson"),<br/>                   concomitant = FLXPmultinom(~RDS))<br/>summary(pat_mix);plot(pat_mix, mark = 3)<br/>fitted&lt;-as.data.frame(predict(pat_mix))<br/>combined&lt;-cbind(patent,fitted,pat_mix@cluster)</span><span id="fc46" class="ly lz in lu b gy me mb l mc md">g1&lt;-ggplot(combined, aes(x=lgRD))+<br/>  geom_point(aes(y=Patents,col=as.factor(pat_mix@cluster)))+<br/>  geom_line(aes(y=Comp.1))+<br/>  geom_line(aes(y=Comp.2))+<br/>  geom_line(aes(y=Comp.3))+theme_bw()</span><span id="4303" class="ly lz in lu b gy me mb l mc md">c1 &lt;- parameters(pat_mix , component=1)<br/>c2 &lt;- parameters(pat_mix , component=2)<br/>c3 &lt;- parameters(pat_mix , component=3)<br/><br/>flex1 &lt;- normalmixEM(patent$lgRD, <br/>                     lambda = c(pat_mix@prior[1],<br/>                                pat_mix@prior[2],<br/>                                pat_mix@prior[3]), <br/>                     mu = c(c1[[1]],c2[[1]],c3[[1]]), <br/>                     sigma = c(c1[[2]],c2[[2]],c3[[2]]))</span><span id="b9ea" class="ly lz in lu b gy me mb l mc md">summary(flex1)<br/>summary of normalmixEM object:<br/>          comp 1   comp 2   comp 3<br/>lambda  0.114638 0.626038 0.259324<br/>mu     -2.130172 0.922172 3.774489<br/>sigma   0.576514 1.378248 0.685054<br/>loglik at estimate:  -145.4764</span><span id="b0b7" class="ly lz in lu b gy me mb l mc md">par(mfrow = c(2, 1))<br/>plot(flex1, density=TRUE, cex.axis=1.4, cex.lab=1.4, cex.main=1.8,<br/>     main2="Normal Mixture (0.6,-1.3,0.12)")<br/>plot(refit(pat_mix), bycluster = FALSE)<br/>mod1 = mixfit(patent$lgRD, ncomp = 3, max_iter=2000); mod1<br/>plot(mod1, title = 'Mixture of Normal Distributions (0.6,-1.3,0.12)')</span></pre><div class="lp lq lr ls gt ab cb"><figure class="mf mg mh mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/947a9fd1fa6918a2a06bf570142a0911.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*O14a-JhG5N_0OPl-K-DlVQ.png"/></div></figure><figure class="mf mg mh mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/99c2242b70197ec2d71db4f8873a64b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*1LLZYGNgOlQB-_JvmsJyJw.png"/></div></figure><figure class="mf mg mh mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/83019c9772b873ed36083bafb03d1337.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*ARLVUXNIVcOKMaA8WBUawg.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk mw di mx my translated">包括几个变量的分布。</figcaption></figure></div><div class="ab cb"><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/28189b740c9ac932b86134edd226effd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*WRQrdf-oxEATykjTawDLzg.png"/></div></figure><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/a738b27f4c52689e2a255d3b9f3c85f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*Am-JkM3iY8VRzwQjmmSjhg.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk nb di nc my translated">混合物模型的组成部分和观测值之上的预测值。</figcaption></figure></div><div class="ab cb"><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/977045fd5b838d2bd420f3faaf847c22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*mWhZMjCvfgZQD9QVMSPRGw.png"/></div></figure><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/c896f0eae1bed40dae8451f80042c055.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*DnljbEPwMeZDqvPGsUjIJw.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk nb di nc my translated">使用正态分布模型建模的数据。如您所见，该分布可以用正态分布来近似，但最好还是看一看泊松混合。我以后会做那件事。图片作者。</figcaption></figure></div><p id="fd55" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们通过添加一个集群组件来稍微改变一下模型。然后，我们可以重新调整模型，看看事情是否发生了变化，并看看来自模型的预测。</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="90c6" class="ly lz in lu b gy ma mb l mc md">pat_mix2 &lt;- flexmix(Patents ~ 1,<br/>                    concomitant = FLXPmultinom(~RDS),<br/>                    data = patent, cluster = Post_1,<br/>                    model = Model_2)<br/>summary(pat_mix2)<br/>parameters(pat_mix2 , component=1)<br/>c(M_1 = BIC(pat_mix), M_2 = BIC(pat_mix2))<br/>plot(refit(pat_mix))<br/>fitted2&lt;-as.data.frame(predict(pat_mix2))<br/>combined&lt;-cbind(patent,fitted,pat_mix2@cluster)<br/>g2&lt;-ggplot(combined, aes(x=lgRD))+<br/>  geom_point(aes(y=Patents,col=as.factor(pat_mix2@cluster)))+<br/>  geom_line(aes(y=Comp.1))+<br/>  geom_line(aes(y=Comp.2))+<br/>  geom_line(aes(y=Comp.3))+theme_bw()<br/>grid.arrange(g1,g2)</span></pre><div class="lp lq lr ls gt ab cb"><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/f6bdaf223960982d445e97277bc0c57e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*AexqUWYuQ5Onr73VHKQzjA.png"/></div></figure><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/7c5aff1ff150eee41d1a21c5b2232271.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*N7e2VOaopMz4QO7OvvFgbA.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk nb di nc my translated">改装部件及其系数，以及新旧型号的新旧拟合线。图片作者。</figcaption></figure></div><p id="13d5" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们继续使用混合模型来模拟数据。下面，您会看到一个新的数据集、图和包含多项式的混合模型。我试图为连续数据拟合一个双组分混合模型。</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="2633" class="ly lz in lu b gy ma mb l mc md">data("NPreg")<br/>plot(density(NPreg$yn))<br/>ggplot(NPreg)+<br/>  geom_density(aes(x=yn))+<br/>  geom_density(aes(x=yp))+<br/>  geom_density(aes(x=yb))+<br/>  theme_bw()<br/>plot(NPreg$x, NPreg$yn)</span><span id="7640" class="ly lz in lu b gy me mb l mc md">m1 &lt;- flexmix(yn ~ x + I(x^2), data = NPreg, k = 2)<br/>plot(m1)<br/>parameters(m1, component = 1)<br/>parameters(m1, component = 2)<br/>table(NPreg$class, clusters(m1))</span><span id="9ed3" class="ly lz in lu b gy me mb l mc md">rm1 &lt;- refit(m1)<br/>summary(rm1)<br/>plot(rm1)</span><span id="1989" class="ly lz in lu b gy me mb l mc md">mod1 = mixfit(NPreg$yn, ncomp = 2); mod1<br/>plot(mod1, title = 'Mixture of Normal Distributions (7.3,33.4)')</span></pre><div class="lp lq lr ls gt ab cb"><figure class="mf mg mh mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/036391674bfbe7959f48caee2f587a30.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*XP1Bgi9hp5QwkrCf43O4Iw.png"/></div></figure><figure class="mf mg mh mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/3ab526fbe142dd2ad03c8c0b5b610f50.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*dQd8Xmv3KjdFoEgYoKyblg.png"/></div></figure><figure class="mf mg mh mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/0d2750c8e450dfd57b71b13ce8def7d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*4JEDJhhhNslSnY5bLeJj4w.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk mw di mx my translated">向量的分布和散点图表明需要多项式。</figcaption></figure></div><div class="ab cb"><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/03c02da61fb35b3213ff734dd8ad01fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*EOcPCW-2bd_VWX2bIQqsvA.png"/></div></figure><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/1a6c086738e987444692bba64d33a832.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*XsKnfvJtZLsfkO_ayiW4Aw.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk nb di nc my translated">图片作者。</figcaption></figure></div><figure class="lp lq lr ls gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi nd"><img src="../Images/0f0a079c5f662ae846fa9da866882f4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pyRu5K0OJwp_loAcuqNmEw.png"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk translated">一个双组分正态混合模型。图片作者。</figcaption></figure><p id="10bd" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在，让我们来拟合一个混合泊松分布。</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="501d" class="ly lz in lu b gy ma mb l mc md">m2 &lt;- flexmix(yp ~ x, data = NPreg, k = 2,<br/>              model = FLXMRglm(family = "poisson"));summary(m2)</span><span id="3290" class="ly lz in lu b gy me mb l mc md">Call:<br/>flexmix(formula = yp ~ x, data = NPreg, k = 2, model = FLXMRglm(family = "poisson"))</span><span id="4b29" class="ly lz in lu b gy me mb l mc md">prior size post&gt;0 ratio<br/>Comp.1 0.532  112    197 0.569<br/>Comp.2 0.468   88    200 0.440</span><span id="60e7" class="ly lz in lu b gy me mb l mc md">'log Lik.' -440.6424 (df=5)<br/>AIC: 891.2849   BIC: 907.7765</span><span id="2123" class="ly lz in lu b gy me mb l mc md">m3 = flexmix(~x, data=NPreg, k=2,<br/>             model=list(FLXMRglm(yn~.+I(x^2)),<br/>             FLXMRglm(yp~., family="poisson")));summary(m3)</span><span id="82ff" class="ly lz in lu b gy me mb l mc md">Call:<br/>flexmix(formula = ~x, data = NPreg, k = 2, model = list(FLXMRglm(yn ~ . + I(x^2)), <br/>    FLXMRglm(yp ~ ., family = "poisson")))</span><span id="0bba" class="ly lz in lu b gy me mb l mc md">prior size post&gt;0 ratio<br/>Comp.1 0.507  104    137 0.759<br/>Comp.2 0.493   96    139 0.691</span><span id="9f96" class="ly lz in lu b gy me mb l mc md">'log Lik.' -1044.768 (df=13)<br/>AIC: 2115.535   BIC: 2158.414</span><span id="c411" class="ly lz in lu b gy me mb l mc md">plot(m3)</span><span id="4476" class="ly lz in lu b gy me mb l mc md">ggplot(NPreg,aes(x,yn,color=as.factor(id2)))+<br/>  geom_point() + theme_bw() + theme(legend.position = "none")</span><span id="c445" class="ly lz in lu b gy me mb l mc md">mod1 = mixfit(NPreg$x, ncomp = 2); mod1</span><span id="6b69" class="ly lz in lu b gy me mb l mc md">Normal mixture model with 2 components<br/>       comp1     comp2<br/>pi 0.4869582 0.5130418<br/>mu 2.5944372 7.3432475<br/>sd 1.5526815 1.5401136</span><span id="ab8c" class="ly lz in lu b gy me mb l mc md">EM iterations: 53 AIC: 963.38 BIC: 979.87 log-likelihood: -476.69</span><span id="bb0f" class="ly lz in lu b gy me mb l mc md">plot(mod1, title = 'Mixture of Normal Distributions (2.5,7.3)')</span></pre><figure class="lp lq lr ls gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi nd"><img src="../Images/2d9c56ffd75bf380511fdd046363c862.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zG49-FHU1F0_54Lb7VYHsA.png"/></div></div></figure><div class="lp lq lr ls gt ab cb"><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/9293d24fa77c6b9d8cc437352a9f0d8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*Vb_XWeBtnFsDh4SFCF1qsw.png"/></div></figure><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/8b739f497bd03e5b9127f9a054f4f8ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*0tZtb4Vw9benlwOtetrqtA.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk nb di nc my translated">右边的正态混合物非常努力地去拟合泊松，它实际上非常接近，但是它可以做得更好。图片作者。</figcaption></figure></div><p id="29d8" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">几个模型之后，并尝试逐步选择，我们可以绘制预测值，以覆盖他们的观察。如您所见，flexmix包在处理离散数据方面非常灵活(正如它的名字一样)。</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="8816" class="ly lz in lu b gy ma mb l mc md">m4 &lt;- flexmix(yn ~ x + I(x^2) | id2, data = NPreg, k = 2)<br/>summary(m4)</span><span id="e48d" class="ly lz in lu b gy me mb l mc md">Call:<br/>flexmix(formula = yn ~ x + I(x^2) | id2, data = NPreg, k = 2)</span><span id="1de5" class="ly lz in lu b gy me mb l mc md">prior size post&gt;0 ratio<br/>Comp.1   0.5  100    100     1<br/>Comp.2   0.5  100    100     1</span><span id="e38f" class="ly lz in lu b gy me mb l mc md">'log Lik.' -561.5651 (df=9)<br/>AIC: 1141.13   BIC: 1170.815</span><span id="6599" class="ly lz in lu b gy me mb l mc md">plot(m4)<br/>fitted&lt;-as.data.frame(predict(m4))<br/>combined&lt;-cbind(NPreg,fitted,m4@cluster)<br/>ggplot(combined, aes(x=x))+<br/>  geom_point(aes(y=yn, col=as.factor(m4@cluster)))+<br/>  geom_line(aes(y=Comp.1))+<br/>  geom_line(aes(y=Comp.2))+theme_bw()</span></pre><figure class="lp lq lr ls gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi nd"><img src="../Images/2e3059432b21fee727f7f1fe490bca32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lnoc036m8f56YsDz_k_j-Q.png"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk translated">图片作者。</figcaption></figure><p id="8516" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Flexmix也有一个逐步选择工具，但它的表现不如我所愿。我不喜欢逐步选择的方法。</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="daac" class="ly lz in lu b gy ma mb l mc md">m7 &lt;- stepFlexmix(yp ~ x + I(x^2) | id2, data = NPreg,<br/>                  control = list(verbose = 0), k = 1:5, nrep = 20);m7<br/>summary(m7)</span><span id="6538" class="ly lz in lu b gy me mb l mc md">1 : * * * * * * * * * * * * * * * * * * * *<br/>2 : * * * * * * * * * * * * * * * * * * * *<br/>3 : * * * * * * * * * * * * * * * * * * * *<br/>4 : * * * * * * * * * * * * * * * * * * * *<br/>5 : * * * * * * * * * * * * * * * * * * * *</span><span id="cf88" class="ly lz in lu b gy me mb l mc md">Call:<br/>stepFlexmix(yp ~ x + I(x^2) | id2, data = NPreg, control = list(verbose = 0), k = 1:5, <br/>    nrep = 20)</span><span id="90a2" class="ly lz in lu b gy me mb l mc md">iter converged k k0    logLik      AIC      BIC      ICL<br/>1    2      TRUE 1  1 -462.7772 933.5544 946.7477 946.7477<br/>2   16      TRUE 2  2 -434.6688 887.3376 917.0224 924.9417<br/>3   52      TRUE 3  3 -427.1162 882.2324 928.4088 936.5170<br/>4  104      TRUE 4  4 -421.2285 880.4569 943.1250 957.5175<br/>5  113      TRUE 5  5 -417.6660 883.3320 962.4916 970.0022</span><span id="0991" class="ly lz in lu b gy me mb l mc md">plot(m7)<br/>m7_select&lt;-getModel(m7, "BIC")<br/>summary(m7_select)</span><span id="4337" class="ly lz in lu b gy me mb l mc md">Call:<br/>stepFlexmix(yp ~ x + I(x^2) | id2, data = NPreg, control = list(verbose = 0), k = 2, <br/>    nrep = 20)</span><span id="3fed" class="ly lz in lu b gy me mb l mc md">prior size post&gt;0 ratio<br/>Comp.1 0.471   96    196 0.490<br/>Comp.2 0.529  104    176 0.591</span><span id="0079" class="ly lz in lu b gy me mb l mc md">'log Lik.' -434.6688 (df=9)<br/>AIC: 887.3376   BIC: 917.0224</span><span id="a273" class="ly lz in lu b gy me mb l mc md">fitted&lt;-as.data.frame(predict(m7_select))<br/>combined&lt;-cbind(NPreg,fitted,m7_select@cluster)<br/>ggplot(combined, aes(x=x))+<br/>  geom_point(aes(y=yn, col=as.factor(m7_select@cluster)))+<br/>  geom_line(aes(y=Comp.1))+<br/>  geom_line(aes(y=Comp.2))+theme_bw()</span></pre><figure class="lp lq lr ls gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi nd"><img src="../Images/d4572d43a82c5450b2a6219faea37b27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YV46qhTIvvci74oPlgwbCg.png"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk translated">图片作者。</figcaption></figure></div><div class="ab cl li lj hr lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="ig ih ii ij ik"><p id="7813" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi ky translated"><span class="l kz la lb bm lc ld le lf lg di">如果</span>我们谈论混合，我们就谈论分布，R有这么多很酷的软件包来为你的数据寻找合适的分布，以及组合分布。让我们仔细看看！</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="0b37" class="ly lz in lu b gy ma mb l mc md">library("MASS")<br/>data(geyser)<br/>summary(geyser)<br/>attach(geyser)<br/>plot(waiting,duration)<br/>plot(duration,waiting)<br/>plot(density(waiting))<br/>plot(density(duration))<br/>idx1 &lt;- geyser$duration &lt;=3<br/>ggplot(geyser,aes(x=duration, col=idx1))+<br/>  geom_density()+theme_bw()<br/>mod1 = mixfit(duration, ncomp = 2); mod1<br/>plot(mod1, title = 'Normal Mixture Model (1.95, 4.23)')</span></pre><div class="lp lq lr ls gt ab cb"><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/ebc680bd8283a0176a1b0c671cfec463.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*s5LA-TIx97Ul_wVu6vFgRQ.png"/></div></figure><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/cbe12fe11481bcd82e5024d28bb4b7bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*IL1YAzZRp4AhK0leMm-Grw.png"/></div></figure></div><div class="ab cb"><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/51a23aceca7120d9fa6779d0d005ecdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*RubhtYPq7rvuaqP7QRLLig.png"/></div></figure><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/043f58c8dd3af8a385dc968297a76db8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*BEL41LuBvWRhOvQHSnTsFw.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk nb di nc my translated">一个简单的正态混合模型。图片作者。</figcaption></figure></div><p id="1ebc" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">上面是一个简单的正态混合模型的重复例子，但下面我们会发现新的分布。<a class="ae lh" href="https://en.wikipedia.org/wiki/Weibull_distribution" rel="noopener ugc nofollow" target="_blank">威布尔</a>、<a class="ae lh" href="https://en.wikipedia.org/wiki/Gamma_distribution" rel="noopener ugc nofollow" target="_blank">伽玛</a>、<a class="ae lh" href="https://en.wikipedia.org/wiki/Log-normal_distribution" rel="noopener ugc nofollow" target="_blank">对数正态</a>。不一定是混合物(虽然它们可以混合)，但对其余部分来说是一个很好的提升。</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="8383" class="ly lz in lu b gy ma mb l mc md">library("fitdistrplus")<br/>options(digits = 4)<br/>set.seed(1234)<br/>data("groundbeef", package = "fitdistrplus")<br/>str(groundbeef)<br/>plotdist(groundbeef$serving, histo = TRUE, demp = TRUE)<br/>descdist(groundbeef$serving, boot = 1000)<br/>fw &lt;- fitdist(groundbeef$serving, "weibull")<br/>fg &lt;- fitdist(groundbeef$serving, "gamma")<br/>fln &lt;- fitdist(groundbeef$serving, "lnorm")<br/>par(mfrow = c(2, 2))<br/>denscomp(list(fw, fln, fg), legendtext = c("Weibull", "lognormal", "gamma"))<br/>qqcomp(list(fw, fln, fg), legendtext = c("Weibull", "lognormal", "gamma"))<br/>cdfcomp(list(fw, fln, fg), legendtext = c("Weibull", "lognormal", "gamma"))<br/>ppcomp(list(fw, fln, fg), legendtext = c("Weibull", "lognormal", "gamma"))</span></pre><div class="lp lq lr ls gt ab cb"><figure class="mf mg ng mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/a96fa23ab476bb868c6d85c226937015.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/format:webp/1*2qCuiYD6lAnWtkNzZlDWyA.png"/></div></figure><figure class="mf mg nh mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/184ed802cabd9f64b67c63393f79a73e.png" data-original-src="https://miro.medium.com/v2/resize:fit:646/format:webp/1*NQ9vriD8ucQFppaFdqmHDg.png"/></div></figure><figure class="mf mg nh mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/4a554c3909f26eb4b6c3639658b99568.png" data-original-src="https://miro.medium.com/v2/resize:fit:646/format:webp/1*i9xsp581Cux9UdGtUoRVBQ.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk ni di nj my translated">使用威布尔、对数正态和伽玛模型来尝试和拟合观察到的数据。图片作者。</figcaption></figure></div><p id="c631" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们来看看更奇特的分布:<a class="ae lh" href="https://en.wikipedia.org/wiki/Burr_distribution" rel="noopener ugc nofollow" target="_blank">伯尔</a>、<a class="ae lh" href="https://en.wikipedia.org/wiki/Pareto_distribution" rel="noopener ugc nofollow" target="_blank">帕累托</a>和<a class="ae lh" href="https://en.wikipedia.org/wiki/Log-logistic_distribution" rel="noopener ugc nofollow" target="_blank">对数逻辑分布</a>。下面的代码看起来很长，但它们是我上面所做的重复——查看一个发行版，并试图适应许多可能看起来合适的版本。</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="e09a" class="ly lz in lu b gy ma mb l mc md">data("endosulfan", package = "fitdistrplus")<br/>ATV &lt;- endosulfan$ATV<br/>fendo.ln &lt;- fitdist(ATV, "lnorm")<br/>library("actuar")<br/>fendo.ll &lt;- fitdist(ATV, "llogis", start = list(shape = 1, scale = 500))<br/>fendo.P  &lt;- fitdist(ATV, "pareto", start = list(shape = 1, scale = 500))<br/>fendo.B  &lt;- fitdist(ATV, "burr", start = list(shape1 = 0.3, shape2 = 1, rate = 1))</span><span id="fb70" class="ly lz in lu b gy me mb l mc md">par(mfrow = c(1, 1))<br/>cdfcomp(list(fendo.ln, fendo.ll, fendo.P, fendo.B), xlogscale = TRUE,ylogscale = TRUE, legendtext = c("lognormal", "loglogistic", "Pareto", "Burr"))</span><span id="4b38" class="ly lz in lu b gy me mb l mc md">quantile(fendo.B, probs = 0.05)<br/>quantile(ATV, probs = 0.05)</span><span id="6dea" class="ly lz in lu b gy me mb l mc md">gofstat(list(fendo.ln, fendo.ll, fendo.P, fendo.B),<br/>        fitnames = c("lnorm", "llogis", "Pareto", "Burr"))<br/>bendo.B &lt;- bootdist(fendo.B, niter = 1001)</span><span id="7fe8" class="ly lz in lu b gy me mb l mc md">summary(bendo.B)<br/>plot(bendo.B)<br/>quantile(bendo.B, probs = 0.05)</span><span id="d4ac" class="ly lz in lu b gy me mb l mc md">fendo.ln.ADL &lt;- fitdist(ATV, "lnorm", method = "mge", gof= "ADL")<br/>fendo.ln.AD2L &lt;- fitdist(ATV, "lnorm", method = "mge", gof = "AD2L")</span><span id="61c5" class="ly lz in lu b gy me mb l mc md">cdfcomp(list(fendo.ln, fendo.ln.ADL, fendo.ln.AD2L),<br/>        xlogscale = TRUE, ylogscale = TRUE,<br/>        main = "Fitting a lognormal distribution", xlegend = "bottomright",legendtext = c("MLE", "Left-tail AD", "Left-tail AD 2nd order"))</span><span id="91f0" class="ly lz in lu b gy me mb l mc md">(HC5.estimates &lt;- c(<br/>  empirical = as.numeric(quantile(ATV, probs = 0.05)),<br/>  Burr = as.numeric(quantile(fendo.B, probs = 0.05)$quantiles),<br/>  lognormal_MLE = as.numeric(quantile(fendo.ln, probs = 0.05)$quantiles),lognormal_AD2 = as.numeric(quantile(fendo.ln.ADL, probs = 0.05)$quantiles),lognormal_AD2L = as.numeric(quantile(fendo.ln.AD2L,probs = 0.05)$quantiles)))<br/>data("danishuni", package = "fitdistrplus")</span><span id="b76c" class="ly lz in lu b gy me mb l mc md">str(danishuni)<br/>fdanish.ln.MLE &lt;- fitdist(danishuni$Loss, "lnorm")<br/>fdanish.ln.MME &lt;- fitdist(danishuni$Loss, "lnorm", method = "mme", order = 1:2)</span><span id="ff92" class="ly lz in lu b gy me mb l mc md">cdfcomp(list(fdanish.ln.MLE, fdanish.ln.MME), <br/>        legend = c("lognormal MLE", "lognormal MME"), <br/>        main = "Fitting a lognormal distribution",<br/>        xlogscale = TRUE, datapch = 20)</span><span id="b70f" class="ly lz in lu b gy me mb l mc md">fdanish.P.MLE &lt;- fitdist(danishuni$Loss, "pareto", <br/>                         start = list(shape = 10, scale = 10), <br/>                         lower = 2+1e-6, <br/>                         upper = Inf)</span><span id="d439" class="ly lz in lu b gy me mb l mc md">memp &lt;- function(x, order) sum(x^order)/length(x)<br/>fdanish.P.MME &lt;- fitdist(danishuni$Loss, "pareto", method = "mme", order = 1:2, memp = "memp", start = list(shape = 10, scale = 10), <br/>                         lower = c(2+1e-6, 2+1e-6), <br/>                         upper = c(Inf, Inf))<br/>par(mfrow = c(1,2))<br/>cdfcomp(list(fdanish.ln.MLE, fdanish.ln.MME), <br/>        legend = c("lognormal MLE", "lognormal MME"), main = "Fitting a lognormal distribution",xlogscale = TRUE, datapch = 20)<br/>cdfcomp(list(fdanish.P.MLE, fdanish.P.MME), legend = c("Pareto MLE", "Pareto MME"), main = "Fitting a Pareto distribution",xlogscale = TRUE, datapch = 20)</span><span id="7fe0" class="ly lz in lu b gy me mb l mc md">par(mfrow = c(1, 1))<br/>cdfcomp(list(fdanish.P.MLE, fdanish.P.MME), <br/>        legend = c("Pareto MLE", "Pareto MME"), <br/>        main = "Fitting a Pareto distribution", xlogscale = TRUE, datapch = ".")</span><span id="12e5" class="ly lz in lu b gy me mb l mc md">gofstat(list(fdanish.ln.MLE, fdanish.P.MLE,fdanish.ln.MME, fdanish.P.MME),fitnames = c("lnorm.mle", "Pareto.mle", "lnorm.mme", "Pareto.mme"))</span><span id="11ad" class="ly lz in lu b gy me mb l mc md">fdanish.ln.QME1 &lt;- fitdist(danishuni$Loss, "lnorm", method = "qme", <br/>                           probs = c(1/3, 2/3))<br/>fdanish.ln.QME2 &lt;- fitdist(danishuni$Loss, "lnorm", method = "qme", <br/>                           probs = c(8/10, 9/10))</span><span id="449e" class="ly lz in lu b gy me mb l mc md">cdfcomp(list(fdanish.ln.MLE, fdanish.ln.QME1, fdanish.ln.QME2), <br/>        legend = c("MLE", "QME(1/3, 2/3)", "QME(8/10, 9/10)"), <br/>        main = "Fitting a lognormal distribution", xlogscale = TRUE, datapch = 20)</span><span id="b5e5" class="ly lz in lu b gy me mb l mc md">cdfcomp(list(fdanish.ln.MLE, fdanish.ln.QME1, fdanish.ln.QME2), <br/>        legend = c("MLE", "QME(1/3, 2/3)", "QME(8/10, 9/10)"), main = "Fitting a lognormal distribution",xlogscale = TRUE, datapch = 20)</span></pre><div class="lp lq lr ls gt ab cb"><figure class="mf mg mh mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/43b4b36864cd8f65aa9ffa5d2ad5bdfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*So5Bao1mTwfIV3edCTBMCg.png"/></div></figure><figure class="mf mg mh mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/0797346fdcd082deb32ea4ecb0344764.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Ec53FUsjpNX5moreG1j0kw.png"/></div></figure><figure class="mf mg mh mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/8fb22cb373e38ef92da247df0c477f37.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*KAzcyPfL0Tjf6DAiHyP9Sg.png"/></div></figure></div><div class="ab cb"><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/956003defb3dec3478c42e037026e31e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*DMvCxQA58tJUk-wyv8NMPg.png"/></div></figure><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/eefbc0f71f9baeb630eb0c0ef2151816.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*2cveQsAKKQEV2p6Zd74aNQ.png"/></div></figure></div><div class="ab cb"><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/aabd123e8f09f8ab1585cd549fcfe486.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*w7U4CiDdPowH3zLXV93ZPg.png"/></div></figure><figure class="mf mg na mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/c89c1a299460295a3be9d05e5b70788c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*FFVm0f2UCcSltwliAXh3qg.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk nb di nc my translated">图片作者。</figcaption></figure></div><p id="2544" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">适合的发行版列表几乎是无止境的，您甚至可以构建自己的发行版。但是，让我们回到传统的离散分布——泊松分布和负二项分布。如你所见，<a class="ae lh" rel="noopener ugc nofollow" target="_blank" href="/power-analysis-for-categorical-data-in-sas-multinomial-ordinal-binary-binomial-beta-poisson-9398888491da">和计数数据的常见情况</a>，负二项式比泊松更适合。</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="71b1" class="ly lz in lu b gy ma mb l mc md">data("toxocara", package = "fitdistrplus")<br/>str(toxocara)<br/>ftoxo.P &lt;- fitdist(toxocara$number, "pois"))<br/>ftoxo.nb &lt;- fitdist(toxocara$number, "nbinom"))</span><span id="af0a" class="ly lz in lu b gy me mb l mc md">plot(ftoxo.P)</span><span id="59c6" class="ly lz in lu b gy me mb l mc md">cdfcomp(list(ftoxo.P, ftoxo.nb),<br/>        legendtext = c("Poisson", "negative binomial"))</span><span id="4601" class="ly lz in lu b gy me mb l mc md">gofstat(list(ftoxo.P, ftoxo.nb),<br/>        fitnames = c("Poisson","negative binomial"))</span><span id="2777" class="ly lz in lu b gy me mb l mc md">Chi-squared statistic:  31257 7.486 <br/>Degree of freedom of the Chi-squared distribution:  5 4 <br/>Chi-squared p-value:  0 0.1123 <br/>   the p-value may be wrong with some theoretical counts &lt; 5  <br/>Chi-squared table:<br/>      obscounts theo Poisson theo negative binomial<br/>&lt;= 0         14     0.009014                 15.295<br/>&lt;= 1          8     0.078237                  5.809<br/>&lt;= 3          6     1.321767                  6.845<br/>&lt;= 4          6     2.131298                  2.408<br/>&lt;= 9          6    29.827829                  7.835<br/>&lt;= 21         6    19.626224                  8.271<br/>&gt; 21          7     0.005631                  6.537</span><span id="8867" class="ly lz in lu b gy me mb l mc md">Goodness-of-fit criteria<br/>                               Poisson negative binomial<br/>Akaike's Information Criterion    1017             322.7<br/>Bayesian Information Criterion    1019             326.6</span></pre><div class="lp lq lr ls gt ab cb"><figure class="mf mg nk mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/aa4a243bfa8abd750e10dae5c09f4b9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/format:webp/1*72khVOo_8lNOL7QIqgmNQw.png"/></div></figure><figure class="mf mg nl mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/f4f685ab7d8f11a57faf839c52ab3227.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*SQT7WtrthEwiZqTxij1Kyw.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk nm di nn my translated">图片作者。</figcaption></figure></div></div><div class="ab cl li lj hr lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="ig ih ii ij ik"><p id="d16b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi ky translated">同样重要的是，让我们转向零膨胀和障碍模型。根据定义，它们是混合模型，因为它们有两个组件来处理具有单一问题(太多零)的单一分布。当计数数据有太多的0时，将不可避免地出现下降，因此你需要建立两个驼峰的模型。</p><p id="878f" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">模拟零膨胀或栅栏模型没有那么难，然后可以附加到泊松、负二项、<a class="ae lh" href="https://en.wikipedia.org/wiki/Beta-binomial_distribution" rel="noopener ugc nofollow" target="_blank">贝塔-二项</a>和<a class="ae lh" href="https://en.wikipedia.org/wiki/Beta_negative_binomial_distribution" rel="noopener ugc nofollow" target="_blank">贝塔-负二项</a>模型。</p><p id="b2da" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><a class="ae lh" href="https://en.wikipedia.org/wiki/Zero-inflated_model" rel="noopener ugc nofollow" target="_blank">零充气</a>和<a class="ae lh" href="https://en.wikipedia.org/wiki/Hurdle_model" rel="noopener ugc nofollow" target="_blank">跨栏</a>模型的区别在于:</p><ol class=""><li id="24d3" class="no np in ke b kf kg ki kj kl nq kp nr kt ns kx nt nu nv nw bi translated">零膨胀模型将模拟两个部分——零的概率和x的概率。</li><li id="88c4" class="no np in ke b kf nx ki ny kl nz kp oa kt ob kx nt nu nv nw bi translated">栅栏模型还将模拟两个部分——零概率和≠ 0概率。</li></ol><p id="f041" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">与零膨胀模型相反，栅栏模型将零计数和非零结果视为两个完全独立的类别，而不是将零计数结果视为结构零和采样零的混合。因此，在某些场景中，他们可能看起来一样，行为也一样，但他们并不相同。</p><p id="3e2f" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们用<a class="ae lh" href="https://cran.r-project.org/web/packages/iZID/index.html" rel="noopener ugc nofollow" target="_blank"> iZid </a> R软件包来模拟分析这些模型。首先，我会模拟。</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="bec7" class="ly lz in lu b gy ma mb l mc md">t1=sample.h(N=2000,phi=0.2,distri='Poisson',lambda=5)          ##hurdle poisson random values<br/>t2=sample.h(N=2000,phi=0.2,distri='nb',r=10,p=0.6)             ##hurdle negative binomial<br/>t3=sample.h(N=2000,phi=0.2,distri='bb',alpha1=8,alpha2=9,n=10) ##hurdle beta binomial<br/>t4=sample.h(N=2000,phi=0.2,distri='bnb',r=10,alpha1=8,alpha2=9)##hurdle beta negative binomial.<br/>t5=sample.zi(N=2000,phi=0.2,distri='Poisson',lambda=5)  ##zero-inflated poisson random values<br/>t6=sample.zi(N=2000,phi=0.2,distri='nb',r=10,p=0.6)   ##zero-inflated negative binomial<br/>t7=sample.zi(N=2000,phi=0.2,distri='bb',alpha1=8,alpha2=9,n=10)   ##zero-inflated beta binomial<br/>t8=sample.zi(N=2000,phi=0.2,distri='bnb',r=10,alpha1=8,alpha2=9) ##zero-inflated beta negative binomial<br/>DF&lt;-as.data.frame(cbind(t1,t2,t3,t4,t5,t6,t7,t8))</span><span id="66ff" class="ly lz in lu b gy me mb l mc md">g1&lt;-ggplot(DF)+<br/>  geom_density(aes(x=t1, fill="Hurdle Poisson"), alpha=0.5)+<br/>  geom_density(aes(x=t2, fill="Hurdle Negative-Binomial"), alpha=0.5)+<br/>  geom_density(aes(x=t3, fill="Hurdle Beta-Binomial"), alpha=0.5)+<br/>  geom_density(aes(x=t4, fill="Hurdle Beta-Negative-Binomial"), alpha=0.5)+<br/>  geom_density(aes(x=t5, fill="Zero-Inflated Poisson"), alpha=0.5)+<br/>  geom_density(aes(x=t6, fill="Zero-Inflated Negative-Binomial"), alpha=0.5)+<br/>  geom_density(aes(x=t7, fill="Zero-Inflated Beta-Binomial"), alpha=0.5)+<br/>  geom_density(aes(x=t8, fill="Zero-Inflated Beta-Negative-Binomial"), alpha=0.5)+<br/>  guides(fill=guide_legend(title="All Zero-Inflated and Hurdle Distributions"))+<br/>  theme_bw()</span><span id="1cb8" class="ly lz in lu b gy me mb l mc md">g2&lt;-ggplot(DF)+<br/>  geom_density(aes(x=t1, fill="Hurdle Poisson"), alpha=0.5)+<br/>  geom_density(aes(x=t2, fill="Hurdle Negative-Binomial"), alpha=0.5)+<br/>  geom_density(aes(x=t3, fill="Hurdle Beta-Binomial"), alpha=0.5)+<br/>  geom_density(aes(x=t4, fill="Hurdle Beta-Negative-Binomial"), alpha=0.5)+<br/>  guides(fill=guide_legend(title="All Hurdle Distributions"))+<br/>  theme_bw()</span><span id="56f2" class="ly lz in lu b gy me mb l mc md">g3&lt;-ggplot(DF)+<br/>  geom_density(aes(x=t5, fill="Zero-Inflated-Poisson"), alpha=0.5)+<br/>  geom_density(aes(x=t6, fill="Zero-Inflated-Negative-Binomial"), alpha=0.5)+<br/>  geom_density(aes(x=t7, fill="Zero-Inflated-Beta-Binomial"), alpha=0.5)+<br/>  geom_density(aes(x=t8, fill="Zero-Inflated-Beta-Negative Binomial"), alpha=0.5)+<br/>  guides(fill=guide_legend(title="All Zero-Inflated Distributions"))+<br/>  theme_bw()</span><span id="43af" class="ly lz in lu b gy me mb l mc md">grid.arrange(g1,g2,g3)</span></pre><figure class="lp lq lr ls gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi oc"><img src="../Images/def1aa5f40c238912462ba7b9575e8a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8s-1g6B4hr06TEeJi_-mRA.png"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk translated">因为我使用了相同的参数，所以不容易发现不同之处。然而，分布并不相同。图片作者。</figcaption></figure><p id="f5d7" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在，让我们采用模拟的零膨胀泊松分布(<em class="od"> t5 </em>)，拟合它，并使用基本泊松和零膨胀泊松进行分析。如你所见，零膨胀泊松做得更好，这是我所期望的。</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="6655" class="ly lz in lu b gy ma mb l mc md">t5_fit&lt;-poisson.zihmle(t5,type ="zi", lowerbound = 0.01,upperbound = 10000)<br/>dis.kstest(t5,nsim=100,bootstrap=TRUE,<br/>           distri="zip")$pvalue</span><span id="5cbe" class="ly lz in lu b gy me mb l mc md">fitp &lt;- fitdist(t5,"pois")<br/>summary(fitp)<br/>plot(fitp)</span><span id="db7c" class="ly lz in lu b gy me mb l mc md">fitzip &lt;- fitdist(t5, "ZIP", <br/>                  start=list(mu=4.9, sigma=0.9),<br/>                  lower=c(-Inf, 0.001), <br/>                  upper=c(Inf, 1), <br/>                  optim.method="L-BFGS-B")<br/>plot(fitzip)<br/>cdfcomp(list(fitzip, fitp))<br/>gofstat(list(fitzip, fitp))</span><span id="cdad" class="ly lz in lu b gy me mb l mc md">Goodness-of-fit statistics<br/>                              1-mle-ZIP  2-mle-pois<br/>Kolmogorov-Smirnov statistic  0.1875014   0.2246594<br/>Cramer-von Mises statistic   11.0954874  25.6150375<br/>Anderson-Darling statistic   74.4086567 221.9835926</span><span id="05de" class="ly lz in lu b gy me mb l mc md">Goodness-of-fit criteria<br/>                               1-mle-ZIP 2-mle-pois<br/>Akaike's Information Criterion  9023.328    10483.1<br/>Bayesian Information Criterion  9034.530    10488.7</span></pre><div class="lp lq lr ls gt ab cb"><figure class="mf mg oe mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/76c4bdd6185081423f67aa9da664d78c.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*Ae-TdwaOuWnmf5UVcjRysw.png"/></div></figure><figure class="mf mg of mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/fdc8b6d41193a2a1b3ac1fe267f6f782.png" data-original-src="https://miro.medium.com/v2/resize:fit:522/format:webp/1*UEVsFPWaj1VB83e918cLEw.png"/></div></figure><figure class="mf mg of mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><img src="../Images/187fa16cf49b24616a48dcb7f5e8a25d.png" data-original-src="https://miro.medium.com/v2/resize:fit:522/format:webp/1*JVE4YuXxJ7fWqRKV4ndopA.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk og di oh my translated">图片作者。</figcaption></figure></div><p id="199b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们再来看看一个跨栏模型！我要做的是使用<a class="ae lh" href="https://cran.r-project.org/web/packages/glmmTMB/index.html" rel="noopener ugc nofollow" target="_blank"> glmmTMB </a>软件包，拟合一个负二项式跨栏模型，和一个零膨胀泊松模型。如您所见，正如所料，跨栏模型最合适。</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="e511" class="ly lz in lu b gy ma mb l mc md">plot(density(DF$t2))<br/>t2_fit&lt;-nb.zihmle(t2,<br/>                   r=8,<br/>                   p=0.6, <br/>                   type ="h", <br/>                   lowerbound = 0.01,<br/>                   upperbound = 10000)<br/>summary(t2_fit)<br/>fit_t2_nbh &lt;- glmmTMB(t2~1,<br/>                      ziformula=~.,<br/>                      data=DF,<br/>                      family=truncated_nbinom1)<br/>summary(fit_t2_nbh)</span><span id="7832" class="ly lz in lu b gy me mb l mc md">Family: truncated_nbinom1  ( log )<br/>Formula:          t2 ~ 1<br/>Zero inflation:      ~.<br/>Data: DF</span><span id="6b56" class="ly lz in lu b gy me mb l mc md">AIC      BIC   logLik deviance df.resid <br/> 10298.3  10315.1  -5146.1  10292.3     1997</span><span id="4240" class="ly lz in lu b gy me mb l mc md">Dispersion parameter for truncated_nbinom1 family (): 0.737</span><span id="3126" class="ly lz in lu b gy me mb l mc md">Conditional model:<br/>            Estimate Std. Error z value Pr(&gt;|z|)    <br/>(Intercept)  1.90854    0.01276   149.6   &lt;2e-16 ***<br/>---<br/>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span><span id="2604" class="ly lz in lu b gy me mb l mc md">Zero-inflation model:<br/>            Estimate Std. Error z value Pr(&gt;|z|)    <br/>(Intercept) -1.44029    0.05683  -25.34   &lt;2e-16 ***<br/>---<br/>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span><span id="e06e" class="ly lz in lu b gy me mb l mc md">fit_t2_nb &lt;- glmmTMB(t2~1,<br/>                      ziformula=~1,<br/>                      data=DF,<br/>                      family=poisson)<br/>summary(fit_t2_nb)</span><span id="ead1" class="ly lz in lu b gy me mb l mc md">AICtab(fit_t2_nbh, fit_t2_nb)</span><span id="3216" class="ly lz in lu b gy me mb l mc md">dAIC  df<br/>fit_t2_nbh   0.0 3 <br/>fit_t2_nb  272.9 2</span></pre><figure class="lp lq lr ls gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi oi"><img src="../Images/f475b0428dadf1d1e898129c71ba0151.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*944fmYGA2eJYAYFkrrsFtQ.png"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk translated">图片作者。</figcaption></figure><p id="d74c" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们使用<a class="ae lh" href="https://strengejacke.github.io/sjPlot/" rel="noopener ugc nofollow" target="_blank"> sjPlot </a>包做一个更好的比较。正如你所看到的，这两种模型实际上都很合适。这也表明，仅仅在一个发行版上应用这样的模型有点矫枉过正。</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="43d7" class="ly lz in lu b gy ma mb l mc md">tab_model(fit_t2_nbh,fit_t2_nb,p.val = "kr", show.df = TRUE)</span></pre><figure class="lp lq lr ls gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi oj"><img src="../Images/70d07b571f9e0ed33ebc482fca87b511.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SqSzxWQIoUrexvb57RFNQg.png"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk translated">图片作者。</figcaption></figure><p id="4800" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我希望这被认为是一个很好的介绍混合物，组件，零膨胀和跨栏模型。现在你自己试试，如果有什么地方不对劲，请告诉我！</p></div></div>    
</body>
</html>