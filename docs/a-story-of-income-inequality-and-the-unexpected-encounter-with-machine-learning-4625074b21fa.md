# 收入不平等和意外遇到机器学习的故事

> 原文：<https://blog.devgenius.io/a-story-of-income-inequality-and-the-unexpected-encounter-with-machine-learning-4625074b21fa?source=collection_archive---------11----------------------->

阅读[之前的帖子](https://abrahamzetz.medium.com/diving-back-into-sql-world-d8ef569e9d8d)了解我回归编程世界的故事。

在带领我们参加了为期 5 天的 SQL 训练营后，我们的*行业领袖* [Andrea Scaringello](https://andreascaringello.com/) 邀请我们两人一组进行一个独立项目。在这个项目中，我们可以使用任何我们喜欢的数据集，并呈现任何我们想要的东西。这是一件随心所欲的事情。

我和我的朋友 Joyce Zheng 一起担任了一周的班级代表，并一起参加了训练营的练习，我感觉到了一种良好的联系，并请她继续一起工作。她接受了我的邀请，我们开始研究收入不平等数据集。

![](img/c14a4310dfb052e17aead3e0cd2ef1b8.png)

照片由 [Josh Appel](https://unsplash.com/@joshappel?utm_source=medium&utm_medium=referral) 在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

收入不平等是富人和其他人之间的收入差距，正式名称为*基尼指数*，指数越高，差距越大。以前曾有分析检验收入不平等和 GDP 之间的相关性，但他们发现两者之间只有微弱的负相关。

我们非常渴望，带着这个问题出发了:

> 收入不平等是否与其他不那么明显的指标相关？

我们使用以下四个假设来探索收入不平等是否与幸福指数、预期寿命和生育率相关:

1.  发达国家比例较高的大陆收入不平等程度较低
2.  收入不平等程度较低的国家更有可能拥有较高的预期寿命
3.  收入不平等程度较低的国家更有可能拥有较高的幸福指数
4.  低收入不平等的国家更有可能出现低生育率

以下是我们使用的数据集:

*   来自 [Gapminder](https://www.gapminder.org/data/) 的基尼指数和生育率
*   从[到](https://www.kaggle.com/kumarajarshi/life-expectancy-who)的预期寿命
*   来自 [Kaggle](https://www.kaggle.com/unsdsn/world-happiness) 的世界幸福报告

下载完。csv 文件，我们查看了数据，了解到了非常重要的东西。 ***数据集可以很乱！*** 尤指来自各种渠道的。与国家打交道的一个典型例子是国名。在一个数据集上，一个国家被称为“刚果民主共和国”，在另一个数据集上被称为“刚果民主共和国”，在另一个数据集上被称为“刚果-金沙萨”。由于没有国家代码出现在任何数据集中，我们别无选择，只能手动清理。我们还通过谷歌搜索手动添加了大洲。这就是数据分析师的生活。

在我们清理完数据之后，一个新的挑战出现了。我们必须想办法把我们的。csv 数据集到 SQLite 数据库。利用我 8 年没有编程经验的生锈的大脑，Andrea 的 Google Colab，以及大量的谷歌搜索，我成功地解决了这个问题。还有，原来好多同学也在纠结这部分，所以我决定做个教程。

现在，这是我第一次尝试使用 Python——因为我在大学时主要使用 Java 和 C 系列。它当然可以更有效，但我当时不知道有什么更好的，所以这就是我写的。

随着数据存储在数据库中，我们开始做我们的分析。使用 SQL 查询，我们计算出了各大洲的基尼指数与全球平均值的差异。

![](img/0b421e1354f78c1dd1ec9efb4799d15f.png)

查询输出

![](img/02c3c146d80d78a9bda861c7a006a3a5.png)

使用 Microsoft Excel 可视化输出

根据 Andrea 的输入，我们知道平均值可能会产生误导，因为可能会有一个异常值将平均值拉伸到远离大多数数据点的位置。他建议我们做一个箱线图，看看数据是如何分布的。同样，通过大量的谷歌搜索，我设法弄清楚了如何在 Python 上使用 matplotlib 来绘制一个方框图。然而，代码效率太低，所以如果你感兴趣，我就把链接[放在这里](https://github.com/abrahamzetz/hi_mod4_inequality/blob/main/Project_4_Inequality.ipynb)。

![](img/fbf7b3781090f542c2c1db28446f75ee.png)

从盒子图可以看出，北美和非洲的标准差很大，意味着不能真正相信均值。

最后，我们在 datawrapper 中总结了我们的发现，以回答我们的第一个假设:*发达国家比例较高的大陆收入不平等程度较低。*事实证明，这一假设只适用于基尼系数最低、发达国家比例最高的欧洲。其他大陆并不遵循同样的假设。

对于其余的假设，回归似乎是唯一的出路。SQL 根本不是用来做这件事的，所以我们必须用一种更强大的编程语言来做，而 Python 似乎就是答案。然而，我们对 Python 不够熟悉，无法解决这个问题。简单地搜索代码而不理解任何东西对我的学习之旅也没有太大帮助，所以我们决定加强我们的游戏。幸运的是，Hyper 与 [DataCamp](https://www.datacamp.com/) 有合作关系，在那里我们可以学习专门为数据相关职业定制的编码。

乔伊斯开始建议一些课程，可以帮助我们做到这一点，但这些课程有先决条件，这些先决条件有其他先决条件。我尝试直接跳到 Python 课程中的[回归与 statsmodels 简介，结果在第二个练习中放弃了。于是，我开始了我的数据营狂欢，做所有的先决条件，以便能够完成测试我们的假设所需的课程。](https://app.datacamp.com/learn/courses/introduction-to-regression-with-statsmodels-in-python)

最后，我们想出了这个:

第一个代码片段显示图表，第二个代码片段显示回归的统计摘要。现在，我可以写代码了，但是我仍然很难理解如何阅读结果。幸运的是，乔伊斯有统计学背景，她教会了我术语的含义以及如何解读结果。

就基尼指数和预期寿命而言，图表和统计摘要显示了具有统计意义的微弱负相关。因此，我们可以假设第二个假设是正确的。

![](img/ad8ef3b9ff8f654273d2526e277cd259.png)

用同样的方法，我们发现第三和第四个假设也成立。

![](img/754ab3b70b07838a86d191bffa5e1e65.png)![](img/dfe80ec7adff81c7fa9424d8a97e894d.png)

做完所有的假设后，我们认为还剩一周时间。然而，Andrea 挑战我们写一个机器学习代码。乔伊斯和我很紧张，认为机器学习远远超出了我们的能力，但安德里亚告诉我们，这只是延伸了一点点。在谷歌和 binging DataCamp 了一些以后，我们终于能够做出我们的第一个预测代码:

代码起作用了！使用 matplotlib，我们可视化了特定国家的预测和实际基尼指数。虽然代码可以工作，但是模型非常糟糕，只有 5%的准确性。

![](img/43a0eed6e30f3aba61daf43502dfc15b.png)

然后我们明白了不是代码有问题，而是代码背后的逻辑有问题。预期寿命、幸福指数和生育率都不是收入不平等的正确预测指标。然而，这些数据集似乎可以很好地预测预期寿命。我们将教育水平加入到预测因子中，对预期寿命进行预测，得到了准确率为 79%的模型。

![](img/26bbfbbffcb5c47fca34a39bcb275dc1.png)

从我们的项目中，我学到了很多东西，我总结为以下三点:

1.  相关性并不意味着因果关系。有很多因素可以导致某些事情，重要的是不要妄下结论。
2.  机器学习不是魔术，只是因为指标显示了一些相关性并不意味着模型会很好。换句话说，糟糕的输入会导致糟糕的输出。
3.  确定要预测的数据和用作预测器的数据是增加建立好模型的机会的关键。

谢谢你一直读到最后。你可以在我的 [Github](https://github.com/abrahamzetz/hi_mod4_inequality) 上找到这个项目的代码。

郑队加油！

![](img/e0f4c0b8b5a3d37cd0c76d7db4b4556d.png)