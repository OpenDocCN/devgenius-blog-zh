<html>
<head>
<title>How To Use Your Mobile Camera With Streamlit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何通过 Streamlit 使用您的手机摄像头</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-use-your-mobile-camera-with-streamlit-546b8de35404?source=collection_archive---------7-----------------------#2022-06-26">https://blog.devgenius.io/how-to-use-your-mobile-camera-with-streamlit-546b8de35404?source=collection_archive---------7-----------------------#2022-06-26</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="8f0d" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">一个专业黑客为您的 ML 演示</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/a93618357920cd7baa879c68efba0c8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LuH6U77memRUCxxq"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">照片由<a class="ae ks" href="https://unsplash.com/@frostroomhead?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Rodion Kutsaev </a>在<a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><blockquote class="kt ku kv"><p id="bf5b" class="kw kx ky kz b la lb jo lc ld le jr lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">与培训和优化相比，制作 ML 演示很无聊。</p></blockquote><p id="c547" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf lt lh li lj lu ll lm ln lv lp lq lr ls ig bi translated">在我的一个简历项目中，我不得不使用便携式 USB 网络摄像头，而不是笔记本电脑的内置摄像头。我用<code class="fe lw lx ly lz b">cv2.VideoCapture</code>从笔记本电脑的摄像头中获取画面，工作得非常好。当我尝试使用 OpenCV 的 USB 摄像头时，即使在<code class="fe lw lx ly lz b">cv2.VideoCapture( &lt;index&gt; )</code>中更改索引后，它也无法检测到摄像头。</p><p id="5b69" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf lt lh li lj lu ll lm ln lv lp lq lr ls ig bi translated">在分析了一些 SO 的问题和答案后，我觉得没有一种“干净”的方式将 USB 摄像头与 OpenCV 连接起来。接下来，我试图寻找一些方法，将我的手机用作便携式相机，并以某种方式(可能使用 WIFI 或蓝牙)将图像传输到我的笔记本电脑上，我在 Quora 上找到了这个极好的答案。</p><div class="ma mb gp gr mc md"><a href="https://www.quora.com/How-can-I-connect-my-phone-camera-or-USB-camera-in-OpenCV-Python" rel="noopener  ugc nofollow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd io gy z fp mi fr fs mj fu fw im bi translated">如何在 OpenCV Python 中连接手机摄像头或 USB 摄像头？</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">回答(第 1 题，共 3 题):我使用下面的代码和 ipwebcam 应用程序将 adroid 与 opencv python 连接起来</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">www.quora.com</p></div></div><div class="mm l"><div class="mn l mo mp mq mm mr km md"/></div></div></a></div><h1 id="502d" class="ms mt in bd mu mv mw mx my mz na nb nc jt nd ju ne jw nf jx ng jz nh ka ni nj bi translated">黑客 1</h1><p id="f293" class="pw-post-body-paragraph kw kx in kz b la nk jo lc ld nl jr lf lt nm li lj lu nn lm ln lv no lq lr ls ig bi translated">破解很简单，</p><blockquote class="np"><p id="3219" class="nq nr in bd ns nt nu nv nw nx ny ls dk translated">使用 IP 网络摄像头应用程序将图像流式传输到本地服务器(由应用程序启动)，然后 Python 脚本从本地服务器获取图像并在 Streamlit 应用程序中显示。</p></blockquote><p id="f8d8" class="pw-post-body-paragraph kw kx in kz b la nz jo lc ld oa jr lf lt ob li lj lu oc lm ln lv od lq lr ls ig bi translated">首先，从谷歌 Play 商店安装<a class="ae ks" href="https://play.google.com/store/apps/details?id=com.pas.webcam" rel="noopener ugc nofollow" target="_blank"> IP 网络摄像头应用程序，并选择视频流所需的设置(分辨率、摄像头、FPS 等。).在右上角，点击菜单并选择“启动服务器”。</a></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oe"><img src="../Images/9697c3080c985c2e6500abbae92b4e9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UmFgKDiDm9gUlETUOq-MMg.jpeg"/></div></div></figure><p id="7a19" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf lt lh li lj lu ll lm ln lv lp lq lr ls ig bi translated">该应用程序将在给定的地址启动一个服务器，</p><pre class="kd ke kf kg gt of lz og oh aw oi bi"><span id="3bf3" class="oj mt in lz b gy ok ol l om on">http:&lt;network_ip_address&gt;:&lt;port&gt;</span></pre><p id="3207" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf lt lh li lj lu ll lm ln lv lp lq lr ls ig bi translated">一旦你在你的计算机浏览器中导航到上述 URL，你会发现这个页面，</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oo"><img src="../Images/33e27b11783552395419ef4e68bd0d49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D6AKc5VsJVKZ5WRgvs5PiQ.png"/></div></div></figure><p id="6917" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf lt lh li lj lu ll lm ln lv lp lq lr ls ig bi translated">点击拍照或对焦拍照按钮，它将从手机的相机中捕捉当前帧并存储在<code class="fe lw lx ly lz b">http:&lt;network_ip_address&gt;:&lt;port&gt;/photo.jpg</code>中。我们可以向这个 URL 发出一个<code class="fe lw lx ly lz b">GET</code>请求，并获取那个相机帧。在下图中，我们使用 Postman 来发出这样的请求。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi op"><img src="../Images/ea42c66fe5920ce9f1a6af1587e3944b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6JkQXOLx-CgEd8GfdY6lAA.png"/></div></div></figure><h2 id="d716" class="oj mt in bd mu oq or dn my os ot dp nc lt ou ov ne lu ow ox ng lv oy oz ni pa bi translated">Streamlit 应用</h2><p id="4a8b" class="pw-post-body-paragraph kw kx in kz b la nk jo lc ld nl jr lf lt nm li lj lu nn lm ln lv no lq lr ls ig bi translated">由于我们现在有了获取相机帧的方法，我们将专注于构建 Streamlit 应用程序。Streamlit 是一个超级有用的框架，可以帮助你用 Python 构建 UI 应用，可以用来制作快速演示或界面。</p><p id="8adb" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf lt lh li lj lu ll lm ln lv lp lq lr ls ig bi translated">我们首先创建一个空的图像容器来保存从服务器获取的帧，</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="pb pc l"/></div></figure><p id="fac9" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf lt lh li lj lu ll lm ln lv lp lq lr ls ig bi translated">接下来，我们将创建一个从服务器请求帧并在<code class="fe lw lx ly lz b">frame_window</code>中显示它的循环。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="pb pc l"/></div></figure><p id="8bf6" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf lt lh li lj lu ll lm ln lv lp lq lr ls ig bi translated">我们可以使用<code class="fe lw lx ly lz b">streamlit run main.py</code>运行这个应用程序，其中<code class="fe lw lx ly lz b">main.py</code>是您的脚本的名称。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi pd"><img src="../Images/999ab25591bbffc699ef2bbe4952b505.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E91wzJU5t9Eoq_6AJaY4vw.png"/></div></div></figure><p id="6548" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf lt lh li lj lu ll lm ln lv lp lq lr ls ig bi translated">我们还可以添加一个“拍照”按钮来冻结相机和存储帧。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="pb pc l"/></div></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi pe"><img src="../Images/068ecc000a58f99b21827aba95aaf27b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*APuQmLYPqDscVY5DR7bIAg.png"/></div></div></figure><h1 id="eeea" class="ms mt in bd mu mv mw mx my mz na nb nc jt nd ju ne jw nf jx ng jz nh ka ni nj bi translated">黑客 2</h1><p id="070c" class="pw-post-body-paragraph kw kx in kz b la nk jo lc ld nl jr lf lt nm li lj lu nn lm ln lv no lq lr ls ig bi translated">第二次攻击类似于第一次攻击，但我们使用了 IP 网络摄像头提供的另一个功能。前往<code class="fe lw lx ly lz b">http:&lt;network_ip_address&gt;:&lt;port&gt;</code>并进入<em class="ky">其他观看方法&gt;高级</em>并向下滚动到<em class="ky">高级</em>部分。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi pf"><img src="../Images/3bc878e0f172da2afb2fdd00768db73a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*190bChFjEyCCl1gcjjs1Ng.png"/></div></div></figure><p id="df0a" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf lt lh li lj lu ll lm ln lv lp lq lr ls ig bi translated">观察映射到一个<a class="ae ks" href="https://en.wikipedia.org/wiki/Motion_JPEG" rel="noopener ugc nofollow" target="_blank"> MJPEG 相机</a>的第一个 URL。快速的谷歌搜索告诉我们，</p><blockquote class="kt ku kv"><p id="12f3" class="kw kx ky kz b la lb jo lc ld le jr lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">MJPEG URL-&gt; URL 由摄像机的 IP 地址组成，后面是摄像机供应商定义的资源名称，如 video.mjpeg 或 mjpg.cgi。</p></blockquote><p id="ed49" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf lt lh li lj lu ll lm ln lv lp lq lr ls ig bi translated">接下来，我们需要从这个 URL 读取视频流。这个关于 SO 的答案给了我们一个清晰的方法，</p><div class="ma mb gp gr mc md"><a href="https://stackoverflow.com/a/36675148/13546426" rel="noopener  ugc nofollow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd io gy z fp mi fr fs mj fu fw im bi translated">如何从 ip 摄像头解析 mjpeg http 流？</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">import cv2 import urllib import numpy as NP stream = urllib . urlopen(' http://localhost:8080/frame . mjpg ')bytes = ' '…</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">stackoverflow.com</p></div></div><div class="mm l"><div class="pg l mo mp mq mm mr km md"/></div></div></a></div><p id="98e8" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf lt lh li lj lu ll lm ln lv lp lq lr ls ig bi translated">在代码中，</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="pb pc l"/></div></figure><p id="ae4f" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf lt lh li lj lu ll lm ln lv lp lq lr ls ig bi translated">运行代码，您会注意到不同之处！</p><h1 id="092e" class="ms mt in bd mu mv mw mx my mz na nb nc jt nd ju ne jw nf jx ng jz nh ka ni nj bi translated">仅此而已！</h1><p id="a91a" class="pw-post-body-paragraph kw kx in kz b la nk jo lc ld nl jr lf lt nm li lj lu nn lm ln lv no lq lr ls ig bi translated">这是一个简短的周日阅读，可以帮助 Streamlit 带来一些新的东西。希望你喜欢黑客！祝你有美好的一天。</p></div></div>    
</body>
</html>