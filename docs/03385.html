<html>
<head>
<title>Vue 3 — Props Data Flow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Vue 3 — Props 数据流</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/vue-3-props-data-flow-2a03840a4197?source=collection_archive---------4-----------------------#2020-10-28">https://blog.devgenius.io/vue-3-props-data-flow-2a03840a4197?source=collection_archive---------4-----------------------#2020-10-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/dbc1892b9899216199eae0650a08296c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZCr6G0IP6iXOluex"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://unsplash.com/@franckinjapan?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Franck V. </a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="8097" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> Vue 3 处于测试阶段，可能会有变化。</strong></p><p id="d5d1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vue 3 是 Vue 前端框架的最新版本。</p><p id="1584" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它建立在 Vue 2 的普及性和易用性之上。</p><p id="577f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇文章中，我们将看看如何使用 Vue 3 的道具。</p><h1 id="026e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">单向数据流</h1><p id="2606" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">道具在父组件和子组件之间有一个单向向下绑定。</p><p id="ea95" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当父属性更新时，更新通过 props 传递给子属性。</p><p id="27dc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这可以防止子组件意外改变父组件的状态。</p><p id="9648" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这使得我们的应用程序更容易理解。</p><p id="cc76" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们不应该改变道具。</p><p id="46d7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们需要改变它们的值，那么我们应该先给它们分配一个新的属性。</p><p id="c991" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，如果我们需要改变用道具值设置的初始值的值，那么我们应该首先把它分配给一个状态。</p><p id="d3e3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们应该写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="d71c" class="mn lc iq mj b gy mo mp l mq mr">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;App&lt;/title&gt;<br/>    &lt;script src="https://unpkg.com/vue@next"&gt;&lt;/script&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="app"&gt;<br/>      &lt;counter :initial-count="5"&gt;&lt;/counter&gt;<br/>    &lt;/div&gt;<br/>    &lt;script&gt;<br/>      const app = Vue.createApp({});</span><span id="ea85" class="mn lc iq mj b gy ms mp l mq mr">      app.component("counter", {<br/>        props: ["initialCount"],<br/>        data() {<br/>          return {<br/>            count: this.initialCount<br/>          };<br/>        },<br/>        template: `<br/>          &lt;div&gt;<br/>            &lt;button @click='count++'&gt;increment&lt;/button&gt;<br/>            &lt;p&gt;{{count}}&lt;/p&gt;<br/>          &lt;/div&gt;<br/>        `<br/>      });</span><span id="940d" class="mn lc iq mj b gy ms mp l mq mr">      app.mount("#app");<br/>    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="f4cb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有<code class="fe mt mu mv mj b">initialCount</code>属性，我们用它来设置<code class="fe mt mu mv mj b">counter</code>组件中<code class="fe mt mu mv mj b">count</code>状态的初始值。</p><p id="ae7f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那我们就可以随心所欲了。</p><p id="fb76" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果值需要转换，那么我们可以将它作为计算属性放入。</p><p id="c101" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="234a" class="mn lc iq mj b gy mo mp l mq mr">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;App&lt;/title&gt;<br/>    &lt;script src="https://unpkg.com/vue@next"&gt;&lt;/script&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="app"&gt;<br/>      &lt;counter :initial-count="5"&gt;&lt;/counter&gt;<br/>    &lt;/div&gt;<br/>    &lt;script&gt;<br/>      const app = Vue.createApp({});</span><span id="3ada" class="mn lc iq mj b gy ms mp l mq mr">      app.component("counter", {<br/>        props: ["initialCount"],<br/>        data() {<br/>          return {<br/>            count: this.initialCount<br/>          };<br/>        },<br/>        computed: {<br/>          doubleCount() {<br/>            return this.count * 2;<br/>          }<br/>        },<br/>        template: `<br/>          &lt;div&gt;<br/>            &lt;button @click='count++'&gt;increment&lt;/button&gt;<br/>            &lt;p&gt;{{doubleCount}}&lt;/p&gt;<br/>          &lt;/div&gt;<br/>        `<br/>      });</span><span id="001d" class="mn lc iq mj b gy ms mp l mq mr">      app.mount("#app");<br/>    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="f7b9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有<code class="fe mt mu mv mj b">initial-count</code>道具，通过返回<code class="fe mt mu mv mj b">this.count * 2</code>转化为<code class="fe mt mu mv mj b">doubleCount</code>。</p><p id="60f0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们不必对属性值本身做任何事情。</p><p id="7c12" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们只需在<code class="fe mt mu mv mj b">data</code>方法和<code class="fe mt mu mv mj b">counter</code>组件的 computed 属性中将状态更改为我们想要的状态。</p><h1 id="6658" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">正确验证</h1><p id="5b24" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过检查数据类型等来验证 props。</p><p id="9bed" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将<code class="fe mt mu mv mj b">props</code>属性的值设置为一个构造函数。</p><p id="8b09" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">或者我们可以用一个函数来验证它。</p><p id="3150" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="7086" class="mn lc iq mj b gy mo mp l mq mr">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;App&lt;/title&gt;<br/>    &lt;script src="https://unpkg.com/vue@next"&gt;&lt;/script&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="app"&gt;<br/>      &lt;blog-post v-for="post of posts"&gt;&lt;/blog-post&gt;<br/>    &lt;/div&gt;<br/>    &lt;script&gt;<br/>      const app = Vue.createApp({<br/>        data() {<br/>          return {<br/>            posts: [{ author: "james", likes: 100 }]<br/>          };<br/>        }<br/>      });<br/>      app.component("blog-post", {<br/>        props: {<br/>          title: {<br/>            type: String,<br/>            default: "default title"<br/>          }<br/>        },<br/>        template: `&lt;p&gt;{{title}}&lt;/p&gt;`<br/>      });<br/>      app.mount("#app");<br/>    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="cad7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们会显示“默认标题”文本，因为我们从未将值传递给<code class="fe mt mu mv mj b">title</code>属性。</p><p id="5f56" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">default</code>有默认值。</p><p id="8682" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">validator</code>具有道具验证器功能。</p><p id="325f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="558f" class="mn lc iq mj b gy mo mp l mq mr">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;App&lt;/title&gt;<br/>    &lt;script src="https://unpkg.com/vue@next"&gt;&lt;/script&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="app"&gt;<br/>      &lt;blog-post v-for="post of posts" type="news"&gt;&lt;/blog-post&gt;<br/>    &lt;/div&gt;<br/>    &lt;script&gt;<br/>      const app = Vue.createApp({<br/>        data() {<br/>          return {<br/>            posts: [{ author: "james", likes: 100 }]<br/>          };<br/>        }<br/>      });<br/>      app.component("blog-post", {<br/>        props: {<br/>          type: {<br/>            validator(value) {<br/>              return ["news", "announcement"].indexOf(value) !== -1;<br/>            }<br/>          }<br/>        },<br/>        template: `&lt;p&gt;{{type}}&lt;/p&gt;`<br/>      });<br/>      app.mount("#app");<br/>    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="49ae" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为<code class="fe mt mu mv mj b">type</code>属性添加一个验证器。</p><p id="0d9d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我们传入具有给定名称的道具时，就会运行<code class="fe mt mu mv mj b">validator</code>方法。</p><p id="5940" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">value</code>是我们传入的值。</p><p id="268c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以如果我们传入除了<code class="fe mt mu mv mj b">'new'</code>或<code class="fe mt mu mv mj b">'announcement'</code>之外的东西，比如:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="9419" class="mn lc iq mj b gy mo mp l mq mr">&lt;blog-post v-for="post of posts" type="foo"&gt;&lt;/blog-post&gt;</span></pre><p id="83bb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们会得到警告。</p><p id="a3ee" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还可以添加<code class="fe mt mu mv mj b">required</code>属性并将其设置为<code class="fe mt mu mv mj b">true</code>来制作所需的道具，如下所示:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="2eb6" class="mn lc iq mj b gy mo mp l mq mr">prop: {<br/>  type: String,<br/>  required: true<br/>}</span></pre><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/2e0c1a754b60c11b5a01728cdd8bc2e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_n72ZgXIzaPuOGCW"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@brett_jordan?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">布雷特·乔丹</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><h1 id="77c4" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="3972" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用构造函数和验证函数来验证 props。</p><p id="eb41" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以添加<code class="fe mt mu mv mj b">default</code>属性来设置道具的默认值。</p></div></div>    
</body>
</html>