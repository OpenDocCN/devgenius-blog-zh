<html>
<head>
<title>Search and filter data using React Hooks and a headless CMS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 React 钩子和一个无头 CMS 搜索和过滤数据</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/search-and-filter-data-using-react-hooks-and-a-headless-cms-806ce55de729?source=collection_archive---------12-----------------------#2022-08-04">https://blog.devgenius.io/search-and-filter-data-using-react-hooks-and-a-headless-cms-806ce55de729?source=collection_archive---------12-----------------------#2022-08-04</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/5b64b8764edd0db3cbca7b7c13a586a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*jUJszSj1s3jorn9wJznpwA.gif"/></div></div></figure><p id="402c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">搜索和过滤数据是网站和应用程序的常见功能，尤其是电子商务。在本文中，我们将讨论如何使用 React 为产品构建搜索和过滤功能。产品数据将从一个<a class="ae kt" href="https://www.cosmicjs.com/headless-cms" rel="noopener ugc nofollow" target="_blank">无头 CMS </a> ( <a class="ae kt" href="https://www.cosmicjs.com/" rel="noopener ugc nofollow" target="_blank">宇宙</a>)中查询，UI 即时更新。我们还将讨论去抖动技术如何使用钩子和 API 使用优化来处理状态管理。</p><h1 id="6223" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">安装模板演示内容</h1><p id="9557" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated">从这个例子开始，安装<a class="ae kt" href="https://www.cosmicjs.com/apps/unft-marketplace" rel="noopener ugc nofollow" target="_blank"> uNFT Marketplace </a>模板，其中包括我们将用于搜索和过滤功能的演示内容。或者您可以跳过这一步，直接按照代码进行操作。</p><ol class=""><li id="d474" class="lx ly in jx b jy jz kc kd kg lz kk ma ko mb ks mc md me mf bi translated">登录你的<a class="ae kt" href="https://app.cosmicjs.com/login" rel="noopener ugc nofollow" target="_blank">宇宙账号</a>。</li><li id="943f" class="lx ly in jx b jy mg kc mh kg mi kk mj ko mk ks mc md me mf bi translated">转到<a class="ae kt" href="https://www.cosmicjs.com/apps/unft-marketplace" rel="noopener ugc nofollow" target="_blank"> uNFT 市场</a>并点击“选择模板”。</li><li id="f962" class="lx ly in jx b jy mg kc mh kg mi kk mj ko mk ks mc md me mf bi translated">按照步骤创建一个新的项目和 Bucket，并导入演示内容。</li><li id="0c72" class="lx ly in jx b jy mg kc mh kg mi kk mj ko mk ks mc md me mf bi translated">查看现在安装在您的铲斗中的演示内容。</li><li id="644d" class="lx ly in jx b jy mg kc mh kg mi kk mj ko mk ks mc md me mf bi translated">转到 Products 并注意包含我们将用于 React 搜索/过滤特性的数据的元字段。</li></ol><figure class="mm mn mo mp gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ml"><img src="../Images/e6561ca4b8c38f4dbf6f97c9fed1b4c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*21k5wHGWPur55wcv"/></div></div></figure><h1 id="45e7" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">创建搜索/过滤反应应用程序</h1><p id="d19c" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated">为了让事情变得更简单，我们已经在<a class="ae kt" href="https://stackblitz.com/edit/react-search-filter-cms?file=src%2FApp.js" rel="noopener ugc nofollow" target="_blank"> StackBlitz </a>上构建了一个具有搜索/过滤功能的小应用。</p><figure class="mm mn mo mp gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ml"><img src="../Images/1e09d7738c793a0d15a053da2178bbcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TJvY8TxBtZv9y3xC"/></div></div></figure><p id="eb03" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">使用 Cosmic API，我们可以根据搜索标准过滤产品结果。现在让我们看看它是如何工作的。</p><h1 id="fde9" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">创建搜索/过滤查询</h1><p id="142d" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated">为了在我们的特性中过滤产品，我们需要向 Cosmic API 发送一个请求，以便只获取符合搜索标准的产品。我们将使用<a class="ae kt" href="https://docs.cosmicjs.com/api-reference/queries" rel="noopener ugc nofollow" target="_blank">宇宙查询</a>来做到这一点。</p><p id="2512" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了创建查询，我们创建一个对象<code class="fe mq mr ms mt b">query</code>，其属性与我们正在搜索的对象元数据值相匹配，如<code class="fe mq mr ms mt b">color</code>、<code class="fe mq mr ms mt b">price</code>和<code class="fe mq mr ms mt b">categories</code>。</p><figure class="mm mn mo mp gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ml"><img src="../Images/23440f12dc27066be3ada22b2a2dbeab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pyuBWw1EdSJ1LdU0.png"/></div></div></figure><p id="d0c3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">下面是一个带有注释的示例，解释了每个查询属性的作用。</p><figure class="mm mn mo mp gt jo"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="f80c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在我们建立我们的查询之后，我们使用<code class="fe mq mr ms mt b">getObjects</code>方法将查询发送到<a class="ae kt" href="https://www.npmjs.com/package/cosmicjs" rel="noopener ugc nofollow" target="_blank">宇宙 NPM 模块</a>。我们使用<code class="fe mq mr ms mt b">props</code>将响应限制为我们需要的属性。这里有一个实现的例子。</p><figure class="mm mn mo mp gt jo"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="7415" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在让我们深入了解 React 如何使用钩子处理 UI 状态更新的细节。</p><h1 id="8e8c" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">反应钩</h1><p id="7953" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated">React 使用单向数据流，将数据从父组件传递到子组件，钩子允许功能组件访问状态。对于输入字段的每次搜索和过滤更新，我们使用状态钩子<code class="fe mq mr ms mt b">useState</code>向 React 应用程序添加状态。</p><figure class="mm mn mo mp gt jo"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="76fd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了在网页上显示过滤后的数据，我们映射到<code class="fe mq mr ms mt b">filterResult</code> <br/>数组，并显示适当的产品列表。</p><figure class="mm mn mo mp gt jo"><div class="bz fp l di"><div class="mu mv l"/></div></figure><figure class="mm mn mo mp gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ml"><img src="../Images/967423c11827377af1536e4b01ef00da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*p1BTLPj3mZer-a36.gif"/></div></div></figure><h1 id="da92" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">使用反作用自定义挂钩反作用</h1><p id="1aeb" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated">当用户在输入框中输入一些内容时，<code class="fe mq mr ms mt b">search</code>变量的状态将会更新。为了改善搜索和过滤体验，我们将创建一个<a class="ae kt" href="https://www.w3schools.com/react/react_customhooks.asp" rel="noopener ugc nofollow" target="_blank"> React 自定义钩子</a> <code class="fe mq mr ms mt b">useDebounce</code>。</p><p id="9963" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">此挂钩支持去抖，可清除任何快速变化的值。当在指定时间段内没有调用<code class="fe mq mr ms mt b">useDebounce</code>挂钩时，去抖动值将仅反映最新值。当与<code class="fe mq mr ms mt b">useEffect</code>结合使用时，您可以确保不会过于频繁地执行像 API 调用这样的昂贵操作。</p><figure class="mm mn mo mp gt jo"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="d41d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">下面的例子允许您搜索 Cosmic API，并使用<code class="fe mq mr ms mt b">useDebounce</code>来防止 API 调用在每次击键时被触发。我们的目标只是让 API 在用户停止输入的时候调用，所以我们不会很快使用 Cosmic API。</p><figure class="mm mn mo mp gt jo"><div class="bz fp l di"><div class="mu mv l"/></div></figure><h1 id="e2dc" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">结论</h1><p id="bc36" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated">搜索和过滤是许多网站和应用程序的常见功能，但构建起来可能会很有挑战性。但是通过使用正确的工具和技术，最终用户可以更容易、更愉快地构建这个特性。</p><p id="b670" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在本文中，我们向您展示了如何使用 Cosmic 查询、React 钩子和反跳来创建出色的搜索和过滤体验。本文中解释的例子都是<a class="ae kt" href="https://www.cosmicjs.com/articles/build-a-digital-art-marketplace-with-nextjs-cosmic-and-stripe" rel="noopener ugc nofollow" target="_blank"> uNFT Marketplace 应用程序模板</a>的一部分。你可以在这里观看完整的演示<a class="ae kt" href="https://unft-marketplace-cosmicjs.vercel.app/" rel="noopener ugc nofollow" target="_blank">，在你的宇宙仪表盘中安装</a><a class="ae kt" href="https://www.cosmicjs.com/apps/unft-marketplace" rel="noopener ugc nofollow" target="_blank">应用模板</a>，或者克隆<a class="ae kt" href="https://github.com/cosmicjs/unft-marketplace" rel="noopener ugc nofollow" target="_blank"> GitHub 库</a>。要了解更多关于宇宙查询的信息，请访问<a class="ae kt" href="https://docs.cosmicjs.com/api-reference/queries" rel="noopener ugc nofollow" target="_blank">宇宙文档</a>。</p><p id="2952" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果你有任何关于宇宙整合和特性的问题，你可以在<a class="ae kt" href="https://twitter.com/cosmicjs" rel="noopener ugc nofollow" target="_blank"> Twitter </a>、<a class="ae kt" href="https://cosmicslack.herokuapp.com/" rel="noopener ugc nofollow" target="_blank"> Slack </a>上联系他们，或者关注<a class="ae kt" href="https://www.youtube.com/cosmicjs" rel="noopener ugc nofollow" target="_blank"> YouTube 频道</a>。</p></div></div>    
</body>
</html>