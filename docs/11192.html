<html>
<head>
<title>Make your own RStudio project template</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">制作您自己的 RStudio 项目模板</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/make-your-own-rstudio-project-template-1f77c4888e79?source=collection_archive---------2-----------------------#2022-12-24">https://blog.devgenius.io/make-your-own-rstudio-project-template-1f77c4888e79?source=collection_archive---------2-----------------------#2022-12-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="da84" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如何确保团队中的每个人都使用相同的蓝图。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/6c609fa612ecca9f26b467ee2bd9d11a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1q1wl5ntMDbyL9V_r7QdRw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">自定义 RStudio 项目模板。图片由作者提供。</figcaption></figure><p id="f871" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我最喜欢的 R 包之一是<code class="fe lb lc ld le b">golem</code>。只需几次点击，你就可以为你闪亮的应用程序创建一个可复制的起点。使用像<code class="fe lb lc ld le b">golem</code>这样的框架在团队中很重要:它确保每个开发人员从相同的蓝图开始。</p><p id="6c99" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">作为一名顾问，我与无数的团队合作过，每个团队的每个开发人员都以自己的方式工作。这在由分析师而不是传统开发人员组成的团队中尤其如此。虽然在某些情况下这是可以接受的，但这使得团队成员之间更难分担工作。</p><p id="2fb0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如何才能使我们的 R 项目标准化？答案取决于你做什么。如果你用闪亮，那就用<code class="fe lb lc ld le b">golem</code>。如果你开发一个包，那么你的工作流的结构是由一个<a class="ae lf" href="https://medium.com/@adrian.joseph/set-up-r-for-success-b12288afc704" rel="noopener"> R 包</a>的标准设计定义的。</p><p id="286c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是，如果您有一个 R Markdown 报告的定制结构，并希望用作所有数据分析项目的参考，该怎么办呢？您可以将它存储在一个共享文件夹中，让您的开发人员从那里访问它。你可以有一个专门的回购来分叉。但是您也可以从<code class="fe lb lc ld le b">golem</code>复制并创建自己的 RStudio 项目模板。</p><p id="5438" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用 RStudio 项目模板的想法并不新鲜。RStudio 从 1.1 版本开始就支持自定义模板。然而，我只是最近才看到它们的实际实现。我想可能会有更多的开发人员在他们的团队中使用这种技术。</p><h1 id="580b" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">基础知识</h1><p id="01f9" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">定制模板背后的基本思想是根据一些定义的规范创建一个 R 包。一旦安装完成，这个包将通过<code class="fe lb lc ld le b">New Project</code>向导提供 RStudio 模板。为此，我们需要三种原料:</p><ul class=""><li id="a10a" class="mj mk iq jp b jq jr ju jv jy ml kc mm kg mn kk mo mp mq mr bi translated">一个模板。</li><li id="2f15" class="mj mk iq jp b jq ms ju mt jy mu kc mv kg mw kk mo mp mq mr bi translated">创建项目模板的函数。</li><li id="f917" class="mj mk iq jp b jq ms ju mt jy mu kc mv kg mw kk mo mp mq mr bi translated">文件<code class="fe lb lc ld le b">rstudioProjectTemplate.dcf</code>。</li></ul><h1 id="0eac" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">模板</h1><p id="4bb0" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">就本指南而言，模板的目的无关紧要。我们将使用一个带有 R Markdown 报告的简单模板。降价报告是一个借口。您可以使用任何您喜欢的东西来创建您的项目模板。</p><p id="45b3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将模板保存到<code class="fe lb lc ld le b">./inst/&lt;YOUR TEMPLATE&gt;</code>中。</p><h1 id="f761" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">R 包</h1><p id="945d" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">正如所料，我们遵循 R 包的标准结构。这里是重要部分的概述。</p><pre class="km kn ko kp gt mx le my mz aw na bi"><span id="8e8b" class="nb lh iq le b gy nc nd l ne nf">.<br/>├── DESCRIPTION<br/>├── NAMESPACE<br/>├── R<br/>│   └── create_project.R<br/>└── inst<br/>    ├── rstudio<br/>    │   └── templates<br/>    │       └── project<br/>    │           ├── rmarkdown_icon.png<br/>    │           └── rstudioProjectTemplate.dcf<br/>    └── templatedemo<br/>        └── [...]</span></pre><p id="aa4e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">关键要素是:</p><ul class=""><li id="a5f9" class="mj mk iq jp b jq jr ju jv jy ml kc mm kg mn kk mo mp mq mr bi translated"><code class="fe lb lc ld le b">R</code>文件夹包含我们创建项目的逻辑。</li><li id="ea7f" class="mj mk iq jp b jq ms ju mt jy mu kc mv kg mw kk mo mp mq mr bi translated"><code class="fe lb lc ld le b">./inst/templatedemo</code>文件夹包含我们项目模板的副本。</li><li id="93fd" class="mj mk iq jp b jq ms ju mt jy mu kc mv kg mw kk mo mp mq mr bi translated"><code class="fe lb lc ld le b">.inst/rstudio/templates/project/rstudioProjectTemplate.dcf</code>文件包含 UI 向导的规范。</li></ul><h1 id="1b3b" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">创建项目的函数</h1><p id="7c8f" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">创建项目的函数放在<code class="fe lb lc ld le b">R</code>文件夹中。您必须拥有这个函数，因为它是用来初始化向导中的模板的。该函数可以有任何名称，只要它匹配在<code class="fe lb lc ld le b">dcf</code>文件的<code class="fe lb lc ld le b">Binding</code>参数中指定的名称(见下文)。该函数的第一个参数必须始终是<code class="fe lb lc ld le b">path</code>。这将是我们创建新项目的路径。我们将在后面看到如何定义额外的参数。</p><p id="2ff7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们来分解这个函数的主要部分。</p><h2 id="977b" class="nb lh iq bd li ng nh dn lm ni nj dp lq jy nk nl lu kc nm nn ly kg no np mc nq bi translated">争论</h2><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="f558" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如上所述，第一个也是唯一一个强制参数是<code class="fe lb lc ld le b">path</code>:我们需要告诉 RStudio 我们想在哪里创建包。所有其他参数都可以指定，或者作为省略号<code class="fe lb lc ld le b">...</code>传递。我们可以使用语法<code class="fe lb lc ld le b">dots &lt;- list(...)</code>来收集所有未命名的参数。</p><h2 id="38f2" class="nb lh iq bd li ng nh dn lm ni nj dp lq jy nk nl lu kc nm nn ly kg no np mc nq bi translated">逻辑</h2><p id="784b" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">这个函数包含了模板所需的所有逻辑。在我们的具体案例中:</p><ul class=""><li id="5861" class="mj mk iq jp b jq jr ju jv jy ml kc mm kg mn kk mo mp mq mr bi translated">它将模板从模板安装文件夹复制到指定的<code class="fe lb lc ld le b">path.</code></li><li id="533a" class="mj mk iq jp b jq ms ju mt jy mu kc mv kg mw kk mo mp mq mr bi translated">它激活<code class="fe lb lc ld le b">renv.</code></li><li id="276e" class="mj mk iq jp b jq ms ju mt jy mu kc mv kg mw kk mo mp mq mr bi translated">它安装依赖项。</li><li id="40e2" class="mj mk iq jp b jq ms ju mt jy mu kc mv kg mw kk mo mp mq mr bi translated">如果需要，它会初始化一个 repo</li><li id="b6ac" class="mj mk iq jp b jq ms ju mt jy mu kc mv kg mw kk mo mp mq mr bi translated">它向新项目<code class="fe lb lc ld le b">readme</code>添加了一些跟踪信息。</li></ul><p id="7ddf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以在本文末尾链接的库中看到完整的代码，但这里是主要的代码块。</p><p id="2166" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">复制代码</strong></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="440f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我们安装包时，模板保存在 R 库中。我们的<code class="fe lb lc ld le b">create_rmarkdown_project</code>函数会将模板从 R 库中复制到用户指定的位置。</p><p id="d483" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">更新参考文献</strong></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="6e8b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我们创建模板时，我们在适当的位置放置占位符。例如，在描述文件中，包的名称是<code class="fe lb lc ld le b">templatedemo</code>。当用户创建新项目时，我们用用户指定的实际名称替换所有占位符。上面的代码片段实现了这一点。它得到一个我们复制的所有文件的列表，然后遍历它们寻找关键字<code class="fe lb lc ld le b">templatedemo</code>。然后，该关键字被替换为用户的新项目名称。</p><p id="135e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">其他任务</strong></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="146a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在向导 UI 中，我们允许用户指定更多的参数。这部分代码基于额外的参数采取行动:激活<code class="fe lb lc ld le b">renv</code>，使用<code class="fe lb lc ld le b">.gitignore</code>，注册<code class="fe lb lc ld le b">R_CONFIG_ACTIVE</code>变量。</p><h1 id="fad7" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">向导用户界面</h1><p id="4168" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">这是我们的向导用户界面的样子。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/61c184a3836f05c4be6a3d3ef1a033c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WotboGRNejEKVUFZEj9W-w.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">我们的向导用户界面。图片由作者提供。</figcaption></figure><p id="51d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">默认情况下，RStudio 会创建“目录名”和“将项目创建为子目录”字段。它们将一起构成我们的<code class="fe lb lc ld le b">create_rmarkdown_project</code>函数的<code class="fe lb lc ld le b">path</code>自变量。</p><p id="aa84" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">页脚也由 RStudio 提供。我们不需要担心它。</p><p id="2354" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们定制的选项是关于<code class="fe lb lc ld le b">.gitignore</code>、<code class="fe lb lc ld le b">renv</code>和“选择项目范围”的选项。</p><p id="669a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">向导界面被定义在<code class="fe lb lc ld le b">rstudioProjectTemplate.dcf</code>文件中。来看看我们的<code class="fe lb lc ld le b">dcf</code>。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="c98c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">前几行定义了一些通用行为:</p><ul class=""><li id="ae45" class="mj mk iq jp b jq jr ju jv jy ml kc mm kg mn kk mo mp mq mr bi translated"><code class="fe lb lc ld le b">Binding</code>:用于创建项目的功能。</li><li id="ad62" class="mj mk iq jp b jq ms ju mt jy mu kc mv kg mw kk mo mp mq mr bi translated"><code class="fe lb lc ld le b">Title</code>:模板的标题，显示在向导中。</li><li id="2c6d" class="mj mk iq jp b jq ms ju mt jy mu kc mv kg mw kk mo mp mq mr bi translated"><code class="fe lb lc ld le b">OpenFiles</code>:新项目打开后，在新会话中显示该文件。</li><li id="e8ea" class="mj mk iq jp b jq ms ju mt jy mu kc mv kg mw kk mo mp mq mr bi translated"><code class="fe lb lc ld le b">Icon</code>:显示在标题旁边的图标。应该是 64 KB 或更小的<code class="fe lb lc ld le b">png</code>。</li></ul><p id="f67f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe lb lc ld le b">Binding</code>块下面的行定义了 UI 向导的不同元素。我们使用<code class="fe lb lc ld le b">CheckboxInput</code>和<code class="fe lb lc ld le b">SelectInput</code>。另一个选项是<code class="fe lb lc ld le b">TextInput</code>，它是一个自由文本输入，行为类似于“目录名”字段。这些输入中的每一个都有一个<code class="fe lb lc ld le b">Parameter</code>参数。这将被用作<code class="fe lb lc ld le b">create_rmarkdown_project()</code>函数的额外参数。</p><h1 id="3787" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">结论</h1><p id="aaa1" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">仅此而已。真的，就是这么简单。用上面定义的最小结构创建一个 R 包，安装它，就可以开始了。只需使用<code class="fe lb lc ld le b">New Project</code>向导，您就有了一个所有团队或组织都可以使用的可复制项目。</p></div><div class="ab cl nt nu hu nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="ij ik il im in"><p id="61e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢您的阅读，记得关注我以获得新故事的通知。</p><p id="5084" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你愿意读更多我和其他作家的作品吗？通过以下链接订阅媒体:<a class="ae lf" href="/@adrian.joseph/membership" rel="noopener ugc nofollow" target="_blank">https://medium.com/@adrian.joseph/membership</a></p><h1 id="ef01" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">参考</h1><p id="33da" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated"><a class="ae lf" href="https://medium.com/towards-data-science/using-rstudio-project-templates-to-help-the-project-standardization-in-data-science-teams-a963db12abac" rel="noopener">老媒体关于这个主题的文章。</a></p><p id="61f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lf" href="https://rstudio.github.io/rstudio-extensions/rstudio_project_templates.html" rel="noopener ugc nofollow" target="_blank">模板文档。</a></p><p id="8e6a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lf" href="https://github.com/theasjblog/rstudiotemplate" rel="noopener ugc nofollow" target="_blank">该项目的储存库。</a></p></div></div>    
</body>
</html>