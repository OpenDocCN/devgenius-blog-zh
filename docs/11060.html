<html>
<head>
<title>How to Launch an AWS EC2 Instance via the AWS CLI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何通过 AWS CLI 启动 AWS EC2 实例</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-launch-an-aws-ec2-instance-via-the-aws-cli-797b6ca5635c?source=collection_archive---------8-----------------------#2022-12-15">https://blog.devgenius.io/how-to-launch-an-aws-ec2-instance-via-the-aws-cli-797b6ca5635c?source=collection_archive---------8-----------------------#2022-12-15</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div class="gh gi jk"><img src="../Images/989e20968080bc8215724928a4e064ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*Y5-c8kiEfGc23KM__zwmNA.gif"/></div></figure><p id="39a6" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">在<a class="ae kp" href="https://medium.com/@tait.hoglund/save-your-business-up-to-31-by-going-cloud-49a4237f9814" rel="noopener">之前的文章</a>中，我向您展示了如何通过 web 浏览器中的控制台启动 AWS EC2 实例。下面是如何从 AWS CLI 完成同样的事情</p><h1 id="841c" class="kq kr in bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">先决条件</h1><ul class=""><li id="4370" class="lo lp in jt b ju lq jy lr kc ls kg lt kk lu ko lv lw lx ly bi translated"><a class="ae kp" href="https://aws.amazon.com/free/?trk=78b916d7-7c94-4cab-98d9-0ce5e648dd5f&amp;sc_channel=ps&amp;s_kwcid=AL!4422!3!432339156165!e!!g!!aws%20free%20tier%20account&amp;ef_id=Cj0KCQiA4uCcBhDdARIsAH5jyUmMO48IA_4exuYqiuLZa7fuSlGeH_mDa9NqBV_Pe3FNYImCoc5LWXoaAtpTEALw_wcB:G:s&amp;s_kwcid=AL!4422!3!432339156165!e!!g!!aws%20free%20tier%20account&amp;all-free-tier.sort-by=item.additionalFields.SortRank&amp;all-free-tier.sort-order=asc&amp;awsf.Free%20Tier%20Types=*all&amp;awsf.Free%20Tier%20Categories=*all" rel="noopener ugc nofollow" target="_blank">一个 AWS 账户</a>——注册是免费的，他们甚至在你的第一年提供“免费级”服务。</li><li id="22ae" class="lo lp in jt b ju lz jy ma kc mb kg mc kk md ko lv lw lx ly bi translated">Internet 访问，以及安装在本地计算机上的 AWS CLI</li><li id="dcb2" class="lo lp in jt b ju lz jy ma kc mb kg mc kk md ko lv lw lx ly bi translated">了解基本的 AWS CL 命令</li><li id="3ce6" class="lo lp in jt b ju lz jy ma kc mb kg mc kk md ko lv lw lx ly bi translated">建立了路由表的 VPC 和子网</li><li id="fb63" class="lo lp in jt b ju lz jy ma kc mb kg mc kk md ko lv lw lx ly bi translated">一个已建立的 AWS 密钥对和安全组，允许进出公共互联网的入站和出站流量(0.0.0.0/0)</li></ul><h1 id="b887" class="kq kr in bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">步骤 1:理解我们的命令</h1><p id="cadb" class="pw-post-body-paragraph jr js in jt b ju lq jw jx jy lr ka kb kc me ke kf kg mf ki kj kk mg km kn ko ig bi translated">下面是我们最终将在 AWS CLI 中运行的命令</p><pre class="mh mi mj mk gt ml mm mn bn mo mp bi"><span id="d37a" class="mq kr in mm b be mr ms l mt mu">aws ec2 run-instances --image-id ami-0b0dcb5067f052a63 --instance-type t2.micro --security-group-ids sg-0cc2b371cd9051296 --subnet-id subnet-0b2a73f958f1fc139 --key-name AWS_CDA_SERVER_KEYPAIR --user-data file://serverspinup.sh</span></pre><p id="2b6c" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">如您所见，在运行我们的命令之前，我们需要收集大量的<values>。以下是每个值的含义、如何根据您的需求定义它们以及它们的位置。</values></p><p id="6c4f" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated"><strong class="jt io"> — image-id &lt;值&gt; </strong>是亚马逊机器图像(AMI)。它用于指定您想要安装的操作系统的类型。AMI 值因地区而异。</p><p id="e650" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated"><strong class="jt io"> —实例类型&lt;值&gt; </strong>选择满足您的计算、内存、网络或存储需求的实例类型。要查看选项的详细列表，请从 EC2 仪表板访问启动 EC2 实例向导。</p><p id="0ff0" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated"><strong class="jt io">—security-group-ids&lt;value&gt;</strong>AWS 中的安全组充当 EC2 实例的虚拟防火墙，它们控制进入实例的流量以及离开实例的流量。</p><p id="2a0f" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated"><strong class="jt io"> -subnet-id &lt;值&gt; </strong>子网提供了您的 VPC 内的一系列 IP 地址，我们的 EC2 实例将连接到这些地址。子网在您的组织内提供屏障和控制。</p><p id="fc14" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated"><strong class="jt io">—Key-name&lt;value&gt;</strong>密钥对由一个公钥和一个私钥组成，作为一组安全凭证来验证您的身份，以便从命令行访问 EC2 实例和其他 AWS 资源。</p><p id="e7cc" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated"><strong class="jt io">-用户数据文件:// &lt;值&gt; </strong>这最后一个字段是可选的，但是一旦我们的 EC2 实例启动，它允许我们引用一个文件(或脚本)来运行命令。此字段对于运行常用命令(如包更新、安装 web 服务器等)非常有用。</p><h1 id="a42b" class="kq kr in bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">步骤 2:定位和设定我们的价值观</h1><p id="9f51" class="pw-post-body-paragraph jr js in jt b ju lq jw jx jy lr ka kb kc me ke kf kg mf ki kj kk mg km kn ko ig bi translated"><strong class="jt io">在 EC2 实例仪表板中定位您的 image-id &lt;值&gt; : </strong>开始。确认您正确的 AWS 区域，从 EC2 仪表板中单击橙色的“启动实例”</p><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi mv"><img src="../Images/a4e6ce089836f5b001ca1553a4a74d53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S-wbeTzmxJ8X8KYuQJYZVA.png"/></div></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">在启动 EC2 实例之前，通过您的 AWS 帐户仔细检查您所在的地区是一个很好的做法</figcaption></figure><p id="e407" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">从“启动实例”菜单中，单击“浏览更多 ami”</p><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/0611df55de64b4bd8a3a2aab6eb438d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1118/format:webp/1*edOSHRIG0h2YvjjXD_r2tg.png"/></div></figure><p id="f330" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">复制您希望安装的特定应用程序和操作系统中的 AMI ID，并作为 image-id 的值插入。</p><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nf"><img src="../Images/5d1faf359c2c0147c574de189dee8376.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UtXane9OSgbMM1_Bo2K6bg.png"/></div></div></figure><p id="2b7d" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated"><strong class="jt io">定位您的实例类型&lt;值&gt; : </strong>从您的 EC2 仪表板访问启动 EC2 实例向导。在实例类型下，滚动并找到您的特定实例，复制名称并将其粘贴到实例类型值&lt;的值&gt;中。</p><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi ng"><img src="../Images/62455d2e39ee4317751804647087186e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hn11WYs3TFp_PzTqSVo5aA.png"/></div></div></figure><p id="91a7" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated"><strong class="jt io">找到您的- security-group-ids &lt;值&gt; : </strong>开始在 AWS 控制台的 VPC 仪表板中，在左侧菜单中，向下滚动找到“Security Group”链接。在“安全组”菜单中，选择分配给 VPC 的安全组。在下面的子菜单中，复制您的“安全组 ID”。将您的值粘贴到安全组 ID &lt;值&gt;中。</p><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nh"><img src="../Images/412076024e9f5a1eee76044c17387ddc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pzaHX_Diwdq2xW3inZGBPw.png"/></div></div></figure><p id="4818" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated"><strong class="jt io">定位您的子网 id &lt;值&gt; : </strong>通过您的 AWS 帐户访问您的 VPC 管理控制台。单击左侧 ide 菜单中的子网链接，选择您的子网并从子菜单中复制子网 ID</p><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi ni"><img src="../Images/50ac4eded046f42effe2f217af0a8094.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C4XtgieAMgc9SHEgrb63bg.png"/></div></div></figure><p id="bded" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated"><strong class="jt io">查找您的密钥名&lt;值&gt; </strong>要查找您的密钥名，请从 EC2 仪表板开始，在左侧菜单的网络&amp;安全下，单击“密钥对”链接。复制密钥对的名称。</p><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nj"><img src="../Images/f54036fc10764dc3929624dc24a9d08e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_6cedOpQ34b3AXWhHoQVGg.png"/></div></div></figure><h1 id="1a27" class="kq kr in bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated"><strong class="ak">可选:步骤 3:定义我们的用户数据&lt;值&gt; </strong></h1><p id="ef5d" class="pw-post-body-paragraph jr js in jt b ju lq jw jx jy lr ka kb kc me ke kf kg mf ki kj kk mg km kn ko ig bi translated">这是一个可选字段，允许我们在启动 EC2 实例后运行命令或脚本。一旦启动，该字段中的命令将会执行。这为我们节省了时间。</p><p id="b91a" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">这是我将要导入的一个示例脚本。如果您对这些命令感到好奇，我在以前的文章中详细介绍了这个脚本，并鼓励您查看一下- <a class="ae kp" href="https://medium.com/devops-dev/basic-automation-with-bash-scripts-for-absolute-beginners-d09d04d930f" rel="noopener"> <strong class="jt io">绝对初学者的 Bash 脚本基础自动化</strong> </a>。</p><p id="1567" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">让我们在当前的 director 中创建我们的脚本，并用 nano 命令定义它。</p><p id="3880" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated"><em class="nk">注意，我们的脚本假设 Linux 安装了 RedHat 或 CentOs</em></p><pre class="mh mi mj mk gt ml mm mn bn mo mp bi"><span id="0359" class="mq kr in mm b be mr ms l mt mu">nano serverspinup.txt</span></pre><p id="d2cb" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">在 nano 中，我们键入我们的服务器启动脚本:</p><pre class="mh mi mj mk gt ml mm mn bn mo mp bi"><span id="425d" class="mq kr in mm b be mr ms l mt mu">!#/bin/bash<br/><br/>#Script to Automate Linux Server Spin Up by Tait Hoglund<br/><br/>sudo yum update -y<br/>sudo yum install -y httpd<br/>systemctl start httpd<br/>systemctl enable httpd</span></pre><p id="601e" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">点击[Ctrl + X]退出 nano。点击“y”将您的更改保存到您的文件 serverspinup.sh。点击[ENTER]确认更改并退出 nano</p><h1 id="1a4b" class="kq kr in bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">步骤 4:在 AWS CLI 中运行我们的命令</h1><p id="c53d" class="pw-post-body-paragraph jr js in jt b ju lq jw jx jy lr ka kb kc me ke kf kg mf ki kj kk mg km kn ko ig bi translated">在我们执行命令之前。确保您运行 AWS 配置了正确的公钥和私钥以及区域。如果不这样做，您可能会得到一个错误。</p><pre class="mh mi mj mk gt ml mm mn bn mo mp bi"><span id="74e5" class="mq kr in mm b be mr ms l mt mu">aws configure</span></pre><p id="b991" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">终于到了在 AWS CLI 中执行命令的时候了:</p><pre class="mh mi mj mk gt ml mm mn bn mo mp bi"><span id="8e33" class="mq kr in mm b be mr ms l mt mu">aws ec2 run-instances --image-id ami-0b0dcb5067f052a63 --instance-type t2.micro --security-group-ids sg-0cc2b371cd9051296 --subnet-id subnet-0b2a73f958f1fc139 --key-name AWS_CDA_SERVER_KEYPAIR --user-data file://serverspinup.sh</span></pre><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/d52d20839ea52facccdfc3212378decc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*kEpsdnnqeP8hu6T9C8yFgw.png"/></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">您应该会收到类似如下的输出。如果您没有收到任何输出，这意味着您的启动不成功</figcaption></figure><p id="d1cb" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">最后，在浏览器中确认您的启动。您应该看到 EC2 实例正在运行</p><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nm"><img src="../Images/12150fe9799b88646715c1055d962430.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qJGASml63rARXUV6LcAZGQ.png"/></div></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">在进行状态检查时，您的实例可能会说“挂起”。给它一两分钟，然后点击刷新。您可以通过单击“名称”列下的“编辑”图标字段来编辑名称</figcaption></figure><p id="659a" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">我们也可以通过提取公共 IP 地址并将其粘贴到另一个浏览器窗口来确认这一点:</p><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nn"><img src="../Images/46add911139a046a7d986b9c9bba81fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZeVI8822yDwi66oataVTiA.png"/></div></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">看到 Apache 测试页面证实了我们更新包和安装 Apache 的命令是成功的</figcaption></figure><p id="a728" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">如果你觉得这些内容有帮助，我会很感激你的“关注”、“鼓掌”或评论。</p><p id="64de" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">直到下一次:前进！</p><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div class="gh gi no"><img src="../Images/2abaab5e713feb393ba250d532937e57.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*W7NbBs6kfXLPDyw60uYajw.jpeg"/></div></figure></div></div>    
</body>
</html>