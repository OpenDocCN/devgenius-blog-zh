<html>
<head>
<title>Pass data using NSNotification in Swift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Swift中使用NSNotification传递数据</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/pass-data-using-nsnotification-in-swift-1ddc3bbd0d6d?source=collection_archive---------0-----------------------#2020-06-27">https://blog.devgenius.io/pass-data-using-nsnotification-in-swift-1ddc3bbd0d6d?source=collection_archive---------0-----------------------#2020-06-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="0a88" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">描述如何使用Swift编程语言中的通知模式在视图控制器之间传递数据。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/7731c2d6e74904de48c46fd4a9f84248.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n4c9n0ORtLIgpKk_Lot4ow.jpeg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">由<a class="ae lb" href="https://unsplash.com/@eduardoequis" rel="noopener ugc nofollow" target="_blank">艾德亚多·桑奇兹</a>通过<a class="ae lb" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><h1 id="bb37" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">概观</h1><p id="9e24" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">在iOS开发中，不同视图之间共享数据是非常常见的。我们可以用不同的方式传递数据。在本教程中，我们将学习如何使用NSNotification将数据从一个视图控制器发送到另一个视图控制器。</p><blockquote class="mf mg mh"><p id="d400" class="jn jo mi jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated"><em class="iq">本教程使用</em> <strong class="jp ir"> <em class="iq"> Swift 5，Xcode 11.4，iOS 13 &amp;故事板接口编写。</em>T9】</strong></p></blockquote><h1 id="0532" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">什么是通知？</h1><p id="bcc1" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">通知是将数据从一个视图发送到另一个视图时的一种通知方式。你可以把它和用邮箱寄信相比。寄件人将信件投到一个或多个收件人的邮箱里。收件人所在地区的邮政局长正在观察信件的到来。当邮政局长收到信时，他/她会做一些特定的工作(将它们分发给实际的收件人)。</p><p id="3fa2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用通知发送数据与此过程非常相似。从一个视图控制器发布通知。一个或多个视图控制器正在观察该通知。当他们通知时，他们做一些具体的工作。让我们看看所有这些东西是如何协同工作的</p><h1 id="ecef" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">从简单的项目开始</h1><p id="93a9" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">在本教程中，我将使用一个简单的单视图应用程序。这个应用程序将只有两个视图控制器，“FirstVC”和“SecondVC”。这是项目的故事板界面。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mm"><img src="../Images/648255592564304ce19634acdab42904.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jyvd3vCTVi8Vqg5KbtXVUw.png"/></div></div></figure><p id="918f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是“FirstVC”和“SecondVC”的视图控制器类。我们的目的是将通知从“SecondVC”发送到“FirstVC ”,这就是为什么我们在视图加载时在“FirstVC”中设置如下标签。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mn"><img src="../Images/f02b53652cc4163c334b45bb576bde75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FljT3f20D1VaPABV-7DkPA.png"/></div></div></figure><p id="45b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们只是为我们的项目设置视图和编写一些初始代码。在这个阶段，我们的app看起来是这样的。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mo"><img src="../Images/4524cf7c09443911249b6ccdced44675.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*6SWQU1Fzrlc5P41UGsOwfg.gif"/></div></div></figure><p id="cb26" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是我们的项目设置，现在可以配置了，酷😎</p><h1 id="8884" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">使用通知</h1><p id="2509" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">现在我们将处理通知。首先，我们将声明一个唯一的键。一个视图控制器将使用该键发送通知，另一个视图控制器将观察与该键相关联的通知，并在收到通知时做一些事情。让我们看看一切是如何一起工作的。</p><h2 id="2600" class="mp ld iq bd le mq mr dn li ms mt dp lm jy mu mv lq kc mw mx lu kg my mz ly na bi translated"><strong class="ak"> 1。设置通知键:</strong></h2><p id="4518" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">为了唯一地标识每个通知，我们需要一个唯一的通知密钥。Key可以在模块中的任何地方声明为变量，但是要确保它们在单独的类中或者在其他类的范围之外。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nb"><img src="../Images/d829f4821d755337e591bcad18d99191.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JU0xLqZWuxJTpJCbSxYlgA.png"/></div></div></figure><p id="cd1c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里我在“FirstVC”中声明了一个变量“notificationKey”。Swift”文件和“FirstVC”类之外。使用此密钥，我们将发布和观察通知。</p><h2 id="1cd2" class="mp ld iq bd le mq mr dn li ms mt dp lm jy mu mv lq kc mw mx lu kg my mz ly na bi translated">2.设置观察者:</h2><p id="78bb" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">我们编写了一个函数来观察通知。这里的<strong class="jp ir"> self </strong>指的是谁在观察通知。在我们的例子中，FirstVC。<strong class="jp ir">#选择器</strong>是通知后将执行的动作。在我们的例子中，如果“FirstVC”成功观察到通知，它将执行“doWhenNotify”函数并设置“notificationTxtLbl”文本。最后，<strong class="jp ir">名称</strong>是“第一VC”正在观察的通知的唯一键。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nb"><img src="../Images/aa033cefdfd8f7def56b1547f97dd6bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wZden3kdxxfYG3Mj8NOm9w.png"/></div></div></figure><h2 id="0299" class="mp ld iq bd le mq mr dn li ms mt dp lm jy mu mv lq kc mw mx lu kg my mz ly na bi translated">3.发布通知:</h2><p id="66cd" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">我们将在点击“SecondVC”中的“submitBtnTap”按钮时发布通知，如下所示。发布此通知时，我们将“SecondVC”引用作为对象传递。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nc"><img src="../Images/2408b49a20ea181c47882ec8def3579d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7RQxkVwEqdd8OIHUmigsmw.png"/></div></div></figure><p id="478a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你按照一切运行项目，你应该看到类似这样的东西。请注意,“FirstVC”文本中的“notificationTxtLbl”按照我们的预期进行了更改。这意味着我们使用通知成功地进行了沟通，太好了😃</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mo"><img src="../Images/e6e9a12eef5c4ad413db268c6fed54a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*CnEl3oxhOWMC5A6vmv83LQ.gif"/></div></div></figure><p id="4778" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是两个或更多的视图控制器如何使用通知相互对话的方式。但是你也必须使用通知来发送一些信息。现在我们来看看如何做到这一点。</p><p id="6e30" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通常，我们使用字典通过通知来发送数据。我们将信息作为键值对放入字典中，并在发布通知时将字典作为参数添加。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nd"><img src="../Images/db73eb8782f7fa31c97532cf12a553b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dEXcBxJwXHWwElwHGXR0Lg.png"/></div></div></figure><p id="075a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们的例子中，我们使用一个名为“info”的字典，并将文本字段输入作为键值对放入其中。将该字典作为名为“userInfo”的参数添加到post方法中。</p><p id="fefd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们将使用在发布通知时发送的“FirstVC”中的“userInfo”参数。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ne"><img src="../Images/59c950ec685d598a3543406b03b893af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QeqfVXmjQgm3U9uK6LAdGw.png"/></div></div></figure><p id="7cd2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">“userInfo”字典有两个关键字，“姓名”和“年龄”。我们安全地打开这些键值，并将它们设置到“infoLbl”中。这就是我们如何使用通知传递数据。现在，您可以设置您的用户名、年龄，并使用通知将它们从“SecondVC”传递到“FirstVC”。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mo"><img src="../Images/af3aff54d78febccc4323a03c0204f37.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*Zm03_5abaFOiCZ2BD90kzQ.gif"/></div></div></figure><h1 id="3172" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">取消初始化通知</h1><p id="80ea" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">您可以通过多种方式取消通知的初始化。这可以通过<strong class="jp ir"> deinit </strong>或视图控制器生命周期函数(<strong class="jp ir">viewdiddisament</strong>或<strong class="jp ir">viewdilldissapear</strong>)函数来完成。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nf"><img src="../Images/25f59ac41cfdb72fdfcd2367c5139f98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PBLAkUkdygkbIkMS0t_5mw.png"/></div></div></figure><p id="8898" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">祝贺🎉 🎉 🎉我想现在您知道如何在swift中使用NSNotification了。你会在这里找到项目<a class="ae lb" href="https://github.com/arifparvez14/Medium/tree/master/iOS/PassDataUsingNotification" rel="noopener ugc nofollow" target="_blank"/>。查看<a class="ae lb" href="https://developer.apple.com/documentation/foundation/nsnotification" rel="noopener ugc nofollow" target="_blank">苹果文档</a>了解更多详情。</p><p id="d81e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">如果你觉得这篇文章有用，请分享并鼓掌</strong>👏👏👏<br/>在<a class="ae lb" href="https://medium.com/@arifulislam14" rel="noopener">媒体</a>上查看我的其他文章，在<a class="ae lb" href="https://www.linkedin.com/in/arifparvez14/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上帮我联系。</p><p id="fe9e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢您阅读&amp;快乐编码🙂</p></div></div>    
</body>
</html>