<html>
<head>
<title>Microservices Boilerplate — with Lumen + Laravel + Nginx + Mysql → part (2/3)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">微服务样板文件—带有Lumen + Laravel + Nginx + Mysql →部分(2/3)</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/microservices-boilerplate-with-lumen-laravel-nginx-mysql-part-2-3-a3c0cc241cf4?source=collection_archive---------3-----------------------#2020-07-05">https://blog.devgenius.io/microservices-boilerplate-with-lumen-laravel-nginx-mysql-part-2-3-a3c0cc241cf4?source=collection_archive---------3-----------------------#2020-07-05</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/a2bcd9c49cf0d9dabfa777a6693d9f24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gLSHjJahOd-yCr8IcROMnQ.jpeg"/></div></div></figure><h2 id="e29b" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">在这个系列中</h2><ul class=""><li id="cd08" class="kr ks in kt b ku kv kw kx ke ky ki kz km la lb lc ld le lf bi translated"><a class="ae lg" href="https://medium.com/@shadysmaoui/micro-services-with-lumen-laravel-nginx-mysql-70b3554e8068" rel="noopener">微服务样板文件:设置(第1/3部分)</a></li><li id="8886" class="kr ks in kt b ku lh kw li ke lj ki lk km ll lb lc ld le lf bi translated"><a class="ae lg" href="https://medium.com/@shadysmaoui/microservices-boilerplate-with-lumen-laravel-nginx-mysql-part-2-3-a3c0cc241cf4" rel="noopener">微服务样板:设计(第2/3部分)</a></li></ul></div><div class="ab cl lm ln hr lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ig ih ii ij ik"><p id="4890" class="pw-post-body-paragraph lt lu in kt b ku lv lw lx kw ly lz ma ke mb mc md ki me mf mg km mh mi mj lb ig bi translated">现在我们的设置已经完成，并且<strong class="kt io">可扩展</strong>架构的基础已经准备好，我们可以向前迈进，更深入地思考我们整个系统的期望设计。</p><p id="4c47" class="pw-post-body-paragraph lt lu in kt b ku lv lw lx kw ly lz ma ke mb mc md ki me mf mg km mh mi mj lb ig bi translated">我们将根据我们将选择的设计要求，在我们必须实施现有微服务或创建新的微服务时，尝试建立遵循的准则，并且我们将必须进行一些DevOps调整，以确保所有部分一起正常运行。与此同时，值得一提的是，总的来说，设置中枯燥的部分已经过去，随着时间的推移，我们越来越接近最有趣的部分。</p><p id="2431" class="pw-post-body-paragraph lt lu in kt b ku lv lw lx kw ly lz ma ke mb mc md ki me mf mg km mh mi mj lb ig bi translated">正如本系列开始时提到的，这些文章的主要目的是首先介绍<strong class="kt io">微服务架构</strong>，然后提供如何设计和实现它的分步演示。<br/> <br/>虽然这种软件架构风格没有精确的定义，但围绕<strong class="kt io"> <em class="mk">有一些共同的特征:可伸缩性、持续集成、自动化部署、端点智能、解耦业务逻辑、语言无关组件和数据的分散控制</em> </strong>。<br/>鉴于本系列的教育性质和范围，我们将无法涵盖上述所有要素，尤其是那些与实际生产流程相关的要素，如<strong class="kt io"> CICD(持续集成/持续部署)。</strong>另一方面，我们将尝试从设计的角度对所有重要方面有一个清晰的概述。</p><h2 id="a0f0" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">系统定义</h2><p id="e40e" class="pw-post-body-paragraph lt lu in kt b ku kv lw lx kw kx lz ma ke ml mc md ki mm mf mg km mn mi mj lb ig bi translated">出于学习目的，我们将创建一个管理电子商务公司产品库存的<strong class="kt io"> ERP(企业资源规划)</strong>系统的最小可行产品。为了使这个过程尽可能顺利和简单，我们将做一些抽象，避免深入挖掘ERP的业务逻辑。然而，我们将坚持定义一个<strong class="kt io"> ERP </strong>的工作流程的主要指导方针，以便给我们的<strong class="kt io"> MVP </strong>一个更现实的方法。</p><h2 id="bafc" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">主要组件</h2><ul class=""><li id="e860" class="kr ks in kt b ku kv kw kx ke ky ki kz km la lb lc ld le lf bi translated"><strong class="kt io">策展人</strong>，这是Laravel应用程序，将使用我们的微服务公开的API，并将为整个系统扮演UI(用户界面)的角色，以及用户的登录页面。这将是一个具有仪表板的网站，允许创建，列表，编辑和删除资源(产品/品牌等)。</li><li id="7bc1" class="kr ks in kt b ku lh kw li ke lj ki lk km ll lb lc ld le lf bi translated"><strong class="kt io">分发器</strong>将是微服务生态系统的主要入口点，正如其名称所规定的，它将分发微服务生态系统的入站和出站请求和响应。用技术术语来说，<strong class="kt io">分配器</strong>将是微服务API网关。</li><li id="22bf" class="kr ks in kt b ku lh kw li ke lj ki lk km ll lb lc ld le lf bi translated"><strong class="kt io"> ms-product，</strong>是负责管理产品的主要微服务。它将接收和响应所有与产品相关的请求。它将有自己的数据库，这个数据库将是唯一的真理来源，当谈到产品。</li><li id="b4cd" class="kr ks in kt b ku lh kw li ke lj ki lk km ll lb lc ld le lf bi translated"><strong class="kt io"> ms-brand — </strong>与微服务的解耦逻辑一样，<strong class="kt io"> ms-brand </strong>将负责管理所有与产品品牌相关的请求。基于与ms-product相同的推理，ms-brand将拥有自己的数据库，该数据库将成为品牌信息的唯一来源。</li><li id="5879" class="kr ks in kt b ku lh kw li ke lj ki lk km ll lb lc ld le lf bi translated"><strong class="kt io"> ms-location — </strong>我们的产品将存放在一个地方，可能是后台商店、前台商店、仓库等。<strong class="kt io"> ms-location </strong>将作为处理位置业务逻辑的参考。</li></ul><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mo"><img src="../Images/674aebe2b0ca4aa629cab04bfa2069bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jp5H8nlsGl45YoY2icogoQ.png"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk translated">微服务样板</figcaption></figure><h2 id="bcc9" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">微服务缓存</h2><p id="bbad" class="pw-post-body-paragraph lt lu in kt b ku kv lw lx kw kx lz ma ke ml mc md ki mm mf mg km mn mi mj lb ig bi translated">为了充分利用<strong class="kt io">微服务架构，</strong>我们将为每个微服务使用一个缓存系统。考虑到我们将通过<strong class="kt io"> Redis </strong>缓存使用<strong class="kt io">内存中数据存储</strong>方法，这将允许我们的微服务获得极快的响应时间。与PostgreSQL、Cassandra、MongoDB和其他将大部分数据存储在磁盘或固态硬盘上的数据库相比，所有Redis数据都驻留在服务器的主内存中。与传统的基于磁盘的数据库(其中大多数操作需要往返磁盘)相比，<strong class="kt io">内存中的数据存储</strong>如<strong class="kt io"> Redis </strong>不会遭受同样的损失。因此，它们可以支持一个数量级、更多的操作和更快的响应时间。结果是极快的性能，平均读取或写入操作不到一毫秒，支持每秒数百万次操作。</p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mx"><img src="../Images/9578d20316a642cf483921d53004379a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*py44nWOENcKJOKov4_y1sQ.png"/></div></div></figure><h2 id="3b93" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">添加微服务</h2><p id="f405" class="pw-post-body-paragraph lt lu in kt b ku kv lw lx kw kx lz ma ke ml mc md ki mm mf mg km mn mi mj lb ig bi translated">现在我们对系统设计有了更清晰的了解，让我们添加不同的组件。</p><p id="a32b" class="pw-post-body-paragraph lt lu in kt b ku lv lw lx kw ly lz ma ke mb mc md ki me mf mg km mh mi mj lb ig bi translated"><code class="fe my mz na nb b">-&gt;$ composer create-project --prefer-dist laravel/lumen apps/ms-product</code></p><p id="ec54" class="pw-post-body-paragraph lt lu in kt b ku lv lw lx kw ly lz ma ke mb mc md ki me mf mg km mh mi mj lb ig bi translated"><code class="fe my mz na nb b">-&gt;$ composer create-project --prefer-dist laravel/lumen apps/ms-brand</code></p><p id="b403" class="pw-post-body-paragraph lt lu in kt b ku lv lw lx kw ly lz ma ke mb mc md ki me mf mg km mh mi mj lb ig bi translated"><code class="fe my mz na nb b">-&gt;$ composer create-project --prefer-dist laravel/lumen apps/ms-location</code></p><p id="c157" class="pw-post-body-paragraph lt lu in kt b ku lv lw lx kw ly lz ma ke mb mc md ki me mf mg km mh mi mj lb ig bi translated">至此，我们应该有了我们<strong class="kt io">全新三微服务</strong>的架构。是时候添加每个微服务的容器了，所以我们先添加各自的docker文件。</p><p id="62c8" class="pw-post-body-paragraph lt lu in kt b ku lv lw lx kw ly lz ma ke mb mc md ki me mf mg km mh mi mj lb ig bi translated">→ <code class="fe my mz na nb b">./apps/ms-product/Dockerfile</code></p><figure class="mp mq mr ms gt jo"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="5c65" class="pw-post-body-paragraph lt lu in kt b ku lv lw lx kw ly lz ma ke mb mc md ki me mf mg km mh mi mj lb ig bi translated">鉴于这是我们第三次产生一个新的微服务，我确信你将能够通过正确地为<strong class="kt io"> ms-brand </strong>以及<strong class="kt io"> ms-location创建Dockerfile来做同样的事情。</strong></p><h2 id="c9a5" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">运行状况检查实施</h2><p id="ab0d" class="pw-post-body-paragraph lt lu in kt b ku kv lw lx kw kx lz ma ke ml mc md ki mm mf mg km mn mi mj lb ig bi translated">我们将一起为<strong class="kt io">分发器</strong>实现<code class="fe my mz na nb b">HealthCheckController</code>,我将让您负责将它添加到其他微服务中。您只需复制/粘贴相同的文件，不做任何更改。</p><p id="a647" class="pw-post-body-paragraph lt lu in kt b ku lv lw lx kw ly lz ma ke mb mc md ki me mf mg km mh mi mj lb ig bi translated">第一步，创建<code class="fe my mz na nb b">HealthCheckController</code>:</p><p id="10d0" class="pw-post-body-paragraph lt lu in kt b ku lv lw lx kw ly lz ma ke mb mc md ki me mf mg km mh mi mj lb ig bi translated"><code class="fe my mz na nb b">-&gt; ./apps/dispenser/app/Http/Controllers/HealthCheckController.php</code></p><figure class="mp mq mr ms gt jo"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="cb5d" class="pw-post-body-paragraph lt lu in kt b ku lv lw lx kw ly lz ma ke mb mc md ki me mf mg km mh mi mj lb ig bi translated">现在我们的<code class="fe my mz na nb b">HealthCheckController</code>已经实现，让我们在<code class="fe my mz na nb b">web.php</code>中添加与之相关的路由。</p><p id="52d7" class="pw-post-body-paragraph lt lu in kt b ku lv lw lx kw ly lz ma ke mb mc md ki me mf mg km mh mi mj lb ig bi translated"><code class="fe my mz na nb b">-&gt; dispenser/routes/web.php</code></p><figure class="mp mq mr ms gt jo"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="3ea4" class="pw-post-body-paragraph lt lu in kt b ku lv lw lx kw ly lz ma ke mb mc md ki me mf mg km mh mi mj lb ig bi translated">如果你喜欢这篇文章，请<strong class="kt io">鼓掌并订阅</strong>！干杯！！✌🏽💕💕👌🏽</p><p id="a8dc" class="pw-post-body-paragraph lt lu in kt b ku lv lw lx kw ly lz ma ke mb mc md ki me mf mg km mh mi mj lb ig bi translated">下面是与这个项目相关的Github资源库:</p><p id="9a43" class="pw-post-body-paragraph lt lu in kt b ku lv lw lx kw ly lz ma ke mb mc md ki me mf mg km mh mi mj lb ig bi translated">https://github.com/shsma/microservices-workspace……别忘了明星</p><p id="640f" class="pw-post-body-paragraph lt lu in kt b ku lv lw lx kw ly lz ma ke mb mc md ki me mf mg km mh mi mj lb ig bi translated"><strong class="kt io">双回阅读第一部分在这里:</strong></p><div class="ne nf gp gr ng nh"><a href="https://medium.com/@shadysmaoui/micro-services-with-lumen-laravel-nginx-mysql-70b3554e8068" rel="noopener follow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd io gy z fp nm fr fs nn fu fw im bi translated">带有Lumen + Laravel + Nginx + Mysql的微服务样板-&gt;第2/3部分</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">在这篇文章中，我将一步一步地演示如何用Lumem和Laravel将你的微服务项目dockerize</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">medium.com</p></div></div><div class="nq l"><div class="nr l ns nt nu nq nv jt nh"/></div></div></a></div></div></div>    
</body>
</html>