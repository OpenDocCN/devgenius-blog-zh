<html>
<head>
<title>Vuex 4 — Actions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Vuex 4 —动作</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/vuex-4-actions-650f4d7d0819?source=collection_archive---------6-----------------------#2020-12-16">https://blog.devgenius.io/vuex-4-actions-650f4d7d0819?source=collection_archive---------6-----------------------#2020-12-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/3cf0ca70913ebdfa314be35da897435d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KRayPuHCw1gQd0tU"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@pietromattia?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Pietro Mattia </a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="b8d8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vuex 4处于测试阶段，可能会有变化。</p><p id="15d0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vuex是一个流行的Vue状态管理库。</p><p id="a15e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vuex 4是专为Vue 3设计的版本。</p><p id="5bb2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解如何将Vuex 4与Vue 3配合使用。</p><h1 id="10dc" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">行动</h1><p id="8941" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">在Vuex 4中，动作类似于突变。</p><p id="a67a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">区别在于动作提交突变，动作可以有异步操作。</p><p id="de44" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了创建一个动作，我们可以向我们的存储添加一个<code class="fe me mf mg mh b">actions</code>属性。</p><p id="81a5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="d77c" class="mq lc iq mh b gy mr ms l mt mu">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;script src="https://unpkg.com/vue@next"&gt;&lt;/script&gt;<br/>    &lt;script src="https://unpkg.com/vuex@4.0.0-beta.4/dist/vuex.global.js"&gt;&lt;/script&gt;<br/>    &lt;title&gt;App&lt;/title&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="app"&gt;<br/>      &lt;button @click="increment"&gt;increment&lt;/button&gt;<br/>      &lt;p&gt;{{count}}&lt;/p&gt;<br/>    &lt;/div&gt;<br/>    &lt;script&gt;<br/>      const store = new Vuex.Store({<br/>        state: {<br/>          count: 0<br/>        },<br/>        mutations: {<br/>          increment(state) {<br/>            state.count++;<br/>          }<br/>        },<br/>        actions: {<br/>          increment(context) {<br/>            context.commit("increment");<br/>          }<br/>        }<br/>      });<br/>      const app = Vue.createApp({<br/>        methods: {<br/>          increment() {<br/>            this.$store.dispatch("increment");<br/>          }<br/>        },<br/>        computed: {<br/>          count() {<br/>            return this.$store.state.count;<br/>          }<br/>        }<br/>      });<br/>      app.use(store);<br/>      app.mount("#app");<br/>    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="6b10" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们创建了一个带有<code class="fe me mf mg mh b">actions</code>属性的Vuex商店，其中包含了<code class="fe me mf mg mh b">increment</code>方法。</p><p id="93fb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它使用<code class="fe me mf mg mh b">comtext</code>参数和<code class="fe me mf mg mh b">commit</code>方法来提交变异。</p><p id="d229" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了在我们的组件中分派动作，我们用动作名调用<code class="fe me mf mg mh b">this.$store.dispatch</code>。</p><p id="7846" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以在一个动作中执行异步操作。</p><p id="6c17" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="d7ad" class="mq lc iq mh b gy mr ms l mt mu">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;script src="https://unpkg.com/vue@next"&gt;&lt;/script&gt;<br/>    &lt;script src="https://unpkg.com/vuex@4.0.0-beta.4/dist/vuex.global.js"&gt;&lt;/script&gt;<br/>    &lt;title&gt;App&lt;/title&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="app"&gt;<br/>      &lt;button @click="increment"&gt;increment&lt;/button&gt;<br/>      &lt;p&gt;{{count}}&lt;/p&gt;<br/>    &lt;/div&gt;<br/>    &lt;script&gt;<br/>      const store = new Vuex.Store({<br/>        state: {<br/>          count: 0<br/>        },<br/>        mutations: {<br/>          increment(state) {<br/>            state.count++;<br/>          }<br/>        },<br/>        actions: {<br/>          incrementAsync({ commit }) {<br/>            setTimeout(() =&gt; {<br/>              commit("increment");<br/>            }, 1000);<br/>          }<br/>        }<br/>      });<br/>      const app = Vue.createApp({<br/>        methods: {<br/>          increment() {<br/>            this.$store.dispatch("incrementAsync");<br/>          }<br/>        },<br/>        computed: {<br/>          count() {<br/>            return this.$store.state.count;<br/>          }<br/>        }<br/>      });<br/>      app.use(store);<br/>      app.mount("#app");<br/>    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="03b6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在<code class="fe me mf mg mh b">setTimeout</code>回调中调用了<code class="fe me mf mg mh b">commit</code>,将动作分派延迟了一秒。</p><p id="4082" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以使用有效负载来分派动作。</p><p id="6ac6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="fc83" class="mq lc iq mh b gy mr ms l mt mu">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;script src="https://unpkg.com/vue@next"&gt;&lt;/script&gt;<br/>    &lt;script src="https://unpkg.com/vuex@4.0.0-beta.4/dist/vuex.global.js"&gt;&lt;/script&gt;<br/>    &lt;title&gt;App&lt;/title&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="app"&gt;<br/>      &lt;button @click="increment"&gt;increment&lt;/button&gt;<br/>      &lt;p&gt;{{count}}&lt;/p&gt;<br/>    &lt;/div&gt;<br/>    &lt;script&gt;<br/>      const store = new Vuex.Store({<br/>        state: {<br/>          count: 0<br/>        },<br/>        mutations: {<br/>          increment(state, payload) {<br/>            state.count += payload.amount;<br/>          }<br/>        },<br/>        actions: {<br/>          incrementAsync({ commit }, payload) {<br/>            setTimeout(() =&gt; {<br/>              commit("increment", payload);<br/>            }, 1000);<br/>          }<br/>        }<br/>      });<br/>      const app = Vue.createApp({<br/>        methods: {<br/>          increment() {<br/>            this.$store.dispatch("incrementAsync", { amount: 2 });<br/>          }<br/>        },<br/>        computed: {<br/>          count() {<br/>            return this.$store.state.count;<br/>          }<br/>        }<br/>      });<br/>      app.use(store);<br/>      app.mount("#app");<br/>    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="2fb1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们向<code class="fe me mf mg mh b">incrementAsync</code>动作添加了一个<code class="fe me mf mg mh b">payload</code>参数，以接受动作中的有效负载。</p><p id="f63e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们将一个对象作为第二个参数传递给<code class="fe me mf mg mh b">this.$store.dispatch</code>方法来调度我们的动作。</p><p id="b6e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还可以传入一个具有<code class="fe me mf mg mh b">type</code>属性的对象，以及将包含在有效负载中的任意属性:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="dbba" class="mq lc iq mh b gy mr ms l mt mu">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;script src="https://unpkg.com/vue@next"&gt;&lt;/script&gt;<br/>    &lt;script src="https://unpkg.com/vuex@4.0.0-beta.4/dist/vuex.global.js"&gt;&lt;/script&gt;<br/>    &lt;title&gt;App&lt;/title&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="app"&gt;<br/>      &lt;button @click="increment"&gt;increment&lt;/button&gt;<br/>      &lt;p&gt;{{count}}&lt;/p&gt;<br/>    &lt;/div&gt;<br/>    &lt;script&gt;<br/>      const store = new Vuex.Store({<br/>        state: {<br/>          count: 0<br/>        },<br/>        mutations: {<br/>          increment(state, payload) {<br/>            state.count += payload.amount;<br/>          }<br/>        },<br/>        actions: {<br/>          incrementAsync({ commit }, payload) {<br/>            setTimeout(() =&gt; {<br/>              commit("increment", payload);<br/>            }, 1000);<br/>          }<br/>        }<br/>      });<br/>      const app = Vue.createApp({<br/>        methods: {<br/>          increment() {<br/>            this.$store.dispatch({ type: "incrementAsync", amount: 2 });<br/>          }<br/>        },<br/>        computed: {<br/>          count() {<br/>            return this.$store.state.count;<br/>          }<br/>        }<br/>      });<br/>      app.use(store);<br/>      app.mount("#app");<br/>    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="d073" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">type</code>是动作的名称，其他属性将在<code class="fe me mf mg mh b">incrementAsync</code>动作的第二个参数中的<code class="fe me mf mg mh b">payload</code>对象中结束。</p><h1 id="8659" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="f888" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以创建动作来提交突变，并使用Vuex 4运行异步代码。</p></div></div>    
</body>
</html>