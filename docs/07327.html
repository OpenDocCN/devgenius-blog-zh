<html>
<head>
<title>Expenses Tracker App using Django and Pandas.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Django 和 Pandas 的费用跟踪应用程序。</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/expenses-tracker-app-using-django-and-pandas-c6ecfdf55e1d?source=collection_archive---------9-----------------------#2022-03-15">https://blog.devgenius.io/expenses-tracker-app-using-django-and-pandas-c6ecfdf55e1d?source=collection_archive---------9-----------------------#2022-03-15</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="7256" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这个 python 项目中，我们需要安装 Django 和 Pandas 库，我们将制作一个包含四个字段的表单:金额、类别(食品、旅游、购物……)、日期和描述。这些信息将会显示在熊猫的数据框中。</p><p id="b08e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们需要做的第一件事是安装 Django 和 pandas 库:</p><pre class="ki kj kk kl gt km kn ko kp aw kq bi"><span id="66f1" class="kr ks in kn b gy kt ku l kv kw">pip install django <br/>pip install pandas</span></pre><p id="114e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Django 和 pandas 安装到您的环境中后，就该开始项目了。</p><pre class="ki kj kk kl gt km kn ko kp aw kq bi"><span id="1352" class="kr ks in kn b gy kt ku l kv kw">Django-admin startproject expenses_tracker</span></pre><p id="59a8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">当项目的目录创建后，您必须移动到“expenses_tracker ”,并在您的终端中编写以下代码:</p><pre class="ki kj kk kl gt km kn ko kp aw kq bi"><span id="f9d9" class="kr ks in kn b gy kt ku l kv kw">py manage.py startapp tracker</span></pre><p id="4dc9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在你必须转到“<a class="ae kx" href="http://settings.py" rel="noopener ugc nofollow" target="_blank"> settings.py </a>”并向下滚动，直到你看到“INSTALLED_APPS”并写下“tracker”，就像这样:</p><pre class="ki kj kk kl gt km kn ko kp aw kq bi"><span id="cc53" class="kr ks in kn b gy kt ku l kv kw">INSTALLED_APPS = [ <br/>'django.contrib.admin', <br/>'django.contrib.auth', <br/>'django.contrib.contenttypes', <br/>'django.contrib.sessions', <br/>'django.contrib.messages', <br/>'django.contrib.staticfiles', <br/>'tracker', <br/>]</span></pre><p id="a23d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">然后在终端中编写以下代码:</p><pre class="ki kj kk kl gt km kn ko kp aw kq bi"><span id="2db1" class="kr ks in kn b gy kt ku l kv kw">py manage.py makemigrations<br/> py manage.py migrate<br/> py manage.py runserver</span></pre><p id="3da7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae kx" href="http://models.py/" rel="noopener ugc nofollow" target="_blank"> Models.py </a>:</p><pre class="ki kj kk kl gt km kn ko kp aw kq bi"><span id="4c48" class="kr ks in kn b gy kt ku l kv kw">from django.db import models<br/>     from django.utils.timezone import now<br/><br/>     # Create your models here.<br/>     CATEGORY_CHOICES = [<br/>                ("Food","Food"),<br/>                ("Travel","Travel"),<br/>                ("Shopping","Shopping"),<br/>                ("Necessities","Necessities"),<br/>                ("Entertainment","Entertainment"),<br/>                ("Other","Other")]<br/><br/>   class Expense_data(models.Model):<br/>            amount=models.CharField(max_length=10)<br/>            category=models.CharField(max_length=20,choices=CATEGORY_CHOICES,default='Food')<br/>            date=models.DateField(default=now)<br/>            description=models.CharField(max_length=200, blank=True)<br/><br/>             def __str__(self):<br/>                   return self.category</span></pre><p id="f941" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在<a class="ae kx" href="http://models.py" rel="noopener ugc nofollow" target="_blank"> models.py </a>中，创建了数据库，只有一个名为“Expense_data”的表，该表有四个字段，这些字段需要填写表单，CATEGORY_CHOICES 是一个常量列表，其中的选项显示在类别字段中。</p><p id="1f5c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae kx" href="http://form.py/" rel="noopener ugc nofollow" target="_blank"> form.py </a></p><pre class="ki kj kk kl gt km kn ko kp aw kq bi"><span id="e2ad" class="kr ks in kn b gy kt ku l kv kw">from django import forms<br/>   from django.forms import ModelForm<br/><br/>  from .models import *<br/><br/> class ExpenseForm(forms.ModelForm):<br/>          amount = models.CharField(max_length=10)<br/>          category = models.CharField(max_length=20, choices=CATEGORY_CHOICES, default='Food')<br/>          date = models.DateField(default=now)<br/>          description = models.CharField(max_length=200, blank=True)<br/><br/>          class Meta:<br/>                  model=Expense_data<br/>                  fields='__all__'</span></pre><p id="0e49" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们需要在 expenses_app 目录中创建一个名为"<a class="ae kx" href="http://form.py" rel="noopener ugc nofollow" target="_blank"> form.py </a>"的新文件，并从 django 模块中导入模型和表单。在这个文件中，我们创建了一个名为“ExpenseForm”的类，并从我们的模型中复制粘贴信息。</p><p id="f657" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae kx" href="http://views.py" rel="noopener ugc nofollow" target="_blank"> views.py </a></p><pre class="ki kj kk kl gt km kn ko kp aw kq bi"><span id="f3ca" class="kr ks in kn b gy kt ku l kv kw">from django.shortcuts import render, redirect<br/> from .models import Expense_data<br/> from .forms import *<br/> import pandas as pd<br/><br/><br/>  def expenses_form(request):<br/>        expenses=Expense_data.objects.all()<br/>        form=ExpenseForm()<br/><br/>         if request.method == 'POST':<br/>               form = ExpenseForm(request.POST)<br/>               if form.is_valid():<br/>                    form.save()<br/>               return redirect("expenses-dataframe")<br/>         context={'expenses': expenses, 'form':form}<br/>         return render(request,'tracker/tracker_form.html',context)<br/><br/><br/><br/>  def expenses_dataframe(request):<br/>        data=Expense_data.objects.all().values()<br/>        df=pd.DataFrame(data)<br/>        context={'df':df.to_html()}<br/>        return render(request, 'tracker/tracker_data.html', context)</span></pre><p id="ba80" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在<a class="ae kx" href="http://views.py" rel="noopener ugc nofollow" target="_blank"> views.py </a>中，我们创建了一个函数来处理 POST 请求。变量“expenses”被分配给模型的所有对象，在变量“form”中分配给表单。下面的代码可以，如果从我们的表单请求一个 POST，并且是有效的，它被保存，我们被重定向到“expenses-dataframe”页面，来自模型和表单的所有对象被分配给上下文变量，在“tracker_form.html”中呈现。</p><p id="1db7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在“def expenses_dataframe”中，我们从数据库中取出所有模型，并将它们分配给变量“data”。“df”变量为数据框分配了将要显示的模型对象。然后，我们将数据帧分配给一个上下文，将它转换成一个 HTML 对象，最后的代码将它呈现到 HTML 文件中。</p><p id="56fa" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在项目的目录(expenses_tracker)中，有一个<a class="ae kx" href="http://urls.py" rel="noopener ugc nofollow" target="_blank"> urls.py </a>，我们复制下一段代码:</p><pre class="ki kj kk kl gt km kn ko kp aw kq bi"><span id="db31" class="kr ks in kn b gy kt ku l kv kw">from django.contrib import admin<br/> from django.urls import path,include<br/><br/> urlpatterns = [<br/>      path('',include('tracker.urls')),<br/>      path('admin/', admin.site.urls),<br/>      ]</span></pre><p id="d56a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">之后，我们创建一个<a class="ae kx" href="http://urls.py" rel="noopener ugc nofollow" target="_blank"> urls.py </a>文件，但是在应用程序的目录(tracker)中，代码如下:</p><pre class="ki kj kk kl gt km kn ko kp aw kq bi"><span id="aed4" class="kr ks in kn b gy kt ku l kv kw">from django.contrib import admin<br/>   from django.urls import path<br/>   from .views import *<br/>   from . import views<br/><br/>   urlpatterns = [<br/>        path('',views.expenses_form,name='expense-tracker'),<br/>        path('/dataframe', views.expenses_dataframe, name='expenses-dataframe'),<br/><br/><br/>         ]</span></pre><p id="21a0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在<a class="ae kx" href="http://admin.py" rel="noopener ugc nofollow" target="_blank"> admin.py </a>中，我们将模型注册到管理员帐户中。</p><pre class="ki kj kk kl gt km kn ko kp aw kq bi"><span id="f866" class="kr ks in kn b gy kt ku l kv kw">from django.contrib import admin<br/>from .models import Expense_data<br/><br/> # Register your models here.<br/> admin.site.register(Expense_data)</span></pre><p id="7dc0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们需要执行代码来迁移我们的模型。</p><pre class="ki kj kk kl gt km kn ko kp aw kq bi"><span id="1130" class="kr ks in kn b gy kt ku l kv kw">py manage.py makemigrations<br/>py manage.py migrate<br/>py manage.py createsuperuser</span></pre><p id="ac70" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">您必须创建一个用户名和密码才能访问管理员帐户。</p><p id="357f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们需要在名为“templates”的 app 文件夹内创建一个模板目录文件夹:在 templates 文件夹内，我们创建另一个名为“tracker”的文件夹；在里面，我们放了所有的 HTML 文件。</p><p id="b984" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">tracker_form.html</p><pre class="ki kj kk kl gt km kn ko kp aw kq bi"><span id="562b" class="kr ks in kn b gy kt ku l kv kw">{% extends 'tracker/base.html' %}<br/><br/>{% block content %}<br/><br/>&lt;div class="header-bar"&gt;<br/>        &lt;a href="{% url 'expenses-dataframe' %}"&gt;&amp;#8592; Dataframe&lt;/a&gt;<br/><br/>&lt;/div&gt;<br/><br/>&lt;div class="card-body"&gt;<br/>       &lt;form method= "POST" action =""&gt;<br/>                {% csrf_token %}<br/>                {{form.as_p}}<br/>                &lt;input class="button" type="submit" value="submit"&gt;<br/>       &lt;/form&gt;<br/><br/><br/> &lt;/div&gt;<br/><br/>{% endblock content %}</span></pre><p id="c341" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">tracker_data.html</p><pre class="ki kj kk kl gt km kn ko kp aw kq bi"><span id="90f4" class="kr ks in kn b gy kt ku l kv kw">{% extends 'tracker/base.html' %}<br/><br/>{% block content %}<br/>&lt;div class="header-bar"&gt;<br/>      &lt;h3&gt;Dataframe&lt;/h3&gt;<br/> &lt;/div&gt;<br/><br/> &lt;div id="expenses-add-wrapper"&gt;<br/>       &lt;a id="add-link" href="{% url 'expense-tracker' %}"&gt;&amp;#x2b;&lt;/a&gt;<br/> &lt;/div&gt;<br/><br/> &lt;body&gt;<br/><br/>       &lt;div class="table"&gt;{{df|safe}}&lt;/div&gt;<br/><br/><br/> &lt;/body&gt;<br/><br/><br/> {% endblock content %}</span></pre><p id="2287" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这里是 base.html 的<a class="ae kx" href="https://github.com/carlosm27/expense_tracker/blob/main/tracker/templates/tracker/base.html" rel="noopener ugc nofollow" target="_blank">文件。</a></p><figure class="ki kj kk kl gt kz gh gi paragraph-image"><div class="gh gi ky"><img src="../Images/58487d13b3dce4b21f14e99156496560.png" data-original-src="https://miro.medium.com/v2/resize:fit:1114/0*5E74EmR3w4UPkgbP"/></div></figure><figure class="ki kj kk kl gt kz gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/ebe35eec41ac1ddb12ff13b2a9160ceb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1118/0*WE9v1UYk0NbuJF6P"/></div></figure><p id="e437" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae kx" href="https://github.com/carlosm27/expense_tracker" rel="noopener ugc nofollow" target="_blank">源代码</a></p><p id="e732" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">感谢您阅读这篇文章。如果您有任何问题或反馈，请在评论区或通过我的<a class="ae kx" href="https://twitter.com/Carlos_marcv" rel="noopener ugc nofollow" target="_blank"> Twitter </a>和<a class="ae kx" href="https://www.linkedin.com/in/carlos-armando-marcano-vargas-a2135a134/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>账户告诉我。</p></div><div class="ab cl ld le hr lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ig ih ii ij ik"><p id="3a26" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lk">原发布于</em><a class="ae kx" href="https://carlosmv.hashnode.dev/expenses-tracker-app-using-django-and-pandas" rel="noopener ugc nofollow" target="_blank"><em class="lk">https://Carlos mv . hash node . dev</em></a><em class="lk">。</em></p></div></div>    
</body>
</html>