<html>
<head>
<title>Automate Emailing a Random Quote from a List of Authors</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自动通过电子邮件发送作者列表中的随机引用</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/automate-emailing-a-random-quote-from-a-list-of-authors-7cf4a31c1f3b?source=collection_archive---------13-----------------------#2022-02-16">https://blog.devgenius.io/automate-emailing-a-random-quote-from-a-list-of-authors-7cf4a31c1f3b?source=collection_archive---------13-----------------------#2022-02-16</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="24eb" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">从你最喜欢的作家那里随机引用一段话开始你的一天</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/9d768a61957a1424496471e240728c53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0pFKrZzoNOuwV7BEAGCaFw.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">图片由<a class="ae ks" href="https://unsplash.com/@freestocks" rel="noopener ugc nofollow" target="_blank"> @freestocks </a>提供</figcaption></figure><p id="16cb" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们很多人都是以一杯咖啡开始新的一天，所以为什么不加点味道呢——这是我们最喜欢的作家的一句随机引用。在这篇文章中，我将解释如何使用 Python 每天给你自己和你的朋友发送一封随机报价的电子邮件。</p><p id="7962" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">以下是步骤:</p><ol class=""><li id="2a8a" class="lp lq in kv b kw kx kz la lc lr lg ls lk lt lo lu lv lw lx bi translated">导入包</li><li id="7848" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">定义最喜欢的作者列表</li><li id="31bb" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">在函数中从列表中生成随机引用</li><li id="f73c" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">发送电子邮件</li><li id="dbea" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">如何自动化这项任务</li></ol></div><div class="ab cl md me hr mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ig ih ii ij ik"><ol class=""><li id="0b71" class="lp lq in kv b kw kx kz la lc lr lg ls lk lt lo lu lv lw lx bi translated"><strong class="kv io">导入包:</strong></li></ol><pre class="kd ke kf kg gt mk ml mm mn aw mo bi"><span id="36ab" class="mp mq in ml b gy mr ms l mt mu">import pandas as pd<br/>import datetime<br/>import smtplib<br/>from email.message import EmailMessage<br/>import random<br/>from quote import quote</span></pre><p id="05cc" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io"> 2。定义最喜欢的作者列表</strong></p><pre class="kd ke kf kg gt mk ml mm mn aw mo bi"><span id="6f2b" class="mp mq in ml b gy mr ms l mt mu">mylist = ["leo tolstoy", "simon sinek", "Paulo Coelho", "Stephen Covey", "Tony Robbins", "Mark Twain", "Fyodor Dostoevsky", "Lao Tzu", "Sun Tzu"]</span></pre><p id="d6b4" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">你可以在这里摆弄列表。你可以删除和添加你喜欢的作者。</p><p id="c3da" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io"> 3。在函数</strong>中从列表中生成随机报价</p><pre class="kd ke kf kg gt mk ml mm mn aw mo bi"><span id="04c0" class="mp mq in ml b gy mr ms l mt mu">def quote_generate():<br/>    <br/>    search = random.choice(mylist)<br/>    result = quote(search, limit=1)</span><span id="3392" class="mp mq in ml b gy mv ms l mt mu">df = pd.DataFrame(result)<br/>    <br/>    return df</span><span id="9fb0" class="mp mq in ml b gy mv ms l mt mu">quote_result = quote_generate()</span></pre><p id="399f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在这一步中，我们创建了函数并将信息保存在一个变量中。</p><p id="d612" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io"> 4。发送邮件</strong></p><pre class="kd ke kf kg gt mk ml mm mn aw mo bi"><span id="d659" class="mp mq in ml b gy mr ms l mt mu">def sendEmail(to, sub, msg):<br/>    print(f"email to {to} \nsend with subject: {sub}\n message: {msg}")<br/>    email = EmailMessage()<br/>    email['from'] = 'Reda Aldahan'<br/>    email['to'] = f"{to}"<br/>    email['subject'] = f'{sub}'</span><span id="8f57" class="mp mq in ml b gy mv ms l mt mu">email.set_content(f'{msg}')</span><span id="b446" class="mp mq in ml b gy mv ms l mt mu">with smtplib.SMTP(host='smtp.gmail.com', port=587) as smtp:<br/>        smtp.ehlo()<br/>        smtp.starttls()<br/>        smtp.login('<a class="ae ks" href="mailto:your_Email@gmail.com" rel="noopener ugc nofollow" target="_blank">your_Email@gmail.com</a>','your password')<br/>        smtp.send_message(email)<br/>        print("Email send")<br/>    pass<br/>if __name__ == "__main__":<br/>    df = pd.read_excel("data.xlsx")<br/>    print(df)<br/>    today = datetime.datetime.now().strftime("%d-%m")<br/>    #print(type(today))<br/>    update = []<br/>    td =  datetime.datetime.now().strftime("%d-%m")<br/>    #print(yearnow)<br/>    for index, item in df.iterrows():<br/>        #print(index,item['birthday'])<br/>        #print(type(bday))<br/>        if td not in str(item["Date"]): <br/>            sendEmail(item['Email'] , "Happy QUOTE "+item["Name"], "Your Quote Today: '" + quote_result.iloc[0][2] + "' By " + quote_result.iloc[0][0])<br/>            update.append(index)<br/>    for i in update:<br/>        dt = df.loc[i, 'Date']<br/>        #print(yr)<br/>        df.loc[i,'Date'] = f"{td}, {dt}"<br/>        #print((df.loc[i, 'Year'])<br/>    #print(df)<br/>    df.to_excel("data.xlsx", index=False)</span></pre><p id="cc46" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在这一步中，我们转到一个名为“data”的 excel 文件，并为电子邮件带来一些信息，它们是:</p><p id="03cb" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">a.收件人的姓名</p><p id="5e54" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">b.日期；如果此人今天已经收到报价，并希望添加更多的人并运行代码，此人将不会收到报价</p><p id="04df" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">c.收件人电子邮件</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/ebee9440d0eee7cbc631f595b1ef9aee.png" data-original-src="https://miro.medium.com/v2/resize:fit:642/format:webp/1*KgVnIot5Tp8q0jr1VwSghw.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">这就是它应该看起来的样子</figcaption></figure><p id="c7b9" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果收件人当天没有收到报价，将会发送电子邮件。excel 表中的日期列将更新为今天的日期，因此您可以添加更多的人并立即重新运行代码，那些没有收到报价的人将会收到报价。</p><p id="06a7" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io"> 5。如何自动完成这项任务</strong></p><p id="91ac" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">只需点击一个按钮就可以轻松运行这些代码，但是如果机器可以为您完成这些工作，又何苦呢。</p><p id="7a84" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">a.您可以使用任务计划程序。这里有一篇文森特·塔坦的文章解释如何做到这一点。点击<a class="ae ks" href="https://towardsdatascience.com/automate-your-python-scripts-with-task-scheduler-661d0a40b279" rel="noopener" target="_blank">此处</a>查看文章。</p><p id="94eb" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">b.使用 Python 库:调度。点击<a class="ae ks" href="https://pypi.org/project/schedule/" rel="noopener ugc nofollow" target="_blank">此处</a>阅读更多信息。</p></div><div class="ab cl md me hr mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ig ih ii ij ik"><p id="88eb" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">结尾:</p><p id="846c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">完整的代码和 excel 表格可以在这里找到<a class="ae ks" href="https://github.com/RedaAldahan/Python-Fun/blob/04660cf21e96b66d9d359cb4b00f7b36d9c655e3/Quote_Authors/Quote_From_Authors.py" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="9fd8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">享受你的报价+你的咖啡！</p></div></div>    
</body>
</html>