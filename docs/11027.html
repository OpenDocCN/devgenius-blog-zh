<html>
<head>
<title>Kafka Streaming with Faust Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">卡夫卡与浮士德蟒蛇流</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/kafka-streaming-with-faust-python-a1783c32339b?source=collection_archive---------2-----------------------#2022-12-14">https://blog.devgenius.io/kafka-streaming-with-faust-python-a1783c32339b?source=collection_archive---------2-----------------------#2022-12-14</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/ec066a8d42fcd0545ed0e4899c1c4e19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0fjb2oNT1wad5saK.png"/></div></div></figure><h1 id="157a" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">卡夫卡与浮士德</h1><h1 id="6853" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">介绍</h1><p id="68fe" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">这是一个简单的例子，展示了如何使用 Faust 从 Kafka 获取数据流。数据是一个简单的 JSON 对象，带有时间戳和随机数。数据由 Python 脚本生成，并发送给 Kafka。浮士德习惯于阅读卡夫卡的资料。</p><h1 id="9fc1" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">先决条件</h1><ul class=""><li id="935c" class="lr ls in kv b kw kx la lb le lt li lu lm lv lq lw lx ly lz bi translated">Python 3.6 以上版本</li><li id="462a" class="lr ls in kv b kw ma la mb le mc li md lm me lq lw lx ly lz bi translated">码头工人</li><li id="dec4" class="lr ls in kv b kw ma la mb le mc li md lm me lq lw lx ly lz bi translated">Docker 撰写</li></ul><h1 id="5ee9" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">设置</h1><ol class=""><li id="81f8" class="lr ls in kv b kw kx la lb le lt li lu lm lv lq mf lx ly lz bi translated">克隆存储库</li><li id="cf5e" class="lr ls in kv b kw ma la mb le mc li md lm me lq mf lx ly lz bi translated">运行<code class="fe mg mh mi mj b">docker-compose up -d</code>启动 Kafka 集群</li><li id="60e4" class="lr ls in kv b kw ma la mb le mc li md lm me lq mf lx ly lz bi translated">运行<code class="fe mg mh mi mj b">pip install -r requirements.txt</code>来安装 Python 依赖项</li><li id="abfd" class="lr ls in kv b kw ma la mb le mc li md lm me lq mf lx ly lz bi translated">运行<code class="fe mg mh mi mj b">python main.py</code>启动制作程序</li><li id="2843" class="lr ls in kv b kw ma la mb le mc li md lm me lq mf lx ly lz bi translated">运行<code class="fe mg mh mi mj b">faust -A faust_stream worker -l info</code>启动浮士德工人</li></ol><h1 id="8b10" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">使用</h1><p id="f898" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">制作人会每秒生成一个随机数，并发送给卡夫卡。浮士德工人将从卡夫卡那里读取数据，并将其打印到控制台上。</p><h1 id="36de" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">巨蟒中的浮士德·卡夫卡消费者</h1><p id="886c" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">在浮士德模块的帮助下成为卡夫卡式的消费者。</p><pre class="mk ml mm mn gt mo mj mp bn mq mr bi"><span id="7709" class="ms jw in mj b be mt mu l mv mw">import faust</span></pre><pre class="mx mo mj my mz aw na bi"><span id="217d" class="nb jw in mj b gy nc nd l ne mw">app= faust.App('agents-demo')</span><span id="b286" class="nb jw in mj b gy nf nd l ne mw">greetings_topic = app.topic('greetings', value_type=str, value_serializer='raw')</span><span id="e18e" class="nb jw in mj b gy nf nd l ne mw">@app.agent(greetings_topic)<br/>async def greet(stream):<br/>    async for greeting in stream:<br/>        print(greeting)</span><span id="967b" class="nb jw in mj b gy nf nd l ne mw">if __name__ == '__main__':<br/>    app.main()</span></pre><h1 id="f137" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">启动浮士德工人</h1><p id="39a1" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">现在完成代码后，我们将启动浮士德工人。</p><pre class="mk ml mm mn gt mo mj mp bn mq mr bi"><span id="082b" class="ms jw in mj b be mt mu l mv mw">faust -A faust_stream worker -l info</span></pre><h1 id="c924" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">测试消费者</h1><p id="ec2b" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">现在，我们将通过 docker CLI 向主题发送一些数据来测试消费者</p><pre class="mk ml mm mn gt mo mj mp bn mq mr bi"><span id="7ea6" class="ms jw in mj b be mt mu l mv mw">docker exec -it cli-tools kafka-console-producer --topic=greetings --bootstrap-server broker0:29092</span></pre><h1 id="193a" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">输出</h1><p id="073e" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">制片人截图</p><figure class="mk ml mm mn gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ng"><img src="../Images/cf9043897d72874ff5db47c1fa26a056.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2pL_xHUPpRW6KCJ-.png"/></div></div></figure><p id="3944" class="pw-post-body-paragraph kt ku in kv b kw nh ky kz la ni lc ld le nj lg lh li nk lk ll lm nl lo lp lq ig bi translated">消费者截图</p><figure class="mk ml mm mn gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nm"><img src="../Images/05a9f1a62a4c9ea593d982257f5c4952.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KarruvahUOdSzEbt.png"/></div></div></figure><h1 id="4f52" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">巨蟒中的浮士德·卡夫卡制片人</h1><p id="0022" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">现在让我们借助浮士德模块制作一个制作人。</p><pre class="mk ml mm mn gt mo mj mp bn mq mr bi"><span id="8d6a" class="ms jw in mj b be mt mu l mv mw"># Producer<br/>@app.timer(interval=1.0)<br/>async def send_greeting():<br/>    await greetings_topic.send(value='Hello, World!')</span></pre><p id="9433" class="pw-post-body-paragraph kt ku in kv b kw nh ky kz la ni lc ld le nj lg lh li nk lk ll lm nl lo lp lq ig bi translated">借助以下命令再次启动该文件</p><pre class="mk ml mm mn gt mo mj mp bn mq mr bi"><span id="1685" class="ms jw in mj b be mt mu l mv mw">faust -A faust_stream worker -l info</span></pre><p id="90c3" class="pw-post-body-paragraph kt ku in kv b kw nh ky kz la ni lc ld le nj lg lh li nk lk ll lm nl lo lp lq ig bi translated">现在，您将每秒在消费者中看到 hello world 消息。</p><h1 id="27cb" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">查看 GitHub 上的代码:</h1><p id="1964" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">【https://github.com/SohaibAnwaar/Kafka-Faust-Python T4】</p><h1 id="e446" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">作者</h1><ul class=""><li id="5921" class="lr ls in kv b kw kx la lb le lt li lu lm lv lq lw lx ly lz bi translated">索海卜·安瓦尔:<a class="ae nn" href="https://www.sohaibanwaar.com/" rel="noopener ugc nofollow" target="_blank">https://www.sohaibanwaar.com</a></li><li id="6b85" class="lr ls in kv b kw ma la mb le mc li md lm me lq lw lx ly lz bi translated">Gmail:<a class="ae nn" href="mailto:sohaibanwaar36@gmail.com" rel="noopener ugc nofollow" target="_blank">sohaibanwaar36@gmail.com</a></li><li id="03bf" class="lr ls in kv b kw ma la mb le mc li md lm me lq lw lx ly lz bi translated">LinkedIn : <a class="ae nn" href="https://www.linkedin.com/in/sohaib-anwaar-4b7ba1187/" rel="noopener ugc nofollow" target="_blank">这里有一些专业的谈话</a></li><li id="a5d0" class="lr ls in kv b kw ma la mb le mc li md lm me lq lw lx ly lz bi translated">堆栈溢出:<a class="ae nn" href="https://stackoverflow.com/users/7959545/sohaib-anwaar" rel="noopener ugc nofollow" target="_blank">在这里获得我的帮助</a></li><li id="d188" class="lr ls in kv b kw ma la mb le mc li md lm me lq lw lx ly lz bi translated">在这里查看我的杰作</li><li id="15e1" class="lr ls in kv b kw ma la mb le mc li md lm me lq lw lx ly lz bi translated">GitHub : <a class="ae nn" href="https://github.com/SohaibAnwaar" rel="noopener ugc nofollow" target="_blank">在这里查看我的代码</a></li></ul></div></div>    
</body>
</html>