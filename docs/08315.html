<html>
<head>
<title>Using Unity’s Graph View</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Unity 的图形视图</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/using-unitys-graph-view-4cc55b704548?source=collection_archive---------2-----------------------#2022-06-05">https://blog.devgenius.io/using-unitys-graph-view-4cc55b704548?source=collection_archive---------2-----------------------#2022-06-05</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="10eb" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">在编辑器中连接节点</h2></div><p id="92a9" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在我有了在编辑器上添加和删除节点的方法，我需要一种将节点连接在一起的方法。有些节点有子节点，有些没有。当节点连接后，需要正确设置子节点。图形视图节点是端口，我可以用它来帮助建立这些连接。</p><div class="ky kz gp gr la lb"><a href="https://docs.unity3d.com/ScriptReference/Experimental.GraphView.Port.html" rel="noopener  ugc nofollow" target="_blank"><div class="lc ab fo"><div class="ld ab le cl cj lf"><h2 class="bd io gy z fp lg fr fs lh fu fw im bi translated">港口</h2><div class="li l"><h3 class="bd b gy z fp lg fr fs lh fu fw dk translated">实验性的:这个 API 是实验性的，将来可能会改变或删除。班级在…</h3></div><div class="lj l"><p class="bd b dl z fp lg fr fs lh fu fw dk translated">docs.unity3d.com</p></div></div><div class="lk l"><div class="ll l lm ln lo lk lp lq lb"/></div></div></a></div><h1 id="def0" class="lr ls in bd lt lu lv lw lx ly lz ma mb jt mc ju md jw me jx mf jz mg ka mh mi bi translated">创建端口</h1><p id="38fe" class="pw-post-body-paragraph kc kd in ke b kf mj jo kh ki mk jr kk kl ml kn ko kp mm kr ks kt mn kv kw kx ig bi translated">我的行为树节点视图需要一个输入端口和一个输出端口。</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi mo"><img src="../Images/1dfc6a07c28482bc2c5bd7e05ca51d1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H_7DDi5FLWqiiFrw7glvGg.png"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">添加到行为树节点视图的输入和输出端口</figcaption></figure><p id="9847" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在我需要两种方法来创建我的端口。我创建了输入端口和输出端口，然后从构造函数中调用它们。</p><figure class="mp mq mr ms gt mt"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="8019" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我将从创建输入端口开始，因为我的所有节点类型都将是相同的。现在图形视图节点有了一个名为 Instantiate Port 的方法，使创建端口变得容易。</p><div class="ky kz gp gr la lb"><a href="https://docs.unity3d.com/ScriptReference/Experimental.GraphView.Node.InstantiatePort.html" rel="noopener  ugc nofollow" target="_blank"><div class="lc ab fo"><div class="ld ab le cl cj lf"><h2 class="bd io gy z fp lg fr fs lh fu fw im bi translated">Unity 脚本 API:实验性的。GraphView.Node.InstantiatePort(方位、方向、类型)</h2><div class="li l"><h3 class="bd b gy z fp lg fr fs lh fu fw dk translated">感谢您帮助我们提高 Unity 文档的质量。虽然我们不能接受所有的提交，但我们…</h3></div><div class="lj l"><p class="bd b dl z fp lg fr fs lh fu fw dk translated">docs.unity3d.com</p></div></div><div class="lk l"><div class="nf l lm ln lo lk lp lq lb"/></div></div></a></div><p id="23e6" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这个方法有 4 个参数。</p><ol class=""><li id="84db" class="ng nh in ke b kf kg ki kj kl ni kp nj kt nk kx nl nm nn no bi translated">方向—端口的方向。可以是<a class="ae np" href="https://docs.unity3d.com/2021.3/Documentation/ScriptReference/Experimental.GraphView.Orientation.Horizontal.html" rel="noopener ugc nofollow" target="_blank">水平</a>(向左或向右流动的连接)或<a class="ae np" href="https://docs.unity3d.com/2021.3/Documentation/ScriptReference/Experimental.GraphView.Orientation.Vertical.html" rel="noopener ugc nofollow" target="_blank">垂直</a>(向上或向下流动的连接)</li><li id="a51c" class="ng nh in ke b kf nq ki nr kl ns kp nt kt nu kx nl nm nn no bi translated">方向—端口的方向。可以是<a class="ae np" href="https://docs.unity3d.com/2021.3/Documentation/ScriptReference/Experimental.GraphView.Direction.Input.html" rel="noopener ugc nofollow" target="_blank">输入</a>或<a class="ae np" href="https://docs.unity3d.com/2021.3/Documentation/ScriptReference/Experimental.GraphView.Direction.Output.html" rel="noopener ugc nofollow" target="_blank">输出</a></li><li id="5a10" class="ng nh in ke b kf nq ki nr kl ns kp nt kt nu kx nl nm nn no bi translated">容量—一个端口可以连接多少条边。可以是<a class="ae np" href="https://docs.unity3d.com/2021.3/Documentation/ScriptReference/Experimental.GraphView.Port.Capacity.Single.html" rel="noopener ugc nofollow" target="_blank">单</a>(只能有单个连接)或<a class="ae np" href="https://docs.unity3d.com/2021.3/Documentation/ScriptReference/Experimental.GraphView.Port.Capacity.Multi.html" rel="noopener ugc nofollow" target="_blank">多</a>(可以有多个连接)。(Unity 文档中未显示，但为必填项)。</li><li id="b6ca" class="ng nh in ke b kf nq ki nr kl ns kp nt kt nu kx nl nm nn no bi translated">类型—端口的数据类型。通常用于确定端口是否可以连接到此端口。即输出端口只能连接到 int 的输入端口。</li></ol><h2 id="b039" class="nv ls in bd lt nw nx dn lx ny nz dp mb kl oa ob md kp oc od mf kt oe of mh og bi translated">创建输入端口</h2><p id="9347" class="pw-post-body-paragraph kc kd in ke b kf mj jo kh ki mk jr kk kl ml kn ko kp mm kr ks kt mn kv kw kx ig bi translated">我希望我的连接上下流动。所以我将使用垂直方向。这是一个输入，因此将输入方向。我将允许多个输入到一个节点，这将允许不止一个路径到达叶子。我将使用节点的数据类型。</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi oh"><img src="../Images/81491560c408d93d75c8a0d329f4a836.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3N_0VIBjYg2MlWslSfH74A.png"/></div></div></figure><p id="7e6f" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果由于某种原因，输入未能创建，就没有什么可做的了。否则，我将输入端口名设置为 nothing，它默认为数据类型的名称。最后需要做的是添加这个输入容器。我可以向输入容器中添加多个不同的输入，就像一些着色器图形节点一样。输入容器保存所有进入节点的输入。</p><figure class="mp mq mr ms gt mt"><div class="bz fp l di"><div class="nd ne l"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">行为树节点视图创建输入端口</figcaption></figure><p id="64e1" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">创建了输入端口的我的行为树。</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi oi"><img src="../Images/11f29a2b2df1972fa90f8a4d7a283869.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RYO4dDS4UCD8RRmh25gApQ.png"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">带有输入端口的行为树编辑器</figcaption></figure><h2 id="079d" class="nv ls in bd lt nw nx dn lx ny nz dp mb kl oa ob md kp oc od mf kt oe of mh og bi translated">创建输出端口</h2><p id="9e98" class="pw-post-body-paragraph kc kd in ke b kf mj jo kh ki mk jr kk kl ml kn ko kp mm kr ks kt mn kv kw kx ig bi translated">现在，输出端口将略有不同。这取决于我有什么输出端口的节点类型。动作节点将没有输出端口。复合节点将是垂直流、输出、多输出(因为它们允许多个子节点)，并且具有节点数据类型。装饰节点将是垂直流、输出、单输出(因为它们只允许有一个子节点)，并且具有节点数据类型。我将使用 switch 语句来确定要创建的输出端口。</p><figure class="mp mq mr ms gt mt"><div class="bz fp l di"><div class="nd ne l"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">打开节点创建输出端口</figcaption></figure><p id="7d55" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">除了我将输出端口添加到输出容器之外，其余的输出创建与输入创建相同。现在我有了输入端口和输出端口。</p><figure class="mp mq mr ms gt mt"><div class="bz fp l di"><div class="nd ne l"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">将输出添加到容器</figcaption></figure><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi oj"><img src="../Images/dd3f3f9833df65dc2c732b71e8581f22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b2zwKcuGHbwoO1yyFuwERw.png"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">创建输出端口</figcaption></figure><p id="e570" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">需要输出端口的节点现在有了输出端口。</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi ok"><img src="../Images/90be103b1596b8917552b93c30574c3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iunbafOS9Hq38bSTYJes7A.png"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">带有输入和输出端口的行为树编辑器</figcaption></figure><h1 id="090a" class="lr ls in bd lt lu lv lw lx ly lz ma mb jt mc ju md jw me jx mf jz mg ka mh mi bi translated">建立联系。</h1><p id="fd83" class="pw-post-body-paragraph kc kd in ke b kf mj jo kh ki mk jr kk kl ml kn ko kp mm kr ks kt mn kv kw kx ig bi translated">端口已创建，但它们不进行任何连接。我必须在行为树视图中覆盖一个方法来获得兼容的端口。此方法返回与起始端口兼容的端口列表。这决定了哪些端口相互兼容。</p><div class="ky kz gp gr la lb"><a href="https://docs.unity3d.com/ScriptReference/Experimental.GraphView.GraphView.GetCompatiblePorts.html" rel="noopener  ugc nofollow" target="_blank"><div class="lc ab fo"><div class="ld ab le cl cj lf"><h2 class="bd io gy z fp lg fr fs lh fu fw im bi translated">Unity 脚本 API:实验性的。graph view . graph view . getcompatibleports</h2><div class="li l"><h3 class="bd b gy z fp lg fr fs lh fu fw dk translated">感谢您帮助我们提高 Unity 文档的质量。虽然我们不能接受所有的提交，但我们…</h3></div><div class="lj l"><p class="bd b dl z fp lg fr fs lh fu fw dk translated">docs.unity3d.com</p></div></div><div class="lk l"><div class="ol l lm ln lo lk lp lq lb"/></div></div></a></div><p id="fc5d" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我将使用 Linq 和 Lambda 表达式来确定哪些端口兼容哪些端口。</p><div class="ky kz gp gr la lb"><a href="https://docs.microsoft.com/en-us/dotnet/api/system.linq.queryable.where?view=net-6.0" rel="noopener  ugc nofollow" target="_blank"><div class="lc ab fo"><div class="ld ab le cl cj lf"><h2 class="bd io gy z fp lg fr fs lh fu fw im bi translated">可查询。Where 方法(系统。Linq)</h2><div class="li l"><h3 class="bd b gy z fp lg fr fs lh fu fw dk translated">其中(IQueryable，Expression &gt;)根据谓词筛选值序列。每个元素的索引用于…</h3></div><div class="lj l"><p class="bd b dl z fp lg fr fs lh fu fw dk translated">docs.microsoft.com</p></div></div><div class="lk l"><div class="om l lm ln lo lk lp lq lb"/></div></div></a></div><p id="2ef0" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我在图形视图中获得所有端口的列表，在条件匹配的地方获得 IEnumerable <tsource>。然后我必须将结果转换回一个列表。我返回转换后的列表。</tsource></p><p id="9e87" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">什么端口兼容什么端口？</p><ol class=""><li id="9cb7" class="ng nh in ke b kf kg ki kj kl ni kp nj kt nk kx nl nm nn no bi translated">一个端口必须是输入，另一个必须是输出。</li><li id="2d20" class="ng nh in ke b kf nq ki nr kl ns kp nt kt nu kx nl nm nn no bi translated">节点无法连接到自身。</li><li id="1508" class="ng nh in ke b kf nq ki nr kl ns kp nt kt nu kx nl nm nn no bi translated">端口必须是相同的端口类型。</li></ol><figure class="mp mq mr ms gt mt"><div class="bz fp l di"><div class="nd ne l"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">获取兼容端口</figcaption></figure><p id="91ee" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我现在可以正确地连接我的节点。</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi on"><img src="../Images/6b6cb7ccac8678ddefb22647e79f26d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*c3-AQmmaatswAmmRqIRXEQ.gif"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">建立联系</figcaption></figure><h1 id="fd61" class="lr ls in bd lt lu lv lw lx ly lz ma mb jt mc ju md jw me jx mf jz mg ka mh mi bi translated">从联系中创造孩子</h1><p id="867c" class="pw-post-body-paragraph kc kd in ke b kf mj jo kh ki mk jr kk kl ml kn ko kp mm kr ks kt mn kv kw kx ig bi translated">为了让我能够在编辑器中添加、删除子节点，或者从连接中获取节点的子节点，我需要创建一个方法，来添加子节点，从阳极中删除子节点，并从节点中获取子节点列表。</p><h2 id="bbf3" class="nv ls in bd lt nw nx dn lx ny nz dp mb kl oa ob md kp oc od mf kt oe of mh og bi translated">结节</h2><p id="211b" class="pw-post-body-paragraph kc kd in ke b kf mj jo kh ki mk jr kk kl ml kn ko kp mm kr ks kt mn kv kw kx ig bi translated">我将从节点本身开始。这些将是空方法，实际实现这些方法(复合和装饰)将取决于有子节点的节点，但是行为树将能够调用这些方法。</p><figure class="mp mq mr ms gt mt"><div class="bz fp l di"><div class="nd ne l"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">节点添加子节点、删除子节点和获取子节点</figcaption></figure><h2 id="b7d0" class="nv ls in bd lt nw nx dn lx ny nz dp mb kl oa ob md kp oc od mf kt oe of mh og bi translated">装饰节点</h2><p id="9094" class="pw-post-body-paragraph kc kd in ke b kf mj jo kh ki mk jr kk kl ml kn ko kp mm kr ks kt mn kv kw kx ig bi translated">装饰器只有一个子节点，所以添加子节点时，我只是将子节点设置为传入节点。为了移除子节点，我检查子节点是否是传入的节点，如果是，我将子节点设置为 null，Get 子节点返回一个包含子节点的列表。</p><figure class="mp mq mr ms gt mt"><div class="bz fp l di"><div class="nd ne l"/></div></figure><h2 id="0c9a" class="nv ls in bd lt nw nx dn lx ny nz dp mb kl oa ob md kp oc od mf kt oe of mh og bi translated">复合节点</h2><p id="6533" class="pw-post-body-paragraph kc kd in ke b kf mj jo kh ki mk jr kk kl ml kn ko kp mm kr ks kt mn kv kw kx ig bi translated">这个比较好做。我将孩子添加到孩子中，将孩子从孩子中移除并返回孩子。</p><figure class="mp mq mr ms gt mt"><div class="bz fp l di"><div class="nd ne l"/></div></figure><h2 id="b030" class="nv ls in bd lt nw nx dn lx ny nz dp mb kl oa ob md kp oc od mf kt oe of mh og bi translated">行为树</h2><p id="cf18" class="pw-post-body-paragraph kc kd in ke b kf mj jo kh ki mk jr kk kl ml kn ko kp mm kr ks kt mn kv kw kx ig bi translated">行为树需要能够从父节点添加、移除和获取子节点。</p><figure class="mp mq mr ms gt mt"><div class="bz fp l di"><div class="nd ne l"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">行为树添加子对象、删除子对象、获取子对象</figcaption></figure><p id="63b1" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">要在行为树中向父节点添加子节点，我首先需要确保父节点存在于节点中。如果没有，那么就没有必要继续下去；如果是，那么我将子节点添加到父节点。如果节点列表中不存在该子节点，我也会添加它。</p><figure class="mp mq mr ms gt mt"><div class="bz fp l di"><div class="nd ne l"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">行为树添加子树</figcaption></figure><p id="3ee6" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">要从行为树的父节点中移除子节点，我首先需要确保父节点存在于节点中。如果没有，那么就没有必要继续。如果是，那么我从父节点中移除子节点。</p><figure class="mp mq mr ms gt mt"><div class="bz fp l di"><div class="nd ne l"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">行为树删除子项</figcaption></figure><p id="0a6f" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果节点是父节点，我返回父节点的子节点，否则我返回一个空列表。</p><figure class="mp mq mr ms gt mt"><div class="bz fp l di"><div class="nd ne l"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">行为树获取子对象</figcaption></figure><h2 id="b458" class="nv ls in bd lt nw nx dn lx ny nz dp mb kl oa ob md kp oc od mf kt oe of mh og bi translated">行为树视图</h2><p id="b61a" class="pw-post-body-paragraph kc kd in ke b kf mj jo kh ki mk jr kk kl ml kn ko kp mm kr ks kt mn kv kw kx ig bi translated">要删除边，我需要挂钩到图形视图，更改要删除的元素，就像我在编辑器中添加和删除节点一样。</p><p id="d314" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在每个循环的元素中，我将元素转换为边。如果这个元素是边，我从边输出节点视图得到父视图，从边输入节点得到子视图。然后，我从树的父视图节点中移除子视图节点。</p><figure class="mp mq mr ms gt mt"><div class="bz fp l di"><div class="nd ne l"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">行为树视图图形视图更改了方法 f 有要删除的元素</figcaption></figure><p id="b6a6" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为了从父对象 I 创建子对象，要将图形视图中的钩子更改为创建边。</p><div class="ky kz gp gr la lb"><a href="https://docs.unity3d.com/ScriptReference/Experimental.GraphView.GraphViewChange-edgesToCreate.html" rel="noopener  ugc nofollow" target="_blank"><div class="lc ab fo"><div class="ld ab le cl cj lf"><h2 class="bd io gy z fp lg fr fs lh fu fw im bi translated">Unity 脚本 API:实验性的。GraphView</h2><div class="li l"><h3 class="bd b gy z fp lg fr fs lh fu fw dk translated">感谢您帮助我们提高 Unity 文档的质量。虽然我们不能接受所有的提交，但我们…</h3></div><div class="lj l"><p class="bd b dl z fp lg fr fs lh fu fw dk translated">docs.unity3d.com</p></div></div><div class="lk l"><div class="oo l lm ln lo lk lp lq lb"/></div></div></a></div><p id="fc5a" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果有边要创建，我就遍历所有的边。我从边的输出节点获得父视图，从边的输入节点获得子视图。然后，我将子视图节点添加到树上的父视图节点中。</p><figure class="mp mq mr ms gt mt"><div class="bz fp l di"><div class="nd ne l"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">如果有要创建的边，行为树视图图形视图更改了方法</figcaption></figure><p id="c78a" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我最终得到的方法是这样的。</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi op"><img src="../Images/db494b6d4bf4751dc7339b9d98dca427.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TJKXC_luCelPgnwwQkL2aA.png"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">行为树视图图形视图更改方法</figcaption></figure><p id="fec6" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在我有了创建正确父子关系的边。</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi oq"><img src="../Images/bd5e10403d9f06a4284b9b5bd6682801.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*FUcSYHOhkhI6a6VsrjpmDA.gif"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">行为树编辑器在建立连接时添加子节点</figcaption></figure><p id="807c" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果我将选择更改为不同的行为树并返回，我仍然有正确的关系，但编辑器不再正确显示它。为了解决这个问题，我必须将它添加到 Populate View 方法中。</p><p id="666b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我需要遍历树中的所有节点</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi or"><img src="../Images/8404a3c5bc9dc218de2f34d061659327.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_IyiZQkxh2OgY1RD4vsJFw.png"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">遍历树中的所有节点</figcaption></figure><p id="3fcc" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">接下来，我需要从节点获取行为树节点视图，这是包含我进行连接的端口的视图。幸运的是，Unity 为图形视图提供了完美的方法。</p><div class="ky kz gp gr la lb"><a href="https://docs.unity3d.com/ScriptReference/Experimental.GraphView.GraphView.GetNodeByGuid.html" rel="noopener  ugc nofollow" target="_blank"><div class="lc ab fo"><div class="ld ab le cl cj lf"><h2 class="bd io gy z fp lg fr fs lh fu fw im bi translated">Unity 脚本 API:实验性的。graph view . graph view . getnodebyuid</h2><div class="li l"><h3 class="bd b gy z fp lg fr fs lh fu fw dk translated">感谢您帮助我们提高 Unity 文档的质量。虽然我们不能接受所有的提交，但我们…</h3></div><div class="lj l"><p class="bd b dl z fp lg fr fs lh fu fw dk translated">docs.unity3d.com</p></div></div><div class="lk l"><div class="os l lm ln lo lk lp lq lb"/></div></div></a></div><p id="4aa5" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这需要一个 guid 字符串，碰巧我的节点包含这个字符串。现在这个方法给了我<a class="ae np" href="https://docs.unity3d.com/ScriptReference/Experimental.GraphView.Node.html" rel="noopener ugc nofollow" target="_blank">实验。具有此 guid 的 GraphView.Node </a>。碰巧我的行为树节点视图是一个<a class="ae np" href="https://docs.unity3d.com/ScriptReference/Experimental.GraphView.Node.html" rel="noopener ugc nofollow" target="_blank">实验。我知道我可以安全地进行造型，并且我拥有的对象就是我想要的。</a></p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi ot"><img src="../Images/a33effb7870aa8518ddc78d1bce4d6b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pfz1JecoSHgjmDFcQhgLew.png"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">获取父节点的节点视图</figcaption></figure><p id="8dcb" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在我需要浏览节点的所有子节点。</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi ou"><img src="../Images/794f4126d7589b87058e43673c234a2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JrVu2GX2KP2wl3-O5NV-aA.png"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">遍历所有子节点</figcaption></figure><p id="e9f2" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我需要连接的端口是子行为树节点视图的输入，所以我将使用<a class="ae np" href="https://docs.unity3d.com/ScriptReference/Experimental.GraphView.GraphView.GetNodeByGuid.html" rel="noopener ugc nofollow" target="_blank"> GraphView。获取视图的 GetNodeByGuid </a>方法。</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi ot"><img src="../Images/54df000346233bf71fb9fa8e5eed4c08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MRSrMcmjSUNBr9JmdJ9xpg.png"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">获取子行为树节点视图</figcaption></figure><p id="4816" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我要做的就是建立联系。碰巧的是，Unity 为我提供了这样做的方法。</p><div class="ky kz gp gr la lb"><a href="https://docs.unity3d.com/ScriptReference/Experimental.GraphView.Port.ConnectTo.html" rel="noopener  ugc nofollow" target="_blank"><div class="lc ab fo"><div class="ld ab le cl cj lf"><h2 class="bd io gy z fp lg fr fs lh fu fw im bi translated">Unity 脚本 API:实验性的。图表视图</h2><div class="li l"><h3 class="bd b gy z fp lg fr fs lh fu fw dk translated">实验性的:这个 API 是实验性的，将来可能会改变或删除。建议一个变化谢谢…</h3></div><div class="lj l"><p class="bd b dl z fp lg fr fs lh fu fw dk translated">docs.unity3d.com</p></div></div><div class="lk l"><div class="ov l lm ln lo lk lp lq lb"/></div></div></a></div><p id="b922" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><a class="ae np" href="https://docs.unity3d.com/ScriptReference/Experimental.GraphView.Port.ConnectTo.html" rel="noopener ugc nofollow" target="_blank">港口。ConnectTo </a>会给我一个<a class="ae np" href="https://docs.unity3d.com/ScriptReference/Experimental.GraphView.Edge.html" rel="noopener ugc nofollow" target="_blank">实验。GraphView.Edge </a></p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi ow"><img src="../Images/ec844b67b7ada983f1912371f8603b2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YjXmkBYCuusqqOeLjkL1Yw.png"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">从连接父输出到子输入中获取边</figcaption></figure><p id="ea73" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这条边恰好是可以添加到图形视图中的可视元素。</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/13397896fa1d276e68aa34fdbfbb5d2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*fgNRUv5I-46vmrWdWTKwYA.png"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">将边添加到图表视图中</figcaption></figure><p id="664c" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">完整的循环看起来像。</p><figure class="mp mq mr ms gt mt"><div class="bz fp l di"><div class="nd ne l"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">将子项作为连接进行填充</figcaption></figure><p id="5e41" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我用 LINQ 表达式来做同样的事情来做同样的事情，我只是把它分解成解释上面的每个部分。LINQ 对我来说更容易阅读和理解我计划实现的目标。</p><figure class="mp mq mr ms gt mt"><div class="bz fp l di"><div class="nd ne l"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">对于通过将所有父节点连接到其子节点而得到的每条边，将边添加到图形视图中。</figcaption></figure><p id="f20f" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我的填充视图方法如下所示。</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi oy"><img src="../Images/d87819bf3977c978b22024ac8e9c9fc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i9EqEw0NHhyRE8qKFz93Fg.png"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">行为树填充视图现在填充到子节点的连接</figcaption></figure><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi oz"><img src="../Images/a7d413d80c38a18579689cbfdff01073.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Mfc4U4rV-u1JBll-IltwSQ.gif"/></div></div></figure><h1 id="0b47" class="lr ls in bd lt lu lv lw lx ly lz ma mb jt mc ju md jw me jx mf jz mg ka mh mi bi translated">结论</h1><p id="152d" class="pw-post-body-paragraph kc kd in ke b kf mj jo kh ki mk jr kk kl ml kn ko kp mm kr ks kt mn kv kw kx ig bi translated">我已经使用端口在节点之间建立了连接。我已经加入到了 Graph View Changed 事件中，以使这些连接有意义，将行为树节点视图的可视元素更改为可脚本化对象节点的子节点。我带走了可脚本化对象节点的子节点，并使它们在编辑器中可视化显示。有许多事情可以做来改善这种情况。例如，使复合节点列表可重新排序，将输出端口更改为单输出列表，而不是多输出列表，为复合节点包含的每个子节点设置一个输出端口，并按子节点在输出上的顺序对其进行排序。<a class="ae np" href="https://docs.unity3d.com/ScriptReference/Experimental.GraphView.GraphView.html" rel="noopener ugc nofollow" target="_blank">单位编辑者。实验性的。graph view。graph view</a>还有许多其他功能可以用来帮助处理事情。UnityEditor。实验性的。GraphView 命名空间有各种各样的东西，比如<a class="ae np" href="https://docs.unity3d.com/ScriptReference/Experimental.GraphView.Blackboard.html" rel="noopener ugc nofollow" target="_blank"> Blackboard </a>或<a class="ae np" href="https://docs.unity3d.com/ScriptReference/Experimental.GraphView.GraphViewBlackboardWindow.html" rel="noopener ugc nofollow" target="_blank">Graph View Blackboard Window</a>等等。我建议您看看这些东西，或者更详细地看看本文中介绍的一些东西，比如<a class="ae np" href="https://docs.unity3d.com/ScriptReference/Experimental.GraphView.Port.html" rel="noopener ugc nofollow" target="_blank">端口</a>或<a class="ae np" href="https://docs.unity3d.com/ScriptReference/Experimental.GraphView.Node.html" rel="noopener ugc nofollow" target="_blank">节点</a>。</p></div></div>    
</body>
</html>