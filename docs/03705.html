<html>
<head>
<title>AWS Fargate — re:Invent 2020 Updates</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS Fargate-re:发明2020更新</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/aws-fargate-re-invent-2020-updates-32ee2cf0f7d9?source=collection_archive---------3-----------------------#2020-12-06">https://blog.devgenius.io/aws-fargate-re-invent-2020-updates-32ee2cf0f7d9?source=collection_archive---------3-----------------------#2020-12-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="0acf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在AWS Fargate上运行容器的新更新&amp;与其他云产品的比较。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/8a42f1d862fc9b8c8dffde4c81ad555c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UBnjyl3L6kBczrkk.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">图片来源:<a class="ae lb" href="https://ecsworkshop.com/introduction/whyfargate/" rel="noopener ugc nofollow" target="_blank"> ECS工作坊</a></figcaption></figure><p id="5cb5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">到目前为止，re:Invent 2020在容器轨道方面的亮点是宣布<a class="ae lb" href="https://aws.amazon.com/eks/eks-anywhere/" rel="noopener ugc nofollow" target="_blank"> ECS/EKS anywhere </a>将使用AWS在内部部署容器。这一声明强调了AWS拥抱多重/混合云的主题，反映了我在“<a class="ae lb" href="https://medium.com/dataseries/why-bigquery-omni-is-a-big-deal-e7e696b4cd60" rel="noopener">为什么BigQuery Omni很重要</a>”中提到的GCP的战略。</p><p id="140f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">与此同时，AWS还发布了AWS Fargate的一些新更新，这是一个在EKS/ECS上运行容器的无服务器产品。在本文中，我们将介绍AWS容器产品，重点介绍Fargate及其新特性，并将它与其他云供应商的同类产品进行比较。</p><h1 id="f75c" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">AWS Fargate</h1><p id="20e1" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">AWS根据管理(ECS和EKS)和托管(EC2和Fargate)来细分其容器产品:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mf"><img src="../Images/4937e2b7327d793a17ab542f7f729292.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M_1hvRt3za3hRpzw6FnqJA.png"/></div></div></figure><p id="85fa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">与解决容器编排的ECS和EKS不同，AWS Fargate提供了一个无服务器的计算引擎来部署容器，并让AWS管理底层基础设施，类似于AWS Lambda对函数的处理。与任何无服务器产品一样，使用Fargate的主要优势是底层基础设施(在本例中是运行容器所需的计算)由AWS管理。简而言之，AWS将匹配正确的实例类，并根据需要相应地扩展集群容量。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mg"><img src="../Images/893e0ca237af30549c7dce284e9132ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P1WxyTR_q6WWI2FN4C4WTQ.png"/></div></div></figure><h2 id="74e0" class="mh ld iq bd le mi mj dn li mk ml dp lm jy mm mn lq kc mo mp lu kg mq mr ly ms bi translated">新的Fargate特性</h2><p id="ecaf" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">迄今为止，Fargate的主要目标是为现有的ECE/EKS用户运行无状态应用程序。许多关于Fargate的客户评价涵盖了Fargate简化了许多DevOps需求的用例，即使团队在ECE或EKS上使用Spot实例优化了结构。</p><p id="f810" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为此，支持AWS批处理作业和Fluent Bit的声明建议进一步支持具有大数据或分析需求的团队简化他们的工作流并获得更多见解。</p><p id="d84a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">新更新</strong>:</p><ul class=""><li id="cbf6" class="mt mu iq jp b jq jr ju jv jy mv kc mw kg mx kk my mz na nb bi translated">亚马逊EFS支持持久存储</li><li id="fd9c" class="mt mu iq jp b jq nc ju nd jy ne kc nf kg ng kk my mz na nb bi translated">暂时存储增加到20GB</li><li id="99f6" class="mt mu iq jp b jq nc ju nd jy ne kc nf kg ng kk my mz na nb bi translated">默认情况下加密的临时存储</li><li id="8d8c" class="mt mu iq jp b jq nc ju nd jy ne kc nf kg ng kk my mz na nb bi translated">通过容器洞察和任务元数据展现的网络性能指标</li><li id="666e" class="mt mu iq jp b jq nc ju nd jy ne kc nf kg ng kk my mz na nb bi translated">支持CAP_SYS_PTRACE</li><li id="a8c9" class="mt mu iq jp b jq nc ju nd jy ne kc nf kg ng kk my mz na nb bi translated">Containerd作为容器运行时(替换了Docker)</li><li id="9a5e" class="mt mu iq jp b jq nc ju nd jy ne kc nf kg ng kk my mz na nb bi translated">针对服务配额的使用指标</li><li id="a9a5" class="mt mu iq jp b jq nc ju nd jy ne kc nf kg ng kk my mz na nb bi translated">增加了默认并发任务/pod服务配额</li><li id="85c8" class="mt mu iq jp b jq nc ju nd jy ne kc nf kg ng kk my mz na nb bi translated"><a class="ae lb" href="https://aws.amazon.com/blogs/aws/new-fully-serverless-batch-computing-with-aws-batch-support-for-aws-fargate/" rel="noopener ugc nofollow" target="_blank">Fargate(ECS)的AWS批处理作业</a></li><li id="5991" class="mt mu iq jp b jq nc ju nd jy ne kc nf kg ng kk my mz na nb bi translated"><a class="ae lb" href="https://aws.amazon.com/blogs/containers/fluent-bit-for-amazon-eks-on-aws-fargate-is-here/" rel="noopener ugc nofollow" target="_blank">流畅的钻头支持</a></li></ul><p id="f22f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">仍不支持:</strong></p><ul class=""><li id="64fc" class="mt mu iq jp b jq jr ju jv jy mv kc mw kg mx kk my mz na nb bi translated">特许集装箱</li><li id="b556" class="mt mu iq jp b jq nc ju nd jy ne kc nf kg ng kk my mz na nb bi translated">添加或删除除CAP_SYS_PTRACE之外的Linux功能</li><li id="10cd" class="mt mu iq jp b jq nc ju nd jy ne kc nf kg ng kk my mz na nb bi translated">Amazon EBS对持久存储的支持</li><li id="8650" class="mt mu iq jp b jq nc ju nd jy ne kc nf kg ng kk my mz na nb bi translated">Windows操作系统</li><li id="e365" class="mt mu iq jp b jq nc ju nd jy ne kc nf kg ng kk my mz na nb bi translated">ARM架构</li><li id="aba7" class="mt mu iq jp b jq nc ju nd jy ne kc nf kg ng kk my mz na nb bi translated">绘图处理器</li><li id="eb6a" class="mt mu iq jp b jq nc ju nd jy ne kc nf kg ng kk my mz na nb bi translated">EKS的守护天使</li></ul><p id="c1d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">考虑到这些限制，如果您需要管理状态并且仍然希望利用Fargate，请确保容器与其他AWS服务(例如DynamoDB、RDS、ElastiCache)集成。为了绕过DaemonSets对EKS的限制，为每个pod模仿sidecar模式的行为，因为Fargate支持多容器pod。</p><h1 id="e5d2" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">与GCP和Azure产品的比较</h1><p id="8815" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">Fargate不是唯一的无服务器容器服务:GCP有<a class="ae lb" href="https://cloud.google.com/run" rel="noopener ugc nofollow" target="_blank">云运行</a>和Azure提供<a class="ae lb" href="https://azure.microsoft.com/en-us/services/container-instances/#features" rel="noopener ugc nofollow" target="_blank">容器实例</a>。虽然他们三个都在引擎盖下使用Kubernetes，但他们的方法略有不同。</p><p id="f46f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="nh">注:如果您想要全面比较托管Kubernetes产品，请查看“</em> <a class="ae lb" href="https://medium.com/swlh/state-of-managed-kubernetes-2020-4be006643360#:~:text=According%20to%20Cloud%20Native%20Computing,and%20GCP%20leading%20the%20pack." rel="noopener"> <em class="nh">托管Kubernetes 2020</em></a><em class="nh">”</em></p><h2 id="e62d" class="mh ld iq bd le mi mj dn li mk ml dp lm jy mm mn lq kc mo mp lu kg mq mr ly ms bi translated">谷歌云运行</h2><p id="c5e3" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">谷歌云用户既可以将Cloud Run作为类似于云功能的独立PaaS产品使用，也可以将其与现有的GKE集群集成，类似于EKS的Fargate。GKE混合云用户也可以在Anthos上使用Cloud Run。Cloud Run建立在<a class="ae lb" href="https://knative.dev/" rel="noopener ugc nofollow" target="_blank"> Knative开源项目</a>的基础上，这意味着AWS用户可以使用像本指南这样的<a class="ae lb" href="https://github.com/mreferre/knative-on-fargate" rel="noopener ugc nofollow" target="_blank">示例设置来模拟行为。</a></p><p id="6b1b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">与Fargate相比，Cloud Run的主要优势是对自动扩展的现成支持，包括将pod扩展到零。这类似于GKE在默认情况下安装集群和水平自动缩放，而不是AWS让其EKS用户配置自动缩放行为。对于Anthos用户来说，Cloud Run也有GPU支持，非常适合运行无状态的大数据作业。Cloud Run也是唯一支持部署版本控制和通过容器图像标签路由流量的产品。</p><p id="1a6a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">另一方面，云运行不允许多容器pod。如果您使用sidecar模式或多容器，您需要单独部署每个服务。好的一面是，Cloud Run可以在几秒钟内部署这些容器，并与其他谷歌云产品无缝集成。</p><h2 id="3f35" class="mh ld iq bd le mi mj dn li mk ml dp lm jy mm mn lq kc mo mp lu kg mq mr ly ms bi translated">Azure容器实例</h2><p id="2b0c" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">Azure在Fargate和Cloud Run之前于2018年发布了容器实例。容器实例利用轻量级虚拟机实现隔离，并使用可选的公共IP地址部署容器。VM级隔离类似于Fargate，但是可选的公共IP地址是一个很好的特性，如果没有ALBs，Fargate是不支持的。</p><p id="effb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">除了Windows容器支持(这是Azure所期望的)，容器实例的不同之处在于不支持本地Kubernetes清单。相反，它符合类似于Kubernetes pod规范的按容器组分组的Azure实现。然而，通过开源Kubelet实现<a class="ae lb" href="https://virtual-kubelet.io/" rel="noopener ugc nofollow" target="_blank"> Virtual Kubelet </a>，Azure容器实例用户可以将容器实例虚拟机伪装成附属于AKS或其他Kubernetes集群的Kubernetes节点。Azure容器实例的另一个很好的特性是通过<a class="ae lb" href="https://docs.microsoft.com/en-us/azure/container-instances/container-instances-overview#persistent-storage" rel="noopener ugc nofollow" target="_blank"> Azure文件共享</a>的本地持久存储支持。<a class="ae lb" href="https://docs.microsoft.com/en-us/azure/container-instances/container-instances-gpu" rel="noopener ugc nofollow" target="_blank"> GPU支持</a>(NVIDIA Tesla GPU)目前正在预览中。</p><h1 id="53cd" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">外卖食品</h1><p id="6a78" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">AWS向Fargate发布新功能，表明AWS承诺改善其容器产品线。然而，与Cloud Run和Azure Container实例相比，它缺乏关键功能(如GPU支持、原生自动缩放)以及流畅的开发人员入职体验。除非您已有ECS或EKS集群，否则Fargate不会像Cloud Run一样作为独立的PaaS产品运行，也不会在不创建ALB来路由流量的情况下分配公共IP。尽管存在缺点，但如果您正在寻找一个托管的无服务器容器计算，或者希望为您的无状态应用程序卸载一些DevOps负担，Fargate值得在AWS生态系统上看看。</p></div></div>    
</body>
</html>