<html>
<head>
<title>Better JavaScript — Standard Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">更好的JavaScript —标准库</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/better-javascript-standard-library-f1e05061937f?source=collection_archive---------9-----------------------#2020-10-20">https://blog.devgenius.io/better-javascript-standard-library-f1e05061937f?source=collection_archive---------9-----------------------#2020-10-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/f29e186c5821c2d19e5971487d8954da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qD5d4DFMVdapiBwf"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">马库斯·温克勒在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="b32f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">像任何类型的应用程序一样，JavaScript应用程序也必须写得很好。</p><p id="9a1d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">否则，我们以后会遇到各种各样的问题。</p><p id="96a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究改进JavaScript代码的方法。</p><h1 id="2a4c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">从标准类继承</h1><p id="4e1b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">使用class语法，我们可以很容易地创建标准类的子类。</p><p id="78bc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以通过编写以下代码来创建<code class="fe me mf mg mh b">Array</code>构造函数的子类:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="e318" class="mq lc iq mh b gy mr ms l mt mu">class MyArray extends Array {}</span><span id="35b5" class="mq lc iq mh b gy mv ms l mt mu">const myArray = new MyArray(1, 2, 3);</span></pre><p id="fb85" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么<code class="fe me mf mg mh b">myArray.length</code>就是3。</p><p id="d96c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于当我们调用<code class="fe me mf mg mh b">MyArray</code>构造函数时会调用<code class="fe me mf mg mh b">Array</code>构造函数，因此<code class="fe me mf mg mh b">length</code>属性被正确设置。</p><p id="143b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">MyArray</code>的<code class="fe me mf mg mh b">[[Class]]</code>值被设置为<code class="fe me mf mg mh b">Array</code>，因此<code class="fe me mf mg mh b">length</code>被正确设置。</p><p id="fa91" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们得到<code class="fe me mf mg mh b">myArray</code>的原型:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="56d5" class="mq lc iq mh b gy mr ms l mt mu">Object.prototype.toString.call(myArray)</span></pre><p id="4654" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们得到:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="d18a" class="mq lc iq mh b gy mr ms l mt mu">[object Array]</span></pre><p id="b852" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以下是各种内置构造函数的<code class="fe me mf mg mh b">[[Class]]</code>值:</p><ul class=""><li id="c0e4" class="mw mx iq kf b kg kh kk kl ko my ks mz kw na la nb nc nd ne bi translated"><code class="fe me mf mg mh b">Array</code>——<code class="fe me mf mg mh b">[[Class]]</code>是<code class="fe me mf mg mh b">'Array'</code></li><li id="58b9" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated"><code class="fe me mf mg mh b">Boolean</code>——<code class="fe me mf mg mh b">[[Class]]</code>是<code class="fe me mf mg mh b">'Boolean'</code></li><li id="5680" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated"><code class="fe me mf mg mh b">Date</code>——<code class="fe me mf mg mh b">[[Class]]</code>是<code class="fe me mf mg mh b">'Date'</code></li><li id="1b00" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated"><code class="fe me mf mg mh b">Error</code>——<code class="fe me mf mg mh b">[[Class]]</code>就是<code class="fe me mf mg mh b">'Error'</code></li><li id="0dc0" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated"><code class="fe me mf mg mh b">Function</code>——<code class="fe me mf mg mh b">[[Class]]</code>就是<code class="fe me mf mg mh b">'Function'</code></li><li id="c942" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated"><code class="fe me mf mg mh b">JSON</code>——<code class="fe me mf mg mh b">[[Class]]</code>就是<code class="fe me mf mg mh b">'JSON'</code></li><li id="bf65" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated"><code class="fe me mf mg mh b">Math</code>——<code class="fe me mf mg mh b">[[Class]]</code>就是<code class="fe me mf mg mh b">'Math'</code></li><li id="e0df" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated"><code class="fe me mf mg mh b">Number</code>——<code class="fe me mf mg mh b">[[Class]]</code>就是<code class="fe me mf mg mh b">'Number'</code></li><li id="cb35" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated"><code class="fe me mf mg mh b">Object</code>——<code class="fe me mf mg mh b">[[Class]]</code>就是<code class="fe me mf mg mh b">'Object'</code></li><li id="a34f" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated"><code class="fe me mf mg mh b">RegExp</code>——<code class="fe me mf mg mh b">[[Class]]</code>是<code class="fe me mf mg mh b">'RegExp'</code></li><li id="1030" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated"><code class="fe me mf mg mh b">String</code>——<code class="fe me mf mg mh b">[[Class]]</code>是<code class="fe me mf mg mh b">'String'</code></li></ul><p id="36ba" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这种类型的继承只能用类语法来完成。</p><p id="10d2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">旧的构造函数语法无法正确设置<code class="fe me mf mg mh b">[[Class]]</code>属性。</p><h1 id="427b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">原型是一个实现细节</h1><p id="e366" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">原型具有对象从其继承的属性。</p><p id="cca2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对象就是接口。</p><p id="1b3d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们不应该检查我们不控制的对象的原型结构。</p><p id="d008" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们不应该检查实现我们不控制的对象内部的属性。</p><p id="3098" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果这是我们无法控制的事情，那么我们就无法改变它们。</p><p id="a558" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们必须用自己控制的代码来处理它们。</p><h1 id="6168" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">没有鲁莽的猴子补丁</h1><p id="52f5" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">猴子补丁是动态地改变代码。</p><p id="3141" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">JavaScript并不阻止我们改变任何对象的属性，包括内置对象。</p><p id="a6ea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以通过编写以下代码向<code class="fe me mf mg mh b">Array</code>构造函数添加一个实例方法:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="4324" class="mq lc iq mh b gy mr ms l mt mu">Array.prototype.split = function(i) { <br/>  return [this.slice(0, i), this.slice(i)];<br/>};</span></pre><p id="7542" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是其他人可能会做同样的事情。</p><p id="5919" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们可能会在内置对象中得到我们没有预料到的属性和方法。</p><p id="f276" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它们可以被删除，破坏大量使用它的代码。</p><p id="4f6e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，如果我们向内置对象添加我们不期望的东西，我们就会遇到问题。</p><p id="6415" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">添加我们自己的代码的更好方法是将它们与内置对象分开。</p><p id="bca9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="c321" class="mq lc iq mh b gy mr ms l mt mu">function split(arr, i) { <br/>  return [arr.slice(0, i), arr.slice(i)];<br/>};</span></pre><p id="3bf2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建我们自己的<code class="fe me mf mg mh b">split</code>函数。</p><p id="380d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，我们可以添加的一个可接受的改变现有内置对象的东西是polyfills。</p><p id="e360" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它们是添加了将来JavaScript引擎应该支持的功能的库。</p><p id="63c2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它们的行为是标准化的，因此我们可以使用它们以安全的方式添加方法。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/186020fb0aba330ce99e1e357a3c6aed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EU5imdHhm20yzbZv"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@rayyu?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">rayu马尔代夫摄影师</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h1 id="f6a6" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="27eb" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">使用类语法，我们可以从标准类继承。</p><p id="ea70" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们不应该检查不受我们控制的代码，因为我们不能改变它们。</p><p id="f927" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也不应该用自己的代码修补本机内置对象。</p></div></div>    
</body>
</html>