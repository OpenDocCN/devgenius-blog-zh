<html>
<head>
<title>4 Ways to Detect Mobile Browsers in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 JavaScript 检测移动浏览器的 4 种方法</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/4-ways-to-detect-mobile-browsers-in-javascript-943b66657524?source=collection_archive---------0-----------------------#2022-08-10">https://blog.devgenius.io/4-ways-to-detect-mobile-browsers-in-javascript-943b66657524?source=collection_archive---------0-----------------------#2022-08-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="86bd" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><code class="fe kf kg kh ki b">userAgent</code>不可靠，我们还能用什么？</h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/d0e1691877c722863ba9ec4c384f1f52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2F3u8Z7snrbUGU-A"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk translated"><a class="ae kz" href="https://unsplash.com/@freestocks?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> freestocks </a>在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="ddd6" class="pw-post-body-paragraph la lb iq lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">在 web 开发中，我们可能需要知道当前用户是否在移动设备上。本文将向您展示如何在 JavaScript 中检测它。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="dcd9" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">1.导航器上的属性</h1><p id="82cd" class="pw-post-body-paragraph la lb iq lc b ld mv jr lf lg mw ju li lj mx ll lm ln my lp lq lr mz lt lu lv ij bi translated">我们可以使用<code class="fe kf kg kh ki b">navigator.userAgent</code>，它返回一个包含设备信息的字符串:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi na"><img src="../Images/3e31f6cdbf5eb1d7806060e8e4171170.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*7uCVLGDYkWQi6ZRWrdhgRw.png"/></div></figure><p id="d8a0" class="pw-post-body-paragraph la lb iq lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">所以我们可以使用正则表达式来匹配它，例如使用<code class="fe kf kg kh ki b">/Android|iPhone/i.test(navigator.userAgent)</code>。</p><p id="d699" class="pw-post-body-paragraph la lb iq lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">这可能是最常见的解决方案。但是我们可以自己修改这个字符串，例如使用<code class="fe kf kg kh ki b">Object.defineProperty</code>、<code class="fe kf kg kh ki b">Reflect.defineProperty</code>等等。因为它的属性描述是这样的:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi nb"><img src="../Images/a13a69d36f8b5de925fc48e4cdd2eae7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nceJfvHAo56sGMtrT7tPzA.png"/></div></div></figure><p id="37aa" class="pw-post-body-paragraph la lb iq lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">这里有一个例子:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi nc"><img src="../Images/5f263b49af3ea5a4b2a0160e10c04ccb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YEXTAkzzceYxhRfX7YJPdA.png"/></div></div></figure><p id="b017" class="pw-post-body-paragraph la lb iq lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">除此之外，我们还可以使用<code class="fe kf kg kh ki b">navigator.platform</code>。它指示为其编译浏览器的机器类型。但它没有一个统一的公开名单，可以造假。不建议使用。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/682171d0dd17bbb726737dda00dfc1bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/1*cs5NCpgqppsWjUuCVWsesA.png"/></div></figure><p id="6747" class="pw-post-body-paragraph la lb iq lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">还有<code class="fe kf kg kh ki b">navigator.userAgentData</code>，可以把<code class="fe kf kg kh ki b">userAgent</code>解析成对象:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi nb"><img src="../Images/ce2beadb72974d93c092cd1d666da8f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7hbvx8kgCoRbvFGQGypRtQ.png"/></div></div></figure><p id="6371" class="pw-post-body-paragraph la lb iq lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">也可以造假，兼容性不好:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi ne"><img src="../Images/be53bcb6300ac12e3f16716d8fee2f31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oSCMqcLA9ly963Rb1ghGhg.png"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk translated">图片来自<a class="ae kz" href="https://caniuse.com/?search=navigator.userAgentData" rel="noopener ugc nofollow" target="_blank">can use</a></figcaption></figure><h1 id="7d21" class="md me iq bd mf mg nf mi mj mk ng mm mn jw nh jx mp jz ni ka mr kc nj kd mt mu bi translated">2.触摸事件</h1><p id="4923" class="pw-post-body-paragraph la lb iq lc b ld mv jr lf lg mw ju li lj mx ll lm ln my lp lq lr mz lt lu lv ij bi translated">触摸屏设备有一个<code class="fe kf kg kh ki b">ontouchstart</code>属性，我们可以这样使用:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/c8ee8b74dae5a2a27004ba95da151652.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*PnrXQD0l5v0wqcSUdtl1XQ.png"/></div></figure><p id="c84e" class="pw-post-body-paragraph la lb iq lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">但是有些笔记本电脑也支持触控，如果需要检测的话可以用<code class="fe kf kg kh ki b"><a class="ae kz" href="https://developer.mozilla.org/en-US/docs/Web/API/Navigator/maxTouchPoints" rel="noopener ugc nofollow" target="_blank">navigator.maxTouchPoints</a></code>。它返回当前设备支持的同时触摸点的最大数量。</p><p id="abf8" class="pw-post-body-paragraph la lb iq lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">笔记本电脑处于键盘模式时，<code class="fe kf kg kh ki b">navigator.maxTouchPoints</code>为 1；在平板电脑模式下，<code class="fe kf kg kh ki b">navigator.maxTouchPoints</code>为 10 或以上。而移动一般是 10 以上。</p><h1 id="0430" class="md me iq bd mf mg nf mi mj mk ng mm mn jw nh jx mp jz ni ka mr kc nj kd mt mu bi translated">3.窗口.方向</h1><p id="23e8" class="pw-post-body-paragraph la lb iq lc b ld mv jr lf lg mw ju li lj mx ll lm ln my lp lq lr mz lt lu lv ij bi translated">我们可以使用<code class="fe kf kg kh ki b">window.orientation</code>来获取屏幕的当前方向，只有移动设备才有这个属性:</p><pre class="kk kl km kn gt nl ki nm nn aw no bi"><span id="528c" class="np me iq ki b gy nq nr l ns nt">if (typeof <!-- -->window<!-- -->.orientation !== 'undefined') { ... }</span></pre><p id="864c" class="pw-post-body-paragraph la lb iq lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">但它已被标记为不推荐使用，因此不建议您使用它。使用<code class="fe kf kg kh ki b"><a class="ae kz" href="https://developer.mozilla.org/en-US/docs/Web/API/Screen/orientation" rel="noopener ugc nofollow" target="_blank">screen.orientation</a></code>代替在<a class="ae kz" href="https://developer.mozilla.org/en-US/docs/Web/API/Window/orientation" rel="noopener ugc nofollow" target="_blank"> MDN </a>中提到。但是<code class="fe kf kg kh ki b"><a class="ae kz" href="https://developer.mozilla.org/en-US/docs/Web/API/Screen/orientation" rel="noopener ugc nofollow" target="_blank">screen.orientation</a></code>在桌面上也是支持的，所以不能用来确定移动。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi nu"><img src="../Images/83394d3ca2475d4fa73a69e908637c2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LXRlk2wviCy0ap-Gd_Tu_A.png"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk translated"><code class="fe kf kg kh ki b"><a class="ae kz" href="https://developer.mozilla.org/en-US/docs/Web/API/Screen/orientation" rel="noopener ugc nofollow" target="_blank">screen.orientation</a></code>的浏览器兼容性</figcaption></figure><h1 id="a748" class="md me iq bd mf mg nf mi mj mk ng mm mn jw nh jx mp jz ni ka mr kc nj kd mt mu bi translated">4.Window.matchMedia()</h1><p id="f08e" class="pw-post-body-paragraph la lb iq lc b ld mv jr lf lg mw ju li lj mx ll lm ln my lp lq lr mz lt lu lv ij bi translated"><code class="fe kf kg kh ki b"><a class="ae kz" href="https://developer.mozilla.org/en-US/docs/Web/API/Window" rel="noopener ugc nofollow" target="_blank">Window</a></code>接口的<code class="fe kf kg kh ki b">matchMedia()</code>方法返回一个新的<code class="fe kf kg kh ki b"><a class="ae kz" href="https://developer.mozilla.org/en-US/docs/Web/API/MediaQueryList" rel="noopener ugc nofollow" target="_blank">MediaQueryList</a></code>对象，该对象可用于确定<code class="fe kf kg kh ki b"><a class="ae kz" href="https://developer.mozilla.org/en-US/docs/Web/API/Document" rel="noopener ugc nofollow" target="_blank">document</a></code>是否匹配<a class="ae kz" href="https://developer.mozilla.org/en-US/docs/Web/CSS/Media_Queries/Using_media_queries" rel="noopener ugc nofollow" target="_blank">媒体查询</a>字符串。</p><p id="e6f2" class="pw-post-body-paragraph la lb iq lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">例如，屏幕宽度不超过<code class="fe kf kg kh ki b">768px</code>的设备被视为移动设备:</p><pre class="kk kl km kn gt nl ki nm nn aw no bi"><span id="1e10" class="np me iq ki b gy nq nr l ns nt">const isMobile = window.matchMedia('only screen and (max-width: 768px)').matches;</span></pre><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi nv"><img src="../Images/f9d214734fcff84dc17449f85f54335f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eOjVrKqPJu5smfNE0xtfTQ.png"/></div></div></figure><p id="c80e" class="pw-post-body-paragraph la lb iq lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">但是屏幕大小判断有时候比较宽松，我们也可以用<code class="fe kf kg kh ki b"><a class="ae kz" href="https://developer.mozilla.org/en-US/docs/Web/CSS/@media/pointer" rel="noopener ugc nofollow" target="_blank">pointer:coarse</a></code>来检测当前设备的指针是否精度有限。</p><pre class="kk kl km kn gt nl ki nm nn aw no bi"><span id="1df1" class="np me iq ki b gy nq nr l ns nt">window.matchMedia('(pointer: coarse)').matches;</span></pre><p id="f35a" class="pw-post-body-paragraph la lb iq lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">但是<code class="fe kf kg kh ki b">pointer:coarse</code>只用于确定主指向设备。对于那些可触摸的笔记本电脑，这将返回 false。在这种情况下，<code class="fe kf kg kh ki b">any-pointer</code>可用于确定所有指点设备，<code class="fe kf kg kh ki b">any-pointer: coarse</code>还指示是否至少有一个指点设备精度有限。</p><pre class="kk kl km kn gt nl ki nm nn aw no bi"><span id="93e3" class="np me iq ki b gy nq nr l ns nt">window.matchMedia('(<!-- -->any-pointer<!-- -->: coarse)').matches;</span></pre><h1 id="8b5d" class="md me iq bd mf mg nf mi mj mk ng mm mn jw nh jx mp jz ni ka mr kc nj kd mt mu bi translated">结论</h1><p id="bc79" class="pw-post-body-paragraph la lb iq lc b ld mv jr lf lg mw ju li lj mx ll lm ln my lp lq lr mz lt lu lv ij bi translated">据我所知，目前还没有完美的检测手机浏览器的方案。上面列出的 4 种方法都有一些缺陷，你可能需要根据你的实际情况来选择它们。</p><p id="8a4f" class="pw-post-body-paragraph la lb iq lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">如果你正在适应小屏幕设备，纯 CSS 可能是最好的，并尽量避免在 JavaScript 检测。</p><p id="2318" class="pw-post-body-paragraph la lb iq lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">你有更好的解决办法吗？请随意与我分享你的想法。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><p id="33a0" class="pw-post-body-paragraph la lb iq lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><em class="nw">感谢阅读。如果你喜欢这样的故事，想支持我，请考虑成为</em> <a class="ae kz" href="https://medium.com/@islizeqiang/membership" rel="noopener"> <em class="nw">中等会员</em> </a> <em class="nw">。每月 5 美元，你可以无限制地访问媒体内容。如果你通过</em> <a class="ae kz" href="https://medium.com/@islizeqiang/membership" rel="noopener"> <em class="nw">我的链接</em> </a> <em class="nw">报名，我会得到一点佣金。</em></p><p id="b93e" class="pw-post-body-paragraph la lb iq lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">你的支持对我来说非常重要——谢谢。</p></div></div>    
</body>
</html>