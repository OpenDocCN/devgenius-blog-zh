<html>
<head>
<title>Looping through and Unzipping .EGP Files with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">循环和解压缩。用 Python 处理 EGP 文件</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/looping-through-and-unzipping-egp-with-python-d8cf5a1ab41c?source=collection_archive---------4-----------------------#2020-09-30">https://blog.devgenius.io/looping-through-and-unzipping-egp-with-python-d8cf5a1ab41c?source=collection_archive---------4-----------------------#2020-09-30</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/482ee737043de1d16576703c9c6a07d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Spc1gxhohoQxhw_spzy0w.jpeg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">这是拉链！</figcaption></figure><h1 id="58ed" class="jz ka in bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">什么是？EGP 档案？</h1><p id="f7e7" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">直接取自<a class="ae lv" href="https://stackoverflow.com/questions/25036780/open-sas-egp-file-to-view-code-without-having-sas-installed#:~:text=A%20.,files%20(and%20other%20things).&amp;text=zip%2C%20you%20can%20open%20it,do%20as%20it's%20fairly%20messy." rel="noopener ugc nofollow" target="_blank">堆栈溢出</a>:</p><blockquote class="lw lx ly"><p id="544a" class="kx ky lz kz b la ma lc ld le mb lg lh mc md lk ll me mf lo lp mg mh ls lt lu ig bi translated">答。egp 文件是一组压缩的 xml 文件(和其他东西)。如果您将扩展名更改为。zip，你可以用任何解压程序打开它，并看到里面的内容。从那里提取程序之类的东西是可能的，尽管这不一定容易做到，因为它相当混乱。</p></blockquote><h1 id="a6ab" class="jz ka in bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">我为什么要写这个故事？</h1><p id="72e6" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">原因很简单。因为我的任务是遍历一个文件夹。这周 egp 文件，不知道怎么做，想通了，不想让别人浪费时间去想我已经做过的事情，所以写了这个帖子。</p><h1 id="57f8" class="jz ka in bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">好吧，那密码在哪里？</h1><p id="8447" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">直奔主题。我喜欢。我在和谁说话…没关系:</p><h2 id="b478" class="mi ka in bd kb mj mk dn kf ml mm dp kj li mn mo kn lm mp mq kr lq mr ms kv mt bi translated">脚本 1/3:</h2><p id="e735" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">这里有一个小脚本来解压一个文件。egp 文件，并将内容放在指定的目录中。只需更改该脚本中的路径即可重现:</p><pre class="mu mv mw mx gt my mz na nb aw nc bi"><span id="2621" class="mi ka in mz b gy nd ne l nf ng">#!/usr/bin/env python<br/># coding: utf-8</span><span id="0815" class="mi ka in mz b gy nh ne l nf ng">#script 1<br/>#extract single .egp file based on directory variable<br/>zip_folder = r'folder/with/all/zip/files'<br/>destination = r'destination/folder'<br/># pwd = '&lt;YOUR_PASSWORD&gt;'</span><span id="e5b9" class="mi ka in mz b gy nh ne l nf ng">with zipfile.ZipFile(zip_folder) as zf:<br/>    zf.extractall(<br/>        destination) #pwd=pwd.encode())</span></pre><h2 id="33b7" class="mi ka in bd kb mj mk dn kf ml mm dp kj li mn mo kn lm mp mq kr lq mr ms kv mt bi translated">第 2 个脚本，共 3 个:</h2><p id="ca98" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">这里有一个脚本来识别和过滤掉文件(。在我们的例子中是 egp ),根据指定的扩展名遍历并解压缩它们，然后将这些文件放在指定的目录中:</p><pre class="mu mv mw mx gt my mz na nb aw nc bi"><span id="817d" class="mi ka in mz b gy nd ne l nf ng">#get files from directory based on list of extentsions<br/>import os<br/>import zipfile</span><span id="6b5a" class="mi ka in mz b gy nh ne l nf ng">#create directory and extension variables<br/>rootdir = r'folder/with/all/zip/files'<br/>destination = r'destination/folder'<br/>extensions = ('.egp', '.sas', '.xml')</span><span id="daf8" class="mi ka in mz b gy nh ne l nf ng">#loop through the directory/subdirectories and extract .egp files<br/>for subdir, dirs, files in os.walk(rootdir):<br/>    for file in files:<br/>        ext = os.path.splitext(file)[-1].lower()<br/>        if ext == '.egp': #change to other extension if necessary<br/>            files = os.path.join(subdir, file)<br/>            print(files)<br/>            # pwd = '&lt;YOUR_PASSWORD&gt;' #insert password if directory is password protected</span><span id="b616" class="mi ka in mz b gy nh ne l nf ng">with zipfile.ZipFile(files) as zf:<br/>                zf.extractall(<br/>                    destination) #pwd=pwd.encode())</span></pre><figure class="mu mv mw mx gt jo gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/c88d576ba4d72d58b906f993369a4888.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/1*KWN3CPugA0VI7Y6nviJSJw.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">脚本 2 将产生类似这样的内容</figcaption></figure><h2 id="a09e" class="mi ka in bd kb mj mk dn kf ml mm dp kj li mn mo kn lm mp mq kr lq mr ms kv mt bi translated">脚本 3/3:</h2><p id="f2b4" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">查看您刚刚提取的内容(所有文件和文件夹)的简单方法:</p><pre class="mu mv mw mx gt my mz na nb aw nc bi"><span id="e4ce" class="mi ka in mz b gy nd ne l nf ng">#list all files and folders in a specific folder and add them to a list<br/>from os import listdir<br/>from os.path import isfile, isdir, join</span><span id="2244" class="mi ka in mz b gy nh ne l nf ng">#get only files or only dirs<br/>onlyfiles = [f for f in listdir(destination) if isfile(join(destination, f))]<br/>onlydirs = [f for f in listdir(destination) if isdir(join(destination, f))]</span><span id="5140" class="mi ka in mz b gy nh ne l nf ng">print('All Files:')<br/>for i in onlyfiles:<br/>    print(i)<br/>print('')<br/>print('All Folders:')<br/>for i in onlydirs:<br/>    print(i)</span></pre><figure class="mu mv mw mx gt jo gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/a6bcbc8bfe7646337c2b123cdaca72ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/format:webp/1*KOYVkJh7-pT3yczwgVwwzQ.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">脚本 3 将产生类似这样的结果</figcaption></figure><h1 id="d538" class="jz ka in bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">完整的剧本</h1><p id="12bd" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">因为每个人都想看到彩色的剧本:</p><figure class="mu mv mw mx gt jo gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/30968f8f2357ed1cd661a3ed6dfd999f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*5gzHr6HsKhCDx_aNiFCBJQ.png"/></div></figure><figure class="mu mv mw mx gt jo gh gi paragraph-image"><a href="https://www.buymeacoffee.com/31yearoldmoron"><div class="gh gi nl"><img src="../Images/65d252f385fcdd1ec86135e6fefa0c74.png" data-original-src="https://miro.medium.com/v2/resize:fit:414/format:webp/1*54tIIhQz9VZppOBxmIN1CA.png"/></div></a></figure><h2 id="1e6e" class="mi ka in bd kb mj mk dn kf ml mm dp kj li mn mo kn lm mp mq kr lq mr ms kv mt bi translated">问候，</h2><p id="d825" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">最大</p></div></div>    
</body>
</html>