<html>
<head>
<title>Make a grid-based game with Unity: dev-log day 3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Unity制作一个基于网格的游戏:开发日志第3天</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/make-a-grid-based-game-with-unity-dev-log-day-3-8ac29d61da7d?source=collection_archive---------5-----------------------#2020-12-30">https://blog.devgenius.io/make-a-grid-based-game-with-unity-dev-log-day-3-8ac29d61da7d?source=collection_archive---------5-----------------------#2020-12-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="5f6a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建一个系统，从文本文件中生成墙和地板的网格。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/f6696cdb98b41f832f88ede195e6e2f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dFxK8dLigqQt5JmV-VkrEg.jpeg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">生成带墙和楼板的楼板。</figcaption></figure><h1 id="6210" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">目标</h1><p id="f8ba" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">今天我想制作它，这样我的游戏就可以以文本文件的方式接收平面图，它看起来像一个带有如下标签的矩阵:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi me"><img src="../Images/5ca188d4fd4a3af42bf55bbd201ca1a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:496/format:webp/1*SjfKg3_zBBV3oYrT1MEaKw.jpeg"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">字母矩阵。</figcaption></figure><p id="0be9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，我的grid_manager将读取这个文件并从中生成一个网格。我希望我的grid_manager足够智能，可以接受任何大小的矩形矩阵，只要它包含有效的标签。</p><p id="81ff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从那里，我的grid_manager将能够用适当的游戏对象生成一个地板。</p></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><h2 id="274f" class="mm lc iq bd ld mn mo dn lh mp mq dp ll jy mr ms lp kc mt mu lt kg mv mw lx mx bi translated">鬼怪；雪碧</h2><p id="472e" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">首先，让我们做一个墙壁精灵，然后把它变成一个预置，就像我的其他精灵一样。</p><p id="7eb3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">出于测试的目的，我将遵循一个惯例，将重要的东西用明亮的颜色，将朴实的颜色用于游戏中不重要的元素。</p><p id="bdad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于我的墙壁，灰褐色就可以了。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi my"><img src="../Images/bf3a7bc809485f62c20cd726dffa8779.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*TvIV3521srSK8PamY67B8A.jpeg"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">土色</figcaption></figure><p id="ccd2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">顺便说一下，我通过在这个网站上发送“随机”按钮来获得我所有的颜色，直到我找到我想要的东西。</p><p id="1b9a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们到了:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi na"><img src="../Images/1c7638bd33b5c66d3cfc4d4ac347ef0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4D1osofC3EzJtsbAfSrWOw.jpeg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">墙壁精灵</figcaption></figure></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><h2 id="e831" class="mm lc iq bd ld mn mo dn lh mp mq dp ll jy mr ms lp kc mt mu lt kg mv mw lx mx bi translated">预制的</h2><p id="31d3" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">就像上次一样，我的游戏中会有很多墙，所以我想要一个可重用的资产，可以很容易地实例化，它可能比精灵有更多的功能，所以我把它制作成一个预置，放在我的资源目录中。</p></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><h2 id="8b8a" class="mm lc iq bd ld mn mo dn lh mp mq dp ll jy mr ms lp kc mt mu lt kg mv mw lx mx bi translated">把墙放进我的格子里</h2><p id="a046" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">我决定这样做的方法是通过txt文件创建一个矩阵，然后读取txt文件并为矩阵中的每个单元生成一个网格。对于矩阵中的每个单元，我想在有墙的地方生成一面墙，即使有墙，也为每个瓷砖生成一个地板。这样，墙的下面仍然有地板。</p><p id="1cb9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将为我以后当或者如果我想添加游戏机制，让玩家通过墙壁打洞。</p></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><h2 id="813d" class="mm lc iq bd ld mn mo dn lh mp mq dp ll jy mr ms lp kc mt mu lt kg mv mw lx mx bi translated">为什么要使用这个实现？</h2><p id="87d6" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">我选择这样做是因为我可以确定这个实现是可能的。Unity可能有一个更优雅的选择，但我不知道那是什么。</p><p id="edfd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，这使得我可以很容易地通过各种方法生成一个级别库。</p><p id="b0d7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我未来的目标之一是做一个门户网站，让朋友、家人和粉丝可以用一个简单的网格编辑器为我的游戏关卡。我的实现是这样设置的，这个目标不会太难。我可以简单地创建一个API，它能够基于网格编辑器中的输入生成文本文件。</p><p id="49b3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">后来，可以使用各种矩阵算法自动生成各种迷宫。</p></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><h2 id="e28f" class="mm lc iq bd ld mn mo dn lh mp mq dp ll jy mr ms lp kc mt mu lt kg mv mw lx mx bi translated">它是如何工作的</h2><p id="2ccb" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">我的代码开始变得有点混乱，但我保持了所有组件的一致性，并扩展了我的grid_manager游戏对象。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="11ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我去掉了行和列的序列化，而是创建了一个方法，它将在我传递给方法调用的某个路径读取本地txt文件。</p><p id="ce75" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个方法将自动检测我的矩阵的大小，并将其内容传递给我的grid_generator。</p><p id="6d1b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将我的路径传递给我的文件阅读器是很重要的，因为当我从master_manager调用grid_generator时，它允许我控制在屏幕上绘制哪个级别。</p><p id="d543" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将有助于我以后让玩家从一个级别跳到下一个级别。</p><p id="fea3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我的grid_manager将检测我的矩阵中每个位置上的标签，并实例化与该标签相关联的预设，而不是实例化地砖。</p></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><h2 id="3d9f" class="mm lc iq bd ld mn mo dn lh mp mq dp ll jy mr ms lp kc mt mu lt kg mv mw lx mx bi translated">我遇到了什么麻烦？</h2><p id="2113" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">嗯，我在日常工作中使用ruby，我几乎没有使用过C#，所以我花了大约一个小时才弄明白如何在unity中读取本地txt文件。幸运的是，C#的矩阵语法非常方便，所以这部分很容易。</p><p id="c7e6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大约一个小时后，我向我的朋友抱怨，然后休息一会儿去看电影，但是在那之后，我就没有什么问题了。</p><p id="a503" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">经过一点点的错误修复，它的工作！</p></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><p id="7a14" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">结果是:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nd nc l"/></div></figure></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><h2 id="71e8" class="mm lc iq bd ld mn mo dn lh mp mq dp ll jy mr ms lp kc mt mu lt kg mv mw lx mx bi translated">今天使用的资源</h2><p id="0cba" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">我用以下代码生成了今天的所有工作:</p><ol class=""><li id="0374" class="ne nf iq jp b jq jr ju jv jy ng kc nh kg ni kk nj nk nl nm bi translated"><a class="ae mz" href="https://docs.microsoft.com/en-us/dotnet/" rel="noopener ugc nofollow" target="_blank">官方c#文档</a></li><li id="ff06" class="ne nf iq jp b jq nn ju no jy np kc nq kg nr kk nj nk nl nm bi translated"><a class="ae mz" href="https://docs.unity3d.com/Manual/ScriptingSection.html" rel="noopener ugc nofollow" target="_blank">官方统一文档</a></li></ol><p id="b8da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.各种堆栈溢出线程</p><p id="6549" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天就到这里吧！</p><p id="c754" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下一次，我会让我的角色不能穿墙而过。</p></div></div>    
</body>
</html>