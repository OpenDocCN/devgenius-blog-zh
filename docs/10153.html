<html>
<head>
<title>5 Ways to Leverage Shell Scripts to Automate your Commands</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用 Shell 脚本自动化命令的 5 种方法</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/5-ways-to-leverage-shell-scripts-to-automate-your-commands-696f1accf31e?source=collection_archive---------10-----------------------#2022-10-10">https://blog.devgenius.io/5-ways-to-leverage-shell-scripts-to-automate-your-commands-696f1accf31e?source=collection_archive---------10-----------------------#2022-10-10</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="92e1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">当你的电脑可以帮你记忆长命令时，不要浪费你的时间去记忆长命令</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><a href="https://www.pexels.com/photo/black-text-on-gray-background-261763/"><div class="gh gi kj"><img src="../Images/b50e30d14ade00090b2c20caa3e3e187.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KzDz8carEeldzxTYDQc-Lw.png"/></div></a><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">Pixabay 在 Pexels 上的原始照片，由作者编辑</figcaption></figure><p id="1eec" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="ki">本文使用的是 MacOS </em></p><p id="3951" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Shell 脚本由 UNIX 终端执行的命令序列。这意味着您可以使用它们与命令行界面(CLI)进行交互，甚至编写自己的逻辑。本文将向您展示如何利用简单的 shell 脚本作为您自己的 CLI。</p><h2 id="ad12" class="kv kw in bd kx ky kz dn la lb lc dp ld jv le lf lg jz lh li lj kd lk ll lm ln bi translated">Shell 脚本的用例</h2><ul class=""><li id="4da9" class="lo lp in jm b jn lq jr lr jv ls jz lt kd lu kh lv lw lx ly bi translated">缩短长 CLI 函数</li><li id="61b8" class="lo lp in jm b jn lz jr ma jv mb jz mc kd md kh lv lw lx ly bi translated">运行多个连续功能</li><li id="de0a" class="lo lp in jm b jn lz jr ma jv mb jz mc kd md kh lv lw lx ly bi translated">实现逻辑以确定要执行的适当命令</li></ul><h1 id="52ff" class="me kw in bd kx mf mg mh la mi mj mk ld ml mm mn lg mo mp mq lj mr ms mt lm mu bi translated">制作 bin 目录</h1><p id="8619" class="pw-post-body-paragraph jk jl in jm b jn lq jp jq jr lr jt ju jv mv jx jy jz mw kb kc kd mx kf kg kh ig bi translated">如果你想在任何地方运行你的脚本，那么好消息是，你可以！</p><p id="6225" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">基于 UNIX 的操作系统(如 MacOS 和 Linux)将把位于<code class="fe my mz na nb b">~/bin</code>目录中的所有 shell 脚本纳入范围。</p><p id="023a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">通过在终端中运行以下命令来检查您是否拥有它</p><pre class="kk kl km kn gt nc nb nd ne aw nf bi"><span id="0671" class="kv kw in nb b gy ng nh l ni nj">$ [[ -d ~/bin ]] &amp;&amp; echo "Directory ~/bin exists." || echo "Directory ~/bin does not exist"</span></pre><p id="0b80" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你没有这个文件夹，你的终端会回复“<em class="ki">目录~/bin 不存在</em>”</p><p id="2a9b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果您收到这条消息，运行命令<code class="fe my mz na nb b">mkdir ~/bin</code></p><h1 id="6c10" class="me kw in bd kx mf mg mh la mi mj mk ld ml mm mn lg mo mp mq lj mr ms mt lm mu bi translated">示例 1: Hello World</h1><p id="b1f8" class="pw-post-body-paragraph jk jl in jm b jn lq jp jq jr lr jt ju jv mv jx jy jz mw kb kc kd mx kf kg kh ig bi translated">让我们从一个基本脚本开始，帮助您掌握它的窍门！</p><p id="fa2e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在您的终端中，执行以下命令:</p><pre class="kk kl km kn gt nc nb nd ne aw nf bi"><span id="de1d" class="kv kw in nb b gy ng nh l ni nj">$ cd ~/bin<br/>$ touch hello<br/>$ chmod 777 hello</span></pre><p id="b406" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这会将您的终端移动到 bin 中作为您的工作目录，创建一个名为 hello 的文件，并授予它作为可执行文件运行的权限。在您选择的代码编辑器中打开该文件</p><pre class="kk kl km kn gt nc nb nd ne aw nf bi"><span id="ce88" class="kv kw in nb b gy ng nh l ni nj">#!/bin/bash<br/>echo "World!"</span></pre><p id="80dc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="ki">注意:</em> <code class="fe my mz na nb b">#!/bin/bash</code> <em class="ki">告诉你的设备将文件作为 bash 脚本运行，没有它脚本就不会运行</em></p><p id="fc14" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在让我们运行文件！</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/2594da6946e5946cdb8c5091b854e438.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*DQaZVQVvkHuBO7dBP4EAJw.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">在多个目录中运行 hello</figcaption></figure><p id="cea3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如你所见，我能够从计算机上的任何目录运行脚本！</p><h1 id="86dc" class="me kw in bd kx mf mg mh la mi mj mk ld ml mm mn lg mo mp mq lj mr ms mt lm mu bi translated">示例 2:引入参数</h1><p id="3ef9" class="pw-post-body-paragraph jk jl in jm b jn lq jp jq jr lr jt ju jv mv jx jy jz mw kb kc kd mx kf kg kh ig bi translated">既然我们已经了解了基础知识，那么在进入我一直使用的脚本之前，让我们先来看看稍微复杂一点的 hello world 版本！</p><p id="6a05" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Shell 脚本保留了变量名，如$1、$2、$3 等。这些是命令行参数的替代品。让我们在 hello 脚本中使用它们，如下所示:</p><pre class="kk kl km kn gt nc nb nd ne aw nf bi"><span id="636f" class="kv kw in nb b gy ng nh l ni nj">#!/bin/bash<br/>echo "hello $1"</span></pre><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/ec134a1ced3d6e4faea19bb66fa2429f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*rs7-GEpPJtKtSIlsFbk4Cg.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">你好，有争论的世界</figcaption></figure><p id="88af" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们将这个概念应用到现实世界的例子中</p><p id="9618" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">正如许多用 java 编程的人可能知道的那样，在运行. Java 文件之前，必须将它编译成. class，这是两个独立的命令。让我们创建一个 shell 脚本，将它们合并成一个“编译并运行”命令！</p><p id="fd41" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="ki">如果需要帮助创建新脚本，您可以跳回 hello world 步骤。我将把这个文件称为‘javab’</em></p><pre class="kk kl km kn gt nc nb nd ne aw nf bi"><span id="f3ce" class="kv kw in nb b gy ng nh l ni nj">#!/bin/bash<br/>javac $1 # compile to .class<br/>/bin/java ${1:-5} # point to local java function, run</span></pre><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/255b300bce62dfad220e33089c69d424.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*k0sGo8loAHvumn2x5SrrBw.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">编译并运行</figcaption></figure><p id="6edc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">厉害！</p><h1 id="2e07" class="me kw in bd kx mf mg mh la mi mj mk ld ml mm mn lg mo mp mq lj mr ms mt lm mu bi translated">示例 3:缩短现有命令</h1><p id="f43c" class="pw-post-body-paragraph jk jl in jm b jn lq jp jq jr lr jt ju jv mv jx jy jz mw kb kc kd mx kf kg kh ig bi translated">如果你以前用过 FFmpeg 压缩视频文件，你会知道这个命令并不短，而且通常很难记住每一步。下面是一个使用 25 的恒定速率因子(CRF)的例子</p><pre class="kk kl km kn gt nc nb nd ne aw nf bi"><span id="74a8" class="kv kw in nb b gy ng nh l ni nj">ffmpeg -i file.mov -vcodec libx264 -crf 25 newfile.mp4</span></pre><p id="4320" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这是我经常运行的一个命令，用来压缩 mac 屏幕录音并将其转换为 mp4。让我们尝试使用 shell 脚本来简化它！</p><p id="d2f3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="ki">如果你没有安装 FFmpeg，你可以在这里</em> 下载 <a class="ae nn" href="https://ffmpeg.org/download.html" rel="noopener ugc nofollow" target="_blank"> <em class="ki"/></a></p><pre class="kk kl km kn gt nc nb nd ne aw nf bi"><span id="8c40" class="kv kw in nb b gy ng nh l ni nj">#!/bin/bash<br/>ffmpeg -i $1 -vcodec libx264 -crf $2 $3</span></pre><p id="b5b0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我把这个文件叫做“压缩”</p><p id="1d57" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，我可以从任何工作目录压缩视频，并将新文件放在同一个目录中。如果您愿意，可以添加一些额外的逻辑，例如</p><pre class="kk kl km kn gt nc nb nd ne aw nf bi"><span id="350e" class="kv kw in nb b gy ng nh l ni nj">#!/bin/bash<br/>ffmpeg -i $1 -vcodec libx264 -crf $2 <!-- -->${1%.*}.mp4 &amp;&amp; rm $1</span></pre><p id="028f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">该命令删除$1 中的文件扩展名，并用. mp4 替换它。如果该命令运行成功，它将删除原始文件，否则不执行任何操作</p><h1 id="7dc0" class="me kw in bd kx mf mg mh la mi mj mk ld ml mm mn lg mo mp mq lj mr ms mt lm mu bi translated">示例 5:循环和 if</h1><p id="ba42" class="pw-post-body-paragraph jk jl in jm b jn lq jp jq jr lr jt ju jv mv jx jy jz mw kb kc kd mx kf kg kh ig bi translated">这将是我们最后也是最复杂的例子，但也是我用得最多的一个。</p><p id="0b3c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你曾经有很多不同的遥控器链接到 heroku，github，bitbucket 等，并想把它们都推给别人，这总是一件麻烦的事。</p><p id="846c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">特别是如果您进行了许多小的提交，并且想要与同事共享您的最新更改以防止合并冲突。</p><p id="335e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这里有一个简短的“保存”脚本，它将提交您的最新更改，然后推送到您的遥控器！</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="no np l"/></div></figure><h1 id="173a" class="me kw in bd kx mf mg mh la mi mj mk ld ml mm mn lg mo mp mq lj mr ms mt lm mu bi translated">结论</h1><p id="2156" class="pw-post-body-paragraph jk jl in jm b jn lq jp jq jr lr jt ju jv mv jx jy jz mw kb kc kd mx kf kg kh ig bi translated">总之，您已经学会了如何使用参数、字符串操作、条件(if 语句和&amp;&amp;)以及循环来自动化您的本地命令行工作流。</p><p id="e8e5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">您现在能够更好地利用您的 shell 脚本知识来推进您的工作并节省一些时间！</p><p id="9738" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果您对编码教程感兴趣，并想了解更多关于通过简单的自动化来改善生活的知识，请点击 follow 并留下来！</p></div></div>    
</body>
</html>