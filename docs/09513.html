<html>
<head>
<title>What is a Cron job?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是 Cron 工作？</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/what-is-a-cron-job-f5a6d969a1b1?source=collection_archive---------11-----------------------#2022-08-25">https://blog.devgenius.io/what-is-a-cron-job-f5a6d969a1b1?source=collection_archive---------11-----------------------#2022-08-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7303" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">安排 Cron 作业的初学者指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c89680aba8b06ff01ce0fea0c49bc9fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dEsz8GeaF_M70sxgDdLj7w.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">在<a class="ae kv" href="https://unsplash.com/s/photos/schedule?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae kv" href="https://unsplash.com/@esteejanssens?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">埃斯特·扬森斯</a>拍摄的照片</figcaption></figure><p id="21e2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">计划作业是基于 web 的应用程序的重要组成部分。来处理失败的任务，运行清理活动，或者其他事情。在大多数企业级应用程序中，调度作业都是一种高效的用例。</p><p id="a1ad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我参与的一些企业项目中，软件工具被用来安排日常工作。我还使用 SpringBoot 和 SpringBoot 调度程序开发了基于服务器的应用程序，每三个小时运行一次日常任务。</p><p id="c13e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最近偶然发现了 Cron jobs 这个概念。出于好奇，我读了一些关于它的文章，并想安排一个示例工作来测试它。原来我是唯一一个不知道这个日程表的人。</p><p id="3931" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这篇文章是为像我这样没有尝试过安排 Cron 作业的人准备的。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="e817" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">什么是 Cron 和 Cron Job？</h2><p id="1c10" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">类 Unix 操作系统提供了一个名为 Cron 的命令行实用程序。我们可以使用这个工具在机器上调度任务。Cron 实用程序中调度的任务或作业称为 Cron 作业。</p><p id="fda8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Cron 是一个<strong class="ky ir"> <em class="mx">守护进程</em> </strong>。</p><blockquote class="my"><p id="49ff" class="mz na iq bd nb nc nd ne nf ng nh lr dk translated">守护程序是一种在后台静默运行的程序。控制这个程序的不是用户，而是事件和条件。这些动作的例子是特定时间、特定日期、特定目录中的变化等。</p></blockquote></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="490e" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">如何安排 Cron 作业</h2><ol class=""><li id="23ce" class="ni nj iq ky b kz ms lc mt lf nk lj nl ln nm lr nn no np nq bi translated">创建一个目录(我在我的用户文件夹下创建了这个目录，但是理想情况下，你可以在根目录下创建这个目录)</li></ol><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="a290" class="lz ma iq ns b gy nw nx l ny nz">mkdir ~/.scripts</span></pre><p id="440d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">2.创建一个文件来编写 shell 脚本</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="da05" class="lz ma iq ns b gy nw nx l ny nz">touch test.sh</span></pre><p id="b648" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，提供对它的修改权限</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="cbe4" class="lz ma iq ns b gy nw nx l ny nz">chmod u+x ./test.sh</span></pre><p id="ae9e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">3.将此内容添加到 test.sh 文件中(编辑命令— <strong class="ky ir"> <em class="mx"> vi test.sh </em> </strong>)</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="1142" class="lz ma iq ns b gy nw nx l ny nz">#!/bin/bash</span><span id="1285" class="lz ma iq ns b gy oa nx l ny nz">echo "Starts here"</span><span id="6ebc" class="lz ma iq ns b gy oa nx l ny nz">echo Hello &gt;&gt; test.txt</span><span id="1f60" class="lz ma iq ns b gy oa nx l ny nz">echo "Done"</span></pre><p id="b02d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上述脚本将在 stdout.log 文件中打印“Starts here”和“Done ”,而“Hello”将被打印到 test.txt 文件中。</p><p id="376b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">4.要运行上面的脚本，我们需要在 crontab 中调度它。</p><blockquote class="my"><p id="9190" class="mz na iq bd nb nc nd ne nf ng nh lr dk translated">computerhope.com 的定义</p><p id="bd66" class="mz na iq bd nb nc nd ne nf ng nh lr dk translated">crontab 命令用于查看或编辑 cron 要运行的命令表。系统中的每个用户都可以拥有一个个人 crontab。</p></blockquote><p id="1613" class="pw-post-body-paragraph kw kx iq ky b kz ob jr lb lc oc ju le lf od lh li lj oe ll lm ln of lp lq lr ij bi translated">要打开编辑器在 crontab 中创建条目，请使用以下命令，</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="d158" class="lz ma iq ns b gy nw nx l ny nz">crontab -e</span></pre><p id="2f16" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">5.将以下条目添加到文件中</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="c215" class="lz ma iq ns b gy nw nx l ny nz">* * * * * cd ~/.scripts &amp;&amp; ./test.sh &gt;/tmp/stdout.log 2&gt;/tmp/stderr.log</span></pre><p id="380c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里，五个星号依次表示以下数据，<br/> 1 —分钟(0–59)<br/>2—小时(0–23)<br/>3—一个月中的某一天(1–31)<br/>4—一个月中的某一天(1–12)<br/>5—一周中的某一天(0–6；周日至周六)</p><blockquote class="my"><p id="2939" class="mz na iq bd nb nc nd ne nf ng nh lr dk translated">不提供任何值表示作业将每分钟运行一次。60 秒是我们可以在调度程序上设置的最小可能值。</p></blockquote><p id="3fb0" class="pw-post-body-paragraph kw kx iq ky b kz ob jr lb lc oc ju le lf od lh li lj oe ll lm ln of lp lq lr ij bi translated">要验证作业是否已调度，请使用命令— <strong class="ky ir"> <em class="mx"> crontab -l </em> </strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/1f162b3ca0920ddc0599764214eef544.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TIT--InG9sWRCOWhOamnJg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">计划的 cron 作业列表</figcaption></figure><p id="949e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">6.验证 test.txt 文件中的输出</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="11d0" class="lz ma iq ns b gy nw nx l ny nz">cat test.txt</span></pre><p id="a09e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">几分钟后，test.txt 文件应该会有类似的输出</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/acc3d256c4cf4f1014765c564d9e1e71.png" data-original-src="https://miro.medium.com/v2/resize:fit:654/format:webp/1*dtCL3IjAmgMH6n_rRljtaQ.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">cron 作业结果</figcaption></figure><p id="cde3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">7.验证 stdout.log 文件(该文件位于根文件夹中)</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="99b8" class="lz ma iq ns b gy nw nx l ny nz">cat stdout.log</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/720b3712f02eb5c2e97cc9289949903d.png" data-original-src="https://miro.medium.com/v2/resize:fit:206/format:webp/1*QQQqO63DV5W3OZt0kv5azA.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">stdout.log 的内容</figcaption></figure><p id="84c6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">8.测试完成后，不要忘记删除 cron 作业。使用命令</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="b049" class="lz ma iq ns b gy nw nx l ny nz">crontab -e</span></pre><p id="531a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">并删除内容。</p><p id="0f77" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">删除。脚本目录以及使用</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="6eae" class="lz ma iq ns b gy nw nx l ny nz">rm -r .scripts</span></pre><h2 id="68c1" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">结论</h2><p id="5668" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">我们刚刚学习了在 Mac / Linux 机器上调度 cron 作业。这些作业在计划的计算机上运行；在分布式系统中，这不是一个理想的解决方案。</p><p id="4cdf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">每个提供商都有自己的调度服务来运行基于云的应用程序中的调度作业。</p></div></div>    
</body>
</html>