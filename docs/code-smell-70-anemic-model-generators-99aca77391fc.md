# 代码气味 70 —贫血模型发电机

> 原文：<https://blog.devgenius.io/code-smell-70-anemic-model-generators-99aca77391fc?source=collection_archive---------4----------------------->

## TL；大卫:不要创造贫血的物体。更不用说自动化工具了。

![](img/8b9ce05c399e1d8bf84e3911ae143269.png)

莱尼·屈尼在 [Unsplash](https://unsplash.com/s/photos/factory) 上的照片

# 问题

*   贫血的物体
*   与实现的耦合
*   更难调试

# 解决方法

1.  手动创建对象。
2.  关注基本行为，而不是偶然的数据存储。

# 示例代码

## 错误的

```
<?AnemicClassCreator::create(
    'Employee',
    [
        new AutoGeneratedField('id', '$validators->getIntegerValidator()'),
        new AutoGeneratedField('name', '$validators->getStringValidator()'),
        new AutoGeneratedField('currentlyWorking', '$validators->getBooleanValidator()')
    ]);class Employee extends AutoGeneratedObjectEmployee {
}//We have magic setters and getters
//getId() , setId(), getName()
//Validation is not implicit
//Class are loaded via an autoloader$john = new Employee;
$john->setId(1);
$john->setName('John');
$john->setCurrentlyWorking(true);$john->getName(); //returns 'John'
```

# 对吧

```
<?final class Employee {
    private $name;
    private $workingStatus; public function __construct(string $name, WorkingStatus $workingStatus) {
        //..
    } public function name(): string {
        return $this->name;
        //This is not a getter. It is Employee's responsibility to tell us her/his name
    }
}//We have no magic setters or getters
//all methods are real and can be debugged
//Validations are implicit$john = new Employee('John', new HiredWorkingStatus());$john->name(); //returns 'John'
```

# 侦查

通常，贫血的模型是用[元编程](https://maximilianocontieri.com/laziness-i-meta-programming)生成的。

我们需要跟踪这些神奇的代码生成器。

# 标签

*   贫血的

# 结论

代码向导、元编程和贫血模型都是代码的味道。

我们需要避免这些黑暗的技术。

必须显式地编写*代码让我们反思我们封装的每一条数据。*

# *关系*

*[](/code-smell-01-anemic-models-f9fb5a1323b3) [## 代码气味 01——贫血模型

### 你的对象是一堆没有行为的公共属性。

blog.devgenius.io](/code-smell-01-anemic-models-f9fb5a1323b3) 

# 更多信息

[](https://codeburst.io/laziness-i-meta-programming-34ef4abdafc6) [## 懒惰 I:元编程

### 元编程是神奇的。这是我们不应该使用它的主要原因。有许多可怕的后果…

codeburst.io](https://codeburst.io/laziness-i-meta-programming-34ef4abdafc6) [](https://codeburst.io/lazyness-ii-code-wizards-18cc5672b642) [## 懒惰 II:代码向导

### 代码生成器完成了我们的艰苦工作。但是我们不再需要它们了。

codeburst.io](https://codeburst.io/lazyness-ii-code-wizards-18cc5672b642) 

> 最好的气味是容易发现的，而且大多数时候会引导你发现真正有趣的问题。数据类(只有数据没有行为的类)就是很好的例子。你看着他们，问自己在这个班级应该有什么样的行为。

马丁·福勒

[](/software-engineering-great-quotes-3af63cea6782) [## 软件工程名言

### 有时一个简短的想法可以带来惊人的想法。

blog.devgenius.io](/software-engineering-great-quotes-3af63cea6782) 

本文是 CodeSmell 系列的一部分。

[](/how-to-find-the-stinky-parts-of-your-code-fa8df47fc39c) [## 如何找到你的代码中有问题的部分

### 代码很难闻。让我们看看如何改变香味。

blog.devgenius.io](/how-to-find-the-stinky-parts-of-your-code-fa8df47fc39c)*