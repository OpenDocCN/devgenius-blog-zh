<html>
<head>
<title>Choose Wisely… PATCH or PUT?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">明智地选择…修补还是放置？</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/choose-wisely-patch-or-put-fedc67d80f25?source=collection_archive---------5-----------------------#2022-10-14">https://blog.devgenius.io/choose-wisely-patch-or-put-fedc67d80f25?source=collection_archive---------5-----------------------#2022-10-14</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div class="gh gi jk"><img src="../Images/11cc992c4a5ce4e8649a4fd92459e6fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*aGit8Wq3m9mBdytrO3hvIQ.gif"/></div></figure><p id="7a06" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated"><strong class="jt io">放</strong>和<strong class="jt io">补丁</strong>都是 2 个广为人知的<strong class="jt io"> <em class="kp"> HTTP 方法</em> </strong>用在基于<strong class="jt io"><em class="kp"/></strong><em class="kp">架构</em>上。虽然在<em class="kp">高层</em>中，两种<em class="kp">方法</em>都主要用于<em class="kp">服务器</em>上的更新<em class="kp">资源</em>，但是它们具有<em class="kp">不同的功能</em>并且用于<em class="kp">不同的目的。</em></p><h2 id="3f5b" class="kq kr in bd ks kt ku dn kv kw kx dp ky kc kz la lb kg lc ld le kk lf lg lh li bi translated">放</h2><p id="0713" class="pw-post-body-paragraph jr js in jt b ju lj jw jx jy lk ka kb kc ll ke kf kg lm ki kj kk ln km kn ko ig bi translated"><strong class="jt io"> PUT </strong> <em class="kp">方法</em>用于<em class="kp">更新</em>一个<em class="kp">资源</em>由<em class="kp">完全替换</em>它。类似于<em class="kp"> POST 方法</em>要求<em class="kp">完整请求体</em>被<em class="kp">发送</em>以便<em class="kp">创建<em class="kp">资源</em> , <em class="kp"> PUT </em>方法<em class="kp">也要求</em>完整请求体</em>被<em class="kp">更新</em>。每当一个<em class="kp">客户端</em>想要用<em class="kp">替换<em class="kp">服务器上的一个<em class="kp">现有资源</em>，<strong class="jt io"> <em class="kp">放</em> </strong>被<em class="kp">使用</em>。<em class="kp">客户端</em>需要在<em class="kp">请求体</em>中发送一个<em class="kp">资源</em>的<em class="kp">完整表示</em>。</em></em></p><figure class="lp lq lr ls gt jo gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/822e3de2f1fff6e2f8994606d7780bff.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/1*G-SSu64-RByIqPGRF3u4eQ.gif"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">放就是替换！！</figcaption></figure><p id="b5e9" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">即使<em class="kp">客户端</em>想要<em class="kp">更新</em>现有资源的仅<em class="kp">一个字段</em>，也需要<em class="kp">在<em class="kp">请求体</em>中添加<em class="kp">资源</em>的所有<em class="kp">字段</em>待<em class="kp">更新</em>，设置<em class="kp">字段</em>待<em class="kp">更新如果其他字段没有包含在请求体中，服务器将在修改<em class="kp">目标资源时将<em class="kp">空值</em>放入这些字段。</em></em></em></p><p id="9833" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">例如，让我们以一个<em class="kp"> JSON </em>格式<em class="kp">请求体</em>为例:</p><pre class="lp lq lr ls gt lx ly lz ma aw mb bi"><span id="a339" class="kq kr in ly b gy mc md l me mf">{<br/>   "firstname": "Jim",<br/>   "lastname":"Brown",<br/>   "age": 24,<br/>   "department": "Development"<br/>}</span></pre><p id="626b" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">这里如果我们要将<em class="kp">更新</em>的<em class="kp">部门字段</em>从<strong class="jt io"><em class="kp"/></strong>到<strong class="jt io"> <em class="kp">【产品管理】</em> </strong>使用<strong class="jt io">放</strong>的方法，我们的请求体看起来会像这样:</p><pre class="lp lq lr ls gt lx ly lz ma aw mb bi"><span id="5103" class="kq kr in ly b gy mc md l me mf">{<br/>   "firstname": "Jim",<br/>   "lastname":"Brown",<br/>   "age": 24,<br/>   "department": "Product Management"<br/>}</span></pre><p id="36e2" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">如前所述，只有要更新的字段，即<em class="kp">部门</em>将被替换为新值“<strong class="jt io"> <em class="kp">产品管理</em> </strong>，其余字段<em class="kp">名字</em>和<em class="kp">年龄</em>保持<em class="kp">不变</em>，然后通过<em class="kp"> PUT </em>方法向服务器发出请求。</p><h2 id="de8e" class="kq kr in bd ks kt ku dn kv kw kx dp ky kc kz la lb kg lc ld le kk lf lg lh li bi translated">修补</h2><p id="fe05" class="pw-post-body-paragraph jr js in jt b ju lj jw jx jy lk ka kb kc ll ke kf kg lm ki kj kk ln km kn ko ig bi translated"><strong class="jt io">补丁</strong>仅用于对<em class="kp">资源</em>进行<em class="kp">部分更新</em>。它<em class="kp">只更新</em>的<em class="kp">请求</em>的<em class="kp">JSON</em>T26】主体的<em class="kp">必填字段</em>，而不是写入所有字段。每当<em class="kp">客户端</em>想要<em class="kp">更新</em>时，仅使用<em class="kp">特定字段</em>、<em class="kp">补丁</em>。与<em class="kp"> PUT </em>方法不同，<em class="kp">客户端</em>只需要发送<em class="kp">请求体</em>的<em class="kp">特定字段</em>及其<em class="kp">更新值</em>，而不是发送资源的整个表示。</p><figure class="lp lq lr ls gt jo gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/417e6c7b40b631d8887d4eb50baed413.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*zyrNiFLfzDFRa0kq8tPqxA.gif"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">补丁就是改变！！</figcaption></figure><p id="161a" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">以请求体为例。</p><pre class="lp lq lr ls gt lx ly lz ma aw mb bi"><span id="166a" class="kq kr in ly b gy mc md l me mf">{<br/>   "firstname": "Jim",<br/>   "lastname":"Brown",<br/>   "age": 24,<br/>   "department": "Development"<br/>}</span></pre><p id="a7cc" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">这里如果我们要将<em class="kp">更新</em>的<em class="kp">部门字段</em>从<strong class="jt io"> <em class="kp">开发</em> </strong>到<strong class="jt io"> <em class="kp">产品管理</em> </strong>使用<em class="kp">补丁</em>的方法，我们的<em class="kp">请求体</em>将会是这样的:</p><pre class="lp lq lr ls gt lx ly lz ma aw mb bi"><span id="87ce" class="kq kr in ly b gy mc md l me mf">{<br/>   "department": "Product Management"<br/>}</span></pre><p id="89ed" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">如前所述，在通过<em class="kp">补丁</em>向服务器发送<em class="kp"> HTTP 请求</em>时，只有<em class="kp">字段</em>将被更新即<em class="kp">部门</em>将<em class="kp">替换为新值<strong class="jt io"> <em class="kp">产品管理</em> </strong>的</em>，其他未更改的字段不需要包含在请求体中</p><h2 id="6eec" class="kq kr in bd ks kt ku dn kv kw kx dp ky kc kz la lb kg lc ld le kk lf lg lh li bi translated">说明</h2><figure class="lp lq lr ls gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mh"><img src="../Images/4f52cbe6772b719ea34ba7b74bed67ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QD-I77Wd--vd-g3GQ9_WBQ.jpeg"/></div></div></figure><p id="46ec" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">为了便于说明，我们使用 restful-booker 的<a class="ae mm" href="https://restful-booker.herokuapp.com/apidoc/index.html" rel="noopener ugc nofollow" target="_blank"><em class="kp"/></a><em class="kp"/>进行测试，这是一个开源的 Web API 。我们将使用<strong class="jt io"> <em class="kp"> Postman </em> </strong>来测试 API。</p><p id="10cb" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">根据<em class="kp"> API 文档</em>，让我们首先使用<strong class="jt io"> <em class="kp"> POST </em> </strong>调用<em class="kp">创建一个预订</em>。</p><figure class="lp lq lr ls gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mn"><img src="../Images/82af6019b1fb8b30b1dbdd8fc7e1b14f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NJCWlZFuc7fLmj7zayC-fg.png"/></div></div></figure><p id="e68b" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">在发送了<em class="kp"> POST 请求</em>后，<em class="kp">响应</em>返回了<em class="kp">新创建的预订，</em>我们将使用 PUT 和 PATCH 方法<em class="kp">更新</em>以便清楚地理解。</p><p id="0e80" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">对于 PUT 和 PATCH，<em class="kp">资源</em>需要在<em class="kp">服务器</em>上<em class="kp">创建</em>，因此上面创建的带有<em class="kp"> bookingid 10722 </em>的预订(在我们的例子中)作为<em class="kp">新创建的资源。</em></p><p id="6bf8" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">现在让我们使用<em class="kp">路径参数</em>中的这个<em class="kp"> bookingid </em>来指定我们新创建的资源(booking)的<em class="kp"> URI </em>来更改一些字段。因此，在我们的例子中，端点 URI 将是<em class="kp">https://restful booker.herokuapp.com/booking/10722</em></p><p id="7faa" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">现在我们将使用<strong class="jt io"> <em class="kp">补丁</em> </strong>的方法来改变我们现有资源的名字(booking)。</p><figure class="lp lq lr ls gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mo"><img src="../Images/2b3761355cadcfefa660837757a20ca8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L7BIDdwvo_nCmH-cavCYwg.png"/></div></div></figure><p id="0671" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">从响应中我们可以看到<em class="kp">名字</em>已经被<em class="kp">补丁</em>方法<em class="kp">成功更新</em>。</p><p id="8bef" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">接下来我们将使用<em class="kp"> PUT </em>方法来<em class="kp">更新(替换)</em><em class="kp">整个资源</em>(预订)。</p><figure class="lp lq lr ls gt jo gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/f17d98256acfbd7102513fd5f754c1d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*5oQ80OyPrhbBQN0IGgYgFg.png"/></div></figure><p id="fe58" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">从响应中我们可以看到<em class="kp">更新字段</em>已经被<em class="kp">成功设置</em>，并且<em class="kp">现有资源</em>已经被<em class="kp">替换为<em class="kp"> PUT </em>方法发送的<em class="kp">请求体</em>。</em></p><h2 id="4713" class="kq kr in bd ks kt ku dn kv kw kx dp ky kc kz la lb kg lc ld le kk lf lg lh li bi translated">什么时候用 PATCH 代替 PUT？</h2><p id="da7c" class="pw-post-body-paragraph jr js in jt b ju lj jw jx jy lk ka kb kc ll ke kf kg lm ki kj kk ln km kn ko ig bi translated">每当请求体有一个<em class="kp">数量的属性</em>并且我们只需要更新<em class="kp">字段的一个<em class="kp">少数</em>补丁</em>应该是优选的，因为它节省时间，因为在<em class="kp"> PUT </em>中，我们<em class="kp">传输</em>许多<em class="kp">数据</em>，导致<em class="kp">不必要的带宽</em>。<em class="kp">资源更改</em>比上传<em class="kp">更容易</em>，因为请求体的<em class="kp">最少，特定的</em>字段将被<em class="kp">更改</em>并且<em class="kp">客户端</em>在发送<em class="kp">更新请求</em>之前不需要知道<em class="kp">资源</em>的<em class="kp">完成状态</em></p><figure class="lp lq lr ls gt jo gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/ba38ba0eec51b9712e52d4f480f4de29.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/1*jy_uGhtFlcNmItegZa-SCg.gif"/></div></figure><blockquote class="mr ms mt"><p id="f758" class="jr js kp jt b ju jv jw jx jy jz ka kb mu kd ke kf mv kh ki kj mw kl km kn ko ig bi translated">因此，根据您的需求和使用案例，明智地选择修补或放置！！</p></blockquote></div></div>    
</body>
</html>