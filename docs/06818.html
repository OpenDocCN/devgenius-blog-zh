<html>
<head>
<title>How to Create an EC2 Instance with Apache through AWS CLI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何通过 AWS CLI 用 Apache 创建 EC2 实例</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-create-an-ec2-instance-with-apache-through-aws-cli-12bb7b57e549?source=collection_archive---------12-----------------------#2022-02-05">https://blog.devgenius.io/how-to-create-an-ec2-instance-with-apache-through-aws-cli-12bb7b57e549?source=collection_archive---------12-----------------------#2022-02-05</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/fa2a311dac1e77a865de15b5bd5ae1b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UwIlLU4Y4lcnMdotc7mI3Q.png"/></div></div></figure><p id="3458" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">什么是 AWS CLI？<br/> <strong class="jx io"> AWS 命令行界面</strong>是一个开源工具，在这里你可以下载、配置和控制多个 AWS 服务。用户可以从这个中心位置使用命令和自动化脚本来实现这一点。</p><p id="c8d0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在本项目中，我们将… <br/> 1。创建一个 t.2 微 EC2 实例<br/> 2。使用脚本更新所有包，安装 Apache，并启动服务<br/> 3。验证该实例通过公共 IP 下载并安装了 apache 服务器</p><blockquote class="kt ku kv"><p id="ce9a" class="jv jw kw jx b jy jz ka kb kc kd ke kf kx kh ki kj ky kl km kn kz kp kq kr ks ig bi translated"><strong class="jx io"> <em class="in">先决条件:</em> </strong> <br/>命令行终端<br/> AWS 账户与 IAM 用户<br/> AWS 命令行接口安装<br/> Vim</p></blockquote><h1 id="bf7c" class="la lb in bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">步骤 1:设置 AWS CLI</h1><p id="43f2" class="pw-post-body-paragraph jv jw in jx b jy ly ka kb kc lz ke kf kg ma ki kj kk mb km kn ko mc kq kr ks ig bi translated">第一步是打开终端窗口，输入以下命令来设置 AWS CLI:</p><figure class="me mf mg mh gt jo gh gi paragraph-image"><div class="gh gi md"><img src="../Images/39ad592d46d14e2ca916e81ada501800.png" data-original-src="https://miro.medium.com/v2/resize:fit:376/format:webp/1*1O0xJqDPs-kQllX7vmozbQ.png"/></div></figure><figure class="me mf mg mh gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mi"><img src="../Images/18181625a6a6099539ffa92f235cdfdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ew7CpnfBlwEdBmoPZikGgA.png"/></div></div></figure><p id="8701" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">输入访问键并设置默认区域后，将默认输出格式设置为 JSON。</p><h1 id="4d3e" class="la lb in bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">步骤 2:创建密钥对</h1><p id="96ab" class="pw-post-body-paragraph jv jw in jx b jy ly ka kb kc lz ke kf kg ma ki kj kk mb km kn ko mc kq kr ks ig bi translated">您需要创建一个密钥对来连接到 EC2 实例。</p><pre class="me mf mg mh gt mj mk ml mm aw mn bi"><span id="1376" class="mo lb in mk b gy mp mq l mr ms">aws ec2 create-key-pair --key-name <strong class="mk io">&lt;KeyPairName&gt;</strong> --query 'KeyMaterial' --output text &gt; <strong class="mk io">&lt;KeyPairName&gt;.pem</strong></span></pre><figure class="me mf mg mh gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mt"><img src="../Images/9885e3c3fb8deca35e580df701cebe52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uw16ixF6RaotCD3Bs4fSCA.png"/></div></div></figure><p id="b34f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">设置您的私钥文件的权限。</p><figure class="me mf mg mh gt jo gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/c9ebc90b2d7b1f2459422ecab0ac5e6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*MkJS0NzW_FM5Z_Sx5LOirw.png"/></div></figure><h1 id="206e" class="la lb in bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">步骤 3:创建安全组</h1><p id="11f0" class="pw-post-body-paragraph jv jw in jx b jy ly ka kb kc lz ke kf kg ma ki kj kk mb km kn ko mc kq kr ks ig bi translated">首先找到您的 VpcId:</p><figure class="me mf mg mh gt jo gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/cbfe45a1e03e6764413c1d8e95e9ee45.png" data-original-src="https://miro.medium.com/v2/resize:fit:606/format:webp/1*PzYiDXczY5zWeRSs7GBJ6Q.png"/></div></figure><figure class="me mf mg mh gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mw"><img src="../Images/639bae7fe5ddd95aeeec506d193bd1c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W6HTLO-5VXVBKAyQyL8Mww.png"/></div></div></figure><p id="0923" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">将您的 VpcId 放入以下命令中，并命名您的安全组:</p><pre class="me mf mg mh gt mj mk ml mm aw mn bi"><span id="3f5f" class="mo lb in mk b gy mp mq l mr ms">aws ec2 create-security-group --group-name <strong class="mk io">&lt;SecurityGroupName&gt;</strong> --description "My security group" --vpc-id <strong class="mk io">&lt;vpcid&gt;</strong></span></pre><figure class="me mf mg mh gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mx"><img src="../Images/65242dd21409f5912456c23745c2a163.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*umwVfjmHqggVpNX3XJdZgA.png"/></div></div></figure><p id="76cd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">复制 SecurityGroupId。我们将在下一步中使用它。</p><h1 id="c53e" class="la lb in bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">步骤 4:向安全组添加规则</h1><p id="823c" class="pw-post-body-paragraph jv jw in jx b jy ly ka kb kc lz ke kf kg ma ki kj kk mb km kn ko mc kq kr ks ig bi translated">我们将添加允许 SSH 和 HTTP 流量的规则:</p><pre class="me mf mg mh gt mj mk ml mm aw mn bi"><span id="078f" class="mo lb in mk b gy mp mq l mr ms">aws ec2 authorize-security-group-ingress --group-id <strong class="mk io">&lt;SecurityGroupID&gt;</strong> --protocol tcp --port 22 --cidr 0.0.0.0/0</span><span id="dfa1" class="mo lb in mk b gy my mq l mr ms">aws ec2 authorize-security-group-ingress --group-id <strong class="mk io">&lt;SecurityGroupID&gt;</strong> --protocol tcp --port 80 --cidr 0.0.0.0/0</span></pre><h1 id="f8bf" class="la lb in bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">步骤 5:启动 EC2 实例</h1><p id="9038" class="pw-post-body-paragraph jv jw in jx b jy ly ka kb kc lz ke kf kg ma ki kj kk mb km kn ko mc kq kr ks ig bi translated">我们必须在 AWS 控制台的 EC2 下选择一个 Amazon 机器映像。选择启动 EC2 实例。</p><figure class="me mf mg mh gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mz"><img src="../Images/5b2290f708b3c4d12011783a4679ae78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HkfIge-PZFs5I9EzCEWzpg.png"/></div></div></figure><p id="3808" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">复制 AmiImageId。我们将在下一步中使用它。</p><p id="9b7e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">接下来，我们需要创建一个脚本来安装 Apache 服务器:</p><pre class="me mf mg mh gt mj mk ml mm aw mn bi"><span id="b56e" class="mo lb in mk b gy mp mq l mr ms">vim user_script.sh</span></pre><p id="175f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">将以下命令插入脚本:</p><pre class="me mf mg mh gt mj mk ml mm aw mn bi"><span id="7396" class="mo lb in mk b gy mp mq l mr ms">#!/bin/bash<br/>yum update -y<br/>yum install httpd -y<br/>systemctl start httpd<br/>systemctl enable httpd</span></pre><p id="908a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">输入<strong class="jx io"> ESC </strong>和<strong class="jx io"> :wq </strong>保存并退出。</p><p id="2de3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">运行下面的命令来启动 EC2 实例</p><pre class="me mf mg mh gt mj mk ml mm aw mn bi"><span id="135c" class="mo lb in mk b gy mp mq l mr ms">aws ec2 run-instances --image-id <strong class="mk io">&lt;AMIImageID&gt;</strong> --count 1 --instance-type t3.nano --key-name <strong class="mk io">&lt;KeyPairName&gt;</strong> --security-group-ids <strong class="mk io">&lt;SecurityGroupID&gt;</strong> --subnet-id <strong class="mk io">&lt;SubnetID&gt;</strong> --user-data file://userscript.sh</span></pre><figure class="me mf mg mh gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi na"><img src="../Images/7d7bc6bd589fb5443535931a8abf2bd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0LuLIpNrwYtgraf5gArtOw.png"/></div></div></figure><h1 id="a281" class="la lb in bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">决赛:测试一下！</h1><p id="2a85" class="pw-post-body-paragraph jv jw in jx b jy ly ka kb kc lz ke kf kg ma ki kj kk mb km kn ko mc kq kr ks ig bi translated">转到 AWS 控制台上的 EC2 仪表板。您将看到您部署的一个实例。单击实例并复制公共 IP 地址。</p><figure class="me mf mg mh gt jo gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/0446a421b33d0de995551c86fae3c633.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*JFnfEHbnFoV1_fEfKssQiQ.png"/></div></figure><p id="4e03" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">将其粘贴到您的网络浏览器中。如果你成功了，这就是你将看到的！</p><figure class="me mf mg mh gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nc"><img src="../Images/09747c3bfb6cdcae328daa07ed0b6278.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pYtOFnZ3LLEFIXOBemqWow.png"/></div></div></figure></div></div>    
</body>
</html>