<html>
<head>
<title>Getting started with Azure Synapse Analytics for beginners(Part 2)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向初学者的 Azure Synapse 分析入门(第 2 部分)</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/getting-started-with-azure-synapse-analytics-for-beginners-part-2-1cc188239131?source=collection_archive---------3-----------------------#2022-11-18">https://blog.devgenius.io/getting-started-with-azure-synapse-analytics-for-beginners-part-2-1cc188239131?source=collection_archive---------3-----------------------#2022-11-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="21f6" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Azure 教程| PostgreSQL</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/179f773e57308abb3b918161f57d156d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KON13921mTC8u_OOaTU_TA.png"/></div></div></figure><p id="4ebd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">正如我们之前在第 1 部分中讨论的，什么是 synapse analytics 和专用 SQL 池及其重要性以及如何创建它们，您可以在此处找到<a class="ae ln" href="https://medium.com/@ansam.yousry/getting-started-with-azure-synapse-analytics-for-beginners-part-1-1822a9015586" rel="noopener"/></p><p id="ea3d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，我们将了解有关 synapse 分析工具的新内容，敬请关注</p><p id="bee9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在本教程中，您将学习:</p><ul class=""><li id="0113" class="lo lp iq kt b ku kv kx ky la lq le lr li ls lm lt lu lv lw bi translated">如何创建 Postgres 数据库？</li><li id="9538" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm lt lu lv lw bi translated">使用 python 脚本在 Postgres 上创建一个新的数据库。</li><li id="9027" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm lt lu lv lw bi translated">在 Synapse 上为 Postgres 创建链接服务。</li></ul><h1 id="2b48" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">先决条件:</h1><p id="bbf7" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mw lc ld le mx lg lh li my lk ll lm ij bi translated">要完成本教程中的步骤，您需要满足下面给出的先决条件</p><ul class=""><li id="4953" class="lo lp iq kt b ku kv kx ky la lq le lr li ls lm lt lu lv lw bi translated">你可以通过这个<a class="ae ln" href="https://azure.microsoft.com/en-us/free/" rel="noopener ugc nofollow" target="_blank">链接</a>创建一个免费账户。</li><li id="02d8" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm lt lu lv lw bi translated">Synapse workspace，可以找到创建 Synapse 的步骤。工作区<a class="ae ln" href="https://medium.com/@ansam.yousry/getting-started-with-azure-synapse-analytics-for-beginners-part-1-1822a9015586" rel="noopener">这里</a>。</li><li id="5c0e" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm lt lu lv lw bi translated">专用的 SQL 池，你可以在这里找到步骤<a class="ae ln" href="https://medium.com/@ansam.yousry/getting-started-with-azure-synapse-analytics-for-beginners-part-1-1822a9015586" rel="noopener"/>。</li></ul></div><div class="ab cl mz na hu nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ij ik il im in"><h1 id="a0de" class="mc md iq bd me mf ng mh mi mj nh ml mm jw ni jx mo jz nj ka mq kc nk kd ms mt bi translated">Azure PostgreSQL 数据库:</h1><p id="5877" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mw lc ld le mx lg lh li my lk ll lm ij bi translated">在市场中搜索 Azure Database for PostgreSQL，然后单击 create。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/0adc1c4d0994c3e81318e5cfe0dd5c95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*Zlo9Or5XLZWZIArsnljiBA.png"/></div></figure><p id="5c5f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在本教程中，我们将使用 Azure Database for PostgreSQL 和一个灵活的服务器作为资源类型，您可以通过点击“显示详细信息”来了解更多关于 PostgreSQL 类型的信息。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/2bc9e94e059c11612eae570bec60f7ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mbj-eH_r4jxhuOjNGQDb9Q.png"/></div></div></figure><p id="fa4d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">创建 PostgresSQL 的第一步是选择您的订阅和资源组。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/84972848ef05f3ebbe976b894be53ecc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z6u6jVYX63M62nMRG_pP5A.png"/></div></div></figure><p id="09be" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">给服务器一个有效的名称，选择离你最近的地区。在本教程中，我们在<strong class="kt ir">工作负载类型</strong>中选择开发，建议用于小型数据库和个人项目，如下所示(注意成本，“开发”工作负载类型是最低价格)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/727853587a73a53cf8c071884480b888.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CmyJs7920SF1J1STsurr2A.png"/></div></div></figure><p id="2ec5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您可以从这里调整服务器配置，这会影响成本。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/db3a74e85faf5ed2918cf3b68b535339.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BxgB-IgnM0-OQPwmCplSYg.png"/></div></div></figure><p id="fd6d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在身份验证部分，给出管理员用户名和密码的名称。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/26a9f699b2fedc1e05756ea2c8ae75a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LHjGMzvuAXZ2ZUvB2RLhTw.png"/></div></div></figure><p id="f5dd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在“网络”选项卡中，防火墙规则只允许从 azure 中的任何 Azure 服务到此服务器的公共访问。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/14fa685ca2a8923e78079391a33bac5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tUxVkFhFHuprSns9yc5ivQ.png"/></div></div></figure><p id="fb94" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">其余的保持默认。</p><p id="677e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">创建 Postgres 数据库后，非常非常重要的是停止它以最小化成本，如下所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/92ecf25c5e3e8667587019d92e1e10dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vAKtehjFpbGsDXjhXbxR0Q.png"/></div></div></figure><p id="a118" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">使用 Python 脚本在 Postgres 服务器上创建数据库和表:</strong></p><p id="cfa2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们需要在 Postgres 服务器上创建一个新的数据库，然后在我们刚刚创建的新数据库中创建表。</p><p id="1581" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你可以在(Jupyter 或 Colab)中运行下面的代码，我更喜欢<a class="ae ln" href="https://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank"> Colab </a>。但是要更改主机、用户和密码。</p><p id="b9d4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您可以获得您的主机和用户名，如下所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/ed0a66a58d06bcc425edf783982395fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MpdrJrMo5H8MwC-uUefzpQ.png"/></div></div></figure><p id="56c6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在运行 python 脚本之前，我们需要在 azure PostgreSQL 的网络中调整一些东西，以建立连接并获得成功。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/f7024b52907fb6f6b54dd26c11b22e69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LAwM0IDtdVyhW95CYOPdvg.png"/></div></div></figure><p id="ff5f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如上图所示，转到网络并添加突出显示的 IP，然后运行 Python 脚本。</p><pre class="kg kh ki kj gt nv nw nx bn ny nz bi"><span id="6e66" class="oa md iq nw b be ob oc l od oe">import psycopg2<br/>from psycopg2.extensions import ISOLATION_LEVEL_AUTOCOMMIT<br/><br/>########################################<br/># Update connection string information #<br/>########################################<br/>host = "postgresqlerver.postgres.database.azure.com"<br/>user = "postgres"<br/>password = "ansam_1993"<br/><br/># Create a new DB<br/>sslmode = "require"<br/>dbname = "postgres"<br/>conn_string = "host={0} user={1} dbname={2} password={3} sslmode={4}".format(host, user, dbname, password, sslmode)<br/>conn = psycopg2.connect(conn_string)<br/>conn.set_isolation_level(ISOLATION_LEVEL_AUTOCOMMIT);<br/>print("Connection established")<br/><br/>cursor = conn.cursor()<br/>cursor.execute('DROP DATABASE IF EXISTS ayDB')<br/>cursor.execute("CREATE DATABASE ayDB")<br/># Clean up initial connection<br/>conn.commit()<br/>cursor.close()<br/>conn.close()<br/><br/># Reconnect to the new DB<br/>dbname = "aydb"<br/>conn_string = "host={0} user={1} dbname={2} password={3} sslmode={4}".format(host, user, dbname, password, sslmode)<br/>conn = psycopg2.connect(conn_string)<br/>print("Connection established")<br/>cursor = conn.cursor()<br/><br/># Helper functions<br/>def drop_recreate(c, tablename, create):<br/>    c.execute("DROP TABLE IF EXISTS {0};".format(tablename))<br/>    c.execute(create)<br/>    print("Finished creating table {0}".format(tablename))<br/><br/>def populate_table(c, filename, tablename):<br/>    f = open(filename, 'r')<br/>    try:<br/>        cursor.copy_from(f, tablename, sep=",", null = "")<br/>        conn.commit()<br/>    except (Exception, psycopg2.DatabaseError) as error:<br/>        print("Error: %s" % error)<br/>        conn.rollback()<br/>        cursor.close()<br/>    print("Finished populating {0}".format(tablename))<br/><br/># Create Rider table<br/>table = "rider"<br/>filename = '/content/riders.csv'<br/>create = "CREATE TABLE rider (rider_id INTEGER PRIMARY KEY, first VARCHAR(50), last VARCHAR(50), address VARCHAR(100), birthday DATE, account_start_date DATE, account_end_date DATE, is_member BOOLEAN);"<br/><br/>drop_recreate(cursor, table, create)<br/>populate_table(cursor, filename, table)<br/><br/># Clean up<br/>conn.commit()<br/>cursor.close()<br/>conn.close()<br/><br/>print("All done!")</span></pre><h1 id="4c69" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">与 Postgresql 链接的服务:</h1><p id="f22b" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mw lc ld le mx lg lh li my lk ll lm ij bi translated">正如我们看到的，已经创建了链接服务，现在我们希望为 Postgresql 创建类似的服务，如下所示</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/d5b8c6482b28a149993868a18a1d9663.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3eDiWKCfUPraAgldoJXuxw.png"/></div></div></figure><p id="9c18" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">搜索 Postgres 并选择突出显示的一个</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi og"><img src="../Images/c9cdb5baa69f7645e50e90af52f267dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/format:webp/1*s20Lltpzr0EXVWdKvdmS9g.png"/></div></figure><p id="1759" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为链接的服务命名，选择您的订阅和服务器</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/0527d2b66f41a12d4408066b67faf01b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*36zYXLKQ24Fr6SDNgxXz1A.png"/></div></figure><p id="6050" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后你会发现一个数据库列表，选择我们刚刚在本教程中创建的“aydb”，测试连接并点击创建按钮。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/6a714c0d328d046fcd185aa8b344afb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*VPRqmrMKCP3z7e_tlfGURg.png"/></div></figure><p id="f68e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">正如我们在下面看到的，PostgreSQL 的链接服务已经创建。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/64949991e608fa3eea8857749eefcfca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xVKmZ_NV0qfrtq05FulwTQ.png"/></div></div></figure><h1 id="e493" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">包扎</h1><p id="3a26" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mw lc ld le mx lg lh li my lk ll lm ij bi translated">在本教程中，您学习了如何:</p><ul class=""><li id="82bf" class="lo lp iq kt b ku kv kx ky la lq le lr li ls lm lt lu lv lw bi translated">创建 Postgres 数据库。</li><li id="024a" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm lt lu lv lw bi translated">使用 python 脚本在 Postgres 上创建一个新的数据库。</li><li id="86f7" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm lt lu lv lw bi translated">在 Synapse 上为 Postgres 创建链接服务。</li></ul><p id="b399" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我希望你喜欢阅读这篇文章，并发现它内容丰富。在接下来的文章中，我们将继续探索 synapse 分析工具，用 Azure 实现云数据仓库。请随意添加您的评论、想法或反馈，并且不要忘记在<a class="ae ln" href="https://www.linkedin.com/in/ansam-yousry-34b32b116/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上联系或关注我的媒体帐户以保持更新。</p></div></div>    
</body>
</html>