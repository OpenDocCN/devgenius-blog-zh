<html>
<head>
<title>Problems That We May Run Into When Refactoring</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">重构时我们可能会遇到的问题</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/problems-that-we-may-run-into-when-refactoring-96ba081cabe?source=collection_archive---------18-----------------------#2020-07-03">https://blog.devgenius.io/problems-that-we-may-run-into-when-refactoring-96ba081cabe?source=collection_archive---------18-----------------------#2020-07-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/2f9333421e6920f7b9f0844b2aebeaf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cscdSr0cj1rQ6svX"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Jorge Franganillo 在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="063b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">重构是我们在开发软件时经常要做的事情。因此，我们必须了解它。</p><p id="fe51" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看重构时可能会遇到的问题。</p><h1 id="30a8" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">更改界面</h1><p id="5d23" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">当我们改变一个接口时，这意味着任何实现该接口的东西和任何调用实现该接口的东西的东西都必须改变。</p><p id="c821" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">拥有接口的全部意义在于，我们不必担心某些东西的底层实现。</p><p id="7c16" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以为重构做一些改变。更改方法名是可以的，因为它们可以一次自动更改。</p><p id="cfb7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，如果我们改变一个已经发布的接口，那么我们必须保持接口的新旧版本，以避免破坏任何现有的代码。</p><p id="ae21" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们改变了函数的签名，那么我们要么调用旧的函数，要么调用新的函数，这取决于使用了哪个接口。</p><p id="8344" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们应该尝试引用这两个接口，看看代码是否仍然可以在新旧接口上工作。</p><p id="9a4e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以弃用旧界面，这样我们就不会引入突破性的变化，但让旧界面的用户知道旧界面将被弃用，并在未来被删除。</p><h1 id="633e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">难以重构的设计变更</h1><p id="df32" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">有些设计变更很难重构。</p><p id="5702" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这可能意味着我们必须从头开始设计那部分程序，并编写干净的代码来清理代码。</p><h1 id="d889" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">什么时候不应该重构？</h1><p id="95e6" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">有些时候我们不应该重构。如果代码太乱，无法重构，我们可能不得不从头开始编写代码。</p><p id="c108" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那样的话，从头开始可能更容易些。</p><p id="675f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们应该重写的一个明显迹象是当当前代码不能按预期工作时。我们可能会发现它充满了无法稳定的错误。</p><p id="dbc7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们想要重构，代码必须大部分正确工作。</p><p id="c32e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也可以考虑将一大段代码重构为具有强封装的组件。</p><p id="1f92" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样，我们可以一次重构或重建一段代码。由于这种松散耦合，修改代码要比保留现有代码容易得多。</p><p id="0350" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们接近最后期限，那么我们不应该重构。重构总是有机会破坏代码。</p><p id="308a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">未完成的重构是技术债。大多数公司需要债务才能正常运转。</p><p id="213f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，我们不能让它失控，否则公司会破产的。</p><p id="49d1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在软件开发的情况下，我们通过重构代码来管理债务。</p><p id="8835" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一旦我们交付了代码，我们就可以重构了。</p><h1 id="165f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">重构和设计</h1><p id="305b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">一起重构和设计。我们应该从一开始就很好地设计我们的代码，这样我们就不必进行太多的重构。</p><p id="938a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们糟糕地设计了代码之后进行重构并不是最有效地利用我们的时间。</p><p id="5639" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们都遇到过糟糕代码的问题，在我们完成糟糕的设计之后。</p><p id="fd13" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们要么不得不做大量的重构，要么不得不从头重写糟糕的部分。</p><p id="13ae" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们不应该将我们的软件构建得过于灵活。灵活的解决方案比不灵活的更难维护。</p><p id="a7a7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们不需要灵活性，那么我们就不应该把它放进去。</p><p id="4c47" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">灵活性花费我们更多的时间来构建，因为它增加了我们代码的复杂性。</p><p id="15c4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这让大家都很沮丧。</p><p id="c12e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">即使我们现在没有实现灵活的解决方案，如果需要，我们仍然可以在以后的代码中增加灵活性。</p><p id="9f93" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">重构可以在不牺牲灵活性的情况下带来简单的设计。</p><p id="19b5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">设计过程可以更容易，压力也更小，因为我们不必为现在不需要的所有灵活性而设计。</p><p id="65d6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们总是可以重构我们的代码来增加我们需要的灵活性。</p><p id="b86a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们应该设计易于重构的代码。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi me"><img src="../Images/a98236e22824bf8798bbe1dfff8b0cfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8DZqRESlH94iX_Se"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae kc" href="https://unsplash.com/@aiony?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">alony Haust</a>拍摄的照片</figcaption></figure><h1 id="3525" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="ddbf" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们遇到的问题包括改变界面和增加灵活性。</p><p id="09f4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">更改接口意味着更改实现接口和使用接口的任何东西的实现。</p><p id="fcda" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们必须保留新旧接口，摒弃旧接口，以避免破坏人们代码的变化。</p><p id="81aa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们必须设计代码，使它们易于重构，以便我们可以在以后对它们进行更改。</p></div></div>    
</body>
</html>