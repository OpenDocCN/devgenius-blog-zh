<html>
<head>
<title>Learn SQL The Right Way Part 3: Relationships</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">正确学习 SQL 第 3 部分:关系</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/learn-sql-the-right-way-part-3-relationships-c421eb2c6738?source=collection_archive---------14-----------------------#2022-08-22">https://blog.devgenius.io/learn-sql-the-right-way-part-3-relationships-c421eb2c6738?source=collection_archive---------14-----------------------#2022-08-22</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div class="gh gi jk"><img src="../Images/d2a03ed15777c8296d189fb5c4928ecf.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*ddll1vtb537KJd_7jzrr-g.png"/></div><figcaption class="jr js gj gh gi jt ju bd b be z dk translated">来源:<a class="ae jv" href="https://www.codesmithtools.com/lib/images/plinqo/user-role-many-to-many.png" rel="noopener ugc nofollow" target="_blank">https://www . codesmithtools . com/lib/images/plinqo/user-role-many-to-many . png</a></figcaption></figure><h1 id="3c66" class="jw jx in bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">学习成果</h1><ul class=""><li id="df6e" class="ku kv in kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">关系的类型</li><li id="8c0e" class="ku kv in kw b kx lm kz ln lb lo ld lp lf lq lh li lj lk ll bi translated">ER 图表</li><li id="3220" class="ku kv in kw b kx lm kz ln lb lo ld lp lf lq lh li lj lk ll bi translated">参照完整性</li></ul><h1 id="dc4b" class="jw jx in bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">什么是关系？</h1><p id="425f" class="pw-post-body-paragraph lr ls in kw b kx ky lt lu kz la lv lw lb lx ly lz ld ma mb mc lf md me mf lh ig bi translated">关系是表之间的关联方式，可以是两个或更多的表。关系基于使用主键和外键。如果你没有听说过主键或外键，我会阅读<a class="ae jv" href="https://medium.com/dev-genius/learn-sql-the-right-way-part-2-key-types-52848fcca792" rel="noopener"> <strong class="kw io">第二部分</strong> </a>。</p><h1 id="7375" class="jw jx in bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">关系的类型</h1><h1 id="f3f1" class="jw jx in bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">一对一的</h1><p id="4d8d" class="pw-post-body-paragraph lr ls in kw b kx ky lt lu kz la lv lw lb lx ly lz ld ma mb mc lf md me mf lh ig bi translated">对于主表中的每个实体，在外表中有且只有一条记录</p><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi mg"><img src="../Images/431fee482b79814560a17e1515b92b02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eshhvrTgLTAfzFqFKQw65g.png"/></div></div><figcaption class="jr js gj gh gi jt ju bd b be z dk translated">学生桌</figcaption></figure><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi mg"><img src="../Images/cd7c55fb53f84e39f8bf04fee996b14a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bojzghLIvYcVUq0kKAAGdg.png"/></div></div><figcaption class="jr js gj gh gi jt ju bd b be z dk translated">联系表</figcaption></figure><p id="f53e" class="pw-post-body-paragraph lr ls in kw b kx mp lt lu kz mq lv lw lb mr ly lz ld ms mb mc lf mt me mf lh ig bi translated">学生和联系表有一对一的关系，这是因为每个学生只有一个联系号码。在技术术语中，我们可以看到 1 的 Id 在 contact 表中只出现一次，因此这符合我们上面的定义。</p><h1 id="9ab3" class="jw jx in bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">一对多</h1><p id="e2f9" class="pw-post-body-paragraph lr ls in kw b kx ky lt lu kz la lv lw lb lx ly lz ld ma mb mc lf md me mf lh ig bi translated">对于主表中的每个实体，在外表中都有一个或多个相关记录。</p><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi mg"><img src="../Images/0eb8958c21ffcdc2b5c5840fac9d492b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*umKhBjm0Xrv-4-CZXvdRug.png"/></div></div><figcaption class="jr js gj gh gi jt ju bd b be z dk translated">客户表</figcaption></figure><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi mg"><img src="../Images/81dd87d289dfa029083ec80f62d933e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OjjVZ_K368MApIA_usGM3Q.png"/></div></div><figcaption class="jr js gj gh gi jt ju bd b be z dk translated">订单表</figcaption></figure><p id="cb70" class="pw-post-body-paragraph lr ls in kw b kx mp lt lu kz mq lv lw lb mr ly lz ld ms mb mc lf mt me mf lh ig bi translated">customers 表和 order 表是一对多关系，这是因为一个客户可以下许多订单。记住上面的定义，我们可以看到 ID 1 不止出现一次，ID 2 只出现一次，这符合我们的定义。您可能会认为定义中有一个或多个状态，那么由于 ID 3 不在表中，会发生什么呢？关系并不总是通过查看键来定义的，例如，我们知道在这个表有任何实体之前，一个客户可以下多个订单，这并不意味着一个客户必须下一个订单。所以，我们可以看到这些关系是预先定义好的。</p><h1 id="aaee" class="jw jx in bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">多对多</h1><p id="b1e3" class="pw-post-body-paragraph lr ls in kw b kx ky lt lu kz la lv lw lb lx ly lz ld ma mb mc lf md me mf lh ig bi translated">对于主表中的每个实体，外表中都有许多相关记录，对于外表中的每个实体，主表中也有许多相关记录。</p><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi mu"><img src="../Images/001f82fc079b30db26870d331929d671.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cTYxjW3n8HKDeYFXmS0_MA.png"/></div></div><figcaption class="jr js gj gh gi jt ju bd b be z dk translated">学生和班级是多对多的</figcaption></figure><p id="1f95" class="pw-post-body-paragraph lr ls in kw b kx mp lt lu kz mq lv lw lb mr ly lz ld ms mb mc lf mt me mf lh ig bi translated">在本例中，关系是多对多的，学生可以上许多课，而每个课将包含许多学生。如果我们查看注册表，我们可以看到学生 ID 和班级 ID 的许多实例。那么，为什么多对多关系有三个表呢？这是为了使数据更具可读性，如果我们在班级表中有那个班级的学生，我们会遇到一个逻辑噩梦。</p><p id="0c3c" class="pw-post-body-paragraph lr ls in kw b kx mp lt lu kz mq lv lw lb mr ly lz ld ms mb mc lf mt me mf lh ig bi translated">我们可以这样做的一个方法是让更多的属性被称为 student1，student2。</p><figure class="mh mi mj mk gt jo"><div class="bz fp l di"><div class="mv mw l"/></div><figcaption class="jr js gj gh gi jt ju bd b be z dk translated">包含学生 1、学生 2、学生 3 和学生 4 的班级表</figcaption></figure><p id="5ea1" class="pw-post-body-paragraph lr ls in kw b kx mp lt lu kz mq lv lw lb mr ly lz ld ms mb mc lf mt me mf lh ig bi translated">这样做的主要问题是，如果一个班级有四个以上的学生，我们需要在表中增加一个额外的属性。另一种方法是让学生一遍又一遍地重复同样的课程</p><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi mg"><img src="../Images/da90951225e28628f41a45c7b3136548.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J57C62DWLB9di1EXjkvwYQ.png"/></div></div><figcaption class="jr js gj gh gi jt ju bd b be z dk translated">包含重复实体和学生 ID 列的类别表</figcaption></figure><p id="87d3" class="pw-post-body-paragraph lr ls in kw b kx mp lt lu kz mq lv lw lb mr ly lz ld ms mb mc lf mt me mf lh ig bi translated">这样做的主要问题是，如果我们要更新标题或描述，我们必须对包含我们希望更新的标题和描述的每个实体都这样做。</p><p id="e4a3" class="pw-post-body-paragraph lr ls in kw b kx mp lt lu kz mq lv lw lb mr ly lz ld ms mb mc lf mt me mf lh ig bi translated">您会注意到，许多 RDBMS 实际上并不支持多对多关系，所以根据经验，多对多关系被拆分到三个表中，使用一对多关系。随着你练习得越来越多，这将变得相当琐碎。</p><h1 id="0f12" class="jw jx in bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">ER 图表</h1><h1 id="9d9f" class="jw jx in bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">什么是 ER 图</h1><p id="c97f" class="pw-post-body-paragraph lr ls in kw b kx ky lt lu kz la lv lw lb lx ly lz ld ma mb mc lf md me mf lh ig bi translated">ER 图是一个实体关系图。这是一种流程图，用于直观地显示“实体”如人、物体或概念如何相互联系。ER 图是用来规划数据库的一个很好的工具。我不会讲太多的细节，因为我可以涵盖很多符号，但我会展示一些简单的例子。我推荐去 https://www.lucidchart.com/pages/er-diagrams 了解更多关于 ER 图的知识。</p><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi mx"><img src="../Images/117cacac0c0eac95f93cb268f867e83d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZptyiMUrQK4jwHPcYlJSFw.png"/></div></div><figcaption class="jr js gj gh gi jt ju bd b be z dk translated">ER 图布局</figcaption></figure><h1 id="4cea" class="jw jx in bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">一对一的例子</h1><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div class="gh gi my"><img src="../Images/1346038bde33acc8cf7d9449332b0f84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*oh6VVxSbw0JVG4FDDfcK9Q.png"/></div><figcaption class="jr js gj gh gi jt ju bd b be z dk translated">员工和团队一对一的关系</figcaption></figure><p id="5320" class="pw-post-body-paragraph lr ls in kw b kx mp lt lu kz mq lv lw lb mr ly lz ld ms mb mc lf mt me mf lh ig bi translated">这是一个一对一关系的例子；我们可以看到，线以上的数字是一对一的关系。在这个例子中，我们看不到表的属性，这很好，因为在计划的这一点上，您将决定您想要什么样的表。中间的菱形告诉我们关系的性质，因此我们可以看到一个<strong class="kw io">员工</strong> <strong class="kw io">管理</strong>一个<strong class="kw io">团队。这很有用，因为有时这种关系并不总是那么明显。</strong></p><h1 id="c258" class="jw jx in bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">一对多示例</h1><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div class="gh gi my"><img src="../Images/f8ad3a2d47b78df8e86f5f379f7f4942.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*f8SNb3qcPt5qp_jFWnLDZA.png"/></div><figcaption class="jr js gj gh gi jt ju bd b be z dk translated">客户和订单一对多关系</figcaption></figure><p id="5e37" class="pw-post-body-paragraph lr ls in kw b kx mp lt lu kz mq lv lw lb mr ly lz ld ms mb mc lf mt me mf lh ig bi translated">在这个例子中，我们可以看到 N，而不是数字 1，N 基本上意味着很多。我们使用 N 的原因是因为它可以是 1，100 甚至 1000。它遵循与上面的例子相似的布局，我们可以看到一个<strong class="kw io">客户</strong>可以<strong class="kw io">下</strong>许多<strong class="kw io">订单</strong>。我们也可以把它换一下，我们称之为多对一，它的行为完全一样。让我们看一个例子。</p><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div class="gh gi my"><img src="../Images/85221f22533b455f2d5869af961442aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*Mlr7olIkA19pQSjqnujN5A.png"/></div><figcaption class="jr js gj gh gi jt ju bd b be z dk translated">员工和部门多对一关系</figcaption></figure><p id="0ed7" class="pw-post-body-paragraph lr ls in kw b kx mp lt lu kz mq lv lw lb mr ly lz ld ms mb mc lf mt me mf lh ig bi translated">这向我们表明，许多<strong class="kw io"/><strong class="kw io">员工</strong> <strong class="kw io">向</strong> <strong class="kw io">一个</strong> <strong class="kw io">部门报告。</strong></p><h1 id="2d13" class="jw jx in bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">多对多示例</h1><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div class="gh gi my"><img src="../Images/af4ec9df402da3bd9377abbe1a26ee1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*HTqbM_pXYCANMpZBj2a9UA.png"/></div><figcaption class="jr js gj gh gi jt ju bd b be z dk translated">学生和班级多对多关系</figcaption></figure><p id="da78" class="pw-post-body-paragraph lr ls in kw b kx mp lt lu kz mq lv lw lb mr ly lz ld ms mb mc lf mt me mf lh ig bi translated">在这个例子中，我们可以看到 M 和 N，原因是简单的代数规则，如果两者都使用字母 N，它们将是相同的数字，但我们知道在多对多中，它可能是 2 到 5 或 2000 到 10000。如果您还记得，我之前提到过，作为经验法则，多对多应该分布在三个表中。请记住，这仍然是计划的早期阶段，我们还没有添加键和属性，所以现在还可以。上例显示<strong class="kw io">多</strong> <strong class="kw io">学生</strong>能<strong class="kw io">报</strong> <strong class="kw io">多</strong>班。</p><h1 id="6197" class="jw jx in bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">参照完整性</h1><p id="1f5c" class="pw-post-body-paragraph lr ls in kw b kx ky lt lu kz la lv lw lb lx ly lz ld ma mb mc lf md me mf lh ig bi translated">这是一个你可能会遇到的常见错误，简单介绍一下是非常重要的。当您试图从一个表中删除一个主键，而该主键是另一个表中的外键时，就会出现参照完整性。大多数数据库不允许你在没有删除所有外键的情况下删除主键。</p><figure class="mh mi mj mk gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi mz"><img src="../Images/58fe5d6efaea90a6bfa78f51001f6312.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V7WtKwtt-eUoKOSJnCxt2g.png"/></div></div></figure><p id="b87c" class="pw-post-body-paragraph lr ls in kw b kx mp lt lu kz mq lv lw lb mr ly lz ld ms mb mc lf mt me mf lh ig bi translated">如您所见，删除 customer 将导致引用完整性，因为主键在 orders 表和 cust_calls 表中。因此，为了删除主键，我们必须首先删除所有的外键。</p><h1 id="3980" class="jw jx in bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">摘要</h1><ul class=""><li id="e55a" class="ku kv in kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">一对一-对于主表中的每个实体，在外部表中有且只有一个记录</li><li id="fd20" class="ku kv in kw b kx lm kz ln lb lo ld lp lf lq lh li lj lk ll bi translated">一对多-对于主表中的每个实体，在外部表中都有一个或多个相关记录。</li><li id="0002" class="ku kv in kw b kx lm kz ln lb lo ld lp lf lq lh li lj lk ll bi translated">多对多-对于主表中的每个实体，外表中都有许多相关记录，对于外表中的每个实体，主表中也有许多相关记录。</li></ul><blockquote class="na"><p id="567a" class="nb nc in bd nd ne nf ng nh ni nj lh dk translated">注意:多对多的经验法则分为三个表</p></blockquote><ul class=""><li id="0baa" class="ku kv in kw b kx nk kz nl lb nm ld nn lf no lh li lj lk ll bi translated">ER 图——一种表示数据库的可视化方式</li><li id="e129" class="ku kv in kw b kx lm kz ln lb lo ld lp lf lq lh li lj lk ll bi translated">参照完整性—在删除主键之前，不要忘记删除所有外键</li></ul><p id="c7b8" class="pw-post-body-paragraph lr ls in kw b kx mp lt lu kz mq lv lw lb mr ly lz ld ms mb mc lf mt me mf lh ig bi translated">暂时够了。</p><p id="d887" class="pw-post-body-paragraph lr ls in kw b kx mp lt lu kz mq lv lw lb mr ly lz ld ms mb mc lf mt me mf lh ig bi translated">在第四部分，我将讨论一个新的话题，叫做规范化。</p><p id="91fb" class="pw-post-body-paragraph lr ls in kw b kx mp lt lu kz mq lv lw lb mr ly lz ld ms mb mc lf mt me mf lh ig bi translated">接下来:以正确的方式学习 SQL 第 4 部分:规范化</p><p id="384b" class="pw-post-body-paragraph lr ls in kw b kx mp lt lu kz mq lv lw lb mr ly lz ld ms mb mc lf mt me mf lh ig bi translated"><em class="np">如果你喜欢这个，点击</em>👏<em class="np">在下面，所以其他人会在介质上看到它。欢迎任何反馈或意见。祝你今天开心！玩的开心！</em></p><h1 id="a4e0" class="jw jx in bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">来源</h1><p id="8f1d" class="pw-post-body-paragraph lr ls in kw b kx ky lt lu kz la lv lw lb lx ly lz ld ma mb mc lf md me mf lh ig bi translated"><a class="ae jv" href="https://www.lucidchart.com/pages/er-diagrams#section_0" rel="noopener ugc nofollow" target="_blank">https://www.lucidchart.com/pages/er-diagrams#section_0</a></p><p id="c0a7" class="pw-post-body-paragraph lr ls in kw b kx mp lt lu kz mq lv lw lb mr ly lz ld ms mb mc lf mt me mf lh ig bi translated"><a class="ae jv" href="https://docs.microsoft.com/en-us/office/vba/access/concepts/structured-query-language/define-relationships-between-tables-using-access-sql" rel="noopener ugc nofollow" target="_blank">https://docs . Microsoft . com/en-us/office/VBA/access/concepts/structured-query-language/define-relationships-between-tables-using-access-SQL</a></p></div></div>    
</body>
</html>