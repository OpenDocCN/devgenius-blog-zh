<html>
<head>
<title>Must-know functions for Pandas Time-Series Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫时间序列数据的必备函数</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/must-know-functions-for-pandas-time-series-data-abc84d957650?source=collection_archive---------4-----------------------#2021-11-24">https://blog.devgenius.io/must-know-functions-for-pandas-time-series-data-abc84d957650?source=collection_archive---------4-----------------------#2021-11-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2fd9" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">了解如何从 Pandas 时序数据中选择行</h2></div><p id="1ae5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Pandas 是处理时间序列数据的一个很好的工具。比较日期时间对象有时会很乏味。本教程向我们展示了用于从 pandas 时间序列中选择行的 pandas 函数。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lb"><img src="../Images/a1965fe7361a436f91f7387099a96f40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cbhT9az9UJbaWy2GgGhkew.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">AAPL 蜡烛图</figcaption></figure><h1 id="71cc" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">设置来自雅虎财经的熊猫时间序列数据</h1><p id="1257" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">让我们首先设置我们的数据集。我们将从雅虎财经下载苹果公司的股票价值。</p><pre class="lc ld le lf gt mo mp mq mr aw ms bi"><span id="8275" class="mt ls iq mp b gy mu mv l mw mx">import yfinance as yf<br/>df = yf.download("AAPL", interval="5m", period="60d")</span></pre><p id="cba8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这给出了一个时间序列数据帧，也就是说索引是一个日期时间对象。</p><pre class="lc ld le lf gt mo mp mq mr aw ms bi"><span id="3762" class="mt ls iq mp b gy mu mv l mw mx">2021–08–31 09:30:00<br/>2021–08–31 09:35:00<br/>2021–08–31 09:40:00<br/>2021–08–31 09:45:00<br/>2021–08–31 09:50:00<br/>2021–08–31 09:55:00<br/>2021–08–31 10:00:00<br/>2021–08–31 10:05:00<br/>2021–08–31 10:10:00<br/>2021–08–31 10:15:00</span></pre><p id="b548" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有 60 天的数据，时间间隔为 5 分钟。需要注意的是，如果您希望筛选的日期时间列在索引中，则只能使用下面演示的函数。如果不是这种情况，可以用 set_index 函数将其设置为索引。</p><h1 id="3e6f" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">从特定的每日间隔中选择行</h1></div><div class="ab cl my mz hu na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="ij ik il im in"><p id="5c31" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设我们对每天 09:30 到 10:00 之间的最高股票价格感兴趣。</p><pre class="lc ld le lf gt mo mp mq mr aw ms bi"><span id="e42b" class="mt ls iq mp b gy mu mv l mw mx">df.between_time("09:30", "09:45")["High"]</span></pre><p id="da4c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">输出:</p><pre class="lc ld le lf gt mo mp mq mr aw ms bi"><span id="8285" class="mt ls iq mp b gy mu mv l mw mx">Datetime<br/>2021-08-31 09:30:00-04:00    152.729996<br/>2021-08-31 09:35:00-04:00    152.425003<br/>2021-08-31 09:40:00-04:00    152.100006<br/>2021-08-31 09:45:00-04:00    152.389999<br/>2021-09-01 09:30:00-04:00    154.500000<br/>                                ...    <br/>2021-11-22 09:45:00-05:00    163.759995<br/>2021-11-23 09:30:00-05:00    161.800003<br/>2021-11-23 09:35:00-05:00    160.719498<br/>2021-11-23 09:40:00-05:00    160.740097<br/>2021-11-23 09:45:00-05:00    160.757095<br/>Name: High, Length: 240, dtype: float64</span></pre><p id="69e2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们需要一个特定的时间间隔时，我们应该使用 at_time 函数。</p><pre class="lc ld le lf gt mo mp mq mr aw ms bi"><span id="3712" class="mt ls iq mp b gy mu mv l mw mx">df.at_time("09:30")</span></pre><h1 id="bc93" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">基于日期选择行</h1><p id="602f" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">如果您想要特定日期的所有数据，您可以将索引与 ISO 格式的日期字符串进行比较。</p><pre class="lc ld le lf gt mo mp mq mr aw ms bi"><span id="c6ef" class="mt ls iq mp b gy mu mv l mw mx">df.loc["2021-09-01"]</span></pre><p id="1853" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设您想要选择某个日期之后的行。</p><pre class="lc ld le lf gt mo mp mq mr aw ms bi"><span id="1895" class="mt ls iq mp b gy mu mv l mw mx">df.loc["2021-09-01":]</span></pre><p id="0bc7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">输出:</p><pre class="lc ld le lf gt mo mp mq mr aw ms bi"><span id="882e" class="mt ls iq mp b gy mu mv l mw mx"><br/>Datetime<br/>2021–09–01 09:30:00–04:00 154.500000<br/>2021–09–01 09:35:00–04:00 154.720001<br/>2021–09–01 09:40:00–04:00 154.625000<br/>2021–09–01 09:45:00–04:00 154.539993<br/>2021–09–01 09:50:00–04:00 154.750000<br/> … <br/>2021–11–23 15:35:00–05:00 161.100006<br/>2021–11–23 15:40:00–05:00 161.227097<br/>2021–11–23 15:45:00–05:00 161.250000<br/>2021–11–23 15:50:00–05:00 161.585007<br/>2021–11–23 15:55:00–05:00 161.690002<br/>Name: High, Length: 4602, dtype: float64</span></pre><p id="e5e0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如您所见，输出中包含了开始日期。</p><h1 id="b77f" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">根据每月季节性选择行</h1><p id="2b17" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">让我们看一个例子，当我们有不同粒度的数据时。让我们下载 5 年的每日数据。</p><pre class="lc ld le lf gt mo mp mq mr aw ms bi"><span id="b646" class="mt ls iq mp b gy mu mv l mw mx">import yfinance as yf<br/>df = yf.download("AAPL", interval="1d", period="5Y")</span></pre><p id="ac28" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设我们想要创建一些季节性技术指标，并希望选择 12 月份的行。</p><pre class="lc ld le lf gt mo mp mq mr aw ms bi"><span id="8a53" class="mt ls iq mp b gy mu mv l mw mx">df.loc[df.index.month == 12]["High"]</span></pre><p id="d3cd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">输出:</p><pre class="lc ld le lf gt mo mp mq mr aw ms bi"><span id="a638" class="mt ls iq mp b gy mu mv l mw mx">Date<br/>2016–12–01 27.735001<br/>2016–12–02 27.522499<br/>2016–12–05 27.507500<br/>2016–12–06 27.590000<br/>2016–12–07 27.797501<br/> … <br/>2020–12–24 133.460007<br/>2020–12–28 137.339996<br/>2020–12–29 138.789993<br/>2020–12–30 135.990005<br/>2020–12–31 134.740005<br/>Name: High, Length: 103, dtype: float64</span></pre><h1 id="8f80" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">熊猫和时间序列数据摘要</h1><p id="6ee4" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">熊猫对于时间序列来说很棒。用于选择行的特定函数在创建季节属性或构建技术指标时非常有用。</p><p id="653c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢您的阅读！</p></div></div>    
</body>
</html>