<html>
<head>
<title>Snowflake Access Management in Brief</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">雪花访问管理简介</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/snowflake-access-management-in-brief-770be7cabe18?source=collection_archive---------6-----------------------#2022-10-21">https://blog.devgenius.io/snowflake-access-management-in-brief-770be7cabe18?source=collection_archive---------6-----------------------#2022-10-21</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><figure class="gm go jp jq jr js gi gj paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="gi gj jo"><img src="../Images/604d8992c87780397a1dad7b1c05d165.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4B25hYut4yJ5jOI7WKKMeg.png"/></div></div><figcaption class="jz ka gk gi gj kb kc bd b be z dk translated">箭头省立公园，2022 年 10 月 8 日</figcaption></figure><p id="fa0f" class="pw-post-body-paragraph kd ke ir kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ik bi translated">访问管理中有两个关键概念:1)用户/角色和 2)对象/权限。所有用户都属于一个或多个角色，而角色与权限(使用、选择、删除等)相关联。)到对象(数据仓库、数据库、表等)上。)</p><p id="75ed" class="pw-post-body-paragraph kd ke ir kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ik bi translated">雪花中有 5 个现成的角色:帐户管理员、安全管理员、系统管理员、用户管理员和公共用户。可以根据组织团队添加自定义角色。</p><figure class="lc ld le lf gu js gi gj paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="gi gj lb"><img src="../Images/1c9e0e388905c1e0484bf791f3d67895.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l41cMcHe6MKk4HyNp2CPpQ.png"/></div></div><figcaption class="jz ka gk gi gj kb kc bd b be z dk translated">角色和关系</figcaption></figure><p id="f9f9" class="pw-post-body-paragraph kd ke ir kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ik bi translated"><strong class="kf is"> ACCOUNTADMIN </strong>是顶级角色，是所有其他角色的父角色。它不应用作日常操作。父角色拥有子角色拥有的所有权限。</p><p id="c01f" class="pw-post-body-paragraph kd ke ir kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ik bi translated"><strong class="kf is"> SECUTIRYADMIN </strong>可以授予/撤销角色对象的权限，无论对象的所有者是谁。听起来是一种超能力。不要在日常操作中使用它。</p><p id="6539" class="pw-post-body-paragraph kd ke ir kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ik bi translated"><strong class="kf is">从 2020 年 4 月发布开始，用户管理员</strong>与安全管理员分离。它专门用于管理用户/角色，授予用户或其他角色角色等。</p><p id="9bb9" class="pw-post-body-paragraph kd ke ir kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ik bi translated"><strong class="kf is"> SYSADMIN </strong>是管理对象，并为角色授予对象权限。该角色负责日常管理任务。</p><p id="8ddf" class="pw-post-body-paragraph kd ke ir kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ik bi translated"><strong class="kf is"> PUBLIC </strong>是任何新创建用户的默认角色。</p><p id="1cc4" class="pw-post-body-paragraph kd ke ir kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ik bi translated"><strong class="kf is">自定义角色</strong>是由用户管理员角色根据组织层次结构创建的角色。它们通常被分配给父 SYSADMIN。在这种情况下，SYSADMIN 创建的对象可以与具有预期权限的角色相关联。</p><p id="7823" class="pw-post-body-paragraph kd ke ir kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ik bi translated"><strong class="kf is">鉴于上述角色目的，最佳实践通常可能是:</strong></p><p id="0cd0" class="pw-post-body-paragraph kd ke ir kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ik bi translated">1 作为用户管理员，为团队创建自定义角色/用户。将顶级自定义角色指定为 SYSADMIN 的子级。</p><p id="768a" class="pw-post-body-paragraph kd ke ir kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ik bi translated">2 作为自定义角色，创建仓库、数据库、模式、表、阶段等。并为顶级自定义角色下的角色授予对这些对象的适当权限。</p><p id="bc9a" class="pw-post-body-paragraph kd ke ir kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ik bi translated">3 作为 SYSADMIN，创建对象并跨不同的自定义角色授予权限。</p><p id="040d" class="pw-post-body-paragraph kd ke ir kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ik bi translated">以下是为销售和财务两个团队设置角色、对象和授予权限的示例。</p><figure class="lc ld le lf gu js gi gj paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="gi gj lg"><img src="../Images/60c06b3f80c78b2a125b52b866c3e006.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QsJvSayGn1SQ3ur2lGILow.png"/></div></div></figure><p id="f22c" class="pw-post-body-paragraph kd ke ir kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ik bi translated"><strong class="kf is">步骤 1，</strong>我们将创建 4 个角色:销售管理角色、销售团队角色、财务管理角色和财务团队角色。另外，在每个角色中创建 4 个用户。</p><pre class="lc ld le lf gu lh li lj lk aw ll bi"><span id="3958" class="lm ln ir li b gz lo lp l lq lr">// switch role to USERADMIN<br/>use role useradmin;</span><span id="688f" class="lm ln ir li b gz ls lp l lq lr">// create sales admin and team roles<br/>create role sales_admin_role;<br/>create role sales_team_role;<br/>grant role sales_team_role to role sales_admin_role;<br/>grant role sales_admin_role to role sysadmin;</span><span id="3804" class="lm ln ir li b gz ls lp l lq lr">// create finance admin and team roles<br/>create role finance_admin_role;<br/>create role finance_team_role;<br/>grant role finance_team_role to role finance_admin_role;<br/>grant role finance_admin_role to role sysadmin;</span><span id="1d02" class="lm ln ir li b gz ls lp l lq lr">// create sales admin and team users, assign roles respectively<br/>create user sales_admin_user password='123' default_role=sales_admin_role must_change_password=true;<br/>grant role sales_admin_role to user sales_admin_user;<br/>create user sales_team_user password='123' default_role=sales_team_role must_change_password=true;<br/>grant role sales_team_role to user sales_team_user;</span><span id="cb9a" class="lm ln ir li b gz ls lp l lq lr">// create finance admin and team users, assign roles respectively<br/>create user finance_admin_user password='123' default_role=finance_admin_role must_change_password=true;<br/>grant role finance_admin_role to user finance_admin_user;<br/>create user finance_team_user password='123' default_role=finance_team_role must_change_password=true;<br/>grant role finance_team_role to user finance_team_user;</span></pre><p id="a53c" class="pw-post-body-paragraph kd ke ir kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ik bi translated"><strong class="kf is">步骤 2，</strong>然后作为系统管理员，创建销售和财务数据库，并将所有权授予团队管理员。</p><p id="3ee8" class="pw-post-body-paragraph kd ke ir kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ik bi translated">注意，需要明确授予数据库和模式的所有权。</p><pre class="lc ld le lf gu lh li lj lk aw ll bi"><span id="e836" class="lm ln ir li b gz lo lp l lq lr">use role sysadmin;</span><span id="0311" class="lm ln ir li b gz ls lp l lq lr">create or replace database salesdb;<br/>grant ownership on database  salesdb to role sales_admin_role;<br/>grant ownership on schema salesdb.public to role sales_admin_role;</span><span id="c482" class="lm ln ir li b gz ls lp l lq lr">create or replace database financedb;<br/>grant ownership on database  financedb to role finance_admin_role;<br/>grant ownership on schema financedb.public to role finance_admin_role;</span></pre><p id="5c32" class="pw-post-body-paragraph kd ke ir kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ik bi translated"><strong class="kf is">第三步，</strong>现在以 sales_admin_user 的身份登录雪花。您将看到 salesdb 数据库。</p><p id="b8cd" class="pw-post-body-paragraph kd ke ir kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ik bi translated">然后，该管理员用户可以创建表，并向销售团队角色授予权限。</p><pre class="lc ld le lf gu lh li lj lk aw ll bi"><span id="5034" class="lm ln ir li b gz lo lp l lq lr">grant usage on database salesdb to role sales_team_role;<br/>grant usage on schema salesdb.public to role sales_team_role;</span><span id="d8bf" class="lm ln ir li b gz ls lp l lq lr">create or replace table salesdb.public.sales_table (id int);</span><span id="2289" class="lm ln ir li b gz ls lp l lq lr">grant select on table salesdb.public.sales_table to role sales_team_role;</span></pre><p id="2e14" class="pw-post-body-paragraph kd ke ir kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ik bi translated">财务管理员用户也可以进行类似的操作。</p><p id="dc26" class="pw-post-body-paragraph kd ke ir kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ik bi translated"><strong class="kf is">第 4 步，</strong>最后，作为系统管理员，我们将授予财务管理员角色，以便能够查看销售数据库。这是跨角色授权。</p><pre class="lc ld le lf gu lh li lj lk aw ll bi"><span id="a2b5" class="lm ln ir li b gz lo lp l lq lr">use role sysadmin;<br/>grant usage on database salesdb to role finance_admin_role;<br/>grant usage on schema salesdb.public to role finance_admin_role;<br/>grant select on table salesdb.public.sales_table to role finance_admin_role;</span></pre><figure class="lc ld le lf gu js gi gj paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="gi gj lt"><img src="../Images/a9c0c1d1ec1fc63fe4a3da6959d27b88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u9CmggBnDBZQbpsHAMBCWg.png"/></div></div><figcaption class="jz ka gk gi gj kb kc bd b be z dk translated">财务管理员用户能够看到 salesdb</figcaption></figure><figure class="lc ld le lf gu js gi gj paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="gi gj lu"><img src="../Images/b77b8b3eb8439450189fdd305455b2b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Eh2KBz2NA6nlBSbSzlvZQ.png"/></div></div><figcaption class="jz ka gk gi gj kb kc bd b be z dk translated">财务团队用户只能查看财务 b</figcaption></figure><p id="584e" class="pw-post-body-paragraph kd ke ir kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ik bi translated">快乐阅读！</p><div class="lv lw gq gs lx ly"><a href="https://medium.com/@fengliplatform/membership" rel="noopener follow" target="_blank"><div class="lz ab fp"><div class="ma ab mb cl cj mc"><h2 class="bd is gz z fq md fs ft me fv fx iq bi translated">通过我的推荐链接-李冯加入媒体</h2><div class="mf l"><h3 class="bd b gz z fq md fs ft me fv fx dk translated">写作帮助我们自己，分享帮助很多人。从我自己的学习笔记开始，没有要求完美的压力…</h3></div><div class="mg l"><p class="bd b dl z fq md fs ft me fv fx dk translated">medium.com</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm jx ly"/></div></div></a></div></div></div>    
</body>
</html>