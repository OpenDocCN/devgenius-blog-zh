# Vim 还是 Neovim？以下是您应该使用后者的原因

> 原文：<https://blog.devgenius.io/vim-vs-neovim-26b856694566?source=collection_archive---------0----------------------->

## 尼奥维姆

## 混淆 Vim 和/或 Neovim？以下是我说服您今天使用 Neovim 的理由！

![](img/3e918d85c30919164cc56f0074576cf3.png)

Vim vs Neovim:用哪个？

如果你以前听说过 Vim，你就会知道最近几年出现的叉子！还有 [Neovim](https://neovim.io) (最受欢迎的叉子) [LunarVim](https://github.com/ChristianChiarulli/LunarVim) (最有前途的叉子之一)&其他无数。显而易见，为自己选择一个合适的可能是一项艰巨的任务。

因此，为了帮助您做出决定，本文将阐明选择 Neovim 而不是 vim 的一些原因。更具体地说，我们将在比较两者的同时研究日常用例。无论如何，在比较消费产品时，分析日常用例更有意义。

但是在我们深入到这篇文章的真正内容之前，像往常一样，先上一点历史课。

Vim 本身是早在 90 年代早期由布莱姆·米勒[设计的现已过时的](https://moolenaar.net/)[Vi](https://en.wikipedia.org/wiki/Vi)的改进克隆。Moolenaar 自己忽略了 Vim 的发展进程。几十年过去了，Vim 源代码开始变得陈旧&难以维护。它很臃肿，一些代码没有优化&它目前的功能集也没有老化。

但是，Neovim 是从零开始重建的！多余的&几十年的旧代码被淘汰了。同时，维护者试图为用户提供和 Vim 一样的能力。虽然，它确实预先包装了可选的类固醇。在文章的其余部分会有更多的介绍！

说了这么多，让我们深入研究一下&看看为什么今天应该使用 Neovim 而不是 vim。不过，请注意，这篇文章并不是要嘲笑 Vim 或它的忠实用户。相反，我们将尝试分析这两个编辑器的不同特性&看看它们在日常工作中有多有用。

# 为什么 Neovim 比 vim 更受欢迎

如前所述，Vim 很老了，因此它的源代码是过时的&很难维护。这也是 Neovim 当前开发团队放弃 vim 并开始自己的旅程的主要原因。

不像一些流传在 Neovim 周围的谣言，因为" *Bram 是一个独裁者* " &什么不是。创建 Neovim 也不是为了给社区更多的权力。但后者绝对是叉在好的方面无意的结果。

自从尼奥维姆被彻底重建以来，它打开了通往；

1.  更容易地添加有用的功能，如[语言-服务器协议](https://microsoft.github.io/language-server-protocol/) (LSP)，嵌入式 [Lua 5.1](https://jarmos.netlify.app/posts/vim-vs-neovim/lua.org) (和 LuaJIT)运行时&等等。
2.  更简洁和优化的源代码，更易于维护和减少加载时间。
3.  更好的插件开发环境。
4.  如有必要，通过改进插件扩展核心 Neovim 功能。

这些只是派生 Vim 源代码的几个好结果。但实际上，这个列表是永无止境的&随着 Neovim 逐渐成熟，有可能会有另一个理由来扩展这个列表。

其他一些同样突出的功能包括:

1.  插件开发人员可以使用 Neovim API 来构建几乎任何东西。
2.  可选的嵌入式 Lua 5.1 环境也是 Neovim 如此受社区喜爱的一个原因。如果用户愿意，可以用 Lua 而不是 VimScript 来配置 Neovim。
3.  一个内置的标准库，包括有用的函数，如`CheckHealth`和/或全局`vim`对象。这些用来检查一个插件是否设置正确。或者配置全局 Neovim 设置。
4.  预装了合理的默认设置，使“ *Vim 体验*”更加舒适。

如果这还不明显的话，Neovim 在有用的功能方面已经遥遥领先了。例如，选择用 VimScript 或 Lua 配置 Neovim。或者，如果你愿意，你甚至可以同时使用两者，选择权在你！

使用 Vim，您将被可怕的 VimScript 所困扰！虽然 LSP 功能是通过插件支持的，但体验并不像它的表亲那样流畅&即装即用。

也就是说，让我们更详细地了解一下上面提到的一些最常用的特性。

# Neovim 明显比 vim 快

如前所述，派生 Vim 的一个主要原因是它陈旧的源代码。由于 Vim 已经存在了将近 30 年，它的源代码现在已经相当臃肿了。它很难维护&简单地从零开始重建要容易得多，所以开发人员做了必要的事情。

由于这个决定，源代码得到了清理和优化。如果你注意到 Neovim 比它的前身快得多，这是显而易见的。

重建 Neovim 也为开发方便的功能打开了许多大门。编辑器最致命的特性之一是嵌入式 Lua 5.1 ( *和 LuaJIT* )环境。

开发人员还采取了其他性能优化措施。其中之一包括让 Neovim 在一个[事件循环](https://en.wikipedia.org/wiki/Event_loop)中运行。所以，你终于可以告别那些会提前挂掉的插件了！

除此之外，开发人员还确保了与 VimScript 的向后兼容性。因此，如果你是 Vim 的长期用户，想要试用 Neovim，不要着急，你会没事的。你可以配置 Neovim 读取你的旧版本`.vimrc`就可以了，尽管这里有一些琐碎的修改&。

但是，如果你承诺使用 Neovim &并准备采取潜水呢？那么我建议将您当前的 VimScript 配置迁移到 Lua 代码。您会注意到性能有所提高。

为了让大家了解我在这里所说的性能提升，我将分享我的经验。我的 Neovim 加载时间从 500 多毫秒减少到了 237 毫秒，简单地从 VimScript 迁移到 Lua 就有大约 50%的改进！

人们只能想象，如果进一步优化配置加载过程，它的执行速度会有多快。

另一方面，通过 Lua 进行配置是一个可选的特性。所以，你不必觉得有义务“*再学一门语言*”。在文章的下一部分会有更多的介绍。

# 选择放弃 VimScript 并采用 Lua

[neo vim 团队的目标之一](http://neovim.io/charter/)是“*开发一流的 Lua/LuaJIT 脚本替代 VimL* ”。忠于他们的话，开发人员没有强迫抛弃 VimScript 而支持 Lua。我怀疑我们中的任何人会在有生之年看到这一切发生！

因此，如果您想继续使用以前的 Vim 配置，您完全不必担心。但是，如果您确实需要 Lua 代码，比如说配置内置 LSP，该怎么办呢？

在这种情况下，Vim `heredoc`会帮助你。你可以在 VimScript 中嵌入 Lua 代码，语法如下:

“init.vim”文件中嵌入 VimScript 的 Lua 代码示例

您可以放心地出门，不必担心这会破坏您以前的 Vim 配置。Vim 仍然知道如何解析这些代码并理解它们。

虽然，这里有点个人意见，如果可以的话尽量不要用 VimScript。用 Lua 编码是一种非常愉快的体验。即使您不得不学习它，这种语言在 Vim 环境之外还有许多实际应用。所以，你不会浪费时间去学习一门多余的编程语言。如果您决定开始用 Lua 配置 Neovim，请通读这篇“[使用 Neovim 和 Lua](https://github.com/nanotee/nvim-lua-guide) 的指南”。

也就是说，Neovim 的嵌入式 Lua 环境的有用性通过其内置的标准库& API 得到了适当的体现。如果您是插件开发人员或 Vim 的普通用户，标准库在很多方面都很有用。它打包了许多有用的函数和命令来满足您的日常开发需求。

因此，在下一节中，我们将对此进行更详细的研究。

# 内置的标准库 API 是💖

Neovim 的第二个开发目标是为插件作者创造一个合适的环境。这样，插件作者可以轻松扩展 Neovim 的核心特性。devs 的核心团队通过创建 Neovim API 层&一个附带的“*标准库*”实现了这一壮举。

底层 API 层向用户展示了对 Neovim 进行编程控制的有用功能。这些函数通过一个名为`vim`的全局名称空间公开。

因此，假设我们想要配置 Neovim 来显示数字列。然后就像在一个`init.lua` ( *或* `*init.vim*` *)文件中编写`vim.api.nvim_set_option("number", true)`一样简单，只需加上一些说明*。你可以走了！

诚然，第一眼看到全局`vim`名称空间可能会感到困惑，但请继续关注我，我将帮助您理解它。

`vim`名称空间公开了几个日常使用的函数。最著名的包括`vim.api`、`vim.lsp`、&、`vim.inspect`函数。还有几个例子&，解释它们超出了本文的范围。但是，您可以在 Neovim 指南的 [Lua 的`*vim*` *名称空间部分*中找到这些函数的完整列表。](https://github.com/nanotee/nvim-lua-guide)

为了保持与本文的上下文相关，下面是一些由`vim.api`名称空间公开的最有用的函数:

1.  设置选项的功能，如`vim.api.nvim_set_option()`。或用于获取全局选项值的`vim.api.nvim_get_option()`。类似地，还有缓冲区局部函数和/或窗口局部函数。这些功能看起来分别像`vim.api.nvim_buf_set_option()` & `vim.api.nvim_win_set_option()`。
2.  如果不定制个性化的按键绑定，Vim 体验是不完整的。而且，有一个非常漂亮的函数可以做到这一点！`vim.api.nvim_set_keymap()`函数有四个参数。“*模式*”，你的自定义键绑定，表达式/默认键绑定&选项(*像“silent”*)传递给它。
3.  我发现的另一个日常有用的函数是`vim.api.replace_termcodes()`。用于转义终端& Vim 键码。因为 VimScript 在默认情况下会这样做，所以您永远不必担心像`"\<C-n>"` times 这样的转义问题。但是当通过 Lua 代码配置时，这并不像预期的那样工作。因此，这个函数有时会非常方便。

还有很多这样的功能&我们仅仅触及了可能的表面！有关`vim`名称空间的更多信息，请参考上面提到的“ *Lua for Neovim 指南*”。在`h: api`的官方文档中也可以很方便地找到关于函数的更多信息，`vim.api`名称空间公开了这些信息。

有了你手中的所有权力，天空几乎是扩展 Neovim 核心功能的极限。所以，自己去弄清楚吧&不要犹豫，把它们分享给 Neo(Vim)社区。

# 明智的默认设置带来更好的首次体验

如果您对编辑器的编程配置不感兴趣。或者，您曾经试用过 Vim，发现它很难使用？或者您不想花一整个周末的时间来配置 Vim 以满足您的特定需求？对你来说，我的朋友，有好消息。降低首次 Vim 用户的准入门槛是 Neovim 开发人员的首要开发目标。

那么，这对门外汉来说意味着什么呢？

意思是，Neovim，开箱即用的外观和感觉足够好。它不需要太多的配置&它可以满足您所有的软件开发需求。当然，这个功能没有 Neovim 的其他“T7”杀手级功能有趣，比如内置 LSP。或者是通过嵌入式 Lua 环境的编程配置系统。但这仍然是一个值得注意的重要特性。

当您需要一个编辑器来满足您的需求，帮助您完成日常任务时，您不会想要花一天(或两天)来配置它，不是吗？如果你属于这一类人，Neovim 值得一试。谁知道呢，你可能会喜欢它&在你余下的开发生涯中坚持下去。

# 最后的话和资源为您的旅程进入 Neovim-土地

现在，在我回答问题之前，" *Vim 或 Neovim:使用哪一个？*”。以下是我们之前讨论的所有内容的简短总结:

1.  Neovim 最初为什么会存在？以及它对社区的影响。
2.  我们现在知道，Neovim 的源代码被清理、优化&从头重写。因此，它明显比它的堂兄 Vim 要快。
3.  允许重新编写 Neovim 提供了包含许多有用特性的机会，比如 LSP、异步执行等。
4.  包含一个“*标准库*，增强了可选嵌入式 Lua 环境的可配置性。明智的默认配置，以减轻首次使用 Vim 的用户的体验。

…还有更多！这个清单是永无止境的&我在上面列出的只是蛋糕上的樱桃。这些特性也是 Neovim 与 vim 相比的突出之处。但是，如果有一天 Vim 也支持 Neovim 的大部分(如果不是全部的话)特性，这并不奇怪。

也就是说，您应该使用 Neovim，原因如下:

1.  您需要一个具有稳定的跨平台可用性的基于终端的编辑器。
2.  您已经是 Vim 的长期用户了&发现编辑器的某些特性，比如 VimScript，令人讨厌和沮丧。
3.  您需要像 LSP 这样的现代 IDE 特性来支持开箱即用和/或如果您需要一些缺省配置而不需要进一步的修改。
4.  最后，如果你需要一个现代的极简文本编辑器，Neovim 应该是你的首选。

你认为这些是试用 Neovim 的正当理由吗，让我知道你的想法！

*原载于 2021 年 7 月 15 日*[*https://jarmos . netlify . app*](https://jarmos.netlify.app/posts/vim-vs-neovim/)*。*