<html>
<head>
<title>Implements a basic search filter and column sort with pagination in Laravel CRUD</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 Laravel CRUD 中实现基本的搜索过滤器和带有分页的列排序</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/implements-a-basic-search-filter-and-column-sort-with-pagination-in-laravel-crud-5e3c70fb12ac?source=collection_archive---------2-----------------------#2022-04-25">https://blog.devgenius.io/implements-a-basic-search-filter-and-column-sort-with-pagination-in-laravel-crud-5e3c70fb12ac?source=collection_archive---------2-----------------------#2022-04-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="19ee" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Laravel 从头开始创建一个管理面板——第 6 部分</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/0a96fd280a0f1dc78c94bdec15c741ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GcAfdH87APOyYE_dUeaLvg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">Laravel CRUD 中的基本搜索过滤器和列排序</figcaption></figure><p id="7d61" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这一部分，我们将在 CRUD 中添加搜索和排序功能。为了更好地理解 Laravel，我不打算使用任何用于过滤和排序的包。</p><p id="e7a5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面的步骤是为我们的 Laravel 管理面板创建一个过滤器和排序。</p><ul class=""><li id="4037" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated"><strong class="kx ir"> 1。实现一个搜索过滤器</strong></li><li id="6ef5" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">1.1 在索引视图中添加搜索字段</li><li id="6c55" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">1.2 在控制器上添加过滤条件</li><li id="52c0" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated"><strong class="kx ir"> 2。实现列排序</strong></li><li id="e892" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">2.1 在视图中添加排序链接</li><li id="ebac" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">2.2 在查询中添加排序依据</li></ul><h1 id="cd10" class="mf mg iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">1.实现搜索过滤器</h1><h2 id="206f" class="mx mg iq bd mh my mz dn ml na nb dp mp le nc nd mr li ne nf mt lm ng nh mv ni bi translated">1.1 在索引视图中添加搜索字段</h2><p id="4704" class="pw-post-body-paragraph kv kw iq kx b ky nj jr la lb nk ju ld le nl lg lh li nm lk ll lm nn lo lp lq ij bi translated">权限 CRUD 只有名称字段。因此，在索引视图上添加以下名称过滤器</p><p id="8362" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">资源/视图/管理/权限/索引. blade.php</p><pre class="kg kh ki kj gt no np nq bn nr ns bi"><span id="c297" class="nt mg iq np b be nu nv l nw nx">+++ b/resources/views/admin/permission/index.blade.php<br/>@@ -22,6 +22,16 @@<br/>                             &lt;/div&gt;<br/>                         @endif<br/>                             &lt;div class="min-w-full border-b border-gray-200 shadow"&gt;<br/>+                                &lt;form method="GET" action="{{ route('permission.index') }}"&gt;<br/>+                                &lt;div class="py-2 flex"&gt;<br/>+                                    &lt;div class="overflow-hidden flex pl-4"&gt;<br/>+                                        &lt;input type="search" name="search" value="{{ request()-&gt;input('search') }}" class="rounded-md shadow-sm border-gray-300 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50" placeholder="Search"&gt;<br/>+                                        &lt;button type='submit' class='ml-4 inline-flex items-center px-4 py-2 bg-gray-800 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-gray-700 active:bg-gray-900 focus:outline-none focus:border-gray-900 focus:ring ring-gray-300 disabled:opacity-25 transition ease-in-out duration-150'&gt;<br/>+                                            {{ __('Search') }}<br/>+                                        &lt;/button&gt;<br/>+                                    &lt;/div&gt;<br/>+                                &lt;/div&gt;<br/>+                                &lt;/form&gt;<br/>                                 &lt;table class="border-collapse table-auto w-full text-sm"&gt;<br/>                                     &lt;thead&gt;<br/>                                         &lt;tr&gt;</span></pre><p id="1d82" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">此外，更改如下所示的<code class="fe ny nz oa np b">$permissions-&gt;links()</code>,在分页链接中追加查询参数</p><pre class="kg kh ki kj gt no np ob oc aw od bi"><span id="7f4b" class="mx mg iq np b gy oe of l og nx">{{ $permissions-&gt;appends(request()-&gt;query())-&gt;links() }}</span></pre><h2 id="5208" class="mx mg iq bd mh my mz dn ml na nb dp mp le nc nd mr li ne nf mt lm ng nh mv ni bi translated">1.2 在控制器上添加过滤条件</h2><p id="9f92" class="pw-post-body-paragraph kv kw iq kx b ky nj jr la lb nk ju ld le nl lg lh li nm lk ll lm nn lo lp lq ij bi translated">在 PermissionController 中，在索引函数上添加以下 where 条件</p><p id="b91f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">app/Http/Controllers/Admin/permission controller . PHP</p><pre class="kg kh ki kj gt no np nq bn nr ns bi"><span id="df0e" class="nt mg iq np b be nu nv l nw nx">if (request()-&gt;has('search')) {<br/>    $permissions-&gt;where('name', 'Like', '%' . request()-&gt;input('search') . '%');<br/>}</span></pre><p id="328c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">更新后，您的索引函数应该具有以下代码</p><pre class="kg kh ki kj gt no np nq bn nr ns bi"><span id="f7f5" class="nt mg iq np b be nu nv l nw nx">public function index()<br/>{<br/>    $permissions = Permission::latest();<br/>    if (request()-&gt;has('search')) {<br/>        $permissions-&gt;where('name', 'Like', '%' . request()-&gt;input('search') . '%');<br/>    }<br/>    $permissions = $permissions-&gt;paginate(5);<br/>    return view('admin.permission.index',compact('permissions'))<br/>        -&gt;with('i', (request()-&gt;input('page', 1) - 1) * 5);<br/>}</span></pre><p id="9310" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们在权限 CRUD 中添加了过滤器功能。类似地，我们可以在过滤器中添加多个字段。</p><p id="cb1a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">不要忘记运行<code class="fe ny nz oa np b">sail npm run dev</code>来重建 CSS</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/f134f0db4c9a31349b61e5a8f38f21b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z5Xse7sr_fKU8s00SY8dRQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">带有搜索过滤器的 Laravel CRUD</figcaption></figure></div><div class="ab cl oi oj hu ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="ij ik il im in"><h1 id="e55d" class="mf mg iq bd mh mi op mk ml mm oq mo mp jw or jx mr jz os ka mt kc ot kd mv mw bi translated"><strong class="ak"> 2。实施排序依据</strong></h1><h2 id="4250" class="mx mg iq bd mh my mz dn ml na nb dp mp le nc nd mr li ne nf mt lm ng nh mv ni bi translated">2.1 在视图中添加排序链接</h2><p id="f9c0" class="pw-post-body-paragraph kv kw iq kx b ky nj jr la lb nk ju ld le nl lg lh li nm lk ll lm nn lo lp lq ij bi translated">创建新的包含刀片文件以显示排序链接。这将有助于在其他 CRUD 中包含排序链接</p><p id="8a27" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">资源/视图/管理/包含/排序链接. blade</p><pre class="kg kh ki kj gt no np nq bn nr ns bi"><span id="c889" class="nt mg iq np b be nu nv l nw nx">@php<br/>    $down_fill = 'lightgray';<br/>    $up_fill = 'lightgray';<br/>    $attribute = $attribute ?? '';<br/>    $label = $label ?? '';<br/>    if(request()-&gt;query('sort') == $attribute) {<br/>        $up_fill = 'black';<br/>    }<br/>    if(request()-&gt;query('sort') == '-'.$attribute) {<br/>        $down_fill = 'black';<br/>    }<br/>@endphp<br/>@if (request()-&gt;query('sort') == $attribute)<br/>    &lt;a href="{{request()-&gt;fullUrlWithQuery(['sort' =&gt; '-'.$attribute])}}" class="no-underline hover:underline text-cyan-600 dark:text-cyan-400"&gt;{{ __($label) }}&lt;/a&gt;<br/>@else<br/>    &lt;a href="{{request()-&gt;fullUrlWithQuery(['sort' =&gt; $attribute])}}" class="no-underline hover:underline text-cyan-600 dark:text-cyan-400"&gt;{{ __($label) }}&lt;/a&gt;<br/>@endif<br/>&lt;svg class="inline-block"  width="15px" height="15px" viewBox="0 0 15 15" fill="none"&gt;<br/>    &lt;path d="M7.5 3L15 11H0L7.5 3Z" fill="{{$up_fill}}"/&gt;<br/>&lt;/svg&gt;<br/>&lt;svg class="inline-block"  width="15px" height="15px" viewBox="0 0 15 15" fill="none"&gt;<br/>    &lt;path d="M7.49988 12L-0.00012207 4L14.9999 4L7.49988 12Z" fill="{{$down_fill}}"/&gt;<br/>&lt;/svg&gt;</span></pre><p id="8e2e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在在 index.blade.php 把<code class="fe ny nz oa np b">{{ __(‘Name’) }}</code>替换到线下</p><pre class="kg kh ki kj gt no np ob oc aw od bi"><span id="2b62" class="mx mg iq np b gy oe of l og nx">@include('admin.includes.sort-link', ['label' =&gt; 'Name', 'attribute' =&gt; 'name'])</span></pre><p id="51b0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在重新加载浏览器并点击标题名称。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ou"><img src="../Images/e58b2db0de49d797b19cf02a5c289bd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AZoTruSAST65_rUssYo3Mg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">具有列排序的 Laravel CRUD</figcaption></figure><p id="1db1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">排序 ASC 订单的名称</p><p id="e10c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">DESC 订单的排序=-名称</p><h2 id="661a" class="mx mg iq bd mh my mz dn ml na nb dp mp le nc nd mr li ne nf mt lm ng nh mv ni bi translated">2.2 在查询中添加排序依据</h2><p id="1a96" class="pw-post-body-paragraph kv kw iq kx b ky nj jr la lb nk ju ld le nl lg lh li nm lk ll lm nn lo lp lq ij bi translated">在我们的索引查询中添加 order by 的时间。打开 PermissionController 索引函数，并用以下代码替换它</p><p id="a13e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">app/Http/Controllers/Admin/permission controller . PHP</p><pre class="kg kh ki kj gt no np nq bn nr ns bi"><span id="2294" class="nt mg iq np b be nu nv l nw nx">public function index()<br/>{<br/>    $permissions = (new Permission)-&gt;newQuery();<br/>    if (request()-&gt;has('search')) {<br/>        $permissions-&gt;where('name', 'Like', '%' . request()-&gt;input('search') . '%');<br/>    }<br/>    if (request()-&gt;query('sort')) {<br/>        $attribute = request()-&gt;query('sort');<br/>        $sort_order = 'ASC';<br/>        if (strncmp($attribute, '-', 1) === 0) {<br/>            $sort_order = 'DESC';<br/>            $attribute = substr($attribute, 1);<br/>        }<br/>        $permissions-&gt;orderBy($attribute, $sort_order);<br/>    } else {<br/>        $permissions-&gt;latest();<br/>    }<br/>    $permissions = $permissions-&gt;paginate(5);<br/>    return view('admin.permission.index',compact('permissions'))<br/>        -&gt;with('i', (request()-&gt;input('page', 1) - 1) * 5);<br/>}</span></pre><p id="a800" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，我们在 CRUD 中添加了列排序功能</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ov"><img src="../Images/403036648aa4af26017f0c832e601b78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1x2WFJlWwJvFp-DadbVprg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">带 ASC 排序的 CRUD</figcaption></figure></div><div class="ab cl oi oj hu ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="ij ik il im in"><p id="d8bb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们成功地在 CRUD 中添加了一个基本的搜索过滤器和带分页的列排序。</p><p id="2685" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下一部分，我们将创建剩余的角色和用户 CRUD。</p></div><div class="ab cl oi oj hu ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="ij ik il im in"><h1 id="3c35" class="mf mg iq bd mh mi op mk ml mm oq mo mp jw or jx mr jz os ka mt kc ot kd mv mw bi translated">GitHub 知识库</h1><p id="b7af" class="pw-post-body-paragraph kv kw iq kx b ky nj jr la lb nk ju ld le nl lg lh li nm lk ll lm nn lo lp lq ij bi translated">许可代码可在<a class="ae ow" href="https://github.com/balajidharma/basic-laravel-admin-panel/tree/archive/1.0.4" rel="noopener ugc nofollow" target="_blank"> 1.0.4 </a>分支上获得</p></div><div class="ab cl oi oj hu ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="ij ik il im in"><p id="9ff1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">上一部分—第 5 部分:<a class="ae ow" rel="noopener ugc nofollow" target="_blank" href="/laravel-crud-access-control-based-on-role-and-permission-f190d03f1fa2">基于角色和权限的 CRUD 访问控制</a></p><p id="0791" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下一部分—第 7 部分— <a class="ae ow" rel="noopener ugc nofollow" target="_blank" href="/create-ui-for-role-management-to-laravel-admin-panel-dce72b09d2ea">创建角色管理的用户界面，添加到管理面板</a></p></div></div>    
</body>
</html>