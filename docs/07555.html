<html>
<head>
<title>What does Istio service discovery do?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Istio 服务发现是做什么的？</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/what-does-istio-service-discovery-do-fe236236313?source=collection_archive---------4-----------------------#2022-04-05">https://blog.devgenius.io/what-does-istio-service-discovery-do-fe236236313?source=collection_archive---------4-----------------------#2022-04-05</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="50a1" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">了解 Istio 服务网格的服务发现功能</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/6193945a4b0c8b999b5ef14dcbbedc27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PKj_xepJ89kUrRYHTGAsVQ.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">斯科特·韦伯在<a class="ae ks" href="https://unsplash.com/s/photos/mesh?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="47e5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">微服务架构在行业中广泛用于开发大规模应用。Kubernetes 平台用于部署这些应用程序的工作负载。Service mesh 用于为开发人员处理流量整形、可观察性、安全性和服务发现等交叉特性，以便他们能够专注于核心业务逻辑。</p><h1 id="0ddf" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated"><strong class="ak">为什么需要服务发现？</strong></h1><p id="2023" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">服务发现特性对于开发人员在他们的应用程序中连接到不同的微服务非常有用。在下图中，我们可以看到在 Kubernetes 集群中部署了四个独立的微服务。出于授权目的，核心业务逻辑服务需要识别并连接到集群中的登录服务。类似地，业务逻辑服务需要连接到应用程序中其他用例场景的库存服务和历史服务。众所周知，IP 地址是动态分配给 k8s 集群中的所有服务的，因此，在建立连接之前，服务会用它们的主机名来标识。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mm"><img src="../Images/e9a33d6700a98d3313ef1e9f4595161c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k6_wfTWrEA378toMPO8jHw.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">没有服务网格的 Kubernetes 中的应用服务</figcaption></figure><p id="1a30" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在没有服务网格的情况下，服务的识别需要通过应用程序代码来处理，并且在跨名称空间识别服务时以及在跨数据中心和各种环境连接到服务和集群时，服务的识别变得难以维护。因此，在这种情况下，服务网格有助于跨集群服务发现。</p><h1 id="3a0b" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">Istio 中的服务发现是如何完成的？</h1><p id="1730" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">为了解决微服务架构中服务发现的上述挑战，并适当地引导服务网格内的流量，Istio 需要知道端点指向哪里，以及这些端点属于哪些服务。如果在 Kubernetes 集群上安装了 Istio 守护进程，那么它会自动检测特定集群中的服务及其端点，并在其内部注册表中为每个服务创建一个条目。</p><h2 id="f89e" class="mn lq in bd lr mo mp dn lv mq mr dp lz lc ms mt mb lg mu mv md lk mw mx mf my bi translated"><strong class="ak">什么是服务条目？</strong></h2><blockquote class="mz na nb"><p id="abe1" class="kt ku nc kv b kw kx jo ky kz la jr lb nd ld le lf ne lh li lj nf ll lm ln lo ig bi translated">在 Istio 维护的内部服务注册表中，包含服务属性(如端点、DNS 名称、端口、协议等)的记录被描述为<strong class="kv io"> <em class="in">服务条目</em> </strong>。在为每个服务添加了服务条目之后，特使代理可以向相应的服务发送流量。</p></blockquote><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mm"><img src="../Images/0265ed015ffbb5a4d06075b929de8f66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tpbxPemHCPRT9qu-OC8xkA.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">使用服务网格 Istio 的 Kubernetes 中的应用服务</figcaption></figure><p id="96be" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">使用 Istio 的内部服务注册表，特使代理读取服务条目记录并将流量导向相关服务。如果在任何应用程序中，有多个工作负载实例，那么特使代理将以循环方式将传入流量分配给每个实例，直到所有实例都收到请求。</p><h2 id="fbd9" class="mn lq in bd lr mo mp dn lv mq mr dp lz lc ms mt mb lg mu mv md lk mw mx mf my bi translated">结论—</h2><p id="c181" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">在跨名称空间和集群的多个服务之间进行管理和通信时，Istio 服务网格的服务发现特性没有那么麻烦。它将服务发现逻辑从 application pod 分离到充当代理的 sidecar pod。sidecar 代理可以轻松地与生态系统中的每个服务一起注入，而不必每次在运行应用程序之前为任何新服务更改核心应用程序逻辑。</p></div></div>    
</body>
</html>