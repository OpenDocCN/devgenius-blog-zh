<html>
<head>
<title>Change Data Capture in DWBI (ETL/ELT implementations)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">DWBI 中的变更数据捕获(ETL/ELT 实施)</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/change-data-capture-in-dwbi-etl-elt-implementations-af08b54d8fb5?source=collection_archive---------5-----------------------#2021-09-17">https://blog.devgenius.io/change-data-capture-in-dwbi-etl-elt-implementations-af08b54d8fb5?source=collection_archive---------5-----------------------#2021-09-17</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="60e6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">变更数据捕获(CDC)是 DWBI 实施最重要的功能之一。CDC 用于识别更改的数据，并将更改应用于数据仓库。变更数据捕获(CDC)是<strong class="jm io">识别源系统中的数据何时发生变化的过程</strong>，以便下游流程或系统能够对该变化采取行动。一个常见的用例是反映不同目标系统中的变化，以便系统中的数据保持同步。</p><p id="7e65" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">变更数据捕获(CDC)记录适用于表的插入、更新和删除活动。该活动以一种易于使用的关系格式提供了变更的细节。为修改的行捕获将更改应用到目标环境所需的列信息和元数据，并将其存储在反映跟踪的源表的列结构的更改表中。</p><p id="6a0a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这项技术针对的数据消费者的一个很好的例子是提取、转换和加载(ETL)应用程序。ETL 应用程序将变更数据从源系统增量加载到数据仓库或数据集市。</p><p id="0bc0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">可以实施不同类型的 CDCs 类型 I、类型 II 和类型 III。类型 I 不存储历史。这直接更新记录，没有历史值的记录，只有当前状态。类型 II——行版本控制，使用当前标志和有效日期以及其他元数据作为版本记录跟踪更改。类型 III -历史版本化，保留数据的版本。跟踪对特定属性的更改，添加一列以显示以前的值，该值会随着进一步的更改而更新。SCD 类型 II 在 DWBI 被广泛使用。</p><p id="fca5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们看看如何在 ETL 和 ELT 实现中实现 SCD 类型 II。对于 SCD 类型 II 实现，目标表需要添加一些额外的列来跟踪版本控制，例如 Active_IND、Start_Date、End_Date 等。活动指示器列表示记录是活动的还是非活动的(旧/历史记录)。对于新的/更新的记录，指示器列设置为“Y”或“Yes ”,对于旧的记录，设置为“N”或“No”。当记录是开始日期/加载日期时，开始日期是日期。结束日期是历史记录更新的日期。对于插入的所有新/活动记录，结束日期设置为空。</p><p id="be4d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">up serts——根据更改将更新和插入应用于目标表/系统。这可以用于 ETL 和 ELT 实现。SCD 可以使用 SQL、ETL 工具、数据库对象存储过程、函数等来实现。</p><p id="49f8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">下面是作为 SCD 类型 II 的一部分，识别和应用对目标系统的改变所遵循的步骤。</p><ol class=""><li id="d2e1" class="ki kj in jm b jn jo jr js jv kk jz kl kd km kh kn ko kp kq bi translated">增量捕获-按计划从源系统接收源数据。</li><li id="bf18" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kn ko kp kq bi translated">确定与目标表进行比较的变更源数据，以确定已存在/更新的记录以及被视为插入目标表的新记录</li><li id="19dc" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kn ko kp kq bi translated">应用标识为要插入或更新的一次性更改记录。更新和插入可以应用于目标系统。在更新的情况下，使用更新日期更新 flag - Active_IND 和 End_date 的旧记录。在插入的情况下，active_ind 设置为 Y，End_date 为 NULL。所有记录都将被更新并作为插入内容一起插入到目标系统中。</li><li id="e637" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kn ko kp kq bi translated">在某些实现中，Batch_ID 还与日期和指示器列一起使用。通过批处理 id，可以用数据加载的批处理来标识加载。批次 id 也可用作审计批次控制的一部分。</li><li id="ca8e" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kn ko kp kq bi translated">关注我的下一篇博客，阅读更多关于 DWBI 的 ABC 实施-ETL/ELT 实施。</li></ol><ul class=""><li id="4c44" class="ki kj in jm b jn jo jr js jv kk jz kl kd km kh kw ko kp kq bi translated"><strong class="jm io">关于我</strong></li></ul><blockquote class="kx ky kz"><p id="52cb" class="jk jl la jm b jn jo jp jq jr js jt ju lb jw jx jy lc ka kb kc ld ke kf kg kh ig bi translated"><em class="in">我是 DWBI 和云师！我一直在处理各种遗留数据仓库、大数据实施、云平台/迁移。我是谷歌认证的专业云架构师。您可以联系我@</em><a class="ae le" href="https://www.linkedin.com/in/poojakelgaonkar" rel="noopener ugc nofollow" target="_blank"><em class="in">LinkedIn</em></a><em class="in">如果您需要任何认证、GCP 实施方面的帮助！</em></p></blockquote></div></div>    
</body>
</html>