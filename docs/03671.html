<html>
<head>
<title>Code Smell 39 — new Date()</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">代码气味39 —新日期()</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/code-smell-39-new-date-7a2571a81ecb?source=collection_archive---------10-----------------------#2020-12-01">https://blog.devgenius.io/code-smell-39-new-date-7a2571a81ecb?source=collection_archive---------10-----------------------#2020-12-01</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="1841" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated"><em class="kc"> 70s第一教程:getCurrentDate()。小菜一碟。我们处在20年代，时代不再全球化。</em></h2></div><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi kd"><img src="../Images/d3fca3dbaa1474bc779c4eaaf193cb3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8D037S1VrN0UXyKpgUzPIw.jpeg"/></div></div></figure><h1 id="67aa" class="kp kq in bd kr ks kt ku kv kw kx ky kz jt la ju lb jw lc jx ld jz le ka lf lg bi translated">问题</h1><ul class=""><li id="0c04" class="lh li in lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">连接</li><li id="a05e" class="lh li in lj b lk lz lm ma lo mb lq mc ls md lu lv lw lx ly bi translated">脆弱的测试</li><li id="68a9" class="lh li in lj b lk lz lm ma lo mb lq mc ls md lu lv lw lx ly bi translated">时区问题</li></ul><h1 id="41bb" class="kp kq in bd kr ks kt ku kv kw kx ky kz jt la ju lb jw lc jx ld jz le ka lf lg bi translated">解决方法</h1><ol class=""><li id="0312" class="lh li in lj b lk ll lm ln lo lp lq lr ls lt lu me lw lx ly bi translated">使用依赖注入来分离时间源。</li></ol><h1 id="18c1" class="kp kq in bd kr ks kt ku kv kw kx ky kz jt la ju lb jw lc jx ld jz le ka lf lg bi translated">示例代码</h1><h2 id="ef9c" class="mf kq in bd kr mg mh dn kv mi mj dp kz lo mk ml lb lq mm mn ld ls mo mp lf mq bi translated">错误的</h2><figure class="ke kf kg kh gt ki"><div class="bz fp l di"><div class="mr ms l"/></div></figure><h2 id="279e" class="mf kq in bd kr mg mh dn kv mi mj dp kz lo mk ml lb lq mm mn ld ls mo mp lf mq bi translated">对吧</h2><figure class="ke kf kg kh gt ki"><div class="bz fp l di"><div class="mr ms l"/></div></figure><h1 id="57be" class="kp kq in bd kr ks kt ku kv kw kx ky kz jt la ju lb jw lc jx ld jz le ka lf lg bi translated">侦查</h1><p id="4a5e" class="pw-post-body-paragraph mt mu in lj b lk ll jo mv lm ln jr mw lo mx my mz lq na nb nc ls nd ne nf lu ig bi translated">我们应该禁止全局函数策略。我们需要耦合到偶然的和可插入的时间源。</p><h1 id="6ffe" class="kp kq in bd kr ks kt ku kv kw kx ky kz jt la ju lb jw lc jx ld jz le ka lf lg bi translated">结论</h1><p id="60b9" class="pw-post-body-paragraph mt mu in lj b lk ll jo mv lm ln jr mw lo mx my mz lq na nb nc ls nd ne nf lu ig bi translated"><code class="fe ng nh ni nj b">Date.today() , Time.now()</code>等全局系统调用都是耦合气味。</p><p id="f944" class="pw-post-body-paragraph mt mu in lj b lk nk jo mv lm nl jr mw lo nm my mz lq nn nb nc ls no ne nf lu ig bi translated">因为测试必须在完全的环境控制下进行。我们应该很容易地设置时间，来回移动时间等等。</p><p id="2491" class="pw-post-body-paragraph mt mu in lj b lk nk jo mv lm nl jr mw lo nm my mz lq nn nb nc ls no ne nf lu ig bi translated">日期和时间类应该只创建不可变的实例。给出实际时间不是他们的责任。这违反了单一责任原则。</p><p id="ba44" class="pw-post-body-paragraph mt mu in lj b lk nk jo mv lm nl jr mw lo nm my mz lq nn nb nc ls no ne nf lu ig bi translated">时间的流逝总是被程序员嗤之以鼻。这使得对象是可变的，设计是糟糕的和耦合的。</p><h1 id="828e" class="kp kq in bd kr ks kt ku kv kw kx ky kz jt la ju lb jw lc jx ld jz le ka lf lg bi translated">关系</h1><div class="np nq gp gr nr ns"><a href="https://medium.com/dev-genius/code-smell-18-static-functions-68d35c15e76" rel="noopener follow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd io gy z fp nx fr fs ny fu fw im bi translated">代码味道18 —静态函数</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">又一个全球接入加上懒惰。</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">medium.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og kn ns"/></div></div></a></div><h1 id="5ec7" class="kp kq in bd kr ks kt ku kv kw kx ky kz jt la ju lb jw lc jx ld jz le ka lf lg bi translated">更多信息</h1><div class="np nq gp gr nr ns"><a href="https://codeburst.io/the-evil-powers-of-mutants-f803281ef82e" rel="noopener follow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd io gy z fp nx fr fs ny fu fw im bi translated">变种人的邪恶力量</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">变异就是进化。它是由查尔斯·达尔文爵士提出的，我们在软件行业中使用它。但是有些事情是…</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">codeburst.io</p></div></div><div class="ob l"><div class="oh l od oe of ob og kn ns"/></div></div></a></div><h1 id="3348" class="kp kq in bd kr ks kt ku kv kw kx ky kz jt la ju lb jw lc jx ld jz le ka lf lg bi translated">标签</h1><ul class=""><li id="ccb9" class="lh li in lj b lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">全局</li></ul></div><div class="ab cl oi oj hr ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="ig ih ii ij ik"><blockquote class="op oq or"><p id="e834" class="mt mu os lj b lk nk jo mv lm nl jr mw ot nm my mz ou nn nb nc ov no ne nf lu ig bi translated">在编程中，困难的部分不是解决问题，而是决定解决什么问题。</p></blockquote><p id="ef7f" class="pw-post-body-paragraph mt mu in lj b lk nk jo mv lm nl jr mw lo nm my mz lq nn nb nc ls no ne nf lu ig bi translated"><em class="os">保罗·格拉厄姆</em></p><div class="np nq gp gr nr ns"><a href="https://medium.com/dev-genius/software-engineering-great-quotes-3af63cea6782" rel="noopener follow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd io gy z fp nx fr fs ny fu fw im bi translated">软件工程名言</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">有时一个简短的想法可以带来惊人的想法。</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">medium.com</p></div></div><div class="ob l"><div class="ow l od oe of ob og kn ns"/></div></div></a></div></div><div class="ab cl oi oj hr ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="ig ih ii ij ik"><p id="0418" class="pw-post-body-paragraph mt mu in lj b lk nk jo mv lm nl jr mw lo nm my mz lq nn nb nc ls no ne nf lu ig bi translated">本文是CodeSmell系列的一部分。</p><div class="np nq gp gr nr ns"><a href="https://medium.com/dev-genius/how-to-find-the-stinky-parts-of-your-code-fa8df47fc39c" rel="noopener follow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd io gy z fp nx fr fs ny fu fw im bi translated">如何找到你的代码中有问题的部分</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">代码很难闻。让我们看看如何改变香味。</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">medium.com</p></div></div><div class="ob l"><div class="ox l od oe of ob og kn ns"/></div></div></a></div></div></div>    
</body>
</html>