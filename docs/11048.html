<html>
<head>
<title>Be the master of your solar data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">成为你的太阳数据的主人</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/be-the-master-of-your-solar-data-e25f4afc29fb?source=collection_archive---------23-----------------------#2022-12-14">https://blog.devgenius.io/be-the-master-of-your-solar-data-e25f4afc29fb?source=collection_archive---------23-----------------------#2022-12-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c484" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何通过 RS232 接口从 Kaco Powador 1501 xi 变频器读取数据？</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5343c40fef2daf4b937f3c8b64734526.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ao_pAeQo00PXOpCC"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">美国公共电力协会在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="a283" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于系统设计，太阳能电池产生直流电(DC)。逆变器用于将 DC 转换成交流电。<a class="ae kv" href="https://kaco-newenergy.com/home/" rel="noopener ugc nofollow" target="_blank"> Kaco </a> Powador 1501 xi 是一款带串行接口的逆变器，用于数据检索。可以使用 Raspberry Pi 从逆变器读取参数数据。</p><p id="f326" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本帖中，我们将展示如何从 Kaco 1501 xi 变频器读取参数值。我们将讨论使用的硬件以及开发的软件。这些步骤如下:</p><ol class=""><li id="c8c1" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated"><strong class="ky ir">硬件设置</strong></li><li id="9762" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ir">通过 RS232 接口读取数据</strong></li><li id="988f" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ir">展望</strong></li><li id="61f0" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ir">有用链接</strong></li></ol><h1 id="f204" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">🖥硬件设置</h1><p id="0fc6" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">我们使用了以下组件:</p><ul class=""><li id="ff9c" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr nd ly lz ma bi translated"><a class="ae kv" href="https://www.raspberrypi.com/products/raspberry-pi-3-model-b/" rel="noopener ugc nofollow" target="_blank">树莓派 3 </a></li><li id="1fa4" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nd ly lz ma bi translated">microSD 卡(建议至少 32GB)</li><li id="6d7a" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nd ly lz ma bi translated"><a class="ae kv" href="https://www.waveshare.com/wiki/2-CH_RS232_HAT" rel="noopener ugc nofollow" target="_blank"> Waveshare 2-CH RS232 树莓派帽子</a></li><li id="6227" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nd ly lz ma bi translated">RS232 电缆</li></ul><h2 id="cff6" class="ne mh iq bd mi nf ng dn mm nh ni dp mq lf nj nk ms lj nl nm mu ln nn no mw np bi translated">1.硬件组件</h2><p id="ae38" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">第一步是将电路板连接到 Raspberry Pi 的 GPIO 引脚。图片说明了结果。您可以看到两个串行端口。两个 Kaco 逆变器可以通过这些接口连接。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/8e791bbdf0910be9908abe2e9c2b0b81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d61_frJmu9zQwWbX8Zs5Gg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">树莓 Pi 3，带 Waveshare-CH RS232 帽子</figcaption></figure><h2 id="93d3" class="ne mh iq bd mi nf ng dn mm nh ni dp mq lf nj nk ms lj nl nm mu ln nn no mw np bi translated">2.闪存卡</h2><p id="6313" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">关于在树莓 Pi 上安装操作系统，可以阅读我们的文章“<a class="ae kv" href="https://tinztwins.medium.com/how-to-install-an-operating-system-on-the-raspberry-pi-c92cf1fb8efa" rel="noopener">如何在树莓 Pi 上安装操作系统？</a>”。</p><div class="nr ns gp gr nt nu"><a href="https://tinztwins.medium.com/how-to-install-an-operating-system-on-the-raspberry-pi-c92cf1fb8efa" rel="noopener follow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">如何在树莓派上安装操作系统？</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">将操作系统闪存到 microSD</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">tinztwins.medium.com</p></div></div><div class="od l"><div class="oe l of og oh od oi kp nu"/></div></div></a></div><h2 id="5945" class="ne mh iq bd mi nf ng dn mm nh ni dp mq lf nj nk ms lj nl nm mu ln nn no mw np bi translated">3.通过 ssh 连接到您的树莓 Pi</h2><p id="8bac" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">使用以下命令通过您的笔记本电脑连接到 Raspberry Pi:</p><pre class="kg kh ki kj gt oj ok ol bn om on bi"><span id="f502" class="oo mh iq ok b be op oq l or os"># &lt;ip-address&gt;: ip adddress of your raspberry pi<br/>ssh pi@&lt;ip-address&gt;</span></pre><p id="b499" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用您的登录数据登录。用<strong class="ky ir">确认下面的问题 T21【是】 </strong>。</p><pre class="kg kh ki kj gt oj ok ol bn om on bi"><span id="f14c" class="oo mh iq ok b be op oq l or os">Are you sure you want to continue connecting (yes/no/[fingerprint])?</span></pre><h2 id="d3c8" class="ne mh iq bd mi nf ng dn mm nh ni dp mq lf nj nk ms lj nl nm mu ln nn no mw np bi translated">4.安装硬件驱动程序和<strong class="ak">库</strong></h2><p id="8f63" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">这些解释基于 Waveshare 的<a class="ae kv" href="https://www.waveshare.com/wiki/2-CH_RS232_HAT" rel="noopener ugc nofollow" target="_blank"> wiki。</a></p><p id="0f34" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">修改 config.txt 文件:</p><pre class="kg kh ki kj gt oj ok ol bn om on bi"><span id="4f47" class="oo mh iq ok b be op oq l or os">sudo nano /boot/config.txt</span></pre><p id="8d93" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将下面一行添加到文件中。</p><pre class="kg kh ki kj gt oj ok ol bn om on bi"><span id="f215" class="oo mh iq ok b be op oq l ou os">dtoverlay=sc16is752-spi1,int_pin=24</span></pre><p id="c760" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后使用以下命令重新启动 Raspberry Pi:</p><pre class="kg kh ki kj gt oj ok ol bn om on bi"><span id="2cb0" class="oo mh iq ok b be op oq l or os">sudo reboot</span></pre><p id="b782" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">重启后，SC16IS752 的驱动程序将被加载到系统内核中。运行以下命令:</p><pre class="kg kh ki kj gt oj ok ol bn om on bi"><span id="0dec" class="oo mh iq ok b be op oq l or os">ls /dev </span></pre><p id="3772" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在您应该在列表中看到以下设备:gpiochip3、ttySC0 和 ttySC1</p><p id="15c6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用以下命令安装 wiringpi:</p><pre class="kg kh ki kj gt oj ok ol bn om on bi"><span id="6766" class="oo mh iq ok b be op oq l or os">sudo apt-get install wiringpi</span></pre><p id="ecd3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用以下命令安装 python 3-串行库:</p><pre class="kg kh ki kj gt oj ok ol bn om on bi"><span id="b649" class="oo mh iq ok b be op oq l or os">sudo apt-get update<br/>sudo apt-get install python3-pip<br/>sudo pip3 install RPi.GPIO<br/>sudo apt-get install python3-serial</span></pre><h1 id="91cb" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">💿通过 RS232 接口读取数据</h1><p id="6b27" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">RS232 串行接口提供以下数据:</p><ul class=""><li id="e049" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr nd ly lz ma bi translated">日期</li><li id="701a" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nd ly lz ma bi translated">时间</li><li id="83fe" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nd ly lz ma bi translated">工况</li><li id="aad9" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nd ly lz ma bi translated">发电机电压(V)</li><li id="f887" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nd ly lz ma bi translated">发电机电流，单位为安(DC)</li><li id="45b1" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nd ly lz ma bi translated">发电机功率(W)</li><li id="7fe8" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nd ly lz ma bi translated">V(交流)电源电压</li><li id="7018" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nd ly lz ma bi translated">交流电中的注入电流</li><li id="a3f8" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nd ly lz ma bi translated">注入功率(W)</li><li id="6180" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nd ly lz ma bi translated">单位温度℃</li></ul><p id="8268" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面你可以看到读取参数值的 Python 代码。</p><pre class="kg kh ki kj gt oj ok ol bn om on bi"><span id="948d" class="oo mh iq ok b be op oq l or os"># Filname example.py<br/>import serial<br/><br/>if __name__ == '__main__':<br/>    try:<br/>        ser = serial.Serial(port='/dev/ttySC0', baudrate=9600)   # Open serial interface<br/>        ser.open<br/><br/>        line = ser.readline()   # read data<br/>        line_str = line.decode("utf-8")<br/><br/>        parameter_list = line_str.split(" ")<br/>        parameter_list_cleaned = list(filter(None, parameter_list))<br/><br/>        del parameter_list_cleaned[-1]<br/>        print(parameter_list_cleaned)<br/><br/>    except Exception as e:<br/>        print("Failed to read from RS232! -&gt; {0}".format(e))<br/>    finally:       <br/>        ser.close()   </span></pre><p id="c799" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，打开串口。在我们的例子中，我们以 9600 的波特率打开串行端口'/dev/ttySC0 '。Waveshare 2-CH RS232 HAT 板的第二个串行端口带有“/dev/ttySC1”标志，可用于另一个逆变器。然后我们用函数<em class="ot"> readline() </em>读取数据，解码数据。最后，我们转换数据，这样我们就可以在一个列表中拥有各个参数值。</p><p id="314f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，您必须将带有<em class="ot"> scp </em>的 example.py 文件复制到您的 Raspberry Pi 中。为此，在笔记本电脑的终端中执行以下命令。</p><pre class="kg kh ki kj gt oj ok ol bn om on bi"><span id="ff68" class="oo mh iq ok b be op oq l or os"># &lt;ip-address&gt;: ip adddress of your raspberry pi<br/># &lt;username&gt;: username of your raspberry pi<br/>scp -r example.py pi@&lt;ip-address&gt;:/home/&lt;username&gt;</span></pre><p id="146b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以使用以下命令在您的 Pi 上启动 Python 代码:</p><pre class="kg kh ki kj gt oj ok ol bn om on bi"><span id="367d" class="oo mh iq ok b be op oq l or os">python example.py</span></pre><p id="ee45" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，您将获得当前参数值的输出。</p><h1 id="678c" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">🔮观点</h1><p id="dbbe" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">给出的代码是一个更大项目的基础。目标是将数据持久存储在流入数据库中。随后，太阳能数据可用于评估和基于人工智能的分析。</p></div><div class="ab cl ov ow hu ox" role="separator"><span class="oy bw bk oz pa pb"/><span class="oy bw bk oz pa pb"/><span class="oy bw bk oz pa"/></div><div class="ij ik il im in"><p id="8dd5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你喜欢这篇文章吗？成为<a class="ae kv" href="https://tinztwins.medium.com/membership" rel="noopener">中级会员</a>继续无限学习。当您使用该链接时，我们将收取一小部分会员费。您无需支付额外费用。</p><p id="2972" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">不要错过我们接下来的故事:</strong></p><div class="nr ns gp gr nt nu"><a href="https://tinztwins.medium.com/subscribe" rel="noopener follow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">每当 Tinz Twins 发布时收到一封电子邮件。</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">每当 Tinz Twins 发布时收到一封电子邮件。注册后，如果您还没有，您将创建一个中型帐户…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">tinztwins.medium.com</p></div></div><div class="od l"><div class="pc l of og oh od oi kp nu"/></div></div></a></div><p id="cf8f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">非常感谢你的阅读。如果你喜欢这篇文章，请随意分享。关注我们了解更多内容。祝你有美好的一天！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pd"><img src="../Images/1924008e75e30f4baed4775b04724600.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mlzonw5462Puvm28fvAnfg.png"/></div></div></figure><h1 id="f851" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">🔍有用的链接</h1><ul class=""><li id="6be7" class="ls lt iq ky b kz my lc mz lf pe lj pf ln pg lr nd ly lz ma bi translated"><a class="ae kv" href="https://www.waveshare.com/wiki/2-CH_RS232_HAT" rel="noopener ugc nofollow" target="_blank"> Wiki Waveshare 2-CH RS232 帽子</a></li><li id="6331" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nd ly lz ma bi translated"><a class="ae kv" href="https://www.solar-auctions.com/Auction/Document/94537003-5aa9-4d36-9971-43436c2ce7d5/kaco_powador_1501xi-5001xi_datasheet.pdf" rel="noopener ugc nofollow" target="_blank">曼努埃尔·卡科 1501 xi 变频器</a></li></ul></div></div>    
</body>
</html>