<html>
<head>
<title>How to build a frontend, when the backend is not ready</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">当后端未准备好时，如何构建前端</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-build-a-frontend-when-the-backend-is-not-ready-f1fc6b541101?source=collection_archive---------6-----------------------#2022-02-07">https://blog.devgenius.io/how-to-build-a-frontend-when-the-backend-is-not-ready-f1fc6b541101?source=collection_archive---------6-----------------------#2022-02-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="483a" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">Javascript 架构</h2><div class=""/><div class=""><h2 id="0c59" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">当前端和后端团队需要并行工作时</h2></div><p id="02f9" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi lk translated">构建一个前端并不是一件容易的事情，你需要理解许多关键概念，例如，HTML，CSS，至少一个 JS 框架，ts，浏览器限制，等等。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi ma"><img src="../Images/6e5d727ad0054b7a5fca17afceddab9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rdok7g00vI15aXls"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk translated">保罗·尼科勒洛在<a class="ae mq" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><p id="56ae" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">然而，如果你花时间在这些概念上，你就能学会它们。</p><p id="e3f4" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">但是，最困难的任务是在你的 API 还没有准备好的时候构建你的页面或者移动应用。</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="741a" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">但是，我们不能因此而停止，对吗？我们需要继续我们的项目。我知道，也许现在你在想，你到底在说什么？</p><p id="f557" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">放松点，兄弟…</p><p id="ce9a" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">以正确的方式使用正确的工具是可能的。</p><p id="0efb" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在开始列举我们的选择之前，我们需要知道一个关键概念。</p><h2 id="3caf" class="mt mu iq bd mv mw mx dn my mz na dp nb kx nc nd ne lb nf ng nh lf ni nj nk iw bi translated"><strong class="ak">合同优先开发</strong>。</h2><p id="9d6d" class="pw-post-body-paragraph ko kp iq kq b kr nl ka kt ku nm kd kw kx nn kz la lb no ld le lf np lh li lj ij bi translated">有一个工作流叫做<strong class="kq ja">契约优先开发</strong>。</p><p id="3e65" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">契约优先开发是一种习惯，在开始编码之前有契约的定义，这将帮助我们发现我们是否遗漏了一些重要的部分。</p><p id="cdaa" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">这种实践将帮助我们创建自动化测试并验证我们的 API，模拟正在开发的服务，并在开始之前拥有良好的文档。</p><p id="64aa" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">因此，两个团队可以并行工作，而不是通过后端开发来阻止前端开发。</p><p id="45e6" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">这个概念不仅仅适用于 API，例如，如果你正在开发桌面应用程序，你可以使用这个概念来模仿你的 SDK、库、DLL 或者你正在使用的任何东西。</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="nq ms l"/></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk translated">合同优先开发</figcaption></figure><h2 id="24c4" class="mt mu iq bd mv mw mx dn my mz na dp nb kx nc nd ne lb nf ng nh lf ni nj nk iw bi translated">一个应用编程接口</h2><p id="2904" class="pw-post-body-paragraph ko kp iq kq b kr nl ka kt ku nm kd kw kx nn kz la lb no ld le lf np lh li lj ij bi translated">正如我所说的，有许多选项可以用来模仿我们的 API。在这个例子中，我将使用一个基本的 React 应用程序来说明我们所有的例子。</p><h2 id="279c" class="mt mu iq bd mv mw mx dn my mz na dp nb kx nc nd ne lb nf ng nh lf ni nj nk iw bi translated">JSON 文件</h2><p id="8261" class="pw-post-body-paragraph ko kp iq kq b kr nl ka kt ku nm kd kw kx nn kz la lb no ld le lf np lh li lj ij bi translated">第一个也是最容易使用的是项目中的一个 JSON 文件，当我们需要数据时就包含它。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/b8cb143c46a2e02cb85433887fbc4364.png" data-original-src="https://miro.medium.com/v2/resize:fit:622/format:webp/1*HgywM2XqddohLAMrB6tx6g.png"/></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk translated">用 JSON 文件模拟数据</figcaption></figure><p id="c3e1" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">正如你所看到的，我在我的项目中做的唯一一件事是用我的服务定义存储一个文件，这将帮助我们模仿我们的 API。</p><p id="75a2" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我们的 JSON 文件包含以下内容</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="nw ms l"/></div></figure><p id="eab0" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我建议添加一个服务层，以便只更改该服务中的源代码，考虑到在不久的将来，您将需要在一个真实的服务中更改 JSON 文件，如果您在代码的许多部分都使用这种方法，那么更改所有调用将会很痛苦。</p><p id="6794" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">最后，您只需要 JSON 文件，如第 2 行中的代码所示。</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="nw ms l"/></div></figure><p id="4c2f" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">前面代码的结果将是我们的前端没有一个真正的后端。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi nx"><img src="../Images/4cb1160f3f9760f00db1b4ec76eda66b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GO0T1MaYlWCi3wIHdRfoAA.png"/></div></div></figure><h2 id="26fd" class="mt mu iq bd mv mw mx dn my mz na dp nb kx nc nd ne lb nf ng nh lf ni nj nk iw bi translated">邮递员</h2><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi ny"><img src="../Images/f75a3ae22bd6b7b6dae61dbe5672dd69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2N6CKnQQy2ZpsNBxYTqpRA.png"/></div></div></figure><p id="f935" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">许多开发人员使用 postman 来测试他们的后端，一些高级开发人员使用这个工具来记录他们的 API 并与他们的同事分享。但是这个工具是瑞士的 Armi 刀。</p><p id="fa5c" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">有了 Postman，你可以测试、记录、自动化、监控或模拟一个 API，以及许多其他与 API 相关的最酷的事情。</p><p id="a2bf" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">这是一种先进的方法，可能是最接近实际服务的方法。</p><p id="e79b" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">要创建 API 模拟，打开您的 postman 应用程序，点击模拟服务器，然后创建一个模拟服务器。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi nz"><img src="../Images/9d770214aa4061591f10446aa9771e39.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*7c8yPmXKQv-DVrJ5WavPRA.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk translated">创建一个模拟服务器</figcaption></figure><p id="8dd2" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">之后，Postman 会提示我们一个新的表单，你需要定义你的 API，比如请求方法，请求 URL，响应代码等等。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi oa"><img src="../Images/06f133c948259a5443de049e61764816.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6f458aNMJ5EVEcdsPUf67A.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk translated">API 定义</figcaption></figure><p id="ce66" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在前面的图片中，我定义了<code class="fe nr ns nt nu b">get-todos</code>方法，作为响应体，我粘贴了我们在第一种方法中使用的 JSON 文件。</p><p id="1b6d" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">如果需要，您可以将其他设置更改为方法或响应代码。当你完成所有设置后，点击<strong class="kq ja">下一个</strong>按钮。</p><p id="d0b3" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">要完成您的模拟服务器，您需要给模拟服务器一个名称</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi ob"><img src="../Images/88df9b30a5b0786e6d4b3c242f891e8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pyJB_zUsuqXVrQs7Uto7Uw.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk translated">模拟服务器配置</figcaption></figure><p id="b738" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">之后，Postman 会给我们一个新的 URL，它将是我们将在代码中使用的 API。</p><p id="278f" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在我们的代码中，我们只需要创建一个对此服务的调用，我创建了一个文件来存储所有与 todos 服务相关的调用。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/7067d93fd67989bd480f15e8dfe7068e.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/1*-F0TS_JglR0xXi90sbXPFg.png"/></div></figure><p id="8183" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">目前，我们的文件只包含这段代码。</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="nw ms l"/></div></figure><p id="7d9f" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">最后，我们将这个 API 作为服务来使用。</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="nw ms l"/></div></figure><p id="2fd6" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">同样，这只是一个基本的例子，我建议使用端点作为环境变量，并添加一个服务层来访问所有的 API。</p><h2 id="9426" class="mt mu iq bd mv mw mx dn my mz na dp nb kx nc nd ne lb nf ng nh lf ni nj nk iw bi translated">海市蜃楼</h2><p id="2632" class="pw-post-body-paragraph ko kp iq kq b kr nl ka kt ku nm kd kw kx nn kz la lb no ld le lf np lh li lj ij bi translated">Mirage 是一个流行的 API 模仿库，它将帮助我们在没有真正后端服务的情况下完成我们的工作。</p><p id="29cb" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我把这个留在最后，因为在我看来这是最完整的方法，因为你可以用你的最终资源在你的代码中模拟你的 API。换句话说，Mirage 将捕获您的所有请求，然后它将返回一个模拟响应，无论您是使用 fetch、Axios 还是任何其他 JS 库来调用服务。</p><p id="9229" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">要安装该库，只需运行以下命令:</p><pre class="mb mc md me gt od nu oe of aw og bi"><span id="f86c" class="mt mu iq nu b gy oh oi l oj ok">npm install --save-dev miragejs</span></pre><p id="761f" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">让我们假设我们在谷歌工作😉最终的网址是<a class="ae mq" href="https://api.google.com/get-todos" rel="noopener ugc nofollow" target="_blank">https://api.google.com/get-todos</a>，但我们的工程师仍在开发 API。</p><p id="bc2d" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">如果我们运行我们的项目，我们将得到一个与网络相关的错误。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/ac29c0dd872c799d93eae376d678d021.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*fdMpcU14phhEeBqW2r5sxw.png"/></div></figure><p id="18c6" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">使用 mirage 时这不是问题，让我们创建一个名为 server.js 的文件</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div class="gh gi om"><img src="../Images/b92201a3f87eb44e5defa9e3d49f5e58.png" data-original-src="https://miro.medium.com/v2/resize:fit:596/format:webp/1*sZByB6IhkqmVZHiNTGoi7w.png"/></div></figure><p id="47fd" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">该文件将包含我们的 API 定义</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="nw ms l"/></div></figure><p id="1ef8" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在 routes 方法中，我们将为我们的 API 定义所有资源，正如你所注意到的，我们可以添加完整的 URL，但是我建议只使用资源，这只是作为一个例子。</p><p id="21e5" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">另一个有趣的部分是路由的响应是一个箭头函数，这意味着我们可以在 mock 中添加更多的逻辑，但是在本例中，我们使用的是第一种方法中使用的 JSON 文件。</p><p id="2c4c" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">不要忘记改变你的 service/todo.js，记住现在我们是在为谷歌工作。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi on"><img src="../Images/aa409d5613c1d7d9d28f5a78a2fd3971.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tJ8rB8BSOQGqZyASmtMKGg.png"/></div></div></figure><p id="d2cd" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">之后，在我们的 App.js 中，我们需要做两件事，第一件是导入我们的 server.js，然后在 useEffect 中运行它</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi oo"><img src="../Images/62a70e1cc4971218ce4285f18ee41207.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vosi28F1hhGfBEZoVPqLuQ.png"/></div></div></figure><p id="1059" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在，如果您运行您的示例，您将在 web developer tools 中看到一个日志，它是记录哪个服务正在模仿的 mirage。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi op"><img src="../Images/ae4db36a605ad248c6935653022c675b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X_eWHFPMUAX8OYjlCHFPTQ.png"/></div></div></figure><h2 id="d2c1" class="mt mu iq bd mv mw mx dn my mz na dp nb kx nc nd ne lb nf ng nh lf ni nj nk iw bi translated">结论</h2><p id="a28c" class="pw-post-body-paragraph ko kp iq kq b kr nl ka kt ku nm kd kw kx nn kz la lb no ld le lf np lh li lj ij bi translated">我们可以使用许多其他工具来模拟我们的 API，根据您的需求使用其中的一种。重要的是，我们仍然可以在没有后端的情况下工作，有时会很困难，但这不再是借口。</p></div></div>    
</body>
</html>