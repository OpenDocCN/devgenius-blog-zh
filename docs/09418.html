<html>
<head>
<title>Develop NodeJs REST APIs using Express and MongoDB</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Express 和 MongoDB 开发 NodeJs REST APIs</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/develop-nodejs-rest-apis-using-express-and-mongodb-840ff885be39?source=collection_archive---------13-----------------------#2022-08-19">https://blog.devgenius.io/develop-nodejs-rest-apis-using-express-and-mongodb-840ff885be39?source=collection_archive---------13-----------------------#2022-08-19</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/26783ea9754c92501c8e440c3dd772b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A-Wxo2PwHwanFJMwH75tJA.png"/></div></div></figure><p id="9156" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">应用程序编程接口(API)定义了一组规则，用于与服务器交互以进行数据检索。API 提供了一种与不同程序通信的方式，并允许一个计算机程序的功能被另一个程序使用。</p><p id="ecc7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">REST(表述性状态转移)是一种 web 标准架构和 HTTP 协议。在 REST 架构中，客户机和服务器可以请求同时读取、写入和更新数据，而不需要了解客户机和服务器的任何操作。REST API 遵循 REST 架构的设计原则。</p><p id="bd3d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在本文中，我们将使用 Node.js 和 mongoDB 创建一个 REST API。</p><h1 id="95c7" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">入门指南</h1><p id="583e" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">这篇文章是以这样一种方式设计的，我们将创建一个 RESTful todo list API，它将创建、读取、更新和删除任务。</p><h2 id="f3e0" class="lw ku in bd kv lx ly dn kz lz ma dp ld kg mb mc lh kk md me ll ko mf mg lp mh bi translated">要求</h2><ul class=""><li id="bd4d" class="mi mj in jx b jy lr kc ls kg mk kk ml ko mm ks mn mo mp mq bi translated">Node.js [ <a class="ae mr" href="https://nodejs.org/en/download/" rel="noopener ugc nofollow" target="_blank">下载</a></li><li id="94c2" class="mi mj in jx b jy ms kc mt kg mu kk mv ko mw ks mn mo mp mq bi translated">MongoDB [ <a class="ae mr" href="https://fastdl.mongodb.org/windows/mongodb-windows-x86_64-5.0.1-signed.msi" rel="noopener ugc nofollow" target="_blank">下载</a> ]</li><li id="2c9b" class="mi mj in jx b jy ms kc mt kg mu kk mv ko mw ks mn mo mp mq bi translated">邮递员[ <a class="ae mr" href="https://www.postman.com/downloads/" rel="noopener ugc nofollow" target="_blank">下载</a></li><li id="a237" class="mi mj in jx b jy ms kc mt kg mu kk mv ko mw ks mn mo mp mq bi translated">Visual Studio 代码或任何文本编辑器[ <a class="ae mr" href="https://code.visualstudio.com/download" rel="noopener ugc nofollow" target="_blank">下载</a></li></ul><p id="f7ed" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果您尚未安装列出的软件，请从官方网站下载并安装在您的机器上。确保您已经在环境变量中添加了<code class="fe mx my mz na b">mongodb</code>和<code class="fe mx my mz na b">node.js</code>路径。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nb"><img src="../Images/bcd69f2d109f0a0e3fcddea16a0492d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Uu1Dg5rDdqFTMqSg.png"/></div></div></figure><p id="5672" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">使用以下命令检查 node.js 和 mongodb 版本。</p><pre class="nc nd ne nf gt ng na nh ni aw nj bi"><span id="b026" class="lw ku in na b gy nk nl l nm nn">npm -v<br/>mongo --version</span></pre><h2 id="06df" class="lw ku in bd kv lx ly dn kz lz ma dp ld kg mb mc lh kk md me ll ko mf mg lp mh bi translated">设置项目结构</h2><ul class=""><li id="e132" class="mi mj in jx b jy lr kc ls kg mk kk ml ko mm ks mn mo mp mq bi translated">打开命令提示符，创建一个名为<code class="fe mx my mz na b">todoListApi</code>的文件夹</li></ul><pre class="nc nd ne nf gt ng na nh ni aw nj bi"><span id="a04c" class="lw ku in na b gy nk nl l nm nn">mkdir todoListApi</span></pre><ul class=""><li id="029f" class="mi mj in jx b jy jz kc kd kg no kk np ko nq ks mn mo mp mq bi translated">移动到该文件夹，使用以下命令初始化 node.js 项目，</li></ul><pre class="nc nd ne nf gt ng na nh ni aw nj bi"><span id="4056" class="lw ku in na b gy nk nl l nm nn">cd todoListApi<br/>npm init</span></pre><p id="0e50" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe mx my mz na b">npm init</code>将提示您输入一些基本信息，如应用名称、描述、版本、作者和关键字。输入这些信息，然后按 Enter 键完成该过程。项目创建后，你会在目录中得到一个<code class="fe mx my mz na b">package.json</code>文件。<code class="fe mx my mz na b">package.json</code>给出基本项目信息以及项目依赖关系。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nr"><img src="../Images/f1fa74a43e89b8e8297c25dc8d9f931d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hv9yfgACaftXK7hN.png"/></div></div></figure><ul class=""><li id="e824" class="mi mj in jx b jy jz kc kd kg no kk np ko nq ks mn mo mp mq bi translated">在目录中打开 VSCode。</li><li id="d472" class="mi mj in jx b jy ms kc mt kg mu kk mv ko mw ks mn mo mp mq bi translated">创建一个名为<code class="fe mx my mz na b">index.js</code>的新文件</li><li id="2c86" class="mi mj in jx b jy ms kc mt kg mu kk mv ko mw ks mn mo mp mq bi translated">创建一个名为<code class="fe mx my mz na b">api</code>的新文件夹。在其中，创建三个文件夹— <code class="fe mx my mz na b">models</code>、<code class="fe mx my mz na b">routes</code>和<code class="fe mx my mz na b">controllers</code>。</li><li id="2941" class="mi mj in jx b jy ms kc mt kg mu kk mv ko mw ks mn mo mp mq bi translated">在<code class="fe mx my mz na b">api/controller</code>文件夹中创建<code class="fe mx my mz na b">todoListController.js</code>，在<code class="fe mx my mz na b">routes</code>文件夹中创建<code class="fe mx my mz na b">todoListRoutes.js</code>，在<code class="fe mx my mz na b">models</code>文件夹中创建<code class="fe mx my mz na b">todoListModel</code>。</li></ul><p id="2882" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">最终的文件夹结构应该如下所示:</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ns"><img src="../Images/c98e42a3fb614a2f904651d4fb3d86d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*L30Lxnb09BJNBf_K.png"/></div></div></figure><h2 id="62cb" class="lw ku in bd kv lx ly dn kz lz ma dp ld kg mb mc lh kk md me ll ko mf mg lp mh bi translated">设置服务器</h2><ul class=""><li id="f15d" class="mi mj in jx b jy lr kc ls kg mk kk ml ko mm ks mn mo mp mq bi translated">打开命令提示符，输入以下命令，在机器上安装<code class="fe mx my mz na b">express</code>和<code class="fe mx my mz na b">body-parser</code>包。</li></ul><pre class="nc nd ne nf gt ng na nh ni aw nj bi"><span id="1d7a" class="lw ku in na b gy nk nl l nm nn">npm install express body-parser</span></pre><ul class=""><li id="8d20" class="mi mj in jx b jy jz kc kd kg no kk np ko nq ks mn mo mp mq bi translated">打开<code class="fe mx my mz na b">package.json</code>文件，在<code class="fe mx my mz na b">scripts</code>下添加<code class="fe mx my mz na b">start</code>命令。</li></ul><pre class="nc nd ne nf gt ng na nh ni aw nj bi"><span id="e848" class="lw ku in na b gy nk nl l nm nn">"start": "node index.js"</span></pre><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/4e77977e571010c7327aa109625b47d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/0*ZjoOEJDs6Rt3acCX.png"/></div></figure><ul class=""><li id="2ab8" class="mi mj in jx b jy jz kc kd kg no kk np ko nq ks mn mo mp mq bi translated">打开<code class="fe mx my mz na b">index.js</code>文件，添加以下代码。</li></ul><figure class="nc nd ne nf gt jo"><div class="bz fp l di"><div class="nu nv l"/></div></figure><ul class=""><li id="0150" class="mi mj in jx b jy jz kc kd kg no kk np ko nq ks mn mo mp mq bi translated">通过运行以下命令启动服务器。</li></ul><pre class="nc nd ne nf gt ng na nh ni aw nj bi"><span id="8d8e" class="lw ku in na b gy nk nl l nm nn">npm start</span></pre><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/104ce37ae61f74670c4786c461512d70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/0*UZHkxUEHM99FQo4W.png"/></div></figure><h2 id="cf1f" class="lw ku in bd kv lx ly dn kz lz ma dp ld kg mb mc lh kk md me ll ko mf mg lp mh bi translated">设置模式</h2><ul class=""><li id="1234" class="mi mj in jx b jy lr kc ls kg mk kk ml ko mm ks mn mo mp mq bi translated">Mongoose 可用于与 MongoDB 实例进行交互。使用以下命令安装<code class="fe mx my mz na b">mongoose</code>。</li></ul><pre class="nc nd ne nf gt ng na nh ni aw nj bi"><span id="174a" class="lw ku in na b gy nk nl l nm nn">npm install mongoose</span></pre><ul class=""><li id="fe3d" class="mi mj in jx b jy jz kc kd kg no kk np ko nq ks mn mo mp mq bi translated">从<code class="fe mx my mz na b"> api/models</code>文件夹中打开<code class="fe mx my mz na b">todoListModel.js</code>文件，添加以下代码。</li></ul><figure class="nc nd ne nf gt jo"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="2939" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们已经为任务集合创建了一个模型。任务模型包含名称、创建日期和状态。默认情况下，状态被定义为待定。</p><h2 id="82c4" class="lw ku in bd kv lx ly dn kz lz ma dp ld kg mb mc lh kk md me ll ko mf mg lp mh bi translated">设置路线</h2><p id="5847" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">路由有助于理解应用程序端点处理客户端请求的方式。每个路由都有处理函数，当路由匹配时将执行这些函数。<br/>我们可以定义两条基本路线— <code class="fe mx my mz na b">/tasks</code>和<code class="fe mx my mz na b">/tasks/taskId</code>。下一步，我们将在控制器中定义处理函数。</p><ul class=""><li id="77fb" class="mi mj in jx b jy jz kc kd kg no kk np ko nq ks mn mo mp mq bi translated">从<code class="fe mx my mz na b">api/routes</code>文件夹中打开<code class="fe mx my mz na b">todoListRoutes.js</code>文件，添加以下代码。</li></ul><figure class="nc nd ne nf gt jo"><div class="bz fp l di"><div class="nu nv l"/></div></figure><h2 id="6619" class="lw ku in bd kv lx ly dn kz lz ma dp ld kg mb mc lh kk md me ll ko mf mg lp mh bi translated">设置控制器</h2><p id="4b82" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">控制器是与路由器绑定的回调函数，用于处理请求。</p><p id="a4d6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">定义控制器来创建、更新、删除和列出任务。创建名为<strong class="jx io"> listAllTasks、createTask、readTask、updateTask、</strong>和<strong class="jx io"> deleteTask </strong>的控制器。控制器使用<code class="fe mx my mz na b">mongoose</code>方法，如<strong class="jx io">查找</strong>(用于选择)<strong class="jx io">、findById </strong>(用于单选)<strong class="jx io">、findOneAndUpdate </strong>(用于更新)<strong class="jx io">、save </strong>和<strong class="jx io"> remove </strong>对数据库进行更改。</p><p id="aeec" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">从<code class="fe mx my mz na b">api/controllers</code>文件夹中打开<code class="fe mx my mz na b">todoListController.js</code>文件，添加以下代码。</p><figure class="nc nd ne nf gt jo"><div class="bz fp l di"><div class="nu nv l"/></div></figure><h2 id="14db" class="lw ku in bd kv lx ly dn kz lz ma dp ld kg mb mc lh kk md me ll ko mf mg lp mh bi translated">完成服务器设置</h2><p id="bcfc" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">让我们连接到数据库并完成服务器配置。</p><ul class=""><li id="8404" class="mi mj in jx b jy jz kc kd kg no kk np ko nq ks mn mo mp mq bi translated">使用 mongoose 实例连接来连接数据库。</li><li id="99f5" class="mi mj in jx b jy ms kc mt kg mu kk mv ko mw ks mn mo mp mq bi translated">使用<code class="fe mx my mz na b">require()</code>方法加载模型。</li><li id="0a2f" class="mi mj in jx b jy ms kc mt kg mu kk mv ko mw ks mn mo mp mq bi translated">在 express 应用程序中注册路线。</li><li id="7335" class="mi mj in jx b jy ms kc mt kg mu kk mv ko mw ks mn mo mp mq bi translated">将以下代码添加到<code class="fe mx my mz na b">index.js</code>文件中(替换旧内容)。</li></ul><figure class="nc nd ne nf gt jo"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="c9b7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">使用以下命令启动服务器。</p><pre class="nc nd ne nf gt ng na nh ni aw nj bi"><span id="da56" class="lw ku in na b gy nk nl l nm nn">npm start</span></pre><p id="4b49" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">你有它！nodejs 中您自己的待办事项列表 api:)</p><h2 id="3c14" class="lw ku in bd kv lx ly dn kz lz ma dp ld kg mb mc lh kk md me ll ko mf mg lp mh bi translated">测试你的应用</h2><p id="f388" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">让我们使用 postman 测试 API。</p><ul class=""><li id="87b4" class="mi mj in jx b jy jz kc kd kg no kk np ko nq ks mn mo mp mq bi translated">打开 postman，在输入请求 URL 部分输入<code class="fe mx my mz na b">http://localhost:3000/tasks</code>,然后按回车键。你可以在 postman 里看到一个空的回复。</li><li id="5b7e" class="mi mj in jx b jy ms kc mt kg mu kk mv ko mw ks mn mo mp mq bi translated">将方法更改为 POST，并将请求正文类型更改为<code class="fe mx my mz na b">x-www-form-urlencoded</code>。提供名称作为键，任务名称作为值。点击发送按钮，你会得到一个回复<code class="fe mx my mz na b">200 ok</code></li></ul><h2 id="c515" class="lw ku in bd kv lx ly dn kz lz ma dp ld kg mb mc lh kk md me ll ko mf mg lp mh bi translated">处理异常(可选)</h2><p id="43da" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">如果您输入了错误的路线<code class="fe mx my mz na b"><a class="ae mr" href="http://localhost:3000/task" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/task</a></code>而不是<code class="fe mx my mz na b"><a class="ae mr" href="http://localhost:3000/task" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/task</a>s</code>，服务器会响应一条消息<strong class="jx io">无法获得/任务</strong>。通过在服务器文件(index.js)中添加以下代码，创建自定义错误信息，而不是默认错误信息。</p><pre class="nc nd ne nf gt ng na nh ni aw nj bi"><span id="4d57" class="lw ku in na b gy nk nl l nm nn">app.use(function(req, res) {<br/>  res.status(404).send({url: req.originalUrl + ' not found'})<br/>});</span></pre><p id="9058" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">感谢阅读这篇文章。</p><p id="883e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">感谢<a class="ae mr" href="https://www.linkedin.com/in/gowri-m-bhatt-85b31814b/" rel="noopener ugc nofollow" target="_blank"> Gowri M Bhatt </a>审阅内容。</p><p id="8192" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果你喜欢这篇文章，请点击拍手按钮👏并且分享出来帮别人找！</p><p id="72fe" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这篇文章也可以在<a class="ae mr" href="https://dev.to/codemaker2015/develop-nodejs-rest-apis-using-express-and-mongodb-3bdm" rel="noopener ugc nofollow" target="_blank"> Dev </a>上找到。</p><p id="bbbb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">本教程的完整源代码可以在这里找到，</p><div class="nx ny gp gr nz oa"><a href="https://github.com/codemaker2015/rest-todo-list-api" rel="noopener  ugc nofollow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd io gy z fp of fr fs og fu fw im bi translated">GitHub-code maker 2015/Rest-todo-list-api:使用 nodejs 和 mongodb 的 Rest todo 列表 API</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">github.com</p></div></div><div class="oj l"><div class="ok l ol om on oj oo jt oa"/></div></div></a></div></div></div>    
</body>
</html>