<html>
<head>
<title>Activity indicator in Navigation Bar (tutorial)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">导航栏中的活动指示器(教程)</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/activity-indicator-in-navigation-bar-tutorial-484b2614f6e4?source=collection_archive---------0-----------------------#2020-09-12">https://blog.devgenius.io/activity-indicator-in-navigation-bar-tutorial-484b2614f6e4?source=collection_archive---------0-----------------------#2020-09-12</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/b6d16444679ff6430742503c1f2693bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dkKE-mgj1UJOZrujEao5Kw.png"/></div></div></figure><p id="c695" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">有很多方法可以向用户显示在后台有一些长时间运行的进程。最明显和简单的方法是使用阻塞进度视图。Github上有很多图书馆，MBProgressHUD<a class="ae kt" href="https://github.com/jdg/MBProgressHUD" rel="noopener ugc nofollow" target="_blank">https://github.com/jdg/MBProgressHUD</a>就是其中之一。</p><p id="b18f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">但是这种方式只有在我们不希望用户在执行操作时与应用程序交互时才是好的。</p><p id="ae2b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">默认的非阻塞方法是更改应用程序实例对象的networkActivityIndicatorVisible，如下所示:</p><blockquote class="ku kv kw"><p id="d003" class="jv jw kx jx b jy jz ka kb kc kd ke kf ky kh ki kj kz kl km kn la kp kq kr ks ig bi translated">ui application . shared . isnetworkactivityindicatorvisible = true</p></blockquote><p id="7fe0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这样，用户将在状态栏中看到一个活动指示器。但这是一种隐晦的方式。每次打开Twitter应用程序时，我们都可以看到它。但Twitter也有一个指标，表明有新内容可用。</p><p id="7bd2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">那么，还有什么？我们来查一下Telegram，WhatsApp等一些热门的信使。他们在导航栏中有一个活动指示器。每次聊天列表更新或建立互联网连接时都会显示。</p></div><div class="ab cl lb lc hr ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ig ih ii ij ik"><h1 id="6544" class="li lj in bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">这是怎么回事？</h1><p id="4709" class="pw-post-body-paragraph jv jw in jx b jy mg ka kb kc mh ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">我们在UINavigationItem中有一个titleView属性，它是UIView类型的可选属性。文件表明这是一个</p><blockquote class="ku kv kw"><p id="d619" class="jv jw kx jx b jy jz ka kb kc kd ke kf ky kh ki kj kz kl km kn la kp kq kr ks ig bi translated">代替标题使用的自定义视图。可以水平调整大小。仅在项目位于堆栈顶部时使用。</p></blockquote><p id="c829" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">因此，让我们制作自己的NavigationBarProgressView，并使其可重用并易于附加到任何UIViewController。</p><p id="e2c2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">首先，我们需要一个UIActivityIndicatorView和一个UILabel对象来显示文本。让我们在自定义UIView中将它们分组。</p><figure class="ml mm mn mo gt jo"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="8013" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">但是我们也希望能够配置它们。要完全配置我们的视图，我们至少需要一种字体、字体颜色、文本、活动指示器的样式和一个视图框架。让我们编写一个描述我们的视图的配置器结构:</p><figure class="ml mm mn mo gt jo"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="b3b0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">然后我们向视图类添加配置代码:</p><figure class="ml mm mn mo gt jo"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="83d4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们现在没事了吗？是和不是。我们需要把我们的标签和活动指标。我们可以使用自动布局或手动布局。让我们手动完成它，没有必要在这样一个简单的视图中使用沉重的线性不等式(Autolayout就是这样)。</p><figure class="ml mm mn mo gt jo"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="5898" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">你可能已经注意到有一些悬而未决的财产。这是一个简单的标志，我们需要正确定位我们的子视图。我们希望标题标签居中，当没有进程运行时看起来像一个简单的标题，当它运行时，我们希望标题标签为活动指示器提供一些空间。所以，isPending是一个简单的Bool标志。</p><p id="957e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在我们看到视图在其生命周期中至少有两个事件。当它开始挂起和停止时。让我们把它变成一个协议。我们希望我们的代码漂亮且可重用，对吗？</p><figure class="ml mm mn mo gt jo"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="d7be" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">好了，我们再进一步。现在，我们希望我们的控件可以方便地附加到任何UIViewController上。我们需要定义一个容器协议来保存对活动视图的引用，并操作视图的状态。我们还需要添加一些方法来将视图附加到我们的UIViewController。</p><figure class="ml mm mn mo gt jo"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="f901" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在，我们可以在导航项目标题视图中任何需要活动指示器的地方使用它了。</p><p id="6154" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">示例控制器可能如下所示:</p><figure class="ml mm mn mo gt jo"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="2c32" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们将得到以下结果:</p><figure class="ml mm mn mo gt jo gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/12ffc655e036bd1692c505356f2778cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*B3ResYvxF8iCnGzBr1inOQ.gif"/></div></figure><p id="b11f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">今天到此为止。感谢您的时间，在这里看到完整的代码<a class="ae kt" href="https://github.com/SergeyPetrachkov/NavigationBarProgress" rel="noopener ugc nofollow" target="_blank">https://github.com/SergeyPetrachkov/NavigationBarProgress</a></p></div></div>    
</body>
</html>