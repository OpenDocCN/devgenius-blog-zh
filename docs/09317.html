<html>
<head>
<title>Implementing LRU cache in PHP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 PHP 中实现 LRU 缓存</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/implementing-lru-cache-in-php-1632cf6a7443?source=collection_archive---------2-----------------------#2022-08-14">https://blog.devgenius.io/implementing-lru-cache-in-php-1632cf6a7443?source=collection_archive---------2-----------------------#2022-08-14</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="463c" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">“最近最少使用”是一种实用的缓存技术，它保存频繁访问的数据并丢弃不使用的项。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/e240dbce8103c8767fa42bb9721fcc78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jn_zpaLYurQFgl6H"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">安德烈·西佐夫在<a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="d30d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">LRU 缓存是<a class="ae ks" href="https://en.wikipedia.org/wiki/Cache_replacement_policies#Least_recently_used_(LRU)" rel="noopener ugc nofollow" target="_blank">缓存替换策略</a>，众多策略之一，它:</p><blockquote class="lp lq lr"><p id="dd0c" class="kt ku ls kv b kw kx jo ky kz la jr lb lt ld le lf lu lh li lj lv ll lm ln lo ig bi translated">是优化指令或算法，计算机程序或硬件维护的结构可以利用这些指令或算法来管理存储在计算机上的信息缓存。缓存通过将最近或经常使用的数据项保存在比普通内存存储更快或计算成本更低的内存位置来提高性能。当缓存已满时，算法必须选择丢弃哪些项目，以便为新项目腾出空间</p></blockquote><h1 id="c26b" class="lw lx in bd ly lz ma mb mc md me mf mg jt mh ju mi jw mj jx mk jz ml ka mm mn bi translated">定义</h1><p id="a6ae" class="pw-post-body-paragraph kt ku in kv b kw mo jo ky kz mp jr lb lc mq le lf lg mr li lj lk ms lm ln lo ig bi translated">这是一种保存有限数量项目的缓存策略。当缓存已满，并且您试图插入另一个缓存项时，它应该会删除“最少使用的缓存”项，以便为新来者腾出空间。</p></div><div class="ab cl mt mu hr mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ig ih ii ij ik"><h1 id="7876" class="lw lx in bd ly lz na mb mc md nb mf mg jt nc ju mi jw nd jx mk jz ne ka mm mn bi translated">LRU 缓存用例</h1><p id="708e" class="pw-post-body-paragraph kt ku in kv b kw mo jo ky kz mp jr lb lc mq le lf lg mr li lj lk ms lm ln lo ig bi translated">LRU 缓存算法通过缓存经常使用的数据来提高代码执行效率。缓存大小限制将内存使用减少到合理的数量。这种策略对于处理大量数据的长时间运行的流程非常有用。</p></div><div class="ab cl mt mu hr mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ig ih ii ij ik"><h1 id="01a3" class="lw lx in bd ly lz na mb mc md nb mf mg jt nc ju mi jw nd jx mk jz ne ka mm mn bi translated">LRU 缓存的工作原理</h1><p id="c636" class="pw-post-body-paragraph kt ku in kv b kw mo jo ky kz mp jr lb lc mq le lf lg mr li lj lk ms lm ln lo ig bi translated">想象一下，一个空的缓存中有五个数字。最初，它是空的:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/dfabf2a3d91b5fc95d27b0769dc2f17e.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/1*7AXxpLCZPHm1OlQADbSIFg.png"/></div></figure><p id="3822" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">当我们<strong class="kv io">插入</strong>新数字时，它们被追加到缓存中。当我们插入<strong class="kv io"> 4 </strong>时，缓存看起来如下:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/924d28a086cb326dd1e6adc9a74ce701.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*XXjlkTLwXT4iFivbz7lbng.png"/></div></figure><p id="027c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">然后我们插入<strong class="kv io"> 8 </strong>。这个元素还不在缓存中，所以它放在前面:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/ff84a6ef09245fe17e976378fb1f421b.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*BJZ9_NZyUdQtxZ3BMSLUbQ.png"/></div></figure><p id="a6aa" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">然后，我们随后插入<strong class="kv io"> 15 </strong>，然后插入<strong class="kv io"> 16 </strong>和<strong class="kv io"> 23。</strong>编号<strong class="kv io"> 4 </strong>成为“最少使用的元素”。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/c91d06f8cda3a93e2e7b275f4e046ecc.png" data-original-src="https://miro.medium.com/v2/resize:fit:822/format:webp/1*E3N35dLiYJAVd1oA_RRMTQ.png"/></div></figure><p id="6e81" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这是事情开始变得有趣的时候。我们想在名单上再增加一个数字。由于只允许五个数字，我们删除了“最少使用的数字”,并将该数字添加到列表中。新的“最少使用的号码”是<strong class="kv io"> 8 </strong>:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/da5e38496b42f0ab981320370c09d485.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*hOtrOdujuntdkUUr1R8XUw.png"/></div></figure><p id="ed94" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在我们想从缓存中请求编号<strong class="kv io"> 8 </strong>。该号码在列表中，所以它被推到列表的前面。新的“最少使用的号码”是<strong class="kv io"> 15 </strong>:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/12fe416e8161088678b16d62bf92bbcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/format:webp/1*4gZvSXu33EF-oQaBZ0seIA.png"/></div></figure></div><div class="ab cl mt mu hr mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ig ih ii ij ik"><h1 id="5c55" class="lw lx in bd ly lz na mb mc md nb mf mg jt nc ju mi jw nd jx mk jz ne ka mm mn bi translated">PHP 实现</h1><p id="66a0" class="pw-post-body-paragraph kt ku in kv b kw mo jo ky kz mp jr lb lc mq le lf lg mr li lj lk ms lm ln lo ig bi translated">我们应该从界面开始。它将使用泛型进行注释，以:</p><ul class=""><li id="2d4f" class="nl nm in kv b kw kx kz la lc nn lg no lk np lo nq nr ns nt bi translated">正确解析 PHPStorm 中的变量类型</li><li id="1c2f" class="nl nm in kv b kw nu kz nv lc nw lg nx lk ny lo nq nr ns nt bi translated">允许对诸如 Psalm/PHPStan 这样的工具进行严格的代码验证</li></ul><h2 id="3c10" class="nz lx in bd ly oa ob dn mc oc od dp mg lc oe of mi lg og oh mk lk oi oj mm ok bi translated">界面</h2><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ol om l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">缓存的接口</figcaption></figure><h2 id="f967" class="nz lx in bd ly oa ob dn mc oc od dp mg lc oe of mi lg og oh mk lk oi oj mm ok bi translated">实施</h2><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ol om l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">PHP 中的可靠实现</figcaption></figure><h2 id="51fe" class="nz lx in bd ly oa ob dn mc oc od dp mg lc oe of mi lg og oh mk lk oi oj mm ok bi translated">用法示例</h2><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ol om l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">用户缓存限制为 50 个用户的任务处理示例</figcaption></figure></div><div class="ab cl mt mu hr mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ig ih ii ij ik"><p id="57d4" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">有疑问吗？想法？请给我留下你的看法。让我们一起让我们的代码变得美丽。订阅我的出版物，获取更多类似的文章，成为更好的开发人员。</p></div><div class="ab cl mt mu hr mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ig ih ii ij ik"><p id="d160" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这个故事对你有价值吗？请留言支持我的工作👏<strong class="kv io">鼓掌表示感谢</strong><em class="ls">n .</em>你知道你可以不止一次鼓掌吗？🥰 <em class="ls">谢谢你。</em></p></div></div>    
</body>
</html>