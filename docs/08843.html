<html>
<head>
<title>The beautiful world of SQL Joins</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQL 连接的美丽世界</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/all-about-sql-joins-f9abd2982616?source=collection_archive---------7-----------------------#2022-07-14">https://blog.devgenius.io/all-about-sql-joins-f9abd2982616?source=collection_archive---------7-----------------------#2022-07-14</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/526cc5d426cb81288654fba7ae61a151.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dNB00sl-bOkiE6K-wEE9Kw.png"/></div></div></figure><p id="53de" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">连接的美丽世界，今天就让我们深入了解一下吧！</p><p id="6a26" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi kt translated"><span class="l ku kv kw bm kx ky kz la lb di"> S </span>根据组合记录的预期结果，QL 连接被分为四种类型，这些记录来自两个或多个使用连接函数中涉及的表的公共列的表。内部联接用于查找具有相同值的记录，左联接用于在两个表中获取左侧表中的所有记录并仅获取右侧表中的匹配值，而右联接用于获取右侧表中的所有记录并仅获取左侧表中的匹配记录，最后，执行完全联接以检索两个表中的所有记录，无论它们是否匹配。</p><p id="60f0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们将学习交叉连接、内部连接、自身连接和外部连接！</p><h1 id="1fd7" class="lc ld in bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated"><strong class="ak">了解加入</strong></h1><p id="0e2c" class="pw-post-body-paragraph jv jw in jx b jy ma ka kb kc mb ke kf kg mc ki kj kk md km kn ko me kq kr ks ig bi translated">为什么<strong class="jx io">会加入</strong>？</p><p id="b930" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">将数据划分到多个表中可以实现更高效的存储、更容易的操作和更大的可伸缩性。然而，这些优势是有代价的。</p><p id="8b48" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">什么是<strong class="jx io">加入</strong>？</p><p id="5548" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">联接是一种在 SELECT 语句中关联或联接表的机制(因此称为联接)。您可以使用特殊的语法连接多个表以返回一组输出，并且该连接会动态地关联每个表中的正确行。</p><p id="67cd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">注</strong>:理解 join 不是物理实体；也就是说，它不存在于数据库表本身中。DBMS 根据需要创建一个连接，并在查询执行期间保持它。</p><p id="2151" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">创建连接</strong></p><p id="85c7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">创建连接非常简单。您必须指定将要包含的所有表，以及它们之间的相互关系。</p><p id="b1dc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">示例:</p><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/2aebd0bbe9de3152658e320208daa286.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*Kl9qngrXhDSZ2hL42A4FEQ.png"/></div></figure><p id="8e16" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">什么是<strong class="jx io">笛卡尔乘积</strong></p><p id="147b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">不包含联接条件的表关系的结果。检索的行数是第一个表的行数乘以第二个表的行数。</p><p id="052f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">什么是<strong class="jx io">交叉连接</strong></p><p id="cd9e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">返回笛卡尔积的联接类型有时称为交叉联接。</p><p id="e9e2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">什么是<strong class="jx io">内部联接</strong></p><p id="9814" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">内部连接</strong>用于从两个表中返回满足指定条件的行。这是最常用的连接操作，可以认为是默认的连接类型。</p><p id="2edc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">内部连接进一步分为三个子类型:</p><ol class=""><li id="7801" class="mk ml in jx b jy jz kc kd kg mm kk mn ko mo ks mp mq mr ms bi translated">θ连接</li><li id="2502" class="mk ml in jx b jy mt kc mu kg mv kk mw ko mx ks mp mq mr ms bi translated">自然连接</li><li id="331a" class="mk ml in jx b jy mt kc mu kg mv kk mw ko mx ks mp mq mr ms bi translated">等价连接</li></ol><p id="5199" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">θ加入</strong></p><p id="c4e1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> Theta Join </strong>允许你根据 Theta 条件合并两个表格。对于所有比较运算符，θ连接功。它由符号表示。θ连接是连接操作的一般情况。</p><blockquote class="my"><p id="0970" class="mz na in bd nb nc nd ne nf ng nh ks dk translated"><code class="fe ni nj nk nl b">A ⋈ A.column 2 &gt; B.column 2 (B)</code></p></blockquote><p id="edb8" class="pw-post-body-paragraph jv jw in jx b jy nm ka kb kc nn ke kf kg no ki kj kk np km kn ko nq kq kr ks ig bi translated"><strong class="jx io">对等连接</strong></p><p id="fde3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="nr">等联接</em> —基于两个表之间相等性测试的联接。这种类型的联接也称为内部联接。事实上，对于这些连接，您可以使用稍微不同的语法，显式地指定连接的类型。</p><p id="c425" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">当θ连接只使用等价条件时，它被称为<strong class="jx io">等价连接</strong>。等价连接是 RDBMS 中最难有效实现的操作，这也是 RDBMS 出现严重性能问题的原因之一。</p><blockquote class="my"><p id="526a" class="mz na in bd nb nc nd ne nf ng nh ks dk translated"><code class="fe ni nj nk nl b">A ⋈ A.column 2 = B.column 2 (B)</code></p></blockquote><p id="5870" class="pw-post-body-paragraph jv jw in jx b jy nm ka kb kc nn ke kf kg no ki kj kk np km kn ko nq kq kr ks ig bi translated"><strong class="jx io">自然连接</strong></p><p id="4379" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">自然连接</strong>不使用任何比较运算符。这种类型的连接中的属性应该具有相同的名称和域。自然连接中的两个关系之间应该至少有一个公共属性。</p><p id="917f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">它对出现在两个关系中的属性执行选择，形成相等，并消除重复的属性。</p><p id="b7be" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">示例:</p><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/d095ff3514134ea6df0be74c7474f77e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*IUrnEmwui7Ps-CHqokRhkA.png"/></div></figure><p id="1c2b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">连接多个表格</strong></p><p id="f4e7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在 SQL 的 SELECT 语句中，可以连接的表的数量没有限制。创建连接的基本规则保持不变。首先列出所有的表，然后定义它们的关系。</p><p id="b186" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">注意</strong>:要连接的 Postgres 最大表数是 61</p><p id="892a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">注意</strong>:一个连接中的最大表数</p><p id="bdba" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">ANSI SQL 中可以连接的表的数量没有限制，但是请检查 DBMS 中的实现。</p><p id="0698" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">示例:</p><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ns"><img src="../Images/f91f12af2a5accc2be093ab1882bd9f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*DyThvoKc4mVGcIRdOJaC0g.png"/></div></div></figure><p id="3940" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">使用表格别名</strong></p><p id="0cae" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">示例:</p><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/eeb8f9cdd7fd6b20ac8c5ad5862a2ec9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*D7D-zOCOjRgrVXXKW9oQAg.png"/></div></figure><p id="0d41" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">注意</strong>:同样值得注意的是，表别名只在查询执行期间使用。与列别名不同，表别名永远不会返回给客户端。</p><p id="ebc5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">使用不同的连接类型</strong></p><p id="31da" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们看看自连接、自然连接和外部连接。</p><p id="3705" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">什么是<strong class="jx io">自我归附</strong></p><p id="4f07" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">顾名思义，自连接将表连接到自身。要使用自联接，表中必须有一列(我们称之为 X)作为主键，另一列(我们称之为 Y)存储可以与 X 列中的值匹配的值。对于任何给定的行，X 列和 Y 列不必具有相同的值，Y 列甚至可以为空。</p><p id="19f3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">示例:</p><p id="362e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">假设您想向 Jim Jones 在同一家公司工作的所有客户联系人发送一封邮件。该查询要求您首先确定 Jim Jones 为哪家公司工作，然后确定哪些客户为该公司工作。解决这个问题的一种方法如下:</p><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ns"><img src="../Images/7bab0aabdc028e4af31487f18607e92e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*eQahNw5e5GkkhiYZadSXfA.png"/></div></div></figure><p id="74c2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">注意</strong>:自连接经常被用来替换那些从与外部语句相同的表中检索数据的语句。尽管最终结果是一样的，但许多 DBMSs 处理连接的速度要比子查询快得多。通常值得对两者进行测试，看看哪一个性能更好。</p><p id="51f8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">什么是<strong class="jx io">自然联结</strong></p><p id="81f6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">自然联接是一种只选择唯一列的联接。对于一个表，这通常通过使用通配符(SELECT *)和所有其他表的列的显式子集来实现。</p><p id="f4ff" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">自然连接连接两个具有相同属性名和数据类型的表。生成的表将具有两个表的所有属性，但每个公共列只有一个副本。</p><p id="f78d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">内部</strong> vs <strong class="jx io">自然</strong>连接</p><p id="0561" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">内部联接根据 on 子句中显式指定的列联接两个表。结果表将包括两个表中的所有属性，包括公共列。</p><p id="ddcf" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">示例:</p><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/f4347891213ec023591d1163f1825635.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*r82hSbF_KgAtK95BWfsxNw.png"/></div></figure><p id="ea34" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">外部联接</strong></p><p id="25c7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">大多数联接将一个表中的行与另一个表中的行相关联。但是有时，您希望包含没有相关行的行，因此您使用了<strong class="jx io">外部</strong>连接。</p><p id="f3ec" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">示例:</p><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/2555073e02f1b4c7de01d265df5739f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*_eW0KCWGnIzQs8kUnutjqQ.png"/></div></figure><p id="8173" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">注意</strong> : <strong class="jx io"> SQLite 外连接</strong></p><p id="bde2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">SQLite 支持<code class="fe ni nj nk nl b">LEFT OUTER JOIN</code>，不支持<code class="fe ni nj nk nl b">RIGHT OUTER JOIN</code>。幸运的是，如果您确实需要 SQLite 中的<code class="fe ni nj nk nl b">RIGHT OUTER JOIN</code>功能，有一个非常简单的解决方案，只需翻转表的顺序。</p><p id="3dae" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">完全外部连接</strong></p><p id="48c8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">当左(表 1)或右(表 2)表记录中有匹配时，<code class="fe ni nj nk nl b">FULL OUTER JOIN</code>关键字返回所有记录。</p><p id="23ed" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">示例:</p><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/abf5ef253b3d425be75ea709f144b4f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*qaj509QXXFfIWewwFFB9BA.png"/></div></figure><p id="90da" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">注意</strong>:Maria db、MySQL 或 SQLite 不支持<code class="fe ni nj nk nl b">FULL OUTER JOIN</code>语法。</p><p id="185a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">注意</strong>:关键字<code class="fe ni nj nk nl b">FULL OUTER JOIN</code>返回两个表中所有匹配的记录，不管另一个表是否匹配。因此，如果“客户”中的行与“订单”中的行不匹配，或者“订单”中的行与“客户”中的行不匹配，这些行也将被列出。</p><p id="6c38" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">使用聚合函数连接</strong></p><p id="3375" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">示例:</p><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/5b2b327f12125c013e5e13cf6f2cf4cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*RlNVraZrYrV3CK9Z0udkpg.png"/></div></figure><h1 id="7aa3" class="lc ld in bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">摘要</h1><p id="92c9" class="pw-post-body-paragraph jv jw in jx b jy ma ka kb kc mb ke kf kg mc ki kj kk md km kn ko me kq kr ks ig bi translated">正如你所看到的，当你学习连接时，它并不可怕，❤️</p><p id="c0df" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我希望你对这篇文章感兴趣！</p></div></div>    
</body>
</html>