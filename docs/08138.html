<html>
<head>
<title>Air Quality Dataset Plot with Plotly Using R Shiny Webapp</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 R Shiny Webapp 使用 Plotly 绘制空气质量数据集</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/air-quality-dataset-plot-with-plotly-using-r-shiny-webapp-1578b59fd088?source=collection_archive---------9-----------------------#2022-05-19">https://blog.devgenius.io/air-quality-dataset-plot-with-plotly-using-r-shiny-webapp-1578b59fd088?source=collection_archive---------9-----------------------#2022-05-19</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><figure class="gm go jp jq jr js gi gj paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="gi gj jo"><img src="../Images/3f6a4033e72976d8c860cb339b5b6a5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Va7KU9o66MWVChS3sy22-g.png"/></div></div><figcaption class="jz ka gk gi gj kb kc bd b be z dk translated">基拉尼省立公园，2021 年 10 月 5 日</figcaption></figure><p id="d724" class="pw-post-body-paragraph kd ke ir kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ik bi translated"><a class="ae lb" href="https://www.rdocumentation.org/packages/datasets/versions/3.6.2/topics/airquality" rel="noopener ugc nofollow" target="_blank">R 中内置的空气质量数据集</a>是纽约五月到九月的每日空气质量测量值。质量值包括:</p><ul class=""><li id="38ee" class="lc ld ir kf b kg kh kk kl ko le ks lf kw lg la lh li lj lk bi translated">臭氧</li><li id="e65a" class="lc ld ir kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated">太阳能。稀有</li><li id="e92c" class="lc ld ir kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated">风</li><li id="f94c" class="lc ld ir kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated">临时雇员</li></ul><p id="6167" class="pw-post-body-paragraph kd ke ir kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ik bi translated">我们将臭氧与其他三种指标进行对比，以了解它们之间的基本关系。它看起来如下:</p><figure class="lr ls lt lu gu js gi gj paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="gi gj lq"><img src="../Images/7e9639c3960329a2988d3c283409f39f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C3XcpKZrZsI9ednvKMtFSQ.png"/></div></div></figure><p id="f8b2" class="pw-post-body-paragraph kd ke ir kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ik bi translated">这个示例 webapp 可以从 shinyapps 网站的<a class="ae lb" href="https://fengliplatform.shinyapps.io/c9papp/" rel="noopener ugc nofollow" target="_blank">这里</a>访问。</p><p id="ec9b" class="pw-post-body-paragraph kd ke ir kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ik bi translated">用户界面代码:</p><pre class="lr ls lt lu gu lv lw lx ly aw lz bi"><span id="51f4" class="ma mb ir lw b gz mc md l me mf">library(shiny)<br/>library(plotly)<br/><br/># Define UI for application that draws a histogram<br/>shinyUI(fluidPage(<br/><br/>  # Application title<br/>  titlePanel("Air Quality Data Plots"),<br/><br/>  # Sidebar with a slider input for number of bins<br/>  sidebarLayout(<br/>    sidebarPanel(<br/>        h3("Brief Redme"),<br/>        tags$div(class="header", checked=NA,<br/>                 tags$p("Ozone plots against Solar.R, Wind and Temp in each tab.<br/>                        Plot data is based on chosen month. You can also show or<br/>                        hide a linear model line to each plot."),<br/>                 tags$a(href="https://github.com/fengliplatform/course9/tree/master/shinyapp/c9pApp", "Source Code on Github.")<br/>        ),<br/><br/>        h3("Choose Month"),<br/>        checkboxInput("checkMay", "May", value = TRUE),<br/>        checkboxInput("checkJune", "June", value = TRUE),<br/>        checkboxInput("checkJuly", "July", value = TRUE),<br/>        checkboxInput("checkAugust", "August", value = TRUE),<br/>        checkboxInput("checkSeptember", "September", value = TRUE),<br/><br/>        h3("Linear Regression Model"),<br/>        checkboxInput("checkModel", "Show/Hide Model", value = TRUE)<br/>    ),<br/><br/>    # Show a plot of the generated distribution<br/>    mainPanel(<br/>        tabsetPanel(type = "tabs",<br/>                    tabPanel("By Solar.R", br(), plotlyOutput("solarPlot")),<br/>                    tabPanel("By Wind", br(), plotlyOutput("windPlot")),<br/>                    tabPanel("By Temp", br(), plotlyOutput("tempPlot"))<br/>        )<br/>    )<br/>  )<br/><br/>))</span></pre><p id="7ac3" class="pw-post-body-paragraph kd ke ir kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ik bi translated">服务器端代码:</p><pre class="lr ls lt lu gu lv lw lx ly aw lz bi"><span id="2f83" class="ma mb ir lw b gz mc md l me mf">library(shiny)<br/>library(plotly)<br/>library(ggplot2)<br/><br/>data("airquality")<br/><br/><br/># Define server logic required to draw a histogram<br/>shinyServer(function(input, output) {<br/><br/>    solar.lm &lt;- reactive({<br/>        df &lt;- generate.df()<br/>        s.lm &lt;- lm(Ozone~Solar.R, data=df)<br/>        s.lm.pred &lt;- predict(s.lm, newdata=df)<br/>        df1 &lt;- data.frame(x=df$Solar.R, y=s.lm.pred)<br/>    })<br/>    wind.lm &lt;- reactive({<br/>        df &lt;- generate.df()<br/>        w.lm &lt;- lm(Ozone~Wind, data=df)<br/>        w.lm.pred &lt;- predict(w.lm, newdata=df)<br/>        df1 &lt;- data.frame(x=df$Wind, y=w.lm.pred)<br/>    })<br/>    temp.lm &lt;- reactive({<br/>        df &lt;- generate.df()<br/>        t.lm &lt;- lm(Ozone~Temp, data=df)<br/>        t.lm.pred &lt;- predict(t.lm, newdata=df)<br/>        df1 &lt;- data.frame(x=df$Temp, y=t.lm.pred)<br/><br/>    })<br/>    generate.df &lt;- reactive({<br/>        checked.month &lt;- numeric<br/>        if( input$checkMay) {<br/>            checked.month &lt;- c(checked.month, 5)<br/>        }<br/>        if( input$checkJune) {<br/>            checked.month &lt;- c(checked.month, 6)<br/>        }<br/>        if( input$checkJuly) {<br/>            checked.month &lt;- c(checked.month, 7)<br/>        }<br/>        if( input$checkAugust) {<br/>            checked.month &lt;- c(checked.month, 8)<br/>        }<br/>        if( input$checkSeptember) {<br/>            checked.month &lt;- c(checked.month, 9)<br/>        }<br/><br/>        df &lt;- airquality[airquality$Month %in% checked.month,]<br/>    })<br/><br/><br/>    output$solarPlot &lt;- renderPlotly({<br/>        df &lt;- generate.df()<br/>        df2 &lt;- solar.lm()<br/><br/>        p &lt;- plot_ly(df, x=~Solar.R, y=~Ozone,<br/>                type = "scatter", mode = "markers",<br/>                marker = list(size = 10, opacity = 0.5),<br/>                showlegend = F)<br/>        if (input$checkModel) {<br/>            add_trace(p, x = df2$x, y = df2$y, mode = "lines")<br/>        } else {<br/>            p<br/>        }<br/><br/>    })<br/>    output$windPlot &lt;- renderPlotly({<br/>        df &lt;- generate.df()<br/>        df2 &lt;- wind.lm()<br/><br/>        p &lt;- plot_ly(df, x=~Wind, y=~Ozone,<br/>                     type = "scatter", mode = "markers",<br/>                     marker = list(size = 10, opacity = 0.5),<br/>                     showlegend = F)<br/>        if (input$checkModel) {<br/>            add_trace(p, x = df2$x, y = df2$y, mode = "lines")<br/>        } else {<br/>            p<br/>        }<br/><br/>    })<br/>    output$tempPlot &lt;- renderPlotly({<br/>        df &lt;- generate.df()<br/>        df2 &lt;- temp.lm()<br/><br/>        p &lt;- plot_ly(df, x=~Temp, y=~Ozone,<br/>                     type = "scatter", mode = "markers",<br/>                     marker = list(size = 10, opacity = 0.5),<br/>                     showlegend = F)<br/>        if (input$checkModel) {<br/>            add_trace(p, x = df2$x, y = df2$y, mode = "lines")<br/>        } else {<br/>            p<br/>        }<br/><br/>    })<br/><br/>})</span></pre><p id="84a1" class="pw-post-body-paragraph kd ke ir kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ik bi translated">快乐阅读！</p></div></div>    
</body>
</html>