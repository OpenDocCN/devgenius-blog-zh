<html>
<head>
<title>Designing Enemies</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">设计敌人</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/designing-enemies-4ba43eba3ef9?source=collection_archive---------1-----------------------#2021-07-09">https://blog.devgenius.io/designing-enemies-4ba43eba3ef9?source=collection_archive---------1-----------------------#2021-07-09</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="a267" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">使用抽象类</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/a376a9a96ac99d35adfdcf16c25e45e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ejfHhPU0kpMYskjPdc2b8w.png"/></div></div></figure><p id="aea9" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我有3个不同的敌人，他们都有共同的功能。为了实现这一点，我将使用一个抽象类。</p><div class="lk ll gp gr lm ln"><a href="https://ktmarine1999.medium.com/using-classes-9c5742c8f7d1" rel="noopener follow" target="_blank"><div class="lo ab fo"><div class="lp ab lq cl cj lr"><h2 class="bd io gy z fp ls fr fs lt fu fw im bi translated">使用类。</h2><div class="lu l"><h3 class="bd b gy z fp ls fr fs lt fu fw dk translated">代码可重复性</h3></div><div class="lv l"><p class="bd b dl z fp ls fr fs lt fu fw dk translated">ktmarine1999.medium.com</p></div></div><div class="lw l"><div class="lx l ly lz ma lw mb km ln"/></div></div></a></div><div class="lk ll gp gr lm ln"><a href="https://ktmarine1999.medium.com/abstract-behaviors-ba4a5aefa55e" rel="noopener follow" target="_blank"><div class="lo ab fo"><div class="lp ab lq cl cj lr"><h2 class="bd io gy z fp ls fr fs lt fu fw im bi translated">抽象行为</h2><div class="lu l"><h3 class="bd b gy z fp ls fr fs lt fu fw dk translated">实现抽象行为以保证方法可用，并强制子行为实现该方法。</h3></div><div class="lv l"><p class="bd b dl z fp ls fr fs lt fu fw dk translated">ktmarine1999.medium.com</p></div></div><div class="lw l"><div class="mc l ly lz ma lw mb km ln"/></div></div></a></div><p id="6ce7" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">敌人类将包含所有的公共变量和方法，每个敌人将被迫实现相同但工作方式不同的方法。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/24df80c37de932e2fb8ddcd4a06d6999.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bgm1WBZaw_wjq7qPdp7Fhg.png"/></div></div></figure><p id="68cf" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我希望我所有的敌人都保持相同的空闲和移动状态，但是如果需要的话，我希望能够增加针对特定类型敌人的功能。我将专注于我的苔藓巨人，让它以我想要的方式工作，但在敌人的行为中使用所有的代码。</p><p id="f2ab" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我创造了一个摩斯巨人敌人游戏对象。我添加了一个航路点对象，它有一个到我的苔藓巨人敌人的平滑路径。我还添加了一个苔藓巨人，它的设置类似于播放器(刚体和长方体碰撞器组件以及一个带有Animator的精灵游戏对象)。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi md"><img src="../Images/9e454c3f753335ab0ac2018d217aad5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*C9pH2nt6UNKtpytMa-enFg.gif"/></div></div></figure><p id="977e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我将我的动画控制器设置为一个空闲动画，一旦它完成，就转换为行走动画。为了转换回行走动画，我将在代码中设置一个触发器。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi me"><img src="../Images/a2a597beff817b03e1ccfb94cb1c65f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*mYVMnpx9uGMcnQSQetQtLA.gif"/></div></div></figure><p id="4f14" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我开始让苔藓巨人在路径点之间移动。</p><p id="f270" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我使用Cinemachine Base Path实现了一个路点系统。</p><div class="lk ll gp gr lm ln"><a rel="noopener  ugc nofollow" target="_blank" href="/moving-platform-a-different-way-ce5992cc8dec"><div class="lo ab fo"><div class="lp ab lq cl cj lr"><h2 class="bd io gy z fp ls fr fs lt fu fw im bi translated">以不同的方式移动平台</h2><div class="lu l"><h3 class="bd b gy z fp ls fr fs lt fu fw dk translated">创建一个模块化的移动平台，并把它变成一个预制组件</h3></div><div class="lv l"><p class="bd b dl z fp ls fr fs lt fu fw dk translated">blog.devgenius.io</p></div></div><div class="lw l"><div class="mf l ly lz ma lw mb km ln"/></div></div></a></div><p id="45b5" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我希望子行为可以访问的变量被保护了。如果将来我需要访问其中一个私有变量，我会为它们创建受保护的assessor，有些东西我不想意外更改，因为这可能会导致一个很难找到的bug。我希望子行为能够修改的方法是虚拟的。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mg"><img src="../Images/b44d21a2802c6b14e640e677300cdbb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AiaBzWyE_C8jy8Sm0gEkhA.png"/></div></div></figure><p id="71c2" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我的苔藓巨人是从敌人那里继承来的空行为。这是必要的，因为抽象类不能作为组件添加到游戏对象中。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/b8f2a3e06325aeb6aeb94c4f6058b071.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/format:webp/1*CQSqrtusZKDxOsubs4aejw.png"/></div></figure><p id="910d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我的苔藓巨人现在在路径点之间移动。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mi"><img src="../Images/4ca33eff1c356f5823cecc4829634690.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*h7frx6-A5g_1pr79x6pDWw.gif"/></div></div></figure><p id="d27a" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">接下来，我使它在播放空闲动画时不能移动。动画师作为一种方法来获得当前状态的信息。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mj"><img src="../Images/964da2103009e39111006688fae56bec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h-Oud-hydOzN3GzwYGEW8g.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae mo" href="https://docs.unity3d.com/2021.1/Documentation/ScriptReference/Animator.GetCurrentAnimatorStateInfo.html" rel="noopener ugc nofollow" target="_blank">https://docs . unity 3d . com/2021.1/Documentation/script reference/Animator。GetCurrentAnimatorStateInfo.html</a></figcaption></figure><p id="8485" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我检查当前状态名是否为Idle，如果是，我退出Update方法。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mp"><img src="../Images/2f71f1926518d7fbcd9e95c1390b59c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_souxRZMfMfOWIB2MEzsQg.png"/></div></div></figure><p id="72ef" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在我的敌人在移动之前播放空闲动画。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/a5b43dee0204d88c4788294dc33cecc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/1*BhH-OJproLkbLHuNhZl8Hg.gif"/></div></figure><p id="1e5c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">接下来，当敌人到达下一个路径点时，我触发空闲动画</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mg"><img src="../Images/ebadf0b152aaa884d55a9ef512b91081.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jgwl4dRBOgvnvYW21PUAdQ.png"/></div></div></figure><p id="a060" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">确保这按预期工作。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/18b0257d7d8f52aa0d62ba7f69f3e59c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/1*AIYggUOsriBZHpSC__lkhw.gif"/></div></figure><p id="2bab" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">最后一步是改变敌人移动时面对的方向。为此，我将改变变换的方向，使其朝向移动的方向。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ms"><img src="../Images/c529e7b04fb15c2e015327879922ac35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H0Po_WLXIpx2tBuhp8fUqQ.png"/></div></div></figure><p id="a8b5" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这工作，但不是在正确的位置退出，因为我想让它改变面对的方向后，它下来与闲置的动画。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/0cb203e6e713a7a383759557f09e756d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/1*WskVt6O2tgdu_RXbt7VCrg.gif"/></div></figure><p id="40cf" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在移动之前，我将代码移动到更新方法中。当前方向是我通过s点的当前方向，也就是敌人移动的相反方向。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mt"><img src="../Images/a43290d2c73b2cc50d767882e3c21843.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*yACMxT1Lyy3S8_cUhYPPvw.gif"/></div></div></figure><p id="f486" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在我把它逻辑上放在了正确的位置。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mu"><img src="../Images/5748bd42fba6623d4c4628aca258097b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/1*heDzUFO0AiEoV1h9rPqlJA.gif"/></div></div></figure><p id="562e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我只需要在敌人改变方向时改变面对的方向。为了做到这一点，如果敌人改变方向，我添加一个布尔。当我改变方向时，我将它设置为true，当我改变方向时，我将它设置为false。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mv"><img src="../Images/65c89098d790ff4b21e08ed341b8d186.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*iyXqqwjmH8LvUTPz2AJedg.gif"/></div></div></figure><p id="0872" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这在视觉上仍然是一样的，但是现在只在需要的时候发生，这使得它更有性能。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/0cb203e6e713a7a383759557f09e756d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/1*WskVt6O2tgdu_RXbt7VCrg.gif"/></div></figure><p id="f6b9" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">然后，我重构了一些代码，使其更加模块化。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mw"><img src="../Images/1b52180101e1f6cb826002bc765e610f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*-3YFpLQ4Xy_6FDTric8x3Q.gif"/></div></div></figure></div></div>    
</body>
</html>