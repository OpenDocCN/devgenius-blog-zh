<html>
<head>
<title>Variadic functions in C</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">C 语言中的变元函数</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/variadic-functions-in-c-c480e85e86e9?source=collection_archive---------7-----------------------#2020-08-03">https://blog.devgenius.io/variadic-functions-in-c-c480e85e86e9?source=collection_archive---------7-----------------------#2020-08-03</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="7835" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">可变函数是那些接受可变数量的参数的函数，因为我们很多人总是好奇 printf 和 scanf 是如何工作的，因为我们可以用可变数量的参数来调用它们。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/020f7f4420da6d89e2cf23f7da26c679.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kz77FG4Q5qsjOUMvAS7IeA.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">麦克斯韦·尼尔森在 T2 的照片</figcaption></figure><blockquote class="kz la lb"><p id="56af" class="jk jl lc jm b jn jo jp jq jr js jt ju ld jw jx jy le ka kb kc lf ke kf kg kh ig bi translated">这是如何工作的？</p></blockquote><p id="530e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你可以用最后一个参数函数(a，b，c，…)将变元函数声明为与其他函数相同的函数，这里“…”表示函数可以有可变数量的参数。看起来像是:</p><pre class="kj kk kl km gt lg lh li lj aw lk bi"><span id="cd55" class="ll lm in lh b gy ln lo l lp lq">int sum(int n, …)</span></pre><p id="1f96" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了使用这个语法，你必须像这样在头文件中包含<strong class="jm io"> stdarg.h </strong>头文件。</p><pre class="kj kk kl km gt lg lh li lj aw lk bi"><span id="c02d" class="ll lm in lh b gy ln lo l lp lq">#include&lt;stdarg.h&gt;</span></pre><p id="e5ff" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在我们将学习一些将在变量函数中使用的宏。</p><p id="5f99" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> va_list : </strong> va_list 宏用于初始化参数指针。</p><pre class="kj kk kl km gt lg lh li lj aw lk bi"><span id="fb1a" class="ll lm in lh b gy ln lo l lp lq">va_list argumentsList;</span></pre><p id="9740" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> va_start : </strong> va_start 宏用于初始化带有参数列表的 va_list，它接受两个参数，第一个是指向 va_list 的指针，第二个是变量参数的计数。</p><pre class="kj kk kl km gt lg lh li lj aw lk bi"><span id="143c" class="ll lm in lh b gy ln lo l lp lq">va_start(argumentsList,n);</span></pre><p id="b287" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> va_arg : </strong> va_arg 宏最初指向我们调用的参数列表的第一个元素，然后它移动到下一个元素，它接受两个参数第一个是指向 va_list 的指针，第二个是 va_arg 指向的元素的数据类型。</p><pre class="kj kk kl km gt lg lh li lj aw lk bi"><span id="e565" class="ll lm in lh b gy ln lo l lp lq">int t=va_arg(argumentsList, int)</span></pre><p id="e7c3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> va_end : </strong> va_end 用于清理 va_list。</p><pre class="kj kk kl km gt lg lh li lj aw lk bi"><span id="c97d" class="ll lm in lh b gy ln lo l lp lq">va_end();</span></pre><p id="ebad" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">理解多元函数的一个非常基本的例子。</p><pre class="kj kk kl km gt lg lh li lj aw lk bi"><span id="3b63" class="ll lm in lh b gy ln lo l lp lq">#include&lt;stdarg.h&gt;<br/>#include&lt;stdio.h&gt;<br/>int add(int n, ...)<br/>{<br/>int i,sum=0;<br/>va_list argumentsList;<br/>va_start(argumentsList,n);<br/>for(i=0;i&lt;n;i++)<br/>{<br/>sum+=va_arg(argumentsList,int);<br/>}<br/>return sum;<br/>}<br/>int main()<br/>{<br/>printf("%d\n",add(3,1,2,3));<br/>printf("%d\n",add(4,1,2,3,4));<br/>printf("%d\n",add(5,1,2,3,4,5));<br/>printf("%d\n",add(6,1,2,3,4,5,6));<br/>return 0;<br/>}</span></pre><p id="07ad" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">该程序的输出将是:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lr"><img src="../Images/7e5694065d0a5902aabad9295f95674f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q6jXHnTnteNYmFQkldBYUA.png"/></div></div></figure><p id="faea" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">结论:</strong>在本文中我们学习了什么是变函数以及如何实现它，如果您有任何疑问和建议请添加备注。</p><p id="7f06" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">谢谢你。</p></div></div>    
</body>
</html>