<html>
<head>
<title>How to Build and Publish an Electron App with React? | Tutorial</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用 React 构建并发布一个电子 App？|教程</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-build-and-publish-an-electron-app-with-react-tutorial-971e1d9d27ce?source=collection_archive---------0-----------------------#2022-05-08">https://blog.devgenius.io/how-to-build-and-publish-an-electron-app-with-react-tutorial-971e1d9d27ce?source=collection_archive---------0-----------------------#2022-05-08</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="53e9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">大家好，</p><p id="bb94" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这篇文章中，我将创建一个 React 应用程序，然后集成电子图书馆。我将解释基本的集成、构建和发布过程。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c50272f63a9a4b2af34b1488be31b32d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wSP9lHfArhtSQJWv2by5eA.png"/></div></div></figure><p id="1c03" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在开始教程之前，我想解释一下什么是电子，以及我为什么使用它。Electron 是一个 JS 框架，它帮助我们通过基于 Web 的技术创建本地应用程序。比如 HTML，Css，JS 等等。从<a class="ae ku" href="https://www.electronjs.org" rel="noopener ugc nofollow" target="_blank">这里</a>可以找到更多信息。</p><p id="0f4c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这篇文章之前，我只用过两次。第一次体验就想利用跨平台优势。我开发了一个应用程序，并针对 Win/OSx/Linux 发布。我用了棱角分明的。网芯。该应用程序运行顺利。第二次，我和我的团队开发了一个 kiosk 应用程序。由于时间有限，我们想使用网络技术而不是桌面应用程序。使用现成的模板很容易开发，这对客户来说是一个很好的体验。</p></div><div class="ab cl kv kw hr kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ig ih ii ij ik"><p id="b8d9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们开始开发吧！</p><p id="6053" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我将在教程中使用一个新的 react 项目。如果你有一个当前的项目，你可以跳过这一部分。此外，我更喜欢使用 typescript 模板。如果您使用 javascript 模板，它不会影响集成过程。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lc"><img src="../Images/6e24ce7f3d8bd02c23032b60b5f9a390.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N-0aeha5maNYarA4qpePSg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated"><strong class="bd lh">截图一:</strong>创建一个 react app。</figcaption></figure><p id="bb22" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，项目已经准备好了。在开始集成 electronic 之前，可以通过以下命令检查 react 项目。</p><pre class="kj kk kl km gt li lj lk ll aw lm bi"><span id="c255" class="ln lo in lj b gy lp lq l lr ls">npm start</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lt"><img src="../Images/16b3996f9ee45c49e95e70fd532e3641.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s8iJZ7FLXQoXhmxfYGBE1g.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated"><strong class="bd lh">截图二:</strong>查看 React app。</figcaption></figure><p id="59cb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">检查 react 项目后，我将运行以下命令，将电子和电子构建器库包含到我的项目中。</p><pre class="kj kk kl km gt li lj lk ll aw lm bi"><span id="8ae8" class="ln lo in lj b gy lp lq l lr ls">npm install --save-dev electron<br/>npm install --save-dev electron-builder</span></pre><p id="35d4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">作为集成的第一步，我将在<strong class="jm io"> public </strong>文件夹中创建一个新的 js 文件。这个文件将是我的电子应用程序的入口点，文件名将是<strong class="jm io"> electron.js </strong>。我将在文件中有一些配置，并有可能添加更多。该文件基本上类似于下面的代码。</p><pre class="kj kk kl km gt li lj lk ll aw lm bi"><span id="3100" class="ln lo in lj b gy lp lq l lr ls">const { app, BrowserWindow } = require('electron');</span><span id="ee98" class="ln lo in lj b gy lu lq l lr ls">const path = require('path');</span><span id="8720" class="ln lo in lj b gy lu lq l lr ls">const url = require('url');</span><span id="dbf4" class="ln lo in lj b gy lu lq l lr ls">function createWindow() {</span><span id="6d32" class="ln lo in lj b gy lu lq l lr ls">    const startUrl = process.env.ELECTRON_START_URL || url.format({</span><span id="914d" class="ln lo in lj b gy lu lq l lr ls">        pathname: path.join(__dirname, '../index.html'),</span><span id="c61d" class="ln lo in lj b gy lu lq l lr ls">        protocol: 'file:',</span><span id="d98f" class="ln lo in lj b gy lu lq l lr ls">        slashes: true,</span><span id="f44a" class="ln lo in lj b gy lu lq l lr ls">    });</span><span id="5947" class="ln lo in lj b gy lu lq l lr ls">    const win = new BrowserWindow({</span><span id="2c86" class="ln lo in lj b gy lu lq l lr ls">        width: 800,</span><span id="281e" class="ln lo in lj b gy lu lq l lr ls">        height: 800,</span><span id="9672" class="ln lo in lj b gy lu lq l lr ls">        webPreferences: {</span><span id="7ffe" class="ln lo in lj b gy lu lq l lr ls">            nodeIntegration: true</span><span id="35ab" class="ln lo in lj b gy lu lq l lr ls">        }</span><span id="a145" class="ln lo in lj b gy lu lq l lr ls">    });</span><span id="758c" class="ln lo in lj b gy lu lq l lr ls">    win.loadURL(startUrl);</span><span id="6e74" class="ln lo in lj b gy lu lq l lr ls">    app.on('window-all-closed', () =&gt; {</span><span id="136f" class="ln lo in lj b gy lu lq l lr ls">        if (process.platform !== 'darwin') {</span><span id="ace2" class="ln lo in lj b gy lu lq l lr ls">            app.quit()</span><span id="6286" class="ln lo in lj b gy lu lq l lr ls">        }</span><span id="ad99" class="ln lo in lj b gy lu lq l lr ls">    });</span><span id="6eff" class="ln lo in lj b gy lu lq l lr ls">}<br/></span><span id="02bf" class="ln lo in lj b gy lu lq l lr ls">app.whenReady().then(createWindow);</span><span id="c94e" class="ln lo in lj b gy lu lq l lr ls">app.on('window-all-closed', () =&gt; {</span><span id="9a83" class="ln lo in lj b gy lu lq l lr ls">    if (process.platform !== 'darwin') {</span><span id="0fca" class="ln lo in lj b gy lu lq l lr ls">        app.quit()</span><span id="d27c" class="ln lo in lj b gy lu lq l lr ls">    }</span><span id="090d" class="ln lo in lj b gy lu lq l lr ls">});<br/></span><span id="5acf" class="ln lo in lj b gy lu lq l lr ls">app.on('activate', () =&gt; {</span><span id="6bd6" class="ln lo in lj b gy lu lq l lr ls">    if (BrowserWindow.getAllWindows().length === 0) {</span><span id="1ee1" class="ln lo in lj b gy lu lq l lr ls">        createWindow()</span><span id="43ef" class="ln lo in lj b gy lu lq l lr ls">    }</span><span id="2709" class="ln lo in lj b gy lu lq l lr ls">});</span></pre><p id="be64" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">第二步，我将在<strong class="jm io"> package.json </strong>文件中定义一些配置变量，我将在本地运行/构建应用程序或创建包时使用它们。此外，Package.json 文件的版本号是应用程序的版本号。package.json 里已经有了，如果没有，加一个就好了。</p><p id="5c46" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">主变量的值是新 JS 文件的路径，正如我前面提到的，它是电子应用程序的入口点。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/3a40dcb45ffcce284fa08265647a3451.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oGV7VvHcnSTM5KyhUEmaLQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated"><strong class="bd lh">截图三:</strong> Package.json</figcaption></figure><p id="b2e0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这三个新字段之后，我将更新 package.json 文件中的脚本部分。首先，我将更新我的启动脚本，因为我不想在本地运行应用程序时打开浏览器窗口。然后我会添加以下三个字段。我将在运行电子应用程序、在本地创建包和在 GitHub 上发布包时使用这些字段。</p><pre class="kj kk kl km gt li lj lk ll aw lm bi"><span id="cb06" class="ln lo in lj b gy lp lq l lr ls"><strong class="lj io">"start-electron":</strong> "export ELECTRON_START_URL=http://localhost:3000 &amp;&amp; electron ."</span><span id="e745" class="ln lo in lj b gy lu lq l lr ls"><strong class="lj io">"package":</strong> "electron-builder build --mac --win -c.extraMetadata.main=build/electron.js --publish never"</span><span id="85ea" class="ln lo in lj b gy lu lq l lr ls"><strong class="lj io">"publish": </strong>"electron-builder build --mac --win --publish always"</span></pre><p id="8cf7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">对于 windows，电子启动命令应该如下所示。</p><pre class="kj kk kl km gt li lj lk ll aw lm bi"><span id="912e" class="ln lo in lj b gy lp lq l lr ls"><strong class="lj io">"start-electron":</strong> "set ELECTRON_START_URL=http://localhost:3000 &amp;&amp; electron ."</span></pre><p id="60c6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我的脚本部分的屏幕截图如下。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lw"><img src="../Images/4f9a363e24830e608217b7fcb00f8889.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jHsJ7Oredkq9Jc0ZPptYsw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated"><strong class="bd lh">截图 4: </strong>脚本部分。</figcaption></figure><p id="6fd7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">作为最后一个配置步骤，我将把以下 json 部分添加到 package.json 文件中。当我想在 Github 上发布一个新的包时，我会使用这个部件。在 json 文件中，owner 和 repository 字段应该用您的存储库和帐户信息进行更新。如果您的存储库是私有的，那么您应该使用【T2 私有:真字段。如果您的存储库是公共的，那么您可以跳过这个字段。此外，您应该有一个存储库的访问令牌。您应该将它传递给<strong class="jm io"> Mac/publish/token </strong>字段和<strong class="jm io"> win/publish/token </strong>字段。</p><pre class="kj kk kl km gt li lj lk ll aw lm bi"><span id="9719" class="ln lo in lj b gy lp lq l lr ls">"build": {</span><span id="c039" class="ln lo in lj b gy lu lq l lr ls">    "mac": {</span><span id="4bca" class="ln lo in lj b gy lu lq l lr ls">        "publish": {</span><span id="8fe6" class="ln lo in lj b gy lu lq l lr ls">            "provider": "github",</span><span id="20ff" class="ln lo in lj b gy lu lq l lr ls">            "owner": "Github Owner",</span><span id="61e7" class="ln lo in lj b gy lu lq l lr ls">            "repo": "Repository Name",</span><span id="e00c" class="ln lo in lj b gy lu lq l lr ls">            "private": true,</span><span id="6f94" class="ln lo in lj b gy lu lq l lr ls">            "token": ""</span><span id="4a1c" class="ln lo in lj b gy lu lq l lr ls">        }</span><span id="af95" class="ln lo in lj b gy lu lq l lr ls">    },</span><span id="7b78" class="ln lo in lj b gy lu lq l lr ls">    "win": {</span><span id="32f3" class="ln lo in lj b gy lu lq l lr ls">        "publish": {</span><span id="55e9" class="ln lo in lj b gy lu lq l lr ls">            "provider": "github",</span><span id="46bc" class="ln lo in lj b gy lu lq l lr ls">            "owner": "Github Owner",</span><span id="9290" class="ln lo in lj b gy lu lq l lr ls">            "repo": "Repository Name",</span><span id="d4d6" class="ln lo in lj b gy lu lq l lr ls">            "private": true,</span><span id="9359" class="ln lo in lj b gy lu lq l lr ls">            "token": ""</span><span id="46a0" class="ln lo in lj b gy lu lq l lr ls">        }</span><span id="2044" class="ln lo in lj b gy lu lq l lr ls">    },</span><span id="1501" class="ln lo in lj b gy lu lq l lr ls">    "files": [</span><span id="3672" class="ln lo in lj b gy lu lq l lr ls">        "build/**/*",</span><span id="961d" class="ln lo in lj b gy lu lq l lr ls">        "node_modules/**/*"</span><span id="23ee" class="ln lo in lj b gy lu lq l lr ls">    ],</span><span id="a85e" class="ln lo in lj b gy lu lq l lr ls">    "publish": {</span><span id="528d" class="ln lo in lj b gy lu lq l lr ls">        "provider": "github",</span><span id="de07" class="ln lo in lj b gy lu lq l lr ls">        "private": true,</span><span id="513c" class="ln lo in lj b gy lu lq l lr ls">        "owner": "Github Owner"</span><span id="a517" class="ln lo in lj b gy lu lq l lr ls">    }</span><span id="6bc4" class="ln lo in lj b gy lu lq l lr ls">}</span></pre><p id="f714" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">搞定了！让我们试着测试一下。</p><p id="8833" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在本地运行；</p><pre class="kj kk kl km gt li lj lk ll aw lm bi"><span id="cf74" class="ln lo in lj b gy lp lq l lr ls">npm start<br/>npm run start-electron</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lx"><img src="../Images/9548d17018985ce5617e38a3a81fdc80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cwnTjqA-Q5tLyF4bM7JdGA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated"><strong class="bd lh">截图 5: </strong>本地 Electon App</figcaption></figure><p id="70b7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">创建本地包；</p><pre class="kj kk kl km gt li lj lk ll aw lm bi"><span id="ee95" class="ln lo in lj b gy lp lq l lr ls">npm run build<br/>npm run package</span></pre><p id="4930" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">运行以上命令后，构建将出现在<strong class="jm io">项目的 root/dist </strong>文件夹中。一个样本截图如下。另外，给<strong class="jm io">添加一个 dist 文件夹也很好。gitignore </strong>文件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ly"><img src="../Images/ec4f04de4d13c399ce92ca9ce5857d99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ntUWglWZvvO315tGrFTyDg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated"><strong class="bd lh">截图 6: </strong>本地构建。</figcaption></figure><p id="5416" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在 Github 上发布一个包；</p><pre class="kj kk kl km gt li lj lk ll aw lm bi"><span id="e9e4" class="ln lo in lj b gy lp lq l lr ls">npm run build<br/>npm run publish</span></pre><p id="8324" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">运行上述命令后，该包将出现在存储库中的 Releases 部分。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/9ed262faad7ad843e12a5066415ae1ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*P69qedMig2LuMxHxF_7k_Q.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated"><strong class="bd lh">截图 7: </strong> Github 发布</figcaption></figure><p id="1a28" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae ku" href="https://github.com/cinarrtolga/ART-React-Electron-App" rel="noopener ugc nofollow" target="_blank">这里的</a>是教程的源代码。</p><p id="5d40" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我试图分享基本的反应电子集成。希望这能有所帮助。:)我打算写第二个关于这个主题的教程，分享如何自动更新，创建闪屏和一些基本的配置更改。</p><p id="e5ed" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如有任何补充或错误信息，请联系我。</p></div></div>    
</body>
</html>