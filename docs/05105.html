<html>
<head>
<title>Pushing Objects in Unity to Complete Puzzles</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">推动物体完成拼图</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/pushing-objects-in-unity-to-complete-puzzles-8181fd4a77d1?source=collection_archive---------1-----------------------#2021-06-17">https://blog.devgenius.io/pushing-objects-in-unity-to-complete-puzzles-8181fd4a77d1?source=collection_archive---------1-----------------------#2021-06-17</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="2b02" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">推动刚体并激活压力触发器。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/d13927b6f390814dc779b548f2719bf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*5TvSVo2DXePXJakyPMvEVQ.gif"/></div></div></figure><p id="6ad5" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我想实现的下一件事是增加在我的游戏中推动盒子来激活触发器的能力。</p><h1 id="6f9b" class="lk ll in bd lm ln lo lp lq lr ls lt lu jt lv ju lw jw lx jx ly jz lz ka ma mb bi translated">推动刚体</h1><p id="3ae8" class="pw-post-body-paragraph ko kp in kq b kr mc jo kt ku md jr kw kx me kz la lb mf ld le lf mg lh li lj ig bi translated">幸运的是，Unity文档中有这样一个例子。</p><div class="mh mi gp gr mj mk"><a href="https://docs.unity3d.com/2021.1/Documentation/ScriptReference/CharacterController.OnControllerColliderHit.html" rel="noopener  ugc nofollow" target="_blank"><div class="ml ab fo"><div class="mm ab mn cl cj mo"><h2 class="bd io gy z fp mp fr fs mq fu fw im bi translated">角色控制器。OnControllerColliderHit(控制器碰撞)</h2><div class="mr l"><h3 class="bd b gy z fp mp fr fs mq fu fw dk translated">使用UnityEngine公共类示例:MonoBehaviour { //这个脚本将角色…</h3></div><div class="ms l"><p class="bd b dl z fp mp fr fs mq fu fw dk translated">docs.unity3d.com</p></div></div><div class="mt l"><div class="mu l mv mw mx mt my km mk"/></div></div></a></div><p id="f19f" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在这个例子中，他们使用刚体推动物体，确保他们没有推动物体下方的物体，而是在X和Z方向上移动物体。我只需要担心X轴。我要把它分解成我行为的步骤。我也要做一个单独的方法来处理刚体的推动。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mz"><img src="../Images/ede36215980b53ce6f928f44cd7ab9d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*1auNcgUm4hyoY4L4otJhKw.gif"/></div></div></figure><p id="9a8d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我在我的场景中有一个可移动的盒子，没有什么特别的，它有刚体组件，位置冻结在Z轴上(所以它不会离开平台，Y轴上的旋转也冻结了(以防止它在Y轴上旋转)，还有一个盒子碰撞器。然后我有了一个视觉上的孩子。子对象只是让我能够很容易地把它换成不同的视觉效果。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi na"><img src="../Images/8fa4bc385e259a869e7944716103dbe4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*zWx0wIHOlCDy3VT-6OczZg.gif"/></div></div></figure><p id="8e35" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在我已经设置了可移动的盒子，我可以用我的播放器来推动它。</p><p id="01e5" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果没有刚体或者刚体是运动学的，我退出这个方法。</p><p id="9ce5" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">然后我确定我没有在我想要推动的物体上方。</p><p id="ee01" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我根据x轴上的移动方向计算移动方向。</p><p id="cc34" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">然后我将刚体的速度设置为移动方向乘以推力。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nb"><img src="../Images/98a5afbd105eb47cc7fffc1901347f68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*dt75NQjRa8q-5hZvtXT8zg.gif"/></div></div></figure><p id="4d65" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在这在行动。注意刚体约束的不同效果。如果我有一个更大的盒子要推，我可能会冻结X轴上的旋转</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/7bd5cfc7a70f5e680f4ee1862d94ec1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/1*LcVmQuRfbOHXgEOowacRlQ.gif"/></div></figure><p id="69d4" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我也没有考虑物体的质量，当我推它的时候，我唯一能控制的方法就是通过阻力的大小。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nd"><img src="../Images/7234351b4ae30f6a84fd8c3610d82927.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*II_ZkSOEJBfji92KDCd8cw.gif"/></div></div></figure><p id="d51e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">因为我经常使用hit.rigidbody，所以我决定缓存它。</p><p id="0bba" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我创建了一个变量来保存推力计算。我检查刚体质量是否大于0，如果是，我用它来计算，如果不是，我用0.1来计算。我把它除以推力。然后我在计算中使用这个新变量。我也给玩家的推力增加了射程属性，防止它低于0.1</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ne"><img src="../Images/d2277d4f17545ee2244bb9a0f92fc292.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*ow8zP6yXO2dpv72BfrOIrQ.gif"/></div></div></figure><p id="2099" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">推动不同质量的箱子。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nf"><img src="../Images/f2bf21715f324284b281da035a91906a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*2Id1md8Tszq98bBKMCKaxA.gif"/></div></div></figure><p id="fff1" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">看来我的数学退步了。我需要把推力除以质量。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ng"><img src="../Images/b64066b7f4663424439e2ca69d954be5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*e5INs5sKXZ07v_ABbWUVmw.gif"/></div></div></figure><p id="6b6c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在我在推物体的时候，考虑了物体的质量。我也可以让我的性格变得更坚强。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nh"><img src="../Images/c631286e3e9f821bf3d123fbc61eb803.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*nXz4tyYI6OQSBkdr3qp6Lg.gif"/></div></div></figure><h1 id="5128" class="lk ll in bd lm ln lo lp lq lr ls lt lu jt lv ju lw jw lx jx ly jz lz ka ma mb bi translated">激活压力垫</h1><p id="f68b" class="pw-post-body-paragraph ko kp in kq b kr mc jo kt ku md jr kw kx me kz la lb mf ld le lf mg lh li lj ig bi translated">有几种不同的方式能够激活压力垫。一些游戏让玩家激活它，它被视为一个开关，一些游戏允许玩家在踩上它时激活它，在玩家离开它时停用它，要求玩家在游戏世界中找到一个物体按住它，其他游戏让它激活一个计时器，允许玩家以不同的方式与游戏世界互动。一些游戏通过它的重量来激活它。有些游戏综合了以上所有因素。不管压力垫是如何激活的，基本原理都差不多。</p><p id="47c0" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">对于这个游戏，我得到的指示是，一旦可移动的盒子完全在上面，或者至少足够远，可移动的盒子应该停止移动，一些事件应该发生，就激活压力垫。</p><p id="6e41" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我缓存了我想要激活这个触发器的对象的标签字符串。如果一个激活对象进入了触发器，我也有一个bool。</p><p id="c9e7" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在On Trigger Enter方法中，我检查进入这个触发器的对象是否是激活对象，如果是，我将bool设置为true。在On Trigger Exit方法中，我检查退出该触发器的对象是否是激活对象，如果是，我将bool设置为false。在更新方法中，我检查是否有激活对象。如果不是，我退出这个方法。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ni"><img src="../Images/2e73c1f132f85d21bae35a78fda854ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*BoMhK0XyLOmwqmGRJyNnLA.gif"/></div></div></figure><p id="1715" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我需要知道压力垫的位置。我确保在Start方法中缓存它。我还需要一个半径，因为我希望可移动的物体在接触之前大部分都在面板上。我还需要activator对象的转换，所以我在On Trigger Enter方法中得到它。我还在On Trigger Exit中将它设置为null。在更新方法中，如果我有一个activator对象，那么我检查它在X轴上的位置，与压力垫的位置进行比较，如果它不在半径范围内，我退出该方法。我也可以使用Vector3。这个平台的距离或光线投射。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nj"><img src="../Images/fe4d76679c08b3b79011335c4dee13b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*X-Op64yXF-fXJ_m1pXcFwA.gif"/></div></div></figure><p id="9219" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在Unity中，我确保将可移动对象的标签设置为压力激活器。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nk"><img src="../Images/5f2d57d6856b8f7429f83b7fa35834a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*6uDEcRgv4p6ajCWi3-LxQw.gif"/></div></div></figure><p id="f1ea" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果activator对象足够近，我将has activation对象设置为true，这样更新逻辑就不会运行下一帧。得到激活物体的刚体。如果它有一个，我设置运动学为真。我将激活器变换位置设置为压力垫的位置。我将激活器转换设置为空。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nl"><img src="../Images/1a62a26164b477e8e8e551360b8734c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*2T91tG9b8j_eHGOSRHe8Ng.gif"/></div></div></figure><p id="8f41" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我创建了一个Unity事件，如果它不为空，我就调用它。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nm"><img src="../Images/ad3189cfc39735152a98f51af3fd2cb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*hp8RMPku2aqRI3VZ1Jxzmg.gif"/></div></div></figure><p id="2f4e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在Unity中，我设置了压力垫的激活事件来改变材质。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nn"><img src="../Images/63e76239b5d3d651e4a77220d4ead323.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*vZCtbo2auvVMMR_02Q4l6g.gif"/></div></div></figure><p id="5b0b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在我创造了一个玩家无法通过的条件。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi no"><img src="../Images/50a3bbe628f1763bc7cb42c6c327a356.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*6LfQh4Moe3aTUXDaei3Hhw.gif"/></div></div></figure><p id="007d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">为了解决这个问题，我将激活的对象变换的旋转设置为相同。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi np"><img src="../Images/4744156fb506dd1312d0e87ee5c1a831.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*2YMRE6oGGaboG5G24iND-g.gif"/></div></div></figure><p id="e38c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在我有一个工作压力垫。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/d13927b6f390814dc779b548f2719bf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*5TvSVo2DXePXJakyPMvEVQ.gif"/></div></div></figure></div></div>    
</body>
</html>