<html>
<head>
<title>Javascript and the event loop</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Javascript 和事件循环</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/javascript-and-the-event-loop-2bc6d7594971?source=collection_archive---------3-----------------------#2022-09-07">https://blog.devgenius.io/javascript-and-the-event-loop-2bc6d7594971?source=collection_archive---------3-----------------------#2022-09-07</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/b685fe7289ae131b2a20a695661d1e33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_jLMsU1kyQ2EZXFg7b7PQQ.png"/></div></div></figure><p id="e84e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">关于 Javascript、执行的生命周期、事件循环和示例的介绍性文章。</p><h1 id="0721" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">Javascript 解释器</h1><p id="af1f" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">也称为 Javascript 引擎。它是一个可以在运行时分析和处理源代码的计算机程序。完全消除了其他编程语言中的编译过程。</p><p id="d54b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">今天最著名的 Javascript 引擎之一是著名的<strong class="jx io"> V8 </strong>引擎，内置于谷歌 Chrome 浏览器并包含在 Nodejs 中。</p><p id="017b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">V8 发动机的操作架构如下:</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lw"><img src="../Images/a359e4a29660a066c08852b8dd1e648b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RLbK8nM3pfLWPu4qIUaWww.png"/></div></div></figure><p id="3b1a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">架构元素:</p><ul class=""><li id="f0a7" class="mb mc in jx b jy jz kc kd kg md kk me ko mf ks mg mh mi mj bi translated"><strong class="jx io">内存堆</strong> : Javascript 内存管理器。</li><li id="9126" class="mb mc in jx b jy mk kc ml kg mm kk mn ko mo ks mg mh mi mj bi translated"><strong class="jx io">调用栈</strong>:函数和任务的调用栈。</li></ul><h1 id="4bb6" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">在单线程上工作</h1><p id="6dc3" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">我们必须强调，Javascript 只适用于单个线程。这是因为浏览器默认只占用一个主线程来执行所有的 Javascript。因此 Javascript 被限制为一次只能运行一个任务。</p><p id="c1be" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">因此，Javascript 使用非阻塞异步模型。这个模型使用它在网络上执行多种操作，处理用户交互，同时保持平滑的界面。</p><p id="629b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">重要的是不要阻塞主线程，因为它是我们执行任务的唯一线程。如果我们阻止它，就有可能堵塞我们的系统。</p><p id="10a2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">注意:</strong>有一个规范叫做 web workers，它允许我们在 Javascript 中创建多线程，但本文并不涉及它。</p><h1 id="6b5a" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">非阻塞异步模型</h1><p id="42b6" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">为了能够以非阻塞的异步方式编程，我们需要依赖 Javascript 引擎外部的特性，这些特性是由 web 浏览器提供的。Javascript 语言的操作是基于引擎<strong class="jx io"> + </strong> web API 的总和。</p><p id="7f19" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">V8 引擎和导航器包含以下操作架构:</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/2a5e10f2abb4c5a2dfffcc74d3eb9f59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HrMx8rJ85EhGEVo-JBnAkA.png"/></div></figure><p id="da8e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">架构元素:</p><ul class=""><li id="5a3e" class="mb mc in jx b jy jz kc kd kg md kk me ko mf ks mg mh mi mj bi translated"><strong class="jx io">Web API</strong>:浏览器提供的一组 API。</li><li id="26cb" class="mb mc in jx b jy mk kc ml kg mm kk mn ko mo ks mg mh mi mj bi translated"><strong class="jx io">回调队列</strong>:浏览器解析的代码队列。</li><li id="77c5" class="mb mc in jx b jy mk kc ml kg mm kk mn ko mo ks mg mh mi mj bi translated"><strong class="jx io">事件循环</strong>:验证和转移机制。</li></ul><p id="c365" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">提到浏览器提供的所有功能都将在另一个线程中执行，并且绝大多数是以异步方式执行的。同时，它与事件循环协作，以免阻塞在主线程中执行的调用堆栈。</p><h1 id="5f91" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">事件循环和回调队列</h1><p id="6b91" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">这两个特性基本上是引擎和浏览器 API 之间的连接桥梁。回调队列负责解析，而事件循环负责验证和分派返回代码。</p><p id="2210" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">执行周期如下:</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mq"><img src="../Images/e06e9b8c2f3b9d531a16a359d0658270.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RtnZO0r3urHFSFuOTnP6Zg.png"/></div></div></figure><h2 id="a523" class="mr ku in bd kv ms mt dn kz mu mv dp ld kg mw mx lh kk my mz ll ko na nb lp nc bi translated">运行周期示例</h2><p id="e8eb" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">在下面的例子中，我们将使用一个属于浏览器的 web APIS 的定时器，名为 setTimeout。这将在 1 秒钟后执行一个代码。</p><pre class="lx ly lz ma gt nd ne nf ng aw nh bi"><span id="6df1" class="mr ku in ne b gy ni nj l nk nl">console.log('Execution 1');</span><span id="981a" class="mr ku in ne b gy nm nj l nk nl">setTimeout(() =&gt; {<br/>  console.log('Execution 2');<br/>}, 1000);</span><span id="e9b8" class="mr ku in ne b gy nm nj l nk nl">console.log('Execution3');</span></pre><p id="c24f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这段代码的结果是:</p><pre class="lx ly lz ma gt nd ne nf ng aw nh bi"><span id="6e62" class="mr ku in ne b gy ni nj l nk nl">Execution 1<br/>Execution 3<br/>Execution 2</span></pre><h2 id="8d85" class="mr ku in bd kv ms mt dn kz mu mv dp ld kg mw mx lh kk my mz ll ko na nb lp nc bi translated">结果解释</h2><ol class=""><li id="07e3" class="mb mc in jx b jy lr kc ls kg nn kk no ko np ks nq mh mi mj bi translated">setTimeout 是异步处理的，而主线程运行其执行任务的过程。</li><li id="b9d1" class="mb mc in jx b jy mk kc ml kg mm kk mn ko mo ks nq mh mi mj bi translated">一旦异步操作被解决，它就被传递给队列回调。</li><li id="e742" class="mb mc in jx b jy mk kc ml kg mm kk mn ko mo ks nq mh mi mj bi translated">回调队列必须等待事件循环来检测调用堆栈是否繁忙。</li><li id="7e60" class="mb mc in jx b jy mk kc ml kg mm kk mn ko mo ks nq mh mi mj bi translated">一旦调用堆栈不忙，事件循环就会传递解决代码。</li></ol><p id="ae19" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这里有一个动画示例:</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nr"><img src="../Images/3bafa766f00cc886258182fde236f59d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*BhmBVIpJStEhVDD43CElFQ.gif"/></div></div></figure><h1 id="2854" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">Javascript 资源和事件循环</h1><ul class=""><li id="4b8c" class="mb mc in jx b jy lr kc ls kg nn kk no ko np ks mg mh mi mj bi translated"><a class="ae ns" href="https://www.youtube.com/watch?v=8aGhZQkoFbQ" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">讲解事件循环视频</strong> </a>:菲利普·罗伯茨在 JSconf 的演讲。</li><li id="8659" class="mb mc in jx b jy mk kc ml kg mm kk mn ko mo ks mg mh mi mj bi translated"><a class="ae ns" href="https://developer.mozilla.org/en-US/docs/Web/API" rel="noopener ugc nofollow" target="_blank"><strong class="jx io">Web API 文档</strong></a>:Web API 及特性列表。</li><li id="cf7a" class="mb mc in jx b jy mk kc ml kg mm kk mn ko mo ks mg mh mi mj bi translated"><a class="ae ns" href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> Web workers 规范</strong> </a>:后台运行的文档和特性。</li></ul></div><div class="ab cl nt nu hr nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="ig ih ii ij ik"><p id="3e2a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">感谢你远道而来，如果你觉得这很有用，别忘了鼓掌👏。订阅以接收更多内容🔔。</p><p id="532c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果你需要额外的帮助，请联系我🤠。</p><ul class=""><li id="60b4" class="mb mc in jx b jy jz kc kd kg md kk me ko mf ks mg mh mi mj bi translated">✉️ <a class="ae ns" href="mailto:dcortes.net@gmail.com" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">给我发邮件</strong> </a></li><li id="323a" class="mb mc in jx b jy mk kc ml kg mm kk mn ko mo ks mg mh mi mj bi translated">🤝<a class="ae ns" href="https://www.linkedin.com/in/dcortesnet/" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">在 LinkedIn 上联系我</strong> </a></li><li id="cbe1" class="mb mc in jx b jy mk kc ml kg mm kk mn ko mo ks mg mh mi mj bi translated">📮<a class="ae ns" href="https://twitter.com/dcortes_net" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">在推特上联系我</strong> </a></li></ul><p id="3336" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">非常感谢您的阅读，我感谢您的时间。</p></div></div>    
</body>
</html>