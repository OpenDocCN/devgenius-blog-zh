<html>
<head>
<title>Preact — Create Web Component and Server Side Rendering</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Preact —创建 Web 组件和服务器端呈现</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/preact-create-web-component-and-server-side-rendering-21e6c2e4d165?source=collection_archive---------1-----------------------#2021-02-13">https://blog.devgenius.io/preact-create-web-component-and-server-side-rendering-21e6c2e4d165?source=collection_archive---------1-----------------------#2021-02-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c71c2a4e2dbb8c6b351500467e3ded8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lCz19oX1QIMywu1p"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://unsplash.com/@lefterisk?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">左 eris kallergis </a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><p id="5971" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Preact 是一个前端 web 框架，类似于 react。</p><p id="cee5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它比 React 小，也不复杂。</p><p id="ced6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解如何开始使用 Preact 进行前端开发。</p><h1 id="b7ed" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">创建 Web 组件</h1><p id="8f03" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用<code class="fe me mf mg mh b">preact-custom-element</code>包将 Preact 组件转换成 web 组件。</p><p id="70ec" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="4533" class="mq lc iq mh b gy mr ms l mt mu">import { render } from "preact";<br/>import register from "preact-custom-element";</span><span id="03f1" class="mq lc iq mh b gy mv ms l mt mu">const Greeting = ({ name = "World" }) =&gt; &lt;p&gt;Hello, {name}!&lt;/p&gt;;</span><span id="a038" class="mq lc iq mh b gy mv ms l mt mu">register(Greeting, "x-greeting", ["name"]);</span><span id="636d" class="mq lc iq mh b gy mv ms l mt mu">export default function App() {<br/>  return &lt;x-greeting name="Jane"&gt;&lt;/x-greeting&gt;;<br/>}</span><span id="97c4" class="mq lc iq mh b gy mv ms l mt mu">if (typeof window !== "undefined") {<br/>  render(&lt;App /&gt;, document.getElementById("root"));<br/>}</span></pre><p id="456d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">导入<code class="fe me mf mg mh b">register</code>函数，将我们的 Preact 组件注册为 web 组件。</p><p id="d34e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有一个<code class="fe me mf mg mh b">Greeting</code>组件，我们将它注册为<code class="fe me mf mg mh b">x-greeting</code>定制元素。</p><p id="724f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第三个参数具有<code class="fe me mf mg mh b">x-greeting</code>所取的属性，即<code class="fe me mf mg mh b">name</code>属性。</p><p id="2f37" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它将被插入到<code class="fe me mf mg mh b">Greeting</code>中的<code class="fe me mf mg mh b">p</code>元素中，就像我们使用常规的 Preact 组件一样。</p><p id="347e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe me mf mg mh b">App</code>中，我们使用带有<code class="fe me mf mg mh b">name</code>道具集的<code class="fe me mf mg mh b">x-greeting</code> web 组件。</p><p id="d394" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们看到:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="b108" class="mq lc iq mh b gy mr ms l mt mu">Hello, Jane!</span></pre><p id="9e0f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">已显示。</p><h1 id="5ef7" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">观察到的属性</h1><p id="bcc2" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们必须使属性可观察，以便它可以响应值的变化。</p><p id="95b0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了使它们可见，我们可以这样写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="9975" class="mq lc iq mh b gy mr ms l mt mu">import { Component, render } from "preact";<br/>import register from "preact-custom-element";</span><span id="71e1" class="mq lc iq mh b gy mv ms l mt mu">class Greeting extends Component {<br/>  static tagName = "x-greeting";<br/>  static observedAttributes = ["name"];</span><span id="f7af" class="mq lc iq mh b gy mv ms l mt mu">  render({ name }) {<br/>    return &lt;p&gt;Hello, {name}!&lt;/p&gt;;<br/>  }<br/>}<br/>register(Greeting);</span><span id="85a6" class="mq lc iq mh b gy mv ms l mt mu">export default function App() {<br/>  return &lt;x-greeting name="Jane"&gt;&lt;/x-greeting&gt;;<br/>}</span><span id="5c9b" class="mq lc iq mh b gy mv ms l mt mu">if (typeof window !== "undefined") {<br/>  render(&lt;App /&gt;, document.getElementById("root"));<br/>}</span></pre><p id="205f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们创建了我们的<code class="fe me mf mg mh b">Greeting</code>组件。</p><p id="526c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们设置<code class="fe me mf mg mh b">tagName</code>静态属性来设置它的标签名。</p><p id="7398" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将<code class="fe me mf mg mh b">observedAttributes</code>设置为要观察的属性名数组。</p><p id="2aed" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe me mf mg mh b">App</code>中，我们以同样的方式使用<code class="fe me mf mg mh b">x-greeting</code>组件。</p><p id="c153" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果没有指定<code class="fe me mf mg mh b">observableAttributes</code>，那么属性的数据类型将从<code class="fe me mf mg mh b">propTypes</code>的键中推断出来。</p><p id="661c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">设置<code class="fe me mf mg mh b">propTypes</code>将使它们可被观察到。</p><p id="4838" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，如果我们有:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="d9ae" class="mq lc iq mh b gy mr ms l mt mu">import { render } from "preact";<br/>import register from "preact-custom-element";</span><span id="c3ef" class="mq lc iq mh b gy mv ms l mt mu">function FullName({ first, last }) {<br/>  return (<br/>    &lt;span&gt;<br/>      {first} {last}<br/>    &lt;/span&gt;<br/>  );<br/>}</span><span id="e6ae" class="mq lc iq mh b gy mv ms l mt mu">FullName.propTypes = {<br/>  first: Object,<br/>  last: Object<br/>};</span><span id="2da7" class="mq lc iq mh b gy mv ms l mt mu">register(FullName, "full-name");<br/>export default function App() {<br/>  return &lt;full-name first="Jane" last="Smith"&gt;&lt;/full-name&gt;;<br/>}</span><span id="47d3" class="mq lc iq mh b gy mv ms l mt mu">if (typeof window !== "undefined") {<br/>  render(&lt;App /&gt;, document.getElementById("root"));<br/>}</span></pre><p id="70a5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将<code class="fe me mf mg mh b">first</code>和<code class="fe me mf mg mh b">last</code>道具类型设置为<code class="fe me mf mg mh b">Object</code>，它们将变得可以被观察到。</p><h1 id="79e1" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">服务器端渲染</h1><p id="e4cc" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以将 Preact 组件呈现为字符串。</p><p id="5e4f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这让我们可以在服务器端呈现内容，这对提高性能很有用。</p><p id="fcc4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="75a7" class="mq lc iq mh b gy mr ms l mt mu">import render from "preact-render-to-string";</span><span id="3a66" class="mq lc iq mh b gy mv ms l mt mu">const App = &lt;div class="foo"&gt;content&lt;/div&gt;;</span><span id="7481" class="mq lc iq mh b gy mv ms l mt mu">console.log(render(App));</span></pre><p id="6c3c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">render</code>将<code class="fe me mf mg mh b">App</code>组件呈现为一个字符串。</p><p id="a528" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们应该看到:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="1d99" class="mq lc iq mh b gy mr ms l mt mu">&lt;div class="foo"&gt;content&lt;/div&gt;</span></pre><p id="6a01" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">记录在控制台日志中。</p><h1 id="c1e4" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="c97c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以从 Preact 组件创建 web 组件。</p><p id="759d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以将组件呈现为字符串。</p></div></div>    
</body>
</html>