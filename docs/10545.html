<html>
<head>
<title>Sending AJAX Request With JWT Token To Access ADABAS REST Web Services</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">发送带有 JWT 令牌的 AJAX 请求来访问 ADABAS REST Web 服务</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/sending-ajax-request-with-jwt-token-to-access-adabas-rest-web-services-28baa254e9ae?source=collection_archive---------2-----------------------#2022-11-10">https://blog.devgenius.io/sending-ajax-request-with-jwt-token-to-access-adabas-rest-web-services-28baa254e9ae?source=collection_archive---------2-----------------------#2022-11-10</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="a8e5" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">REST、JWT 和 AJAX 的实际例子</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/357ddd4c91f0e95e09822154e9e96166.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*X8uq_i0sitLNEHLo"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">帕万·特里库塔姆在<a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="9153" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">REST(<strong class="kv io">RE</strong>presentational<strong class="kv io">S</strong>tate<strong class="kv io">T</strong>transfer)是由<a class="ae ks" href="https://dl.acm.org/doi/10.5555/932295" rel="noopener ugc nofollow" target="_blank"> Fielding (2000) </a>创造的一个术语，指的是一种描述 web 环境中客户端和服务器之间的请求/响应消息的架构风格(参见<a class="ae ks" href="https://www.techtarget.com/searchapparchitecture/definition/REST-REpresentational-State-Transfer" rel="noopener ugc nofollow" target="_blank"> TechTarget REST </a>)。REST 请求通常包含以下组件:(1)唯一资源标识符(URI)，(GET、POST PUT 和 DELETE 等方法，(3)头，(4)有效负载和(5)参数(参考<a class="ae ks" href="https://aws.amazon.com/what-is/restful-api/" rel="noopener ugc nofollow" target="_blank"> Amazon Restful API </a>)。REST 还包括一个认证机制来证明发送者的身份，以及一个授权令牌，发送者在访问某些受保护的 API 时必须提供这个令牌。这篇文章展示了一个使用 JWT 令牌发送 AJAX 请求来访问 ADABAS REST web 服务的实例。AJAX 请求将使用 jQuery 实现(参考<a class="ae ks" href="https://api.jquery.com/jQuery.ajax/" rel="noopener ugc nofollow" target="_blank"> jQuery AJAX </a>)，而页面样式采用 Bootstrap 库(参考<a class="ae ks" href="https://getbootstrap.com/docs/5.0/getting-started/introduction/" rel="noopener ugc nofollow" target="_blank"> Bootstrap 介绍</a>)。</p><pre class="kd ke kf kg gt lp lq lr ls aw lt bi"><span id="6349" class="lu lv in lq b gy lw lx l ly lz">PRE-REQUISITE:<br/>(1) ADABAS Server Community Edition (Docker Version). <br/>(2) NATURAL ONE IDE v.9.1.4.<br/>(refer <a class="ae ks" href="https://medium.com/@mohamad.razzi.my/getting-started-with-adabas-natural-part-1-6597688406ad" rel="noopener">here</a> for the <a class="ae ks" href="https://medium.com/@mohamad.razzi.my/getting-started-with-adabas-natural-part-1-6597688406ad" rel="noopener">setup guide</a>).<br/>(3) Postman REST client application.<br/>(4) Firefox web browser with CORS-disabled plugin (refer <a class="ae ks" href="https://addons.mozilla.org/en-US/firefox/addon/cors-everywhere/" rel="noopener ugc nofollow" target="_blank">here</a> for the <a class="ae ks" href="https://addons.mozilla.org/en-US/firefox/addon/cors-everywhere/" rel="noopener ugc nofollow" target="_blank">setup guide</a>)</span></pre><h1 id="8203" class="ma lv in bd mb mc md me mf mg mh mi mj jt mk ju ml jw mm jx mn jz mo ka mp mq bi translated">(1)创建一个动态 Web 项目</h1><p id="7801" class="pw-post-body-paragraph kt ku in kv b kw mr jo ky kz ms jr lb lc mt le lf lg mu li lj lk mv lm ln lo ig bi translated">在 IDE 中，转到菜单并选择文件/新建/其他…然后，在“选择向导”对话框中，选择 Web/动态 Web 项目。单击下一步按钮。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/54134ddb5012241c7f31cbd5f638e203.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*ScEzW1FB285LZa0PV6w54A.png"/></div></figure><p id="2384" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在下一个对话窗口中，开发人员需要指定一个目标运行时。NATURAL ONE IDE 已经捆绑了 Tomcat 版本 9。单击新建运行时。在新的服务器运行时环境窗口中，在服务器列表中选择 Tomcat version 9，单击 Next 按钮。然后，浏览位于自然的 ONE IDE 根文件夹的一个子文件夹中的 Tomcat 包。单击完成按钮。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mx"><img src="../Images/f1009aca77b666f110bfe917a20095e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O6l8LJPjoAEiPU9sBmV-Xg.png"/></div></div></figure><p id="c4c7" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在这个阶段，Apache Tomcat v9.0 已经被设置为目标运行时，动态 web 模块版本已经被设置为 4.0。单击完成按钮。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi my"><img src="../Images/5ef211754e1026380fc77db681f1ebd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/1*l8hcH4ldxT-2rT4x0p0xcw.png"/></div></figure><p id="0317" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">继续使用建议的选项来打开 Java EE 透视图。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi my"><img src="../Images/f6fd8db3b2cc02f0487ba295033e69e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/1*UB8WIay60kzY8FGrjqr3sw.png"/></div></figure><p id="0e55" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">已经创建了一个新项目，其中<strong class="kv io"> WEB1 </strong>作为<strong class="kv io">上下文根</strong>，而<strong class="kv io"> WebContent </strong>作为<strong class="kv io">内容目录</strong>。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/8b0b75564ae056267fb33fdaef48ce08.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*XwMsV6EF1fSusGFmxb0xjg.png"/></div></figure><h1 id="467e" class="ma lv in bd mb mc md me mf mg mh mi mj jt mk ju ml jw mm jx mn jz mo ka mp mq bi translated">(2)创建登录页面</h1><p id="979b" class="pw-post-body-paragraph kt ku in kv b kw mr jo ky kz ms jr lb lc mt le lf lg mu li lj lk mv lm ln lo ig bi translated">右键单击 WebContent 文件夹，选择新建/HTML 文件。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi na"><img src="../Images/4da9d84dcc1e24969666773402f97114.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y1l5msODOuGABxR6JcJXaw.png"/></div></div></figure><p id="9376" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">按如下方式编辑文件。</p><pre class="kd ke kf kg gt lp lq lr ls aw lt bi"><span id="207b" class="lu lv in lq b gy lw lx l ly lz">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>&lt;head&gt;<br/>  &lt;title&gt;Login&lt;/title&gt;<br/>  &lt;meta charset="utf-8"&gt;<br/>  &lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;<br/>  &lt;script src="<a class="ae ks" href="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js" rel="noopener ugc nofollow" target="_blank">https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js</a>"&gt;&lt;/script&gt;<br/>  &lt;link href="<a class="ae ks" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="noopener ugc nofollow" target="_blank">https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css</a>" rel="stylesheet"&gt;<br/>  &lt;script src="<a class="ae ks" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" rel="noopener ugc nofollow" target="_blank">https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js</a>"&gt;&lt;/script&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;</span><span id="4767" class="lu lv in lq b gy nb lx l ly lz">&lt;div class="container mt-3" style="width:400px;"&gt;<br/>  &lt;h2&gt;User login&lt;/h2&gt;<br/>  &lt;div&gt;<br/>    &lt;div class="mb-3 mt-3"&gt;<br/>      &lt;label for="usr"&gt;Username:&lt;/label&gt;<br/>      &lt;input type="text" class="form-control" id="usr" placeholder="Enter username" name="usr"&gt;<br/>    &lt;/div&gt;<br/>    &lt;div class="mb-3"&gt;<br/>      &lt;label for="pwd"&gt;Password:&lt;/label&gt;<br/>      &lt;input type="password" class="form-control" id="pwd" placeholder="Enter password" name="pwd"&gt;<br/>    &lt;/div&gt;</span><span id="73fd" class="lu lv in lq b gy nb lx l ly lz">&lt;button onclick="prepLogin()" class="btn btn-primary"&gt;Login&lt;/button&gt;<br/>  &lt;/div&gt;<br/>&lt;/div&gt;</span><span id="ab8b" class="lu lv in lq b gy nb lx l ly lz">&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="e10e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">保存。</p><p id="df62" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">运行项目，即右键单击项目，选择运行方式/在服务器上运行。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nc"><img src="../Images/df2808749c6d028651d42520efa984f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*27Dh-yRt8IB-KTTOOKcCWA.png"/></div></div></figure><p id="0a3f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">IDE 可能会要求选择服务器。确认选择 Tomcat v9.0 服务器，然后单击 Finish。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/d4b5a5c2b7a36d930d3b7f1d2069bc5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/format:webp/1*DCIHT-kueXSU4xifkLV5bg.png"/></div></figure><p id="7352" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">登录页面可以通过网址<a class="ae ks" href="https://localhost:8080/WEB1/login.html" rel="noopener ugc nofollow" target="_blank">https://localhost:8080/web 1/log in . html</a>浏览。如今，大多数网络浏览器都有阻止 AJAX 功能的 CORS 保护。建议使用带有<a class="ae ks" href="https://addons.mozilla.org/en-US/firefox/addon/cors-everywhere/" rel="noopener ugc nofollow" target="_blank"> CORS 禁用插件</a>的 Firefox 来测试该项目的网页。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ne"><img src="../Images/df2e06770eff48d807be7818400f5606.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D_lUBdx96odencr4AxCBdg.png"/></div></div></figure><p id="b8b0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">接下来，添加 JavaScript 代码。将增加两个功能，即<strong class="kv io"> prepLogin() </strong>和<strong class="kv io"> reqsLogin() </strong>。<strong class="kv io"> prepLogin() </strong>将获得用户名和密码的输入。输入将被编码为 base64 字符串，以遵循基本的 REST auth 格式。编码后的字符串将被发送到函数<strong class="kv io"> reqsLogin() </strong>。函数<strong class="kv io"> reqsLogin() </strong>将把编码后的字符串附加到 XHR 对象上，然后向服务器发送一个请求。在本练习中，服务器将是运行在端口 8190 上的 ADABAS REST 服务(参见<a class="ae ks" href="https://medium.com/@mohamad.razzi.my/getting-started-with-adabas-natural-part-1-6597688406ad" rel="noopener">设置指南</a>中的<a class="ae ks" href="https://medium.com/@mohamad.razzi.my/getting-started-with-adabas-natural-part-1-6597688406ad" rel="noopener">)。</a></p><pre class="kd ke kf kg gt lp lq lr ls aw lt bi"><span id="c4f6" class="lu lv in lq b gy lw lx l ly lz">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>&lt;head&gt;<br/>  &lt;title&gt;Login&lt;/title&gt;<br/>  &lt;meta charset="utf-8"&gt;<br/>  &lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;<br/>  &lt;script src="<a class="ae ks" href="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js" rel="noopener ugc nofollow" target="_blank">https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js</a>"&gt;&lt;/script&gt;  <br/>  &lt;link href="<a class="ae ks" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="noopener ugc nofollow" target="_blank">https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css</a>" rel="stylesheet"&gt;<br/>  &lt;script src="<a class="ae ks" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" rel="noopener ugc nofollow" target="_blank">https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js</a>"&gt;&lt;/script&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;</span><span id="983b" class="lu lv in lq b gy nb lx l ly lz">&lt;div class="container mt-3" style="width:400px;"&gt;<br/>  &lt;h2&gt;User login&lt;/h2&gt;<br/>  &lt;div&gt;<br/>    &lt;div class="mb-3 mt-3"&gt;<br/>      &lt;label for="usr"&gt;Username:&lt;/label&gt;<br/>      &lt;input type="text" class="form-control" id="usr" placeholder="Enter username" name="usr"&gt;<br/>    &lt;/div&gt;<br/>    &lt;div class="mb-3"&gt;<br/>      &lt;label for="pwd"&gt;Password:&lt;/label&gt;<br/>      &lt;input type="password" class="form-control" id="pwd" placeholder="Enter password" name="pwd"&gt;<br/>    &lt;/div&gt;</span><span id="8239" class="lu lv in lq b gy nb lx l ly lz">&lt;button onclick="<strong class="lq io">prepLogin()</strong>" class="btn btn-primary"&gt;Login&lt;/button&gt;<br/>  &lt;/div&gt;<br/>&lt;/div&gt;</span><span id="5ad5" class="lu lv in lq b gy nb lx l ly lz">&lt;script&gt;<br/><strong class="lq io">function prepLogin(){<br/> var usr=document.getElementById("usr").value||"-";<br/> var pwd=document.getElementById("pwd").value||"-";<br/> var encodedUsrPwd=btoa(usr+":"+pwd);<br/> reqsLogin(encodedUsrPwd);<br/>}<br/>function reqsLogin(encodedUsrPwd){<br/> var request = $.ajax({<br/>    url:      "</strong><a class="ae ks" href="http://localhost:8190/login" rel="noopener ugc nofollow" target="_blank"><strong class="lq io">http://localhost:8190/login</strong></a><strong class="lq io">",<br/>    contentType: "application/json; charset=utf-8",<br/>    dataType: "json",<br/>    method: "POST",<br/>    headers: {<br/>       authorization: "Basic "+encodedUsrPwd<br/>     }, <br/>    cache:    false,     <br/>    data: {},<br/>  }); <br/> <br/> request.done(function(responseText) {<br/>  console.log("done");<br/>  console.log(responseText);<br/>  });<br/> request.fail(function( jqXHR,statusText ) {<br/>  console.log("fail");<br/>  console.log( "Fail: " + statusText );<br/>  }); <br/> request.always(function() {</strong></span><span id="1595" class="lu lv in lq b gy nb lx l ly lz"><strong class="lq io">}); <br/>}</strong><br/>&lt;/script&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="a83e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">保存文件。刷新页面。输入<code class="fe nf ng nh lq b">username=admin</code>和<code class="fe nf ng nh lq b">password=manage</code>。控制台窗口应显示从服务器收到的 JSON 响应。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nc"><img src="../Images/89ebf222ea02f262f7e7d42cbb0dbac4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*24ORN-NgTn4elc_yo98SZA.png"/></div></div></figure><p id="d4c5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">添加一个引导模式以在登录请求期间显示旋转图标，如下所示。模态将被 jQuery 回调函数“always”隐藏。</p><pre class="kd ke kf kg gt lp lq lr ls aw lt bi"><span id="7ba7" class="lu lv in lq b gy lw lx l ly lz">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>&lt;head&gt;<br/>  &lt;title&gt;Login&lt;/title&gt;<br/>  &lt;meta charset="utf-8"&gt;<br/>  &lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;<br/>  &lt;script src="<a class="ae ks" href="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js" rel="noopener ugc nofollow" target="_blank">https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js</a>"&gt;&lt;/script&gt;  <br/>  &lt;link href="<a class="ae ks" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="noopener ugc nofollow" target="_blank">https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css</a>" rel="stylesheet"&gt;<br/>  &lt;script src="<a class="ae ks" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" rel="noopener ugc nofollow" target="_blank">https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js</a>"&gt;&lt;/script&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;</span><span id="c820" class="lu lv in lq b gy nb lx l ly lz">&lt;div class="container mt-3" style="width:400px;"&gt;<br/>  &lt;h2&gt;User login&lt;/h2&gt;<br/>  &lt;div&gt;<br/>    &lt;div class="mb-3 mt-3"&gt;<br/>      &lt;label for="usr"&gt;Username:&lt;/label&gt;<br/>      &lt;input type="text" class="form-control" id="usr" placeholder="Enter username" name="usr"&gt;<br/>    &lt;/div&gt;<br/>    &lt;div class="mb-3"&gt;<br/>      &lt;label for="pwd"&gt;Password:&lt;/label&gt;<br/>      &lt;input type="password" class="form-control" id="pwd" placeholder="Enter password" name="pwd"&gt;<br/>    &lt;/div&gt;</span><span id="f292" class="lu lv in lq b gy nb lx l ly lz">&lt;button onclick="prepLogin()" class="btn btn-primary" <strong class="lq io">data-bs-toggle="modal" data-bs-target="#myModal"</strong>&gt;Login&lt;/button&gt;<br/>  &lt;/div&gt;<br/>&lt;/div&gt;<br/><strong class="lq io">&lt;!-- The Modal --&gt;<br/>&lt;div class="modal" id="myModal"&gt;<br/>  &lt;div class="modal-dialog"&gt;<br/>    &lt;div class="modal-content"&gt;<br/>      &lt;!-- Modal Header --&gt;<br/>      &lt;div class="modal-header"&gt;<br/>        &lt;h4 class="modal-title"&gt;Wait...&lt;/h4&gt;<br/>        &lt;button type="button" class="btn-close" data-bs-dismiss="modal"&gt;&lt;/button&gt;<br/>      &lt;/div&gt;<br/>      &lt;!-- Modal body --&gt;<br/>      &lt;div class="modal-body" style="text-align:center;"&gt;<br/>        &lt;div class="spinner-border"&gt;&lt;/div&gt;<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>  &lt;/div&gt;<br/>&lt;/div&gt;</strong></span><span id="7f0f" class="lu lv in lq b gy nb lx l ly lz">&lt;script&gt;<br/>function prepLogin(){<br/> var usr=document.getElementById("usr").value||"-";<br/> var pwd=document.getElementById("pwd").value||"-";<br/> var encodedUsrPwd=btoa(usr+":"+pwd);<br/> reqsLogin(encodedUsrPwd);<br/>}<br/>function reqsLogin(encodedUsrPwd){<br/> var request = $.ajax({<br/>     url:      "<a class="ae ks" href="http://localhost:8190/login" rel="noopener ugc nofollow" target="_blank">http://localhost:8190/login</a>",<br/>        contentType: "application/json; charset=utf-8",<br/>        dataType: "json",<br/>  method: "POST",<br/>  headers: {<br/>       authorization: "Basic "+encodedUsrPwd<br/>     }, <br/>    cache:    false,     <br/>    data: {},<br/>  }); <br/> <br/> request.done(function(responseText) {<br/>  console.log("done");<br/>  console.log(responseText);<br/>  });<br/> request.fail(function( jqXHR,statusText ) {<br/>  console.log("fail");<br/>  console.log( "Fail: " + statusText );<br/>  }); <br/><strong class="lq io"> request.always(function() {<br/>  $('#myModal').modal('hide');<br/>  });</strong> <br/>}<br/>&lt;/script&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nc"><img src="../Images/0d33a0239a212980fddda6d440b7bb10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*25v1sbfr5kVoBOhwh4C_uw.png"/></div></div></figure><p id="a3a2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">添加代码以将令牌保存到会话存储中。</p><pre class="kd ke kf kg gt lp lq lr ls aw lt bi"><span id="6f8e" class="lu lv in lq b gy lw lx l ly lz">...<br/> request.done(function(responseText) {<br/>  console.log("done");<br/>  console.log(responseText);<br/>  <strong class="lq io">sessionStorage.setItem("token",responseText.token)</strong><br/>  });<br/>...</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nc"><img src="../Images/a206fbb53f5567b91b456eda2fe2e084.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RVlIufy3ME0Zaw5E_phjYg.png"/></div></div></figure><h1 id="5d5d" class="ma lv in bd mb mc md me mf mg mh mi mj jt mk ju ml jw mm jx mn jz mo ka mp mq bi translated">(3)创建第二页</h1><p id="253d" class="pw-post-body-paragraph kt ku in kv b kw mr jo ky kz ms jr lb lc mt le lf lg mu li lj lk mv lm ln lo ig bi translated">创建一个新的 HTML 文件，manage.html</p><pre class="kd ke kf kg gt lp lq lr ls aw lt bi"><span id="36e4" class="lu lv in lq b gy lw lx l ly lz">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>&lt;head&gt;<br/>  &lt;title&gt;Manage&lt;/title&gt;<br/>  &lt;meta charset="utf-8"&gt;<br/>  &lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;<br/>  &lt;script src="<a class="ae ks" href="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js" rel="noopener ugc nofollow" target="_blank">https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js</a>"&gt;&lt;/script&gt;  <br/>  &lt;link href="<a class="ae ks" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="noopener ugc nofollow" target="_blank">https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css</a>" rel="stylesheet"&gt;<br/>  &lt;script src="<a class="ae ks" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" rel="noopener ugc nofollow" target="_blank">https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js</a>"&gt;&lt;/script&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>&lt;nav class="navbar navbar-expand-sm navbar-dark bg-dark"&gt;<br/>  &lt;div class="container-fluid"&gt;<br/>    &lt;a class="navbar-brand" href="javascript:void(0)"&gt;Logo&lt;/a&gt;<br/>    &lt;button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mynavbar"&gt;<br/>      &lt;span class="navbar-toggler-icon"&gt;&lt;/span&gt;<br/>    &lt;/button&gt;<br/>    &lt;div class="collapse navbar-collapse" id="mynavbar"&gt;<br/>      &lt;ul class="navbar-nav me-auto"&gt;<br/>        &lt;li class="nav-item" style="margin-top:-12px;"&gt;<br/>          &lt;a class="nav-link active" href="javascript:void(0)"&gt;Link&lt;/a&gt;<br/>        &lt;/li&gt;<br/>        &lt;li class="nav-item" style="margin-top:-12px;"&gt;<br/>          &lt;a class="nav-link" href="javascript:void(0)"&gt;Link&lt;/a&gt;<br/>        &lt;/li&gt;<br/>        &lt;li class="nav-item" style="margin-top:-12px;"&gt;<br/>          &lt;a class="nav-link" href="javascript:void(0)"&gt;Link&lt;/a&gt;<br/>        &lt;/li&gt;<br/>      &lt;/ul&gt;<br/>      &lt;div class="d-flex"&gt;<br/>        &lt;input class="form-control me-2" type="text" placeholder="Search" <strong class="lq io">id="empid"</strong>&gt;<br/>        &lt;button class="btn btn-primary" type="button" onclick="<strong class="lq io">prepSearch()</strong>"&gt;Search&lt;/button&gt;<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>  &lt;/div&gt;<br/>&lt;/nav&gt;<br/>&lt;script&gt;<br/><strong class="lq io">function prepSearch(){</strong></span><span id="fdfb" class="lu lv in lq b gy nb lx l ly lz"><strong class="lq io">}</strong><br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nc"><img src="../Images/2e3d6c67eee04b4b4b10b6daecd2b0cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NxAvIJP7rzjeFyk9l7sk9Q.png"/></div></div></figure><p id="68ae" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">给文件<strong class="kv io">index.html</strong>中的函数<strong class="kv io"> reqsLogin() </strong>添加代码，将其重定向到<strong class="kv io">manage.html</strong>。</p><pre class="kd ke kf kg gt lp lq lr ls aw lt bi"><span id="f0ed" class="lu lv in lq b gy lw lx l ly lz">...<br/> request.done(function(responseText) {<br/>  console.log("done");<br/>  console.log(responseText);<br/>  sessionStorage.setItem("token",responseText.token);<br/>  <strong class="lq io">window.location = './manage.html';</strong><br/>  });<br/>...</span></pre><p id="7764" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在<strong class="kv io">&lt;&gt;</strong>标签中添加一个<strong class="kv io"> onload </strong>属性，在<strong class="kv io"> &lt; body &gt; </strong>加载时调用函数<strong class="kv io"> checkToken() </strong>，并将<strong class="kv io"> &lt; body &gt; </strong>样式设置为<strong class="kv io">【无】</strong>(隐藏)，直到检查令牌的有效性。</p><pre class="kd ke kf kg gt lp lq lr ls aw lt bi"><span id="9f22" class="lu lv in lq b gy lw lx l ly lz">&lt;body <strong class="lq io">onload="checkToken()"</strong> style="display:none;"&gt;</span></pre><p id="ca41" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">向函数 checkToken()添加代码，以检查令牌并执行后续操作，即:<br/> (1)从<strong class="kv io">会话存储中检索令牌数据</strong>。<br/> (2)提取<strong class="kv io">到期时间</strong>。<br/> (3)将<strong class="kv io">到期时间</strong>与<strong class="kv io">当前时间</strong>进行比较。将结果保存在<strong class="kv io"> isExpired </strong>中。<br/> (4)如果 isExpired 为真，重定向到<strong class="kv io">登录页面</strong>。否则，显示页面<strong class="kv io">正文&lt;页面&gt;正文</strong>内容。</p><pre class="kd ke kf kg gt lp lq lr ls aw lt bi"><span id="90e0" class="lu lv in lq b gy lw lx l ly lz">&lt;script&gt;<br/>function checkToken(){<br/> const JWT = sessionStorage.getItem("token");<br/> const jwtPayload = JSON.parse(window.atob(JWT.split('.')[1]))<br/> const datetime=new Date(jwtPayload.exp*1000);<br/> console.log("expiry time (epoch):",jwtPayload.exp * 1000);<br/> console.log("expiry time (ISO):", datetime.toISOString());<br/> const isExpired = Date.now() &gt;= jwtPayload.exp * 1000;<br/> console.log("token is expired:",isExpired);<br/> if (isExpired==true){<br/>  window.location = './login.html';<br/> }else{<br/>  document.getElementsByTagName("body")[0].style.display = "block";<br/> }<br/>}<br/>&lt;/script&gt;</span></pre><p id="acbf" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">为了访问受保护的 API，REST 请求中包含了有效的令牌。下面的代码演示了一个 REST 请求，该请求基于包含授权令牌的雇员 id 来查找雇员。</p><pre class="kd ke kf kg gt lp lq ni bn nj nk bi"><span id="61ee" class="nl lv in lq b be nm nn l ly lz"><br/>...<br/>function prepSearch(){<br/> var empid=document.getElementById("empid").value||"-";<br/> reqsSearch(empid);<br/>}<br/>function reqsSearch(empid){<br/> console.log(empid); <br/> const JWT = sessionStorage.getItem("token");<br/> var request = $.ajax({<br/>  url:      "http://localhost:8190/rest/map/EmployeeMap?search=Id="+empid,<br/>    method: "GET",<br/>    timeout: 0,<br/>  headers: {<br/>        <strong class="lq io">authorization: "Bearer "+JWT</strong><br/>     }<br/>  });  <br/> request.done(function(responseText) {<br/>  console.log("done");<br/>  console.log(responseText);<br/>  });<br/> request.fail(function( jqXHR,statusText ) {<br/>  console.log("fail");<br/>  console.log( "Fail: " + statusText );<br/>  }); <br/> request.always(function() {<br/>  $('#myModal').modal('hide');<br/>  }); <br/>}<br/>...</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi no"><img src="../Images/53a20deaea327e10b642ae1bd7b26bf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qiDzQ0457HPK82Q4NlfZtg.png"/></div></div></figure><p id="efc2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">上面的代码演示了 REST、JWT 和 AJAX 在实践中如何工作的一个简单例子。它们只是基本的想法。进一步的编码工作需要做，以使这个项目完美。</p><p id="06eb" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">REST 的替代方案是简单对象访问协议(SOAP)。</p><p id="cb05" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">未完待续。</p></div><div class="ab cl np nq hr nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ig ih ii ij ik"><p id="0daa" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">本帖是“Adabas &amp; Natural 入门”系列的一部分，该系列包括:<br/> (1) <a class="ae ks" href="https://medium.com/@mohamad.razzi.my/getting-started-with-adabas-natural-part-1-6597688406ad" rel="noopener">设置 Adabas &amp; Natural 社区版(Docker 版)</a>。<br/> (2) <a class="ae ks" href="https://medium.com/@mohamad.razzi.my/getting-started-with-adabas-natural-part-2-34621e576fa4" rel="noopener">通过 Adabas REST Web app 访问 Adabas 数据库</a>。<br/> (3) <a class="ae ks" rel="noopener ugc nofollow" target="_blank" href="/getting-started-with-adabas-natural-part-3-a334822db12"> Adabas“周期组”和 JSON 数据格式的“多值”表示</a>。<br/> (4) <a class="ae ks" href="https://medium.com/@mohamad.razzi.my/getting-started-with-adabas-natural-part-4-728e6977ad4f" rel="noopener">使用 Adabas TCP-IP 节点包访问 Adabas 数据库</a>。<br/> (5) <a class="ae ks" href="https://medium.com/@mohamad.razzi.my/getting-started-with-adabas-natural-part-5-1665a0be42ab" rel="noopener">使用 NaturalONE IDE 的大型机编程(Natural)介绍</a>。<br/> (6) <a class="ae ks" href="https://medium.com/@mohamad.razzi.my/getting-started-with-adabas-natural-part-6-48b4b2fd3e6d" rel="noopener">使用自然编程和自然 IDE 访问 Adabas 数据库</a>。<br/> (7) <a class="ae ks" href="https://medium.com/@mohamad.razzi.my/mainframe-database-programming-fundamentals-b34fd88acf6e" rel="noopener">大型机数据库编程基础</a>。<br/> (8) <a class="ae ks" href="https://medium.com/@mohamad.razzi.my/mainframe-database-programming-27803b92a3a3" rel="noopener">大型机数据库编程中级</a>。<br/> (9) <a class="ae ks" href="https://medium.com/@mohamad.razzi.my/developing-ajax-web-pages-e270eb59fc92" rel="noopener">使用自然 AJAX 框架开发 AJAX 网页</a>。<br/>(10)<a class="ae ks" href="https://medium.com/@mohamad.razzi.my/how-does-ajax-actually-work-2f57cf4ddc55" rel="noopener">AJAX 实际上是如何工作的</a>？<br/> (11) <a class="ae ks" href="https://medium.com/dev-genius/how-does-ajax-actually-work-2f57cf4ddc55" rel="noopener">向 ADABAS REST Web app 发送带有 JWT 令牌的 AJAX 请求</a>。<br/> (12)通过 Java Servlets 和 Java Web Services (SOAP)向 ADABAS REST 服务发送 HTTP 请求。</p></div></div>    
</body>
</html>