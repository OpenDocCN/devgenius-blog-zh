<html>
<head>
<title>Extract Table from PDF using Python — Python Programming</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python-Python 编程从 PDF 中提取表格</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/extract-table-from-pdf-using-python-python-programming-13f40d468945?source=collection_archive---------0-----------------------#2021-06-27">https://blog.devgenius.io/extract-table-from-pdf-using-python-python-programming-13f40d468945?source=collection_archive---------0-----------------------#2021-06-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="77fc" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在本教程中，我们将讨论如何使用 Python 从 PDF 文件中提取表格</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d0ce7a42752df02945f65f0ff80cf67c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rXWPhtSxHHCPFSkF"/></div></div></figure><p id="3e07" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">目录</strong></p><ul class=""><li id="3eab" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated">介绍</li><li id="7a86" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">示例 PDF 文件</li><li id="1f85" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">使用 Python 从 PDF 的单个页面中提取单个表格</li><li id="d953" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">使用 Python 从单个 PDF 页面中提取多个表格</li><li id="359f" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">使用 Python 从 PDF 中提取所有表格</li><li id="ac53" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">结论</li></ul></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mi mj l"/></div></figure></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="0475" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">介绍</h1><p id="ae9c" class="pw-post-body-paragraph kr ks iq kt b ku nc jr kw kx nd ju kz la ne lc ld le nf lg lh li ng lk ll lm ij bi translated">当阅读研究论文或阅读一些技术指南时，我们通常会获得 PDF 格式的文件。它们载有许多有用的信息，读者可能对一些带有数据集或研究论文的发现和结果的表格特别感兴趣。然而，我们都面临着将这些表格轻松提取到 Excel 或数据框架的困难。</p><p id="a84c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">多亏了 Python 和它的一些神奇的库，现在您可以用几行代码提取这些表了！</p><p id="4fdb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">要继续学习本教程，我们需要以下 Python 库:tabula-py。</p><p id="e860" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果您没有安装它，请打开“命令提示符”(在 Windows 上)并使用以下代码安装它:</p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="9140" class="nm ml iq ni b gy nn no l np nq">pip install tabula-py</span></pre><p id="31b8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">tabula-py 是 tabula-java 的 Python 包装器，所以您还需要在您的计算机上安装 java。你可以在这里下载<a class="ae nr" href="https://www.java.com/en/" rel="noopener ugc nofollow" target="_blank">。</a></p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="0ce4" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">示例 PDF 文件</h1><p id="dfd6" class="pw-post-body-paragraph kr ks iq kt b ku nc jr kw kx nd ju kz la ne lc ld le nf lg lh li ng lk ll lm ij bi translated">现在我们已经安装了需求，让我们找到几个示例 PDF 文件，我们将从中提取表格。</p><p id="a451" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">该文件仅用于代码示例:</p><ul class=""><li id="eece" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated"><a class="ae nr" href="https://sedl.org/afterschool/toolkits/science/pdf/ast_sci_data_tables_sample.pdf" rel="noopener ugc nofollow" target="_blank">链接到文件</a></li></ul><p id="d6cb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在让我们深入研究代码！</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="1b29" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">使用 Python 从 PDF 的单个页面中提取单个表格</h1><p id="c03b" class="pw-post-body-paragraph kr ks iq kt b ku nc jr kw kx nd ju kz la ne lc ld le nf lg lh li ng lk ll lm ij bi translated">在本节中，我们将使用上面提到的文件。如果你看一下，你会发现它在两页上总共有三个表格:第一页上有一个表格，第二页上有两个表格。</p><p id="5285" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">假设您对提取如下所示的第一个表感兴趣:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/3d4af45f5881bb7d30ad42a7a2f334a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/0*EvHRAY_Ldn1YJ_qo"/></div><figcaption class="nt nu gj gh gi nv nw bd b be z dk translated">作者图片</figcaption></figure><p id="d6fd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们知道它在 PDF 文件的第一页。现在我们可以使用 Python 将其提取为 CSV 或 DataFrame。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="095f" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">方法 1:</h1><p id="726a" class="pw-post-body-paragraph kr ks iq kt b ku nc jr kw kx nd ju kz la ne lc ld le nf lg lh li ng lk ll lm ij bi translated"><strong class="kt ir">第一步:导入库并定义文件路径</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx mj l"/></div></figure><p id="dc54" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">第二步:从 PDF 文件中提取表格</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx mj l"/></div></figure><p id="e579" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">上面的代码读取 PDF 文件的第一页，搜索表格，并将每个表格作为一个数据帧添加到一个数据帧列表中。</p><p id="9f50" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这里我们只期望一个表，因此<strong class="kt ir"> dfs </strong>列表的长度应该是 1:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx mj l"/></div></figure><p id="ec52" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">它应该返回:</p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="5623" class="nm ml iq ni b gy nn no l np nq">1</span></pre><p id="6c36" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您也可以通过显示列表中第一个元素的内容来验证结果:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx mj l"/></div></figure><p id="2bd3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">并获得:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/ba09369cd647a3b523b9264af2d6a8d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/1*Y9QWXjqGM6Dr4Dq1M5whbA.png"/></div></figure><p id="5d45" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">步骤 3:将数据帧写入 CSV 文件</strong></p><p id="b100" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">只需将数据帧写入同一目录中的 CSV:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx mj l"/></div></figure></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="dd86" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">方法二:</h1><p id="c69c" class="pw-post-body-paragraph kr ks iq kt b ku nc jr kw kx nd ju kz la ne lc ld le nf lg lh li ng lk ll lm ij bi translated">这种方法将产生相同的结果，并且该库提供了一行解决方案，而不是一步一步地进行:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx mj l"/></div></figure></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><p id="b690" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">重要提示:</strong></p><p id="0350" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">当您确定特定页面上只有一个表格时，上述两种方法都很容易使用。</p><p id="358f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在下一节中，我们将探讨在处理多个表时如何调整代码。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="5ed8" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">使用 Python 从单个 PDF 页面中提取多个表格</h1><p id="f057" class="pw-post-body-paragraph kr ks iq kt b ku nc jr kw kx nd ju kz la ne lc ld le nf lg lh li ng lk ll lm ij bi translated">回想一下<a class="ae nr" href="https://sedl.org/afterschool/toolkits/science/pdf/ast_sci_data_tables_sample.pdf" rel="noopener ugc nofollow" target="_blank"> PDF 文件</a>在第 2 页上有 2 个表格。</p><p id="2fcf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们希望提取下面的表格:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/3612d4f4e6cf286d1e3d42c1ddcf9aae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/0*t4Jv3JKLgqeUIEYe"/></div><figcaption class="nt nu gj gh gi nv nw bd b be z dk translated">作者图片</figcaption></figure><p id="3ab9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">和</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/b15f494e5b5bf61163ba42e00a82aaa1.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/0*rhF2KvFD7ndAXcFO"/></div><figcaption class="nt nu gj gh gi nv nw bd b be z dk translated">作者图片</figcaption></figure><p id="25a4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">使用上一节中的<strong class="kt ir">方法 1 </strong>，我们可以将每个表提取为一个数据帧，并创建一个数据帧列表:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx mj l"/></div></figure><p id="35b2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">注意，在这种情况下，我们设置<strong class="kt ir"> pages='2' </strong>，因为我们从 PDF 文件的第 2 页提取表格。</p><p id="be31" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">检查列表是否包含两个数据帧:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx mj l"/></div></figure><p id="bfeb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">它应该返回:</p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="a349" class="nm ml iq ni b gy nn no l np nq">2</span></pre><p id="4421" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">既然列表包含多个数据帧，那么可以使用 for 循环将每个数据帧提取到一个单独的 CSV 文件中:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx mj l"/></div></figure><p id="a4fa" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">并且你应该会得到两个 CSV 文件:<em class="ob"> table_0.csv </em>和<em class="ob"> table_1.csv </em>。</p><p id="be16" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">注意:</strong>如果您尝试使用上一节中描述的方法 2，它会将这两个表提取到 CSV 文件中的一个工作表中，您需要手动将它分成两个工作表。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="9c8a" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">使用 Python 从 PDF 中提取所有表格</h1><p id="d8f0" class="pw-post-body-paragraph kr ks iq kt b ku nc jr kw kx nd ju kz la ne lc ld le nf lg lh li ng lk ll lm ij bi translated">在上面几节中，我们主要关注从给定的单个页面(第 1 页或第 2 页)中提取表格。现在，如果我们只是想把 PDF 文件中的所有表格放到不同的 CSV 文件中，我们该怎么做呢？</p><p id="da24" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">用表格库很容易解决。代码与前一部分几乎相同。我们需要做的唯一更改是设置 pages='all '，因此代码提取它找到的所有表作为数据帧，并用它们创建一个列表:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx mj l"/></div></figure><p id="7a90" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">检查列表是否包含所有三个数据帧:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx mj l"/></div></figure><p id="f453" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">它应该返回:</p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="94ff" class="nm ml iq ni b gy nn no l np nq">3</span></pre><p id="fac0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">既然列表包含多个数据帧，那么可以使用 for 循环将每个数据帧提取到一个单独的 CSV 文件中:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx mj l"/></div></figure></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="af37" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">结论</h1><p id="f283" class="pw-post-body-paragraph kr ks iq kt b ku nc jr kw kx nd ju kz la ne lc ld le nf lg lh li ng lk ll lm ij bi translated">在本文中，我们讨论了如何使用 tabula-py 库从 PDF 文件中提取表格。</p><p id="249d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果你有任何问题或对编辑有任何建议，请随时在下面留下评论，并查看我的更多<a class="ae nr" href="https://pyshark.com/category/python-programming/" rel="noopener ugc nofollow" target="_blank"> Python 编程</a>文章。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><p id="098b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="ob">原载于 2021 年 6 月 27 日 https://pyshark.com</em><a class="ae nr" href="https://pyshark.com/extract-table-from-pdf-using-python/" rel="noopener ugc nofollow" target="_blank"><em class="ob"/></a><em class="ob">。</em></p></div></div>    
</body>
</html>