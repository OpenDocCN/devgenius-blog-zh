<html>
<head>
<title>Docker Containers &amp; AWS ECR</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">码头集装箱和 AWS ECR</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/docker-containers-aws-ecr-1fe5d2e98dfe?source=collection_archive---------5-----------------------#2022-10-31">https://blog.devgenius.io/docker-containers-aws-ecr-1fe5d2e98dfe?source=collection_archive---------5-----------------------#2022-10-31</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/9e706458cb40144e825c44ef730de2a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ifIYicOZUI7Q_TX1fH1_KQ.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">图片来源:istock images</figcaption></figure><p id="d9ae" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">Docker 是云计算的未来，因为它的容器！可扩展性、可用性(集群)/在单个环境中运行多个容器、经济实惠&amp;它的简单性将使任何应用程序操作系统梦想成真！让我们直接进入项目，看看 Docker“whally”是如何工作的(呵呵 jokey 玩笑)！</p></div><div class="ab cl kx ky hr kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ig ih ii ij ik"><p id="d203" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">您的团队需要您快速部署自定义映像，并在文件中编写快速脚本来完成任务。你将会做一个你以前可能没有做过的任务，所以如果你不知道怎么做的话，一定要研究一下。</p><h2 id="9959" class="le lf in bd lg lh li dn lj lk ll dp lm kk ln lo lp ko lq lr ls ks lt lu lv lw bi translated">目标:</h2><ol class=""><li id="2b3a" class="lx ly in kb b kc lz kg ma kk mb ko mc ks md kw me mf mg mh bi translated">使用 Nginx 创建您自己的映像，并添加一个文件来告诉您容器的部署日期</li><li id="36dd" class="lx ly in kb b kc mi kg mj kk mk ko ml ks mm kw me mf mg mh bi translated">在端口 8080 打开的情况下部署容器</li><li id="632f" class="lx ly in kb b kc mi kg mj kk mk ko ml ks mm kw me mf mg mh bi translated">将容器数据保存到 AWS 弹性容器注册表(ECR)</li></ol></div><div class="ab cl kx ky hr kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ig ih ii ij ik"><h2 id="05d4" class="le lf in bd lg lh li dn lj lk ll dp lm kk ln lo lp ko lq lr ls ks lt lu lv lw bi translated">先决条件:</h2><ul class=""><li id="4906" class="lx ly in kb b kc lz kg ma kk mb ko mc ks md kw mn mf mg mh bi translated">具有运行状态 EC2 实例的 AWS 自由层帐户(必须安装 Docker)。我用的操作系统是 Linux/Ubuntu</li><li id="181d" class="lx ly in kb b kc mi kg mj kk mk ko ml ks mm kw mn mf mg mh bi translated">安装 Docker 并注册一个 Docker Hub 帐户</li><li id="4e66" class="lx ly in kb b kc mi kg mj kk mk ko ml ks mm kw mn mf mg mh bi translated">端口 8080 (EC2 安全组)</li></ul></div><div class="ab cl kx ky hr kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ig ih ii ij ik"><h1 id="dcbd" class="mo lf in bd lg mp mq mr lj ms mt mu lm mv mw mx lp my mz na ls nb nc nd lv ne bi translated">使用 Nginx 创建您自己的映像，并添加一个文件来告诉您容器的部署日期</h1><h2 id="0b75" class="le lf in bd lg lh li dn lj lk ll dp lm kk ln lo lp ko lq lr ls ks lt lu lv lw bi translated">第一步。</h2><ul class=""><li id="cd56" class="lx ly in kb b kc lz kg ma kk mb ko mc ks md kw mn mf mg mh bi translated">我们需要从创建一个文件夹开始，并将目录更改到我们正在创建的文件夹中。</li></ul><pre class="nf ng nh ni gt nj nk nl nm aw nn bi"><span id="426a" class="le lf in nk b gy no np l nq nr"><strong class="nk io">$ mkdir &lt;name of directory&gt;<br/>$ cd &lt;name of directory&gt;</strong></span></pre><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/8b75dc729881f26d98bfc3e1027e748f.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*WH7HDnl6t00GxDHUR2g_tw.png"/></div></figure><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/7f34b1fe470150e6b4a722fc5735ea6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*ZEIcDLq2Ew8Xzaro8wx_ag.png"/></div></figure><h2 id="d196" class="le lf in bd lg lh li dn lj lk ll dp lm kk ln lo lp ko lq lr ls ks lt lu lv lw bi translated">第二步。拉 Nginix</h2><p id="d360" class="pw-post-body-paragraph jz ka in kb b kc lz ke kf kg ma ki kj kk nu km kn ko nv kq kr ks nw ku kv kw ig bi translated">对于我用 Nginx 提取的 Docker 图像。</p><pre class="nf ng nh ni gt nj nk nl nm aw nn bi"><span id="c52e" class="le lf in nk b gy no np l nq nr">#to get the latest ngnix or you could enter the latest name such as nginx:1.23 or whatever the latest file is called<br/><strong class="nk io">$docker pull nginx:latest </strong></span><span id="3af7" class="le lf in nk b gy nx np l nq nr">#gives you the information on the latest pull you requested<br/><strong class="nk io">$docker images</strong></span></pre><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ny"><img src="../Images/857d742c4501e30beecb4321adad9be7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pKOzs1X3XZdnFKKHFxxGag.png"/></div></div></figure><h2 id="e226" class="le lf in bd lg lh li dn lj lk ll dp lm kk ln lo lp ko lq lr ls ks lt lu lv lw bi translated">第二步。创建 html 文件</h2><p id="0107" class="pw-post-body-paragraph jz ka in kb b kc lz ke kf kg ma ki kj kk nu km kn ko nv kq kr ks nw ku kv kw ig bi translated">为了创建一个 VIM 文件，我使用了下面的命令。然后，我们的编辑屏幕出现在 VIM 中。为 html 输入以下内容。</p><pre class="nf ng nh ni gt nj nk nl nm aw nn bi"><span id="1b59" class="le lf in nk b gy no np l nq nr">#creates our index file<br/><strong class="nk io">$touch index.html</strong></span><span id="a079" class="le lf in nk b gy nx np l nq nr">#allows you to edit the file <strong class="nk io"><br/>$vim index.html</strong></span></pre><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nz"><img src="../Images/748d02f17861ddf1e03d5df1571c94a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ET8TrYhriB6QaLnrdG60Kg.png"/></div></div></figure></div><div class="ab cl kx ky hr kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ig ih ii ij ik"><p id="1beb" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">使用 Docker 的可爱之处在于它可以使用<strong class="kb io"> <em class="oa"> Dockerfile 自动为您构建一个图像。</em>T3】</strong></p><h2 id="7a72" class="le lf in bd lg lh li dn lj lk ll dp lm kk ln lo lp ko lq lr ls ks lt lu lv lw bi translated"><strong class="ak">第一步。创建一个 Dockerfile &amp;在 VIM 编辑器</strong>中编辑它</h2><pre class="nf ng nh ni gt nj nk nl nm aw nn bi"><span id="6aa9" class="le lf in nk b gy no np l nq nr">#creates our index file<br/><strong class="nk io">$touch Dockerfile</strong></span><span id="c924" class="le lf in nk b gy nx np l nq nr">#allows you to edit the file <strong class="nk io"><br/>$vim Dockerfile</strong></span></pre><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/7595cf91aa2efec3c34b00097c7ee7ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/1*4jZlu3ulG7JkhMwP3aDVAQ.png"/></div></figure><h2 id="56f1" class="le lf in bd lg lh li dn lj lk ll dp lm kk ln lo lp ko lq lr ls ks lt lu lv lw bi translated">第二步。现在在 VIM 编辑器中编辑 Dockerfile 文件</h2><pre class="nf ng nh ni gt nj nk nl nm aw nn bi"><span id="8ede" class="le lf in nk b gy no np l nq nr"><strong class="nk io">FROM nginix<br/>COPY index.html /usr/share/nginix/html</strong></span><span id="37f9" class="le lf in nk b gy nx np l nq nr">#hit ESC on your keyboard then :wq to save and exit the VIM editor </span></pre><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/eafd9fe3053550ed9029bca5d9946568.png" data-original-src="https://miro.medium.com/v2/resize:fit:1048/format:webp/1*z-ll--r0zGtGNm0Oi154RQ.png"/></div></figure><ul class=""><li id="2a51" class="lx ly in kb b kc kd kg kh kk od ko oe ks of kw mn mf mg mh bi translated">这里需要理解的一件重要事情是。下一步将需要 build 命令中的这个“映像名”。否则，如果拼写错误或者没有输入正确的“文件图像”,您将会遇到错误。</li></ul><p id="036e" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">将构建上下文发送到 docker 守护程序 3.584kB 步骤 1/2:从 nginix 拉取访问被拒绝对于 nginix，存储库不存在或可能需要“Docker 登录”:被拒绝:请求的资源访问被拒绝</p><p id="f279" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">FROM = <an image="" name="" within="" your="" dockerfile=""/></p><p id="7537" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">复制 index.html/usr/share "这是"上面的图像名称"/html/</p><p id="81fe" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">所以…</p><p id="791f" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">来自<strong class="kb io"> nginx </strong></p><p id="c37d" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">复制 index.html/usr/share/<strong class="kb io">nginx</strong>/html/</p><h2 id="5589" class="le lf in bd lg lh li dn lj lk ll dp lm kk ln lo lp ko lq lr ls ks lt lu lv lw bi translated">第三步。建立我们的形象</h2><pre class="nf ng nh ni gt nj nk nl nm aw nn bi"><span id="34dc" class="le lf in nk b gy no np l nq nr">docker build -t nginx</span></pre><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div class="gh gi og"><img src="../Images/aae91cb8ef7ccff1291d21ea03335fc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*6JjdEvSrsTioDgqlGDxFMQ.png"/></div></figure></div><div class="ab cl kx ky hr kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ig ih ii ij ik"><h1 id="532b" class="mo lf in bd lg mp mq mr lj ms mt mu lm mv mw mx lp my mz na ls nb nc nd lv ne bi translated">在端口 8080 打开的情况下部署容器</h1><pre class="nf ng nh ni gt nj nk nl nm aw nn bi"><span id="c942" class="le lf in nk b gy no np l nq nr">docker run -d --name firstdocker_container -p 8080:80 nginx</span></pre><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oh"><img src="../Images/43b06af6965c8cda2b5e54f599f72717.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*He4pgFPepmnqlC9zf9CQiA.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">该命令将生成容器 ID</figcaption></figure><p id="5c35" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">如果你跑…</p><pre class="nf ng nh ni gt nj nk nl nm aw nn bi"><span id="987d" class="le lf in nk b gy no np l nq nr">docker ps</span></pre><p id="ad63" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">它将很好地解释 docker run 命令为我们做了什么。</p><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oi"><img src="../Images/f80229798d1fc414b1b3f0a2756112ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SMDsmYIhyy2OFmf7nr1X0w.png"/></div></div></figure><ul class=""><li id="adf7" class="lx ly in kb b kc kd kg kh kk od ko oe ks of kw mn mf mg mh bi translated">在 Cloud9 的右上角，在 Share&gt; applications 下获取你的 IP 地址。输入到你的搜索栏&gt; IP 地址:8080，看看你的 html 页面是否显示！</li></ul><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oj"><img src="../Images/93a73ee2c9a6f2d8249c7a3a81690bd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*avttat4_L4zjbKMW-BG7sw.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">呜哇呜！</figcaption></figure></div><div class="ab cl kx ky hr kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ig ih ii ij ik"><h1 id="6a27" class="mo lf in bd lg mp mq mr lj ms mt mu lm mv mw mx lp my mz na ls nb nc nd lv ne bi translated">将容器数据保存到 AWS 弹性容器注册表(ECR)</h1><h2 id="9b94" class="le lf in bd lg lh li dn lj lk ll dp lm kk ln lo lp ko lq lr ls ks lt lu lv lw bi translated">第一步。</h2><p id="9e5c" class="pw-post-body-paragraph jz ka in kb b kc lz ke kf kg ma ki kj kk nu km kn ko nv kq kr ks nw ku kv kw ig bi translated">您可以在命令行中这样做，或者直接进入 AWS 弹性容器注册中心(ECR)并创建存储库。我已经陷得太深了…所以我不得不坚持做下去。</p><ul class=""><li id="0b8c" class="lx ly in kb b kc kd kg kh kk od ko oe ks of kw mn mf mg mh bi translated">从命令行输入以下命令在 AWS 中创建存储库</li></ul><pre class="nf ng nh ni gt nj nk nl nm aw nn bi"><span id="7e51" class="le lf in nk b gy no np l nq nr"><strong class="nk io">$ aws ecr create-repository --repository-name [name here]--region [region here]</strong></span></pre><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ok"><img src="../Images/b178e43ac01a47a9db952ae88faf180b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DfiujiLGcYIJ9jedk9ZSoA.png"/></div></div></figure><ul class=""><li id="93b3" class="lx ly in kb b kc kd kg kh kk od ko oe ks of kw mn mf mg mh bi translated">您需要使用这个命令获得一个登录名和令牌。</li></ul><pre class="nf ng nh ni gt nj nk nl nm aw nn bi"><span id="fe21" class="le lf in nk b gy no np l nq nr">#displays the token<br/><strong class="nk io">$ aws ecr get-login-password --region us-east-1</strong></span></pre><ul class=""><li id="d0f8" class="lx ly in kb b kc kd kg kh kk od ko oe ks of kw mn mf mg mh bi translated">之后，我可以在 AWS ECR 中查看我的存储库。单击查看推送命令，并按照以下步骤完成我们的最后一项任务！</li></ul><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ol"><img src="../Images/a52ec13d60c15690a3936008d755f41c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gvAF0rlpm5wTK_GSb7KOIA.png"/></div></div></figure><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi om"><img src="../Images/c6b9473e3f96cbca28a97f5c801dd706.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nIM-W5o3qRFeq2fq5HDcKQ.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">耶！我们已成功将容器保存到 ECR！</figcaption></figure><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi on"><img src="../Images/ca092fb0043f8113e30bc7b0e9a8c280.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6rltDHHG8gcE6oSyCFW47w.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">在 AWS ECR 中，您还可以查看已创建的图像！</figcaption></figure><p id="7721" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">别忘了删除你的资源！<a class="ae oo" href="https://www.geeksforgeeks.org/remove-all-containers-and-images-in-docker/" rel="noopener ugc nofollow" target="_blank">https://www . geeks forgeeks . org/remove-all-containers-and-images-in-docker/</a></p><pre class="nf ng nh ni gt nj nk nl nm aw nn bi"><span id="a2f5" class="le lf in nk b gy no np l nq nr">docker stop $(docker ps -aq)<br/>docker rmi $(docker images -q)<br/>docker rm $(docker ps -aq)</span></pre></div><div class="ab cl kx ky hr kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ig ih ii ij ik"><h1 id="da8b" class="mo lf in bd lg mp mq mr lj ms mt mu lm mv mw mx lp my mz na ls nb nc nd lv ne bi translated">我们连线吧！</h1><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi op"><img src="../Images/3c8f110ccf67b33cc99efc92b4ee4006.png" data-original-src="https://miro.medium.com/v2/resize:fit:372/format:webp/0*O-rXxX-WrO9Saq1X.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">我的 Linkedin 个人资料:【https://www.linkedin.com/in/janita-williamson-186a1a85 T2】</figcaption></figure><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/67a0c386e9cdca329355ddbfc8dd6412.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/0*qg5rsNV-TEXqbFKj.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">我的 GitHub 用户名:https://github.com/MrsTorres/python-.git<a class="ae oo" href="https://github.com/MrsTorres/python-.git" rel="noopener ugc nofollow" target="_blank">MrsTorres</a></figcaption></figure><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div class="gh gi or"><img src="../Images/58151bab0333e91f9ca88bac3cf89d95.png" data-original-src="https://miro.medium.com/v2/resize:fit:284/format:webp/0*juEEPgSemQHC0qsY.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">一个视觉日记，记录了我从医疗保健到科技世界的咖啡之旅！@caffeinatedtechie</figcaption></figure></div></div>    
</body>
</html>