<html>
<head>
<title>Add a Dendrogram into Our React App with the Visx Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Visx库将树状图添加到React应用程序中</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/add-a-dendrogram-into-our-react-app-with-the-visx-library-425352fb55ee?source=collection_archive---------3-----------------------#2021-04-01">https://blog.devgenius.io/add-a-dendrogram-into-our-react-app-with-the-visx-library-425352fb55ee?source=collection_archive---------3-----------------------#2021-04-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/35d4951d21a2f8468ad4a899035a8634.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AKm6M_KP3Y2aKTx2"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Todd Quackenbush 在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="071b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Visx是一个库，让我们可以轻松地将图形添加到React应用程序中。</p><p id="ee07" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解如何使用它向React应用程序添加树状图。</p><h1 id="396e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">安装所需的软件包</h1><p id="2968" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们必须安装一些模块。</p><p id="61e8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们运行:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="89df" class="mn lc iq mj b gy mo mp l mq mr">npm i @visx/gradient @visx/group @visx/hierarchy @visx/responsive @visx/shape</span></pre><p id="8e2b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">安装软件包。</p><h1 id="dd73" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">创建树状图</h1><p id="9a3a" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过编写以下内容来创建树状图:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="9c01" class="mn lc iq mj b gy mo mp l mq mr">import React, { useMemo } from "react";<br/>import { Group } from "@visx/group";<br/>import { Cluster, hierarchy } from "@visx/hierarchy";<br/>import { LinkVertical } from "@visx/shape";<br/>import { LinearGradient } from "@visx/gradient";</span><span id="e770" class="mn lc iq mj b gy ms mp l mq mr">const citrus = "#ddf163";<br/>const white = "#ffffff";<br/>const green = "#79d259";<br/>const aqua = "#37ac8c";<br/>const merlinsbeard = "#f7f7f3";<br/>const background = "#306c90";</span><span id="053d" class="mn lc iq mj b gy ms mp l mq mr">const clusterData = {<br/>  name: "$",<br/>  children: [<br/>    {<br/>      name: "A",<br/>      children: [<br/>        { name: "A1" },<br/>        { name: "A2" },<br/>        {<br/>          name: "C",<br/>          children: [<br/>            {<br/>              name: "C1"<br/>            }<br/>          ]<br/>        }<br/>      ]<br/>    },<br/>    {<br/>      name: "B",<br/>      children: [{ name: "B1" }, { name: "B2" }]<br/>    },<br/>    {<br/>      name: "X",<br/>      children: [<br/>        {<br/>          name: "Z"<br/>        }<br/>      ]<br/>    }<br/>  ]<br/>};</span><span id="aefc" class="mn lc iq mj b gy ms mp l mq mr">function Node({ node }) {<br/>  const isRoot = node.depth === 0;<br/>  const isParent = !!node.children;</span><span id="3924" class="mn lc iq mj b gy ms mp l mq mr">  if (isRoot) return &lt;RootNode node={node} /&gt;;</span><span id="f00e" class="mn lc iq mj b gy ms mp l mq mr">  return (<br/>    &lt;Group top={node.y} left={node.x}&gt;<br/>      {node.depth !== 0 &amp;&amp; (<br/>        &lt;circle<br/>          r={12}<br/>          fill={background}<br/>          stroke={isParent ? white : citrus}<br/>          onClick={() =&gt; {<br/>            alert(`clicked: ${JSON.stringify(node.data.name)}`);<br/>          }}<br/>        /&gt;<br/>      )}<br/>      &lt;text<br/>        dy=".33em"<br/>        fontSize={9}<br/>        fontFamily="Arial"<br/>        textAnchor="middle"<br/>        style={{ pointerEvents: "none" }}<br/>        fill={isParent ? white : citrus}<br/>      &gt;<br/>        {node.data.name}<br/>      &lt;/text&gt;<br/>    &lt;/Group&gt;<br/>  );<br/>}</span><span id="4e6d" class="mn lc iq mj b gy ms mp l mq mr">function RootNode({ node }) {<br/>  const width = 40;<br/>  const height = 20;<br/>  const centerX = -width / 2;<br/>  const centerY = -height / 2;</span><span id="665c" class="mn lc iq mj b gy ms mp l mq mr">  return (<br/>    &lt;Group top={node.y} left={node.x}&gt;<br/>      &lt;rect<br/>        width={width}<br/>        height={height}<br/>        y={centerY}<br/>        x={centerX}<br/>        fill="url('#top')"<br/>      /&gt;<br/>      &lt;text<br/>        dy=".33em"<br/>        fontSize={9}<br/>        fontFamily="Arial"<br/>        textAnchor="middle"<br/>        style={{ pointerEvents: "none" }}<br/>        fill={background}<br/>      &gt;<br/>        {node.data.name}<br/>      &lt;/text&gt;<br/>    &lt;/Group&gt;<br/>  );<br/>}</span><span id="5c84" class="mn lc iq mj b gy ms mp l mq mr">const defaultMargin = { top: 40, left: 0, right: 0, bottom: 40 };</span><span id="3957" class="mn lc iq mj b gy ms mp l mq mr">function Example({ width, height, margin = defaultMargin }) {<br/>  const data = useMemo(() =&gt; hierarchy(clusterData), []);<br/>  const xMax = width - margin.left - margin.right;<br/>  const yMax = height - margin.top - margin.bottom;</span><span id="0378" class="mn lc iq mj b gy ms mp l mq mr">  return width &lt; 10 ? null : (<br/>    &lt;svg width={width} height={height}&gt;<br/>      &lt;LinearGradient id="top" from={green} to={aqua} /&gt;<br/>      &lt;rect width={width} height={height} rx={14} fill={background} /&gt;<br/>      &lt;Cluster root={data} size={[xMax, yMax]}&gt;<br/>        {(cluster) =&gt; (<br/>          &lt;Group top={margin.top} left={margin.left}&gt;<br/>            {cluster.links().map((link, i) =&gt; (<br/>              &lt;LinkVertical<br/>                key={`cluster-link-${i}`}<br/>                data={link}<br/>                stroke={merlinsbeard}<br/>                strokeWidth="1"<br/>                strokeOpacity={0.2}<br/>                fill="none"<br/>              /&gt;<br/>            ))}<br/>            {cluster.descendants().map((node, i) =&gt; (<br/>              &lt;Node key={`cluster-node-${i}`} node={node} /&gt;<br/>            ))}<br/>          &lt;/Group&gt;<br/>        )}<br/>      &lt;/Cluster&gt;<br/>    &lt;/svg&gt;<br/>  );<br/>}</span><span id="3a57" class="mn lc iq mj b gy ms mp l mq mr">export default function App() {<br/>  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;Example width={500} height={300} /&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="e36f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在代码的顶部为树状图创建变量。</p><p id="c639" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">clusterData</code>变量包含了树状图的树数据。</p><p id="ed3e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们创建<code class="fe mt mu mv mj b">Node</code>组件来呈现树状图的节点。</p><p id="4be7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它的<code class="fe mt mu mv mj b">Group</code>组件里面有一些<code class="fe mt mu mv mj b">text</code>。</p><p id="d91d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">根节点是用<code class="fe mt mu mv mj b">RootBNode</code>组件创建的。</p><p id="7492" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它与<code class="fe mt mu mv mj b">Node</code>的不同之处在于它在文本周围多了一个矩形。</p><p id="5cc1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">Example</code>组件是整个树形图的集合。</p><p id="d40e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe mt mu mv mj b">Cluster</code>组件的渲染属性来渲染树节点。</p><p id="2eeb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该数据被设置为<code class="fe mt mu mv mj b">root</code>道具的值。</p><p id="477f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在渲染道具的<code class="fe mt mu mv mj b">Group</code>组件中，我们有<code class="fe mt mu mv mj b">LinkVertical</code>组件来添加链接父节点和子节点的线条。</p><p id="dfc2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe mt mu mv mj b">cluster.descendants</code>方法得到子节点。</p><p id="475f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将它们映射到。</p><h1 id="bd0f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="f928" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用Visx库将树状图添加到React应用程序中。</p></div></div>    
</body>
</html>