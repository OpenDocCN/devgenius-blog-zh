<html>
<head>
<title>Gentle Introduction to Neural Networks — Understanding Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">神经网络简介——了解深度学习</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/gentle-introduction-to-neural-networks-understanding-deep-learning-7cbfeed995b?source=collection_archive---------8-----------------------#2022-06-13">https://blog.devgenius.io/gentle-introduction-to-neural-networks-understanding-deep-learning-7cbfeed995b?source=collection_archive---------8-----------------------#2022-06-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7825" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Python 中的代码示例</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/17c08117273e770a9839fcfda79ae31a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*fjRy7zZEDxgBnwDVeG4fvQ.png"/></div></figure><p id="30e9" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kp ir"> <em class="lj">神经网络</em> </strong>最准确的名称是<strong class="kp ir"> <em class="lj">多层感知器</em> </strong> (MLPs)。我们可以把 MLPs 看作是几个线性模型的总和，这些线性模型在模型做出决定之前执行许多中间阶段。深度学习模型可以用于回归和分类任务。</p><p id="e23e" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我们可以用一个例子来帮助我们理解一个深度学习模型。如果我们想根据温度、压力、风和湿度(要素)等信息预测明天是否会下雨，我们可以使用线性模型，其中:</p><pre class="kg kh ki kj gt lk ll lm ln aw lo bi"><span id="5ecd" class="lp lq iq ll b gy lr ls l lt lu"><strong class="ll ir">Features:</strong><br/>x[0] → temperature<br/>x[1] → pressure<br/>x[2] → wind<br/>x[3] → humidity</span><span id="98ce" class="lp lq iq ll b gy lv ls l lt lu"><strong class="ll ir">Outcome:</strong> <br/>y = 1 → rain<br/>y = 0 → not rain</span></pre><p id="ebb9" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">当考虑线性模型时，我们可以用图形表示它:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/d6ee9ef52717d720f904ab2f82269fe3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*JlkFTYza4xZskQ8KYgSI7g.png"/></div><figcaption class="lx ly gj gh gi lz ma bd b be z dk translated">线性模型的图形表示</figcaption></figure><p id="75b8" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">其中绿点表示输入要素，蓝点表示输出。黑线是要素的权重，表示其对输出的影响。我们可以看到，该模型有 4 个系数要学习，用黑线表示。可视化的数学公式是:</p><blockquote class="mb"><p id="97c9" class="mc md iq bd me mf mg mh mi mj mk li dk translated">x[0]w[0]+x[1]w[1]+x[2]w[2]+x[3]w[3]= y</p></blockquote><p id="1ec6" class="pw-post-body-paragraph kn ko iq kp b kq ml jr ks kt mm ju kv kw mn ky kz la mo lc ld le mp lg lh li ij bi translated">通过深度学习，我们将这个过程进行得更“深入”，我们多次重复这个过程，试图改进我们的决策模型。中间步骤被称为“<strong class="kp ir"> <em class="lj">隐藏层</em> </strong>”，由我们的机器执行(我们不知道它，也不会访问它，所以命名为隐藏层)。使用上面的例子，我们可以添加一个带有三个节点的隐藏层:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/d4abec8c5f5e439236967fdfdd4d519d.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*gJ5K6fozD4MZ2ik4Bpv6Hg.png"/></div><figcaption class="lx ly gj gh gi lz ma bd b be z dk translated">具有 1 个隐藏层和 3 个节点的深度学习模型</figcaption></figure><p id="7577" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">现在，绿点是估算的要素，蓝点是隐藏图层中的节点，红点是输出。模型需要学习的系数数量是 15。</p><p id="218c" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">研究人员可以设置隐藏层中的节点数量，以及隐藏层的数量。再次使用相同的示例，可以将模型设置为使用 2 个隐藏层，第一个具有 6 个节点，第二个具有 3 个节点。这是一个更复杂的模型，有 45 个系数需要学习。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/ad344d0cb737127c750d14e57b457c84.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*uhUOv9_KCvgsReq81n4jmA.png"/></div><figcaption class="lx ly gj gh gi lz ma bd b be z dk translated">具有两个隐藏层的深度学习模型</figcaption></figure><blockquote class="ms mt mu"><p id="60c6" class="kn ko lj kp b kq kr jr ks kt ku ju kv mv kx ky kz mw lb lc ld mx lf lg lh li ij bi translated">术语<strong class="kp ir"> <em class="iq">深度学习</em> </strong>出现在模型架构中，它深入数据，有几个隐藏层。</p></blockquote><p id="f2ec" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">与机器学习中的任何其他模型一样，MLP 有优点也有缺点:</p><blockquote class="ms mt mu"><p id="a2e9" class="kn ko lj kp b kq kr jr ks kt ku ju kv mv kx ky kz mw lb lc ld mx lf lg lh li ij bi translated"><strong class="kp ir">优势:<br/> </strong> - <strong class="kp ir"> </strong>适用于大型复杂数据<br/> -能够捕获其他模型无法捕获的数据<br/> -通常胜过任何其他 ML 模型<br/> -适用于图像、声音和文本数据</p><p id="5adb" class="kn ko lj kp b kq kr jr ks kt ku ju kv mv kx ky kz mw lb lc ld mx lf lg lh li ij bi translated"><strong class="kp ir">缺点:</strong> <br/> -要求计算量大<br/> -训练时间长(部分模型/数据需要 GPU)<br/>-要求仔细的数据预处理<br/> -难以/不可能理解</p></blockquote><h1 id="d8fe" class="my lq iq bd mz na nb nc nd ne nf ng nh jw ni jx nj jz nk ka nl kc nm kd nn no bi translated">天气数据集的应用示例:</h1><p id="c597" class="pw-post-body-paragraph kn ko iq kp b kq np jr ks kt nq ju kv kw nr ky kz la ns lc ld le nt lg lh li ij bi translated">在这个例子中，我将使用包含在<a class="ae nu" href="https://www.kaggle.com/datasets/zaraavagyan/weathercsv" rel="noopener ugc nofollow" target="_blank"> weather.csv </a>数据集中的部分数据。您可以通过从数据集中选择任意四个数字要素来遵循此示例。</p><pre class="kg kh ki kj gt lk ll lm ln aw lo bi"><span id="0271" class="lp lq iq ll b gy lr ls l lt lu">import numpy as np<br/>import pandas as pd</span><span id="5f62" class="lp lq iq ll b gy lv ls l lt lu">df = pd.read_csv("/content/weather_2.csv")<br/>df</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/a94a025e8fefbc7adcb063324bff464a.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*THLEMNYDvSlggzaA8AU6fw.png"/></div></figure><p id="5014" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">这是我将用来建立模型的数据。如你所见，数据没有被标准化，这对于建立深度学习模型是必不可少的。为了标准化数据，我们将使用预处理中的 StandardScaler:</p><pre class="kg kh ki kj gt lk ll lm ln aw lo bi"><span id="c87c" class="lp lq iq ll b gy lr ls l lt lu">from sklearn import preprocessing</span><span id="8539" class="lp lq iq ll b gy lv ls l lt lu"><strong class="ll ir">#Normalize data using StandardScaler:</strong></span><span id="8f5c" class="lp lq iq ll b gy lv ls l lt lu"><strong class="ll ir">#Define X and y:<br/></strong>y = df['rain']<br/>X = df.drop('rain', axis=1)</span><span id="7234" class="lp lq iq ll b gy lv ls l lt lu"><strong class="ll ir">#Create array:<br/></strong>X = np.array(X)</span><span id="bc68" class="lp lq iq ll b gy lv ls l lt lu"><strong class="ll ir">#Define preprocessing method:<br/></strong>scaler = preprocessing.StandardScaler().fit(X)</span><span id="c9bf" class="lp lq iq ll b gy lv ls l lt lu"><strong class="ll ir">#Transform X:<br/></strong>X_scaled = scaler.transform(X</span><span id="6b73" class="lp lq iq ll b gy lv ls l lt lu"><strong class="ll ir">#Convert np.array to pd.DataFrame:<br/></strong>X = pd.DataFrame(X_scaled)</span><span id="9836" class="lp lq iq ll b gy lv ls l lt lu"><strong class="ll ir">#Inspect X:</strong><br/>X</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/174e18676f4854c6f17e69a92527a1f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/format:webp/1*YBdUS5focBGHHfjtZ0EQCA.png"/></div></figure><p id="66dc" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我们还需要将数据分成训练样本和测试样本:</p><pre class="kg kh ki kj gt lk ll lm ln aw lo bi"><span id="a1fb" class="lp lq iq ll b gy lr ls l lt lu">from sklearn.model_selection import train_test_split</span><span id="5a8c" class="lp lq iq ll b gy lv ls l lt lu"><strong class="ll ir">#Split data into train an test, with test size of 20%:</strong>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, stratify=y, random_state=42)</span></pre><p id="db8f" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">现在构建模型:</p><pre class="kg kh ki kj gt lk ll lm ln aw lo bi"><span id="1992" class="lp lq iq ll b gy lr ls l lt lu">from sklearn.neural_network import MLPClassifier</span><span id="5400" class="lp lq iq ll b gy lv ls l lt lu"><strong class="ll ir">#Build and fit the model:<br/></strong>clf = MLPClassifier(random_state=1, max_iter=1000).fit(X_train, y_train)</span><span id="2feb" class="lp lq iq ll b gy lv ls l lt lu"><strong class="ll ir">#Evaluate the model:<br/></strong>print("accuracy on training set: %f" % clf.score(X_train, y_train))<br/>print("accuracy on test set: %f" % clf.score(X_test, y_test))</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/e6b73afa90ef794841d1908bcb233166.png" data-original-src="https://miro.medium.com/v2/resize:fit:604/format:webp/1*BQS9yDgnUghPTMKH657-jw.png"/></div></figure><p id="cd12" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">使用 Sci-Kit Learn，默认的隐藏层数是 1，有 100 个节点。我们可以改变这个值并建立用户特定的神经网络:</p><pre class="kg kh ki kj gt lk ll lm ln aw lo bi"><span id="1997" class="lp lq iq ll b gy lr ls l lt lu"><strong class="ll ir">#Build and fit a model with 1 hidden layer with 3 nodes:</strong>clf_2 = MLPClassifier(random_state=1, max_iter=1000, hidden_layer_sizes=[3]).fit(X_train, y_train)</span><span id="c113" class="lp lq iq ll b gy lv ls l lt lu"><strong class="ll ir">#Evaluate the model:<br/></strong>print("accuracy on training set: %f" % clf_2.score(X_train, y_train))<br/>print("accuracy on test set: %f" % clf_2.score(X_test, y_test))</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/58fcbde02e30d628bde17a8260b6e42b.png" data-original-src="https://miro.medium.com/v2/resize:fit:616/format:webp/1*e8k0iHlxahVfsGUsTqFU5g.png"/></div></figure><pre class="kg kh ki kj gt lk ll lm ln aw lo bi"><span id="b0e9" class="lp lq iq ll b gy lr ls l lt lu"><strong class="ll ir">#Build and fit a model with 2 hidden layer with 6 and 3 nodes:<br/></strong>clf_3 = MLPClassifier(random_state=1, max_iter=1000, hidden_layer_sizes=[6, 3]).fit(X_train, y_train)</span><span id="e597" class="lp lq iq ll b gy lv ls l lt lu"><strong class="ll ir">#Evaluate the model:<br/></strong>print("accuracy on training set: %f" % clf_3.score(X_train, y_train))<br/>print("accuracy on test set: %f" % clf_3.score(X_test, y_test))</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/5fef7f42c382dd104d6914c7ba8cbb8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/1*-G9qY7uCfTE4HMpVZqrXlA.png"/></div></figure><p id="9dcb" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">感谢您的阅读。</p><p id="b436" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kp ir">如果:</strong>你喜欢这篇文章，别忘了关注我，这样你就能收到关于新出版物的所有更新。</p><p id="bf0b" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kp ir">其他如果:</strong>你想了解更多，你可以通过<a class="ae nu" href="https://cdanielaam.medium.com/membership" rel="noopener">我的推荐链接</a>订阅媒体会员。它不会花你更多的钱，但会支付我一杯咖啡。</p><p id="4018" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kp ir">其他:</strong>谢谢！</p></div></div>    
</body>
</html>