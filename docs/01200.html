<html>
<head>
<title>Automation for Web Performance — All Flavours Lighthouse</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Web 性能自动化—各种风格灯塔</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/automation-for-web-performance-all-flavours-lighthouse-3d90eabfdafa?source=collection_archive---------25-----------------------#2020-06-26">https://blog.devgenius.io/automation-for-web-performance-all-flavours-lighthouse-3d90eabfdafa?source=collection_archive---------25-----------------------#2020-06-26</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/b2c8a55fbf9e944f97e388af019ba17b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pjHsSX85eHR-SGm_11cggA.jpeg"/></div></div></figure><p id="1d8b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">Google Lighthouse 是一个令人惊叹的工具，它改变了我们看待网络性能的方式，现在指引我们努力改进它。让我们展示一下自动化审计和收集多种格式的数据是多么容易！</p><h1 id="acce" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">Web 性能一瞥🚄</h1><p id="0e34" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">在过去的四到五年里，<strong class="jx io">网络性能</strong>已经成为整个互联网行业讨论和创新的一个巨大话题。对于任何人来说，能够简单地定义聚集在这个术语下的组件都是非常方便的，但事实并非如此。</p><p id="016f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在一个非常高的层次上，我们可以列出几个<strong class="jx io">已经明确的</strong>面向网络的:</p><ul class=""><li id="1193" class="lw lx in jx b jy jz kc kd kg ly kk lz ko ma ks mb mc md me bi translated">作为主机平台的浏览器内部工作方式</li><li id="a4e2" class="lw lx in jx b jy mf kc mg kg mh kk mi ko mj ks mb mc md me bi translated">数据有效载荷</li><li id="5070" class="lw lx in jx b jy mf kc mg kg mh kk mi ko mj ks mb mc md me bi translated">用户界面/用户体验</li></ul><p id="6eeb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我脑海中很容易出现的三个项目，是值得大量信息、细节和技术爱好的主题。不过好的一面是，我们不需要消化所有的信息来在我们自己的项目环境中改进它们。</p><h1 id="22f5" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">灯塔</h1><p id="ffe9" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">仅仅一撮理解就足够了，这里就是<a class="ae mk" href="https://developers.google.com/web/tools/lighthouse" rel="noopener ugc nofollow" target="_blank">灯塔</a>出现的地方。</p><figure class="mm mn mo mp gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ml"><img src="../Images/62abda78594d5d668ce7eb9e0223204a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*VR415fQ7cAMuV0VH.png"/></div></div></figure><p id="61cd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">Lighthouse 是一款帮助技术专家审计、监控和提高网页整体质量的工具，在 Google Chrome 旗下开源。如果你还不知道，它已经包含在你的 Chrome 和 Edge 浏览器中了。如果你还不知道如何运行它的一些细节。<br/> <em class="mq">灯塔标签在</em> <a class="ae mk" href="https://developers.google.com/web/tools/lighthouse#devtools" rel="noopener ugc nofollow" target="_blank"> <em class="mq">镀铬</em> </a> <em class="mq">，灯塔标签在</em> <a class="ae mk" href="https://docs.microsoft.com/en-us/microsoft-edge/devtools-guide-chromium/whats-new/2020/03/devtools#the-audits-panel-is-now-the-lighthouse-panel" rel="noopener ugc nofollow" target="_blank"> <em class="mq">边缘</em> </a> <em class="mq">。</em></p><p id="5cba" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">【总体】</strong>对于软件专家来说，听起来可能有些厚脸皮和软弱。令他们惊讶的是，至少在我看来,《灯塔计划》是一个已经、正在并将继续改善网络质量的项目，因为我们在许多方面都体验到了它。默认情况下，它包括以下建议:</p><ul class=""><li id="5f6f" class="lw lx in jx b jy jz kc kd kg ly kk lz ko ma ks mb mc md me bi translated">表演</li><li id="0f98" class="lw lx in jx b jy mf kc mg kg mh kk mi ko mj ks mb mc md me bi translated">渐进式网络应用</li><li id="b14e" class="lw lx in jx b jy mf kc mg kg mh kk mi ko mj ks mb mc md me bi translated">最佳实践</li><li id="a418" class="lw lx in jx b jy mf kc mg kg mh kk mi ko mj ks mb mc md me bi translated">易接近</li><li id="d446" class="lw lx in jx b jy mf kc mg kg mh kk mi ko mj ks mb mc md me bi translated">搜索引擎优化</li></ul><p id="99d3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">来自整个技术社区的许多人的巨大工程努力，使这个工具成为一个发电站，并且无可争议地成为性能监控的“首选”。</p><blockquote class="mr ms mt"><p id="0a80" class="jv jw mq jx b jy jz ka kb kc kd ke kf mu kh ki kj mv kl km kn mw kp kq kr ks ig bi translated">如果我是你，我会马上探索这些类别和功能，投资回报是巨大的！</p></blockquote><p id="d749" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">当你从工具的神奇中恢复过来后…🤯</p><p id="a12c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我告诉您，Lighthouse 生成的整个报告，以及粒度性能指标和更多数据，可以使用一个命令自动检索，或者在更复杂的情况下，只需几行 JavaScript 代码。</p><p id="b0dd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">现在就行动！</strong></p><h1 id="8f74" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">灯塔单线🛤</h1><p id="8743" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">如果您希望运行 Lighthouse 的特定页面或页面集对所有<strong class="jx io">的</strong>有效，请遵循以下标准:</p><p id="4356" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">-可公开访问<br/> -不区分已知和匿名用户<br/> -不需要以前的应用程序状态</p><p id="e3bf" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">然后你可以只使用<a class="ae mk" href="https://github.com/GoogleChrome/lighthouse#using-the-node-cli" rel="noopener ugc nofollow" target="_blank"> lighthouse-cli </a>或者使用<a class="ae mk" href="https://developers.google.com/speed/pagespeed/insights/?hl=en" rel="noopener ugc nofollow" target="_blank">Google page speed Insights</a>(<em class="mq">在内部使用 light house</em>)，你不需要任何额外的东西。</p><p id="59f0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">您可以遵循一个简单的设置，从一个裸 Node.js 项目开始，使用命令行界面提供一个单独的位置来运行和存储您的 Lighthouse 报告。</p><p id="601d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在您的命令行中，让我们为手头的任务构建一个新项目:</p><pre class="mm mn mo mp gt mx my mz na aw nb bi"><span id="e4af" class="nc ku in my b gy nd ne l nf ng">mkdir auto-lighthouse<br/>cd auto-lighthouse<br/>npm init -y</span></pre><p id="e91e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">搭建好项目之后，接下来是安装所需的库:</p><pre class="mm mn mo mp gt mx my mz na aw nb bi"><span id="730b" class="nc ku in my b gy nd ne l nf ng">npm install lighthouse</span></pre><p id="625d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">只有安装了 Lighthouse npm 模块，您现在才能运行:</p><pre class="mm mn mo mp gt mx my mz na aw nb bi"><span id="507c" class="nc ku in my b gy nd ne l nf ng">npx lighthouse <a class="ae mk" href="https://dev.to" rel="noopener ugc nofollow" target="_blank">https://dev.to</a></span></pre><p id="6a86" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在发生的是，你会看到一个谷歌 Chrome 实例在你的机器上启动，自动导航到提供的 URL，做一些魔法🧙‍♂️，最后在项目文件夹中生成一个文件。生成的文件是一个 HTML 文件，其名称结构如下:<br/><strong class="jx io">【SUPPLIED _ URL } { DATE }</strong></p><p id="8294" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在你选择的浏览器中打开这个文件。在那里，你有一份惊人的报告要在你的团队中分发，以揭示他们的<em class="mq">无能</em>🤣</p><figure class="mm mn mo mp gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ml"><img src="../Images/3e39d35f8eae61436247df5f4ed829fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Q-2dq2j6zIsh74qB.png"/></div></div></figure><p id="c741" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="mq">特别提示:如果您想保存文件，但又想在浏览器中自动打开报告，您可以使用</em> <code class="fe nh ni nj my b"><em class="mq">--view</em></code> <em class="mq">选项运行 cli 命令。</em></p><p id="1d09" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="mq"> **如果你想知道为什么你的报告显示设备字段为“仿真 Moto G4”，你不是唯一一个感到困惑的人。监控兔子洞</em> <a class="ae mk" href="https://github.com/GoogleChrome/lighthouse/issues?q=is%3Aissue+mobile+emulation" rel="noopener ugc nofollow" target="_blank"> <em class="mq">这里</em> </a>🐰</p><h1 id="fc97" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">为您量身定制的更进一步👔</h1><p id="0dfa" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">既然你走到了这一步，你要么对我们的精彩内容感兴趣，要么你想让你的灯塔报告自动化的情况有点复杂，例如…</p><ul class=""><li id="67f1" class="lw lx in jx b jy jz kc kd kg ly kk lz ko ma ks mb mc md me bi translated">用户需要通过身份验证才能看到目标页面</li><li id="4242" class="lw lx in jx b jy mf kc mg kg mh kk mi ko mj ks mb mc md me bi translated">必须有一些浏览器/应用程序状态被初始化</li></ul><p id="2320" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="mq">嗯… </em> <br/> <em class="mq">我们无法使用 lighthouse cli 在浏览器中预烤状态… </em> <br/> <em class="mq">我们无法在不进行登录操作的情况下安全地认证用户至少… </em></p><p id="2662" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">那么我们将如何应对这些情况呢？🤔</strong></p><p id="7d2d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">当然，我们可以使用我们最喜欢的 Node.js 浏览器自动化库，<strong class="jx io">木偶师或剧作家</strong>。使用这些库，我们将能够编排达到正确的应用程序状态所需的步骤，然后运行 Lighthouse。</p><h1 id="fa9e" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">现在是代码👨‍💻</h1><p id="b7c9" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">* <em class="mq">我相信你渴望进入代码，这就是我们要做的。但是随着我们的进展，我会尽我所能来解释在试图完成这个过程时看起来不清楚的地方(至少对我来说)。</em></p><p id="6d18" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">首先，你应该继续安装额外的 npm 包，我们将需要使这个工作。出于演示的目的，我们将安装<a class="ae mk" href="https://www.thehomeofwebautomation.com/getting-started-puppeteer/" rel="noopener ugc nofollow" target="_blank">木偶操纵者</a>。</p><pre class="mm mn mo mp gt mx my mz na aw nb bi"><span id="2b0c" class="nc ku in my b gy nd ne l nf ng">npm install puppeteer</span></pre><p id="b798" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">接下来，使用以下上下文创建一个名为<em class="mq"> index.js </em>的新文件:</p><pre class="mm mn mo mp gt mx my mz na aw nb bi"><span id="3ca3" class="nc ku in my b gy nd ne l nf ng">const puppeteer = require("puppeteer");<br/>const lighthouse = require("lighthouse");</span><span id="1e45" class="nc ku in my b gy nk ne l nf ng">(async function(){<br/>  const url = "https://dev.to"; /* Random */<br/>  const PORT = 9222; /* Not arbitrary, the default Lighthouse would look for if not specified in options */</span><span id="13c7" class="nc ku in my b gy nk ne l nf ng">  const browser = await puppeteer.launch({<br/>    args: [`--remote-debugging-port=${PORT}`], /* Expose this so we can use it below */<br/>  });</span><span id="aebc" class="nc ku in my b gy nk ne l nf ng">  const lighthouseOpts = {<br/>    port: PORT,<br/>    disableStorageReset: true /* For the custom steps we will show later */<br/>    logLevel: 'info', /* To observe the good stuff */<br/>  };</span><span id="6d1d" class="nc ku in my b gy nk ne l nf ng">  /* Run Lighthouse, using the options specified */<br/>  const lighthouseResult = await lighthouse(url, lighthouseOpts);<br/>  console.log(lighthouseResult.lhr) /* Inspect the "lhr" (lighthouse report) property in the console */</span><span id="f9ef" class="nc ku in my b gy nk ne l nf ng">  /* Kill the browser 🔪 */<br/>  await browser.close()<br/>})();</span></pre><blockquote class="mr ms mt"><p id="f1fc" class="jv jw mq jx b jy jz ka kb kc kd ke kf mu kh ki kj mv kl km kn mw kp kq kr ks ig bi translated"><em class="in">可能你想到的第一个问题是:</em> <strong class="jx io"> <em class="in">我们为什么要用这个</em>远程调试端口<em class="in">的东西？</em>T25】</strong></p></blockquote><p id="e778" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">Lighthouse 的编程能力之一是，它可以通过使用浏览器正在使用的端口将<a class="ae mk" href="https://github.com/GoogleChrome/lighthouse/blob/master/lighthouse-core/gather/connections/cri.js#L24" rel="noopener ugc nofollow" target="_blank">连接到现有的浏览器实例。</a></p><p id="443a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果您现在运行该脚本，它将具有与 CLI 版本完全相同的行为，但是它不会在您的目录中产生新的 HTML 报告，相反，它只会记录控制台上的<em class="mq"> lhr </em>属性。</p><h1 id="89ba" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">添加自定义步骤🔧</h1><p id="07e2" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">正如你可能已经怀疑的那样，有一个地方可以放入额外的逻辑，以便将应用程序驱动到你需要的状态。</p><pre class="mm mn mo mp gt mx my mz na aw nb bi"><span id="06c4" class="nc ku in my b gy nd ne l nf ng">const browser = await puppeteer.launch({/*...*/});</span><span id="ee5a" class="nc ku in my b gy nk ne l nf ng">/*<br/> * Additional Web Automation logic<br/> * await authenticate(browser, ...args);<br/> * await fillEphemeralStorage(browser, ...args);<br/> * ...<br/> */</span><span id="9759" class="nc ku in my b gy nk ne l nf ng">const lighthouseOpts = { /*...*/ };</span></pre><p id="a765" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">您将使用的函数示例:</p><pre class="mm mn mo mp gt mx my mz na aw nb bi"><span id="7761" class="nc ku in my b gy nd ne l nf ng">async function authenticate(browser, signinUrl){<br/>  const page = await browser.newPage();<br/>  await page.goto(signinUrl);</span><span id="ec58" class="nc ku in my b gy nk ne l nf ng">  const emailInput = await page.$("input[type=email]");<br/>  await emailInput.type("admin@admin.com");<br/>  await page.click("button[id=go]");<br/>  await page.waitForNavigation();</span><span id="643d" class="nc ku in my b gy nk ne l nf ng">  await page.close();<br/>}</span></pre><p id="e27b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">诸如此类的函数将导致特定于您的应用程序需求的状态，但请记住，它可能与以下内容有关:</p><p id="b6fa" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">-浏览器存储的凭证(<em class="mq">cookie</em>)🍪<br/> -本地浏览器状态(<em class="mq">索引数据库、本地存储等</em>)🏦<br/> -短命 app 特定条件👻</p><p id="7a17" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">完成设置功能后，可以调用 Lighthouse 在目标 URL 上运行。</p><h1 id="dcda" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">一个重要的灯塔参数🚦</h1><p id="af99" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">由于 Lighthouse 的内部工作方式、要收集的指标和收集的启发式方法，每次请求审计时，都会打开一个新页面，但会清理掉<strong class="jx io">浏览器存储的</strong>，除非另有说明。为了从一张<em class="mq">干净的“石板”</em>开始，这是可以理解的。你可以在这里看到这个过程<a class="ae mk" href="https://github.com/GoogleChrome/lighthouse/blob/91b4461c214c0e05d318ec96f6585dcca52a51cc/lighthouse-core/gather/driver.js#L1457" rel="noopener ugc nofollow" target="_blank">的代码。</a></p><p id="89bc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了确保我们的设置不会被 Lighthouse 重置，我们传递了参数</p><pre class="mm mn mo mp gt mx my mz na aw nb bi"><span id="296d" class="nc ku in my b gy nd ne l nf ng">disableStorageReset: true</span></pre><p id="ffc2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在我们的设置是安全的！</p><h1 id="ad77" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">处理报告📈</h1><p id="aaf2" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">目前，我们在报告中所做的唯一处理是在控制台中将其注销。<strong class="jx io">没那么得心应手！</strong></p><p id="6cab" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">对我们有利的是，Lighthouse API 公开了一种方法，通过提供收集的数据和我们希望生成报告的格式，我们可以生成一个完整的报告。</p><pre class="mm mn mo mp gt mx my mz na aw nb bi"><span id="f4cd" class="nc ku in my b gy nd ne l nf ng">/* ... */<br/>const { generateReport } = require("lighthouse/lighthouse-core/report/report-generator");<br/>const fs = require("fs");<br/>/* ... */<br/>const { lhr } = await lighthouse(url, lighthouseOpts);<br/>fs.writeFileSync("./report.json", generateReport(lhr, "json") );</span></pre><p id="33a1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们在这里所做的是演示如何使用<code class="fe nh ni nj my b">generateReport</code>函数创建一个<em class="mq"> JSON </em>格式的新报告，并将其放入当前目录中一个名为<em class="mq"> report.json </em>的新文件中。</p><p id="c9d7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="mq">* generate report 函数可以用来输出</em><strong class="jx io"><em class="mq">JSON</em></strong><em class="mq">，</em><strong class="jx io"><em class="mq">CSV</em></strong><em class="mq">和</em><strong class="jx io"><em class="mq">HTML</em></strong><em class="mq">格式。</em></p><p id="0f20" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果你打开这个文件，你可以看到所有的网络质量指标。您很有可能不知道 Lighthouse 收集和报告了多少信息🎉</p><p id="00ec" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">安排脚本在您管理的所有网站上运行，一切就绪！</strong></p><h1 id="fd11" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">关闭🎗</h1><p id="f26d" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">谢谢你又看了一遍食谱。我希望你有更多的弹药来说服你的项目领导，自动化灯塔审计可以给你带来更多的好处。我的建议是请一天假，看看并研究所有报告的指标。时间花得值！</p><p id="80cb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在您的团队/组织内传播报告和专业见解，以推动更好的变化，使最终用户受益。在不久的将来，我们将会看到更多关于 web 自动化和性能监控的东西。到时候见！</p><p id="884f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="mq">转贴自</em><a class="ae mk" href="https://www.thehomeofwebautomation.com/foot-in-the-door/" rel="noopener ugc nofollow" target="_blank"><em class="mq">Web 自动化之家</em> </a></p></div></div>    
</body>
</html>