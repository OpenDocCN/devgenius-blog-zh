<html>
<head>
<title>Create a Weather App Using Django</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Django 创建天气应用程序</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/creating-a-weather-app-using-using-django-8f6d9d346f2b?source=collection_archive---------12-----------------------#2022-01-24">https://blog.devgenius.io/creating-a-weather-app-using-using-django-8f6d9d346f2b?source=collection_archive---------12-----------------------#2022-01-24</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/183a2600c0ca72bd58cd931c5a83595f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*la4s4IBKba0Ki8yf"/></div></div></figure><p id="6781" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这篇文章展示了如何使用 Weather API 创建一个天气应用程序，为我们提供实时天气数据。我们将使用 Django 后端框架。</p><p id="63ec" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">1/创建天气项目</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="edb5" class="lc ld in ky b gy le lf l lg lh">$ django-admin startproject weather</span></pre><p id="f1db" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">2/导航内部天气</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="a201" class="lc ld in ky b gy le lf l lg lh">$ cd weather</span></pre><p id="128b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">3/启动服务器，检查服务器是否正在运行</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="88d9" class="lc ld in ky b gy le lf l lg lh">$ python manage.py runserver</span></pre><p id="af6b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在浏览器中输入<a class="ae li" href="http://127.0.0.1:800/" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:800/ </a></p><p id="2e67" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">按 ctrl + c 停止服务器。</p><p id="56b2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">4/通过键入以下命令，在项目中创建一个名为“main”的应用程序:</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="6e65" class="lc ld in ky b gy le lf l lg lh">$ python manage.py startapp main</span></pre><p id="d72e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">5/转到主目录并创建“模板”文件夹。在此文件夹中创建“index.html”文件。这个文件用于在前端显示天气数据。目录结构将类似于:</p><figure class="kt ku kv kw gt jo gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/c568f705fecba6b9508969a15c3d64fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/0*Psuem_sf2LE0HqV5"/></div></figure><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="cf7e" class="lc ld in ky b gy le lf l lg lh">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en" dir="ltr"&gt;<br/><br/>&lt;head&gt;<br/>    &lt;meta charset="utf-8"&gt;<br/>    &lt;title&gt;Weather&lt;/title&gt;<br/>    &lt;link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css"&gt;<br/>    &lt;script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"&gt;&lt;/script&gt;<br/>    &lt;script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"&gt;&lt;/script&gt;<br/><br/>    &lt;style&gt;<br/>        body {<br/>            background-color: #D3D3D3;<br/>        }<br/>    &lt;/style&gt;<br/><br/>&lt;/head&gt;<br/><br/>&lt;body&gt;<br/>    &lt;nav class="row navtitle" style="background: gray; color: white;"&gt;<br/>        &lt;h1 class="col text-center"&gt;How is the weather? &lt;/h1&gt;<br/>    &lt;/nav&gt;<br/>    &lt;br /&gt;<br/>    &lt;br /&gt;<br/>    &lt;center class="row"&gt;<br/><br/>        &lt;form method="post" class="col-md-6 col-md-offset-3"&gt;<br/>            {% csrf_token %}<br/>            &lt;div class="input-group"&gt;<br/>                &lt;input type="text" class="form-control" name="city" placeholder="Search"&gt;<br/>                &lt;div class="input-group-btn"&gt;<br/>                    &lt;button class="btn btn-default" type="submit"&gt;&lt;i class="glyphicon glyphicon-search"&gt;&lt;/i&gt;&lt;/button&gt;<br/>                &lt;/div&gt;<br/>            &lt;/div&gt;<br/>            &lt;form&gt;<br/><br/>    &lt;/center&gt;<br/>    &lt;div class="row"&gt;<br/>        {% if country_code and coordinate and temp and pressure and humidity %}<br/>        &lt;div class="col-md-6 col-md-offset-3"&gt;<br/>            &lt;h3&gt;City : {{city}}&lt;/h3&gt;<br/>            &lt;h4&gt;Country code : {{country_code}}&lt;/h4&gt;<br/>            &lt;h5&gt;Coordinate : {{coordinate}}&lt;/h5&gt;<br/>            &lt;h5&gt;Temperature : {{temp}}&lt;/h5&gt;<br/>            &lt;h5&gt;Pressure : {{pressure}} &lt;/h5&gt;<br/>            &lt;h5&gt;Humidity : {{humidity}}&lt;/h5&gt;<br/>        &lt;/div&gt;<br/>        {% endif %}<br/>    &lt;/div&gt;<br/>&lt;/body&gt;<br/><br/>&lt;/html&gt;</span></pre><p id="232d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">6/将应用添加到“<a class="ae li" href="http://settings.py" rel="noopener ugc nofollow" target="_blank">设置. py </a></p><figure class="kt ku kv kw gt jo gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/d9037de412d29d3c9ca53a7d7c9bcb1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/0*_f8gE-oqesZzT85z"/></div></figure><p id="3a5c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">7/将网址添加到“天气”文件夹中的“<a class="ae li" href="http://urls.py" rel="noopener ugc nofollow" target="_blank">网址. py </a>”中。代码如下所示</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="915c" class="lc ld in ky b gy le lf l lg lh">from django.contrib import admin<br/>from django.urls import path, include<br/><br/>urlpatterns = [<br/>    path('admin/', admin.site.urls),<br/>    path('', include('main.urls')),<br/>]</span></pre><p id="a6db" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">8/在' main '文件夹中创建'<a class="ae li" href="http://urls.py" rel="noopener ugc nofollow" target="_blank"> urls.py </a>，并添加以下代码来定义索引的路径</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="8040" class="lc ld in ky b gy le lf l lg lh">from django.urls import path<br/>from . import views<br/><br/>urlpatterns = [<br/>         path('', views.index),<br/>]</span></pre><p id="bfbf" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">9/现在，为应用程序创建视图。转到'<a class="ae li" href="http://views.py" rel="noopener ugc nofollow" target="_blank"> views.py </a>'文件并添加索引视图。我们可以从'<a class="ae li" href="https://openweathermap.org/api'" rel="noopener ugc nofollow" target="_blank">openweathermap.org/api'</a>得到一个 API 密匙</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="3f90" class="lc ld in ky b gy le lf l lg lh">from django.shortcuts import render<br/>import json  # import json to load json data to python dictionary<br/>import urllib.request  # urllib.request to make a request to api<br/><br/>def index(request):<br/>    if request.method == 'POST':<br/>        city = request.POST['city']<br/><br/>        ''' api key might be expired use your own api_key<br/>            place api_key in place of appid ="your_api_key_here "  '''<br/>        # source contain JSON data from API<br/>        source = urllib.request.urlopen('http://api.openweathermap.org/data/2.5/weather?q=' + city + '&amp;appid=718bfb40fec2a75aee7767677f367613').read()<br/><br/>        # converting JSON data to a dictionary<br/>        list_of_data = json.loads(source)<br/><br/>        # data for variable list_of_data<br/>        data = {<br/>            'city': city,<br/>            "country_code": str(list_of_data['sys']['country']),<br/>            "coordinate": str(list_of_data['coord']['lon']) + ' '<br/>                        + str(list_of_data['coord']['lat']),<br/>            "temp": str(list_of_data['main']['temp']) + 'k',<br/>            "pressure": str(list_of_data['main']['pressure']),<br/>            "humidity": str(list_of_data['main']['humidity']),<br/>        }<br/>        print(data)<br/>    else:<br/>        data ={}<br/>    return render(request, "index.html", data)</span></pre><p id="d17c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">10/进行迁移并迁移它。这一步是这个应用程序的可选步骤，因为我们没有制作任何模型。当我们需要改变数据库的配置时，我们在 Django 中进行迁移。我们可以通过输入命令来完成</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="afc8" class="lc ld in ky b gy le lf l lg lh">$ python manage.py makemigrations</span><span id="1cf6" class="lc ld in ky b gy ll lf l lg lh">$ python manage.py migrate</span></pre><figure class="kt ku kv kw gt jo gh gi paragraph-image"><div class="gh gi lm"><img src="../Images/04bca61cb4119e7d142465815f5b125e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/0*tedLc4UPodN5DV1c"/></div></figure><p id="1cc3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">11/运行应用程序</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="7a21" class="lc ld in ky b gy le lf l lg lh">$ python manage.py runserver</span></pre><p id="596b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">以下是最终结果:</p><figure class="kt ku kv kw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ln"><img src="../Images/98b238aa01806808146608e30c3f2da1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4hAg3L_ZRe94bPDJLVLELg.png"/></div></div></figure><p id="c079" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">GitHub <a class="ae li" href="https://github.com/Ugyenwangdi/DjangoWeather/tree/master" rel="noopener ugc nofollow" target="_blank">链接</a></p><p id="6d84" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">主办于<a class="ae li" href="https://whatdowea.herokuapp.com/" rel="noopener ugc nofollow" target="_blank"> heroku </a></p><p id="18b0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">参考:<a class="ae li" href="https://www.geeksforgeeks.org/weather-app-using-django-python/" rel="noopener ugc nofollow" target="_blank">使用 django 的天气应用</a></p></div><div class="ab cl lo lp hr lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ig ih ii ij ik"><p id="9825" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="lv">原载于</em><a class="ae li" href="https://wulfi.hashnode.dev/creating-a-weather-app-using-using-django" rel="noopener ugc nofollow" target="_blank"><em class="lv">https://wulfi . hash node . dev</em></a><em class="lv">。</em></p></div></div>    
</body>
</html>