<html>
<head>
<title>Laravel-Excel — P10: Export from View</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Laravel-Excel — P10:从视图导出</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/laravel-excel-p10-export-from-view-7fca03cc0d4?source=collection_archive---------1-----------------------#2022-10-11">https://blog.devgenius.io/laravel-excel-p10-export-from-view-7fca03cc0d4?source=collection_archive---------1-----------------------#2022-10-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/bdadc943013c98ce94f4c8e7f53b0805.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zBDV2QY18lB568EXB5SL_Q.jpeg"/></div></div></figure><p id="dec4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们讨论了将项目从数据库表导出到工作表，但是我们还没有真正讨论如何定制工作表。</p><div class="kw kx gp gr ky kz"><a href="https://dinocajic.medium.com/laravel-excel-p9-exports-bff04e5c2c14" rel="noopener follow" target="_blank"><div class="la ab fo"><div class="lb ab lc cl cj ld"><h2 class="bd ir gy z fp le fr fs lf fu fw ip bi translated">P9:出口</h2><div class="lg l"><h3 class="bd b gy z fp le fr fs lf fu fw dk translated">我认为在前 8 篇文章中，我们已经很好地了解了进口。是时候切换到导出数据了…</h3></div><div class="lh l"><p class="bd b dl z fp le fr fs lf fu fw dk translated">dinocajic.medium.com</p></div></div><div class="li l"><div class="lj l lk ll lm li ln jw kz"/></div></div></a></div><p id="fdd3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们想做的是创建一种独特的方式来显示内容，甚至可能注入一些没有存储在数据库中的项目。这涉及到在 Laravel 中使用刀片组件。</p><p id="d293" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一步一步来。首先，我们需要创建我们的出口商。</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="2afc" class="lx ly iq lt b gy lz ma l mb mc">php artisan make:export ViewExporter --model=User</span></pre><p id="ffdc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是该命令生成的内容。</p><figure class="lo lp lq lr gt jr"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="dbca" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是我们需要实现<code class="fe mf mg mh lt b">FromView</code>，而不是实现<code class="fe mf mg mh lt b">FromCollection</code>。<code class="fe mf mg mh lt b">FromView</code>问题需要<code class="fe mf mg mh lt b">view</code>方法。它会返回一个<code class="fe mf mg mh lt b">View</code>。</p><figure class="lo lp lq lr gt jr"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="a13b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">接下来，我们需要一个视图。创建视图的方式与您通常创建视图的方式完全相同。我将在<code class="fe mf mg mh lt b">views</code>下一个名为<code class="fe mf mg mh lt b">exports</code>的子目录中创建一个名为<code class="fe mf mg mh lt b">users.blade.php</code>的视图。</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="586c" class="lx ly iq lt b gy lz ma l mb mc">project_name/resources/views/exports/users.blade.php</span></pre><p id="375d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在视图内部，我们需要一个<code class="fe mf mg mh lt b">table</code>。该表将被转换成我们的 Excel 表中的数据。将标题数据添加到表格的<code class="fe mf mg mh lt b">thead</code>组件中。细胞数据将进入我们的<code class="fe mf mg mh lt b">tbody</code>。</p><figure class="lo lp lq lr gt jr"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="122b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要调用<code class="fe mf mg mh lt b">view</code>，将下面的代码片段添加到您的导出器中:</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="87fa" class="lx ly iq lt b gy lz ma l mb mc">return view('exports.users');</span></pre><figure class="lo lp lq lr gt jr"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="76b3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们只需要创建一个对我们的<code class="fe mf mg mh lt b">ViewExporter</code>的调用来启动下载。</p><figure class="lo lp lq lr gt jr"><div class="bz fp l di"><div class="md me l"/></div></figure><figure class="lo lp lq lr gt jr"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="82e0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们得到的结果如下。</p><figure class="lo lp lq lr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mi"><img src="../Images/fa77b0452fd059db4bc56624832174e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nJ2-eoU1cxvfc648eLiJoQ.png"/></div></div></figure><p id="e0bc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要获得实际的用户数据来显示，我们只需使用我们的 Laravel 知识并将<code class="fe mf mg mh lt b">User</code>数据作为参数传递给视图。然后，我们可以使用 blade 指令遍历数据。</p><figure class="lo lp lq lr gt jr"><div class="bz fp l di"><div class="md me l"/></div></figure><figure class="lo lp lq lr gt jr"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="82a2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">再次调用路由会产生以下文件。</p><figure class="lo lp lq lr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mj"><img src="../Images/1f12ecd160ddafe0ba8a53465cd5feda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*67AWo836TSO-3pr0uBby6Q.png"/></div></div></figure><p id="2c40" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们用<code class="fe mf mg mh lt b">strong</code>标签包装我们的头会怎么样？</p><figure class="lo lp lq lr gt jr"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="4ffd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们有粗体标题。</p><figure class="lo lp lq lr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mk"><img src="../Images/36ac020708cb17218216801f749bf1ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4lXE0LQ-KtzmN4L0NG2RWQ.png"/></div></div></figure><p id="1204" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">享受这个实验的乐趣。</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><figure class="lo lp lq lr gt jr gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/30191a5fd34f3ec436d82cd7937a067e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pnyz7LxgMyEgX2bp.jpeg"/></div></figure><p id="6a3d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">迪诺·卡伊奇目前是<a class="ae mt" href="https://www.lsbio.com/" rel="noopener ugc nofollow" target="_blank"> LSBio(生命周期生物科学公司)</a>、<a class="ae mt" href="https://absoluteantibody.com/" rel="noopener ugc nofollow" target="_blank">绝对抗体</a>、<a class="ae mt" href="https://www.kerafast.com/" rel="noopener ugc nofollow" target="_blank"> Kerafast </a>、<a class="ae mt" href="https://everestbiotech.com/" rel="noopener ugc nofollow" target="_blank">珠穆朗玛生物</a>、<a class="ae mt" href="https://www.nordicmubio.com/" rel="noopener ugc nofollow" target="_blank">北欧 MUbio </a>和<a class="ae mt" href="https://www.exalpha.com/" rel="noopener ugc nofollow" target="_blank"> Exalpha </a>的 IT 主管。他还担任我的自动系统的首席执行官。他有十多年的软件工程经验。他拥有计算机科学学士学位，辅修生物学。他的背景包括创建企业级电子商务应用程序、执行基于研究的软件开发，以及通过写作促进知识的传播。</p><p id="2dc7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以在<a class="ae mt" href="https://www.linkedin.com/in/dinocajic/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上联系他，在<a class="ae mt" href="https://instagram.com/think.dino" rel="noopener ugc nofollow" target="_blank"> Instagram </a>上关注他，或者<a class="ae mt" href="https://dinocajic.medium.com/subscribe" rel="noopener">订阅他的媒体出版物</a>。</p><p id="bfd2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae mt" href="https://dinocajic.medium.com/membership" rel="noopener"> <em class="mu">阅读迪诺·卡吉克(以及媒体上成千上万其他作家)的每一个故事。你的会员费直接支持迪诺·卡吉克和你阅读的其他作家。你也可以在媒体上看到所有的故事。</em> </a></p></div></div>    
</body>
</html>