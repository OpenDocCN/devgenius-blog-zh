<html>
<head>
<title>My Most Useful Helper Functions for PHP and MySQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我对 PHP 和 MySQL 最有用的助手函数</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/my-most-useful-helper-functions-for-php-and-mysql-202c01bb0185?source=collection_archive---------13-----------------------#2020-07-07">https://blog.devgenius.io/my-most-useful-helper-functions-for-php-and-mysql-202c01bb0185?source=collection_archive---------13-----------------------#2020-07-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3023" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">2 个准备好的语句的包装函数，因此它们可以像普通查询一样容易地使用</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/adbe4122affd886a1cdacc00413c3f1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PNwZW-E1i8ekbCm4"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">卡斯帕·卡米尔·鲁宾在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="6f36" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">迄今为止，PHP 最常见的用法是在后端与 MySQL 数据库通信。尽管越来越多的人转向 Node.js 或 Python 等技术，PHP 仍然是后端编程的常见选择。我喜欢 PHP 是因为它的 C 风格语法和易用性。这是我用了 10 多年的东西，也是我个人网站开发项目的首选。当我第一次开始使用 PHP 时，我使用文本文件作为数据库，但很快我就改用 MySQL 了。在使用普通查询一段时间后，我了解到更好的方法是使用预处理语句。</p><p id="d3eb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">准备好的声明为抵御 SQL 注入攻击提供了最好的安全保障。然而，与普通的查询相比，它们需要更多的步骤来设置和使用，如果您使用大量的查询，这可能会变得很乏味。为了减少编程开销，我创建了两个包装器函数，使得使用准备好的语句就像普通查询一样简单，这节省了大量的工作和时间。</p><p id="bac4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它们是用普通 PHP 编写的，包含在一个可以包含的文件中。因为我主要从事中小型项目，这是一个很大的优势。我不需要担心下载和建立大框架只是为了让 MySQL 更容易使用。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ls"><img src="../Images/f77c37c45d738a99e4b4982fbe167185.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2DFZ272KmPWeGbEp"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@markusspiske?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马库斯·斯皮斯克</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><h2 id="706f" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk ml bi translated">调用用户函数数组</h2><p id="3f61" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">PHP 有<a class="ae kv" href="https://www.php.net/manual/en/function.call-user-func-array.php" rel="noopener ugc nofollow" target="_blank"><em class="mr">call _ user _ func _ array</em></a>函数，它允许回调函数用数组中的所有参数调用。它适用于普通函数和类成员函数。我使用的是面向对象风格的<em class="mr"> mysqli </em> API。之所以需要这个回调函数，是因为<em class="mr"> mysqli_stmt </em>类的<a class="ae kv" href="https://www.php.net/manual/en/mysqli-stmt.bind-param.php" rel="noopener ugc nofollow" target="_blank"> <em class="mr"> bind_param </em> </a>函数可以有不同数量的参数，这取决于查询。例如查询"<em class="mr"> SELECT * FROM table WHERE ID=？</em>“只有一个？因此在<em class="mr"> bind_param </em>函数调用中只需要一个参数，但是像<em class="mr">“INSERT INTO table(ID，name ) VALUES(？, ?)"</em>就需要两个参数。因此，没有一个简单的包装函数总是接受相同的参数。相反，包装函数还需要能够处理可变数量的参数。</p><h2 id="0e0e" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk ml bi translated">履行</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ms mt l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">My 2 wrapper 函数，便于使用 MySQL 编写语句。</figcaption></figure><p id="3e59" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如上所述，因为<em class="mr"> bind_param </em>函数可以接受可变数量的参数，所以包装函数也需要能够做到这一点。与 C++中的可变模板不同，由于 PHP 的非严格类型，这很容易做到，只需在参数前添加…。在调用<em class="mr"> call_user_func_array </em>之前，我们迭代可变数量的参数并构建函数所需的数组。</p><p id="db92" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，在将<em class="mr"> call_user_func_array </em>与<em class="mr"> bind_param </em>函数一起使用时，有一个很大的注意事项。<em class="mr"> bind_param </em>函数需要通过引用传递参数。因此，在构建数组时，需要用对原始参数的引用来填充数组。</p><p id="9dbe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">包装函数的另一个好处是错误处理。它们检查每个 MySQL 函数的错误并相应地返回一个值，因此您仍然可以检查查询是否成功。</p><h2 id="7732" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk ml bi translated">用法示例</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ms mt l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">有无包装函数和普通查询的预准备语句的比较。</figcaption></figure></div><div class="ab cl mu mv hu mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="ij ik il im in"><p id="322b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有了这些包装器函数，可以像普通查询一样方便地使用预处理语句，并在所有步骤中进行错误检查。它们是用普通 PHP 编写的，不需要任何额外的框架，这使得它们非常适合中小型项目。因为 PHP 的主要用途是与后端数据库的通信，所以会经常使用预处理语句。这意味着拥有好的包装器功能是非常重要的，它将在项目持续期间节省大量的工作和时间。</p></div></div>    
</body>
</html>