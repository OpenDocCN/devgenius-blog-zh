<html>
<head>
<title>Clean Swift VIP with Example</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用实例清理 Swift VIP</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/clean-swift-vip-with-example-6f6e643a1a01?source=collection_archive---------2-----------------------#2020-06-15">https://blog.devgenius.io/clean-swift-vip-with-example-6f6e643a1a01?source=collection_archive---------2-----------------------#2020-06-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><h1 id="b5d3" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">清洁 Swift VIP</h1><p id="3854" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">Clean Swift(又名 VIP)是 Bob 大叔应用于 iOS 和 Mac 项目的 Clean 架构。干净的 Swift 架构不是一个框架。它是一组 Xcode 模板，可以为您生成干净的架构组件。这意味着您可以根据自己的需要自由修改模板。</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi lj"><img src="../Images/03dd5890bd351967686180a349552b33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Q2qPUtCiefnnjdVI"/></div></div></figure><ul class=""><li id="6022" class="lv lw iq kn b ko lx ks ly kw lz la ma le mb li mc md me mf bi translated">视图控制器</li><li id="42ad" class="lv lw iq kn b ko mg ks mh kw mi la mj le mk li mc md me mf bi translated">模型</li><li id="e505" class="lv lw iq kn b ko mg ks mh kw mi la mj le mk li mc md me mf bi translated">路由器</li><li id="4f23" class="lv lw iq kn b ko mg ks mh kw mi la mj le mk li mc md me mf bi translated">工人</li><li id="00a8" class="lv lw iq kn b ko mg ks mh kw mi la mj le mk li mc md me mf bi translated">互动者</li><li id="8dba" class="lv lw iq kn b ko mg ks mh kw mi la mj le mk li mc md me mf bi translated">提出者</li></ul><h1 id="0515" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">视图控制器</h1><p id="90a1" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">视图控制器开始和结束 VIP 循环向交互器发送数据，尽管它没有从交互器获得响应。该类与演示者进行单向交互。视图控制器从演示者获得响应，但不能向它传输任何内容</p><pre class="lk ll lm ln gt ml mm mn mo aw mp bi"><span id="979b" class="mq jo iq mm b gy mr ms l mt mu">import UIKit</span><span id="df83" class="mq jo iq mm b gy mv ms l mt mu">protocol IMostPopularViewController: class {<br/>	var router: IMostPopularRouter? { get set }<br/>}</span><span id="e077" class="mq jo iq mm b gy mv ms l mt mu">class MostPopularViewController: UIViewController {<br/>	var interactor: IMostPopularInteractor?<br/>	var router: IMostPopularRouter?</span><span id="57c7" class="mq jo iq mm b gy mv ms l mt mu">	override func viewDidLoad() {<br/>        super.viewDidLoad()<br/>		// do someting...<br/>    }<br/>}</span><span id="b36a" class="mq jo iq mm b gy mv ms l mt mu">extension MostPopularViewController: IMostPopularViewController {<br/>	// do someting...<br/>}</span></pre><h1 id="d579" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">模型</h1><p id="4c63" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">模型类与 VIP 模型中的每个组件相关。模型是一个包含请求、响应和视图模型等结构的类:</p><ul class=""><li id="a3ae" class="lv lw iq kn b ko lx ks ly kw lz la ma le mb li mc md me mf bi translated">请求模型包含发送给 API 请求的参数，这些参数是用户输入，比如在文本字段中输入的文本和在选择器中选择的值。</li><li id="5b12" class="lv lw iq kn b ko mg ks mh kw mi la mj le mk li mc md me mf bi translated">响应<br/>这种类型的模型接收来自 API 的响应，并存储适当的数据。</li><li id="9b91" class="lv lw iq kn b ko mg ks mh kw mi la mj le mk li mc md me mf bi translated">ViewModel <br/>这个模型将发送给演示者的响应封装成原始数据类型，比如 String 和 Int。</li></ul><pre class="lk ll lm ln gt ml mm mn mo aw mp bi"><span id="beb3" class="mq jo iq mm b gy mr ms l mt mu">import UIKit<br/>struct MostPopularModel {	<br/>	struct Request {<br/>		// do someting...</span><span id="7544" class="mq jo iq mm b gy mv ms l mt mu">		func parameters() -&gt; [String: Any]? {<br/>			// do someting...<br/>			return nil<br/>		}<br/>	}</span><span id="0c34" class="mq jo iq mm b gy mv ms l mt mu">	struct Response {<br/>		// do someting...<br/>	}<br/>}</span></pre><h1 id="e40d" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">路由器</h1><p id="5e70" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">路由器通过在视图控制器之间传递数据来处理过渡，这是通过助手类完成的</p><p id="d58e" class="pw-post-body-paragraph kl km iq kn b ko lx kq kr ks ly ku kv kw mw ky kz la mx lc ld le my lg lh li ij bi translated">操作发生在具有委托方法的视图控制器调用路由器类中</p><pre class="lk ll lm ln gt ml mm mn mo aw mp bi"><span id="7f6b" class="mq jo iq mm b gy mr ms l mt mu">//MARK: - in View Controller <br/>   func getMostPopularArticles(){<br/>        router?.navigateToArticle(article_id : id )<br/>    }<br/>//MARK: - in Router<br/>import UIKit<br/>protocol IMostPopularRouter: class {<br/>	func navigateToArticle(article_id : Int )<br/>}</span><span id="62dc" class="mq jo iq mm b gy mv ms l mt mu">class MostPopularRouter: IMostPopularRouter {	<br/>	weak var view: MostPopularViewController?<br/>	<br/>	init(view: MostPopularViewController?) {<br/>		self.view = view<br/>	}<br/>	<br/>	func navigateToArticle(article_id : Int ){<br/>        view?.navigate(type: .modal, module: GeneralRoute.mostPopularArticles, completion: nil)<br/>    }<br/>}</span></pre><ul class=""><li id="17fb" class="lv lw iq kn b ko lx ks ly kw lz la ma le mb li mc md me mf bi translated">通用根<br/>包含从视图控制器路由的所有模块，并通过通用根选择目的地将参数传递给目的地配置类</li></ul><pre class="lk ll lm ln gt ml mm mn mo aw mp bi"><span id="2ada" class="mq jo iq mm b gy mr ms l mt mu">import Foundation<br/>import UIKit</span><span id="6a2e" class="mq jo iq mm b gy mv ms l mt mu">enum MostPopularRoute: IRouter {<br/>    /*<br/>     If you want passing with parameters<br/>     you just add like this:<br/>         */<br/>     case sample<br/>     case sample2(parameter: [String: Any])<br/>    /*<br/>     you can use: String, Int, [String: Any], etc..<br/>    */<br/>}</span><span id="6fb1" class="mq jo iq mm b gy mv ms l mt mu">extension MostPopularRoute {<br/>    var module: UIViewController? {<br/>        /*<br/>         Setup module with parameters like:<br/>           */<br/>         switch self {<br/>         case .sample:<br/>            return SampleConfiguration.setup()<br/>        case .sample2(let parameters):<br/>            return SampleConfiguration2.setup(parameters: parameters)<br/>         }<br/>  <br/>    }<br/>}</span></pre><ul class=""><li id="4b3f" class="lv lw iq kn b ko lx ks ly kw lz la ma le mb li mc md me mf bi translated">配置<br/>配置器是一个初始化所有干净的 Swift 组件的类。然而这个类是可选的。您可以通过在 ViewController 中创建私有函数来配置场景。</li></ul><pre class="lk ll lm ln gt ml mm mn mo aw mp bi"><span id="e11a" class="mq jo iq mm b gy mr ms l mt mu">import Foundation<br/>import UIKit</span><span id="169e" class="mq jo iq mm b gy mv ms l mt mu">class MostPopularConfiguration {<br/>    static func setup(parameters: [String: Any] = [:]) -&gt; UIViewController {<br/>        let controller = MostPopularViewController()<br/>        let router = MostPopularRouter(view: controller)<br/>        let presenter = MostPopularPresenter(view: controller)<br/>        let manager = MostPopularManager()<br/>        let interactor = MostPopularInteractor(presenter: presenter, manager: manager)<br/>        <br/>        controller.interactor = interactor<br/>        controller.router = router<br/>        interactor.parameters = parameters<br/>        return controller<br/>    }<br/>}</span></pre><h1 id="f356" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">工人</h1><p id="acf9" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">Worker 处理所有的 API 和核心数据请求和响应，并为交互器准备数据，它还向交互器发送成功和错误响应</p><pre class="lk ll lm ln gt ml mm mn mo aw mp bi"><span id="dba1" class="mq jo iq mm b gy mr ms l mt mu">import Foundation</span><span id="521f" class="mq jo iq mm b gy mv ms l mt mu">protocol IArticlesManager: class {<br/>   func mostPopularFromApi(complition: @escaping (NSError?, Bool, ArticlesModel.MostPopularArticle?) -&gt; Void)<br/>}</span><span id="06b6" class="mq jo iq mm b gy mv ms l mt mu">class ArticlesManager: IArticlesManager {<br/>   func mostPopularFromApi(complition: @escaping (NSError?, Bool, ArticlesModel.MostPopularArticle?) -&gt; Void) {<br/>       NetworkService.share.request(endpoint: ArticlesEndpoint.mostPopular, success: { (responseData) in<br/>           let response = responseData<br/>           do {<br/>               let decoder = JSONDecoder()<br/>               let data = try decoder.decode(ArticlesModel.MostPopularArticle.self, from: response)<br/>               print(data)<br/>               complition(nil , true , data)<br/>           } catch let error {<br/>               print("error : ", error.localizedDescription)<br/>               complition(error as NSError , true , nil)<br/>           }<br/>       })<br/>   }<br/>}</span></pre><h1 id="ed1a" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">互动者</h1><p id="86d1" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">交互器是工作器和呈现器之间的中介。首先，它与 ViewController 通信，后者在向工作器发送数据之前传递工作器所需的所有查询参数。交互器检查这些数据。如果一切正常，工作器返回响应，交互器向呈现器发送响应</p><pre class="lk ll lm ln gt ml mm mn mo aw mp bi"><span id="871d" class="mq jo iq mm b gy mr ms l mt mu">//MARK: - in View Controller <br/>   func getMostPopularArticles(){<br/>        interactor?.getMostPopularArticles()<br/>    }<br/>    <br/>    <br/>//MARK: - in Interactor</span><span id="87f3" class="mq jo iq mm b gy mv ms l mt mu">import UIKit</span><span id="8f27" class="mq jo iq mm b gy mv ms l mt mu">protocol IArticlesInteractor: class {<br/>	var parameters: [String: Any]? { get set }<br/>    func getMostPopularArticles()<br/>}</span><span id="59f8" class="mq jo iq mm b gy mv ms l mt mu">class ArticlesInteractor: IArticlesInteractor {<br/>    var presenter: IArticlesPresenter?<br/>    var manager: IArticlesManager?<br/>    var parameters: [String: Any]?</span><span id="7631" class="mq jo iq mm b gy mv ms l mt mu">    init(presenter: IArticlesPresenter, manager: IArticlesManager) {<br/>    	self.presenter = presenter<br/>    	self.manager = manager<br/>    }<br/>    <br/>    <br/>    func getMostPopularArticles() {<br/>        manager?.mostPopularFromApi( complition: { (error, success, response) in<br/>            if(success == true){<br/>                print("getMostPopularArticles Done.....")<br/>                self.presenter?.showResponse(response: response)<br/>            } else {<br/>                self.presenter?.showErrorAlert(title: "Error", msg: error?.localizedDescription )<br/>            }<br/>        })<br/>    }<br/>}</span></pre><h1 id="1017" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">提出者</h1><p id="17de" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">演示者负责演示逻辑。它决定了数据将如何呈现给用户。演示者将交互者发送的响应组织成适合显示的视图模型。接下来，演示者将这些视图模型传递回视图控制器，以显示给用户</p><pre class="lk ll lm ln gt ml mm mn mo aw mp bi"><span id="9be2" class="mq jo iq mm b gy mr ms l mt mu">import UIKit</span><span id="17bd" class="mq jo iq mm b gy mv ms l mt mu">protocol IArticlesPresenter: class {<br/>	func showErrorAlert(title: String, msg: String?)<br/>    func showResponse(response: ArticlesModel.MostPopularArticle?)<br/>}</span><span id="92e0" class="mq jo iq mm b gy mv ms l mt mu">class ArticlesPresenter: IArticlesPresenter {	<br/>	weak var view: IArticlesViewController?<br/>	<br/>	init(view: IArticlesViewController?) {<br/>		self.view = view<br/>	}<br/>    func showErrorAlert(title: String, msg: String?) {<br/>        view?.showErrorAlert(title: title, msg: msg)<br/>    }<br/>    func showResponse(response: ArticlesModel.MostPopularArticle?) {<br/>        view?.showResponse(response: response)<br/>    }<br/>}</span></pre><h1 id="ed79" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">Clean Swift 的优势</h1><ul class=""><li id="9020" class="lv lw iq kn b ko kp ks kt kw mz la na le nb li mc md me mf bi translated">现成的模板</li><li id="00d2" class="lv lw iq kn b ko mg ks mh kw mi la mj le mk li mc md me mf bi translated">单向数据流动</li><li id="ccfa" class="lv lw iq kn b ko mg ks mh kw mi la mj le mk li mc md me mf bi translated">易测性</li><li id="4ce3" class="lv lw iq kn b ko mg ks mh kw mi la mj le mk li mc md me mf bi translated">复用性</li><li id="f8ca" class="lv lw iq kn b ko mg ks mh kw mi la mj le mk li mc md me mf bi translated">合作</li></ul><h1 id="4d3a" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">Clean Swift 的缺点</h1><ul class=""><li id="0df2" class="lv lw iq kn b ko kp ks kt kw mz la na le nb li mc md me mf bi translated">进入壁垒</li><li id="4977" class="lv lw iq kn b ko mg ks mh kw mi la mj le mk li mc md me mf bi translated">过度工程化</li></ul><p id="5b96" class="pw-post-body-paragraph kl km iq kn b ko lx kq kr ks ly ku kv kw mw ky kz la mx lc ld le my lg lh li ij bi translated">你可以从<a class="ae nc" href="https://github.com/AhmedibnAdam/NYTimes" rel="noopener ugc nofollow" target="_blank">这里</a> <br/>查看 GitHub 上的源代码谢谢:)</p></div></div>    
</body>
</html>