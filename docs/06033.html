<html>
<head>
<title>NodeJs+ Nginx on Azure VM</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Azure虚拟机上的NodeJs+ Nginx</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/nodejs-nginx-on-azure-vm-cf23d05a9b9b?source=collection_archive---------2-----------------------#2021-12-07">https://blog.devgenius.io/nodejs-nginx-on-azure-vm-cf23d05a9b9b?source=collection_archive---------2-----------------------#2021-12-07</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="8840" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这篇博客是我们从零开始讨论<strong class="jm io"> Devops </strong>概念的系列文章的一部分，面向的是入门知识有限的读者。这篇文章属于初学者系列，因为它涉及到简单设置nginx作为Azure VM上基本节点应用程序的简单反向代理。</p><p id="58f4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">本系列早期的一些博客</p><p id="0b00" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae ki" href="https://amit894.medium.com/ssh-what-not-to-do-92c266ca430f" rel="noopener"> <strong class="jm io">宋承宪</strong> </a> <strong class="jm io"> <br/> </strong> <a class="ae ki" href="https://amit894.medium.com/public-cloud-first-static-website-7d6f7c6f794" rel="noopener"> <strong class="jm io">第一静态网站</strong></a><strong class="jm io"><br/></strong><a class="ae ki" href="https://medium.com/@amit894/k8s-on-laptop-first-proxy-f0413145c9d1" rel="noopener"><strong class="jm io">本地</strong></a><strong class="jm io">K8<br/></strong><a class="ae ki" href="https://medium.com/@amit894/the-myth-of-dns-simplified-e169a6dadc0a" rel="noopener"><strong class="jm io">DNS</strong></a></p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/d2a393643ba0c9b8775bae997db8f17a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GSYsaKgie8na7GsOuIiNGw.png"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk translated">Nginx作为反向代理</figcaption></figure><h1 id="70bd" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">什么是Node JS？</h1><p id="cc7d" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">nodejs是一个构建在Javascript V8引擎之上的开源后端环境，它是解决开发者后端和UI需求的流行工具</p><p id="ddae" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">下面是一个基本的“<em class="mc"> Hello Audience </em>”应用程序，用node.js编写，运行在3000端口上</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="f599" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了运行相同的程序，可以使用以下命令之一</p><pre class="kk kl km kn gt mf mg mh mi aw mj bi"><span id="7ef2" class="mk la in mg b gy ml mm l mn mo"><strong class="mg io">Using node</strong></span><span id="b61f" class="mk la in mg b gy mp mm l mn mo">node app.js</span><span id="11e4" class="mk la in mg b gy mp mm l mn mo"><strong class="mg io">Using PM2</strong></span><span id="6f28" class="mk la in mg b gy mp mm l mn mo">pm2 start app.js</span></pre><h1 id="93d1" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">Nginx是什么？</h1><p id="3285" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">引擎X是一个网络服务器，可以用作多用途—负载平衡器、反向代理等，用于运行在java/node等上的后端应用程序。代理传递模块可用于将端口80上的传入重定向到端口3000，如下例所示</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="md me l"/></div></figure><h1 id="5d36" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">设置和配置</h1><h2 id="d14d" class="mk la in bd lb mq mr dn lf ms mt dp lj jv mu mv ln jz mw mx lr kd my mz lv na bi translated">地形模块</h2><p id="7b95" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated"><a class="ae ki" href="https://amit894.medium.com/public-cloud-first-static-website-7d6f7c6f794" rel="noopener"> <strong class="jm io">复习</strong> </a></p><p id="f401" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">对于这个博客，地形环境由四个模块组成- <em class="mc">键。网络、虚拟机和存储。</em></p><p id="192e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">详细的模块可以在-</p><p id="57b4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae ki" href="https://github.com/amit894/node-vm-azure/tree/main/resources/terraform/modules" rel="noopener ugc nofollow" target="_blank">https://github . com/Amit 894/node-VM-azure/tree/main/resources/terra form/modules</a></p><p id="7f56" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要安装terraform模块，需要从上述git repo的环境文件夹中运行以下执行步骤</p><p id="0fdc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae ki" href="https://github.com/amit894/node-vm-azure/tree/main/resources/terraform/env/dev" rel="noopener ugc nofollow" target="_blank">https://github . com/Amit 894/node-VM-azure/tree/main/resources/terra form/env/dev</a></p><pre class="kk kl km kn gt mf mg mh mi aw mj bi"><span id="1915" class="mk la in mg b gy ml mm l mn mo"><strong class="mg io">Steps</strong></span><span id="c82d" class="mk la in mg b gy mp mm l mn mo">terrform init<br/>terraform plan<br/>terraform apply</span></pre><p id="80c0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae ki" href="https://amit894.medium.com/ansible-hello-world-8d37627758a9" rel="noopener"> <strong class="jm io">进修</strong> </a></p><p id="c05c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">对于这个博客，剧本由两个角色ngnix和nodejs组成，在上面的远程Azure VM设置中进行配置。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="df08" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">每个角色都有以下4个步骤- <em class="mc"> prereqs.yml、configure.yml install.yml和service.yml. </em></p><p id="b64f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">详细的角色可以在</p><p id="6157" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">节点</strong>-<a class="ae ki" href="https://github.com/amit894/node-vm-azure/tree/main/resources/ansible/roles/node" rel="noopener ugc nofollow" target="_blank">https://github . com/Amit 894/Node-VM-azure/tree/main/resources/ansi ble/roles/Node</a><br/><strong class="jm io">Nginx</strong>-<a class="ae ki" href="https://github.com/amit894/node-vm-azure/tree/main/resources/ansible/roles/nginx" rel="noopener ugc nofollow" target="_blank">https://github . com/Amit 894/Node-VM-azure/tree/main/resources/ansi ble/roles/Nginx</a></p><p id="09df" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要安装ansible行动手册，需要运行以下执行步骤-</p><pre class="kk kl km kn gt mf mg mh mi aw mj bi"><span id="b856" class="mk la in mg b gy ml mm l mn mo">ansible-playbook ./playbooks/node-azure-vm.yml -i hosts</span></pre><h2 id="4431" class="mk la in bd lb mq mr dn lf ms mt dp lj jv mu mv ln jz mw mx lr kd my mz lv na bi translated">安装后验证</h2><pre class="kk kl km kn gt mf mg mh mi aw mj bi"><span id="29da" class="mk la in mg b gy ml mm l mn mo">curl -v "http://104.210.136.108/" <strong class="mg io">where </strong>104.210.136.108=IP of the Azure VM<br/></span><span id="c325" class="mk la in mg b gy mp mm l mn mo">* Mark bundle as not supporting multiuse<br/>&lt; HTTP/1.1 200 OK<br/>&lt; Content-Type: text/plain<br/>&lt; Date: Tue, 07 Dec 2021 16:09:48 GMT<br/>&lt; Connection: keep-alive<br/>&lt; Keep-Alive: timeout=5<br/>&lt; Content-Length: 14<br/>&lt;* Connection #0 to host 127.0.0.1 left intact<br/>Hello Audience<strong class="mg io">%</strong></span></pre><p id="a4e8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如需反馈，请发邮件至<strong class="jm io">Amit[dot]894[at]Gmail[dot]com</strong>或联系<a class="ae ki" href="https://about.me/amit_raj" rel="noopener ugc nofollow" target="_blank">https://about.me/amit_raj</a>的任何链接</p></div><div class="ab cl nb nc hr nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="ig ih ii ij ik"><p id="56f9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="mc">更多内容请看</em><a class="ae ki" href="http://blog.devgenius.io" rel="noopener ugc nofollow" target="_blank"><em class="mc">blog . dev genius . io</em></a><em class="mc">。</em></p></div></div>    
</body>
</html>