<html>
<head>
<title>Android 103 : How is constructor injection different from provides method in Dagger?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Android 103:æ„é€ å‡½æ•°æ³¨å…¥å’Œ Dagger ä¸­çš„ provides æ–¹æ³•æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://blog.devgenius.io/android-103-how-is-constructor-injection-different-from-provides-method-in-dagger-66ff0209ebb3?source=collection_archive---------9-----------------------#2022-03-26">https://blog.devgenius.io/android-103-how-is-constructor-injection-different-from-provides-method-in-dagger-66ff0209ebb3?source=collection_archive---------9-----------------------#2022-03-26</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="d145" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">åœ¨ç¬¬ä¸€ç¯‡<a class="ae ki" href="https://saurabhofficial.medium.com/android-101-what-does-dagger-really-generate-behind-the-scenes-db1300f9ce82" rel="noopener"> <strong class="jm io">æ–‡ç« </strong> </a>ä¸­ï¼Œæˆ‘ä»¬æ¢è®¨äº† dagger å¦‚ä½•ä¸ºæ³¨å…¥çš„æ„é€ å‡½æ•°ä¾èµ–å…³ç³»ç”Ÿæˆå·¥å‚ï¼Œåœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨æ›´å¤šå…³äºå½“æˆ‘ä»¬ä½¿ç”¨<strong class="jm io"> @Provides </strong>æ–¹æ³•ä»£æ›¿æ„é€ å‡½æ•°æ³¨å…¥æ¥å®šä¹‰ä¾èµ–å…³ç³»æˆ–ç»‘å®šæ—¶ dagger ç”Ÿæˆçš„ä»£ç ã€‚</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/27f46f3dd74151b0675287cb3787dea0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0kTgHd0BXZTlYQR5C02x0Q.jpeg"/></div></div></figure><p id="8617" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æ­£å¦‚åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æåˆ°çš„ï¼ŒDagger ä¸ºæ¯ä¸ªæ„é€ å‡½æ•°æ³¨å…¥çš„ä¾èµ–é¡¹ç”Ÿæˆä¸€ä¸ªå·¥å‚ï¼Œåœ¨ç”Ÿæˆçš„ç»„ä»¶ç±»ä¸­ä½¿ç”¨è¿™ä¸ªå·¥å‚æ¥åˆ›å»ºå£°æ˜çš„ä¾èµ–é¡¹çš„å®ä¾‹ã€‚</p><blockquote class="kv kw kx"><p id="2c23" class="jk jl ky jm b jn jo jp jq jr js jt ju kz jw jx jy la ka kb kc lb ke kf kg kh ig bi translated">ä½†æ˜¯æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦@provides æ³¨é‡Šå‘¢ï¼Ÿä»€ä¹ˆæ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ„é€ å‡½æ•°æ³¨å…¥æ¥å®šä¹‰ç»‘å®šï¼Œç”šè‡³ä¸éœ€è¦åˆ›å»º dagger æ¨¡å—ï¼Ÿ <br/>åªè¦æˆ‘ä»¬å¯ä»¥æ³¨é‡Šä»»ä½•ç±»çš„æ„é€ å‡½æ•°ï¼Œæˆ‘ä»¬å°±åº”è¯¥è¿™æ ·åšï¼Œè€Œä¸æ˜¯åˆ›å»ºä¸€ä¸ªæ¨¡å—å¹¶å®šä¹‰@provides æ–¹æ³•ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šè¢«æ¨¡å—å¡ä½ï¼Œä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬æ— æ³•è®¿é—®æˆ‘ä»¬å¸Œæœ›ä½œä¸ºåº”ç”¨ç¨‹åºä¸­æ³¨å…¥ä¾èµ–é¡¹çš„ç±»çš„æ„é€ å‡½æ•°æ—¶ï¼Œå°±åƒ Android ä¸­çš„ Activity ç±»</p></blockquote><p id="6c9c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æˆ‘ä»¬å°†é€šè¿‡å®šä¹‰ä¸€ä¸ªä¾èµ–äº DummyModule çš„ DummyComponent æ¥ç ”ç©¶ç”Ÿæˆçš„ä»£ç ï¼Œå¹¶çœ‹çœ‹ Dagger ç”Ÿæˆäº†å“ªäº›ç±»ã€‚</p><pre class="kk kl km kn gt lc ld le lf aw lg bi"><span id="00f4" class="lh li in ld b gy lj lk l ll lm"><strong class="ld io">@Module<br/>object DummyModule {<br/></strong>    <br/>    @Singleton<br/>    @Provides<br/>    fun provideDummy(): Dummy {<br/>        return Dummy()<br/>    }<br/><strong class="ld io">}</strong></span></pre><p id="be2a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">è¿™æ˜¯æˆ‘å†™çš„<strong class="jm io"> DummyModule </strong>ï¼Œä¹Ÿæ˜¯è¿™é‡Œçš„<strong class="jm io"> DummyComponent </strong></p><pre class="kk kl km kn gt lc ld le lf aw lg bi"><span id="4442" class="lh li in ld b gy lj lk l ll lm"><strong class="ld io">@Component(modules = [DummyModule::class])<br/>@Singleton<br/>interface DummyComponent {<br/></strong>    fun getDummy(): Dummy<br/><strong class="ld io">}</strong></span></pre><p id="4e2b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">å½“æˆ‘ä»¬ä½¿ç”¨ provides annotated æ–¹æ³•æ—¶ï¼Œdagger ä¼šä¸º DummyModule ä¸­å£°æ˜çš„æ¯ä¸ªç»‘å®š/ä¾èµ–é¡¹ç”Ÿæˆä¸€ä¸ªå·¥å‚ã€‚å³<strong class="jm io">dummy module _ providedummy factory</strong></p><pre class="kk kl km kn gt lc ld le lf aw lg bi"><span id="015b" class="lh li in ld b gy lj lk l ll lm"><strong class="ld io">// One such factory is generated for each binding in Module</strong></span><span id="eacc" class="lh li in ld b gy ln lk l ll lm"><strong class="ld io">public final class DummyModule_ProvideDummyFactory implements Factory&lt;Dummy&gt;</strong> {</span><span id="1b6c" class="lh li in ld b gy ln lk l ll lm">  @Override<br/>  public Dummy get() {<br/>    return <em class="ky">provideDummy</em>();<br/>  }<br/><br/>  public static DummyModule_ProvideDummyFactory create() {<br/>    return InstanceHolder.<em class="ky">INSTANCE</em>;<br/>  }<br/><br/>  public static Dummy provideDummy() {<br/>    return Preconditions.<em class="ky">checkNotNullFromProvides</em>(DummyModule.<em class="ky">INSTANCE</em>.provideDummy());<br/>  }<br/><br/>  private static final class InstanceHolder {<br/>    private static final DummyModule_ProvideDummyFactory <em class="ky">INSTANCE </em>= new DummyModule_ProvideDummyFactory();<br/>  }<br/><strong class="ld io">}</strong></span></pre><p id="b11d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">è¿™ä¸ªç”Ÿæˆçš„å·¥å‚å‡ ä¹ç±»ä¼¼äºæˆ‘ä»¬ä½¿ç”¨æ„é€ å‡½æ•°æ³¨å…¥è€Œä¸æ˜¯ provides æ–¹æ³•æ—¶ç”Ÿæˆçš„å·¥å‚ï¼Œåªæ˜¯åç§°å‘ç”Ÿäº†å˜åŒ–ï¼Œä»¥åæ˜ æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ provides æ–¹æ³•ï¼Œè€Œä¸æ˜¯ä»æ„é€ å‡½æ•°æ³¨å…¥ç”Ÿæˆçš„å·¥å‚ã€‚</p><p id="aca7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">è¿™ä¸ªç”Ÿæˆçš„å·¥å‚åœ¨ç”Ÿæˆçš„ Dagger ç»„ä»¶ä¸­è¢«ä½¿ç”¨ï¼Œä»¥è·å¾— Dummy ç±»çš„å®ä¾‹ï¼Œè¿™ä¸ä¸Šä¸€ç¯‡æ–‡ç« éå¸¸ç›¸ä¼¼ï¼Œé™¤äº†ä¸€ä¸ªä¸åŒä¹‹å¤„æ˜¯<strong class="jm io">ç»„ä»¶æ„å»ºå™¨</strong>ã€‚</p><pre class="kk kl km kn gt lc ld le lf aw lg bi"><span id="57f2" class="lh li in ld b gy lj lk l ll lm"><strong class="ld io">public final class DaggerDummyComponent implements DummyComponent {<br/></strong>  private final DaggerDummyComponent dummyComponent = this;<br/><br/>  private Provider&lt;Dummy&gt; provideDummyProvider;<br/><br/>  private DaggerDummyComponent() {<br/>    initialize();<br/>  }<br/><br/>  public static Builder builder() {<br/>    return new Builder();<br/>  }<br/><br/>  public static DummyComponent create() {<br/>    return new Builder().build();<br/>  }<br/><br/>  @SuppressWarnings("unchecked")<br/>  private void initialize() {<br/>    this.provideDummyProvider = DoubleCheck.<em class="ky">provider</em>(DummyModule_ProvideDummyFactory.<em class="ky">create</em>());<br/>  }<br/><br/>  @Override<br/>  public Dummy getDummy() {<br/>    return provideDummyProvider.get();<br/>  }<br/><br/><strong class="ld io">  public static final class Builder {<br/></strong>    <strong class="ld io">private Builder() {<br/>    }</strong><br/><br/>    <em class="ky">/**<br/>     * @deprecated This module is declared, but an instance is not used in the component. This method is a no-op. For more, see https://dagger.dev/unused-modules.<br/>     */<br/>    </em><strong class="ld io">@Deprecated<br/>    public Builder dummyModule(DummyModule dummyModule) {<br/>      Preconditions.<em class="ky">checkNotNull</em>(dummyModule);<br/>      return this;<br/>    }<br/><br/>    public DummyComponent build() {<br/>      return new DaggerDummyComponent();<br/>    }<br/>  }</strong><br/>}</span></pre><p id="3207" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ç”±äºè¿™ä¸ªç»„ä»¶ä¾èµ–äºä¸€ä¸ªæ¨¡å—æ¥è·å¾—å®ƒçš„ä¾èµ–é¡¹ï¼ŒDagger ç”Ÿæˆäº†ä¸€ä¸ªæ„å»ºå™¨ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç”¨æ‰€æœ‰éœ€è¦çš„æ¨¡å—æ¥åˆå§‹åŒ–æˆ‘ä»¬çš„ç»„ä»¶ã€‚</p><p id="d45c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">éœ€è¦æ³¨æ„çš„ç»†èŠ‚ï¼</strong></p><ol class=""><li id="9d1c" class="lo lp in jm b jn jo jr js jv lq jz lr kd ls kh lt lu lv lw bi translated"><strong class="jm io">ç”Ÿæˆçš„ä»£ç ä¸­é‚£ä¸ªå¤§çš„å¼ƒç”¨è­¦å‘Šæ˜¯ä»€ä¹ˆï¼Ÿ</strong> <br/>å¼ƒç”¨è¯´æ˜å‘Šè¯‰æˆ‘ä»¬ï¼Œç»„ä»¶ä¸éœ€è¦æ¨¡å—çš„ä»»ä½•å®ä¾‹æ¥è°ƒç”¨å†…éƒ¨çš„ provides æ–¹æ³•ï¼Œå› ä¸ºæ‰€æœ‰æ–¹æ³•éƒ½æ˜¯å¯è®¿é—®çš„ï¼Œç”šè‡³ä¸éœ€è¦åˆ›å»ºæ¨¡å—çš„ä»»ä½•å®ä¾‹ï¼Œå› ä¸ºå®ƒè¢«å£°æ˜ä¸º<a class="ae ki" href="https://play.kotlinlang.org/byExample/03_special_classes/04_Object" rel="noopener ugc nofollow" target="_blank">å¯¹è±¡</a>ï¼Œè¿™ä½¿å¾—ç”Ÿæˆçš„ä»£ç æ›´æœ‰æ•ˆï¼Œå› ä¸ºç»„ä»¶ä¸éœ€è¦å®ä¾‹åŒ–æ¨¡å—ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œå½“æˆ‘ä»¬å†™æ¨¡å—çš„æ—¶å€™ï¼Œæˆ‘ä»¬åº”è¯¥è¯•ç€è®©å®ƒé‡Œé¢çš„æ‰€æœ‰æ–¹æ³•éƒ½æ˜¯é™æ€çš„(æˆ–è€…åœ¨ kotlin ä¸­ä½œä¸ºä¸€ä¸ªå¯¹è±¡ç±»)ã€‚</li><li id="5d00" class="lo lp in jm b jn lx jr ly jv lz jz ma kd mb kh lt lu lv lw bi translated">æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦æ¨¡å—ç±»çš„å®ä¾‹å‘¢ï¼Ÿä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸èƒ½æ€»æ˜¯æŠŠå®ƒå£°æ˜ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Ÿæœ‰æ—¶æˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„æ¨¡å—ç±»æ˜¯æœ‰çŠ¶æ€çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨æ¨¡å—å†…éƒ¨å£°æ˜ä¸€äº›å˜é‡ï¼Œä»¥ä¾› provides æ–¹æ³•ä½¿ç”¨ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†æŠŠå®ƒå£°æ˜ä¸ºä¸€ä¸ªé€‚å½“çš„ç±»ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç»„ä»¶å°†éœ€è¦æ¨¡å—çš„ä¸€ä¸ªå®ä¾‹æ¥è°ƒç”¨æ¨¡å—ä¸­å£°æ˜çš„ provides æ–¹æ³•ã€‚è¿™ä¸ª<a class="ae ki" href="https://codinginflow.com/tutorials/android/dagger-2/part-7-stateful-modules" rel="noopener ugc nofollow" target="_blank">æ•™ç¨‹</a>æ¶µç›–äº†å®Œå…¨ç›¸åŒçš„åœºæ™¯ã€‚<br/>ä½ å¯ä»¥è¯•ç€åœ¨<strong class="jm io"> DummyModule </strong>å£°æ˜ä¸­ç”¨ä¸€ä¸ªç®€å•çš„<strong class="jm io">ç±»</strong>æ›¿æ¢<strong class="jm io">å¯¹è±¡</strong>ï¼Œçœ‹çœ‹ç”Ÿæˆçš„ä»£ç æœ‰ä½•ä¸åŒï¼</li></ol><p id="7442" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æˆ‘ä¼šè¯•ç€åœ¨è¿™ä¸ªç³»åˆ—ä¸­å†™æ›´å¤šå…³äº Dagger çš„å†…å®¹ï¼Œå¹¶åœ¨è¿™é‡Œæ›´æ–°ç›¸å…³æ–‡ç« /**WIP*/</p><p id="1d83" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« å¾ˆæœ‰è§åœ°ï¼Œè¯·ç»™æˆ‘ä¸€ä¸ªæŒå£°ğŸ˜„ï¼Œå¿«ä¹é˜…è¯»ï¼</p></div></div>    
</body>
</html>