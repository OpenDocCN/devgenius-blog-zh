<html>
<head>
<title>K8’s on Laptop : First Proxy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">K8的笔记本电脑:第一个代理</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/k8s-on-laptop-first-proxy-f0413145c9d1?source=collection_archive---------5-----------------------#2021-12-02">https://blog.devgenius.io/k8s-on-laptop-first-proxy-f0413145c9d1?source=collection_archive---------5-----------------------#2021-12-02</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="7dbc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这篇博客是我们从零开始讨论<strong class="jm io"> Devops </strong>概念的系列文章的一部分，面向的是入门知识有限的读者。重述这个系列的前三篇博客，来自<em class="ki">初级</em>。这篇文章属于中级系列，因为它涉及到K8和Dockers，并带有一小段代码演练。</p><p id="9d01" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae kj" href="https://amit894.medium.com/ansible-hello-world-8d37627758a9" rel="noopener"><strong class="jm io">Ansible</strong></a><strong class="jm io"><br/></strong><a class="ae kj" href="https://amit894.medium.com/ssh-what-not-to-do-92c266ca430f" rel="noopener"><strong class="jm io">宋承宪</strong></a><strong class="jm io"><br/></strong><a class="ae kj" href="https://amit894.medium.com/public-cloud-first-static-website-7d6f7c6f794" rel="noopener"><strong class="jm io">第一静态网站</strong> </a></p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi kk"><img src="../Images/3c5c53ac51757bbd7518549c128c1239.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H8Q8lSa-DyxzKhJ_NWXa9A.png"/></div></div></figure><h2 id="5a87" class="kw kx in bd ky kz la dn lb lc ld dp le jv lf lg lh jz li lj lk kd ll lm ln lo bi translated">代理人</h2><p id="06c2" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv lr jx jy jz ls kb kc kd lt kf kg kh ig bi translated">代理是客户端和应用层之间的中间服务器，充当安全性、可伸缩性和性能的护栏。开源世界里有各种技术-<a class="ae kj" href="https://www.nginx.com/resources/wiki/" rel="noopener ugc nofollow" target="_blank"><strong class="jm io">Nginx</strong></a><strong class="jm io"/><a class="ae kj" href="https://en.wikipedia.org/wiki/The_Apache_Software_Foundation" rel="noopener ugc nofollow" target="_blank"><strong class="jm io">Apache</strong></a>等可以帮助实现功能。</p><h2 id="e4bb" class="kw kx in bd ky kz la dn lb lc ld dp le jv lf lg lh jz li lj lk kd ll lm ln lo bi translated">库伯内特斯</h2><p id="44e0" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv lr jx jy jz ls kb kc kd lt kf kg kh ig bi translated"><a class="ae kj" href="https://kubernetes.io/" rel="noopener ugc nofollow" target="_blank"> Kubernetes </a>或k8的开源管理和编排工具，用于在云和本地设置上运行应用程序容器。对于本地设置，有一些工具如<a class="ae kj" href="https://github.com/kubernetes/minikube" rel="noopener ugc nofollow" target="_blank"><em class="ki">Minikube</em></a><em class="ki"/><a class="ae kj" href="https://kind.sigs.k8s.io/docs/user/quick-start/" rel="noopener ugc nofollow" target="_blank"><em class="ki">种类</em> </a> <em class="ki"> </em>与Docker一起帮助<em class="ki">控制平面</em>和<em class="ki">节点组件</em>进行设置。</p><h2 id="922a" class="kw kx in bd ky kz la dn lb lc ld dp le jv lf lg lh jz li lj lk kd ll lm ln lo bi translated">创建本地代理</h2><p id="805b" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv lr jx jy jz ls kb kc kd lt kf kg kh ig bi translated">出于本练习的目的，我们将使用<em class="ki"> Minikube </em>和<em class="ki"> Nginx入口控制器</em>作为本练习的目的。Nginx还用于Docker/pods设置，冗余层可以针对生产工作负载移除，并用于<em class="ki">pod/服务/部署</em>级别的任何调试。</p><p id="25ff" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">安装和配置Minikube </strong></p><p id="f5d7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在运行minikube之前，应该在笔记本电脑上运行Docker守护进程。另一个选择是VirtualBox</p><pre class="kl km kn ko gt lu lv lw lx aw ly bi"><span id="9ce9" class="kw kx in lv b gy lz ma l mb mc">brew install minikube<br/>minikube start <br/>minikube status</span><span id="11e4" class="kw kx in lv b gy md ma l mb mc"><strong class="lv io">Output</strong></span><span id="82d4" class="kw kx in lv b gy md ma l mb mc">type: Control Plane<br/>host: Running<br/>kubelet: Running<br/>apiserver: Running<br/>kubeconfig: Configured</span></pre><p id="aa84" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">创建部署。</strong></p><p id="b19a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">用k8的无状态词来说，每个部署都为docker映像创建pod(容器)。下面是一个使用单个副本的部署示例。</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="me mf l"/></div></figure><pre class="kl km kn ko gt lu lv lw lx aw ly bi"><span id="0fbc" class="kw kx in lv b gy lz ma l mb mc">kubectl apply -f .</span></pre><h2 id="d56a" class="kw kx in bd ky kz la dn lb lc ld dp le jv lf lg lh jz li lj lk kd ll lm ln lo bi translated">创建服务</h2><p id="7463" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv lr jx jy jz ls kb kc kd lt kf kg kh ig bi translated">这些部署可以作为服务公开给内部/外部网络空间。k8中的服务有各种类型<a class="ae kj" href="https://kubernetes.io/docs/concepts/services-networking/service/" rel="noopener ugc nofollow" target="_blank"> <em class="ki"> NodePort、ClusterIp、负载平衡器</em> </a>等，这取决于整体部署架构的性质。这里是一个服务的例子，该服务选择所有名为<em class="ki">静态网站-1 </em>的应用，并在端口<em class="ki"> 80 </em>上运行。</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="me mf l"/></div></figure><pre class="kl km kn ko gt lu lv lw lx aw ly bi"><span id="46db" class="kw kx in lv b gy lz ma l mb mc">kubectl apply -f .</span></pre><h2 id="ca27" class="kw kx in bd ky kz la dn lb lc ld dp le jv lf lg lh jz li lj lk kd ll lm ln lo bi translated">创建入口</h2><p id="1330" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv lr jx jy jz ls kb kc kd lt kf kg kh ig bi translated">入口控制器是一个网络层，用于向主机虚拟机提供服务。这里有一个nginx控制器的例子，它用于将静态网站作为本地主机域上的路径公开。</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="me mf l"/></div></figure><pre class="kl km kn ko gt lu lv lw lx aw ly bi"><span id="68db" class="kw kx in lv b gy lz ma l mb mc">kubectl apply -f .</span></pre><h2 id="239a" class="kw kx in bd ky kz la dn lb lc ld dp le jv lf lg lh jz li lj lk kd ll lm ln lo bi translated">在Minikube上启用入口</h2><pre class="kl km kn ko gt lu lv lw lx aw ly bi"><span id="1b9c" class="kw kx in lv b gy lz ma l mb mc">minikube tunnel</span></pre><h2 id="af38" class="kw kx in bd ky kz la dn lb lc ld dp le jv lf lg lh jz li lj lk kd ll lm ln lo bi translated">验证部署</h2><pre class="kl km kn ko gt lu lv lw lx aw ly bi"><span id="d0cb" class="kw kx in lv b gy lz ma l mb mc">curl -H “Host: rgate” “http://localhost/static-1/"</span></pre><h2 id="98b3" class="kw kx in bd ky kz la dn lb lc ld dp le jv lf lg lh jz li lj lk kd ll lm ln lo bi translated">额外资源</h2><ul class=""><li id="c432" class="mg mh in jm b jn lp jr lq jv mi jz mj kd mk kh ml mm mn mo bi translated"><a class="ae kj" href="https://github.com/amit894/simple-proxy" rel="noopener ugc nofollow" target="_blank">https://github.com/amit894/simple-proxy</a></li></ul></div></div>    
</body>
</html>