<html>
<head>
<title>Finding a Balance in Bias-Variance Trade-off</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在偏差-方差权衡中找到平衡</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/bias-variance-trade-off-c4139fc798b7?source=collection_archive---------16-----------------------#2022-09-15">https://blog.devgenius.io/bias-variance-trade-off-c4139fc798b7?source=collection_archive---------16-----------------------#2022-09-15</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/d723b379d5e9668afe73e626d1f0bc76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SJpxH_rzVHY99F-ikeo_GQ.png"/></div></div></figure><p id="1f2a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在有监督的机器学习中，建立一个通用的模型一直是一个挑战。监督机器学习是最常用和最成功的机器学习类型之一。当一个模型能够对看不见的数据做出准确的预测/分类时，该模型被称为是良好概括的。</p><p id="e8c6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">泛化对于机器学习是必不可少的；学习算法很好地拟合了训练数据，并不意味着它是一个好的机器学习模型。它可能会过度拟合数据并做出错误的预测。在部署之前，我们必须确保模型是合适的。</p><p id="24e1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">一般来说，模型性能是以泛化误差来衡量的，也称为预测误差/测试误差。通常，我们建立一个可以对训练数据集做出准确预测的模型，并且我们希望该模型也可以对测试数据做出准确预测。然而，有时这并没有发生；这是一个<strong class="jx io"> <em class="kt">泛化错误</em> </strong>。它衡量算法或统计模型预测以前看不到的数据的输出值的准确性。</p><p id="8a85" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在本文中，我们将讨论模型的偏差和方差，以及它们与过度拟合和欠拟合的关系。</p></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><p id="1552" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi lb translated"><span class="l lc ld le bm lf lg lh li lj di"> O </span>当统计模型或机器学习算法很好地拟合训练数据时，就会发生拟合，但不幸的是，该模型无法在新的未知数据上准确预测输出。</p><figure class="ll lm ln lo gt jo gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/412c960e9bf2b472475329ee7e13e6f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*Al3-WRfr4fTM3_pinPAsMQ.png"/></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk translated">过度拟合模型性能</figcaption></figure><p id="fc0d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">典型地，在过度拟合中，如果一个模型在相同的训练数据上训练了太长时间，它学习可用的模式；然而，它也学习训练数据中的噪声或随机波动作为概念。该模型开始记忆训练数据，而不是学习所需的模式。因此，它在训练数据上表现很好，但在看不见的数据上不一般化，因为那些概念不适用于新的看不见的数据。</p></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><p id="a131" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi lb translated">当统计模型或机器学习算法无法捕捉学习模式或输入和输出变量之间的有意义的关系时，就会发生欠拟合，这导致模型既不能很好地处理训练数据，也不能推广到新的未知数据。</p><figure class="ll lm ln lo gt jo gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/a5242a17bd819ab46ba262024a90cd07.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*sLI6QiUq22VMWI8cnUPZHQ.png"/></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk translated">欠拟合模型性能</figcaption></figure><p id="1935" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">适应不足是适应过度的反义词。当模型没有经过足够长时间的训练，或者输入变量的重要性不足以找到输入和输出变量之间的关系时，就会出现欠拟合。因此，它会产生大量的训练和测试错误。</p><p id="e681" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">欠拟合不如过拟合问题讨论得多，因为欠拟合模型或算法比过拟合模型更容易识别，因为它们会产生较大的训练误差。</p><p id="65c0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在实践中，我们通常可以计算训练误差，但估计测试误差相对具有挑战性，因为没有测试数据可用。</p><p id="d2e9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">理解模型评估的一种方法是解释模型的偏差和方差。泛化误差总是分解成三个基本量:数据中的<strong class="jx io"> <em class="kt">方差</em> </strong>误差、<strong class="jx io"> <em class="kt">平方偏差</em> </strong>误差和不可约误差 的<strong class="jx io"> <em class="kt">方差。</em></strong></p><p id="c927" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="kt">以下等式给出了测试误差的数学表示:</em></p><blockquote class="lt lu lv"><p id="ecec" class="jv jw kt jx b jy jz ka kb kc kd ke kf lw kh ki kj lx kl km kn ly kp kq kr ks ig bi translated"><strong class="jx io"> <em class="in">误差(预测误差)=方差误差+【偏差】误差+不可约误差</em> </strong></p></blockquote><p id="29f0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这里，<strong class="jx io"> <em class="kt">误差</em> </strong>是预期测试误差，是指使用大量训练集重复训练一个算法并分别测试后得到的平均测试误差。</p><p id="8dfd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了最小化上述预期测试误差，我们应该选择低方差和低偏差的统计模型或机器学习算法。</p><p id="72b4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">根据上面的等式，我们可以说<em class="kt">误差</em>永远不会小于不可约误差的方差，因为偏差和方差都是非负项，即使模型能够实现零偏差和零方差，<em class="kt">误差</em>也将总是等于不可约误差的方差。</p><p id="dc8c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> <em class="kt">不可约误差</em> </strong>是由于训练数据集中的一些噪声或未知变量而引入的误差，我们无法使用任何算法或统计方法来减少这种误差。因此，我们必须专注于最小化偏差和方差，以最小化测试误差。</p><h1 id="456f" class="lz ma in bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">理解差异</h1><p id="daea" class="pw-post-body-paragraph jv jw in jx b jy mx ka kb kc my ke kf kg mz ki kj kk na km kn ko nb kq kr ks ig bi translated">根据定义，</p><blockquote class="lt lu lv"><p id="36e4" class="jv jw kt jx b jy jz ka kb kc kd ke kf lw kh ki kj lx kl km kn ly kp kq kr ks ig bi translated">方差误差是指如果我们使用不同的训练数据集对预测值进行估计，预测值会发生的变化量。</p></blockquote><p id="c2c7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">当我们添加新的数据点、要素或数据中的任何噪声和随机性时，由于模型对数据集中的波动非常敏感，因此会出现方差误差。</p><p id="52f0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">通常，通过使用训练数据来拟合统计模型或算法。不同的训练数据集将导致不同的预测值。然而，这些预测值不应该变化太大。预测中的这些变化指的是模型方差误差。</p><p id="ed73" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们通过交叉验证更好地了解不同的训练数据集。在<strong class="jx io"> <em class="kt"> k-fold 交叉验证</em> </strong>中，训练数据被分割成<strong class="jx io"> <em class="kt"> k </em> </strong>个更小的集合，其中使用 fold 的<strong class="jx io"> <em class="kt"> k-1 </em> </strong>作为训练数据来训练模型，并且在数据的剩余部分上评估得到的模型，即，它被用作测试集合来计算诸如<code class="fe nc nd ne nf b">mean_squared_error</code>的性能测量。然后通过简单地取每个模型的平均值来测量 k 倍交叉验证的性能。</p><ul class=""><li id="66cf" class="ng nh in jx b jy jz kc kd kg ni kk nj ko nk ks nl nm nn no bi translated">假设，我们通过将数据分成五个小的训练样本，将训练观察结果<code class="fe nc nd ne nf b">{(X1, y1), (X2, y2), (X3, y3), ...,(Xn, yn))}</code>分成五个交叉验证。</li><li id="a5e0" class="ng nh in jx b jy np kc nq kg nr kk ns ko nt ks nl nm nn no bi translated">然后，我们在大型训练集的这五个不同子集上拟合模型。现在我们有五个模型。</li><li id="09d8" class="ng nh in jx b jy np kc nq kg nr kk ns ko nt ks nl nm nn no bi translated">在拟合一个模型后，我们估计未知的近似函数<code class="fe nc nd ne nf b">y_hat</code>，其中我们期望<strong class="jx io"> y_hat </strong>的预测值近似等于<code class="fe nc nd ne nf b">y1, y2, y3, ..., yn</code>。</li><li id="3df3" class="ng nh in jx b jy np kc nq kg nr kk ns ko nt ks nl nm nn no bi translated">当我们试图使用这五个不同的模型来预测新的未知测试数据<code class="fe nc nd ne nf b">(X0, y0)</code>时，从先前训练的五个模型预测新输入<strong class="jx io"> X0 </strong>的五个值应该是相似的，并且大约等于输出值<strong class="jx io"> y0 </strong>。</li></ul><p id="ce56" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">方差表示模型的结果如何随着数据集中的变化而变化。这五个预测值的分布是指预测误差中的方差误差。如果它们彼此接近，则模型具有<strong class="jx io">低方差。</strong>相反，如果预测值相差很远，则模型具有<strong class="jx io">高方差</strong>。</p><p id="a7d9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">方差更多地受到数据点中的噪声和随机性的影响。高方差使模型对异常值或随机噪声过于敏感，而不是很好地概括。例如，线性模型基于输入和输出变量之间存在线性关系的假设进行预测，并且几乎不受数据结构的影响。而在决策树中，预测依赖于数据集。如果数据集包含异常值，那么决策树模型的预测将会很差，并且比线性回归模型具有更高的方差。</p><figure class="ll lm ln lo gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nu"><img src="../Images/710f81fbda0fa8641d921c6071f5be35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Z2KpBSfjM3PyDUK4ngTww.png"/></div></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk translated">高方差和低偏差(过拟合)</figcaption></figure><p id="e63d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在上图中，蓝色圆圈代表了考虑到我们可以获得的所有数据组合的完美模型。每个橙色的点标记是由我们在不同的训练数据子集上学习的模型做出的预测。</p><p id="4b07" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">过度拟合的模型受预测方差误差的影响很大。高度复杂或具有大量特征/属性的模型更容易过度拟合数据。它们对训练数据中的异常值或微小变化更敏感，这些异常值或微小变化可能会导致预测值发生较大变化。通常，过拟合模型通常会有<strong class="jx io">高方差</strong>。</p><p id="854a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">而欠拟合模型将具有极低的<strong class="jx io">方差</strong>，因为该模型不会学习任何模式，或者不依赖于它所获得的任何数据子集，并且预测常数值。</p></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h1 id="2ce9" class="lz ma in bd mb mc nv me mf mg nw mi mj mk nx mm mn mo ny mq mr ms nz mu mv mw bi translated">理解偏差</h1><p id="c91d" class="pw-post-body-paragraph jv jw in jx b jy mx ka kb kc my ke kf kg mz ki kj kk na km kn ko nb kq kr ks ig bi translated">根据定义，</p><blockquote class="lt lu lv"><p id="e6d8" class="jv jw kt jx b jy jz ka kb kc kd ke kf lw kh ki kj lx kl km kn ly kp kq kr ks ig bi translated">偏差误差是模型在所有可能的训练数据集上估计量的实际值和预测值之间的平均差异。</p></blockquote><p id="f0e8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">偏差是由于模型对数据中参数的错误假设而产生的误差。考虑到上面的例子，我们将我们的训练数据集分成五个子集，并在这些子集上训练我们的模型。由于数据中潜在的噪声和随机性，这些子集对新输入<code class="fe nc nd ne nf b">(X0, y0)</code>的预测不会总是相同的，而<strong class="jx io">偏差</strong>试图测量实际值和预测值之间的差异。因此，偏差表示模型在整个训练数据集子集上的平均近似误差。</p><p id="8bed" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">偏差受到模型对数据和模式的错误假设的影响。例如，线性回归算法假设输入(X)和输出(y)之间的关系总是线性的，即使数据没有这样的关系，而决策树对数据结构没有这样的假设，并且纯粹从数据中学习模式。因此，线性模型往往比决策树模型有更高的偏差。</p><p id="f96d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">过度拟合模型是具有大量特征的过度复杂的模型。随着模型复杂性的增加，模型将了解更多的数据趋势和模式，这将有助于预测准确的输出。平均而言，过拟合模型比欠拟合模型表现更好。因此，过度拟合的模型通常具有<strong class="jx io">低偏差</strong>误差。</p><figure class="ll lm ln lo gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oa"><img src="../Images/18e7f86efc88f31e040689812a232de3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i7nLh3OyUEjQ-5EgOYJucw.png"/></div></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk translated">高偏置和低方差(欠拟合)</figcaption></figure><p id="b1fb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">欠拟合模型受预测偏差误差的影响很大，通常具有<strong class="jx io">高偏差</strong>和<strong class="jx io">低方差</strong>误差。</p><p id="6628" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">具有高偏差和低方差的模型如上图所示，该图倾向于做出恒定的预测，而不考虑模型所基于的数据集。它将不会学习做出正确预测所需的训练数据中的必要模式和关系，并且由于高偏差误差而产生关于数据的错误假设。这样一来，就无法很好地概括了。</p><h1 id="1b3e" class="lz ma in bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">偏差-方差权衡</h1><p id="50be" class="pw-post-body-paragraph jv jw in jx b jy mx ka kb kc my ke kf kg mz ki kj kk na km kn ko nb kq kr ks ig bi translated">随着模型复杂性的增加，方差增加，偏差减少。这两个量的相对变化率决定了测试误差是增加还是减少。</p><figure class="ll lm ln lo gt jo gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/ad6d64012ae52cdd5c303d3b11f5587d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*WaZtPef1z_wxew9ONx1B2A.png"/></div></figure><p id="62ba" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">当我们增加模型的复杂性时，偏差最初会减少，而方差会增加。因此，预期误差也减小了。然而，在某些时候，增加复杂性对偏倚的影响很小，但方差显著增加，这增加了预期的测试误差。</p><p id="45a7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">当我们降低模型的复杂性时，检验误差会减小，因为方差会减小，而偏差会增大。然而，当我们增加模型的复杂性时，方差会增加，但偏差会通过减少测试误差而减少。</p><p id="9c51" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">偏差、方差和测试误差之间的这种关系称为<strong class="jx io"> <em class="kt">偏差-方差权衡</em> </strong>。统计模型或机器学习算法的良好测试集性能需要<strong class="jx io">低方差</strong>和<strong class="jx io">低平方偏差</strong>，这实际上是不可能的。</p><p id="32be" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">很容易获得低偏差但高方差的算法(过拟合模型)或低方差但高偏差的算法(欠拟合模型)。</p><p id="5b56" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">面临的挑战是建立一个模型，找到偏差-方差权衡之间的平衡。在实践中，为机器学习模型显式计算未知数据的测试误差、偏差或方差是不可行的。</p><p id="8b46" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们仍然可以通过理解模型的过拟合和欠拟合来评估模型的性能。但是，在选择和评估机器学习模型时，应该记住偏差-方差权衡。为了减少偏差，我们需要对数据的结构做出合理的假设，同时，我们必须确保它从数据中学习，而不是过度拟合。</p><p id="664a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">偏差-方差权衡是机器学习中令人困惑的概念之一。我希望这能帮助你理解偏差和方差以及它们之间的权衡。</p><p id="1c53" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">感谢您的阅读！</p><p id="7909" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">资源:</strong></p><ul class=""><li id="cf58" class="ng nh in jx b jy jz kc kd kg ni kk nj ko nk ks nl nm nn no bi translated"><a class="ae oc" href="https://www.statlearning.com/" rel="noopener ugc nofollow" target="_blank"><em class="kt">【R 中统计学习的介绍与应用</em> </a> <em class="kt">【书】</em></li><li id="9369" class="ng nh in jx b jy np kc nq kg nr kk ns ko nt ks nl nm nn no bi translated"><a class="ae oc" href="http://scott.fortmann-roe.com/docs/BiasVariance.html" rel="noopener ugc nofollow" target="_blank">了解偏差-方差权衡</a></li><li id="7b57" class="ng nh in jx b jy np kc nq kg nr kk ns ko nt ks nl nm nn no bi translated"><a class="ae oc" href="https://en.wikipedia.org/wiki/Bias%E2%80%93variance_tradeoff" rel="noopener ugc nofollow" target="_blank">偏差-方差权衡</a></li></ul></div></div>    
</body>
</html>