<html>
<head>
<title>Learning Go, A Journey: Testing and Benchmarking #7</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">学习围棋之旅:测试和基准测试#7</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/learning-go-a-journey-testing-and-benchmarking-6-70058827ed81?source=collection_archive---------12-----------------------#2022-09-24">https://blog.devgenius.io/learning-go-a-journey-testing-and-benchmarking-6-70058827ed81?source=collection_archive---------12-----------------------#2022-09-24</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="ee97" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">测试是评估和验证我们的程序的过程，以确保它做它应该做的事情。在我们的产品上市并被用户使用之前，需要进行测试。Golang 有一个很好的测试和基准测试方法，由标准库 testing 提供。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7da58183a55c190b88edcb6003b4bf6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7dHiCzFNFa1X_W1R6Vi7rQ.png"/></div></div></figure><h1 id="dbbd" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">测试</h1><p id="be89" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">让我们来看一个可以测试的示例代码</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lx"><img src="../Images/8edd69663f977d39eda36fc462cf9c22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*A_XmF1xdeOphg9Q3"/></div></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">main.go</figcaption></figure><p id="f3bc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">正如我们所看到的，在主包中我们有一个阶乘函数，它接收一个数字并返回该数字的阶乘。我们可以通过在包含所有测试函数的同一个名为“main_test.go”的包中创建新文件来测试阶乘函数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lx"><img src="../Images/877199594f5b98f872b8d7557c705eb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FeSkzZCXgYKs_8Jy"/></div></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">主 _ 测试. go</figcaption></figure><p id="242d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了测试我们的一个函数，我们必须创建一个名为“TestXxx”的函数。“Xxx”代表函数的名称。该函数接收一个参数，该参数是来自包测试的指针类型“t”。在函数内部，我们可以用一个值和一个预期的结果创建多个测试用例。之后，我们在切片上测试每种情况，如果期望值不匹配，我们抛出一个错误。要运行我们的测试，如果您使用 Visual Studio 代码，您可以单击测试函数上方的“运行测试”,或者您可以运行“go test”或“go test -v”。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lx"><img src="../Images/15209c6f355cbec3ce0aaacf8addece6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HBewFWRRkvKazk4O"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mc"><img src="../Images/52f5942e7960df6b3a8048c19738308f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*um_t-8UWS84Iu9At"/></div></div></figure><p id="ff55" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">正如我们所看到的，我们已经运行了我们的测试，结果是“PASS ”,这意味着我们的程序正在按预期工作。</p><h1 id="44d3" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">提供示例</h1><p id="7c21" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">包测试还运行并验证示例代码。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lx"><img src="../Images/dabad6d67cd6d4d63c88dc9851640ddf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IuUZPnCpRHqfbb5I"/></div></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">你好，去吧</figcaption></figure><p id="fee0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">例如，我们有一个包“hello ”,它具有函数“SayHello”和附加到类型“Person”的“Introduction”方法。我们可以通过在同一个包中创建一个名为“hello_test.go”的新文件来为这些函数创建一个示例。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lx"><img src="../Images/326855d07825ab43fef8278be76988a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WUGkv0lLL-K0OmOM"/></div></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">hello_test.go</figcaption></figure><p id="4800" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要创建一个示例，我们必须将函数命名为“ExampleXxx”。“Xxx”是函数的名称。我们可以调用“Println”来写输出。在输出下面，我们要写一个注释“output:”然后是输出的结果。然后我们可以像运行测试一样运行这个例子。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mc"><img src="../Images/5798479314da2d0836711a7a3a5a020a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gP4IkEueX0Czku-6"/></div></div></figure><p id="406b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">正如我们所看到的，我们已经成功地运行了我们的示例。</p><h1 id="6f1a" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">标杆管理</h1><p id="384b" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">基准测试是一种用性能指标测试代码性能的方法。标杆管理有助于保持我们的项目达到标准质量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lx"><img src="../Images/72639bfe078469aee4521fb6db9d3328.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nCpcWB-p3Ho67Jgl"/></div></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">打招呼去吧</figcaption></figure><p id="792d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">例如，我们有一个名为“greet”的包来问候人们。为了对包中的一个函数进行基准测试，我们可以创建一个名为“greet_test.go”的文件，并创建一个基准函数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lx"><img src="../Images/4cf4d065c7c00d3fd53a85d6bcd04673.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*I0J8WMAC2oqCg6po"/></div></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">greet_test.go</figcaption></figure><p id="63e9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">基准函数必须命名为“BenchmarkXxx”。“Xxx”是我们想要测试的函数的名称。基准函数接收一个 testing.B 类型的指针，在函数内部，我们要创建一个 for 循环，从“b”开始循环“N”次。循环次数由包装决定。在循环函数内部，我们调用“Greet”函数。要运行基准测试，如果您使用 Visual Studio 代码，请单击基准测试函数上方的“运行基准测试”或运行命令“运行测试工作台”在 bash(“.”意味着我们运行所有基准测试)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lx"><img src="../Images/ef10db0fd43f52f217763e16d0ba0499.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LRmEpsHlfWBzwIk0"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mc"><img src="../Images/f938a13d401eeb7a28ccdf94c720e93e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xaFUA_0mMmoFdBe_"/></div></div></figure><p id="89dd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">结果显示了每次操作花费的时间。在这种情况下，要运行“greet”函数，程序需要 123.2 纳秒。在那之后，我们可以根据度量标准决定是改变还是保留代码。</p></div><div class="ab cl md me hr mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ig ih ii ij ik"><p id="3d44" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">本文到此为止，别忘了留下一个赞，分享给别人。如果您有任何反馈，请在下面留下您的评论。感谢你阅读这篇文章，祝你有美好的一天👋。</p></div></div>    
</body>
</html>