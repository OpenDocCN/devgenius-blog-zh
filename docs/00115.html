<html>
<head>
<title>Microservices Boilerplate — with Lumen + Laravel + Nginx + Mysql → part (1/3)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">微服务样板——带 Lumen + Laravel + Nginx + Mysql →零件(1/3)</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/micro-services-with-lumen-laravel-nginx-mysql-70b3554e8068?source=collection_archive---------0-----------------------#2020-02-16">https://blog.devgenius.io/micro-services-with-lumen-laravel-nginx-mysql-70b3554e8068?source=collection_archive---------0-----------------------#2020-02-16</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/52c27fb2c699b0fe7363e44b962dac77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o_bw_35FLpOu33n17oFcKQ.png"/></div></div></figure><h2 id="f487" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">在这个系列中</h2><ul class=""><li id="cd08" class="kr ks in kt b ku kv kw kx ke ky ki kz km la lb lc ld le lf bi translated"><a class="ae lg" href="https://medium.com/@shadysmaoui/micro-services-with-lumen-laravel-nginx-mysql-70b3554e8068" rel="noopener">微服务样板文件:设置(第 1/3 部分)</a></li><li id="8886" class="kr ks in kt b ku lh kw li ke lj ki lk km ll lb lc ld le lf bi translated"><a class="ae lg" href="https://medium.com/@shadysmaoui/microservices-boilerplate-with-lumen-laravel-nginx-mysql-part-2-3-a3c0cc241cf4" rel="noopener">微服务样板:设计(第 2/3 部分)</a></li></ul></div><div class="ab cl lm ln hr lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ig ih ii ij ik"><h2 id="b8cf" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">介绍</h2><p id="179c" class="pw-post-body-paragraph lt lu in kt b ku kv lv lw kw kx lx ly ke lz ma mb ki mc md me km mf mg mh lb ig bi translated">在这篇文章中，我将一步一步地演示用<code class="fe mi mj mk ml b">Lumen</code>和<code class="fe mi mj mk ml b">Laravel</code>以及作为 web 服务器的<code class="fe mi mj mk ml b">nginx</code>和<code class="fe mi mj mk ml b">mysql</code>来对接您的微服务项目的过程。这是三篇文章系列的第一部分。这个初始部分将允许我们建立我们项目的基础，对其主要组件进行分类，并建立基础，以便在所有组件之间进行流畅的交流。</p><p id="a134" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">下面是与这个项目相关的 Github 资源库:</p><p id="13d3" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">【https://github.com/shsma/microservices-workspace】</p><h2 id="daeb" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">先决条件:</h2><ul class=""><li id="7fb6" class="kr ks in kt b ku kv kw kx ke ky ki kz km la lb lc ld le lf bi translated"><code class="fe mi mj mk ml b">Docker</code></li><li id="2fe9" class="kr ks in kt b ku lh kw li ke lj ki lk km ll lb lc ld le lf bi translated"><code class="fe mi mj mk ml b">Docker-compose</code></li></ul><h2 id="ae23" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">技术</h2><ul class=""><li id="27ec" class="kr ks in kt b ku kv kw kx ke ky ki kz km la lb lc ld le lf bi translated"><code class="fe mi mj mk ml b">Lumen -v 6.x</code>:它是构建基于<code class="fe mi mj mk ml b">Laravel</code>的微服务和超快的 API 的完美解决方案。这是目前最快的微框架之一。<br/><a class="ae lg" href="https://lumen.laravel.com/" rel="noopener ugc nofollow" target="_blank">https://lumen.laravel.com/</a></li><li id="8169" class="kr ks in kt b ku lh kw li ke lj ki lk km ll lb lc ld le lf bi translated"><code class="fe mi mj mk ml b">Laravel -v 6.x</code> : Laravel 是一个 web 应用框架，具有丰富、优雅的语法。<br/><a class="ae lg" href="https://laravel.com/" rel="noopener ugc nofollow" target="_blank">https://laravel.com/</a></li><li id="dcda" class="kr ks in kt b ku lh kw li ke lj ki lk km ll lb lc ld le lf bi translated"><code class="fe mi mj mk ml b">Nginx:</code>它是一种网络服务器，可为互联网上最繁忙的网站加速内容和应用交付、提高安全性、促进可用性和可扩展性。<br/><a class="ae lg" href="https://www.nginx.com/" rel="noopener ugc nofollow" target="_blank">https://www.nginx.com/</a></li><li id="9c02" class="kr ks in kt b ku lh kw li ke lj ki lk km ll lb lc ld le lf bi translated">我们将使用<code class="fe mi mj mk ml b">php-7.4</code>和<code class="fe mi mj mk ml b">fpm</code>进程管理器。</li><li id="cbb8" class="kr ks in kt b ku lh kw li ke lj ki lk km ll lb lc ld le lf bi translated">我们将使用<code class="fe mi mj mk ml b">mysql 8.0</code>并利用它的超快的速度。</li></ul><h2 id="70a4" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">设置</h2><p id="0782" class="pw-post-body-paragraph lt lu in kt b ku kv lv lw kw kx lx ly ke lz ma mb ki mc md me km mf mg mh lb ig bi translated">创建<code class="fe mi mj mk ml b">microservices-workspace</code>文件夹:</p><p id="964b" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated"><code class="fe mi mj mk ml b">-&gt;$ mkdir microservices-workspace &amp;&amp; cd microservices-workspace</code></p><p id="42bd" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated"><code class="fe mi mj mk ml b">-&gt;$ mkdir apps</code></p><p id="87b9" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">现在，在我们的工作区中，我们创建了<code class="fe mi mj mk ml b">docker</code>文件夹，以及在<code class="fe mi mj mk ml b">apps</code>文件夹中的两个组件<code class="fe mi mj mk ml b">curator</code>和<code class="fe mi mj mk ml b">dipenser</code>文件夹。</p><ul class=""><li id="294a" class="kr ks in kt b ku mm kw mn ke mr ki ms km mt lb lc ld le lf bi translated"><code class="fe mi mj mk ml b">Curator</code>是 Laravel 应用程序，它将包含视图和核心逻辑，以及迁移和模型。</li><li id="3c19" class="kr ks in kt b ku lh kw li ke lj ki lk km ll lb lc ld le lf bi translated"><code class="fe mi mj mk ml b">Dispenser</code>是 Lumen 应用程序，它将充当微服务，分发/应答来自<code class="fe mi mj mk ml b">curator</code>的呼叫。</li></ul><p id="e04c" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated"><code class="fe mi mj mk ml b">-&gt;$ composer create-project --prefer-dist laravel/laravel apps/curator</code></p><p id="3971" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated"><code class="fe mi mj mk ml b">-&gt;$ omposer create-project --prefer-dist laravel/lumen apps/dispenser</code></p><p id="40a1" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">我们将创建一个 docker 文件夹，稍后再处理:</p><p id="ada6" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated"><code class="fe mi mj mk ml b">-&gt;$ mkdir docker</code></p><p id="fe7b" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">最后，我们需要在项目的根目录下创建一个<code class="fe mi mj mk ml b">docker-compose</code>文件:</p><p id="ad5b" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated"><code class="fe mi mj mk ml b">-&gt;$ touch docker-compose.yml</code></p><h2 id="f83c" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">文件夹结构</strong></h2><p id="45ed" class="pw-post-body-paragraph lt lu in kt b ku kv lv lw kw kx lx ly ke lz ma mb ki mc md me km mf mg mh lb ig bi translated">以下是我们的目标文件夹结构:</p><figure class="mv mw mx my gt jo gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/1779af85983cf3dfc2ef1ba23602fb44.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/1*umylJow0xRrdmpOiGzx2Hw.png"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">文件夹结构</figcaption></figure><h2 id="60f3" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">设置 Docker + Docker-compose </strong></h2><h2 id="8677" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">Docker 文件</h2><p id="9ce6" class="pw-post-body-paragraph lt lu in kt b ku kv lv lw kw kx lx ly ke lz ma mb ki mc md me km mf mg mh lb ig bi translated">由于我们不会为两个<code class="fe mi mj mk ml b">php </code>应用程序使用来自<code class="fe mi mj mk ml b">docker-compose</code>文件的预编译图像，我们需要为每个组件提供一个特定的<code class="fe mi mj mk ml b">Dockerfile</code>:</p><p id="2c92" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">→ <code class="fe mi mj mk ml b">.apps/curator/Dockerfile</code></p><figure class="mv mw mx my gt jo"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="79a9" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">→ <code class="fe mi mj mk ml b">.apps/dispenser/Dockerfile</code></p><figure class="mv mw mx my gt jo"><div class="bz fp l di"><div class="nd ne l"/></div></figure><h2 id="53ff" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">docker-撰写</h2><p id="9f1d" class="pw-post-body-paragraph lt lu in kt b ku kv lv lw kw kx lx ly ke lz ma mb ki mc md me km mf mg mh lb ig bi translated">→首先，我们需要在我们的<code class="fe mi mj mk ml b">docker-compose.yml</code>中设置<code class="fe mi mj mk ml b">Nginx</code>网络服务器组件。</p><figure class="mv mw mx my gt jo gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/bad8cdf75e64319051e335c3372fee58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*_xRAecm-VPZyxeNAPa7ehg.png"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">Nginx 组件</figcaption></figure><p id="10ca" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">→既然 web 服务器已经在我们的 docker-compose 文件中设置好了，是时候建立两个主要组件了，<code class="fe mi mj mk ml b">curator</code>和<code class="fe mi mj mk ml b">dispenser</code>:</p><figure class="mv mw mx my gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi gj"><img src="../Images/77962bdc3fd44e5f0a2c8722caaaf17d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LxXddPbGgs1qfu_CrKXDpA.png"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">策展人组件</figcaption></figure><figure class="mv mw mx my gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ng"><img src="../Images/5869ae245ce93d0b8195d9dcbce884ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0JPfCKGQoWiyJcm628HbiA.png"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">分配器组件</figcaption></figure><p id="ee00" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">在这一阶段，我们的 web 服务器和两个主要组件已经安装完毕。剩下要做的就是设置<code class="fe mi mj mk ml b">db</code>组件。我们必须记住网络设置，以便 web 服务器按照<code class="fe mi mj mk ml b">bridge</code>设计模式的规定正常运行，最后是<code class="fe mi mj mk ml b">volumes</code>确保我们的<code class="fe mi mj mk ml b">db</code>组件的某种持久性。</p><figure class="mv mw mx my gt jo gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/b94e503e37a5c69a555fb59b0d4e2195.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*KP-22LIf5kHZmGKjEdOD4w.png"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">Db 组件</figcaption></figure><p id="1524" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">最终结果是，<code class="fe mi mj mk ml b">docker-compose.yml</code>文件应该如下所示:</p><figure class="mv mw mx my gt jo"><div class="bz fp l di"><div class="nd ne l"/></div></figure><h2 id="001a" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">Docker 文件夹</h2><figure class="mv mw mx my gt jo gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/0937f1301d840e2cde28e632deccc126.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/1*lK2db03ktmqB6dE5i-gFdA.png"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">Docker 文件夹结构</figcaption></figure><p id="14a7" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">目前，我们将关注<code class="fe mi mj mk ml b">mysql</code>和<code class="fe mi mj mk ml b">php</code>子文件夹，下一步我们将关注包含更复杂结构的<code class="fe mi mj mk ml b">nginx</code>子文件夹。</p><p id="40fa" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">为了确保我们的整个设置功能正常，我们必须提供一个有效的<code class="fe mi mj mk ml b">php</code>设置，以便<code class="fe mi mj mk ml b">docker-compose</code>文件可以将它链接到应用程序容器中正确的<code class="fe mi mj mk ml b">local.ini</code> <code class="fe mi mj mk ml b">php</code>。</p><p id="3da2" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated"><code class="fe mi mj mk ml b">-&gt;$ cd docker &amp;&amp; mkdir php</code></p><p id="0bb5" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated"><code class="fe mi mj mk ml b">-&gt;$ touch php/local.ini</code></p><p id="bed6" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">将以下设置复制到<code class="fe mi mj mk ml b">local.ini</code>文件中。</p><pre class="mv mw mx my gt nj ml nk nl aw nm bi"><span id="a628" class="jv jw in ml b gy nn no l np nq">upload_max_filesize=40M<br/>post_max_size=40M</span></pre><p id="2e92" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">同样，我们必须设置<code class="fe mi mj mk ml b">mysql</code>配置，以确保<code class="fe mi mj mk ml b">db</code>和<code class="fe mi mj mk ml b">mysql</code>容器正常工作:</p><p id="f98e" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated"><code class="fe mi mj mk ml b">-&gt;$ mkdir mysql &amp;&amp; touch mysql/my.cnf</code></p><p id="5aba" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">将以下内容复制粘贴到与 db 容器内的<code class="fe mi mj mk ml b">my.cnf</code>链接的<code class="fe mi mj mk ml b">my.cnf</code>文件中:</p><pre class="mv mw mx my gt nj ml nk nl aw nm bi"><span id="a15c" class="jv jw in ml b gy nn no l np nq">[mysqld]<br/>general_log = 1<br/>general_log_file = /var/lib/mysql/general.log<br/>secure-file-priv=NULL</span></pre><h2 id="42f8" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">Nginx 文件夹</h2><p id="d776" class="pw-post-body-paragraph lt lu in kt b ku kv lv lw kw kx lx ly ke lz ma mb ki mc md me km mf mg mh lb ig bi translated">首先，我们必须设置<code class="fe mi mj mk ml b">ssl</code>证书，我们将使用这些证书通过<code class="fe mi mj mk ml b">https</code>协议为我们的应用程序提供服务。最初，我们将在<code class="fe mi mj mk ml b">docker</code>文件夹中创建一个<code class="fe mi mj mk ml b">ssl</code>文件夹，并且我们将创建私有和公共密钥，如下所示。</p><p id="6566" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">为了您的方便和保持简单，您将在下面找到私钥和公钥，您可以简单地复制并粘贴到它们的适当位置</p><p id="83a4" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">→ <code class="fe mi mj mk ml b">./docker/nginx/ssl/ssl_cert.key</code></p><pre class="mv mw mx my gt nj ml nk nl aw nm bi"><span id="179a" class="jv jw in ml b gy nn no l np nq">-----BEGIN PRIVATE KEY-----<br/>MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDkqvlH/9a/JiSZ<br/>XR6/Fvb8Q8uaWR+sF/wzD3/d/mrDBMZYyVUVEaTgYiwLe73IFZnvPbijENFKlo/j<br/>o61XtmcPdl690dL/aekFKy7rQoU3nbaxr1MimNY3MZ2kXLL8fgWqs28/Se0EjqUM<br/>O80imUBp3RwvxUa0nY9ooJ09dxPP7O7hjfiNpXYQgZ/LqFOjEeVtjsrI5vT6cKAU<br/>dwEiML12BmXSuJCGsjChmHf6j1J1UkT2jZe9wRyp8HBuP3K6ZN9b/+UV6tmGobzX<br/>jQDM9c7sI0Xgi/Ck3jlP+I8CGokIfESASwkCa0P7xWuOdSMa+DI201GtJiqMi57H<br/>9bINrKoxAgMBAAECggEAGO/YTZTF64SSWzM/hiFQAAS4sHVlsdPPyhW3oRL8u5XK<br/>t6YFJE4PR/UMzpfJA4fviJqXhxjvag3vVSjlX3ph1NrYzCSUuQvowIqMDFXtxzno<br/>0YnILC60tcIwads+HbD0l0AIMsOyGFwh/aqL3WkPEDxvtXnzEwFXwVY6r5hLzdHZ<br/>CstyfkfyBqRfOvBltyt0YraMvr3Icubh/DnK48HzUx3LRQHhPmJSPVVUTgCNtvk/<br/>NtNJofs9bOUc8YZbJPb3WyDJg/DR5g2qEgYASTZNCiyOs89+H/cHBknfGymWdKnp<br/>Tx9BaZGGcrkizlYMqa62LBK8nw3ne88CXcQOAkV0AQKBgQD9oWy/TgmTJjG7heJl<br/>1MIAVPdAdHM+/0wGXHSnoR1hjWE/XO6suQlP0WQa8/YDkVEfcOiHeiH//oorWuTD<br/>hMLKiJXifDSJAnH8ionUEDCh5JJMuhd7ILPrJWB44OeYVWzNzEJqleP4zLp7gg8l<br/>6HBbGhoTW1OIPnBImHiiKpJqQQKBgQDmzdlS+fXsx8ShkOZAD/ZvNYAZIXZay+vd<br/>6in/U9d3YTVYOFpyf2kGppkZmiSw34dIaEp11nwjSo+TPwHUKdg6gRitbpwQlWU5<br/>j2IDUp3otI1AodhcdlVlcAP1tkohArWO86DeAmX7MMbl5QnKV/vvg0b9tY99UGrZ<br/>XRJB19/j8QKBgQDPG949aXAQJQQ/aNiy5sV0l+0/SNhC/R4Lo7vulnXzjwt2PmD3<br/>0jF0aDwidkzSJPvlfMGkv2q8LBKPzK05q1OVJ2udgmcz6jdCTa626HGOAaQl22AJ<br/>P28r+V2J173GextaAg3KE5QROryc1lugTOpSukHIxK61dqch4L/BTJo7AQKBgGj4<br/>CfTw9eYAXO9WJUHRgLTHUkEbtOZKhDVjQEJ9cSs8LLS4vHoCdFOwBUVdk35VywMl<br/>W2gIamDqki3XpA9IEK1a9Uw7WAM6ztTE30C/nE2vf+Z7NRmoP+JodYSUqVYmE0i2<br/>iN0vng4F+w+ngTJjnZMq02ij4GSP5GiDKcCEW7EhAoGBAKisBPhj2b2+spGGHdru<br/>9IsPA6aFiOjrz2RgXangEpulliNfjQK1px9yzo0INdwxB5kXZOEKSNGuBVgeu1zm<br/>FOaiomVfpTfQbTc7GunGeg+tU7fxpwyJ2F4yf93KibZZBQajv1+kYVjvEID+5oDs<br/>PsN8Wxl8hzv36p4674bkzWxj<br/>-----END PRIVATE KEY-----</span></pre><p id="aa6e" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">→ <code class="fe mi mj mk ml b">./docker/nginx/ssl/ssl_cert.pem</code></p><pre class="mv mw mx my gt nj ml nk nl aw nm bi"><span id="51aa" class="jv jw in ml b gy nn no l np nq">-----BEGIN CERTIFICATE-----<br/>MIIDLjCCAhYCCQDL5Hz3lJ4c4TANBgkqhkiG9w0BAQsFADBZMQswCQYDVQQGEwJD<br/>QTEPMA0GA1UECAwGUXVlYmVjMREwDwYDVQQHDAhNb250cmVhbDERMA8GA1UECgwI<br/>TFhSYW5kQ28xEzARBgNVBAMMCmx4cmNvLnRlc3QwHhcNMTgwOTI1MjAxMjAzWhcN<br/>MTkwOTI1MjAxMjAzWjBZMQswCQYDVQQGEwJDQTEPMA0GA1UECAwGUXVlYmVjMREw<br/>DwYDVQQHDAhNb250cmVhbDERMA8GA1UECgwITFhSYW5kQ28xEzARBgNVBAMMCmx4<br/>cmNvLnRlc3QwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDkqvlH/9a/<br/>JiSZXR6/Fvb8Q8uaWR+sF/wzD3/d/mrDBMZYyVUVEaTgYiwLe73IFZnvPbijENFK<br/>lo/jo61XtmcPdl690dL/aekFKy7rQoU3nbaxr1MimNY3MZ2kXLL8fgWqs28/Se0E<br/>jqUMO80imUBp3RwvxUa0nY9ooJ09dxPP7O7hjfiNpXYQgZ/LqFOjEeVtjsrI5vT6<br/>cKAUdwEiML12BmXSuJCGsjChmHf6j1J1UkT2jZe9wRyp8HBuP3K6ZN9b/+UV6tmG<br/>obzXjQDM9c7sI0Xgi/Ck3jlP+I8CGokIfESASwkCa0P7xWuOdSMa+DI201GtJiqM<br/>i57H9bINrKoxAgMBAAEwDQYJKoZIhvcNAQELBQADggEBAHL+nIFZO4wtEWfewdI9<br/>9paXoHpqHvY/twLU5Jekx7REv5+deYH4/aaq+gcDu3zgSCJz9mu/v8e+EDRVAmJf<br/>yX01JMGuRC/G10YRiUYsaHXlYcn7dZsxPnZ1zi5vAiNymaxk14vIkpnkAjRe56B6<br/>6iUuyGesu3xSRLCZkAi+YMQYq6qIqIn4LW87oQ6CrM0tTpb8u1QPQlz8FJ5MHLkf<br/>ldXfQmbF3yGndl+cEsDKsExYV72vbJ441cpVGJmTupv5q4QOqsHgv1cnwXjvqio/<br/>b0fQBBOE//o1aTgA1rZVWBONlTC4QBY7TzJe7+B2DEDQlXfWVOnB8dkkqNsRKtWo<br/>ywA=<br/>-----END CERTIFICATE-----</span></pre><p id="494d" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">此时，<code class="fe mi mj mk ml b">ssl</code>证书应该是好的，并且已经设置好了，这允许我们继续构建我们的<code class="fe mi mj mk ml b">Nginx</code>服务器。</p><p id="b433" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">在<code class="fe mi mj mk ml b">Ngnix</code>文件夹的根目录下有我们的主文件夹<code class="fe mi mj mk ml b">nginx.conf</code>，它包含 web 服务器的核心配置，我们稍后将把特定于每个组件的配置转置到其中。</p><p id="0e61" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">→ <code class="fe mi mj mk ml b">./docker/nginx/nginx.conf</code></p><figure class="mv mw mx my gt jo"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="8b93" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">在<code class="fe mi mj mk ml b">/nginx</code>文件夹中，我们将创建一个<code class="fe mi mj mk ml b">/sites</code>文件夹，其中包含特定于每个组件的配置:</p><p id="bbd9" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">→ <code class="fe mi mj mk ml b">./docker/nginx/sites/curator.conf</code></p><figure class="mv mw mx my gt jo"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="9125" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">→ <code class="fe mi mj mk ml b">./docker/nginx/sites/dispenser.conf</code></p><figure class="mv mw mx my gt jo"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="5980" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">在流程的这个阶段，最后一个任务是将域名添加到我们的主机中，放在<code class="fe mi mj mk ml b">/etc/hosts</code>下，这样我们就可以在本地主机上提供服务。</p><p id="adae" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">→在<code class="fe mi mj mk ml b">/etc/hosts:</code>的底部添加以下一行</p><p id="aa1f" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated"><code class="fe mi mj mk ml b">127.0.0.1 dispenser.shadysmaoui.test<br/> 127.0.0.1 curator.shadysmaoui.test</code></p><p id="bc6a" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">我们现在准备尝试构建和运行我们的组件，但是首先我们应该在<code class="fe mi mj mk ml b">.env</code>文件中为每个应用程序生成应用程序密钥。因此，导航到应用程序文件夹并执行这两个命令..</p><p id="7071" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated"><code class="fe mi mj mk ml b">cp .env.example .env</code></p><p id="306f" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated"><code class="fe mi mj mk ml b">php artisan key:gen</code></p><p id="b6f7" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">从项目的根目录中运行“生成并运行”命令:</p><p id="d6c1" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated"><code class="fe mi mj mk ml b">docker-comopse build &amp;&amp; docker-compose up -d</code></p><p id="f805" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">构建完成了，我们的容器也准备好了，我们需要从每个容器中运行<br/> <code class="fe mi mj mk ml b"> composer install</code>。</p><p id="7336" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">现在访问下面的域</p><p id="4514" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated"><code class="fe mi mj mk ml b"><a class="ae lg" href="https://dispenser.shadysmaoui.test" rel="noopener ugc nofollow" target="_blank">https://dispenser.shadysmaoui.test</a> &amp;&amp; https://<a class="ae lg" href="https://curator.shadysmaoui.test" rel="noopener ugc nofollow" target="_blank">curator.shadysmaoui.test</a>\</code></p><figure class="mv mw mx my gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nr"><img src="../Images/1607421950d1bfd8ac5af0ed8955bc06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nwuwIi75PlH-nsaCAJNbvQ.png"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">管理者</figcaption></figure><figure class="mv mw mx my gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ns"><img src="../Images/53888367ce672b8ea000385e60480ab3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vtMq10WBKuUhJU84Hk9v3A.png"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">药剂师</figcaption></figure><p id="5cd4" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">开始了。为了在这个系列中促进开发工作流，我们已经正确地完成了我们的设置。</p><p id="00d8" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">如果你喜欢这篇文章，请<strong class="kt io">鼓掌并订阅</strong>！干杯！！✌🏽💕💕👌🏽</p><p id="c7d4" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated">别忘了明星<a class="ae lg" href="https://github.com/shsma/microservices-workspace" rel="noopener ugc nofollow" target="_blank">https://github.com/shsma/microservices-workspace</a>；)</p><p id="8760" class="pw-post-body-paragraph lt lu in kt b ku mm lv lw kw mn lx ly ke mo ma mb ki mp md me km mq mg mh lb ig bi translated"><strong class="kt io">在这里继续阅读第二部分:</strong></p><div class="nt nu gp gr nv nw"><a href="https://medium.com/@shadysmaoui/microservices-boilerplate-with-lumen-laravel-nginx-mysql-part-2-3-a3c0cc241cf4" rel="noopener follow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd io gy z fp ob fr fs oc fu fw im bi translated">微服务样板文件—带有 Lumen + Laravel + Nginx + Mysql →部分(2/3)</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">现在，我们的设置已经完成，可扩展架构的基础也准备好了，我们可以向前看并思考…</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">medium.com</p></div></div><div class="of l"><div class="og l oh oi oj of ok jt nw"/></div></div></a></div></div></div>    
</body>
</html>