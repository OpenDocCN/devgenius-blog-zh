<html>
<head>
<title>Pushing messages from Amazon SQS to DynamoDB</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从亚马逊 SQS 向 DynamoDB 推送消息</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/pushing-messages-from-amazon-sqs-to-dynamodb-bf1c1fa5c2c3?source=collection_archive---------1-----------------------#2022-02-10">https://blog.devgenius.io/pushing-messages-from-amazon-sqs-to-dynamodb-bf1c1fa5c2c3?source=collection_archive---------1-----------------------#2022-02-10</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="ca26" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">亚马逊 SQS 是最受欢迎的托管消息队列服务之一。它用于分离组件，并在大型应用程序中实现异步流程。一些用例包括高吞吐量、系统到系统的消息传递、缓冲和批处理作业、请求卸载、收集应用程序日志和指标、触发 SMS/电子邮件服务、收集元数据等。SQS 与 Lambda 和 DynamoDB 等工具相结合，形成了一个强大的框架，可以轻松应对与此类操作相关的挑战。</p><p id="a050" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在本文中，我将演示使用 AWS Lambda 从 SQS 异步收集数据并将其存储到 DynamoDB 的过程。这种设置在许多情况下都很有用，例如，在从电子商务网站到流媒体平台的各种应用程序中收集和存储元数据。</p><p id="7cfd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们假设一个应用程序想要收集用户的设备和位置信息作为元数据，并将其存储在 dynamoDB 表中。让我们先来看看系统的整体架构:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7a9cac5daff8cd357f07344bbc9ea611.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iqn8gyXYyV9axPovTKo6fQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">系统结构</figcaption></figure><p id="4b1c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这是一个实现起来相当简单的系统。主应用程序将消息推入消息队列(SQS)。队列反过来触发一个 lambda 函数，并将收到的消息作为有效负载发送出去。lambda 函数可以包含对接收到的数据执行各种操作的代码。在这种情况下，它将数据保存到 DynamoDB 表中，并将一些信息记录到 Cloudwatch 中。为了简单起见，我们将使用 AWS 控制台将消息推送到 SQS，而不是一个成熟的应用程序，因为它将服务于演示这个想法的目的。现在让我们来看一下这些步骤:</p><blockquote class="ky kz la"><p id="e312" class="jk jl lb jm b jn jo jp jq jr js jt ju lc jw jx jy ld ka kb kc le ke kf kg kh ig bi translated"><strong class="jm io">第一步:创建一个 SQS 队列</strong></p></blockquote><ol class=""><li id="1c1b" class="lf lg in jm b jn jo jr js jv lh jz li kd lj kh lk ll lm ln bi translated">访问 SQS <a class="ae lo" href="https://console.aws.amazon.com/sqs/v2/home" rel="noopener ugc nofollow" target="_blank">控制台</a>，点击<strong class="jm io">开始</strong>下的<strong class="jm io">创建队列</strong>:</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lp"><img src="../Images/986af77d43a52f4533f539f6e18b696d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FqyDOeHe6jGUuUxBdstfDQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">单击突出显示的按钮</figcaption></figure><p id="2901" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">2.选择队列'<strong class="jm io">类型</strong>作为'<strong class="jm io">标准</strong>，<strong class="jm io">输入队列名称</strong>。为了简单起见，保留其他选项的默认设置。滚动到页面底部，点击'<strong class="jm io">创建队列'</strong>，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lp"><img src="../Images/b864cef5afbdd0edc3ee1632ed52f59a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t-gKOUFz1IfoFxWc8tovDg.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lp"><img src="../Images/3cafc02f9068c07c7406087b6ce63655.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QObAVKN4i6tLWiufswlWig.png"/></div></div></figure><p id="471b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">3.创建队列后，您将被重定向到队列的详细信息页面。这个控制台有许多选项，可以用来管理队列的所有方面。然而，我们只关心发送消息。点击'<strong class="jm io">发送和接收信息'</strong>按钮(右二) :</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lq"><img src="../Images/f25c6d7d0852485e4242dc07ffa1d024.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c8Y3qgJjJRNUXZlx08kODg.png"/></div></div></figure><p id="c90f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">4.在“<strong class="jm io">发送消息”</strong>部分，在“<strong class="jm io">消息正文”</strong>文本框中输入一条消息，然后点击“<strong class="jm io">发送消息</strong>”按钮，如图所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lp"><img src="../Images/4e59061763bda79b85311648ec5955a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cW43y3R8k7Di2_H7q23xBA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">要作为消息发送到队列中的字符串化 JSON 有效负载</figcaption></figure><p id="3774" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">5.要查看队列中已发送的消息，请向下滚动到“<strong class="jm io">接收消息”</strong>部分，然后单击“<strong class="jm io">轮询消息”。</strong>这将开始轮询队列，获取的消息显示在此部分:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lr"><img src="../Images/f3925ce94a910e2c81983f72a1d5f874.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OPF5Oo-GKujycDsONv_YGA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">单击突出显示的按钮</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ls"><img src="../Images/fa705df9fbb8805f41523a02680f9de5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D3a02B_0-X1K2G_COqms-g.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">开始显示消息—单击 ID</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lt"><img src="../Images/182d105b958e73488b41528633ecfc73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Me818DsNM-3CvijJM48fQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">单击 ID 时显示的消息详细信息</figcaption></figure><p id="a210" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这个阶段，我们有一个功能性队列，可以向它推送消息，也可以从它那里轮询消息。消息的内容可在消息对象的'<em class="lb"> body' </em>属性下获得。在这里，我们可以找到所需的 JSON 格式的有效载荷。下一步是创建一个 lambda 函数，它最终会被上面的队列触发。</p><blockquote class="ky kz la"><p id="b0d5" class="jk jl lb jm b jn jo jp jq jr js jt ju lc jw jx jy ld ka kb kc le ke kf kg kh ig bi translated"><strong class="jm io">第二步:创建 Lambda 函数</strong></p></blockquote><ol class=""><li id="f3d1" class="lf lg in jm b jn jo jr js jv lh jz li kd lj kh lk ll lm ln bi translated">访问<a class="ae lo" href="https://console.aws.amazon.com/lambda/home" rel="noopener ugc nofollow" target="_blank"> AWS Lambda 控制台</a>并点击“<strong class="jm io">创建功能</strong>”按钮:</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lp"><img src="../Images/5df542770948e1b1bfa59e39612090bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HwOWmf4wSEfgxf4K8FMDRQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">单击突出显示的按钮</figcaption></figure><p id="2165" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">2.在创建功能页面中，从头选择'<strong class="jm io">作者</strong>'。在基本详细信息下，输入函数名称。然后点击'<strong class="jm io">权限</strong>部分下的'<strong class="jm io">更改默认执行角色</strong>，如图所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lu"><img src="../Images/09a7814ad638ed162d68590151db8f80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sMjz345Cb4UTo1xuoyA-wA.png"/></div></div></figure><p id="8e54" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">3.选择“<strong class="jm io">从 AWS 策略模板</strong>创建新角色”。输入角色名称和策略模板，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/ec53833a6da415737908d5c5213dddce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_34OIUs-HoZoCv0oTF9T9g.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd lw">这些策略为 lambda 函数提供了轮询 SQS 和写入 dynamoDB 和 cloudwatch 的权限。</strong></figcaption></figure><p id="7ad7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">4.保留其他选项的默认设置，并点击页面底部的“<strong class="jm io">创建功能</strong>”。这将创建一个准系统 Node.js lambda 函数并在编辑器中显示它:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lp"><img src="../Images/e0d587047002c337da87d932ad76e7a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fl9s9BKOIoNaT3P3aRj4MQ.png"/></div></div></figure><p id="f777" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">5.用以下代码覆盖编辑器的内容，然后单击'<strong class="jm io"> Deploy </strong>':</p><p id="d28d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe lx ly lz ma b">exports.handler = async (event) =&gt; {<br/> console.log(event.Records); // array property has the messages from SQS<br/> return;<br/>};</code></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ls"><img src="../Images/e49d46fa156be5e9581000ba8a9e957b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eRpBtlqZQ-rp0R6ckkvnEg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">越过代码，然后单击“部署”</figcaption></figure><p id="1bac" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这个阶段，我们有一个 lambda 函数准备接收来自 SQS 队列的消息并记录它们。可以在 Cloudwatch 中查看日志。下一步将是最重要的一步，我们将让 SQS 队列触发上面的 lambda 函数。</p><blockquote class="ky kz la"><p id="4bff" class="jk jl lb jm b jn jo jp jq jr js jt ju lc jw jx jy ld ka kb kc le ke kf kg kh ig bi translated"><strong class="jm io">步骤三:将 lambda 触发器添加到 SQS 队列中【重要提示】</strong></p></blockquote><ol class=""><li id="6d8e" class="lf lg in jm b jn jo jr js jv lh jz li kd lj kh lk ll lm ln bi translated">再次访问 SQS 控制台，单击之前创建的队列:</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lp"><img src="../Images/5a9160ac0978256ea29f979a2aaf6edd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O3Mhoo8cppPzqaKh8zy-Ng.png"/></div></div></figure><p id="11e3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">2.点击'<strong class="jm io"> Lambda 触发器</strong>，点击'<strong class="jm io">配置 Lambda 功能触发器</strong>按钮。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mb"><img src="../Images/6515ad2c23c70269a91353e4b69ad882.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jmwe_qDGd-TQQFWaGM7xrQ.png"/></div></div></figure><p id="b1b8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">3.在下拉列表中按名称搜索前面创建的 lambda 函数并选择它。点击'<strong class="jm io">保存</strong>按钮。这将成功地将 lambda 触发器添加到 SQS 队列中:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mc"><img src="../Images/c64ea9817b888f3b6af27e817c7dcdb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XOXTV_BiXgqit0D-b1Braw.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi md"><img src="../Images/408a59d9a0de37b215d5d549513b86d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QnTyjQ0OlRRInzzcyAFnVQ.png"/></div></div></figure><p id="5e8c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">4.现在，为了测试我们的设置，我们将向队列发送一条消息(如本文前面所示)。消息必须传递给 lambda 函数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi me"><img src="../Images/c7cf81d369f1a6a170465853b0c517b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*swgEMr9dZ05hsxWdp2l1YA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">向队列发送消息</figcaption></figure><p id="1a43" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">5.回到 lambda 控制台，点击'<strong class="jm io">监视器</strong>'选项卡。然后点击“<strong class="jm io">查看 CloudWatch 中的日志</strong>按钮。这将打开一个新标签页，并带您进入 CloudWatch。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mf"><img src="../Images/d89e48d9528fd8364ac7fc1f01d9a675.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gUilTHS0_9tiTOA05MScfA.png"/></div></div></figure><p id="4d8a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">6.在 CloudWatch 日志组页面中，您会发现一个日志流，记录了 lambda 函数的最新执行。点击查看日志:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lp"><img src="../Images/5501e86a73da5b645ca6a564f126c172.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G3kSwdZ35egiYaR8vNt-Rw.png"/></div></div></figure><p id="121d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">7.消息对象的日志在下面突出显示。展开它以查看整个对象。我们发送的消息将出现在消息对象的“正文”字段中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mg"><img src="../Images/4f5e739afcd94ae92b8901285f5a5a80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OIg3KODsDWvly60gCFs52A.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">展开这个</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mh"><img src="../Images/6289706f6d9d24b7ae3da7d79491e974.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f8BWkwnGGvlAubfyqF9NNA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">在消息对象的“正文”字段中发送的消息</figcaption></figure><p id="deba" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因此，在这个阶段，我们有一个功能设置，发送到 SQS 的消息被推送到 lambda 函数，该函数又将其记录到 CloudWatch。现在，对于拼图的最后一块，我们必须设置一个 DynamoDB 表，并编写一些代码将数据插入其中。</p><blockquote class="ky kz la"><p id="7cc8" class="jk jl lb jm b jn jo jp jq jr js jt ju lc jw jx jy ld ka kb kc le ke kf kg kh ig bi translated"><strong class="jm io">第四步:DynamoDB 设置和集成</strong></p></blockquote><ol class=""><li id="7368" class="lf lg in jm b jn jo jr js jv lh jz li kd lj kh lk ll lm ln bi translated">转到<a class="ae lo" href="https://console.aws.amazon.com/dynamodbv2/home" rel="noopener ugc nofollow" target="_blank"> DynamoDB 控制台</a>并点击“<strong class="jm io">创建表格</strong>”:</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lp"><img src="../Images/a087553b80427767c58b9db4ec477cfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gzMP0ncxpRmKUQJ2pRv7JQ.png"/></div></div></figure><p id="9134" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">2.如下所示，提供一个表名和一个分区键。保留其他默认设置。滚动到页面底部，点击'<strong class="jm io">创建表格</strong>'按钮:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lp"><img src="../Images/6faa9f4e0fc9c8b5141681ae5629cc3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m1TwLRkffcHwJ_ltVDoB2w.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">向下滚动到底部</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lp"><img src="../Images/5a616dabe5f3139189e335698ffc263e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IRxxcXfU456qC26XkfE6Yw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">点击创建表格按钮</figcaption></figure><p id="79ba" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">3.创建该表需要一些时间。同时，回到 Lambda 控制台。将以下代码粘贴到编辑器中，然后单击'<strong class="jm io"> Deploy </strong>'(就像我们之前做的一样) :</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="5669" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">上面的代码解析从 SQS 收到的消息，并将其写入我们创建的 dynamoDB 表。它还将一些额外的信息记录到 CloudWatch，以防成功和错误。提供注释是为了更好地理解。<em class="lb">注意，我们不需要在 lambda 环境中安装 aws-sdk 依赖项，因为它是默认提供的</em>。</p><blockquote class="ky kz la"><p id="7e70" class="jk jl lb jm b jn jo jp jq jr js jt ju lc jw jx jy ld ka kb kc le ke kf kg kh ig bi translated"><strong class="jm io">最终测试</strong></p></blockquote><p id="cdba" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">1.转到 SQS 控制台，发送以下消息:</p><p id="f684" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe lx ly lz ma b">{“user_id":"user_1","device":"iPhoneX","location":"Kolkata"}</code></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mk"><img src="../Images/bc60c3afe691c03b411b10a2f90ece9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Me9N3CQKsPYu2Ayy_3VjAg.png"/></div></div></figure><p id="1471" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">2.现在访问 dynamo DB 控制台，单击您之前创建的表:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ml"><img src="../Images/ea8fef895c56939cd409fafe0f766700.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qFCJa5-WUn4XAQJ5lZTgBA.png"/></div></div></figure><p id="e419" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">3.点击右边的‘E<strong class="jm io">xplore 表物品</strong>按钮:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mm"><img src="../Images/57c6ece560d2cb82f526d804c5238b0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4EW4Xo-C4rz9h3Ew8d7biQ.png"/></div></div></figure><p id="b805" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">4.…..瞧啊。您可以在表格中看到一个条目，其中存储了所需的数据:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mn"><img src="../Images/a1d5ed5306bd6ee44ede0d152854dcf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5GH8L8lcH1Aqmc_10QNxvg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">来自 SQS 的消息存储在 DynamoDB 中</figcaption></figure><p id="c1a5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们的演示到此结束。我们可以将更多的消息推入队列，并得到以下结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mo"><img src="../Images/19b3f10f6c96b630af49e0c5e26e8e76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B6BGiIsLrhccEwbCSw_AZg.png"/></div></div></figure><p id="2236" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">此外，您可以查看 Cloudwatch 日志，了解那里记录的信息:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mp"><img src="../Images/2e2ad15d9adbe224367284833e312d86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NV5AIThF0PYB3GFrfG6yQA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">为放入 SQS 的所有后续消息显示的日志</figcaption></figure><p id="d3fb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">感谢您通读。希望这对你有帮助😊</p></div></div>    
</body>
</html>