<html>
<head>
<title>Object-Oriented JavaScript — Maps, Sets, WeakSets, and WeakMaps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向对象的 JavaScript —地图、集合、WeakSets 和 WeakMaps</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/object-oriented-javascript-maps-sets-weaksets-and-weakmaps-744a588cab64?source=collection_archive---------7-----------------------#2020-11-14">https://blog.devgenius.io/object-oriented-javascript-maps-sets-weaksets-and-weakmaps-744a588cab64?source=collection_archive---------7-----------------------#2020-11-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/7e089f2ce301e1fedc3eb944b3e28deb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vJpsk6ayAVWLb8Y7"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">威廉·拜罗伊特在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="0a73" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">JavaScript 部分是面向对象的语言。</p><p id="7b04" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要学习 JavaScript，我们必须学习 JavaScript 的面向对象部分。</p><p id="6eb1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇文章中，我们将看看地图迭代、集合、弱集合和弱地图。</p><h1 id="2791" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">迭代地图</h1><p id="3651" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用<code class="fe me mf mg mh b">keys</code>方法迭代映射来迭代键。</p><p id="a882" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="437a" class="mq lc iq mh b gy mr ms l mt mu">const m = new Map([<br/>  ['one', 1],<br/>  ['two', 2],<br/>  ['three', 3],<br/>]);</span><span id="2201" class="mq lc iq mh b gy mv ms l mt mu">for (const k of m.keys()) {<br/>  console.log(k);<br/>}</span></pre><p id="daa7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们得到:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="e524" class="mq lc iq mh b gy mr ms l mt mu">one<br/>two<br/>three</span></pre><p id="bdac" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从控制台日志中。</p><p id="a87d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用<code class="fe me mf mg mh b">values</code>方法迭代这些值:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="8601" class="mq lc iq mh b gy mr ms l mt mu">for (const v of m.values()) {<br/>  console.log(v);<br/>}</span></pre><p id="eedf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们得到:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="9fcd" class="mq lc iq mh b gy mr ms l mt mu">1<br/>2<br/>3</span></pre><p id="b8e1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从控制台日志中。</p><p id="6b6b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用<code class="fe me mf mg mh b">entries</code>方法遍历条目:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="eda1" class="mq lc iq mh b gy mr ms l mt mu">for (const [k, v] of m.entries()) {<br/>  console.log(k, v);<br/>}</span></pre><p id="41b5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们得到:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="206f" class="mq lc iq mh b gy mr ms l mt mu">one 1<br/>two 2<br/>three 3</span></pre><p id="f486" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们重构了从<code class="fe me mf mg mh b">entries</code>方法返回的键和值。</p><h1 id="a59a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">将地图转换为数组</h1><p id="34ff" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用 spread 操作符将地图转换成数组。</p><p id="2a89" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="ffe5" class="mq lc iq mh b gy mr ms l mt mu">const m = new Map([<br/>  ['one', 1],<br/>  ['two', 2],<br/>  ['three', 3],<br/>]);</span><span id="4eca" class="mq lc iq mh b gy mv ms l mt mu">const keys = [...m.keys()]</span></pre><p id="5b1f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从地图中获取关键字并将其转换为数组。</p><p id="f0bf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们得到:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="9de1" class="mq lc iq mh b gy mr ms l mt mu">["one", "two", "three"]</span></pre><p id="d7cf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还可以扩展映射，将键值对扩展到键值对的嵌套数组中。</p><p id="c3e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以如果我们有:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="4abd" class="mq lc iq mh b gy mr ms l mt mu">const m = new Map([<br/>  ['one', 1],<br/>  ['two', 2],<br/>  ['three', 3],<br/>]);</span><span id="8803" class="mq lc iq mh b gy mv ms l mt mu">const arr = [...m]</span></pre><p id="0e18" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们得到:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="eb4f" class="mq lc iq mh b gy mr ms l mt mu">[<br/>  [<br/>    "one",<br/>    1<br/>  ],<br/>  [<br/>    "two",<br/>    2<br/>  ],<br/>  [<br/>    "three",<br/>    3<br/>  ]<br/>]</span></pre><p id="fafa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">作为<code class="fe me mf mg mh b">arr</code>的价值。</p><h1 id="0a35" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">一组</h1><p id="f74a" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">一个<code class="fe me mf mg mh b">Set</code>是不能有重复条目的值的集合。</p><p id="2bdf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="56f5" class="mq lc iq mh b gy mr ms l mt mu">const s = new Set();<br/>s.add('first');</span></pre><p id="ef2a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们创建一个带有条目的集合。</p><p id="c08f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">add</code>添加一个条目。</p><p id="82b1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">has</code>检查值是否存在。我们可以通过书写来使用它:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="835c" class="mq lc iq mh b gy mr ms l mt mu">s.has('first');</span></pre><p id="2376" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">delete</code>让我们删除一个值:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="7618" class="mq lc iq mh b gy mr ms l mt mu">s.delete('first');</span></pre><p id="5d76" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也可以创建一个数组，这样我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="a176" class="mq lc iq mh b gy mr ms l mt mu">const colors = new Set(['red', 'green', 'blue']);</span></pre><p id="08de" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">用字符串创建一个集合。</p><h1 id="9c9e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">WeakMap 和 WeakSet</h1><p id="5319" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated"><code class="fe me mf mg mh b">WeakMap</code>和<code class="fe me mf mg mh b">WeakSet</code>与<code class="fe me mf mg mh b">Map</code>和<code class="fe me mf mg mh b">Set</code>相似，但更受限制。</p><p id="a03b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">WeakMap</code> s 只有<code class="fe me mf mg mh b">has()</code>、<code class="fe me mf mg mh b">get()</code>、<code class="fe me mf mg mh b">set()</code>和<code class="fe me mf mg mh b">delete()</code>方法。</p><p id="3f3c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">WeakSet</code> s 只有<code class="fe me mf mg mh b">has()</code>、<code class="fe me mf mg mh b">add()</code>和<code class="fe me mf mg mh b">delete()</code>方法。</p><p id="0f40" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">WeakMap</code>的按键必须是对象。</p><p id="1235" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们只能用它的键访问一个<code class="fe me mf mg mh b">WeakMap</code>值。</p><p id="8be4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">WeakSet</code>的值必须是对象。</p><p id="23c2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们不能迭代一个<code class="fe me mf mg mh b">WeakMap</code>或者<code class="fe me mf mg mh b">WeakSet</code>。</p><p id="849a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们无法清除一个<code class="fe me mf mg mh b">WeakMap</code>或<code class="fe me mf mg mh b">WeakSet</code>。</p><p id="0316" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">WeakMap</code>当我们不想控制我们保存的对象的生命周期时，s 是有用的。</p><p id="484e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当密钥不再可用时，它将被自动垃圾收集。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/3bfd76751c3f9938d3537ee896cb7b43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Y-QB-5k7pWprIlWq"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae kc" href="https://unsplash.com/@kyllik?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">克里·基特斯</a>拍摄的照片</figcaption></figure><h1 id="92d2" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="c582" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">地图、集合、WeakMaps 和 WeakSets 是我们可以在应用程序中使用的有用数据结构。</p></div></div>    
</body>
</html>