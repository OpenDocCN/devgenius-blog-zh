<html>
<head>
<title>How to use vue-draggable.next with composition api</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何通过组合 api 使用 vue-draggable.next</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-use-vue-draggable-next-with-composition-api-2900024cb3b7?source=collection_archive---------3-----------------------#2022-12-04">https://blog.devgenius.io/how-to-use-vue-draggable-next-with-composition-api-2900024cb3b7?source=collection_archive---------3-----------------------#2022-12-04</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/10a02d03c611298b6b22cef4d30d161e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/0*usJrUP1XndX9IJgp.png"/></div></div></figure><p id="bbc0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">图片来自<a class="ae kt" href="https://www.npmjs.com/package/vue-draggable" rel="noopener ugc nofollow" target="_blank">https://www.npmjs.com/package/vue-draggable</a></p><h1 id="2cdc" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">目的</h1><p id="7474" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated">当我在一个当前项目中使用<a class="ae kt" href="http://vue-draggable.next" rel="noopener ugc nofollow" target="_blank"> vue-draggable.next </a>和组合 api 时，我被分配到这个库，我正在努力实现这个项目的要求。</p><p id="cabe" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我猜网上有使用这个库的有用资源和文章，但是没有很多具体的例子。所以，我将与你分享这些知识。</p><h1 id="175c" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">什么是<a class="ae kt" href="http://vue-draggable.next" rel="noopener ugc nofollow" target="_blank"> vue-draggable.next </a>？</h1><p id="bd16" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated">正如我已经提到的，这是一个实现拖放功能的库。从 vue3 开始，名称略有变化，新版本命名为. next。</p><p id="7ef9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这个库为什么有用？因为你可以实现拖放更少的代码，并用 props 添加一些特性(例如。何时开始拖放以及何时结束拖放)</p><p id="c43b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">下面是一个带有组合 api 脚本设置的示例。安装非常简单，只需用“npm i vuedraggable @ next”安装包，照常导入库即可。</p><p id="8e14" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在 vue3 中，您需要添加模板标签和#item={element}而不是 v-for，然后您可以访问这些元素，如{ {<a class="ae kt" href="http://element.name" rel="noopener ugc nofollow" target="_blank">element . name</a>} }</p><p id="f2c3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果将组属性添加到 draggable 标记，则可以创建多个区域并将元素转移到不同的区域。而且如果加上手柄道具，可以用一个元素作为手柄来拖动。</p><p id="aef1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">因为有非常有用的道具我不能展示，如果你感兴趣，请参考官方文件。</p><pre class="lx ly lz ma gt mb mc md bn me mf bi"><span id="9ef3" class="mg kv in mc b be mh mi l mj mk">&lt;script setup&gt;<br/>import { ref } from "vue";<br/>import draggable from "vuedraggable";<br/><br/>const data = ref([<br/>  {<br/>    id: 1,<br/>    content: "test1",<br/>  },<br/>  {<br/>    id: 2,<br/>    content: "test2",<br/>  },<br/>  {<br/>    id: 3,<br/>    content: "teat3",<br/>  },<br/>]);<br/>&lt;/script&gt;<br/><br/>&lt;template&gt;<br/>  &lt;div class="hello"&gt;<br/>    &lt;draggable v-model="data" item-key="id"&gt;<br/>      &lt;template #item="{ element }"&gt;<br/>        &lt;div class="drag-item"&gt;<br/>          {{ element.id }}<br/>        &lt;/div&gt;<br/>      &lt;/template&gt;<br/>    &lt;/draggable&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;<br/><br/>&lt;style scoped&gt;<br/>.drag-item {<br/>  background: blue;<br/>  margin: 10px 0;<br/>}<br/>&lt;/style&gt;</span></pre><p id="76b6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这是我的屏幕。您可以看到通过拖放改变了顺序</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/f99f6cedb45fd3507214c4e03eeb790d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*zKigGr4Hha9Eryhg.gif"/></div></figure><p id="ffa4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">以上是非常基本的用法，但如果你还有其他要求，我们该如何实现呢？</p><h1 id="08ec" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">需求 1:拖拽后保存订单。</h1><p id="1835" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated">这是最常见的要求之一，因为如果你想在你的应用程序中使用拖放功能，你需要保存这些订单。你基本上可以选择两个选项，保存在本地存储或你的后端。然而，你可能知道本地存储有时是危险的，因为黑客可以看到你的本地存储。所以最常见的方法是发送您的后端。所以，我就用这种方式来解释。</p><p id="70ee" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">解决方案很简单，所有我们需要实现的是“拖动元素后，保存新订单到您的后端”。如果给 draggable 加上@end 道具，就可以了。</p><p id="866f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">下面是一个示例代码。在真实的情况下，你需要创建你的后端，但我会告诉你只是一个前端部分。我想强调这种方式是一个例子，但我想基本思想是相同的，即使代码是不同的。</p><pre class="lx ly lz ma gt mb mc md bn me mf bi"><span id="9f30" class="mg kv in mc b be mh mi l mj mk">&lt;script setup&gt;<br/>import { ref } from "vue";<br/>import draggable from "vuedraggable";<br/><br/>const data = ref([<br/>  {<br/>    id: 1,<br/>    order: 1,<br/>    content: "test1",<br/>  },<br/>  {<br/>    id: 2,<br/>    order: 2,<br/>    content: "test2",<br/>  },<br/>  {<br/>    id: 3,<br/>    order: 3, <br/>    content: "teat3",<br/>  },<br/>]);<br/><br/>const onDragEnd = async () =&gt; {<br/>// THIS CODE IS JUST AN IDEA<br/> for (let i = 0; i &lt; data.length; i++) {<br/>    try {<br/>      const res = await axios.put("YOUR BACKEND PATH", {<br/>        id: data[i].id,<br/>      });<br/>      console.log(res.data);<br/>      return;<br/>    } catch (err) {<br/>      console.log(err);<br/>      return;<br/>    }<br/>  }<br/>};<br/><br/>&lt;/script&gt;<br/><br/>&lt;template&gt;<br/>  &lt;div class="hello"&gt;<br/>    &lt;draggable v-model="data" item-key="id" @end="onDragEnd"&gt;<br/>      &lt;template #item="{ element }"&gt;<br/>        &lt;div class="drag-item"&gt;<br/>          {{ element.id }}<br/>        &lt;/div&gt;<br/>      &lt;/template&gt;<br/>    &lt;/draggable&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;<br/><br/>&lt;style scoped&gt;<br/>.drag-item {<br/>  background: blue;<br/>  margin: 10px 0;<br/>}<br/></span></pre><h1 id="48d6" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">需求 2:用一些不可拖动的元素创建不同的可拖动区域。</h1><p id="f22b" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated">我被分配的一个项目的要求有点复杂，因为我需要创建一些可拖动和不可拖动的元素，如下所示。</p><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/c1f39a63863f555d6a8dde306f71e5e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*I3Nw7EfVuf8_pIQG.gif"/></div></figure><p id="e7f9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我的解决方法如下。这个解决方案并不难，但你需要有一些想法。</p><p id="a29b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">首先，你需要创建一个可拖动的元素作为数组中的一个对象，因为如果你想创建不同的区域，你需要创建你的每个元素作为数组。而且有必要为不可拖动内容创建不同的数组。</p><p id="dd11" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">其次，您需要添加“v-for”元素来创建多个可拖动区域。然后，您可以插入不可拖动的内容，以使用“v-for”元素的索引。</p><p id="826b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">第三，你需要创建一个可拖动的元素，不是“v-model ”,而是“:list ”,因为如果你使用 v-model，这个函数不起作用(如果你添加 v-model，你会得到这样一个错误。内部服务器错误:v-model 不能用于 v-for 或 v-slot 范围变量，因为它们不可写。).</p><pre class="lx ly lz ma gt mb mc md bn me mf bi"><span id="2c5d" class="mg kv in mc b be mh mi l mj mk">&lt;script setup&gt;<br/>import { ref } from "vue";<br/>import draggable from "vuedraggable";<br/><br/>const dataList = ref({<br/>  draggable: [<br/>    [<br/>      {<br/>        id: 1,<br/>        content: "draggableText1",<br/>      },<br/>    ],<br/>    [<br/>      {<br/>        id: 2,<br/>        content: "draggableText2",<br/>      },<br/>    ],<br/>    [<br/>      {<br/>        id: 3,<br/>        content: "draggableText3",<br/>      },<br/>    ],<br/>  ],<br/>  unDraggable: [<br/>    {<br/>      id: 1,<br/>      content: "unDraggableText1",<br/>    },<br/>    {<br/>      id: 2,<br/>      content: "unDraggableText2",<br/>    },<br/>    {<br/>      id: 3,<br/>      content: "unDraggableText3",<br/>    },<br/>  ],<br/>});<br/>&lt;/script&gt;<br/><br/>&lt;template&gt;<br/>  &lt;div v-for="(draggableData, index) in dataList.draggable" class="hello"&gt;<br/>    &lt;draggable :list="draggableData" group="test" :key="draggableData"&gt;<br/>      &lt;template #item="{ element }"&gt;<br/>        &lt;div class="drag-item"&gt;{{ element.id }}: {{ element.content }}&lt;/div&gt;<br/>      &lt;/template&gt;<br/>    &lt;/draggable&gt;<br/>    {{ dataList.unDraggable[index].content }}<br/>  &lt;/div&gt;<br/>&lt;/template&gt;<br/><br/>&lt;style scoped&gt;<br/>.drag-item {<br/>  background: paleturquoise;<br/>  margin: 10px 0;<br/>}<br/>&lt;/style&gt;<br/></span></pre><h1 id="e9e6" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">结论</h1><p id="40f0" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated"><a class="ae kt" href="http://Vue-draggable.next" rel="noopener ugc nofollow" target="_blank"> Vue-draggable.next </a>是一个有用的实现拖放功能的库，但是有时候你需要一些想法来实现你需要的东西。希望这篇文章对你有帮助。</p><h1 id="3625" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">参考</h1><p id="3705" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated">官方指南:【https://github.com/SortableJS/vue.draggable.next T2】</p><p id="c367" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">感谢您的阅读！！</p></div></div>    
</body>
</html>