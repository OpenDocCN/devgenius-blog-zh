<html>
<head>
<title>Anchor scrolling in Angular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">é”šæ»šåŠ¨è§’åº¦</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://blog.devgenius.io/anchor-scrolling-in-angular-47ed1f393c77?source=collection_archive---------2-----------------------#2022-11-22">https://blog.devgenius.io/anchor-scrolling-in-angular-47ed1f393c77?source=collection_archive---------2-----------------------#2022-11-22</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="02ce" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">ä¸ºä»€ä¹ˆå®ƒä¸èµ·ä½œç”¨ï¼Ÿ</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/785e4e133abea25d3e81bd7497dc797f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fKH1N77qdf3zZMJ5TnBsJg.png"/></div></div></figure><p id="46e3" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">å¦‚æœå½“ URL ä¸­åŒ…å«ä¸€ä¸ªç‰‡æ®µæ—¶ï¼Œæ‚¨æ›¾ç»é‡åˆ°è¿‡å°†æ­£æ–‡æ»šåŠ¨åˆ°æ­£ç¡®ä½ç½®çš„é—®é¢˜ï¼Œé‚£ä¹ˆè¯·ä¸è¦ç¦»å¼€ã€‚</p><h1 id="cf6a" class="lk ll in bd lm ln lo lp lq lr ls lt lu jt lv ju lw jw lx jx ly jz lz ka ma mb bi translated">æ°´ç–—ä¸­å¿ƒçš„ä¸»æ’­å¡å—’å£°ã€‚</h1><p id="18b2" class="pw-post-body-paragraph ko kp in kq b kr mc jo kt ku md jr kw kx me kz la lb mf ld le lf mg lh li lj ig bi translated">ç‰‡æ®µæ˜¯ URL çš„<code class="fe mh mi mj mk b">hash</code>å±æ€§ï¼Œé€šå¸¸æŒ‡å‘é¡µé¢ä¸Šçš„ä¸€ä¸ªé”šç‚¹ã€‚é”šç‚¹å‡»åœ¨ç½‘ç»œä¸Šå·¥ä½œéœ€è¦ä»¥ä¸‹åŸºæœ¬çŸ¥è¯†:</p><p id="edaa" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe mh mi mj mk b">&lt;a href="#anchor"&gt;Click me&lt;/a&gt;</code></p><p id="5a90" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">åœ¨å¦ä¸€ä¸ªåœ°æ–¹</p><p id="40f2" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe mh mi mj mk b">&lt;element id="anchor"&gt;&lt;/element&gt;</code></p><p id="7fe3" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">ä¸ºäº†åœ¨é¡µé¢åŠ è½½æ—¶å·¥ä½œï¼Œä¸éœ€è¦ä»»ä½•å…¶ä»–ä¸œè¥¿ã€‚åœ¨ Angular ä¸­ï¼Œå€¼å¾—ä¸€æçš„æ˜¯ï¼Œé“¾æ¥åº”è¯¥æ˜¯å…·æœ‰<code class="fe mh mi mj mk b">fragment</code>å±æ€§çš„è·¯ç”±å™¨é“¾æ¥ï¼Œå°±åƒè¿™æ ·:</p><p id="4d4a" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe mh mi mj mk b">&lt;a routerLink="." fragment="anchor"&gt;Click me&lt;/a&gt;</code></p><p id="8ee1" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">æ ¹æ®<a class="ae ml" href="https://angular.io/api/router/InMemoryScrollingOptions#anchorScrolling" rel="noopener ugc nofollow" target="_blank">è§’åº¦æ–‡æ¡£</a>ï¼Œæˆ‘ä»¬éœ€è¦å°†æ ¹è·¯ç”±å™¨çš„<code class="fe mh mi mj mk b">anchorScrolling</code>å±æ€§è®¾ç½®ä¸º<code class="fe mh mi mj mk b">enabled</code>æ¥è¿›è¡Œæ»šåŠ¨ã€‚ä½†è¿™å¹¶ä¸å‡†ç¡®ã€‚</p><p id="0d2a" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">é‚£ä¹ˆè¿™ä¸ªå±æ€§åˆ°åº•æ˜¯åšä»€ä¹ˆçš„å‘¢ï¼Ÿå½“ç”¨<code class="fe mh mi mj mk b">anchor</code>æ•æ‰åˆ°æ»šåŠ¨äº‹ä»¶æ—¶ï¼Œè°ƒç”¨<a class="ae ml" href="https://github.com/angular/angular/blob/b653ee340e3361b484837b028bdd7c4f91a46f85/packages/common/src/viewport_scroller.ts#L119" rel="noopener ugc nofollow" target="_blank">å‡½æ•°</a> <code class="fe mh mi mj mk b">scrollToAnchor</code>ã€‚è®©æˆ‘ä»¬æ·±å…¥ç ”ç©¶ä¸€ä¸‹è¿™ä¸ªå‡½æ•°ã€‚è¯¥å‡½æ•°è¿›è¡Œä¸€äº›æ£€æŸ¥ï¼Œæ‰¾åˆ°å…ƒç´ ï¼Œç„¶å<a class="ae ml" href="https://github.com/angular/angular/blob/b653ee340e3361b484837b028bdd7c4f91a46f85/packages/common/src/viewport_scroller.ts#L156" rel="noopener ugc nofollow" target="_blank">å¾—åˆ°åæ ‡</a>ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><blockquote class="mm mn mo"><p id="60a8" class="ko kp mp kq b kr ks jo kt ku kv jr kw mq ky kz la mr lc ld le ms lg lh li lj ig bi translated">çœ‹ï¼ŒMedium ç»ˆäºé‡‡ç”¨äº†ä»£ç ç€è‰²ï¼</p></blockquote><pre class="kd ke kf kg gt mt mk mu bn mv mw bi"><span id="4b10" class="mx ll in mk b be my mz l na nb">// Angular internal function common library<br/>scrollToElement(el) {<br/>  const rect = el.getBoundingClientRect();<br/>  const left = rect.left + this.window.pageXOffset;<br/>  const top = rect.top + this.window.pageYOffset;<br/>  const offset = this.offset();<br/>  this.window.scrollTo(left - offset[0], top - offset[1]);<br/>}</span></pre><p id="de66" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io">é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆâ€”â€”å³ä½¿å®ƒæ‰¾åˆ°äº†å…ƒç´ â€”â€”è¿”å›å€¼éƒ½æ˜¯é›¶å‘¢ï¼Ÿ</strong></p><p id="fc68" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">å¦‚æœå…ƒç´ åœ¨ä¸»ç»„ä»¶ä¹‹å¤–(å› æ­¤æ¯”ä»»ä½•å­ç»„ä»¶åŠ è½½å¾—éƒ½å¿«),å®ƒå¯èƒ½ä¼šè¢«æ‰¾åˆ°ï¼Œä½†æ˜¯å®ƒä¼šå‡ºç°åœ¨æœ€ä¸Šé¢ã€‚æ‰€ä»¥é›¶æ˜¯æ­£ç¡®çš„è¯»æ•°ã€‚ç„¶è€Œï¼Œå¦‚æœå®ƒåœ¨å­ç»„ä»¶ä¸­ï¼Œè¿”å›çš„æ»šåŠ¨å¯¹è±¡å¯èƒ½æ˜¯<code class="fe mh mi mj mk b">null</code>ï¼Œå¦‚æœå®ƒè¿˜æ²¡æœ‰è¢«åŠ è½½çš„è¯ã€‚</p><p id="831f" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">æˆ‘ä»¬å¿…é¡»ç­‰å¾…å®¢æˆ·ç«¯åŠ è½½ã€‚ä½†æ˜¯éœ€è¦å¤šä¹…å‘¢ï¼Ÿ</p><p id="5e28" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">è®©æˆ‘åˆ†äº«ä¸€ä¸‹<code class="fe mh mi mj mk b">RouterModule</code> <a class="ae ml" href="https://github.com/angular/angular/blob/main/packages/router/src/router_scroller.ts#L67" rel="noopener ugc nofollow" target="_blank">è§’åº¦ä»£ç </a>ä¸­çš„æ»šåŠ¨äº‹ä»¶â€œæ¶ˆè´¹è€…â€å‡½æ•°ï¼Œä»¥ä¾›å‚è€ƒï¼Œå› ä¸ºæˆ‘ä»¬å°†ä½¿ç”¨æˆ‘ä»¬è‡ªå·±çš„è®¢é˜…è€…è¦†ç›–å®ƒ:</p><pre class="kd ke kf kg gt mt mk mu bn mv mw bi"><span id="270d" class="mx ll in mk b be my mz l na nb">// Angular internal code in router module library<br/>private consumeScrollEvents() {<br/>  return this.router.events.subscribe(e =&gt; {<br/>    if (!(e instanceof Scroll)) return;<br/>    // a popstate event. The pop state event will always ignore anchor scrollin<br/>    if (e.position) {<br/>      if (this.options.scrollPositionRestoration === 'top') {<br/>        this.viewportScroller.scrollToPosition([0, 0]);<br/>      } else if (this.options.scrollPositionRestoration === 'enabled') {<br/>        this.viewportScroller.scrollToPosition(e.position);<br/>      }<br/>      // imperative navigation "forward"<br/>    } else {<br/>      if (e.anchor &amp;&amp; this.options.anchorScrolling === 'enabled') {<br/>      /*********** here is where things happen ************/<br/>        this.viewportScroller.scrollToAnchor(e.anchor);<br/>      } else if (this.options.scrollPositionRestoration !== 'disabled') {<br/>        this.viewportScroller.scrollToPosition([0, 0]);<br/>      }<br/>    }<br/>  });<br/>}</span></pre><h1 id="5b94" class="lk ll in bd lm ln lo lp lq lr ls lt lu jt lv ju lw jw lx jx ly jz lz ka ma mb bi translated">è®¡æ—¶å™¨</h1><p id="77b1" class="pw-post-body-paragraph ko kp in kq b kr mc jo kt ku md jr kw kx me kz la lb mf ld le lf mg lh li lj ig bi translated">è§£å†³è¿™ä¸ªé—®é¢˜çš„ç¬¬ä¸€ä¸ªä¹Ÿæ˜¯æœ€æ˜æ˜¾çš„æ–¹æ³•æ˜¯åœ¨æ»šåŠ¨åˆ°å…ƒç´ ä¹‹å‰ä½¿ç”¨ä¸€ä¸ª<code class="fe mh mi mj mk b">timeout</code>ã€‚å¦‚æœæˆ‘ä»¬åœ¨æ ¹è·¯ç”±æ¨¡å—ä¸­è®¾ç½®<code class="fe mh mi mj mk b">anchorScrolling</code>ä¸º<code class="fe mh mi mj mk b">enabled</code>ï¼Œé‚£ä¹ˆ<code class="fe mh mi mj mk b">Scroll</code>äº‹ä»¶ä¼šåœ¨<code class="fe mh mi mj mk b">NavigationEnd</code>ä¹‹åç«‹å³è§¦å‘ã€‚ç„¶è€Œï¼Œåœ¨<strong class="kq io">ç‰ˆæœ¬ 15 ä¸­ï¼Œ</strong>äº‹ä»¶è¢«è¶…æ—¶è§¦å‘(<a class="ae ml" href="https://github.com/angular/angular/commit/79e9e8ab779d230f6a1df25c4ccff94b13129305" rel="noopener ugc nofollow" target="_blank">è§å‘å¸ƒä¿®å¤</a>):</p><pre class="kd ke kf kg gt mt mk mu bn mv mw bi"><span id="9f3c" class="mx ll in mk b be my mz l na nb">// Angular internal code<br/>private scheduleScrollEvent(routerEvent: NavigationEnd, anchor: string|null): void {<br/>  this.zone.runOutsideAngular(() =&gt; {<br/>    setTimeout(() =&gt; {<br/>      this.zone.run(() =&gt; {<br/>        this.router.triggerEvent(new Scroll(<br/>            routerEvent, this.lastSource === 'popstate' ? this.store[this.restoredId] : null,<br/>            anchor));<br/>      });<br/>    }, 0);<br/>  });<br/>}</span></pre><p id="2b47" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io">ä½†æ˜¯äº‹æƒ…æ˜¯è¿™æ ·çš„</strong>ï¼Œå®šæ—¶å™¨å‡ ä¹ç«‹åˆ»è§¦å‘äº‹ä»¶(0 æ¯«ç§’)ã€‚è¿™ä»ç„¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œå› ä¸ºæœ‰æ—¶å†…å®¹åœ¨åŠ è½½ä¹‹å‰éœ€è¦ä¸€ç‚¹æ—¶é—´(æƒ³æƒ³ headless CSMï¼Œé¢„æ¸²æŸ“å¹¶ä¸èƒ½è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸º Angular åœ¨ JavaScript å‡†å¤‡å¥½çš„æ—¶å€™å°±å¼€å§‹äº†)ã€‚å› æ­¤ï¼Œè®©æˆ‘ä»¬ç¼–å†™è‡ªå·±çš„äº‹ä»¶è®¢é˜…è€…ï¼Œè‡³å°‘æœ‰ 1 ç§’é’Ÿçš„å»¶è¿Ÿã€‚</p><blockquote class="mm mn mo"><p id="8bb4" class="ko kp mp kq b kr ks jo kt ku kv jr kw mq ky kz la mr lc ld le ms lg lh li lj ig bi translated">æœ€ç»ˆä»£ç åœ¨<a class="ae ml" href="https://stackblitz.com/edit/angular-anchor-scrolling" rel="noopener ugc nofollow" target="_blank">å †æ ˆä¸Š</a></p></blockquote><p id="b759" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">åœ¨æˆ‘ä»¬çš„<strong class="kq io">æ ¹è·¯ç”±æ¨¡å—</strong>ä¸­ï¼Œæˆ‘ä»¬å°†è®¾ç½®ä¸€ä¸ªäº‹ä»¶ç›‘å¬å™¨ï¼Œè¶…æ—¶åè°ƒç”¨<code class="fe mh mi mj mk b">scrollToAnchor</code>å‡½æ•°ã€‚æˆ‘ä»¬è¿˜åº”è¯¥ç¦ç”¨ä»»ä½•<code class="fe mh mi mj mk b">anchorScrolling</code>,è¿™æ ·å®ƒå°±ä¸ä¼šè¿è¡Œå†…ç½®ä»£ç ã€‚</p><pre class="kd ke kf kg gt mt mk mu bn mv mw bi"><span id="9fc5" class="mx ll in mk b be my mz l na nb">// root routing module<br/>@NgModule({<br/>  imports: [<br/>    RouterModule.forRoot(routes, {<br/>      // you may still do this<br/>      scrollPositionRestoration: 'top',<br/>      // but don't do this, the default is disabled<br/>      // anchorScrolling: 'enabled'<br/>    })<br/>  ],<br/>  exports: [RouterModule]<br/>})<br/>export class AppRoutingModule {<br/>  constructor(<br/>    router: Router,<br/>    viewportScroller: ViewportScroller,<br/>  ) {<br/>    // listen to events<br/>    router.events.pipe(<br/>      // catch the Scroll event<br/>      filter(event =&gt; event instanceof Scroll)<br/>    ).subscribe({<br/>      next: (e: Scroll) =&gt; {<br/>         if (e.anchor) {<br/>           // timeout for 1 second before scrolling<br/>           // or timer(1000) RxJS<br/>           zone.runOutsideAngular(() =&gt; {<br/>             setTimeout(() =&gt; {<br/>               zone.run(() =&gt; {<br/>                 viewportScroller.scrollToAnchor(e.anchor);<br/>               });<br/>             }, 1000);<br/>           });<br/>         }<br/>      }<br/>    });<br/>  }<br/>}</span></pre><p id="b8e2" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">æˆ‘ä»¬å¯ä»¥ç”¨æœ‰æ£±è§’çš„ç”·äººç”¨çš„åŒºå¤–æ³•ï¼Œè®©è‡ªå·±çœ‹èµ·æ¥å¾ˆé…·ã€‚ğŸ˜</p><p id="50d5" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">æ‚¨å¯ä»¥å¾®è°ƒè®¡æ—¶å™¨ä»¥é€‚åˆæ‚¨çš„é¡¹ç›®ï¼Œå¹¶ä¸”è®°ä½æ‚¨éœ€è¦ä¸é¡µé¢åŠ è½½ä¿æŒè¶³å¤Ÿçš„è·ç¦»ï¼Œä½†è¦è¶³å¤Ÿå¿«ï¼Œä»¥å…æ··æ·†ç”¨æˆ·ã€‚</p><p id="68cd" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">è¿™å¹¶ä¸ç†æƒ³ã€‚æˆ‘ä»¬èƒ½åšå¾—æ›´å¥½å—ï¼Ÿ</p><h1 id="b9a8" class="lk ll in bd lm ln lo lp lq lr ls lt lu jt lv ju lw jw lx jx ly jz lz ka ma mb bi translated">æ»šåŠ¨ç‰¹å®šäº‹ä»¶</h1><p id="1e7c" class="pw-post-body-paragraph ko kp in kq b kr mc jo kt ku md jr kw kx me kz la lb mf ld le lf mg lh li lj ig bi translated">å¦‚æœæˆ‘ä»¬éœ€è¦çš„åªæ˜¯ä¸€ä¸ªå¸¦æœ‰æ ‡é¢˜çš„ç®€å•é¡µé¢ï¼Œé‚£ä¹ˆç­‰å¾… 1 ç§’é’Ÿåº”è¯¥æ²¡é—®é¢˜ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªå¤æ‚çš„è®¾ç½®<strong class="kq io">æ— å¤´ CSM ä¸æˆ‘ä»¬æƒ³è¦é“¾æ¥çš„å‰¯æ ‡é¢˜</strong>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¸Œæœ›æœ‰ç‚¹åˆ›æ„ã€‚ä»¥ä¸‹æ˜¯æˆ‘çš„å»ºè®®:</p><p id="b5d3" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io">è§¦å‘æ»šåŠ¨äº‹ä»¶ï¼Œä¸å½±å“å†å²çŠ¶æ€</strong>ã€‚æˆ‘ä»ç„¶æƒ³ä½¿ç”¨ Angular åº“çš„å†…éƒ¨æœºåˆ¶ï¼Œæˆ‘ä¸å¸Œæœ›æ˜¾å¼åœ°è®¡ç®—ä½ç½®ï¼Œä¹Ÿä¸å¸Œæœ›åœ¨æ²¡æœ‰å¿…è¦æ—¶è¶…æ—¶ã€‚æœ‰ä¸¤ä¸ªåœ°æ–¹æˆ‘ä»¬å¯ä»¥è¿™æ ·åš:</p><ul class=""><li id="586a" class="nc nd in kq b kr ks ku kv kx ne lb nf lf ng lj nh ni nj nk bi translated">æ¯æ¬¡ HTTP è°ƒç”¨ç»“æŸå</li><li id="8cdb" class="nc nd in kq b kr nl ku nm kx nn lb no lf np lj nh ni nj nk bi translated">é€‰æ‹©æ€§åœ°åœ¨è¿”å›çš„ HTML ç»‘å®šå®Œæˆå</li></ul><p id="85a7" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">å› ä¸ºåªæœ‰é€šè¿‡è§¦å‘å¯¼èˆªäº‹ä»¶æ‰èƒ½è§¦å‘æ»šåŠ¨äº‹ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨<code class="fe mh mi mj mk b">navigate</code>æ–¹æ³•ã€‚</p><p id="9a75" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">è®©æˆ‘ä»¬å‡è®¾ä¸€ä¸ª HTTP è°ƒç”¨ï¼Œå®ƒåœ¨å‡ æ¯«ç§’å†…ç»“æŸ:</p><pre class="kd ke kf kg gt mt mk mu bn mv mw bi"><span id="078f" class="mx ll in mk b be my mz l na nb">// example call to an http function<br/>this.post$ = this.postService.GetPost('someparams').pipe(<br/>  // on finish, try to navigate<br/>  finalize(() =&gt; {<br/>    // router = Router<br/>    // url has the hash with it<br/>    // skipLocationChange so that it does not build up in history<br/>    // for this to work, the root router module needs to be set to<br/>    // onSameUrlNavigation: 'reload'<br/>    this.router.navigateByUrl(this.router.url, {skipLocationChange: true});<br/>  })<br/>);</span></pre><p id="f62e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">è¿™ä¹ŸåŠ ä¸Šäº†<code class="fe mh mi mj mk b">anchorScrolling</code>ä¸º<code class="fe mh mi mj mk b">enabled</code>ï¼Œ<code class="fe mh mi mj mk b">onSameUrlNavigation</code>ä¸º<code class="fe mh mi mj mk b">reload</code>ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥è€ƒè™‘å°†<code class="fe mh mi mj mk b">scrollOffset</code>è®¾ç½®ä¸ºè¿œç¦»è¾¹ç¼˜çš„å€¼ï¼Œæ¯”å¦‚<code class="fe mh mi mj mk b">200px</code>:</p><pre class="kd ke kf kg gt mt mk mu bn mv mw bi"><span id="2b4d" class="mx ll in mk b be my mz l na nb">// root routing module, for navigate solution to work<br/>RouterModule.forRoot(routes, {<br/>   onSameUrlNavigation: 'reload',<br/>   anchorScrolling: 'enabled',<br/>   scrollOffset: [0, 200],<br/>})</span></pre><p id="154b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªæœåŠ¡å’Œä¸€ä¸ª HTTP <strong class="kq io">æ‹¦æˆªå™¨</strong>ï¼Œè¿™å¯ä»¥è®¾è®¡å¾—æ›´å¥½ã€‚ä½†æ˜¯æˆ‘ä¸ä¼šç”¨æˆ‘çš„è®¾ç½®æ¥è¿·æƒ‘ä½ ï¼Œåªè¦è®°ä½ï¼Œåœ¨ä¸€ä¸ªå¥½çš„åº”ç”¨ç¨‹åºä¸­ï¼Œåœ¨å®Œæˆä¸€ä¸ª HTTP æ‹¦æˆªå™¨æ—¶ï¼Œé€šå¸¸ä¼šå‘ç”Ÿå¦ä¸€ä¸ªäº‹ä»¶:<strong class="kq io">éšè—é¡µé¢åŠ è½½å™¨</strong>ã€‚ä½ å¯èƒ½æƒ³æŠŠè¿™æ¡çº¿å’Œå®ƒæ”¾åœ¨ä¸€èµ·ã€‚</p><p id="aa25" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">åˆ«æ‹…å¿ƒï¼Œ<code class="fe mh mi mj mk b">navigatgeByUrl</code>ä¸é‡è£…ç»„ä»¶ï¼Œå…¶å®é‡è£…ç»„ä»¶æ˜¯ä¸€ä¸ªå‡ ä¹æ°¸è¿œä¸ä¼šå®ç°çš„æ¢¦æƒ³ã€‚</p><p id="a044" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">ä¸ºäº†æ‰¾å‡º URL æ˜¯å¦æœ‰ç‰‡æ®µï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code class="fe mh mi mj mk b">ActivatedRoute</code> snapshot å±æ€§:</p><p id="2f53" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe mh mi mj mk b">this.activatedRoute.snapshot.fragment</code></p><p id="e0e9" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">æˆ–è€…ç®€å•åœ°åœ¨ä½ çš„<code class="fe mh mi mj mk b">router.url</code>ä¸­æ‰¾åˆ°<code class="fe mh mi mj mk b">#</code></p><p id="9b21" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe mh mi mj mk b">this.router.url.indexOf('#') &gt; -1</code></p><p id="7f40" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">æ‰€ä»¥æˆ‘ä»¬éœ€è¦è®¾è®¡çš„å‡ æ¡åŸºæœ¬çº¿æ˜¯:</p><pre class="kd ke kf kg gt mt mk mu bn mv mw bi"><span id="78dc" class="mx ll in mk b be my mz l na nb">// we need to run this after the event we think creates and populates our HTML<br/>if (this.router.url.indexOf('#') &gt; -1) {<br/> this.router.navigateByUrl(this.router.url, {skipLocationChange: true});<br/>}</span></pre><p id="d92c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">å°±æˆ‘ä¸ªäººè€Œè¨€ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯æ— å¤´ CSMï¼Œåœ¨æˆ‘æ¸²æŸ“ HTML ä¹‹åï¼Œæˆ‘è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ¥å¤„ç†è¶…å‡ºåŸå§‹æ ¼å¼çš„ HTMLã€‚æˆ‘ç”¨åŒºå¤–è¶…æ—¶æ¥çœ‹èµ·æ¥å¾ˆé…·ã€‚ğŸ˜</p><p id="4e1b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">æ³¨æ„:å…³äº SSRï¼Œç”Ÿæˆçš„é”šè¢« SEO çˆ¬è™«æ£€æµ‹åˆ°å°±å¯ä»¥äº†ã€‚</p><p id="2270" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">è°¢è°¢ä½ å¯¹æˆ‘çš„å®¹å¿ã€‚ä½ æŠ“ä½é‚£åªç†Šäº†å—ï¼Ÿ</p><h1 id="4b24" class="lk ll in bd lm ln lo lp lq lr ls lt lu jt lv ju lw jw lx jx ly jz lz ka ma mb bi translated">èµ„æº</h1><ul class=""><li id="1246" class="nc nd in kq b kr mc ku md kx nq lb nr lf ns lj nh ni nj nk bi translated"><a class="ae ml" href="https://angular.io/api/router/InMemoryScrollingOptions#anchorScrolling" rel="noopener ugc nofollow" target="_blank">é”šç‚¹æ»šåŠ¨è§’åº¦æ–‡æ¡£</a></li><li id="c29a" class="nc nd in kq b kr nl ku nm kx nn lb no lf np lj nh ni nj nk bi translated"><a class="ae ml" href="https://github.com/angular/angular/blob/b653ee340e3361b484837b028bdd7c4f91a46f85/packages/common/src/viewport_scroller.ts#L119" rel="noopener ugc nofollow" target="_blank"> GitHub Angular æºä»£ç </a></li><li id="fb45" class="nc nd in kq b kr nl ku nm kx nn lb no lf np lj nh ni nj nk bi translated"><a class="ae ml" href="https://github.com/angular/angular/commit/79e9e8ab779d230f6a1df25c4ccff94b13129305" rel="noopener ugc nofollow" target="_blank">è§’åº¦ 15Â°é‡Šæ”¾å›ºå®š</a></li><li id="e339" class="nc nd in kq b kr nl ku nm kx nn lb no lf np lj nh ni nj nk bi translated"><a class="ae ml" href="https://stackblitz.com/edit/angular-anchor-scrolling" rel="noopener ugc nofollow" target="_blank">æ–¯å¡”å…‹å¸ƒé‡Œå…¹</a></li></ul></div></div>    
</body>
</html>