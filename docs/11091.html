<html>
<head>
<title>DevOps in Linux — Environment Variables</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Linux 中的 DevOps 环境变量</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/devops-in-linux-environment-variables-e1c38bda19fe?source=collection_archive---------1-----------------------#2022-12-18">https://blog.devgenius.io/devops-in-linux-environment-variables-e1c38bda19fe?source=collection_archive---------1-----------------------#2022-12-18</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="40a8" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">Linux 环境变量用法概述</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/d2f0efd8bd3cf996eca5871c0ce1525b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZtJ3JBa-E9BKsv2zkI6Yxg.png"/></div></div></figure><p id="c2dd" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">Linux 是一个多用户操作系统。多用户是指每个用户登录系统后都有自己专用的操作环境。而这个环境是由一组变量定义的，称为<strong class="ku is">环境变量</strong>。用户可以修改自己的环境变量来满足环境的要求。</p><h1 id="4251" class="lo lp ir bd lq lr ls lt lu lv lw lx ly jx lz jy ma ka mb kb mc kd md ke me mf bi translated">环境变量显示</h1><p id="b28f" class="pw-post-body-paragraph ks kt ir ku b kv mg js kx ky mh jv la lb mi ld le lf mj lh li lj mk ll lm ln ik bi translated">您可以使用命令<code class="fe ml mm mn mo b">env</code>或<code class="fe ml mm mn mo b">printenv</code>显示当前定义的环境变量，例如:</p><pre class="kh ki kj kk gu mp mo mq bn mr ms bi"><span id="e26a" class="mt lp ir mo b be mu mv l mw mx">$ env (or printenv)<br/>XDG_SESSION_ID=3092<br/>HOSTNAME=xxxx<br/>NVM_CD_FLAGS=<br/>TERM=xterm-256color<br/>SHELL=/bin/bash<br/>HISTSIZE=1000<br/>SSH_CLIENT=xxxx 49967 22<br/>SSH_TTY=/dev/pts/0<br/>NVM_DIR=/mnt/efs/data/home/txu/.nvm<br/>USER=txu<br/>MAIL=/var/spool/mail/txu<br/>...<br/>LC_CTYPE=en_US.UTF-8<br/>LESSOPEN=||/usr/bin/lesspipe.sh %s</span></pre><p id="397e" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">要显示一个特定的<code class="fe ml mm mn mo b">ENV</code>变量，可以使用<code class="fe ml mm mn mo b">echo</code>命令:</p><pre class="kh ki kj kk gu mp mo mq bn mr ms bi"><span id="de01" class="mt lp ir mo b be mu mv l mw mx">$ echo $HOME<br/>/mnt/data/home/txu</span></pre><h1 id="1bec" class="lo lp ir bd lq lr ls lt lu lv lw lx ly jx lz jy ma ka mb kb mc kd md ke me mf bi translated">设置/取消设置新的环境变量</h1><p id="e72d" class="pw-post-body-paragraph ks kt ir ku b kv mg js kx ky mh jv la lb mi ld le lf mj lh li lj mk ll lm ln ik bi translated">要设置一个新的环境变量，可以使用<code class="fe ml mm mn mo b">export</code>命令:</p><pre class="kh ki kj kk gu mp mo mq bn mr ms bi"><span id="b3de" class="mt lp ir mo b be mu mv l mw mx">$ echo $VERSION<br/><br/>$ export VERSION=1.0.0<br/>$ echo $VERSION<br/>1.0.0</span></pre><p id="a3a4" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">要删除/移除现有的环境变量，使用<code class="fe ml mm mn mo b">unset</code>命令</p><pre class="kh ki kj kk gu mp mo mq bn mr ms bi"><span id="6fe4" class="mt lp ir mo b be mu mv l mw mx">$ echo $VERSION<br/>1.0.0<br/>$ unset VERSION<br/>$ echo $VERSION</span></pre><p id="2fd2" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">您也可以设置/取消设置多个变量:</p><pre class="kh ki kj kk gu mp mo mq bn mr ms bi"><span id="459f" class="mt lp ir mo b be mu mv l mw mx">$ export VERSION=1.0.0 VERSION2=2.0.0<br/>$ unset VERSION VERSION2</span></pre><p id="58c7" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">您也可以设置“只读”变量:</p><pre class="kh ki kj kk gu mp mo mq bn mr ms bi"><span id="ed50" class="mt lp ir mo b be mu mv l mw mx">$ export VERSION=1.0.0<br/>$ echo $VERSION<br/>1.0.0<br/>$ export VERSION=2.0.0<br/>$ echo $VERSION<br/>2.0.0<br/>$ readonly VERSION<br/>$ export VERSION=3.0.0<br/>-bash: VERSION: readonly variable</span></pre><h1 id="ba59" class="lo lp ir bd lq lr ls lt lu lv lw lx ly jx lz jy ma ka mb kb mc kd md ke me mf bi translated">设置持久环境变量</h1><h2 id="c8e6" class="my lp ir bd lq mz na dn lu nb nc dp ly lb nd ne ma lf nf ng mc lj nh ni me nj bi translated">所有用户</h2><p id="6b83" class="pw-post-body-paragraph ks kt ir ku b kv mg js kx ky mh jv la lb mi ld le lf mj lh li lj mk ll lm ln ik bi translated">为了使 ENV 变量对所有用户都是持久的，您可以利用<code class="fe ml mm mn mo b">/etc/profile</code>文件。该文件用于在用户 shells 上设置系统范围的环境变量。变量有时与。bash_profile，但是这个文件用于为系统的所有 shell 用户设置初始路径或 PS1。例如:</p><pre class="kh ki kj kk gu mp mo mq bn mr ms bi"><span id="a9ea" class="mt lp ir mo b be mu mv l mw mx">export CLASSPATH=./JAVA_HOME/lib:$JAVA_HOME/jre/lib</span></pre><p id="7364" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">添加完成后，新的环境变量不会立即生效，需要运行 source /etc/profile 才能立即生效，否则只有下次以用户身份重新登录时才会生效。</p><p id="b9d5" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">注意，除非你知道你在做什么，否则改变这个文件不是一个好主意。最好在/etc/profile.d/中创建一个 custom.sh shell 脚本来对您的环境进行定制更改，因为这将避免在将来的更新中进行合并。</p><h2 id="957f" class="my lp ir bd lq mz na dn lu nb nc dp ly lb nd ne ma lf nf ng mc lj nh ni me nj bi translated">单一用户</h2><p id="450d" class="pw-post-body-paragraph ks kt ir ku b kv mg js kx ky mh jv la lb mi ld le lf mj lh li lj mk ll lm ln ik bi translated">为单个用户设置特定的 ENV 变量，可以修改用户主目录中的<code class="fe ml mm mn mo b">.bash_profile</code>文件，这是一个可以被<code class="fe ml mm mn mo b">ll -a</code>viwed 的隐藏文件:</p><pre class="kh ki kj kk gu mp mo mq bn mr ms bi"><span id="ca0a" class="mt lp ir mo b be mu mv l mw mx">$ cd ~<br/>$ ll -a .bash_profile<br/>-rw-r--r-- 1 tony tony 193 Sep 22  2021 .bash_profile</span></pre><h2 id="1535" class="my lp ir bd lq mz na dn lu nb nc dp ly lb nd ne ma lf nf ng mc lj nh ni me nj bi translated">bash_profile vs bashrc</h2><p id="2f86" class="pw-post-body-paragraph ks kt ir ku b kv mg js kx ky mh jv la lb mi ld le lf mj lh li lj mk ll lm ln ik bi translated">首先，我们来了解一下不同概要文件的调用顺序。当用户作为交互式登录 shell 登录时，Bash 会查找/etc/profile 文件，如果该文件存在，它会运行文件中列出的命令。然后 Bash 搜索~/。bash_profile，~/。bash_login 和~/。配置文件，并从找到的第一个可读文件开始执行命令。</p><p id="cb22" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">当 Bash 作为交互式非登录 shell 被调用时，它从~/中读取并执行命令。bashrc，如果该文件存在，并且是可读的。</p><p id="5e9a" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">因此，基于上述事实，当 Bash 作为交互式登录 shell 被调用时，<code class="fe ml mm mn mo b">.bash_profile</code>被读取并执行，而对于交互式非登录 shell，<code class="fe ml mm mn mo b">.bashrc</code>被执行:</p><ul class=""><li id="c424" class="nk nl ir ku b kv kw ky kz lb nm lf nn lj no ln np nq nr ns bi translated"><code class="fe ml mm mn mo b">.bash_profile</code>:用于只应运行一次的命令，如自定义 PATH 环境变量。</li><li id="9b28" class="nk nl ir ku b kv nt ky nu lb nv lf nw lj nx ln np nq nr ns bi translated"><code class="fe ml mm mn mo b">.bashrc</code>:对于每次新 shell 启动时应该运行的命令，这里是<code class="fe ml mm mn mo b">aliases</code>、<code class="fe ml mm mn mo b">functions</code>、<code class="fe ml mm mn mo b">custom prompts</code>和历史定制的地方。</li></ul><h1 id="d728" class="lo lp ir bd lq lr ls lt lu lv lw lx ly jx lz jy ma ka mb kb mc kd md ke me mf bi translated">常见环境变量</h1><h2 id="4abf" class="my lp ir bd lq mz na dn lu nb nc dp ly lb nd ne ma lf nf ng mc lj nh ni me nj bi translated">小路</h2><pre class="kh ki kj kk gu mp mo mq bn mr ms bi"><span id="7595" class="mt lp ir mo b be mu mv l mw mx">$ echo $PATH<br/>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin</span></pre><p id="a7eb" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">路径由冒号分隔，是可执行程序所在的目录列表。当你输入一个命令时，shell 会首先检查这个命令是否是系统内部的命令，如果不是，它会检查这个命令是否是一个应用程序，shell 会尝试从路径中找到这些应用程序。</p><p id="44c6" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">如果 shell 在这些路径目录中找不到可执行文件，就会报错；如果找到，系统将调用并执行该应用程序。通过设置路径，我们运行程序或命令更加方便。</p><p id="d16c" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">要将目录路径添加到 path，您可以编写:</p><pre class="kh ki kj kk gu mp mo mq bn mr ms bi"><span id="9ade" class="mt lp ir mo b be mu mv l mw mx">$ pwd<br/>/root/docker/httpd<br/>$ export PATH=$PATH:$PWD<br/>$ echo $PATH<br/>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin:/root/docker/httpd</span></pre><h2 id="c16a" class="my lp ir bd lq mz na dn lu nb nc dp ly lb nd ne ma lf nf ng mc lj nh ni me nj bi translated">家</h2><p id="6dc2" class="pw-post-body-paragraph ks kt ir ku b kv mg js kx ky mh jv la lb mi ld le lf mj lh li lj mk ll lm ln ik bi translated">当用户登录到 Linux 系统时，用户的主工作目录是默认目录。</p><pre class="kh ki kj kk gu mp mo mq bn mr ms bi"><span id="ce7a" class="mt lp ir mo b be mu mv l mw mx">$ whoami<br/>tony<br/>$ echo $HOME<br/>/home/tony</span></pre><h2 id="eae8" class="my lp ir bd lq mz na dn lu nb nc dp ly lb nd ne ma lf nf ng mc lj nh ni me nj bi translated">历史尺寸</h2><p id="343d" class="pw-post-body-paragraph ks kt ir ku b kv mg js kx ky mh jv la lb mi ld le lf mj lh li lj mk ll lm ln ik bi translated">保存历史命令的数量。我们输入的命令会被系统保存，这个环境变量记录了要保存的命令数量。一般 1000。</p><pre class="kh ki kj kk gu mp mo mq bn mr ms bi"><span id="b73c" class="mt lp ir mo b be mu mv l mw mx">$ echo $HISTSIZE<br/>1000<br/>$ HISTSIZE=1001<br/>$ echo $HISTSIZE<br/>1001</span></pre><p id="ca50" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">历史命令保存在内存中。当您退出或登录到 shell 时，它们将被自动保存或读取。我们可以通过历史命令查看它们。您可以使用符号<code class="fe ml mm mn mo b">!</code>来执行具有指定序列号的历史命令。例如，要执行 1nd history 命令，输入<code class="fe ml mm mn mo b">!1</code>。</p><pre class="kh ki kj kk gu mp mo mq bn mr ms bi"><span id="c48f" class="mt lp ir mo b be mu mv l mw mx">$ history<br/>...<br/> 1000  env | grep VERSION<br/> 1001  cd ~<br/> 1002  ll -a .bash_profile<br/> 1003  cat ~/.bash_profile<br/> 1004  history<br/> 1005  env<br/><br/>$ !1002<br/>ll -a .bash_profile<br/>-rw-r--r-- 1 tony tony 193 Sep 22  2021 .bash_profile</span></pre><h2 id="50a7" class="my lp ir bd lq mz na dn lu nb nc dp ly lb nd ne ma lf nf ng mc lj nh ni me nj bi translated">日志名</h2><p id="3442" class="pw-post-body-paragraph ks kt ir ku b kv mg js kx ky mh jv la lb mi ld le lf mj lh li lj mk ll lm ln ik bi translated">当前用户登录名。</p><pre class="kh ki kj kk gu mp mo mq bn mr ms bi"><span id="8def" class="mt lp ir mo b be mu mv l mw mx">$ echo $LOGNAME<br/>txu</span></pre><h2 id="3f78" class="my lp ir bd lq mz na dn lu nb nc dp ly lb nd ne ma lf nf ng mc lj nh ni me nj bi translated">主机名</h2><p id="6251" class="pw-post-body-paragraph ks kt ir ku b kv mg js kx ky mh jv la lb mi ld le lf mj lh li lj mk ll lm ln ik bi translated">主机名。</p><pre class="kh ki kj kk gu mp mo mq bn mr ms bi"><span id="90e1" class="mt lp ir mo b be mu mv l mw mx">$ echo $HOSTNAME<br/>cloud-dev.test.com</span></pre><h2 id="71af" class="my lp ir bd lq mz na dn lu nb nc dp ly lb nd ne ma lf nf ng mc lj nh ni me nj bi translated">壳</h2><p id="a45d" class="pw-post-body-paragraph ks kt ir ku b kv mg js kx ky mh jv la lb mi ld le lf mj lh li lj mk ll lm ln ik bi translated">当前用户使用的外壳类型。</p><pre class="kh ki kj kk gu mp mo mq bn mr ms bi"><span id="b115" class="mt lp ir mo b be mu mv l mw mx">$ echo $SHELL<br/>/bin/bash</span></pre></div></div>    
</body>
</html>