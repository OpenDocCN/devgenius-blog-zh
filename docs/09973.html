<html>
<head>
<title>Fun with Python GET requests, Medium stats, and the Oracle Autonomous Database</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python GET 请求、中等统计数据和 Oracle 自治数据库带来的乐趣</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/friday-fun-with-python-get-requests-and-the-oracle-autonomous-database-af3a6153369c?source=collection_archive---------13-----------------------#2022-09-26">https://blog.devgenius.io/friday-fun-with-python-get-requests-and-the-oracle-autonomous-database-af3a6153369c?source=collection_archive---------13-----------------------#2022-09-26</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="6ce5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我觉得发这个帖子很傻，因为你很快就会意识到，我现在不得不把事情做完<em class="ki"/>。但是我太兴奋了，我真的有东西要分享了！</p><p id="fa47" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你一直在关注，你知道你总能在我的博客上找到我。但我也尽力在其他渠道交叉发布:</p><ul class=""><li id="26af" class="kk kl in jm b jn jo jr js jv km jz kn kd ko kh kp kq kr ks bi translated"><a class="ae kj" href="https://www.linkedin.com/in/chrishoina/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a></li><li id="a6dc" class="kk kl in jm b jn kt jr ku jv kv jz kw kd kx kh kp kq kr ks bi translated">Tealfeed (目前来看，这种情况可能会有所改变)</li><li id="49bb" class="kk kl in jm b jn kt jr ku jv kv jz kw kd kx kh kp kq kr ks bi translated">中等(咄)</li></ul><p id="9869" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">但是考虑到我所做的一切都支持开发社区，受众统计对我来说总是至关重要的。因此，我会定期查看我在博客和其他网站上的统计数据，以了解最热门的话题。</p><p id="e965" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Python 继续做<strong class="jm io"> <em class="ki">巨大的</em> </strong>。任何与 Python 和 REST API 相关的东西。我的<a class="ae kj" href="https://followthecoffee.com/sort-oracle-json-python-or-queries/" rel="noopener ugc nofollow" target="_blank"> Python 和查询过滤</a>和<a class="ae kj" href="https://followthecoffee.com/python-post-requests-three-ways-with-oracle-rest-data-services-ords/" rel="noopener ugc nofollow" target="_blank"> Python 帖子请求</a>帖子似乎产生了很多兴趣。</p><p id="accd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">不久前，我甚至做了一个非常受欢迎的 RegEx 帖子。谢天谢地，<em class="ki">没有那么流行，因为通过正则表达式工作让我很痛苦。</em></p><p id="500c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我可以在我的博客上快速查看站点统计数据，但是其他地方，比如 Medium，就比较难破译了。当然，你可以下载你的观众统计数据，但遗憾的是你的故事统计数据不能下载😐。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi ky"><img src="../Images/7118d023243c1cdcdd5ec5aec31cb38c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*froUQBoO42h9OMlV.png"/></div></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk translated">观众统计下载，但没有故事统计下载。</figcaption></figure><p id="907a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我没有被吓倒，我想看看是否有可能获得我的<em class="ki">故事</em>统计数据。这是可能的，在某种程度上…</p><h1 id="3fd1" class="lo lp in bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">展示和讲解</h1><p id="d11d" class="pw-post-body-paragraph jk jl in jm b jn mm jp jq jr mn jt ju jv mo jx jy jz mp kb kc kd mq kf kg kh ig bi translated">如果在您登录到您的中型帐户后，导航到您的统计页面，在您的浏览器中打开开发者工具并导航到您的“控制台”从那里，重新加载页面，并简单地观察所有的流量。</p><figure class="kz la lb lc gt ld"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="897d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你会看到一堆请求:</p><ul class=""><li id="0739" class="kk kl in jm b jn jo jr js jv km jz kn kd ko kh kp kq kr ks bi translated"><code class="fe mt mu mv mw b">GET</code></li><li id="313c" class="kk kl in jm b jn kt jr ku jv kv jz kw kd kx kh kp kq kr ks bi translated"><code class="fe mt mu mv mw b">POST</code></li><li id="fa1e" class="kk kl in jm b jn kt jr ku jv kv jz kw kd kx kh kp kq kr ks bi translated"><code class="fe mt mu mv mw b">OPTION</code>(老实说，我不知道这是什么，但我也还没有研究过)</li></ul><p id="b73d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我认为统计数据内容是通过这些 API 请求之一产生的。所以是的，我(一次一个)展开了每个请求，并查看了每个请求的响应体。我一直这么做，直到找到有用的东西。几分钟后，它出现了:</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi ky"><img src="../Images/59a440953c1af902ff0cd5b1de28d4d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iDUYsfX9OkuTN096.png"/></div></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk translated">神奇的<code class="fe mt mu mv mw b">GET</code>请求。</figcaption></figure><p id="a199" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我确认我已经挖到了金子，把这个网址放入一个新的浏览器窗口，然后按下回车键。在选择“原始数据”后，我看到了这个:</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi ky"><img src="../Images/65493aa1318ba7ad52149c9191d12ccc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iejOoS5I36FWWDWm.png"/></div></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk translated">仔细检查原始 JSON。</figcaption></figure><p id="31fe" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">事实上，我们看到了我的故事统计。但是 URL 中的最后两个路径对我来说毫无意义。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi ky"><img src="../Images/f14754d5c8e02654501a27eaacbd9b39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JZUAw9_OXSBZjEx5.jpg"/></div></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk translated">图灵时间到了！</figcaption></figure><p id="6494" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">它们看起来如此相似…我别无选择，只能激活图灵模式。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/40dfe54fb83d6bee67b1dae84f050b4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/0*9AIV4kRx9rKRfsWl.png"/></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk translated">一样的前缀，有意思…</figcaption></figure><p id="ba1e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我可以看到这些数字是相似的，所以我在我的文本编辑器中排列它们，看到它们共享相同的<strong class="jm io"> 166 </strong>前缀。我不太了解机器可读的代码，但是由于我的屏幕上显示的是过去 30 天，我想这可能是<em class="ki">的某个日期</em>。但是我以前从未见过这样的事情，所以我不是 100%确定。</p><h1 id="b6c9" class="lo lp in bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">Unix 时间戳</h1><p id="22c4" class="pw-post-body-paragraph jk jl in jm b jn mm jp jq jr mn jt ju jv mo jx jy jz mp kb kc kd mq kf kg kh ig bi translated">在大约 20 分钟的搜索和几乎放弃之后，我在我们的 Oracle docs(一个 MySQL 参考指南)中找到了一些引用了 Unix 时间戳的东西。找到了。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi my"><img src="../Images/282f55133e1685e2acd6e4a0d9011cc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*H5Ac8zhMQGTU-0gY.png"/></div></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk translated">关于 Oracle MySQL 文档中的 Unix 时间戳。</figcaption></figure><p id="d7b4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">成功，我找到了。所以我搜索了一个“Unix 时间戳计算器”并输入数字。事实证明我的预感是正确的；这确实是过去的三十天！</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi mz"><img src="../Images/2ba012cf2370de5e32fc6170981b7a70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cLIm8yvv4_lM3KsU.png"/></div></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk translated">验证 Unix 时间戳。</figcaption></figure><p id="e4a9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">所以现在我想知道，如果我改变了<code class="fe mt mu mv mw b">GET</code>请求中的前导日期，是否允许我获取从 2022 年 1 月到现在的所有故事统计数据？哦，当然，会的！</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi ky"><img src="../Images/2b89828cf6d754367818fc9b48097f54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_m-4JAdQbKuAeeZf.png"/></div></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk translated">我所有的故事统计从 2022 年 1 月到现在。</figcaption></figure><h1 id="c1b3" class="lo lp in bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">线的尽头</h1><p id="3823" class="pw-post-body-paragraph jk jl in jm b jn mm jp jq jr mn jt ju jv mo jx jy jz mp kb kc kd mq kf kg kh ig bi translated">好的，所以这里我必须让它保持开放。我今天有有限的时间来做这件事，但我想做的是看看我是否可以使用基本身份验证来验证我的中型帐户。并且至少得到一个<a class="ae kj" href="https://docs.oracle.com/en/database/oracle/oracle-rest-data-services/22.2/orrst/Status-Codes.html" rel="noopener ugc nofollow" target="_blank"> 200 响应码</a>。哦，等等，我已经做过了！？</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi ky"><img src="../Images/110d9afd5c33b5f222ed5668f3f9af88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gaJuLzHT8QaVSBLj.png"/></div></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk translated">得到那个甜蜜的，甜蜜的 200 回应码。</figcaption></figure><p id="7a2f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在是 Python 代码！</p><pre class="kz la lb lc gt na mw nb nc aw nd bi"><span id="af38" class="ne lp in mw b gy nf ng l nh ni">import requests<br/>import json <br/>from requests.auth import HTTPBasicAuth</span><span id="56f2" class="ne lp in mw b gy nj ng l nh ni">url = "https://medium.com/m/signin"<br/># I found this to work even if I typically sign on through <br/># the Google Single-sign-on. I just used the same email/password <br/># I do when I login directly to google (Gmail). <br/>user = "[Your login/email]"<br/>password = "[Your password]"</span><span id="bfe1" class="ne lp in mw b gy nj ng l nh ni">r = requests.get(url, auth=HTTPBasicAuth(user, password))</span><span id="e749" class="ne lp in mw b gy nj ng l nh ni">print(r)<br/></span><span id="43cf" class="ne lp in mw b gy nj ng l nh ni"># I found this URL in the console but then removed everything after<br/># the query string (the "?"), and used that for the requests URL</span><span id="6cf7" class="ne lp in mw b gy nj ng l nh ni"># "/m/signin?operation=login&amp;amp;redirect=https%3A%2F%2Fmedium.com%2F&amp;amp;source=--------------------------lo_home_nav-----------"</span></pre><p id="7fc2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">您可能想知道我是如何找到中型登录页面的正确 URL 的。很简单，我在控制台上找到正确的网址。这个有点棘手，但是经过一些调整后，我让它工作了。我最初发现了这个:</p><pre class="kz la lb lc gt na mw nb nc aw nd bi"><span id="0d35" class="ne lp in mw b gy nf ng l nh ni">"/m/signin?operation=login&amp;amp;redirect=https%3A%2F%2Fmedium.com%2F&amp;amp;source=--------------------------lo_home_nav-----------"</span></pre><p id="d7ff" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因为我认为所有的事情都在 T1 之后是一个可选的<a class="ae kj" href="https://docs.oracle.com/en/database/oracle/oracle-rest-data-services/22.2/orddg/developing-REST-applications.html#GUID-4A7F4425-61DF-4290-AED0-05DC2EF77158" rel="noopener ugc nofollow" target="_blank">查询字符串</a>，我只是删除了它，并将相关部分添加到 Medium 的基本 URL 中，得到了这个:</p><pre class="kz la lb lc gt na mw nb nc aw nd bi"><span id="bc08" class="ne lp in mw b gy nf ng l nh ni"><a class="ae kj" href="https://medium.com/m/signin" rel="noopener">https://medium.com/m/signin</a></span></pre><h1 id="4c34" class="lo lp in bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">后续步骤</h1><p id="632d" class="pw-post-body-paragraph jk jl in jm b jn mm jp jq jr mn jt ju jv mo jx jy jz mp kb kc kd mq kf kg kh ig bi translated">从这里开始，我想使用 JSON 对象，或者:</p><ul class=""><li id="b9b5" class="kk kl in jm b jn jo jr js jv km jz kn kd ko kh kp kq kr ks bi translated">在通过 ORDS、<em class="ki">或</em>加载到我的自治数据库之前，使用 Python 熊猫库进行清理</li><li id="0210" class="kk kl in jm b jn kt jr ku jv kv jz kw kd kx kh kp kq kr ks bi translated">用 SQL 提取现有的 JSON (CLOB )(详见<a class="ae kj" href="https://community.oracle.com/tech/developers/discussion/4490358/extract-json-from-clob" rel="noopener ugc nofollow" target="_blank">这篇 Oracle 社区论坛文章</a>)</li></ul><p id="c84d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果我想保持原样，我知道我可以轻松地用 cURL 命令和 ORDS 批处理加载 API 加载 JSON。事实上，我把它放到了我的自治数据库(数据加载)中，只是为了看看它会是什么样子:</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi ky"><img src="../Images/d34512794bc9440f66c5d7737767b826.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qUCKCxxPm3Ed35SM.png"/></div></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk translated">我的 CLOB。</figcaption></figure><p id="4cf1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在我刚刚提到的 Oracle LiveLabs 研讨会<a class="ae kj" href="https://followthecoffee.com/oracle-rest-apis-a-livelabs-review/" rel="noopener ugc nofollow" target="_blank">中，我们做了一些非常类似的事情。此处</a>可进入<a class="ae kj" href="https://apexapps.oracle.com/pls/apex/f?p=133:180:17991266814702::::wid:815" rel="noopener ugc nofollow" target="_blank">车间！</a></p><p id="ebf3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这个我会有后续的。但是现在，这是我前进的方向。如果你正在读这篇文章，并且想看到更多这样的内容，请告诉我！留下评论转发之类的。我想知道，我不会无缘无故患上腕管综合症🤣。</p><h1 id="339b" class="lo lp in bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">别忘了跟着</h1><p id="a2cb" class="pw-post-body-paragraph jk jl in jm b jn mm jp jq jr mn jt ju jv mo jx jy jz mp kb kc kd mq kf kg kh ig bi translated">如果您还没有分享或关注，请务必分享或关注:</p><ul class=""><li id="2a1a" class="kk kl in jm b jn jo jr js jv km jz kn kd ko kh kp kq kr ks bi translated"><a class="ae kj" href="https://twitter.com/chrishoina" rel="noopener ugc nofollow" target="_blank">推特</a></li><li id="d213" class="kk kl in jm b jn kt jr ku jv kv jz kw kd kx kh kp kq kr ks bi translated"><a class="ae kj" href="https://followthecoffee.com" rel="noopener ugc nofollow" target="_blank">我的博客</a></li><li id="903c" class="kk kl in jm b jn kt jr ku jv kv jz kw kd kx kh kp kq kr ks bi translated"><a class="ae kj" href="https://www.youtube.com/user/chrishoina/" rel="noopener ugc nofollow" target="_blank"> YouTube </a></li><li id="1257" class="kk kl in jm b jn kt jr ku jv kv jz kw kd kx kh kp kq kr ks bi translated"><a class="ae kj" href="https://github.com/chrishoina" rel="noopener ugc nofollow" target="_blank"> GitHub </a></li><li id="151b" class="kk kl in jm b jn kt jr ku jv kv jz kw kd kx kh kp kq kr ks bi translated"><a class="ae kj" href="https://discord.gg/seYeAPgq9E" rel="noopener ugc nofollow" target="_blank">不和</a></li><li id="a6ce" class="kk kl in jm b jn kt jr ku jv kv jz kw kd kx kh kp kq kr ks bi translated"><a class="ae kj" href="https://www.linkedin.com/in/chrishoina/" rel="noopener ugc nofollow" target="_blank">领英</a></li><li id="d697" class="kk kl in jm b jn kt jr ku jv kv jz kw kd kx kh kp kq kr ks bi translated"><a class="ae kj" href="https://stackoverflow.com/users/9552864/chris-hoina" rel="noopener ugc nofollow" target="_blank">堆栈溢出</a></li></ul></div></div>    
</body>
</html>