<html>
<head>
<title>Building a data pipeline for cryptocurrency market insights</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä¸ºåŠ å¯†è´§å¸å¸‚åœºæ´å¯Ÿæ„å»ºæ•°æ®ç®¡é“</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://blog.devgenius.io/building-a-data-pipeline-for-cryptocurrency-market-insights-946f31ab511a?source=collection_archive---------9-----------------------#2022-11-27">https://blog.devgenius.io/building-a-data-pipeline-for-cryptocurrency-market-insights-946f31ab511a?source=collection_archive---------9-----------------------#2022-11-27</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/ab8a3c9dd82dc2e64ae279fb9e49d054.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DMNfCYAKZmlYBW1KFpFc-w.jpeg"/></div></div></figure><h2 id="7d96" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">ä»‹ç»</h2><p id="c579" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">åˆ©æ¶¦ï¼è¿™æ˜¯ä¸€ä¸ªéå¸¸æœ‰è¶£çš„è¯ï¼Œä½†å®ƒæ˜¯æ„æˆæˆ‘ä»¬ä¸–ç•Œå¸‚åœºç»æµçš„æœ¬è´¨ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå®ƒæ˜¯ä¸€ç§è®©ä½ æŠ•èµ„çš„èµ„é‡‘äº§ç”Ÿç›ˆä½™çš„èƒ½åŠ›ã€‚æ‰€ä»¥ï¼Œå‡è®¾ä½ æŠ•èµ„ 10 ç¾å…ƒï¼Œèµšäº† 15 ç¾å…ƒï¼Œé‚£ä¹ˆä½ å°±èµšäº† 5 ç¾å…ƒâ€”â€”å¾ˆç®€å•ï¼Œå¯¹å§ï¼Ÿ</p><p id="809a" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">ç°åœ¨â€¦ä½ ä¸€ç”Ÿä¸­é‡åˆ°çš„æ¯ä¸€é¡¹æœåŠ¡ã€æ¯ä¸€ä¸ªæœºæ„éƒ½æ˜¯åŸºäºè¿™ä¸ªåŸåˆ™ï¼Œä»å­¦æ ¡ã€äº¤é€šã€å¨±ä¹åˆ°åŸºæœ¬çš„ç”Ÿå­˜ï¼Œæ¯”å¦‚é£Ÿå“å·¥ä¸šã€‚å¦‚æœè¿™äº›è¡Œä¸šçš„æˆæœ¬é«˜äºå®ƒä»¬åº”è¯¥è·å¾—çš„åˆ©æ¶¦ï¼Œå®ƒä»¬å°±ä¼šå€’é—­ã€‚</p><p id="139b" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">è®©æˆ‘ä»¬è°ˆä¸€è°ˆäº¤æ˜“ï¼Œå› ä¸ºè¯¥è®¡åˆ’æ—¨åœ¨è§£å†³åŠ å¯†è´§å¸å¸‚åœºä¸­çš„ä¸€ä¸ªç‰¹å®šç”¨ä¾‹ã€‚</p><h2 id="18a4" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">é‚£ä¹ˆï¼Œä»€ä¹ˆæ˜¯äº¤æ˜“ï¼Ÿ</h2><p id="3457" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">å®ƒå»ºç«‹åœ¨ä»¥ç›ˆåˆ©ä¸ºç›®çš„çš„å¸‚åœºç»æµä½“åˆ¶çš„åŒæ ·åŸåˆ™åŸºç¡€ä¸Šã€‚ä½†æ˜¯å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„å‘¢ï¼Ÿ</p><p id="b6d5" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">ä½ ä»¥æŸä¸€ä»·æ ¼ä¹°å…¥ä¸€ç§è´§å¸ï¼Œå½“è¿™ç§è´§å¸å‡å€¼æ—¶ï¼Œä½ å°±è·åˆ©äº†ğŸ˜Šè¯¶å“ˆâ€¦ä½†æ˜¯å¦‚æœå½“ä½ çš„é’±åœ¨å¸‚åœºä¸Šæ—¶å®ƒä¸‹è·Œäº†ï¼Œä½ å°±äºäº†ã€‚å¦‚æœä½ çš„é’±ä¸åœ¨å¸‚åœºä¸Šï¼Œé‚£ä¹ˆè¿™æ˜¯ä¸€ä¸ªä½ä»·ä¹°å…¥çš„æœºä¼šï¼Œè¿™æ ·å½“ä»·æ ¼ä¸Šæ¶¨æ—¶ï¼Œä½ å°±è·åˆ©äº†ã€‚äº¤æ˜“çš„å­˜åœ¨æ˜¯å› ä¸ºä»·å€¼æ— æ—¶æ— åˆ»ä¸åœ¨æ³¢åŠ¨â€¦<strong class="kt io"/>ï¼å®ƒçš„æ³¢åŠ¨åŸºäºå¾ˆå¤šå› ç´ ï¼Œæ ¸å¿ƒæ˜¯å…³äºå¸‚åœºä¸Šèµ„äº§çš„ä¾›ç»™å’Œéœ€æ±‚ï¼Œæ›´å¤šçš„ä¾›ç»™å’Œæ›´å¼±çš„éœ€æ±‚æ¨åŠ¨ä»·æ ¼ä¸‹è·Œï¼Œç›¸åæ¨åŠ¨ä»·æ ¼ä¸Šæ¶¨ã€‚</p><p id="3c61" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">æ‰€ä»¥ï¼Œä½œä¸ºä¸€ä¸ªäº¤æ˜“è€…ï¼Œå°¤å…¶æ˜¯çŸ­çº¿äº¤æ˜“è€…ï¼Œä½ æƒ³è¦ä¸€ä¸ªæ³¢åŠ¨å¾ˆå¤§çš„è´§å¸ï¼Œå› ä¸ºä½ æƒ³åšå°½å¯èƒ½å¤šçš„ç›ˆåˆ©äº¤æ˜“ã€‚ä½ çŸ¥é“æ¯”ç‰¹å¸ä¸æ˜¯åŠ å¯†è´§å¸å¸‚åœºä¸­å”¯ä¸€çš„è´§å¸èµ„äº§å—ï¼ŸğŸ¤”æœ‰å¾ˆå¤šï¼Œä½ è¦åšçš„æ˜¯ç¡®å®šå“ªäº›éšç€æ—¶é—´çš„æ¨ç§»æ³¢åŠ¨æœ€å¤§ï¼Œä½ è¦æŠŠä½ çš„æŠ•èµ„åˆ†æ•£åˆ°ä½ å·²ç»ç¡®å®šçš„è‚¡ç¥¨ä¸Šã€‚ä¸ºæ­¤ï¼Œæ‚¨éœ€è¦å¯¹å¸‚åœºè¿›è¡Œåˆ†æï¼Œä»¥äº†è§£<strong class="kt io"> <em class="lr">è¶‹åŠ¿</em> </strong>å’Œ<strong class="kt io"> <em class="lr">æ¨¡å¼</em> </strong>ï¼Œè¿™å°±æ˜¯ä¸‹é¢çš„<strong class="kt io">æ•°æ®è§£å†³æ–¹æ¡ˆå¹³å°</strong>å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚</p><p id="3687" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">åœ¨ä»»ä½•ç»™å®šçš„æ—¶é—´å›ç­”ä¸€äº›å…³é”®é—®é¢˜çš„èƒ½åŠ›åœ¨è¿™é‡Œæ˜¯è‡³å…³é‡è¦çš„ã€‚</p><ul class=""><li id="b3ee" class="ls lt in kt b ku lm ky ln ke lu ki lv km lw ll lx ly lz ma bi translated">éšç€æ—¶é—´çš„æ¨ç§»ï¼ŒåŠ å¯†è´§å¸çš„å¹³å‡ä»·æ ¼æ˜¯å¤šå°‘ï¼Ÿä¸€å¹´ã€ä¸¤å¹´ç­‰ã€‚ä½ æƒ³åœ¨è¿™é‡ŒæŠ“ä½<strong class="kt io"> <em class="lr">æ¨¡å¼</em></strong>â€¦â€¦<em class="lr">æˆ‘ä»¬å¾ˆå¯èƒ½ä¼šåšæˆ‘ä»¬åœ¨ä¸€æ®µæ—¶é—´å†…é€šå¸¸ä¼šåšçš„äº‹æƒ…ã€‚â€</em></li><li id="b4b4" class="ls lt in kt b ku mb ky mc ke md ki me km mf ll lx ly lz ma bi translated">ä»·æ ¼å¤šä¹…æ³¢åŠ¨ä¸€æ¬¡ï¼Œæ³¢åŠ¨å¹…åº¦æ˜¯å¤šå°‘ï¼Ÿåœ¨è¿‡å» x æ®µæ—¶é—´å†…(ä¸€å¹´ã€ä¸¤å¹´ç­‰)ï¼Œè¯¥å€¼ä¸Šå‡æˆ–ä¸‹é™ 1%ã€5%ã€10%ç­‰çš„é¢‘ç‡</li></ul><p id="42e1" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">ä½œä¸ºæŠ•èµ„è€…ï¼Œè¿™äº›é—®é¢˜çš„ç­”æ¡ˆä¼šè®©ä½ å¤„äºæ›´æœ‰åˆ©çš„ä½ç½®ã€‚</p><p id="49f5" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">å¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬å·²ç»è§£å†³äº†è¿™ä¸ªé—®é¢˜â€”â€”è®©æˆ‘ä»¬æ¥è°ˆè°ˆæŠ€æœ¯é—®é¢˜ğŸ˜‹</p><p id="6dc3" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">ç»¼åˆèµ·æ¥çš„è§£å†³æ–¹æ¡ˆæ˜¯ç”¨ Python ç¼–å†™çš„ï¼Œå®ƒå°†æ•°æ®å‘é€åˆ°ä¸€ä¸ªè¿‘ä¹å®æ—¶çš„æµåª’ä½“å¹³å°(<strong class="kt io"> <em class="lr">ã€å¡å¤«å¡ã€‘</em> </strong>)ï¼Œç„¶åè¯¥å¹³å°å°†æ•°æ®è½¬å‘åˆ°ä¸€ä¸ªåˆ†æå¹³å°(<strong class="kt io"> <em class="lr"> Elasticsearch </em> </strong>)ä»¥è·å¾—å¯æ“ä½œçš„è§è§£ã€‚</p><h2 id="a1f1" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">æ‘„å…¥ Python Kafka åˆ¶ä½œç¨‹åº</h2><pre class="mg mh mi mj gt mk ml mm bn mn mo bi"><span id="0839" class="mp jw in ml b be mq mr l ms mt"><br/>################################ Get ALL cryptocurrencies (array) #######################################<br/><br/>#==============================# Import required modules for this program #==============================<br/><br/>from confluent_kafka import Producer, KafkaError<br/>import json<br/>import os<br/>import requests<br/>from time import sleep<br/>from datetime import datetime<br/>from datetime import timezone<br/>from requests.exceptions import ConnectionError, ConnectTimeout<br/>import socket<br/>import boto3<br/>import json<br/>import requests<br/>import logging<br/><br/>#==============================# This section runs our python code as a TCP server #==============================<br/><br/># Create a socket<br/>sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br/><br/># Ensure that you can restart your server quickly when it terminates<br/>sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)<br/><br/># Set the client socket's TCP "well-known port" number<br/>well_known_port = int(os.environ['PYTHON_PRODUCER_SERVER_PORT'])<br/>sock.bind(('localhost', well_known_port))<br/><br/># Set the number of clients waiting for connection that can be queued<br/>sock.listen(5)<br/><br/>#==============================# This section sets up Kafka Consumer world #==============================<br/><br/>#Set your kafka topic you will publishing into<br/>topic = os.environ['KAFKA_TOPIC']<br/>#Set kafka Producer settings<br/>settings = {<br/>    'bootstrap.servers': os.environ['KAFKA_BROKERS_HOST_PORT'],<br/>    'client.id': os.environ['KAFKA_PRODUCER_CLIENT_ID']<br/>}<br/><br/>#Function to check connectivity to kafka cluster<br/>def isOpen(ip,port):<br/>   s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br/>   try:<br/>      s.connect((ip, int(port)))<br/>      s.settimeout(30)<br/>      print("Connection successfully established with kafka cluster. We may proceed")<br/>      return True<br/>   except:<br/>      return False<br/>   finally:<br/>        s.close()<br/><br/># Check connectivity to kafka cluster before proceding any further<br/>def check_kafka():<br/>    global check_port<br/>    check_port_wait = 30<br/>    while True:<br/>        check_port =  isOpen(os.environ['KAFKA_HOST'], int(os.environ['KAFKA_BROKERS_PORT']))<br/>        if check_port == False:<br/>            for x in range(check_port_wait):<br/>                print("Retrying connection to kafka cluster...in " + str(x) + " seconds", end="\r")<br/>                sleep(1)<br/>        else:<br/>            break<br/><br/># Execute function    <br/>check_kafka()<br/><br/># Here is our Producer variable <br/>if check_port == True:<br/>    p = Producer(settings)<br/><br/># API poll interval for the dataset we're streaming<br/># We got it at every 2 minutes - you can adjust to make as real-time as possible<br/>interval = int(os.environ['KAFKA_PRODUCER_BATCH_INTERVAL'])<br/><br/>#Wait interval to retry a connection<br/>waiting = int(os.environ['KAFKA_PRODUCER_RETRIES_INTERVAL'])<br/><br/>## Functions ## <br/>#Called once for each message produced to indicate delivery result.<br/>#Triggered by poll() or flush().<br/>def delivery_report(err, msg):<br/>    if err is not None:<br/>        print('Message delivery failed: {}'.format(err))<br/>    else:<br/>        print('1 Message delivered to {} [{}]'.format(msg.topic(), msg.partition()))<br/><br/>#==================================#            AWS S3 setup            #==================================<br/><br/>#Creating Session With Boto3.<br/>session = boto3.Session(<br/>aws_access_key_id= os.environ['AWS_S3_ACCESS_KEY'],<br/>aws_secret_access_key= os.environ['AWS_S3_SECRET_KEY'],<br/>region_name= os.environ['AWS_S3_REGION']<br/>)<br/><br/>#Function for AWS S3 connectivity <br/>def send_to_s3():<br/>    try:<br/>        s3 = session.resource('s3')<br/>        run = s3.meta.client.put_object(Body=x,Bucket=os.environ['AWS_S3_BUCKET'],Key=os.environ['AWS_S3_FILENAME_PREFIX'] + str(datetime.now().strftime("%Y-%m-%dT%H-%M-%S.json")))<br/>        res = run.get('ResponseMetadata')<br/><br/>        if res.get('HTTPStatusCode') == 200:<br/>            print('Data Uploaded Succesfully to the Lake AWS S3 at ' + str(datetime.now().strftime("%Y-%m-%dT%H:%M:%S")))<br/>        else:<br/>            print('Data Not Uploaded  to the Lake AWS S3 at ' + str(datetime.now().strftime("%Y-%m-%dT%H:%M:%S"))) <br/>            print("Exiting program until fixed")<br/>            exit()<br/>    except Exception as e:<br/>        print(e)<br/><br/>#==================================# This is the Main section which runs this program - Produce to kafka #==================================<br/><br/>#a countdown variable to keep track of the amount of batches processed<br/>track = 1<br/><br/>#a continous loop to keep polling API endpoint for datasets<br/>try:<br/>    while True:<br/>        count = 0<br/>        ola = requests.get(os.environ['CRYPTO_API_ENDPOINT']).json()<br/>        #We loop throught the array<br/>        for x in ola["result"]:<br/>            #The dataset does NOT have a timestamp associated with the event, we need to add one so we can do time series analytics  <br/>            x["timestamp"] = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%S.%f")<br/>            #Because our get call returns a type of dictionary(json), we need to convert it to a string as kafka only takes string, bytes NOT dict<br/>            x = json.dumps(x)<br/>            #Kafka producer keeps polling for new events<br/>            p.poll(0)<br/>            #Kafka producer now produces the events received to kafka topic and prints out and executes the report function<br/>            p.produce(topic,key="hello",value=x, callback=delivery_report)<br/>            #We increment our count variable to keep track of the amount of events processed<br/>            count += 1<br/>        #Then producer queue is flushed<br/>        p.flush()<br/>        #Once we run through the array, we print out message with total amount of events processed in a batch     <br/>        print("Batch number " + str(track) + " - " + str(count) + " Messages delivered to " + topic + " at " + str(datetime.now().strftime("%Y-%m-%dT%H:%M:%S")))<br/>        #Now, we're sending dataset to the lake (AWS S3)<br/>        #Creating S3 Resource From the Session.<br/>        print("Sending datasets to the Data lake AWS S3...")<br/>        send_to_s3()<br/>        #Here we pause for our next batch <br/>        for x in range(interval):<br/>            print("Pausing for next batch in ..." + str(interval) + "sec - " + str(x))<br/>            sleep(1)<br/>        #The batch count is incremented here<br/>        track += 1<br/>        #Ensure kafka is reachable <br/>        check_kafka()<br/>except ConnectionError:<br/>    while True:<br/>        print("Unable to establish connection to crypto API endpoint.Verify URL")<br/>        for x in range(waiting):<br/>            print("Retrying connection to crypto API in ... " + str(waiting) + " seconds ", str(x), end="\r")<br/>            sleep(1)<br/>except Exception as e:<br/>    print(e)<br/><br/></span></pre><p id="3e0a" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">æˆ‘å·²ç»å°½åŠ›åœ¨ä»£ç ä¸­åŒ…å«å°½å¯èƒ½å¤šçš„æ³¨é‡Šï¼Œè¿™æ ·ä½ å°±å¯ä»¥ç†è§£äº†ã€‚æˆ‘æƒ³åœ¨è¿™é‡Œæåˆ°çš„å‡ ä»¶äº‹æ˜¯â€¦å› ä¸ºä»£ç ä¾èµ–äºå…¶ä»–å±‚æ¥å®ç°ä¸€ä¸ªæœ‰æ•ˆä¸”å‡†ç¡®çš„è§£å†³æ–¹æ¡ˆï¼Œæˆ‘éœ€è¦è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œå¹¶åœ¨ä¾èµ–å±‚(<strong class="kt io"> kafka </strong>ã€<strong class="kt io"> aws s3 </strong>)ç”±äºæŸäº›åŸå› ä¸å¯ç”¨æ—¶åœæ­¢ä»£ç æ‰§è¡Œã€‚</p><h2 id="bf19" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">ETL å¤„ç†â€” Python Kafka æ¶ˆè´¹è€…</h2><pre class="mg mh mi mj gt mk ml mm bn mn mo bi"><span id="0ef4" class="mp jw in ml b be mq mr l ms mt">#Consume from kafka topic and send to ES<br/><br/>import requests<br/>import json<br/>from decimal import Decimal<br/>from confluent_kafka import Consumer, KafkaError<br/>import os<br/>import socket<br/>from time import sleep<br/><br/>from datetime import datetime<br/>from elasticsearch import Elasticsearch<br/><br/>#==============================# This section runs our python code as a TCP server #==============================<br/># Create a socket<br/>sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br/><br/># Ensure that you can restart your server quickly when it terminates<br/>sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)<br/><br/># Set the client socket's TCP "well-known port" number<br/>well_known_port = int(os.environ['PYTHON_CONSUMER_SERVER_PORT'])<br/>sock.bind(('localhost', well_known_port))<br/><br/># Set the number of clients waiting for connection that can be queued<br/>sock.listen(5)<br/><br/>#==============================# This section sets up Elasticsearch world #==============================<br/><br/>#Function to check connectivity to ES cluster<br/>def isOpenES(ip,port):<br/>   s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br/>   try:<br/>      print("Attempting connectio to ES cluster...")<br/>      s.settimeout(30)<br/>      s.connect((ip, int(port)))<br/>      print("Connection successfully established with ES cluster. We may proceed")<br/>      sleep(1)<br/>      return True<br/>   except:<br/>      return False<br/>   finally:<br/>        s.close()<br/><br/># Check connectivity to ES cluster before proceding any further<br/>def check_elastic():<br/>  global check_port_wait<br/>  check_port_wait = 30<br/>  while True:<br/>    global check_port<br/>    check_port =  isOpenES(os.environ['ES_HOST'], int(os.environ['ES_HOST_PORT']))<br/>    if check_port == False:<br/>        for x in range(check_port_wait):<br/>            print("Retrying connection to ES cluster...in " + str(x) + " seconds")<br/>            sleep(1)<br/>    else:<br/>      break<br/>    <br/># Execute elasticsearch connection check<br/>check_elastic()<br/><br/>#Only when successfull connection to ES cluster established then we can setup ES client <br/>if check_port == True:<br/>  es = Elasticsearch(<br/>      hosts= os.environ['ES_URL_ENDPOINT'],<br/>      basic_auth= (os.environ['ES_USER'], os.environ['ES_PASSWORD']),<br/>      request_timeout= 60<br/>      )<br/><br/># Set up index settings and fields mappings<br/>es_settings = {<br/>  "settings": {<br/>    "number_of_shards": 1,<br/>    "number_of_replicas": 0<br/>  },<br/>  "mappings": {<br/>    "properties": {<br/>      "next_funding_time": {<br/>        "type": "keyword"<br/>      },<br/>      "delivery_time": {<br/>        "type": "keyword"<br/>      },<br/>      "ask_price": {<br/>        "type": "float"<br/>      },<br/>      "bid_price": {<br/>        "type": "float"<br/>      },<br/>      "index_price": {<br/>        "type": "float"<br/>      },<br/>      "last_price": {<br/>        "type": "float"<br/>      },<br/>      "low_price_24h": {<br/>        "type": "float"<br/>      },<br/>      "last_price": {<br/>        "type": "float"<br/>      },<br/>      "mark_price": {<br/>        "type": "float"<br/>      },<br/>      "open_interest": {<br/>        "type": "float"<br/>      },<br/>      "prev_price_1h": {<br/>        "type": "float"<br/>      },<br/>      "prev_price_24h": {<br/>        "type": "float"<br/>      },<br/>      "price_1h_pcnt": {<br/>        "type": "float"<br/>      },<br/>      "price_24h_pcnt": {<br/>        "type": "float"<br/>      },<br/>      "total_volume": {<br/>        "type": "float"<br/>      },<br/>      "turnover_24h": {<br/>        "type": "float"<br/>      },<br/>      "volume_24h": {<br/>        "type": "float"<br/>      }<br/>    }<br/>  }<br/>}<br/><br/>#Check if if index exists before creating it:<br/>try:<br/>  check_indices = es.indices.exists(index=os.environ['ES_INDEX'])<br/>except:<br/>  while True:<br/>    if es.cluster.health()["status"] != ("green" or "yellow"):<br/>      for x in range(15):<br/>        print("ES cluster is not healthy yet, we retry in " + str(x) + " seconds")<br/>    else:<br/>      break<br/><br/><br/>#If index doesnt exist, create it<br/>if check_indices == False:<br/>  es.indices.create(index=os.environ['ES_INDEX'], body=es_settings)<br/><br/>#==============================# This section sets up Kafka Consumer world #==============================<br/><br/>#Kafka consumer settings<br/>settings = {<br/>    'bootstrap.servers': os.environ['KAFKA_BROKERS_HOST_PORT'],<br/>    'group.id': os.environ['KAFKA_CONSUMER_GROUP_ID'],<br/>    'default.topic.config': {'auto.offset.reset': os.environ['KAFKA_OFFSET_RESET']},<br/>    'auto.offset.reset': os.environ['KAFKA_OFFSET_RESET']<br/>}<br/><br/>#Function to check connectivity to Kafka cluster<br/>def isOpenKafka(ip,port):<br/>   s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br/>   try:<br/>      s.connect((ip, int(port)))<br/>      s.settimeout(30)<br/>      print("Connection successfully established with Kafka cluster. We may proceed, awaiting incoming events ...")<br/>      sleep(1)<br/>      return True<br/>   except:<br/>      return False<br/>   finally:<br/>        s.close()<br/><br/># Check connectivity to kafka cluster before proceding any further<br/>def check_kafka():<br/>  while True:<br/>    check_port =  isOpenKafka(os.environ['KAFKA_HOST'], int(os.environ['KAFKA_BROKERS_PORT']))<br/>    if check_port == False:<br/>        for x in range(check_port_wait):<br/>            print("Retrying connection to kafka cluster...in " + str(x) + " seconds")<br/>            sleep(1)<br/>    else:<br/>      break<br/><br/># Execute kafka check inception<br/>check_kafka()<br/><br/>#Only when successfull connection is established with kafka then we can setup Consumer <br/>if check_port == True:<br/>  c = Consumer(settings)<br/>  c.subscribe([os.environ['KAFKA_TOPIC']])<br/><br/>#==============================# This is the Main section which runs this program - Consume from kafka #==============================<br/><br/>#Set up the batch counter<br/>count = 0<br/><br/>#Kick off the consumer loop to continously consume as per poll interval.<br/>#We need to have it in a 'try' section so we can handle exceptions errors<br/>try:<br/>    while True:<br/>      #Initiates the consumer with a poll interval of milliseconds - price_nowtime poll<br/>      msg = c.poll(0.1)<br/>      #If there are no messages, continue waiting for incoming events<br/>      if msg is None:<br/>          continue<br/>      #If there are no msg.error then we've got messages and can print what we've received<br/>      elif not msg.error():<br/>          count += 1<br/>          print('Received message: {0}'.format(msg.value()))<br/>          #print('Received message: {}'.format(msg.value().decode('utf-8')))<br/>          data = msg.value().decode()<br/>          #If the message value is None, continue <br/>          if msg.value() is None:<br/>              continue<br/>          <br/>          # Handle UTF<br/>          try:<br/>              data = msg.value().decode()<br/>          except Exception:<br/>              data = msg.value()<br/>              print(data)<br/>          #At this point we have the messages so we can send them to ES cluster<br/>          try: <br/>            resp = es.index(index="elastic-index", id=datetime.now(), document=data)<br/>            print(resp['result'])<br/>          except:<br/>            check_elastic()<br/>      #Keeping track of the amount of message processed<br/>      print(str(count) + " messages received so far...at " + str(datetime.now().strftime("%Y-%m-%dT%H:%M:%S")))<br/><br/>      if msg.error():<br/>        print("Consumer error: {}".format(msg.error()))<br/>        continue<br/><br/>except Exception as e:<br/>  print(e)<br/><br/>finally:<br/>    c.close() </span></pre><p id="f1d1" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">å…³äºæ¶ˆè´¹è€…éœ€è¦è¡¥å……çš„æ˜¯ï¼Œè¿™ä¸ªç¨‹åºä½œä¸º TCP æœåŠ¡å™¨åœ¨æ‚¨é€‰æ‹©çš„ç‰¹å®š TCP ç«¯å£ä¸Šè¿è¡Œã€‚åŸå› æ˜¯æˆ‘ä»¬æƒ³é€šè¿‡å®ƒçš„ TCP ç«¯å£çŸ¥é“è¿™ä¸ªåº”ç”¨ç¨‹åºæ˜¯å¯åŠ¨è¿˜æ˜¯æ­»äº¡ã€‚æˆ‘ä»¬å°†ä½œä¸º docker å®¹å™¨è¿è¡Œï¼Œå¹¶é€šè¿‡ TCP ç«¯å£ç›‘æ§å…¶å¥åº·çŠ¶å†µã€‚é¡ºä¾¿è¯´ä¸€å¥ï¼ŒåŒæ ·çš„åŸåˆ™åº”è¯¥é€‚ç”¨äºç”Ÿäº§è€…ã€‚</p><p id="0e41" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹è¿™ä¸¤ä¸ªä»£ç è¿è¡Œåçš„æ ·å­ã€‚</p><h2 id="5dc5" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">Bootstrapping â€¦ä»£ç æ­£åœ¨è¿è¡Œï¼Œä½†ä¼šåœæ­¢è¿›ä¸€æ­¥æ‰§è¡Œï¼Œç›´åˆ°å…¶ä¾èµ–å±‚(<em class="mu"> Kafka </em>)å¯è®¿é—®</h2><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mv"><img src="../Images/6ab7a6b3e46e6550a3f1fd8ea93d16fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dB5GxOT9avDn3ULHYtzySw.png"/></div></div></figure><p id="7cba" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">ä¸€æ—¦ä¾èµ–æ˜¯å¯è¾¾çš„å’Œå¯æ“ä½œçš„ï¼Œå®ƒå°±å¯ä»¥äº§ç”Ÿå¡å¤«å¡ä¸»é¢˜</p><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mw"><img src="../Images/cee3173878aa479950282bd200d3cb97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K4zxi0VZohGnm94JGn5kEA.png"/></div></div></figure><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mx"><img src="../Images/91ad63e2e7973be1c1db399227e989ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2-eeXiQ5xv9FzTeF7GOoqA.png"/></div></div></figure><p id="93e2" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">æˆ‘ç¡®ä¿æˆ‘ä»¬å¾—åˆ°äº†äº‹ä»¶æµçš„å®æ—¶æŠ¥å‘Šï¼Œä»¥ä¾¿è·Ÿè¸ªåœ¨è¿™ä¸ªæµä¸­å‘ç”Ÿäº†ä»€ä¹ˆã€‚æˆ‘ä»¬æ­£åœ¨åˆ†æ‰¹æ‘„å–ï¼Œä½œä¸ºæ¯æ¬¡æ‘„å–çš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†æ•°æ®é›†å‘é€åˆ°æ•°æ®æ¹–(<strong class="kt io"> AWS S3 </strong>)è¿›è¡Œé•¿æœŸä¿å­˜ï¼Œå¹¶åœ¨éœ€è¦æ—¶ç”¨äºæ»¡è¶³ä»»ä½•å…¶ä»–æ¶ˆè´¹è€…çš„éœ€æ±‚ã€‚</p><h2 id="1abf" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">ä¸‹é¢æ˜¯åç»­æ‰¹å¤„ç†çš„æ ·å­:</h2><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi my"><img src="../Images/837a5f28bdec5ba45fb1d217343d3a02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wqUWv1rwYXo7RcZHI2R-kw.png"/></div></div></figure><h2 id="4671" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">æ˜¯æ—¶å€™å¯åŠ¨æˆ‘ä»¬çš„ Kafka æ¶ˆè´¹è€…äº†â€¦â€¦æ­£å¦‚æ‚¨åœ¨è¿™é‡Œæ³¨æ„åˆ°çš„ï¼Œæ¶ˆè´¹è€…çš„ä»£ç æ‰§è¡Œæš‚åœäº†ï¼Œå› ä¸ºä»–çš„ä¾èµ–å±‚(<strong class="ak"><em class="mu">elastic search</em></strong>)ä¸å¯è¾¾ã€‚è¿™å°†å¾ªç¯è¿›è¡Œï¼Œç›´åˆ°å¯ä»¥åˆ°è¾¾:</h2><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mz"><img src="../Images/87cdc8376542ab1436f138bcb96151c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p6UPP3dE5XHy5yw7BCZxvw.png"/></div></div></figure><p id="4c3f" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">è®©æˆ‘ä»¬å¯åŠ¨ elastic searchâ€¦â€¦ä¸€æ—¦å¯åŠ¨ï¼Œä»£ç å°†ç»§ç»­æ‰§è¡Œã€‚</p><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi na"><img src="../Images/3ca09093523e0f47dfc108c73654c023.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zRHhE9uJFJl_D42iTf7f5w.png"/></div></div></figure><p id="b86b" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">è§£å†³æ–¹æ¡ˆä¸­åŒ…å«çš„ä¸€ä¸ªé‡è¦æ³¨æ„äº‹é¡¹æ˜¯ï¼Œæˆ‘ä»¬<strong class="kt io">è·Ÿè¸ª</strong>å’Œ<strong class="kt io">æ—¶é—´æˆ³</strong>æ­¤å·¥ä½œæµæ¥æ”¶ã€å¤„ç†çš„æ¯æ¡è®°å½•:</p><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nb"><img src="../Images/310c9f5628ffd04e24f1f89872db427e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xUuJ8xVyUDUWgB3lJY6kCg.png"/></div></div></figure><p id="b0a3" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">å¾ˆå¥½ï¼Œç°åœ¨æˆ‘ä»¬æ­£åœ¨å¤„ç†äº‹ä»¶å¹¶å°†å®ƒä»¬å‘å¸ƒåˆ°æˆ‘ä»¬çš„åˆ†æå¹³å°(elasticsearch)ã€‚æˆ‘ä»¬å»çœ‹çœ‹å®ƒæ˜¯ä»€ä¹ˆæ ·å­ã€‚</p><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nc"><img src="../Images/820e67f0e392353d1f613bd46d4e420c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-rxR4ZnXsHLkKq4j4wd5NA.png"/></div></div></figure><p id="39d1" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">åœ¨æˆ‘ä»¬å¼€å§‹è¿›ä¸€æ­¥åˆ†æå®ƒä¹‹å‰ï¼Œå®ƒçœ‹èµ·æ¥å¹¶ä¸æ€ä¹ˆæ ·â€¦</p><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nd"><img src="../Images/29b9719350d7ee281650d17cedb1340d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ERVFaOhQcd5GwhktxgAa7A.png"/></div></div></figure><p id="a316" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">åœ¨è¿‡å»çš„ 7 å¤©é‡Œï¼Œæ¯ç§è´§å¸çš„ä»·æ ¼å’Œæ³¢åŠ¨ç™¾åˆ†æ¯”æ˜¯ä»€ä¹ˆæ ·çš„:</p><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ne"><img src="../Images/23a20ab4e933a0895f509e3ceb1ea9ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zu1cSno1ljUUlwRJr454NQ.png"/></div></div></figure><p id="cc0b" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">å“¼ğŸ¤”â€¦æˆ‘ä»¬å¼€å§‹äº†è§£è¿™ç§æƒ…å†µï¼Œä¸Šæ¶¨ 2.5%ååˆä¸‹è·Œçš„è´§å¸æ˜¯ä»€ä¹ˆï¼Ÿè°åœ¨è¿™é‡Œç»å¸¸å˜åŠ¨ï¼Ÿ</p><p id="b574" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">è®©æˆ‘ä»¬è·å¾— 10 ç§åŠ å¯†è´§å¸åœ¨åŒä¸€æ—¶æœŸ(7 å¤©)çš„ç™¾åˆ†æ¯”å˜åŒ–æƒé‡:</p><pre class="mg mh mi mj gt mk ml mm bn mn mo bi"><span id="6b66" class="mp jw in ml b be mq mr l ms mt">GET elastic-index/_search<br/>{<br/>  "size": 0,<br/>  "aggs": {<br/>    "MICKA": {<br/>      "terms": {<br/>        "field": "symbol.keyword"<br/>        , "size": 10<br/>      },<br/>      "aggs": {<br/>        "NAME": {<br/>          "percentiles": {<br/>            "field": "price_24h_pcnt",<br/>            "percents": [<br/>              25,<br/>              50,<br/>              75,<br/>              95,<br/>              99<br/>            ]<br/>          }<br/>        }<br/>      }<br/>    }<br/>  }<br/>}</span></pre><pre class="nf mk ml mm bn mn mo bi"><span id="1e24" class="mp jw in ml b be mq mr l ms mt">{<br/>  "took" : 59,<br/>  "timed_out" : false,<br/>  "_shards" : {<br/>    "total" : 1,<br/>    "successful" : 1,<br/>    "skipped" : 0,<br/>    "failed" : 0<br/>  },<br/>  "hits" : {<br/>    "total" : {<br/>      "value" : 10000,<br/>      "relation" : "gte"<br/>    },<br/>    "max_score" : null,<br/>    "hits" : [ ]<br/>  },<br/>  "aggregations" : {<br/>    "MICKA" : {<br/>      "doc_count_error_upper_bound" : 0,<br/>      "sum_other_doc_count" : 72986,<br/>      "buckets" : [<br/>        {<br/>          "key" : "SKLUSDT",<br/>          "doc_count" : 397,<br/>          "NAME" : {<br/>            "values" : {<br/>              "25.0" : -0.017249249387532473,<br/>              "50.0" : 0.013384000398218632,<br/>              "75.0" : 0.02213199995458126,<br/>              "95.0" : 0.0325398001819849,<br/>              "99.0" : 0.04053437914699315<br/>            }<br/>          }<br/>        },<br/>        {<br/>          "key" : "SLPUSDT",<br/>          "doc_count" : 397,<br/>          "NAME" : {<br/>            "values" : {<br/>              "25.0" : -0.01976200006902218,<br/>              "50.0" : 0.003984000068157911,<br/>              "75.0" : 0.0206344376783818,<br/>              "95.0" : 0.041492998600006104,<br/>              "99.0" : 0.04583299905061722<br/>            }<br/>          }<br/>        },<br/>        {<br/>          "key" : "SNXUSDT",<br/>          "doc_count" : 397,<br/>          "NAME" : {<br/>            "values" : {<br/>              "25.0" : -0.04339925153180957,<br/>              "50.0" : -0.002605666678088407,<br/>              "75.0" : 0.034786999225616455,<br/>              "95.0" : 0.05091765057295561,<br/>              "99.0" : 0.056417589783668516<br/>            }<br/>          }<br/>        },<br/>        {<br/>          "key" : "SOLUSDT",<br/>          "doc_count" : 397,<br/>          "NAME" : {<br/>            "values" : {<br/>              "25.0" : -0.018149999901652336,<br/>              "50.0" : 0.020818000038464863,<br/>              "75.0" : 0.08763474971055984,<br/>              "95.0" : 0.11487374790012836,<br/>              "99.0" : 0.12104500085115433<br/>            }<br/>          }<br/>        },<br/>        {<br/>          "key" : "STGUSDT",<br/>          "doc_count" : 397,<br/>          "NAME" : {<br/>            "values" : {<br/>              "25.0" : -0.024567687651142478,<br/>              "50.0" : -0.01639300025999546,<br/>              "75.0" : 0.00449066663471361,<br/>              "95.0" : 0.025875399820506545,<br/>              "99.0" : 0.06390500068664551<br/>            }<br/>          }<br/>        },<br/>        {<br/>          "key" : "STMXUSDT",<br/>          "doc_count" : 397,<br/>          "NAME" : {<br/>            "values" : {<br/>              "25.0" : -0.03550550062209368,<br/>              "50.0" : 9.619999909773469E-4,<br/>              "75.0" : 0.03224662481807172,<br/>              "95.0" : 0.05798500031232834,<br/>              "99.0" : 0.06297794189304108<br/>            }<br/>          }<br/>        },<br/>        {<br/>          "key" : "STORJUSDT",<br/>          "doc_count" : 397,<br/>          "NAME" : {<br/>            "values" : {<br/>              "25.0" : -0.03473616577684879,<br/>              "50.0" : -0.007122000213712454,<br/>              "75.0" : 0.014991999603807926,<br/>              "95.0" : 0.033587001264095306,<br/>              "99.0" : 0.03975500166416168<br/>            }<br/>          }<br/>        },<br/>        {<br/>          "key" : "STXUSDT",<br/>          "doc_count" : 397,<br/>          "NAME" : {<br/>            "values" : {<br/>              "25.0" : 0.004346999805420637,<br/>              "50.0" : 0.013100000098347664,<br/>              "75.0" : 0.025890000785390537,<br/>              "95.0" : 0.03912999853491783,<br/>              "99.0" : 0.07264900207519531<br/>            }<br/>          }<br/>        },<br/>        {<br/>          "key" : "SUNUSDT",<br/>          "doc_count" : 397,<br/>          "NAME" : {<br/>            "values" : {<br/>              "25.0" : 0.015608999878168106,<br/>              "50.0" : 0.028155000880360603,<br/>              "75.0" : 0.042449667739371456,<br/>              "95.0" : 0.06716989986598491,<br/>              "99.0" : 0.07128699868917465<br/>            }<br/>          }<br/>        },<br/>        {<br/>          "key" : "SUSHIUSDT",<br/>          "doc_count" : 397,<br/>          "NAME" : {<br/>            "values" : {<br/>              "25.0" : -0.049969250336289406,<br/>              "50.0" : -0.020973000675439835,<br/>              "75.0" : 0.010279750218614936,<br/>              "95.0" : 0.09280899912118912,<br/>              "99.0" : 0.10080005057156086<br/>            }<br/>          }<br/>        }<br/>      ]<br/>    }<br/>  }<br/>}</span></pre><p id="8827" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">ä½ æœ€å–œæ¬¢çš„åŠ å¯†è´§å¸ğŸ™‚</p><pre class="mg mh mi mj gt mk ml mm bn mn mo bi"><span id="108f" class="mp jw in ml b be mq mr l ms mt">GET elastic-index/_search<br/>{<br/>  "size": 0,<br/>  "query": {<br/>    "match": {<br/>      "symbol": "BTCUSD"<br/>    }<br/>  }, <br/>  "aggs": {<br/>    "MICKA": {<br/>      "terms": {<br/>        "field": "symbol.keyword"<br/>      },<br/>      "aggs": {<br/>        "NAME": {<br/>          "percentiles": {<br/>            "field": "price_24h_pcnt",<br/>            "percents": [<br/>              1,<br/>              5,<br/>              25,<br/>              50,<br/>              75,<br/>              95,<br/>              99<br/>            ]<br/>          }<br/>        }<br/>      }<br/>    }<br/>  }<br/>}</span></pre><pre class="nf mk ml mm bn mn mo bi"><span id="c5e2" class="mp jw in ml b be mq mr l ms mt">{<br/>  "took" : 740,<br/>  "timed_out" : false,<br/>  "_shards" : {<br/>    "total" : 1,<br/>    "successful" : 1,<br/>    "skipped" : 0,<br/>    "failed" : 0<br/>  },<br/>  "hits" : {<br/>    "total" : {<br/>      "value" : 398,<br/>      "relation" : "eq"<br/>    },<br/>    "max_score" : null,<br/>    "hits" : [ ]<br/>  },<br/>  "aggregations" : {<br/>    "MICKA" : {<br/>      "doc_count_error_upper_bound" : 0,<br/>      "sum_other_doc_count" : 0,<br/>      "buckets" : [<br/>        {<br/>          "key" : "BTCUSD",<br/>          "doc_count" : 398,<br/>          "NAME" : {<br/>            "values" : {<br/>              "1.0" : -0.018621680364012717,<br/>              "5.0" : -0.017968399822711947,<br/>              "25.0" : -0.013923999853432178,<br/>              "50.0" : 0.0018339999951422215,<br/>              "75.0" : 0.010238000191748142,<br/>              "95.0" : 0.022255999967455864,<br/>              "99.0" : 0.02323047965764999<br/>            }<br/>          }<br/>        }<br/>      ]<br/>    }<br/>  }<br/>}</span></pre><p id="1577" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">è¿™æ˜¯ä¸€ä¸ª<strong class="kt io"> 7 å¤©</strong>çš„æ•°æ®é›†åˆ†æï¼è¿‡å»ä¸€ä¸¤å¹´çš„å›¾åƒæ•°æ®é›†â€¦å¯èƒ½ä¼šè®©ä½ å¯¹å¸‚åœºæœ‰ä¸€ä¸ªæ›´å¥½çš„äº†è§£ï¼Œä¸æ˜¯å—ï¼Ÿ</p><p id="c880" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">é…·ï¼Œå°±æ˜¯è¿™æ ·ï¼Œä¼™è®¡ä»¬ï¼åœ¨æˆ‘çš„ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†åšä¸€äº›<strong class="kt io"> devops </strong>å¹¶å°†å…¶å­˜æ”¾åœ¨ docker å®¹å™¨ä¸­ï¼Œä»¥ä¾¿ä¸ ansible ä¸€èµ·éƒ¨ç½²åœ¨<a class="ae ng" href="https://aws.amazon.com/ec2/" rel="noopener ugc nofollow" target="_blank"> <strong class="kt io"> AWS EC2 </strong> </a>å·¥ä½œè´Ÿè½½ä¸Šâ€¦â€¦æ•¬è¯·å…³æ³¨ğŸ˜‰</p><h2 id="841a" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">å“¦ï¼ä»¥ä¸‹æ˜¯æˆ‘ä»¬çš„æ•°æ®æ¹– AWS S3 ä¸­çš„æ•°æ®é›†:</h2><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nh"><img src="../Images/b0d12ffa826b13bc71d6381e561d959e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kbQpj9K1QFIi9Ec9_drU0w.png"/></div></div></figure></div></div>    
</body>
</html>