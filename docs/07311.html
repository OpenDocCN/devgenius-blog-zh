<html>
<head>
<title>How to generate XML Sitemaps in Go</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在 Go 中生成 XML 站点地图</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-generate-xml-sitemaps-in-go-1d5a6249fc9d?source=collection_archive---------7-----------------------#2022-03-14">https://blog.devgenius.io/how-to-generate-xml-sitemaps-in-go-1d5a6249fc9d?source=collection_archive---------7-----------------------#2022-03-14</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/b075aa68fae9e1a9016fd540b5c31627.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VamrqX0eIU-EmrLlXz2r_w.jpeg"/></div></div></figure><p id="d15a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">每个网站必不可少的一部分是它的<strong class="jx io">站点地图</strong>，它看起来像一个简单的 XML 文件，可以使用简单的脚本来构建，虽然在 Wordpress 等内容管理系统中只需点击一下就很容易，但对于大型网站来说，这可能会变得很棘手，在这些网站中，您可能需要将几个站点地图文件合并到一个<strong class="jx io">站点地图索引</strong>文件中，以获得一个与<a class="ae kt" href="https://www.sitemaps.org/protocol.html" rel="noopener ugc nofollow" target="_blank">站点地图协议</a>兼容的有组织的输出，该协议定义了要应用的大型站点地图的一些规则。</p><p id="4221" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在这篇文章中，我将详细解释这些规则，以及它们的困难，此外还有使用强大的<strong class="jx io"> Golang 模块</strong>帮助你轻松生成网站的站点地图的指导。</p></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h2 id="7bc8" class="lb lc in bd ld le lf dn lg lh li dp lj kg lk ll lm kk ln lo lp ko lq lr ls lt bi translated">详细的站点地图模式协议限制</h2><p id="fef6" class="pw-post-body-paragraph jv jw in jx b jy lu ka kb kc lv ke kf kg lw ki kj kk lx km kn ko ly kq kr ks ig bi translated">与所有其他 SEO 技术一样，Sitemap 有一个在构建过程中必须考虑的合同协议，你可以在上面提到的网站上看到。本文的重点是大型网站的 sitemap 文件规则和限制，这些网站可能有数千个不同类型的链接。</p><p id="9c67" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">最重要的步骤是使用站点地图索引文件对多个站点地图文件进行分组，其中包括站点地图文件的 URL。主要的限制是每个文件中<em class="lz"> &lt; url &gt; </em>标签的数量，这对于小型博客/应用网站来说似乎很高，但是对于大型博客/应用网站来说，这是一个很小的数量，因为在大型博客/应用网站中可能有更多的标签。</p><p id="5f94" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">另一个限制是未压缩文件的大小必须不超过 50MB，这可能发生在长 URL 以及包含更多信息的带扩展名的网站地图<a class="ae kt" href="https://developers.google.com/search/docs/advanced/sitemaps/video-sitemaps" rel="noopener ugc nofollow" target="_blank">视频网站地图</a>。</p><p id="48ee" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">解决方案是将它们分成几个文件，在站点地图索引文件中引用，如下例所示，其中显示了一个列出两个站点地图的站点地图索引:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="3298" class="lb lc in mf b gy mj mk l ml mm">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><span id="e850" class="lb lc in mf b gy mn mk l ml mm">&lt;<a class="ae kt" href="https://www.sitemaps.org/protocol.html#sitemapIndex_sitemapindex" rel="noopener ugc nofollow" target="_blank">sitemapindex</a> &gt;</span><span id="f892" class="lb lc in mf b gy mn mk l ml mm">   &lt;<a class="ae kt" href="https://www.sitemaps.org/protocol.html#sitemapIndex_sitemap" rel="noopener ugc nofollow" target="_blank">sitemap</a>&gt;</span><span id="c0ef" class="lb lc in mf b gy mn mk l ml mm">      &lt;<a class="ae kt" href="https://www.sitemaps.org/protocol.html#sitemapIndex_loc" rel="noopener ugc nofollow" target="_blank">loc</a>&gt;http://www.example.com/sitemap1.xml.gz&lt;/loc&gt;</span><span id="cae2" class="lb lc in mf b gy mn mk l ml mm">      &lt;<a class="ae kt" href="https://www.sitemaps.org/protocol.html#sitemapIndex_lastmod" rel="noopener ugc nofollow" target="_blank">lastmod</a>&gt;2004-10-01T18:23:17+00:00&lt;/lastmod&gt;</span><span id="b5b9" class="lb lc in mf b gy mn mk l ml mm">   &lt;/sitemap&gt;</span><span id="88ac" class="lb lc in mf b gy mn mk l ml mm">   &lt;<a class="ae kt" href="https://www.sitemaps.org/protocol.html#sitemapIndex_sitemap" rel="noopener ugc nofollow" target="_blank">sitemap</a>&gt;</span><span id="3b15" class="lb lc in mf b gy mn mk l ml mm">      &lt;<a class="ae kt" href="https://www.sitemaps.org/protocol.html#sitemapIndex_loc" rel="noopener ugc nofollow" target="_blank">loc</a>&gt;http://www.example.com/sitemap2.xml.gz&lt;/loc&gt;</span><span id="df14" class="lb lc in mf b gy mn mk l ml mm">      &lt;<a class="ae kt" href="https://www.sitemaps.org/protocol.html#sitemapIndex_lastmod" rel="noopener ugc nofollow" target="_blank">lastmod</a>&gt;2005-01-01&lt;/lastmod&gt;</span><span id="f7d4" class="lb lc in mf b gy mn mk l ml mm">   &lt;/sitemap&gt;</span><span id="8233" class="lb lc in mf b gy mn mk l ml mm">&lt;/sitemapindex&gt;</span></pre></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h2 id="b117" class="lb lc in bd ld le lf dn lg lh li dp lj kg lk ll lm kk ln lo lp ko lq lr ls lt bi translated">Go 网站地图-生成器模块</h2><p id="dba9" class="pw-post-body-paragraph jv jw in jx b jy lu ka kb kc lv ke kf kg lw ki kj kk lx km kn ko ly kq kr ks ig bi translated">为了忘记所有关于站点地图限制的考虑，以及你需要在你的网站中为不同的内容类型有单独的文件的情况，我建议你使用这个<a class="ae kt" href="https://github.com/sabloger/sitemap-generator" rel="noopener ugc nofollow" target="_blank">高性能 Go 模块</a>，它透明地处理所有需要的规则。</p><div class="mo mp gp gr mq mr"><a href="https://github.com/sabloger/sitemap-generator" rel="noopener  ugc nofollow" target="_blank"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd io gy z fp mw fr fs mx fu fw im bi translated">GitHub-sabloger/Sitemap-generator:一个非常棒的 Go 网站地图生成器模块</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">一个高性能的站点地图生成器 Go 模块，它是一个创建和管理站点地图索引的综合工具</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">github.com</p></div></div><div class="na l"><div class="nb l nc nd ne na nf jt mr"/></div></div></a></div><p id="fe35" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这个库给了你一个简单而漂亮的 API 来使用一个强大的引擎完成你所需要的一切。它控制 URL 项目的数量以及最终的文件大小，并自动将它分成几个文件。</p><h2 id="40f3" class="lb lc in bd ld le lf dn lg lh li dp lj kg lk ll lm kk ln lo lp ko lq lr ls lt bi translated">如何使用网站地图生成器</h2><p id="8d65" class="pw-post-body-paragraph jv jw in jx b jy lu ka kb kc lv ke kf kg lw ki kj kk lx km kn ko ly kq kr ks ig bi translated">根据文档，您可以使用这一行<code class="fe ng nh ni mf b">go get</code>将它添加到您的 go mod 项目中:</p><p id="49a7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe ng nh ni mf b">go get github.com/sabloger/sitemap-generator</code></p><p id="7033" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">下面的示例代码是一个使用<code class="fe ng nh ni mf b">smg.NewSitemap()</code>将这个模块用于单个站点地图文件的例子:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="2fa8" class="lb lc in mf b gy mj mk l ml mm">package main<br/><br/>import (<br/>  "fmt"<br/>  "github.com/sabloger/sitemap-generator/smg"<br/>  "log"<br/>  "time"<br/>)<br/><br/>func main() {<br/>  now := time.Now().UTC()<br/><br/>  sm := smg.NewSitemap(true) // The argument is PrettyPrint which must be set on initializing<br/>  sm.SetName("single_sitemap") // Optional - sets the file name without extension<br/>  sm.SetHostname("https://www.example.com")<br/>  sm.SetOutputPath("./some/path")<br/>  sm.SetLastMod(&amp;now)<br/>  sm.SetCompress(false) // Default is true<br/><br/>  // Adding URL items<br/>  err := sm.Add(&amp;smg.SitemapLoc{<br/>    Loc:        "some/uri.html",<br/>    LastMod:    &amp;now,<br/>    ChangeFreq: smg.Always,<br/>    Priority:   0.4,<br/>  })<br/>  if err != nil {<br/>    log.Fatal("Unable to add SitemapLoc:", err)<br/>  }<br/><br/>  // Save func saves the xml file and returns more than one filename in case of split large files.<br/>  filenames, err := sm.Save()<br/>  if err != nil {<br/>    log.Fatal("Unable to Save Sitemap:", err)<br/>  }<br/>  for i, filename := range filenames {<br/>    fmt.Println("file no.", i+1, filename)<br/>  }<br/>}</span></pre><p id="b266" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">此外，您可以使用<code class="fe ng nh ni mf b">smg.NewSitemapIndex()</code>来构建一个站点地图索引实例:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="6fb9" class="lb lc in mf b gy mj mk l ml mm">package main<br/><br/>import (<br/>  "fmt"<br/>  "github.com/sabloger/sitemap-generator/smg"<br/>  "log"<br/>  "time"<br/>)<br/><br/>func main() {<br/>  now := time.Now().UTC()<br/><br/>  smi := smg.NewSitemapIndex(true)<br/>  smi.SetCompress(false)<br/>  smi.SetSitemapIndexName("an_optional_name_for_sitemap_index")<br/>  smi.SetHostname("https://www.example.com")<br/>  smi.SetOutputPath("./sitemap_index_example/")<br/>  smi.SetServerURI("/sitemaps/") // Optional<br/><br/>  smBlog := smi.NewSitemap()<br/>  smBlog.SetName("blog_sitemap")<br/>  smBlog.SetLastMod(&amp;now)<br/>  err := smBlog.Add(&amp;smg.SitemapLoc{<br/>    Loc:        "blog/post/1231",<br/>    LastMod:    &amp;now,<br/>    ChangeFreq: smg.Weekly,<br/>    Priority:   0.8,<br/>  })<br/>  if err != nil {<br/>    log.Fatal("Unable to add SitemapLoc:", err)<br/>  }<br/><br/>  smNews := smi.NewSitemap()<br/>  smNews.SetLastMod(&amp;now)<br/>  err = smNews.Add(&amp;smg.SitemapLoc{<br/>    Loc:        "news/2021-01-05/a-news-page",<br/>    LastMod:    &amp;now,<br/>    ChangeFreq: smg.Weekly,<br/>    Priority:   1,<br/>  })<br/>  if err != nil {<br/>    log.Fatal("Unable to add SitemapLoc:", err)<br/>  }<br/><br/>  filename, err := smi.Save()<br/>  if err != nil {<br/>    log.Fatal("Unable to Save Sitemap:", err)<br/>  }<br/><br/>  fmt.Println("sitemap_index file:", filename)<br/>}</span></pre><p id="44b2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">输出目录将如下所示:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="7593" class="lb lc in mf b gy mj mk l ml mm">sitemap_index_example<br/>├── an_optional_name_for_sitemap_index.xml<br/>├── blog_sitemap.xml<br/>└── sitemap2.xml</span></pre><p id="fcfa" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe ng nh ni mf b">an_optional_name_for_sitemap_index.xml</code>将模样:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="19e3" class="lb lc in mf b gy mj mk l ml mm">&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br/>&lt;sitemapindex &gt;<br/>  &lt;<a class="ae kt" href="https://www.sitemaps.org/protocol.html#sitemapIndex_sitemap" rel="noopener ugc nofollow" target="_blank">sitemap</a>&gt;<br/>    &lt;loc&gt;https:/www.example.com/sitemaps/blog_sitemap.xml&lt;/loc&gt;<br/>    &lt;lastmod&gt;2022-02-12T18:38:06.671183Z&lt;/lastmod&gt;<br/>  &lt;/<a class="ae kt" href="https://www.sitemaps.org/protocol.html#sitemapIndex_sitemap" rel="noopener ugc nofollow" target="_blank">sitemap</a>&gt;<br/>  &lt;<a class="ae kt" href="https://www.sitemaps.org/protocol.html#sitemapIndex_sitemap" rel="noopener ugc nofollow" target="_blank">sitemap</a>&gt;<br/>    &lt;loc&gt;https:/www.example.com/sitemaps/sitemap2.xml&lt;/loc&gt;<br/>    &lt;lastmod&gt;2022-02-12T18:38:06.671183Z&lt;/lastmod&gt;<br/>  &lt;/<a class="ae kt" href="https://www.sitemaps.org/protocol.html#sitemapIndex_sitemap" rel="noopener ugc nofollow" target="_blank">sitemap</a>&gt;<br/>&lt;/sitemapindex&gt;</span></pre></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h2 id="73c7" class="lb lc in bd ld le lf dn lg lh li dp lj kg lk ll lm kk ln lo lp ko lq lr ls lt bi translated">结论</h2><p id="8d66" class="pw-post-body-paragraph jv jw in jx b jy lu ka kb kc lv ke kf kg lw ki kj kk lx km kn ko ly kq kr ks ig bi translated">如今，拥有一个网站地图是必要的，但是当你不知道可用的工具时，这可能会很困难。我试图向您介绍一个有助于 Go 开发人员以高效的方式生成站点地图文件的软件包。与所有其他开源项目一样，这个库对贡献者开放，变得比现在有用得多。</p></div></div>    
</body>
</html>