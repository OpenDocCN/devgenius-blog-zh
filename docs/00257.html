<html>
<head>
<title>Cost Optimization on Azure App Service Plan</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Azure 应用服务计划的成本优化</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/cost-optimization-on-azure-app-service-plan-38fcd574522d?source=collection_archive---------1-----------------------#2020-05-28">https://blog.devgenius.io/cost-optimization-on-azure-app-service-plan-38fcd574522d?source=collection_archive---------1-----------------------#2020-05-28</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="6f16" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">继新冠肺炎·疫情之后，世界上大多数公司都在削减成本。因此，在这个时候，如果我们能够减少公司的 Azure 支出，这将是巨大的增值。我尝试了下面列出的方法，这些方法每月将我们的非生产环境 azure 成本降低 40%,而且影响最小。它不需要在管道中做任何改变，这些方法的实现会非常快。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e33fbef17705e3178954b741f7ea64bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GP4XeWxAHrwrCBhxgGDVTQ.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">优化 Azure 成本</figcaption></figure><blockquote class="ky kz la"><p id="c514" class="jk jl lb jm b jn jo jp jq jr js jt ju lc jw jx jy ld ka kb kc le ke kf kg kh ig bi translated"><strong class="jm io">处理影响 Azure 成本的未使用和不必要的资源。</strong></p></blockquote><p id="4ca2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">随着我们不断创建新的应用程序，我们的环境也在增长，我们确实用一个 azure 资源替换了另一个。我们通常不会删除旧的，因为我们可能需要恢复我们的更改。我们在订阅中确定了那些我们不确定其用途的资源。有些资源总是被使用，有时被使用，但从未被使用过。我们确定了那些可以删除而不会影响业务、开发和测试活动的内容。这包括删除跨环境不使用的<em class="lb"> Windows </em> <em class="lb">应用服务环境</em>、<em class="lb">应用服务计划、应用洞察、部署槽</em>。在删除之前，我们有团队成员的多次审查，以确保它不会导致任何问题。</p><blockquote class="ky kz la"><p id="aca3" class="jk jl lb jm b jn jo jp jq jr js jt ju lc jw jx jy ld ka kb kc le ke kf kg kh ig bi translated">2.<strong class="jm io">应用服务计划的垂直扩展。</strong></p></blockquote><p id="a9cc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">应用服务计划的垂直扩展是指需要手动执行的几个步骤，这些步骤需要扩展或缩减资源。在缩减过程中，所有资源都将其当前层和大小保存到 Azure 存储表中。这允许向上扩展脚本知道一旦执行后将资源设置回什么。此扩展操作仅在非生产环境的应用服务计划上实施。<em class="lb">不建议在生产环境中安装。</em>如果您的开发或 QA 环境类似于生产环境，那么您将为没有相同的 100%正常运行时间要求的环境支付额外费用。因此，您可以在下班时间缩小基本或共享计划中的应用，并在工作时间再次扩大。如果有任何正在进行的开发/测试活动，应用服务计划也可以作为例外添加。它也可以在 Azure automation account 中作为运行手册进行安排，这样它将每天运行两次。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lf"><img src="../Images/79c8f7c9ce0486480cf0976aeb63f28a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*SEqrXxtJgOuKR723mE6qmw.jpeg"/></div></figure><blockquote class="ky kz la"><p id="6917" class="jk jl lb jm b jn jo jp jq jr js jt ju lc jw jx jy ld ka kb kc le ke kf kg kh ig bi translated">3.<strong class="jm io">应用服务计划的横向扩展:</strong></p></blockquote><p id="595c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">根据应用程序类型，所有非生产应用程序服务计划都扩展到一个实例中。如果需要，可以轻松扩展到任意数量。在一天结束时运行的 PowerShell 作业，用于将计数更新为 1，即使在工作时间有任何部署也是如此。</p><blockquote class="ky kz la"><p id="b0de" class="jk jl lb jm b jn jo jp jq jr js jt ju lc jw jx jy ld ka kb kc le ke kf kg kh ig bi translated"><strong class="jm io"> 4。应用整合:</strong></p></blockquote><p id="91f5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果可能，多个应用服务将整合到一个应用服务计划中。在这种情况下，应用服务需要有多个实例或更高的 SKU。目前，我们使用 power shell 在不影响任何管道的情况下实现了这一点。</p><blockquote class="ky kz la"><p id="613f" class="jk jl lb jm b jn jo jp jq jr js jt ju lc jw jx jy ld ka kb kc le ke kf kg kh ig bi translated"><strong class="jm io"> 5。减少应用洞察中的数据摄取:</strong></p></blockquote><p id="92d0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">由于负载平衡器的监控，很少有 Azure 日志分析会接收大量数据。它包括异常日志记录、远程依赖性、消息日志记录、事件日志记录、请求日志记录和指标。</p><blockquote class="ky kz la"><p id="7e54" class="jk jl lb jm b jn jo jp jq jr js jt ju lc jw jx jy ld ka kb kc le ke kf kg kh ig bi translated"><strong class="jm io"> 6。减少应用洞察中的数据采样。</strong></p></blockquote><p id="ed08" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">默认摄取数据采样设置为保留收到的所有数据，但您可以随时更改数据采样。</p></div></div>    
</body>
</html>