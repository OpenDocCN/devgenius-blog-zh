<html>
<head>
<title>React Tips — Pass Props, Background Image, and Window Resize</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">反应提示—传递道具、背景图像和调整窗口大小</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/react-tips-pass-props-background-image-and-window-resize-36de8526786e?source=collection_archive---------8-----------------------#2020-07-24">https://blog.devgenius.io/react-tips-pass-props-background-image-and-window-resize-36de8526786e?source=collection_archive---------8-----------------------#2020-07-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/0737d905dd0bc0cdaeddcae297ee7c2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QR8hd3Nvpyg-Jsda"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@ttcollect?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Troy T </a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="67a8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">React 是一个用于创建 web 应用程序和移动应用程序的流行库。</p><p id="f2a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解一些编写更好的 React 应用程序的技巧。</p><h1 id="101e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用 React 路由器将属性传递给处理程序组件</h1><p id="0c2d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用渲染属性将属性传递给路由处理器组件。</p><p id="d39a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="c85e" class="mn lc iq mj b gy mo mp l mq mr">&lt;Route path="/greeting/:name" render={(props) =&gt; &lt;Greeting greeting="Hello, " {...props} /&gt;} /&gt;</span></pre><p id="90da" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们可以通过编写以下代码来定义我们的<code class="fe ms mt mu mj b">Greeting</code>组件:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="f80c" class="mn lc iq mj b gy mo mp l mq mr">class Greeting extends React.Component {<br/>  render() {<br/>    const { text, match: {params} } = this.props;<br/>    const { name } = params;</span><span id="be25" class="mn lc iq mj b gy mv mp l mq mr">    return (<br/>      &lt;&gt;<br/>        &lt;p&gt;<br/>          {text} {name}<br/>        &lt;/p&gt;<br/>      &lt;/&gt;<br/>    );<br/>  }<br/>}</span></pre><p id="33fd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将<code class="fe ms mt mu mj b">props</code>从参数传递给<code class="fe ms mt mu mj b">Greeting</code>组件。</p><p id="2f8b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们从<code class="fe ms mt mu mj b">Greetings</code>的<code class="fe ms mt mu mj b">this.props</code>物业拿道具。</p><p id="a958" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那我们就可以随心所欲了。</p><h1 id="409b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">调整浏览器大小时重新渲染视图</h1><p id="0935" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">如果我们使用函数组件，我们可以用钩子监视窗口的大小调整。</p><p id="5ddb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="be14" class="mn lc iq mj b gy mo mp l mq mr">import React, { useLayoutEffect, useState } from 'react';</span><span id="ff4d" class="mn lc iq mj b gy mv mp l mq mr">function useWindowSize() {<br/>  const [size, setSize] = useState([0, 0]);<br/>  useLayoutEffect(() =&gt; {<br/>    function updateSize() {<br/>      setSize([window.innerWidth, window.innerHeight]);<br/>    }<br/>    window.addEventListener('resize', updateSize);<br/>    updateSize();<br/>    return () =&gt; window.removeEventListener('resize', updateSize);<br/>  }, []);<br/>  return size;<br/>}</span><span id="02e2" class="mn lc iq mj b gy mv mp l mq mr">function App() {<br/>  const [width, height] = useWindowSize();<br/>  return &lt;span&gt;{width} x {height}&lt;/span&gt;;<br/>}</span></pre><p id="ee0f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们创建了一个<code class="fe ms mt mu mj b">useWindowSize</code>钩子，通过为<code class="fe ms mt mu mj b">resize</code>事件添加一个事件监听器来监视窗口大小的变化。</p><p id="2197" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后当我们返回函数来清理代码时，我们调用<code class="fe ms mt mu mj b">removeEventListener</code>来移除事件监听器。</p><p id="e884" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在事件处理程序中设置了<code class="fe ms mt mu mj b">size</code>状态。</p><p id="b123" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">window.innerWidth</code>表示窗口宽度，<code class="fe ms mt mu mj b">window.innerHeight</code>表示窗口高度。</p><p id="082a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们可以通过在组件中使用钩子来获取最新的值。</p><p id="7c96" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们创建自己的钩子来封装我们的逻辑，这样我们就不必在代码中散布它们。</p><p id="cfed" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以在任何地方重用它，这是另一个好处。</p><p id="bf04" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在类组件中，我们还可以观察<code class="fe ms mt mu mj b">resize</code>事件。</p><p id="b037" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="5f9f" class="mn lc iq mj b gy mo mp l mq mr">import React from 'react';</span><span id="19f8" class="mn lc iq mj b gy mv mp l mq mr">class App extends React.Component {<br/>  state = { width: 0, height: 0 };<br/>  render() {<br/>    return &lt;span&gt;{this.state.width} x {this.state.height}&lt;/span&gt;;<br/>  }</span><span id="a73f" class="mn lc iq mj b gy mv mp l mq mr">  updateDimensions = () =&gt; {<br/>    this.setState({ width: window.innerWidth, height: window.innerHeight });<br/>  };</span><span id="aed1" class="mn lc iq mj b gy mv mp l mq mr">  componentDidMount() {<br/>    window.addEventListener('resize', this.updateDimensions);<br/>  }</span><span id="3dbe" class="mn lc iq mj b gy mv mp l mq mr">  componentWillUnmount() {<br/>    window.removeEventListener('resize', this.updateDimensions);<br/>  }<br/>}</span></pre><p id="19f7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有<code class="fe ms mt mu mj b">updateDiemsions</code>的方法用<code class="fe ms mt mu mj b">setState</code>设置窗口的宽度和高度。</p><p id="add4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们调用<code class="fe ms mt mu mj b">componentDidMount</code>中的<code class="fe ms mt mu mj b">addEventListener</code>来监听窗口大小的变化。</p><p id="7219" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当组件卸载时，我们调用<code class="fe ms mt mu mj b">removeEventListener</code>来移除监听器。</p><p id="374a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe ms mt mu mj b">render</code>方法中，我们渲染窗口大小。</p><h1 id="f931" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">Fix“未捕获的类型错误:无法读取未定义错误的属性“setState”</h1><p id="a03e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过在类组件中调用的方法上调用<code class="fe ms mt mu mj b">bind</code>来修复<code class="fe ms mt mu mj b">setState</code>未定义的错误。</p><p id="3cd4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们写道:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="4dba" class="mn lc iq mj b gy mo mp l mq mr">constructor(props) {<br/>  super(props);<br/>  this.state = {<br/>    count: 1<br/>  };</span><span id="4913" class="mn lc iq mj b gy mv mp l mq mr">  this.setCount = this.setCount.bind(this);<br/>}</span></pre><p id="fced" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们调用<code class="fe ms mt mu mj b">this.setCount.bind(this)</code>来设置<code class="fe ms mt mu mj b">this.setCount</code>的<code class="fe ms mt mu mj b">this</code>的值给组件。</p><p id="99f4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在构造函数中调用它，这样我们就不必在其他地方多次调用<code class="fe ms mt mu mj b">bind</code>。</p><p id="f257" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以使用箭头函数来代替。</p><p id="d390" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="1bca" class="mn lc iq mj b gy mo mp l mq mr">setCount <!-- --> = () =&gt; {<br/>  this.setState({<br/>    count : this.state.count + 1<br/>  });<br/>}</span></pre><p id="0a5b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们的组件类中。</p><h1 id="f6c7" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">带有可选路径参数的反应路由器</h1><p id="435b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过向 path 参数添加一个问号来添加一个可选的 path 参数。</p><p id="714e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="d5ec" class="mn lc iq mj b gy mo mp l mq mr">&lt;Route path="/to/page/:pathParam?" component={Page} /&gt;</span></pre><p id="e71d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于一个可选参数。</p><p id="4820" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们想要更多，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="3458" class="mn lc iq mj b gy mo mp l mq mr">&lt;Route path="/to/page/:foo?/:bar?" component={Page} /&gt;</span></pre><p id="fd21" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这适用于版本 4 或更高版本。</p><h1 id="bc7c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用 React 内联样式设置背景图像</h1><p id="41d5" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用 React inline 样式设置背景图像，方法是:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="1cf9" class="mn lc iq mj b gy mo mp l mq mr">backgroundImage: `url(${Background})`</span></pre><p id="1908" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们传递给<code class="fe ms mt mu mj b">styles</code>道具的对象内部。</p><p id="ae4e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">Backgeround</code>是我们作为模块导入的图像。</p><p id="1a25" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">可以使用 Webpack 将图像作为模块导入。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/704b1f61e6f7be8b4d07bdf038cd4c9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bJPh2gIvPrqBIWgQ"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://unsplash.com/@wesleyphotography?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">韦斯利·廷吉</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="2157" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="99db" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过将图像作为一个模块导入并将其设置为背景图像的值来设置背景图像。</p><p id="ccc0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了得到窗口的大小，我们可以监听<code class="fe ms mt mu mj b">resize</code>事件。</p><p id="a25c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用 React Router 将 props 传递给路由处理组件。</p></div></div>    
</body>
</html>