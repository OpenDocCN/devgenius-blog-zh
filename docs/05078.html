<html>
<head>
<title>Deep Dive Into Structural Directives In Angular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深入探讨角度的结构指令</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/deep-dive-into-structural-directives-in-angular-8a5d0251fbb5?source=collection_archive---------1-----------------------#2021-06-12">https://blog.devgenius.io/deep-dive-into-structural-directives-in-angular-8a5d0251fbb5?source=collection_archive---------1-----------------------#2021-06-12</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/d79b4d5db83cc479d7580ce10239267b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VWYUHrATqLu8l-sR"/></div></div></figure><p id="3a6f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们从 Angular 中可用的指令类型开始讨论。Angular 中有两种类型的指令可用。</p><ol class=""><li id="a541" class="kt ku in jx b jy jz kc kd kg kv kk kw ko kx ks ky kz la lb bi translated"><strong class="jx io">结构指令</strong></li></ol><p id="6fb1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">结构指令是可以改变 DOM 结构和执行 DOM 操作的指令。</p><p id="4fec" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> 2。属性指令</strong></p><p id="a999" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">属性指令是可以改变 DOM 元素和角度组件的外观或行为的指令</p><p id="7bdf" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这篇文章是关于结构指令的。Angular 提供了一些内置的结构指令，比如 NgIf、NgFor 和 NgSwitch。让我们看看下面的 NgIf 示例</p><figure class="lc ld le lf gt jo"><div class="bz fp l di"><div class="lg lh l"/></div></figure><p id="e22a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">NgIf 是一个指令，仅当传递给它的条件为真时，才显示它所附加的元素。但是让我们仔细看看它的语法。在 Angular 中，这个指令只被命名为 ngIf。但是这里我们用星号(*)来表示它。</p><p id="f6bd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">根据 Angular 的官方文件:-</p><blockquote class="li lj lk"><p id="381c" class="jv jw ll jx b jy jz ka kb kc kd ke kf lm kh ki kj ln kl km kn lo kp kq kr ks ig bi translated">星号、<strong class="jx io"> * </strong>、结构指令上的语法，比如<strong class="jx io"> *ngIf </strong>，是 Angular 解释为更长形式的简写。Angular 将结构指令前的星号转换成包围宿主元素及其后代的<strong class="jx io"> &lt; ng 模板&gt; </strong>。</p></blockquote><p id="8688" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">因此，按照这个语句，Angular 将在上面的代码片段中解释我们的 DOM，如下所示。</p><figure class="lc ld le lf gt jo"><div class="bz fp l di"><div class="lg lh l"/></div></figure><p id="f3e7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">因此，即使你以 ng-template 的形式编写代码，也和在 div 上编写*ngIf 一样。但是让我们来理解 Angular 为什么要这么做。</p><p id="50de" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了理解这一点，让我们试着创建一个类似的指令。如果我们仔细观察 ngIf 指令，它会在条件为 falsy 时删除特定的 DOM 元素。但是如果我们在模板中的组件选择器上应用这个指令，那么如果条件变得错误，就会破坏组件。因此，让我们尝试通过创建一个名为 ngShow 的结构化指令来解决这个问题，它将从 DOM 中删除元素，但不会在随后的值更改中破坏和重新创建它。相反，它将重新添加相同的实例。</p><p id="9f85" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们一步一步地创建这个指令。</p><ol class=""><li id="5049" class="kt ku in jx b jy jz kc kd kg kv kk kw ko kx ks ky kz la lb bi translated">运行命令。</li></ol><p id="4d0a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="ll"> ng 生成指令 ngShow </em></p><p id="8c09" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">2.我们的文件如下所示。</p><figure class="lc ld le lf gt jo"><div class="bz fp l di"><div class="lg lh l"/></div></figure><p id="3f27" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">3.让我们在指令中注入 templateRef 和 viewContainerRef，并引入一个名为 ngShow 的输入。</p><figure class="lc ld le lf gt jo"><div class="bz fp l di"><div class="lg lh l"/></div></figure><p id="acb5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这就是 Angular 以 ng-template 的形式解释结构指令的主要原因，这样它就可以根据条件动态地嵌入或删除模板。ViewContainerRef 是将在其中创建模板的容器的引用。</p><p id="54db" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">4.<strong class="jx io"> </strong>现在让我们实现我们的指令，这样一旦创建了一个模板，在条件的值进一步改变之后，它就重用同一个模板，而不是销毁和重新创建。</p><figure class="lc ld le lf gt jo"><div class="bz fp l di"><div class="lg lh l"/></div></figure><p id="5fe2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在，如果仔细看第 23 行，我们存储了一个引用，当条件第一次为真时创建视图，当条件为假时分离视图。</p><p id="2d9b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">分离的作用是防止破坏视图，只是简单地删除它。然后，我们为条件的后续真值重新插入同一个 viewRef。当指令被摧毁时，我们只是在摧毁那个观点。</p><p id="da61" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">5.现在让我们在 app 组件的同一个例子中使用这个指令，而不是在 div 上使用 ngIf。</p><figure class="lc ld le lf gt jo"><div class="bz fp l di"><div class="lg lh l"/></div></figure><p id="6aea" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这将每隔 2000 秒显示和隐藏一次 Hello 文本，而不会破坏 DOM 节点，如果我们将这个指令放在模板中的一个组件选择器上，情况也是如此。</p><p id="cfe0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">目前，这个指令不支持 ngIf 指令中的其他行为，但如果我们愿意，我们也可以通过在指令中增加一个输入来配置，并应用相同的原则。但是 ngShow 只是意味着如果条件为假，隐藏元素。这就是为什么这里不这么做。</p><blockquote class="li lj lk"><p id="2f45" class="jv jw ll jx b jy jz ka kb kc kd ke kf lm kh ki kj ln kl km kn lo kp kq kr ks ig bi translated">结构化指令是 angular 中执行 DOM 操作的一个很好的特性。如果我们对它们有足够的了解，我们可以为不同的场景创建自己的结构指令来执行 DOM 操作。</p></blockquote><p id="6842" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">要了解更多关于结构指令的内容，你也可以点击这里阅读官方文档:-<a class="ae lp" href="https://angular.io/guide/structural-directives" rel="noopener ugc nofollow" target="_blank">https://angular.io/guide/structural-directives</a></p><p id="8cad" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">遵循它可以创建不同类型的结构指令，甚至像 ngFor 这样的东西也是基于相同类型的设置。</p></div></div>    
</body>
</html>