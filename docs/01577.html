<html>
<head>
<title>Old MVVMCross Xamarin solutions &amp; the looming Android 10 Deadline</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">旧的 MVVMCross Xamarin 解决方案&amp;日益逼近的 Android 10 截止日期</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/oldmvvmcrossxamarinsolutionstheloomingandroid10deadline-1744a54b6dbd?source=collection_archive---------5-----------------------#2020-07-07">https://blog.devgenius.io/oldmvvmcrossxamarinsolutionstheloomingandroid10deadline-1744a54b6dbd?source=collection_archive---------5-----------------------#2020-07-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7971" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">11 月 2 日就要到了，要主动避免崩溃</h2></div><p id="0634" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi lb translated"><span class="l lc ld le bm lf lg lh li lj di"> U </span>像 Xamarin 这样的跨平台框架有很多优点，比如学习曲线更短，开发时间更短。但是，由于原生 iOS &amp; Android SDK 的<strong class="kh ir">不可预见的</strong>变化而需要的变化是缺点之一，正如你将在本文中看到的。<br/>更新:查看<a class="ae lk" href="https://prototypemakers.medium.com/migrating-updating-an-old-xamarin-native-mvvmcross-project-c2ddd90282b6" rel="noopener">这篇文章</a>了解如何更新和迁移。</p><h2 id="8d0f" class="ll lm iq bd ln lo lp dn lq lr ls dp lt ko lu lv lw ks lx ly lz kw ma mb mc md bi translated">介绍</h2><p id="1d4d" class="pw-post-body-paragraph kf kg iq kh b ki me jr kk kl mf ju kn ko mg kq kr ks mh ku kv kw mi ky kz la ij bi translated">你一定已经从微软刚刚发表的一篇文章<a class="ae lk" href="https://devblogs.microsoft.com/xamarin/android-10-requirements" rel="noopener ugc nofollow" target="_blank">中了解到 Android Play 商店需求的重要变化。它基于 Android </a>概述的<a class="ae lk" href="https://developer.android.com/distribute/play-policies" rel="noopener ugc nofollow" target="_blank">截止日期，并在此图中进行了总结:</a></p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mj"><img src="../Images/6799b6d9435531186eb52fc3778d2466.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EDrQ1dWg3FcH0LQSh2xWKw.png"/></div></div><figcaption class="mv mw gj gh gi mx my bd b be z dk translated">谷歌的解释者图片显示了不同需求的时间表</figcaption></figure><p id="9ce0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">谷歌 Play 商店要求指出，2020 年 11 月 2 日之后，所有对 Android 应用的更新都需要针对 Android 10 (Q API Level 29)框架。</p><h2 id="898f" class="ll lm iq bd ln lo lp dn lq lr ls dp lt ko lu lv lw ks lx ly lz kw ma mb mc md bi translated">修复大多数 Xamarin 应用程序</h2><p id="061c" class="pw-post-body-paragraph kf kg iq kh b ki me jr kk kl mf ju kn ko mg kq kr ks mh ku kv kw mi ky kz la ij bi translated">对于大多数 Xamarin 和 Xamarin。表单应用程序，这是一个简单的 4 步修复:</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mz"><img src="../Images/a22d92bfda3bf95a73ab7322f3a7aaaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ApFh8Dv1Ss74zFI499FjcQ.png"/></div></div><figcaption class="mv mw gj gh gi mx my bd b be z dk translated">4 步改变以符合 Android 10 的变化</figcaption></figure><ol class=""><li id="ab0e" class="na nb iq kh b ki kj kl km ko nc ks nd kw ne la nf ng nh ni bi translated">在 Microsoft Visual Studio 中打开您的 Xamarin 解决方案(SLN)文件，双击您的<code class="fe nj nk nl nm b">Droid</code>项目以打开项目选项</li><li id="de30" class="na nb iq kh b ki nn kl no ko np ks nq kw nr la nf ng nh ni bi translated">在菜单中选择常规构建选项</li><li id="0c98" class="na nb iq kh b ki nn kl no ko np ks nq kw nr la nf ng nh ni bi translated">将目标框架更改为 Android 10 或更高版本</li><li id="f56b" class="na nb iq kh b ki nn kl no ko np ks nq kw nr la nf ng nh ni bi translated">按确定，你就完成了！</li></ol><h2 id="723a" class="ll lm iq bd ln lo lp dn lq lr ls dp lt ko lu lv lw ks lx ly lz kw ma mb mc md bi translated">为什么 MVVMCross 没那么容易？</h2><p id="1683" class="pw-post-body-paragraph kf kg iq kh b ki me jr kk kl mf ju kn ko mg kq kr ks mh ku kv kw mi ky kz la ij bi translated">如果你正在使用一个像 MVVMCross 这样的“MVVM 框架”库(nuget 包)，你可能会有很多工作要做。这些库与 Xamarin 本地解决方案的代码紧密相关，主要用于简化导航和代码共享，比 Xamarin 早很多年。形式变得更加稳定。那么问题是什么呢？正如 StackOverflow 上的<a class="ae lk" href="https://stackoverflow.com/questions/59078153/mvvmcross-android-10-0-q-mainactivity-exception-crash-on-setcontentview" rel="noopener ugc nofollow" target="_blank">所详述的，由于 MVVMCross 框架无法预见的 Android SDK<strong class="kh ir">中的变化，这些应用不能简单地针对 Android 10 框架。您的应用程序将在加载时崩溃，除非您更新到 MVVMCross 版本 6.4.1 库。更新 Nuget 包通常很容易，不是吗？修复并不容易，因为这些 MVVM 框架库的更新版本不支持您的“核心”项目的&gt; 5 年旧目标框架，它可能使用。NET Portable PCL 4.5 —配置文件 111。该库的维护者 Tomasz，<a class="ae lk" href="https://twitter.com/Cheesebaron/status/1280521246535561223" rel="noopener ugc nofollow" target="_blank">指出</a>有一些潜在的变通办法，比如滚动你自己的<code class="fe nj nk nl nm b">MvxLayoutInflater</code>代码，或者可能只是停止使用 MvvmCross 的绑定膨胀，像在 iOS 上一样在代码中进行所有的绑定，但我还没有尝试过这些。</strong></a></p><h2 id="dace" class="ll lm iq bd ln lo lp dn lq lr ls dp lt ko lu lv lw ks lx ly lz kw ma mb mc md bi translated">那么我该如何更新呢？</h2><p id="7e8a" class="pw-post-body-paragraph kf kg iq kh b ki me jr kk kl mf ju kn ko mg kq kr ks mh ku kv kw mi ky kz la ij bi translated">理论上，更新库版本应该遵循以下步骤:</p><figure class="mk ml mm mn gt mo"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="mv mw gj gh gi mx my bd b be z dk translated">GIF 讽刺的叫你把头发拔了</figcaption></figure><ol class=""><li id="b56f" class="na nb iq kh b ki kj kl km ko nc ks nd kw ne la nf ng nh ni bi translated">您必须首先将核心 PCL 项目目标框架更新为。NET 标准 2.0。有几篇文章谈到了这一点。</li><li id="901f" class="na nb iq kh b ki nn kl no ko np ks nq kw nr la nf ng nh ni bi translated">一旦你改变了这一点，现在你所有的第三方库将需要更新到一个版本，以支持新的核心目标框架。</li><li id="f331" class="na nb iq kh b ki nn kl no ko np ks nq kw nr la nf ng nh ni bi translated">由于这些库中多年的变化(可能超过 2000)，您将会有很多错误。</li><li id="312c" class="na nb iq kh b ki nn kl no ko np ks nq kw nr la nf ng nh ni bi translated">一旦你通过简单的修复解决了 90%的错误，所有的项目都需要做大量的修改，因为 MVVMCross 的设置和以前有很大的不同。</li></ol><p id="2e80" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我的建议是不要尝试更新你的库版本！从我的试验中，我了解到更新库版本的最简单的方法是用最新的目标框架和库获取 MVVMCross 提供的最新工作样本，并对其进行替换，一部分一部分地替换页面。如上所述，也许可以试试 Tomasz 提到的潜在解决方法。</p><h2 id="2d9c" class="ll lm iq bd ln lo lp dn lq lr ls dp lt ko lu lv lw ks lx ly lz kw ma mb mc md bi translated">为什么我会知道这件事？</h2><p id="e325" class="pw-post-body-paragraph kf kg iq kh b ki me jr kk kl mf ju kn ko mg kq kr ks mh ku kv kw mi ky kz la ij bi translated">去年，我花了一些空闲时间，尝试在空闲时间为一个应用程序进行迁移，这是一个挑战，遵循我在网上收到的教程和建议，并向 Xamarin 顾问请教，这导致了一个路障和许多实现。对于我刚刚继承的一个应用程序，一家主要的咨询公司花了几个月的时间与 Xamarin apps 一起进行 MVVMCross 框架“迁移”，我们仍然在修复产生的 bug。</p><h2 id="91eb" class="ll lm iq bd ln lo lp dn lq lr ls dp lt ko lu lv lw ks lx ly lz kw ma mb mc md bi translated">迁移会让应用持续一段时间吗？</h2><p id="05a2" class="pw-post-body-paragraph kf kg iq kh b ki me jr kk kl mf ju kn ko mg kq kr ks mh ku kv kw mi ky kz la ij bi translated">迁移并不都是不幸的。2018 年底左右做的另一个改变是，Android 把所有原生库都改成了“AndroidX”。从我与 MVVMCross 的创建者的交谈中，只有一个非官方版本的库支持 AndroidX，但它是可行的。你现在不需要做这种改变，但随着即将到来的 MVVMCross 版本 7 库，你可以在可预见的未来继续发布你的 Xamarin MVVMCross Android 应用程序的更新。</p></div><div class="ab cl nu nv hu nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="ij ik il im in"><h2 id="5cb4" class="ll lm iq bd ln lo lp dn lq lr ls dp lt ko lu lv lw ks lx ly lz kw ma mb mc md bi translated">MVVMCross 太牛了！</h2><p id="4c5d" class="pw-post-body-paragraph kf kg iq kh b ki me jr kk kl mf ju kn ko mg kq kr ks mh ku kv kw mi ky kz la ij bi translated">我最近继承的应用程序将 MVVMCross 用于 2013 版的库，非常稳定。该公司只是决定迁移到最新版本，因为这个 Android 10 的要求。考虑到这一点，尽管有这个问题，我还是高度赞扬框架的创建者和贡献者们创造了一个奇妙的库。不要忘记与你的朋友分享，因为他们可能不知道这个迫在眉睫的最后期限。请在<a class="ae lk" href="https://twitter.com/Saamerm" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上告诉我你的想法，或者在这里发表评论。</p></div></div>    
</body>
</html>