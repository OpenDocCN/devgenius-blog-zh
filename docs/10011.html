<html>
<head>
<title>Daily SQL ~ Day 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">每日 SQL ~第 2 天</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/daily-sql-day-2-e2f9a1016770?source=collection_archive---------4-----------------------#2022-09-29">https://blog.devgenius.io/daily-sql-day-2-e2f9a1016770?source=collection_archive---------4-----------------------#2022-09-29</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="f56d" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">提问由<a class="ae kc" href="https://datalemur.com/" rel="noopener ugc nofollow" target="_blank">的大狐猴</a>、<a class="ae kc" href="https://www.scaler.com/topics/sql/sql-query-execution-order/" rel="noopener ugc nofollow" target="_blank">的标量</a>进行练习</h2></div><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi kd"><img src="../Images/3be3c500a6553f698f7ac2a925225bf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FH-7Gls7QtLuzYKL.png"/></div></div></figure><p id="1b09" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">要快速修改 SQL 子句，请访问<a class="ae kc" href="https://medium.com/@imabhi1216/sql-revision-part-1-fed9b4106b82" rel="noopener"><strong class="kr io"><em class="ll">SQL cheat sheet</em></strong></a></p><h1 id="61bd" class="lm ln in bd lo lp lq lr ls lt lu lv lw jt lx ju ly jw lz jx ma jz mb ka mc md bi translated"><a class="ae kc" href="https://datalemur.com/questions/sql-histogram-tweets" rel="noopener ugc nofollow" target="_blank"> <strong class="ak"> 1。推文直方图</strong> </a></h1><p id="6b9b" class="pw-post-body-paragraph kp kq in kr b ks me jo ku kv mf jr kx ky mg la lb lc mh le lf lg mi li lj lk ig bi translated">假设您收到了包含 tweet 数据的下表。编写一个查询来获得 2022 年每个用户发布的 tweets 的直方图。输出每个用户的 tweet 计数作为 bucket，然后输出落入该 bucket 的 Twitter 用户数。</p><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi mj"><img src="../Images/48ea6aad157563dc78cdecb9894a83ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-4xKl4ZShydSNg3ZMsFLLQ.png"/></div></div></figure><p id="3893" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated"><strong class="kr io"> <em class="ll">解决方案:</em> </strong></p><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi mk"><img src="../Images/44d839362307b3157a673fe9a2033dc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yb7QLUfGI4CMnOuRKaqPcg.png"/></div></div></figure><h1 id="c09e" class="lm ln in bd lo lp lq lr ls lt lu lv lw jt lx ju ly jw lz jx ma jz mb ka mc md bi translated"><a class="ae kc" href="https://datalemur.com/questions/second-day-confirmation" rel="noopener ugc nofollow" target="_blank"> <strong class="ak"> 2。第二天确认</strong> </a></h1><p id="9b64" class="pw-post-body-paragraph kp kq in kr b ks me jo ku kv mf jr kx ky mg la lb lc mh le lf lg mi li lj lk ig bi translated">新抖音用户用他们的电子邮件注册，每个用户都会收到一条确认激活他们账户的短信。假设你得到了下面关于电子邮件和短信的表格。</p><p id="c6e6" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">编写一个查询来显示在注册的第一天没有确认，但在第二天确认的用户的 id。</p><p id="d8f5" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">假设:</p><ul class=""><li id="a7eb" class="ml mm in kr b ks kt kv kw ky mn lc mo lg mp lk mq mr ms mt bi translated"><code class="fe mu mv mw mx b">action_date</code>是用户激活账户并通过文本确认注册的日期。</li></ul><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div class="gh gi my"><img src="../Images/024c8e541f788073709efcfabb70af67.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/format:webp/1*cRKt98n9sPGiF1S3bht-zg.png"/></div></figure><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/b1a13c7d7f223edbc6a70ff11b312995.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*1Ia3sIjhYzsxHWplpv26dQ.png"/></div></figure><p id="73ab" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated"><strong class="kr io"> <em class="ll">解决方案:</em> </strong></p><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi na"><img src="../Images/332e36400994171e11dc6d0b2dcf4c99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6Yo3TkrwHmjRweDwY_iHrQ.png"/></div></div></figure><blockquote class="nb nc nd"><p id="e204" class="kp kq ll kr b ks kt jo ku kv kw jr kx ne kz la lb nf ld le lf ng lh li lj lk ig bi translated"><strong class="kr io"> <em class="in">注:</em> </strong></p><p id="c22e" class="kp kq ll kr b ks kt jo ku kv kw jr kx ne kz la lb nf ld le lf ng lh li lj lk ig bi translated"><code class="fe mu mv mw mx b">INNER JOIN</code>关键字选择在两个表中都有匹配值的记录。</p></blockquote><pre class="ke kf kg kh gt nh mx ni nj aw nk bi"><span id="0ef3" class="nl ln in mx b gy nm nn l no np">SELECT <em class="ll">column_name(s)</em><br/>FROM <em class="ll">table1</em><br/>INNER JOIN <em class="ll">table2<br/></em>ON <em class="ll">table1.column_name </em>=<em class="ll"> table2.column_name</em>;</span></pre><blockquote class="nb nc nd"><p id="8d94" class="kp kq ll kr b ks kt jo ku kv kw jr kx ne kz la lb nf ld le lf ng lh li lj lk ig bi translated"><a class="ae kc" href="https://www.w3schools.com/sql/sql_join_inner.asp" rel="noopener ugc nofollow" target="_blank"> <strong class="kr io"> <em class="in">来源</em> </strong> </a></p></blockquote><h1 id="6ca1" class="lm ln in bd lo lp lq lr ls lt lu lv lw jt lx ju ly jw lz jx ma jz mb ka mc md bi translated"><a class="ae kc" href="https://datalemur.com/questions/apple-pay-volume" rel="noopener ugc nofollow" target="_blank"> 3。<strong class="ak"> Apple Pay 卷</strong>卷</a></h1><p id="75ce" class="pw-post-body-paragraph kp kq in kr b ks me jo ku kv mf jr kx ky mg la lb lc mh le lf lg mi li lj lk ig bi translated">Visa 正试图分析其应用支付合作伙伴关系。计算通过 Apple Pay 进行交易的每个商家的总交易量。</p><p id="0d71" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">按商家输出商家 ID 和总交易。对于没有 Apple Pay 交易的商户，输出其总交易量为 0。</p><p id="8618" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">按交易量降序显示结果。</p><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi nq"><img src="../Images/610484193d7245fe08cf8727983a0337.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/1*sqCoPkINkHb1h0TVUkjzzQ.png"/></div></div></figure><p id="ff66" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated"><strong class="kr io"> <em class="ll">解决方案:</em> </strong></p><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi na"><img src="../Images/2d43d2b6800341ce1deee58e7c83ae33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gkVpVMY-LPDBHInC-4SoZg.png"/></div></div></figure><blockquote class="nb nc nd"><p id="f2f7" class="kp kq ll kr b ks kt jo ku kv kw jr kx ne kz la lb nf ld le lf ng lh li lj lk ig bi translated"><strong class="kr io"> <em class="in">注:</em> </strong></p><p id="e24d" class="kp kq ll kr b ks kt jo ku kv kw jr kx ne kz la lb nf ld le lf ng lh li lj lk ig bi translated"><code class="fe mu mv mw mx b">CASE</code>表达式遍历所有条件，并在满足第一个条件时返回值(类似于 if-then-else 语句)。所以，一旦条件为真，它将停止读取并返回结果。如果没有条件为真，则返回<code class="fe mu mv mw mx b">ELSE</code>子句中的值。</p><p id="b000" class="kp kq ll kr b ks kt jo ku kv kw jr kx ne kz la lb nf ld le lf ng lh li lj lk ig bi translated">如果没有<code class="fe mu mv mw mx b">ELSE</code>部分并且没有条件为真，则返回 NULL。</p></blockquote><pre class="ke kf kg kh gt nh mx ni nj aw nk bi"><span id="1a93" class="nl ln in mx b gy nm nn l no np">CASE<br/> WHEN <em class="ll">condition1</em> THEN <em class="ll">result1</em><br/> WHEN <em class="ll">conditionN</em> THEN <em class="ll">resultN</em><br/> ELSE <em class="ll">result</em><br/>END;</span></pre><blockquote class="nb nc nd"><p id="f774" class="kp kq ll kr b ks kt jo ku kv kw jr kx ne kz la lb nf ld le lf ng lh li lj lk ig bi translated"><a class="ae kc" href="https://www.w3schools.com/sql/sql_case.asp" rel="noopener ugc nofollow" target="_blank"> <strong class="kr io"> <em class="in">来源</em> </strong> </a></p></blockquote><h1 id="325d" class="lm ln in bd lo lp lq lr ls lt lu lv lw jt lx ju ly jw lz jx ma jz mb ka mc md bi translated"><a class="ae kc" href="https://datalemur.com/questions/teams-power-users" rel="noopener ugc nofollow" target="_blank"> <strong class="ak"> 4。团队超级用户</strong> </a></h1><p id="c2d0" class="pw-post-body-paragraph kp kq in kr b ks me jo ku kv mf jr kx ky mg la lb lc mh le lf lg mi li lj lk ig bi translated">编写一个查询，查找 2022 年 8 月在微软团队中发送消息最多的前 2 名超级用户。显示这两个用户的 id 以及他们发送的邮件总数。以递减的消息数输出结果。</p><p id="8b6d" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">假设:</p><ul class=""><li id="0c3e" class="ml mm in kr b ks kt kv kw ky mn lc mo lg mp lk mq mr ms mt bi translated">没有两个用户在 2022 年 8 月发送了相同数量的消息。</li></ul><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi nr"><img src="../Images/0743bdc22c51c89624ef771e5ec20ba2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D3FnLBEMu0khMWSBMX52Kw.png"/></div></div></figure><p id="c533" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated"><strong class="kr io"> <em class="ll">解决方案:</em> </strong></p><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi na"><img src="../Images/a240645d3309f5fffc0d1bdc64a57075.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DuRUwFl-NVJcNYGnzoiIFA.png"/></div></div></figure><blockquote class="nb nc nd"><p id="28c3" class="kp kq ll kr b ks kt jo ku kv kw jr kx ne kz la lb nf ld le lf ng lh li lj lk ig bi translated"><strong class="kr io"> <em class="in">注:</em> </strong></p><p id="b43d" class="kp kq ll kr b ks kt jo ku kv kw jr kx ne kz la lb nf ld le lf ng lh li lj lk ig bi translated">函数的作用是:从给定的日期中提取一个部分。</p><p id="9bbe" class="kp kq ll kr b ks kt jo ku kv kw jr kx ne kz la lb nf ld le lf ng lh li lj lk ig bi translated">I/P:选择提取(从“2017–06–15”开始的月份)；</p><p id="79fe" class="kp kq ll kr b ks kt jo ku kv kw jr kx ne kz la lb nf ld le lf ng lh li lj lk ig bi translated">O/P: 6</p><p id="1db9" class="kp kq ll kr b ks kt jo ku kv kw jr kx ne kz la lb nf ld le lf ng lh li lj lk ig bi translated"><a class="ae kc" href="https://www.w3schools.com/mysql/trymysql.asp?filename=trysql_func_mysql_extract" rel="noopener ugc nofollow" target="_blank"> <strong class="kr io"> <em class="in">来源</em> </strong> </a></p></blockquote><h1 id="2353" class="lm ln in bd lo lp lq lr ls lt lu lv lw jt lx ju ly jw lz jx ma jz mb ka mc md bi translated"><a class="ae kc" href="https://datalemur.com/questions/sql-highest-products" rel="noopener ugc nofollow" target="_blank"> 5。<strong class="ak">最高产品数量</strong> </a></h1><p id="fff4" class="pw-post-body-paragraph kp kq in kr b ks me jo ku kv mf jr kx ky mg la lb lc mh le lf lg mi li lj lk ig bi translated">假设您收到了下表，其中包含易贝客户的各种订单信息。编写一个查询来获取前 3 名客户购买的产品的用户 id 和数量；这些顾客总共至少花了 1000 美元。</p><p id="3241" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">以降序输出用户 id 和产品数量。为了打破平局(例如，如果两个顾客都购买了 10 件产品)，花费更多的用户应该优先。</p><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/9492e402a26a739335d3be814549b857.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*0O8-wwCiwOp7AU81k-bVOw.png"/></div></figure><p id="f1d1" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated"><strong class="kr io"> <em class="ll">解决方案:</em> </strong></p><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi na"><img src="../Images/f7a74a1d4ff02bb99a2a84db8c9eaa1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sy7kyAfjck9q1h8hqdtptQ.png"/></div></div></figure><blockquote class="nb nc nd"><p id="acea" class="kp kq ll kr b ks kt jo ku kv kw jr kx ne kz la lb nf ld le lf ng lh li lj lk ig bi translated"><strong class="kr io"> <em class="in">注:</em> </strong></p><p id="81b5" class="kp kq ll kr b ks kt jo ku kv kw jr kx ne kz la lb nf ld le lf ng lh li lj lk ig bi translated">SQL 中 having 和 where 子句的区别在于，where 子句不能<em class="in">或</em>用于聚合，但是 having 子句可以。</p><p id="aff0" class="kp kq ll kr b ks kt jo ku kv kw jr kx ne kz la lb nf ld le lf ng lh li lj lk ig bi translated"><strong class="kr io"> where </strong>子句作用于行的数据，而不是聚合数据</p><p id="4f25" class="kp kq ll kr b ks kt jo ku kv kw jr kx ne kz la lb nf ld le lf ng lh li lj lk ig bi translated"><a class="ae kc" href="https://www.geeksforgeeks.org/having-vs-where-clause-in-sql/" rel="noopener ugc nofollow" target="_blank"> <strong class="kr io"> <em class="in">来源</em> </strong> </a></p></blockquote><h1 id="feb9" class="lm ln in bd lo lp lq lr ls lt lu lv lw jt lx ju ly jw lz jx ma jz mb ka mc md bi translated">参考资料:</h1><h1 id="220b" class="lm ln in bd lo lp lq lr ls lt lu lv lw jt lx ju ly jw lz jx ma jz mb ka mc md bi translated"><a class="ae kc" href="https://datalemur.com/" rel="noopener ugc nofollow" target="_blank">数据狐猴</a></h1></div></div>    
</body>
</html>