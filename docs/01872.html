<html>
<head>
<title>Build Automation for Absolute Beginners (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为绝对初学者构建自动化(第1部分)</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/build-automation-for-absolute-beginners-part-1-73ecf15ebd72?source=collection_archive---------23-----------------------#2020-07-13">https://blog.devgenius.io/build-automation-for-absolute-beginners-part-1-73ecf15ebd72?source=collection_archive---------23-----------------------#2020-07-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="38eb" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">自动化应用程序构建、测试和部署</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ba7539801c655557aa6463cbeb9e302b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y7aXKDwfemIDz24WxTIMwQ.png"/></div></div></figure><p id="349d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是我为绝对初学者系列的第三篇。它从面向绝对初学者的<a class="ae ln" href="https://medium.com/dev-genius/application-programming-for-absolute-beginners-bf2a035efdf6" rel="noopener">应用程序编程</a>开始，目标是通过使用更少的行话和一步一步地安装应用程序编程所需的最少软件，让人们快速入门。</p><p id="8850" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">本系列的下一篇文章，<a class="ae ln" href="https://medium.com/dev-genius/application-containers-for-absolute-beginners-253a61bb6e39" rel="noopener">面向绝对初学者的应用程序容器</a>采用了同样的逐步安装方法，并在我们学习部署应用程序时详细解释了这些内容。最终，我们能够将它们部署到Kubernetes集群(运行在笔记本电脑上)，这仍然让一些经验丰富的开发人员望而生畏。所以如果你做到了，恭喜你！</p><p id="1c0a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在本文中，我们将通过部署和设置旨在自动化构建软件过程的软件来构建它。人们使用许多花哨的术语来描述这种活动，管道、CI/CD、DevOps，但它真正包含的是将程序从变更请求到生产的过程自动化。我有信心，通过使用一步一步的方法，即使是绝对的初学者也可以学习这种软件开发的高级方法。虽然公司不喜欢雇用初级程序员，但他们可能会给你一个机会，让你使用我将在本文中讨论的工具成为测试开发人员或开发人员。如果没有别的事，你将可以使用一些非常酷的(我认为)工具。</p><p id="7d9f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">对于本文，我假设您已经阅读了前两篇文章并编写了代码。您应该知道如何在我们安装的Atom编辑器中查看和编辑代码，并且应该知道如何与Git和GitHub进行交互。您的笔记本电脑还应该安装有家酿和Docker桌面，并启用Kubernetes。如果你不清楚我在说什么，回到前两篇文章，并刷新你的记忆。</p><p id="5cb4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了自动化我们的流程，我们将使用一个可靠的应用程序Jenkins。这不是最新的，也不能说是最棒的，但在更大的工作场所非常普遍。因此，让我们将它部署到您的系统上，这样您就可以获得一些实践经验。</p><p id="16ec" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在我的上一篇文章中，我们安装了Docker Desktop并增加了默认的资源。如果你给Docker桌面的资源不足，这就是事情可能开始变慢的地方。我把给Docker的内存提升到了8g，但是如果魔兽世界开始变慢，我可能会恢复。我有我的优先权。要调整您的资源，请单击右上角工具栏中的Docker桌面图标，选择首选项，然后选择资源/高级。</p><p id="a4cc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我在这篇文章中的目标之一是让你不必在你的笔记本电脑上安装很多软件。其中一部分是在容器中运行。所以在我以前的文章《绝对初学者的应用程序容器》中，我们在一个容器中安装了MongoDB，并很快删除了它。我们将对Jenkins做同样的事情，除了我们将为Kubernetes使用一个名为<a class="ae ln" href="https://helm.sh/" rel="noopener ugc nofollow" target="_blank"> Helm </a>的“包管理器”。这使得需要在Kubernetes中创建依赖项或其他工件的应用程序可以捆绑到一个名为Helm Chart的项目中。要明确的是，虽然我们可以部署没有头盔的詹金斯，但我觉得这样更容易，特别是因为我们没有微调它。</p><p id="6103" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">由于我们已经在之前的文章中安装了Homebrew，我们可以使用这个命令来安装helm:</p><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="4cbc" class="lt lu iq lp b gy lv lw l lx ly">brew install helm<br/>helm version # should give a number &gt;= v3.2.4</span></pre><p id="1fca" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Helm对Helm图表的存储库进行操作，有点像DockerHub是一个预建图像的存储库。我们将从Google APIs获取舵图表库，并从那里部署Jenkins</p><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="10d2" class="lt lu iq lp b gy lv lw l lx ly">helm repo add jenkins https://charts.jenkins.io<br/>helm repo update<br/>helm install jenkins jenkins/jenkins</span></pre><p id="d20f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">使用Helm的好处是，如果你的Jenkins部署完全混乱，你可以运行<code class="fe lz ma mb lp b">helm uninstall jenkins</code>并重新安装。</p><p id="fabb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">安装的一部分是为您创建一个随机的<code class="fe lz ma mb lp b">admin</code>密码，您可以用这个命令访问它:</p><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="a6ab" class="lt lu iq lp b gy lv lw l lx ly">printf $(kubectl get secret --namespace default jenkins \<br/>   -o jsonpath="{.data.jenkins-admin-password}" | \<br/>   base64 --decode);echo</span></pre><p id="a22a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">保存该值，以备我们需要登录时使用。</p><p id="06fe" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">使用以下命令查看正在运行的服务:</p><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="46c0" class="lt lu iq lp b gy lv lw l lx ly">randalkamradt@Fuji blackbook % kubectl get service<br/>NAME            TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)     AGE<br/>jenkins         ClusterIP   10.99.0.184    &lt;none&gt;        8080/TCP    2m38s<br/>jenkins-agent   ClusterIP   10.102.3.147   &lt;none&gt;        50000/TCP   2m38s<br/>kubernetes      ClusterIP   10.96.0.1      &lt;none&gt;        443/TCP     14d</span></pre><p id="2db0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们可以看到Jenkins服务的类型是ClusterIP，没有外部IP。我们需要改变这种情况。幸运的是，我们可以编辑一个正在运行的服务。但首先，我们需要设置标准编辑器，因为否则你将被介绍给宇宙中最讨厌的编辑器，<code class="fe lz ma mb lp b">vi</code>(对不起vi粉丝，你的数量远远超过)。让我们将您的编辑器设置为更熟悉的东西，我们在应用程序编程中为绝对初学者安装的Atom编辑器。</p><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="eba5" class="lt lu iq lp b gy lv lw l lx ly">export <!-- -->KUBE_EDITOR="atom --wait"</span></pre><p id="119d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">事实上，我们应该将它添加到您的<code class="fe lz ma mb lp b">~/.bash_profile</code>中，这样您的终端将总是以<code class="fe lz ma mb lp b">KUBE_EDITOR</code>值集开始。<code class="fe lz ma mb lp b">~/.bash_profile</code>是每当你打开一个新的终端窗口时终端将运行的脚本。要添加新值，请运行以下命令:</p><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="d879" class="lt lu iq lp b gy lv lw l lx ly">echo 'export KUBE_EDITOR="atom --wait"' &gt;&gt; ~/.bash_profile</span></pre><p id="8fd7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是一种在文件末尾添加内容的奇特的脚本方式。现在，您的编辑器将始终被设置。(提示，如果你设置了<code class="fe lz ma mb lp b">EDITOR</code>而不是<code class="fe lz ma mb lp b">KUBE_EDITOR</code>，更多的程序会在需要打开编辑器时使用这个值)</p><p id="dc74" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在我们可以安全地编辑服务描述了</p><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="d530" class="lt lu iq lp b gy lv lw l lx ly">kubectl edit service jenkins</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mc"><img src="../Images/50e5125897183a3a46e96da908701a1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*swaUHTtuKOLXDYmqZyFGzg.png"/></div></div></figure><p id="0639" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">显示的最后一行<code class="fe lz ma mb lp b">spec.type</code>应从ClusterIP更改为<code class="fe lz ma mb lp b">LoadBalancer</code>。关闭Atom，再次运行<code class="fe lz ma mb lp b">kubectl get services</code>，应该会看到一个<code class="fe lz ma mb lp b">localhost</code>的外部IP。因为Docker桌面的负载平衡器总是<code class="fe lz ma mb lp b">localhost</code>，你必须确保端口不会干扰。在这种情况下，我没有在端口8080上运行其他服务，但是如果我运行了，我必须再次编辑该服务，并将spec.ports.port(而不是spec.ports.targetPort)设置为某个未使用的端口号。</p><p id="414e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在我们继续之前，我想为<code class="fe lz ma mb lp b">localhost</code>造一个同义词，这样我就可以统一访问Jenkin(在Kubernetes内部，它认为它运行在一个名为<code class="fe lz ma mb lp b">jenkins</code>的主机上)。为此，您需要编辑一个名为<code class="fe lz ma mb lp b">/etc/hosts</code>的受保护文件。从终端运行<code class="fe lz ma mb lp b">atom /etc/hosts</code>在Atom中调出文件。将<code class="fe lz ma mb lp b">127.0.0.1 localhost</code>改为<code class="fe lz ma mb lp b">127.0.0.1 localhost jenkins</code>当您试图保存该文件时，系统会提示您输入密码。</p><p id="caac" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在我们可以浏览到<a class="ae ln" href="http://localhost:8080" rel="noopener ugc nofollow" target="_blank"> http://jenkins:8080 </a>并看到登录屏幕。使用用户名<code class="fe lz ma mb lp b">admin</code>和您之前保存的密码登录。您应该会看到类似这样的内容:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi md"><img src="../Images/0d715d46a3e997681f382091c5480a2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5HQDQBh0o7ab1Kep6XltKQ.png"/></div></div></figure><p id="12c2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">它希望我们创造一份工作。在我们的例子中，工作是一系列的步骤，旨在获取原始源代码，构建它，测试它，并部署它。我们称之为管道，因为一个步骤的输出应该是下一个步骤的输入，尽管这并不完全正确。对于Jenkins，编写这些步骤的标准语言是Groovy，这些步骤所在的默认文件称为<code class="fe lz ma mb lp b">Jenkinsfile</code>。</p><p id="567c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">通常，我会将构建步骤从源代码本身中分离出来，所以我会将它放在自己的存储库中。但是为了简单起见，我将把它直接添加到我们的代码库中。在本系列的前几篇文章中，我使用<a class="ae ln" href="https://github.com/rkamradt/myfirstrepository" rel="noopener ugc nofollow" target="_blank">https://github.com/rkamradt/myfirstrepository</a>作为回购，所以我将在这里添加它。如果您遵循了本系列，您的笔记本电脑上应该还有它。如果没有，你可以把它“叉”进你自己的GitHub账户。要分叉它，点击“分叉”按钮，并选择你的GitHub帐户，如果它要求。然后，您可以将新创建的存储库“克隆”到您的笔记本电脑上。如果你感到困惑，请参考我以前的文章。但是它<em class="me">必须</em>出现在你的账户下的GitHub上，因为我们的自动化会期望这样。</p><p id="a57a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">一旦存储库出现在您的笔记本电脑上，打开Atom，添加<code class="fe lz ma mb lp b">myfirstrepository</code>作为项目文件夹，这样您的屏幕看起来就像这样:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mf"><img src="../Images/1477d9419a37e5b305455462926d5e7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g5i2HqIQGy9OcYMZlfseig.png"/></div></div></figure><p id="643d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在右击<code class="fe lz ma mb lp b">myfirstrepostiory</code>文件夹，选择“新建文件”。输入<code class="fe lz ma mb lp b">Jenkinsfile</code>作为名字。现在添加以下内容:</p><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="c767" class="lt lu iq lp b gy lv lw l lx ly">pipeline {<br/>  agent any<br/>  stages {<br/>    stage('Build') {<br/>      steps {<br/>          echo 'Building'<br/>      }<br/>    }<br/>    stage('Test') {<br/>      steps {<br/>          echo 'Testing'<br/>      }<br/>    }<br/>    stage('Deploy') {<br/>      steps {<br/>          echo 'Deploying' <br/>      }<br/>    }<br/>  }<br/>}</span></pre><p id="5aba" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这个脚本实际上什么也不做，只是打印出它应该在日志中做的事情。我们稍后将添加真实的动作。现在我们必须致力于Git，并“推”到GitHub</p><p id="13d8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在本系列的第一篇文章中，我们使用Atom的特性将更改提交并推回到GitHub。虽然您仍然可以使用所描述的过程，但是我们需要能够解决一个我一直在拖延的问题。可怕的公钥/私钥。</p><p id="36e0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">公钥/私钥是我们在计算机或应用程序之间建立信任的方式。要点是，我们可以将我们的公钥分发给任何人，然后当我们向他们发送一些数据时，我们可以用我们的私钥加密或“签名”，只有公钥才能解码。这本身并不是一种加密手段，因为任何人都可以得到我们的公钥，所以任何人都可以解码它。它唯一做的事情是表明数据来自我们，因为我们是唯一拥有签名数据的私钥的人。私钥就像我们的签名，我们用它来证明某些东西是我们的。</p><p id="4c3d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们制作一个公钥/私钥。首先，我们可以检查我们是否已经有了一个，其他应用程序可能已经为我们做了一个。默认情况下，它们在<code class="fe lz ma mb lp b">~/.ssh</code>目录中，名为id_rsa(私钥)和id_rsa.pub(公钥),所以如果它们在那里，就用<code class="fe lz ma mb lp b">ls ~/.ssh</code>列出那个目录，太好了。如果没有，我们必须创建它们。那里可能有其他文件，但我们不会仔细检查。</p><p id="6d81" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">要创建密钥对，请使用以下命令:</p><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="35c1" class="lt lu iq lp b gy lv lw l lx ly">ssh-keygen -t rsa</span></pre><p id="aa38" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你会被要求输入密码，如果你愿意，你可以输入一个，但我通常不会。密码短语只是额外的保险，以防有人得到你的私钥，他们需要密码短语来伪造你的签名。不管是哪种方式，千万不要让任何人拥有你的私钥，这就是为什么它被称为私有。</p><p id="ba55" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在再次运行<code class="fe lz ma mb lp b">ls ~/.ssh</code>，您应该会看到这两个文件。我们想对这些文件做的是给GitHub你的公钥，这样我们可以签署任何推送请求，GitHub自动知道它来自你。如果你要做任何可能与GitHub交互的自动化操作，你不会想要不断地输入你的密码。所以让我们给它你的公钥。回到终端，运行以下命令:</p><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="26aa" class="lt lu iq lp b gy lv lw l lx ly">cat ~/.ssh/id_rsa.pub</span></pre><p id="dc83" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这将打印出您的公钥(确保您使用的是<code class="fe lz ma mb lp b">.pub</code>扩展名，否则您可能会意外使用您的私钥)。现在，您可以通过高亮显示它并按下Command-c键(或从编辑菜单中拷贝)来直接从终端拷贝它。不要担心格式。它应该以ssh-rsa开头，以电子邮件地址结尾。</p><p id="257b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">回到GitHub，点击右上角的图标，选择“设置”，然后选择“SSH和GPG密钥”标签，点击“新建SSH密钥”按钮。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mg"><img src="../Images/ce973ac8c32c45e0c0d9afce3a342942.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RnweqICrVuXjWcoSWqOH8g.png"/></div></div></figure><p id="5a9f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">将您的公钥粘贴到“密钥”文本框中，并在标题框中添加描述。你应该为你用来开发的每台计算机准备一把钥匙，这就是标题的用处，这样你就知道哪把钥匙配哪台计算机了。</p><p id="30b2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在GitHub将允许我们推送到我们自己的仓库。我们现在可以使用以下命令提交和推送代码:</p><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="085a" class="lt lu iq lp b gy lv lw l lx ly">git add . # this stages the changes<br/>git commit -m "my changes" # this commits to the local repo<br/>git push # this pushes your commits to github</span></pre><p id="785d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">回到你的GitHub库，你应该会看到新的<code class="fe lz ma mb lp b">Jenkinsfile</code>。</p><p id="afc6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">回到我们的本地Jenkins (http://localhost:8080)，我们应该看到它提示我们“创建一个作业”。继续并点击它开始。它会提示您输入一个名称，我选择了<code class="fe lz ma mb lp b">myfirstrepository</code>来匹配存储库名称。然后，我选择管道作为类型，并单击确定。在下一个屏幕上，单击“管道”选项卡，为定义选择“来自SCM的管道脚本”,为SCM选择“Git”。对于资源库的URL，您可以返回GitHub，找到您的资源库。单击“代码”按钮，您应该会看到类似如下的下拉列表:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mh"><img src="../Images/5a0a9c898e08c4f4d6e024ae396c8cb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VJTf1n5R0mTJpEFJGjbQAA.png"/></div></div></figure><p id="34a5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">单击剪贴板图标，将存储库的SSH URL放入剪贴板，然后可以将其粘贴回本地Jenkins的“存储库URL”框中:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mi"><img src="../Images/dae989d15419238fde1b7c7923e5fb22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WoGRs4v9SVCNcCb7KU8-nA.png"/></div></div></figure><p id="2440" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在满屏都是一堆红色，因为GitHub不信任Jenkins。在凭证旁边，有一个“添加”按钮，点击它，然后选择詹金斯。将弹出一个对话框，您可以将“种类”更改为“带私钥的SSH用户名”</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mj"><img src="../Images/f1c041af109ba5818bd35440b1fb7e0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bsBYzlHVvvHQkwXStFhHZA.png"/></div></div></figure><p id="7d35" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">还记得我告诉过你，你生成的公钥/私钥永远不要共享私钥吗？嗯，我们将与詹金斯分享它，这样詹金斯就可以代表你工作。我们这样做只是因为这是你自己的詹金斯的私人实例。我们不希望在Jenkins的工作实例或网络上的任何地方这样做。回到终端，运行以下命令:</p><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="880d" class="lt lu iq lp b gy lv lw l lx ly">cat ~/.ssh/id_rsa</span></pre><p id="dec0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">注意这次没有<code class="fe lz ma mb lp b">.pub</code>延期。这是显示您的私钥。选择输出并复制它。回到Jenkins，单击名为“直接输入”的单选按钮，然后单击“添加”按钮，将您的私钥粘贴到文本框中。给它一个容易记忆的ID，如果你喜欢的话，可以给它一个描述，并在你生成密钥对的计算机上使用你的用户名。最后，单击添加按钮。</p><p id="48c3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为什么这样可以？我之前说过，在任何情况下，你都不应该把你的私钥给任何人。我们需要詹金斯代表你行事，这就是我们在这个特殊案件中的做法。因为Jenkins在Kubernetes内部运行，所以它不能访问您笔记本电脑上的任何资源。所以，因为它不能访问你的私钥，我们必须复制它。您在笔记本电脑上运行的其他应用程序，如Git，将可以访问<code class="fe lz ma mb lp b">~/.ssh</code>目录。但是请记住，永远不要与任何不在您的笔记本电脑上运行的应用程序共享您的私钥，包括Jenkins的其他实例。</p><p id="a875" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在我们发现自己又回到了Jenkins屏幕，仍然显示红色错误信息。您必须选择“凭据”下拉列表，并选择您刚刚创建的项目。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mk"><img src="../Images/04d539345b3a41f9003e57db74e6419d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*im7ZvHIWQqhlE_dMAnVkig.png"/></div></div></figure><p id="4cf5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">红色的错误信息消失了，这意味着GitHub现在认为你的Jenkins实例就是你。点击“保存”按钮。您现在应该会看到新的管道页面</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ml"><img src="../Images/63899c178e6e6d16f0b7b38c7b09f007.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1zTCcESnvHY6KqRm_RRO2A.png"/></div></div></figure><p id="74a5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">单击“立即构建”按钮开始构建。再过几秒/几分钟，管道就应该完成了:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ba7539801c655557aa6463cbeb9e302b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y7aXKDwfemIDz24WxTIMwQ.png"/></div></div></figure><p id="277d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在“构建历史”区域，单击“#1”查看首次构建的详细信息。在那里，您可以单击“Show Console”来查看构建的输出。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mm"><img src="../Images/c4910054340a1449ae41d862276ec5d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VvG89mxmdcIUX8b8z3xkjQ.png"/></div></div></figure><p id="2865" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">当您需要对构建进行故障排除时，这就是您要去的地方。如果你向下滚动，你会看到一个非常令人愉快的“成功”。</p><p id="9698" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">刚刚发生了什么？詹金斯的工作是管理工作。通常，它会在Jenkins运行的主机上运行它们。但是在这种情况下，我们设置Jenkins在一个由Kubernetes控制的容器中运行每个作业。如果我们直接在Jenkins主机上运行作业，我们将需要安装构建所需的任何软件；编译器、翻译器、依赖处理器等。我们可以通过在容器中完成构建来绕过这一切，现在Jenkins主机只需要安装Kubernetes。由于Jenkins在Kubernetes上运行，它可以访问Kubernetes提供的所有内容。</p><p id="b2fd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">运行作业的映像实例或“pod”有一个映像，其中只有JNLP在与main Jenkins对话。为了让我们做的不仅仅是打印东西，我们需要增强它来使用任何需要的图像来执行想要的动作。我们将在本文的第2部分中讨论这个问题，在那里我们将实际构建、测试和部署服务。</p><p id="04e0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这篇文章的标题是为绝对初学者构建自动化，而不是为傻瓜构建自动化。这里有很多详细的说明，如果你顺利地做到了这一步，你应该祝贺自己。当我试图弄清楚这些事情的时候，它会让我头昏脑胀，所以如果你读这篇文章的时候有点眩晕，你并不孤单。我希望在本文的第2部分看到您，我们将把所有这些准备工作付诸实施！</p><p id="3c45" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">本文的代码:</p><div class="mn mo gp gr mp mq"><a href="https://github.com/rkamradt/myfirstrepository/tree/v0.1" rel="noopener  ugc nofollow" target="_blank"><div class="mr ab fo"><div class="ms ab mt cl cj mu"><h2 class="bd ir gy z fp mv fr fs mw fu fw ip bi translated">rkamradt/myfirstrepository</h2><div class="mx l"><h3 class="bd b gy z fp mv fr fs mw fu fw dk translated">我的第一个仓库。通过在GitHub上创建一个帐户，为rkamradt/myfirstrepository开发做出贡献。</h3></div><div class="my l"><p class="bd b dl z fp mv fr fs mw fu fw dk translated">github.com</p></div></div><div class="mz l"><div class="na l nb nc nd mz ne kp mq"/></div></div></a></div><p id="a25b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">参考的其他文章:</p><div class="mn mo gp gr mp mq"><a href="https://medium.com/dev-genius/application-programming-for-absolute-beginners-bf2a035efdf6" rel="noopener follow" target="_blank"><div class="mr ab fo"><div class="ms ab mt cl cj mu"><h2 class="bd ir gy z fp mv fr fs mw fu fw ip bi translated">绝对初学者的应用程序设计</h2><div class="mx l"><h3 class="bd b gy z fp mv fr fs mw fu fw dk translated">如何将您的普通Mac笔记本电脑变成一个疯狂的开发怪物</h3></div><div class="my l"><p class="bd b dl z fp mv fr fs mw fu fw dk translated">medium.com</p></div></div><div class="mz l"><div class="nf l nb nc nd mz ne kp mq"/></div></div></a></div><div class="mn mo gp gr mp mq"><a href="https://medium.com/dev-genius/application-containers-for-absolute-beginners-253a61bb6e39" rel="noopener follow" target="_blank"><div class="mr ab fo"><div class="ms ab mt cl cj mu"><h2 class="bd ir gy z fp mv fr fs mw fu fw ip bi translated">绝对初学者的应用程序容器</h2><div class="mx l"><h3 class="bd b gy z fp mv fr fs mw fu fw dk translated">为真实世界准备您的应用程序</h3></div><div class="my l"><p class="bd b dl z fp mv fr fs mw fu fw dk translated">medium.com</p></div></div><div class="mz l"><div class="ng l nb nc nd mz ne kp mq"/></div></div></a></div></div></div>    
</body>
</html>