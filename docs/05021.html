<html>
<head>
<title>CRUD Operations with C# WinForms(.Net Framework)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">C# WinForms的CRUD操作(。Net框架)</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/crud-operations-with-c-winforms-net-framework-bc10b1d6ae47?source=collection_archive---------0-----------------------#2021-06-04">https://blog.devgenius.io/crud-operations-with-c-winforms-net-framework-bc10b1d6ae47?source=collection_archive---------0-----------------------#2021-06-04</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="80a9" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">这是专门为我的学生编写的完整的101讨论，但这将有助于任何人开始使用C# WinForms应用程序。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/6981e95786239d6035eb13ea0f8a0354.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M8SaYbMkscx9tHvxj1fBrg.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">Bret Kavanaugh 在<a class="ae ks" href="https://unsplash.com" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="a2e8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">2020年<a class="ae ks" href="https://devblogs.microsoft.com/dotnet/windows-forms-designer-for-net-core-released/" rel="noopener ugc nofollow" target="_blank">微软宣布</a>。Windows窗体应用程序的net Core(WinForms)哪个好？。在过去，唯一的选择是使用<a class="ae ks" href="https://www.mono-project.com/docs/about-mono/dotnet-integration/" rel="noopener ugc nofollow" target="_blank"> Mono </a>为macOS开发WinForm应用程序。不幸的是，唯一的选择仍然是在macOS和Linux上使用Mono😔。</p><blockquote class="lp"><p id="fced" class="lq lr in bd ls lt lu lv lw lx ly lo dk translated">根据微软高级项目经理Olia Gavrysh的说法，“Windows窗体仍将是纯Windows平台，所以这些特性不会出现在Mac的Visual Studio中”</p></blockquote><p id="fb1a" class="pw-post-body-paragraph kt ku in kv b kw lz jo ky kz ma jr lb lc mb le lf lg mc li lj lk md lm ln lo ig bi translated">但是，朋友们，不要失去希望，使用有更多的好处。Net核心进行开发。现在你可能想知道这家伙到底在说什么？不是。Net框架和。网芯一样？简单的回答是<strong class="kv io">不</strong>，他们不一样。都是。Net框架和。Net Core是构建应用程序的结构(在技术领域，我们称之为框架)。直到微软推出。Net Core，早在2016年我们就使用了。Net框架来构建我们的桌面、移动和web应用程序。因此，你可以说。Net Core是。Net框架。是的，我同意你，但是它完全是重写的。。Net Core是一个跨平台、开源、可扩展、轻量级、面向服务、速度更快的工具，基本上，它就像特斯拉的Cybertruck。简单来说，更具未来感的版本，具有有趣的功能。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi me"><img src="../Images/cef49fbd97c9b653dd45816e73aeb246.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SN7ym7nSb2EPAGxQYY7SHA.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">来源:<a class="ae ks" href="https://dotnet.microsoft.com/download" rel="noopener ugc nofollow" target="_blank">https://dotnet.microsoft.com/download</a></figcaption></figure><p id="56d6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">先决条件:</strong>需要安装Visual Studio(我用的是<a class="ae ks" href="https://docs.microsoft.com/en-us/visualstudio/releases/2019/release-notes#16.6.0" rel="noopener ugc nofollow" target="_blank"> Visual Studio 2019版本16.10 </a>)。不需要以前的c#经验，但你应该能够通过拖放为我们的WinForms应用程序创建简单的用户界面。最后，我更喜欢安装SQL<a class="ae ks" href="https://docs.microsoft.com/en-us/sql/ssms/download-sql-server-management-studio-ssms?view=sql-server-ver15" rel="noopener ugc nofollow" target="_blank">Server Management Studio(SSMS)</a>来创建数据库。(非强制。默认情况下，Visual Studio附带一个内置的SQL server实例。)现在让我们开始吧。</p><h1 id="2944" class="mf mg in bd mh mi mj mk ml mm mn mo mp jt mq ju mr jw ms jx mt jz mu ka mv mw bi translated">让我们把手弄脏吧</h1><blockquote class="lp"><p id="6567" class="lq lr in bd ls lt lu lv lw lx ly lo dk translated">这是我C#系列的第一篇文章。这里我们用广为人知的。Net Framework 4.7.2，希望在下一篇文章中我们可以讨论WinForms。网芯。</p></blockquote><h2 id="96e9" class="mx mg in bd mh my mz dn ml na nb dp mp lc nc nd mr lg ne nf mt lk ng nh mv ni bi translated">步骤1:设计用户界面</h2><p id="8495" class="pw-post-body-paragraph kt ku in kv b kw nj jo ky kz nk jr lb lc nl le lf lg nm li lj lk nn lm ln lo ig bi translated">首先，我使用Windows窗体设计器工具设计了一个简单的UI。我很有信心，没有任何支持，你们都能轻松做到。这是简单的拖放操作。所以，我的UI如下，</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi no"><img src="../Images/087cc2a2f0860f7ce9a127fbb29275d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u422Gcm0MaPeFDSULLHdEw.png"/></div></div></figure><p id="ea51" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如上所示，我使用WinForms设计工具设计了一个简单的卫星跟踪表单。这是我们今天要实现的功能，</p><ul class=""><li id="8213" class="np nq in kv b kw kx kz la lc nr lg ns lk nt lo nu nv nw nx bi translated">在左上角，我们可以通过ID搜索卫星。</li><li id="3e84" class="np nq in kv b kw ny kz nz lc oa lg ob lk oc lo nu nv nw nx bi translated">我们在底部有Datagridview来检索数据。</li><li id="6f32" class="np nq in kv b kw ny kz nz lc oa lg ob lk oc lo nu nv nw nx bi translated">基本上，我们从卫星收集SatelliteID(int)、SatelliteName(string)、经度(float)、纬度(float)、高度(float)和健康状态(string - Combobox)。</li><li id="c080" class="np nq in kv b kw ny kz nz lc oa lg ob lk oc lo nu nv nw nx bi translated">“全部清除”按钮用于清除所有字段。</li><li id="36eb" class="np nq in kv b kw ny kz nz lc oa lg ob lk oc lo nu nv nw nx bi translated">插入按钮用于插入新记录。</li><li id="3853" class="np nq in kv b kw ny kz nz lc oa lg ob lk oc lo nu nv nw nx bi translated">更新按钮用于更新现有记录。</li><li id="20f3" class="np nq in kv b kw ny kz nz lc oa lg ob lk oc lo nu nv nw nx bi translated">删除按钮用于删除记录。</li></ul><h2 id="220e" class="mx mg in bd mh my od dn ml na oe dp mp lc of nd mr lg og nf mt lk oh nh mv ni bi translated">步骤2:创建SQL数据库</h2><p id="55fa" class="pw-post-body-paragraph kt ku in kv b kw nj jo ky kz nk jr lb lc nl le lf lg nm li lj lk nn lm ln lo ig bi translated">在我的数据库中，我需要两个表。一个用于存储Combobox属性，另一个用于存储其余的数据。于是，我创建了一个名为<strong class="kv io"> <em class="oi"> spacex </em> </strong>的数据库和两个表，<strong class="kv io"> <em class="oi">卫星和</em> </strong> <strong class="kv io"> <em class="oi">状态</em> </strong>。</p><pre class="kd ke kf kg gt oj ok ol om aw on bi"><span id="ab47" class="mx mg in ok b gy oo op l oq or">create database spacex;<br/>use spacex;</span><span id="b236" class="mx mg in ok b gy os op l oq or">CREATE TABLE Satellites (<br/>    SatelliteID int NOT NULL IDENTITY,<br/>    SatelliteName varchar(300),<br/>    Longitude float,<br/>    Latitude float,<br/>    Elevation float,<br/>    HealthStatus varchar(300)<br/>);</span><span id="203f" class="mx mg in ok b gy os op l oq or">CREATE TABLE Status(<br/> ID int NOT NULL IDENTITY,<br/> HealthStatus varchar(300)<br/>);</span><span id="bbd6" class="mx mg in ok b gy os op l oq or">INSERT INTO Status(HealthStatus) Values('Good Condition'),('Avarage Condition'),('Poor Condition')</span></pre><p id="1213" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">创建一个执行CRUD的存储过程，定义了5种操作类型，</p><ol class=""><li id="0d88" class="np nq in kv b kw kx kz la lc nr lg ns lk nt lo ot nv nw nx bi translated">插入</li></ol><p id="b2e6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">2.更新</p><p id="e290" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">3.删除</p><p id="045b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">4.选择特定记录</p><p id="7c77" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">5.全选</p><pre class="kd ke kf kg gt oj ok ol om aw on bi"><span id="99b7" class="mx mg in ok b gy oo op l oq or">GO<br/>SET ANSI_NULLS ON<br/>GO<br/>SET QUOTED_IDENTIFIER ON<br/>GO</span><span id="d104" class="mx mg in ok b gy os op l oq or">CREATE PROCEDURE spacex_pro<br/>@SatelliteID int,<br/>@SatelliteName varchar(300),<br/>@Longitude float,<br/>@Latitude float,<br/>@Elevation float,<br/>@HealthStatus varchar(300),<br/>@OperationType int</span><span id="3684" class="mx mg in ok b gy os op l oq or">AS<br/>BEGIN<br/>SET NOCOUNT ON;<br/>IF @OperationType=1<br/>BEGIN<br/>INSERT INTO Satellites VALUES (@SatelliteName,@Longitude,@Latitude,@Elevation,@HealthStatus)<br/>END<br/>ELSE IF @OperationType=2<br/>BEGIN<br/>UPDATE Satellites SET SatelliteName=@SatelliteName , Longitude=@Longitude ,Latitude=@Latitude, Elevation=@Elevation, HealthStatus=@HealthStatus WHERE SatelliteID=@SatelliteID<br/>END<br/>ELSE IF @OperationType=3<br/>BEGIN<br/>DELETE FROM Satellites WHERE SatelliteID=@SatelliteID<br/>END<br/>ELSE IF @OperationType=4<br/>BEGIN<br/>SELECT * FROM Satellites WHERE SatelliteID=@SatelliteID<br/>END<br/>ELSE<br/>BEGIN<br/>SELECT * FROM Satellites<br/>END<br/>END</span></pre><h2 id="755a" class="mx mg in bd mh my od dn ml na oe dp mp lc of nd mr lg og nf mt lk oh nh mv ni bi translated">步骤3:连接到数据库并执行操作</h2><p id="a907" class="pw-post-body-paragraph kt ku in kv b kw nj jo ky kz nk jr lb lc nl le lf lg nm li lj lk nn lm ln lo ig bi translated">连接到SQL Server数据源，需要导入SQLClient库<code class="fe ou ov ow ok b">using System.Data.SQLClient;</code>。但是在某些情况下，我们需要安装SQLClient NuGet包才能使用它。您可以通过以下方式安装掘金包，</p><ul class=""><li id="6064" class="np nq in kv b kw kx kz la lc nr lg ns lk nt lo nu nv nw nx bi translated">右键单击解决方案面板中的项目文件，然后单击Manage NuGet Packages选项。</li><li id="1234" class="np nq in kv b kw ny kz nz lc oa lg ob lk oc lo nu nv nw nx bi translated">在NuGet软件包管理器窗口中，选择浏览器选项卡。搜索系统。Data.SqlClient，然后按enter键</li><li id="5919" class="np nq in kv b kw ny kz nz lc oa lg ob lk oc lo nu nv nw nx bi translated">选择第一个选项“系统”。Data.SqlClient by Microsoft单击安装按钮</li></ul><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ox"><img src="../Images/195ead657925568ac46f074f4800e0d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PF1VKJG8_W3kQNLzp25CnQ.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">安装SQLClient NuGet包</figcaption></figure><p id="8bae" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">要添加数据源，<strong class="kv io"> <em class="oi">转到服务器资源管理器选项卡&gt;右键单击数据连接&gt;添加连接&gt;给出您的数据源名称(在我的情况下是Microsoft SQL Server) &gt;从您的SSMS复制服务器名称&gt;选择您的验证类型(在我的情况下是Windows验证)&gt;选择数据库名称&gt;单击确定</em> </strong>。现在，Visual studio已连接到数据源。最后，要获得连接字符串，您可以单击添加的数据连接，并从properties选项卡中复制连接字符串。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oy"><img src="../Images/8bc662bfc08f3b846b2b3be3a562f4c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AgPowMPnX-n6Jt8amPwQCQ.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">查找连接字符串</figcaption></figure><p id="8776" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在我们需要移动到<strong class="kv io"> <em class="oi"> Form_Load </em> </strong>函数(只需在设计视图中双击您的表单)并添加连接字符串。连接字符串是一个基本字符串，它指定了关于数据源的信息，在我们的例子中是SQL Server。下面是我的<strong class="kv io"> <em class="oi"> Form_Load </em> </strong>函数，</p><pre class="kd ke kf kg gt oj ok ol om aw on bi"><span id="efd1" class="mx mg in ok b gy oo op l oq or">cn = new SqlConnection(@"&lt;Your_connecton_string_here&gt;");<br/>cn.Open();<br/>//bind data in data grid view<br/>GetAllSatelliteRecord();<br/>//disable delete and update button on load<br/>btnUpdate.Enabled = false;<br/>btnDelete.Enabled = false;</span></pre><p id="9eb3" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">最后，我们需要为Datagridview和ComboBox选择一个连接。最简单的方法是将<strong class="kv io"> <em class="oi">移动到Windows窗体设计器工具&gt;单击Datagridview旁边的小箭头&gt;单击选择数据源&gt;单击添加项目数据源&gt;选择数据库&gt;选择数据集&gt;选择连接&gt;选择要显示的表</em> </strong>。(使用相同的方法选择ComboBox的数据源)</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oz"><img src="../Images/ce1cac25d39ebae9f0af45307f749be3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hq2DVxUQB4RAfiS7CiNfAg.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">组合框任务选择</figcaption></figure><h2 id="8c23" class="mx mg in bd mh my od dn ml na oe dp mp lc of nd mr lg og nf mt lk oh nh mv ni bi translated">步骤4:查找、保存、更新、删除和清除所有按钮功能</h2><p id="be1a" class="pw-post-body-paragraph kt ku in kv b kw nj jo ky kz nk jr lb lc nl le lf lg nm li lj lk nn lm ln lo ig bi translated">最后一步是编写查找、保存、更新、删除和清除所有按钮函数。实际上，这很简单，我们需要在UI模式下双击按钮，功能就会自动为我们创建。功能体是最关键的部分。这里我们需要写实际的逻辑。</p><p id="1e21" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">查找函数体:</strong></p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="pa pb l"/></div></figure><p id="204b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">保存函数体:</strong></p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="pa pb l"/></div></figure><p id="943a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">更新函数体:</strong></p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="pa pb l"/></div></figure><p id="10d0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">删除函数体:</strong></p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="pa pb l"/></div></figure><p id="28ed" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io"> ClearAll函数体:</strong></p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="pa pb l"/></div></figure><h1 id="7f49" class="mf mg in bd mh mi mj mk ml mm mn mo mp jt mq ju mr jw ms jx mt jz mu ka mv mw bi translated">总结:</h1><p id="9f97" class="pw-post-body-paragraph kt ku in kv b kw nj jo ky kz nk jr lb lc nl le lf lg nm li lj lk nn lm ln lo ig bi translated">在我的C#系列的第一篇文章中，我们讨论了如何使用MsSQL数据库执行简单的CRUD操作(使用存储过程)。在未来，我希望讨论实体框架来链接查询、变更跟踪和更新。最重要的是，这只是为了学习的目的，对于现实世界的应用，我更喜欢。网芯因其<a class="ae ks" href="https://stackoverflow.com/questions/289565/what-is-lts-long-term-support" rel="noopener ugc nofollow" target="_blank">长期支持</a>。如果您有任何建议，请随时在下面留言。</p><div class="pc pd gp gr pe pf"><a href="https://drive.google.com/file/d/1OPXezkpXdmxWdiTuBuXZCxOC76AkbFdv/view?usp=sharing" rel="noopener  ugc nofollow" target="_blank"><div class="pg ab fo"><div class="ph ab pi cl cj pj"><h2 class="bd io gy z fp pk fr fs pl fu fw im bi translated">c#。活力</h2><div class="pm l"><h3 class="bd b gy z fp pk fr fs pl fu fw dk translated">编辑描述</h3></div><div class="pn l"><p class="bd b dl z fp pk fr fs pl fu fw dk translated">drive.google.com</p></div></div></div></a></div><p id="12ce" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><a class="ae ks" href="https://drive.google.com/file/d/1OPXezkpXdmxWdiTuBuXZCxOC76AkbFdv/view?usp=sharing" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io">点击这里</strong> </a>下载项目文件。别忘了鼓掌展示一下❤️love❤️👏👏👏。感谢阅读！</p></div></div>    
</body>
</html>