<html>
<head>
<title>Power BI Desktop by steps #2 — Transforming data with Power Query</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Power BI Desktop 第 2 步—使用 Power Query 转换数据</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/power-bi-desktop-by-steps-2-transforming-data-with-power-query-b745e676b585?source=collection_archive---------11-----------------------#2022-02-23">https://blog.devgenius.io/power-bi-desktop-by-steps-2-transforming-data-with-power-query-b745e676b585?source=collection_archive---------11-----------------------#2022-02-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/987976f3bf1ed4e9632a2665fd5edbfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ldGjd6VXEhmqnTKo"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated"><a class="ae jd" href="https://unsplash.com/@kobuagency?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> KOBU 机构</a>在<a class="ae jd" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><div class=""/><p id="e5f1" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您对数据感兴趣，出于多种原因，Microsoft Power BI 是必知的工具之一。在本系列中，我想介绍 Power BI Desktop 的基本特性，以简单实用的方式导入、转换和构建对数据的洞察。</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="64ca" class="lk ll jg lg b gy lm ln l lo lp"><strong class="lg jh">· </strong><a class="ae jd" href="#1593" rel="noopener ugc nofollow"><strong class="lg jh">Intro</strong></a><strong class="lg jh"><br/>· </strong><a class="ae jd" href="#8c31" rel="noopener ugc nofollow"><strong class="lg jh">Importing data</strong></a><strong class="lg jh"><br/>· </strong><a class="ae jd" href="#d276" rel="noopener ugc nofollow"><strong class="lg jh">Power Query queries</strong></a><strong class="lg jh"><br/>  ∘ </strong><a class="ae jd" href="#311e" rel="noopener ugc nofollow"><strong class="lg jh">First transformation: column selection</strong></a><strong class="lg jh"><br/>  ∘ </strong><a class="ae jd" href="#f6fd" rel="noopener ugc nofollow"><strong class="lg jh">The essence of Power BI data transformation: built-in Vs DAX</strong></a><strong class="lg jh"><br/>  ∘ </strong><a class="ae jd" href="#9be9" rel="noopener ugc nofollow"><strong class="lg jh">Pushing transformations to Data Model</strong></a><strong class="lg jh"><br/>· </strong><a class="ae jd" href="#c06f" rel="noopener ugc nofollow"><strong class="lg jh">In a nutshell..</strong></a></span></pre><h1 id="1593" class="lq ll jg bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">介绍</h1><p id="c239" class="pw-post-body-paragraph kd ke jg kf b kg mn ki kj kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">在我的故事<a class="ae jd" rel="noopener ugc nofollow" target="_blank" href="/power-bi-desktop-by-steps-1-overview-22bf781fd8bf"><strong class="kf jh">Power BI Desktop by steps # 1—Overview</strong></a>中对 Power BI 进行了简短概述之后，我想谈谈数据转换。这是大多数数据项目的有趣之处，人类几乎无法替代，因为在这个阶段，我们开始通过简单地清理数据或应用复杂的业务规则来赋予原始数据商业意义。</p><p id="8285" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Power BI 的主要特性之一是可以将任何东西应用到非常简单到复杂的数据转换中。当我们想要生成直接的数据洞察或为其他数据流程提供信息时，这是我们始终需要应用的基本步骤。Power BI 中创建数据转换序列的组件是“Power Query”工具。</p><p id="b632" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本文的目标是通过介绍一种在 Power BI 中创建数据转换的方法来开始使用它。</p><h1 id="8c31" class="lq ll jg bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">导入数据</h1><p id="8046" class="pw-post-body-paragraph kd ke jg kf b kg mn ki kj kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">在这个故事中，我们将参考下面的数据集，你可以从<a class="ae jd" href="https://github.com/MawFerrari/SharedRepo/blob/27b4e8f80093c3c6fb4f737f980bdb2fc83dc066/Customers.csv" rel="noopener ugc nofollow" target="_blank">这里</a>下载一个 csv 文件，命名为“Customers.csv”。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/c6f67104a028904c76dc7263010a375a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*r4VhwZD8XFO8YcTqHycnkQ.png"/></div></figure><p id="c316" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们从我们的源文件导入源数据，通过点击<strong class="kf jh">获取数据</strong>按钮，浏览您的文件位置，然后点击<strong class="kf jh">加载</strong>来导入它。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mt"><img src="../Images/16a27e7b4ff0b5224aaa4cbd2981fcd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zo6qTUh9Pj1B_AS3DrvGpQ.png"/></div></div></figure><p id="a041" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们要打开电源查询，通过点击<strong class="kf jh">转换数据</strong>按钮。</p><h1 id="d276" class="lq ll jg bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated"><strong class="ak">电力查询查询</strong></h1><p id="89f5" class="pw-post-body-paragraph kd ke jg kf b kg mn ki kj kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">Power Query 将数据源视为查询。在我们的这个例子中我们导入了 Customers.csv，只是创建了一个查询" Customers "</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mu"><img src="../Images/f32915292eb4aaa9275e0f3648788e98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rDeT4ATXnghXdLCSrT6_kg.png"/></div></div></figure><p id="060a" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当然，我们可以修改查询或创建新的查询，以添加新的转换、清理数据、应用业务规则，就像您对数据库使用 SQL 一样。</p><p id="55d5" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最佳实践:确保您定义的每个查询都有一个清晰易懂的名称(例如 Customers)。如果默认名称不够明确，您可以重命名它。</p><p id="c56e" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Power Query 的每个查询都将作为一个不同的表成为我们数据模型的一部分。</p><h2 id="311e" class="lk ll jg bd lr mv mw dn lv mx my dp lz ko mz na md ks nb nc mh kw nd ne ml nf bi translated">第一个转换:列选择</h2><p id="b039" class="pw-post-body-paragraph kd ke jg kf b kg mn ki kj kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">我们的第一个转换是从源中删除我们不需要的列。在编写 SQL 查询时，这也是一个最佳实践。</p><p id="e052" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在 Power Query 中，我们可以用几种不同的方式来实现，但这里是我最喜欢的方式:在<strong class="kf jh">主页</strong>功能区下，单击按钮<strong class="kf jh">选择列</strong></p><figure class="lb lc ld le gt is gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/0613ec9de65ebffe6268e0269f734241.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*gJ29txV2rF_7HRLWW9jJWQ.png"/></div></figure><p id="a4a4" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们选择除<strong class="kf jh">客户名称</strong>列之外的所有列。</p><p id="acc9" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请注意，在右侧显示的应用步骤列表中，有一个步骤“已删除”..列”添加到前面的步骤中。您可以随时删除或修改已经创建的步骤。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/b771ce4c818fa53100eea23241e4ab0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/format:webp/1*g2uDvwzjte2FRYxNYlkYew.png"/></div></figure><h2 id="f6fd" class="lk ll jg bd lr mv mw dn lv mx my dp lz ko mz na md ks nb nc mh kw nd ne ml nf bi translated">Power BI 数据转换的本质:内置 Vs DAX</h2><p id="a599" class="pw-post-body-paragraph kd ke jg kf b kg mn ki kj kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">我们经常需要基于现有的列来转换数据，以增强信息内容并允许更复杂的分析。</p><p id="1725" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">简单的例子:我们希望根据客户的出生年份来分析客户行为，但是我们的数据源上只有客户的出生日期。</p><p id="168a" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我通常喜欢复制现有的原始列，并在新创建的列上进行数据转换。这里我们复制了生日列</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ni"><img src="../Images/e00cc920e5804c5d5ddbf99bf8367f8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Js7SRmYMBINIo8OSMyaR_Q.png"/></div></div></figure><p id="f615" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是:</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nj"><img src="../Images/0e990c92f3d4c5b17f9a7a662a137270.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qPlE1HcqE8hIYJJEklRo6Q.png"/></div></div></figure><p id="28c1" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们以一种有意义的方式重新命名它:</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/0f22472737f7c1775dfcd0cb3794a0f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:360/format:webp/1*xAe12Q0TzTCZFi-QSaq3LA.png"/></div></figure><p id="6c59" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们需要转换它的数据。在超级查询中，我们可以通过两种主要方式来完成</p><ul class=""><li id="b5de" class="nl nm jg kf b kg kh kk kl ko nn ks no kw np la nq nr ns nt bi translated">通过内置的转换</li><li id="0f51" class="nl nm jg kf b kg nu kk nv ko nw ks nx kw ny la nq nr ns nt bi translated">由达克斯</li></ul><p id="9051" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在让我们从最简单的方式开始:内置数据转换，将 DAX 留给我的系列中的其他文章。</p><p id="bbb9" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">只需右键单击我们想要处理的列，我们就可以看到多种潜在的转换。</p><p id="0377" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">根据列的数据类型，我们有不同的潜在转换</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/0c09d573819dd5c6006150dd8e9531b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/1*Aw-3FuAv5dieZSr_Mqu8Ug.png"/></div></figure><p id="8e5d" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这里，我想从数据中提取年份，所以我选择了 Year，我们开始了:我们的 birth date-Year 列不再包含完整的日期，而只包含年份。</p><p id="8a2f" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">还要注意右侧的应用步骤列表:我们有越来越多的步骤，因为我们应用到数据源的每个操作(导入源文件、选择要保留的列、复制生日列、重命名它、提取年份)都被列出，并且可以被编辑或删除。</p><p id="e321" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以便我们可以跟踪所有的转换，这在我们需要总结和记录业务规则时非常有用。</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oa"><img src="../Images/6730808fdfa913feb5b64b34475722a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2MULiUIbNEtfa9TMEuO1TQ.png"/></div></div></figure><h2 id="9be9" class="lk ll jg bd lr mv mw dn lv mx my dp lz ko mz na md ks nb nc mh kw nd ne ml nf bi translated">将转换推送到数据模型</h2><p id="826d" class="pw-post-body-paragraph kd ke jg kf b kg mn ki kj kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">一旦我们对所有全新的数据转换感到满意，我们希望将它们传播到实际的数据模型，最终将为我们的数据可视化、报告和仪表板提供信息。</p><p id="028f" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们通过点击<strong class="kf jh">关闭&amp;应用</strong>按钮来实现。简单，但做起来很重要！</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ob"><img src="../Images/e1af0c03b09939763dae5b4bf9baf20c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FwwKI7dSrRfwoGOTZSUIYg.png"/></div></div></figure><p id="58c5" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，当您转到<strong class="kf jh">数据</strong>视图时，您会注意到我们所做的所有转换实际上都是我们数据模型的一部分。</p><p id="1ca3" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf jh">数据</strong>视图:</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/27e709a026fd5e543661871a4a2ffd9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*hCVX1ovUEVu_4jKKIJA-KQ.png"/></div></figure><p id="c4e7" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf jh">型号</strong>视图:</p><figure class="lb lc ld le gt is gh gi paragraph-image"><div class="gh gi od"><img src="../Images/d210b6fcc9b8351a590df3c02ed04177.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*lkePDtY7zp5TEC9ReRa_bA.png"/></div></figure></div><div class="ab cl oe of hu og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="ij ik il im in"><h1 id="c06f" class="lq ll jg bd lr ls ol lu lv lw om ly lz ma on mc md me oo mg mh mi op mk ml mm bi translated">简单地..</h1><p id="cb06" class="pw-post-body-paragraph kd ke jg kf b kg mn ki kj kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">在这个故事中，我们讨论了您将在 Power BI 的任何数据项目中使用的两个概念:导入和转换数据。我们只使用了数百种可用的内置转换中的一种，将最强大的“DAX”转换留给了本系列的其他故事。这里的想法只是介绍我们如何将业务逻辑应用于原始数据源。</p><p id="da16" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢阅读。</p><p id="df5f" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae jd" href="http://eepurl.com/humfIH" rel="noopener ugc nofollow" target="_blank">随时订阅我的<strong class="kf jh">《分享数据知识》</strong>简讯<strong class="kf jh">。</strong> </a></p><figure class="lb lc ld le gt is gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/97360d2ffc129b1d1bc250cf0ff4a0eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:402/format:webp/0*DRkwUclmr8a4O85W.png"/></div></figure><p id="31e1" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你想订阅《灵媒》,请随意使用我的推荐链接<a class="ae jd" href="https://medium.com/@maw-ferrari/membership" rel="noopener">https://medium.com/@maw-ferrari/membership</a>:对你来说，费用是一样的，但它间接有助于我的故事。</p></div></div>    
</body>
</html>