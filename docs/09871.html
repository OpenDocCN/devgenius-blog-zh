<html>
<head>
<title>Uninstalling MongoDB on Ubuntu: Going in circles? Use dpkg!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 Ubuntu 上卸载 MongoDB:兜圈子？用 dpkg！</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/uninstalling-mongodb-on-ubuntu-going-in-circles-use-dpkg-732a93a31f0f?source=collection_archive---------5-----------------------#2022-09-19">https://blog.devgenius.io/uninstalling-mongodb-on-ubuntu-going-in-circles-use-dpkg-732a93a31f0f?source=collection_archive---------5-----------------------#2022-09-19</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="08a6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Tldr 使用' dpkg -l | grep mongo '列出所有软件包，然后使用' sudo dpkg -r packageName '逐个删除它们。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8a0ad06c99cc6b22e4b1e9fe4b340331.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TMZQyODnO1wrZFZK"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">鲁拜图·阿扎德在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="fd63" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">问题是</h1><p id="3f0a" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">最近，我试图安装 python 3.9，但是在我尝试的过程中，我碰到了相当不幸的未解决的依赖问题。</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="bc88" class="mh la in md b gy mi mj l mk ml">sudo apt install python3.9<br/>[sudo] password for shouv:<br/>Reading package lists... Done<br/>Building dependency tree<br/>Reading state information... Done<br/>You might want to run 'apt --fix-broken install' to correct these.<br/>The following packages have unmet dependencies:<br/> mongodb-org-database : Depends: mongodb-org-server but it is not going to be installed<br/>                        Depends: mongodb-org-mongos but it is not going to be installed<br/> mongodb-org-tools : Depends: mongodb-database-tools but it is not going to be installed<br/> python3.9 : Depends: python3.9-minimal (= 3.9.14-1+focal1) but it is not going to be installed<br/>             Depends: libpython3.9-stdlib (= 3.9.14-1+focal1) but it is not going to be installed<br/>E: Unmet dependencies. Try 'apt --fix-broken install' with no packages (or specify a solution).</span></pre><p id="bab5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">然后我想哼，apt 坏了，简单的一行修复——只需要复制并运行命令来修复坏的安装。</p><p id="49b5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">但是 Ubuntu 神有其他的计划……</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="38c1" class="mh la in md b gy mi mj l mk ml">sudo apt --fix-broken install<br/>Reading package lists... Done<br/>Building dependency tree<br/>Reading state information... Done<br/>Correcting dependencies... Done<br/>The following packages were automatically installed and are no longer required:<br/>  golang-1.13-go golang-1.13-race-detector-runtime golang-1.13-src golang-race-detector-runtime golang-src<br/>  libboost-filesystem1.71.0 libboost-iostreams1.71.0 libboost-program-options1.71.0 libgoogle-perftools4 libsnappy1v5<br/>  libtcmalloc-minimal4 libyaml-cpp0.6 mongo-tools mongodb-server-core<br/>Use 'sudo apt autoremove' to remove them.<br/>The following additional packages will be installed:<br/>  mongodb-database-tools mongodb-org-mongos mongodb-org-server<br/>The following NEW packages will be installed:<br/>  mongodb-database-tools mongodb-org-mongos mongodb-org-server<br/>0 upgraded, 3 newly installed, 0 to remove and 411 not upgraded.<br/>6 not fully installed or removed.<br/>Need to get 0 B/92.8 MB of archives.<br/>After this operation, 187 MB of additional disk space will be used.<br/>Do you want to continue? [Y/n] Y<br/>(Reading database ... 138597 files and directories currently installed.)<br/>Preparing to unpack .../mongodb-org-server_5.0.12_amd64.deb ...<br/>Unpacking mongodb-org-server (5.0.12) ...<br/>dpkg: error processing archive /var/cache/apt/archives/mongodb-org-server_5.0.12_amd64.deb (--unpack):<br/> trying to overwrite '/usr/bin/mongod', which is also in package mongodb-server-core 1:3.6.9+really3.6.8+90~g8e540c0b6d-0ubuntu5<br/>dpkg-deb: error: paste subprocess was killed by signal (Broken pipe)<br/>Preparing to unpack .../mongodb-org-mongos_5.0.12_amd64.deb ...<br/>Unpacking mongodb-org-mongos (5.0.12) ...<br/>dpkg: error processing archive /var/cache/apt/archives/mongodb-org-mongos_5.0.12_amd64.deb (--unpack):<br/> trying to overwrite '/usr/bin/mongos', which is also in package mongodb-server-core 1:3.6.9+really3.6.8+90~g8e540c0b6d-0ubuntu5<br/>dpkg-deb: error: paste subprocess was killed by signal (Broken pipe)<br/>Preparing to unpack .../mongodb-database-tools_100.6.0_amd64.deb ...<br/>Unpacking mongodb-database-tools (100.6.0) ...<br/>dpkg: error processing archive /var/cache/apt/archives/mongodb-database-tools_100.6.0_amd64.deb (--unpack):<br/> trying to overwrite '/usr/bin/bsondump', which is also in package mongo-tools 3.6.3-0ubuntu1<br/>dpkg-deb: error: paste subprocess was killed by signal (Broken pipe)<br/>Errors were encountered while processing:<br/> /var/cache/apt/archives/mongodb-org-server_5.0.12_amd64.deb<br/> /var/cache/apt/archives/mongodb-org-mongos_5.0.12_amd64.deb<br/> /var/cache/apt/archives/mongodb-database-tools_100.6.0_amd64.deb<br/>E: Sub-process /usr/bin/dpkg returned an error code (1)</span></pre><p id="359c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">所以 mongo-tools 固执的不让 bsondup 被覆盖，现在怎么办？</p><p id="e7d1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">所以我想，让我们净化吧！</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="0738" class="mh la in md b gy mi mj l mk ml">sudo apt-get autoremove --purge mongo*<br/>Reading package lists... Done<br/>Building dependency tree<br/>Reading state information... Done<br/>You might want to run 'apt --fix-broken install' to correct these.<br/>The following packages have unmet dependencies:<br/> mongodb-org-database : Depends: mongodb-org-server but it is not going to be installed<br/>                        Depends: mongodb-org-mongos but it is not going to be installed<br/> mongodb-org-tools : Depends: mongodb-database-tools but it is not going to be installed<br/>E: Unmet dependencies. Try 'apt --fix-broken install' with no packages (or specify a solution).</span></pre><p id="5bc4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你现在应该明白了。每次我试图删除/卸载/清除它给我未满足的依赖错误，并指示我修复损坏的安装。而且每次我试图修复坏掉的安装 mongo 都会保护自己不被删除。</p><p id="4115" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因此，在尝试了许多解决方案并兜了一会儿圈子后，我想尝试一下老 dkpg，它成功了！</p><h1 id="ec81" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">解决方案</h1><p id="2f14" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">所以从列出你所有的 mongo 包开始。</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="03e1" class="mh la in md b gy mi mj l mk ml">dpkg -l | grep mongo<br/>ii  mongo-tools                          3.6.3-0ubuntu1                              amd64        collection of tools for administering MongoDB servers<br/>iU  mongodb-mongosh                      1.5.0                                       amd64        MongoDB Shell CLI REPL Package<br/>iU  mongodb-org                          5.0.9                                       amd64        MongoDB open source document-oriented database system (metapackage)<br/>iU  mongodb-org-database                 5.0.9                                       amd64        MongoDB open source document-oriented database system (metapackage)<br/>iU  mongodb-org-database-tools-extra     5.0.9                                       amd64        Extra MongoDB database tools<br/>iU  mongodb-org-shell                    5.0.9                                       amd64        MongoDB shell client<br/>iU  mongodb-org-tools                    5.0.9                                       amd64        MongoDB tools<br/>rc  mongodb-server                       1:3.6.9+really3.6.8+90~g8e540c0b6d-0ubuntu5 all          object/document-oriented database (managed server package)<br/>ii  mongodb-server-core                  1:3.6.9+really3.6.8+90~g8e540c0b6d-0ubuntu5 amd64        object/document-oriented database (server binaries package)</span></pre><p id="8464" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">然后一个一个的去掉！</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="28a9" class="mh la in md b gy mi mj l mk ml">sudo dpkg -r mongodb-org<br/>(Reading database ... 138573 files and directories currently installed.)<br/>Removing mongodb-org (5.0.9) ...</span></pre><p id="da42" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">但是要注意，有些包可能依赖于另一个包——在这种情况下，您需要首先删除它所依赖的包。</p><p id="9459" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">比如我撞见了这个。</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="d214" class="mh la in md b gy mi mj l mk ml">sudo dpkg -r mongodb-mongosh<br/>dpkg: dependency problems prevent removal of mongodb-mongosh:<br/> mongodb-org depends on mongodb-mongosh; however:<br/>  Package mongodb-mongosh is to be removed.</span><span id="c030" class="mh la in md b gy mm mj l mk ml">dpkg: error processing package mongodb-mongosh (--remove):<br/> dependency problems - not removing<br/>Errors were encountered while processing:<br/> mongodb-mongosh</span></pre><p id="b25e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">所以我们需要先删除 mongodb-org，然后才能删除 mongodb-mongosh。</p><p id="9252" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">希望这有所帮助，使用 dpkg 可以很好地解决类似的问题。愿编程大神保护我们不要兜圈子(但我们都知道无论如何都会发生！).</p></div></div>    
</body>
</html>