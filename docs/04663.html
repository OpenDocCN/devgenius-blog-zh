<html>
<head>
<title>Add Charts into Our React App with Victory — Transition, Brush and Zoom</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Victory 将图表添加到我们的 React 应用程序中——过渡、笔刷和缩放</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/add-charts-into-our-react-app-with-victory-transition-brush-and-zoom-4eeaeed1431c?source=collection_archive---------8-----------------------#2021-04-16">https://blog.devgenius.io/add-charts-into-our-react-app-with-victory-transition-brush-and-zoom-4eeaeed1431c?source=collection_archive---------8-----------------------#2021-04-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/28adcd09b64a39c2092c1884e615fd57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jrMyjs8LCUGFLN2-"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">罗斯·斯奈登在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="e09f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">胜利让我们能够将图表和数据可视化添加到 React 应用程序中。</p><p id="35db" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解如何使用 Victory 将图表添加到 React 应用程序中。</p><h1 id="e8dc" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">过渡</h1><p id="3d5d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用<code class="fe me mf mg mh b">VictoryBar</code>组件设置动画的过渡效果。</p><p id="8bd9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="126a" class="mq lc iq mh b gy mr ms l mt mu">import React, { useEffect, useState } from "react";<br/>import { VictoryBar, VictoryChart } from "victory";</span><span id="9b69" class="mq lc iq mh b gy mv ms l mt mu">const random = (min, max) =&gt; Math.floor(min + Math.random() * max);</span><span id="5841" class="mq lc iq mh b gy mv ms l mt mu">const getData = () =&gt; {<br/>  const bars = random(6, 10);<br/>  return Array(bars)<br/>    .fill()<br/>    .map((_, index) =&gt; {<br/>      return {<br/>        x: index + 1,<br/>        y: random(2, 100)<br/>      };<br/>    });<br/>};</span><span id="5220" class="mq lc iq mh b gy mv ms l mt mu">export default function App() {<br/>  const [data, setData] = useState([]);<br/>  useEffect(() =&gt; {<br/>    const timer = setInterval(() =&gt; {<br/>      setData(getData());<br/>    }, 3000);<br/>    return () =&gt; clearInterval(timer);<br/>  }, []);</span><span id="5077" class="mq lc iq mh b gy mv ms l mt mu">  return (<br/>    &lt;VictoryChart domainPadding={{ x: 20 }} animate={{ duration: 500 }}&gt;<br/>      &lt;VictoryBar<br/>        data={data}<br/>        style={{<br/>          data: { fill: "tomato", width: 12 }<br/>        }}<br/>        animate={{<br/>          onExit: {<br/>            duration: 500,<br/>            before: () =&gt; ({<br/>              _y: 0,<br/>              fill: "orange",<br/>              label: "BYE"<br/>            })<br/>          }<br/>        }}<br/>      /&gt;<br/>    &lt;/VictoryChart&gt;<br/>  );<br/>}</span></pre><p id="ac34" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们为图表生成随机数据，并每 3 秒钟用新数据更新一次。</p><p id="7453" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在<code class="fe me mf mg mh b">VictoryBar</code>组件上设置了<code class="fe me mf mg mh b">animate</code>道具，为条形添加过渡效果。</p><p id="f15d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">onExit.duration</code>已经离开动画的持续时间。</p><p id="cd37" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe me mf mg mh b">fill</code>属性改变条形的颜色。</p><p id="ca21" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当条形离开屏幕时，显示<code class="fe me mf mg mh b">label</code>。</p><h1 id="8698" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">笔刷和缩放</h1><p id="a3b9" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用<code class="fe me mf mg mh b">VictoryChart</code>的<code class="fe me mf mg mh b">containerComponent</code>道具添加画笔和放大图表。</p><p id="6e84" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="09e1" class="mq lc iq mh b gy mr ms l mt mu">import React from "react";<br/>import { VictoryChart, VictoryScatter, VictoryZoomContainer } from "victory";</span><span id="c33c" class="mq lc iq mh b gy mv ms l mt mu">const random = (min, max) =&gt; Math.floor(min + Math.random() * max);</span><span id="f90c" class="mq lc iq mh b gy mv ms l mt mu">const getData = () =&gt; {<br/>  return Array(50)<br/>    .fill()<br/>    .map((index) =&gt; {<br/>      return {<br/>        x: random(1, 50),<br/>        y: random(10, 90),<br/>        size: random(8) + 3<br/>      };<br/>    });<br/>};</span><span id="ec7c" class="mq lc iq mh b gy mv ms l mt mu">export default function App() {<br/>  return (<br/>    &lt;VictoryChart<br/>      domain={{ y: [0, 100] }}<br/>      containerComponent={<br/>        &lt;VictoryZoomContainer zoomDomain={{ x: [5, 35], y: [0, 100] }} /&gt;<br/>      }<br/>    &gt;<br/>      &lt;VictoryScatter<br/>        data={getData()}<br/>        style={{<br/>          data: {<br/>            opacity: ({ datum }) =&gt; (datum.y % 5 === 0 ? 1 : 0.7),<br/>            fill: ({ datum }) =&gt; (datum.y % 5 === 0 ? "tomato" : "black")<br/>          }<br/>        }}<br/>      /&gt;<br/>    &lt;/VictoryChart&gt;<br/>  );<br/>}</span></pre><p id="d009" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将<code class="fe me mf mg mh b">containerComponent</code>设置为<code class="fe me mf mg mh b">VictoryZoomContainer</code>组件。</p><p id="23c4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">zoomDomain</code>道具允许我们使用<code class="fe me mf mg mh b">x</code>和<code class="fe me mf mg mh b">y</code>属性设置 x 轴和 y 轴的缩放级别范围。</p><p id="8aa1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还可以为画笔创建一个单独的图表:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="000e" class="mq lc iq mh b gy mr ms l mt mu">import React, { useState } from "react";<br/>import {<br/>  VictoryAxis,<br/>  VictoryBrushContainer,<br/>  VictoryChart,<br/>  VictoryLine,<br/>  VictoryZoomContainer<br/>} from "victory";</span><span id="1275" class="mq lc iq mh b gy mv ms l mt mu">export default function App() {<br/>  const [selectedDomain, setSelectedDomain] = useState();<br/>  const [zoomDomain, setZoomDomain] = useState();</span><span id="768d" class="mq lc iq mh b gy mv ms l mt mu">const handleZoom = (domain) =&gt; {<br/>    setSelectedDomain(domain);<br/>  };</span><span id="fd58" class="mq lc iq mh b gy mv ms l mt mu">const handleBrush = (domain) =&gt; {<br/>    setZoomDomain(domain);<br/>  };</span><span id="7e00" class="mq lc iq mh b gy mv ms l mt mu">return (<br/>    &lt;&gt;<br/>      &lt;VictoryChart<br/>        width={550}<br/>        height={300}<br/>        scale={{ x: "time" }}<br/>        containerComponent={<br/>          &lt;VictoryZoomContainer<br/>            responsive={false}<br/>            zoomDimension="x"<br/>            zoomDomain={zoomDomain}<br/>            onZoomDomainChange={handleZoom}<br/>          /&gt;<br/>        }<br/>      &gt;<br/>        &lt;VictoryLine<br/>          style={{<br/>            data: { stroke: "tomato" }<br/>          }}<br/>          data={[<br/>            { x: new Date(1982, 1, 1), y: 125 },<br/>            { x: new Date(1987, 1, 1), y: 257 },<br/>            { x: new Date(1993, 1, 1), y: 345 },<br/>            { x: new Date(1997, 1, 1), y: 515 },<br/>            { x: new Date(2001, 1, 1), y: 132 },<br/>            { x: new Date(2005, 1, 1), y: 305 },<br/>            { x: new Date(2011, 1, 1), y: 270 },<br/>            { x: new Date(2015, 1, 1), y: 470 }<br/>          ]}<br/>        /&gt;<br/>      &lt;/VictoryChart&gt;</span><span id="3198" class="mq lc iq mh b gy mv ms l mt mu">&lt;VictoryChart<br/>        width={550}<br/>        height={90}<br/>        scale={{ x: "time" }}<br/>        padding={{ top: 0, left: 50, right: 50, bottom: 30 }}<br/>        containerComponent={<br/>          &lt;VictoryBrushContainer<br/>            responsive={false}<br/>            brushDimension="x"<br/>            brushDomain={selectedDomain}<br/>            onBrushDomainChange={handleBrush}<br/>          /&gt;<br/>        }<br/>      &gt;<br/>        &lt;VictoryAxis<br/>          tickValues={[<br/>            new Date(1985, 1, 1),<br/>            new Date(1990, 1, 1),<br/>            new Date(1995, 1, 1),<br/>            new Date(2000, 1, 1),<br/>            new Date(2005, 1, 1),<br/>            new Date(2010, 1, 1),<br/>            new Date(2015, 1, 1)<br/>          ]}<br/>          tickFormat={(x) =&gt; new Date(x).getFullYear()}<br/>        /&gt;<br/>        &lt;VictoryLine<br/>          style={{<br/>            data: { stroke: "tomato" }<br/>          }}<br/>          data={[<br/>            { x: new Date(1982, 1, 1), y: 125 },<br/>            { x: new Date(1987, 1, 1), y: 257 },<br/>            { x: new Date(1993, 1, 1), y: 345 },<br/>            { x: new Date(1997, 1, 1), y: 515 },<br/>            { x: new Date(2001, 1, 1), y: 132 },<br/>            { x: new Date(2005, 1, 1), y: 305 },<br/>            { x: new Date(2011, 1, 1), y: 270 },<br/>            { x: new Date(2015, 1, 1), y: 470 }<br/>          ]}<br/>        /&gt;<br/>      &lt;/VictoryChart&gt;<br/>    &lt;/&gt;<br/>  );<br/>}</span></pre><p id="f559" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们通过拖动底部图形来设置<code class="fe me mf mg mh b">zoomDomain</code>和<code class="fe me mf mg mh b">selectedDomain</code>来实现这一点。</p><p id="52ea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在底部<code class="fe me mf mg mh b">VictoryChart</code>中，我们将<code class="fe me mf mg mh b">containerComponent</code>设置为<code class="fe me mf mg mh b">VictoryBrushContainer</code>。</p><p id="3461" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">brushDomain</code>设置为<code class="fe me mf mg mh b">selectedDomain</code>，</p><p id="294e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">并且将<code class="fe me mf mg mh b">onBrushDomainChange</code>设置到<code class="fe me mf mg mh b">handleBrush</code>功能来改变<code class="fe me mf mg mh b">selectedDomain</code>。</p><p id="a1c8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该位置将反映在顶部图表中。</p><p id="3b8f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有类似的代码来设置顶部图表中的<code class="fe me mf mg mh b">zoomDomain</code>。</p><p id="cf38" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">缩放反映在底部的图表中。</p><h1 id="f80d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="77dc" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用 Victory 在 React 应用程序中添加过渡、画笔和放大图表。</p></div></div>    
</body>
</html>