<html>
<head>
<title>Apache Spark with Java on Jupyter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Jupyter 上的 Apache Spark 与 Java</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/apache-spark-with-java-on-jupyter-e2a7144dbab6?source=collection_archive---------5-----------------------#2021-12-21">https://blog.devgenius.io/apache-spark-with-java-on-jupyter-e2a7144dbab6?source=collection_archive---------5-----------------------#2021-12-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="5c91" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用 Java 在 Google Colab 上运行 Apache Spark 的快速入门</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/0661358aa88fbe7ed14211cc759da4eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CHXBmrc7u_lHFYfLDMwn9g.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated"><a class="ae lb" href="https://pixabay.com/photos/welding-work-metal-tools-man-3963341/" rel="noopener ugc nofollow" target="_blank">图片来自 Pixabay </a></figcaption></figure><h1 id="5c4f" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">介绍</h1><p id="1efa" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">在以前的文章中，我展示了我们如何在<a class="ae lb" href="https://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank"> Google Colab </a>上的 Jupyter 笔记本中用 Java 编码，并使用<a class="ae lb" href="https://github.com/SpencerPark/IJava/blob/master/docs/magics.md" rel="noopener ugc nofollow" target="_blank"> Magics </a>通过 Maven 导入库。我们还尝试使用<a class="ae lb" href="https://jtablesaw.github.io/tablesaw/" rel="noopener ugc nofollow" target="_blank"> Tablesaw </a>处理数据帧，并使用<a class="ae lb" href="https://github.com/plotly" rel="noopener ugc nofollow" target="_blank"> Plotly </a>的 Java 实现创建简单的可视化。</p><ul class=""><li id="8d08" class="mf mg iq jp b jq jr ju jv jy mh kc mi kg mj kk mk ml mm mn bi translated"><a class="ae lb" href="https://medium.com/@gmsharpe/jupyter-java-and-google-colab-7a2f7fb08808" rel="noopener"> Java、Jupyter 和 Google Colab </a></li><li id="4b35" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated"><a class="ae lb" href="https://medium.com/@gmsharpe/getting-started-with-tablesaw-and-google-colab-65ef0cbe280c" rel="noopener">开始使用 Tablesaw 和 Google Colab </a></li><li id="2336" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated"><a class="ae lb" href="https://medium.com/@gmsharpe/java-jupyter-plotly-e1bbaa7f2be8" rel="noopener"> Java、Jupyter 和 Plotly </a></li></ul><p id="2fd4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我们将加载一个配置了必要依赖项的内核，以允许我们使用<a class="ae lb" href="https://spark.apache.org/docs/latest/api/java/" rel="noopener ugc nofollow" target="_blank"> Java API </a>运行<a class="ae lb" href="https://spark.apache.org/" rel="noopener ugc nofollow" target="_blank"> Apache Spark </a>。</p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><h1 id="9aa9" class="lc ld iq bd le lf na lh li lj nb ll lm ln nc lp lq lr nd lt lu lv ne lx ly lz bi translated">入门指南</h1><h2 id="40df" class="nf ld iq bd le ng nh dn li ni nj dp lm jy nk nl lq kc nm nn lu kg no np ly nq bi translated">先决条件</h2><p id="dddf" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">在完成下一部分之前，您需要熟悉在 Google Colab 上配置和安装内核的步骤，如上面介绍中链接的几篇文章所示。</p><p id="b3b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">假设你现在对如何在 Colab 上安装和配置一个 Java 内核还不太熟悉，你可以在 Google Colab 中打开这个<a class="ae lb" href="https://github.com/gmsharpe/edumore/blob/master/blank_notebook_with_java_kernel.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> Jupyter 笔记本模板</strong> </a> <strong class="jp ir"> </strong>，按照下面的说明安装包含必要的 Apache Spark 依赖项的 Java 内核。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nr"><img src="../Images/cc2d77a0f595659625b3b081c6de9656.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2qLnimMSegOt9bvfa4fOnA.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated"><a class="ae lb" href="https://upload.wikimedia.org/wikipedia/commons/thumb/7/78/Sparkler.JPG/1280px-Sparkler.JPG" rel="noopener ugc nofollow" target="_blank">图片来自 Pixabay </a></figcaption></figure><p id="ca99" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="ns"> TL/DR 本节:</em> </strong> <em class="ns">不好意思，没有捷径。您需要熟悉在 Google Colab 中配置和运行 Java 的步骤。</em></p><p id="074a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ns">当你是，你可以从这个</em> <a class="ae lb" href="https://github.com/gmsharpe/edumore/blob/master/blank_notebook_with_java_kernel.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="ns"> Jupyter 笔记本模板</em> </strong> </a> <strong class="jp ir"> <em class="ns">开始。</em> </strong></p><h2 id="3f67" class="nf ld iq bd le ng nh dn li ni nj dp lm jy nk nl lq kc nm nn lu kg no np ly nq bi translated">安装 Java 内核</h2><p id="e264" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">最初的 IJava 笔记本只提供了入门 Java 和 Jupyter 所需的最少的库。下面的内核包括 Apache Spark，稍微简化了设置。</p><p id="a572" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将以下内容粘贴到您的<a class="ae lb" href="https://github.com/gmsharpe/edumore/blob/master/blank_notebook_with_java_kernel.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> Jupyter 笔记本模板</strong> </a>副本中。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="7ba6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这确实需要几分钟，所以要有耐心，多喝点咖啡，沉思片刻，等等。</p><p id="8f1b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">导入依赖关系</strong></p><p id="650d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完成上述工作后，我们将正式将必要的依赖项导入到我们的环境中。</p><pre class="km kn ko kp gt nv nw nx ny aw nz bi"><span id="16b1" class="nf ld iq nw b gy oa ob l oc od">import org.apache.spark.*;<br/>import org.apache.spark.sql.*;<br/>import org.apache.spark.api.java.*;<br/>import org.apache.spark.ml.linalg.*;<br/>import org.apache.spark.sql.types.*;</span></pre><p id="4311" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">初始化火花上下文</strong></p><p id="fb64" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们不会将 Spark 与笔记本电脑“分开”运行。实际上，我们将在笔记本内部启动 Spark，将其作为嵌入式进程运行。</p><p id="4aa4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将此复制到笔记本的下一个代码块中并执行。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oe"><img src="../Images/95ab8e4099579875b33dc717b6f0a0d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qKRUrFzTs-s8c0mpgDL_Kw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">在你执行代码块之后，在你的 Google Colab 笔记本中的一张图片。</figcaption></figure><p id="7cf2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">从一个简单的数据结构中创建一个数据集(Data frame)</strong></p><p id="c221" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Spark 现在有三个 API 用于表示我们在大多数其他流行上下文中可能认为的数据帧(例如熊猫)。这些是:</p><ul class=""><li id="8da7" class="mf mg iq jp b jq jr ju jv jy mh kc mi kg mj kk mk ml mm mn bi translated"><a class="ae lb" href="https://spark.apache.org/docs/latest/api/java/org/apache/spark/rdd/RDD.html" rel="noopener ugc nofollow" target="_blank">弹性分布式数据集(RDD) </a></li><li id="c668" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated"><a class="ae lb" href="https://spark.apache.org/docs/1.6.3/api/java/org/apache/spark/sql/DataFrame.html" rel="noopener ugc nofollow" target="_blank">数据帧</a></li><li id="f037" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated"><a class="ae lb" href="https://spark.apache.org/docs/latest/api/java/index.html?org/apache/spark/sql/Dataset.html" rel="noopener ugc nofollow" target="_blank">数据集&lt;T&gt;T30】</a></li></ul><p id="6d05" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe of og oh nw b">SparkSQL</code>包中的<code class="fe of og oh nw b">DataFrame</code>不再是首选的“高级”表示。相反，我们使用继任者，严格类型化的<code class="fe of og oh nw b">Dataset&lt;T&gt;</code>。</p><p id="15dc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ns">注意:你可以在</em> <a class="ae lb" href="https://databricks.com/blog/2016/07/14/a-tale-of-three-apache-spark-apis-rdds-dataframes-and-datasets.html" rel="noopener ugc nofollow" target="_blank"> <em class="ns">三个 Apache Spark APIs 的故事:RDDs vs data frames and Datasets</em></a>中了解更多关于这三个在 Apache Spark 中使用的著名 API 的信息</p><p id="824c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">启动 spark 后，我们在笔记本上要做的第一件事是创建一个数据集。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oi"><img src="../Images/f84b493104d2a369b9fb27827afdc156.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3ORGq2bnksFE1BOmeaKrXg.png"/></div></div></figure><p id="cc22" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从这里，我们可以向任何方向探索 Apache Spark 的 Java API。</p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><h2 id="6b5c" class="nf ld iq bd le ng nh dn li ni nj dp lm jy nk nl lq kc nm nn lu kg no np ly nq bi translated">矩阵</h2><p id="1c1a" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">如果您想在 Apache Spark 中探索矩阵，可以从以下内容开始。</p><pre class="km kn ko kp gt nv nw nx ny aw nz bi"><span id="78bc" class="nf ld iq nw b gy oa ob l oc od">// https://spark.apache.org/docs/latest/mllib-data-types.html#local-matrix</span><span id="0254" class="nf ld iq nw b gy oj ob l oc od">// Create a dense matrix ((1.0, 2.0), (3.0, 4.0), (5.0, 6.0))<br/>Matrix dm = Matrices.dense(3, 2, new double[] {1.0, 3.0, 5.0, 2.0, 4.0, 6.0});</span><span id="4f60" class="nf ld iq nw b gy oj ob l oc od">// Create a sparse matrix ((9.0, 0.0), (0.0, 8.0), (0.0, 6.0))<br/>Matrix sm = Matrices.sparse(3, 2, new int[] {0, 1, 3}, new int[] {0, 2, 1}, new double[] {9, 6, 8});</span></pre><p id="bb3d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们的笔记本中，我们可以首先粘贴上面的内容，然后渲染两个矩阵中的每一个以便快速显示，如下所示:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/2461a0aee1f9d028390a95334ca21c6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/1*d9X0Wd1Dkryb2n3ebmrWSw.png"/></div></figure><p id="b816" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您想进一步探索“密集”和“稀疏”矩阵，您可以从 Java API 文档本身开始:</p><ul class=""><li id="c1e4" class="mf mg iq jp b jq jr ju jv jy mh kc mi kg mj kk mk ml mm mn bi translated"><a class="ae lb" href="https://spark.apache.org/docs/latest/api/java/org/apache/spark/mllib/linalg/DenseMatrix.html" rel="noopener ugc nofollow" target="_blank"> DenseMatrix </a></li><li id="bd35" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated"><a class="ae lb" href="https://spark.apache.org/docs/latest/api/java/org/apache/spark/mllib/linalg/SparseMatrix.html" rel="noopener ugc nofollow" target="_blank">稀疏矩阵</a></li></ul><p id="7c03" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你也可以探索其他的‘矩阵’类型、运算等。在 MLib 文档的<a class="ae lb" href="https://spark.apache.org/docs/latest/mllib-data-types.html" rel="noopener ugc nofollow" target="_blank">数据类型部分下。</a></p><h1 id="4837" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">结论</h1><p id="6f3e" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">这是对使用 Google Colab 的 Java 内核运行 Apache Spark 的简要介绍。Spark 的<a class="ae lb" href="https://spark.apache.org/docs/latest/sql-programming-guide.html" rel="noopener ugc nofollow" target="_blank">文档中有大量简单的教程可以探索，包括 Java 中的例子。</a></p><p id="b141" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您想尝试创建这篇文章的笔记本的副本，您可以在下面找到它:</p><ul class=""><li id="a586" class="mf mg iq jp b jq jr ju jv jy mh kc mi kg mj kk mk ml mm mn bi translated"><a class="ae lb" href="https://gist.github.com/gmsharpe/3c49f3a79f40f90e2d6e5b5dcbda1337" rel="noopener ugc nofollow" target="_blank">完成笔记本</a></li></ul><p id="7e91" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我很期待看到你们接下来的作品。</p><p id="4449" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">所以，发挥创意</strong>，别忘了<a class="ae lb" href="https://austinkleon.com/show-your-work/" rel="noopener ugc nofollow" target="_blank">展示你的作品</a>！！</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ol"><img src="../Images/1f90ae5786b5d5c8ec4d42407b651b54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iCnoGabx0Qz_n6XB40HuQg.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated"><a class="ae lb" href="https://pixabay.com/photos/light-orange-bright-art-color-579290/" rel="noopener ugc nofollow" target="_blank">图片来自 Pixabay </a></figcaption></figure><h1 id="e686" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">作者的说明</h1><p id="1e7e" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">我很乐意听到任何探索如何在笔记本环境中使用 Java 的人的反馈(Jupyter，<a class="ae lb" href="https://zeppelin.apache.org/" rel="noopener ugc nofollow" target="_blank"> Zeppelin </a>等)。)和命令行(<a class="ae lb" href="https://docs.oracle.com/javase/9/jshell/introduction-jshell.htm" rel="noopener ugc nofollow" target="_blank"> JShell </a>)上使用 Tablesaw 等工具进行数据处理和可视化。</p><p id="1736" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">给我发消息，特别是如果你已经在 Medium 上发表了任何材料，我很乐意在将来相关的时候链接到你的内容。</p></div></div>    
</body>
</html>