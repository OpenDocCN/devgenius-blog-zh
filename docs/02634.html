<html>
<head>
<title>3 bad use cases of Javascripts forEach loop</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Javascripts forEach循环的3个糟糕用例</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/3-bad-use-cases-of-javascripts-foreach-loop-add3600a8895?source=collection_archive---------2-----------------------#2020-08-17">https://blog.devgenius.io/3-bad-use-cases-of-javascripts-foreach-loop-add3600a8895?source=collection_archive---------2-----------------------#2020-08-17</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/5c778a5a9af96be527b4f0ad906f69f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2nWcbur_jrKFxPCI"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">保罗·埃施-洛朗在<a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="d634" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">forEach循环是大多数JS开发人员工具箱的一部分。但是一定要这样吗？我会说不。我还没有发现forEach是唯一合理的解决方案的情况，我发现自己越来越少使用它。一些开发人员喜欢forEach循环的可读性，这一点很有道理，因为这是一个主观问题。我个人认为“for of”循环更具可读性。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="b9b4" class="lh li in ld b gy lj lk l ll lm"><em class="ln">elements</em>.forEach(function(<em class="ln">el</em>) {<br/> // <em class="ln">code</em><br/>});</span><span id="c16e" class="lh li in ld b gy lo lk l ll lm">for (<em class="ln">el </em>of <em class="ln">elements</em>) {<br/> // <em class="ln">code</em><br/>}</span></pre><p id="6ea1" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们来看看forEach循环不适合的情况。</p><h2 id="860a" class="lh li in bd lp lq lr dn ls lt lu dp lv kl lw lx ly kp lz ma mb kt mc md me mf bi translated">如果你想短路或者脱离回路</h2><p id="23ff" class="pw-post-body-paragraph ka kb in kc b kd mg kf kg kh mh kj kk kl mi kn ko kp mj kr ks kt mk kv kw kx ig bi translated">短路意味着终止或跳过循环的迭代。在forEach循环中，终止循环的唯一方法是引发异常。由于这一限制，您应该期望运行时与循环数组的大小线性匹配。例如，搜索元素因此不是forEach循环的好用例。相反，使用数组方法“find”、“findIndex”或可以终止的for循环。</p><h2 id="f449" class="lh li in bd lp lq lr dn ls lt lu dp lv kl lw lx ly kp lz ma mb kt mc md me mf bi translated">性能至关重要时</h2><p id="1cb8" class="pw-post-body-paragraph ka kb in kc b kd mg kf kg kh mh kj kk kl mi kn ko kp mj kr ks kt mk kv kw kx ig bi translated">在forEach循环中，我们在每次迭代中都调用回调函数。与for循环相比，这个额外的作用域会导致速度变慢。for循环使用一个初始化语句和一个在每次迭代中计算的条件。这意味着与以前相比成本更低。</p><p id="99fc" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">很难说确切的数字，因为每个平台都有所不同，但我看到了从2倍到20倍的性能差异。此外，您还可以对for和forEach进行性能改进。一个例子是“反向for循环”,其中条件不需要包括数组长度检查。</p><h2 id="6f2c" class="lh li in bd lp lq lr dn ls lt lu dp lv kl lw lx ly kp lz ma mb kt mc md me mf bi translated">当你想变换一个数组时</h2><p id="41ee" class="pw-post-body-paragraph ka kb in kc b kd mg kf kg kh mh kj kk kl mi kn ko kp mj kr ks kt mk kv kw kx ig bi translated">forEach循环在副本上工作，所以即使您试图改变元素，数组也保持不变。考虑到流行的不变性编码实践，这并不是最好的主意。</p><p id="feea" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">对于转换，您可以使用map和filter，它们都返回一个新数组。forEach循环总是返回undefined。使用forEach来达到同样的结果更加笨拙。</p><p id="c7d5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">当你想通过循环得到一个累加值时，大声喊出来减少。</p></div><div class="ab cl ml mm hr mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ig ih ii ij ik"><p id="9ba5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">希望你在阅读这篇文章时学到了一些东西，并祝你在未来的编码会议中愉快🚀<br/>如果你想说代码，在推特上找我:@barelydaniel</p></div></div>    
</body>
</html>