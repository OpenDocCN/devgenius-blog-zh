<html>
<head>
<title>Local Development Setup for MWAA with PyCharm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 PyCharm 的 MWAA 本地开发设置</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/local-development-setup-for-mwaa-with-pycharm-ea5f002aeb1?source=collection_archive---------10-----------------------#2022-02-14">https://blog.devgenius.io/local-development-setup-for-mwaa-with-pycharm-ea5f002aeb1?source=collection_archive---------10-----------------------#2022-02-14</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/50093e4c39ebc767527357f4f935be40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qGnydr8uAWEr5VuJ"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated"><a class="ae jz" href="https://unsplash.com/photos/3uqauucYhjQ" rel="noopener ugc nofollow" target="_blank">照片</a>由<a class="ae jz" href="https://unsplash.com/@jcgellidon" rel="noopener ugc nofollow" target="_blank"> JC Gellidon </a>在 Unsplash 上拍摄</figcaption></figure><p id="af3b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">通常，我的组织使用<code class="fe ky kz la lb b">airflow</code>作为我们的<code class="fe ky kz la lb b">etl</code>或<code class="fe ky kz la lb b">pipeline</code>服务。最近，我们从我们的内部<code class="fe ky kz la lb b">airflow</code>设置转移到<strong class="kc io">亚马逊管理的气流，又名 MWAA </strong>。</p><p id="3651" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在花了一些时间之后，我开始想是否有办法在本地设置 dag/operators/plugin 开发。</p><p id="cc91" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我使用 P <a class="ae jz" href="https://www.jetbrains.com/pycharm/" rel="noopener ugc nofollow" target="_blank"> ycharm </a>作为我的本地<code class="fe ky kz la lb b">python</code>相关开发 IDE。所以我决定用 P<a class="ae jz" href="https://www.jetbrains.com/pycharm/" rel="noopener ugc nofollow" target="_blank">y cham</a>来设置我的<strong class="kc io">气流 Dags </strong>开发。谢天谢地，<strong class="kc io"> MWAA </strong>已经在 GitHub 上发布了一个本地开发设置—<a class="ae jz" href="https://github.com/aws/aws-mwaa-local-runner" rel="noopener ugc nofollow" target="_blank">AWS-mwaa-local-runner</a>。</p><p id="6d07" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">下面我提供了我遵循的步骤:</p><p id="388e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">步骤 1: </strong>在本地下载存储库。我正在使用<strong class="kc io">气流 1.10.12，</strong>所以我下载了<code class="fe ky kz la lb b">1.10.12</code>标签</p><pre class="lc ld le lf gt lg lb lh li aw lj bi"><span id="8e8d" class="lk ll in lb b gy lm ln l lo lp">git clone -b v1.10.12 <a class="ae jz" href="https://github.com/aws/aws-mwaa-local-runner" rel="noopener ugc nofollow" target="_blank">https://github.com/aws/aws-mwaa-local-runner</a></span></pre><p id="678d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">步骤 2: </strong>按照'<a class="ae jz" href="https://github.com/aws/aws-mwaa-local-runner/blob/main/README.md" rel="noopener ugc nofollow" target="_blank">自述文件</a>'在本地构建 docker 映像。</p><pre class="lc ld le lf gt lg lb lh li aw lj bi"><span id="ce1f" class="lk ll in lb b gy lm ln l lo lp">./mwaa-local-env build-image</span></pre><p id="0e6b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">第三步:</strong>一旦构建了映像，我们必须执行一个快速的 hack，即将 Docker 合成文件<code class="fe ky kz la lb b">docker-compose-local.yml</code>从<code class="fe ky kz la lb b">docker</code>文件夹移动到根文件夹<code class="fe ky kz la lb b">aws-mwaa-local-runner</code>。</p><p id="a31d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">第四步:</strong>设置 Pycharm 的时间到了。在 Pycharm 中打开<code class="fe ky kz la lb b">aws-mwaa-local-runner</code>，应用以下设置。</p><figure class="lc ld le lf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lq"><img src="../Images/bfa9e0fe2753685bc92b69dfdfaf8c7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xIQsFebxY8JimQM1IZ4f8Q.jpeg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">Pycharm 项目结构设置</figcaption></figure><p id="141f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">选择<code class="fe ky kz la lb b">aws-mwaa-local-runner</code>作为<strong class="kc io">根文件夹</strong>，选择<code class="fe ky kz la lb b">dags</code>和<code class="fe ky kz la lb b">plugins</code>作为<strong class="kc io">源文件夹</strong>。</p><p id="833d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">步骤 5: </strong>为项目设置<code class="fe ky kz la lb b">Python Interpreter</code>。</p><figure class="lc ld le lf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lr"><img src="../Images/805bbddc0c3b51446388afd456cf0bc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8pSMxKAJcJajaax74rrpaQ.jpeg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">选择 Python 解释器-&gt;添加新项-&gt; Docker 编写-&gt;选择 docker-componse-local.yml 文件-&gt;服务` local-runner '</figcaption></figure><p id="3134" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">选择<strong class="kc io"> Python 解释器</strong>-&gt;-<strong class="kc io">添加新</strong>-&gt;-<strong class="kc io">Docker 撰写</strong> - &gt;选择<code class="fe ky kz la lb b"><strong class="kc io">docker-componse-local.yml</strong></code>文件- &gt;服务<code class="fe ky kz la lb b"><strong class="kc io">local-runner.</strong></code></p><p id="2aef" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">第六步:</strong>现在，我们几乎完成了所有的先决条件。开始吧。！运行<code class="fe ky kz la lb b">docker-compose-local.yml</code>文件。</p><figure class="lc ld le lf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ls"><img src="../Images/3c9da35029851c29adadfd69edfa9d28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WfOHz-6CShWB-8fdZneZVw.jpeg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">右键单击 docker-compose-local.yml 并运行</figcaption></figure><p id="3239" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这应该会启动<code class="fe ky kz la lb b">docker-compose-local.yml</code>文件中提到的容器。</p><figure class="lc ld le lf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lt"><img src="../Images/5878c9366e46b1ca51567045d9d0a5b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a_Jqd7YBOpiWVgyr-LRyJQ.jpeg"/></div></div></figure><p id="72cb" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在我们可以看到容器启动并运行:</p><figure class="lc ld le lf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lu"><img src="../Images/1d2568aabd570e16ff7cf9fc67f27dcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ucXzo57bTZwjSPPbbahtzQ.jpeg"/></div></div></figure><figure class="lc ld le lf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lv"><img src="../Images/8ce2dade86be2e3e973d635e9cf0f741.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ubgg3yTv9GxU77WkkEWUHA.jpeg"/></div></div></figure><p id="f65a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在我们可以看到我们有:</p><ol class=""><li id="48b3" class="lw lx in kc b kd ke kh ki kl ly kp lz kt ma kx mb mc md me bi translated"><strong class="kc io">气流</strong>集装箱作为<code class="fe ky kz la lb b">/aws-mwaa-local-runner-local-runner-1</code>运行</li><li id="fb5a" class="lw lx in kc b kd mf kh mg kl mh kp mi kt mj kx mb mc md me bi translated"><strong class="kc io"> Postgres </strong>集装箱作为<code class="fe ky kz la lb b">/aws-mwaa-local-runner-postgres-1</code>运行</li><li id="511e" class="lw lx in kc b kd mf kh mg kl mh kp mi kt mj kx mb mc md me bi translated">如果您选择容器右窗格，您可以看到日志和本地 URL 的<strong class="kc io">气流</strong><a class="ae jz" href="http://0.0.0.0:8080" rel="noopener ugc nofollow" target="_blank">http://0 . 0 . 0 . 0:8080</a>。</li></ol><p id="f513" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们已经在我们最喜欢的 IDE, <strong class="kc io"> PyCharm 上运行了本地<strong class="kc io">亚马逊管理气流</strong>。</strong></p><h1 id="7680" class="mk ll in bd ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng bi translated">编码快乐！！</h1></div></div>    
</body>
</html>