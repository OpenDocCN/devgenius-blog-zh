<html>
<head>
<title>I Built a Smart Irrigation System Using Only a Raspberry Pi.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我只用一个树莓做了一个智能灌溉系统。</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/i-built-a-smart-irrigation-system-using-only-a-raspberry-pi-ba29282b499e?source=collection_archive---------3-----------------------#2020-06-08">https://blog.devgenius.io/i-built-a-smart-irrigation-system-using-only-a-raspberry-pi-ba29282b499e?source=collection_archive---------3-----------------------#2020-06-08</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><figure class="im in gp gr io ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/66b18c8201ff44e1625c4f5cd9cef465.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Vws48XduMjm-IjWe"/></div></div><figcaption class="iw ix gj gh gi iy iz bd b be z dk translated">哈里森·布罗德本特在<a class="ae ja" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><div class=""/><div class=""><h2 id="b60f" class="pw-subtitle-paragraph ka jc jd bd b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dk translated">我是这样做的，你也可以这样做</h2></div><p id="71dd" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">智能灌溉系统到处都在涌现！农民们正在使用尖端技术来节省农场的时间和费用。房主正在使用智能灌溉控制器来节省每月的水费。如果你安装一个，这些系统每年可以为你节省多达10，000加仑的水。他们从哪里得到这些新奇的设备？大公司。但事实是，自己做一个并不难。我做到了，你也可以。</p><p id="3ec6" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">智能灌溉系统是郁郁葱葱的草坪和廉价水费的最终结合。<a class="ae ja" href="https://www.hydropoint.com/what-is-smart-irrigation/" rel="noopener ugc nofollow" target="_blank">智能灌溉控制器</a>根据你的花园需求调整灌溉计划。有几个因素，管制员审查和可靠的时间表的基础。这些因素包括当地天气、土壤条件和你院子里的植物种类。这种不干涉的方法是在美国房主社区获得牵引力的连胜。</p></div><div class="ab cl lo lp hr lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ig ih ii ij ik"><p id="882a" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">我的家庭使用传统的洒水系统，估计每年要用30，000加仑的水；改用智能控制器改变了生活。真的。为了制作一个，我只使用了一个<a class="ae ja" href="https://www.raspberrypi.org/" rel="noopener ugc nofollow" target="_blank">树莓酱</a>、电磁阀、一个5伏继电器和几根电线。在项目的软件方面，我混合使用了<a class="ae ja" href="https://www.python.org/" rel="noopener ugc nofollow" target="_blank"> python </a>、<a class="ae ja" href="https://www.json.org/json-en.html" rel="noopener ugc nofollow" target="_blank"> json </a>和<a class="ae ja" href="https://developer.apple.com/swift/" rel="noopener ugc nofollow" target="_blank"> swift </a>来执行重要的任务。对于天气数据，我使用了<a class="ae ja" href="https://openweathermap.org/api" rel="noopener ugc nofollow" target="_blank"> OpenWeatherMap API </a>。<a class="ae ja" href="https://stackoverflow.com/" rel="noopener ugc nofollow" target="_blank">堆栈溢出</a>是一个了不起的资源，帮助我解决了出现的任何问题。</p><p id="525b" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">连接硬件很容易。我用四根母到母的跳线电缆从树莓派连接到五伏继电器。迷你电脑的GPIO引脚使连接变得简单易行。全世界的人们都可以利用这些i/o引脚来实现他们的技术梦想。我用标准铜线创建了一个与<a class="ae ja" href="https://www.sparkfun.com/products/10288" rel="noopener ugc nofollow" target="_blank">电源</a>、<a class="ae ja" href="https://en.wikipedia.org/wiki/Solenoid_valve#:~:text=A%20solenoid%20valve%20is%20an,characteristics%20of%20fluid%20they%20control." rel="noopener ugc nofollow" target="_blank">电磁阀</a>和<a class="ae ja" href="https://en.wikipedia.org/wiki/Solid-state_relay" rel="noopener ugc nofollow" target="_blank">固态继电器</a>的三向连接。对于大多数电气工程挑战来说，稳定的电源非常重要。该系统的图表如下所示。</p><figure class="lw lx ly lz gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi lv"><img src="../Images/bcc866c71791a67ce1bb1fb9c2ca5418.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zqau9oFZF-HP1mT90TIulQ.jpeg"/></div></div></figure><p id="0252" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">在这个项目中，我花了相当多的时间弄清楚灌溉系统的软件是如何工作的。我需要解决它的多个方面。系统的这些不同部分代表了应用程序的不同层。这包括编写一个接收用户输入的应用程序，创建一个将参数传递给json文件的python脚本，以及编写一个可以读取和执行python文件参数的系统。</p><p id="b0b8" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">到目前为止，编写ios应用程序是我项目中最难的部分。我以前从未在swift中编写过代码，这种体验有点令人沮丧。UI不是我的强项，设计应用程序的过程对我来说也不自然。</p><p id="553f" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">我在设计整个系统时遇到的一个障碍是如何将数据从用swift编码的应用程序传输到raspberry pi，在那里用python分析数据。为了解决这个问题，我使用了一个名为<a class="ae ja" href="http://mqtt.org/" rel="noopener ugc nofollow" target="_blank"> MQTT </a>的消息协议。消息将从应用程序发送到所有订阅的服务器。在这种情况下，我们订阅的服务器将是raspberry pi。</p><p id="ac31" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">我使用了<a class="ae ja" href="https://cocoapods.org/pods/CocoaMQTT" rel="noopener ugc nofollow" target="_blank"> CocoaMQTT框架</a>，这样应用程序就可以在应用程序和服务器之间传输数据了。我使用podfile设置了这项服务。</p><p id="3cb7" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">逻辑和ui链接到名为viewcontroller.swift的主要ios应用程序文件。在这个文件中，我链接了ios storyboard的功能，这是一个用于设计外向应用程序的gui。我包含了向python文件所在的raspberry pi发送时间表和浇水偏好等信息的逻辑。</p><figure class="lw lx ly lz gt ip"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="20c7" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">由于我缺乏使用swift的经验，栈溢出是棘手情况下的救命稻草。<a class="ae ja" href="https://developer.apple.com/documentation/swift" rel="noopener ugc nofollow" target="_blank">苹果开发者文档</a>帮助我了解了如何使用不同的部分，如选择器、按钮和文本区。每个部分的不同属性帮助我塑造了代码，并将其转化为可用的东西。</p><p id="0388" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">在我的raspberry pi上，我安装了MQTT软件，使设备能够订阅来自ios应用程序的任何消息。我创建了一个简单的python脚本来处理传入的消息，这些消息携带了用户信息，比如他们设置的时间表和rain delay首选项。</p><figure class="lw lx ly lz gt ip"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="9862" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">我导入mqtt客户端库和gpio pin库。这有助于我将消息与系统物理方面的执行联系起来。我使用MQTT库中的预设函数来连接我的ios设备。我将消息中的信息传递到一个<a class="ae ja" href="https://www.w3schools.com/python/python_json.asp" rel="noopener ugc nofollow" target="_blank"> json字典</a>中，并将其附加到一个json文件中，如下所示:</p><figure class="lw lx ly lz gt ip"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="f30e" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">这个配置文件包含了关于rain_delay和调度的所有重要信息。这个文件是我们的主python文件读取和分析的内容，以决定它需要采取什么行动。下面是main.py:</p><figure class="lw lx ly lz gt ip"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="e409" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">Main.py文件处理来自config.json文件和PpenWeatherMap API的分析信息，执行rain_delay函数和其他进程。我选择使用openweathermap API，因为它是免费的，并且在python中使用它的文档非常简单。我所要做的就是访问pyowm库并用API密钥验证自己。这允许我使用pyowm库中的所有天气API函数。为了决定什么将参与降雨延迟功能，我使用了华盛顿州雷蒙德市的降雨预报，并设置了一个if语句，该语句将查看数据并决定最佳行动方案。</p><p id="0839" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">我的智能灌溉控制器还没做好。有这么多不同的事情需要努力。我需要你的帮助来完成这个项目。我链接了我的github库，这样你就可以查看代码，调整它，让项目变得更好。除此之外，我将链接几个帮助我开始这个项目的来源，希望它们也能指导你。</p></div><div class="ab cl lo lp hr lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ig ih ii ij ik"><p id="fbe9" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">Github资源库:【https://github.com/omshah2006/Smart-Irrigation-Controller T4】</p><p id="c238" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">带树莓pi的MQTT指南:<a class="ae ja" href="https://www.raspberrypi.org/forums/viewtopic.php?t=196010" rel="noopener ugc nofollow" target="_blank">https://www.raspberrypi.org/forums/viewtopic.php?t=196010</a></p><p id="4d7c" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">GPIO引脚连接指南:<a class="ae ja" href="https://www.youtube.com/watch?v=iF-cOppShQE" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=iF-cOppShQE</a></p><p id="93ed" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">我用过的工具和资源:Macbook Air，Xcode，Raspberry Pi，Thony IDE，Stack Overflow，W3 Schools，4根母对母gpio线，3根电线，5伏固态继电器模块，电磁阀，电源线，直流连接器(母)。</p></div><div class="ab cl lo lp hr lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ig ih ii ij ik"><p id="c0f9" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">这是我的联系方式！如果你对这个项目有任何问题，随时给我发电子邮件。</p><p id="8eb2" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">电子邮件:omshah2006@gmail.com</p></div></div>    
</body>
</html>