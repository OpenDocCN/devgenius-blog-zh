<html>
<head>
<title>Managing RAID on Linux</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 Linux 上管理 RAID</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/managing-raid-on-linux-d05dc4a482f0?source=collection_archive---------13-----------------------#2022-07-18">https://blog.devgenius.io/managing-raid-on-linux-d05dc4a482f0?source=collection_archive---------13-----------------------#2022-07-18</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="e2b2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在<a class="ae ki" rel="noopener ugc nofollow" target="_blank" href="/virtual-machine-disk-performance-testing-on-cloud-b7a7c2e62a6f">上一篇文章</a>中，我们测试了单盘的性能。然而，在现实世界中，磁盘有时会发生故障，导致磁盘丢失。<a class="ae ki" href="https://en.wikipedia.org/wiki/RAID" rel="noopener ugc nofollow" target="_blank"> RAID </a>的创建是为了使用廉价的磁盘保护数据免受磁盘故障的影响。一般有硬件 RAID 和软件 RAID。这篇文章讲的是软件 RAID。有关硬件和软件 RAID 之间的差异，请参考附录中的文章。</p><h1 id="ff7b" class="kj kk in bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">RAID 级别</h1><p id="3055" class="pw-post-body-paragraph jk jl in jm b jn lh jp jq jr li jt ju jv lj jx jy jz lk kb kc kd ll kf kg kh ig bi translated">要理解 RAID，您需要理解条带化、镜像和奇偶校验。它们在文章中有描述。</p><div class="lm ln gp gr lo lp"><a href="http://www.freeraidrecovery.com/library/what-is-raid.aspx" rel="noopener  ugc nofollow" target="_blank"><div class="lq ab fo"><div class="lr ab ls cl cj lt"><h2 class="bd io gy z fp lu fr fs lv fu fw im bi translated">RAID 基础知识-什么是 RAID？</h2><div class="lw l"><h3 class="bd b gy z fp lu fr fs lv fu fw dk translated">RAID 是独立(或廉价)磁盘冗余阵列的缩写。事实上，RAID 是结合…</h3></div><div class="lx l"><p class="bd b dl z fp lu fr fs lv fu fw dk translated">www.freeraidrecovery.com</p></div></div><div class="ly l"><div class="lz l ma mb mc ly md me lp"/></div></div></a></div><div class="lm ln gp gr lo lp"><a href="https://www.storagetutorials.com/understanding-concept-striping-mirroring-parity/" rel="noopener  ugc nofollow" target="_blank"><div class="lq ab fo"><div class="lr ab ls cl cj lt"><h2 class="bd io gy z fp lu fr fs lv fu fw im bi translated">了解条带化、镜像和奇偶校验的概念</h2><div class="lw l"><h3 class="bd b gy z fp lu fr fs lv fu fw dk translated">如果您想成为一名存储管理员或 SAN、NAS 专家，那么您应该掌握一些基本的…</h3></div><div class="lx l"><p class="bd b dl z fp lu fr fs lv fu fw dk translated">www.storagetutorials.com</p></div></div><div class="ly l"><div class="mf l ma mb mc ly md me lp"/></div></div></a></div><p id="d64b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">RAID 有不同的级别。</p><div class="lm ln gp gr lo lp"><a href="https://en.wikipedia.org/wiki/Standard_RAID_levels" rel="noopener  ugc nofollow" target="_blank"><div class="lq ab fo"><div class="lr ab ls cl cj lt"><h2 class="bd io gy z fp lu fr fs lv fu fw im bi translated">标准 RAID 级别-维基百科</h2><div class="lw l"><h3 class="bd b gy z fp lu fr fs lv fu fw dk translated">在计算机存储中，标准 RAID 级别包括一组基本的 RAID(“独立磁盘冗余阵列”或…</h3></div><div class="lx l"><p class="bd b dl z fp lu fr fs lv fu fw dk translated">en.wikipedia.org</p></div></div><div class="ly l"><div class="mg l ma mb mc ly md me lp"/></div></div></a></div><div class="lm ln gp gr lo lp"><a href="https://www.thegeekstuff.com/2010/08/raid-levels-tutorial/" rel="noopener  ugc nofollow" target="_blank"><div class="lq ab fo"><div class="lr ab ls cl cj lt"><h2 class="bd io gy z fp lu fr fs lv fu fw im bi translated">用图表解释 RAID 0、RAID 1、RAID 5、RAID 10</h2><div class="lw l"><h3 class="bd b gy z fp lu fr fs lv fu fw dk translated">RAID 代表廉价(独立)磁盘冗余阵列。在大多数情况下，你会使用…</h3></div><div class="lx l"><p class="bd b dl z fp lu fr fs lv fu fw dk translated">www.thegeekstuff.com</p></div></div><div class="ly l"><div class="mh l ma mb mc ly md me lp"/></div></div></a></div><p id="0871" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">以我的经验来看，RAID 0，1，5，10 是比较常见的。如果需要容错，可以用 1，5，10。一般如果有钱，RAID 10 提供容错以及良好的读/写性能。你可以看到下面的区别。</p><div class="lm ln gp gr lo lp"><a href="https://www.dataplugs.com/en/raid-level-comparison-raid-0-raid-1-raid-5-raid-6-raid-10/" rel="noopener  ugc nofollow" target="_blank"><div class="lq ab fo"><div class="lr ab ls cl cj lt"><h2 class="bd io gy z fp lu fr fs lv fu fw im bi translated">RAID 级别比较:RAID 0、RAID 1、RAID 5、RAID 6 和 RAID 10</h2><div class="lw l"><h3 class="bd b gy z fp lu fr fs lv fu fw dk translated">在之前的文章中，我们已经讨论了硬件 RAID 和软件 RAID 的区别。我们将比较…</h3></div><div class="lx l"><p class="bd b dl z fp lu fr fs lv fu fw dk translated">www.dataplugs.com</p></div></div><div class="ly l"><div class="mi l ma mb mc ly md me lp"/></div></div></a></div><div class="lm ln gp gr lo lp"><a href="https://techgenix.com/raid-10-vs-raid-5/" rel="noopener  ugc nofollow" target="_blank"><div class="lq ab fo"><div class="lr ab ls cl cj lt"><h2 class="bd io gy z fp lu fr fs lv fu fw im bi translated">RAID 10 与 RAID 5:何时使用每个级别，为什么</h2><div class="lw l"><h3 class="bd b gy z fp lu fr fs lv fu fw dk translated">RAID 是一种技术，它通过预先确定的配置或级别将不同形式的磁盘阵列组合在一起，以…</h3></div><div class="lx l"><p class="bd b dl z fp lu fr fs lv fu fw dk translated">techgenix.com</p></div></div><div class="ly l"><div class="mj l ma mb mc ly md me lp"/></div></div></a></div><p id="fe5c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在 Linux 中，<a class="ae ki" href="https://raid.wiki.kernel.org/index.php/A_guide_to_mdadm" rel="noopener ugc nofollow" target="_blank"> mdadm </a>用于管理软件 RAID。接下来，我们将展示如何使用 mdadm 创建软件 RAID。</p><h1 id="9607" class="kj kk in bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">调配 Linux 虚拟机</h1><p id="3db2" class="pw-post-body-paragraph jk jl in jm b jn lh jp jq jr li jt ju jv lj jx jy jz lk kb kc kd ll kf kg kh ig bi translated">让我们在 Azure 上创建 Ubuntu VM。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="5519" class="mt kk in mp b gy mu mv l mw mx">provider "azurerm" {<br/> # The "feature" block is required for AzureRM provider 2.x.<br/> # If you are using version 1.x, the "features" block is not allowed.<br/> version = "~&gt;2.0"<br/> features {}<br/>}<br/>locals {<br/> myterraformgroup = "rg1"<br/>}</span><span id="6ce6" class="mt kk in mp b gy my mv l mw mx">resource "azurerm_virtual_network" "myterraformnetwork" {<br/> name = "myVnet"<br/> address_space = ["10.0.0.0/16"]<br/> location = "eastus"<br/> resource_group_name = local.myterraformgroup<br/>tags = {<br/> environment = "Terraform Demo"<br/> }<br/>}<br/># Bastion subnet<br/>resource "azurerm_subnet" "bastionsubnet" {<br/> name = "AzureBastionSubnet"<br/> resource_group_name = local.myterraformgroup<br/> virtual_network_name = azurerm_virtual_network.myterraformnetwork.name<br/> address_prefixes = ["10.0.200.0/27"]<br/>}<br/>resource "azurerm_public_ip" "bastionip" {<br/> name = "bastionip"<br/> location = azurerm_virtual_network.myterraformnetwork.location<br/> resource_group_name = local.myterraformgroup<br/> allocation_method = "Static"<br/> sku = "Standard"<br/>}<br/>resource "azurerm_bastion_host" "bastionhost" {<br/> name = "myvmbastion"<br/> location = azurerm_virtual_network.myterraformnetwork.location<br/> resource_group_name = local.myterraformgroup<br/>ip_configuration {<br/> name = "configuration"<br/> subnet_id = azurerm_subnet.bastionsubnet.id<br/> public_ip_address_id = azurerm_public_ip.bastionip.id<br/> }<br/>}<br/># Create worker subnet<br/>resource "azurerm_subnet" "myterraformsubnet" {<br/> name = "mySubnet"<br/> resource_group_name = local.myterraformgroup<br/> virtual_network_name = azurerm_virtual_network.myterraformnetwork.name<br/> address_prefixes = ["10.0.1.0/24"]<br/>}<br/># Create Network Security Group and rule<br/>resource "azurerm_network_security_group" "myterraformnsg" {<br/> name = "myNetworkSecurityGroup"<br/> location = "eastus"<br/> resource_group_name = local.myterraformgroup<br/>security_rule {<br/> name = "SSH"<br/> priority = 1001<br/> direction = "Inbound"<br/> access = "Allow"<br/> protocol = "Tcp"<br/> source_port_range = "*"<br/> destination_port_range = "22"<br/> source_address_prefix = "*"<br/> destination_address_prefix = "*"<br/> }<br/>tags = {<br/> environment = "Terraform Demo"<br/> }<br/>}<br/># Create network interface<br/>resource "azurerm_network_interface" "myterraformnic" {<br/> name = "myNIC"<br/> location = "eastus"<br/> resource_group_name = local.myterraformgroup<br/>ip_configuration {<br/> name = "myNicConfiguration"<br/> subnet_id = azurerm_subnet.myterraformsubnet.id<br/> private_ip_address_allocation = "Dynamic"<br/> }<br/>tags = {<br/> environment = "Terraform Demo"<br/> }<br/>}<br/># Connect the security group to the network interface<br/>resource "azurerm_network_interface_security_group_association" "example" {<br/> network_interface_id = azurerm_network_interface.myterraformnic.id<br/> network_security_group_id = azurerm_network_security_group.myterraformnsg.id<br/>}<br/># Generate random text for a unique storage account name<br/>resource "random_id" "randomId" {<br/> keepers = {<br/> # Generate a new ID only when a new resource group is defined<br/> resource_group = local.myterraformgroup<br/> }<br/>byte_length = 8<br/>}<br/># Create storage account for boot diagnostics<br/>resource "azurerm_storage_account" "mystorageaccount" {<br/> name = "diag${random_id.randomId.hex}"<br/> resource_group_name = local.myterraformgroup<br/> location = "eastus"<br/> account_tier = "Standard"<br/> account_replication_type = "LRS"<br/>tags = {<br/> environment = "Terraform Demo"<br/> }<br/>}<br/># Create (and display) an SSH key<br/>resource "tls_private_key" "example_ssh" {<br/> algorithm = "RSA"<br/> rsa_bits = 4096<br/>}<br/>output "tls_private_key" { <br/> value = nonsensitive(tls_private_key.example_ssh.private_key_pem)<br/>}<br/># Create virtual machine<br/>resource "azurerm_linux_virtual_machine" "myterraformvm" {<br/> name = "myVM"<br/> location = "eastus"<br/> resource_group_name = local.myterraformgroup<br/> network_interface_ids = [azurerm_network_interface.myterraformnic.id]<br/> size = "Standard_D4as_v5"<br/>os_disk {<br/> name = "myOsDisk"<br/> caching = "ReadWrite"<br/> storage_account_type = "Premium_LRS"<br/> }<br/>source_image_reference {<br/> publisher = "Canonical"<br/> offer = "UbuntuServer"<br/> sku = "18.04-LTS"<br/> version = "latest"<br/> }<br/>computer_name = "myvm"<br/> admin_username = "azureuser"<br/> disable_password_authentication = true<br/>admin_ssh_key {<br/> username = "azureuser"<br/> public_key = tls_private_key.example_ssh.public_key_openssh<br/> }<br/>boot_diagnostics {<br/> storage_account_uri = azurerm_storage_account.mystorageaccount.primary_blob_endpoint<br/> }<br/>tags = {<br/> environment = "Terraform Demo"<br/> }<br/>}<br/>resource "azurerm_managed_disk" "example1" {<br/> name = "myVM-disk1"<br/> location = "eastus"<br/> resource_group_name = local.myterraformgroup<br/> storage_account_type = "Premium_LRS"<br/> create_option = "Empty"<br/> disk_size_gb = 2048<br/>}<br/>resource "azurerm_virtual_machine_data_disk_attachment" "example1" {<br/> managed_disk_id = azurerm_managed_disk.example1.id<br/> virtual_machine_id = azurerm_linux_virtual_machine.myterraformvm.id<br/> lun = "10"<br/> caching = "ReadWrite"<br/>}<br/>resource "azurerm_managed_disk" "example2" {<br/> name = "myVM-disk2"<br/> location = "eastus"<br/> resource_group_name = local.myterraformgroup<br/> storage_account_type = "Premium_LRS"<br/> create_option = "Empty"<br/> disk_size_gb = 2048<br/>}<br/>resource "azurerm_virtual_machine_data_disk_attachment" "example2" {<br/> managed_disk_id = azurerm_managed_disk.example2.id<br/> virtual_machine_id = azurerm_linux_virtual_machine.myterraformvm.id<br/> lun = "20"<br/> caching = "ReadWrite"<br/>}</span></pre><h1 id="3fc4" class="kj kk in bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">管理磁盘和 RAID</h1><p id="84c3" class="pw-post-body-paragraph jk jl in jm b jn lh jp jq jr li jt ju jv lj jx jy jz lk kb kc kd ll kf kg kh ig bi translated">我们创建了 2 个 2TB 磁盘，lsblk 显示了以下结果(2 个磁盘以粗体显示)。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="c4dd" class="mt kk in mp b gy mu mv l mw mx">NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT<br/>sda 8:0 0 30G 0 disk <br/>├─sda1 8:1 0 29.9G 0 part /<br/>├─sda14 8:14 0 4M 0 part <br/>└─sda15 8:15 0 106M 0 part /boot/efi<br/><strong class="mp io">sdb 8:16 0 2T 0 disk <br/>sdc 8:32 0 2T 0 disk </strong><br/>sr0 11:0 1 628K 0 rom</span></pre><h2 id="9542" class="mt kk in bd kl mz na dn kp nb nc dp kt jv nd ne kx jz nf ng lb kd nh ni lf nj bi translated">安装 mdadm</h2><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="7c91" class="mt kk in mp b gy mu mv l mw mx">sudo apt update -y<br/>sudo apt install mdadm</span></pre><p id="1178" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">下面的文章对 mdadm 有详细的解释。</p><div class="lm ln gp gr lo lp"><a href="https://www.digitalocean.com/community/tutorials/how-to-create-raid-arrays-with-mdadm-on-ubuntu-16-04" rel="noopener  ugc nofollow" target="_blank"><div class="lq ab fo"><div class="lr ab ls cl cj lt"><h2 class="bd io gy z fp lu fr fs lv fu fw im bi translated">如何在 Ubuntu 16.04 | DigitalOcean 上使用 mdadm 创建 RAID 阵列</h2><div class="lw l"><h3 class="bd b gy z fp lu fr fs lv fu fw dk translated">mdadm 实用程序可用于使用 Linux 的软件 RAID 功能创建和管理存储阵列…</h3></div><div class="lx l"><p class="bd b dl z fp lu fr fs lv fu fw dk translated">www.digitalocean.com</p></div></div><div class="ly l"><div class="nk l ma mb mc ly md me lp"/></div></div></a></div><div class="lm ln gp gr lo lp"><a href="https://manpages.ubuntu.com/manpages/xenial/man8/mdadm.8.html" rel="noopener  ugc nofollow" target="_blank"><div class="lq ab fo"><div class="lr ab ls cl cj lt"><h2 class="bd io gy z fp lu fr fs lv fu fw im bi translated">Ubuntu 联机帮助页:mdadm -管理 MD 设备，也称为 Linux 软件 RAID</h2><div class="lw l"><h3 class="bd b gy z fp lu fr fs lv fu fw dk translated">RAID 设备是从两个或更多真实块设备创建的虚拟设备。这允许多个设备(通常…</h3></div><div class="lx l"><p class="bd b dl z fp lu fr fs lv fu fw dk translated">manpages.ubuntu.com</p></div></div></div></a></div><p id="a190" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="nl">注意:数组一旦创建就可以使用。不需要等待初始重新同步完成。</em></p><p id="fbb2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">mdadm create raid 命令非常简单:指定 raid 设备、raid 级别、磁盘数量，并指定磁盘列表。</p><h2 id="2c89" class="mt kk in bd kl mz na dn kp nb nc dp kt jv nd ne kx jz nf ng lb kd nh ni lf nj bi translated">RAID 1</h2><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="3cf4" class="mt kk in mp b gy mu mv l mw mx"># create raid 1<br/>sudo mdadm — create — verbose /dev/md1 — level=1 — raid-devices=2 /dev/sdb /dev/sdc</span></pre><p id="0acf" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">使用/proc/mdstat 进行监视</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="d8a3" class="mt kk in mp b gy mu mv l mw mx"># monitor<br/>cat /proc/mdstat</span></pre><p id="c408" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">结果</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="ceb3" class="mt kk in mp b gy mu mv l mw mx">Personalities : [linear] [multipath] [raid0] [raid1] [raid6] [raid5] [raid4] [raid10] <br/>md1 : active raid1 sdc[1] sdb[0]<br/> 2147351552 blocks super 1.2 [2/2] [UU]<br/> [&gt;………………..] resync = 0.6% (14161664/2147351552) finish=223.1min speed=159297K/sec<br/> bitmap: 16/16 pages [64KB], 65536KB chunk</span><span id="88ba" class="mt kk in mp b gy my mv l mw mx">unused devices: &lt;none&gt;</span><span id="49ac" class="mt kk in mp b gy my mv l mw mx">Progress is 0.6%</span></pre><p id="9251" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">使用 mdadm 监控</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="76cb" class="mt kk in mp b gy mu mv l mw mx">sudo mdadm — detail /dev/md1</span></pre><p id="f35d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">结果。您可以看到它显示了重新同步状态和 RAID 底层磁盘</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="9420" class="mt kk in mp b gy mu mv l mw mx">/dev/md1:<br/> Version : 1.2<br/> Creation Time : Wed Jul 13 16:18:50 2022<br/> Raid Level : raid1<br/> Array Size : 2147351552 (2047.87 GiB 2198.89 GB)<br/> Used Dev Size : 2147351552 (2047.87 GiB 2198.89 GB)<br/> Raid Devices : 2<br/> Total Devices : 2<br/> Persistence : Superblock is persistent</span><span id="682c" class="mt kk in mp b gy my mv l mw mx">Intent Bitmap : Internal</span><span id="b130" class="mt kk in mp b gy my mv l mw mx">Update Time : Wed Jul 13 16:23:06 2022<br/> State : clean, resyncing <br/> Active Devices : 2<br/> Working Devices : 2<br/> Failed Devices : 0<br/> Spare Devices : 0</span><span id="547d" class="mt kk in mp b gy my mv l mw mx">Consistency Policy : bitmap</span><span id="6e00" class="mt kk in mp b gy my mv l mw mx"><em class="nl">Resync Status : 1% complete</em></span><span id="3799" class="mt kk in mp b gy my mv l mw mx">Name : myvm:1 (local to host myvm)<br/> UUID : 4a5bacfc:311c2ef7:c31657c1:e2b3ac18<br/> Events : 51</span><span id="eea0" class="mt kk in mp b gy my mv l mw mx">Number Major Minor RaidDevice State<br/><em class="nl"> 0 8 16 0 active sync /dev/sdb<br/> 1 8 32 1 active sync /dev/sdc</em></span></pre><p id="2d47" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">创建文件系统</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="ce50" class="mt kk in mp b gy mu mv l mw mx">sudo mkfs.xfs /dev/md1</span></pre><p id="ea21" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">lsblk 结果</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="bd37" class="mt kk in mp b gy mu mv l mw mx">NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT<br/>sda 8:0 0 30G 0 disk <br/>├─sda1 8:1 0 29.9G 0 part /<br/>├─sda14 8:14 0 4M 0 part <br/>└─sda15 8:15 0 106M 0 part /boot/efi<br/>sdb 8:16 0 2T 0 disk <br/>└─md1 9:1 0 2T 0 raid1 <br/>sdc 8:32 0 2T 0 disk <br/>└─md1 9:1 0 2T 0 raid1 <br/>sr0 11:0 1 628K 0 rom</span></pre><p id="6418" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">装载 RAID</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="0f2f" class="mt kk in mp b gy mu mv l mw mx">sudo mkdir /mnt/md1<br/>sudo mount /dev/md1 /mnt/md1</span></pre><p id="0b2f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在当你跑的时候</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="8a19" class="mt kk in mp b gy mu mv l mw mx">df -h</span></pre><p id="f432" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你会看到 RAID 挂载。因为镜像使用一个磁盘作为镜像，所以实际可用空间只有 1 个磁盘</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="faff" class="mt kk in mp b gy mu mv l mw mx">Filesystem Size Used Avail Use% Mounted on<br/>udev 7.8G 0 7.8G 0% /dev<br/>tmpfs 1.6G 704K 1.6G 1% /run<br/>/dev/sda1 29G 1.6G 28G 6% /<br/>tmpfs 7.9G 0 7.9G 0% /dev/shm<br/>tmpfs 5.0M 0 5.0M 0% /run/lock<br/>tmpfs 7.9G 0 7.9G 0% /sys/fs/cgroup<br/>/dev/sda15 105M 4.4M 100M 5% /boot/efi<br/>tmpfs 1.6G 0 1.6G 0% /run/user/1000<br/><strong class="mp io">/dev/md1 2.0T 2.1G 2.0T 1% /mnt/md1</strong></span></pre><h2 id="c8d6" class="mt kk in bd kl mz na dn kp nb nc dp kt jv nd ne kx jz nf ng lb kd nh ni lf nj bi translated">RAID 0</h2><p id="d2e3" class="pw-post-body-paragraph jk jl in jm b jn lh jp jq jr li jt ju jv lj jx jy jz lk kb kc kd ll kf kg kh ig bi translated">RAID 0 是条带化的，因此可用磁盘空间等于底层磁盘的总磁盘空间。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="8175" class="mt kk in mp b gy mu mv l mw mx">sudo mdadm — create — verbose /dev/md0 — level=0 — raid-devices=2 /dev/sdb /dev/sdc</span><span id="0dc4" class="mt kk in mp b gy my mv l mw mx"># make fielsystem<br/>sudo mkfs.xfs -f /dev/md0</span></pre><p id="7186" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">lsblk 结果</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="df8c" class="mt kk in mp b gy mu mv l mw mx">NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT<br/>sda 8:0 0 30G 0 disk <br/>├─sda1 8:1 0 29.9G 0 part /<br/>├─sda14 8:14 0 4M 0 part <br/>└─sda15 8:15 0 106M 0 part /boot/efi<br/>sdb 8:16 0 2T 0 disk <br/>└─md0 9:0 0 4T 0 raid0 <br/>sdc 8:32 0 2T 0 disk <br/>└─md0 9:0 0 4T 0 raid0 <br/>sr0 11:0 1 628K 0 rom</span></pre><p id="09b6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">增加</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="b7b0" class="mt kk in mp b gy mu mv l mw mx">sudo mkdir /mnt/md0<br/>sudo mount /dev/md0 /mnt/md0</span></pre><p id="99e6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">文件系统磁盘空间</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="bc70" class="mt kk in mp b gy mu mv l mw mx"># df -h<br/>Filesystem Size Used Avail Use% Mounted on<br/>udev 7.8G 0 7.8G 0% /dev<br/>tmpfs 1.6G 704K 1.6G 1% /run<br/>/dev/sda1 29G 1.6G 28G 6% /<br/>tmpfs 7.9G 0 7.9G 0% /dev/shm<br/>tmpfs 5.0M 0 5.0M 0% /run/lock<br/>tmpfs 7.9G 0 7.9G 0% /sys/fs/cgroup<br/>/dev/sda15 105M 4.4M 100M 5% /boot/efi<br/>tmpfs 1.6G 0 1.6G 0% /run/user/1000<br/><strong class="mp io">/dev/md0 4.0T 4.2G 4.0T 1% /mnt/md0</strong></span></pre><h2 id="f927" class="mt kk in bd kl mz na dn kp nb nc dp kt jv nd ne kx jz nf ng lb kd nh ni lf nj bi translated">其他 mdadm 命令</h2><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="e534" class="mt kk in mp b gy mu mv l mw mx">sudo mdadm — stop /dev/md1<br/>sudo mdadm — remove /dev/md1</span></pre><p id="5580" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果您需要自动化 mdadm 脚本，如果您 mdadm —停止并 mdadm —再次创建，您将看到“&lt;&gt;似乎是 raid 阵列的一部分，继续创建阵列”，有趣的是，mdadm 没有强制或静默继续的标志，这里有一个智能的<a class="ae ki" href="https://stackoverflow.com/questions/8707156/scripting-mdadm-when-a-component-device-may-contain-ext2-file-system-already" rel="noopener ugc nofollow" target="_blank">文章</a>来解决这个问题。</p><h1 id="5176" class="kj kk in bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">附录</h1><p id="b8ee" class="pw-post-body-paragraph jk jl in jm b jn lh jp jq jr li jt ju jv lj jx jy jz lk kb kc kd ll kf kg kh ig bi translated">硬件 RAID 与软件 RAID</p><div class="lm ln gp gr lo lp"><a href="https://www.geeksforgeeks.org/difference-between-hardware-raid-vs-software-raid/" rel="noopener  ugc nofollow" target="_blank"><div class="lq ab fo"><div class="lr ab ls cl cj lt"><h2 class="bd io gy z fp lu fr fs lv fu fw im bi translated">硬件 RAID 与软件 RAID 的区别</h2><div class="lw l"><h3 class="bd b gy z fp lu fr fs lv fu fw dk translated">独立磁盘冗余阵列(RAID)是一种虚拟磁盘技术，它将多个物理驱动器组合成一个…</h3></div><div class="lx l"><p class="bd b dl z fp lu fr fs lv fu fw dk translated">www.geeksforgeeks.org</p></div></div><div class="ly l"><div class="nm l ma mb mc ly md me lp"/></div></div></a></div><div class="lm ln gp gr lo lp"><a href="https://web.mit.edu/rhel-doc/5/RHEL-5-manual/Deployment_Guide-en-US/s1-raid-approaches.html" rel="noopener  ugc nofollow" target="_blank"><div class="lq ab fo"><div class="lr ab ls cl cj lt"><h2 class="bd io gy z fp lu fr fs lv fu fw im bi translated">4.3.硬件 RAID 与软件 RAID</h2><div class="lw l"><h3 class="bd b gy z fp lu fr fs lv fu fw dk translated">4.3.硬件 RAID 与软件 RAID 4.3。硬件 RAID 与软件 RAID 有两种可能的 RAID 方法…</h3></div><div class="lx l"><p class="bd b dl z fp lu fr fs lv fu fw dk translated">web.mit.edu</p></div></div></div></a></div><div class="lm ln gp gr lo lp"><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/5/html/installation_guide/s1-s390info-raid" rel="noopener  ugc nofollow" target="_blank"><div class="lq ab fo"><div class="lr ab ls cl cj lt"><h2 class="bd io gy z fp lu fr fs lv fu fw im bi translated">22.3.使用 mdadm 配置基于 RAID 的多路径存储 Red Hat Enterprise Linux 5 | Red…</h2><div class="lw l"><h3 class="bd b gy z fp lu fr fs lv fu fw dk translated">与组成 raidtools 包集的其他工具类似，mdadm 命令可用于执行所有必要的…</h3></div><div class="lx l"><p class="bd b dl z fp lu fr fs lv fu fw dk translated">access.redhat.com</p></div></div><div class="ly l"><div class="nn l ma mb mc ly md me lp"/></div></div></a></div></div></div>    
</body>
</html>