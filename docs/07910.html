<html>
<head>
<title>`the-devoyage/graphql-users` — Easy Users Service For Federated API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">` the-devoyage/graphql-users` —联邦 API 的简易用户服务</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/the-devoyage-graphql-users-easy-to-deploy-users-service-for-federated-api-44c4e2975ccf?source=collection_archive---------8-----------------------#2022-05-02">https://blog.devgenius.io/the-devoyage-graphql-users-easy-to-deploy-users-service-for-federated-api-44c4e2975ccf?source=collection_archive---------8-----------------------#2022-05-02</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="10c9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">大家好！感谢您的加入！</p><p id="2792" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">今天，我想分享一个知识库，您可以使用它来扩展下一个(或现有的！)您构建的 API。特别是通过向您的平台添加用户和用户成员。</p><p id="866e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">用<code class="fe ki kj kk kl b">graphql-users</code>很简单。让我向您展示这个存储库，您可以使用它来为您的 API 启用这些特性。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/ec83945a73a6b6edc73c41e3dd339860.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*emI89Lj4HQgtEtbXL0gAWQ.jpeg"/></div></div></figure><h1 id="4028" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated"><code class="fe ki kj kk kl b">GraphQL Users</code> API</h1><p id="ad66" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">将<code class="fe ki kj kk kl b">the-devoyage/graphql-users</code>库与您现有的 API 一起部署，以便在您的平台中启用用户和成员特性。让我解释一下它是如何工作的。</p><h2 id="5bbc" class="mb kz in bd la mc md dn le me mf dp li jv mg mh lm jz mi mj lq kd mk ml lu mm bi translated">最底层的</h2><p id="8b6a" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">这是这个用户和成员微服务的高级概述。</p><ol class=""><li id="85bc" class="mn mo in jm b jn jo jr js jv mp jz mq kd mr kh ms mt mu mv bi translated">有人使用您现有的身份验证系统登录，并获得一个 ID。</li><li id="3ba5" class="mn mo in jm b jn mw jr mx jv my jz mz kd na kh ms mt mu mv bi translated">将帐户 id 和帐户电子邮件安全地传递给这个新用户服务，以便用户“登录”。</li><li id="7e53" class="mn mo in jm b jn mw jr mx jv my jz mz kd na kh ms mt mu mv bi translated"><code class="fe ki kj kk kl b">graphql-users</code>服务返回一个代表用户和帐户的 JWT(签名的 JSON Web 令牌)。如您所愿，使用 JWT 验证请求！</li></ol><p id="001d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">就是这样！用户登录并与帐户相关联，并且用户现在能够与该 API 提供的其他功能交互，例如:</p><ul class=""><li id="7ee3" class="mn mo in jm b jn jo jr js jv mp jz mq kd mr kh nb mt mu mv bi translated">用户可以向任何人发送和撤销成员资格，允许其他人管理他们的帐户。</li><li id="1207" class="mn mo in jm b jn mw jr mx jv my jz mz kd na kh nb mt mu mv bi translated">用户可以接受或拒绝管理其他用户帐户的邀请。</li><li id="88f5" class="mn mo in jm b jn mw jr mx jv my jz mz kd na kh nb mt mu mv bi translated">用户可以切换到邀请的帐户。</li><li id="e009" class="mn mo in jm b jn mw jr mx jv my jz mz kd na kh nb mt mu mv bi translated">角色的范围是帐户，允许用户在帐户之间维护不同的角色和权限。</li></ul><p id="81f1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这是一个灵活的系统，允许许多可能的用例。</p><p id="845c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">想了解更多的功能和更少的技术？</p><div class="nc nd gp gr ne nf"><a href="https://thedevoyage.gumroad.com/p/bring-a-website-to-life-for-your-business-idea" rel="noopener  ugc nofollow" target="_blank"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd io gy z fp nk fr fs nl fu fw im bi translated">向您的 Web 应用程序添加用户和成员</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">欢迎来到 Devoayge，一个提供 web 开发产品和服务的地方！今天，我想分享一个代码起源…</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">thedevoyage.gumroad.com</p></div></div><div class="no l"><div class="np l nq nr ns no nt kw nf"/></div></div></a></div><h1 id="17b5" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">入门指南</h1><p id="091b" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">使用这个存储库就像将它与任何现有的 API 一起旋转一样简单——只需要一些配置。</p><h2 id="fdf5" class="mb kz in bd la mc md dn le me mf dp li jv mg mh lm jz mi mj lq kd mk ml lu mm bi translated">下载源代码</h2><p id="8d2b" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">这是一个开源项目，有两个选项可以满足您的需求。</p><p id="65dc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> GNU GPL 许可</strong></p><p id="f1e0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">对于免费和开源项目，请查看资源库。</p><div class="nc nd gp gr ne nf"><a href="https://github.com/The-Devoyage/graphql-users" rel="noopener  ugc nofollow" target="_blank"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd io gy z fp nk fr fs nl fu fw im bi translated">GitHub-The-devo yage/graph QL-users:即装即用的用户微服务…</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">用户微服务是现成的用户身份验证和数据存储服务，也可以用作…</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">github.com</p></div></div><div class="no l"><div class="nu l nq nr ns no nt kw nf"/></div></div></a></div><p id="1205" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">麻省理工学院许可证</strong></p><p id="2cc2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你需要更多的灵活性来私下使用它，你可以在这里购买 MIT 许可下的最新版本！</p><div class="nc nd gp gr ne nf"><a href="https://thedevoyage.gumroad.com/l/graphql-users" rel="noopener  ugc nofollow" target="_blank"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd io gy z fp nk fr fs nl fu fw im bi translated">GraphQL 用户-用户和成员 API</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">GraphQL 用户 GraphQL 用户服务是 Devoyage 的 Code Genesis 产品之一——预构建的、功能齐全的……</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">thedevoyage.gumroad.com</p></div></div><div class="no l"><div class="nv l nq nr ns no nt kw nf"/></div></div></a></div><h2 id="2ecd" class="mb kz in bd la mc md dn le me mf dp li jv mg mh lm jz mi mj lq kd mk ml lu mm bi translated">环境变量</h2><p id="1cf9" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">调整环境变量以适应您的项目。</p><pre class="kn ko kp kq gt nw kl nx ny aw nz bi"><span id="e3d3" class="mb kz in kl b gy oa ob l oc od">NODE_ENV=development<br/>BACKEND_PORT=5002<br/>MONGO_URI=mongodb://sun:sun@localhost:27017/sun<br/>JWT_ENCRYPTION_KEY=abcdefg<br/>MAILER_URI=<a class="ae oe" href="http://mailer:5008/send" rel="noopener ugc nofollow" target="_blank">http://mailer:5008/send</a></span></pre><h2 id="939c" class="mb kz in bd la mc md dn le me mf dp li jv mg mh lm jz mi mj lq kd mk ml lu mm bi translated">旋转起来</h2><p id="1e5d" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">您可以使用 npm 来启动它，或者使用提供的<code class="fe ki kj kk kl b">Dockerfile</code>来启动服务。</p><pre class="kn ko kp kq gt nw kl nx ny aw nz bi"><span id="ff5f" class="mb kz in kl b gy oa ob l oc od">npm run dev</span></pre><h2 id="0f23" class="mb kz in bd la mc md dn le me mf dp li jv mg mh lm jz mi mj lq kd mk ml lu mm bi translated">告诉网关</h2><p id="2627" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">最后，确保告诉网关新用户服务的位置。</p><h1 id="b64b" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">它是如何工作的</h1><p id="faaa" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">现在您已经将服务安装在现有 API 的旁边，您可以立即开始使用它。</p><h2 id="df8f" class="mb kz in bd la mc md dn le me mf dp li jv mg mh lm jz mi mj lq kd mk ml lu mm bi translated">帐户 ID +电子邮件</h2><p id="83e6" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">如上所述，这个微服务被设计成紧挨着你现有的 API 使用。在您的用户通过身份验证后，保留相关的“帐户”id。它可以是任何唯一的 Mongo ObjectId 来表示帐户。</p><p id="3b77" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果您没有生成唯一帐户 id 的认证系统，请查看<a class="ae oe" href="https://github.com/The-Devoyage/graphql-accounts" rel="noopener ugc nofollow" target="_blank"> graphql-accounts！</a></p><h2 id="0a92" class="mb kz in bd la mc md dn le me mf dp li jv mg mh lm jz mi mj lq kd mk ml lu mm bi translated">登录用户</h2><p id="056e" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">是时候第一次使用新用户服务了。</p><p id="dd9c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要将帐户 id 和电子邮件传递给用户服务，您需要将它们附加到一个<code class="fe ki kj kk kl b">context</code>头。建议在验证帐户后，从网关服务等服务中执行此操作。</p><pre class="kn ko kp kq gt nw kl nx ny aw nz bi"><span id="40a4" class="mb kz in kl b gy oa ob l oc od">JSON.stringify({<br/>  auth: {<br/>    account: { _id: OBJECT_ID; email: ACCOUNT_EMAIL },<br/>    isAuth: boolean,<br/>  }<br/>});</span></pre><h2 id="1997" class="mb kz in bd la mc md dn le me mf dp li jv mg mh lm jz mi mj lq kd mk ml lu mm bi translated">JWT 代币</h2><p id="269f" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">登录操作会返回一个签名的 JWT 令牌，允许您将帐户与用户相关联。您可以通过环境变量向<code class="fe ki kj kk kl b">graphql-users</code>服务提供加密密钥，允许您在现有的 API 中验证 JWT。</p><h2 id="2004" class="mb kz in bd la mc md dn le me mf dp li jv mg mh lm jz mi mj lq kd mk ml lu mm bi translated">其余的</h2><p id="d0f2" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">是的，还有很多——用户成员资格、邀请、角色……查看存储库的自述文件以了解更多信息。</p><h1 id="5568" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">仓库</h1><p id="a3a6" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">嘿，谢谢你检查这个用户服务！目的是您可以直接从存储库中使用它作为您的下一个用户管理平台——或者使用它作为您的下一个 API 的定制修改的起点。</p><p id="fce8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae oe" href="https://github.com/The-Devoyage/graphql-users" rel="noopener ugc nofollow" target="_blank">查看存储库</a>——或者— <a class="ae oe" href="https://thedevoyage.gumroad.com/l/graphql-users" rel="noopener ugc nofollow" target="_blank">展示你的爱</a>如果你发现它有帮助/结束使用它！</p></div><div class="ab cl of og hr oh" role="separator"><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok"/></div><div class="ig ih ii ij ik"><p id="2278" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">好了，这就是今天的全部时间，但是请继续关注关于这个库和其他项目的更深入的帖子，它们可以帮助您启动您的下一个开发周期，</p><p id="12b9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">谢谢你，尼克—</p></div></div>    
</body>
</html>