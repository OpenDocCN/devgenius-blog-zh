<html>
<head>
<title>Code Smell 103 — Double Encapsulation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">代码气味 103 —双重封装</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/code-smell-103-double-encapsulation-32c5d0978988?source=collection_archive---------3-----------------------#2021-11-19">https://blog.devgenius.io/code-smell-103-double-encapsulation-32c5d0978988?source=collection_archive---------3-----------------------#2021-11-19</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="1ecf" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">调用我们自己的访问器方法似乎是一个很好的封装想法。但事实并非如此。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/e433e35e72ffa30220ed47330a64810d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CzUQTm1cPX4pIpzpHPiq7Q.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">雷·轩尼诗在<a class="ae ks" href="https://unsplash.com/s/photos/double" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><blockquote class="kt ku kv"><p id="b018" class="kw kx ky kz b la lb jo lc ld le jr lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">TL；DR:不要使用 setters 和 getters，即使是私人使用</p></blockquote><h1 id="1387" class="lt lu in bd lv lw lx ly lz ma mb mc md jt me ju mf jw mg jx mh jz mi ka mj mk bi translated">问题</h1><ul class=""><li id="bd6c" class="ml mm in kz b la mn ld mo mp mq mr ms mt mu ls mv mw mx my bi translated">安装员</li><li id="38c5" class="ml mm in kz b la mz ld na mp nb mr nc mt nd ls mv mw mx my bi translated">吸气剂</li><li id="bd56" class="ml mm in kz b la mz ld na mp nb mr nc mt nd ls mv mw mx my bi translated">公开私有属性</li></ul><h1 id="5d9b" class="lt lu in bd lv lw lx ly lz ma mb mc md jt me ju mf jw mg jx mh jz mi ka mj mk bi translated">解决方法</h1><ol class=""><li id="0e2c" class="ml mm in kz b la mn ld mo mp mq mr ms mt mu ls ne mw mx my bi translated">拆下 setters</li></ol><div class="nf ng gp gr nh ni"><a rel="noopener  ugc nofollow" target="_blank" href="/refactoring-001-remove-setters-e5acdf60462c"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd io gy z fp nn fr fs no fu fw im bi translated">重构 001 —移除设置器</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">Setters 违反了不变性并增加了意外耦合</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">blog.devgenius.io</p></div></div><div class="nr l"><div class="ns l nt nu nv nr nw km ni"/></div></div></a></div><p id="9fd9" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mp lh li lj mr ll lm ln mt lp lq lr ls ig bi translated">2.移除吸气剂</p><p id="f25b" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mp lh li lj mr ll lm ln mt lp lq lr ls ig bi translated">3.保护你的属性</p><h1 id="f7ec" class="lt lu in bd lv lw lx ly lz ma mb mc md jt me ju mf jw mg jx mh jz mi ka mj mk bi translated">语境</h1><p id="1251" class="pw-post-body-paragraph kw kx in kz b la mn jo lc ld mo jr lf mp nx li lj mr ny lm ln mt nz lq lr ls ig bi translated">使用双重封装是 90 年代的标准程序。</p><p id="293a" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mp lh li lj mr ll lm ln mt lp lq lr ls ig bi translated">我们想隐藏实现细节，即使是私人使用。</p><p id="961d" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mp lh li lj mr ll lm ln mt lp lq lr ls ig bi translated">当太多的函数依赖于数据结构和偶然的实现时，这就隐藏了另一种味道。</p><p id="0a26" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mp lh li lj mr ll lm ln mt lp lq lr ls ig bi translated">例如，我们可以改变一个对象的内部表示并依赖它的外部协议。</p><p id="ba6f" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mp lh li lj mr ll lm ln mt lp lq lr ls ig bi translated">成本/收益不值得。</p><h1 id="df35" class="lt lu in bd lv lw lx ly lz ma mb mc md jt me ju mf jw mg jx mh jz mi ka mj mk bi translated">示例代码</h1><h2 id="c5e7" class="oa lu in bd lv ob oc dn lz od oe dp md mp of og mf mr oh oi mh mt oj ok mj ol bi translated">错误的</h2><pre class="kd ke kf kg gt om on oo op aw oq bi"><span id="762d" class="oa lu in on b gy or os l ot ou">contract MessageContract {<br/> string message = “Let’s trade”;<br/> <br/> function getMessage() public constant returns(string) {<br/> return message;<br/> }<br/> <br/> function setMessage(string newMessage) public {<br/> message = newMessage;<br/> }<br/> <br/> function sendMessage() public constant {<br/> this.send(this.getMessage());<br/> //We can access property but make a self call instead<br/> }<br/>}</span></pre><h1 id="9820" class="lt lu in bd lv lw lx ly lz ma mb mc md jt me ju mf jw mg jx mh jz mi ka mj mk bi translated">对吧</h1><pre class="kd ke kf kg gt om on oo op aw oq bi"><span id="3592" class="oa lu in on b gy or os l ot ou">contract MessageContract {<br/> string message = “Let’s trade”;<br/> <br/> function sendMessage() public constant {<br/> this.send(message);<br/> }<br/>}</span></pre><h1 id="c541" class="lt lu in bd lv lw lx ly lz ma mb mc md jt me ju mf jw mg jx mh jz mi ka mj mk bi translated">侦查</h1><p id="b573" class="pw-post-body-paragraph kw kx in kz b la mn jo lc ld mo jr lf mp nx li lj mr ny lm ln mt nz lq lr ls ig bi translated">[X]半自动</p><p id="8b06" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mp lh li lj mr ll lm ln mt lp lq lr ls ig bi translated">我们可以推断 getters 和 setters，并检查它们是否是从同一个对象中调用的。</p><h1 id="a2a0" class="lt lu in bd lv lw lx ly lz ma mb mc md jt me ju mf jw mg jx mh jz mi ka mj mk bi translated">标签</h1><ul class=""><li id="9c6a" class="ml mm in kz b la mn ld mo mp mq mr ms mt mu ls mv mw mx my bi translated">包装</li></ul><h1 id="1a35" class="lt lu in bd lv lw lx ly lz ma mb mc md jt me ju mf jw mg jx mh jz mi ka mj mk bi translated">结论</h1><p id="ddf1" class="pw-post-body-paragraph kw kx in kz b la mn jo lc ld mo jr lf mp nx li lj mr ny lm ln mt nz lq lr ls ig bi translated">双重封装是保护意外实现的时髦想法，但它暴露的不仅仅是受保护的。</p><h1 id="c068" class="lt lu in bd lv lw lx ly lz ma mb mc md jt me ju mf jw mg jx mh jz mi ka mj mk bi translated">关系</h1><div class="nf ng gp gr nh ni"><a rel="noopener  ugc nofollow" target="_blank" href="/code-smell-37-protected-attributes-4607260edb2d"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd io gy z fp nn fr fs no fu fw im bi translated">代码气味 37 —受保护的属性</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">受保护的属性对于封装和控制对我们属性的访问非常有用。他们可能在警告我们…</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">blog.devgenius.io</p></div></div><div class="nr l"><div class="ov l nt nu nv nr nw km ni"/></div></div></a></div><div class="nf ng gp gr nh ni"><a rel="noopener  ugc nofollow" target="_blank" href="/code-smell-28-setters-5b0e764049aa"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd io gy z fp nn fr fs no fu fw im bi translated">气味代码 28 —设定器</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">初级程序员做的第一个练习。ide、教程和高级开发人员不断教他们这种反模式。</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">blog.devgenius.io</p></div></div><div class="nr l"><div class="ow l nt nu nv nr nw km ni"/></div></div></a></div><div class="nf ng gp gr nh ni"><a rel="noopener  ugc nofollow" target="_blank" href="/code-smell-68-getters-68571a0f7fa8"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd io gy z fp nn fr fs no fu fw im bi translated">代码气味 68 —吸气剂</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">得到的东西是广泛而安全的。但这是一种非常糟糕的做法。</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">blog.devgenius.io</p></div></div><div class="nr l"><div class="ox l nt nu nv nr nw km ni"/></div></div></a></div><h1 id="5360" class="lt lu in bd lv lw lx ly lz ma mb mc md jt me ju mf jw mg jx mh jz mi ka mj mk bi translated">更多信息</h1><div class="nf ng gp gr nh ni"><a href="https://softwareengineering.stackexchange.com/questions/181567/should-the-methods-of-a-class-call-its-own-getters-and-setters" rel="noopener  ugc nofollow" target="_blank"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd io gy z fp nn fr fs no fu fw im bi translated">类的方法应该调用自己的 getters 和 setters 吗？</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">软件工程栈交换是一个为专业人士，学者和学生工作的问答网站</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">softwareengineering.stackexchange.com</p></div></div><div class="nr l"><div class="oy l nt nu nv nr nw km ni"/></div></div></a></div><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oz pa l"/></div></figure><p id="3dac" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mp lh li lj mr ll lm ln mt lp lq lr ls ig bi translated"><a class="ae ks" href="https://www.infoworld.com/article/2073723/why-getter-and-setter-methods-are-evil.html" rel="noopener ugc nofollow" target="_blank">https://www . infoworld . com/article/2073723/why-getter-and-setter-methods-are-evil . html</a></p></div><div class="ab cl pb pc hr pd" role="separator"><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg"/></div><div class="ig ih ii ij ik"><blockquote class="kt ku kv"><p id="f628" class="kw kx ky kz b la lb jo lc ld le jr lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">概括不同的概念。</p></blockquote><p id="2c68" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mp lh li lj mr ll lm ln mt lp lq lr ls ig bi translated"><em class="ky">埃里希·伽马</em></p><div class="nf ng gp gr nh ni"><a rel="noopener  ugc nofollow" target="_blank" href="/software-engineering-great-quotes-3af63cea6782"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd io gy z fp nn fr fs no fu fw im bi translated">软件工程名言</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">有时一个简短的想法可以带来惊人的想法。</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">blog.devgenius.io</p></div></div><div class="nr l"><div class="pi l nt nu nv nr nw km ni"/></div></div></a></div></div><div class="ab cl pb pc hr pd" role="separator"><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg"/></div><div class="ig ih ii ij ik"><p id="0f96" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mp lh li lj mr ll lm ln mt lp lq lr ls ig bi translated">本文是 CodeSmell 系列的一部分。</p><div class="nf ng gp gr nh ni"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-find-the-stinky-parts-of-your-code-fa8df47fc39c"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd io gy z fp nn fr fs no fu fw im bi translated">如何找到你的代码中有问题的部分</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">代码很难闻。让我们看看如何改变香味。</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">blog.devgenius.io</p></div></div><div class="nr l"><div class="pj l nt nu nv nr nw km ni"/></div></div></a></div></div></div>    
</body>
</html>