# ç‹¬ä¸€æ— äºŒçš„å¯¹è±¡çš„å•ä¾‹æ¨¡å¼

> åŸæ–‡ï¼š<https://blog.devgenius.io/singleton-pattern-for-one-of-a-kind-objects-java-a63c774d9d4?source=collection_archive---------7----------------------->

æ¬¢è¿å›åˆ°è®¾è®¡æ¨¡å¼ç³»åˆ—ï¼ğŸ‘»è¿™æ˜¯ä¸€ç»„æ–‡ç« ï¼Œæˆ‘å†³å®šå‘èµ·ä¼ æ’­ä»–ä»¬çš„çŸ¥è¯†ğŸ‘€

ä¸è¦é”™è¿‡æˆ‘åœ¨è¯¥ç³»åˆ—ä¸­çš„å…¶ä»–æ–‡ç« :

*   ç­–ç•¥æ¨¡å¼:[https://medium . com/toward sdev/strategy-pattern-for-independent-algorithms-kot Lin-70 ed 24 c 7 BD 8 b](/towardsdev/strategy-pattern-for-independent-algorithms-kotlin-70ed24c7bd8b)
*   è§‚å¯Ÿè€…æ¨¡å¼:[https://medium . com/toward sdev/observer-pattern-for-loose-coupling-kot Lin-f5ab 804609 bb](/towardsdev/observer-pattern-for-loose-coupling-kotlin-f5ab804609bb)
*   è£…é¥°è€…æ¨¡å¼:[https://medium . com/toward sdev/decorator-decorator-pattern-for-object-composition-kot Lin-7 CEC 92 cbaf 7b](/towardsdev/decorator-decorator-pattern-for-object-composition-kotlin-7cec92cbaf7b)
*   å·¥å‚æ¨¡å¼:[https://medium . com/dev-genius/factory-patternS-to-hide-instantiation-kot Lin-D5 f 01 cf 01921](https://medium.com/dev-genius/factory-patterns-to-hide-instantiation-kotlin-d5f01cf01921)

å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°ç ”ç©¶æ¨¡å¼çš„ä¸–ç•Œï¼Œè¯·ä¸è¦åå•¬è¿™æœ¬ä¹¦:[https://www . oreilly . com/library/view/head-first-design/9781492077992/](https://www.oreilly.com/library/view/head-first-design/9781492077992/)

ç»“æ„:

*   ä»‹ç»
*   é—®é¢˜
*   è®¾è®¡éµå¾ªçš„åŸåˆ™:`null` **æœ¬æ–‡ä¸­çš„**
*   é¢å¤–éƒ¨åˆ†
*   æœ€ç»ˆè§£å†³æ–¹æ¡ˆä»£ç (åœ¨æœ¬æ–‡ä¸­ï¼Œå®ƒä¸åŒäºä»¥å‰çš„ä»£ç )
*   å›¾ç”»

**å‰è¨€:ã€https://wickedlysmart.com/head-first-design-patterns/ã€‘æ­£å¦‚æˆ‘ä¸Šé¢æåˆ°çš„ï¼Œåœ¨æœ¬æ–‡ä¸­æˆ‘ä¸ä¼šä½¿ç”¨æˆ‘è‡ªå·±çš„ä»£ç ï¼Œè€Œæ˜¯æœ¬ä¹¦ä½œè€…æä¾›çš„ Java ä»£ç :ã€‚ä¸ºä»€ä¹ˆè¿™æ ·ä½ ä¼šåœ¨ articleâœŒï¸çš„ä¸»è¦éƒ¨åˆ†æ‰¾åˆ°å®ƒ**

# å•ä¸€æ¨¡å¼

## ä»‹ç»

å½“ä½ å¼€å§‹åœ¨ä¸åŒçš„ç¨‹åºä¸­ç¼–å†™è½¯ä»¶æ—¶ï¼Œä½ ä¼šå‘ç°ç›¸åŒçš„æ¨¡å¼å¯èƒ½ä¼šä»¥ç¨å¾®ä¸åŒçš„æ–¹å¼å®ç°ã€‚ä¸¾ä¾‹ï¼Ÿ

*   **Singleton** åœ¨ Java ä¸­ä½¿ç”¨`static`ï¼Œä½†åœ¨ Kotlin ä¸­å®ƒåªæ˜¯`object`ï¼Œè€Œåœ¨ Python ä¸­å®ƒåˆ©ç”¨äº†`metaclass`åŠå…¶å‘¨å›´çš„ä¸œè¥¿
*   **é€‚é…å™¨**(æ¨¡å¼å°†åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­å‡ºç°)æœ‰ä¸¤ä¸ªä¸»è¦å®ç°:å®ƒåœ¨ Java ä¸­ä½¿ç”¨*ç»„åˆ*(ç”±äºç¼ºå°‘*å¤šé‡ç»§æ‰¿*)å’Œåœ¨ Python ä¸­ä½¿ç”¨*å¤šé‡ç»§æ‰¿*(å°½ç®¡æ²¡æœ‰äººé™åˆ¶æ‚¨ä½¿ç”¨*ç»„åˆ*)

æˆ‘æƒ³å¼ºè°ƒçš„æ˜¯ï¼Œä¸åŒè¯­è¨€çš„æ¦‚å¿µæ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯å®ç°å¯èƒ½æ˜¯ varyâ˜ï¸

> è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¤§å¸ˆä»¬è¯æ˜:â€œä¸è¦æ­»è®°ç¡¬èƒŒå®ç°ï¼Œè€Œæ˜¯è¦ç†è§£è¶…è¶Šä¸€ç§è¯­è¨€çš„æ¦‚å¿µâ€

## é—®é¢˜

æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æœ‰ä¸€ä¸ªç¨‹åºï¼Œå®ƒæœ‰å¤šä¸ªçº¿ç¨‹ï¼Œç¼“å­˜å’Œç±»ä¼¼çš„ä¸œè¥¿ã€‚æˆ‘ä»¬ä¸å¸Œæœ›ä»–ä»¬äº’ç›¸æ··æ‚ã€‚

æƒ³åˆ°çš„å¯èƒ½çš„è§£å†³æ–¹æ¡ˆï¼Ÿ

*   ä½¿ç”¨`global` **å˜é‡**
*   ä½¿ç”¨`static`

è®©æˆ‘ä»¬é©¬ä¸Šå‰–æè¿™äº›ä¾‹å­:

1.  `global`ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œå› ä¸ºå®ƒä»¬é€šå¸¸åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶è¢«åˆå§‹åŒ–ã€‚å› æ­¤ï¼Œå¦‚æœä¸€ä¸ªæ˜¯**èµ„æºå¯†é›†å‹**åº”ç”¨ç¨‹åºå¯¼è‡´ä»ä¸ä½¿ç”¨å®ƒ- >æµªè´¹å®è´µçš„èµ„æºğŸ‘ğŸ¼
2.  åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå°†æ‰€æœ‰ä¸œè¥¿éƒ½å£°æ˜ä¸º`static`å¯èƒ½æ˜¯ä¸€ç§é€‰æ‹©ï¼Œä½†æ˜¯å®ƒæœ‰ä¸€ä¸ªå¾ˆå¤§çš„ç¼ºç‚¹ã€‚å“ªä¸€ä¸ªï¼Ÿä¸åˆå§‹åŒ–é¡ºåºç›¸å…³çš„ç»†å¾®é”™è¯¯ï¼Œå› æ­¤è¿‡åº¦ä½¿ç”¨`static`å¯èƒ½ä¼šå¯¼è‡´éš¾ä»¥å‘ç°çš„é—®é¢˜

`=>`ä¸ºäº†æ‹¯æ•‘æˆ‘ä»¬ï¼Œå¼€å‘äº†**å•ä¾‹æ¨¡å¼**æ¥ç¡®ä¿èº«ä»½(å”‰ï¼Œå¹¶ä¸æ€»æ˜¯è¿™æ ·ï¼Œä½†æˆ‘ä¼šåœ¨**é¢å¤–éƒ¨åˆ†**ä¸­æåˆ°å®ƒ)

å®ƒåˆ©ç”¨ç§æœ‰å’Œå…¬å…±çš„æ„é€ å‡½æ•°å’Œå¿ƒçˆ±çš„`static`å…³é”®å­—ã€‚

è®©æˆ‘å‘ä½ å±•ç¤ºè¾¾åˆ°æ¨¡å¼æœ€ç»ˆçŠ¶æ€çš„æ­¥éª¤ğŸ‘¨ğŸ»â€ğŸ’»ï¼š

1.  ä¸ºäº†ä½¿ç±»é€‚åˆå®ä¾‹åŒ–ï¼Œæˆ‘ä»¬éœ€è¦`public constructor`:

`public ExampleOfClass`

2.ä¸ºäº†ä½¿ä¸€ä¸ªç±»å¯¹å¤–éƒ¨ä¸–ç•Œä¸å¯è§ï¼Œæˆ‘ä»¬å°†å®ƒè½¬å‚¨åˆ°å‰é¢çš„å…¬å…±ç±»ä¸­ï¼Œå¹¶ä½¿å®ƒ:

`private ExampleOfInnerClass`

3.ä¸ºäº†åˆå§‹åŒ–è¿™ä¸ªå†…éƒ¨ç±»ï¼Œæˆ‘ä»¬è‚¯å®šéœ€è¦è°ƒç”¨ä¸€äº›æ–¹æ³•ã€‚ä½¿ç”¨`static`ä½¿å…¶å¯ä»`public`æ„é€ å™¨è®¿é—®:

`public static ExampleOfInnerClass getInstance()`

4.ä¸ºä»€ä¹ˆå°†`static`ç”¨äº**å•ä¾‹**å˜é‡ï¼Œä¾‹å¦‚:

`private static Singleton uniqueInstance`

é˜…è¯»ä»¥ä¸‹å…³äº[å †æ ˆæº¢å‡º](https://medium.com/u/d53dd768d047?source=post_page-----a63c774d9d4--------------------------------)çš„å¸–å­:[https://stackoverflow.com/a/26993425/16543524](https://stackoverflow.com/a/26993425/16543524)

æ¯•ç«Ÿï¼Œè®©æˆ‘ä»¬è§‚å¯Ÿå•ä¾‹æ¨¡å¼çš„æœ€ç»ˆä»£ç ï¼Œå¹¶è®¨è®º itğŸ› çš„å¯èƒ½ä¿®æ”¹

## é¢å¤–éƒ¨åˆ†

ä½†é¦–å…ˆï¼Œè®©æˆ‘è¯´ä¸€ç‚¹é¢˜å¤–è¯:

*   ä»€ä¹ˆæ˜¯`static`ï¼Ÿæˆ‘ä¸æ˜¯ä¸€ä¸ªé‡ JVM çš„å®¶ä¼™ï¼Œä½†å¯ä»¥è§£é‡Šä¸€ä¸‹:è¿™ä¸ªè¯å‘Šè¯‰ JVMï¼Œå½“åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶ï¼Œå®ƒåº”è¯¥ç”¨è¿™ä¸ªå…³é”®å­—**åˆå§‹åŒ–(æˆ–åªæ˜¯è®°ä½)å˜é‡ã€‚**
*   è®°ä½**å•ä¾‹**ä¸æ˜¯ç®€å•çš„*ä¸ºäº†æ¨¡å¼è€Œæ¨¡å¼*çš„ä¸œè¥¿ã€‚å®ƒé‡Œé¢å¯ä»¥æœ‰å¾ˆå¤šç§æ–¹æ³•ã€‚
*   å½“å¦ä¸€ä¸ªçº¿ç¨‹/èµ„æºè®¿é—® **Singleton** æ—¶ï¼Œå®ƒæ£€æŸ¥æ–¹æ³•:å®ä¾‹æ˜¯å¦å·²ç»åˆå§‹åŒ–ï¼Ÿå¦‚æœä½ ä¸æ˜ç™½æˆ‘å¯¹ aboutğŸ§çš„è¯´æ•™ï¼Œè¯·çœ‹ä¸‹ä¸€èŠ‚çš„`getInstance()`æ–¹æ³•
*   è¯¥æ¨¡å¼è¿åäº†**å®**ä¸­çš„ S:**å•ä¸€è´£ä»»åŸåˆ™**ã€‚

> ç±»åº”è¯¥åªåšä¸€ä»¶äº‹ï¼Œä¸è¦ä¸å„ç§

*   é‚£ä¹ˆï¼Œ**å•ä¾‹**ä¸å°±æ˜¯**æ¾è€¦åˆ**å—

æœ€åä¸¤ä¸ªé¡¹ç›®ç¬¦å·å¹¶ä¸æ„å‘³ç€è¯¥æ¨¡å¼åœ¨æŸç§ç¨‹åº¦ä¸Šæ˜¯ä½åŠ£çš„ã€‚å®ƒç»å¸¸å› æ­¤å—åˆ°æ‰¹è¯„ï¼Œä½†è¿™å°±æ˜¯ä¸–ç•Œçš„çœŸç›¸:æˆ‘ä»¬å¹¶ä¸æ€»æ˜¯åšæŒæœ€ä½³å®è·µğŸ¤·â€â™‚ï¸

*   ç§‘ç‰¹æ—æ²¡æœ‰æˆç†Ÿçš„**å•ä¾‹æ¨¡å¼**ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªç®€å•çš„`object`ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘å†³å®šç”¨ Java è§£é‡Šä¸€åˆ‡
*   å½“æˆ‘ä»¬æœ‰å¤šä¸ªç±»è£…å…¥å™¨& **å•ä¾‹ç±»**æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°**å•ä¾‹ç±»**çš„é—®é¢˜ã€‚è§£å†³æ–¹æ¡ˆï¼Ÿè‡ªå·±æŒ‡å®šç±»è£…å…¥å™¨ã€‚

## **æœ€ç»ˆè§£å†³æ–¹æ¡ˆä»£ç **

é¦–å…ˆï¼Œè®©æˆ‘ä»¬çœ‹çœ‹åŸºæœ¬çš„ **Singleton** ï¼Œç„¶åæˆ‘ä»¬ä¼šè€ƒè™‘æ”¹å–„å®ƒçš„æ–¹æ³•

æ­£å¦‚æˆ‘åœ¨ä¹‹å‰çš„æ–‡ç« ä¸­æ‰€æè¿°çš„:

*   `public class Singleton` æ„é€ å™¨ä½¿ç±»å¯¹å¤–éƒ¨ä¸–ç•Œå¯è®¿é—®
*   `private Singleton`æ„é€ å‡½æ•°ä½¿ç±»å¯¹å¤–éƒ¨ä¸–ç•Œä¸å¯è§
*   `public static Singleton getInstance()`å…è®¸`public class Singleton`è®¿é—®è¯¥æ–¹æ³•
*   `private static Singleton uniqueInstance`åŒæ ·çš„å¸–å­åœ¨[æ ˆæº¢å‡º](https://medium.com/u/d53dd768d047?source=post_page-----a63c774d9d4--------------------------------):[https://stackoverflow.com/a/26993425/16543524](https://stackoverflow.com/a/26993425/16543524)

ä½ ä¼šæƒ³:æœ‰ä»€ä¹ˆå¯ä»¥æ”¹è¿›çš„ï¼Ÿè€å®è¯´ï¼Œæ€»ä½“ç»“æ„ä¿æŒä¸å˜ï¼Œä½†æ˜¯è¦åº”ç”¨ä¸€äº›å°çš„å˜åŒ–(å®ƒä»¬å¸¦æ¥çš„é‡è¦æ€§èŒƒå›´å¹¶ä¸å°)ã€‚

å¦‚æœæˆ‘ä»¬æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œå®ƒä»¬åŒæ—¶è®¿é—®å•ä¸ªçš„ä¼šæ€ä¹ˆæ ·ï¼Ÿ- >å½“æ¯ä¸ªçº¿ç¨‹éƒ½å¯èƒ½è¿›å…¥è¿™ä¸ªç±»æ—¶ä¼šå¼•èµ·éªšåŠ¨ï¼Œåœ¨å’Œ`if (uniqueInstance == null)`ä¹‹å**å®ƒä»¬éƒ½å°†åˆ›å»ºè‡ªå·±çš„å®ä¾‹ã€‚å› æ­¤å®ƒå¼•èµ·äº†è®¸å¤šéº»çƒ¦ğŸ˜°**

æ€ä¹ˆæ‰èƒ½ä¿®å¥½ï¼Ÿ

1.  åœ¨`getInstance()`æ–¹æ³•ä¸­ä½¿ç”¨`synchronized`å…³é”®å­—ã€‚è¿™å°†å¯¼è‡´çº¿ç¨‹ç­‰å¾…ï¼Œç›´åˆ°å¦ä¸€ä¸ªè§£é”æ–¹æ³•ã€‚

éµå®ˆä»£ç :

å…³æ³¨`synchronized`

2.â€œçƒ­åˆ‡åˆ›é€ â€çš„ç‹¬ç”Ÿå­å¥³

é¦–å…ˆçœ‹çœ‹ä»£ç ï¼Œç„¶åæˆ‘ä¼šä¸€æ­¥ä¸€æ­¥åœ°è§£é‡Šä»–ä»¬æ˜¯å¦‚ä½•åšåˆ°çš„:

å›å¿†ä¸€ä¸‹`static`çš„è§£é‡Šï¼ŸåŒæ ·ï¼Œå½“ app è¢«åˆå§‹åŒ–æ—¶ï¼ŒJVM å¼€å§‹äº†è§£æ‰€æœ‰çš„`static`ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬çš„`static`å˜é‡è°ƒç”¨æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ª**å•ä¾‹**å®ä¾‹`=>`å½“æˆ‘ä»¬è¿›ä¸€æ­¥ä½¿ç”¨è¯¥æ–¹æ³•æ—¶ï¼Œå˜é‡å°†å·²ç»è¢«åˆå§‹åŒ–ã€‚

3.DCI:åŒé‡æ£€æŸ¥é”å®š

ä½ çŸ¥é“`synchronized`çš„éª—å±€å—ï¼Ÿå®ƒä¼šæ¶ˆè€—å¤§é‡èµ„æºï¼Œå¦‚æœå®ƒå¾ˆå…³é”®ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªè§£å†³æ–¹æ¡ˆ:

å› æ­¤ï¼Œåœ¨è¿™ç§æ–¹æ³•ä¸­ï¼Œå¦‚æœä¸¤ä¸ªçº¿ç¨‹å‘ç°è‡ªå·±åœ¨ `if (uniqueInstance == null)`ä¹‹å**ï¼Œä»£ç é˜»å¡å˜é‡ï¼Œç„¶åè¿›è¡Œç¬¬äºŒæ¬¡æ£€æŸ¥(ä¸ºä»€ä¹ˆï¼Ÿ- >æš‚æ—¶è¯·ç­‰å¾…ğŸ™)ï¼Œå¦‚æœè¿˜æ˜¯`null`ï¼Œåˆå§‹åŒ–å˜é‡ã€‚æ‰€ä»¥ï¼Œä½ å¯ä»¥æ‹¥æœ‰ questionsâ“:**

*   ä¸ºä»€ä¹ˆè¦ç¬¬äºŒæ¬¡æ£€æŸ¥ï¼Ÿå› æ­¤ï¼Œä¸¤ä¸ªçº¿ç¨‹é€šè¿‡äº†ç¬¬ä¸€ä¸ª`if`æ£€æŸ¥ã€‚ç„¶åï¼Œæˆ‘ä»¬é€šè¿‡`synchronized`è¿›è¡Œé˜»æŒ¡ã€‚ç¬¬ä¸€ä¸ªçº¿ç¨‹å·²ç»“æŸåˆå§‹åŒ–ï¼Œç¬¬äºŒä¸ªçº¿ç¨‹å¼€å§‹è¿è¡Œã€‚ä½†æ˜¯åœ¨ç¬¬äºŒæ¬¡`if`æ£€æŸ¥ä¸­:å®ä¾‹å·²ç»å­˜åœ¨- >ä¸éœ€è¦åˆ›å»ºå®ƒã€‚å½“å®ä¾‹æ²¡æœ‰å®ç°æ—¶ï¼Œæˆ‘ä»¬åªä½¿ç”¨ä¸€æ¬¡`synchronized`ã€‚
*   ä»€ä¹ˆæ˜¯`violate`ï¼Ÿå®ƒå‘Šè¯‰**çº¿ç¨‹**åœ¨å˜é‡çš„å½“å‰å€¼ä¸­æŸ¥æ‰¾(åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå®ƒåœ¨ç±»å†…éƒ¨)ï¼Œä½†æ˜¯ä¸åœ¨çº¿ç¨‹çš„**ç¼“å­˜**ä¸­æŸ¥æ‰¾(åœ¨é‚£é‡Œå˜é‡å¯èƒ½æ²¡æœ‰è¢«åˆå§‹åŒ–)

â€¼ï¸Dangerâ€¼ï¸:è¿™ç§æ–¹æ³•åœ¨ Java 5 ä¹‹å‰æ˜¯è¡Œä¸é€šçš„

4.æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ Java Enum åš **Singleton** ï¼Œä½†æ˜¯æˆ‘å°†åœ¨æœ¬æ–‡ä¸­è·³è¿‡å®ƒã€‚

## **å›¾çº¸**ğŸ’«

![](img/b5a076398a0909e704d871fcd0e5c321.png)

åœ¨ç…§ç‰‡ä¸­ä½ å¯ä»¥çœ‹åˆ°æˆ‘çš„æ¶‚é¸¦ğŸ™„æˆ‘ç”»äº†å„ç§å®ç°ï¼Œåšäº†å‡ ç‚¹æ³¨é‡Šã€‚

> å¦‚æœä½ æ²¡æœ‰å¾—åˆ°ä»€ä¹ˆï¼Œç•™ä¸‹è¯„è®ºï¼Œæˆ‘ä¼šæ¥è§£é‡Š

## ç»“å°¾éƒ¨åˆ†ğŸ“£

> **å•ä¾‹æ¨¡å¼**çš„å­¦æœ¯å®šä¹‰:å®ƒç¡®ä¿ç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜æä¾›äº†ä¸€ä¸ª**å…¨å±€è®¿é—®ç‚¹**

ä»Šå¤©å°±è¿™äº›äº†ã€‚æŸ¥çœ‹æˆ‘åœ¨è¯¥ç³»åˆ—ä¸­ä»¥å‰çš„æ–‡ç« ğŸ‘‹

ä½ å¯ä»¥æ‰¾åˆ°æˆ‘:

*   é¢†è‹±:[www.linkedin.com/in/sleeplesschallenger](http://www.linkedin.com/in/sleeplesschallenger)
*   GitHub:[https://github.com/SleeplessChallenger](https://github.com/SleeplessChallenger)
*   leet code:[https://leetcode.com/SleeplessChallenger/](https://leetcode.com/SleeplessChallenger/)
*   ç”µæŠ¥:@æ— çœ æŒ‘æˆ˜è€…