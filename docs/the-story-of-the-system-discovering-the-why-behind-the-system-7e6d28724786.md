# 系统的故事:发现系统背后的“为什么”

> 原文：<https://blog.devgenius.io/the-story-of-the-system-discovering-the-why-behind-the-system-7e6d28724786?source=collection_archive---------13----------------------->

![](img/88da359df6028d11bfa58a30489d1ef0.png)

软件开发可能是一个快节奏的世界，不同的时尚在这个行业中来来去去，很多时候旧的又变成了新的，至少有 36 家供应商在争夺使用他们的技术来构建您的系统。这就是这个行业的本质。这其中的一个问题是:通常在同一个系统中可以发现多种时尚或竞争技术。仅仅是一次失败或放弃的迁移吗？某些技术是否将用于某些用例，而其他的则否？X 的建造方式似乎是错误的，为什么要这样建造呢？这些很可能是你以前问过自己的问题。清楚地回答这些问题会对你在一个系统中的效率产生深远的影响，因此值得探索。

无论系统的年代如何，每个系统和应用都有一个故事。一些系统是新的，因此他们的故事可能很短，希望平安无事。其他系统可能已经存在了几十年，有着漫长而曲折的历史，这也是为什么它会是现在这个样子的原因。理解这个故事通常是对一个系统做出改变的第一步，尤其是如果这是一个实质性的改变。问题是，你如何发现这段历史？在我们这个快节奏的世界里，我们没有时间重新发明轮子，一遍又一遍地尝试同样的事情，如果它们不起作用的话。相反，如果随着时间的推移，我们不能对系统做出改变，我们就进入了停滞状态，正如[杰夫·贝索斯](https://www.aboutamazon.com/news/company-news/2016-letter-to-shareholders)所说，停滞是“随后的无关紧要”。随之而来的是极度痛苦的衰落。其次是死亡。”没有人希望这样。

让我们深入探讨一下如何分享特定系统架构的原因。

## 讲故事

![](img/920185197b8d9dcbd1823aac8a815dc0.png)

照片由[迈克·厄斯金](https://unsplash.com/@mikejerskine?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄

诚然，第一个想法非常脆弱，通常不可能实现，但当你能让它发挥作用时，它与下面将分享的其他一些想法配合起来会非常有效。这就是讲故事的理念。当与另一个工程师在一个系统上工作时，分享正在工作的部分如何融入整体的故事。分享故事和为什么是这样的原因。分享该系统的缺点和遇到的问题。这个过程显然需要一个最初的人知道这个故事，但在此之后，这个故事可以被其他人流传下来。很明显，故事有可能会随着世代相传而发生变异，这就是额外的方法可以充当护栏的地方，但叙事格式似乎很受人们欢迎。

我以前和一个软件架构师同事一起工作过，有一个过程，当一个开发人员在系统中工作了一段时间后，他会和他们开一个会，他们会坐在白板前，他会让他们画出系统的架构，并向他解释它是如何工作的。这不是测试。显然，在一个系统中工作却不知道它如何工作的人会令人担忧，但人们如何解释事情却没有任何影响。这个过程有几个目的。首先，它允许架构师看到系统的知识是如何被共享的。如果人们对事情如何运作有误解，他可以纠正他们，如果他们的解释是正确的，这是一个系统知识正在传播的迹象。分享架构的故事对描述它的人来说也是一个好处，因为它在他们的脑海中巩固了事物如何工作。

## 质量属性

![](img/298cdfb8d960ba410a8c1ca7f025043c.png)

在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上由[Towfiqu barb huya](https://unsplash.com/@towfiqu999999?utm_source=medium&utm_medium=referral)拍摄的照片

有时也被称为“能力”，因为它们中的许多以后缀“-ility”结尾，[质量属性](https://en.wikipedia.org/wiki/List_of_system_quality_attributes)作为系统的非常重要的非功能属性。这些是系统要成功必须达到的最重要的非功能属性。架构和系统设计是一个权衡的游戏。虽然我们希望我们所有的系统拥有世界上所有的好东西，但这是不可能的。拥有良好记录的质量属性允许那些在系统中工作的人参考它们来帮助理解为什么系统是这样构建的。它还提供了一个框架来测试新的决策，以确保系统不会走向错误的方向。

我曾经在一个极其复杂的系统中工作过。应用程序的各个部分是极其松散耦合和分布式的。这些项目本身都不是问题。当试图回答“为什么”这个问题时，问题出现了。真的没有太多的答案。您偶尔会得到这样的回答，“我们需要支持 X 数量的请求每秒爆发到 1000 倍”，这可以作为性能或可伸缩性质量属性的良好基础，唯一的问题是这些数字是编造的。深入实际的业务需求，我们发现真正的质量属性是开发速度、可维护性、数据完整性、适度的性能需求等。最初的体系结构在某种程度上是同类产品中的第一个，具有很高的学习曲线和数据完整性问题。这与质量属性直接不一致。这个最初的架构后来被放弃了，采用了一个更简单的架构，它允许我们满足那些最初的需求。

## 架构决策记录

![](img/2c62e346cb7a7d0cce0d8deab886d609.png)

照片由[阿里萨·查塔萨](https://unsplash.com/@golfarisa?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄

另一种方式来解释“为什么”背后的故事是通过架构决策记录来实现的。一个[架构决策记录](https://cognitect.com/blog/2011/11/15/documenting-architecture-decisions.html) (ADR)是一个关于应用程序架构重要部分的文档化决策。有许多可以使用的架构决策记录的格式，但是其中包含的一般信息是一种状态(是否被接受、废弃等等)。)、决策是什么、做出决策的环境、接受决策的不利因素以及在得出当前答案之前考虑的其他选项。如果有用，可以向记录中添加额外的部分，但这是它所包含的内容的共同核心。

架构决策记录的一个优点是，它们可以以一种相当简洁的方式非常快速地获得大量信息，而只需要一个文本编辑器就可以开始。这可能是为什么许多人建议使用它们，它已经出现在[ThoughtWorks](https://www.thoughtworks.com/radar/techniques/lightweight-architecture-decision-records)tech radar 上，像[迈克尔·尼加德](https://cognitect.com/authors/MichaelNygard.html)这样的行业领袖分享了它们的优点，等等。

当环境发生变化时，上面的格式非常有用。我曾经和一个有着很强的反微服务规则的团队合作过。这在很大程度上被接受了，但是他们遇到了一个问题，他们想开始利用一个更加面向服务的架构。问题是他们有不使用微服务的书面决定。只有当他们发现做出这个决定的原因时，他们才能前进。过去，该公司构建的软件是由非技术用户在内部部署和管理的。在这种环境下，微服务的操作复杂性是不可接受的。然而，该公司后来转向自己部署和管理软件，并将其作为 SaaS 解决方案提供。因此，随着环境的变化，可以使用新的当前环境作为其指南来做出新的决策。如果最初的环境和推理没有被记录下来，做出转向的决定可能会面临更多的复杂情况。

## 建筑适应度函数

![](img/20d0e53687422ff5aabbfa7724a5a336.png)

照片由 [Nguyen Dang Hoang Nhu](https://unsplash.com/@nguyendhn?utm_source=medium&utm_medium=referral) 在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

一个[架构适应度函数](https://www.thoughtworks.com/radar/techniques/architectural-fitness-function)是一个从进化计算中借用的概念，在进化计算中，一个系统被开发来确定一个给定的系统在多大程度上实现一个特定的目标。这些适应度函数依赖于已经有质量属性和场景来指导测试。这个概念最初是由尼尔·福特、丽贝卡·帕森斯和帕特里克·库阿在[进化架构](https://amzn.to/3ctDGhB)中解释的。这些适应性功能通常作为自动测试存在于您的系统中。如果它们不能在应用程序中持续运行，并且对开发人员来说是不可见的，那么它们的有用性就会大大降低。就像更传统的自动化测试可以作为一个系统做什么和它应该如何工作的文档一样，自动化的适应性功能可以作为一个系统如何工作、应该工作以及为什么工作的文档。

我最喜欢的帮助支持这个功能的工具之一是一个叫做 [ArchUnit](https://www.archunit.org/) 的工具。ArchUnit 是一个很棒的工具，它可以融入到您现有的测试框架中，并允许您快速开始测试和记录您的架构决策。虽然它所涵盖的范围有限，但在其影响范围内，它很好地完成了工作。它还允许扩展以增强最初没有附带的新功能。我已经成功地使用这个库来构建先发制人的测试，确保未来的开发人员在各种能力下遵循我们所追求的架构指南。我所写的实施的例子是确保所有的测试都被组织中的一个可接受的标签所标记(在这个例子中是单元对集成)。强制在生产环境中被区别对待的应用程序的特定部分在该环境中工作。当设计的东西不能在其他环境下工作时，这加快了反馈的速度。作为最后一个例子，我已经能够使用它来强制代码不调用系统不同部分的非发布 API。这些只是 ArchUnit 所能做的一些想法。

这些只是如何记录“为什么”的一些想法一个系统的架构背后(甚至只是一部分)。这些工作都不是免费的，它肯定需要努力。也就是说，如果你投资这项工作，它会有回报。人们不仅会知道组成你的系统的关键部分及其原因，而且他们还会更好地识别系统中那些不关键的、更容易改变的部分。这一切都导致加速开发和更快乐的开发人员，我相信，这导致更高质量的应用程序。