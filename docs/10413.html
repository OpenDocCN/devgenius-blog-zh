<html>
<head>
<title>How to use Google cloud vision API to detect image properties in Laravel</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在 Laravel 中使用 Google cloud vision API 检测图像属性</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-use-google-cloud-vision-api-to-detect-image-properties-in-laravel-f165fb0fa528?source=collection_archive---------13-----------------------#2022-10-31">https://blog.devgenius.io/how-to-use-google-cloud-vision-api-to-detect-image-properties-in-laravel-f165fb0fa528?source=collection_archive---------13-----------------------#2022-10-31</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><figure class="im in gp gr io ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/834205e41d3e12cb42c77b7d004747de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nEu4mPqXMmsOZCU9"/></div></div><figcaption class="iw ix gj gh gi iy iz bd b be z dk translated">Google cloud vision API 检测 Laravel 中的图像属性</figcaption></figure><div class=""/><p id="b63b" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在本文中，我们将了解如何使用 Google cloud vision API 光学字符识别(OCR)来检测 Laravel 应用程序中的图像属性。</p><p id="7220" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><a class="ae kx" href="https://cloud.google.com/vision/docs/detecting-properties" rel="noopener ugc nofollow" target="_blank">检测图像属性</a></p><p id="7a5b" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">图像属性功能检测图像的一般属性，如主色。</p><p id="bb82" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在本教程<a class="ae kx" href="https://alemsbaja.hashnode.dev/how-to-use-google-cloud-vision-api-safe-search-detection-to-detect-explicit-content-on-image-uploads-in-laravel" rel="noopener ugc nofollow" target="_blank">如何使用 Google cloud vision API 安全搜索检测来检测 Laravel </a>中图片上传的露骨内容中，我们详细介绍了如何创建 Google Cloud Platform (GCP)项目、服务帐户凭证以及将 cloud vision 软件包集成到 Laravel 中。</p><p id="6e97" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">为了保持这篇文章的简短，我们将直接探讨图像属性检测如何在文件上传上工作，因为我们已经有了一个用于上传文件的<a class="ae kx" href="https://github.com/RaphAlemoh/google_cloud_vision_features/blob/main/resources/views/uploads/create.blade.php" rel="noopener ugc nofollow" target="_blank">表单。</a></p><figure class="kz la lb lc gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi ky"><img src="../Images/e37781c8bace0406729a9f163afb00b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ypHALltoC0fzOpTn"/></div></div></figure><p id="0154" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb jd">注意:为了清楚起见，每个特征在 web.php 文件中都有自己的路线。</strong></p><p id="0ef7" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">您也可以检查 github 上的一个特定分支，查看它的实现</p><ul class=""><li id="eea2" class="ld le jc kb b kc kd kg kh kk lf ko lg ks lh kw li lj lk ll bi translated"><strong class="kb jd">检测局部图像中的图像属性</strong></li></ul><p id="1f0c" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">Vision API 可以对本地图像文件执行功能检测，方法是在请求正文中以 base64 编码字符串的形式发送图像文件的内容。</p><p id="dd80" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">ColorInfo 字段不携带用于解释 RGB 值的绝对色彩空间的信息(例如，sRGB、Adobe RGB、DCI-P3、BT.2020 等)。).默认情况下，应用程序应该采用 sRGB 色彩空间。</p><p id="1737" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">这里有一个<a class="ae kx" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/master/vision/src/detect_image_property.php" rel="noopener ugc nofollow" target="_blank">存储库</a>及其集成的例子。</p><p id="da45" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我们可以在上传文件时在 post 方法中运行检测。</p><ul class=""><li id="0fbf" class="ld le jc kb b kc kd kg kh kk lf ko lg ks lh kw li lj lk ll bi translated">导入类</li></ul><pre class="kz la lb lc gt lm ln lo lp aw lq bi"><span id="eff1" class="lr ls jc ln b gy lt lu l lv lw">use Google\Cloud\Vision\V1\ImageAnnotatorClient;<br/>// this HtmlStringclass is used to format the text detected on the image<br/>use Illuminate\Support\HtmlString;</span></pre><ul class=""><li id="db8d" class="ld le jc kb b kc kd kg kh kk lf ko lg ks lh kw li lj lk ll bi translated">对上传的图像运行 propertyDetection</li></ul><pre class="kz la lb lc gt lm ln lo lp aw lq bi"><span id="8829" class="lr ls jc ln b gy lt lu l lv lw">public function detectImageProperties(Request $request)<br/>    {</span><span id="74d1" class="lr ls jc ln b gy lx lu l lv lw">$request-&gt;validate([<br/>            'avatar' =&gt; 'required|image|max:10240',<br/>        ]);</span><span id="1926" class="lr ls jc ln b gy lx lu l lv lw">try {</span><span id="1e0d" class="lr ls jc ln b gy lx lu l lv lw">$imageAnnotator = new ImageAnnotatorClient([<br/>                //we can also keep the details of the google cloud json file in an env and read it as an object here<br/>                'credentials' =&gt; config_path('laravel-cloud.json')<br/>            ]);</span><span id="5743" class="lr ls jc ln b gy lx lu l lv lw"># annotate the image<br/>            $image = file_get_contents($request-&gt;file("avatar"));<br/>            $response = $imageAnnotator-&gt;imagePropertiesDetection($image);<br/>            $props = $response-&gt;getImagePropertiesAnnotation();</span><span id="1b91" class="lr ls jc ln b gy lx lu l lv lw">print('Properties:' . PHP_EOL);</span><span id="96df" class="lr ls jc ln b gy lx lu l lv lw">$number_of_colors = count($props-&gt;getDominantColors()-&gt;getColors());</span><span id="411a" class="lr ls jc ln b gy lx lu l lv lw">$img_prop_content = '';</span><span id="4735" class="lr ls jc ln b gy lx lu l lv lw">foreach ($props-&gt;getDominantColors()-&gt;getColors() as $colorInfo) {</span><span id="5674" class="lr ls jc ln b gy lx lu l lv lw">printf('Fraction: %s' . PHP_EOL, $colorInfo-&gt;getPixelFraction());<br/>                $color = $colorInfo-&gt;getColor();<br/>                $img_prop_content .= "Fraction: {$colorInfo-&gt;getPixelFraction()} Red: {$color-&gt;getRed()} - Green: {$color-&gt;getGreen()} - Blue: {$color-&gt;getBlue()} &lt;br&gt;";<br/>            }</span><span id="1e6d" class="lr ls jc ln b gy lx lu l lv lw">$formatted_image_props = new HtmlString("Image Properties detection successful!!! Number of Colors:  $number_of_colors Formatted Details of Image Properties found on image uploaded: $img_prop_content");</span><span id="e992" class="lr ls jc ln b gy lx lu l lv lw">return redirect()-&gt;route('home')<br/>                -&gt;with('success', $formatted_image_props);<br/>        } catch (Exception $e) {<br/>            return $e-&gt;getMessage();<br/>        }<br/>        $imageAnnotator-&gt;close();<br/>    }</span></pre><ul class=""><li id="d0b5" class="ld le jc kb b kc kd kg kh kk lf ko lg ks lh kw li lj lk ll bi translated">我们将上传此图像，并查看检测图像属性如何返回内容</li></ul><figure class="kz la lb lc gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi ly"><img src="../Images/c5c95d73400809b782d56a35d3d14eda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/0*BhMDVNTwo81RMlBx"/></div></div></figure><p id="5d26" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">图片来源:<a class="ae kx" href="https://unsplash.com/photos/QUwLZNchflk" rel="noopener ugc nofollow" target="_blank">杰里米·毕晓普</a>在 Unsplash 上。</p><ul class=""><li id="3939" class="ld le jc kb b kc kd kg kh kk lf ko lg ks lh kw li lj lk ll bi translated">图像属性详细信息响应</li></ul><figure class="kz la lb lc gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi lz"><img src="../Images/27624966db1a25ab120385ba59b90b24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*N9qBhBJIM_odCG6k"/></div></div></figure><ul class=""><li id="0596" class="ld le jc kb b kc kd kg kh kk lf ko lg ks lh kw li lj lk ll bi translated">检测远程图像中的文本(谷歌云存储，Cloudinary，S3 桶等)</li></ul><p id="9860" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">为了方便起见，Vision API 可以直接对位于 Google 云存储或 Web 上的图像文件执行特征检测，而无需在请求正文中发送图像文件的内容。</p><p id="0822" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">ColorInfo 字段不携带用于解释 RGB 值的绝对色彩空间的信息(例如，sRGB、Adobe RGB、DCI-P3、BT.2020 等)。).默认情况下，应用程序应该采用 sRGB 色彩空间。</p><p id="adf0" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb jd">注意:当从 HTTP/HTTPS URL 获取图像时，Google 不能保证请求会被完成。如果指定的主机拒绝了请求(例如，由于请求限制或 DOS 阻止)，或者如果 Google 为了防止滥用而限制了对站点的请求，您的请求可能会失败。生产应用程序不应依赖外部托管的映像。</strong></p><p id="f494" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">只需将上传文件名替换为互联网或远程存储上的图像 URL</p><pre class="kz la lb lc gt lm ln lo lp aw lq bi"><span id="df53" class="lr ls jc ln b gy lt lu l lv lw">$image = 'file_path...<a class="ae kx" href="https://googleapis.com.......png'" rel="noopener ugc nofollow" target="_blank">https://googleapis.com.......png'</a>;</span><span id="29ed" class="lr ls jc ln b gy lx lu l lv lw">//run the image details detection feature on the image<br/>            $response = $imageAnnotatorClient-&gt;imagePropertiesDetection($image);</span></pre><p id="fa18" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">如果你是 Google cloud vision 的新手，或者想探索其他功能集成，这里有一些我以前发表的文章。</p><ul class=""><li id="2830" class="ld le jc kb b kc kd kg kh kk lf ko lg ks lh kw li lj lk ll bi translated"><a class="ae kx" href="https://alemsbaja.hashnode.dev/how-to-use-google-cloud-vision-optical-character-recognitionocr-to-detect-file-content-in-laravel" rel="noopener ugc nofollow" target="_blank">如何使用谷歌云视觉光学字符识别(OCR)检测 Laravel 中的文件内容</a></li><li id="36a1" class="ld le jc kb b kc ma kg mb kk mc ko md ks me kw li lj lk ll bi translated"><a class="ae kx" href="https://alemsbaja.hashnode.dev/how-to-use-google-cloud-vision-api-safe-search-detection-to-detect-explicit-content-on-image-uploads-in-laravel" rel="noopener ugc nofollow" target="_blank">如何使用 Google cloud vision API 安全搜索检测来检测 Laravel 中图片上传的露骨内容</a></li><li id="645b" class="ld le jc kb b kc ma kg mb kk mc ko md ks me kw li lj lk ll bi translated"><a class="ae kx" href="https://alemsbaja.hashnode.dev/how-to-use-google-cloud-vision-api-to-detect-the-faces-on-image-uploads-in-laravel" rel="noopener ugc nofollow" target="_blank">如何使用 Google cloud vision API 在 Laravel 中检测上传图像中的人脸</a></li><li id="18b0" class="ld le jc kb b kc ma kg mb kk mc ko md ks me kw li lj lk ll bi translated"><a class="ae kx" href="https://alemsbaja.hashnode.dev/how-to-use-google-cloud-vision-api-to-detect-multiple-objects-in-image-upload-in-laravel" rel="noopener ugc nofollow" target="_blank">如何在 Laravel 中使用 Google cloud vision API 检测图片上传中的多个物体</a></li></ul><p id="a4c1" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">下面是教程<a class="ae kx" href="https://github.com/RaphAlemoh/google_cloud_vision_features" rel="noopener ugc nofollow" target="_blank">资源库</a></p><p id="e4c9" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">感谢您阅读本文！！！。</p><p id="f8a8" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">如果你觉得这篇文章有帮助，请分享给你的网络，并随时使用评论区的问题，答案和贡献。</p></div><div class="ab cl mf mg hr mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ig ih ii ij ik"><p id="30b5" class="pw-post-body-paragraph jz ka jc kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><em class="mm">最初发布于</em><a class="ae kx" href="https://alemsbaja.hashnode.dev/how-to-use-google-cloud-vision-api-to-detect-image-properties-in-laravel" rel="noopener ugc nofollow" target="_blank"><em class="mm">https://alemsbaja . hashnode . dev</em></a><em class="mm">。</em></p></div></div>    
</body>
</html>