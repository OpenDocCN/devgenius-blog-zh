<html>
<head>
<title>Deploy Socket.io to Kubernetes - Part 0: Overview</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将 Socket.io 部署到 Kubernetes——第 0 部分:概述</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/deploy-socket-io-to-kubernetes-part-0-overview-f192428b48a4?source=collection_archive---------13-----------------------#2022-03-03">https://blog.devgenius.io/deploy-socket-io-to-kubernetes-part-0-overview-f192428b48a4?source=collection_archive---------13-----------------------#2022-03-03</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><h2 id="d77e" class="il im in bd b dl io ip iq ir is it dk iu translated" aria-label="kicker paragraph">插座。木卫一和库伯内特</h2><div class=""/><div class=""><h2 id="5a64" class="pw-subtitle-paragraph jt iw in bd b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk dk translated">如何在 Kubernetes 上轻松运行实时应用程序？</h2></div><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/a582db1bfc26ddee61efa5af85d9417a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AavNVEwf_j6Fczf8"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">凯利·西克玛在<a class="ae lb" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="e754" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">要阅读其他部分:</p><ul class=""><li id="d082" class="ly lz in le b lf lg li lj ll ma lp mb lt mc lx md me mf mg bi translated"><a class="ae lb" rel="noopener ugc nofollow" target="_blank" href="/deploy-socket-io-to-kubernetes-part-1-chat-application-f0824fed648a">第一部分:聊天应用</a></li><li id="e68e" class="ly lz in le b lf mh li mi ll mj lp mk lt ml lx md me mf mg bi translated"><a class="ae lb" rel="noopener ugc nofollow" target="_blank" href="/deploy-socket-io-to-kubernetes-part-2-infrastructure-7764fec252d0">第二部分:基础设施</a></li></ul><p id="0561" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">我很难将 Socket.io 应用程序部署到 Kubernetes。好像 Kubernetes 不是为 Socket.io 和 Websocket 设计的。尽管 Socket.io 有潜力，但将其部署到 Kubernetes 并不像看起来那么简单。这也是为什么我想和大家分享我关于如何将 Socket.io 部署到 Kubernetes 的经验。</p><h1 id="c74c" class="mm mn in bd mo mp mq mr ms mt mu mv mw kc mx kd my kf mz kg na ki nb kj nc nd bi translated">背景</h1><p id="3825" class="pw-post-body-paragraph lc ld in le b lf ne jx lh li nf ka lk ll ng ln lo lp nh lr ls lt ni lv lw lx ig bi translated">在我 3 年的软件工程师生涯中(2 年全职，1 年实习)，我从未成功开发(甚至学习)<a class="ae lb" href="https://stackoverflow.com/a/12366688" rel="noopener ugc nofollow" target="_blank">双向系统</a>。我要么使用<a class="ae lb" href="https://github.com/sofastack/sofa-rpc" rel="noopener ugc nofollow" target="_blank"> RPC </a>要么使用 HTTP，其中两个系统都是单向系统，这意味着只有客户端可以将更新“推”到服务器。我从双向系统中得到的最接近的东西是消息代理，其中有消息发布者(或生产者)和订阅者(或消费者)。这就是为什么我想学习双向系统(在这里是 Socket.io)，这样我至少知道如何构建“实时”应用程序。</p><p id="0464" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">至于为什么在 Kubernetes，还有另外一个故事。我目前正在学习 Kubernetes。我和 Kubernetes 的第一个项目是<a class="ae lb" href="https://learnk8s.io/terraform-lke" rel="noopener ugc nofollow" target="_blank">在 Linode cloud </a>中部署 hello-world image(教程是由<a class="ae lb" href="https://learnk8s.io/blog" rel="noopener ugc nofollow" target="_blank"> learnk8s.io </a>制作的，你也应该去看看)。我很高兴，但我想更进一步，在 Kubernetes 部署双向系统。这就是我开始这个副业的原因。</p><h1 id="3f41" class="mm mn in bd mo mp mq mr ms mt mu mv mw kc mx kd my kf mz kg na ki nb kj nc nd bi translated">系统结构</h1><p id="6f5b" class="pw-post-body-paragraph lc ld in le b lf ne jx lh li nf ka lk ll ng ln lo lp nh lr ls lt ni lv lw lx ig bi translated">由于双向系统对我来说是新的，我对如何设计架构没有一个大致的想法(至少在 Kubernetes 上)。所以，我花了相当多的时间来设计这个建筑。</p><p id="51b3" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">我首先只暴露后端，不使用入口。我认为通过只暴露后端，我们可以避免复杂的设计。这被证明是一个坏主意，因为我们需要公开客户端(确保用户可以看到网络)和服务器(在客户端之间发送和交换消息)。</p><p id="31d2" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">我的第二个迭代是通过使用<a class="ae lb" href="https://kubernetes.io/docs/concepts/services-networking/service/" rel="noopener ugc nofollow" target="_blank"> Kubernetes 的服务</a>来公开客户端和服务器。我的想法是，通过在 Kubernetes 中使用<a class="ae lb" href="https://medium.com/google-cloud/kubernetes-nodeport-vs-loadbalancer-vs-ingress-when-should-i-use-what-922f010849e0" rel="noopener">负载平衡器服务</a>，我不需要设置入口(我不习惯这样)，从而避免创建新的<a class="ae lb" href="https://kubernetes.io/docs/concepts/overview/working-with-objects/kubernetes-objects/" rel="noopener ugc nofollow" target="_blank"> Kubernetes 对象</a>。为什么我尽量避免新的对象？因为新对象意味着额外的复杂性。但是，事实证明这并不奏效。</p><p id="47e2" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">下面是成功在云端运行 Socket.io 的最终系统架构。至于详细的故事，这将在这个项目的第二部分进一步解释。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nj"><img src="../Images/65b1b8ed4537df212d9233a4e290c871.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lN6j8dCCdk0ONyj3MI4A8A.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">高级系统架构。</figcaption></figure><h1 id="10f1" class="mm mn in bd mo mp mq mr ms mt mu mv mw kc mx kd my kf mz kg na ki nb kj nc nd bi translated">云提供商</h1><p id="4f53" class="pw-post-body-paragraph lc ld in le b lf ne jx lh li nf ka lk ll ng ln lo lp nh lr ls lt ni lv lw lx ig bi translated">对于这个项目，我使用谷歌云。为什么？实际上没有什么特别的原因，除了我有 300 美元的免费信用额度可以花。理论上，你可以使用任何你想要的云提供商。然而，这个项目中的 Terraform 配置文件适合 Google Cloud。</p></div><div class="ab cl nk nl hr nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ig ih ii ij ik"><p id="ad59" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">我希望在这篇文章中，你了解这个项目的概况。在接下来的两篇文章中，我将向您解释该应用程序是如何制作并部署到云中的。敬请期待！</p></div></div>    
</body>
</html>