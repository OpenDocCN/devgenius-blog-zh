<html>
<head>
<title>Convert your React application to an Andriod/iOS app using Cordova</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Cordova 将 React 应用程序转换为 Andriod/iOS 应用程序</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/convert-your-react-application-to-an-andriod-ios-app-using-cordova-87646729c2b7?source=collection_archive---------0-----------------------#2022-03-08">https://blog.devgenius.io/convert-your-react-application-to-an-andriod-ios-app-using-cordova-87646729c2b7?source=collection_archive---------0-----------------------#2022-03-08</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/b072ed9f5583b72c89f6dc8a7970b162.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mbus9kfOtlG4U2brQg_0Bg.png"/></div></div></figure><p id="5589" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这里，我不是在谈论 React 原生应用程序。如果你有一个 React web 应用程序，并且你想用最少的努力在 App store 或 Google play store 中列出你的应用程序，那么这个故事就是为你准备的。请记住，react web 应用程序的响应能力非常重要，因此如果 web 应用程序在较小的设备上运行良好，那么将其转换为移动应用程序是有意义的。</p><p id="2eb0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">虽然将 react 应用程序转换成移动应用程序的过程看起来势不可挡，但是相信我，这是非常简单的。</p><p id="bee9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">首先，我们将创建两个不同的应用程序。第一个是 Cordova 应用程序，另一个是 React 应用程序。然后我们将合并这两个应用程序。</p><p id="0aa6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">Apache Cordova 基本上是 HTML 和 JavaScript 的包装器，允许 web 开发人员为各种平台构建本地应用程序。</p><p id="79fc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们开始吧。</p><p id="72d9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">安装科尔多瓦</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="13e1" class="lc ld in ky b gy le lf l lg lh">npm install cordova -g</span></pre><p id="079c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">创建 React 应用程序</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="c868" class="lc ld in ky b gy le lf l lg lh">npx create-react-app pure-react</span></pre><p id="38b2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">或者</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="c30d" class="lc ld in ky b gy le lf l lg lh">yarn create react-app pure-react</span></pre><p id="3d65" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">创建 Cordova 应用程序</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="5370" class="lc ld in ky b gy le lf l lg lh">cordova create ReactCordova</span></pre><figure class="kt ku kv kw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi li"><img src="../Images/a381a812e2960ff7ba40c159561e1765.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TJ9dLZ0yBhbpYMkk_SVRrg.png"/></div></div></figure><p id="e019" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这应该是一个文件夹中两个项目的结构。</p><p id="06c5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们现在应该测试 react 应用程序。</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="ce51" class="lc ld in ky b gy le lf l lg lh">$ cd pure-react<br/>$ npm start</span></pre><p id="5bc5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在如果我们访问 url <a class="ae lj" href="http://localhost:3000." rel="noopener ugc nofollow" target="_blank"> http://localhost:3000。</a>我们应该看到 react 测试页面。</p><figure class="kt ku kv kw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lk"><img src="../Images/ba6c19d9eb86ef663c7342429e3c5ed8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eOcKWlgWNuoyeIEgwCQaog.png"/></div></div></figure></div><div class="ab cl ll lm hr ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ig ih ii ij ik"><p id="c7ee" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">所有设置完成后，我们将手动合并这两个项目。</p><p id="d422" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">首先，我们需要从<strong class="jx io"> pure-react/package.json </strong>中复制<em class="ls">脚本</em>、<em class="ls">依赖关系</em>和<em class="ls"> browserList、</em>，并将其粘贴到<strong class="jx io">react Cordova/package . JSON</strong>中。</p><p id="87a3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">结果文件<strong class="jx io">react Cordova/package . JSON</strong>应该是这样的。</p><figure class="kt ku kv kw gt jo"><div class="bz fp l di"><div class="lt lu l"/></div></figure><p id="5a77" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们应该将<strong class="jx io"> pure-react/public/ </strong>和<strong class="jx io"> pure-react/src </strong>文件夹移动到<strong class="jx io"> ReactCordova/ </strong>文件夹中。</p><p id="1268" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在项目结构应该是这样的。</p><figure class="kt ku kv kw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi li"><img src="../Images/7d3c425ad66b5876fe3167d19333f3be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qvda7X_em5gODJHB-CZ0aw.png"/></div></div></figure><p id="f1df" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">由于我们在<strong class="jx io">react Cordova/package . JSON</strong>中有了新的依赖项，我们将把它们安装在我们的项目中。</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="211b" class="lc ld in ky b gy le lf l lg lh">$ cd ReactCordova/<br/>$ npm i</span></pre><p id="407b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果我们再次逃跑</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="ae4f" class="lc ld in ky b gy le lf l lg lh">$ npm start</span></pre><p id="15d2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们应该看到 react 测试页面，但是这次是从 Cordova 应用程序项目内部。这是因为我们迁移了 Cordova 应用程序文件夹中运行 react 应用程序所需的最少资源。</p><p id="3040" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在，让我们给&lt;头&gt;内的<strong class="jx io"> public/index.html </strong>添加一些 meta 标签。</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="2d8a" class="lc ld in ky b gy le lf l lg lh">&lt;meta http-equiv="Content-Security-Policy" content="default-src 'self' data: gap: https://ssl.gstatic.com 'unsafe-eval' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; media-src *; img-src 'self' data: content:;"&gt;</span><span id="bee3" class="lc ld in ky b gy lv lf l lg lh">&lt;meta name="format-detection" content="telephone=no"&gt;</span><span id="b2cc" class="lc ld in ky b gy lv lf l lg lh">&lt;meta name="msapplication-tap-highlight" content="no"&gt;</span><span id="aa54" class="lc ld in ky b gy lv lf l lg lh">&lt;meta name="viewport" content="initial-scale=1, width=device-width, viewport-fit=cover"&gt;</span></pre><p id="28f1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">然后我们需要在我们的<strong class="jx io"> public/index.html </strong>文件中注入<strong class="jx io"> cordova.js </strong>脚本。</p><p id="f18f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在<strong class="jx io"> public/index.html </strong>中的<em class="ls"> &lt; /body &gt; </em>标签前添加以下几行。</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="4bce" class="lc ld in ky b gy le lf l lg lh">&lt;script src="cordova.js" type="text/javascript"&gt;&lt;/script&gt;</span></pre><p id="0b25" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们需要确保在文档中加载 Cordova 脚本之后加载 React DOM。所以用下面的方法编辑<strong class="jx io"> src/index.js </strong>文件。我们将创建一个函数<em class="ls"> renderReactDom </em>并在一个监听器上调用它，即<em class="ls"> deviceready </em>被触发。</p><figure class="kt ku kv kw gt jo"><div class="bz fp l di"><div class="lt lu l"/></div></figure><p id="387e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">下一步，我们将改变 JavaScript 和 CSS 文件的绝对路径。为此，您只需要在<strong class="jx io"> package.json </strong>中添加下面一行。</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="892b" class="lc ld in ky b gy le lf l lg lh">"homepage": "./"</span></pre></div><div class="ab cl ll lm hr ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ig ih ii ij ik"><p id="7004" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在，JSX 和 ES6 中的代码库不能直接在 Cordova 应用程序中使用。因此，React 应用程序需要为生产使用而构建和打包，这将由 Cordova 应用程序使用。</p><p id="9506" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们需要在构建 Cordova 应用程序之前构建 React 应用程序。为此，在标签<em class="ls"> &lt;小部件&gt; </em>下的<strong class="jx io"> config.xml </strong>文件中添加以下行。</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="9132" class="lc ld in ky b gy le lf l lg lh">&lt;hook type="before_prepare" src="scripts/prebuild.js"/&gt;</span></pre><p id="09ec" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">因为，prebuild.js 是一个自定义脚本，它将执行 React 应用程序的构建。我们需要将这个脚本添加到项目中。创建一个<strong class="jx io">脚本</strong>文件夹，并添加以下文件。</p><figure class="kt ku kv kw gt jo"><div class="bz fp l di"><div class="lt lu l"/></div></figure><p id="2309" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">另外，安装<strong class="jx io"> prebuild.js </strong>脚本的依赖项。</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="7128" class="lc ld in ky b gy le lf l lg lh">$ npm i rimraf</span></pre><p id="c095" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">一切就绪，我们准备在 Android 模拟器中运行 react 应用程序。</p><p id="afe7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在终端中运行以下命令，在 Android 模拟器中启动 Cordova 应用程序。在执行以下命令之前，请确保模拟器已经启动并正在运行。</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="688e" class="lc ld in ky b gy le lf l lg lh">$ cordova platform add android<br/>$ cordova run android</span></pre><p id="6c55" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">就是这样。您现在运行的 React 是由 Cordova 创建的 android 应用程序。</p><figure class="kt ku kv kw gt jo gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/66727a4cadaf0ca6d5860cb17c08c8a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*RumH2GLc3nYSgKNX6q2eCg.gif"/></div></figure><p id="0595" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="ls">感谢阅读。</em></p><p id="53d6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">订阅我的时事通讯，获取我所有的更新。<a class="ae lj" href="https://neelratan-93840.medium.com/subscribe" rel="noopener">【https://neelratan-93840.medium.com/subscribe】T21</a></p></div></div>    
</body>
</html>