<html>
<head>
<title>Navigating Azure Storage Authentication Options using a Java Client</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Java 客户端导航 Azure 存储验证选项</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/navigating-azure-storage-authentication-options-using-a-java-client-d8ab31e12308?source=collection_archive---------6-----------------------#2022-02-23">https://blog.devgenius.io/navigating-azure-storage-authentication-options-using-a-java-client-d8ab31e12308?source=collection_archive---------6-----------------------#2022-02-23</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="87ea" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这篇博客是我们从零开始讨论<strong class="jm io">云</strong>概念的系列文章的一部分，面向的是入门知识有限的读者。本文属于<em class="ki">中级</em>系列，因为它涉及到理解<strong class="jm io"> </strong> <a class="ae kj" href="https://docs.microsoft.com/en-us/azure/storage/common/storage-account-overview" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> Azure 存储帐户</strong> </a> <strong class="jm io"> t. </strong>的可用认证选项</p><p id="a662" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">云系列中的一些早期博客如下。</p><p id="9c9e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae kj" rel="noopener ugc nofollow" target="_blank" href="/gcp-big-query-writing-my-first-python-connector-1140b022b88a"> <strong class="jm io"> GCP 大查询第一 Python 连接器</strong></a><strong class="jm io"><br/></strong><a class="ae kj" rel="noopener ugc nofollow" target="_blank" href="/automating-your-monthly-azure-cloud-cost-spends-a51257a6564f"><strong class="jm io">Azure 造价自动化</strong></a><strong class="jm io"><br/></strong><a class="ae kj" rel="noopener ugc nofollow" target="_blank" href="/azure-cosmos-db-rbac-authentication-using-a-java-client-720b20c637fe"><strong class="jm io">Azure Cosmos RBAC 认证</strong> </a></p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi kk"><img src="../Images/e38dc1b60ac48590de8262fd31a7d7ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ULxh8yI-cbTZxdt-P3MeuQ.png"/></div></div></figure><h1 id="2ea9" class="kw kx in bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">Azure 存储帐户—概述</h1><p id="0df9" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv lw jx jy jz lx kb kc kd ly kf kg kh ig bi translated">Azure Storage 是一个通用的命名空间，用于存储各种类型的数据，具体形式为<em class="ki"> blob、队列、表格和磁盘</em>，具体取决于正在解决的整体云原生用例。从更广的层面来看，存储帐户有两种类型-</p><h2 id="af77" class="lz kx in bd ky ma mb dn lc mc md dp lg jv me mf lk jz mg mh lo kd mi mj ls mk bi translated"><strong class="ak">标准用途存储账户</strong></h2><p id="d86d" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv lw jx jy jz lx kb kc kd ly kf kg kh ig bi translated">它们主要用于日常用例，在性能和 IOPS 方面处于低端，因为它们使用<a class="ae kj" href="https://en.wikipedia.org/wiki/Hard_disk_drive" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io">硬盘</strong> </a>来存储数据。它们支持优步 Azure 存储支持矩阵中的所有类型的数据集。</p><h2 id="a5e2" class="lz kx in bd ky ma mb dn lc mc md dp lg jv me mf lk jz mg mh lo kd mi mj ls mk bi translated"><strong class="ak">高级存储账户</strong></h2><p id="8975" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv lw jx jy jz lx kb kc kd ly kf kg kh ig bi translated">顾名思义，这些存储帐户用于服务于更高性能的用例，因为它们通过将数据存储在<a class="ae kj" href="https://en.wikipedia.org/wiki/Solid-state_drive" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> SSD </strong> </a> <strong class="jm io">上来提供更好的 IOPS 吞吐量。</strong>他们不支持优步 Azure 存储支持矩阵中所有的<em class="ki">队列</em>和<em class="ki">表</em>类型的数据集。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi ml"><img src="../Images/c86f05f1fa9671367d6ec6d6a65d992e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f-7zN6o1uA7bSLra3GFHtQ.png"/></div></div></figure><p id="eb88" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Azure 存储帐户中的身份验证方法可以使用三种不同的选项来实现- <br/> i)访问密钥。<br/> ii) SAS 令牌。iii) Azure 活动目录令牌。</p><h2 id="f613" class="lz kx in bd ky ma mb dn lc mc md dp lg jv me mf lk jz mg mh lo kd mi mj ls mk bi translated">访问键</h2><p id="8ee0" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv lw jx jy jz lx kb kc kd ly kf kg kh ig bi translated">访问密钥是默认的基于密码的身份验证机制，具有长期的有效性。这些工作在帐户的名称空间级别，即同一帐户内的所有<strong class="jm io"> <em class="ki">文件、blobs、队列等</em> </strong>共享相同的<em class="ki">主/次</em>密钥进行访问。使用访问键<em class="ki">不支持操作方面的细粒度访问— <strong class="jm io"> <em class="ki">读、写、创建等</em> </strong> <em class="ki"> </em>。</em>在定期轮换之前的有效期内，这些产品具有最大的安全风险。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi mm"><img src="../Images/f71aad2c2dd609e2caafa75eae0903fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LzoQQkRWyc_W6qc3CuHlTQ.png"/></div></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk translated"><strong class="bd ky"> Azure Blob 访问密钥</strong></figcaption></figure><p id="5355" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">样本客户端</strong></p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="mr ms l"/></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk translated"><strong class="ak">访问密钥- Java 客户端</strong></figcaption></figure><h2 id="b215" class="lz kx in bd ky ma mb dn lc mc md dp lg jv me mf lk jz mg mh lo kd mi mj ls mk bi translated">SAS 令牌</h2><p id="1f9e" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv lw jx jy jz lx kb kc kd ly kf kg kh ig bi translated">共享访问签名向客户端提供受限访问，以使用 Azure 存储帐户进行身份验证。它们的范围是单个容器，而不是优步存储帐户的命名空间。由于创建时有一个过期时间，超过该时间后，它们对身份验证无效，因此它们优化了旋转密钥的操作需求。此外，这些令牌支持基于权限的访问- <strong class="jm io"> <em class="ki">读、写、创建</em> </strong>，这有利于创建<strong class="jm io"> <em class="ki">只读/只写客户端</em> </strong>，以支持给定业务用例的数据访问需求。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi mt"><img src="../Images/bb0e9bf07958324859a415feda4086b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QyIWrZ7gk3a_7dhC2CtUHw.png"/></div></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk translated"><strong class="bd ky"> Azure Blob SAS 令牌</strong></figcaption></figure><p id="bafa" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">样本客户端</strong></p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="mr ms l"/></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk translated"><strong class="ak"> SAS 令牌- Java 客户端</strong></figcaption></figure><h2 id="24e9" class="lz kx in bd ky ma mb dn lc mc md dp lg jv me mf lk jz mg mh lo kd mi mj ls mk bi translated">Azure Active Directory 令牌</h2><p id="770a" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv lw jx jy jz lx kb kc kd ly kf kg kh ig bi translated">使用在 Azure 目录租户中创建的身份，我们可以在 Azure Blob 存储帐户中创建由 RBAC 访问支持的短期令牌。可以使用<a class="ae kj" href="https://docs.microsoft.com/en-us/azure/storage/blobs/assign-azure-role-data-access?tabs=portal" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io">内置存储角色</strong> </a> <strong class="jm io">在 Azure 存储帐户的名称空间级别或在单个容器级别为这些身份分配各种细粒度权限。</strong></p><p id="6128" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">设置广告应用</strong></p><ul class=""><li id="455d" class="mu mv in jm b jn jo jr js jv mw jz mx kd my kh mz na nb nc bi translated">为了设置一个广告应用程序，在 Azure <strong class="jm io"> </strong>门户的搜索栏中进入<strong class="jm io"> Azure Active Directory </strong>。</li><li id="9a26" class="mu mv in jm b jn nd jr ne jv nf jz ng kd nh kh mz na nb nc bi translated">从左侧选项卡中，点击<strong class="jm io">应用程序注册</strong>并创建一个具有用户友好名称的新应用程序。</li><li id="1142" class="mu mv in jm b jn nd jr ne jv nf jz ng kd nh kh mz na nb nc bi translated">需要<strong class="jm io"> <em class="ki">租户 ID、应用 ID 和客户端凭证</em> </strong>(仅一次查看)来验证客户端并生成临时令牌。</li></ul><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi ni"><img src="../Images/ce98b0a82006edbb67a023f8c90651d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5bB9c-MuoExkekWkSt0Y8g.png"/></div></div></figure><p id="70cb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">分配权限</strong></p><pre class="kl km kn ko gt nj nk nl nm aw nn bi"><span id="e899" class="lz kx in nk b gy no np l nq nr">az login</span><span id="ec4f" class="lz kx in nk b gy ns np l nq nr">az role assignment create --role "Storage Blob Data Contributor" --assignee-object-id &lt;object id of the above ad application&gt; --scope "/subscriptions/&lt;subscription&gt;/resourceGroups/&lt;resource-group&gt;/providers/Microsoft.Storage/storageAccounts/&lt;storage-account&gt;/blobServices/default/containers/&lt;container&gt;"</span></pre><p id="0166" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">样本客户端</strong></p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="mr ms l"/></div></figure><h1 id="bba3" class="kw kx in bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">额外资源</h1><div class="nt nu gp gr nv nw"><a href="https://github.com/amit894/java-blob-client" rel="noopener  ugc nofollow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd io gy z fp ob fr fs oc fu fw im bi translated">GitHub-Amit 894/Java-Blob-client:Azure Blob 机制的身份验证</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">github.com</p></div></div><div class="of l"><div class="og l oh oi oj of ok ku nw"/></div></div></a></div><p id="0cc4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="ki">如需反馈，请留言至</em><strong class="jm io"><em class="ki">Amit[dot]894[at]Gmail[dot]com</em></strong><em class="ki">或联系 https://about.me/amit_raj</em><em class="ki">的任意链接。</em></p></div></div>    
</body>
</html>