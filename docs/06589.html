<html>
<head>
<title>Applied Data Science with Python and Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python和熊猫的应用数据科学</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/pytyhapplied-data-science-with-python-and-pandas-419e63302e79?source=collection_archive---------11-----------------------#2022-01-18">https://blog.devgenius.io/pytyhapplied-data-science-with-python-and-pandas-419e63302e79?source=collection_archive---------11-----------------------#2022-01-18</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/c98394bd099eb9d72453009a295c611e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fhm9K6ZYNWXMVMmwRyOieA.png"/></div></div></figure><p id="9616" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">数据科学是一项非常重要的技能，已经成为21世纪的必备技能。随着数据的增加，对数据科学家的需求也增加了。说到学习数据科学，Python是首选的编程语言。Python附带了大量工具来帮助数据科学过程，其中最突出的工具之一是Pandas。在本文中，我们将了解如何使用Pandas库处理数据，以便它可以用于其他任务，如分析或机器学习。</p></div><div class="ab cl kt ku hr kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ig ih ii ij ik"><h2 id="e694" class="la lb in bd lc ld le dn lf lg lh dp li kg lj lk ll kk lm ln lo ko lp lq lr ls bi translated">什么是数据科学？</h2><p id="c00f" class="pw-post-body-paragraph jv jw in jx b jy lt ka kb kc lu ke kf kg lv ki kj kk lw km kn ko lx kq kr ks ig bi translated">令人惊讶的是，这个问题没有正确的答案。人们只以处理数据的方式来定义数据科学。事实上，数据科学是一个通用术语，涵盖了我们应用于数据的所有技术和程序。这就是为什么在寻找数据科学工作时，您会发现作为工作要求的各种工具可能彼此相关，也可能不相关，例如<strong class="jx io"> SQL、Python、R或Power BI </strong>。</p><p id="5772" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">从事提取数据和ETL工作的人会精通SQL，但可能会也可能不会Python。相反，一个建立机器学习模型的人会精通Python，但可能会也可能不会SQL。然而，这两个人都可以称自己为数据科学家，因为他们处理数据，但职责不同。</p><p id="205e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在本文中，我将解释数据清理和过滤是数据科学领域的一部分。如果你对<a class="ae ly" href="https://writersbyte.com/datascience/ai-for-beginners-2/?swcfpc=1" rel="noopener ugc nofollow" target="_blank">机器学习</a>感兴趣，那么你可以在这里开始阅读<a class="ae ly" href="https://writersbyte.com/datascience/implementing-multi-variable-linear-regression-algorithm-in-python/?swcfpc=1" rel="noopener ugc nofollow" target="_blank">。</a></p><div class="lz ma gp gr mb mc"><a href="https://writersbyte.com/datascience/implementing-multi-variable-linear-regression-algorithm-in-python/?swcfpc=1" rel="noopener  ugc nofollow" target="_blank"><div class="md ab fo"><div class="me ab mf cl cj mg"><h2 class="bd io gy z fp mh fr fs mi fu fw im bi translated">多元线性回归Python实现。</h2><div class="mj l"><h3 class="bd b gy z fp mh fr fs mi fu fw dk translated">机器学习算法在过去十年中获得了巨大的普及。今天，这些算法被用于…</h3></div><div class="mk l"><p class="bd b dl z fp mh fr fs mi fu fw dk translated">writersbyte.com</p></div></div><div class="ml l"><div class="mm l mn mo mp ml mq jt mc"/></div></div></a></div><h2 id="81ef" class="la lb in bd lc ld le dn lf lg lh dp li kg lj lk ll kk lm ln lo ko lp lq lr ls bi translated">下载数据</h2><p id="aa3f" class="pw-post-body-paragraph jv jw in jx b jy lt ka kb kc lu ke kf kg lv ki kj kk lw km kn ko lx kq kr ks ig bi translated">如果你得到了一份数据科学的工作，那么无论你为哪个组织工作，你都将与收集的真实世界一起工作。您必须使用…您猜对了…SQL从SQL数据库中提取数据！。然而，出于本教程的目的，我将从Kaggle下载一个开源数据集。</p><p id="ffcc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们将使用“世界能源消耗”数据集，您可以从<a class="ae ly" href="https://www.kaggle.com/pralabhpoudel/world-energy-consumption" rel="noopener ugc nofollow" target="_blank">这里</a>下载。</p><h2 id="9e01" class="la lb in bd lc ld le dn lf lg lh dp li kg lj lk ll kk lm ln lo ko lp lq lr ls bi translated">熊猫入门</h2><p id="cc77" class="pw-post-body-paragraph jv jw in jx b jy lt ka kb kc lu ke kf kg lv ki kj kk lw km kn ko lx kq kr ks ig bi translated">你将首先安装熊猫开始工作。只需在命令提示符下运行以下命令，就可以做到这一点。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="2941" class="la lb in mw b gy na nb l nc nd">pip install pandas</span></pre><p id="ee49" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果您不熟悉使用命令提示符或者只是一般地安装python的包，您可以从这里的开始阅读<a class="ae ly" href="https://writersbyte.com/programming/python-for-absolute-beginners-in-3-easy-steps/?swcfpc=1" rel="noopener ugc nofollow" target="_blank">。</a></p><div class="lz ma gp gr mb mc"><a href="https://writersbyte.com/programming/python-for-absolute-beginners-in-3-easy-steps/?swcfpc=1" rel="noopener  ugc nofollow" target="_blank"><div class="md ab fo"><div class="me ab mf cl cj mg"><h2 class="bd io gy z fp mh fr fs mi fu fw im bi translated">Python适合初学者，只需3个简单的步骤</h2><div class="mj l"><h3 class="bd b gy z fp mh fr fs mi fu fw dk translated">随着人工智能和数据获得越来越多的能力，Python变得越来越…</h3></div><div class="mk l"><p class="bd b dl z fp mh fr fs mi fu fw dk translated">writersbyte.com</p></div></div><div class="ml l"><div class="ne l mn mo mp ml mq jt mc"/></div></div></a></div><p id="1400" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">一旦Pandas安装完毕，我们就可以加载数据集了。</p><p id="6ed2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">先进口熊猫。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="d834" class="la lb in mw b gy na nb l nc nd">import pandas as pd</span></pre><p id="855f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">请注意，我们在上面的import语句中写了‘as PD ’,这是我们在Python中为导入设置别名的方式。因为很难在你使用本库的任何地方写出完整的术语Pandas，你可以简单地用术语‘PD’来引用它。</p><p id="af0c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">Pandas允许您从各种来源加载数据，如excel表、CSV(逗号分隔值)文件、文本文件，甚至SQL表。我们的数据是CSV文件的形式，所以我们将使用下面的函数来加载我们的数据集。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="0d43" class="la lb in mw b gy na nb l nc nd">world_power_data = pd.read_csv()</span></pre><p id="ab74" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们看看数据中有什么。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="af93" class="la lb in mw b gy na nb l nc nd">world_power_data.head()</span></pre><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nf"><img src="../Images/163ecd060a714948a98461f571e8f8db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ndBSbNbYuka6br5IR-1IIw.png"/></div></div><figcaption class="ng nh gj gh gi ni nj bd b be z dk translated">数据集的前5行</figcaption></figure><p id="353f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">。head() </strong>函数为我们提供了数据集的前5行(数据集的头)。我们可以在括号中输入任意数字作为参数传递，函数将返回与传递的数字相等的行数。</p><p id="6553" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">反过来，我们也有一个<strong class="jx io">。tail() </strong>函数的作用正好相反，即返回数据集的最后5行。</p><p id="890f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">看起来我们在这个数据集中有122列，让我们了解一下数据的概况。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="237d" class="la lb in mw b gy na nb l nc nd">world_power_data.info()</span></pre><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/dbddbb53438d2776936b6b86c754ec32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*pzTbF7tvL5JrzmmXIaSEQA.png"/></div></figure><p id="7f5c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">好的，我们有119列浮点值，1列整数，2列对象。Pandas中的对象数据类型仅仅意味着列包含多种数据类型的值。</p><p id="0aa4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们现在还知道数据集已经占用了<strong class="jx io"> <em class="nl"> 16.2+ MB的内存。</em>T11】</strong></p><p id="c369" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">所以这是一个非常庞大的数据集。</p><h2 id="c32a" class="la lb in bd lc ld le dn lf lg lh dp li kg lj lk ll kk lm ln lo ko lp lq lr ls bi translated">什么是数据框？</h2><p id="a4cf" class="pw-post-body-paragraph jv jw in jx b jy lt ka kb kc lu ke kf kg lv ki kj kk lw km kn ko lx kq kr ks ig bi translated">在我们继续进行数据分析之前，了解什么是数据框及其结构是很重要的。数据帧有3个基本部分。</p><ol class=""><li id="d565" class="nm nn in jx b jy jz kc kd kg no kk np ko nq ks nr ns nt nu bi translated">有标题行</li><li id="1ae0" class="nm nn in jx b jy nv kc nw kg nx kk ny ko nz ks nr ns nt nu bi translated">索引</li><li id="f183" class="nm nn in jx b jy nv kc nw kg nx kk ny ko nz ks nr ns nt nu bi translated">数据</li></ol><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/151ddb9214a910b2e31bc037b420b78b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*cEhUhTEoTDobM8izFteCjw.png"/></div><figcaption class="ng nh gj gh gi ni nj bd b be z dk translated">数据帧的结构</figcaption></figure><p id="baa7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">标题行</strong>定义数据的列名。<strong class="jx io">索引</strong>为每一行提供一个标识符，而<strong class="jx io">数据</strong>是数据帧的主要关键，即具有意义的数字数据。</p><p id="f809" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们可以使用索引和列跳转到数据集的任何行或列。</p><p id="19b6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">按索引</strong></p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="ef7c" class="la lb in mw b gy na nb l nc nd">world_power_data.loc[45:50] #return data rows from index no. 45 to 50</span></pre><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ob"><img src="../Images/01bd5351898f4f5e65c383ac2a5c9221.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DBqHlJbGKIVIi1odpfkD8g.png"/></div></div><figcaption class="ng nh gj gh gi ni nj bd b be z dk translated">索引数据帧</figcaption></figure><p id="60d5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">按列</strong></p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="f834" class="la lb in mw b gy na nb l nc nd">world_power_data[["country", "year", "coal_prod_change_pct", "coal_prod_change_twh" ,"gas_prod_change_pct"]].head() #show only certain columns</span></pre><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oc"><img src="../Images/80da1de766d26b8d37a56a0cead14d07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*pP0Z7yeE5o_C-rYAF8Lyxw.png"/></div></div><figcaption class="ng nh gj gh gi ni nj bd b be z dk translated">显示的特定列</figcaption></figure><p id="711a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">删除2020年数据</strong></p><p id="44be" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">看起来这个数据集只包含到2019年的值。让我们删除2020年的所有稀疏数据行。我们将在下面的步骤中做到这一点。</p><ul class=""><li id="a3ed" class="nm nn in jx b jy jz kc kd kg no kk np ko nq ks od ns nt nu bi translated">获取2020年数据行的索引</li></ul><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="1c49" class="la lb in mw b gy na nb l nc nd">twentytwenty_idx = world_power_data[world_power_data['year'] == 2020].index</span></pre><p id="592b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在告诉熊猫删除带有这些索引的列。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="a2c3" class="la lb in mw b gy na nb l nc nd">world_power_data.drop(index = twentytwenty_idx, inplace = True)</span></pre><p id="5efc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们已经删除了数据，但是我们弄乱了索引，因此为了保持整个数据框的一致性，我们需要重置索引。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="2540" class="la lb in mw b gy na nb l nc nd">world_power_data.reset_index(inplace = True)</span></pre><h2 id="0e38" class="la lb in bd lc ld le dn lf lg lh dp li kg lj lk ll kk lm ln lo ko lp lq lr ls bi translated">仅保留重点国家</h2><p id="a38e" class="pw-post-body-paragraph jv jw in jx b jy lt ka kb kc lu ke kf kg lv ki kj kk lw km kn ko lx kq kr ks ig bi translated">现在我们只想对一些特定的发达国家进行分析，因为这些国家是世界上主要的能源消费国。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="9e0b" class="la lb in mw b gy na nb l nc nd">#our focus countries<br/>focus_countries = ['United States', 'Canada', 'Russia', 'United Kingdom', 'China']</span><span id="3d4c" class="la lb in mw b gy oe nb l nc nd">#filter for focus countries<br/>power_data = world_power_data[world_power_data["country"].isin(focus_countries)]</span><span id="0624" class="la lb in mw b gy oe nb l nc nd">power_data</span></pre><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi of"><img src="../Images/f5c1419d11277177368f029c7b372712.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N1gq8QnmRCG0P0LXzgdi0w.png"/></div></div><figcaption class="ng nh gj gh gi ni nj bd b be z dk translated">仅限重点国家</figcaption></figure><h2 id="5348" class="la lb in bd lc ld le dn lf lg lh dp li kg lj lk ll kk lm ln lo ko lp lq lr ls bi translated">基于年份过滤数据</h2><p id="339a" class="pw-post-body-paragraph jv jw in jx b jy lt ka kb kc lu ke kf kg lv ki kj kk lw km kn ko lx kq kr ks ig bi translated">我们有自1900年以来的数据(这确实对这个数据集XD的可信度提出了质疑)。我们只想分析21世纪的数据，所以让我们开始过滤。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="88ce" class="la lb in mw b gy na nb l nc nd">power_data = power_data[power_data["year"] &gt;= 2000] #return data for only years greater than or equal to 2000</span><span id="28a6" class="la lb in mw b gy oe nb l nc nd">power_data</span></pre><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi og"><img src="../Images/d3568c0f968c792ac69c27dce18753fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s4j2KStp5fmTxUl4maYHJQ.png"/></div></div><figcaption class="ng nh gj gh gi ni nj bd b be z dk translated">过滤的年份</figcaption></figure><h2 id="7e4f" class="la lb in bd lc ld le dn lf lg lh dp li kg lj lk ll kk lm ln lo ko lp lq lr ls bi translated">列过滤</h2><p id="0065" class="pw-post-body-paragraph jv jw in jx b jy lt ka kb kc lu ke kf kg lv ki kj kk lw km kn ko lx kq kr ks ig bi translated">在这个数据集中，我们总共有122列。我们只对能源消耗数据感兴趣，所以我们只想保留那些列。</p><p id="e5ba" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们将首先创建一个包含术语'<strong class="jx io"> consumption </strong>'的所有列名的列表。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="dfda" class="la lb in mw b gy na nb l nc nd">#get column names with the word consumption in them<br/>consumption_cols = [col for col in power_data.keys()[power_data.keys().str.contains('consumption')]]</span></pre><p id="ec56" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">接下来，我们仍然需要国家名称和年份的标识符。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="7306" class="la lb in mw b gy na nb l nc nd">consumption_cols.append('country') #append country column<br/>consumption_cols.append('year') #append year column</span><span id="6fb7" class="la lb in mw b gy oe nb l nc nd">consumption_cols</span></pre><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/491d110f239b40e3b7d22fc861d6efca.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/1*35w0aWgsCFmNRMgwT2Jdgg.png"/></div><figcaption class="ng nh gj gh gi ni nj bd b be z dk translated">焦点列</figcaption></figure><p id="0cdd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们缩小数据集，只显示这些列。请注意，由于年份和国家被附加在列表的末尾，它们将作为最后一列出现，这对于我们的分析来说是没问题的，但是如果您出于美观的原因想要解决这个问题，那么您可以有几种变通方法。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="f3af" class="la lb in mw b gy na nb l nc nd">power_data = power_data[consumption_cols]</span><span id="071e" class="la lb in mw b gy oe nb l nc nd">power_data</span></pre><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oi"><img src="../Images/06e899da75553481d5febd725dc506c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8_waC0LLv339Q5lSMaZbNQ.png"/></div></div><figcaption class="ng nh gj gh gi ni nj bd b be z dk translated">只剩下15列了</figcaption></figure><h2 id="3c96" class="la lb in bd lc ld le dn lf lg lh dp li kg lj lk ll kk lm ln lo ko lp lq lr ls bi translated"><strong class="ak">总能耗</strong></h2><p id="b38f" class="pw-post-body-paragraph jv jw in jx b jy lt ka kb kc lu ke kf kg lv ki kj kk lw km kn ko lx kq kr ks ig bi translated">我们的下一个问题陈述是找出这些国家在过去20年中每种能源消耗的总能量。为此，我们将使用group by语句，group by是一个非常有用和重要的聚合工具。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="df0e" class="la lb in mw b gy na nb l nc nd">#group by country and sum the values in the remainig columns<br/>total_power_consumed = power_data.groupby(['country']).sum()</span></pre><p id="63e3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">上面的语句告诉pandas使用“country”列按数据分组，然后对其余列中的值求和。插图更好地解释了它。</p><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/f5c0e13af1d63d4f5b43d4c86cbc56b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zBYQemi9qosuEzqj8QNfvA.png"/></div></div><figcaption class="ng nh gj gh gi ni nj bd b be z dk translated">分组依据</figcaption></figure><p id="eda4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">您可以使用任何类型的聚合，例如平均值、计数等。year列的聚合没有意义，它甚至与我们的情况无关，因此我们可以忽略该列，甚至可以删除它。</p><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oj"><img src="../Images/18c8eb9853554b3326f7e8abeff64103.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a_jLYmMDPQRGJlOVqmWZ7A.png"/></div></div><figcaption class="ng nh gj gh gi ni nj bd b be z dk translated">按国家分组</figcaption></figure><p id="06d7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们现在有了每个国家每种资源类型的总耗电量。我们希望单独保存这些数据，这样我们就不必每次都进行分析。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="3634" class="la lb in mw b gy na nb l nc nd">total_power_consumed.to_csv('Total_Power_Consumed.csv') #save as csv</span></pre><p id="457a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">上面的函数将我们的数据保存为一个单独的CSV文件。</p><p id="b419" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们进行更多的分析。假设我们想回答以下问题。</p><p id="caac" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> <em class="nl">哪种资源在各国能源消费中使用最广泛？</em> </strong></p><p id="e734" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在回答这个问题之前，我们需要注意一个问题。在我们的数据中有一个名为'<em class="nl">primary _ energy _ consumption</em>的列，它给出了一个模糊的总能耗数字，但因为我们想要具体到单个能源资源的数据。所以我们将放弃这个专栏。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="8b58" class="la lb in mw b gy na nb l nc nd">total_power_consumed.drop(columns = ['primary_energy_consumption'],inplace = True)</span></pre><p id="06a6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在我们将首先看看哪个国家使用哪种能源最多。为此，我们将按列对数据集求和，并返回求和值最高的列的名称。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="0f44" class="la lb in mw b gy na nb l nc nd">total_power_consumed.idxmax(axis = 1) #which resource is consumed most</span></pre><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/54a0a63dd5c8736414a90b4ab3c7c508.png" data-original-src="https://miro.medium.com/v2/resize:fit:702/format:webp/1*WoP2lmDlbCF6iPwJKlzC7g.png"/></div><figcaption class="ng nh gj gh gi ni nj bd b be z dk translated">最大消耗量</figcaption></figure><p id="ba5e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">看起来每个人都使用<strong class="jx io"> <em class="nl">化石燃料</em> </strong>作为他们的主要能源发生器。</p><p id="f589" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在我们来看看这些消耗了多少。为此，我们将简单地返回按列求和的最大值。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="7bca" class="la lb in mw b gy na nb l nc nd">print(total_power_consumed.max(axis = 1))</span></pre><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/02a02bc076d1ed8c27c2a18d1a40dabc.png" data-original-src="https://miro.medium.com/v2/resize:fit:508/format:webp/1*fI9YCAD4bQrc6Eo99tycTA.png"/></div></figure><p id="6960" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">所以我们看到中国实际上只利用了<strong class="jx io"> <em class="nl">化石燃料</em> </strong>的<strong class="jx io">48k+TW</strong>电力！！</p><p id="6d7e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在是最后一个问题，让我们来回答一下在过去的二十年里，太阳能、风能、核能和化石燃料发电在美国的使用趋势是如何变化的。</p><p id="390a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">首先，我们只过滤美国的数据。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="263a" class="la lb in mw b gy na nb l nc nd">united_states = power_data[power_data["country"] == "United States"]<br/>united_states.reset_index(drop = True, inplace =True)</span></pre><p id="0ef1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">接下来，我们绘制各个列的数据。尽管我们有专门的工具来绘制Python，但是，Pandas本身也允许您直接从数据框中绘制数据。想学习python中的绘图，可以看下面。</p><div class="lz ma gp gr mb mc"><a href="https://writersbyte.com/programming/data-visualization-in-python-using-matplotlib/?swcfpc=1" rel="noopener  ugc nofollow" target="_blank"><div class="md ab fo"><div class="me ab mf cl cj mg"><h2 class="bd io gy z fp mh fr fs mi fu fw im bi translated">使用MatPlotLib - WritersByte在Python中进行数据可视化和分析</h2><div class="mj l"><h3 class="bd b gy z fp mh fr fs mi fu fw dk translated">人们经常提出的一个问题是“数据科学vs数据分析”。我们已经在许多其他方面讨论了数据科学…</h3></div><div class="mk l"><p class="bd b dl z fp mh fr fs mi fu fw dk translated">writersbyte.com</p></div></div><div class="ml l"><div class="om l mn mo mp ml mq jt mc"/></div></div></a></div><p id="59fc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">对于熊猫，我们做以下事情。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="7f75" class="la lb in mw b gy na nb l nc nd">united_states.plot('year',\<br/>                   ['solar_consumption','wind_consumption', 'nuclear_consumption', 'fossil_fuel_consumption'],\<br/>                   logy = True ,figsize= (16,12), title = "Trend of Energy Consumption in America")</span></pre><p id="cff2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这里我们指定了以下项目。</p><ol class=""><li id="6f3c" class="nm nn in jx b jy jz kc kd kg no kk np ko nq ks nr ns nt nu bi translated">“年份”应该用于x轴。</li><li id="de78" class="nm nn in jx b jy nv kc nw kg nx kk ny ko nz ks nr ns nt nu bi translated">用于y轴值的列。</li><li id="a2e8" class="nm nn in jx b jy nv kc nw kg nx kk ny ko nz ks nr ns nt nu bi translated">使用对数y轴(以清楚地看到趋势)</li><li id="f297" class="nm nn in jx b jy nv kc nw kg nx kk ny ko nz ks nr ns nt nu bi translated">将图形大小设置为[16x12]</li><li id="2520" class="nm nn in jx b jy nv kc nw kg nx kk ny ko nz ks nr ns nt nu bi translated">给情节起个标题。</li></ol><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi on"><img src="../Images/559b7c80e61ca9c16e5cfced4e486757.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MX1YQwtG0KrCJFwnAmaBdQ.png"/></div></div></figure><p id="c33d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">看起来化石燃料和核能的使用一直很稳定，然而风能和太阳能的使用却急剧上升。这很可能是因为电力需求的增加。</p><h2 id="5bb9" class="la lb in bd lc ld le dn lf lg lh dp li kg lj lk ll kk lm ln lo ko lp lq lr ls bi translated">最后的想法</h2><p id="7b81" class="pw-post-body-paragraph jv jw in jx b jy lt ka kb kc lu ke kf kg lv ki kj kk lw km kn ko lx kq kr ks ig bi translated">所以你上面看到的只是数据科学的一部分。这就是我们所说的数据处理。你问自己想从数据中获得什么样的洞察力，然后应用不同的处理技术来获得这种洞察力。本文旨在向您展示一些技术，您可以在数据集上应用这些技术来获得有价值的视觉效果。</p></div></div>    
</body>
</html>