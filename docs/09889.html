<html>
<head>
<title>Build Ansible AWX in Docker containers — Ansible AWX</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在码头集装箱中建造 AWX——AWX</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/build-ansible-awx-in-docker-containers-ansible-awx-aeefc7dcacfe?source=collection_archive---------3-----------------------#2022-09-20">https://blog.devgenius.io/build-ansible-awx-in-docker-containers-ansible-awx-aeefc7dcacfe?source=collection_archive---------3-----------------------#2022-09-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c8cc" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何在最新的 Fedora 中的 Docker 容器中构建可扩展的 AWX，并考虑到初步的需求。</h2></div><figure class="kf kg kh ki gt kj"><div class="bz fp l di"><div class="kk kl l"/></div></figure><h1 id="abb6" class="km kn iq bd ko kp kq kr ks kt ku kv kw jw kx jx ky jz kz ka la kc lb kd lc ld bi translated">如何在 Docker 容器中构建可扩展的 AWX？</h1><p id="7d59" class="pw-post-body-paragraph le lf iq lg b lh li jr lj lk ll ju lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">AWX 是 Ansible 自动化控制器的开源上游项目，包含在 Ansible 自动化平台(以前的 Ansible Tower)中。<br/>在 Docker 容器中运行，以使用现代的 web-UI 和 API 接口。仅向有经验的用户和开发人员推荐在 Docker 容器中运行。<br/>我是卢卡·伯尔顿，欢迎来到今天的《神秘飞行员》节目。</p><h1 id="1e32" class="km kn iq bd ko kp kq kr ks kt ku kv kw jw kx jx ky jz kz ka la kc lb kd lc ld bi translated">Ansible AWX</h1><p id="bd82" class="pw-post-body-paragraph le lf iq lg b lh li jr lj lk ll ju lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">Ansible AWX 仅支持<strong class="lg ir"> x86_64 </strong>操作系统:</p><ul class=""><li id="2677" class="ma mb iq lg b lh mc lk md ln me lr mf lv mg lz mh mi mj mk bi translated">Fedora(维护版本)</li><li id="5f13" class="ma mb iq lg b lh ml lk mm ln mn lr mo lv mp lz mh mi mj mk bi translated">LTS 的 Ubuntu(20.04 或 22.04)</li><li id="bfd9" class="ma mb iq lg b lh ml lk mm ln mn lr mo lv mp lz mh mi mj mk bi translated">红帽企业版 Linux 8+，CentOS Stream 8+</li><li id="7783" class="ma mb iq lg b lh ml lk mm ln mn lr mo lv mp lz mh mi mj mk bi translated">macOS 11</li></ul><p id="c9a5" class="pw-post-body-paragraph le lf iq lg b lh mc jr lj lk md ju lm ln mq lp lq lr mr lt lu lv ms lx ly lz ij bi translated">Ansible AWX 是 Ansible Automation Controller(以前的 Ansible Tower)的上游项目，它提供了一个现代化的 web-UI 和 API 界面来管理贵组织中团队之间的 Ansible 剧本、库存、凭证和保管库。</p><p id="ebdc" class="pw-post-body-paragraph le lf iq lg b lh mc jr lj lk md ju lm ln mq lp lq lr mr lt lu lv ms lx ly lz ij bi translated">在本地 Docker 容器中运行 AWX 允许您测试 AWX web-UI 和 API 来轻松管理 Ansible Playbook 的执行。AWX 在 Docker 上运行仅用于测试或开发；从版本 18.0 开始，首选方式是通过 AWX 运算符。这种初始配置有时对一些 Ansible AWX 用户来说是一个障碍。Ansible AWX 仅支持 x86_64 操作系统:</p><p id="b73b" class="pw-post-body-paragraph le lf iq lg b lh mc jr lj lk md ju lm ln mq lp lq lr mr lt lu lv ms lx ly lz ij bi translated">- Fedora(保留版本)</p><p id="aad2" class="pw-post-body-paragraph le lf iq lg b lh mc jr lj lk md ju lm ln mq lp lq lr mr lt lu lv ms lx ly lz ij bi translated">-LTS 乌班图(20.04 或 22.04)</p><p id="9696" class="pw-post-body-paragraph le lf iq lg b lh mc jr lj lk md ju lm ln mq lp lq lr mr lt lu lv ms lx ly lz ij bi translated">- Red Hat Enterprise Linux 8+，CentOS Stream 8+</p><p id="6f98" class="pw-post-body-paragraph le lf iq lg b lh mc jr lj lk md ju lm ln mq lp lq lr mr lt lu lv ms lx ly lz ij bi translated">- macOS 11</p><h1 id="704d" class="km kn iq bd ko kp kq kr ks kt ku kv kw jw kx jx ky jz kz ka la kc lb kd lc ld bi translated">链接</h1><ul class=""><li id="933a" class="ma mb iq lg b lh li lk ll ln mt lr mu lv mv lz mh mi mj mk bi translated"><a class="ae mw" href="https://github.com/ansible/awx/blob/devel/INSTALL.md" rel="noopener ugc nofollow" target="_blank">https://github.com/ansible/awx/blob/devel/INSTALL.md</a></li></ul><h1 id="1ba0" class="km kn iq bd ko kp kq kr ks kt ku kv kw jw kx jx ky jz kz ka la kc lb kd lc ld bi translated">演示</h1><p id="a9f4" class="pw-post-body-paragraph le lf iq lg b lh li jr lj lk ll ju lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">如何在 Docker 容器中构建可解析的 AWX？</p><p id="941f" class="pw-post-body-paragraph le lf iq lg b lh mc jr lj lk md ju lm ln mq lp lq lr mr lt lu lv ms lx ly lz ij bi translated">我将向您展示如何使用 Docker 容器和最新的受体图像在最新的 Fedora 中构建最新的 Ansible AWX。</p><p id="e974" class="pw-post-body-paragraph le lf iq lg b lh mc jr lj lk md ju lm ln mq lp lq lr mr lt lu lv ms lx ly lz ij bi translated">必须安装附加软件:</p><p id="e0c4" class="pw-post-body-paragraph le lf iq lg b lh mc jr lj lk md ju lm ln mq lp lq lr mr lt lu lv ms lx ly lz ij bi translated">- OpenSSL 库</p><p id="309f" class="pw-post-body-paragraph le lf iq lg b lh mc jr lj lk md ju lm ln mq lp lq lr mr lt lu lv ms lx ly lz ij bi translated">- Ansible</p><p id="3df6" class="pw-post-body-paragraph le lf iq lg b lh mc jr lj lk md ju lm ln mq lp lq lr mr lt lu lv ms lx ly lz ij bi translated">-码头工人</p><p id="6c45" class="pw-post-body-paragraph le lf iq lg b lh mc jr lj lk md ju lm ln mq lp lq lr mr lt lu lv ms lx ly lz ij bi translated">请注意，要在目标系统中安装最新的 Docker 技术，必须启动 Docker 服务，并将当前用户添加到<code class="fe mx my mz na b">docker</code>组中。此外，为了成功安装，必须安装最新的<a class="ae mw" href="https://pypi.org/project/docker-compose/" rel="noopener ugc nofollow" target="_blank"> docker-compose </a> Python 模块。</p><p id="03aa" class="pw-post-body-paragraph le lf iq lg b lh mc jr lj lk md ju lm ln mq lp lq lr mr lt lu lv ms lx ly lz ij bi translated">如何构建 Ansible AWX 基本容器映像并下载最新的 Ansible 接受器映像。</p><ol class=""><li id="f9e3" class="ma mb iq lg b lh mc lk md ln me lr mf lv mg lz nb mi mj mk bi translated">克隆最新的稳定标签 Ansible AWX 仓库</li></ol><p id="639f" class="pw-post-body-paragraph le lf iq lg b lh mc jr lj lk md ju lm ln mq lp lq lr mr lt lu lv ms lx ly lz ij bi translated"><code class="fe mx my mz na b">git clone -b x.y.z <a class="ae mw" href="https://github.com/ansible/awx.git" rel="noopener ugc nofollow" target="_blank">https://github.com/ansible/awx.git</a></code></p><p id="34b6" class="pw-post-body-paragraph le lf iq lg b lh mc jr lj lk md ju lm ln mq lp lq lr mr lt lu lv ms lx ly lz ij bi translated">将<code class="fe mx my mz na b">x.y.z</code>替换为<a class="ae mw" href="https://github.com/ansible/awx/releases/latest" rel="noopener ugc nofollow" target="_blank">最新发布版本号</a>(例如 21.5.0)。</p><ol class=""><li id="97a9" class="ma mb iq lg b lh mc lk md ln me lr mf lv mg lz nb mi mj mk bi translated">配置清单(可选)</li></ol><p id="f468" class="pw-post-body-paragraph le lf iq lg b lh mc jr lj lk md ju lm ln mq lp lq lr mr lt lu lv ms lx ly lz ij bi translated">您可以定制<code class="fe mx my mz na b">inventory</code>参数<code class="fe mx my mz na b">pg_password</code>、<code class="fe mx my mz na b">broadcast_websocket_secret</code>、<code class="fe mx my mz na b">secret_key</code>，以及部署所需的任何其他设置。</p><ol class=""><li id="9280" class="ma mb iq lg b lh mc lk md ln me lr mf lv mg lz nb mi mj mk bi translated">基于 AWX 的容器图像</li></ol><ul class=""><li id="1939" class="ma mb iq lg b lh mc lk md ln me lr mf lv mg lz mh mi mj mk bi translated">构建 AWX 基本容器映像。</li></ul><pre class="kf kg kh ki gt nc na nd ne aw nf bi"><span id="3ba4" class="ng kn iq na b gy nh ni l nj nk">$ make docker-compose-build</span></pre><p id="6c21" class="pw-post-body-paragraph le lf iq lg b lh mc jr lj lk md ju lm ln mq lp lq lr mr lt lu lv ms lx ly lz ij bi translated">该命令构建 AWX 基本容器映像(需要一段时间并连接到互联网以下载依赖项、包和库)。</p><p id="6684" class="pw-post-body-paragraph le lf iq lg b lh mc jr lj lk md ju lm ln mq lp lq lr mr lt lu lv ms lx ly lz ij bi translated">成功执行<code class="fe mx my mz na b">docker images</code>命令后，你会看到一个新的<code class="fe mx my mz na b">ansible/awx_devel</code>图像:</p><pre class="kf kg kh ki gt nc na nd ne aw nf bi"><span id="f390" class="ng kn iq na b gy nh ni l nj nk">[lberton@ansible awx]$ docker images<br/>REPOSITORY                  TAG       IMAGE ID       CREATED         SIZE<br/>ghcr.io/ansible/awx_devel   HEAD      4d593fc25fc2   21 hours ago    1.8GB</span></pre><p id="7767" class="pw-post-body-paragraph le lf iq lg b lh mc jr lj lk md ju lm ln mq lp lq lr mr lt lu lv ms lx ly lz ij bi translated">2.感受器图像</p><ul class=""><li id="0aec" class="ma mb iq lg b lh mc lk md ln me lr mf lv mg lz mh mi mj mk bi translated">下载受体图像</li></ul><p id="8dad" class="pw-post-body-paragraph le lf iq lg b lh mc jr lj lk md ju lm ln mq lp lq lr mr lt lu lv ms lx ly lz ij bi translated">该过程还从接收器下载最新的<code class="fe mx my mz na b">devel</code>图像。使用<code class="fe mx my mz na b">docker images</code>命令验证接收器图像已成功下载:</p><pre class="kf kg kh ki gt nc na nd ne aw nf bi"><span id="8e1e" class="ng kn iq na b gy nh ni l nj nk">[lberton@ansible awx]$ docker images<br/>REPOSITORY                  TAG       IMAGE ID       CREATED         SIZE<br/>quay.io/ansible/receptor    devel     981db0fc0f90   7 days ago      233MB</span></pre><p id="291c" class="pw-post-body-paragraph le lf iq lg b lh mc jr lj lk md ju lm ln mq lp lq lr mr lt lu lv ms lx ly lz ij bi translated">成功构建以没有任何错误的提示结束。</p><h1 id="b2ed" class="km kn iq bd ko kp kq kr ks kt ku kv kw jw kx jx ky jz kz ka la kc lb kd lc ld bi translated">概述</h1><p id="bde0" class="pw-post-body-paragraph le lf iq lg b lh li jr lj lk ll ju lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">现在您知道了如何在 Docker 容器中构建可解析的 AWX。</p><p id="f3d5" class="pw-post-body-paragraph le lf iq lg b lh mc jr lj lk md ju lm ln mq lp lq lr mr lt lu lv ms lx ly lz ij bi translated">我希望你喜欢读这篇文章。如果你愿意支持我成为一名作家，可以考虑注册<a class="ae mw" href="https://ansiblepilot.medium.com/membership" rel="noopener">成为</a>的媒体成员。每月只要 5 美元，你就可以无限制地使用 Medium。</p><p id="13f1" class="pw-post-body-paragraph le lf iq lg b lh mc jr lj lk md ju lm ln mq lp lq lr mr lt lu lv ms lx ly lz ij bi translated">订阅<a class="ae mw" href="https://www.youtube.com/channel/UC5MNbTYRHSCu9vAki3z9SmA" rel="noopener ugc nofollow" target="_blank"> YouTube 频道</a>、<a class="ae mw" href="https://ansiblepilot.medium.com/" rel="noopener"> Medium </a>、<a class="ae mw" href="https://ansiblepilot.substack.com/" rel="noopener ugc nofollow" target="_blank"> Substack </a>和<a class="ae mw" href="https://www.ansiblepilot.com/" rel="noopener ugc nofollow" target="_blank">网站</a>，不要错过 Ansible Pilot 的下一集。</p><h1 id="4027" class="km kn iq bd ko kp kq kr ks kt ku kv kw jw kx jx ky jz kz ka la kc lb kd lc ld bi translated">Ansible 的最佳资源</h1><h2 id="ee57" class="ng kn iq bd ko nl nm dn ks nn no dp kw ln np nq ky lr nr ns la lv nt nu lc nv bi translated">视频课程</h2><ul class=""><li id="241c" class="ma mb iq lg b lh li lk ll ln mt lr mu lv mv lz mh mi mj mk bi translated"><a class="ae mw" href="https://click.linksynergy.com/deeplink?id=euGmLrdj*Ec&amp;mid=39197&amp;murl=https%3A%2F%2Fwww.udemy.com%2Fcourse%2Fansible-by-examples-devops%2F%3FreferralCode%3D8E065F6D6F8622A3DEC8" rel="noopener ugc nofollow" target="_blank">通过 200 多个示例学习 Ansible Automation&amp;实践课程:通过一些真实的例子学习 Ansible，了解如何使用最常见的模块和 ansi ble 剧本</a>。</li></ul><h2 id="95fd" class="ng kn iq bd ko nl nm dn ks nn no dp kw ln np nq ky lr nr ns la lv nt nu lc nv bi translated">书</h2><ul class=""><li id="a1e3" class="ma mb iq lg b lh li lk ll ln mt lr mu lv mv lz mh mi mj mk bi translated"><a class="ae mw" href="https://www.amazon.com/Ansible-VMware-Examples-Step-Step/dp/1484288785/" rel="noopener ugc nofollow" target="_blank">ansi ble For VMware by Examples:VMware 基础架构自动化分步指南</a></li><li id="b922" class="ma mb iq lg b lh ml lk mm ln mn lr mo lv mp lz mh mi mj mk bi translated"><a class="ae mw" href="https://leanpub.com/ansiblebyexamples" rel="noopener ugc nofollow" target="_blank">可通过示例回答:针对 Linux 和 Windows 系统管理员和开发人员的 200 多个自动化示例</a></li><li id="2d17" class="ma mb iq lg b lh ml lk mm ln mn lr mo lv mp lz mh mi mj mk bi translated"><a class="ae mw" href="https://leanpub.com/ansibleforwindowsbyexamples" rel="noopener ugc nofollow" target="_blank">负责 Windows 示例:50 多个针对 Windows 系统管理员和开发人员的自动化示例</a></li><li id="0691" class="ma mb iq lg b lh ml lk mm ln mn lr mo lv mp lz mh mi mj mk bi translated"><a class="ae mw" href="https://leanpub.com/ansibleforlinuxbyexamples" rel="noopener ugc nofollow" target="_blank">ansi ble For Linux by Examples:100 多个针对 Linux 系统管理员和开发人员的自动化示例</a></li><li id="351a" class="ma mb iq lg b lh ml lk mm ln mn lr mo lv mp lz mh mi mj mk bi translated"><a class="ae mw" href="https://leanpub.com/linuxfileanddirectorybyansibleexamples" rel="noopener ugc nofollow" target="_blank"> Ansible Linux 文件系统示例:40 多个针对现代 IT 基础设施的 Linux 文件和目录操作自动化示例</a></li><li id="ded4" class="ma mb iq lg b lh ml lk mm ln mn lr mo lv mp lz mh mi mj mk bi translated"><a class="ae mw" href="https://leanpub.com/ansible-for-kubernetes-by-examples" rel="noopener ugc nofollow" target="_blank">通过示例负责容器和 Kubernetes:20 多个自动化示例来自动化容器、Kubernetes 和 OpenShift </a></li><li id="dd80" class="ma mb iq lg b lh ml lk mm ln mn lr mo lv mp lz mh mi mj mk bi translated"><a class="ae mw" href="https://leanpub.com/ansibleforsecuritybyexamples" rel="noopener ugc nofollow" target="_blank">负责安全示例:100 多个自动化示例，用于自动化现代 IT 基础设施的安全和验证合规性</a></li><li id="bee2" class="ma mb iq lg b lh ml lk mm ln mn lr mo lv mp lz mh mi mj mk bi translated"><a class="ae mw" href="https://leanpub.com/ansible-tips-and-tricks" rel="noopener ugc nofollow" target="_blank">可行的技巧和窍门:10 多个可行的例子来节省时间和自动化更多的任务</a></li><li id="3b5b" class="ma mb iq lg b lh ml lk mm ln mn lr mo lv mp lz mh mi mj mk bi translated"><a class="ae mw" href="https://leanpub.com/ansiblelinuxusersandgroupsbyexamples" rel="noopener ugc nofollow" target="_blank"> Ansible Linux 用户&amp;按示例分组:20 多个关于现代 IT 基础设施的 Linux 用户和分组操作的自动化示例</a></li><li id="6a6c" class="ma mb iq lg b lh ml lk mm ln mn lr mo lv mp lz mh mi mj mk bi translated"><a class="ae mw" href="https://leanpub.com/ansible-for-postgresql-by-examples" rel="noopener ugc nofollow" target="_blank">Ansible For PostgreSQL by Examples:10 多个自动化 PostgreSQL 数据库的示例</a></li><li id="c0f5" class="ma mb iq lg b lh ml lk mm ln mn lr mo lv mp lz mh mi mj mk bi translated"><a class="ae mw" href="https://leanpub.com/ansible-for-aws-by-examples" rel="noopener ugc nofollow" target="_blank">ansi ble For Amazon Web Services AWS By Examples:10 多个自动化 AWS 现代基础设施的示例</a></li></ul><h1 id="7205" class="km kn iq bd ko kp kq kr ks kt ku kv kw jw kx jx ky jz kz ka la kc lb kd lc ld bi translated">捐赠</h1><div class="nw nx gp gr ny nz"><a href="https://patreon.com/lucaberton" rel="noopener  ugc nofollow" target="_blank"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd ir gy z fp oe fr fs of fu fw ip bi translated">卢卡·伯尔顿正在为 Ansible | Patreon 创建软件开源</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">今天就成为卢卡·伯尔顿的赞助人:获得世界上最大会员的独家内容和体验…</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">patreon.com</p></div></div><div class="oi l"><div class="oj l ok ol om oi on oo nz"/></div></div></a></div><div class="nw nx gp gr ny nz"><a href="https://github.com/sponsors/lucab85" rel="noopener  ugc nofollow" target="_blank"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd ir gy z fp oe fr fs of fu fw ip bi translated">GitHub 赞助商上的赞助商@lucab85</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">我是一个活跃的开源贡献者，参与到了 Ansible 社区中，尽管我到处都是。@lucab85 的…</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">github.com</p></div></div><div class="oi l"><div class="op l ok ol om oi on oo nz"/></div></div></a></div><figure class="kf kg kh ki gt kj gh gi paragraph-image"><div role="button" tabindex="0" class="or os di ot bf ou"><div class="gh gi oq"><img src="../Images/13fd9e6e0efead6dd2416dc695f53811.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wXf8NcCVnjECVisQ5F8SvQ.png"/></div></div></figure></div></div>    
</body>
</html>