<html>
<head>
<title>Create a React Chord Diagram with the Visx Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Visx 库创建一个 React 和弦图</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/create-a-react-chord-diagram-with-the-visx-library-45664861cedc?source=collection_archive---------7-----------------------#2021-03-27">https://blog.devgenius.io/create-a-react-chord-diagram-with-the-visx-library-45664861cedc?source=collection_archive---------7-----------------------#2021-03-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/8cf20a5221836f4d340d0359c0bde9cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AkJPdJq0CScMBKH4"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">由<a class="ae kc" href="https://unsplash.com/@markus_gjengaar?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Markus Gjengaar </a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><p id="42f8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Visx 是一个库，让我们可以轻松地将图形添加到 React 应用程序中。</p><p id="5429" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解如何使用它将和弦图添加到 React 应用程序中。</p><h1 id="3ecb" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">安装所需的软件包</h1><p id="2968" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们必须安装一些模块。</p><p id="61e8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们运行:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="89df" class="mn lc iq mj b gy mo mp l mq mr">npm i @visx/chord @visx/gradient @visx/group @visx/responsive @visx/scale @visx/shape</span></pre><p id="8e2b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">安装软件包。</p><h1 id="4761" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">创建图表</h1><p id="04ad" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过添加模块提供的项目来创建图表。</p><p id="7bc9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们使用来自<code class="fe ms mt mu mj b">@visx/mock-data</code>模块的数据。</p><p id="7fee" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了创建和弦图，我们写下:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="4adf" class="mn lc iq mj b gy mo mp l mq mr">import React from "react";<br/>import { Arc } from "@visx/shape";<br/>import { Group } from "@visx/group";<br/>import { Chord, Ribbon } from "@visx/chord";<br/>import { scaleOrdinal } from "@visx/scale";<br/>import { LinearGradient } from "@visx/gradient";</span><span id="b2f7" class="mn lc iq mj b gy mv mp l mq mr">const pink = "#ff2fab";<br/>const orange = "#ffc62e";<br/>const purple = "#dc04ff";<br/>const purple2 = "#7324ff";<br/>const red = "#d04376";<br/>const green = "#52f091";<br/>const blue = "#04a6ff";<br/>const lime = "#00ddc6";<br/>const bg = "#e4e3d8";</span><span id="a512" class="mn lc iq mj b gy mv mp l mq mr">const dataMatrix = [<br/>  [11975, 5871, 8916, 2868],<br/>  [1951, 10048, 2060, 6171],<br/>  [8010, 16145, 8090, 8045],<br/>  [1013, 990, 940, 6907]<br/>];</span><span id="f553" class="mn lc iq mj b gy mv mp l mq mr">function descending(a, b) {<br/>  return b &lt; a ? -1 : b &gt; a ? 1 : b &gt;= a ? 0 : NaN;<br/>}</span><span id="d225" class="mn lc iq mj b gy mv mp l mq mr">const color = scaleOrdinal({<br/>  domain: [0, 1, 2, 3],<br/>  range: [<br/>    "url(#gpinkorange)",<br/>    "url(#gpurplered)",<br/>    "url(#gpurplegreen)",<br/>    "url(#gbluelime)"<br/>  ]<br/>});</span><span id="2149" class="mn lc iq mj b gy mv mp l mq mr">function Example({ width, height, centerSize = 20, events = false }) {<br/>  height -= 77;<br/>  const outerRadius = Math.min(width, height) * 0.5 - (centerSize + 10);<br/>  const innerRadius = outerRadius - centerSize;</span><span id="edf2" class="mn lc iq mj b gy mv mp l mq mr">return width &lt; 10 ? null : (<br/>    &lt;div className="chords"&gt;<br/>      &lt;svg width={width} height={height}&gt;<br/>        &lt;LinearGradient<br/>          id="gpinkorange"<br/>          from={pink}<br/>          to={orange}<br/>          vertical={false}<br/>        /&gt;<br/>        &lt;LinearGradient<br/>          id="gpurplered"<br/>          from={purple}<br/>          to={red}<br/>          vertical={false}<br/>        /&gt;<br/>        &lt;LinearGradient<br/>          id="gpurplegreen"<br/>          from={purple2}<br/>          to={green}<br/>          vertical={false}<br/>        /&gt;<br/>        &lt;LinearGradient id="gbluelime" from={blue} to={lime} vertical={false} /&gt;<br/>        &lt;rect width={width} height={height} fill={bg} rx={14} /&gt;<br/>        &lt;Group top={height / 2} left={width / 2}&gt;<br/>          &lt;Chord matrix={dataMatrix} padAngle={0.05} sortSubgroups={descending}&gt;<br/>            {({ chords }) =&gt; (<br/>              &lt;g&gt;<br/>                {chords.groups.map((group, i) =&gt; (<br/>                  &lt;Arc<br/>                    key={`key-${i}`}<br/>                    data={group}<br/>                    innerRadius={innerRadius}<br/>                    outerRadius={outerRadius}<br/>                    fill={color(i)}<br/>                    onClick={() =&gt; {<br/>                      if (events) alert(`${JSON.stringify(group)}`);<br/>                    }}<br/>                  /&gt;<br/>                ))}<br/>                {chords.map((chord, i) =&gt; {<br/>                  return (<br/>                    &lt;Ribbon<br/>                      key={`ribbon-${i}`}<br/>                      chord={chord}<br/>                      radius={innerRadius}<br/>                      fill={color(chord.target.index)}<br/>                      fillOpacity={0.75}<br/>                      onClick={() =&gt; {<br/>                        if (events) alert(`${JSON.stringify(chord)}`);<br/>                      }}<br/>                    /&gt;<br/>                  );<br/>                })}<br/>              &lt;/g&gt;<br/>            )}<br/>          &lt;/Chord&gt;<br/>        &lt;/Group&gt;<br/>      &lt;/svg&gt;<br/>      &lt;style jsx&gt;{`<br/>        .chords {<br/>          display: flex;<br/>          flex-direction: column;<br/>          user-select: none;<br/>        }<br/>        svg {<br/>          margin: 1rem 0;<br/>          cursor: pointer;<br/>        }<br/>        .deets {<br/>          display: flex;<br/>          flex-direction: row;<br/>          font-size: 12px;<br/>        }<br/>        .deets &gt; div {<br/>          margin: 0.25rem;<br/>        }<br/>      `}&lt;/style&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span><span id="5c78" class="mn lc iq mj b gy mv mp l mq mr">export default function App() {<br/>  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;Example width={500} height={300} /&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="42dd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们添加带有颜色代码的变量来设置和弦的颜色。</p><p id="c6e2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">dataMatrix</code>变量包含和弦的数据。</p><p id="4f7a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">descending</code>函数根据<code class="fe ms mt mu mj b">a</code>和<code class="fe ms mt mu mj b">b</code>的值返回一个数字，将排序改为降序。</p><p id="3461" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们创建<code class="fe ms mt mu mj b">color</code>变量来添加和弦的颜色范围。</p><p id="aa81" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe ms mt mu mj b">Example</code>组件中，我们添加了和弦图。</p><p id="e3c0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们添加<code class="fe ms mt mu mj b">LinearGradient</code>组件来为和弦添加渐变。</p><p id="254a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们在<code class="fe ms mt mu mj b">Group</code>组件中添加<code class="fe ms mt mu mj b">Chord</code>组件来添加和弦。</p><p id="00f0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们通过渲染<code class="fe ms mt mu mj b">Arc</code>组件来创建和弦组。</p><p id="17ac" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe ms mt mu mj b">Ribbon</code>组件渲染和弦本身。</p><p id="ebc8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们有一些风格来定位和弦图。</p><h1 id="5bd0" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="b36a" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用 Visx 库提供的 React 组件轻松创建和弦图。</p></div></div>    
</body>
</html>