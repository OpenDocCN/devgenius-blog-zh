<html>
<head>
<title>Web Scraping with Beautiful Soup — Attributes and Strings</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">漂亮汤的网页抓取——属性和字符串</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/web-scraping-with-beautiful-soup-attributes-and-strings-2f10f706251b?source=collection_archive---------1-----------------------#2021-01-30">https://blog.devgenius.io/web-scraping-with-beautiful-soup-attributes-and-strings-2f10f706251b?source=collection_archive---------1-----------------------#2021-01-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/7d382b7898348a01b7f10af82c064f98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xN5FmEyA_lrI0YXP"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@stevetsang?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">史蒂夫·曾</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="7804" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用美汤从网页上获取数据。</p><p id="ff10" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它让我们解析DOM并提取我们想要的数据。</p><p id="101a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇文章中，我们将看看如何用漂亮的汤刮HTML文档。</p><h1 id="2515" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">操纵属性</h1><p id="c47f" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用漂亮的汤来操纵属性。</p><p id="1c29" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="ca7a" class="mn lc iq mj b gy mo mp l mq mr">from bs4 import BeautifulSoup</span><span id="fc02" class="mn lc iq mj b gy ms mp l mq mr">tag = BeautifulSoup('&lt;b id="boldest"&gt;bold&lt;/b&gt;', 'html.parser').b<br/>tag['id'] = 'verybold'<br/>tag['another-attribute'] = 1<br/>print(tag)<br/>del tag['id']<br/>del tag['another-attribute']<br/>print(tag)</span></pre><p id="c136" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们只是在<code class="fe mt mu mv mj b">tag</code>字典中添加和删除条目来操作属性。</p><p id="f31f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后第一个<code class="fe mt mu mv mj b">print</code>语句打印出来:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="49dc" class="mn lc iq mj b gy mo mp l mq mr">&lt;b another-attribute="1" id="verybold"&gt;bold&lt;/b&gt;</span></pre><p id="ad3c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第二个打印:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="8582" class="mn lc iq mj b gy mo mp l mq mr">&lt;b&gt;bold&lt;/b&gt;</span></pre><h1 id="2fd9" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">多值属性</h1><p id="6275" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">美丽的汤与具有多个值的属性一起工作。</p><p id="4b4d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以解析:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="814c" class="mn lc iq mj b gy mo mp l mq mr">from bs4 import BeautifulSoup</span><span id="be68" class="mn lc iq mj b gy ms mp l mq mr">css_soup = BeautifulSoup('&lt;p class="body bold"&gt;&lt;/p&gt;', 'html.parser')<br/>print(css_soup.p['class'])</span></pre><p id="3ab6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们把<code class="fe mt mu mv mj b">[u’body’, u’bold’]</code>印出来。</p><p id="80bf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们将字典转换回字符串之后，所有的值都将被添加:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="0975" class="mn lc iq mj b gy mo mp l mq mr">from bs4 import BeautifulSoup</span><span id="a10e" class="mn lc iq mj b gy ms mp l mq mr">rel_soup = BeautifulSoup('&lt;p&gt;Back to the &lt;a rel="index"&gt;homepage&lt;/a&gt;&lt;/p&gt;', 'html.parser')<br/>rel_soup.a['rel'] = ['index', 'contents']<br/>print(rel_soup.p)</span></pre><p id="9772" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将打印出<code class="fe mt mu mv mj b">print</code>语句:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="d277" class="mn lc iq mj b gy mo mp l mq mr">&lt;p&gt;Back to the &lt;a rel="index contents"&gt;homepage&lt;/a&gt;&lt;/p&gt;</span></pre><p id="f02a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们用LXML解析一个带有n XML的文档，我们会得到相同的结果:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="936d" class="mn lc iq mj b gy mo mp l mq mr">from bs4 import BeautifulSoup</span><span id="9f11" class="mn lc iq mj b gy ms mp l mq mr">xml_soup = BeautifulSoup('&lt;p class="body strikeout"&gt;&lt;/p&gt;', 'lxml')<br/>print(xml_soup.p['class'])</span></pre><p id="b0e8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们仍然得到:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="99d7" class="mn lc iq mj b gy mo mp l mq mr">['body', 'strikeout']</span></pre><p id="fb90" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">印刷的。</p><h1 id="fb18" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><code class="fe mt mu mv mj b">NavigableString</code></h1><p id="f6b5" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以在标签中获取文本。例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="0e60" class="mn lc iq mj b gy mo mp l mq mr">from bs4 import BeautifulSoup</span><span id="23a2" class="mn lc iq mj b gy ms mp l mq mr">soup = BeautifulSoup('&lt;b class="boldest"&gt;Extremely bold&lt;/b&gt;', 'html.parser')<br/>tag = soup.b<br/>tag.string<br/>print(type(tag.string))</span></pre><p id="012c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们得到:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="a7fe" class="mn lc iq mj b gy mo mp l mq mr">&lt;class 'bs4.element.NavigableString'&gt;</span></pre><p id="4133" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">印刷的。</p><p id="3476" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">tag.string</code>属性在<code class="fe mt mu mv mj b">b</code>标签中有一个可导航的字符串。</p><p id="b4e2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以通过编写以下代码将其转换为Python字符串:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="02b5" class="mn lc iq mj b gy mo mp l mq mr">from bs4 import BeautifulSoup</span><span id="e237" class="mn lc iq mj b gy ms mp l mq mr">soup = BeautifulSoup('&lt;b class="boldest"&gt;Extremely bold&lt;/b&gt;', 'html.parser')<br/>tag = soup.b<br/>tag.string<br/>unicode_string = str(tag.string)<br/>print(unicode_string)</span></pre><p id="851a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后<code class="fe mt mu mv mj b"> ‘Extremely bold’</code>被打印。</p><p id="2ee5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用不同的字符串替换可导航的字符串。</p><p id="4e19" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们写道:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="41df" class="mn lc iq mj b gy mo mp l mq mr">from bs4 import BeautifulSoup</span><span id="2da4" class="mn lc iq mj b gy ms mp l mq mr">soup = BeautifulSoup('&lt;b class="boldest"&gt;Extremely bold&lt;/b&gt;', 'html.parser')<br/>tag = soup.b<br/>print(tag.string)<br/>tag.string.replace_with("No longer bold")<br/>print(tag.string)</span></pre><p id="2b9d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们看到:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="605e" class="mn lc iq mj b gy mo mp l mq mr">Extremely bold<br/>No longer bold</span></pre><p id="961d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">印刷的。</p><h1 id="1877" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><code class="fe mt mu mv mj b">BeautifulSoup Object</code></h1><p id="ef1e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated"><code class="fe mt mu mv mj b">BeautifulSoup</code>对象表示整个解析后的文档。</p><p id="2058" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，如果我们有:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="8b4e" class="mn lc iq mj b gy mo mp l mq mr">from bs4 import BeautifulSoup</span><span id="9e36" class="mn lc iq mj b gy ms mp l mq mr">doc = BeautifulSoup("&lt;document&gt;&lt;content/&gt;INSERT FOOTER HERE&lt;/document", "xml")<br/>footer = BeautifulSoup("&lt;footer&gt;Here's the footer&lt;/footer&gt;", "xml")<br/>doc.find(text="INSERT FOOTER HERE").replace_with(footer)<br/>print(doc)<br/>print(doc.name)</span></pre><p id="6329" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们看到:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="ba5f" class="mn lc iq mj b gy mo mp l mq mr">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/>&lt;document&gt;&lt;content/&gt;&lt;footer&gt;Here's the footer&lt;/footer&gt;&lt;/document&gt;</span></pre><p id="de23" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从第一次<code class="fe mt mu mv mj b">print</code>调用开始打印。</p><p id="79f7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">并且:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="4e4c" class="mn lc iq mj b gy mo mp l mq mr">[document]</span></pre><p id="0b64" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从第二次<code class="fe mt mu mv mj b">print</code>调用开始打印。</p><h1 id="743e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">注释和其他特殊字符串</h1><p id="4709" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">Beautiful Soup可以解析注释和其他特殊字符串。</p><p id="39ae" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="2b5f" class="mn lc iq mj b gy mo mp l mq mr">from bs4 import BeautifulSoup</span><span id="376b" class="mn lc iq mj b gy ms mp l mq mr">markup = "&lt;b&gt;&lt;!--Hey, buddy. Want to buy a used parser?--&gt;&lt;/b&gt;"<br/>soup = BeautifulSoup(markup, 'html.parser')<br/>comment = soup.b.string<br/>print(type(comment))<br/>print(soup.b.prettify())</span></pre><p id="9770" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以从带有<code class="fe mt mu mv mj b">soup.b.string</code>属性的<code class="fe mt mu mv mj b">b</code>元素中获取注释字符串。</p><p id="e609" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以第一个<code class="fe mt mu mv mj b">print</code>叫版画:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="62f1" class="mn lc iq mj b gy mo mp l mq mr">&lt;class 'bs4.element.Comment'&gt;</span></pre><p id="c2fa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第二次<code class="fe mt mu mv mj b">print</code>调用打印:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="7701" class="mn lc iq mj b gy mo mp l mq mr">&lt;b&gt;<br/> &lt;!--Hey, buddy. Want to buy a used parser?--&gt;<br/>&lt;/b&gt;</span></pre><h1 id="7edb" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="c9eb" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以操纵属性，用漂亮的汤处理字符串。</p></div></div>    
</body>
</html>