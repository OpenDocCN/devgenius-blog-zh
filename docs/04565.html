<html>
<head>
<title>Provisioning vs Configuration Management with Terraform</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Terraform进行供应和配置管理</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/provisioning-vs-configuration-management-with-terraform-4bf07b9c79db?source=collection_archive---------1-----------------------#2021-04-04">https://blog.devgenius.io/provisioning-vs-configuration-management-with-terraform-4bf07b9c79db?source=collection_archive---------1-----------------------#2021-04-04</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="9a52" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">以代码形式介绍地形和基础设施</p><p id="c9d9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我信奉的格言之一是阿尔伯特·爱因斯坦说的:“如果你不能简单地解释某件事，你可能还不够理解它”。</p><p id="62b6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">时不时会有新概念、新方法或新方式的引入，这些概念、方法或方式彻底改变了it行业，并推动IT向前发展。这些词很好地概括了它:版本控制、敏捷、CI/CD、DevOps、站点可靠性工程、云计算、虚拟化、容器化、编排、基础设施即代码等。</p><p id="9121" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，有了这些新的概念、方法和做事的方式<strong class="jm io"><em class="ki">——来了很多工具</em> </strong>。它们被构建来为IT专业人员提供媒介，以便为他们的组织实现那些新概念、方法或过程。下面是一个例子:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/36ee24f03653ed87dbb5afad6ff9acde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KfC5CcUPKUCrfVNSCF_tig.jpeg"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk translated">来源:<a class="ae kz" href="http://www.jamesbowman.me/post/continuous-delivery-tool-landscape/?utm_content=bufferb129e&amp;utm_medium=social&amp;utm_source=twitter.com&amp;utm_campaign=buffer" rel="noopener ugc nofollow" target="_blank"> jamesbowman.me </a></figcaption></figure><ul class=""><li id="9d90" class="la lb in jm b jn jo jr js jv lc jz ld kd le kh lf lg lh li bi translated">Terraform 是<strong class="jm io">基础设施即代码最流行的工具之一。</strong></li></ul><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi lj"><img src="../Images/3da576c458ec90794fa750ec17c81a1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xRAEY0B6mBbmrYCoNTHMjg.png"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk translated">来源:<a class="ae kz" href="https://www.terraform.io/" rel="noopener ugc nofollow" target="_blank"> terraform.io </a></figcaption></figure><p id="4acf" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">正如您可能知道的那样，市场上有各种其他工具可供您使用，来实现所有这些新概念、方法和做事的方式，而决定选择哪一个可能会很麻烦。</p><p id="70bb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在选择这些工具时，了解以下细节并在决策中加以考虑是非常重要的:</p><blockquote class="lk ll lm"><p id="a802" class="jk jl ki jm b jn jo jp jq jr js jt ju ln jw jx jy lo ka kb kc lp ke kf kg kh ig bi translated">-配置管理与供应<br/> -程序性与声明性<br/> -可变与不可变基础设施<br/> -主控与无主<br/> -代理与无代理<br/> *哪些工具拥有大型社区与小型社区—工具文档等</p></blockquote><p id="9fee" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在本文中，我将探讨配置管理与供应。它们如何不同，但又相互关联，并展示了一个小演示。</p><h1 id="516d" class="lq lr in bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">配置管理与配置</h1><blockquote class="lk ll lm"><p id="db5e" class="jk jl ki jm b jn jo jp jq jr js jt ju ln jw jx jy lo ka kb kc lp ke kf kg kh ig bi translated"><strong class="jm io">什么是准备金？</strong></p><p id="700b" class="jk jl ki jm b jn jo jp jq jr js jt ju ln jw jx jy lo ka kb kc lp ke kf kg kh ig bi translated">资源调配是设置IT基础架构的过程。它还可以指管理对数据和资源的访问并使它们对用户和系统可用所需的步骤。一旦<strong class="jm io">配置好</strong>，下一步就是<strong class="jm io">配置</strong>。</p></blockquote><p id="197b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">CloudFormation、Terraform、Ansible、Salt、流浪者、木偶、码头工人等是可以用于<strong class="jm io">供应的工具。</strong></p><p id="3931" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这些工具旨在配置所需的基础架构，如服务器(虚拟机)、负载平衡器、数据库、网络配置等。将配置工作留给配置管理及其工具。</p><blockquote class="lk ll lm"><p id="0852" class="jk jl ki jm b jn jo jp jq jr js jt ju ln jw jx jy lo ka kb kc lp ke kf kg kh ig bi translated"><strong class="jm io">什么是配置管理</strong>？</p><p id="3d07" class="jk jl ki jm b jn jo jp jq jr js jt ju ln jw jx jy lo ka kb kc lp ke kf kg kh ig bi translated">配置管理是一个系统工程过程，用于建立和维护计算机系统、服务器和软件，使其处于期望的、一致的性能状态。管理IT系统配置包括定义系统的期望状态——比如服务器<strong class="jm io"> c </strong>配置——然后构建和维护这些系统。</p></blockquote><p id="9000" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">厨师，木偶，Ansible，章鱼部署，团队，竹子，地形等。也可以作为<strong class="jm io">的配置管理工具。</strong></p><p id="19bb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这种情况下，它们被设计或设置为在现有基础设施上安装软件包或软件、管理软件和配置。到目前为止，您一定已经注意到，用于配置的工具也可以用于配置管理。这是因为:</p><blockquote class="mo"><p id="0c75" class="mp mq in bd mr ms mt mu mv mw mx kh dk translated">P <strong class="ak"> <em class="my">供应和配置管理并不相互排斥。大多数配置管理工具可以进行某种程度的配置，反之亦然。</em></strong></p></blockquote><p id="25bd" class="pw-post-body-paragraph jk jl in jm b jn mz jp jq jr na jt ju jv nb jx jy jz nc kb kc kd nd kf kg kh ig bi translated">但是请记住，其中一些工具将更适合某些类型的任务。这需要考虑您的IT组织设置和您想要实现的目标。也就是说，在大多数情况下，一个好的替代方法是同时使用配置管理和供应工具。</p><p id="0b48" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">例如，使用<strong class="jm io"> Terraform </strong>进行配置，同时运行<strong class="jm io"> Chef </strong>来配置您的基础架构，或者使用<strong class="jm io"> Ansible </strong>来配置您的基础架构，同时运行<strong class="jm io"> Chef </strong>进行配置管理或任何适合您的工作。</p><p id="318e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在决定使用哪种工具时，理解工具的用途是很重要的。在你选择了要使用的工具后，你可以对如何使用做更多的研究或培训。</p><p id="52f9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">最重要的是，理解<strong class="jm io">为什么</strong>我们首先使用这些工具或者按照我们的方式做事是为你的组织实现一个非常酷和成功的IT基础设施的关键。</p><p id="b186" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">理想情况下，当实施新的解决方案或对您的基础架构进行更改时。尝试简单地定义并与组织中的其他人交流，如下所示:</p><blockquote class="mo"><p id="9aa5" class="mp mq in bd mr ms mt mu mv mw mx kh dk translated">我们有一个难题或问题X——我们可以用概念或技术Y来解决——使用工具或平台Z</p></blockquote><p id="5319" class="pw-post-body-paragraph jk jl in jm b jn mz jp jq jr na jt ju jv nb jx jy jz nc kb kc kd nd kf kg kh ig bi translated">要了解更多信息，请查看<a class="ae kz" href="https://pubs.opengroup.org/dpbok/standard/DPBoK.html" rel="noopener ugc nofollow" target="_blank"> DPBoK </a>上一些非常有见地的阅读材料</p></div><div class="ab cl ne nf hr ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ig ih ii ij ik"><h1 id="649e" class="lq lr in bd ls lt nl lv lw lx nm lz ma mb nn md me mf no mh mi mj np ml mm mn bi translated"><strong class="ak">平台式陈列柜</strong></h1><p id="42c3" class="pw-post-body-paragraph jk jl in jm b jn nq jp jq jr nr jt ju jv ns jx jy jz nt kb kc kd nu kf kg kh ig bi translated">对于这个展示演示，我们正在研究一个演示Nodejs项目，这个项目的全部内容是由<a class="ae kz" href="https://www.stthomas.edu/gradsoftware/about/faculty/charles-betz.html" rel="noopener ugc nofollow" target="_blank"> Charles Betz </a>教授为<a class="ae kz" href="https://www.stthomas.edu/gradsoftware/" rel="noopener ugc nofollow" target="_blank">圣托马斯大学</a>(明尼苏达州圣保罗)的<a class="ae kz" href="https://www.coursicle.com/stthomas/courses/SEIS/664/" rel="noopener ugc nofollow" target="_blank"> SEIS 664 IT交付课程</a> —研究生院级别编写和设计的。请随意查看Gitlab repo、<a class="ae kz" href="https://gitlab.com/charlestbetz/dp-course" rel="noopener ugc nofollow" target="_blank">课程内容</a>和<a class="ae kz" href="https://gitlab.com/charlestbetz/node-svc" rel="noopener ugc nofollow" target="_blank">演示项目</a>以了解更多信息。</p><ul class=""><li id="dcdb" class="la lb in jm b jn jo jr js jv lc jz ld kd le kh lf lg lh li bi translated">本项目托管在<a class="ae kz" href="https://cloud.google.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> <em class="ki"> Google云平台</em> </strong> </a>上并设置使用:</li></ul><blockquote class="lk ll lm"><p id="bf3c" class="jk jl ki jm b jn jo jp jq jr js jt ju ln jw jx jy lo ka kb kc lp ke kf kg kh ig bi translated"><strong class="jm io">容器化的Docker</strong>:容器允许你创建独立的环境来运行你的应用程序。在实现不可变的基础设施模型方面，它们比虚拟机有一些显著的优势</p></blockquote><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="nv nw l"/></div></figure><blockquote class="lk ll lm"><p id="556e" class="jk jl ki jm b jn jo jp jq jr js jt ju ln jw jx jy lo ka kb kc lp ke kf kg kh ig bi translated">协调的库贝内特斯:大规模运行容器是完全不同的，一种被称为<strong class="jm io">协调器</strong>的特殊工具被用于这项任务。这就是Kubernetes的用武之地。</p></blockquote><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk translated">Kubernetes部署清单</figcaption></figure><p id="20d8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">然后可以使用下面的<strong class="jm io"> <em class="ki"> kubectl </em> </strong>命令在Kubernetes集群中创建部署对象:</p><pre class="kk kl km kn gt nx ny nz oa aw ob bi"><span id="6ab1" class="oc lr in ny b gy od oe l of og">$ kubectl apply -f deployments.yaml</span></pre><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi oh"><img src="../Images/3d24686ec59aa8f402864ae64b2eeaf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fVi3TYv7VzUdbdU41Ug_uA.png"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk translated">来源:<a class="ae kz" href="https://kubernetes.io/docs/tutorials/kubernetes-basics/explore/explore-intro/" rel="noopener ugc nofollow" target="_blank"> kubernetes.io </a></figcaption></figure><p id="717c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">大规模运行应用程序意味着运行分布在多个虚拟机上的多个容器。这可能会导致诸如<em class="ki"> </em>所有这些应用程序容器之间的负载平衡问题，以及定义连接到应用程序的单一入口点。这就是<strong class="jm io"> <em class="ki"> Kubernetes服务清单</em> </strong>出现的地方，看起来像这样:</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk translated">Kubernetes服务清单—用于我的Nodejs演示项目</figcaption></figure><blockquote class="lk ll lm"><p id="7603" class="jk jl ki jm b jn jo jp jq jr js jt ju ln jw jx jy lo ka kb kc lp ke kf kg kh ig bi translated"><strong class="jm io">用于供应的Terraform&amp;配置管理</strong> : Kubernetes集群可以使用terra form进行描述，以便通过代码进行管理。</p><p id="585b" class="jk jl ki jm b jn jo jp jq jr js jt ju ln jw jx jy lo ka kb kc lp ke kf kg kh ig bi translated">我们正在使用Terraform代码创建一个Kubernetes集群；应创建的集群。使用Terraform <a class="ae kz" href="https://www.terraform.io/intro/getting-started/variables.html" rel="noopener ugc nofollow" target="_blank">输入变量</a>来参数化集群的创建允许你轻松地改变配置参数。这按如下方式完成:</p></blockquote><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk translated"><code class="fe oi oj ok ny b">main.tf</code>保存关于应该创建的集群的所有信息</figcaption></figure><p id="e5ab" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">使用Terraform <a class="ae kz" href="https://www.terraform.io/intro/getting-started/variables.html" rel="noopener ugc nofollow" target="_blank">输入变量</a>对集群创建进行参数化，这允许您轻松更改配置参数:</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="nv nw l"/></div></figure><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="345d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，可以通过运行以下脚本来重建Terraform集群:</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="nv nw l"/></div></figure><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi ol"><img src="../Images/81bed70462d16229ff953bec93f6f3a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*mS8mbOtqZYN4y_WDbNlWdA.gif"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk translated">使用Terraform进行配置的屏幕截图</figcaption></figure><blockquote class="lk ll lm"><p id="2650" class="jk jl ki jm b jn jo jp jq jr js jt ju ln jw jx jy lo ka kb kc lp ke kf kg kh ig bi translated"><strong class="jm io">用于源代码管理的git lab—CI/CD管道</strong>:下面是这个项目的一个<a class="ae kz" href="https://docs.gitlab.com/ee/ci/quick_start/index.html" rel="noopener ugc nofollow" target="_blank"> Gitlab CI/CD </a>脚本的样子:</p></blockquote><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="b3c1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们已经创建了集群，并配置了应用运行所需的资源基础架构，现在让我们来看看目前为止我们都有什么:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi om"><img src="../Images/8a530f06f4212a6ea137528b54b78b0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*-_TFcc9Jl7Iw3TAvgDoEmA.gif"/></div></div></figure><p id="e38c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在你可以注意到它们不是正在运行的吊舱。这是因为构建和部署需要通过自动化的Gitlab CI/DC管道运行:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi om"><img src="../Images/412df0ef5185c05c689381cf5431d703.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*dtz1_NAsgmSMc3_8oPUK8w.gif"/></div></div></figure><p id="212f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">搞定了。😎🥳:这样，我现在可以通过代码来管理我的应用程序的各个方面，这是infratcure as code的基础。通过运行以下terraform脚本，可以简单地销毁或"<strong class="jm io"><em class="ki"/></strong>"取消调配所有创建的资源:</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="nv nw l"/></div></figure><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi om"><img src="../Images/57ce8f05573858fbabc4c0872da6e09e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*CgMLTZ673tRzgbfOJZeyNw.gif"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk translated">使用terraform取消配置的<strong class="bd ls"> <em class="my">屏幕截图。</em> </strong></figcaption></figure><blockquote class="lk ll lm"><p id="1600" class="jk jl ki jm b jn jo jp jq jr js jt ju ln jw jx jy lo ka kb kc lp ke kf kg kh ig bi translated"><em class="in">如果你喜欢这个，你可能也会喜欢:</em> <a class="ae kz" href="https://blog.bitsrc.io/github-actions-how-to-deploy-angular-app-to-firebase-hosting-89a93f9c4fe1" rel="noopener ugc nofollow" target="_blank"> Github Actions:如何将Angular App部署到Firebase主机</a></p></blockquote><blockquote class="mo"><p id="2101" class="mp mq in bd mr ms on oo op oq or kh dk translated">干杯！！！</p></blockquote></div></div>    
</body>
</html>