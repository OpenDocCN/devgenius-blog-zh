<html>
<head>
<title>Create a web editor using Monaco editor, React and Node + Webpack and Typescript … How hard can it be?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Monaco editor，React 和 Node + Webpack 和 Typescript 创建一个 web 编辑器……能有多难？</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/create-a-web-editor-using-monaco-editor-react-and-node-webpack-and-typescript-how-hard-can-it-597332454a24?source=collection_archive---------4-----------------------#2022-04-25">https://blog.devgenius.io/create-a-web-editor-using-monaco-editor-react-and-node-webpack-and-typescript-how-hard-can-it-597332454a24?source=collection_archive---------4-----------------------#2022-04-25</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div class="gh gi jk"><img src="../Images/d07c1993cd7eb52f1c79cf70ac3e9261.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*Xf5C1RR9neKJznN6MnM-gA.gif"/></div><figcaption class="jr js gj gh gi jt ju bd b be z dk translated">网络编辑器</figcaption></figure><p id="0692" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">嗯，这是有点棘手，但没有那么难。你只需要克隆这个回购😛。开玩笑的。</p><p id="ddc9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">到目前为止，世界上几乎所有的服务都在向云迁移，并且正在数字化。由于疫情的原因，即使是在这种数字化转型背后的国家现在也在加速进行数字化(我认为这在我的国家斯里兰卡是一种趋势，因为人们现在正在寻求在线服务，而不是去商店或商业服务中心)。这和我要讨论的主题不太相关，但是..良好的..至少我们正在尝试将我们本地机器上的代码编辑工具转变成一个在线服务，在这里可以很容易地集成许多功能，如团队协作、轻松审查。</p><h1 id="50c9" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">准备环境</strong></h1><p id="ca43" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated">在深入主题之前，让我们准备好您的环境，以便您可以实现它。</p><p id="c772" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">先决条件</strong>:</p><p id="257a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><a class="ae kt" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank">节点</a> : v16.9.0 <br/> NPM: 7.21.1</p><p id="412e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">另外，如果你不是 VSCode 的粉丝，请准备好带有<a class="ae kt" href="https://www.typescriptlang.org/" rel="noopener ugc nofollow" target="_blank"> Typescript </a>插件的编辑器。</p><h1 id="f6fd" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">创建节点应用</strong></h1><p id="c2c7" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated">首先，让我们设置节点应用程序来集成 Monaco 编辑器。我将要创建的应用程序的文件夹结构如下。你们可以复制同样的结构。您也可以使用 cmd <code class="fe lx ly lz ma b"><a class="ae kt" href="https://docs.npmjs.com/cli/v8/commands/npm-init" rel="noopener ugc nofollow" target="_blank">npm init</a></code>来启动项目。这将为模块创建 package.json。你也可以在这里检查你能用这个工具<a class="ae kt" href="https://docs.npmjs.com/cli/v8/commands/npm-init#examples" rel="noopener ugc nofollow" target="_blank">做什么。无论如何，我要保持简单，手动创建应用程序。</a></p><figure class="mc md me mf gt jo gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/cae0a1a3f8b6fc69b7219f549882a187.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*LYLu7XsGxJegyVDrzb8zig.png"/></div><figcaption class="jr js gj gh gi jt ju bd b be z dk translated">初始结构</figcaption></figure><p id="fb2e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">以上结构将是我们该项目的第一个文件和文件夹结构。下一步，让我们添加应用程序实现所需的依赖项。</p><p id="a3f0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> Package.json </strong></p><figure class="mc md me mf gt jo"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="efe0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果你检查<em class="mi">依赖关系</em>，我<em class="mi"> </em>增加了<code class="fe lx ly lz ma b">monaco-editor</code>、<code class="fe lx ly lz ma b">monaco-editor-core</code>、<code class="fe lx ly lz ma b">monaco-languageclient</code>和<code class="fe lx ly lz ma b">react</code>，我还增加了一个叫做<code class="fe lx ly lz ma b">react-monaco-editor</code>的东西。</p><p id="a625" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe lx ly lz ma b"><a class="ae kt" href="https://www.npmjs.com/package/react-monaco-editor" rel="noopener ugc nofollow" target="_blank">react-monaco-editor</a></code>是一个包装了 Monaco 编辑器库的库，支持 react。但是在我们使用的打包工具内部几乎没有什么工作要做，在这个例子中是<code class="fe lx ly lz ma b">webpack</code>来运行它。还有像<a class="ae kt" href="https://www.npmjs.com/package/@monaco-editor/react" rel="noopener ugc nofollow" target="_blank"> @monaco-editor/react </a>这样的新库，我还没有深入研究，但我会在本系列的未来部分尝试用这些新库更新这个应用程序。</p><p id="6689" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> tsconfig.json </strong></p><p id="e1fc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">下一步，让我们添加<a class="ae kt" href="https://www.typescriptlang.org/docs/handbook/tsconfig-json.html" rel="noopener ugc nofollow" target="_blank"><em class="mi">ts config . JSON</em></a>文件，该文件配置与 typescript 相关的编译选项。</p><figure class="mc md me mf gt jo"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="3ef1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">安装完 typescript 后，您可以使用命令<code class="fe lx ly lz ma b">tsc — -init</code>轻松地创建这个文件，它将使用 Typescript 编译器的默认选项生成这个文件。你可以看到我已经添加了<code class="fe lx ly lz ma b">./build</code>作为输出目录，包括了<code class="fe lx ly lz ma b">src</code>目录，并且排除了测试和<code class="fe lx ly lz ma b">node_modules</code>被编译器编译。这只是使用 typescript 编写的 node react 应用程序的常见配置。</p><p id="3791" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> webpack.config.ts </strong></p><p id="10dd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们编辑 Webpack 配置文件来配置我们的打包。</p><figure class="mc md me mf gt jo"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="6bb1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">正如你在<code class="fe lx ly lz ma b">webpack.config.js</code>顶部看到的，这些是打包我们的应用程序所需的插件。其中<code class="fe lx ly lz ma b">MonacoWebpackPlugin</code>和<code class="fe lx ly lz ma b">WebpackRequireFrom</code>是我们需要处理 Monaco 编辑器集成的两个插件。</p><ul class=""><li id="5bc1" class="mj mk in jx b jy jz kc kd kg ml kk mm ko mn ks mo mp mq mr bi translated"><code class="fe lx ly lz ma b">MonacoWebpackPlugin</code>将帮助我们加载带有 webpack 的 Monaco 编辑器。</li><li id="542b" class="mj mk in jx b jy ms kc mt kg mu kk mv ko mw ks mo mp mq mr bi translated"><code class="fe lx ly lz ma b">WebpackRequireFrom</code>将帮助我们处理加载动态内容，这些内容在运行时被延迟加载到我们想要的位置。这将有助于当我们在 URI 有路径，并需要在一个路径下加载应用程序，并从该路径解析资源。</li></ul><p id="db16" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">你也可以在<code class="fe lx ly lz ma b">resolve</code>下看到我为节点级库添加了几个别名。所以这些别名帮助<code class="fe lx ly lz ma b">monaco</code>和<code class="fe lx ly lz ma b">vscode-languageclient</code>在浏览器上工作。此外，如果你检查我已经注册了一个过程节点库提供程序插件，并使其在浏览器中可用，以帮助运行摩纳哥编辑器。</p><h1 id="b2d5" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">实施应用</strong></h1><p id="aaf7" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated">好了，既然我们配置了节点应用程序，那么让我们来看看应用程序的实现。</p><figure class="mc md me mf gt jo gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/9e9640dd1860ef3a98ef1df51fc4065c.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*t8e85ArwzdEnKwAdgw0kUw.png"/></div><figcaption class="jr js gj gh gi jt ju bd b be z dk translated">源文件夹结构</figcaption></figure><p id="a0a7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">以上是源文件夹的文件夹结构。其中大部分只是普通的 react 应用程序实现，你可以在我为这个示例应用程序创建的 GitHub repo 中查看。在这里，我将重点关注集成了 Monaco 编辑器的组件<code class="fe lx ly lz ma b">editor</code>。</p><figure class="mc md me mf gt jo"><div class="bz fp l di"><div class="mg mh l"/></div><figcaption class="jr js gj gh gi jt ju bd b be z dk translated">编辑器组件</figcaption></figure><p id="2e85" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果您检查组件函数，您可以看到它返回了<code class="fe lx ly lz ma b">&lt;MonacoEditor /&gt;</code>组件。因此，您需要向 MonacoEditor 组件传递一些道具来使其工作，其中有一些非常基本的道具，即<code class="fe lx ly lz ma b">width</code> <code class="fe lx ly lz ma b">height</code> <code class="fe lx ly lz ma b">language</code> <code class="fe lx ly lz ma b">theme</code> <code class="fe lx ly lz ma b">options</code> <code class="fe lx ly lz ma b">onChange</code>和<code class="fe lx ly lz ma b">editorDidMount</code>。</p><p id="4477" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe lx ly lz ma b">width</code>和<code class="fe lx ly lz ma b">height</code>将设置编辑器的高度和宽度。这些是接受 css 的单位。</p><p id="2923" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">使用<code class="fe lx ly lz ma b">language</code>道具你可以设置 Monaco 编辑器应该支持的语言。这将决定摩纳哥方面将添加哪些语法突出显示和语言功能配置。您也可以在这里注册您自己的语言，并为该语言添加语法突出显示和语言功能。但是在这里我将添加一个已经在 Monaco 编辑器中<a class="ae kt" href="https://microsoft.github.io/monaco-editor/" rel="noopener ugc nofollow" target="_blank">支持的语言</a>，JSON。</p><p id="6514" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">对于<code class="fe lx ly lz ma b">theme</code>你可以使用内置主题或<a class="ae kt" href="https://microsoft.github.io/monaco-editor/api/modules/monaco.editor.html#defineTheme" rel="noopener ugc nofollow" target="_blank">你可以定义一个主题</a>然后定制你的编辑器的外观。现在我使用默认的主题。即使你没有添加这个属性编辑器也会将它设置为默认主题。</p><p id="59ad" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在<code class="fe lx ly lz ma b">options</code>属性中，您可以根据您要使用该编辑器(Diff 编辑器或编辑器)创建的功能，为编辑器提供<a class="ae kt" href="https://microsoft.github.io/monaco-editor/api/interfaces/monaco.editor.IEditorOptions.html" rel="noopener ugc nofollow" target="_blank">选项</a>。在这里，我创建了一个编辑器，它只有一个能够打开一个文件的编辑器，因此我传递了与该用例相关的<a class="ae kt" href="https://microsoft.github.io/monaco-editor/api/interfaces/monaco.editor.IEditorConstructionOptions.html" rel="noopener ugc nofollow" target="_blank">选项</a>。我不会解释我们可以通过的每一个选项，因为那些选项已经在摩纳哥的网站上解释过了。</p><p id="7f3e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">接下来我们来看看<code class="fe lx ly lz ma b">editorDidMount</code>属性。这个属性期望一个回调被绑定，一旦编辑器被装载到 DOM，这个回调就会被调用。这是一个与<code class="fe lx ly lz ma b">componentDidMount</code>事件相似的案例。当执行这个函数时会把当前的 Monaco 编辑器传给你。此外，在这个函数中，您可以启动 monaco-langclient 来绑定您的编辑器，这将帮助您将语言特性绑定到您的编辑器。这将帮助您将编辑器与语言服务器绑定，以提供丰富的语言编辑体验。</p><p id="ae45" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">接下来是<code class="fe lx ly lz ma b">onChange</code>属性，我们可以注册 onChange 回调以在编辑时(每次按键输入)获得代码编辑器上的最新内容。所以这个函数将有两个参数，它们将给出<code class="fe lx ly lz ma b">newContent</code>和触发<code class="fe lx ly lz ma b">onChange</code>事件的事件或文本变化。所以第二个参数将帮助您识别新添加的文本。</p><p id="037f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">好吧！因此，我认为这是我所知道的将 Monaco 编辑器集成到 react 应用程序中的最简单的方法。正如我提到的，我们可以使用其他库，但我没有尝试过，因为我成功地使用了这个库。因此，如果有其他简单易用的库，您可以尝试使用其他库，也可以帮助其他人。</p><p id="5216" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">实现可在此处找到:</p><div class="my mz gp gr na nb"><a href="https://github.com/NipunaMarcus/web-editor" rel="noopener  ugc nofollow" target="_blank"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd io gy z fp ng fr fs nh fu fw im bi translated">GitHub-NipunaMarcus/web-编辑器</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">这是一个与本文相关的示例应用程序。这是一个示例实现，它将…</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">github.com</p></div></div><div class="nk l"><div class="nl l nm nn no nk np jp nb"/></div></div></a></div><h1 id="5af4" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">总结</strong></h1><ul class=""><li id="1a24" class="mj mk in jx b jy ls kc lt kg nq kk nr ko ns ks mo mp mq mr bi translated">准备您的环境以安装节点 v16.9.0 和 NPM 7.21.1</li><li id="addd" class="mj mk in jx b jy ms kc mt kg mu kk mv ko mw ks mo mp mq mr bi translated">准备您的 IDE 以支持类型脚本编辑。</li><li id="5622" class="mj mk in jx b jy ms kc mt kg mu kk mv ko mw ks mo mp mq mr bi translated">用<code class="fe lx ly lz ma b">package.json</code>、<code class="fe lx ly lz ma b">webpack.config.js</code>、<code class="fe lx ly lz ma b">tsconfig.json</code>文件和<code class="fe lx ly lz ma b">src</code>目录创建一个节点模块。</li><li id="baed" class="mj mk in jx b jy ms kc mt kg mu kk mv ko mw ks mo mp mq mr bi translated">创建<code class="fe lx ly lz ma b">src</code>目录结构，根据您的喜好选择<code class="fe lx ly lz ma b">index.tsx</code>、<code class="fe lx ly lz ma b">index.ejs</code>或<code class="fe lx ly lz ma b">index.html</code>。此外，还添加了两个组件来保存应用程序组件，该组件将是编辑器组件的父组件，编辑器组件将保存 Monaco 编辑器集成的实现。</li><li id="910b" class="mj mk in jx b jy ms kc mt kg mu kk mv ko mw ks mo mp mq mr bi translated">针对<a class="ae kt" href="https://github.com/NipunaMarcus/web-editor" rel="noopener ugc nofollow" target="_blank">这个 git repo </a>实现应用。</li></ul><h1 id="25b6" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">接下来…</h1><p id="38ea" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated">这个系列将继续下去，直到我们有一个聪明的编辑在我们的手中。在下一篇文章中，我们将探讨如何将语言服务器集成到我们的 web 编辑器中。</p><h1 id="a027" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">上一个…</h1><div class="my mz gp gr na nb"><a href="https://medium.com/ballerina-techblog/implementing-a-language-server-how-hard-can-it-be-part-3-7269962498ac" rel="noopener follow" target="_blank"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd io gy z fp ng fr fs nh fu fw im bi translated">实现一个语言服务器…能有多难？—第三部分</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">重述…</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">medium.com</p></div></div><div class="nk l"><div class="nt l nm nn no nk np jp nb"/></div></div></a></div><div class="my mz gp gr na nb"><a href="https://medium.com/ballerina-techblog/implementing-a-language-server-how-hard-can-it-be-part-2-fa65a741aa23" rel="noopener follow" target="_blank"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd io gy z fp ng fr fs nh fu fw im bi translated">实现一个语言服务器…能有多难？？—第二部分</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">唷…终于，在一年后，我找到时间写这个系列的第 2 部分。</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">medium.com</p></div></div><div class="nk l"><div class="nu l nm nn no nk np jp nb"/></div></div></a></div><div class="my mz gp gr na nb"><a href="https://medium.com/ballerina-techblog/implementing-a-language-server-how-hard-can-it-be-part-1-introduction-c915d2437076" rel="noopener follow" target="_blank"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd io gy z fp ng fr fs nh fu fw im bi translated">实现一个语言服务器…能有多难？？—第一部分(引言)</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">嗯，这真的没有那么难… :D</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">medium.com</p></div></div><div class="nk l"><div class="nv l nm nn no nk np jp nb"/></div></div></a></div></div></div>    
</body>
</html>