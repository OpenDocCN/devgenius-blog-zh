<html>
<head>
<title>Algorithmic Trading — Backtesting Portfolio of Stocks in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">算法交易——用Python对股票组合进行回溯测试</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/algorithmic-trading-backtesting-portfolio-of-stocks-in-python-9be75ce9f232?source=collection_archive---------1-----------------------#2022-01-21">https://blog.devgenius.io/algorithmic-trading-backtesting-portfolio-of-stocks-in-python-9be75ce9f232?source=collection_archive---------1-----------------------#2022-01-21</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/5caef7833450456bf0605ecd95073f5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*G9SihSfyytXZgIS-"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated"><a class="ae jz" href="https://unsplash.com/@homajob?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">斯科特·格雷厄姆</a>在<a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><h2 id="f823" class="ka kb in bd kc kd ke dn kf kg kh dp ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">介绍</h2><p id="f51b" class="pw-post-body-paragraph kw kx in ky b kz la lb lc ld le lf lg kj lh li lj kn lk ll lm kr ln lo lp lq ig bi translated">这篇文章描述了如何在股票投资组合上测试你的算法交易策略。投资组合降低了风险，而不仅仅是将一种策略应用于一只股票。优化投资组合可以带来更高的回报，降低整体风险(提高夏普比率)。</p><p id="7424" class="pw-post-body-paragraph kw kx in ky b kz lr lb lc ld ls lf lg kj lt li lj kn lu ll lm kr lv lo lp lq ig bi translated">我强烈建议您浏览一下我以前的文章，以便更好地理解这篇文章。</p><ul class=""><li id="7bf9" class="lw lx in ky b kz lr ld ls kj ly kn lz kr ma lq mb mc md me bi translated"><a class="ae jz" rel="noopener ugc nofollow" target="_blank" href="/algorithmic-trading-backtesting-a-strategy-in-python-3a136be16ece">用python对策略进行回溯测试</a></li><li id="4453" class="lw lx in ky b kz mf ld mg kj mh kn mi kr mj lq mb mc md me bi translated"><a class="ae jz" rel="noopener ugc nofollow" target="_blank" href="/algorithmic-trading-backtesting-a-simple-buy-low-sell-high-strategy-in-python-cb1f9692984e">python中的低买高卖策略回溯测试</a></li><li id="c908" class="lw lx in ky b kz mf ld mg kj mh kn mi kr mj lq mb mc md me bi translated"><a class="ae jz" rel="noopener ugc nofollow" target="_blank" href="/optimizing-trading-strategies-using-python-ff419f1f3ffb">优化python中的策略</a></li></ul><h2 id="c95e" class="ka kb in bd kc kd ke dn kf kg kh dp ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">要遵循的步骤</h2><ol class=""><li id="4fef" class="lw lx in ky b kz la ld le kj mk kn ml kr mm lq mn mc md me bi translated">去拿工具</li><li id="0de6" class="lw lx in ky b kz mf ld mg kj mh kn mi kr mj lq mn mc md me bi translated">创建应用于投资组合的必要功能</li><li id="7c9e" class="lw lx in ky b kz mf ld mg kj mh kn mi kr mj lq mn mc md me bi translated">将策略应用于投资组合股票并建立头寸</li><li id="a748" class="lw lx in ky b kz mf ld mg kj mh kn mi kr mj lq mn mc md me bi translated">结果和图</li></ol></div><div class="ab cl mo mp hr mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="ig ih ii ij ik"><h2 id="492e" class="ka kb in bd kc kd ke dn kf kg kh dp ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">第一步。去拿工具</h2><p id="aa9c" class="pw-post-body-paragraph kw kx in ky b kz la lb lc ld le lf lg kj lh li lj kn lk ll lm kr ln lo lp lq ig bi translated">导入必要的库。Yfinance用于下载历史OHLCV数据。</p><figure class="mv mw mx my gt jo"><div class="bz fp l di"><div class="mz na l"/></div></figure><h2 id="d35c" class="ka kb in bd kc kd ke dn kf kg kh dp ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">第二步。创建应用于投资组合的必要功能</h2><p id="a3c0" class="pw-post-body-paragraph kw kx in ky b kz la lb lc ld le lf lg kj lh li lj kn lk ll lm kr ln lo lp lq ig bi translated">在这一步中，我们创建了可能需要在所有股票上调用的各种函数。这可能有助于我们以后将这个功能封装到一个类中。(如果需要的话)创建以下函数</p><ul class=""><li id="110d" class="lw lx in ky b kz lr ld ls kj ly kn lz kr ma lq mb mc md me bi translated">获取每日数据</li><li id="0c43" class="lw lx in ky b kz mf ld mg kj mh kn mi kr mj lq mb mc md me bi translated">移动平均策略函数</li><li id="47df" class="lw lx in ky b kz mf ld mg kj mh kn mi kr mj lq mb mc md me bi translated">计算累积回报</li><li id="f8b7" class="lw lx in ky b kz mf ld mg kj mh kn mi kr mj lq mb mc md me bi translated">计算年化份额</li></ul><figure class="mv mw mx my gt jo"><div class="bz fp l di"><div class="mz na l"/></div></figure><h2 id="d39b" class="ka kb in bd kc kd ke dn kf kg kh dp ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">第三步。将策略应用于投资组合股票并建立头寸</h2><p id="889d" class="pw-post-body-paragraph kw kx in ky b kz la lb lc ld le lf lg kj lh li lj kn lk ll lm kr ln lo lp lq ig bi translated">在这一步中，我们定义投资组合并迭代其中的股票，依次下载数据并应用移动平均策略。</p><figure class="mv mw mx my gt jo"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="mv mw mx my gt jo gh gi paragraph-image"><div class="ab gu cl nb"><img src="../Images/74b864c3d394956bbb5f25ab901ffe86.png" data-original-src="https://miro.medium.com/v2/format:webp/1*J3c-8e8hxl7TegzqOwsWpw.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">个人和投资组合策略回报</figcaption></figure><p id="2e42" class="pw-post-body-paragraph kw kx in ky b kz lr lb lc ld ls lf lg kj lt li lj kn lu ll lm kr lv lo lp lq ig bi translated"><strong class="ky io">第四步。结果和图</strong></p><p id="b5ac" class="pw-post-body-paragraph kw kx in ky b kz lr lb lc ld ls lf lg kj lt li lj kn lu ll lm kr lv lo lp lq ig bi translated">在这一步中，将投资组合的累积回报和年化夏普比率与个股表现进行比较。</p><p id="2584" class="pw-post-body-paragraph kw kx in ky b kz lr lb lc ld ls lf lg kj lt li lj kn lu ll lm kr lv lo lp lq ig bi translated">从图中可以直观地观察到，与个股表现相比，投资组合几乎没有变化。</p><p id="b3a8" class="pw-post-body-paragraph kw kx in ky b kz lr lb lc ld ls lf lg kj lt li lj kn lu ll lm kr lv lo lp lq ig bi translated">单个股票的平均年夏普比率约为0.38，而投资组合的年夏普比率为0.72。这表明投资股票组合可以降低风险。</p><p id="c0da" class="pw-post-body-paragraph kw kx in ky b kz lr lb lc ld ls lf lg kj lt li lj kn lu ll lm kr lv lo lp lq ig bi translated">通过使用CAMP(资本资产定价模型)和Kelly标准等各种技术优化投资组合，可以获得更高的回报。</p><figure class="mv mw mx my gt jo"><div class="bz fp l di"><div class="mz na l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">创建性能数据框</figcaption></figure><figure class="mv mw mx my gt jo gh gi paragraph-image"><div class="ab gu cl nb"><img src="../Images/b74ed6118a59f1c1f9e271062b3d9ba5.png" data-original-src="https://miro.medium.com/v2/format:webp/1*YTRuTO8C3JCW8t1jkAB-zw.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">个人表现</figcaption></figure><figure class="mv mw mx my gt jo"><div class="bz fp l di"><div class="mz na l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">比较指标:投资组合与个股</figcaption></figure><pre class="mv mw mx my gt nc nd ne nf aw ng bi"><span id="9201" class="ka kb in nd b gy nh ni l nj nk">Cumulative returns                              : 0.382<br/>Annualized Sharpe Ratio                         : 0.384</span><span id="6d73" class="ka kb in nd b gy nl ni l nj nk">Cumulative returns MA Stretegy                  : 0.382<br/>Annualized sharpe ratio MA Strategy             : 0.719</span></pre><figure class="mv mw mx my gt jo"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="mv mw mx my gt jo gh gi paragraph-image"><div class="ab gu cl nb"><img src="../Images/6867d5ac86bd2746c777925d3acfc4a8.png" data-original-src="https://miro.medium.com/v2/format:webp/1*S2v_SuWUfZc6ER_hDyNW0w.png"/></div></figure><p id="a7aa" class="pw-post-body-paragraph kw kx in ky b kz lr lb lc ld ls lf lg kj lt li lj kn lu ll lm kr lv lo lp lq ig bi translated">您可以在以下位置找到代码片段:<a class="ae jz" href="https://github.com/karthikramx/Algorithmic-Trading-Backtesting-Portfolio-of-Stocks-Python" rel="noopener ugc nofollow" target="_blank">https://github . com/karthikramx/algorithm-Trading-back testing-Portfolio-of-Stocks-Python</a></p><p id="ae3d" class="pw-post-body-paragraph kw kx in ky b kz lr lb lc ld ls lf lg kj lt li lj kn lu ll lm kr lv lo lp lq ig bi translated">在你有兴趣应用无监督的机器学习算法来构建股票的多元化投资组合时，我欢迎你在这里阅读我关于它的文章:<a class="ae jz" rel="noopener ugc nofollow" target="_blank" href="/creating-a-diversified-stock-portfolio-using-clustering-analysis-aae5af284b1f">https://blog . dev genius . io/creating-a-diversified-stock-portfolio-using-clustering-analysis-aa E5 af 284 B1 f</a></p></div></div>    
</body>
</html>