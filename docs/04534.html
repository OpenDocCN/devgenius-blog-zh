<html>
<head>
<title>Beginner’s D3.js Tutorial: Learn Data Visualization with JS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">初学者的 D3.js 教程:用 js 学习数据可视化</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/beginners-d3-js-tutorial-learn-data-visualization-with-js-b357d9308ada?source=collection_archive---------3-----------------------#2021-03-30">https://blog.devgenius.io/beginners-d3-js-tutorial-learn-data-visualization-with-js-b357d9308ada?source=collection_archive---------3-----------------------#2021-03-30</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/d7f532103cdc5bf3238b4481ff06c2b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h8Qkw2UuuH40RcYz0yje_A.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">图片来源:作者</figcaption></figure><p id="534b" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">D3.js 是用于<strong class="kb io">数据可视化</strong>的强大 JavaScript 库。与许多使用 Python 的数据可视化工具不同，D3.js 完全由 JavaScript、CSS 和 HTML 等前端技能控制。凭借 JS 驱动的代码、内置的渲染功能和自动动画，D3 一直是前端开发人员的最佳数据可视化工具。</p><p id="ecb8" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">今天，我们将帮助你开始使用 D3.js 组件，并给你创建你的第一个可视化的实践机会。</p><p id="708e" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">下面是我们今天要讲的内容:</strong></p><ul class=""><li id="8543" class="kx ky in kb b kc kd kg kh kk kz ko la ks lb kw lc ld le lf bi translated">D3.js 是什么？</li><li id="094e" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated">D3.js 环境设置</li><li id="6731" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated">D3.js 的基本组件</li><li id="5102" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated">数据可视化示例</li><li id="63b0" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated">接下来要学习的高级概念</li></ul><h1 id="78ee" class="ll lm in bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">D3.js 是什么？</h1><p id="36fd" class="pw-post-body-paragraph jz ka in kb b kc mj ke kf kg mk ki kj kk ml km kn ko mm kq kr ks mn ku kv kw ig bi translated"><strong class="kb io">D3 . js(Data-Driven-Documents)</strong>是一个开源的 JavaScript 库，可以让你使用 SVC、HTML 5 和 CSS 在 web 浏览器中创建动态数据可视化。它是由迈克·博斯托克在 2011 年创建的，作为普罗托维斯的精神继承者。D3.js 擅长以可理解和交互的方式表示大型数据集。</p><p id="94dd" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">虽然大多数数据可视化工具需要 Python，但 D3.js 可视化完全是使用 JavaScript 创建的。这允许前端开发人员将高级数据可视化添加到他们的 ui 中，而无需学习新语言。</p><p id="f457" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">内置并实现了许多高级数据操作和可视化功能，这意味着新的 D3.js 用户可以创建需要多年经验才能创建的效果。</p><p id="983f" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">例如，D3.js 具有内置的图形样式，可以显示从简单的饼图到交互式圆形条形图的任何内容。</p><blockquote class="mo mp mq"><p id="b787" class="jz ka mr kb b kc kd ke kf kg kh ki kj ms kl km kn mt kp kq kr mu kt ku kv kw ig bi translated"><em class="in">简而言之，D3.js 在现在的前端开发者手中，设计起来就是上手快，功能强大。</em></p></blockquote><p id="d3c6" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">这里有一个 D3.js 饼状图的例子，展示了 2020 年使用的顶级编程语言。</p><figure class="mw mx my mz gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mv"><img src="../Images/572a879dc6354b523013ffcc1cea609c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*E6RiEj5EOjSUHwaK.PNG"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">图片来源:作者</figcaption></figure><p id="2a7d" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">虽然大数据很难理解，但可视化要容易得多。一个做得好的视觉效果可以将成千上万的数据点完美地传达成一个有凝聚力的、可操作的趋势。</p><p id="65f2" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">数据可视化有助于:</p><ul class=""><li id="ea78" class="kx ky in kb b kc kd kg kh kk kz ko la ks lb kw lc ld le lf bi translated">基于大型数据集快速做出决策</li><li id="4466" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated">了解总体市场趋势</li><li id="3bb6" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated">交流信息一目了然</li><li id="209f" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated">查找记录数据中的错误</li></ul><h1 id="fec1" class="ll lm in bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">D3.js 的主要特性</h1><ul class=""><li id="7671" class="kx ky in kb b kc mj kg mk kk na ko nb ks nc kw lc ld le lf bi translated"><strong class="kb io">使用 Web 标准</strong>:使用已建立的标准 SVG、HTML 和 CSS，使其与现有技术兼容。</li><li id="7aa0" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated"><strong class="kb io">数据驱动</strong> : D3 可以使用静态数据，也可以从远程服务器获取多种格式的数据，比如数组、对象、CSV、JSON 或 XML。</li><li id="d8c0" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated"><strong class="kb io"> DOM 操作</strong> : D3 允许您使用数据操作文档对象模型(DOM)。</li><li id="870b" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated"><strong class="kb io">动态属性</strong> : D3 提供动态属性和元素。可以将属性指定为数据的函数，然后编辑您的元素。换句话说，您的数据定义了可视化的风格。</li><li id="4721" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated"><strong class="kb io">可视化的类型</strong> : D3 有几十种内置的图形格式，用于常见的应用，如排名、关联和分布。</li><li id="0e48" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated"><strong class="kb io">定制可视化</strong> : D3 允许你从头开始或者通过调整当前的图形格式来创建定制可视化。</li><li id="d2e1" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated"><strong class="kb io">过渡和动画:</strong> D3 提供了内置的动画函数<code class="fe nd ne nf ng b">transition()</code>、<code class="fe nd ne nf ng b">duration()</code>、<code class="fe nd ne nf ng b">delay()</code>和<code class="fe nd ne nf ng b">ease()</code>函数，这些函数根据用户交互、定时过渡或其他事件自动动画显示图形的特征。</li></ul><h1 id="0bff" class="ll lm in bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">D3.js 环境设置</h1><p id="7ede" class="pw-post-body-paragraph jz ka in kb b kc mj ke kf kg mk ki kj kk ml km kn ko mm kq kr ks mn ku kv kw ig bi translated">在动手之前，您必须设置一个 D3.js 环境。D3.js 环境的四个组件是<strong class="kb io"> D3 库</strong>、<strong class="kb io">web 服务器</strong>、<strong class="kb io">文本编辑器</strong>和<strong class="kb io">web 浏览器</strong>。</p><p id="e12a" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">您可以通过从内容交付网络(CDN)将 D3 库直接链接到您的 HTML 页面来使用它。使用 CDN 将允许你在不下载源代码的情况下使用 D3。</p><p id="a3d5" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">通过在您的<code class="fe nd ne nf ng b">head</code>部分输入 D3 的 CDN url 来包含 D3:</p><pre class="mw mx my mz gt nh ng ni nj aw nk bi"><span id="f637" class="nl lm in ng b gy nm nn l no np">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>&lt;head&gt;<br/>    &lt;script src="https://d3js.org/d3.v4.min.js"&gt;&lt;/script&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;</span><span id="138a" class="nl lm in ng b gy nq nn l no np">&lt;script&gt;<br/>    // write your d3 code here.. <br/>&lt;/script&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="4c96" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">对于 web 服务器，大多数浏览器将本地 HTML 文件直接发送到浏览器。如果你觉得更舒服的话，你也可以使用 Apache 这样的 web 服务器。</p><p id="a932" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">您的文本编辑器应该支持 JavaScript。一些优秀的集成开发环境(ide)包括:</p><ul class=""><li id="fe8e" class="kx ky in kb b kc kd kg kh kk kz ko la ks lb kw lc ld le lf bi translated">Visual Studio 代码</li><li id="30a9" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated">黯然失色</li><li id="4a26" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated">崇高的文本</li></ul><p id="783d" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">D3 可以在除 IE8 和更低版本以外的所有浏览器上运行。在本教程中，我将使用谷歌浏览器。一旦你拥有了所有这些东西，你就可以开始了！</p><h1 id="1d9b" class="ll lm in bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">D3.js 的基本组件</h1><p id="a5ec" class="pw-post-body-paragraph jz ka in kb b kc mj ke kf kg mk ki kj kk ml km kn ko mm kq kr ks mn ku kv kw ig bi translated">现在我们来看看任何 D3 项目的基本组件。重要组件包括:</p><ul class=""><li id="db48" class="kx ky in kb b kc kd kg kh kk kz ko la ks lb kw lc ld le lf bi translated"><strong class="kb io">选择</strong>，用于选择 DOM 元素进行操作</li><li id="4dd9" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated"><strong class="kb io"> DOM 操纵</strong>，用于添加或修改 DOM 元素内的文本</li><li id="abc7" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated"><strong class="kb io">方法链接</strong>，用于创建方法管道，每个方法都转换一个对象。</li><li id="0989" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated"><strong class="kb io">数据连接</strong>，用于将数据绑定到选定的元素，使基于数据的操作更容易。</li></ul><h1 id="368b" class="ll lm in bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">D3 选择</h1><p id="ef21" class="pw-post-body-paragraph jz ka in kb b kc mj ke kf kg mk ki kj kk ml km kn ko mm kq kr ks mn ku kv kw ig bi translated">选择是大多数 D3 方法链的开始，因为它决定了哪些元素将受到后面方法的影响。D3.js 中有两种选择方式，<code class="fe nd ne nf ng b">select()</code>和<code class="fe nd ne nf ng b">selectAll()</code>。</p><h1 id="2f09" class="ll lm in bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">选择()</h1><p id="e9a9" class="pw-post-body-paragraph jz ka in kb b kc mj ke kf kg mk ki kj kk ml km kn ko mm kq kr ks mn ku kv kw ig bi translated"><code class="fe nd ne nf ng b">select()</code>方法用于选择给定 HTML 标签的单个实例。如果指定的标签不存在，那么它将返回一个空的选择。如果存在选定标记的多个实例，那么它将只选择第一个元素。</p><p id="03be" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">让我们使用<code class="fe nd ne nf ng b">select()</code>方法为 D3.js 运行著名的“hello world”程序。</p><blockquote class="mo mp mq"><p id="a908" class="jz ka mr kb b kc kd ke kf kg kh ki kj ms kl km kn mt kp kq kr mu kt ku kv kw ig bi translated">第一段代码是我们的 HTML，第二段是我们的 JavaScript 文件。</p></blockquote><pre class="mw mx my mz gt nh ng ni nj aw nk bi"><span id="2360" class="nl lm in ng b gy nm nn l no np">&lt;head&gt;<br/>    &lt;script src="https://d3js.org/d3.v6.min.js"&gt;&lt;/script&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>    &lt;div&gt;Welcome to Educative&lt;/div&gt;<br/>    &lt;div&gt;Introduction to D3.js&lt;/div&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span><span id="cad9" class="nl lm in ng b gy nq nn l no np">d3.selectAll('div').style("color","green");</span></pre><p id="abbc" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">上面，我们使用<code class="fe nd ne nf ng b">selectAll()</code>方法选择所有的 HTML <code class="fe nd ne nf ng b">div</code>标签，将它们的颜色改为绿色。</p><p id="d826" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">首先，我们使用<code class="fe nd ne nf ng b">selectAll()</code>方法选择<code class="fe nd ne nf ng b">div</code>标签下的所有文本。然后，我们使用<code class="fe nd ne nf ng b">style()</code>方法给选中的文本添加样式。</p><h1 id="2637" class="ll lm in bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">用 D3 进行 DOM 操作</h1><p id="7dfc" class="pw-post-body-paragraph jz ka in kb b kc mj ke kf kg mk ki kj kk ml km kn ko mm kq kr ks mn ku kv kw ig bi translated">现在我们来看看最常见的 DOM 操作方法，<code class="fe nd ne nf ng b">text()</code>、<code class="fe nd ne nf ng b">append()</code>、<code class="fe nd ne nf ng b">remove()</code>、<code class="fe nd ne nf ng b">style()</code>和<code class="fe nd ne nf ng b">attr()</code>。</p><h1 id="fda8" class="ll lm in bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">文本()</h1><p id="fdb8" class="pw-post-body-paragraph jz ka in kb b kc mj ke kf kg mk ki kj kk ml km kn ko mm kq kr ks mn ku kv kw ig bi translated"><code class="fe nd ne nf ng b">text()</code>方法操作 DOM 元素，通常用于添加或修改 DOM 元素中的文本。</p><pre class="mw mx my mz gt nh ng ni nj aw nk bi"><span id="004f" class="nl lm in ng b gy nm nn l no np">&lt;head&gt;<br/>    &lt;script src="https://d3js.org/d3.v6.min.js"&gt;&lt;/script&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>    &lt;div&gt;&lt;/div&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span><span id="e1d3" class="nl lm in ng b gy nq nn l no np">d3.select('div').text("I am adding text");</span></pre><p id="4628" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我们首先使用<code class="fe nd ne nf ng b">select()</code>方法来选择<code class="fe nd ne nf ng b">div</code>元素。然后我们使用<code class="fe nd ne nf ng b">text()</code>方法将我们的文本添加到<code class="fe nd ne nf ng b">div</code>元素中。</p><h1 id="b18c" class="ll lm in bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">追加()</h1><p id="970b" class="pw-post-body-paragraph jz ka in kb b kc mj ke kf kg mk ki kj kk ml km kn ko mm kq kr ks mn ku kv kw ig bi translated"><code class="fe nd ne nf ng b">append()</code>方法用于在选中元素的末尾添加一个新的 HTML 元素。让我们在<code class="fe nd ne nf ng b">body</code>标签内创建一个新的<code class="fe nd ne nf ng b">div</code>元素，并使用<code class="fe nd ne nf ng b">text()</code>方法向其添加文本。</p><pre class="mw mx my mz gt nh ng ni nj aw nk bi"><span id="8454" class="nl lm in ng b gy nm nn l no np">&lt;head&gt;<br/>    &lt;script src="https://d3js.org/d3.v6.min.js"&gt;&lt;/script&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>    &lt;div&gt;Introduction to Visualization using D3.js&lt;/div&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span><span id="3427" class="nl lm in ng b gy nq nn l no np">d3.select("body").append("div").text("Appending new div tag")</span></pre><p id="2ddd" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">一个<code class="fe nd ne nf ng b">div</code>标签已经存在于 HTML 文件的 body 标签中。在第 1 行，我们使用<code class="fe nd ne nf ng b">append()</code>方法向 HTML 文件添加一个新的 div 元素。然后，我们添加了文本，使用 text()方法“追加新标签”。</p><h1 id="45f4" class="ll lm in bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">移除()</h1><p id="efc7" class="pw-post-body-paragraph jz ka in kb b kc mj ke kf kg mk ki kj kk ml km kn ko mm kq kr ks mn ku kv kw ig bi translated">方法用于移除一个选中的 HTML 元素。</p><pre class="mw mx my mz gt nh ng ni nj aw nk bi"><span id="992a" class="nl lm in ng b gy nm nn l no np">&lt;head&gt;<br/>    &lt;script src="https://d3js.org/d3.v6.min.js"&gt;&lt;/script&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>    &lt;div&gt;1st div tag&lt;/div&gt;<br/>    &lt;div&gt;2nd div tag&lt;/div&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span><span id="f4b6" class="nl lm in ng b gy nq nn l no np">d3.select("div").remove()</span></pre><p id="e807" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><code class="fe nd ne nf ng b">select()</code>方法选择第一个<code class="fe nd ne nf ng b">div</code>元素。然后，我们使用<code class="fe nd ne nf ng b">remove()</code>方法移除选中的元素。最后，仅显示第二个<code class="fe nd ne nf ng b">div</code>元素。</p><h1 id="9aed" class="ll lm in bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">样式()</h1><p id="f9e5" class="pw-post-body-paragraph jz ka in kb b kc mj ke kf kg mk ki kj kk ml km kn ko mm kq kr ks mn ku kv kw ig bi translated">D3.js 提供了<code class="fe nd ne nf ng b">style()</code>方法来设置所选 DOM 元素的样式。样式以类似于 CSS 的格式设置，但一次只能更改一个属性。<code class="fe nd ne nf ng b">style</code>的第一个参数始终是您想要编辑的属性，第二个参数是新值。</p><pre class="mw mx my mz gt nh ng ni nj aw nk bi"><span id="1ebc" class="nl lm in ng b gy nm nn l no np">&lt;head&gt;<br/>    &lt;script src="https://d3js.org/d3.v6.min.js"&gt;&lt;/script&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>    &lt;div&gt;Showing effect of the style method&lt;/div&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span><span id="163a" class="nl lm in ng b gy nq nn l no np">d3.select("div").style("color","blue").style("font-size","30px")</span></pre><p id="e5e3" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">和以前一样，我们首先选择<code class="fe nd ne nf ng b">div</code>标签，然后用第一个<code class="fe nd ne nf ng b">style()</code>方法将颜色改为蓝色，用第二个方法改变字体。每个<code class="fe nd ne nf ng b">style()</code>方法只能改变一个属性。</p><h1 id="edd2" class="ll lm in bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">属性()</h1><p id="7020" class="pw-post-body-paragraph jz ka in kb b kc mj ke kf kg mk ki kj kk ml km kn ko mm kq kr ks mn ku kv kw ig bi translated">我们可以调用<code class="fe nd ne nf ng b">attr()</code>一次，而不是调用<code class="fe nd ne nf ng b">style()</code>两次。方法将你的元素链接到一个 CSS 样式表，并将该样式表的设置应用到任何选中的元素。</p><p id="3545" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">它也用来定义一个几何图形的属性，我们将在后面看到。</p><pre class="mw mx my mz gt nh ng ni nj aw nk bi"><span id="e79a" class="nl lm in ng b gy nm nn l no np">&lt;head&gt;<br/>    &lt;script src="https://d3js.org/d3.v6.min.js"&gt;&lt;/script&gt;</span><span id="3dfc" class="nl lm in ng b gy nq nn l no np">&lt;/head&gt;<br/>&lt;body&gt;<br/>    &lt;div&gt;Showing effect of the attr method&lt;/div&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span><span id="910e" class="nl lm in ng b gy nq nn l no np">d3.select("div").attr("class","error");</span><span id="bd73" class="nl lm in ng b gy nq nn l no np">.error {<br/>    color: blue;<br/>    font-size: 30px<br/>    }</span></pre><p id="9a8f" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我们的<code class="fe nd ne nf ng b">attr()</code>方法将选中的<code class="fe nd ne nf ng b">div</code>元素链接到我们的 CSS 表单。第一个参数定义工作表的类型，第二个参数指定要选择的类名。</p><p id="c486" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">这允许 D3 使所选元素的颜色和字体大小属性与 CSS 表单相匹配。</p><h1 id="df02" class="ll lm in bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">方法链接</h1><p id="51db" class="pw-post-body-paragraph jz ka in kb b kc mj ke kf kg mk ki kj kk ml km kn ko mm kq kr ks mn ku kv kw ig bi translated">方法链是一种将多个方法串在一起的技术。第一个方法的输出将作为第二个方法的输入，依此类推，直到链完成。</p><p id="8f80" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">类似于函数式编程中的函数组合，方法链允许您组合简单的方法来创建复杂的行为。</p><p id="3698" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">当我们在同一个元素上使用<code class="fe nd ne nf ng b">select()</code>和另一个方法时，你已经在整个教程中使用了。</p><p id="88fc" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">前面的例子是一个很好的例子。</p><pre class="mw mx my mz gt nh ng ni nj aw nk bi"><span id="7784" class="nl lm in ng b gy nm nn l no np">d3.select("div").style("color","blue").style("font-size","30px")</span></pre><p id="6e7d" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">首先，我们将<code class="fe nd ne nf ng b">div</code>作为输入传递给<code class="fe nd ne nf ng b">select()</code>方法。然后<code class="fe nd ne nf ng b">select()</code>返回一个选择元素，作为<code class="fe nd ne nf ng b">style()</code>方法的输入。然后，第一个<code class="fe nd ne nf ng b">style()</code>将样式更改应用于传递的元素。然后，新样式的元素被传递到下一个<code class="fe nd ne nf ng b">style()</code>进行另一次更改。最后，我们通过对原始输入的一次调用来应用 3 个方法。</p><p id="1643" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">您也可以在单独的行上编写方法链，以提高可读性:</p><pre class="mw mx my mz gt nh ng ni nj aw nk bi"><span id="d7d6" class="nl lm in ng b gy nm nn l no np">d3.select("div")<br/>.style("color","blue")<br/>.style("font-size","30px")</span></pre><h1 id="1eb2" class="ll lm in bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">数据连接</h1><p id="34bf" class="pw-post-body-paragraph jz ka in kb b kc mj ke kf kg mk ki kj kk ml km kn ko mm kq kr ks mn ku kv kw ig bi translated">数据连接允许我们将选定的元素绑定到数组的数据上。绑定是您用来绘制可视化的主要工具，因为它们使您的 DOM 操作对您的数据更加敏感。</p><p id="8151" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">数据连接的三种主要方法是<code class="fe nd ne nf ng b">datum()</code>、<code class="fe nd ne nf ng b">data()</code>和<code class="fe nd ne nf ng b">enter()</code>。</p><h1 id="1e67" class="ll lm in bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">基准()</h1><p id="d622" class="pw-post-body-paragraph jz ka in kb b kc mj ke kf kg mk ki kj kk ml km kn ko mm kq kr ks mn ku kv kw ig bi translated"><code class="fe nd ne nf ng b">datum()</code>方法用单个 D3 选择连接数据点。</p><pre class="mw mx my mz gt nh ng ni nj aw nk bi"><span id="f699" class="nl lm in ng b gy nm nn l no np">&lt;head&gt;<br/>    &lt;script src="https://d3js.org/d3.v6.min.js"&gt;&lt;/script&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>    &lt;p&gt;&lt;/p&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span><span id="c6cd" class="nl lm in ng b gy nq nn l no np">d3.select("body")<br/>  .select("p")<br/>  .datum(["10"])<br/>  .text(function(d) { return d; });</span></pre><p id="067a" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在上面的例子中，我们想要绑定数据元素和 HTML 标签。在<strong class="kb io">行 1 </strong>中，我们使用<code class="fe nd ne nf ng b">select()</code>方法选择<code class="fe nd ne nf ng b">p</code>标签。在<strong class="kb io">第 3 行</strong>中，我们使用<code class="fe nd ne nf ng b">datum()</code>将<code class="fe nd ne nf ng b">10</code>与<code class="fe nd ne nf ng b">p</code>标签绑定。在<strong class="kb io">第 4 行</strong>中，我们使用<code class="fe nd ne nf ng b">text()</code>返回与<code class="fe nd ne nf ng b">p</code>标签相关的数据。</p><h1 id="7878" class="ll lm in bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">数据()</h1><p id="1b99" class="pw-post-body-paragraph jz ka in kb b kc mj ke kf kg mk ki kj kk ml km kn ko mm kq kr ks mn ku kv kw ig bi translated">我们可以使用<code class="fe nd ne nf ng b">data()</code>将多个数据点与一组 D3 选择相关联。这在处理大数据集时很有用，因为这意味着您不需要单独绑定每个数据点。</p><pre class="mw mx my mz gt nh ng ni nj aw nk bi"><span id="589e" class="nl lm in ng b gy nm nn l no np">&lt;head&gt;<br/>    &lt;script src="https://d3js.org/d3.v6.min.js"&gt;&lt;/script&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>    &lt;p&gt;&lt;/p&gt;<br/>   &lt;p&gt;&lt;/p&gt;<br/>   &lt;p&gt;&lt;/p&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span><span id="768e" class="nl lm in ng b gy nq nn l no np">d3.select("body").selectAll("p")<br/>   .data([10, 20, 30])<br/>   .text(function(d) { return d; });</span></pre><p id="34da" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">这里，我们使用<code class="fe nd ne nf ng b">selectAll()</code>方法选择正文中的三个元素，并使用<code class="fe nd ne nf ng b">data()</code>将每个元素绑定到一个数据点。最后一行打印成对选择的数据。</p><h1 id="221b" class="ll lm in bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">输入()</h1><p id="b9a1" class="pw-post-body-paragraph jz ka in kb b kc mj ke kf kg mk ki kj kk ml km kn ko mm kq kr ks mn ku kv kw ig bi translated">当选择的元素多于数组中的元素时，使用<code class="fe nd ne nf ng b">enter()</code>方法绑定元素。</p><pre class="mw mx my mz gt nh ng ni nj aw nk bi"><span id="252b" class="nl lm in ng b gy nm nn l no np">&lt;head&gt;<br/>    &lt;script src="https://d3js.org/d3.v6.min.js"&gt;&lt;/script&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>    &lt;p&gt;&lt;/p&gt;<br/>    &lt;p&gt;&lt;/p&gt;<br/>    &lt;p&gt;&lt;/p&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span><span id="3ec6" class="nl lm in ng b gy nq nn l no np">d3.select("body").selectAll("p")<br/>   .data([10, 20, 30, 50, 70])<br/>   .text(function(d) { return d; })<br/>   .enter()<br/>   .append("p")<br/>   .text(function(d) { return d; });</span></pre><p id="0e94" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">上面我们选择了三个<code class="fe nd ne nf ng b">p</code>元素，但是在<code class="fe nd ne nf ng b">data()</code>数组中有 5 个元素。这将按顺序绑定所有可能的元素，直到没有未绑定的<code class="fe nd ne nf ng b">p</code>元素。然后我们使用 append 添加额外的<code class="fe nd ne nf ng b">p</code>元素，直到所有元素都可以被绑定。</p><h1 id="436c" class="ll lm in bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">数据可视化示例</h1><p id="6f9b" class="pw-post-body-paragraph jz ka in kb b kc mj ke kf kg mk ki kj kk ml km kn ko mm kq kr ks mn ku kv kw ig bi translated">现在我们知道了组件，我们将看看如何使用 D3 来完成两个不同的示例视觉效果。我们将从一个简单的 line SVG 开始，让您熟悉一下，然后向您展示如何创建本文前面提到的饼图。</p><h1 id="5bed" class="ll lm in bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">带有 D3.js 的 SVG</h1><p id="9d37" class="pw-post-body-paragraph jz ka in kb b kc mj ke kf kg mk ki kj kk ml km kn ko mm kq kr ks mn ku kv kw ig bi translated">为了用 D3 创建一个 SVG，我们需要在 HTML 文件中包含<code class="fe nd ne nf ng b">svg</code>标签。</p><pre class="mw mx my mz gt nh ng ni nj aw nk bi"><span id="d400" class="nl lm in ng b gy nm nn l no np">&lt;body&gt;<br/>     &lt;svg&gt;content&lt;/svg&gt;<br/>&lt;/body&gt;</span></pre><p id="c108" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">D3 还有一个“线”图形元素，可以用<code class="fe nd ne nf ng b">attr()</code>配置。</p><pre class="mw mx my mz gt nh ng ni nj aw nk bi"><span id="48a8" class="nl lm in ng b gy nm nn l no np">&lt;head&gt;<br/>    &lt;script src="https://d3js.org/d3.v6.min.js"&gt;&lt;/script&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span><span id="1ac8" class="nl lm in ng b gy nq nn l no np">var svg = d3.select("body") //create Svg element<br/>   .append("svg")<br/>   .attr("height",200 )<br/>   .attr("width", 200)<br/>   .style("border", "solid 8px red");</span><span id="aece" class="nl lm in ng b gy nq nn l no np">svg.append("line")<br/>   .attr("x1", 50)<br/>   .attr("y1", 30)<br/>   .attr("x2", 150)<br/>   .attr("y2", 100)<br/>   .attr("stroke", "black")<br/>   .attr("stroke-width","2px");</span></pre><p id="eecb" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">从 JavaScript 页面中的<strong class="kb io">第 1 行</strong>到<strong class="kb io">第 5 行</strong>，我们在<code class="fe nd ne nf ng b">body</code>标签内创建了<code class="fe nd ne nf ng b">svg</code>标签。在<code class="fe nd ne nf ng b">attr</code>方法的帮助下，我们正在定义<code class="fe nd ne nf ng b">svg</code>的属性。</p><p id="0113" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在 JavaScript 页面中，从<strong class="kb io">第 7 行</strong>到<strong class="kb io">第 13 行</strong>，我们在<code class="fe nd ne nf ng b">svg</code>标签内创建了一行，并借助<code class="fe nd ne nf ng b">attr</code>方法初始化了该行的属性。</p><p id="c7e4" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">下图显示了直线相对于位于 SVG 画布左上角的原点的位置。</p><figure class="mw mx my mz gt jo gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/6afa6f02593f4e4a38c3c69e3ff9bc93.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/0*_N2NOW96hfu_ozt8.PNG"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">图片来源:作者</figcaption></figure><h1 id="c267" class="ll lm in bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">包含 D3.js 的饼图</h1><p id="4eff" class="pw-post-body-paragraph jz ka in kb b kc mj ke kf kg mk ki kj kk ml km kn ko mm kq kr ks mn ku kv kw ig bi translated">现在我们将使用<code class="fe nd ne nf ng b">d3.arc</code>和<code class="fe nd ne nf ng b">d3.pie</code>API 来创建我们在文章开头看到的“2020 年使用的编程语言”图表的一部分。</p><pre class="mw mx my mz gt nh ng ni nj aw nk bi"><span id="fb78" class="nl lm in ng b gy nm nn l no np">&lt;head&gt;<br/>    &lt;script src="https://d3js.org/d3.v6.min.js"&gt;&lt;/script&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span><span id="44e0" class="nl lm in ng b gy nq nn l no np">var margin = {top: 20, right: 20, bottom: 60, left: 80},<br/>     width = 500 - margin.left - margin.right,<br/>     height = 500 - margin.top - margin.bottom;<br/>var data = [<br/>  {language:  "Python", value: 30},<br/>  {language:  "Java", value: 20},<br/>  {language:  "C/C++", value: 15},<br/>  {language:  "Javascript", value: 35},<br/>  {language:  "PHP", value: 15},];<br/>colors=["#00A5E3","#FF96C5","#00CDAC","#FFA23A","#74737A"]  <br/>var svg = d3.select("body") //create Svg element<br/>   .append("svg")<br/>   .attr('width', width + margin.right + margin.left)<br/>   .attr('height', height + margin.top + margin.bottom)<br/>   .style("border", "solid 1px red")<br/>    .attr("transform","translate(200,0)");                 <br/>var chart=svg.append('g')<br/>   .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')')<br/>   .attr('width', width)<br/>   .attr('height', height)<br/>var pie=d3.pie() <br/>        .value(d =&gt; d.value)<br/>var color_scale=d3.scaleOrdinal()<br/>              .domain(data.map(d=&gt;d.language))<br/>              .range(colors)<br/>let arc=d3.arc()<br/>       .outerRadius(150)<br/>       .innerRadius(0)<br/>var p_chart=chart.selectAll("pie")<br/>     .data(pie(data))<br/>     .enter()<br/>     .append("g")<br/>     .attr('transform', 'translate(170,230)') <br/>p_chart.append("path")<br/>     .attr("d",arc) <br/>     .attr("fill",d=&gt;{<br/>       return color_scale(d.data.language);<br/>     })     <br/>p_chart.append("text")<br/>      .text(function(d){ return d.data.language})<br/>      .attr("transform", function(d) { return "translate(" + arc.centroid(d) + ")";  }) <br/>      .style("text-anchor", "middle")</span></pre><p id="dbe6" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">第 29–33 行</strong>:首先，我们定义了<code class="fe nd ne nf ng b">p_chart</code>。我们选择了不存在的 pie，所以它将返回一个空的选择。现在我们通过<code class="fe nd ne nf ng b">data(pie(data))</code>加入<code class="fe nd ne nf ng b">data()</code>我们的返回选择。然后，我们为每个数据点添加了<code class="fe nd ne nf ng b">g</code>标签。</p><p id="3bb9" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">第 34–38 行</strong>是借助弧线绘制饼图的地方。在<code class="fe nd ne nf ng b">ordinalScale()</code>的帮助下，我们已经给每条弧线分配了一种颜色。</p><p id="acec" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">第 39–42 行</strong>:我们已经使用<code class="fe nd ne nf ng b">text()</code>方法将语言的名称添加到相应的 arc 中。借助于<code class="fe nd ne nf ng b">arc.centroid()</code>方法，该<code class="fe nd ne nf ng b">text()</code>将被放置在每个圆弧的质心。</p><h1 id="3508" class="ll lm in bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">接下来要学习的高级概念</h1><p id="5737" class="pw-post-body-paragraph jz ka in kb b kc mj ke kf kg mk ki kj kk ml km kn ko mm kq kr ks mn ku kv kw ig bi translated">正如你所看到的，D3 允许你用这些基本的组件创造一些引人注目的视觉效果。随着您继续学习 D3.js，这里有一些高级概念将帮助您制作更好的图表和图形:</p><ul class=""><li id="e2ac" class="kx ky in kb b kc kd kg kh kk kz ko la ks lb kw lc ld le lf bi translated">缩放和重新缩放</li><li id="b9ca" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated">用户交互性</li><li id="067d" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated">分层映射</li><li id="3265" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated">高级图表表单</li></ul><p id="a3de" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><em class="mr">快乐学习！</em></p></div></div>    
</body>
</html>