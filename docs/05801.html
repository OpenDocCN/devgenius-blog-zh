<html>
<head>
<title>Stored Procedures SQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">存储过程SQL</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/stored-procedures-sql-34c2d146d6e7?source=collection_archive---------1-----------------------#2021-11-01">https://blog.devgenius.io/stored-procedures-sql-34c2d146d6e7?source=collection_archive---------1-----------------------#2021-11-01</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/14b9cbab9948109b201e68faac12610d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WmPkdIimAGgyenbNyh-Vww.png"/></div></div></figure><p id="53ce" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">你可以在我的网站上阅读这篇文章。</p></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><p id="85fb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">你好。你在程序上是新手吗？没关系，在这篇文章中，我将带着这个强大的工具与您见面。我们将使用T-SQL来编写程序。好了，我们开始吧。</p><p id="b6ba" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">那么，程序是什么？</strong></p><p id="5499" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">存储过程表示作为一个单元执行的一组指令。因此，存储过程允许您简化复杂的操作，并将它们放入单个对象中。您可以编写一次过程，然后反复重用它。此外，您可以向过程传递参数并返回值。</p><p id="400b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">存储过程还允许您限制对表中数据的访问，从而减少与这些数据相关的有意或无意的不必要操作的可能性。</p><p id="a512" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">而另一个重要的方面就是<strong class="jx io">性能</strong>。存储过程通常比常规SQL语句快。这是因为程序代码在第一次运行时编译一次，然后以编译后的形式保存。</p><p id="2b25" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这是一个非常强大的东西，所以每个人至少应该知道它的存在</p></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><p id="1738" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">如何声明和执行程序？</strong></p><p id="05f1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我使用<em class="lb">SQL Server Management Studio</em>和<em class="lb">微软SQL Server。</em></p><p id="ebb8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">首先，我们将创建一个表<code class="fe lc ld le lf b">Products</code>，我们将为其编写程序。</p><pre class="lg lh li lj gt lk lf ll lm aw ln bi"><span id="e21f" class="lo lp in lf b gy lq lr l ls lt">CREATE<!-- --> <!-- -->TABLE<!-- --> <!-- -->Products</span><span id="cc93" class="lo lp in lf b gy lu lr l ls lt">(</span><span id="d4c6" class="lo lp in lf b gy lu lr l ls lt">Id INT<!-- --> <!-- -->IDENTITY PRIMARY<!-- --> <!-- -->KEY,</span><span id="b0b9" class="lo lp in lf b gy lu lr l ls lt">ProductName NVARCHAR(30) NOT<!-- --> <!-- -->NULL,</span><span id="1778" class="lo lp in lf b gy lu lr l ls lt">Manufacturer NVARCHAR(20) NOT<!-- --> <!-- -->NULL,</span><span id="adbf" class="lo lp in lf b gy lu lr l ls lt">ProductCount INT<!-- --> <!-- -->DEFAULT<!-- --> <!-- -->0,</span><span id="ff9f" class="lo lp in lf b gy lu lr l ls lt">Price MONEY NOT<!-- --> <!-- -->NULL</span><span id="6c38" class="lo lp in lf b gy lu lr l ls lt">);</span></pre><p id="4cfc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">并插入一些数据，例如:</p><pre class="lg lh li lj gt lk lf ll lm aw ln bi"><span id="c83f" class="lo lp in lf b gy lq lr l ls lt">INSERT INTO Products VALUES ('IPhone X', 'Apple', 10000, 999);</span><span id="814c" class="lo lp in lf b gy lu lr l ls lt">INSERT INTO Products VALUES ('IPhone 13', 'Apple', 5000, 1999);</span><span id="7f84" class="lo lp in lf b gy lu lr l ls lt">INSERT INTO Products VALUES ('Galaxy S20', 'Samsung', 3000, 500);</span><span id="38e7" class="lo lp in lf b gy lu lr l ls lt">INSERT INTO Products VALUES ('Mi 10S', 'Xiaomi', 20000, 299);</span><span id="066f" class="lo lp in lf b gy lu lr l ls lt">INSERT INTO Products VALUES ('Nokia X10', 'Nokia', 7500, 899);</span></pre><p id="6e2e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在，我们可以使用以下命令选择数据:</p><p id="938a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe lc ld le lf b">SELECT * FROM Products</code></p><p id="b157" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们用这个做一个程序:</p><pre class="lg lh li lj gt lk lf ll lm aw ln bi"><span id="9b5b" class="lo lp in lf b gy lq lr l ls lt">USE productdb;                   </span><span id="e59e" class="lo lp in lf b gy lu lr l ls lt">GO                               </span><span id="4192" class="lo lp in lf b gy lu lr l ls lt">CREATE PROCEDURE ProductSummary  </span><span id="00ea" class="lo lp in lf b gy lu lr l ls lt">AS                               </span><span id="3848" class="lo lp in lf b gy lu lr l ls lt">SELECT * FROM Products           </span></pre><p id="fddf" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe lc ld le lf b">CREATE PROCEDURE</code>和<code class="fe lc ld le lf b">CREATE PROC</code>命令用于创建存储过程。</p><p id="e48a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">因为<code class="fe lc ld le lf b">CREATE PROCEDURE</code>命令必须在一个单独的包中调用，所以<code class="fe lc ld le lf b">GO</code>命令在安装当前数据库的<code class="fe lc ld le lf b">USE</code>命令之后使用，以定义一个新的包。</p><p id="662e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">程序名后面必须跟有<code class="fe lc ld le lf b">AS</code>关键字。</p><p id="4005" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了将程序体与脚本的其余部分分开，程序代码通常放在一个<code class="fe lc ld le lf b">BEGIN</code> … <code class="fe lc ld le lf b">END</code>块中:</p><pre class="lg lh li lj gt lk lf ll lm aw ln bi"><span id="3a37" class="lo lp in lf b gy lq lr l ls lt">USE productdb;</span><span id="a71b" class="lo lp in lf b gy lu lr l ls lt">GO</span><span id="a4eb" class="lo lp in lf b gy lu lr l ls lt">CREATE PROCEDURE ProductSummary</span><span id="8060" class="lo lp in lf b gy lu lr l ls lt">AS</span><span id="7787" class="lo lp in lf b gy lu lr l ls lt">BEGIN</span><span id="470b" class="lo lp in lf b gy lu lr l ls lt">   SELECT * FROM Products</span><span id="520a" class="lo lp in lf b gy lu lr l ls lt">END;</span></pre><p id="81d3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">添加完过程后，我们可以看到在SQL Server Management Studio数据库节点下的可编程性-&gt;存储过程子节点:</p><p id="300f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">最后，我们可以用命令<code class="fe lc ld le lf b">EXEC</code>或<code class="fe lc ld le lf b">EXECUTE</code>运行程序，并查看结果。</p><pre class="lg lh li lj gt lk lf ll lm aw ln bi"><span id="b365" class="lo lp in lf b gy lq lr l ls lt">EXEC ProductSummary</span></pre><figure class="lg lh li lj gt jo gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/aa22d15f122a701e070626f1d33edc55.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*ff9_rrLhj89-8t97XVGD2A.png"/></div></figure><p id="884c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">使用以下命令删除程序:<code class="fe lc ld le lf b">DROP PROCEDURE ProductSummary</code></p></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><p id="b43c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">创建带参数的SQL存储过程</strong></p><p id="d688" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">过程可以带参数。可以输入参数——在它们的帮助下，您可以向过程传递一些值。参数也可以输出，它们允许你从过程中返回一些值。</p><p id="ba38" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们创建一个接受输入参数并向表<code class="fe lc ld le lf b">Products</code>添加新记录的过程。</p><pre class="lg lh li lj gt lk lf ll lm aw ln bi"><span id="62d5" class="lo lp in lf b gy lq lr l ls lt">USE productdb;</span><span id="5fca" class="lo lp in lf b gy lu lr l ls lt">GO</span><span id="ffa8" class="lo lp in lf b gy lu lr l ls lt">CREATE PROCEDURE AddNewProduct</span><span id="c450" class="lo lp in lf b gy lu lr l ls lt">   @name NVARCHAR(30),</span><span id="df56" class="lo lp in lf b gy lu lr l ls lt">   @manufacturer NVARCHAR(20),</span><span id="2363" class="lo lp in lf b gy lu lr l ls lt">   @productCount INT,</span><span id="6408" class="lo lp in lf b gy lu lr l ls lt">   @price MONEY</span><span id="3ebe" class="lo lp in lf b gy lu lr l ls lt">AS</span><span id="7373" class="lo lp in lf b gy lu lr l ls lt">BEGIN</span><span id="ccc8" class="lo lp in lf b gy lu lr l ls lt">   INSERT INTO Products(ProductName, Manufacturer, ProductCount, Price)</span><span id="f358" class="lo lp in lf b gy lu lr l ls lt">   VALUES(@name, @manufacturer, @productCount, @price)</span><span id="5d46" class="lo lp in lf b gy lu lr l ls lt">END;</span></pre><p id="b3b4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在过程名之后，有一个输入参数列表，它们的定义方式与变量相同——名称以@符号开头，名称之后是变量的类型。</p><p id="d36d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">下一步是使用此过程:</p><pre class="lg lh li lj gt lk lf ll lm aw ln bi"><span id="1477" class="lo lp in lf b gy lq lr l ls lt">USE productdb;<br/></span><span id="5c03" class="lo lp in lf b gy lu lr l ls lt">DECLARE @productName NVARCHAR(30), @company NVARCHAR(20);</span><span id="d380" class="lo lp in lf b gy lu lr l ls lt">DECLARE @productCount INT, @price MONEY</span><span id="53b2" class="lo lp in lf b gy lu lr l ls lt">SET @productName = 'IPhone 7'</span><span id="6683" class="lo lp in lf b gy lu lr l ls lt">SET @company = 'Apple'</span><span id="b0b3" class="lo lp in lf b gy lu lr l ls lt">SET @price = 99</span><span id="16f2" class="lo lp in lf b gy lu lr l ls lt">SET @productCount = 150<br/></span><span id="0c40" class="lo lp in lf b gy lu lr l ls lt">EXEC AddNewProduct @productName, @company, @productCount, @price</span><span id="cf83" class="lo lp in lf b gy lu lr l ls lt">SELECT * FROM Products</span></pre><figure class="lg lh li lj gt jo gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/2db39ced43a5a2c0a4bb0dc9d02917b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*Y0x-9GWiMjfDTlqw4VHgqQ.png"/></div></figure><p id="f248" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">再举一个例子，考虑这样一个过程，它采用一个输入参数按制造商过滤并输出这些记录:</p><pre class="lg lh li lj gt lk lf ll lm aw ln bi"><span id="3db0" class="lo lp in lf b gy lq lr l ls lt">USE productdb;</span><span id="7095" class="lo lp in lf b gy lu lr l ls lt">GO</span><span id="eb57" class="lo lp in lf b gy lu lr l ls lt">CREATE PROCEDURE SelectProductsByManufacturer</span><span id="8681" class="lo lp in lf b gy lu lr l ls lt">   @manufacturer NVARCHAR(20)</span><span id="c720" class="lo lp in lf b gy lu lr l ls lt">AS</span><span id="77a5" class="lo lp in lf b gy lu lr l ls lt">BEGIN</span><span id="1191" class="lo lp in lf b gy lu lr l ls lt">   SELECT * FROM Products</span><span id="53ba" class="lo lp in lf b gy lu lr l ls lt">   WHERE Manufacturer = @manufacturer</span><span id="e06d" class="lo lp in lf b gy lu lr l ls lt">END;</span><span id="0ce4" class="lo lp in lf b gy lu lr l ls lt">--! Also we can pass parameters directly like below:</span><span id="7c1f" class="lo lp in lf b gy lu lr l ls lt">EXEC SelectProductsByManufacturer 'Apple'</span><span id="de70" class="lo lp in lf b gy lu lr l ls lt">--! You can also pass values to procedure parameters by name:</span><span id="5810" class="lo lp in lf b gy lu lr l ls lt">EXEC SelectProductsByManufacturer @manufacturer = 'Apple'</span></pre><figure class="lg lh li lj gt jo gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/88e4049f03fdf827178760ad49ea4404.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*MuPzciFLfj80qLJF7kmI9w.png"/></div></figure><p id="a8e5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果我忘记传递参数会发生什么？你是对的——错误:)<br/>要解决这个问题，你可以把参数标记为可选的，并给它一个默认值。<br/>让我们创建一个带有可选参数的过程。</p><pre class="lg lh li lj gt lk lf ll lm aw ln bi"><span id="989f" class="lo lp in lf b gy lq lr l ls lt">USE productdb;</span><span id="ae16" class="lo lp in lf b gy lu lr l ls lt">GO</span><span id="b524" class="lo lp in lf b gy lu lr l ls lt">CREATE PROCEDURE AddNewProductWithOptionalCount</span><span id="bb6a" class="lo lp in lf b gy lu lr l ls lt">   @name NVARCHAR(20),</span><span id="1c96" class="lo lp in lf b gy lu lr l ls lt">   @manufacturer NVARCHAR(20),</span><span id="91e4" class="lo lp in lf b gy lu lr l ls lt">   @price MONEY,</span><span id="0b1a" class="lo lp in lf b gy lu lr l ls lt">   @count INT = 1 --! default value</span><span id="3a7f" class="lo lp in lf b gy lu lr l ls lt">AS</span><span id="0f01" class="lo lp in lf b gy lu lr l ls lt">BEGIN</span><span id="1b58" class="lo lp in lf b gy lu lr l ls lt">   INSERT INTO Products(ProductName, Manufacturer, Price, ProductCount)</span><span id="5e0f" class="lo lp in lf b gy lu lr l ls lt">   VALUES(@name, @manufacturer, @price, @count)</span><span id="ba4b" class="lo lp in lf b gy lu lr l ls lt">END</span></pre><p id="9e88" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">并执行它:</p><pre class="lg lh li lj gt lk lf ll lm aw ln bi"><span id="b83b" class="lo lp in lf b gy lq lr l ls lt">EXEC AddNewProductWithOptionalCount 'Lenovo K12', 'Lenovo', 399</span><span id="2ce1" class="lo lp in lf b gy lu lr l ls lt">SELECT * FROM Products</span></pre><figure class="lg lh li lj gt jo gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/fc92e388a7cb6f55103149c33ca6598f.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*mA2WfGtzAhA-aLQ-qQnlCg.png"/></div></figure><p id="7119" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在，对于@count参数，您不需要向过程传递值，默认值将是1。</p><p id="be68" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">最好将可选参数放在过程参数列表的末尾。</p><p id="8de9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">还记得参数可以输出吗？输出参数允许您从过程中返回一些结果。使用<code class="fe lc ld le lf b">OUTPUT</code>关键字指定输出参数。</p><p id="54a0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">示例:</p><pre class="lg lh li lj gt lk lf ll lm aw ln bi"><span id="cfae" class="lo lp in lf b gy lq lr l ls lt">USE productdb;</span><span id="cf94" class="lo lp in lf b gy lu lr l ls lt">GO</span><span id="cb28" class="lo lp in lf b gy lu lr l ls lt">CREATE PROCEDURE GetMinMaxProductPrice</span><span id="6ec5" class="lo lp in lf b gy lu lr l ls lt">   @minPrice MONEY OUTPUT,</span><span id="1e71" class="lo lp in lf b gy lu lr l ls lt">   @maxPrice MONEY OUTPUT</span><span id="e636" class="lo lp in lf b gy lu lr l ls lt">AS</span><span id="b81f" class="lo lp in lf b gy lu lr l ls lt">BEGIN</span><span id="d22b" class="lo lp in lf b gy lu lr l ls lt">   SELECT @minPrice = MIN(Price),  @maxPrice = MAX(Price)</span><span id="af2b" class="lo lp in lf b gy lu lr l ls lt">   FROM Products</span><span id="16d5" class="lo lp in lf b gy lu lr l ls lt">END;</span></pre><p id="427d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">当调用输出参数的过程时，变量用<code class="fe lc ld le lf b">OUTPUT</code>关键字传递:</p><pre class="lg lh li lj gt lk lf ll lm aw ln bi"><span id="d30f" class="lo lp in lf b gy lq lr l ls lt">USE productdb;</span><span id="fb0d" class="lo lp in lf b gy lu lr l ls lt">DECLARE @minPrice MONEY, @maxPrice MONEY<br/></span><span id="89dc" class="lo lp in lf b gy lu lr l ls lt">EXEC GetMinMaxProductPrice @minPrice OUTPUT, @maxPrice OUTPUT</span><span id="3417" class="lo lp in lf b gy lu lr l ls lt">PRINT 'Min price ' + CONVERT(VARCHAR, @minPrice)</span><span id="f7d3" class="lo lp in lf b gy lu lr l ls lt">PRINT 'Max price ' + CONVERT(VARCHAR, @maxPrice)</span></pre><figure class="lg lh li lj gt jo gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/9b970fb35ce60beff169afd5f9743001.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*E_1UaWXqwvWuXJfsB4-GNg.png"/></div></figure><p id="56d5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">请记住，您可以在过程中组合输入和输出参数。</p><p id="8791" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">还有一个功能——通过<code class="fe lc ld le lf b">ALTER PROCEDURE</code>改变现有程序</p><p id="0ab1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们改变这一个程序。</p><pre class="lg lh li lj gt lk lf ll lm aw ln bi"><span id="dc9d" class="lo lp in lf b gy lq lr l ls lt">USE productdb;</span><span id="2a03" class="lo lp in lf b gy lu lr l ls lt">GO</span><span id="6e1c" class="lo lp in lf b gy lu lr l ls lt">CREATE PROCEDURE SelectProductsByManufacturer</span><span id="b2cb" class="lo lp in lf b gy lu lr l ls lt">   @manufacturer NVARCHAR(20)</span><span id="1e7f" class="lo lp in lf b gy lu lr l ls lt">AS</span><span id="a06b" class="lo lp in lf b gy lu lr l ls lt">BEGIN</span><span id="a99e" class="lo lp in lf b gy lu lr l ls lt">   SELECT * FROM Products</span><span id="cc66" class="lo lp in lf b gy lu lr l ls lt">   WHERE Manufacturer = @manufacturer</span><span id="53f7" class="lo lp in lf b gy lu lr l ls lt">END;</span></pre><p id="9330" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">到</p><pre class="lg lh li lj gt lk lf ll lm aw ln bi"><span id="778e" class="lo lp in lf b gy lq lr l ls lt">USE productdb;</span><span id="2ff0" class="lo lp in lf b gy lu lr l ls lt">GO</span><span id="53ec" class="lo lp in lf b gy lu lr l ls lt">ALTER PROCEDURE SelectProductsByManufacturer @manufacturer nvarchar(20)</span><span id="1de6" class="lo lp in lf b gy lu lr l ls lt">AS</span><span id="e61a" class="lo lp in lf b gy lu lr l ls lt">BEGIN</span><span id="9e6d" class="lo lp in lf b gy lu lr l ls lt">   SELECT * FROM Products</span><span id="6859" class="lo lp in lf b gy lu lr l ls lt">   WHERE Manufacturer LIKE @manufacturer + '%' --! Here we added LIKE operator insted of '='</span><span id="b02b" class="lo lp in lf b gy lu lr l ls lt">END;</span></pre><p id="3065" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">仅此而已，但请记住，您可以在过程中使用next语句:</p><ol class=""><li id="7310" class="ma mb in jx b jy jz kc kd kg mc kk md ko me ks mf mg mh mi bi translated">否则</li><li id="d96d" class="ma mb in jx b jy mj kc mk kg ml kk mm ko mn ks mf mg mh mi bi translated">在…期间</li><li id="8457" class="ma mb in jx b jy mj kc mk kg ml kk mm ko mn ks mf mg mh mi bi translated">继续</li><li id="d1d5" class="ma mb in jx b jy mj kc mk kg ml kk mm ko mn ks mf mg mh mi bi translated">破裂</li><li id="a155" class="ma mb in jx b jy mj kc mk kg ml kk mm ko mn ks mf mg mh mi bi translated">试着接住</li></ol><p id="7261" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">感谢阅读这篇文章。希望之后你能更好地适应这些程序。编码快乐！</p><h1 id="8cd7" class="mo lp in bd mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk bi translated">学到了新东西？</h1><p id="6f3f" class="pw-post-body-paragraph jv jw in jx b jy nl ka kb kc nm ke kf kg nn ki kj kk no km kn ko np kq kr ks ig bi translated">如果你喜欢这篇文章，可以<a class="ae kt" href="https://www.buymeacoffee.com/stasoz" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">给我买杯咖啡</strong> </a>我写下一篇文章的时候再喝:)</p><figure class="lg lh li lj gt jo gh gi paragraph-image"><a href="https://www.buymeacoffee.com/stasoz"><div class="gh gi nq"><img src="../Images/cf79c871f5a738ec15a7f5802d80017f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lviQAsrtgJB0dMiercB9ig.png"/></div></a></figure></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><p id="a6cc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="lb">更多内容尽在</em><a class="ae kt" href="http://blog.devgenius.io" rel="noopener ugc nofollow" target="_blank"><em class="lb">blog . dev genius . io</em></a><em class="lb">。</em></p></div></div>    
</body>
</html>