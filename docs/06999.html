<html>
<head>
<title>Predicting The Price of A House Using Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用机器学习预测房价</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/predicting-the-price-of-a-house-using-machine-learning-6288f21c891e?source=collection_archive---------4-----------------------#2022-02-18">https://blog.devgenius.io/predicting-the-price-of-a-house-using-machine-learning-6288f21c891e?source=collection_archive---------4-----------------------#2022-02-18</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/8eda2be6f3b33b8968a305ec6b43f7eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VmoG1wccXXMFht4y2yYkMQ.png"/></div></div></figure><p id="42f6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">什么是房子？</p><blockquote class="kt ku kv"><p id="0e94" class="jv jw kw jx b jy jz ka kb kc kd ke kf kx kh ki kj ky kl km kn kz kp kq kr ks ig bi translated">根据<a class="ae la" href="https://en.wikipedia.org/wiki/House" rel="noopener ugc nofollow" target="_blank">维基百科</a>的说法，房子是一个单元的住宅建筑。它的复杂程度不一，从简陋的小屋到复杂的木头、砖石、混凝土或其他材料的结构，配备有管道、电气、供暖、通风和空调系统。</p></blockquote><p id="6621" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">有些房子仅限于一个或多个相同数量的家庭或社会团体。人们通常外出工作、上学或从事其他日常活动中需要社交的活动。房子里最频繁的活动就是休息和睡觉。</p><p id="9df1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现代住宅由几个房间组成，每个房间都有特定的功能:卧室、浴室、厨房、起居室、餐厅、地下室等等。</p><p id="4788" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">根据上面的解释，许多人想拥有自己的房子。为了拥有一栋房子，他们中的一些人在空地上建造了它。同时，其他人直接从另一个人那里买。当谈到买房时，许多考虑因素需要注意，如有多少卧室和浴室，房子的条件如何，房子是什么时候建造的，以及最重要的问题是房子的合适价格是多少。</p><p id="380b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">有些人觉得很难决定这个价格是否合适。为了回答这个问题，我试图通过建立一个预测房屋价格的机器学习模型来提供帮助。在创建这个机器学习模型时，我使用了来自<a class="ae la" href="https://www.kaggle.com/shree1992/housedata" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>的数据集。</p></div><div class="ab cl lb lc hr ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ig ih ii ij ik"><h1 id="b24c" class="li lj in bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">数据剖析</h1><p id="e17f" class="pw-post-body-paragraph jv jw in jx b jy mg ka kb kc mh ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">在创建机器学习模型之前，我需要先了解数据集。因此，我将进行数据分析，以便更好地理解数据。</p><h2 id="5fb7" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">导入数据</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="20c2" class="ml lj in nc b gy ng nh l ni nj">#Importing Data<br/>import pandas as pd<br/>pd.set_option('display.max_columns',None)<br/>df = pd.read_csv('Data Rumah.csv')</span></pre><p id="3bfa" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">第一步是初始化库，使用<strong class="jx io">熊猫</strong>、<strong class="jx io"> </strong>将数据集导入 Python，并将其指定为<strong class="jx io"> df </strong>。从 Kaggle 下载的数据将被保存为<strong class="jx io">‘Data rumah . CSV’。</strong></p><h2 id="c73a" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">显示数据的长度</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="b7c3" class="ml lj in nc b gy ng nh l ni nj">#Showing The Length of The Data<br/>print("\nThe Length of The Data: ", len(df))</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/18a5a1db5a0aab715b1d623686dfa7e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:494/format:webp/1*1TrBK0DTo4neo6m0x6Y9Ww.png"/></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd lk">图一。</strong>数据集的长度</figcaption></figure><p id="8aed" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">第二步是使用<strong class="jx io"> len() </strong>显示数据集中有多少数据。结果是这个数据的大小是<strong class="jx io"> 4600 </strong>。</p><h2 id="1e2c" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">显示数据的形状</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="1f41" class="ml lj in nc b gy ng nh l ni nj">#Showing The Shape of The Data<br/>print("\nThe Shape of The Data: ", df.shape)</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi np"><img src="../Images/71b3aa04db2ed6dd75dfba13b512db8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:572/format:webp/1*wpzh8cJ5A8Q3qGEQoQ26iQ.png"/></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd lk">图二。</strong>数据集的形状</figcaption></figure><p id="74ee" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">第三步是使用<strong class="jx io">显示数据的形状。形状</strong>。结果是这个数据有<strong class="jx io"> 4600 行和</strong>18 列。</p><h2 id="09f5" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">显示数据的信息</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="bf36" class="ml lj in nc b gy ng nh l ni nj">#Showing The Information of The Data<br/>print("\nThe Information of The Data: ")<br/>print(df.info())</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/cbe5c2cf8af0b35028f8d3285a3063c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/1*8jHjDZl8YCd7BRh4_BXD5A.png"/></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd lk">图三。</strong>数据的信息</figcaption></figure><p id="565c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">第四步是使用<strong class="jx io">从数据中获取信息。info() </strong></p><h2 id="dc85" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">显示统计计算</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="381f" class="ml lj in nc b gy ng nh l ni nj">#Showing The Statistical Calculations<br/>print("\nThe Statistical Calculations: ")<br/>print(df.describe().T)</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/db559052d1f82cb3b639d247c442f921.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*JAqKYK-PiMjl91kZeTQsWA.png"/></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd lk">图 4。</strong>统计计算的结果</figcaption></figure><p id="53fd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">第五步是使用<strong class="jx io">显示数据的统计分析。</strong>形容()。</p><h2 id="b7e0" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">显示唯一的数据</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="f1a7" class="ml lj in nc b gy ng nh l ni nj">#Showing The Unique Data<br/>print("\nThe Unique Data: ")<br/>print(df.nunique())</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/b88fc2b12d9daedf8dd5615fd78dd234.png" data-original-src="https://miro.medium.com/v2/resize:fit:394/format:webp/1*N_A5tNsWdNCT1l7XZS4rEw.png"/></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd lk">图五。</strong>每列中具有唯一值的数据量</figcaption></figure><p id="01fb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">数据分析的第六步是使用函数<strong class="jx io">显示来自每一列的唯一数据。努尼克()</strong>。</p><h2 id="43a8" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">更改列名和列值</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="b2de" class="ml lj in nc b gy ng nh l ni nj">#Changing The Column's Name And The Column's Value<br/>kolom_string = list(df.dtypes[df.dtypes == 'object'].index)<br/>for col in kolom_string:<br/>    df[col] = df[col].str.lower().str.replace(' ', '_')<br/><br/>df.columns = df.columns.str.capitalize().str.replace('_', ' ')<br/><br/>df.rename(columns ={'Bedrooms': 'Bedroom(s)',<br/>                    'Bathrooms': 'Bathroom(s)',<br/>                    'Sqft living': 'Square Meter Living',<br/>                    'Sqft lot': 'Square Meter Lot',<br/>                    'Floors': 'Floor(s)',<br/>                    'Sqft above': 'Square Meter Above',<br/>                    'Sqft basement': 'Basement',<br/>                    'Yr built': 'Year Built',<br/>                    'Yr renovated': 'Renovated',<br/>                    'Statezip': 'State ZIP'}, inplace=True)</span></pre><h2 id="8dd3" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">寻找相关性</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="3b45" class="ml lj in nc b gy ng nh l ni nj">#Looking For A Correlation<br/>import numpy as np<br/>import seaborn as sns<br/>import matplotlib.pyplot as plt<br/>plt.figure(figsize=(17, 15))<br/>corr_mask = np.triu(df.corr())<br/>h_map = sns.heatmap(df.corr(), mask=corr_mask, cmap='Blues')<br/>plt.yticks(rotation=360)<br/>plt.show()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/66a589a1b19b57b34b426476c8bb1341.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wy5OW2fr8sn399ykYm9q5w.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd lk">图六。</strong>热图关联</figcaption></figure><p id="eb14" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">数据分析的最后一步是通过可视化来寻找每个数据的相关性。在这部分，我将使用<strong class="jx io"> Seaborn </strong>、<strong class="jx io"> Matplotlib </strong>和<strong class="jx io"> Numpy </strong>。</p><h1 id="b01c" class="li lj in bd lk ll nu ln lo lp nv lr ls lt nw lv lw lx nx lz ma mb ny md me mf bi translated">数据清理</h1><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="e6e5" class="ml lj in nc b gy ng nh l ni nj">#Create a function to remove the outliers<br/>def hapus_outliers(data, col):<br/>    Q1 = data[col].quantile(0.25)<br/>    Q3 = data[col].quantile(0.75)<br/>    IQR = Q3 - Q1<br/>    data = data[~((data[col] &lt; (Q1 - 1.5 * IQR)) | (data[col] &gt; (Q3 + 1.5 * IQR)))]<br/>    return data</span></pre><p id="60ff" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在进行数据清理之前，我将创建一个名为<strong class="jx io"> hapus_outliers </strong>的函数，它接收参数<strong class="jx io">数据</strong>和<strong class="jx io">列</strong>。</p><h2 id="bd67" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">寻找每一列中缺少的值</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="e2ae" class="ml lj in nc b gy ng nh l ni nj">print(df.isnull().sum())</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/c59e7ec6aca428e796703a43b6fa3e3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*IcZp8AdEQ_UetUcK9-YaKw.png"/></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd lk">图 7 </strong>。每列中缺失值的数量</figcaption></figure><p id="8793" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我使用<strong class="jx io"> isnull() </strong>和<strong class="jx io"> sum() </strong>来计算缺少的值是多少。结果表明该数据集中没有缺失值。</p><h2 id="7947" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">删除不必要的列</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="5bec" class="ml lj in nc b gy ng nh l ni nj">#Removing Unnecessary Column<br/>df = df.drop(['Date'], axis=1)<br/>df = df.drop(['Country'], axis=1)<br/>df = df.drop(['Street'], axis=1)<br/>df = df.drop(['State ZIP'], axis=1)</span></pre><p id="313b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">删除的栏目有<strong class="jx io">日期</strong>、<strong class="jx io">国家</strong>、<strong class="jx io">街道</strong>、<strong class="jx io">州邮政编码</strong>。删除日期列的原因是它只给出关于日期的信息。删除国家列的原因是该列只有一个值:美国。至于街道列和州邮政编码列被删除，因为每所房子都有自己的街道和州邮政编码。</p><h2 id="1445" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">检查价格栏</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="cd77" class="ml lj in nc b gy ng nh l ni nj">#Checking The Price Column<br/>print("\nChecking The Price Column")<br/>sns.histplot(df['Price'])<br/>plt.show()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/d56f3477fb8dd563beb7097f22c89cf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fBGgNoOoB2pUZBvv8HVY1g.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd lk">图 8。</strong>价格列的可视化</figcaption></figure><p id="c55d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">第一步是通过使用<strong class="jx io"> seaborn </strong>和<strong class="jx io"> matplotlib </strong>可视化数据来检查价格列。正如您在<strong class="jx io">图 8 </strong>中看到的，<strong class="jx io">价格</strong>列有异常值。为了克服这些异常值，我将使用我之前创建的名为<strong class="jx io"> hapus_outliers </strong>的函数删除它们。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="3ccb" class="ml lj in nc b gy ng nh l ni nj">df = hapus_outliers(df, 'Price')<br/>print(df.shape)<br/>sns.histplot(df['Price'])<br/>plt.show()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/572b7123486ed8f534c902b9a016573f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Re8SQeBVn21bcOl-L2POgQ.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd lk">图九。</strong>去除异常值后价格列的可视化</figcaption></figure><p id="c66c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在去除价格列中的异常值后，该数据有<strong class="jx io"> 4360 行和 14 列</strong>。</p><h2 id="0044" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">检查卧室栏</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="7424" class="ml lj in nc b gy ng nh l ni nj">#Checking The Bedroom(s) Column<br/>print("\nChecking The Bedroom(s) Column")<br/>sns.catplot(x='Bedroom(s)', y='Price', data=df, height=5, aspect=2)<br/>plt.show()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/3512fc1ec67610bb09f50449ae128bbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QVHnU1ZfFKyPKLhpyMXLyA.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd lk">图 10。</strong>卧室的可视化列</figcaption></figure><p id="55bb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">从<strong class="jx io">图 10 </strong>可以看出，卧室(s)一栏有十种数据:0、1、2、3、4、5、6、7、8、9。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="94c4" class="ml lj in nc b gy ng nh l ni nj">mask_bedroom = {0:1, 1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9}<br/>df['Bedroom(s)'] = df['Bedroom(s)'].map(mask_bedroom)<br/>sns.catplot(x='Bedroom(s)', y='Price', data=df, height=5, aspect=2)<br/>plt.show()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/815a5d9ea31fda89231ad10d46162a23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z5KleA6rBwrgCxhCf_Azsg.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd lk">图 11。</strong>改变数值后卧室栏的可视化</figcaption></figure><p id="6e37" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这些数字表示房子里卧室的数量。我会假设价值为 0 的房子是 1 居室的房子。所以我把 0 值变成 1。</p><h2 id="60c5" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">检查浴室栏</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="0a95" class="ml lj in nc b gy ng nh l ni nj">#Checking The Bathroom(s) Column<br/>print("\nChecking The Bathroom(s) Column")<br/>sns.catplot(x='Bathroom(s)', y='Price', data=df, height=5, aspect=2)<br/>plt.show()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/341b9481c1f99a73804a2fe1b9fdf43c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZoViBA3da8sfbNXT9lWxEQ.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd lk">图 12。</strong>浴室列的可视化</figcaption></figure><p id="ad96" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">从<strong class="jx io">图 12 </strong>中可以看到，浴室(s)一栏有 20 种数据。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="1111" class="ml lj in nc b gy ng nh l ni nj">mask_bathroom = {0:1, 0.75: 1, 1: 1, 1.25:1,<br/>                 1.5:2, 1.75:2, 2:2, 2.25:2,<br/>                 2.5:3, 2.75:3, 3:3, 3.25:3,<br/>                 3.5:4, 3.75:4, 4:4, 4.25:4,<br/>                 4.5:5, 4.75:5, 5:5, 5.25:5,<br/>                 5.5:6, 5.75:6, 6:6, 6.25:6,}<br/>df['Bathroom(s)'] = df['Bathroom(s)'].map(mask_bathroom)<br/>sns.catplot(x='Bathroom(s)', y='Price', data=df, height=5, aspect=2)<br/>plt.show()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/5f112a0a4518ed228bca78154637b242.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z__QrK_o177UD83ty5bdAw.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd lk">图十三。</strong>更改值后浴室列的可视化</figcaption></figure><p id="529d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这些数字表示房子里浴室的数量。我会把这些值改成<strong class="jx io"> 1，2，3，4，5，6 </strong>。</p><h2 id="6523" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">检查居住、地段和以上栏的平方米</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="72a9" class="ml lj in nc b gy ng nh l ni nj">#Checking The Square Meter Living, Lot, And Above Column<br/>print("\nChecking The Square Meter Column")<br/>kolom_square_meter = df.columns[df.columns.str.contains('Square Meter')]</span></pre><p id="4aa8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我要做的第一步是创建一个名为<strong class="jx io"> kolom_square_meter </strong>的变量，将包含“Square Meter”的列与另一列分开。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="a184" class="ml lj in nc b gy ng nh l ni nj">df[kolom_square_meter] = df[kolom_square_meter].apply(lambda x: x*0.09290304)</span></pre><p id="bb88" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">接下来，我将更改 kolom_square_meter 中的值。之前本栏目用<strong class="jx io">平方英尺</strong>；现在我把它换算成<strong class="jx io">平方米</strong>。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="0339" class="ml lj in nc b gy ng nh l ni nj">from matplotlib.gridspec import GridSpec<br/>fig = plt.figure(figsize=(10, 5))<br/>grid = GridSpec(ncols=3, nrows=1, figure=fig)<br/>for i, name in enumerate(kolom_square_meter):<br/>    ax = fig.add_subplot(grid[i])<br/>    sns.histplot(df[name], ax=ax)<br/>plt.show()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/f2da3055f7375ac864d647299b3e5e2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d-i-wbvh9j92SCGIjzuDiw.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd lk">图 14。</strong>可视化的平方米居住、地段及以上栏目</figcaption></figure><p id="2d10" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">正如您在<strong class="jx io">图 14 </strong>中看到的，平方米居住、地段和以上列有异常值。为了克服这些异常值，我将删除它们。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="95ef" class="ml lj in nc b gy ng nh l ni nj">df = hapus_outliers(df, 'Square Meter Living')<br/>df = hapus_outliers(df, 'Square Meter Lot')<br/>df = hapus_outliers(df, 'Square Meter Above')<br/>print("\nThe Shape of The Data After Removing The Outliers: ", df.shape)<br/>fig = plt.figure(figsize=(10, 5))<br/>grid = GridSpec(ncols=3, nrows=1, figure=fig)<br/>for i, name in enumerate(kolom_square_meter):<br/>    ax = fig.add_subplot(grid[i])<br/>    sns.histplot(df[name], ax=ax)<br/>plt.show()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/cf96d333c8c9dfaf50138b0db3b54225.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7frzyWWMw8jnaVEFCb8yqg.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd lk">图 15。</strong>去除异常值后的居住、地段和以上面积栏的可视化</figcaption></figure><p id="1280" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">除去价格列中的异常值后，这个数据有<strong class="jx io"> 3725 行和 14 列</strong>。</p><h2 id="4c29" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">检查楼层列</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="1cd2" class="ml lj in nc b gy ng nh l ni nj">#Checking The Floor(s) Column<br/>print("\nChecking The Floor(s) Column")<br/>sns.catplot(x='Floor(s)', y='Price', data=df, height=5, aspect=2)<br/>plt.show()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/2a4188ec38b326383d40f9404bb7408a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e1O9sJCLQDTaoY-TxpgPGg.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd lk">图 16。</strong>楼层列的可视化</figcaption></figure><p id="a0bf" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在<strong class="jx io">图 16 </strong>中，楼层(s)栏有六种数据:<strong class="jx io"> 1、1.5、2、2.5、3、3.5 </strong>。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="07c7" class="ml lj in nc b gy ng nh l ni nj">mask_floors = {1: 1, 1.5:1, 2:2, 2.5:3, 3:3, 3.5:4}<br/>df['Floor(s)'] = df['Floor(s)'].map(mask_floors)<br/>sns.catplot(x='Floor(s)', y='Price', data=df, height=5, aspect=2)<br/>plt.show()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/c457861c80da9f93dab973066597cd90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fo5Etn_9HNruzfmtpPXFmw.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd lk">图 17。</strong>更改值后楼层列的可视化</figcaption></figure><p id="11cd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我会将这些值从<strong class="jx io"> 1、1.5、2、2.5、3 和 3.5 </strong>更改为<strong class="jx io"> 1、2、3 和 4 </strong>。</p><h2 id="94c5" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">检查滨水专栏</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="a354" class="ml lj in nc b gy ng nh l ni nj">#Checking The Waterfront Column<br/>print("\nChecking The Waterfront Column")<br/>sns.catplot(x='Waterfront', y='Price', data=df, height=5, aspect=2)<br/>plt.show()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/5c6c2e47aba234baca503680fb0fa6e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YT9U4_dm6DYfapaz-HEkCA.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd lk">图 18。</strong>滨水圆柱的可视化</figcaption></figure><h2 id="bd6b" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">检查视图列</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="1e77" class="ml lj in nc b gy ng nh l ni nj">#Checking The View Column<br/>print("\nChecking The View Column")<br/>sns.catplot(x='View', y='Price', data=df, height=5, aspect=2)<br/>plt.show()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/c3a6b3331a15131a21c45faa1b4e2b0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N8Q6fIk4Ul7thDvMYdFgBA.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd lk">图 19。</strong>视图列的可视化</figcaption></figure><p id="b95e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在<strong class="jx io">图 19 </strong>中，楼层(s)栏有五种数据:<strong class="jx io"> 0、1、2、3、4 </strong>。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="3845" class="ml lj in nc b gy ng nh l ni nj">mask_view = {0: 1, 1:2, 2:3, 3:4, 4:5}<br/>df['View'] = df['View'].map(mask_view)<br/>sns.catplot(x='View', y='Price', data=df, height=5, aspect=2)<br/>plt.show()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/aeec764a81fa8348bf200eb7eba88c59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*75OiRT3KV4Au0j2Ln0pf5Q.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd lk">图 20。</strong>改变值后视图列的可视化</figcaption></figure><p id="539e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我会将这些值从<strong class="jx io"> 0、1、2、3 和 4 </strong>更改为<strong class="jx io"> 1、2、3、4 和 5 </strong>。</p><h2 id="cb3a" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">检查条件列</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="4295" class="ml lj in nc b gy ng nh l ni nj">#Checking The Condition Column<br/>print("\nChecking The Condition Column")<br/>sns.catplot(x='Condition', y='Price', data=df, height=5, aspect=2)<br/>plt.show()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/e052d706cd7deaf1cee2e3e0ba1d8f03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cvDeKO3dZWO2ctG1YrOR-Q.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd lk">图 21。</strong>条件栏的可视化</figcaption></figure><h2 id="585b" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">检查地下室的柱子</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="b931" class="ml lj in nc b gy ng nh l ni nj">#Checking The Basement Column<br/>print("\nChecking The Basement Column")<br/>sns.histplot(df['Basement'])<br/>plt.show()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/ddff23a383070feb50b5d69b4e4afd55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gc1odjk6lVexOgM7X0tqXg.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd lk">图 22。</strong>地下室柱的可视化</figcaption></figure><p id="3b14" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">最初，这个专栏提供了地下室有多大的信息。但是我决定把这个栏目改一下，给出这个房子有没有地下室的信息。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="d246" class="ml lj in nc b gy ng nh l ni nj">df['Basement'] = df['Basement'].apply(lambda x: 0 if x == 0 else 1)<br/>sns.catplot(x='Basement', y='Price', data=df, height=5, aspect=2)<br/>plt.show()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/b8ab358bc1dd80d1a90877b6e092b92d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3g_dvWoZkd49_0dbCZthOw.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd lk">图 23。</strong>改变值后基底柱的可视化</figcaption></figure><p id="8333" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">所以，如果地下室一栏里的值是 0，就说明房子没有地下室。</p><h2 id="6215" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">检查“年份”栏</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="2ed3" class="ml lj in nc b gy ng nh l ni nj">#Checking The Year Built Column<br/>print("\nChecking The Year Column")<br/>sns.histplot(df['Year Built'])<br/>plt.show()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/f61caa93a5c824f5744fac90bbc74a62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YUJO03uhCURjeC8RmADY7g.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd lk">图 24。</strong>可视化的年建栏目</figcaption></figure><h2 id="cde0" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">检查翻新的柱子</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="c763" class="ml lj in nc b gy ng nh l ni nj">#Checking The Renovated Column<br/>print("\nChecking The Renovated Column")<br/>sns.histplot(df['Renovated'])<br/>plt.show()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/d22a447306411c7e129e52575edb6da8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GujIaidMbOtq5KznozwuTg.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd lk">图 25。</strong>改造后柱子的可视化</figcaption></figure><p id="af7d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">最初，这个专栏提供了这所房子最后一次装修的信息。我决定改变这个专栏来提供关于这个房子是否被翻新过的信息。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="4c55" class="ml lj in nc b gy ng nh l ni nj">df['Renovated'] = df['Renovated'].apply(lambda x: 0 if x == 0 else 1)<br/>sns.catplot(x='Renovated', y='Price', data=df, height=5, aspect=2)<br/>plt.show()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oa"><img src="../Images/84aaade8b9bdf1d4a099621cd79bf91b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1p941iz6mnlET4fOabYkZQ.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd lk">图 26。</strong>更改值后更新后的柱的可视化</figcaption></figure><p id="1902" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">所以，如果装修一栏里的值是 0，说明房子从来没有装修过。</p><h2 id="8eb9" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">删除重复数据</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="8f15" class="ml lj in nc b gy ng nh l ni nj">#Removing Duplicated Data<br/>print("\nRemoving Duplicated Data")<br/>df.drop_duplicates(inplace=True)<br/>print('\nThe Shape of The Data After Removing The Duplicated Data: ', df.shape)</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/ff1854d79c1e9816e2159c1412ad1c13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/1*DbpfgRLrJEdz8VQoiY34sQ.png"/></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd lk">图 27。</strong>删除重复数据后的数据形状</figcaption></figure><p id="89f3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在这一部分，我将删除重复的数据。删除重复数据后，该数据有<strong class="jx io"> 3725 行和</strong>14 列。</p></div><div class="ab cl lb lc hr ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ig ih ii ij ik"><h1 id="d9b0" class="li lj in bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">分离特征和标签</h1><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="3bcc" class="ml lj in nc b gy ng nh l ni nj">#Separating Features and Labels<br/>X = df.drop('Price', axis=1)<br/>y = df['Price'].astype(int)</span></pre><p id="a326" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在这一部分，我将制造两个变量；第一个变量是仅具有特征的<strong class="jx io"> X </strong>和仅具有标签的<strong class="jx io"> y </strong>。</p></div><div class="ab cl lb lc hr ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ig ih ii ij ik"><h1 id="092f" class="li lj in bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">数据集的缩放和标注转换</h1><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="e368" class="ml lj in nc b gy ng nh l ni nj">#Scaling and Labels Conversion on The Dataset<br/>from sklearn.impute import SimpleImputer<br/>from sklearn.preprocessing import OneHotEncoder, StandardScaler<br/>from sklearn.compose import make_column_selector,make_column_transformer<br/><br/>impute_angka = SimpleImputer(strategy='most_frequent', add_indicator=True)<br/>scaler = StandardScaler()<br/><br/>impute_kategori = SimpleImputer(strategy='constant')<br/>ohe = OneHotEncoder(handle_unknown='ignore')<br/><br/>kolom_angka = make_column_selector(dtype_include='number')<br/>kolom_kategori = make_column_selector(dtype_exclude='number')<br/><br/>from sklearn.pipeline import make_pipeline<br/>preprocessor = make_column_transformer((make_pipeline(impute_angka, scaler), kolom_angka),<br/>                                       (make_pipeline(impute_kategori, ohe), kolom_kategori))</span></pre><p id="ef8c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">接下来，我将使用<strong class="jx io"> StandardScaler </strong>、<strong class="jx io"> OneHotEncoder </strong>、<strong class="jx io"> make_pipeline </strong>、<strong class="jx io"> make_column_selector </strong>和<strong class="jx io">make _ column _ transformer</strong>对数据集进行缩放和标签转换。</p></div><div class="ab cl lb lc hr ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ig ih ii ij ik"><h1 id="ce15" class="li lj in bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">准备培训、测试和验证数据集</h1><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="4bf8" class="ml lj in nc b gy ng nh l ni nj">#Preparing Training, Testing, And Validating Dataset<br/>from sklearn.model_selection import train_test_split</span><span id="9dcd" class="ml lj in nc b gy oc nh l ni nj">X_train_full, X_test, y_train_full, y_test = train_test_split(X, y, test_size=0.2, random_state=4)</span><span id="9a6a" class="ml lj in nc b gy oc nh l ni nj">X_train, X_val, y_train, y_val = train_test_split(X_train_full, y_train_full, test_size=0.2, random_state=3)</span></pre></div><div class="ab cl lb lc hr ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ig ih ii ij ik"><h1 id="36ba" class="li lj in bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">建立一个机器学习模型</h1><p id="1c76" class="pw-post-body-paragraph jv jw in jx b jy mg ka kb kc mh ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">下一步是建立一个机器学习模型。我将对<strong class="jx io">线性回归</strong>、<strong class="jx io">决策树回归量</strong>、<strong class="jx io">随机森林回归量</strong>、<strong class="jx io">套索</strong>和<strong class="jx io">山脊</strong>进行比较。</p><h2 id="18cf" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">线性回归</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="6913" class="ml lj in nc b gy ng nh l ni nj">#Build A Machine Learning Model<br/>from sklearn.linear_model import LinearRegression<br/>model_linreg = make_pipeline(preprocessor, LinearRegression())<br/>model_linreg = model_linreg.fit(X_train, y_train)<br/>y_pred_linreg = model_linreg.predict(X_test)<br/><br/>#Evaluating The Machine Learning Model<br/>from sklearn.metrics import mean_squared_error, mean_absolute_error<br/>import numpy as np<br/><br/>#Mean Squared Error<br/>mse = mean_squared_error(y_test, y_pred_linreg)<br/>print('\nMean squared error dari Testing Set:', round(mse))<br/><br/>#Mean Absolute Error<br/>mae = mean_absolute_error(y_test, y_pred_linreg)<br/>print('Mean absolute error dari Testing Set:', round(mae))<br/><br/>#Root Mean Squared Error<br/>rmse = np.sqrt(mse)<br/>print('Root Mean Squared Error dari Testing Set:', round(rmse))</span></pre><h2 id="6bb0" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">决策树回归器</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="4e18" class="ml lj in nc b gy ng nh l ni nj">#Build a Machine Learning Model DecisionTree<br/>from sklearn.tree import DecisionTreeRegressor<br/>model_dtr = make_pipeline(preprocessor, DecisionTreeRegressor(random_state=42))<br/>model_dtr = model_dtr.fit(X_train, y_train)<br/>y_pred_dtr = model_dtr.predict(X_test)<br/><br/>#Evaluating The Machine Learning Model<br/>from sklearn.metrics import mean_squared_error, mean_absolute_error<br/>import numpy as np<br/><br/>#Mean Squared Error<br/>mse = mean_squared_error(y_test, y_pred_dtr)<br/>print('\nMean squared error dari Testing Set:', round(mse))<br/><br/>#Mean Absolute Error<br/>mae = mean_absolute_error(y_test, y_pred_dtr)<br/>print('Mean absolute error dari Testing Set:', round(mae))<br/><br/>#Root Mean Squared Error<br/>rmse = np.sqrt(mse)<br/>print('Root Mean Squared Error dari Testing Set:', round(rmse))</span></pre><h2 id="b9c4" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">随机森林回归量</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="0cc7" class="ml lj in nc b gy ng nh l ni nj">#Build a Machine Learning Model RandomForest<br/>from sklearn.ensemble import RandomForestRegressor<br/>model_rfr = make_pipeline(preprocessor, RandomForestRegressor(random_state=42))<br/>model_rfr = model_rfr.fit(X_train, y_train)<br/>y_pred_rfr = model_rfr.predict(X_test)<br/><br/>#Evaluating The Machine Learning Model<br/>from sklearn.metrics import mean_squared_error, mean_absolute_error<br/>import numpy as np<br/><br/>#Mean Squared Error<br/>mse = mean_squared_error(y_test, y_pred_rfr)<br/>print('\nMean squared error dari Testing Set:', round(mse))<br/><br/>#Mean Absolute Error<br/>mae = mean_absolute_error(y_test, y_pred_rfr)<br/>print('Mean absolute error dari Testing Set:', round(mae))<br/><br/>#Root Mean Squared Error<br/>rmse = np.sqrt(mse)<br/>print('Root Mean Squared Error dari Testing Set:', round(rmse))</span></pre><h2 id="7a19" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">套索</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="4da3" class="ml lj in nc b gy ng nh l ni nj">#Build a Machine Learning Model Lasso<br/>from sklearn.linear_model import Lasso<br/>model_lasso = make_pipeline(preprocessor, Lasso(random_state=42))<br/>model_lasso = model_lasso.fit(X_train, y_train)<br/>y_pred_lasso = model_lasso.predict(X_test)<br/><br/>#Evaluating The Machine Learning Model<br/>from sklearn.metrics import mean_squared_error, mean_absolute_error<br/>import numpy as np<br/><br/>#Mean Squared Error<br/>mse = mean_squared_error(y_test, y_pred_lasso)<br/>print('\nMean squared error dari Testing Set:', round(mse))<br/><br/>#Mean Absolute Error<br/>mae = mean_absolute_error(y_test, y_pred_lasso)<br/>print('Mean absolute error dari Testing Set:', round(mae))<br/><br/>#Root Mean Squared Error<br/>rmse = np.sqrt(mse)<br/>print('Root Mean Squared Error dari Testing Set:', round(rmse))</span></pre><h2 id="47a5" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">山脉</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="2d96" class="ml lj in nc b gy ng nh l ni nj">#Build a Machine Learning Model Ridge<br/>from sklearn.linear_model import Ridge<br/>model_ridge = make_pipeline(preprocessor, Ridge(random_state=42))<br/>model_ridge = model_ridge.fit(X_train, y_train)<br/>y_pred_ridge = model_ridge.predict(X_test)<br/><br/>#Evaluating The Machine Learning Model<br/>from sklearn.metrics import mean_squared_error, mean_absolute_error<br/>import numpy as np<br/><br/>#Mean Squared Error<br/>mse = mean_squared_error(y_test, y_pred_ridge)<br/>print('\nMean squared error dari Testing Set:', round(mse))<br/><br/>#Mean Absolute Error<br/>mae = mean_absolute_error(y_test, y_pred_ridge)<br/>print('Mean absolute error dari Testing Set:', round(mae))<br/><br/>#Root Mean Squared Error<br/>rmse = np.sqrt(mse)<br/>print('Root Mean Squared Error dari Testing Set:', round(rmse))</span></pre></div><div class="ab cl lb lc hr ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ig ih ii ij ik"><h1 id="2c62" class="li lj in bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">评估机器学习模型</h1><p id="4b40" class="pw-post-body-paragraph jv jw in jx b jy mg ka kb kc mh ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">建立机器学习模型后的下一个阶段是评估该模型。在这个评估过程中，我将查看<strong class="jx io">均方误差</strong>、<strong class="jx io">平均绝对误差</strong>和<strong class="jx io">均方根误差</strong>值。我将采用<strong class="jx io">最小的 RMSE 值</strong>来决定哪一个更好。</p><h2 id="e346" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">线性回归</h2><p id="da27" class="pw-post-body-paragraph jv jw in jx b jy mg ka kb kc mh ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">使用线性回归的结果是<strong class="jx io"> 13978053502 MSE，81551 MAE 和 118229 RMSE。</strong></p><h2 id="5144" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">决策树回归器</h2><p id="4a9d" class="pw-post-body-paragraph jv jw in jx b jy mg ka kb kc mh ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">使用决策树回归器的结果是<strong class="jx io"> 30269819377 MSE，117398 MAE，173982 RMSE。</strong></p><h2 id="7322" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">随机森林回归量</h2><p id="8f97" class="pw-post-body-paragraph jv jw in jx b jy mg ka kb kc mh ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">使用随机森林回归量的结果是<strong class="jx io"> 15404909596 MSE，84112 MAE 和 124117 RMSE。</strong></p><h2 id="1851" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">套索</h2><p id="cf79" class="pw-post-body-paragraph jv jw in jx b jy mg ka kb kc mh ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">使用套索的结果是<strong class="jx io"> 13967964699 MSE，81518 MAE 和 118186 RMSE。</strong></p><h2 id="fdb2" class="ml lj in bd lk mm mn dn lo mo mp dp ls kg mq mr lw kk ms mt ma ko mu mv me mw bi translated">山脉</h2><p id="7bf5" class="pw-post-body-paragraph jv jw in jx b jy mg ka kb kc mh ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">使用脊的结果是<strong class="jx io"> 13213872570 MSE，80624 MAE，114952 RMSE。</strong></p><p id="2dbf" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">从这个评价来看，使用岭的机器学习模型具有最小的 RMSE。</p></div><div class="ab cl lb lc hr ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ig ih ii ij ik"><h1 id="7b18" class="li lj in bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">可视化机器学习模型</h1><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="11d3" class="ml lj in nc b gy ng nh l ni nj">#Visualize The Machine Learning Model<br/>fig = plt.figure(figsize=(17, 10))<br/>df = df.sort_values(by=['Price'])<br/>X = df.drop('Price', axis=1)<br/>y = df['Price']<br/>plt.scatter(range(X.shape[0]), model_ridge.predict(X), marker='.', label='Predict')<br/>plt.scatter(range(X.shape[0]), y, color='red', label='Real')<br/>plt.legend(loc='best', prop={'size': 10})<br/>plt.show()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/16dfed05f4658cb90de263420caa8ff5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VBVvQJ6IiGaMJ97NE1_Lrw.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd lk">图 28。</strong>使用岭方法的机器学习模型的可视化</figcaption></figure></div><div class="ab cl lb lc hr ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ig ih ii ij ik"><h1 id="4447" class="li lj in bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">验证机器学习模型</h1><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="5950" class="ml lj in nc b gy ng nh l ni nj">#Validating The Machine Learning Model<br/>for i in range(5):<br/>    real = y_val.iloc[i]<br/>    pred = int(model_ridge.predict(X_val.iloc[i].to_frame().T)[0])<br/>    print(f'Real Value      -----&gt;&gt;&gt;&gt;&gt; {real} $\n'<br/>          f'Predicted Value -----&gt;&gt;&gt;&gt;&gt; {pred} $')<br/>    print()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi od"><img src="../Images/78df6096b890dbb075d0b10b4b4d9cb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:882/format:webp/1*dtdjZknugD4qXhZLoOHZEQ.png"/></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd lk">表 1。</strong>验证机器学习模型的结果</figcaption></figure></div><div class="ab cl lb lc hr ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ig ih ii ij ik"><figure class="mx my mz na gt jo"><div class="bz fp l di"><div class="oe of l"/></div></figure></div><div class="ab cl lb lc hr ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ig ih ii ij ik"><p id="6e66" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我说的就是这些。如果你对这个项目有任何批评、建议或问题，可以联系我。谢谢你，我真的很感谢你花时间来阅读这一点。</p></div></div>    
</body>
</html>