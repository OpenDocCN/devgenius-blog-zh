<html>
<head>
<title>Automatically audit your web application’s Performance, Accessibility, and Code Quality with Google Lighthouse</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Google Lighthouse自动审计您的web应用程序的性能、可访问性和代码质量</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/automatically-audit-your-web-applications-performance-accessibility-and-code-quality-with-d44a76d6741d?source=collection_archive---------1-----------------------#2020-03-30">https://blog.devgenius.io/automatically-audit-your-web-applications-performance-accessibility-and-code-quality-with-d44a76d6741d?source=collection_archive---------1-----------------------#2020-03-30</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/e008bcc245e9aca1ca7905a305ce41a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wmPc8AfUqbPeegcR"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">本杰明·达达在<a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="c210" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">近年来，许多组织受益于软件开发团队，他们使用JavaScript和其他流行的前端技术开发单页面应用程序，以创建令人愉快的微交互和可维护的、人类可读的代码模块。</p><p id="76d0" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这些应用程序中的许多还被编码为尽可能快地向用户显示有用的内容，使用<a class="ae jz" href="https://developers.google.com/web/fundamentals/primers/async-functions" rel="noopener ugc nofollow" target="_blank">异步功能</a>、<a class="ae jz" href="https://redux.js.org/recipes/server-rendering" rel="noopener ugc nofollow" target="_blank">服务器端渲染</a>、<a class="ae jz" href="https://developer.mozilla.org/en-US/docs/Glossary/minification" rel="noopener ugc nofollow" target="_blank">缩小</a>、<a class="ae jz" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Preloading_content" rel="noopener ugc nofollow" target="_blank">资源预加载/预取</a>和<a class="ae jz" href="https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/http-caching" rel="noopener ugc nofollow" target="_blank">缓存</a>，以及一系列其他性能优化技术。许多开发人员和产品所有者受益于审计工具，以跟踪他们在加快页面加载时间方面的进展，从而留住访问者并最大限度地提高转化率。</p><p id="7960" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">其中一个工具是谷歌的<a class="ae jz" href="https://developers.google.com/web/tools/lighthouse" rel="noopener ugc nofollow" target="_blank"> Lighthouse </a>，它提供了一个清晰全面的报告，对网页的关键性能指标进行评级，例如</p><p id="45fe" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><a class="ae jz" href="https://developers.google.com/web/tools/lighthouse/audits/first-meaningful-paint" rel="noopener ugc nofollow" target="_blank">第一次有意义的绘制</a> —这表示页面开始为用户加载有意义的内容需要多长时间，例如静态文本(例如页面标题或介绍性内容，不需要动态数据获取)。虽然像加载微调器这样的间隙状态非常有助于让用户确信他们的内容即将到来，但它们不能算作有意义的描绘。只有在需要有效利用页面(例如，在线商店产品描述)时，图像等资产才会包含在此指标中。非关键内容(包括大多数图像)的显示包含在<a class="ae jz" href="https://web.dev/fcp/" rel="noopener ugc nofollow" target="_blank">第一个内容丰富的绘画</a>指标中。</p><p id="0061" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><a class="ae jz" href="https://developers.google.com/web/tools/lighthouse/audits/time-to-interactive" rel="noopener ugc nofollow" target="_blank">交互时间</a> —这衡量页面完全响应用户输入所需的时间，例如按钮点击、搜索栏中的条目和折叠切换。该指标很可能会受到应用程序为提供该功能而必须消耗的资源数量以及这些资源的性能的影响。例如，显示静态数据(如联系信息)的accordion的交互速度可能比用户配置文件编辑表单快得多，后者要求在用户查看和更新数据之前从服务器获取数据。</p><p id="49d4" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">除了这些有用的性能得分，Lighthouse还提供了可访问性、搜索引擎优化和最佳实践的指标。由于SEO和无障碍设计最佳实践之间的<a class="ae jz" href="https://webaim.org/blog/web-accessibility-and-seo/" rel="noopener ugc nofollow" target="_blank">一致性</a>，许多开发人员可能会发现，随着可访问性的提高，搜索引擎优化得分会增加，从而为您的应用程序带来更广泛的受众。</p><p id="c48c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">运行临时Lighthouse审计既快速又简单:</p><p id="5bbf" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">1.安装并启动<a class="ae jz" href="https://www.google.com/chrome/" rel="noopener ugc nofollow" target="_blank">谷歌Chrome网络浏览器</a>。</p><p id="3b45" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">2.访问您希望审计的网页。</p><p id="58d6" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">3.打开<a class="ae jz" href="https://developers.google.com/web/tools/chrome-devtools/open" rel="noopener ugc nofollow" target="_blank"> Chrome开发者工具</a>。</p><p id="0197" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">4.切换“审计”选项卡并单击“生成报告”:</p><figure class="kz la lb lc gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ky"><img src="../Images/03c1721bb3900c2b2e0114855be9a999.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ueKlGk3qe79MUc9wN4JxGg.png"/></div></div></figure><p id="b3e7" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">然后，您的审计报告将显示在开发人员工具中:</p><figure class="kz la lb lc gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ld"><img src="../Images/925f7f2131e0881d0f7ae532fcb0f12c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OYGLLHXY3-UkmB-3PwNbKw.png"/></div></div></figure><p id="b385" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">快速、简单、信息丰富…但不是自动化的。能够在每次发布新的更改时运行审计，允许开发人员和产品所有者根据这些关键指标来监控应用程序的性能，并确定新优化的有效性。</p><p id="3968" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">灯塔团队提供了一个<a class="ae jz" href="https://github.com/GoogleChrome/lighthouse" rel="noopener ugc nofollow" target="_blank">命令行界面</a>，允许开发人员编写脚本来运行审计、转换和存储返回的数据。这些脚本可以手动运行，也可以集成到构建过程中。将数据保存为JSON或另一种常见格式，可以很容易地将这些有用的数据输入到您最喜欢的可视化工具中，如<a class="ae jz" href="https://www.splunk.com/" rel="noopener ugc nofollow" target="_blank"> splunk </a>、<a class="ae jz" href="https://powerbi.microsoft.com/en-us/" rel="noopener ugc nofollow" target="_blank"> PowerBI </a>或<a class="ae jz" href="https://www.elastic.co/kibana" rel="noopener ugc nofollow" target="_blank"> kibana </a>。</p><p id="4dc9" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">CLI 的<a class="ae jz" href="https://developers.google.com/web/tools/lighthouse#cli" rel="noopener ugc nofollow" target="_blank">文档非常全面，许多现成的例子已经在线发布。我也发布了一个利用Google Lighthouse CLI自动对你的网页进行审计的示例脚本。</a></p><p id="a149" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果您使用GitHub和Node.js，并且有兴趣在命令行上尝试我的脚本:</p><pre class="kz la lb lc gt le lf lg lh aw li bi"><span id="6b04" class="lj lk in lf b gy ll lm l ln lo">git clone <a class="ae jz" href="https://github.com/cloud-quinn/automated-lighthouse-audits.git" rel="noopener ugc nofollow" target="_blank">https://github.com/cloud-quinn/automated-lighthouse-audits.git</a></span><span id="ba75" class="lj lk in lf b gy lp lm l ln lo">cd automated-lighthouse-audits</span><span id="c1c7" class="lj lk in lf b gy lp lm l ln lo">npm i</span><span id="e2de" class="lj lk in lf b gy lp lm l ln lo">npm start &lt;urlToAudit&gt;</span></pre><p id="0b86" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><urltoaudit>应该是您希望审计的页面的网址，例如，要针对<a class="ae jz" href="http://bashcorp.co.uk/" rel="noopener ugc nofollow" target="_blank">http://bashcorp.co.uk</a>运行审计，命令应该是</urltoaudit></p><pre class="kz la lb lc gt le lf lg lh aw li bi"><span id="8f52" class="lj lk in lf b gy ll lm l ln lo">npm start <a class="ae jz" href="http://bashcorp.co.uk" rel="noopener ugc nofollow" target="_blank">http://bashcorp.co.uk</a></span></pre><p id="21e3" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">注意:</strong>该脚本要求Node.js版本10或以上。</p><p id="b520" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">该脚本的主要特点是:</p><p id="423e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">1.对命令行参数中指定的任何URL运行审核</p><p id="98dd" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">2.获取审计提供的关键得分，即性能、可访问性、最佳实践、SEO(搜索引擎优化)、PWA(渐进式网络应用)</p><p id="3a41" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">3.根据<code class="fe lq lr ls lf b">./metrics.js</code>中的定义，获取一组预定义指标的值。要保存一组不同的指标，只需修改从该文件返回的数组中的值。确保您定义的所有值都存在于有效指标的<a class="ae jz" href="https://docs.google.com/spreadsheets/d/1up5rxd4EMCoMaxH8cppcK1x76n6HLx0e7jxb0e0FXvc/edit#gid=0" rel="noopener ugc nofollow" target="_blank">列表中</a>。该脚本被编码为针对每个指标返回<code class="fe lq lr ls lf b">numericValue</code>——这是以毫秒为单位的时间量。例如，交互度量值2500意味着页面需要两秒半的时间才能完全响应用户输入。</p><p id="7d69" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">4.将这些转换后的分数和指标以JSON格式保存在本地文件(可以上传到任何地方)或AWS上的S3存储桶中。为了使用此选项，您需要更新。/saveOutput/s3.js文件，以便在您的AWS帐户上使用您的s3的真实详细信息和凭据。更多详情请参考优秀的<a class="ae jz" href="https://docs.aws.amazon.com/cli/latest/reference/s3api/put-object.html" rel="noopener ugc nofollow" target="_blank"> AWS文档</a>。</p><p id="c887" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我祝您在性能和可访问性审计中好运，无论您是使用Lighthouse还是其他工具，在浏览器中，还是在命令行中。有了这些数据，我们可以让我们的网页每天都变得更好。</p></div></div>    
</body>
</html>