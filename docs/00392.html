<html>
<head>
<title>Bash Scripting and Shell Programming Basics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Bash 脚本和 Shell 编程基础</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/bash-scripting-and-shell-programming-basics-9837afb3cfde?source=collection_archive---------11-----------------------#2020-06-05">https://blog.devgenius.io/bash-scripting-and-shell-programming-basics-9837afb3cfde?source=collection_archive---------11-----------------------#2020-06-05</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/c6e433fb0038eedf72d20a595827cf93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SHFHtg7oyiAORJ4FviS6KA.jpeg"/></div></div></figure><p id="ff30" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">你有没有浏览过 bash 脚本、shell 编程、bash 文件、shebang 之类的术语，或者听过有人谈论如何用 bash 编写代码，它甚至是一种编程语言吗？或者看到了奇怪的文件。sh 扩展，从来没有费心去研究他们？你知道这些很重要，但是如何使用它们呢？让我们试着深入了解它到底是什么，以及如何真正利用它！</p><h1 id="07ef" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">外壳脚本简介</h1><h2 id="aa16" class="lr ku in bd kv ls lt dn kz lu lv dp ld kg lw lx lh kk ly lz ll ko ma mb lp mc bi translated">什么是剧本？</h2><p id="9d44" class="pw-post-body-paragraph jv jw in jx b jy md ka kb kc me ke kf kg mf ki kj kk mg km kn ko mh kq kr ks ig bi translated">脚本是包含一系列命令的命令行程序，这些命令由解释器一个接一个地执行，对于 shell 脚本，shell 充当解释器。</p><p id="eb98" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">您在终端(命令行)中运行的任何东西都可以放在 shell 脚本中，shell 脚本在自动化任务方面非常出色。如果您发现自己正在运行一系列命令来实现某些目标，那么将它们放在 shell 脚本中并每次都运行该脚本而不是所有这些命令是一个好主意。</p><p id="01b7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们来看一个非常基本的 shell 脚本示例:</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="43ac" class="lr ku in mn b gy mr ms l mt mu">#!/bin/bash<br/>echo “Hello World!”</span></pre><p id="2a9e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">以及如何运行这个脚本？</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="1950" class="lr ku in mn b gy mr ms l mt mu">$ chmod 755 script.sh<br/>$ ./script.sh<br/>Hello World!</span></pre><h1 id="3290" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">记住，每个 shell 脚本都以 shebang 开头。</h1><h2 id="ba18" class="lr ku in bd kv ls lt dn kz lu lv dp ld kg lw lx lh kk ly lz ll ko ma mb lp mc bi translated">“舍邦”是什么鬼东西？</h2><p id="116e" class="pw-post-body-paragraph jv jw in jx b jy md ka kb kc me ke kf kg mf ki kj kk mg km kn ko mh kq kr ks ig bi translated">在上面的脚本示例中，第一行类似于<strong class="jx io"> <em class="mv"> #！/bin/bash </em> </strong>，口头上你会说是<strong class="jx io"><em class="mv">sharp-bang-forward slash-bin-forward slash</em></strong>(有人参考！砰的一声。)于是，“<strong class="jx io"> #！</strong>可以说是<strong class="jx io">锐棒</strong>，已经慢慢变成了<strong class="jx io">射棒</strong>。对，就是这样。</p><p id="fe83" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="mv">注意:对于除 shebang 以外的每一行，如果它以井号(#)开头，则被视为注释。</em></p><p id="4e2f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">当脚本的第一行以 shebang 开头时，shebang 后面的代码将被用作脚本中列出的命令的解释器。上例中的“/bin/bash”。其他例子可以是:“bin/csh”、“bin/ksh/”、“bin/zsh”。</p><p id="2837" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">你听说过 python 是一种脚本语言吗？是的，你也可以用 python 作为解释器来运行脚本。看看下面的例子:</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="b0f5" class="lr ku in mn b gy mr ms l mt mu">#!/bin/python<br/>print "Hello World, Using a python script."</span></pre><p id="64d4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">并运行它:</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="990d" class="lr ku in mn b gy mr ms l mt mu">$ chmod 755 hello.py<br/>$ ./hello.py<br/>Hello World, Using a python script.</span></pre><h1 id="85ad" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">让我们掌握它的窍门</h1><p id="06f3" class="pw-post-body-paragraph jv jw in jx b jy md ka kb kc me ke kf kg mf ki kj kk mg km kn ko mh kq kr ks ig bi translated">让我们做点什么，而不仅仅是印刷 Hello World！并在这里应用一些基本的编程概念，如将值存储到变量中等等。</p><h2 id="d53b" class="lr ku in bd kv ls lt dn kz lu lv dp ld kg lw lx lh kk ly lz ll ko ma mb lp mc bi translated">为变量设置值并使用这些值</h2><p id="eafb" class="pw-post-body-paragraph jv jw in jx b jy md ka kb kc me ke kf kg mf ki kj kk mg km kn ko mh kq kr ks ig bi translated">定义变量的规则:</p><ul class=""><li id="f903" class="mw mx in jx b jy jz kc kd kg my kk mz ko na ks nb nc nd ne bi translated">shell 脚本中的变量区分大小写。</li><li id="8fc1" class="mw mx in jx b jy nf kc ng kg nh kk ni ko nj ks nb nc nd ne bi translated">按照惯例，变量是大写的。</li><li id="4965" class="mw mx in jx b jy nf kc ng kg nh kk ni ko nj ks nb nc nd ne bi translated">请记住，不要在=符号前后留任何空格。</li><li id="681d" class="mw mx in jx b jy nf kc ng kg nh kk ni ko nj ks nb nc nd ne bi translated">变量名可以包含数字、字母和下划线。</li><li id="ca24" class="mw mx in jx b jy nf kc ng kg nh kk ni ko nj ks nb nc nd ne bi translated">一个很好的例子是:VARIABLE_NAME="some value "</li></ul><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="24dc" class="lr ku in mn b gy mr ms l mt mu">#!/bin/bash<br/>FAV_FRUIT="Apple"<br/>echo "My garden is full of $FAV_FRUIT trees."</span></pre><p id="f550" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">您也可以将变量值作为$ { FAV _ 水果}来传递，而不是$ FAV _ 水果。如果您想要连接两个字符串，您可能想要使用花括号语法，例如，如果您想要打印“I Love Apple <strong class="jx io"> s </strong>”，那么您不能传递结尾带有“s”的值。您可以按如下方式传递该值:</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="7323" class="lr ku in mn b gy mr ms l mt mu">echo "I Love ${FAV_FRUIT}s" </span></pre><h2 id="02cd" class="lr ku in bd kv ls lt dn kz lu lv dp ld kg lw lx lh kk ly lz ll ko ma mb lp mc bi translated">算术运算符</h2><p id="bfd0" class="pw-post-body-paragraph jv jw in jx b jy md ka kb kc me ke kf kg mf ki kj kk mg km kn ko mh kq kr ks ig bi translated">比较两个数字之类的算术运算不是使用普通的运算符来完成的，比如等号、大于号或小于号，它在 shell 脚本中有一个特殊的语法。请看下面:</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="2ec1" class="lr ku in mn b gy mr ms l mt mu">arg1 -eq arg2 True if arg1 is equal to arg2.<br/>arg1 -ne arg2 True if arg1 is not equal to arg2.</span><span id="6143" class="lr ku in mn b gy nk ms l mt mu">arg1 -lt arg2 True if arg1 is less than arg2.<br/>arg1 -le arg2 True if arg1 is less than or equal to arg2.</span><span id="5004" class="lr ku in mn b gy nk ms l mt mu">arg1 -gt arg2 True if arg1 is greater than arg2.<br/>arg1 -ge arg2 True if arg1 is greater than or equal to arg2.</span></pre><h2 id="915f" class="lr ku in bd kv ls lt dn kz lu lv dp ld kg lw lx lh kk ly lz ll ko ma mb lp mc bi translated">做决策——if 语句</h2><p id="5f1c" class="pw-post-body-paragraph jv jw in jx b jy md ka kb kc me ke kf kg mf ki kj kk mg km kn ko mh kq kr ks ig bi translated">现在，您对如何检查条件有了基本的了解，如果满足某个条件，您可以将结果与 if 语句结合起来运行一个命令(或一组命令)。</p><p id="77c8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">if 语句的语法如下:</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="c04d" class="lr ku in mn b gy mr ms l mt mu">if [condition-is-met]<br/>then<br/>  command 1<br/>  command 2<br/>  command N<br/>fi</span></pre><p id="ae7b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">if 语句以单词“if”开头，后跟一个测试，下面一行包含单词“then”。接下来是一个命令，或者一系列的命令，如果满足条件，这些命令将被执行。最后，if 条件以单词“fi”结束，它只是“if”的倒拼。</p><p id="bf6f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">您也可以将 else if 和 else 命令放在 if 命令之后，如下所示:</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="c179" class="lr ku in mn b gy mr ms l mt mu">if [condition-is-met]<br/>then<br/>  command 1<br/>  command 2<br/>  command N<br/>elif [condition-is-met]<br/>then<br/>  command X<br/>else<br/>  command Y<br/>fi</span></pre><h2 id="a3b0" class="lr ku in bd kv ls lt dn kz lu lv dp ld kg lw lx lh kk ly lz ll ko ma mb lp mc bi translated">For 循环</h2><p id="b9be" class="pw-post-body-paragraph jv jw in jx b jy md ka kb kc me ke kf kg mf ki kj kk mg km kn ko mh kq kr ks ig bi translated">您可以使用 for 循环对项目列表执行操作，shell 脚本中 for 循环的语法如下所示:</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="d47e" class="lr ku in mn b gy mr ms l mt mu">for VARIABLE_NAME in ITEM_1 ITEM_N<br/>do<br/>  command 1<br/>  command 2<br/>  command N<br/>done</span></pre><p id="6d2c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">for 循环的第一行以单词“for”开头，后跟一个变量名，然后是一个项目列表。下一行包含单词“do ”,然后您应该放置您想要执行的语句，最后在下一行用单词“done”结束 for 循环。</p><p id="79cc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在这种情况下，第一项被赋给变量，这组命令在该变量上执行，然后列表中的下一项被赋给该变量，这些命令再次在该变量上执行。这种情况会一直发生，直到循环到达列表中的最后一个元素。</p><h2 id="15e0" class="lr ku in bd kv ls lt dn kz lu lv dp ld kg lw lx lh kk ly lz ll ko ma mb lp mc bi translated">接受用户输入(标准输入)</h2><p id="c849" class="pw-post-body-paragraph jv jw in jx b jy md ka kb kc me ke kf kg mf ki kj kk mg km kn ko mh kq kr ks ig bi translated">如果要接受 STDIN，使用<strong class="jx io"> <em class="mv">读取</em> </strong>命令。请记住，STDIN 通常来自键盘输入，但也可能来自其他来源，如另一个命令或一组命令的输出。<strong class="jx io"> <em class="mv">读作</em> </strong>的语法如下:</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="3dc4" class="lr ku in mn b gy mr ms l mt mu"> read -p "PROMPT" VARIABLE</span></pre><p id="8556" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这里的 PROMPT 基本上就是你要向用户显示的内容。下面的例子:</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="be4d" class="lr ku in mn b gy mr ms l mt mu">read -p "Enter your name: " NAME<br/>echo "You are registered, $NAME"</span></pre><h2 id="6f61" class="lr ku in bd kv ls lt dn kz lu lv dp ld kg lw lx lh kk ly lz ll ko ma mb lp mc bi translated">位置参数</h2><p id="fb7a" class="pw-post-body-paragraph jv jw in jx b jy md ka kb kc me ke kf kg mf ki kj kk mg km kn ko mh kq kr ks ig bi translated">位置参数是包含命令行内容的变量，变量有$0，$1，$2，$3……..$9.这个脚本本身存储在$0 中，第一个参数存储在$1 中，第二个存储在$2 中，依此类推。</p><p id="0912" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">看看这个例子:</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="899e" class="lr ku in mn b gy mr ms l mt mu">$ script.sh parameter1 parameter2 parameter3</span></pre><p id="fff4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这里，变量及其值如下:</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="68f2" class="lr ku in mn b gy mr ms l mt mu"><strong class="mn io">$0 : "script.sh"<br/>$1 : "parameter1"<br/>$2 : "parameter2"<br/>$3 : "parameter3"</strong></span></pre><p id="ee79" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">要访问命令行上的所有项目，请使用特殊变量<strong class="jx io"> $@。</strong></p><h2 id="3f15" class="lr ku in bd kv ls lt dn kz lu lv dp ld kg lw lx lh kk ly lz ll ko ma mb lp mc bi translated">功能</h2><p id="394a" class="pw-post-body-paragraph jv jw in jx b jy md ka kb kc me ke kf kg mf ki kj kk mg km kn ko mh kq kr ks ig bi translated">每当您需要在脚本中多次执行相同的操作时，这是一个好迹象，表明您应该使用函数来代替。简单地说，函数是一个可重用的代码块，它执行一个动作并返回一个退出状态或返回代码。</p><p id="7280" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">有两种方法定义一个函数是一个 shell 脚本:</p><p id="b42a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">第一种方式:</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="63f6" class="lr ku in mn b gy mr ms l mt mu">function function-name() {<br/>  #code goes here<br/>}</span></pre><p id="e5ef" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">第二种方式:</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="0d26" class="lr ku in mn b gy mr ms l mt mu">funtion-name() {<br/>  #code goes here<br/>}</span></pre><p id="91ab" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">要调用或执行函数，只需在脚本中的任何一行列出它的名字。一旦定义好，它就可以充当您可以在 shell 脚本中使用的任何其他命令。</p><p id="a67a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="mv">注意:调用函数时，不要使用括号。</em></p><p id="62dc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">定义和调用函数的示例:</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="0413" class="lr ku in mn b gy mr ms l mt mu">#!/bin/bash<br/>function hello() {<br/>  echo "Hello!"<br/>}</span><span id="88d5" class="lr ku in mn b gy nk ms l mt mu">hello</span></pre><p id="bbdc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">当您运行上面的脚本时，屏幕上会显示单词 hello。</p></div><div class="ab cl nl nm hr nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ig ih ii ij ik"><p id="3229" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">本文涵盖的主题是您编写自己的 bash 脚本所需的全部内容，并且肯定会引导您编写更复杂的脚本和自动化您的任务。</p><p id="6d91" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我希望这是有用的，请点击鼓掌按钮👏🏽如果你觉得有用/有见地。随意写评论。</p><p id="2483" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">编码快乐！</p></div></div>    
</body>
</html>