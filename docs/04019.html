<html>
<head>
<title>WordPress site under 12€ year with docker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">12岁以下的€网站</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/wordpress-site-under-12-year-with-docker-2628fcb51e79?source=collection_archive---------3-----------------------#2021-01-16">https://blog.devgenius.io/wordpress-site-under-12-year-with-docker-2628fcb51e79?source=collection_archive---------3-----------------------#2021-01-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d1cb604cf2c2246bac6efb74e74c8770.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3VlpR_gFUiizoNnF"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">马库斯·温克勒在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="03f0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要用WordPress创建一个站点，你通常需要依赖一个服务，它会给你一个完整的domino包。这种解决方案通常每年花费超过50€。最常见的是从第二年开始价格上涨。</p><p id="3b99" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇文章中，我将向你展示如何使用免费的虚拟机来托管你的WordPress站点，只需支付域名(12€)，这样你就节省了一大笔钱。</p><p id="3f1b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，如果你没有域名，你需要购买一个域名。我用https://domains.google.com的<a class="ae kc" href="https://domains.google.com" rel="noopener ugc nofollow" target="_blank">购买域名。</a></p><p id="91d2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">买了域名之后，你需要在google cloud或者oracle cloud或者别的什么上面创建一个虚拟机。我推荐这两种服务中的一种，因为基本虚拟机是免费的。</p><p id="4cb3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用google cloud，标准的免费虚拟机只有600 MB内存、一个共享内核和30GB内存。另一方面，如果您使用Oracle Cloud，则有1 GB的内存、两个内核和50 GB内存。</p><p id="0ec1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">关于Oracle云的所有信息都在此处<a class="ae kc" href="https://www.oracle.com/cloud/free/?&amp;source=:ow:o:p:nav:0916BCButton&amp;intcmp=:ow:o:p:nav:0916BCButton" rel="noopener ugc nofollow" target="_blank"/>，您可以注册并创建一个虚拟机(免费层)。</p><p id="6d9b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你想使用谷歌云，你可以看看这个<a class="ae kc" href="https://medium.com/@hbmy289/how-to-set-up-a-free-micro-vps-on-google-cloud-platform-bddee893ac09" rel="noopener">指南</a>。</p><p id="4505" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就我个人而言，我使用Ubuntu作为虚拟机的操作系统。</p><p id="1898" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果使用oracle cloud，则必须打开端口443和80(<a class="ae kc" href="https://oracle-base.com/articles/vm/oracle-cloud-infrastructure-oci-amend-firewall-rules" rel="noopener ugc nofollow" target="_blank">https://Oracle-base . com/articles/VM/Oracle-cloud-infra structure-OCI-amend-firewall-rules</a>)。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h2 id="f384" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">现在经过初步设置后，我们在Docker上设置了WordPress，带有phpMyAdmin、SSL(通过Traefik)和自动更新。</h2><ul class=""><li id="03f1" class="mb mc iq kf b kg md kk me ko mf ks mg kw mh la mi mj mk ml bi translated">Docker，一种强大的标准化应用部署方式</li><li id="5425" class="mb mc iq kf b kg mm kk mn ko mo ks mp kw mq la mi mj mk ml bi translated">来自Let's Encrypt的免费SSL证书(通过Traefik)</li><li id="f932" class="mb mc iq kf b kg mm kk mn ko mo ks mp kw mq la mi mj mk ml bi translated">phpMyAdmin轻松管理您的数据库</li><li id="260c" class="mb mc iq kf b kg mm kk mn ko mo ks mp kw mq la mi mj mk ml bi translated">自动容器更新(通过瞭望塔)</li></ul><p id="9520" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在ssh中连接到虚拟机并更新虚拟机后:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="7303" class="li lj iq mw b gy na nb l nc nd">sudo apt update<br/>sudo apt upgrade<br/>sudo reboot</span></pre><p id="9a87" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在您更新虚拟机之后，我建议使用以下命令添加一个交换文件(因为我们没有太多的RAM，这样在我们用完RAM的情况下会使用部分硬盘):</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="e51d" class="li lj iq mw b gy na nb l nc nd">sudo fallocate -l 4G /swapfile<br/>sudo chmod 600 /swapfile<br/>sudo mkswap /swapfile<br/>sudo swapon /swapfile</span></pre><p id="a801" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们使交换文件持久化，所以您必须在这个文件中添加这个字符串"<strong class="kf ir"> /swapfile none swap sw 0 0 </strong>":</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="e8e3" class="li lj iq mw b gy na nb l nc nd">sudo nano /etc/fstab</span></pre><p id="1b74" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">重新启动虚拟机以保持持久性:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="c2dc" class="li lj iq mw b gy na nb l nc nd">sudo reboot</span></pre><p id="824b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">安装Docker:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="f8fd" class="li lj iq mw b gy na nb l nc nd">curl <a class="ae kc" href="https://get.docker.com/" rel="noopener ugc nofollow" target="_blank">https://get.docker.com</a> &gt; install-docker.sh<br/>chmod +x install-docker.sh<br/>./install-docker.sh</span></pre><p id="412c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你必须有代理权限，因为如果你不这样做，你必须运行Docker与sudo:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="b667" class="li lj iq mw b gy na nb l nc nd">sudo usermod -aG docker your_user</span></pre><p id="299e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">安装Docker compose，你可以使用这个指南为Linux(<a class="ae kc" href="https://docs.docker.com/compose/install/" rel="noopener ugc nofollow" target="_blank">https://docs.docker.com/compose/install/</a>)</p><p id="562b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果用ARM基的机器(【https://github.com/docker/compose/issues/6831】T2</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="0e48" class="li lj iq mw b gy na nb l nc nd"># for ARM Machine<br/>git clone https://github.com/BytemarkHosting/docker-smtp.git<br/><br/>cd docker-smtp/stretch<br/>docker build -t bytemark/smtp .</span></pre><p id="5911" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们可以为你的站点配置WordPress和其他容器了。</p><p id="38ee" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，您必须克隆这个存储库:</p><div class="ne nf gp gr ng nh"><a href="https://github.com/pietrocolombo/wordpress-docker" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd ir gy z fp nm fr fs nn fu fw ip bi translated">pietrocolombo/wordpress-docker</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">Docker，一个强大的标准化方法来部署应用程序免费的SSL证书从让我们加密(通过Traefik)…</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">github.com</p></div></div><div class="nq l"><div class="nr l ns nt nu nq nv jw nh"/></div></div></a></div><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="560a" class="li lj iq mw b gy na nb l nc nd">git clone <a class="ae kc" href="https://github.com/pietrocolombo/wordpress-docker.git" rel="noopener ugc nofollow" target="_blank">https://github.com/pietrocolombo/wordpress-docker.git</a></span><span id="77df" class="li lj iq mw b gy nw nb l nc nd">cd wordpress-docker</span></pre><p id="d2e2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Traefik需要一个文件来存储SSL密钥和证书，因此运行以下命令:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="063b" class="li lj iq mw b gy na nb l nc nd">touch acme.json<br/>chmod 0600 acme.json</span></pre><p id="7f14" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在你必须编辑。env文件并添加所有信息(BASIC_AUTH，ACME_EMAIL，TRAEFIK_DOMAINS，WORDPRESS_DOMAINS，WORDPRESS_DB_ROOT_PASSWORD，WORDPRESS_DB_PASSWORD)。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="46f3" class="li lj iq mw b gy na nb l nc nd">nano .env</span></pre><p id="4e14" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，您需要为您的域提供虚拟机的IP地址:</p><figure class="mr ms mt mu gt jr"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="2e7b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要运行您的新站点，您可以运行以下命令:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="5679" class="li lj iq mw b gy na nb l nc nd">docker-compose up -d</span></pre><p id="9b39" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在如果你去<a class="ae kc" href="https://Your-Domain" rel="noopener ugc nofollow" target="_blank"> https://Your-Domain </a>你可以配置WordPress:</p><figure class="mr ms mt mu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nz"><img src="../Images/835ec135a39de2e0e1a9737a80a3ac65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WYS34F_DeVZAp8lJveW6wg.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><em class="oa">作者图片</em></figcaption></figure><p id="28a9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您需要停止集装箱:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="ceea" class="li lj iq mw b gy na nb l nc nd">docker-compose down</span></pre><p id="47ba" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要解决插件安装需要ftp访问的问题，请执行以下操作:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="5a82" class="li lj iq mw b gy na nb l nc nd">sudo chown -R www-data  /var/lib/docker/volumes/<a class="ae kc" href="https://github.com/pietrocolombo/wordpress-docker" rel="noopener ugc nofollow" target="_blank">wordpress-docker</a>_vol-wp-content/</span></pre><p id="c192" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样，你唯一的成本就是域名的成本。而且，比起许多导游来，HTTPS身边允许<strong class="kf ir">的</strong>协议。</p><p id="d041" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我希望我的文章对你有用，如果你有任何问题，请写在评论里。</p><p id="10e1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢阅读！</p><p id="b7d9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了获得无限的故事，你也可以考虑只花5美元注册成为媒体会员。如果你用我的 <a class="ae kc" href="https://pietrocolombo.medium.com/membership" rel="noopener"> <em class="ob">链接</em> </a> <em class="ob">注册，我会收到一小笔佣金。</em></p></div></div>    
</body>
</html>