<html>
<head>
<title>Adding Graphics to a React App with D3 — CSVs and TSVs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 D3 向 React 应用添加图形—CSV 和 tsv</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/adding-graphics-to-a-react-app-with-d3-csvs-and-tsvs-16094a9d157f?source=collection_archive---------7-----------------------#2021-02-08">https://blog.devgenius.io/adding-graphics-to-a-react-app-with-d3-csvs-and-tsvs-16094a9d157f?source=collection_archive---------7-----------------------#2021-02-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/018f9040796065402223fcd8c80d06ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Zn-GNdSxbtINug7C"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Rami Al-zayat 在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="490d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">D3 让我们可以轻松地向前端 web 应用添加图形。</p><p id="461d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vue 是一个流行的前端 web 框架。</p><p id="55a5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">他们合作得很好。在本文中，我们将了解如何使用 D3 为 Vue 应用添加图形。</p><h1 id="a298" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">csvParseRows</h1><p id="b6c8" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用<code class="fe me mf mg mh b">csvParseRows</code>方法将 CSV 字符串解析成一个对象数组。</p><p id="6ab6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="5152" class="mq lc iq mh b gy mr ms l mt mu">import React, { useEffect } from "react";<br/>import * as d3 from "d3";</span><span id="0af0" class="mq lc iq mh b gy mv ms l mt mu">const string = `2011,10\n2012,20\n2013,30\n`;</span><span id="5f95" class="mq lc iq mh b gy mv ms l mt mu">export default function App() {<br/>  useEffect(() =&gt; {<br/>    const data = d3.csvParseRows(string, function ([year, population]) {<br/>      return {<br/>        year: new Date(+year, 0, 1),<br/>        population<br/>      };<br/>    });<br/>    console.log(data);<br/>  }, []);</span><span id="fa66" class="mq lc iq mh b gy mv ms l mt mu">  return &lt;div className="App"&gt;&lt;/div&gt;;<br/>}</span></pre><p id="c4c5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用 CSV 字符串作为第一个参数调用<code class="fe me mf mg mh b">csvParseRows</code>。</p><p id="4e78" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">回调函数有经过解析的条目，我们可以从中返回我们想要的东西。</p><h1 id="f0c8" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">CSV 格式</h1><p id="c1b5" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated"><code class="fe me mf mg mh b">csvFormat</code>方法格式化 CSV 的行和列。</p><p id="d83e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="2c95" class="mq lc iq mh b gy mr ms l mt mu">import React, { useEffect } from "react";<br/>import * as d3 from "d3";</span><span id="c7f0" class="mq lc iq mh b gy mv ms l mt mu">const data = [<br/>  { year: 2011, population: 10 },<br/>  { year: 2012, population: 20 },<br/>  { year: 2013, population: 30 }<br/>];<br/>export default function App() {<br/>  useEffect(() =&gt; {<br/>    const string = d3.csvFormat(data, ["year", "population"]);<br/>    console.log(string);<br/>  }, []);</span><span id="e2eb" class="mq lc iq mh b gy mv ms l mt mu">  return &lt;div className="App"&gt;&lt;/div&gt;;<br/>}</span></pre><p id="3607" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们传入一个对象数组作为第一个参数。</p><p id="cc1f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们传入一个包含列名的字符串数组。</p><p id="2073" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们得到<code class="fe me mf mg mh b">string</code>的值，也就是 CSV 字符串。它的值是:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="642d" class="mq lc iq mh b gy mr ms l mt mu">year,population<br/>2011,10<br/>2012,20<br/>2013,30</span></pre><h1 id="58d3" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">tsvParse</h1><p id="f135" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated"><code class="fe me mf mg mh b">tsvParse</code>方法让我们解析制表符分隔的字符串。</p><p id="b0d9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="2404" class="mq lc iq mh b gy mr ms l mt mu">import React, { useEffect } from "react";<br/>import * as d3 from "d3";</span><span id="e553" class="mq lc iq mh b gy mv ms l mt mu">const string = `year\tpopulation\n2011\t10\n2012\t20\n2013\t30\n`;</span><span id="2984" class="mq lc iq mh b gy mv ms l mt mu">export default function App() {<br/>  useEffect(() =&gt; {<br/>    const data = d3.tsvParse(string, function ({ year, population }) {<br/>      return {<br/>        year: new Date(+year, 0, 1),<br/>        population<br/>      };<br/>    });<br/>    console.log(data);<br/>  }, []);</span><span id="6d44" class="mq lc iq mh b gy mv ms l mt mu">  return &lt;div className="App"&gt;&lt;/div&gt;;<br/>}</span></pre><p id="9dbc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有一个制表符分隔的字符串，并用它调用<code class="fe me mf mg mh b">tsvParse</code>。</p><p id="00a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在回调时，我们从参数中解析的条目中析构<code class="fe me mf mg mh b">year</code>和<code class="fe me mf mg mh b">population</code>属性。</p><p id="3eda" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们返回对象来返回我们想要的。</p><h1 id="3796" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">tsvParseRows</h1><p id="b992" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated"><code class="fe me mf mg mh b">tsvParseRows</code>方法让我们解析不带标题的制表符分隔的字符串行。</p><p id="5b7e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="3d61" class="mq lc iq mh b gy mr ms l mt mu">import React, { useEffect } from "react";<br/>import * as d3 from "d3";</span><span id="9e80" class="mq lc iq mh b gy mv ms l mt mu">const string = `2011\t10\n2012\t20\n2013\t30\n`;</span><span id="4c46" class="mq lc iq mh b gy mv ms l mt mu">export default function App() {<br/>  useEffect(() =&gt; {<br/>    const data = d3.tsvParseRows(string, function ([year, population]) {<br/>      return {<br/>        year: new Date(+year, 0, 1),<br/>        population<br/>      };<br/>    });<br/>    console.log(data);<br/>  }, []);</span><span id="f78e" class="mq lc iq mh b gy mv ms l mt mu">return &lt;div className="App"&gt;&lt;/div&gt;;<br/>}</span></pre><p id="10cb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们传入一个不带标题的字符串。</p><p id="65a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们用字符串和回调函数调用<code class="fe me mf mg mh b">tsvParseRows</code>，回调函数具有被解析行的属性。</p><p id="9658" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们为每个条目返回我们想要返回的对象。</p><h1 id="44fe" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="0768" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用 D3 解析和创建 CSV 和 tsv，并在 React 应用程序中使用它们。</p></div></div>    
</body>
</html>