<html>
<head>
<title>Best Practice: Data Loading State</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">最佳实践:数据加载状态</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/best-practice-data-loading-state-b9328e2718ac?source=collection_archive---------6-----------------------#2022-07-19">https://blog.devgenius.io/best-practice-data-loading-state-b9328e2718ac?source=collection_archive---------6-----------------------#2022-07-19</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="867d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你有没有想过在 Android 应用程序中分享数据状态的最佳实践是什么？是加载，成功，失败，还是以上都不是？<br/>本文将讨论发布数据加载状态的不同方法，最后我将展示我认为的最佳架构实践。<br/>我还建议熟悉由<a class="kj kk ep" href="https://medium.com/u/3b5622dd813c?source=post_page-----b9328e2718ac--------------------------------" rel="noopener" target="_blank"> Manuel Vivo </a>和他的团队编写的<a class="ae ki" href="https://developer.android.com/topic/architecture" rel="noopener ugc nofollow" target="_blank">应用架构指南</a>，在我看来，他们对编写该指南产生了巨大的影响。介绍完毕，让我们开始吧:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/d895f8a2be79ed4a618150f48b5583aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HCgs0b_zZhhUAIkO"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">照片由<a class="ae ki" href="https://unsplash.com/@leekos?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Kostiantyn Li </a>在<a class="ae ki" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h2 id="fb07" class="lb lc in bd ld le lf dn lg lh li dp lj jv lk ll lm jz ln lo lp kd lq lr ls lt bi translated">关于混凝土数据和荷载状态建模的思考</h2><ul class=""><li id="0260" class="lu lv in jm b jn lw jr lx jv ly jz lz kd ma kh mb mc md me bi translated">我们需要哪些状态？他们的目的是什么？</li><li id="e1d8" class="lu lv in jm b jn mf jr mg jv mh jz mi kd mj kh mb mc md me bi translated">首选的建模方法是什么:包装器，组合的还是分离的？</li><li id="e883" class="lu lv in jm b jn mf jr mg jv mh jz mi kd mj kh mb mc md me bi translated">加载状态应该与数据本身紧密耦合还是松散耦合？</li></ul><p id="de29" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将逐步回答每个问题。首先要明白的是我们的需求。下一个表填充了符合典型应用的一些基本状态:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mk ml l"/></div></figure><h2 id="6e1f" class="lb lc in bd ld le lf dn lg lh li dp lj jv lk ll lm jz ln lo lp kd lq lr ls lt bi translated">为这些场景建模的常见方法:</h2><p id="c1ce" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv mm jx jy jz mn kb kc kd mo kf kg kh ig bi translated">我相信我们大多数人都熟悉以下部分或全部模型:</p><ol class=""><li id="1863" class="lu lv in jm b jn jo jr js jv mp jz mq kd mr kh ms mc md me bi translated">松散耦合来自加载状态的具体数据，例如我们可以在我们的视图模型/存储库中声明以下成员:</li></ol><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mk ml l"/></div></figure><p id="4417" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="mt">注:用</em> <code class="fe mu mv mw mx b"><em class="mt">LiveData&lt;&gt; / Flow&lt;&gt;</em></code> <em class="mt">作为最适合自己的。<br/> </em>这是我最不喜欢的方法，因为它容易出错:<br/><code class="fe mu mv mw mx b">MyError</code>和<code class="fe mu mv mw mx b">MyConcreteData</code>有可能同时存在吗？<code class="fe mu mv mw mx b">MyError</code>能包含数据和<code class="fe mu mv mw mx b">isLoading=true</code>吗？<br/>这种架构建模方法似乎支持不期望的情况，并且由于在需要时忘记清除其中一个而可能错误地发生。我试图想出这种方法的一些积极的好处，但什么也想不出来，请告诉我一些想法。</p><p id="ca1a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">2.紧密耦合的信息:数据、误差和载荷；</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mk ml l"/></div></figure><p id="bac5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这种建模方法帮助我们确保在创建<code class="fe mu mv mw mx b">DataWithState</code>对象时，我们必须考虑🖼️.的全貌这有助于我们减少错误，这很好。关于它的一个大胆的事情是，开发者可以非常灵活地构造<code class="fe mu mv mw mx b">DataWithState</code>，这是优点还是缺点？你会决定的。就我个人而言，我更希望避免促成一个毫无意义的国家的建立。</p><p id="0d5b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">3.这就引出了我们的下一个方法，包装器状态:<br/>接下来的代码将描述<code class="fe mu mv mw mx b">LoadState&lt;T&gt;</code>类，而<code class="fe mu mv mw mx b">T</code>是我们具体数据模型的类型。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mk ml l"/></div></figure><p id="1a19" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">看起来，第二种方法的大部分好处都在这里，不仅如此，它<strong class="jm io">通过使用包装器方法防止了任何不合理模型的构建</strong>。例如，我们不能将加载状态与错误一起发布。这一次，在我看来，紧密耦合更符合我们的需求。我知道<code class="fe mu mv mw mx b">Failure</code>模式使我们能够创建一个<code class="fe mu mv mw mx b">ApiError</code>模式和<code class="fe mu mv mw mx b">Exception</code>模式，所以我们建议也要阻止它。挑战自己这样做😉。</p><p id="1713" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">看起来不错，让我们用一个使用示例来增加它的趣味:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mk ml l"/></div></figure><p id="3b40" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我希望上面的例子能让你更好地理解。<br/>我们已经完成了本文的第一部分，了解了建模过程背后的思想。我还想和你分享一份奖金🎁，我们可以理解为<code class="fe mu mv mw mx b">updateMyData()</code>的实现会对很多类似的加载操作重复自己。有没有可能抽象出<code class="fe mu mv mw mx b">updateMyData()</code>的实现？<br/>答案是肯定的，我已经用手指为你输入了下一篇文章，它将解释如何做到这一点。<a class="ae ki" href="https://medium.com/subscribe/@itay.c14" rel="noopener"> <strong class="jm io">订阅</strong> </a>接收通知。</p></div><div class="ab cl my mz hr na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="ig ih ii ij ik"><p id="c20b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你觉得我的文章有任何帮助，请<strong class="jm io">分享</strong>它，并为它<strong class="jm io">鼓掌</strong>。但是如果你认为我可能会用更有价值的内容给你惊喜，你可以<a class="ae ki" href="https://medium.com/subscribe/@itay.c14" rel="noopener"> <strong class="jm io">订阅</strong> </a>和<strong class="jm io">关注</strong>我来获得新内容的通知。</p><blockquote class="nf"><p id="81f1" class="ng nh in bd ni nj nk nl nm nn no kh dk translated">有一个伟大的一天，更大的知识和可怕的技能！</p></blockquote><p id="c83f" class="pw-post-body-paragraph jk jl in jm b jn np jp jq jr nq jt ju jv nr jx jy jz ns kb kc kd nt kf kg kh ig bi translated"><a class="ae ki" href="https://www.linkedin.com/in/itay-cohen-b717b1107/" rel="noopener ugc nofollow" target="_blank">伊塔·科恩|领英</a></p></div></div>    
</body>
</html>