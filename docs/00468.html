<html>
<head>
<title>Pruning your code — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">修剪代码—第1部分</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/pruning-your-code-part-1-8ec0d27536db?source=collection_archive---------18-----------------------#2020-06-08">https://blog.devgenius.io/pruning-your-code-part-1-8ec0d27536db?source=collection_archive---------18-----------------------#2020-06-08</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="d6e6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi ki translated">我喜欢园艺。我还记得我种下第一张床时的感觉有多好。尽管我不得不等了整整一年才等到花开，但这仍然是非常值得的。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/25723efdcf30df60f3ad20262cf17802.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ljiHysYLTr59xooYIZF1-w.jpeg"/></div></div></figure><p id="113b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你很快就会上瘾。我很快开始添加越来越多的植物，最终我的床都满了，基本上变得无法维护。直到我再也无法区分不同的植物。</p><p id="7f62" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这最终导致以后的季节几乎没有花。我需要建议。</p><p id="f5e8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我的祖母被请来会诊，她有十个绿手指。</p><p id="0ae4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">那天她的建议改变了我对如何打理花园的整个看法。</p><blockquote class="ld le lf"><p id="29de" class="jk jl lg jm b jn jo jp jq jr js jt ju lh jw jx jy li ka kb kc lj ke kf kg kh ig bi translated"><strong class="jm io"> <em class="in">“对你的花园最好的投资就是修剪掉那些不需要的东西。”——菲娅·文特尔奶奶。</em> </strong></p></blockquote><p id="c847" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这让我开始思考。当然，我在网上看过花园改造前后的照片，一直认为关键是重做。但是她的话在我的脑海中，我意识到你可以通过移除过度生长和重组你所拥有的来清理混乱。</p><p id="536f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我开始在网上搜索图片，发现了这个花园。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi lk"><img src="../Images/fb4e40072ca6297a8352078acdfa8177.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YxGfznDJ09wil-cs1QfkLQ.png"/></div></div></figure><p id="8025" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">很快我就把这个建议应用到我自己的花园里，拿出我所有的植物，砍掉三分之二，重新种上同样的植物，然后等一年过去。</p><p id="2798" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">结果令人震惊。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ll"><img src="../Images/8ba5003013ee43ee953baf744985a727.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*A8KCCLJArfX6J_8mC5-0LQ.png"/></div><figcaption class="lm ln gj gh gi lo lp bd b be z dk translated">重组</figcaption></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi lk"><img src="../Images/477bc85fbb5f34f3ac836af9e502ed1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QFU1kWvu52Zh9b6NWS0H9A.png"/></div></div><figcaption class="lm ln gj gh gi lo lp bd b be z dk translated">一年后</figcaption></figure><p id="e585" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我同样的花草，突然有了新的生命。</p><h2 id="9845" class="lq lr in bd ls lt lu dn lv lw lx dp ly jv lz ma mb jz mc md me kd mf mg mh mi bi translated">发生了什么事？</h2><ul class=""><li id="e875" class="mj mk in jm b jn ml jr mm jv mn jz mo kd mp kh mq mr ms mt bi translated">修剪鼓励了我的植物生长，这导致了更多的花朵。</li><li id="5e0a" class="mj mk in jm b jn mu jr mv jv mw jz mx kd my kh mq mr ms mt bi translated">维护我的花园现在更容易了——例如，发现枯叶更容易了。</li><li id="8077" class="mj mk in jm b jn mu jr mv jv mw jz mx kd my kh mq mr ms mt bi translated">提高了我花园的整体美感。</li><li id="1621" class="mj mk in jm b jn mu jr mv jv mw jz mx kd my kh mq mr ms mt bi translated">我的植物的形状得到了改善。</li><li id="63b2" class="mj mk in jm b jn mu jr mv jv mw jz mx kd my kh mq mr ms mt bi translated">我的花园的布局和视野现在很清楚，也更容易理解。</li></ul><p id="725a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这让我开始思考。</p><h1 id="a62e" class="mz lr in bd ls na nb nc lv nd ne nf ly ng nh ni mb nj nk nl me nm nn no mh np bi translated"><strong class="ak">修剪与软件开发有什么关系？</strong></h1><p id="0ba1" class="pw-post-body-paragraph jk jl in jm b jn ml jp jq jr mm jt ju jv nq jx jy jz nr kb kc kd ns kf kg kh ig bi translated">我开始意识到，对于软件开发来说，以下是正确的:</p><ul class=""><li id="3709" class="mj mk in jm b jn jo jr js jv nt jz nu kd nv kh mq mr ms mt bi translated">我们忘记了“修剪”我们的代码。</li><li id="3bc1" class="mj mk in jm b jn mu jr mv jv mw jz mx kd my kh mq mr ms mt bi translated">我们允许我们的代码自由分支。</li><li id="eafa" class="mj mk in jm b jn mu jr mv jv mw jz mx kd my kh mq mr ms mt bi translated">我们需要删除不必要的分支。</li><li id="d341" class="mj mk in jm b jn mu jr mv jv mw jz mx kd my kh mq mr ms mt bi translated">随着时间的推移，维护变得越来越复杂。</li><li id="29c1" class="mj mk in jm b jn mu jr mv jv mw jz mx kd my kh mq mr ms mt bi translated">布局和设计变得不清楚。</li></ul><p id="8e79" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">但是为什么会这样呢？</p><h1 id="235b" class="mz lr in bd ls na nb nc lv nd ne nf ly ng nh ni mb nj nk nl me nm nn no mh np bi translated">后藤去了哪里？</h1><p id="a0ef" class="pw-post-body-paragraph jk jl in jm b jn ml jp jq jr mm jt ju jv nq jx jy jz nr kb kc kd ns kf kg kh ig bi translated">GoTo是一个允许将控制单向转移到另一行代码的语句。与将返回控件的函数调用不同。跳转位置通常是某种形式的标签或行号。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nw"><img src="../Images/5a611795b9122bde1fbba18babdbe0d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VHrtsyM_iJpC2xXc8lTBgA.png"/></div></div><figcaption class="lm ln gj gh gi lo lp bd b be z dk translated">信用:<a class="ae nx" href="http://xkcd.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="bd ls"> xkcd </strong> </a></figcaption></figure><p id="9d20" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这可以认为是分支。通过实现GoTo语句，您已经为代码创建了一个新的执行路径。</p><h2 id="c5e9" class="lq lr in bd ls lt lu dn lv lw lx dp ly jv lz ma mb jz mc md me kd mf mg mh mi bi translated">为什么这样不好？</h2><p id="6019" class="pw-post-body-paragraph jk jl in jm b jn ml jp jq jr mm jt ju jv nq jx jy jz nr kb kc kd ns kf kg kh ig bi translated">使用GoTo会导致程序极难理解和分析。这可能导致不确定的行为，并增加代码的刚性。</p><p id="0b10" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">今天，许多程序员会争辩说，我们今天没有使用GoTo语句，因为许多编程语言不再支持它，所以为什么还要谈论它呢？</p><p id="52e8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们考虑下面的代码片段。尝试查找GoTo语句:</p><pre class="ks kt ku kv gt ny nz oa ob aw oc bi"><span id="7597" class="lq lr in nz b gy od oe l of og"><strong class="nz io">private boolean</strong> processTransaction(<strong class="nz io">Transaction</strong> trans) {<br/>// do some session security checking<br/><strong class="nz io">User</strong> user = trans.user;<br/>log("security check for user " + user.name);</span><span id="a85c" class="lq lr in nz b gy oh oe l of og">if ( user.loggedIn() == false)<br/><strong class="nz io">return</strong> false;</span><span id="981c" class="lq lr in nz b gy oh oe l of og">if ( user.sessionTimeout() == true )<br/> <strong class="nz io">return</strong> false;</span><span id="df64" class="lq lr in nz b gy oh oe l of og"><strong class="nz io">boolean</strong> success = true;</span><span id="c6bc" class="lq lr in nz b gy oh oe l of og">// process transaction here<br/><strong class="nz io">return</strong> success;</span><span id="95c6" class="lq lr in nz b gy oh oe l of og">}</span></pre><p id="fd36" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">条件语句中，<strong class="jm io"> IF </strong>和<strong class="jm io"> SWITCH </strong>应该被认为是GoTo语句。</p><pre class="ks kt ku kv gt ny nz oa ob aw oc bi"><span id="5efb" class="lq lr in nz b gy od oe l of og"><strong class="nz io">IF </strong><em class="lg">condition </em><strong class="nz io">THEN goto</strong></span><span id="6ce6" class="lq lr in nz b gy oh oe l of og"><strong class="nz io">SWITCH </strong><em class="lg">expression </em><strong class="nz io">CASE goto</strong></span></pre><p id="0c21" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们过度使用了条件语句。</p><h1 id="0202" class="mz lr in bd ls na nb nc lv nd ne nf ly ng nh ni mb nj nk nl me nm nn no mh np bi translated">为什么分支不好？</h1><h2 id="b2c8" class="lq lr in bd ls lt lu dn lv lw lx dp ly jv lz ma mb jz mc md me kd mf mg mh mi bi translated"><strong class="ak">分支在CPU上开销很大。</strong></h2><ul class=""><li id="82a9" class="mj mk in jm b jn ml jr mm jv mn jz mo kd mp kh mq mr ms mt bi translated">当处理器看到分支指令出现在它的流水线中时，它需要想出如何继续填满它的流水线。</li><li id="67de" class="mj mk in jm b jn mu jr mv jv mw jz mx kd my kh mq mr ms mt bi translated">为了弄清楚程序流中分支之后是什么指令，它需要知道两件事:</li><li id="9b36" class="mj mk in jm b jn mu jr mv jv mw jz mx kd my kh mq mr ms mt bi translated">如果树枝被拿走了</li><li id="1129" class="mj mk in jm b jn mu jr mv jv mw jz mx kd my kh mq mr ms mt bi translated">分支的目标。</li></ul><p id="a5f4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">搞清楚这个就叫做<strong class="jm io"> <em class="lg">分支预测</em> </strong>，是一个很有挑战性的问题。如果处理器正确猜测<strong class="jm io"/>，程序继续全速运行。相反，如果处理器错误地猜测了<strong class="jm io"><em class="lg"/></strong>，它只是花费了一些时间来计算错误的东西。</p><p id="26db" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">它现在必须刷新其流水线，并从正确的执行路径重新加载指令。</p><p id="6c2a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一句话:巨大的性能成功。</p><h2 id="714a" class="lq lr in bd ls lt lu dn lv lw lx dp ly jv lz ma mb jz mc md me kd mf mg mh mi bi translated"><strong class="ak">分支会导致箭头反模式。</strong></h2><p id="44bf" class="pw-post-body-paragraph jk jl in jm b jn ml jp jq jr mm jt ju jv nq jx jy jz nr kb kc kd ns kf kg kh ig bi translated">嵌套的条件语句很难调试和维护。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oi"><img src="../Images/3c004dea5824ef923bc1fd7200717dd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KLl-pl2685ELo9syd8wt6w.png"/></div></div></figure><h1 id="3816" class="mz lr in bd ls na nb nc lv nd ne nf ly ng nh ni mb nj nk nl me nm nn no mh np bi translated">我如何修剪我的代码？</h1><p id="8f97" class="pw-post-body-paragraph jk jl in jm b jn ml jp jq jr mm jt ju jv nq jx jy jz nr kb kc kd ns kf kg kh ig bi translated">在<a class="ae nx" href="https://medium.com/@frikkievanbiljon/pruning-your-code-part-2-d32a2ef27e37" rel="noopener">下一部分</a>中，我们将看看如何通过删除大多数条件语句来修剪代码。我们将研究编写函数的替代方法，使之更简洁、更简短、更少IF。</p><p id="b45d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">改变旧习惯很难。尤其是当你开始爱他们的时候。用条件句解决问题成了我们的第二天性。就像Dijkstra说的:</p><blockquote class="ld le lf"><p id="dbad" class="jk jl lg jm b jn jo jp jq jr js jt ju lh jw jx jy li ka kb kc lj ke kf kg kh ig bi translated">囚犯爱上了他的锁链。</p></blockquote><p id="81a5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将通过删除<strong class="jm io"> IF- </strong>和<strong class="jm io"> SWITCH- </strong>语句来重做一些代码，并考虑修剪代码是否会产生更好的结果。</p></div></div>    
</body>
</html>