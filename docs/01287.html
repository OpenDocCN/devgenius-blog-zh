<html>
<head>
<title>Common Vue Problems — State Updates, Vuex, and Event Handlers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">常见的Vue问题—状态更新、Vuex和事件处理程序</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/common-vue-problems-state-updates-vuex-and-event-handlers-8a570c6cac8a?source=collection_archive---------14-----------------------#2020-06-29">https://blog.devgenius.io/common-vue-problems-state-updates-vuex-and-event-handlers-8a570c6cac8a?source=collection_archive---------14-----------------------#2020-06-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/570b4eaa4ac824b1d55bdc20cecd4e07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Y3SdYBTSEr-k-WIT"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">莎伦·麦卡琴在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="2dde" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vue.js让开发前端应用变得简单。然而，我们仍有可能遇到问题。</p><p id="0df2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇文章中，我们将看看一些常见的问题，并看看如何解决它们。</p><h1 id="6215" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">将事件和参数传递给Vue.js中的v-on</h1><p id="a9b3" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以将参数传递给我们在Vue的<code class="fe me mf mg mh b">v-on</code>指令中调用的方法。</p><p id="79ee" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="b718" class="mq lc iq mh b gy mr ms l mt mu">&lt;input type="number" v-on:input="addToCart($event, item.id)" min="0" placeholder="0"&gt;</span></pre><p id="0385" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们的模板中。</p><p id="81bb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在我们的组件中，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="4100" class="mq lc iq mh b gy mr ms l mt mu">methods: {<br/>  addToCart(event, id){<br/>    console.log(id)<br/>  }<br/>}</span></pre><p id="48d5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">$event</code>拥有从<code class="fe me mf mg mh b">input</code>事件中发出的对象。</p><p id="2aaa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">id</code>拥有我们在模板代码中传递的<code class="fe me mf mg mh b">item.id</code>。</p><h1 id="64bd" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">nextTick的目的</h1><p id="c0a9" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated"><code class="fe me mf mg mh b">nextTick</code>让我们在更改数据后做些什么。</p><p id="04f2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这就像普通JavaScript中的<code class="fe me mf mg mh b">setTimeout</code>。</p><p id="249c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">nextTick</code>从数据变化中检测变化，所以它总是在数据更新后运行。</p><p id="7330" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">没有意识到。</p><p id="52df" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，如果我们有:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="0a57" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div&gt;<br/>    {{ val }}<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="706d" class="mq lc iq mh b gy mv ms l mt mu">&lt;script&gt;<br/>export default {<br/>  data() {<br/>    return {<br/>      val: 1<br/>    }<br/>  },<br/>  mounted() {<br/>    this.val = 2;</span><span id="0510" class="mq lc iq mh b gy mv ms l mt mu">    this.$nextTick(() =&gt; {<br/>      this.val = 3;<br/>    });<br/>  }<br/>}<br/>&lt;/script&gt;</span></pre><p id="5413" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">this.val</code>的初始值为1。</p><p id="321e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后调用<code class="fe me mf mg mh b">mounted</code>钩子，更新<code class="fe me mf mg mh b">this.val</code>为2。</p><p id="9e8f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一旦更新完成，Vue就将<code class="fe me mf mg mh b">this.val</code>更新为3。</p><h1 id="48e5" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">$mount()和$el之间的区别</h1><p id="dc96" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated"><code class="fe me mf mg mh b">$mount</code>让我们在需要时显式挂载Vue实例。</p><p id="9eb2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有了它，我们可以延迟<code class="fe me mf mg mh b">Vue</code>实例，直到一个特定的元素存在。</p><p id="dd04" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这对于将Vue添加到通过操作DOM添加元素的遗留应用程序非常有用。</p><p id="495f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">el</code>将<code class="fe me mf mg mh b">Vue</code>实例直接挂载到DOM中，而不先检查它是否存在。</p><p id="7427" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，将实例安装到静态元素或我们知道总是在<code class="fe me mf mg mh b">Vue</code>实例之前加载的东西是很有用的。</p><h1 id="4b6a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">[Vue警告]:找不到元素</h1><p id="f25f" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">这个错误意味着Vue不能选择给定的元素来安装组件。</p><p id="6744" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，如果我们有:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="e793" class="mq lc iq mh b gy mr ms l mt mu">const main = new Vue({<br/>  el: '#main',<br/>  data: {<br/>    hello: 'home'<br/>  }<br/>});</span></pre><p id="17c8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么没有找到ID为<code class="fe me mf mg mh b">main</code>的元素。</p><p id="3c29" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了解决这个问题，我们应该确保在创建<code class="fe me mf mg mh b">Vue</code>实例之前加载元素。</p><p id="0614" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="8d6f" class="mq lc iq mh b gy mr ms l mt mu">window.onload = () =&gt; {<br/>  const main = new Vue({<br/>    el: '#main',<br/>    data: {<br/>      hello: 'home'<br/>    }<br/>  });<br/>}</span></pre><p id="0b6b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">或者我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="65c1" class="mq lc iq mh b gy mr ms l mt mu">window.addEventListener('load', () =&gt; {<br/>  // add the same Vue instance as the previous example<br/>})</span></pre><p id="26fe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它们都允许我们在给定元素出现在DOM中之后挂载<code class="fe me mf mg mh b">Vue</code>实例。</p><h1 id="cfdf" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在初始Vue.js加载时加载所有服务器端数据</h1><p id="bc18" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以在创建Vue实例之前，通过编写自己的函数来加载数据，从而将数据加载到Vuex存储中。</p><p id="3547" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="55f5" class="mq lc iq mh b gy mr ms l mt mu">const store = (data) =&gt; {<br/>  return new Vuex.Store({<br/>    state: {<br/>      exams: data,<br/>    },<br/>    actions,<br/>    getters,<br/>    mutations,<br/>  });<br/>}</span><span id="91b0" class="mq lc iq mh b gy mv ms l mt mu">fetch('/some/url')<br/>  .then(response =&gt; response.json())<br/>  .then((data) =&gt; {<br/>    new Vue({<br/>      el: '#app',<br/>      router,<br/>      store: store(data),<br/>      template: '&lt;App/&gt;',<br/>      components: { App },<br/>    });<br/>  });</span></pre><p id="6185" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有一个用<code class="fe me mf mg mh b">store</code>创建商店的函数。</p><p id="89f3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们调用传递给<code class="fe me mf mg mh b">Vue</code>构造函数的对象中的<code class="fe me mf mg mh b">store</code>函数。</p><p id="7616" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们传递给<code class="fe me mf mg mh b">store</code>的<code class="fe me mf mg mh b">data</code>来自于<code class="fe me mf mg mh b">fetch</code>函数调用。</p><p id="7bee" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样，数据将在进入商店之前被填充到商店中。</p><h1 id="e6d1" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用Vue CLI项目导入SASS或SCSS</h1><p id="c799" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过添加<code class="fe me mf mg mh b">node-sass</code>和<code class="fe me mf mg mh b">sass-loaer</code>包，用Vue CLI创建的Vue app导入SASS或SCSS。</p><p id="d67a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以在代码中加载SCSS文件。</p><p id="12e3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了安装软件包，我们运行:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="adca" class="mq lc iq mh b gy mr ms l mt mu">npm install -D node-sass sass-loader</span></pre><p id="938c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="3037" class="mq lc iq mh b gy mr ms l mt mu">import './styles/my-styles.scss'</span></pre><p id="1835" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe me mf mg mh b">main.js</code>中全局导入样式。</p><p id="60ab" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们想在文件中导入一个SASS或SCSS文件，那么我们写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="56ed" class="mq lc iq mh b gy mr ms l mt mu">&lt;style lang="scss"&gt;<br/>  ...<br/>&lt;/style&gt;</span></pre><p id="3bb4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">添加让Vue知道SCSS代码。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/c0cfdc499fa2c3838bc57561b2b8a7c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EEySk6JcyxGGtbO1"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@melodyjacob1?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Melody Jacob </a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h1 id="5817" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="3ca0" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">为了让我们在现有项目中使用SASS或SCSS代码，我们可以使用SASS loader包。</p><p id="abd2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们想在加载Vue应用程序之前将数据加载到Vuex商店，我们可以加载数据，然后用数据创建Vuex商店。</p><p id="5a88" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以用商店创建我们的Vue实例。</p><p id="74d0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以将任何东西传递给事件处理程序。</p><p id="d90a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">nextTick</code>便于在其他更新后更新我们的状态。</p></div></div>    
</body>
</html>