<html>
<head>
<title>How to use multiple environments in .Net Core</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在中使用多种环境？网络核心</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-use-multiple-environments-in-net-core-b3441612e8bd?source=collection_archive---------2-----------------------#2020-06-21">https://blog.devgenius.io/how-to-use-multiple-environments-in-net-core-b3441612e8bd?source=collection_archive---------2-----------------------#2020-06-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="5314" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">中管理多个开发环境的综合方法。网芯。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/4cee75be9dc897b3f37233affbd252aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f3WXZr5TimCxd8Nld9xQ8g.jpeg"/></div></div></figure><h1 id="761f" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">概观</h1><p id="124b" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">随着……的引入。Net Core带来了一系列的改进，包括个人和企业解决方案。开始学的时候。Net Core没有必要了解多种开发环境和部署管道，因为在转向生产就绪型应用程序时，教程和在线课程不会涵盖这些重要信息。</p><p id="f691" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我将向您展示如何正确地设置多个。Net核心应用程序环境，并利用不同的appsetting.json文件。</p><h1 id="fbc3" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">先决条件</h1><p id="4456" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">我希望你对面向对象编程概念有基本的了解。</p><ul class=""><li id="62e0" class="ma mb iq jp b jq jr ju jv jy mc kc md kg me kk mf mg mh mi bi translated"><a class="ae mj" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> Visual Studio代码</a>(或任何其他代码编辑器)</li><li id="dd36" class="ma mb iq jp b jq mk ju ml jy mm kc mn kg mo kk mf mg mh mi bi translated"><a class="ae mj" href="https://dotnet.microsoft.com/download" rel="noopener ugc nofollow" target="_blank">。网芯3.1 SDK </a></li><li id="10f2" class="ma mb iq jp b jq mk ju ml jy mm kc mn kg mo kk mf mg mh mi bi translated"><a class="ae mj" href="https://azure.microsoft.com/en-us/free/" rel="noopener ugc nofollow" target="_blank">蔚蓝账户</a></li></ul><h1 id="eb0b" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">步骤1 —创建API</h1><p id="4b94" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">首先，我们必须为。Net核心web API。幸运的是，我们已经有了用于这个目的的SDK。选择希望应用程序驻留的文件夹，打开命令终端并键入以下命令:</p><pre class="km kn ko kp gt mp mq mr ms aw mt bi"><span id="63bf" class="mu ky iq mq b gy mv mw l mx my">mkdir mkdir multi_environment_webapi<br/>cd multi_environment_webapi<br/>dotnet new webapi<br/>code . // If using VS Code</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mz"><img src="../Images/83788d5878ae296868684fd0a3495fcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*GTdBvVSZ4tK5kxLQy-zhJg.gif"/></div></div></figure><p id="c697" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果一切按预期进行，您应该打开代码编辑器，工作目录中的项目结构如下:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi na"><img src="../Images/b74f0cd920445561943f9d44a89865bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*TBqnNd3ShL098RjxqZ8pbw.png"/></div></figure><h1 id="76f5" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">步骤2-添加多个appsetting.json文件</h1><p id="9d3a" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">现在，为了保持整洁有序，让我们创建两个特定于环境的appsetting文件。为了我们的发展，Recette和生产应该是充足的。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nb"><img src="../Images/bb841beb22a1eb0088c2f8f5c3372b1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*pj_Zr0b-3dZJ3HhS6VzFwQ.gif"/></div></div></figure><p id="b860" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">默认情况下。Net core已经支持多种环境，但是在这种情况下，它只加载特定环境的设置。更好的解决方案是拥有一个共享的appsettings.json文件，其中包含环境不变的配置和用于特定于环境的配置的单独文件。</p><p id="e439" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们来添加一些配置。</p><p id="215e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在“appsettings。Recette.json“我们补充一下</p><pre class="km kn ko kp gt mp mq mr ms aw mt bi"><span id="35d0" class="mu ky iq mq b gy mv mw l mx my">{<br/>   "Message": "Hello from Recette environment file"<br/>}</span></pre><p id="fa95" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对其他环境也做同样的事情。</p><p id="afd4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，是时候添加对加载多个配置文件的支持了。我们将对程序做一些修改</p><pre class="km kn ko kp gt mp mq mr ms aw mt bi"><span id="4ce3" class="mu ky iq mq b gy mv mw l mx my">public static IHostBuilder CreateHostBuilder(string[] args)=&gt;<br/> Host.CreateDefaultBuilder(args)<br/>    .ConfigureWebHostDefaults(webBuilder =&gt;<br/>    {<br/>       webBuilder.UseStartup&lt;Startup&gt;();<br/>    })<br/>    <strong class="mq ir">.ConfigureAppConfiguration(appConfig =&gt;<br/>    {<br/>       appConfig.AddJsonFile($"appsettings.json", false, true);  <br/>       appConfig.AddJsonFile(  $"appsettings{Environment.GetEnvironmentVariable(<br/>"ASPNETCORE_ENVIRONMENT")}.json", false, true);<br/>    });</strong></span></pre><p id="f83e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它所做的只是加载默认的“appsettings.json”文件以及依赖于<strong class="jp ir"> ASPNETCORE_ENVIRONMENT </strong>变量的值的设置。</p><h1 id="7385" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">第三步——收获成果</h1><p id="7d25" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">终于，是时候看看我们的劳动成果了。让我们创建一个简单的表示控制器，从我们的配置中返回我们的消息；</p><p id="c261" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">转到“控制器”文件夹，创建一个名为“SettingsMessageController.cs”的新文件</p><pre class="km kn ko kp gt mp mq mr ms aw mt bi"><span id="3058" class="mu ky iq mq b gy mv mw l mx my">using Microsoft.AspNetCore.Mvc;<br/>using Microsoft.Extensions.Configuration;</span><span id="a20d" class="mu ky iq mq b gy nc mw l mx my">namespace multi_environment_webapi.Controllers<br/>{<br/>   [ApiController]<br/>   [Route("[controller]")]<br/>   public class SettingsMessageController : ControllerBase<br/>   {<br/>      private string settingMessage;<br/>      public SettingsMessageController(IConfiguration configuration)<br/>      {<br/>         settingMessage = configuration.GetValue&lt;string&gt;("Message");<br/>      }<br/>   <br/>     [HttpGet]<br/>      public string Get()<br/>      {<br/>         return settingMessage;<br/>      }<br/>   }<br/>}</span></pre><p id="a63e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在打开一个命令终端(在visual studio代码中是“CTRL +`”)并键入:</p><pre class="km kn ko kp gt mp mq mr ms aw mt bi"><span id="e86b" class="mu ky iq mq b gy mv mw l mx my">dotnet run</span></pre><p id="0e92" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后打开浏览器，导航到<a class="ae mj" href="https://localhost:5001/settingsmessage" rel="noopener ugc nofollow" target="_blank">localhost:5001/settings message</a>看看吧。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nd"><img src="../Images/70b0be0d8724250ec5f87aebdfc85457.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iZqhSl_HNeiTHlTUYU9BbA.png"/></div></div></figure><p id="6b5e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您想在其他环境中查看其他结果，只需导航到launchSettings.json并更改ASPNETCOR_ENVIRONMENT变量值:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ne"><img src="../Images/fa7d51156df2184b9f3c74c7034a2bb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*CYsrOuX6qe_gy9WHSxE1Dg.gif"/></div></div></figure><p id="5337" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就是这样！恭喜你！</p><p id="3e66" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，您已经有了一个基于应用程序环境的整洁且准备就绪的appsetting配置。我希望你学到了一些新的有用的东西来帮助你未来的项目。</p><p id="0c9b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以在我的Github库上查看整个项目:</p><h2 id="c994" class="mu ky iq bd kz nf ng dn ld nh ni dp lh jy nj nk ll kc nl nm lp kg nn no lt np bi translated"><a class="ae mj" href="https://github.com/EButa/multi_environment_webapi/commit/ccf5d40decc45fd403b18bb14e0376402f47d2e4" rel="noopener ugc nofollow" target="_blank">https://github . com/EButa/multi _ environment _ webapi/commit/CCF 5d 40 decc 45 FD 403 b 18 bb 14 e 0376402 f 47 D2 E4</a></h2><p id="47d0" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">我希望你喜欢这篇文章，也希望它对你有用。感谢您的反馈，让我了解如何改进这一点。</p><h1 id="bda1" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">进一步学习的免费参考资料:</h1><p id="195b" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated"><a class="ae mj" href="https://bit.ly/medium_article_link" rel="noopener ugc nofollow" target="_blank">。NET核心教程</a> —微软文档</p><p id="40ca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae mj" href="https://bit.ly/medium_article_link2" rel="noopener ugc nofollow" target="_blank">ASP.NET核心文档</a> —微软文档</p><h1 id="238c" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">如果你觉得有用，可以考虑投资我的咖啡瘾。</h1><div class="nq nr gp gr ns nt"><a href="https://www.buymeacoffee.com/ernebuta" rel="noopener  ugc nofollow" target="_blank"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd ir gy z fp ny fr fs nz fu fw ip bi translated">mounted.dev为我晚上困扰的问题提供了解决方案</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">嘿👋只是来帮忙的。作为一名软件开发人员，我真的希望能多喝点咖啡！！</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">www.buymeacoffee.com</p></div></div><div class="oc l"><div class="od l oe of og oc oh kv nt"/></div></div></a></div></div></div>    
</body>
</html>