<html>
<head>
<title>Why I Love Azure Serverless Functions for Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么我喜欢 Node.js 的 Azure 无服务器功能</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/why-i-love-azure-serverless-functions-for-node-js-d03c5767eb62?source=collection_archive---------6-----------------------#2021-12-21">https://blog.devgenius.io/why-i-love-azure-serverless-functions-for-node-js-d03c5767eb62?source=collection_archive---------6-----------------------#2021-12-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/719361c33bd897be50756760859713bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xWRNh1usG3H8VZEvigP32Q.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">NodeJs + Azure 函数</figcaption></figure><p id="e7f7" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在我职业软件开发生涯的前五年，我主要是一名. NET 开发人员。如果你已经编程了。NET，你知道首选的 IDE 是<a class="ae la" href="https://visualstudio.microsoft.com/" rel="noopener ugc nofollow" target="_blank"> Visual Studio </a> (VS)。VS 给了你很多工具，让开发变得更加容易。</p><p id="3e30" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">VS (IMO)最好的部分之一是它的调试工具。它允许您设置断点、观察器等等。这对初级开发人员非常有帮助，因为它允许您查看可以访问的不同属性和方法，当然，比使用打印/控制台日志语句更容易找到代码中的错误。</p><p id="2646" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这就是为什么当我转而关注 JavaScript 时，我在调试代码时遇到了如此大的困难。我被 VS 工具套件宠坏了，以至于它很快就变得令人沮丧。为 AWS Lambdas 之类的无服务器功能设置本地环境是多么复杂，这可能会使问题复杂化。</p><h1 id="a16e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">蔚蓝的</h1><p id="f984" class="pw-post-body-paragraph kc kd iq ke b kf lz kh ki kj ma kl km kn mb kp kq kr mc kt ku kv md kx ky kz ij bi translated">在我的职业生涯中，我使用过所有主要的云提供商(AWS、GCP 和 Azure)。在这三者中，Azure 是最容易使用的。他们的门户是直观和干净的。他们提供与 GCP 和 AWS 几乎相同的服务。最棒的是，它们为我的新宠 IDE<a class="ae la" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank">Visual Studio 代码</a>提供了奇妙的工具(如下所示)。</p><h1 id="b347" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">创建 Azure 无服务器功能</h1><h2 id="e757" class="me lc iq bd ld mf mg dn lh mh mi dp ll kn mj mk lp kr ml mm lt kv mn mo lx mp bi translated">Azure 帐户</h2><p id="a101" class="pw-post-body-paragraph kc kd iq ke b kf lz kh ki kj ma kl km kn mb kp kq kr mc kt ku kv md kx ky kz ij bi translated">如果您还没有帐户，请前往 https://azure.microsoft.com 的<a class="ae la" href="https://azure.microsoft.com/en-us/free/" rel="noopener ugc nofollow" target="_blank"/>，创建一个帐户，然后登录门户网站测试您的证书。从这里开始，我们将不再使用 Azure，而是使用 VS 代码来创建一切。</p><h2 id="2147" class="me lc iq bd ld mf mg dn lh mh mi dp ll kn mj mk lp kr ml mm lt kv mn mo lx mp bi translated">Azure Tools Visual Studio 代码扩展</h2><p id="fb8f" class="pw-post-body-paragraph kc kd iq ke b kf lz kh ki kj ma kl km kn mb kp kq kr mc kt ku kv md kx ky kz ij bi translated">接下来，下载<a class="ae la" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> VS 代码</a>如果你还没有的话。下载完成后，点击左侧菜单中的扩展选项卡，搜索<a class="ae la" href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.vscode-node-azure-pack" rel="noopener ugc nofollow" target="_blank"> Azure Tools </a>并安装。</p><figure class="mr ms mt mu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mq"><img src="../Images/ca80c6eac95ab69d34886c161c2152d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xD7fNjCle4PsHr0QhOHrTA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">安装 Azure 扩展</figcaption></figure><p id="b7a7" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">安装完扩展后，你会在左侧菜单中看到一个 Azure 图标。点击它，然后点击“登录 Azure”。这将提示您登录 Azure 帐户。</p><figure class="mr ms mt mu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/6711e25f35dcca553e458bd5ea6e8408.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w5sY1i4lxgY6E89yzhgsCA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Azure 扩展登录</figcaption></figure><p id="a73c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在我们已经登录了，我们可以直接从 VS 代码创建一个 Azure 函数。为此，请确保您在 azure 扩展菜单上，找到“功能”选项卡，然后单击“创建新项目”图标。如果您不在目录(文件夹)中，它会提示您创建一个目录。一旦进入您想要的目录，它将引导您创建新的函数。</p><h2 id="9549" class="me lc iq bd ld mf mg dn lh mh mi dp ll kn mj mk lp kr ml mm lt kv mn mo lx mp bi translated">我将选择以下内容:</h2><ol class=""><li id="2faf" class="mw mx iq ke b kf lz kj ma kn my kr mz kv na kz nb nc nd ne bi translated">选择一种语言:<strong class="ke ir"> JavaScript </strong></li><li id="a16a" class="mw mx iq ke b kf nf kj ng kn nh kr ni kv nj kz nb nc nd ne bi translated">为你的第一个函数选择一个模板:<strong class="ke ir"> HTTP 触发器</strong>(还有很多其他的。可以在这里了解一下:<a class="ae la" href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-reference" rel="noopener ugc nofollow" target="_blank">https://docs . Microsoft . com/en-us/azure/azure-functions/functions-overview</a>)</li><li id="f37c" class="mw mx iq ke b kf nf kj ng kn nh kr ni kv nj kz nb nc nd ne bi translated">提供一个名称:<strong class="ke ir">媒体功能</strong></li><li id="a4dd" class="mw mx iq ke b kf nf kj ng kn nh kr ni kv nj kz nb nc nd ne bi translated">授权:<strong class="ke ir">函数</strong>(要了解更多关于 Auth 的信息，请访问:<strong class="ke ir"/><a class="ae la" href="https://docs.microsoft.com/en-us/azure/azure-functions/security-concepts" rel="noopener ugc nofollow" target="_blank">https://docs . Microsoft . com/en-us/azure/azure-functions/security-concepts</a>)</li></ol><p id="e329" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">选择之后，您可以选择在当前窗口中打开该功能。Azure 会在你的函数目录下创建几个文件。两个最重要的文件是 function.json 和 index.js，前者保存所有的函数设置，后者保存代码。</p><figure class="mr ms mt mu gt jr gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/2e922176a3c7fd621a3ce8a190136bf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/1*7T2zJIqBZJAiMf0yOgSGhw.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">项目结构</figcaption></figure><h2 id="e6ae" class="me lc iq bd ld mf mg dn lh mh mi dp ll kn mj mk lp kr ml mm lt kv mn mo lx mp bi translated">操作码</h2><p id="ec4e" class="pw-post-body-paragraph kc kd iq ke b kf lz kh ki kj ma kl km kn mb kp kq kr mc kt ku kv md kx ky kz ij bi translated">在基本项目模板中，您将看到一些示例代码。它期望您向主体或查询字符串传递一个名称参数，并且它将返回一个响应，主体将名称和一些文本一起传递回来。该状态默认为 200，但可以被覆盖。</p><pre class="mr ms mt mu gt nl nm nn no aw np bi"><span id="b428" class="me lc iq nm b gy nq nr l ns nt">module<em class="nu">.</em>exports = <em class="nu">async</em> function (context, req) {<br/> <em class="nu">context.log</em>(<br/>  'JavaScript HTTP trigger function processed a  request.'<br/> );</span><span id="9f14" class="me lc iq nm b gy nv nr l ns nt"> const<em class="nu"> name </em>=<em class="nu"> </em>(<em class="nu">req.query.name </em>||<em class="nu"> </em>(<em class="nu">req.body </em>&amp;&amp;<em class="nu"> req.body.name</em>));</span><span id="be36" class="me lc iq nm b gy nv nr l ns nt"> const<em class="nu"> responseMessage </em>=<em class="nu"> </em>name<br/>  ? "Hello, " + name + ". This HTTP triggered function executed <br/>  successfully." : <br/>  "This HTTP triggered function executed successfully. Pass a name<br/>  in the query string or in the request body for a personalized <br/>  response.";</span><span id="4381" class="me lc iq nm b gy nv nr l ns nt"><em class="nu"> context.</em>res = {<br/>  //<em class="nu"> status: 200, /* Defaults to 200 */<br/>  </em>body: responseMessage<br/> };<br/>}</span></pre><h2 id="0c86" class="me lc iq bd ld mf mg dn lh mh mi dp ll kn mj mk lp kr ml mm lt kv mn mo lx mp bi translated">函数. json</h2><p id="ecd0" class="pw-post-body-paragraph kc kd iq ke b kf lz kh ki kj ma kl km kn mb kp kq kr mc kt ku kv md kx ky kz ij bi translated">在 function.json 中，我们可以找到函数的设置:</p><pre class="mr ms mt mu gt nl nm nn no aw np bi"><span id="345a" class="me lc iq nm b gy nq nr l ns nt">{<br/> "bindings": [<br/>  {<br/>   "authLevel": "function",<br/>   "type": "httpTrigger",<br/>   "direction": "in",<br/>   "name": "req",<br/>   "methods": [<br/>    "get",<br/>    "post"<br/>   ]<br/>  },<br/>  {<br/>   "type": "http",<br/>   "direction": "out",<br/>   "name": "res"<br/>  }<br/> ]<br/>}</span></pre><p id="8332" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这显示了我们在功能设置中选择的所有选项。我们将 auth level 作为一个函数，将 type 作为 httpTrigger，一些方向设置，以及我们允许的 HTTP 方法(GET 和 POST)。要了解如何编辑此文件的更多信息，请访问:<a class="ae la" href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-reference" rel="noopener ugc nofollow" target="_blank">https://docs . Microsoft . com/en-us/azure/azure-functions/functions-reference</a></p><h1 id="c225" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">最精彩的部分…</h1><h2 id="01ba" class="me lc iq bd ld mf mg dn lh mh mi dp ll kn mj mk lp kr ml mm lt kv mn mo lx mp bi translated">局部功能调试</h2><p id="6c0d" class="pw-post-body-paragraph kc kd iq ke b kf lz kh ki kj ma kl km kn mb kp kq kr mc kt ku kv md kx ky kz ij bi translated">使用 Azure 函数最奇妙的部分是本地调试功能。要在本地启动它，请单击左侧菜单中的调试图标，这将在左上角显示一个绿色的播放按钮。一旦你点击它，它将启动你的功能，并给你一个端点。</p><figure class="mr ms mt mu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nw"><img src="../Images/a76e66bdb7aefefa907cf834f90045a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*67zTfkuoR0GU14D9z3arRw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">在本地启动 Azure 功能</figcaption></figure><h2 id="c7c9" class="me lc iq bd ld mf mg dn lh mh mi dp ll kn mj mk lp kr ml mm lt kv mn mo lx mp bi translated">设置和命中断点</h2><p id="dd81" class="pw-post-body-paragraph kc kd iq ke b kf lz kh ki kj ma kl km kn mb kp kq kr mc kt ku kv md kx ky kz ij bi translated">现在回到 index.js 文件，在第 4 行设置一个断点，在这里检查名字。然后打开 Postman(或类似的),用查询字符串或请求正文中的名称调用端点。</p><p id="5e7a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这将在本地调用该函数并命中断点。从那里，您可以将鼠标悬停在不同的变量上，查看它们的值和方法。在我看来，毫无疑问这使得开发变得更加容易。</p><figure class="mr ms mt mu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nx"><img src="../Images/650c6de90ef08a1e6a36d563e3bf7b42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tj5La12WY3XpY08XI2WaDg.png"/></div></div></figure><h1 id="be4a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">更多…</h1><p id="8220" class="pw-post-body-paragraph kc kd iq ke b kf lz kh ki kj ma kl km kn mb kp kq kr mc kt ku kv md kx ky kz ij bi translated">很难在一篇文章中展示更多。因此，要想获得更深入的教程，请务必查看我下面关于这个主题的视频。在这篇文章中，我们将涵盖本文中包含的所有内容，以及如何返回不同的状态代码，如何在一个项目中创建多个功能，以及如何在 Azure 上部署它们。</p><h1 id="c120" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">视频教程</h1><figure class="mr ms mt mu gt jr"><div class="bz fp l di"><div class="ny nz l"/></div></figure></div></div>    
</body>
</html>