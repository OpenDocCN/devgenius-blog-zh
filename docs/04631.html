<html>
<head>
<title>Add Charts into Our React App with Victory — Custom Chart Components</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Victory 将图表添加到我们的 React 应用程序中—自定义图表组件</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/add-charts-into-our-react-app-with-victory-custom-chart-components-5eeb4499ce01?source=collection_archive---------10-----------------------#2021-04-12">https://blog.devgenius.io/add-charts-into-our-react-app-with-victory-custom-chart-components-5eeb4499ce01?source=collection_archive---------10-----------------------#2021-04-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/16578c00e67695cdefef348e6859548a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Y99uLu52ZyXiCrrl"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Solen Feyissa 在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="224e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">胜利让我们能够将图表和数据可视化添加到 React 应用程序中。</p><p id="35db" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解如何使用 Victory 将图表添加到 React 应用程序中。</p><h1 id="5d5c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">多边形图表</h1><p id="1f42" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用<code class="fe me mf mg mh b">Polygon</code>组件添加多边形图表。</p><p id="cc50" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="99c6" class="mq lc iq mh b gy mr ms l mt mu">import React from "react";<br/>import { VictoryChart, VictoryScatter } from "victory";</span><span id="e959" class="mq lc iq mh b gy mv ms l mt mu">const data = [<br/>  { x: 2, y: 1 },<br/>  { x: 3, y: 5 },<br/>  { x: 6, y: 3 }<br/>];</span><span id="56f0" class="mq lc iq mh b gy mv ms l mt mu">const Polygon = (props) =&gt; {<br/>  const getPoints = (data, scale) =&gt; {<br/>    return data.reduce(<br/>      (pointStr, { x, y }) =&gt; `${pointStr} ${scale.x(x)},${scale.y(y)}`,<br/>      ""<br/>    );<br/>  };</span><span id="6917" class="mq lc iq mh b gy mv ms l mt mu">  const { data, style, scale } = props;<br/>  const points = getPoints(data, scale);<br/>  return &lt;polygon points={points} style={style} /&gt;;<br/>};</span><span id="b839" class="mq lc iq mh b gy mv ms l mt mu">export default function App() {<br/>  return (<br/>    &lt;VictoryChart height={400} width={400} domain={[-10, 10]}&gt;<br/>      &lt;Polygon data={data} style={{ fill: "tomato", opacity: 0.5 }} /&gt;<br/>      &lt;VictoryScatter data={data} /&gt;<br/>    &lt;/VictoryChart&gt;<br/>  );<br/>}</span></pre><p id="21ce" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在<code class="fe me mf mg mh b">Polygon</code>组件中创建了<code class="fe me mf mg mh b">getPoint</code>函数来创建多边形路径的点串。</p><p id="4be7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们将它传递给<code class="fe me mf mg mh b">polygon</code>元素来创建点。</p><p id="ffb6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe me mf mg mh b">App</code>中，我们通过<code class="fe me mf mg mh b">Polygon</code>组件和<code class="fe me mf mg mh b">data</code>道具从给定的角点创建多边形。</p><p id="49bb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe me mf mg mh b">VictoryScatter</code>组件将相同的点渲染成点。</p><h1 id="2d88" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用 Victory 组件创建定制组件</h1><p id="ec5e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用 Victory 组件来创建定制组件。</p><p id="f8a4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="d77a" class="mq lc iq mh b gy mr ms l mt mu">import React from "react";<br/>import {<br/>  VictoryAxis,<br/>  VictoryChart,<br/>  VictoryGroup,<br/>  VictoryLine,<br/>  VictoryPie,<br/>  VictoryScatter<br/>} from "victory";</span><span id="4772" class="mq lc iq mh b gy mv ms l mt mu">const data = [<br/>  { x: 2, y: 1 },<br/>  { x: 3, y: 5 },<br/>  { x: 6, y: 3 }<br/>];</span><span id="bc4b" class="mq lc iq mh b gy mv ms l mt mu">const CustomPie = (props) =&gt; {<br/>  const { datum, x, y } = props;<br/>  const pieWidth = 120;</span><span id="926f" class="mq lc iq mh b gy mv ms l mt mu">  return (<br/>    &lt;g transform={`translate(${x - pieWidth / 2}, ${y - pieWidth / 2})`}&gt;<br/>      &lt;VictoryPie<br/>        standalone={false}<br/>        height={pieWidth}<br/>        width={pieWidth}<br/>        data={datum.pie}<br/>        style={{ labels: { fontSize: 0 } }}<br/>        colorScale={["#f77", "#55e", "#8af"]}<br/>      /&gt;<br/>    &lt;/g&gt;<br/>  );<br/>};</span><span id="c608" class="mq lc iq mh b gy mv ms l mt mu">export default function App() {<br/>  return (<br/>    &lt;VictoryChart domain={{ y: [0, 100] }}&gt;<br/>      &lt;VictoryAxis /&gt;<br/>      &lt;VictoryGroup data={data}&gt;<br/>        &lt;VictoryLine /&gt;<br/>        &lt;VictoryScatter dataComponent={&lt;CustomPie /&gt;} /&gt;<br/>      &lt;/VictoryGroup&gt;<br/>    &lt;/VictoryChart&gt;<br/>  );<br/>}</span></pre><p id="134c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们创建了呈现小饼图的<code class="fe me mf mg mh b">CustomPie</code>组件，并用<code class="fe me mf mg mh b">VictoryPie</code>组件将饼图呈现为点。</p><p id="16e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe me mf mg mh b">App</code>中，我们通过将<code class="fe me mf mg mh b">VictoryGroup</code>设置为<code class="fe me mf mg mh b">data</code>道具来渲染<code class="fe me mf mg mh b">data</code>。</p><p id="026c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">VictoryScatter</code>让我们渲染这些点。</p><p id="061c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将<code class="fe me mf mg mh b">CustomPie</code>设置为<code class="fe me mf mg mh b">dataComponent</code>道具，将馅饼渲染为点。</p><p id="3daa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以将任何 SVG 组件作为点组件传入<code class="fe me mf mg mh b">dataComponent</code>属性中。</p><p id="1265" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以使用样式化组件为点创建 SVG 圆:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="6b52" class="mq lc iq mh b gy mr ms l mt mu">import React from "react";<br/>import styled from "styled-components";<br/>import { VictoryChart, VictoryLine, VictoryScatter } from "victory";</span><span id="e317" class="mq lc iq mh b gy mv ms l mt mu">const data = [<br/>  { x: 2, y: 1 },<br/>  { x: 3, y: 5 },<br/>  { x: 6, y: 3 }<br/>];</span><span id="77fd" class="mq lc iq mh b gy mv ms l mt mu">const StyledPoint = styled.circle`<br/>  fill: ${(props) =&gt; props.color};<br/>`;</span><span id="11bd" class="mq lc iq mh b gy mv ms l mt mu">const colors = ["#A8E6CE", "#DCEDC2", "#FFD3B5", "#FFAAA6", "#FF8C94"];</span><span id="dd59" class="mq lc iq mh b gy mv ms l mt mu">const ScatterPoint = ({ x, y, datum, min, max }) =&gt; {<br/>  const i = React.useMemo(() =&gt; {<br/>    return Math.floor(((datum.y - min) / (max - min)) * (colors.length - 1));<br/>  }, [datum, min, max]);</span><span id="f63a" class="mq lc iq mh b gy mv ms l mt mu">return &lt;StyledPoint color={colors[i]} cx={x} cy={y} r={6} /&gt;;<br/>};</span><span id="ed74" class="mq lc iq mh b gy mv ms l mt mu">export default function App() {<br/>  const temperatures = data.map(({ y }) =&gt; y);<br/>  const min = Math.min(...temperatures);<br/>  const max = Math.max(...temperatures);</span><span id="fc0a" class="mq lc iq mh b gy mv ms l mt mu">  return (<br/>    &lt;VictoryChart&gt;<br/>      &lt;VictoryLine data={data} /&gt;<br/>      &lt;VictoryScatter<br/>        data={data}<br/>        dataComponent={&lt;ScatterPoint min={min} max={max} /&gt;}<br/>      /&gt;<br/>    &lt;/VictoryChart&gt;<br/>  );<br/>}</span></pre><p id="762d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">StyledPoint</code>组件具有点。</p><p id="3425" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">并且<code class="fe me mf mg mh b">ScatterPoint</code>用该点的填充颜色渲染<code class="fe me mf mg mh b">StyledPoint</code>。</p><p id="4f8a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们通过<code class="fe me mf mg mh b">ScatterPoint</code>作为<code class="fe me mf mg mh b">dataComponent</code>的值来渲染这些点。</p><h1 id="aae4" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="360d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用 React Victory 渲染多边形图表并为图表创建自定义组件。</p></div></div>    
</body>
</html>