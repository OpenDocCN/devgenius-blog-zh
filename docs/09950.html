<html>
<head>
<title>Design Patterns in Python: Memento Pattern</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 中的设计模式:纪念模式</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/design-patterns-in-python-memento-pattern-dfbb8a6f36cb?source=collection_archive---------6-----------------------#2022-09-25">https://blog.devgenius.io/design-patterns-in-python-memento-pattern-dfbb8a6f36cb?source=collection_archive---------6-----------------------#2022-09-25</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="b910" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">Memento 设计模式在 Python 中的实现</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/831fbcb3021a9fac7c211c870216fa10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L8oUmKaR8eYFTEydgWUlzQ.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">纪念的电影海报。<a class="ae ks" href="https://wall.alphacoders.com/big.php?i=1122155" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="ad8c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们使用 Memento 设计模式来捕捉一个对象的瞬时状态，并将其取出。这样，物体就可以在必要的时候回到我们带出的这个状态。</p><p id="6d4a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">前一章是:</p><div class="lp lq gp gr lr ls"><a href="https://python.plainenglish.io/design-patterns-in-python-observer-pattern-3d65307ab46a" rel="noopener  ugc nofollow" target="_blank"><div class="lt ab fo"><div class="lu ab lv cl cj lw"><h2 class="bd io gy z fp lx fr fs ly fu fw im bi translated">Python 中的设计模式:观察者模式</h2><div class="lz l"><h3 class="bd b gy z fp lx fr fs ly fu fw dk translated">观察者设计模式在 Python 中的实现</h3></div><div class="ma l"><p class="bd b dl z fp lx fr fs ly fu fw dk translated">python .平原英语. io</p></div></div><div class="mb l"><div class="mc l md me mf mb mg km ls"/></div></div></a></div><p id="0f53" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在一个结构中，一个对象的状态可能会经常改变。我们可能还想存储有问题的对象所在的状态，返回到这些状态(撤销)，或者创建检查点。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mh"><img src="../Images/99aa8f4b48c6a959a030c449d03b08d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d2E3Xkx_OnfyMI3UxkpKRA.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">撤消。</figcaption></figure><p id="10a3" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">封装不允许我们导出对象的状态。那么设计另一个可以访问和存储对象状态的对象可能是明智的。为了解决这个问题，我们可以设计一个纪念品。</p><p id="17f5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Memento 保护对象的快照。它接收状态信息，并将其存储在为其设计的数据结构中。它只有需要存储的状态信息，并在必要时，介入将有问题的对象转换为它为撤销操作存储的状态。</p><ul class=""><li id="28a9" class="mi mj in kv b kw kx kz la lc mk lg ml lk mm lo mn mo mp mq bi translated"><strong class="kv io">发起者</strong>是其状态将被存储的对象。</li><li id="a375" class="mi mj in kv b kw mr kz ms lc mt lg mu lk mv lo mn mo mp mq bi translated"><strong class="kv io">纪念物</strong>是存储状态的对象。</li><li id="5b88" class="mi mj in kv b kw mr kz ms lc mt lg mu lk mv lo mn mo mp mq bi translated"><strong class="kv io">看管人</strong>是触发纪念品存储发起者状态的对象。</li></ul><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mw"><img src="../Images/16d07ae8ec40af32d632fc72117286c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uMs5o-KOWQ9EGysy9wSZgg.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">UML 类图。<a class="ae ks" href="https://sbcode.net/python/memento/" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="9c3d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们有一个 memento 类，它保存状态信息。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mz"><img src="../Images/f5ae3f480e968ac2cfa788e2313ad3cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0gPOewA01x6KjCqoy_z3Fw.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">纪念品</figcaption></figure><p id="356f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">发起者有通常的 getters 和 setters。此外，如果我们想要快照，它会返回一个 memento 对象(通过<em class="na"> get_memento </em>方法)。并且，<em class="na"> memento </em>方法只是处理恢复或撤销操作。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nb"><img src="../Images/1dc9a188bedd04c936725a13433cc7b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EVGTkQ43sZTRLp03kv33qg.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">发起人</figcaption></figure><p id="b20e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">管理员是纪念品和发起者之间的接口。它按顺序跟踪纪念品。因此，我们可以跳转到任何带有索引的 memento 对象。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nc"><img src="../Images/d790ef4bb342ff5fe8325649de19401b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O8GJkxLSzoIy6lXn6rNJ2g.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">看门人</figcaption></figure><p id="2d90" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们创建客户端:</p><pre class="kd ke kf kg gt nd ne nf ng aw nh bi"><span id="7145" class="ni nj in ne b gy nk nl l nm nn">ORIGINATOR = Originator()<br/>CARETAKER = CareTaker(ORIGINATOR)</span></pre><p id="a1fb" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">尝试做一些改变:</p><pre class="kd ke kf kg gt nd ne nf ng aw nh bi"><span id="9fce" class="ni nj in ne b gy nk nl l nm nn">ORIGINATOR.set_state("State 1")</span><span id="f435" class="ni nj in ne b gy no nl l nm nn"><strong class="ne io">#New State of Originator: State 1</strong><br/><br/>ORIGINATOR.set_state("State 2")</span><span id="34da" class="ni nj in ne b gy no nl l nm nn"><strong class="ne io">#New State of Originator: State 2</strong></span></pre><p id="822c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们创造看守者；</p><pre class="kd ke kf kg gt nd ne nf ng aw nh bi"><span id="787c" class="ni nj in ne b gy nk nl l nm nn">CARETAKER.create()</span><span id="8baa" class="ni nj in ne b gy no nl l nm nn"><strong class="ne io">#Providing a new memento object of current state<br/>#I am a Memento and my state is State 2<br/>#Total mementos in caretaker:  1</strong></span></pre><p id="8446" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们在状态中再做一次改变，然后保存它。</p><pre class="kd ke kf kg gt nd ne nf ng aw nh bi"><span id="814e" class="ni nj in ne b gy nk nl l nm nn">ORIGINATOR.set_state("State 3")<br/>CARETAKER.create()</span><span id="bdb5" class="ni nj in ne b gy no nl l nm nn"><strong class="ne io">#New State of Originator: State 3<br/>#Providing a new memento object of current state<br/>#I am a Memento and my state is State 3<br/>#Total mementos in caretaker:  2</strong></span><span id="85bb" class="ni nj in ne b gy no nl l nm nn">ORIGINATOR.set_state("State 4")</span><span id="c412" class="ni nj in ne b gy no nl l nm nn"><strong class="ne io">#New State of Originator: State 4</strong></span><span id="fd59" class="ni nj in ne b gy no nl l nm nn"><strong class="ne io">print(ORIGINATOR.get_state())</strong></span><span id="f7b3" class="ni nj in ne b gy no nl l nm nn">#State 4</span></pre><p id="49f8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们恢复并回到第一个纪念品的状态:</p><pre class="kd ke kf kg gt nd ne nf ng aw nh bi"><span id="ac51" class="ni nj in ne b gy nk nl l nm nn">CARETAKER.restore(0)</span><span id="8d85" class="ni nj in ne b gy no nl l nm nn"><strong class="ne io">#Undo operation at 0 index<br/>#State 2<br/>#Returning to the state of memento State 2</strong></span><span id="371d" class="ni nj in ne b gy no nl l nm nn">print(ORIGINATOR.get_state())</span><span id="d345" class="ni nj in ne b gy no nl l nm nn"><strong class="ne io">#State 2</strong></span></pre><p id="4261" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">通过使用 memento 设计模式，我们不会在状态存储期间破坏封装。使用纪念版可能会很贵。要持有的对象数量越多，成本就越高。它用在 GUI 和编辑器等经常使用撤销操作的系统中。</p><p id="e32f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">感谢阅读。如果你有任何问题或意见，请随时写信给我。</p><h2 id="a0c6" class="ni nj in bd np nq nr dn ns nt nu dp nv lc nw nx ny lg nz oa ob lk oc od oe of bi translated">下一章</h2><div class="lp lq gp gr lr ls"><a href="https://medium.com/@okanyenigun/design-patterns-in-python-mediator-pattern-a7fe09655d44" rel="noopener follow" target="_blank"><div class="lt ab fo"><div class="lu ab lv cl cj lw"><h2 class="bd io gy z fp lx fr fs ly fu fw im bi translated">Python 中的设计模式:中介模式</h2><div class="lz l"><h3 class="bd b gy z fp lx fr fs ly fu fw dk translated">中介设计模式解释。</h3></div><div class="ma l"><p class="bd b dl z fp lx fr fs ly fu fw dk translated">medium.com</p></div></div><div class="mb l"><div class="og l md me mf mb mg km ls"/></div></div></a></div><h2 id="78bc" class="ni nj in bd np nq nr dn ns nt nu dp nv lc nw nx ny lg nz oa ob lk oc od oe of bi translated">阅读更多内容…</h2><div class="lp lq gp gr lr ls"><a href="https://levelup.gitconnected.com/design-patterns-in-python-singleton-pattern-f76dc26281f8" rel="noopener  ugc nofollow" target="_blank"><div class="lt ab fo"><div class="lu ab lv cl cj lw"><h2 class="bd io gy z fp lx fr fs ly fu fw im bi translated">Python 中的设计模式:单例模式</h2><div class="lz l"><h3 class="bd b gy z fp lx fr fs ly fu fw dk translated">Python 中 Singleton 设计模式的实现</h3></div><div class="ma l"><p class="bd b dl z fp lx fr fs ly fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="mb l"><div class="oh l md me mf mb mg km ls"/></div></div></a></div><div class="lp lq gp gr lr ls"><a href="https://python.plainenglish.io/design-patterns-in-python-builder-pattern-d921fbac7fb3" rel="noopener  ugc nofollow" target="_blank"><div class="lt ab fo"><div class="lu ab lv cl cj lw"><h2 class="bd io gy z fp lx fr fs ly fu fw im bi translated">Python 中的设计模式:构建器模式</h2><div class="lz l"><h3 class="bd b gy z fp lx fr fs ly fu fw dk translated">用 Python 语言实现 Builder 模式</h3></div><div class="ma l"><p class="bd b dl z fp lx fr fs ly fu fw dk translated">python .平原英语. io</p></div></div><div class="mb l"><div class="oi l md me mf mb mg km ls"/></div></div></a></div><div class="lp lq gp gr lr ls"><a href="https://medium.com/@okanyenigun/how-does-python-work-7dc53da52065" rel="noopener follow" target="_blank"><div class="lt ab fo"><div class="lu ab lv cl cj lw"><h2 class="bd io gy z fp lx fr fs ly fu fw im bi translated">Python 是如何工作的？</h2><div class="lz l"><h3 class="bd b gy z fp lx fr fs ly fu fw dk translated">Python 的内部工作原理</h3></div><div class="ma l"><p class="bd b dl z fp lx fr fs ly fu fw dk translated">medium.com</p></div></div><div class="mb l"><div class="oj l md me mf mb mg km ls"/></div></div></a></div><div class="lp lq gp gr lr ls"><a href="https://levelup.gitconnected.com/restful-django-django-rest-framework-8b62bed31dd8" rel="noopener  ugc nofollow" target="_blank"><div class="lt ab fo"><div class="lu ab lv cl cj lw"><h2 class="bd io gy z fp lx fr fs ly fu fw im bi translated">RESTful Django — Django REST 框架</h2><div class="lz l"><h3 class="bd b gy z fp lx fr fs ly fu fw dk translated">让我们开发一个 RESTful Django 项目</h3></div><div class="ma l"><p class="bd b dl z fp lx fr fs ly fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="mb l"><div class="ok l md me mf mb mg km ls"/></div></div></a></div><h2 id="750e" class="ni nj in bd np nq nr dn ns nt nu dp nv lc nw nx ny lg nz oa ob lk oc od oe of bi translated">参考</h2><p id="9ba7" class="pw-post-body-paragraph kt ku in kv b kw ol jo ky kz om jr lb lc on le lf lg oo li lj lk op lm ln lo ig bi translated"><a class="ae ks" href="https://www.geeksforgeeks.org/memento-method-python-design-patterns/" rel="noopener ugc nofollow" target="_blank">https://www . geeks forgeeks . org/memento-method-python-design-patterns/</a></p><p id="49ea" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><a class="ae ks" href="https://refactoring.guru/design-patterns/memento/python/example" rel="noopener ugc nofollow" target="_blank">https://refactoring . guru/design-patterns/memento/python/example</a></p><p id="82e8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><a class="ae ks" href="http://www.coursegalaxy.com/design-patterns/memento-python.html" rel="noopener ugc nofollow" target="_blank">http://www . course galaxy . com/design-patterns/memento-python . html</a></p><p id="1ddd" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><a class="ae ks" href="https://pythonwife.com/memento-design-pattern-with-python/" rel="noopener ugc nofollow" target="_blank">https://pythonwife.com/memento-design-pattern-with-python/</a></p></div></div>    
</body>
</html>