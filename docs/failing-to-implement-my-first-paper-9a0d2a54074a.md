# 未能完成我的第一篇论文

> 原文：<https://blog.devgenius.io/failing-to-implement-my-first-paper-9a0d2a54074a?source=collection_archive---------9----------------------->

在过去的一周里，我一直在实现一篇在地震图像上创建标签的论文。这样做是为了实现同一作者的另一篇论文，让卷积网络从这些标签中学习特征。但我没能这样做。我会在博客中解释原因。

一开始我发现了这张[纸](https://arxiv.org/pdf/1901.05306.pdf)，它使用弱标签来学习图像的特征。但是从报纸上看。我不得不自己做标签。所以，我查了他们参考的另一篇论文，他们做了标签。在那篇论文中，他们从普通图像标签中制作了像素级标签。他们有介绍他们算法的论文。[这里有一个](https://arxiv.org/pdf/1812.08756.pdf)，收录了算法的总结。这是我找到的第一篇论文。这里还有一个[第二个](https://pdfs.semanticscholar.org/15c5/3fd0424d9aadda88de3c431078fde46459d2.pdf)更详细。我后来用它来帮助编写项目代码。

## 准备好数据

在我开始编写机器学习模型来生成标签之前。我做了数据探索。我得到的数据集被称为[陆地](https://github.com/olivesgatech/LANDMASS)。这篇论文的作者。它有数以千计的荷兰北海的地震图像。由于这是大量的数据，我首先查看了 10 张图片。我首先必须将 MATLAB 文件中的图像转换成普通图像。这在开始时证明是困难的。不过后来找到了窍门，借助这个[中条](https://towardsdatascience.com/how-to-load-matlab-mat-files-in-python-1f200e1287b5)。以及这个公式，从[堆栈溢出](https://stackoverflow.com/a/50966711)将归一化数据转换成正常像素。

`*round((img + 1) * 255 / 2)*`

![](img/8326b688018ffad744d5a2aa5b8cfc1d.png)

混沌图像

在我能够了解图像的样子之后。我开始研究机器学习模型。以获取模型所需的数据。我需要收集不同类别的所有图像。包括混沌、地平线、断层和盐丘。同样，由于数据集包括成千上万的图像。我选择每类 10 张图片。在我收集了所有的图像之后。我用 K-means 算法初始化特征矩阵。

但后来，我忽略了一个关键因素，那就是这篇论文提到的。这些图像被转换成矢量。所以，我找到了一段代码，将图像转换成矢量。这次我收集了矢量图像。

# 绘制标签和图像

使用的主要算法是[非负矩阵分解](https://mlexplained.com/2017/12/28/a-practical-introduction-to-nmf-nonnegative-matrix-factorization/)。但是我的电脑没有这样做所需的软件包。(当时打算用 TensorFlow)。所以，我转到了 Google Colab。即使我没有使用张量流来制作 NMF 模型。使用 google colab 更好，因为我可以使用 google 服务器来计算我的模型。我用 [Scikit-learn NMF 模块](https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.NMF.html)代替。之后，我在模型收敛后制作标签。之后，我在列上使用了 argmax 函数。然后应用中值滤波器来去除有噪声的标签。

然后我画出了标签。那么这就是主要问题出现的地方。在我绘制标签后，它们看起来像这样:

![](img/ca9f77a78e527e2df0cb9d2d604f31eb.png)

这看起来一点也不像标签应该有的样子。以下是研究论文中的例子:

![](img/119fabe0ac6f96ccc6416d90ebeb67d0.png)

我无数次用各种方法重塑了数据。并编辑了 NMF 模型。但不太成功。我不知道如何前进。因为解决问题并不容易。并且一直在搜索寻找答案。我还使用了标签数据的切片。因此，它与数据集中的图像长度相同。但是没有使标签更清晰。

之后，我尝试绘制保存在数组中的图像。通过使用切片，我最终让它工作了。像这样切片[:256，256]。意味着将绘制 256 像素的行和列。但有一件小事是，当使用 matplotlib 图像绘图不像枕头显示一种蓝色。

![](img/08bb4d455a82f3605671c953859d476d.png)

我尝试的解决方案之一是添加更多数据。所以，每个类别增加了 40 多张图片。每个类别将保存 50 张图片。但变化不大。我没有用过的一个解决方案是从头开始创建 NMF 模型。基本上，NMF 不使用 Scikit learn。并使用类似 TensorFlow 的东西。因为该论文具有它们自己的使用稀疏度测量的 NMF 方程。来弥补标签会弱的事实。

![](img/748d55bfb5110ea20a378c16da1c98af.png)![](img/8c116e9d2f742ddd47e29a1d6dbb89e0.png)![](img/42c9908833595cabeb0c84b8bdf8b037.png)

我也可以尝试使用一个更加定制的 k-means 算法。但是这篇论文没有为定制的 k-means 算法添加任何细节。所以标准的 k-means 算法可能不是问题。

# 数学困难

让模型更加定制化可能是答案。我认为导致这些问题的主要原因是数据的形式。拥有一个更加定制的模型将向我展示数据是如何被操作的。唯一的问题是定制模型很难。我需要把数学转换成代码。编写项目代码时最难的一点是计算 Q 变量。

![](img/53ed22065d1ea0a6551158ab61799e5c.png)

我仍然不知道我这样做是否正确。特别是对于 *hn* 变量，我已经把它从方程中去掉了，因为我不知道该加什么运算符，也不知道如何在方程中定义它。因此，即使定制模型和返工的 Q 值。只是因为缺乏将数学转化为代码的知识。仍然是不可能的。

所以，这是我第一次认真尝试实现一篇论文。我认为可以说我没有成功。但是我学到了很多新东西。喜欢更好的数学符号知识。和进一步使用 scikit learn。我将很快尝试实现其他文件。

更新时间:

我复制了一个 NMF 实现的[张量流。差别不大。尝试实现论文的乘法更新规则被证明非常困难。因为我在努力理解乐谱。突出了我正在努力阅读的问题。](https://github.com/eesungkim/NMF-Tensorflow)

![](img/99364db78d0c060d2f21a3d4f60ecb70.png)