<html>
<head>
<title>PHP — P106: __invoke, __toString, __get and __set Magic Methods</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PHP — P106: __invoke、__toString、__get 和 __set 魔术方法</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/php-p106-invoke-tostring-get-and-set-magic-methods-eda38d07bc0a?source=collection_archive---------9-----------------------#2022-12-03">https://blog.devgenius.io/php-p106-invoke-tostring-get-and-set-magic-methods-eda38d07bc0a?source=collection_archive---------9-----------------------#2022-12-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/42866714094d920ab9acfbc99e5c9536.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Lsyi-dJix_i8u3mgehXpg.jpeg"/></div></div></figure><p id="df75" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们正在讨论 PHP 必须提供的最后一个内置函数/方法。我们还没有接近 PHP 提供的内置函数的全部范围，但是我认为我们已经涵盖了最常用的函数。在本文中，我们将看看<code class="fe kw kx ky kz b">__invoke</code>、<code class="fe kw kx ky kz b">__toString</code>、<code class="fe kw kx ky kz b">__get</code>和<code class="fe kw kx ky kz b">__set</code>方法。</p><p id="569b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">PHP 有几个“神奇的方法”，如<code class="fe kw kx ky kz b">__construct</code>、<code class="fe kw kx ky kz b">__destruct</code>、<code class="fe kw kx ky kz b">__call</code>、<code class="fe kw kx ky kz b">__callStatic</code>、<code class="fe kw kx ky kz b">__get</code>、<code class="fe kw kx ky kz b">__set</code>、<code class="fe kw kx ky kz b">__isset</code>、<code class="fe kw kx ky kz b">__unset</code>、<code class="fe kw kx ky kz b">__sleep</code>、<code class="fe kw kx ky kz b">__wakeup</code>、<code class="fe kw kx ky kz b">__serialize</code>、<code class="fe kw kx ky kz b">__toString</code>、<code class="fe kw kx ky kz b">__invoke</code>、<code class="fe kw kx ky kz b">__setState</code>、<code class="fe kw kx ky kz b">__clone</code>和<code class="fe kw kx ky kz b">__debuginfo</code>。我们已经介绍了<code class="fe kw kx ky kz b">__call</code>、<code class="fe kw kx ky kz b">__construct</code>和<code class="fe kw kx ky kz b">__destruct</code>魔法方法。</p><div class="la lb gp gr lc ld"><a rel="noopener  ugc nofollow" target="_blank" href="/php-p101-trim-htmlspecialchars-and-call-built-in-functions-7b4f25728db9"><div class="le ab fo"><div class="lf ab lg cl cj lh"><h2 class="bd ir gy z fp li fr fs lj fu fw ip bi translated">PHP — P101: trim、htmlspecialchars 和 __call 内置函数</h2><div class="lk l"><h3 class="bd b gy z fp li fr fs lj fu fw dk translated">在过去的 100 篇 PHP 文章中，我们使用了各种内置函数。是时候把它们收集到一个地方了…</h3></div><div class="ll l"><p class="bd b dl z fp li fr fs lj fu fw dk translated">blog.devgenius.io</p></div></div><div class="lm l"><div class="ln l lo lp lq lm lr jw ld"/></div></div></a></div><ul class=""><li id="59bf" class="ls lt iq ka b kb kc kf kg kj lu kn lv kr lw kv lx ly lz ma bi translated"><code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p101-trim-htmlspecialchars-and-call-built-in-functions-7b4f25728db9" rel="noopener">trim()</a>,</code>、<code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p101-trim-htmlspecialchars-and-call-built-in-functions-7b4f25728db9" rel="noopener">ltrim()</a></code>、<code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p101-trim-htmlspecialchars-and-call-built-in-functions-7b4f25728db9" rel="noopener">rtrim()</a></code></li><li id="f288" class="ls lt iq ka b kb mc kf md kj me kn mf kr mg kv lx ly lz ma bi translated"><code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p101-trim-htmlspecialchars-and-call-built-in-functions-7b4f25728db9" rel="noopener">htmlspecialchars()</a></code></li><li id="61cd" class="ls lt iq ka b kb mc kf md kj me kn mf kr mg kv lx ly lz ma bi translated"><code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p101-trim-htmlspecialchars-and-call-built-in-functions-7b4f25728db9" rel="noopener">__call()</a></code></li><li id="614f" class="ls lt iq ka b kb mc kf md kj me kn mf kr mg kv lx ly lz ma bi translated"><code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p102-preg-match-and-regular-expressions-b4b23869261a" rel="noopener">preg_match()</a></code></li><li id="5d92" class="ls lt iq ka b kb mc kf md kj me kn mf kr mg kv lx ly lz ma bi translated"><code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p103-filter-var-built-in-function-b21c186a24e9" rel="noopener">filter_var()</a></code></li><li id="7072" class="ls lt iq ka b kb mc kf md kj me kn mf kr mg kv lx ly lz ma bi translated"><code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p104-string-functions-acb8bbeae832" rel="noopener">addslashes()</a></code></li><li id="77b0" class="ls lt iq ka b kb mc kf md kj me kn mf kr mg kv lx ly lz ma bi translated"><code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p104-string-functions-acb8bbeae832" rel="noopener">str_replace()</a></code></li><li id="cf9c" class="ls lt iq ka b kb mc kf md kj me kn mf kr mg kv lx ly lz ma bi translated"><code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p104-string-functions-acb8bbeae832" rel="noopener">strlen()</a></code></li><li id="8d29" class="ls lt iq ka b kb mc kf md kj me kn mf kr mg kv lx ly lz ma bi translated"><code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p104-string-functions-acb8bbeae832" rel="noopener">strtolower()</a></code></li><li id="f78b" class="ls lt iq ka b kb mc kf md kj me kn mf kr mg kv lx ly lz ma bi translated"><code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p104-string-functions-acb8bbeae832" rel="noopener">strtoupper()</a></code></li><li id="c821" class="ls lt iq ka b kb mc kf md kj me kn mf kr mg kv lx ly lz ma bi translated"><code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p104-string-functions-acb8bbeae832" rel="noopener">ucfirst()</a></code></li><li id="2bf8" class="ls lt iq ka b kb mc kf md kj me kn mf kr mg kv lx ly lz ma bi translated"><code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p104-string-functions-acb8bbeae832" rel="noopener">strpos()</a></code>、<code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p104-string-functions-acb8bbeae832" rel="noopener">stripos()</a></code>、<code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p104-string-functions-acb8bbeae832" rel="noopener">strrpos()</a></code>、<code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p104-string-functions-acb8bbeae832" rel="noopener">strripos()</a></code></li><li id="02ae" class="ls lt iq ka b kb mc kf md kj me kn mf kr mg kv lx ly lz ma bi translated"><a class="ae mb" href="https://medium.com/dev-genius/php-p105-array-functions-54f682a76c1" rel="noopener">数组函数有:</a> <code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p105-array-functions-54f682a76c1" rel="noopener">array_chunk()</a></code> <a class="ae mb" href="https://medium.com/dev-genius/php-p105-array-functions-54f682a76c1" rel="noopener">，</a> <code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p105-array-functions-54f682a76c1" rel="noopener">array_diff()</a></code> <a class="ae mb" href="https://medium.com/dev-genius/php-p105-array-functions-54f682a76c1" rel="noopener">，</a> <code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p105-array-functions-54f682a76c1" rel="noopener">array_key_exists()</a></code> <a class="ae mb" href="https://medium.com/dev-genius/php-p105-array-functions-54f682a76c1" rel="noopener">，</a> <code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p105-array-functions-54f682a76c1" rel="noopener">array_key_first()</a></code> <a class="ae mb" href="https://medium.com/dev-genius/php-p105-array-functions-54f682a76c1" rel="noopener">，</a> <code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p105-array-functions-54f682a76c1" rel="noopener">array_key_last()</a></code> <a class="ae mb" href="https://medium.com/dev-genius/php-p105-array-functions-54f682a76c1" rel="noopener">，</a> <code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p105-array-functions-54f682a76c1" rel="noopener">array_map()</a></code> <a class="ae mb" href="https://medium.com/dev-genius/php-p105-array-functions-54f682a76c1" rel="noopener">，</a> <code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p105-array-functions-54f682a76c1" rel="noopener">array_merge()</a></code> <a class="ae mb" href="https://medium.com/dev-genius/php-p105-array-functions-54f682a76c1" rel="noopener">，</a> <code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p105-array-functions-54f682a76c1" rel="noopener">array_push()</a></code> <a class="ae mb" href="https://medium.com/dev-genius/php-p105-array-functions-54f682a76c1" rel="noopener">，<code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p105-array-functions-54f682a76c1" rel="noopener">array_sum()</a></code> </a><a class="ae mb" href="https://medium.com/dev-genius/php-p105-array-functions-54f682a76c1" rel="noopener">，</a> <code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p105-array-functions-54f682a76c1" rel="noopener">asort()</a></code> <a class="ae mb" href="https://medium.com/dev-genius/php-p105-array-functions-54f682a76c1" rel="noopener">，</a> <code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p105-array-functions-54f682a76c1" rel="noopener">arsort()</a></code>，<code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p105-array-functions-54f682a76c1" rel="noopener">count()</a></code>，<code class="fe kw kx ky kz b"><a class="ae mb" href="https://medium.com/dev-genius/php-p105-array-functions-54f682a76c1" rel="noopener">in_array()</a></code></li><li id="e886" class="ls lt iq ka b kb mc kf md kj me kn mf kr mg kv lx ly lz ma bi translated">神奇的方法有:<code class="fe kw kx ky kz b"><strong class="ka ir">__invoke()</strong></code> <strong class="ka ir">、</strong>、<code class="fe kw kx ky kz b"><strong class="ka ir">__toString()</strong></code>、<strong class="ka ir">、</strong>、<code class="fe kw kx ky kz b"><strong class="ka ir">__get()</strong></code>、<strong class="ka ir">、</strong>、<code class="fe kw kx ky kz b"><strong class="ka ir">__set()</strong></code></li></ul><h1 id="284b" class="mh mi iq bd mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne bi translated">__invoke()</h1><p id="7b6b" class="pw-post-body-paragraph jy jz iq ka b kb nf kd ke kf ng kh ki kj nh kl km kn ni kp kq kr nj kt ku kv ij bi translated">当脚本像调用函数一样调用对象时，就会调用<code class="fe kw kx ky kz b">__invoke</code>魔法方法。</p><pre class="nk nl nm nn gt no kz np bn nq nr bi"><span id="0b52" class="ns mi iq kz b be nt nu l nv nw">&lt;?php<br/><br/>class InvokeTest<br/>{<br/>    public function __invoke( $name )<br/>    {<br/>        echo "Hey " . $name;<br/>    }<br/>}<br/><br/>$invoke = new InvokeTest;<br/>$invoke("Dino");</span></pre><p id="0ac4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有意思。我们实例化 InvokeTest 对象，然后像调用函数一样调用该对象。我们确实得到了回应，那就是:<code class="fe kw kx ky kz b">Hey Dino</code>。</p><h1 id="d593" class="mh mi iq bd mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne bi translated">__toString()</h1><p id="cb8b" class="pw-post-body-paragraph jy jz iq ka b kb nf kd ke kf ng kh ki kj nh kl km kn ni kp kq kr nj kt ku kv ij bi translated">如果你曾经想要<code class="fe kw kx ky kz b">echo</code>对象本身，你只需要实现<code class="fe kw kx ky kz b">__toString</code>方法。</p><pre class="nk nl nm nn gt no kz np bn nq nr bi"><span id="6cdd" class="ns mi iq kz b be nt nu l nv nw">&lt;?php<br/><br/>class ToStringTest<br/>{<br/>    private string $name = "Dino Cajic";<br/><br/>    public function __toString() {<br/>        return $this-&gt;name;<br/>    }<br/>}<br/><br/>$test = new ToStringTest;<br/>echo $test;</span></pre><p id="b28c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们得到的回应是<code class="fe kw kx ky kz b">Dino Cajic</code>。</p><h1 id="aa02" class="mh mi iq bd mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne bi translated">__set()，__get()</h1><p id="fe05" class="pw-post-body-paragraph jy jz iq ka b kb nf kd ke kf ng kh ki kj nh kl km kn ni kp kq kr nj kt ku kv ij bi translated">在我们结束的时候，我们也可以讨论一下<code class="fe kw kx ky kz b">__set</code>和<code class="fe kw kx ky kz b">__get</code>方法。类似于<code class="fe kw kx ky kz b">__call</code>魔术方法，当属性不可访问时，调用<code class="fe kw kx ky kz b">__set</code>和<code class="fe kw kx ky kz b">__get</code>，因为私有/受保护修饰符被应用到属性，或者因为属性不存在。</p><p id="28b3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe kw kx ky kz b">__set</code>魔术方法接受两个参数，<code class="fe kw kx ky kz b">$name</code>和<code class="fe kw kx ky kz b">$value</code>。<code class="fe kw kx ky kz b">$name</code>是您试图访问的属性，<code class="fe kw kx ky kz b">$value</code>是您试图分配的值。</p><p id="90e3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于<code class="fe kw kx ky kz b">__get</code>魔法方法，我们将只传递您试图访问的属性。</p><pre class="nk nl nm nn gt no kz np bn nq nr bi"><span id="674d" class="ns mi iq kz b be nt nu l nv nw">&lt;?php<br/><br/>class GetAndSetTest<br/>{<br/>    private array $data;<br/><br/>    public function __set($name, $value) {<br/>        $this-&gt;data[$name] = $value;<br/>    }<br/><br/>    public function __get($name) {<br/>        return $this-&gt;data[$name];<br/>    }<br/>}<br/><br/>$test = new GetAndSetTest;<br/><br/>$test-&gt;name = "Dino Cajic";<br/>echo $test-&gt;name;<br/><br/>$test-&gt;age = 55;<br/>echo $test-&gt;age;</span></pre><p id="cc77" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">尽管我们没有那些属性，但我们有一个<code class="fe kw kx ky kz b">__set</code>魔法方法。它先用<code class="fe kw kx ky kz b">$data[‘name’] = ‘Dino Cajic’</code>设置我们的<code class="fe kw kx ky kz b">$data</code>数组，然后再用<code class="fe kw kx ky kz b">$data[‘age’] = 55</code>设置。然后我们可以用<code class="fe kw kx ky kz b">__get</code>方法调用这些属性。所以我们得到的回应是，一旦我们调用我们的属性:<code class="fe kw kx ky kz b">Dino Cajic</code>和<code class="fe kw kx ky kz b">55</code>。</p><div class="la lb gp gr lc ld"><a href="https://github.com/dinocajic/php-youtube-tutorials" rel="noopener  ugc nofollow" target="_blank"><div class="le ab fo"><div class="lf ab lg cl cj lh"><h2 class="bd ir gy z fp li fr fs lj fu fw ip bi translated">GitHub-dinocajic/PHP-YouTube-tutorials:PHP YouTube 教程的代码</h2><div class="lk l"><h3 class="bd b gy z fp li fr fs lj fu fw dk translated">PHP YouTube 教程的代码确保你已经安装了 Docker。克隆回购。运行以下命令…</h3></div><div class="ll l"><p class="bd b dl z fp li fr fs lj fu fw dk translated">github.com</p></div></div><div class="lm l"><div class="nx l lo lp lq lm lr jw ld"/></div></div></a></div></div><div class="ab cl ny nz hu oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="ij ik il im in"><figure class="nk nl nm nn gt jr gh gi paragraph-image"><div class="gh gi of"><img src="../Images/e72714a9d19ff78da0aaa3cf5d968293.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sWKXkxViJG1JIfGs.jpeg"/></div></figure><p id="dd35" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Dino Cajic 目前是<a class="ae mb" href="http://absolutebiotech.com/" rel="noopener ugc nofollow" target="_blank"> Absolute Biotech </a>的 IT 负责人，该公司是<a class="ae mb" href="https://www.lsbio.com/" rel="noopener ugc nofollow" target="_blank"> LSBio(寿命生物科学公司)</a>、<a class="ae mb" href="https://absoluteantibody.com/" rel="noopener ugc nofollow" target="_blank"> Absolute 抗体</a>、<a class="ae mb" href="https://www.kerafast.com/" rel="noopener ugc nofollow" target="_blank"> Kerafast </a>、<a class="ae mb" href="https://everestbiotech.com/" rel="noopener ugc nofollow" target="_blank"> Everest BioTech </a>、<a class="ae mb" href="https://www.nordicmubio.com/" rel="noopener ugc nofollow" target="_blank"> Nordic MUbio </a>和<a class="ae mb" href="https://www.exalpha.com/" rel="noopener ugc nofollow" target="_blank"> Exalpha </a>的母公司。他还担任我的自动系统的首席执行官。他拥有计算机科学学士学位，辅修生物学，并拥有十多年的软件工程经验。他的背景包括创建企业级电子商务应用程序、执行基于研究的软件开发，以及通过写作促进知识的传播。</p><p id="2169" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以在<a class="ae mb" href="https://www.linkedin.com/in/dinocajic/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上联系他，在<a class="ae mb" href="https://instagram.com/think.dino" rel="noopener ugc nofollow" target="_blank"> Instagram </a>上关注他，或者<a class="ae mb" href="https://dinocajic.medium.com/subscribe" rel="noopener">订阅他的媒体出版物</a>。</p><p id="a4af" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">阅读 Dino Cajic(以及 Medium 上成千上万的其他作家)的每一个故事。你的会员费直接支持迪诺·卡吉克和你阅读的其他作家。你也可以在媒体上看到所有的故事。T25】</p></div></div>    
</body>
</html>