<html>
<head>
<title>What is Jenkins Pipeline and JenkinsFile?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是 Jenkins 管道和 JenkinsFile？</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/what-is-jenkins-pipeline-and-jenkinsfile-96f30f3a29c?source=collection_archive---------2-----------------------#2022-01-09">https://blog.devgenius.io/what-is-jenkins-pipeline-and-jenkinsfile-96f30f3a29c?source=collection_archive---------2-----------------------#2022-01-09</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/6fe19f811e4452e82864ec05f034eb9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XljFv5ON0CU97NPJVCdaog.png"/></div></div></figure><h2 id="2c28" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">简介:</h2><p id="f5ef" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">在这篇文章中，我将谈论 Jenkins 管道和我如何能写 Jenkins 文件，以及什么是 Jenkins 文件的语法。</p><p id="c531" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">读完这篇文章后，我想让你明白什么是 CI/CD 概念，什么是 Jenkins，你可以看看这个博客来了解这个主题<a class="ae lr" href="https://medium.com/@abdalrhmanalkraien/ci-cd-concept-with-pipeline-3408d2fff38" rel="noopener">什么是 CI/CD 概念？</a>和<a class="ae lr" href="https://medium.com/@abdalrhmanalkraien/what-is-jenkins-bc8bebcc05cf" rel="noopener">詹金斯是什么？</a></p><h2 id="05ef" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">詹金斯管道是什么？</h2><p id="d7dc" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">流水线 it 是在软件从版本控制到最终用户的过程中，使用自动化工具进行自动化部署的作业搭配</p><p id="1850" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">这个特性用于将软件与连续交付相结合</p><h2 id="4e4f" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">我可以以两种方式使用管道</h2><ul class=""><li id="d17f" class="ls lt in kt b ku kv ky kz ke lu ki lv km lw ll lx ly lz ma bi translated"><strong class="kt io">第一路用管道</strong></li></ul><p id="e3f0" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">第一种方式创建许多作业，每个作业都有一个任务，如测试作业 1 和构建作业 2，等等，然后创建管道以顺序方式运行这些作业，但这种方式是复杂的项目，我认为这很无聊</p><ul class=""><li id="8b9b" class="ls lt in kt b ku lm ky ln ke mb ki mc km md ll lx ly lz ma bi translated"><strong class="kt io">第二种管道方式:</strong></li></ul><p id="0d64" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">我们可以使用<strong class="kt io"> Jenkins 管道项目</strong>这是 Jenkins 为构建复杂项目提供的新功能</p><p id="ebbd" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">这种方式依赖于<strong class="kt io"> Jenkinsfile </strong>。</p><blockquote class="me mf mg"><p id="9320" class="kr ks mh kt b ku lm kw kx ky ln la lb mi lo ld le mj lp lg lh mk lq lj lk ll ig bi translated"><em class="in">在本文中，我将解释构建我们的</em> <strong class="kt io"> <em class="in">管道</em> </strong> <em class="in">的第二种方法。</em></p></blockquote><h2 id="27d6" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">现在我该如何通过声明式管道使用 Jenkins 管道项目呢？</strong></h2><p id="ca16" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">这个管道的关键特性是通过代码定义整个部署流程。</p><p id="7877" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">我们可以使用<strong class="kt io"> Jenkinsfile </strong>在将我的项目构建为工作流之前的编写所有阶段，现在我可以替换旧的方式，即创建作业，然后我需要将此作业放在 Jenkins 系统的管道中。</p><blockquote class="me mf mg"><p id="848a" class="kr ks mh kt b ku lm kw kx ky ln la lb mi lo ld le mj lp lg lh mk lq lj lk ll ig bi translated"><strong class="kt io"><em class="in">Jenkins file</em></strong><em class="in">必须嵌入你的</em> <strong class="kt io"> <em class="in">版本控制</em> </strong> <em class="in">像</em><strong class="kt io"><em class="in">github</em></strong><em class="in">或者</em><strong class="kt io"><em class="in">gitlab</em></strong><em class="in">等等。</em></p></blockquote><h2 id="2dd9" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">什么是 Jenkinsfile？</h2><p id="859b" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">一个<strong class="kt io"> Jenkinsfile </strong>是一个文本文件，它将整个工作流程存储为代码，并且可以在您的本地系统上签入一个<strong class="kt io"> SCM </strong></p><p id="e29a" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">我可以随时打开<strong class="kt io"> Jenkinsfile </strong>并在上面编辑</p><p id="dc00" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated"><strong class="kt io"> Jenkinsfile </strong>是使用<strong class="kt io"> Groovy </strong> <strong class="kt io"> DSL </strong>编写的，它可以通过文本/groovy 编辑器或通过 Jenkins 实例上的配置页面创建。它基于两种语法编写，即:</p><ul class=""><li id="84ce" class="ls lt in kt b ku lm ky ln ke mb ki mc km md ll lx ly lz ma bi translated"><strong class="kt io"> <em class="mh">声明式管道语法</em> </strong></li></ul><p id="b354" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">这是一个支持管道作为代码概念的新特性，允许从版本控制(如 git)中获取代码</p><ul class=""><li id="fb8f" class="ls lt in kt b ku lm ky ln ke mb ki mc km md ll lx ly lz ma bi translated"><strong class="kt io"> <em class="mh">脚本化管道语法</em> </strong></li></ul><p id="68f3" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">这是编写代码的传统方式</p><blockquote class="me mf mg"><p id="114b" class="kr ks mh kt b ku lm kw kx ky ln la lb mi lo ld le mj lp lg lh mk lq lj lk ll ig bi translated"><em class="in">在这篇文章中我将解释关于</em> <strong class="kt io"> <em class="in">的声明式管道语法</em> </strong> <em class="in">用于构建我们的</em><strong class="kt io"><em class="in">Jenkins file</em></strong><em class="in">。</em></p></blockquote><p id="e9fb" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">现在我将解释一下<strong class="kt io">管道概念</strong>:</p><ul class=""><li id="ec2e" class="ls lt in kt b ku lm ky ln ke mb ki mc km md ll lx ly lz ma bi translated"><strong class="kt io">管道</strong></li></ul><p id="728c" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">我们可以在管道块中定义所有的处理，比如构建、测试、编译和部署</p><p id="23f4" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">在这里，我们可以在<strong class="kt io"> Jenkinsfile </strong>中定义收集阶段</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="3ff7" class="jv jw in mq b gy mu mv l mw mx">pipeline{<br/>​<br/>}</span></pre><ul class=""><li id="8c1e" class="ls lt in kt b ku lm ky ln ke mb ki mc km md ll lx ly lz ma bi translated"><strong class="kt io">节点</strong></li></ul><p id="ce23" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">节点是执行整个工作流的机器。它是脚本化管道语法的关键部分。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="0ef0" class="jv jw in mq b gy mu mv l mw mx">node{<br/>​<br/>}</span></pre><ul class=""><li id="28b3" class="ls lt in kt b ku lm ky ln ke mb ki mc km md ll lx ly lz ma bi translated"><strong class="kt io">代理</strong></li></ul><p id="b09a" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">有了代理，我们可以只用一个<strong class="kt io"> Jenkins </strong>实例运行多个构建</p><p id="e2c1" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">我们可以用代理运行几个带有一个<strong class="kt io"> Jenkins </strong>实例的项目，它指示 Jenkins<strong class="kt io">为构建分配一个执行程序</strong>。</p><p id="1306" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">可以为整个管道指定单个代理，也可以分配特定的代理来执行管道中的每个阶段。一些参数</p><ul class=""><li id="237c" class="ls lt in kt b ku lm ky ln ke mb ki mc km md ll lx ly lz ma bi translated"><strong class="kt io">任何</strong></li></ul><p id="bca9" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">在任何可用的代理上运行管道/阶段。</p><ul class=""><li id="395d" class="ls lt in kt b ku lm ky ln ke mb ki mc km md ll lx ly lz ma bi translated"><strong class="kt io">无</strong></li></ul><p id="1a70" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">此参数应用于管道的根，它表示整个管道没有全局代理，每个阶段都必须指定自己的代理。</p><ul class=""><li id="5849" class="ls lt in kt b ku lm ky ln ke mb ki mc km md ll lx ly lz ma bi translated"><strong class="kt io">标签</strong></li></ul><p id="5b57" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">在标记的代理上执行管道/阶段。</p><ul class=""><li id="8d29" class="ls lt in kt b ku lm ky ln ke mb ki mc km md ll lx ly lz ma bi translated"><strong class="kt io">码头工人</strong></li></ul><p id="ecc7" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">此参数使用 docker 容器作为管道或特定阶段的执行环境。</p><p id="e678" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">这个映像现在可以用作运行多个命令的执行环境。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="14e8" class="jv jw in mq b gy mu mv l mw mx">pipeline{</span><span id="320a" class="jv jw in mq b gy my mv l mw mx">   agent{</span><span id="fe1e" class="jv jw in mq b gy my mv l mw mx">      docker{</span><span id="3932" class="jv jw in mq b gy my mv l mw mx">         image 'ubuntu'</span><span id="e232" class="jv jw in mq b gy my mv l mw mx">      }</span><span id="c887" class="jv jw in mq b gy my mv l mw mx">   }</span><span id="924e" class="jv jw in mq b gy my mv l mw mx">}</span></pre><ul class=""><li id="7305" class="ls lt in kt b ku lm ky ln ke mb ki mc km md ll lx ly lz ma bi translated"><strong class="kt io">阶段</strong></li></ul><p id="bcbb" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">这个块有运行<strong class="kt io">管道</strong>所需的所有任务，这里我需要一个指定的工作流来像一个阶段一样运行管道。</p><p id="bae5" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">我可以定义许多阶段，每个阶段都有特定的任务。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="b486" class="jv jw in mq b gy mu mv l mw mx">pipeline{<br/>   agent any<br/>   stages{</span><span id="d2aa" class="jv jw in mq b gy my mv l mw mx">      stage ('build'){</span><span id="575c" class="jv jw in mq b gy my mv l mw mx">          steps{<br/>          ...<br/>       <br/>         }<br/>      <br/>      }<br/>   <br/>   }</span><span id="8706" class="jv jw in mq b gy my mv l mw mx">}</span></pre><ul class=""><li id="9fb7" class="ls lt in kt b ku lm ky ln ke mb ki mc km md ll lx ly lz ma bi translated"><strong class="kt io">阶段</strong></li></ul><p id="b427" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">步骤取决于<strong class="kt io">阶段</strong>，在这里我们可以定义阶段内的新阶段以及我们需要在该块内做什么。</p><ul class=""><li id="c08b" class="ls lt in kt b ku lm ky ln ke mb ki mc km md ll lx ly lz ma bi translated"><strong class="kt io">步骤</strong></li></ul><p id="7523" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">步骤是依赖于<strong class="kt io">阶段</strong>的，我们可以在一个<strong class="kt io">阶段</strong>中定义一系列步骤，当我们需要执行<strong class="kt io">阶段</strong>时<strong class="kt io">会执行</strong>这个<strong class="kt io">步骤</strong>在<strong class="kt io">序列</strong>中，步骤块中必须至少有一个步骤</p><p id="d504" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">为了更好地理解阶段和步骤，请看下面的例子</p><h2 id="3c0b" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">结论</h2><p id="7c26" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">在这篇文章中，我解释了 Jenkins 和什么是 Jenkins 和 Jenkins 文件中的管道，以及我如何编写它。</p><p id="0f72" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">Jenkins 在这里建立了依赖的<strong class="kt io"> CI/CD 概念</strong></p><p id="2c0e" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">你可以看看这篇文章了解什么是<a class="ae lr" href="https://medium.com/@abdalrhmanalkraien/ci-cd-concept-with-pipeline-3408d2fff38" rel="noopener">什么是 CI/CD 概念？</a>，而你可以看到这篇文章来了解<a class="ae lr" href="https://medium.com/@abdalrhmanalkraien/what-is-jenkins-bc8bebcc05cf" rel="noopener">詹金斯是什么？</a></p></div></div>    
</body>
</html>