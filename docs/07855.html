<html>
<head>
<title>What is Co-Variance</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是协变</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/understanding-maths-behind-covariance-and-implementation-using-numpy-6014811b44d4?source=collection_archive---------12-----------------------#2022-04-27">https://blog.devgenius.io/understanding-maths-behind-covariance-and-implementation-using-numpy-6014811b44d4?source=collection_archive---------12-----------------------#2022-04-27</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="5bcd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">协变是指两个随机变量之间的系统关系，其中另一个变量的变化反映了一个变量的变化。</p><p id="e7fd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">协方差值的范围从-∞到+∞，负值表示负相关，正值表示正相关。</p><p id="119c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这个数字越大，关系就越可靠。</p><h2 id="101e" class="ki kj in bd kk kl km dn kn ko kp dp kq jv kr ks kt jz ku kv kw kd kx ky kz la bi translated">让我们先看看有哪些应用:-</h2><ul class=""><li id="9a7e" class="lb lc in jm b jn ld jr le jv lf jz lg kd lh kh li lj lk ll bi translated">协方差矩阵有助于找到大多数数据点出现的方向，这也是 PCA 在降维中的目的。</li><li id="2d47" class="lb lc in jm b jn lm jr ln jv lo jz lp kd lq kh li lj lk ll bi translated">协方差在投资组合理论中用于确定投资组合中包含哪些资产。</li><li id="965a" class="lb lc in jm b jn lm jr ln jv lo jz lp kd lq kh li lj lk ll bi translated">它在生物学中用于计算遗传关系矩阵(GRM)</li><li id="d1ef" class="lb lc in jm b jn lm jr ln jv lo jz lp kd lq kh li lj lk ll bi translated">在信号处理中，它用于捕捉信号的频谱变化。</li></ul><h2 id="686d" class="ki kj in bd kk kl km dn kn ko kp dp kq jv kr ks kt jz ku kv kw kd kx ky kz la bi translated">协方差背后的数学</h2><p id="71cc" class="pw-post-body-paragraph jk jl in jm b jn ld jp jq jr le jt ju jv lr jx jy jz ls kb kc kd lt kf kg kh ig bi translated">在进入协方差公式之前。首先了解什么是方差公式。</p><p id="e9aa" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">差异如下所示:-</p><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/10a87fcfc7616feb53f4acb849c37f8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/format:webp/1*biHlxTh5EJ7zpBmhasQDjQ.png"/></div></figure><p id="a295" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，如果我们简化这个，</p><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/d50302137a8e4248db9242be96465f32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/format:webp/1*Err7CqeMoONGwFydGGiuaw.png"/></div></figure><p id="8c58" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这里对于秒 s(x)如果我们用 y 代替 x，</p><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div class="gh gi md"><img src="../Images/8cca40e61835fc172b3f5321220d2573.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*wzznRPVK7debAj_zOT6WlA.png"/></div></figure><p id="81e8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这个等式被称为协方差</p><pre class="lv lw lx ly gt me mf mg mh aw mi bi"><span id="c4e6" class="ki kj in mf b gy mj mk l ml mm">import numpy as np<br/>feature1 = np.random.rand(50)*10</span><span id="6694" class="ki kj in mf b gy mn mk l ml mm">feature2 = np.random.rand(50)*10</span></pre><h2 id="bf6e" class="ki kj in bd kk kl km dn kn ko kp dp kq jv kr ks kt jz ku kv kw kd kx ky kz la bi translated">1.线性增长关系</h2><p id="30c4" class="pw-post-body-paragraph jk jl in jm b jn ld jp jq jr le jt ju jv lr jx jy jz ls kb kc kd lt kf kg kh ig bi translated">如图，我们以特征 1 和特征 2 线性增加为例。橙色点代表 X-Y 平面中 f1 和 f2 特征的平均值。</p><pre class="lv lw lx ly gt me mf mg mh aw mi bi"><span id="f699" class="ki kj in mf b gy mj mk l ml mm">import matplotlib.pyplot as plt<br/><br/><br/>ascending_f1 = np.sort(feature1)<br/>ascending_f2 = np.sort(feature2)<br/><br/><br/>plt.scatter(ascending_f1,ascending_f2)<br/>plt.scatter([np.mean(ascending_f1)],[np.mean(ascending_f2)])<br/>plt.xlabel('Feature 1') ; plt.ylabel('Feature 2')<br/>plt.show()</span></pre><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div class="ab gu cl mo"><img src="../Images/fbf813e0bafc48eaee2e8572ab84540c.png" data-original-src="https://miro.medium.com/v2/format:webp/1*pqKFF7xqhCSh9Hz6yw2OWA.png"/></div></figure><p id="c6dc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">上述上升特征的协方差将在 numpy 中计算如下</p><pre class="lv lw lx ly gt me mf mg mh aw mi bi"><span id="e567" class="ki kj in mf b gy mj mk l ml mm">N = ascending_f1.shape[0]<br/>diff1 = ascending_f1 - np.mean(ascending_f1)<br/>diff2 = ascending_f2 - np.mean(ascending_f2)<br/>covariance = np.sum(diff1*diff2) / N-1<br/>print(covariance)</span><span id="0915" class="ki kj in mf b gy mn mk l ml mm">6.181944719813141</span></pre><p id="6936" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">理解工作数学:- </strong> <br/>现在，让我们来理解，为什么我们得到正值。<br/>为此，让我们考虑上图中的两点对(4，4)和(6，6)。平均值大致在(4.5，4.5)左右。</p><p id="f1fc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你可以在下图中看到它</p><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div class="ab gu cl mo"><img src="../Images/3f182974c32e6cd903f943b4fddc8d23.png" data-original-src="https://miro.medium.com/v2/format:webp/1*oGu96uacLUordC9dx45uMw.png"/></div></figure><p id="9a73" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">那么，当你对第一个(4，4)点求差时</p><ul class=""><li id="376a" class="lb lc in jm b jn jo jr js jv mp jz mq kd mr kh li lj lk ll bi translated">diff 1(4–4.5)它将是负的，因为 4 小于 x 轴上的平均值。</li><li id="3b9d" class="lb lc in jm b jn lm jr ln jv lo jz lp kd lq kh li lj lk ll bi translated">diff 2(4–4.5)也将是负的，因为 4 再次小于 y 轴上的平均值。</li></ul><p id="8853" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因此，结果乘积为(-ve) * (-ve) = (+ve)。</p><p id="6c6f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">同样，当我们寻找(6，6)并求差时</p><ul class=""><li id="24d1" class="lb lc in jm b jn jo jr js jv mp jz mq kd mr kh li lj lk ll bi translated">diff 1(6–4.5)将为正，因为 6 大于 x 轴上的平均值。</li><li id="657c" class="lb lc in jm b jn lm jr ln jv lo jz lp kd lq kh li lj lk ll bi translated">diff 2(6–4.5)也将是正的，因为 6 再次大于 y 轴上的平均值。</li></ul><p id="3f7b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因此，结果乘积将再次为(+ve) * (+ve) = (+ve)。</p><p id="a229" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因此，当存在线性增加的关系时，我们总是得到正号。</p><h2 id="530c" class="ki kj in bd kk kl km dn kn ko kp dp kq jv kr ks kt jz ku kv kw kd kx ky kz la bi translated">2.线性递减关系</h2><p id="46d9" class="pw-post-body-paragraph jk jl in jm b jn ld jp jq jr le jt ju jv lr jx jy jz ls kb kc kd lt kf kg kh ig bi translated">现在，让我们考虑当特征 1 增加时，特征 2 减少。</p><p id="6a33" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了更清楚，让我们考虑一个产品是 1 天前的，那么它的销售额是 10 美分，而 10 天前的产品的销售额是 2 美分。因此，产品的年龄和销售额之间存在线性递减关系。</p><pre class="lv lw lx ly gt me mf mg mh aw mi bi"><span id="5fb8" class="ki kj in mf b gy mj mk l ml mm">import matplotlib.pyplot as plt<br/><br/>ascending_f1 #Feature1#<br/>descending_f2 = ascending_f2[-1::-1] #Feature2#<br/><br/><br/>plt.scatter(ascending_f1,descending_f2)<br/>plt.scatter([np.mean(ascending_f1)],[np.mean(descending_f2)])<br/>plt.xlabel('Feature 1') ; plt.ylabel('Feature 2')<br/>plt.show()</span></pre><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div class="ab gu cl mo"><img src="../Images/179830ccd2ab8dd65a32093087497d83.png" data-original-src="https://miro.medium.com/v2/format:webp/1*TsMuAyCj5d0Ico-mqTkekw.png"/></div></figure><p id="a989" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">协方差的计算方法如下</p><pre class="lv lw lx ly gt me mf mg mh aw mi bi"><span id="d6b1" class="ki kj in mf b gy mj mk l ml mm">N = descending_f1.shape[0]<br/>diff1 = ascending_f1 - np.mean(ascending_f1)<br/>diff2 = descending_f2 - np.mean(descending_f2)<br/>covariance = np.sum(diff1*diff2) / N-1<br/>print(covariance)</span><span id="05c9" class="ki kj in mf b gy mn mk l ml mm">-8.102113499370311</span></pre><p id="b940" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">所以，这里你可以看到，我们得到了负值。因为，我们有线性递减关系。</p><p id="968a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们了解一下，符号是如何计算的:-</p><p id="3b57" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们考虑两个点(2，6)和(8，1 ),平均值大约位于(4，5)</p><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div class="ab gu cl mo"><img src="../Images/fe15eb7f8abb323de2d0ddb495a0861d.png" data-original-src="https://miro.medium.com/v2/format:webp/1*xWCpSaNXRZeufgzbBNjb3A.png"/></div></figure><p id="33ee" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因此，对于点(2，6)和(4，5)处的平均值</p><ul class=""><li id="ae4e" class="lb lc in jm b jn jo jr js jv mp jz mq kd mr kh li lj lk ll bi translated">diff1 将是(2–4)将是负数。</li><li id="5e5b" class="lb lc in jm b jn lm jr ln jv lo jz lp kd lq kh li lj lk ll bi translated">diff2 将是(6–5)将是正数。</li><li id="4a55" class="lb lc in jm b jn lm jr ln jv lo jz lp kd lq kh li lj lk ll bi translated">因此，diff1*diff2 将为负。表示为线性递减关系</li></ul><p id="e0e6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">点(8，1)和(4，5)处的平均值也是如此</p><ul class=""><li id="5ea8" class="lb lc in jm b jn jo jr js jv mp jz mq kd mr kh li lj lk ll bi translated">diff1 将是(8–4)将是正数。</li><li id="6919" class="lb lc in jm b jn lm jr ln jv lo jz lp kd lq kh li lj lk ll bi translated">diff2 将是(1–5)将是负数。</li><li id="82dd" class="lb lc in jm b jn lm jr ln jv lo jz lp kd lq kh li lj lk ll bi translated">因此，diff1*diff2 将为负。同样，表示为线性递减关系</li></ul><p id="1aff" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">总之，对于所有低于平均值的 x 点，diff 将为负，而对于所有低于平均值的 y 点，diff 将为正。导致消极的关系。</p><p id="f637" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">类似地，对于所有高于平均值的 x 点，diff 将为正，而对于所有高于平均值的 y 点，diff 将为负。导致消极的关系。</p><h2 id="d301" class="ki kj in bd kk kl km dn kn ko kp dp kq jv kr ks kt jz ku kv kw kd kx ky kz la bi translated">协变的问题:-</h2><ul class=""><li id="fda6" class="lb lc in jm b jn ld jr le jv lf jz lg kd lh kh li lj lk ll bi translated">当存在大量点簇且具有高偏斜度时，协方差不正确地确定关系。因为，存在偏态时，均值并不代表合适的值。例如在下图中，</li></ul><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div class="ab gu cl mo"><img src="../Images/f71bc910ec4b65672713dc8e75b901ab.png" data-original-src="https://miro.medium.com/v2/format:webp/1*nUJpmgvL5_qpdc5wFJ3QPg.png"/></div></figure><ul class=""><li id="23a9" class="lb lc in jm b jn jo jr js jv mp jz mq kd mr kh li lj lk ll bi translated">这可以通过使用关联技术来解决，这将在下一篇博客中讨论。</li></ul></div><div class="ab cl ms mt hr mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ig ih ii ij ik"><p id="c7d1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">谢谢你阅读我的故事😊</p></div></div>    
</body>
</html>