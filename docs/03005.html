<html>
<head>
<title>Maintainable JavaScript — Separate HTML and JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">可维护的 JavaScript——分离 HTML 和 JavaScript</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/maintainable-javascript-separate-html-and-javascript-e4dfd06438de?source=collection_archive---------9-----------------------#2020-09-19">https://blog.devgenius.io/maintainable-javascript-separate-html-and-javascript-e4dfd06438de?source=collection_archive---------9-----------------------#2020-09-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d2ea75a8c7f9cf30106a1d325e697b96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4HbwZ0Hdhkor7gue"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://unsplash.com/@davidrotimi?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">大卫·罗蒂米</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="9c0a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果想继续使用代码，创建可维护的 JavaScript 代码很重要。</p><p id="9221" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将通过查看 JavaScript 和 HTML 之间的松散耦合来了解创建可维护的 JavaScript 代码的基础。</p><h1 id="335c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">让 HTML 远离 JavaScript</h1><p id="445e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们应该把 HTML 代码放在 JavaScript 之外。</p><p id="c2e6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们的 JavaScript 代码中加入 HTML 使得当代码中有任何文本或结构问题时，应用程序很难调试。</p><p id="6b55" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">几乎不可能在我们的 JavaScript 代码中跟踪动态 HTML 的问题。</p><p id="4bc0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们不应该编写这样的代码:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="4f23" class="mn lc iq mj b gy mo mp l mq mr">const div = document.querySelector("div");<br/>div.innerHTML = "&lt;h3&gt;Error&lt;/h3&gt; &lt;p&gt;Invalid date.&lt;/p&gt;";</span></pre><p id="775d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们的 JavaScript 中嵌入 HTML 字符串是一种不好的做法。</p><p id="a6ae" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它使跟踪任何文本或结构问题变得复杂，</p><p id="c9c7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">很难通过我们浏览器的开发控制台中的 DOM inspector 来解决这个问题，因为它是动态更新的。</p><p id="6987" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，这比追踪简单的 DOM 操作问题更难。</p><p id="350c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第二个问题是可维护性。</p><p id="69a8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们需要改变文本或标记，我们必须改变 HTML 和 JavaScript 代码来改变文本。</p><p id="b1e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这比在 HTML 代码中改变它们要多得多。</p><p id="e636" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">JavaScript 中的标记不可更改。</p><p id="1b98" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是因为我们不希望在 JavaScript 代码中使用 HTML。</p><p id="e9c8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">编辑标记比编辑 JavaScript 更容易出错，因为标记是字符串形式的。</p><p id="8169" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以把 HTML 放在我们的 JavaScript 代码中，我们就把问题复杂化了。</p><p id="2d21" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有很多方法可以以松耦合的方式用 JavaScript 插入 HTML。</p><p id="314b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一种方法是使用一些模板系统，比如把手。</p><p id="706c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="135f" class="mn lc iq mj b gy mo mp l mq mr">&lt;script src="https://cdn.jsdelivr.net/npm/handlebars@latest/dist/handlebars.js"&gt;&lt;/script&gt;</span><span id="cbc7" class="mn lc iq mj b gy ms mp l mq mr">&lt;script&gt;<br/>  const template = Handlebars.compile("&lt;p&gt;{{firstname}} {{lastname}}&lt;/p&gt;");</span><span id="fd9e" class="mn lc iq mj b gy ms mp l mq mr">  console.log(template({<br/>    firstname: "james",<br/>    lastname: "smith"<br/>  }));</span><span id="7908" class="mn lc iq mj b gy ms mp l mq mr">&lt;/script&gt;</span></pre><p id="4a51" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们包含了 Handlebars 库，然后调用<code class="fe mt mu mv mj b">Handlebars.compile</code>返回一个<code class="fe mt mu mv mj b">template</code>函数，让我们在模板字符串中插入表达式。</p><p id="71c5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们想在把手上使用 HTML，我们添加一个特殊的脚本标签:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="1c34" class="mn lc iq mj b gy mo mp l mq mr">&lt;script src="https://cdn.jsdelivr.net/npm/handlebars@latest/dist/handlebars.js"&gt;&lt;/script&gt;</span><span id="5301" class="mn lc iq mj b gy ms mp l mq mr">&lt;script id="entry-template" type="text/x-handlebars-template"&gt;<br/>  &lt;div class="entry"&gt;<br/>    &lt;p&gt;{{firstname}} {{lastname}}&lt;/p&gt;<br/>  &lt;/div&gt;<br/>&lt;/script&gt;</span></pre><p id="535e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以添加下面的 JavaScript 将模板编译成 HTML:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="0779" class="mn lc iq mj b gy mo mp l mq mr">const source = $("#entry-template").html();<br/>const template = Handlebars.compile(source);<br/>const context = {<br/>  firstname: "james",<br/>  lastname: "smith"<br/>}<br/>const output = template(context);<br/>$("body").append(output);</span></pre><p id="f754" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">脚本标签具有<code class="fe mt mu mv mj b">text/x-handlebars-template</code>类型，以区别于 JavaScript 脚本标签。</p><p id="9b11" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们可以把<code class="fe mt mu mv mj b">template</code>编译成 HTML。</p><p id="9df4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">编译是通过用 jQuery 获取脚本来完成的。</p><p id="c131" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们调用<code class="fe mt mu mv mj b">Handlebars.compile</code>来编译源代码。</p><p id="4113" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">context</code>有我们想要在模板中插入的变量。</p><p id="9a38" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们用<code class="fe mt mu mv mj b">context</code>调用<code class="fe mt mu mv mj b">template</code>来编译数据。</p><p id="0f7a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们用编译好的模板调用<code class="fe mt mu mv mj b">append</code>。</p><p id="dbd8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">或者，我们可以使用像 Vue、React 或 Angular 这样的框架来构建我们的应用程序，这样我们就不必担心混合 HTML 和 JavaScript 是一种无组织的方式。</p><p id="d498" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">框架让我们以 JavaScript 和 HTML 之间松散耦合的方式编写代码。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/a412a6d2e3d99663b54584f5fb3cf654.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tVBSF6QF00b3Mmyz"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">西蒙·瑞在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="5692" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="c95c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们应该把 HTML 代码放在 JavaScript 代码之外。</p><p id="d939" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样，我们就不必担心跟踪难以调试的代码。</p><p id="67f8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用模板系统(比如把手)或者使用框架(比如 Angular、React 或 Vue)将它们分开。</p></div></div>    
</body>
</html>