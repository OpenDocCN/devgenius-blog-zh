<html>
<head>
<title>Ultimate way in setting up Nodemailer for Email Service</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为电子邮件服务设置节点邮件程序的终极方法</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/correct-way-in-setting-up-nodemailer-for-email-service-946f6bfd73e8?source=collection_archive---------9-----------------------#2021-12-27">https://blog.devgenius.io/correct-way-in-setting-up-nodemailer-for-email-service-946f6bfd73e8?source=collection_archive---------9-----------------------#2021-12-27</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="067c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">网上有很多关于设置nodemailer的教程，但是有些设置只适用于开发环境，而不适用于生产环境。因此，下面是为生产环境设置nodemailer的正确方法:</p><h1 id="5b58" class="ki kj in bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated"><strong class="ak">为节点邮件程序设置传送器:</strong></h1><p id="28f3" class="pw-post-body-paragraph jk jl in jm b jn lg jp jq jr lh jt ju jv li jx jy jz lj kb kc kd lk kf kg kh ig bi translated">为了使用nodemailer发送电子邮件，您必须首先创建一个transporter，所以在我的例子中，我在一个单独的文件中创建了transporter常量，然后每当我想发送电子邮件时就反复使用它。</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi ll"><img src="../Images/f46787880ba4ba2770121891786fd102.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BxQEhOO27a-BcOIlyVZ87Q.png"/></div></div></figure><p id="36eb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在transporter中有几个重要的东西，用来获取<strong class="jm io"> clientId </strong>、<strong class="jm io"> clientSecret、accessToken、</strong>和<strong class="jm io"> refreshToken的凭证。</strong></p><h1 id="6c1f" class="ki kj in bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">获取clientId和clientSecret</h1><p id="4220" class="pw-post-body-paragraph jk jl in jm b jn lg jp jq jr lh jt ju jv li jx jy jz lj kb kc kd lk kf kg kh ig bi translated">并且为了获得<strong class="jm io"> clientId </strong>和<strong class="jm io"> clientSecret </strong>，可以去Google cloud控制台。</p><p id="f1b8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">下面是一个简化版本:</p><ol class=""><li id="ffde" class="lx ly in jm b jn jo jr js jv lz jz ma kd mb kh mc md me mf bi translated">在谷歌云控制台中创建新应用。</li><li id="da62" class="lx ly in jm b jn mg jr mh jv mi jz mj kd mk kh mc md me mf bi translated">将<strong class="jm io"> Gmail API </strong>添加到您的应用程序中，然后点击管理</li></ol><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/2e26b733e1123e330fe8b2d79ed83b7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*QuIIpshQ6LXblRWN9GiGHA.png"/></div></figure><p id="f9f2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">3.之后，点击右侧的“信用”。</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/127951d97c60e8de679ff21d22b31b22.png" data-original-src="https://miro.medium.com/v2/resize:fit:390/format:webp/1*u3tQPHtC7CAMhOFpng_Oxw.png"/></div></figure><p id="a922" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">4.然后在创建凭据下，单击OAuth客户端Id</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/897d82bcce7e31c52b6bcfdc725caa3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*iQD-kek0uuHyIrtPj-Udwg.png"/></div></figure><p id="c52d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">5.填写OAuth凭证的信息，然后在</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/fa7e25043cecd61168f69675bf745b77.png" data-original-src="https://miro.medium.com/v2/resize:fit:642/format:webp/1*sND0QA8RTWbGh2z9fgWPBw.png"/></div></figure><p id="957b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">点击添加https://developers.google.com/oauthplayground，然后输入<a class="ae mp" href="https://developers.google.com/oauthplayground/" rel="noopener ugc nofollow" target="_blank"/></p><p id="634b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">6.最后会出现一个弹出窗口，显示<strong class="jm io"> clientId </strong>和<strong class="jm io"> clientSecret。</strong></p><h1 id="7fd1" class="ki kj in bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">获取秘密令牌和访问令牌</h1><p id="2042" class="pw-post-body-paragraph jk jl in jm b jn lg jp jq jr lh jt ju jv li jx jy jz lj kb kc kd lk kf kg kh ig bi translated">第一次访问，<a class="ae mp" href="https://developers.google.com/oauthplayground/" rel="noopener ugc nofollow" target="_blank">https://developers.google.com/oauthplayground/</a></p><p id="bd18" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">首先点击右上角的设置，</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/de98967e34c4db1b82051fc6ae3b874c.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/format:webp/1*jU48SogrM6t_9xSXrIW22w.png"/></div></figure><p id="35f6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">打勾使用您自己的OAuth凭证，您将从google cloud控制台获得该凭证。</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/14a384450118445b066095ebe6d9655c.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*KYDkFoNd0L6pj53MQu4GLw.png"/></div></figure><p id="4f11" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">对于步骤1，您可以键入<a class="ae mp" href="https://mail.google.com" rel="noopener ugc nofollow" target="_blank">https://mail.google.com</a>并点击授权API</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/c61b3e6e8caee6e4e954e88912c1f938.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*tOcbR6bcAqEZoOxoUXHkvw.png"/></div></figure><p id="60d2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">* <strong class="jm io">高级概念:</strong></p><p id="f923" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">对于像noreply@something.com这样的企业邮箱，如果你有主域名，你可以很容易地设置邮箱子域。但是，如果您正在使用客户的个人电子邮件地址为客户开发电子邮件功能，并且您无权访问他们的电子邮件地址凭据，您可以创建一个备用Gmail帐户，专门用于从您的应用程序发送电子邮件，并且您可以使用Gmail中的<strong class="jm io">以</strong>身份发送电子邮件功能。</p><p id="7fae" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">下面是我的意思的一个简化版本:你使用A的电子邮件帐户的目的只是向客户发送电子邮件，这意味着你不会将该电子邮件用于你的业务目的。我们的业务电子邮件是电子邮件B，但我们在这里想做的是，我们使用电子邮件A发送电子邮件，但客户看到的显示电子邮件将来自电子邮件B。</p><p id="8e59" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你可以在Gmail &gt;账户设置和导入中找到它，然后你会看到发送电子邮件部分。您可以在那里添加备选电子邮件地址。</p><p id="fb9b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">如何设置:</strong></p><ol class=""><li id="c8b5" class="lx ly in jm b jn jo jr js jv lz jz ma kd mb kh mc md me mf bi translated">在您单击“发送电子邮件为”部分中的“添加另一个电子邮件地址”后，将会出现一个弹出窗口。</li></ol><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/18511c5c0c10087ee0364f071f90f6c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*2vW_KCcMM-2zyYbrJhPSLA.png"/></div></figure><p id="654a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">对于名称部分，您可以输入您希望在发送电子邮件时显示的名称，而电子邮件地址部分是您希望客户端看到的另一封电子邮件的电子邮件地址。</p><p id="c9bb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">2.之后，它将发送一封验证电子邮件到您将显示为的电子邮件，然后您只需输入发送的验证码，该过程就完成了。</p><p id="1ee7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">3.最后一步是，你可以设置你想要发送的电子邮件为默认。</p><p id="7126" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在回到如何设置nodemailer凭证，在您拥有授权API并使用您将使用的google帐户登录之后</p><p id="81fd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在第二步中，点击下面的按钮，它将显示传输器的<strong class="jm io">访问令牌</strong>和<strong class="jm io">秘密令牌</strong>，记住还要检查自动刷新令牌。</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi mu"><img src="../Images/95d6a05c2b1f990eff38a8b407834f20.png" data-original-src="https://miro.medium.com/v2/resize:fit:602/format:webp/1*vbz8WeNHp05cckxzn5IXSg.png"/></div></div></figure><p id="d4a4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，为传输器设置凭证的工作已经完成。</p><p id="b096" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">之后，您可以通过导入传输器发送电子邮件，然后使用send email功能。请查看关于如何使用nodemailer发送电子邮件的文档。</p><p id="f03f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">但是整体设置已经完成。请注意，在一些教程视频中，您可能会看到他们使用电子邮件帐户和密码作为transporter中的凭据。但是根据我的经验，这在生产模式下是行不通的。所以最好用accessToken和secretToken代替。</p><p id="78ed" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">最后，感谢您到目前为止阅读本文，我希望这将有助于您很好地设置nodemailer。这个设置为我带来了几个youtube视频和发现，但上面设置的参考可以在这个youtube链接中找到:</p><figure class="lm ln lo lp gt lq"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="425b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我在使用nodemailer时遇到的另一个挑战是电子邮件模板的使用。我将在另一篇电子邮件文章中讨论这个问题。但目前就这些了，希望对你的发展之旅有所帮助。</p></div></div>    
</body>
</html>