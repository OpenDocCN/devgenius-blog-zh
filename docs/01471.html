<html>
<head>
<title>Explore Apple’s new Swift logging API for iOS 14</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">探索苹果iOS 14新的Swift日志API</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/explore-apples-new-swift-logging-api-for-ios-14-7542d045bb6?source=collection_archive---------5-----------------------#2020-07-04">https://blog.devgenius.io/explore-apples-new-swift-logging-api-for-ios-14-7542d045bb6?source=collection_archive---------5-----------------------#2020-07-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f2a1" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">了解如何使用WWDC 2020大会上推出的新API在您的iOS应用程序中记录事件和错误</h2></div><p id="066d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在WWDC 2020上，苹果推出了iOS 14的新Swift日志API。这篇文章总结了如何利用这个新的API来调试iOS应用程序中的行为。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lb"><img src="../Images/3c4dd022d4880ba6f6bbc7320fb7a504.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tM2DDx-MUUyRART0.jpg"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">我在听，告诉我更多关于这个新日志系统的事！</figcaption></figure><h1 id="7d3e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">基础</h1><p id="f81b" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">当谈到在iOS应用程序中记录消息时，首先想到的API可能是<code class="fe mp mq mr ms b">print</code>或<code class="fe mp mq mr ms b">NSLog</code>。或者也许你正在使用第三方库，如<code class="fe mp mq mr ms b">CocoaLumberjack</code>、<code class="fe mp mq mr ms b">Willow</code>或<code class="fe mp mq mr ms b">SwiftyBeaver</code>。</p><p id="e771" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，在iOS 10中，苹果推出了一个新的iOS标准，用于使用<code class="fe mp mq mr ms b">OSLog</code>记录信息，提供了一种高效的记录信息的方式。</p><p id="17ee" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在今年的WWDC 2020上，这个API变得——你可以说——更加迅捷。它提供了不同的日志级别、类别、持久性、格式化、高性能和隐私特性。值得去看看。</p><p id="7efb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们看一个例子。</p><pre class="lc ld le lf gt mt ms mu mv aw mw bi"><span id="edb9" class="mx lt iq ms b gy my mz l na nb">import os </span><span id="8fc2" class="mx lt iq ms b gy nc mz l na nb">let logger = Logger(subsystem: "com.tanaschita.funapp", category: "funnyanimals") <br/>let videoName = "The turtle" </span><span id="f2b4" class="mx lt iq ms b gy nc mz l na nb">logger.log("Starting video with title \(videoName, privacy: .public)")</span></pre><p id="2216" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mp mq mr ms b">subsystem</code>参数通常是应用程序的包标识符。<code class="fe mp mq mr ms b">category</code>参数可用于构建应用程序不同部分的日志。您可以记录符合<code class="fe mp mq mr ms b">CustomStringConvertable</code>的任何类型。</p><p id="2a9e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">运行应用程序时，日志输出会出现在Xcode的控制台中。连接设备后，您也可以使用Mac上“实用工具”文件夹中的Console.app。</p><h1 id="8657" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">日志记录级别</h1><p id="32fc" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">API提供了五个日志级别:</p><ul class=""><li id="7a02" class="nd ne iq kh b ki kj kl km ko nf ks ng kw nh la ni nj nk nl bi translated"><code class="fe mp mq mr ms b">Debug</code></li><li id="a685" class="nd ne iq kh b ki nm kl nn ko no ks np kw nq la ni nj nk nl bi translated"><code class="fe mp mq mr ms b">Info</code></li><li id="c87d" class="nd ne iq kh b ki nm kl nn ko no ks np kw nq la ni nj nk nl bi translated"><code class="fe mp mq mr ms b">Notice</code>(默认)</li><li id="2a35" class="nd ne iq kh b ki nm kl nn ko no ks np kw nq la ni nj nk nl bi translated"><code class="fe mp mq mr ms b">Error</code></li><li id="fcd4" class="nd ne iq kh b ki nm kl nn ko no ks np kw nq la ni nj nk nl bi translated"><code class="fe mp mq mr ms b">Fault</code></li></ul><p id="2423" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mp mq mr ms b">Logger</code>实例为这些级别提供了合适的方法，如<code class="fe mp mq mr ms b">debug</code>、<code class="fe mp mq mr ms b">info</code>等。例如，要记录应用程序中的API错误，您可以执行以下操作:</p><pre class="lc ld le lf gt mt ms mu mv aw mw bi"><span id="9702" class="mx lt iq ms b gy my mz l na nb">logger.error("Missing field \(field) in response from \(endpoint).")</span></pre><h1 id="576e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">坚持</h1><p id="08a5" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">日志被存档，以便以后从设备中检索。若要浏览设备上的持续信息，请将设备连接到Mac，并打开Mac上“实用工具”文件夹中预装的Console.app。</p><p id="0a0e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">执行后只能检索持久化的日志。日志消息是否持久取决于日志级别。<code class="fe mp mq mr ms b">Notice</code>、<code class="fe mp mq mr ms b">Error</code>和<code class="fe mp mq mr ms b">Fault</code>消息持续存在。</p><h1 id="161f" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">表演</h1><p id="0b97" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">根据苹果公司的说法，日志系统非常具有性能，所以你可以在你的应用程序中广泛使用它，而不会降低它的速度。与<code class="fe mp mq mr ms b">print</code>不同，日志消息没有完全转换成字符串表示。相反，编译器和日志库一起工作来产生日志消息的优化表示。</p><h1 id="2223" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">隐私</h1><p id="e4f4" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">默认情况下，日志中的非数字值被配置为私有，因此它们在消息中是隐藏的。这可以确保在发货后，日志不会显示任何个人信息。所以在使用时:</p><pre class="lc ld le lf gt mt ms mu mv aw mw bi"><span id="00f2" class="mx lt iq ms b gy my mz l na nb">logger.log("Logging in user with email \(emailAddress)")</span></pre><p id="1451" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上述语句将产生以下日志消息:</p><pre class="lc ld le lf gt mt ms mu mv aw mw bi"><span id="eb24" class="mx lt iq ms b gy my mz l na nb">Logging in user with email &lt;private&gt;</span></pre><p id="94e5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您记录的信息不应被隐藏，您必须将其显式标记为公开:</p><pre class="lc ld le lf gt mt ms mu mv aw mw bi"><span id="2061" class="mx lt iq ms b gy my mz l na nb">logger.log("Opening funny video \(videoId, privacy: .public)")</span></pre><h1 id="1a73" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结论</h1><p id="7f64" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">在将API与提到的第三方库进行比较时，我个人缺少的一点是从<code class="fe mp mq mr ms b">Logger</code>实例中检索所有消息的能力，例如能够直接在应用程序中显示日志。</p><p id="f18b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">尽管如此，新的API是一个有前途的、强大的日志解决方案。</p></div><div class="ab cl nr ns hu nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="ij ik il im in"><p id="b466" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="ny">最初发表于</em><a class="ae nz" href="https://tanaschita.com/posts/20200705-explore-apples-recommended-swift-logging-api-wwdc-2020/" rel="noopener ugc nofollow" target="_blank">T5【https://tanaschita.com】</a><em class="ny">。</em></p></div></div>    
</body>
</html>