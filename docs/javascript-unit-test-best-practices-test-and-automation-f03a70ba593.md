# JavaScript 单元测试最佳实践—测试和自动化

> 原文：<https://blog.devgenius.io/javascript-unit-test-best-practices-test-and-automation-f03a70ba593?source=collection_archive---------8----------------------->

![](img/37b300883de1784a68a1d9e0694cb24a.png)

[亚历山大·奈特](https://unsplash.com/@agkdesign?utm_source=medium&utm_medium=referral)在[号航天飞机](https://unsplash.com?utm_source=medium&utm_medium=referral)上拍摄的照片

单元测试对于检查我们的应用程序是如何工作的非常有用。

否则，我们以后会遇到各种问题。

在本文中，我们将研究在编写 JavaScript 单元测试时应该遵循的一些最佳实践。

# 在类似生产的环境中执行端到端测试

我们应该在类似生产的环境中运行我们的端到端测试，这样我们就知道我们的代码可能会在生产环境中工作。

我们可以用 Docker 创建一个孤立的环境——用一个命令编写。

它将创建一个文档化的环境，我们只需要一个命令。

我们也可以使用类似 AWS Local 的东西来存根 AWS 服务。

# 并行化测试执行

我们应该并行运行测试，这样我们就可以在更短的时间内运行更多的测试。

有像 Jest 和 Mocha 这样的测试框架的扩展，可以让我们并行运行测试。

由于我们应该保持测试彼此独立，我们应该能够轻松做到这一点。

我们可以用多个流程运行测试，以大大加快反馈时间。

# 远离法律问题

我们应该检查许可证，这样我们就不会违反它们。

否则，如果有人抓住我们，我们就会遇到麻烦。

不看许可证就很容易不小心使用东西。

我们可以使用许可证检查包来检查我们的代码。

要安装它，我们运行:

```
npm install -g license-checker
```

然后，我们通过运行以下命令来检查依赖项的许可证:

```
license-checker --summary --failOn BSD
```

# 检查是否存在易受攻击的依赖项

我们应该检查易受攻击的依赖项，这样攻击者就不能攻击我们的应用程序。

为此，我们运行`npm audit`或使用 snyk 自动检查易受攻击的依赖项。

# 自动进行依赖项更新

我们可以自动更新我们的依赖关系，这样我们就不必自己做任何事情。

像 ncu 这样的工具让我们可以自动管理依赖关系。

还有`npm outdated`来检查过时的依赖关系。

我们可以在我们的配置项中运行它来停止和构建已经过时的依赖项。

此外，我们可以检查每个拉请求的更新依赖性。

# 本地码头工人支持

Docker 使 devops 更容易，所以我们可以用它来部署和运行我们的应用程序。

# 提前失败

我们应该先运行我们最快的测试，这样我们就可以快速检查我们的应用程序。

如果有任何失败，它会提前发生。

# 检查生成工件

构建工件，如测试和覆盖报告、日志等。应该很容易找到，这样我们就不用浪费时间去找他们了。

# 创建多个管道

管道对自动化我们的工作很有用。

我们可以为功能分支提交配置一个作业，为主 PR 配置不同的作业。

但是我们可以重用它们之间的逻辑，这样我们就不必两次做同样的工作。

# 没有秘密

我们的工作中不应该有秘密。

它们应该从作业配置的机密存储中检索。

# 发布版本中的缓冲版本

发布版本中的版本应该被删除，这样我们才能区分它们。

![](img/f2158aa5570fb55f42d98b58eff10270.png)

[列宁·埃斯特拉达](https://unsplash.com/@lenin33?utm_source=medium&utm_medium=referral)在[号航天飞机](https://unsplash.com?utm_source=medium&utm_medium=referral)上的照片

# 结论

我们还可以自动化其他事情，以减少工作量。