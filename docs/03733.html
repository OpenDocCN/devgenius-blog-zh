<html>
<head>
<title>Vuelidate — More Complex Custom Validators</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">vue lidate——更复杂的定制验证器</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/vuelidate-more-complex-custom-validators-2f55b20c9a28?source=collection_archive---------1-----------------------#2020-12-09">https://blog.devgenius.io/vuelidate-more-complex-custom-validators-2f55b20c9a28?source=collection_archive---------1-----------------------#2020-12-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/69f756cecb4bfa9ae53ab7cf64c8d5c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_5tpDlm_p2zo1481"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">由<a class="ae kc" href="https://unsplash.com/@motoculturel?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Motoculturel </a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="be5d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">默认情况下，Vue.js 没有任何表单验证功能。</p><p id="2094" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们需要添加自己的表单验证库或自己的代码。</p><p id="6ce0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看如何用 Vuelidate 创建定制的验证器。</p><h1 id="ec73" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">访问组件</h1><p id="5914" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用 Vuelidate 访问整个组件的模型。</p><p id="bfd8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="60a7" class="mn lc iq mj b gy mo mp l mq mr">&lt;template&gt;<br/>  &lt;div id="app"&gt;<br/>    &lt;div&gt;<br/>      &lt;label&gt;name&lt;/label&gt;<br/>      &lt;input v-model.trim="$v.name.$model"&gt;<br/>      &lt;div v-if="!$v.name.mustBeCool"&gt;name is invalid.&lt;/div&gt;<br/>    &lt;/div&gt;</span><span id="fa49" class="mn lc iq mj b gy ms mp l mq mr">&lt;div&gt;<br/>      &lt;label&gt;field&lt;/label&gt;<br/>      &lt;input v-model.trim="$v.field.$model"&gt;<br/>    &lt;/div&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;<br/>&lt;script&gt;<br/>import { helpers } from "vuelidate/lib/validators";</span><span id="592a" class="mn lc iq mj b gy ms mp l mq mr">const contains = param =&gt;<br/>  helpers.withParams(<br/>    { type: "contains", value: param },<br/>    (value, vm) =&gt; !helpers.req(value) || vm[param.field].includes(param.text)<br/>  );<br/>export default {<br/>  name: "App",<br/>  data() {<br/>    return {<br/>      name: "",<br/>      field: ""<br/>    };<br/>  },<br/>  validations: {<br/>    name: {<br/>      mustBeCool: contains({ text: "cool", field: "field" })<br/>    },<br/>    field: {}<br/>  }<br/>};<br/>&lt;/script&gt;</span></pre><p id="7852" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">添加一个验证器来检查<code class="fe mt mu mv mj b">field</code>字段中是否有单词<code class="fe mt mu mv mj b">'cool'</code>。</p><p id="155d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果是的话，那么如果<code class="fe mt mu mv mj b">field</code>字段中包含单词<code class="fe mt mu mv mj b">'cool'</code>，那么使用<code class="fe mt mu mv mj b">contains</code>验证器的字段就是有效的。</p><p id="05d4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">vm</code>有组件的视图模型，有状态。</p><h1 id="7a6e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">基于正则表达式的验证程序</h1><p id="a7b9" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以添加基于正则表达式的验证。</p><p id="d1cc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="8313" class="mn lc iq mj b gy mo mp l mq mr">&lt;template&gt;<br/>  &lt;div id="app"&gt;<br/>    &lt;div&gt;<br/>      &lt;label&gt;name&lt;/label&gt;<br/>      &lt;input v-model.trim="$v.name.$model"&gt;<br/>      &lt;div v-if="!$v.name.alpha"&gt;name is invalid.&lt;/div&gt;<br/>    &lt;/div&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;<br/>&lt;script&gt;<br/>import { helpers } from "vuelidate/lib/validators";</span><span id="b791" class="mn lc iq mj b gy ms mp l mq mr">const alpha = helpers.regex("alpha", /^[a-zA-Z]*$/);</span><span id="0e58" class="mn lc iq mj b gy ms mp l mq mr">export default {<br/>  name: "App",<br/>  data() {<br/>    return {<br/>      name: ""<br/>    };<br/>  },<br/>  validations: {<br/>    name: {<br/>      alpha<br/>    }<br/>  }<br/>};<br/>&lt;/script&gt;</span></pre><p id="a42c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们添加了<code class="fe mt mu mv mj b">alpha</code>验证器来检查输入的值是否都是字母。</p><h1 id="c954" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">基于定位器的验证器</h1><p id="fcd1" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">此外，我们可以使用定位器策略进行验证。</p><p id="706d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="ec90" class="mn lc iq mj b gy mo mp l mq mr">&lt;template&gt;<br/>  &lt;div id="app"&gt;<br/>    &lt;div&gt;<br/>      &lt;label&gt;name&lt;/label&gt;<br/>      &lt;input v-model.trim="$v.password.$model"&gt;<br/>    &lt;/div&gt;</span><span id="842d" class="mn lc iq mj b gy ms mp l mq mr">    &lt;div&gt;<br/>      &lt;label&gt;confirm password&lt;/label&gt;<br/>      &lt;input v-model.trim="$v.confirmPassword.$model"&gt;<br/>      &lt;div v-if="!$v.confirmPassword.same"&gt;confirm pasword must be the same as password.&lt;/div&gt;<br/>    &lt;/div&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;<br/>&lt;script&gt;<br/>import { helpers } from "vuelidate/lib/validators";</span><span id="7b2b" class="mn lc iq mj b gy ms mp l mq mr">const sameAs = equalTo =&gt;<br/>  helpers.withParams({ type: "sameAs", eq: equalTo }, function(<br/>    value,<br/>    parentVm<br/>  ) {<br/>    return value === helpers.ref(equalTo, this, parentVm);<br/>  });</span><span id="a778" class="mn lc iq mj b gy ms mp l mq mr">export default {<br/>  name: "App",<br/>  data() {<br/>    return {<br/>      password: "",<br/>      confirmPassword: ""<br/>    };<br/>  },<br/>  validations: {<br/>    password: {},<br/>    confirmPassword: {<br/>      same: sameAs("password")<br/>    }<br/>  }<br/>};<br/>&lt;/script&gt;</span></pre><p id="6ae5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">helper.ref</code>方法使用<code class="fe mt mu mv mj b">equalTo</code>参数检查两个字段是否相等。</p><p id="d6b0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">equalTo</code>参数具有要检查的字段名，以确定它是否与该字段相同。</p><p id="15dc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以<code class="fe mt mu mv mj b">equalTo</code>应该是<code class="fe mt mu mv mj b">'password'</code>，因为我们想检查它是否与<code class="fe mt mu mv mj b">'password'</code>相同。</p><p id="ada9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们返回条件来比较另一个字段的值是否与我们输入给定字段的值相同。</p><h1 id="e22b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="fe80" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用 Vuelidate 的各种策略创建我们自己的定制验证器。</p></div></div>    
</body>
</html>