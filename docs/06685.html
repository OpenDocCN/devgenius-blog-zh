<html>
<head>
<title>Formatting, Linting, and Documenting with Rust</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Rust 格式化、林挺和记录</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/formatting-linting-and-documenting-with-rust-eb7b189ade65?source=collection_archive---------6-----------------------#2022-01-25">https://blog.devgenius.io/formatting-linting-and-documenting-with-rust-eb7b189ade65?source=collection_archive---------6-----------------------#2022-01-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="acbe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">本文将简要概述 Rust 的格式化、内衬和文档化过程。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/c33a82110930259cf6b52525c4193abf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BjwwC3o0T7ks1oV6VqlWbQ.jpeg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">Missy，在看了一些没有文档也没有应用格式或 linter 的代码之后。</figcaption></figure><p id="5b45" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我最喜欢的一句与软件工程相关的名言是:</p><blockquote class="lb"><p id="3777" class="lc ld iq bd le lf lg lh li lj lk kk dk translated"><strong class="ak">编写代码时，要始终把最终维护你代码的人当成一个知道你住哪儿的暴力精神病患者。</strong>(出自约翰·伍兹)</p></blockquote><p id="c1ce" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">编写清晰易懂的代码应该是任何软件工程师/开发人员的首要目标。</p><p id="c6e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">格式化程序、linter 和文档生成器是一些工具，如果正确和持续地使用，它们可以帮助我们创建干净和可维护的代码。</p><p id="b718" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，继上周的文章《我为什么爱上 Rust》(这里是<a class="ae lq" href="https://anismousse.medium.com/why-you-should-learn-rust-fa52d0139b85" rel="noopener">这里是</a>)之后，这篇文章将旨在回顾 Rust 中有助于生成干净代码的不同工具。</p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h2 id="67d6" class="ly lz iq bd ma mb mc dn md me mf dp mg jy mh mi mj kc mk ml mm kg mn mo mp mq bi translated">Rust 中的格式</h2><p id="0291" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated">格式化程序是一种工具，旨在根据所使用的编程语言的样式准则来固定源代码的样式。</p><p id="172c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> Rustfmt </strong>不要与模块<strong class="jp ir">STD::fmt(</strong><a class="ae lq" href="https://doc.rust-lang.org/std/fmt/" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">doc</strong></a><strong class="jp ir">)，</strong>是 Rust 代码格式化程序，可通过<code class="fe mw mx my mz b">rustfmt.toml</code> <em class="na">或</em> <code class="fe mw mx my mz b">.rustfmt.toml</code>完全配置。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nb nc l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">Rust 代码格式不正确的示例</figcaption></figure><p id="977f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以通过运行命令<code class="fe mw mx my mz b"><strong class="jp ir">cargo fmt</strong></code>将<strong class="jp ir"> Rustfmt </strong>应用到这段代码中。该命令将重新格式化我们项目中的源代码，这将导致我们的示例产生以下结果:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="daae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你使用的是最新版本的 Rust，<strong class="jp ir"> Rustfmt </strong>应该已经安装了。如果不是这样，您可以在此找到所有安装细节和更多<a class="ae lq" href="https://github.com/rust-lang/rustfmt" rel="noopener ugc nofollow" target="_blank">。</a></p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h2 id="ac09" class="ly lz iq bd ma mb mc dn md me mf dp mg jy mh mi mj kc mk ml mm kg mn mo mp mq bi translated">生锈的林挺</h2><p id="71df" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated">Linter 旨在分析应用于的任何代码，捕捉潜在的错误，建议最佳实践，并优化现有的解决方案。</p><p id="4628" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">虽然 Rust compiler (cargo)已经非常严格，但 Rust 的 linter 旨在识别和呈现任何可能的坏的或非最佳的实践。</p><p id="cfc9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Rust 的最新版本默认预装了<strong class="jp ir"> Clippy </strong>，但是快速浏览一下<strong class="jp ir">Clippy</strong>GitHub pages<a class="ae lq" href="https://github.com/rust-lang/rust-clippy" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">这里的</strong> </a>会让你很好地了解如何安装和配置它。</p><p id="9e4f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面的 rust 代码是可编译和可执行的，但是包含一些次优的实践。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nb nc l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">次优的可编译和可运行的 rust 代码示例</figcaption></figure><p id="a23f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过命令<code class="fe mw mx my mz b"><strong class="jp ir">cargo clippy</strong></code>在这个代码示例上运行 Clippy 将生成以下警告:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nd"><img src="../Images/73c817b23a6293876ec883097c7f2be2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HB9_yGG75phkKuWoEZpbiw.png"/></div></div></figure><p id="7925" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如你所见，<strong class="jp ir"> Clippy </strong>已经在我们的代码示例中发现了一个次优的实践，并为我们提供了一个更好的选择。</p><p id="05d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这再次很好地说明了 Rust 的一个强大特性，即能够帮助您准确识别任何潜在问题或次优实践，并提供最佳替代方案。</p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h2 id="44f3" class="ly lz iq bd ma mb mc dn md me mf dp mg jy mh mi mj kc mk ml mm kg mn mo mp mq bi translated">Rust 文档</h2><p id="8c35" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated">文档旨在解释项目的特性，告知我们如何使用它们，并帮助我们理解其功能，同时允许 defacto 降低入职成本。</p><p id="5ca5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，项目文档是任何软件开发过程的重要部分。</p><p id="6c2b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Rustdoc 是 Rust 项目的标准文档生成工具。可以通过以下命令生成并打开文档:<code class="fe mw mx my mz b"><strong class="jp ir">cargo doc --open</strong></code></p><p id="157a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是 Rustdoc 如何知道将源代码的哪一部分添加到文档中呢？在这里评论一下<strong class="jp ir">文件评论</strong>拯救。</p><p id="d801" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建文档注释的主要方法是在行首使用三个<em class="na">斜线(<code class="fe mw mx my mz b">///</code>)。需要注意的是，该文档注释仅在项目出现时有效；这些是内部文档注释。</em></p><p id="3c42" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您还可以通过开始一行<code class="fe mw mx my mz b">//!</code>来创建文档注释，使文档注释适用于注释的父项，而不是后面的项。</p><p id="98c1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是一个 rust 代码源代码的例子，带有一些文档注释和 Rustdoc 生成的相关文档。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nb nc l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">带有一些文档注释的 rust 代码</figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ne"><img src="../Images/69930cc84a3d75dc073436824b1b3562.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mU8prDUEHGMS3-s3SdCqJw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">rustdoc 制作的文档</figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nf"><img src="../Images/024a929b7094dd33d8f2df61e2f72cee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ukj0EJMLfRTejo4_rIlS9w.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">rustdoc 制作的文档</figcaption></figure><p id="f449" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">rust 文档注释还有更多的内容，比如集成一些示例代码，这可能会有所帮助。文档中的那些源代码示例可以在 rust 项目上运行我们的测试时进行测试(我们将在以后的文章中讨论 Rust 中的测试，因为我仍在探索它)。</p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h2 id="3172" class="ly lz iq bd ma mb mc dn md me mf dp mg jy mh mi mj kc mk ml mm kg mn mo mp mq bi translated">结论</h2><p id="91eb" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated">正如我们刚刚看到的，Rust 有多种工具可以帮助您生成最佳和干净的代码。更好的是，您可以通过利用<strong class="jp ir"> Git 预提交钩子</strong>中的所有工具来简化您的过程，以确保您将要上传以供审查/接受的任何代码都将应用最少量的检查和平衡。</p><p id="b8c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下周，我打算转移一下 Rust 的话题，谈谈科技领域的年龄歧视问题。</p><p id="401b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">自从几周前我分享了下面的推文，以及到这个周末我将长大一岁的事实后，我对这个话题有了很多想法:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ng nc l"/></div></figure><p id="2e63" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在那，有一个伟大的一周！！鼓掌，评论，跟着都是欢迎的！！</p><p id="7a0e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">附加资源</strong></p><p id="0df3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Git 预提交钩子:模式细节<a class="ae lq" href="https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks" rel="noopener ugc nofollow" target="_blank">在这里</a>。</p><p id="1fa3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Rust 文档:更多细节<a class="ae lq" href="https://doc.rust-lang.org/rustdoc/how-to-write-documentation.html" rel="noopener ugc nofollow" target="_blank">在这里</a>。</p></div></div>    
</body>
</html>