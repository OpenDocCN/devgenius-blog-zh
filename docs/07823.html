<html>
<head>
<title>Creating a DynamoDB, scanning from an EC2.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建一个 DynamoDB，从 EC2 扫描。</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/creating-a-dynamodb-scanning-from-an-ec2-4e63ebb13a0?source=collection_archive---------13-----------------------#2022-04-25">https://blog.devgenius.io/creating-a-dynamodb-scanning-from-an-ec2-4e63ebb13a0?source=collection_archive---------13-----------------------#2022-04-25</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><figure class="gm go jp jq jr js gi gj paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="gi gj jo"><img src="../Images/7e9b36de1918c4491c8b582964f2668f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uczX_Q-LX2FOUzsI5v3kJw.png"/></div></div></figure><p id="6ec7" class="pw-post-body-paragraph jz ka ir kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">在今天的冒险中，我们将创建一个 DynamoDB，用一些有趣的数据填充它，创建一个允许 EC2 实例从 DB 获取数据的角色，然后启动一个 EC2 实例来完成这个任务。使用最小特权原则，这个 EC2 实例应该只能从数据库中读取。</p><h1 id="9578" class="kx ky ir bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">这些是我们正在使用的工具</h1><p id="66ca" class="pw-post-body-paragraph jz ka ir kb b kc lv ke kf kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ik bi translated">在这个练习中，我们将使用 AWS 中的以下工具:<br/>-dynamo db<br/>-IAM<br/>-EC2<br/>基本项目允许我们使用 AWS 控制台，如此温暖和 GUI 的感觉！</p><h1 id="f421" class="kx ky ir bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">这是你需要知道/使用的</h1><ul class=""><li id="caea" class="ma mb ir kb b kc lv kg lw kk mc ko md ks me kw mf mg mh mi bi translated">具有管理和控制台访问权限的 AWS IAM 帐户。</li><li id="8d7c" class="ma mb ir kb b kc mj kg mk kk ml ko mm ks mn kw mf mg mh mi bi translated">一些有趣的数据来填充你的数据库</li></ul><h1 id="1f06" class="kx ky ir bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">第一步:创建一个 DynamoDB</h1><figure class="mp mq mr ms gu js gi gj paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="gi gj mo"><img src="../Images/8153cb3ded85d3b449201e716a85dc87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qXOD3L03puL2kHbZZB2sgg.png"/></div></div><figcaption class="mt mu gk gi gj mv mw bd b be z dk translated">砸碎那个按钮！</figcaption></figure><p id="3a3d" class="pw-post-body-paragraph jz ka ir kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">非常简单，我们将命名它，然后创建主分区键。这基本上是允许数据库确定唯一记录的主要信息。<br/>我们将继续，其余的保持默认设置。滚动到底部，点击“创建”。</p><figure class="mp mq mr ms gu js gi gj paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="gi gj mx"><img src="../Images/c79e2bc453b79bbfe901de663ad0525d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zrli2jC3vrjGB4--sUu0qQ.png"/></div></div></figure><h1 id="001b" class="kx ky ir bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">第二步:添加项目</h1><p id="bec1" class="pw-post-body-paragraph jz ka ir kb b kc lv ke kf kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ik bi translated">现在，我的控制台通过我回到 DynamoDB 仪表板，但我们要导航到侧边栏“表格”标题下的“探索项目”。这将显示您所有的表。数据库创建完成后(这可能需要一两分钟)，单击名称进入此屏幕:</p><figure class="mp mq mr ms gu js gi gj paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="gi gj my"><img src="../Images/160124478ad21d0e0fcb78115d07ec05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KsS2whYRCT-lplyhAJ_AWA.png"/></div></div></figure><p id="1ca3" class="pw-post-body-paragraph jz ka ir kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">在这里，我们将多次循环这个过程，以便在表中创建至少 10 个条目。</p><figure class="mp mq mr ms gu js gi gj paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="gi gj mz"><img src="../Images/e8e2c10bea317c595e14bbd21a12a187.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j2qcRuiUaJZz17SLtiJu4Q.png"/></div></div><figcaption class="mt mu gk gi gj mv mw bd b be z dk translated">为了好玩，我为每个条目添加了一个额外的属性。</figcaption></figure><figure class="mp mq mr ms gu js gi gj paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="gi gj na"><img src="../Images/1a4b248d18e4b496de21def1daf8acfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5fnW_Lowh3t54htJXx9iIw.png"/></div></div><figcaption class="mt mu gk gi gj mv mw bd b be z dk translated">现在再做 9 次！:)</figcaption></figure><p id="e218" class="pw-post-body-paragraph jz ka ir kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">万岁。我们现在有一个数据库，里面有一些数据！继续下一个！</p><h1 id="d6bf" class="kx ky ir bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">第三步:创建一个 t.2 micro EC2 实例</h1><p id="104f" class="pw-post-body-paragraph jz ka ir kb b kc lv ke kf kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ik bi translated">我不会截图，因为到处都有“启动实例”按钮。</p><p id="aede" class="pw-post-body-paragraph jz ka ir kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">在这一点上，创建一个实例应该是非常过时的，因为我仍然在自由层，这些选项中的大部分都是默认的，但是这样您就可以跟着做了:</p><p id="c660" class="pw-post-body-paragraph jz ka ir kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">— AMI: Amazon Linux 2 AMI (HVM) <br/> —实例:t2.micro <br/> —密钥对:在没有密钥对的情况下继续进行<br/> —网络:允许来自“任何地方”的 SSH 流量</p><p id="2300" class="pw-post-body-paragraph jz ka ir kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">发射那只小狗！</p><p id="494e" class="pw-post-body-paragraph jz ka ir kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">注意:对于这一步和下一步，我们可以完全交换顺序，并在实例的创建中使用新的 IAM 角色，但是我们将按此顺序进行，以便我们可以观察如何向已经运行的实例添加角色！</p><h1 id="bc8e" class="kx ky ir bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">第四步:使用 IAM 创建角色，授予 EC2 对数据库的访问权限</h1><figure class="mp mq mr ms gu js gi gj paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="gi gj nb"><img src="../Images/101a705684c43cc62566fe78fc5b2786.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3zrjYBYdOPVOx1hsjwxaHw.png"/></div></div><figcaption class="mt mu gk gi gj mv mw bd b be z dk translated">启动向导</figcaption></figure><figure class="mp mq mr ms gu js gi gj paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="gi gj nc"><img src="../Images/b47094a779582ea1b77b6c8b187b5ca0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*83_41acu-KsuIKAd1V9vcw.png"/></div></div><figcaption class="mt mu gk gi gj mv mw bd b be z dk translated">鉴于这是服务的角色，即 EC2，我们选择这些选项让 AWS 控制台为我们做一些繁重的工作。</figcaption></figure><figure class="mp mq mr ms gu js gi gj paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="gi gj nd"><img src="../Images/1107f7b5e0518bf134a6cff3d2ced69d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n1pGNQkB2ncDM7sybFDmQw.png"/></div></div><figcaption class="mt mu gk gi gj mv mw bd b be z dk translated">这里，我们正在搜索预构建的“AWS 托管”权限，以便让我们的角色读取我们的数据。牢记最低特权原则，我们寻找“只读”</figcaption></figure><p id="0e2b" class="pw-post-body-paragraph jz ka ir kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">下一个屏幕我们只需给它一个名称，滚动到底部，然后单击“下一步”。</p><h1 id="80c9" class="kx ky ir bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">步骤 4.5:我们将返回，并将该角色添加到我们的实例中。</h1><p id="8d96" class="pw-post-body-paragraph jz ka ir kb b kc lv ke kf kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ik bi translated">跳回到 EC2 仪表板，并选择您的实例。从“操作”菜单中，我们可以找到“安全性”&gt;“修改 IAM 角色”。</p><figure class="mp mq mr ms gu js gi gj paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="gi gj ne"><img src="../Images/1a885af427d72a6f040e9018e411db4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vb2bCKQU1hWjEezrmq3oLg.png"/></div></div></figure><figure class="mp mq mr ms gu js gi gj paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="gi gj nf"><img src="../Images/142e05741049af1a3b891e481bbba759.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_mtdRg0QmdsFVDQe30CC7w.png"/></div></div></figure><p id="5ef7" class="pw-post-body-paragraph jz ka ir kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">现在，您的 EC2 实例能够从数据库中读取数据了！我们最后的几个步骤基本上只是验证:</p><h1 id="5ea6" class="kx ky ir bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">第五步:在 EC2 实例中使用 AWS CLI 扫描数据库</h1><p id="baee" class="pw-post-body-paragraph jz ka ir kb b kc lv ke kf kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ik bi translated">通过您最喜欢的方法跳转到您的实例(我使用了控制台内置的“连接到实例”页面)，我们将运行以下代码:</p><p id="eb8a" class="pw-post-body-paragraph jz ka ir kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated"><code class="fe ng nh ni nj b">aws dynamodb scan --table-name halo_games_simple --region us-east-2</code></p><p id="51c5" class="pw-post-body-paragraph jz ka ir kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">还有成功！我们看到来自 DynamoDB 的项目整齐地列在我们的终端上！</p><figure class="mp mq mr ms gu js gi gj paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="gi gj nk"><img src="../Images/608033ef68ce57c75e8eae4b28db430b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5G0GFt_BA8WOsIrOcmR4cQ.png"/></div></div><figcaption class="mt mu gk gi gj mv mw bd b be z dk translated">我是个光晕呆子。#无地理</figcaption></figure><h1 id="83b8" class="kx ky ir bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">第六步:在 EC2 实例中使用 AWS CLI 验证我们不能写入数据库</h1><p id="f428" class="pw-post-body-paragraph jz ka ir kb b kc lv ke kf kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ik bi translated">最后一个测试，让我们确保我们的策略能达到我们的目的！我将尝试在数据库中放置一个新项目:</p><p id="f17d" class="pw-post-body-paragraph jz ka ir kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated"><code class="fe ng nh ni nj b">aws dynamodb put-item --table-name halo_games_simple --region us-east-2 --item "{\"Game\":{\"S\":\"Halo: New Game\"},\"Console\":{\"S\":\"Xbox Series X\"}, \"Release Date\":{\"N\":\"2034\"}}"</code></p><figure class="mp mq mr ms gu js gi gj paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="gi gj nl"><img src="../Images/ea4eba43e894f9779b5cf9198dcadb48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MSnMka3mD6icLrVem0V89Q.png"/></div></div><figcaption class="mt mu gk gi gj mv mw bd b be z dk translated">哦。拒绝！</figcaption></figure><p id="8532" class="pw-post-body-paragraph jz ka ir kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">但是，嘿，这正是我们想要看到的！我们的 EC2 实例可以获得它需要的数据，但是不能在我们不需要的时候进行写操作！</p><h1 id="017b" class="kx ky ir bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">结论</strong></h1><p id="5b74" class="pw-post-body-paragraph jz ka ir kb b kc lv ke kf kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ik bi translated">所以你有它，保持东西的安全，但允许一些非常重要的服务进行通信！虽然我们主要是在 AWS 控制台中完成的，但我希望发布我对这个项目的演练，但完全是通过 AWS CLI 完成的。快来这里找吧！</p><p id="9c24" class="pw-post-body-paragraph jz ka ir kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">一如既往的感谢你坚持到最后！我希望你学会了一个新的技巧，或者至少喜欢看我学一些。感谢阅读！下次见！</p></div></div>    
</body>
</html>