<html>
<head>
<title>Building a live clock wallpaper using Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Node.js构建实时时钟壁纸</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/building-a-live-clock-wallpaper-using-node-js-273d898e3e26?source=collection_archive---------2-----------------------#2020-09-09">https://blog.devgenius.io/building-a-live-clock-wallpaper-using-node-js-273d898e3e26?source=collection_archive---------2-----------------------#2020-09-09</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/a7ad08a2292baec6a8ded4e50ce0a11f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_nWLWtF-xa85WNzZ3v2UPg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">Node.js内置的动态壁纸时钟</figcaption></figure><p id="581d" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">还记得那些大家曾经爱不释手的Windows 7小工具吗？就我自己来说，我对他们只有美好的回忆。那时候，它让你觉得你可以让你的桌面个性化。👨‍🎨</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div class="gh gi kx"><img src="../Images/81af32161e34cd3728bfc8bd7d082b70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*22XV7cmSlTt19RfRnvopDg.jpeg"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">Windows 7小工具</figcaption></figure><p id="507e" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">但是，让我们正确地看看我过去喜欢的浮动时钟(但不超过CPU仪表)。以今天的标准和功能来看，它并不是最漂亮的，让它浮在桌面图标上的特性并没有提供太多的价值。一个设计良好的壁纸时钟有可能在这两个方面击败Win 7小工具时钟。</p><p id="cd6b" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在我的工具箱里有Node.js，Javascript服务器端运行时。现在是一个成熟的发电站，可以解决你能想象的大多数编程任务。</p><p id="fa9d" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">为了创建动态壁纸，我们需要解决三个问题:</p><ol class=""><li id="be52" class="lc ld in kb b kc kd kg kh kk le ko lf ks lg kw lh li lj lk bi translated">用正确计时的时钟创建图像。</li><li id="7d9a" class="lc ld in kb b kc ll kg lm kk ln ko lo ks lp kw lh li lj lk bi translated">从节点以编程方式更新壁纸。</li><li id="b989" class="lc ld in kb b kc ll kg lm kk ln ko lo ks lp kw lh li lj lk bi translated">保持每分钟换壁纸。对于一个时钟来说，一个比这更长的时间框架是很奇怪的。</li></ol><p id="a192" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">继续寻找能够解决我们问题的可行方案。</p><p id="3c8c" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">Npm没有让人失望。以下是我的三个发现:</p><ol class=""><li id="377a" class="lc ld in kb b kc kd kg kh kk le ko lf ks lg kw lh li lj lk bi translated"><a class="ae lq" href="https://www.npmjs.com/package/node-html-to-image" rel="noopener ugc nofollow" target="_blank">节点-html-图像</a></li><li id="0de1" class="lc ld in kb b kc ll kg lm kk ln ko lo ks lp kw lh li lj lk bi translated"><a class="ae lq" href="https://www.npmjs.com/package/wallpaper" rel="noopener ugc nofollow" target="_blank">壁纸</a></li><li id="6103" class="lc ld in kb b kc ll kg lm kk ln ko lo ks lp kw lh li lj lk bi translated"><a class="ae lq" href="https://www.npmjs.com/package/node-cron" rel="noopener ugc nofollow" target="_blank"> node-cron </a></li></ol><p id="6feb" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">太好了！Node-html-to-image可以接收一个html字符串，使用<a class="ae lq" href="https://www.npmjs.com/package/puppeteer" rel="noopener ugc nofollow" target="_blank">puppeter</a>在一个无头浏览器中运行它，并将截图保存到磁盘上。它甚至可以在拍照前运行Javascript。📸</p><p id="449e" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">壁纸包提供了一个非常简单的基于承诺的API来设置壁纸图片。我甚至跨平台工作。🚀</p><p id="ac5a" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">Node-cron允许我们传入cron语法和一个回调函数。然后，该函数将以给定的时间间隔运行。这里有一个试验cron语法的好网站:<a class="ae lq" href="https://crontab.guru/" rel="noopener ugc nofollow" target="_blank">https://crontab.guru/</a></p><p id="6d7d" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">编码时间到了…</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lr"><img src="../Images/8ae18b3e86118b00a8e8265ce1a6cfea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bbhCfO-urHZzPGlgucZU4A.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">Node.js代码实现每分钟一个新的壁纸时钟</figcaption></figure><p id="6fa7" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">哇！只有很少几行代码(如果你不考虑错误检查的话)。</p><p id="9163" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">最后一步是让节点脚本在引导时运行。我知道的最简单的方法是使用<a class="ae lq" href="https://pm2.keymetrics.io/" rel="noopener ugc nofollow" target="_blank"> pm2 </a>。可以用npm安装。</p><pre class="ky kz la lb gt ls lt lu lv aw lw bi"><span id="b404" class="lx ly in lt b gy lz ma l mb mc">npm install -g pm2</span></pre><p id="6b97" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">然后只需要3个命令就可以创建引导配置。</p><pre class="ky kz la lb gt ls lt lu lv aw lw bi"><span id="e4c1" class="lx ly in lt b gy lz ma l mb mc">pm2 startup<br/>pm2 start ./index.js<br/>pm2 save</span></pre><p id="e058" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">现在我们有了。一个HTML和CSS可定制的壁纸时钟。</p><p id="2800" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">代码可在<a class="ae lq" href="https://github.com/danba340/wallpaper-clock" rel="noopener ugc nofollow" target="_blank">这里</a>获得。</p><p id="1784" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我还在我的youtube频道上制作了一个<a class="ae lq" href="https://youtu.be/pATKLIrf-p0" rel="noopener ugc nofollow" target="_blank">视频教程</a>:</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi md"><img src="../Images/d7b234bd1eff1a9ec47d756d5a3e73e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w7IQ5-BKkAv89HWZ1IbDvQ.png"/></div></div></figure></div><div class="ab cl me mf hr mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ig ih ii ij ik"><p id="345f" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">希望你喜欢阅读。</p><p id="62ad" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我总是在推特上谈论代码:【https://twitter.com/BarelyDaniel T2】</p><p id="ca59" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">过得愉快👋</p></div></div>    
</body>
</html>