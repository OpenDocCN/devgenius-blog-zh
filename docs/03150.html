<html>
<head>
<title>Fly Me to the Moon: Sinatra with Ruby will take you places!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带我飞向月球:辛纳特拉与红宝石将带你去的地方！</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/fly-me-to-the-moon-sinatra-with-ruby-will-take-you-places-81922ea7e8ac?source=collection_archive---------8-----------------------#2020-10-05">https://blog.devgenius.io/fly-me-to-the-moon-sinatra-with-ruby-will-take-you-places-81922ea7e8ac?source=collection_archive---------8-----------------------#2020-10-05</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="88a5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">读者朋友们，你们好！我回来了，带来了更多关于我为熨斗学校做的项目的报道。本文将讨论我使用 Ruby 和 Sinatra 创建全栈 web 应用程序的第一次尝试！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/dae4f7484ebbe227ae1c47d7a15b591f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jTnUfdCmt-4SqGQr"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@jesuskiteque?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">耶稣·基特克</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h2 id="f115" class="kz la in bd lb lc ld dn le lf lg dp lh jv li lj lk jz ll lm ln kd lo lp lq lr bi translated">辛纳特拉？那不是歌手吗？</h2><p id="92f1" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">虽然你认为 Sinatra 是歌手并没有错，但是，我们将要讨论的 Sinatra 是在 Ruby 和 Rack 之上实现的 DSL(领域特定语言),类似于 Rails 的轻量级版本。Sinatra 旨在以最少的努力，简单而容易地开始创建 web 应用程序。</p><p id="c404" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">本质上，Sinatra 是 Ruby Gem，它大大加快了创建 web 应用程序的过程。它在处理嵌套目录的方法上非常有效。</p><h2 id="ed01" class="kz la in bd lb lc ld dn le lf lg dp lh jv li lj lk jz ll lm ln kd lo lp lq lr bi translated">什么是不爱？</h2><p id="8e3d" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">我必须喊出一个特殊的 Sinatra 框架，它为创建快速 web 应用程序创建了基本的文件结构。<a class="ae ky" href="https://github.com/thebrianemory/corneal" rel="noopener ugc nofollow" target="_blank"> Corneal </a>实际上是一个拯救生命的工具，它去除了所有与创建基本应用程序相关的初始繁琐工作。Corneal 将以这种方式建立文件结构:</p><pre class="kj kk kl km gt lx ly lz ma aw mb bi"><span id="662f" class="kz la in ly b gy mc md l me mf">Directory structure:</span><span id="5da2" class="kz la in ly b gy mg md l me mf">├── config.ru<br/>├── Gemfile<br/>├── Gemfile.lock<br/>├── Rakefile<br/>├── README<br/>├── app<br/>│   ├── controllers<br/>│   │   └── application_controller.rb<br/>│   ├── models<br/>│   └── views<br/>│       ├── layout.erb<br/>│       └── welcome.erb<br/>├── config<br/>│   ├── initializers<br/>│   └── environment.rb<br/>├── db<br/>│   └── migrate<br/>├── lib<br/>│   └── .gitkeep<br/>└── public<br/>|   ├── images<br/>|   ├── javascripts<br/>|   └── stylesheets<br/>|       └── main.css<br/>└── spec<br/>    ├── application_controller_spec.rb<br/>    └── spec_helper.rb</span></pre><p id="951e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我发现特别有帮助的是 Corneal 附带了一些默认的 CSS 样式，当你忙于在 MVC 模型中创建控制器时，可以很容易地看到你的项目。我发现这非常有帮助，当我建立数据库和模型时，可以很容易地看到我的代码是否如预期的那样工作。</p><p id="8560" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">角膜也有这个可怕的方法建立在创造容易耙迁移。</p><pre class="kj kk kl km gt lx ly lz ma aw mb bi"><span id="a910" class="kz la in ly b gy mc md l me mf">corneal [model/scaffold] NAME name:string age:integer</span></pre><p id="a793" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这个简单的命令做两件事。首先，它创建一个 rake 迁移文件。第二，它为你写表。从本质上来说，节省了你很多宝贵的时间。向...告别:</p><pre class="kj kk kl km gt lx ly lz ma aw mb bi"><span id="7e09" class="kz la in ly b gy mc md l me mf">rake db:create_migration NAME=[migration_name]</span><span id="eb66" class="kz la in ly b gy mg md l me mf">&amp;&amp;</span><span id="c87f" class="kz la in ly b gy mg md l me mf">class CreateUsers &lt; ActiveRecord::Migration<br/>  def change<br/>    create_table :users do |t|<br/>      t.string :name<br/>      t.age :integer<br/><br/>      t.timestamps null: false<br/>    end<br/>  end<br/>end</span></pre><p id="a809" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">所以，非常感谢布莱恩·埃默里发明了这个救生工具。</p><h2 id="31ad" class="kz la in bd lb lc ld dn le lf lg dp lh jv li lj lk jz ll lm ln kd lo lp lq lr bi translated">一些控制器动作呢？</h2><p id="a559" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">在模型-视图-控制器(MVC)格式中，控制器可以被看作是服务员，从餐馆后面的厨师那里发出/返回订单，并从客户或视图那里接收/返回订单。这实际上说明了控制器对于一个正常运行的 web 应用程序是多么重要。当您创建 web 应用程序时，可以保证您将大部分时间花在这些控制器上。</p><p id="0d95" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在 Sinatra 中，控制器是用 Ruby 编写的，由“路由”组成，这些“路由”接受来自浏览器的请求(“获取该数据”、“发布该数据”)，通过使用模型运行基于这些请求的代码，然后呈现。供用户查看的 erb(视图)文件。此外，application_controller.rb 文件是您的程序从 Sinatra::Base 继承的地方，使所有这些令人敬畏的 Sinatra 方法对您的应用程序可用。</p><h2 id="2d55" class="kz la in bd lb lc ld dn le lf lg dp lh jv li lj lk jz ll lm ln kd lo lp lq lr bi translated">帮手呢？</h2><p id="22e5" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">说到 Sinatra 中的控制器，在你的 application_controller 中使用一个助手方法可以让你的 web 应用摆脱一些“代码味”或者方法中的冗余。作为一名开发人员，我在培训中真正领悟到的一点是，开发人员不喜欢重复自己，重复自己会让你的程序看起来混乱不堪。记得保持代码干爽(不要重复)！因此，创建助手方法确实允许我们作为开发人员编写一次代码，并且仍然能够在整个 web 应用程序中使用它。</p><pre class="kj kk kl km gt lx ly lz ma aw mb bi"><span id="ff9b" class="kz la in ly b gy mc md l me mf">helpers do</span><span id="d94a" class="kz la in ly b gy mg md l me mf">def logged_in?<br/>    !!current_user<br/>end</span><span id="4943" class="kz la in ly b gy mg md l me mf">def current_user<br/>    User.find_by(id: session[:user_id])<br/>end</span><span id="af14" class="kz la in ly b gy mg md l me mf">def authorized_to_edit?(post)<br/>    post.user == current_user<br/>end</span><span id="e09c" class="kz la in ly b gy mg md l me mf">end</span></pre><p id="a14c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">上面的 current_user 助手方法允许我们将当前的 user :id 与 current_user 方法相关联。这种方法在与 logged_in 配合使用时非常有用。方法，该方法将 current_user 的值转换为布尔值，该值将返回 true 或 false，以确定 current_user 当时是否登录。</p><p id="88dd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如何在 posts_controller.rb 文件中使用它的示例:</p><pre class="kj kk kl km gt lx ly lz ma aw mb bi"><span id="17a5" class="kz la in ly b gy mc md l me mf">get '/posts/new' do</span><span id="7c50" class="kz la in ly b gy mg md l me mf">if logged_in?<br/>    erb :'/posts/new'<br/>else<br/>    flash[:error] = "You must be logged in to create a review"<br/>    redirect '/'<br/>end<br/>end</span></pre><p id="1811" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">很自然，这允许我们使用 logged_in？方法来呈现/posts/new 表单。等于 true，使得只有登录的人才能创建新帖子！</p><p id="403b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你可能已经注意到了，</p><pre class="kj kk kl km gt lx ly lz ma aw mb bi"><span id="b1bc" class="kz la in ly b gy mc md l me mf">flash[:error] = "You must be logged in to create a review"</span></pre><p id="5013" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这是一个超级棒的宝石，让用户知道什么时候有问题，否则用户永远不会知道实际发生了什么。s<a class="ae ky" href="https://github.com/SFEley/sinatra-flash" rel="noopener ugc nofollow" target="_blank">in tra-Flash</a>的生命周期是一次刷新，这意味着一旦用户刷新页面，消息就会消失！这是另一个超级方便的东西，让程序更加动态！</p><h2 id="5d47" class="kz la in bd lb lc ld dn le lf lg dp lh jv li lj lk jz ll lm ln kd lo lp lq lr bi translated">判决结果？</h2><p id="44a3" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">Sinatra 是一个非常棒的 DSL，可以用最少的努力创建快速的网络应用程序！我真的很喜欢用 Sinatra 创作和学习。尽管我必须承认辛纳屈并不完美。最让我恼火的一件事是，当你创建你的路线时，顺序很重要！如果你没有按照辛纳特拉希望你拥有的方式来安排你的路线，你会得到奇怪的错误，或者像辛纳特拉喜欢说的“辛纳特拉不知道这首小曲。”除了那个奇怪的怪癖，辛纳特拉真的很有趣！</p></div></div>    
</body>
</html>