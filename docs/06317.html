<html>
<head>
<title>How to create a telegram bot in GOLANG</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在 GOLANG 中创建电报机器人</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-create-a-telegram-bot-in-golang-d30ce8b1bd58?source=collection_archive---------2-----------------------#2021-12-30">https://blog.devgenius.io/how-to-create-a-telegram-bot-in-golang-d30ce8b1bd58?source=collection_archive---------2-----------------------#2021-12-30</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="975b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Telegram 是一个每天都在增长的信使应用程序。它有包括机器人在内的大量功能。机器人可以与用户、组、超级组和频道进行交互。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/021e419867845c8bb7cf374773929127.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v2OZpbp9mpu5tzIZ4pkj3w.jpeg"/></div></div></figure><p id="25de" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这篇文章中，我们将学习如何在 golang 中创建一个电报机器人。</p><h1 id="c15e" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">要求</strong></h1><ul class=""><li id="e51f" class="ls lt in jm b jn lu jr lv jv lw jz lx kd ly kh lz ma mb mc bi translated"><strong class="jm io">电报账号</strong>:你需要一个电报账号来使用 botfather(稍后描述)创建机器人。</li><li id="66ba" class="ls lt in jm b jn md jr me jv mf jz mg kd mh kh lz ma mb mc bi translated"><strong class="jm io"> telego 模块</strong> : <a class="ae mi" href="https://github.com/SakoDroid/telego" rel="noopener ugc nofollow" target="_blank"> Telego </a>是一个在 golang 中创建电报应用的新库。</li></ul><h1 id="64cc" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">安装模块</strong></h1><p id="c7c6" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv mj jx jy jz mk kb kc kd ml kf kg kh ig bi translated">要安装 telegot，您需要使用<strong class="jm io"> go get </strong>命令将它安装到您的 GOPATH 中。只需在您的终端中键入以下内容进行安装:</p><pre class="kj kk kl km gt mm mn mo mp aw mq bi"><span id="a0eb" class="mr kv in mn b gy ms mt l mu mv">go get -u github.com/SakoDroid/telego</span></pre><p id="766e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">创建机器人</strong></p><p id="2c74" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">首先你需要使用<a class="ae mi" href="https://t.me/botfather" rel="noopener ugc nofollow" target="_blank"> bofather </a>创建一个新的机器人。下面的步骤将告诉你如何做:</p><ol class=""><li id="0d4d" class="ls lt in jm b jn jo jr js jv mw jz mx kd my kh mz ma mb mc bi translated">启动<a class="ae mi" href="https://t.me/botfather" rel="noopener ugc nofollow" target="_blank">机器人父亲</a>机器人。</li><li id="d3f5" class="ls lt in jm b jn md jr me jv mf jz mg kd mh kh mz ma mb mc bi translated">向机器人父亲发送/newbot 命令。</li><li id="971c" class="ls lt in jm b jn md jr me jv mf jz mg kd mh kh mz ma mb mc bi translated">为您的机器人选择一个唯一的名称。</li><li id="640e" class="ls lt in jm b jn md jr me jv mf jz mg kd mh kh mz ma mb mc bi translated">如果一切正常，你会收到一条信息，如下图所示。它包含一个<strong class="jm io">令牌</strong>，我们稍后会用到它，所以把这个令牌写在某个地方。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/c1b58703ff9c22e068c491f8b45edc69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W0SmgqfGs8yjCDMB0cWHbw.jpeg"/></div></div></figure><p id="c46c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在你已经创建了机器人。让我们转到编码部分。</p><h1 id="f091" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">写代码</strong></h1><p id="e6a5" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv mj jx jy jz mk kb kc kd ml kf kg kh ig bi translated">为了用 golang 编写机器人代码，我们将使用前面提到的<strong class="jm io"> telego </strong>库。</p><p id="f2ee" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将一步一步地学习这一部分:</p><p id="da52" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">第一步:导入库</strong>。只需导入以下库:</p><pre class="kj kk kl km gt mm mn mo mp aw mq bi"><span id="b73f" class="mr kv in mn b gy ms mt l mu mv">package main<br/>  <br/>import (<br/>	bt "github.com/SakoDroid/telego"<br/>	cfg "github.com/SakoDroid/telego/configs"<br/>	objs "github.com/SakoDroid/telego/objects"<br/>)</span></pre><p id="10c3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">步骤 2:创建机器人配置。Bot configs 是一个结构，它有一些用于配置 Bot 动作的字段。这些配置位于作为<strong class="jm io"> cfg </strong>导入的<strong class="jm io">配置</strong>包中。如果你不想弄乱配置，这个包有一些默认值。Bot 配置有一个名为<strong class="jm io"> UpdateConfigs </strong>的字段，其中包含与从 API 服务器请求和接收更新相关的配置。现在让我们看一下代码:</strong></p><pre class="kj kk kl km gt mm mn mo mp aw mq bi"><span id="1858" class="mr kv in mn b gy ms mt l mu mv">package main</span><span id="3942" class="mr kv in mn b gy nb mt l mu mv">import (<br/>	bt "github.com/SakoDroid/telego"<br/>	cfg "github.com/SakoDroid/telego/configs"<br/>	objs "github.com/SakoDroid/telego/objects"<br/>)</span><span id="596f" class="mr kv in mn b gy nb mt l mu mv">//This the token you receive from botfather<br/>const token string = "5078468473:AAHLCQfMnJTIFM25rFlbU2k5432kYD46dhs"</span><span id="35fe" class="mr kv in mn b gy nb mt l mu mv">//The instance of the bot<br/>var bot *bt.Bot</span><span id="9500" class="mr kv in mn b gy nb mt l mu mv">func main() {</span><span id="2f47" class="mr kv in mn b gy nb mt l mu mv">	//Update configs<br/>	up := cfg.DefaultUpdateConfigs()<br/>    <br/>    //Bot configs<br/>	cf := cfg.BotConfigs{<br/>      BotAPI: cfg.DefaultBotAPI, <br/>      APIKey: token, UpdateConfigs: up, <br/>      Webhook: false, <br/>      LogFileAddress: cfg.DefaultLogFile<br/>    }<br/>	<br/>}</span></pre><p id="4afa" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">关于 BoConfigs 字段:</p><p id="9a0f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">1.<strong class="jm io"> APIKey: </strong>这是你创建 bot 的时候从 botfather 那里收到的令牌。</p><p id="6e03" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">2.<strong class="jm io"> BotAPI: </strong>这是 BotAPI 服务器的地址。如果您没有运行本地 api 服务器，请使用<strong class="jm io"> cfg。该字段的 DefaultBotApi </strong>常量。</p><p id="8b25" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">3.<strong class="jm io">更新配置:</strong>这是更新相关的配置，例如更新频率(默认:300 毫秒)。可以用<strong class="jm io"> cfg。此字段的 DefaultUpdateConfigs() </strong>方法。</p><p id="fb79" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">3.<strong class="jm io"> Webhook: </strong>如果要使用 Webhook 接收更新，则传递 true。(Telego 目前不支持 webhook)。</p><p id="2791" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">4.<strong class="jm io">日志文件地址:</strong>机器人的日志会保存在这个文件中。</p><p id="5c69" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">步骤 3:创建机器人实例。</strong>现在我们已经创建了配置，是时候创建机器人了。只需将您创建的配置传递给 telego 包的<strong class="jm io"> NewBot </strong>方法(作为<strong class="jm io"> bt </strong>导入)。创建完机器人后。您需要调用<strong class="jm io"> Run() </strong>以便 bot 启动并开始从 API 服务器接收更新。</p><pre class="kj kk kl km gt mm mn mo mp aw mq bi"><span id="adec" class="mr kv in mn b gy ms mt l mu mv">package main</span><span id="6e16" class="mr kv in mn b gy nb mt l mu mv">import (<br/>	"fmt"<br/>    <br/>	bt "github.com/SakoDroid/telego"<br/>	cfg "github.com/SakoDroid/telego/configs"<br/>	objs "github.com/SakoDroid/telego/objects"<br/>)</span><span id="763b" class="mr kv in mn b gy nb mt l mu mv">const token string = "5078468473:AAHLCQfMnJTIFM25rFlbU2k5432kYD46dhs"</span><span id="68eb" class="mr kv in mn b gy nb mt l mu mv">//The instance of the bot.<br/>var bot *bt.Bot</span><span id="b0ba" class="mr kv in mn b gy nb mt l mu mv">func main() {</span><span id="a21d" class="mr kv in mn b gy nb mt l mu mv">	up := cfg.DefaultUpdateConfigs()<br/>    <br/>	cf := cfg.BotConfigs{<br/>      BotAPI: cfg.DefaultBotAPI, <br/>      APIKey: token, UpdateConfigs: up, <br/>      Webhook: false, <br/>      LogFileAddress: cfg.DefaultLogFile<br/>    }<br/>    <br/>    var err error<br/>	<br/>    //Creating the bot using the created configs<br/>    bot, err = bt.NewBot(&amp;cf)<br/>	<br/>    if err == nil {<br/>    <br/>    	//Start the bot.<br/>    	err = bot.Run()<br/>        <br/>        if err == nil{<br/>			start()<br/>        }else {<br/>			fmt.Println(err)<br/>		}<br/>	} else {<br/>		fmt.Println(err)<br/>	}<br/>    <br/>}</span><span id="a203" class="mr kv in mn b gy nb mt l mu mv">func start(){<br/>	//Described in later sections<br/>}</span></pre><p id="d4e0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">步骤 4:接收更新并与客户端交互。</strong> Telego 提供了两种方式来处理从 API 服务器收到的更新:</p><ol class=""><li id="302c" class="ls lt in jm b jn jo jr js jv mw jz mx kd my kh mz ma mb mc bi translated">经理人</li><li id="7d2e" class="ls lt in jm b jn md jr me jv mf jz mg kd mh kh mz ma mb mc bi translated">Go 频道</li><li id="2abd" class="ls lt in jm b jn md jr me jv mf jz mg kd mh kh mz ma mb mc bi translated"><strong class="jm io">处理程序:</strong>处理程序可以用于文本消息和回调查询(一种内嵌键盘按钮)。您可以指定正则表达式模式、聊天类型和函数。每次从指定的聊天类型接收到文本消息时，将调用该函数并向其传递更新。聊天类型可以是“私人”、“群组”、“超级群组”、“频道”和“全部”。您可以指定多种聊天类型。让我们为文本消息“/start”添加一个处理程序，并响应“嗨，我是电报机器人！" :</li></ol><pre class="kj kk kl km gt mm mn mo mp aw mq bi"><span id="e36f" class="mr kv in mn b gy ms mt l mu mv">package main</span><span id="2d00" class="mr kv in mn b gy nb mt l mu mv">import (<br/>	"fmt"<br/>    <br/>	bt "github.com/SakoDroid/telego"<br/>	cfg "github.com/SakoDroid/telego/configs"<br/>	objs "github.com/SakoDroid/telego/objects"<br/>)</span><span id="7b05" class="mr kv in mn b gy nb mt l mu mv">const token string = "5078468473:AAHLCQfMnJTIFM25rFlbU2k5432kYD46dhs"</span><span id="893d" class="mr kv in mn b gy nb mt l mu mv">//The instance of the bot.<br/>var bot *bt.Bot</span><span id="6766" class="mr kv in mn b gy nb mt l mu mv">func main() {</span><span id="696b" class="mr kv in mn b gy nb mt l mu mv">	up := cfg.DefaultUpdateConfigs()<br/>    <br/>	cf := cfg.BotConfigs{<br/>      BotAPI: cfg.DefaultBotAPI, <br/>      APIKey: token, UpdateConfigs: up, <br/>      Webhook: false, <br/>      LogFileAddress: cfg.DefaultLogFile<br/>    }<br/>    <br/>    var err error<br/>	<br/>    //Creating the bot using the created configs<br/>    bot, err = bt.NewBot(&amp;cf)<br/>	<br/>    if err == nil {<br/>    	err = bot.Run()<br/>        if err == nil{<br/>			start()<br/>        }else {<br/>			fmt.Println(err)<br/>		}<br/>	} else {<br/>		fmt.Println(err)<br/>	}<br/>    <br/>}</span><span id="a38a" class="mr kv in mn b gy nb mt l mu mv">func start(){<br/>	bot.AddHandler("/start", func(u *objs.Update) {<br/>    <br/>    	//Sends the message to the chat that the message has been received from. The message will be a reply to the received message.<br/>		_,err := bot.SendMessage(u.Message.Chat.Id,"hi i'm a telegram bot!","",u.Message.MessageId,false,false)<br/>        if err != nil{<br/>        	fmt.Println(err)<br/>        }<br/>        <br/>	}, "private","group")<br/>}</span></pre><p id="a5aa" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因为我们已经将“private”和“group”传递给了<strong class="jm io"> AddHandler </strong>方法，所以只有当收到的消息来自私聊或群聊时，这个处理程序才会工作。</p><p id="f1fc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> 2。Go 频道:</strong>在 Telego 中，您可以注册特定聊天的频道并更新类型。更新类型是更新包含的文件。它可以包含消息、编辑消息、内嵌查询等。您可以注册一个频道，当更新包含指定字段时，该频道将被更新。您也可以指定一个聊天，这意味着频道将根据该聊天进行更新。这两个参数可以组合在一起，以创建专用于特定聊天中特定更新类型的频道。</p><p id="3d66" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在下面的代码中，我们注册了一个只接收消息更新的通道。由于我们没有指定聊天 id，所有包含消息字段的聊天的所有更新都将被传递到该频道。让我们来看看:</p><pre class="kj kk kl km gt mm mn mo mp aw mq bi"><span id="a119" class="mr kv in mn b gy ms mt l mu mv">package main</span><span id="085d" class="mr kv in mn b gy nb mt l mu mv">import (<br/>	"fmt"<br/>    <br/>	bt "github.com/SakoDroid/telego"<br/>	cfg "github.com/SakoDroid/telego/configs"<br/>	objs "github.com/SakoDroid/telego/objects"<br/>)</span><span id="78f9" class="mr kv in mn b gy nb mt l mu mv">const token string = "5078468473:AAHLCQfMnJTIFM25rFlbU2k5432kYD46dhs"</span><span id="fb5c" class="mr kv in mn b gy nb mt l mu mv">//The instance of the bot.<br/>var bot *bt.Bot</span><span id="8c6b" class="mr kv in mn b gy nb mt l mu mv">func main() {</span><span id="9090" class="mr kv in mn b gy nb mt l mu mv">	up := cfg.DefaultUpdateConfigs()<br/>    <br/>	cf := cfg.BotConfigs{<br/>      BotAPI: cfg.DefaultBotAPI, <br/>      APIKey: token, UpdateConfigs: up, <br/>      Webhook: false, <br/>      LogFileAddress: cfg.DefaultLogFile<br/>    }<br/>    <br/>    var err error<br/>	<br/>    //Creating the bot using the created configs<br/>    bot, err = bt.NewBot(&amp;cf)<br/>	<br/>    if err == nil {<br/>    <br/>    	err = bot.Run()<br/>        <br/>        if err == nil{<br/>			start()<br/>        }else {<br/>			fmt.Println(err)<br/>		}<br/>	} else {<br/>		fmt.Println(err)<br/>	}<br/>    <br/>}</span><span id="c86f" class="mr kv in mn b gy nb mt l mu mv">func start(){</span><span id="c925" class="mr kv in mn b gy nb mt l mu mv">	//Register the channel<br/>	messageChannel, _ := bot.AdvancedMode().RegisterChannel("", "message")<br/>    <br/>    for {<br/>    <br/>    	//Wait for updates<br/>		up := &lt;- *messageChannel<br/>        <br/>        //Print the text<br/>        fmt.Println(up.Message.Text) <br/>    }<br/>}</span></pre><p id="5ea6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这段代码将通过<strong class="jm io">消息通道</strong>接收更新并打印文本。</p><h1 id="016d" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">与用户互动</strong></h1><p id="f744" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv mj jx jy jz mk kb kc kd ml kf kg kh ig bi translated">现在我们知道了如何接收更新，我们如何向用户发送消息、媒体和其他东西呢？</p><p id="6f0e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Telego 有很多方法发回文本、照片、视频、贴纸等。它们都是从<strong class="jm io">发送</strong>开始的，比如<strong class="jm io"> SendMessage </strong>会发送文本消息，或者<strong class="jm io"> SendPhoto </strong>会发送照片。</p><p id="c97a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">对于发送媒体，调用相关方法将返回一个<strong class="jm io"> MediaSender </strong>。根据<a class="ae mi" href="https://core.telegram.org/bots/api" rel="noopener ugc nofollow" target="_blank"> telegram bot API 文档</a>，媒体可以通过三种方式发送:</p><ol class=""><li id="b6ac" class="ls lt in jm b jn jo jr js jv mw jz mx kd my kh mz ma mb mc bi translated">使用已存储在电报服务器中的文件的文件 id。</li><li id="e200" class="ls lt in jm b jn md jr me jv mf jz mg kd mh kh mz ma mb mc bi translated">使用 HTTP url。</li><li id="d0c5" class="ls lt in jm b jn md jr me jv mf jz mg kd mh kh mz ma mb mc bi translated">使用计算机中的文件。</li></ol><p id="fa98" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">MediaSender 涵盖了所有这三种方式。它有两种方法:<strong class="jm io">sendbyfileidourl</strong>和<strong class="jm io"> SendByFile。</strong></p><p id="a8bb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">SendByFileIdOrUrl 将接受一个字符串，该字符串可以是文件 id 或 Url。<strong class="jm io"> SendByFile </strong>获取文件并上传至电报服务器。</p><p id="a721" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> ** </strong>由于所有的发送方法都返回发送的消息，您可以保存返回消息中的文件 id 以备后用，避免每次都上传媒体。</p><p id="f8c8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">(要发送其他信息，如投票和位置，您可以在这里阅读 Telego 的完整文档<a class="ae mi" href="https://github.com/SakoDroid/telego" rel="noopener ugc nofollow" target="_blank"/></p><p id="e8aa" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在让我们创建一个代码，每当收到文本消息“pic”时，它将发送两张图片。其中一个是 HTTP URL，另一个是存储在运行 bot 的计算机中的文件。在这种情况下，我们将使用处理程序(代码的其他部分如上所示，此处删除) :</p><pre class="kj kk kl km gt mm mn mo mp aw mq bi"><span id="4094" class="mr kv in mn b gy ms mt l mu mv">func start(){<br/>	bot.AddHandler("pic", func(u *objs.Update) {<br/>    <br/>      //ChatId of this chat<br/>      chatId := u.Message.Chat.Id</span><span id="0bb4" class="mr kv in mn b gy nb mt l mu mv">      //Received message if. We will use it's id to reply to it<br/>      messageId := u.Message.MessageId</span><span id="22e8" class="mr kv in mn b gy nb mt l mu mv">      //Create a media sender for sending a URL<br/>      mediaSender1 := bot.SendPhoto(chatId,messageId,"this is the caption","")</span><span id="5940" class="mr kv in mn b gy nb mt l mu mv">//Send the URL<br/>      _,err := mediaSender1.SendByFileIdOrUrl("http://example.com/funny_cat.jpg",false,false)<br/>      if err2 != nil{<br/>          fmt.Println(err)<br/>      }</span><span id="ce5a" class="mr kv in mn b gy nb mt l mu mv">      //Create a media sender for sending a file<br/>      mediaSender2 := bot.SendPhoto(chatId,messageId,"this is the caption","")</span><span id="e405" class="mr kv in mn b gy nb mt l mu mv">      //Open the file. error is ignored to simplify the code<br/>      file,_ := os.Open("funny_cat.jpg")</span><span id="6f95" class="mr kv in mn b gy nb mt l mu mv">//Send the file<br/>      _,err = mediaSender2.SendByFile(file,false,false)</span><span id="575d" class="mr kv in mn b gy nb mt l mu mv">      if err != nil{<br/>          fmt.Println(err)<br/>      }<br/>    <br/>	}, "private")<br/>}</span></pre><p id="a0bf" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">就这样，你只发了两张照片！</p><p id="23c4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">发送其他媒体的代码与上面的代码类似，但你只需调用机器人的相关方法(如<strong class="jm io"> SendVideo </strong>或<strong class="jm io"> SendGif </strong>)。</p><h1 id="ec81" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">关于键盘</h1><p id="17d9" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv mj jx jy jz mk kb kc kd ml kf kg kh ig bi translated">Telegram 提供两种类型的键盘:</p><ol class=""><li id="d61a" class="ls lt in jm b jn jo jr js jv mw jz mx kd my kh mz ma mb mc bi translated">自定义键盘:这种键盘将显示给用户，而不是字母键盘。(您可以在它们之间切换)</li><li id="26cb" class="ls lt in jm b jn md jr me jv mf jz mg kd mh kh mz ma mb mc bi translated">嵌入式键盘:该键盘将显示在发送信息的下方。</li></ol><p id="6fea" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Telego 有一个工具可以创建两种键盘，而且非常容易使用。创建一个定制键盘你需要调用<strong class="jm io"> CreateKeyboard 方法</strong>，创建一个内嵌键盘你可以调用<strong class="jm io"> CreateInlineKeyboard </strong>方法。这个方法将返回一个键盘指针，其中有几个方法可以添加按钮。完成键盘输入后，您可以将它们与消息一起发送给用户。要发送它们，只需将键盘传递给高级 bot 的<strong class="jm io"> Send </strong>方法的<strong class="jm io">键盘</strong>参数即可。</p><p id="b7b9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将用示例代码来介绍它们。</p><h2 id="45fe" class="mr kv in bd kw nc nd dn la ne nf dp le jv ng nh li jz ni nj lm kd nk nl lq nm bi translated"><strong class="ak">定制键盘</strong></h2><p id="b967" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv mj jx jy jz mk kb kc kd ml kf kg kh ig bi translated">下面的代码创建了一个自定义键盘，并将其与文本消息一起发送:</p><pre class="kj kk kl km gt mm mn mo mp aw mq bi"><span id="2177" class="mr kv in mn b gy ms mt l mu mv">func start(){<br/>	bot.AddHandler("/start", func(u *objs.Update) {<br/>    <br/>    	    <!-- -->//Create the custom keyboard<br/>            kb := bot.CreateKeyboard(false, false, false, "type ...")</span><span id="6945" class="mr kv in mn b gy nb mt l mu mv">            //Add buttons to it. First argument is the button's text and the second one is the row number that the button will be added to it.</span><span id="4b44" class="mr kv in mn b gy nb mt l mu mv">            kb.AddButton("button1", 1)</span><span id="368e" class="mr kv in mn b gy nb mt l mu mv">            kb.AddButton("button2", 1)</span><span id="f23b" class="mr kv in mn b gy nb mt l mu mv">kb.AddButton("button3", 2)<br/>        <br/>            //Pass the keyboard to the send method<br/>            _, err := bot.AdvancedMode().ASendMessage(u.Message.Chat.Id, "hi to you too, send me a location", "", u.Message.MessageId, false<!-- -->,false<!-- -->, nil, false, false, kb)</span><span id="39b2" class="mr kv in mn b gy nb mt l mu mv">            if err != nil {</span><span id="8c08" class="mr kv in mn b gy nb mt l mu mv">                fmt.Println(err)</span><span id="bc7a" class="mr kv in mn b gy nb mt l mu mv">            }</span><span id="b2b6" class="mr kv in mn b gy nb mt l mu mv">        }, "private","group")<br/>}</span></pre><p id="70de" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">当每个按钮被按下时，包含按钮文本的文本消息被发送到机器人。因此，为了处理每个按钮，您可以为按钮包含的文本添加一个处理程序。</p><h2 id="6f41" class="mr kv in bd kw nc nd dn la ne nf dp le jv ng nh li jz ni nj lm kd nk nl lq nm bi translated">嵌入式键盘</h2><p id="189e" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv mj jx jy jz mk kb kc kd ml kf kg kh ig bi translated">嵌入式键盘有几种类型的按钮。Telego 有添加所有这些按钮的方法。源代码中完整地记录了这些方法。现在让我们创建一个直列键盘:</p><pre class="kj kk kl km gt mm mn mo mp aw mq bi"><span id="382d" class="mr kv in mn b gy ms mt l mu mv">func start(){</span><span id="bed0" class="mr kv in mn b gy nb mt l mu mv">     bot.AddHandler("/start", func(u *objs.Update) {</span><span id="38d4" class="mr kv in mn b gy nb mt l mu mv">           //Creates a inline keyboard<br/>           <!-- -->kb := bot.CreateInlineKeyboard()</span><span id="3893" class="mr kv in mn b gy nb mt l mu mv">           //Adds a url button, when this button is pressed the url will be opened.<br/>           kb.AddURLButton("url", "https://google.com", 1)</span><span id="ac43" class="mr kv in mn b gy nb mt l mu mv">           //Adds a button which will send back a callback query containing the data we give to this function, to the bot when it's pressed.<br/>           kb.AddCallbackButton("call back without handler", "callback data 1", 2)</span><span id="a646" class="mr kv in mn b gy nb mt l mu mv">           //Adds a button which will send back a callback query containing the data we give to this function, to the bot when it's pressed. The difference between this method and the last method is that this method adds a handler for the callback of this button.<br/>           kb.AddCallbackButtonHandler("callabck with handler", "callback data 2", 3, func(u *objs.Update) {</span><span id="ea61" class="mr kv in mn b gy nb mt l mu mv">               _, err3 := bot.AdvancedMode().AAnswerCallbackQuery(u.CallbackQuery.Id, "callback received", true, "", 0)</span><span id="9902" class="mr kv in mn b gy nb mt l mu mv">               if err3 != nil {</span><span id="11c6" class="mr kv in mn b gy nb mt l mu mv">                   fmt.Println(err3)</span><span id="9a66" class="mr kv in mn b gy nb mt l mu mv">               }</span><span id="f534" class="mr kv in mn b gy nb mt l mu mv">           })</span><span id="92fa" class="mr kv in mn b gy nb mt l mu mv">           //Pass the keyboard to the send method<br/>           _, err := bot.AdvancedMode().ASendMessage(u.Message.Chat.Id, "hi to you too, send me a location", "", u.Message.MessageId, false<!-- -->,false<!-- -->, nil, false, false, kb)</span><span id="a406" class="mr kv in mn b gy nb mt l mu mv">           if err != nil {</span><span id="5a05" class="mr kv in mn b gy nb mt l mu mv">               fmt.Println(err)</span><span id="fd86" class="mr kv in mn b gy nb mt l mu mv">           }</span><span id="5d1a" class="mr kv in mn b gy nb mt l mu mv">    }, "private","group")<br/>}</span></pre><p id="b906" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在本文中，我们介绍了在 golang 中使用 telego 库创建 bot 的基础知识。为了进一步阅读，你可以阅读<a class="ae mi" href="https://github.com/SakoDroid/telego" rel="noopener ugc nofollow" target="_blank"> telego 文档</a>以了解更多关于使用 golnag 的 telego 库创建机器人的信息。</p></div></div>    
</body>
</html>