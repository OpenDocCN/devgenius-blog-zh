<html>
<head>
<title>Getting Started with React State Management with MobX 6</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">MobX 6 React 状态管理入门</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/getting-started-with-react-state-management-with-mobx-6-1c566e17222e?source=collection_archive---------5-----------------------#2021-06-19">https://blog.devgenius.io/getting-started-with-react-state-management-with-mobx-6-1c566e17222e?source=collection_archive---------5-----------------------#2021-06-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/8dbd6ab1cf2e3933f54499399c2e7e50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZO3NLDtKTVYR03lO"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@vidarnm?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">维达尔·诺德里-马西森</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="49c0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">MobX 是 React 应用程序的简单状态管理解决方案。</p><p id="d533" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解如何使用 MobX 6 将状态管理添加到 React 应用程序中。</p><h1 id="3bb1" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">装置</h1><p id="28b8" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">首先，我们可以通过运行以下命令来安装 MobX 包:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="a556" class="mn lc iq mj b gy mo mp l mq mr">yarn add mobx</span></pre><p id="e393" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">用纱线或:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="9b04" class="mn lc iq mj b gy mo mp l mq mr">npm install --save mobx</span></pre><p id="b5e4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">和 NPM 一起。</p><p id="b788" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了和 React 一起使用，我们还需要<code class="fe ms mt mu mj b">mobx-react-lite</code>包。</p><p id="8165" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要安装它，我们运行:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="0278" class="mn lc iq mj b gy mo mp l mq mr">npm i mobx-react-lite</span></pre><p id="fa13" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以添加一个脚本标签来从 CDN 加载 MobX 库。</p><p id="4882" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该脚本的 URL 是:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="b3b2" class="mn lc iq mj b gy mo mp l mq mr">https://cdnjs.com/libraries/mobx</span></pre><p id="f7dc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">或者:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="396f" class="mn lc iq mj b gy mo mp l mq mr">https://unpkg.com/mobx/dist/mobx.umd.production.min.js</span></pre><h1 id="0692" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">简单用法</h1><p id="d8ec" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">在我们安装了这些包之后，我们可以使用它们来存储 React 应用程序的全局状态。</p><p id="a365" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="8429" class="mn lc iq mj b gy mo mp l mq mr">import React from "react";<br/>import { makeObservable, observable, computed, action } from "mobx";<br/>import { observer } from "mobx-react-lite";</span><span id="72e3" class="mn lc iq mj b gy mv mp l mq mr">class Count {<br/>  count = 0;<br/>  get doubleCount() {<br/>    return this.count * 2;<br/>  }<br/>  constructor(count) {<br/>    makeObservable(this, {<br/>      count: observable,<br/>      doubleCount: computed,<br/>      increment: action<br/>    });<br/>    this.count = count;<br/>  }</span><span id="2ef0" class="mn lc iq mj b gy mv mp l mq mr">increment() {<br/>    this.count++;<br/>  }<br/>}</span><span id="ef05" class="mn lc iq mj b gy mv mp l mq mr">const store = new Count(1);</span><span id="96ac" class="mn lc iq mj b gy mv mp l mq mr">const Counter = observer(({ store: { count } }) =&gt; {<br/>  return &lt;div&gt;{count}&lt;/div&gt;;<br/>});</span><span id="4257" class="mn lc iq mj b gy mv mp l mq mr">const DoubleCounter = observer(({ store: { doubleCount } }) =&gt; (<br/>  &lt;div&gt;{doubleCount}&lt;/div&gt;<br/>));</span><span id="a7cf" class="mn lc iq mj b gy mv mp l mq mr">const Incrementer = observer(({ store }) =&gt; {<br/>  return (<br/>    &lt;div&gt;<br/>      &lt;button onClick={() =&gt; store.increment()}&gt;increment&lt;/button&gt;<br/>    &lt;/div&gt;<br/>  );<br/>});</span><span id="d2d5" class="mn lc iq mj b gy mv mp l mq mr">export default function App() {<br/>  return (<br/>    &lt;div&gt;<br/>      &lt;Incrementer store={store} /&gt;<br/>      &lt;Counter store={store} /&gt;<br/>      &lt;DoubleCounter store={store} /&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="4dc7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建<code class="fe ms mt mu mj b">Count</code>商店并在我们的 React 应用程序中使用它。</p><p id="9b30" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在<code class="fe ms mt mu mj b">Count</code>类中有<code class="fe ms mt mu mj b">count</code>状态。</p><p id="e8f7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">doubleCount</code>是从<code class="fe ms mt mu mj b">count</code>状态的值计算出来的状态。</p><p id="7d44" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在构造函数中，我们有<code class="fe ms mt mu mj b">makeObservable</code>函数来使<code class="fe ms mt mu mj b">count</code>和<code class="fe ms mt mu mj b">doubleCount</code>属性处于反应状态。</p><p id="5ed9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使其成为可观察的状态。</p><p id="0626" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">而<code class="fe ms mt mu mj b">computed</code>使它成为一个计算状态，这意味着它是一个从一个或多个可观测状态派生出来的反应状态。</p><p id="4c1e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们将<code class="fe ms mt mu mj b">this.count</code>类属性初始化为<code class="fe ms mt mu mj b">count</code>参数的值。</p><p id="80b7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们创建<code class="fe ms mt mu mj b">increment</code>方法来增加<code class="fe ms mt mu mj b">count</code>值。</p><p id="e177" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们从<code class="fe ms mt mu mj b">Count</code>类创建一个<code class="fe ms mt mu mj b">store</code>，并将<code class="fe ms mt mu mj b">count</code>状态初始化为 1。</p><p id="56a3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们创建获取<code class="fe ms mt mu mj b">store.count</code>值的<code class="fe ms mt mu mj b">Counter</code>组件并呈现它。</p><p id="25df" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还有<code class="fe ms mt mu mj b">DoubleCounter</code>组件来呈现<code class="fe ms mt mu mj b">store.doubleCount</code>值。</p><p id="e713" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们有了从 prop 获取<code class="fe ms mt mu mj b">store</code>的<code class="fe ms mt mu mj b">Incrementer</code>组件，当我们单击按钮时，调用它的<code class="fe ms mt mu mj b">increment</code>来增加<code class="fe ms mt mu mj b">count</code>的值。</p><p id="7f72" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用 MobX <code class="fe ms mt mu mj b">observer</code>函数包装所有 3 个组件，让所有 3 个组件都监视存储状态值。</p><p id="1eac" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，在<code class="fe ms mt mu mj b">App</code>中，我们添加所有 3 个组件并传入商店，这样当我们单击 increment 时，我们会看到<code class="fe ms mt mu mj b">count</code>和<code class="fe ms mt mu mj b">doubleCount</code>都更新了。</p><h1 id="526f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="ea53" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用 MobX 轻松地将状态管理添加到 React 应用程序中。</p></div></div>    
</body>
</html>