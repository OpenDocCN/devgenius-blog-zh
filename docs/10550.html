<html>
<head>
<title>How to Convert CSV to an Array in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在 JavaScript 中将 CSV 转换成数组</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/javascript-convert-csv-to-array-474ea1f2cfbd?source=collection_archive---------7-----------------------#2022-11-10">https://blog.devgenius.io/javascript-convert-csv-to-array-474ea1f2cfbd?source=collection_archive---------7-----------------------#2022-11-10</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/08bf96c3dee0ddb013fa6f7122a4f265.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xr0cXLFecTrPSTioQbYZaw.png"/></div></div></figure><p id="bab1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">您可以通过<code class="fe kt ku kv kw b">csvtojson</code>库将 CSV 文件或字符串快速转换为 JavaScript 中的对象数组:</p><p id="e835" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe kt ku kv kw b">index.js</code></p><pre class="kx ky kz la gt lb kw lc bn ld le bi"><span id="1e0f" class="lf lg in kw b be lh li l lj lk">import csvToJson from 'csvtojson';<br/><br/>const csvFilePath = 'data.csv';<br/><br/>const array = await csvToJson().fromFile(csvFilePath);<br/>console.log(array);</span></pre><p id="397b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">对于这样一个<code class="fe kt ku kv kw b">data.csv</code>文件:</p><p id="b3d4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe kt ku kv kw b">data.csv</code></p><pre class="kx ky kz la gt lb kw lc bn ld le bi"><span id="a5c6" class="lf lg in kw b be lh li l ll lk">color,maxSpeed,age<br/>"red",120,2<br/>"blue",100,3<br/>"green",130,2</span></pre><p id="135c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这将是生成的数组:</p><p id="1fb5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe kt ku kv kw b">Output</code></p><pre class="kx ky kz la gt lb kw lc bn ld le bi"><span id="93de" class="lf lg in kw b be lh li l lj lk">[<br/>  { color: 'red', maxSpeed: '120', age: '2' },<br/>  { color: 'blue', maxSpeed: '100', age: '3' },<br/>  { color: 'green', maxSpeed: '130', age: '2' }<br/>]</span></pre><h1 id="688c" class="lm lg in bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">安装<code class="fe kt ku kv kw b">csvtojson</code></h1><p id="8246" class="pw-post-body-paragraph jv jw in jx b jy mj ka kb kc mk ke kf kg ml ki kj kk mm km kn ko mn kq kr ks ig bi translated">在使用<code class="fe kt ku kv kw b">csvtojson</code>之前，您需要将它安装到您的项目中。您可以使用 NPM 或 Yarn CLI 来完成此操作。</p><pre class="kx ky kz la gt lb kw lc bn ld le bi"><span id="768d" class="lf lg in kw b be lh li l lj lk">npm i csvtojson<br/><br/># Yarn<br/>yarn add csvtojson</span></pre><p id="f5a3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">安装后，您可以将其导入 JavaScript 模块，如下所示:</p><pre class="kx ky kz la gt lb kw lc bn ld le bi"><span id="f028" class="lf lg in kw b be lh li l lj lk">import csvToJson from 'csvtojson';<br/><br/>// CommonJS<br/>const csvToJson = require('csvtojson');</span></pre><h1 id="4fd0" class="lm lg in bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">用<code class="fe kt ku kv kw b">fromFile()</code>将 CSV 文件转换成数组</h1><p id="cab0" class="pw-post-body-paragraph jv jw in jx b jy mj ka kb kc mk ke kf kg ml ki kj kk mm km kn ko mn kq kr ks ig bi translated">我们调用<code class="fe kt ku kv kw b">csvtojson</code>模块的默认导出函数来创建将 CSV 转换为数组的对象。这个对象有很多方法，每个方法都以某种方式与 CSV 到 JavaScript 对象的转换相关，而<code class="fe kt ku kv kw b">fromFile()</code>就是其中之一。</p><p id="4044" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">它接受要转换的 CSV 文件的名称，并返回一个<code class="fe kt ku kv kw b">Promise</code>，因为转换是一个异步过程。<code class="fe kt ku kv kw b">Promise</code>将用产生的 JSON 字符串进行解析。</p><h1 id="9b4a" class="lm lg in bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">用<code class="fe kt ku kv kw b">fromString()</code>将 CSV 字符串转换成数组</h1><p id="4d98" class="pw-post-body-paragraph jv jw in jx b jy mj ka kb kc mk ke kf kg ml ki kj kk mm km kn ko mn kq kr ks ig bi translated">要直接从 CSV 数据字符串转换，而不是从文件转换，可以使用 converter 对象的异步<code class="fe kt ku kv kw b">fromString()</code>方法:</p><p id="bf39" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe kt ku kv kw b">index.js</code></p><pre class="kx ky kz la gt lb kw lc bn ld le bi"><span id="420b" class="lf lg in kw b be lh li l lj lk">import csvToJson from 'csvtojson';<br/><br/>const csv = `"First Name","Last Name","Age"<br/>"Russell","Castillo",23<br/>"Christy","Harper",35<br/>"Eleanor","Mark",26`;<br/>const array = await csvToJson().fromString(csv);<br/>console.log(array);</span></pre><p id="e39d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe kt ku kv kw b">Output</code></p><pre class="kx ky kz la gt lb kw lc bn ld le bi"><span id="6b88" class="lf lg in kw b be lh li l lj lk">[<br/>  { 'First Name': 'Russell', 'Last Name': 'Castillo', Age: '23' },<br/>  { 'First Name': 'Christy', 'Last Name': 'Harper', Age: '35' },<br/>  { 'First Name': 'Eleanor', 'Last Name': 'Mark', Age: '26' }<br/>]</span></pre><h1 id="1a38" class="lm lg in bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">自定义 CSV 到数组的转换</h1><p id="99ee" class="pw-post-body-paragraph jv jw in jx b jy mj ka kb kc mk ke kf kg ml ki kj kk mm km kn ko mn kq kr ks ig bi translated"><code class="fe kt ku kv kw b">csvtojson</code>的默认导出功能接受一个对象，该对象用于指定自定义转换过程的选项。</p><p id="ef21" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">一个这样的选项是<code class="fe kt ku kv kw b">header</code>，一个用于指定 CSV 数据中的头的数组。</p><p id="da68" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe kt ku kv kw b">index.js</code></p><pre class="kx ky kz la gt lb kw lc bn ld le bi"><span id="2fc2" class="lf lg in kw b be lh li l lj lk">import csvToJson from 'csvtojson';<br/><br/>const csv = `"First Name","Last Name","Age"<br/>"Russell","Castillo",23<br/>"Christy","Harper",35<br/>"Eleanor","Mark",26`;<br/>const array = await csvToJson({<br/>  headers: ['firstName', 'lastName', 'age'],<br/>}).fromString(csv);<br/>console.log(array);</span></pre><p id="cde2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe kt ku kv kw b">Output</code></p><pre class="kx ky kz la gt lb kw lc bn ld le bi"><span id="7c62" class="lf lg in kw b be lh li l lj lk">[<br/>  { firstName: 'Russell', lastName: 'Castillo', age: '23' },<br/>  { firstName: 'Christy', lastName: 'Harper', age: '35' },<br/>  { firstName: 'Eleanor', lastName: 'Mark', age: '26' }<br/>]</span></pre><p id="e155" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">另一个是<code class="fe kt ku kv kw b">delimeter</code>，用于表示分隔各列的字符:</p><pre class="kx ky kz la gt lb kw lc bn ld le bi"><span id="6a95" class="lf lg in kw b be lh li l lj lk">import csvToJson from 'csvtojson';<br/><br/>const csv = `"First Name"|"Last Name"|"Age"<br/>"Russell"|"Castillo"|23<br/>"Christy"|"Harper"|35<br/>"Eleanor"|"Mark"|26`;<br/>const array = await csvToJson({<br/>  headers: ['firstName', 'lastName', 'age'],<br/>  delimiter: '|',<br/>}).fromString(csv);</span></pre><p id="524c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe kt ku kv kw b">Output</code></p><pre class="kx ky kz la gt lb kw lc bn ld le bi"><span id="fed9" class="lf lg in kw b be lh li l lj lk">[<br/>  { firstName: 'Russell', lastName: 'Castillo', age: '23' },<br/>  { firstName: 'Christy', lastName: 'Harper', age: '35' },<br/>  { firstName: 'Eleanor', lastName: 'Mark', age: '26' }<br/>]</span></pre><p id="e0b3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们还有<code class="fe kt ku kv kw b">ignoreColumns</code>，一个使用正则表达式指示转换器忽略某些列的选项。</p><pre class="kx ky kz la gt lb kw lc bn ld le bi"><span id="6935" class="lf lg in kw b be lh li l lj lk">import csvToJson from 'csvtojson';<br/><br/>const csv = `"First Name"|"Last Name"|"Age"<br/>"Russell"|"Castillo"|23<br/>"Christy"|"Harper"|35<br/>"Eleanor"|"Mark"|26`;<br/>const array = await csvToJson({<br/>  headers: ['firstName', 'lastName', 'age'],<br/>  delimiter: '|',<br/>  ignoreColumns: /lastName/,<br/>}).fromString(csv);<br/>console.log(array);</span></pre><p id="7b7d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe kt ku kv kw b">Output</code></p><pre class="kx ky kz la gt lb kw lc bn ld le bi"><span id="75ba" class="lf lg in kw b be lh li l lj lk">[<br/>  { firstName: 'Russell', age: '23' },<br/>  { firstName: 'Christy', age: '35' },<br/>  { firstName: 'Eleanor', age: '26' }<br/>]</span></pre><h1 id="afeb" class="lm lg in bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">将 CSV 转换为行数组</h1><p id="6e74" class="pw-post-body-paragraph jv jw in jx b jy mj ka kb kc mk ke kf kg ml ki kj kk mm km kn ko mn kq kr ks ig bi translated">通过将<code class="fe kt ku kv kw b">output</code>选项设置为<code class="fe kt ku kv kw b">'csv'</code>，我们可以生成一个数组列表，其中每个数组代表一行，包含该行所有列的值。</p><p id="7d59" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">例如:</p><p id="5e6d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe kt ku kv kw b">index.js</code></p><pre class="kx ky kz la gt lb kw lc bn ld le bi"><span id="23b7" class="lf lg in kw b be lh li l lj lk">import csvToJson from 'csvtojson';<br/><br/>const csv = `color,maxSpeed,age<br/>"red",120,2<br/>"blue",100,3<br/>"green",130,2`;<br/>const array = await csvToJson({<br/>  output: 'csv',<br/>}).fromString(csv);<br/>console.log(array);</span></pre><p id="becd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe kt ku kv kw b">Output</code></p><pre class="kx ky kz la gt lb kw lc bn ld le bi"><span id="432f" class="lf lg in kw b be lh li l lj lk">[<br/>  [ 'red', '120', '2' ],<br/>  [ 'blue', '100', '3' ],<br/>  [ 'green', '130', '2' ]<br/>]</span></pre><h1 id="5e1f" class="lm lg in bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">CSV 到数组的本机转换</h1><p id="3bdd" class="pw-post-body-paragraph jv jw in jx b jy mj ka kb kc mk ke kf kg ml ki kj kk mm km kn ko mn kq kr ks ig bi translated">不使用任何第三方库也可以将 CSV 转换成 JavaScript 数组。</p><p id="5752" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe kt ku kv kw b">index.js</code></p><pre class="kx ky kz la gt lb kw lc bn ld le bi"><span id="8512" class="lf lg in kw b be lh li l lj lk">function csvToArray(csv) {<br/>  // \n or \r\n depending on the EOL sequence<br/>  const lines = csv.split('\n');<br/>  const delimeter = ',';<br/>  const result = [];<br/>  const headers = lines[0].split(delimeter);<br/>  for (const line of lines) {<br/>    const obj = {};<br/>    const row = line.split(delimeter);<br/>    for (let i = 0; i &lt; headers.length; i++) {<br/>      const header = headers[i];<br/>      obj[header] = row[i];<br/>    }<br/>    result.push(obj);<br/>  }<br/>  // Prettify output<br/>  return JSON.stringify(result, null, 2);<br/>}<br/>const csv = `color,maxSpeed,age<br/>"red",120,2<br/>"blue",100,3<br/>"green",130,2`;<br/>const array = csvToArray(csv);<br/>console.log(array);</span></pre><p id="e757" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe kt ku kv kw b">Output</code></p><pre class="kx ky kz la gt lb kw lc bn ld le bi"><span id="8c3c" class="lf lg in kw b be lh li l lj lk">[<br/>  {<br/>    "color": "color",<br/>    "maxSpeed": "maxSpeed",<br/>    "age": "age"<br/>  },<br/>  {<br/>    "color": "\"red\"",<br/>    "maxSpeed": "120",<br/>    "age": "2"<br/>  },<br/>  {<br/>    "color": "\"blue\"",<br/>    "maxSpeed": "100",<br/>    "age": "3"<br/>  },<br/>  {<br/>    "color": "\"green\"",<br/>    "maxSpeed": "130",<br/>    "age": "2"<br/>  }<br/>]</span></pre><p id="5250" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">您可以修改上面的代码，以允许变化和更复杂的 CSV 数据。</p><p id="9159" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="mo">原载于</em>【codingbeautydev.com】<em class="mo"/></p><h1 id="c55d" class="lm lg in bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">JavaScript 做的每一件疯狂的事情</h1><p id="e18c" class="pw-post-body-paragraph jv jw in jx b jy mj ka kb kc mk ke kf kg ml ki kj kk mm km kn ko mn kq kr ks ig bi translated">一本关于 JavaScript 微妙的警告和鲜为人知的部分的迷人指南。</p><figure class="kx ky kz la gt jo gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/143ee152ba78025ea8643ba5b9726a20.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*YS5Oub8REWy8vnOEqBnsyQ.png"/></div></figure><p id="7d6e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><a class="ae mp" href="https://cbdev.link/d3c4eb" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">报名</strong> </a>立即免费领取一份。</p></div></div>    
</body>
</html>