<html>
<head>
<title>Debugging Using gdb</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 gdb 调试</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/debugging-using-gdb-5e2a4db976e9?source=collection_archive---------11-----------------------#2022-10-16">https://blog.devgenius.io/debugging-using-gdb-5e2a4db976e9?source=collection_archive---------11-----------------------#2022-10-16</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/54d2caf041e213777e6e587be3d53146.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*n2kcJ7ulIdXuHQWF"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">约书亚·雷德科普在<a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure></div><div class="ab cl ka kb hr kc" role="separator"><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf"/></div><div class="ig ih ii ij ik"><h1 id="469d" class="kh ki in bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">介绍</h1><p id="3706" class="pw-post-body-paragraph lf lg in lh b li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc ig bi translated">调试是发现和修复计算机程序中错误的过程。错误通常被称为软件开发中的错误。调试在开发过程中是必不可少的，因为通常不可能测试一个大型程序中的所有代码。程序员可能会在编写代码时对其进行测试，但仍有可能遗漏错误。</p><p id="7c9c" class="pw-post-body-paragraph lf lg in lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc ig bi translated">当发现错误时，可以使用调试器来找到错误的位置，以便可以修复它。调试器也用于检查程序的状态，以便程序员可以理解为什么它不能按预期工作。</p><p id="266a" class="pw-post-body-paragraph lf lg in lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc ig bi translated">有许多不同类型的调试器，但大多数可以分为两类:符号型和动态型。符号调试器使用运行时不可用的程序信息，如源代码或符号表。另一方面，动态调试器使用运行时可用的信息，比如变量值。</p><p id="4988" class="pw-post-body-paragraph lf lg in lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc ig bi translated">这两种调试器各有优缺点。符号调试器通常更容易使用，因为它们可以提供关于程序的更多信息。但是，它们只能用在已经用调试信息编译的程序上。动态调试器可以用在没有用调试信息编译的程序上，但是它们通常更难使用。不同的编程语言有许多不同的调试器。</p><h1 id="02a6" class="kh ki in bd kj kk mi km kn ko mj kq kr ks mk ku kv kw ml ky kz la mm lc ld le bi translated">调试器的类型</h1><p id="ac36" class="pw-post-body-paragraph lf lg in lh b li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc ig bi translated">在<strong class="lh io"> C 编程语言</strong>中，有一个被广泛使用的调试器叫做<strong class="lh io"> <em class="mn"> gdb </em> </strong>。</p><p id="150d" class="pw-post-body-paragraph lf lg in lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc ig bi translated"><strong class="lh io"> <em class="mn"> gdb </em> </strong>是一个命令行调试器，可以用来发现<strong class="lh io"> C 程序中的错误。</strong>可用于检查变量值，设置断点，使程序在特定点停止运行，单步执行代码，使其一次执行一行。</p><p id="07e1" class="pw-post-body-paragraph lf lg in lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc ig bi translated"><strong class="lh io"> <em class="mn"> gdb </em> </strong>可以用来调试与调试器运行在同一台计算机上的程序，也可以调试运行在不同计算机上的程序。当调试运行在不同计算机上的程序时，可以使用<strong class="lh io"> <em class="mn"> gdb </em> </strong>通过网络连接到程序。</p><p id="215c" class="pw-post-body-paragraph lf lg in lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc ig bi translated"><strong class="lh io"> <em class="mn"> gdb </em> </strong>不是唯一可用于<strong class="lh io"> C 程序</strong>的调试器，但它是最受欢迎的调试器之一。其他调试器包括<strong class="lh io"> <em class="mn"> lldb </em> </strong>，它是<strong class="lh io"> LLVM 编译器</strong>的调试器，以及<strong class="lh io"> ddd </strong>，它是一个图形调试器。</p><h1 id="a438" class="kh ki in bd kj kk mi km kn ko mj kq kr ks mk ku kv kw ml ky kz la mm lc ld le bi translated">运行 gdb</h1><p id="0b52" class="pw-post-body-paragraph lf lg in lh b li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc ig bi translated">要使用<strong class="lh io"> <em class="mn"> gdb </em> </strong>，第一步是用<code class="fe mo mp mq mr b">-g</code>标志编译程序，以便调试信息包含在可执行文件中。接下来就是运行<strong class="lh io"> <em class="mn"> gdb </em> </strong>中的程序。</p><p id="3e16" class="pw-post-body-paragraph lf lg in lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc ig bi translated"><strong class="lh io"> <em class="mn"> gdb </em> </strong>可以从命令行运行，方法是键入<strong class="lh io"> <em class="mn"> gdb </em> </strong>后跟可执行文件的名称。例如，如果文件 test.c 包含以下代码:</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="161f" class="na ki in mr b gy nb nc l nd ne">#include &lt;stdio.h&gt;</span><span id="b1d9" class="na ki in mr b gy nf nc l nd ne">int main(void)</span><span id="f870" class="na ki in mr b gy nf nc l nd ne">{ <br/>    int i;</span><span id="b8fd" class="na ki in mr b gy nf nc l nd ne">    printf(“Enter a number: “);</span><span id="f802" class="na ki in mr b gy nf nc l nd ne">    scanf(“%d”, &amp;i);</span><span id="a4c8" class="na ki in mr b gy nf nc l nd ne">    printf(“The number is %d “, i);</span><span id="8bb8" class="na ki in mr b gy nf nc l nd ne">    return 0;</span><span id="e452" class="na ki in mr b gy nf nc l nd ne">}</span></pre><p id="54ff" class="pw-post-body-paragraph lf lg in lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc ig bi translated">程序可以用<code class="fe mo mp mq mr b">-g</code>标志编译，如下所示:</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="b74c" class="na ki in mr b gy nb nc l nd ne"> gcc -g test.c -o test</span></pre><p id="28b2" class="pw-post-body-paragraph lf lg in lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc ig bi translated">然后<strong class="lh io"> <em class="mn"> gdb </em> </strong>可以用来运行程序如下:</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="0d28" class="na ki in mr b gy nb nc l nd ne">gdb ./test </span></pre><p id="b858" class="pw-post-body-paragraph lf lg in lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc ig bi translated">一旦<strong class="lh io"> <em class="mn"> gdb </em> </strong>启动，就可以通过键入运行命令来执行程序。例如，要运行上面的程序，可以在 gdb 中键入以下命令:</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="c936" class="na ki in mr b gy nb nc l nd ne">(gdb) run <br/>Starting program: /path/to/your/folder<br/>Enter a number: The number is 42<br/>[Inferior 1 (process 1234) exited normally]<br/> (gdb)</span></pre><figure class="ms mt mu mv gt jo gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/c8b5a30dfee73225bd53fc3f7f501300.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*z2JilMsN2pzIkgef8KhLnw.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">gdb 调试</figcaption></figure><h1 id="4bd2" class="kh ki in bd kj kk mi km kn ko mj kq kr ks mk ku kv kw ml ky kz la mm lc ld le bi translated"><em class="nh">下一个</em>命令</h1><p id="e5aa" class="pw-post-body-paragraph lf lg in lh b li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc ig bi translated">run 命令将启动程序，然后在第一行代码处停止。要继续执行程序，可以使用下一个命令。这将执行下一行代码。</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="b101" class="na ki in mr b gy nb nc l nd ne">(gdb) next<br/>Enter a number: The number is 42 <br/>[Inferior 1 (process 1234) exited normally] <br/>(gdb) </span></pre><p id="600d" class="pw-post-body-paragraph lf lg in lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc ig bi translated">下一个命令可以用来一次执行一行程序。这对于单步执行代码并查看发生了什么非常有用。</p><p id="c014" class="pw-post-body-paragraph lf lg in lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc ig bi translated">print 命令可用于打印变量的值。例如，要打印变量<code class="fe mo mp mq mr b">i</code>的值，可以使用以下命令:</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="20b7" class="na ki in mr b gy nb nc l nd ne">(gdb) print i $1 = 42 (gdb)</span></pre><h1 id="9721" class="kh ki in bd kj kk mi km kn ko mj kq kr ks mk ku kv kw ml ky kz la mm lc ld le bi translated">打印命令</h1><p id="145f" class="pw-post-body-paragraph lf lg in lh b li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc ig bi translated">print 命令也可以用来打印表达式的值。例如，要打印 i+1 的值，可以使用以下命令:</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="744e" class="na ki in mr b gy nb nc l nd ne"> (gdb) print i+1 $2 = 43 (gdb) </span></pre><h1 id="958b" class="kh ki in bd kj kk mi km kn ko mj kq kr ks mk ku kv kw ml ky kz la mm lc ld le bi translated">中断命令</h1><p id="5624" class="pw-post-body-paragraph lf lg in lh b li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc ig bi translated">break 命令可用于在代码中设置断点。断点是程序将停止运行的点。例如，要在打印<code class="fe mo mp mq mr b">i</code>的那一行设置一个断点，可以使用以下命令:</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="bee6" class="na ki in mr b gy nb nc l nd ne">(gdb) break printf <br/>Breakpoint 1 at 0x7ffff7de0770: file ./stdio-common/printf.c, line 28.<br/>(gdb)</span></pre><p id="406e" class="pw-post-body-paragraph lf lg in lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc ig bi translated">break 命令将在调用<code class="fe mo mp mq mr b">printf</code>函数的那一行设置一个断点。然后可以使用 run 命令运行该程序。当到达断点时，程序将停止运行，gdb 将打印即将执行的代码行。</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="fc84" class="na ki in mr b gy nb nc l nd ne">(gdb) run <br/>Starting program: /path/to/your/folder<br/>Enter a number: <br/>Breakpoint 1, main () at test.c:5 <br/>5 printf(“The number is %d “, i); <br/>(gdb)</span></pre><h1 id="3ad1" class="kh ki in bd kj kk mi km kn ko mj kq kr ks mk ku kv kw ml ky kz la mm lc ld le bi translated">继续命令</h1><p id="5f2e" class="pw-post-body-paragraph lf lg in lh b li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc ig bi translated">continue 命令可用于从断点继续运行程序。例如，要从设置在<code class="fe mo mp mq mr b">printf</code>行的断点继续运行程序，可以使用以下命令:</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="cd44" class="na ki in mr b gy nb nc l nd ne">(gdb) continue <br/>Continuing. <br/>The number is 42 [Inferior 1 (process 1234) exited normally] <br/>(gdb) </span></pre><p id="c0ad" class="pw-post-body-paragraph lf lg in lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc ig bi translated">continue 命令将从断点处继续执行程序。程序将一直运行，直到到达下一个断点或完成。</p><h1 id="66c3" class="kh ki in bd kj kk mi km kn ko mj kq kr ks mk ku kv kw ml ky kz la mm lc ld le bi translated">结论</h1><p id="ac51" class="pw-post-body-paragraph lf lg in lh b li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc ig bi translated"><strong class="lh io"> <em class="mn"> gdb </em> </strong>调试器是一个强大的工具，可以帮助你找到并修复程序中的错误。然而，它也是一个复杂的工具，在本文中很难学习如何使用它的所有特性。</p><p id="ae72" class="pw-post-body-paragraph lf lg in lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc ig bi translated">如果您在使用 gdb 时遇到问题，或者您想了解更多关于它的特性，有几个资源可以帮助您。</p><p id="a6cf" class="pw-post-body-paragraph lf lg in lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc ig bi translated"><a class="ae jz" href="https://www.gnu.org/software/gdb/" rel="noopener ugc nofollow" target="_blank"> GNU 调试器网站</a>包含<strong class="lh io"> <em class="mn"> gdb </em> </strong>的文档，以及教程和其他资源。《用 GDB 调试》这本书是使用 gdb 的很好的指南。如果你用的是 Linux，在你喜欢的搜索引擎上搜索“gdb”也可以找到很多<strong class="lh io"> <em class="mn"> gdb </em> </strong>教程和 how-tos。</p><p id="e30c" class="pw-post-body-paragraph lf lg in lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc ig bi translated">如果你喜欢这篇文章，你也可以看看我的<a class="ae jz" href="https://jaredatandi.hashnode.dev/" rel="noopener ugc nofollow" target="_blank"> Hashnode 博客</a>，看看我写的其他软件开发文章。</p></div></div>    
</body>
</html>