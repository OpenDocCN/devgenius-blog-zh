<html>
<head>
<title>Building a Medium-Style Editor with Vue</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Vue构建一个中型编辑器</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/building-a-medium-style-editor-with-vue-9118942a34a8?source=collection_archive---------2-----------------------#2020-11-13">https://blog.devgenius.io/building-a-medium-style-editor-with-vue-9118942a34a8?source=collection_archive---------2-----------------------#2020-11-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div class="gh gi io"><img src="../Images/b92009e7ee6e08d43f2e379147c1123c.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*7m5M2wgbTEBpeQdE8FaO8A.png"/></div></figure><div class=""/><p id="f483" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我绝对喜欢和媒体编辑一起写作。这就是为什么我更有可能在这里写一篇文章，而不是在https://andyhartnett.com</p><p id="1095" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">所以为了打破写作障碍，我决定建立自己的编辑器。还有其他类似的回购，但我想为自己建立这一点。(我喜欢建造东西)</p><p id="e06a" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我用Vue构建了这个，因为它是我最喜欢的JS框架。我能够在一个多小时内制作出这个的原型并发布一个MVP。当我有了想法并想要原型时，我就开始编码。使用Vue的CLI的工作流速度快，使用简单，所以我一直在使用它。</p><h2 id="6506" class="kx ky ix bd kz la lb dn lc ld le dp lf kf lg lh li kj lj lk ll kn lm ln lo lp bi translated">这个概念</h2><p id="54d5" class="pw-post-body-paragraph ju jv ix jw b jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr ij bi translated">我的博客使用存储在数据库中的html。普通的html/css很快，对SEO来说很棒，所以我尽量保持我的博客简单。所以这个中等风格的编辑器就是牢记这一点而构建的。这个想法是，当你写的时候，每一行都存储在一个包含类型和内容的块中，当解析的时候，用普通的html表示。</p><figure class="lw lx ly lz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi lv"><img src="../Images/da9291d02a6f5918ba12a2355a7d330b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2g1oYeb9xJgbl2jz0iIE4g.png"/></div></div></figure><p id="5beb" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">然后当你点击“保存”按钮时，会有一个包含html和块的回调。这个Vue组件接受一个config prop，您可以将回调传递给它。</p><pre class="lw lx ly lz gt me kw mf mg aw mh bi"><span id="ff02" class="kx ky ix kw b gy mi mj l mk ml">&lt;editor :config="config"&gt;&lt;/editor&gt;</span><span id="b226" class="kx ky ix kw b gy mm mj l mk ml">...</span><span id="68d7" class="kx ky ix kw b gy mm mj l mk ml">data() {<br/>    return {<br/>        config: { save: this.save }<br/>    }<br/>},</span><span id="f1ef" class="kx ky ix kw b gy mm mj l mk ml">methods: {<br/>    save(<em class="mn">payload</em>) {<br/>        axios.post('/somewhere', {payload.html, payload.blocks})<br/>    },</span><span id="225b" class="kx ky ix kw b gy mm mj l mk ml">...</span></pre><p id="e2c1" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这个例子中，当你保存内容时，它会在某个地方用数据发出一个post请求。这样你就可以把写好的东西保存在服务器上任何你想保存的地方。save上发生的事情完全取决于你。</p><h2 id="f15c" class="kx ky ix bd kz la lb dn lc ld le dp lf kf lg lh li kj lj lk ll kn lm ln lo lp bi translated">它是如何工作的</h2><p id="0551" class="pw-post-body-paragraph ju jv ix jw b jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr ij bi translated">编辑块时，每个块都是一个<strong class="jw iy">动态输入</strong>。这只是我的文本区域组件包装器的一个虚构术语。像这样:</p><figure class="lw lx ly lz gt is gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/5ac96ed918a86701e335d8bf47602b91.png" data-original-src="https://miro.medium.com/v2/resize:fit:568/format:webp/1*iLMCRs5TX5VxsQ13lMbIhg.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">Editor.vue</figcaption></figure><figure class="lw lx ly lz gt is gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/9c6398ea127b3e7707220f00f034997f.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*j2zuh89sc7gpOWcybmgjMg.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">动态输入</figcaption></figure><p id="f7b7" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我在文本区域有一些方法来决定行为。主要是，如果你按回车键或退格键，你可能需要创建一个新的块，或者删除当前的块，如果它是空的。当这种情况发生时，我们需要将聚焦的文本区域改变到正确的位置。</p><figure class="lw lx ly lz gt is gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/d90c9484ac62544c0a1f1425885ba75b.png" data-original-src="https://miro.medium.com/v2/resize:fit:846/format:webp/1*24WOF2F2C2ao0NqiLw3tgg.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">关键事件的方法</figcaption></figure><p id="d3ee" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我还发现了一个很酷的技巧来确保文本区域总是和内容一样大，就像你在上面看到的<code class="fe kt ku kv kw b">e.target.style.height</code>引用一样。您还可以看到，我为<code class="fe kt ku kv kw b">newLine</code>和<code class="fe kt ku kv kw b">deleteLine</code>发出了事件，父组件将使用这些事件来拼接blocks数组。</p><p id="3502" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">然后是媒体选择器改变内容类型的魔力，就像这样:</p><figure class="lw lx ly lz gt is gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/7b9c46ff3057168a1985c1f2a2e6b98c.png" data-original-src="https://miro.medium.com/v2/resize:fit:564/format:webp/1*vZ9YGgQBwvusuIqFHIiy-A.png"/></div></figure><p id="685b" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这只是一个绝对定位的div，带有用于更新块的<code class="fe kt ku kv kw b">type</code>的按钮。神奇之处在于当文本被选中时显示这个div:</p><figure class="lw lx ly lz gt is gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/897d9b40abbc28ab7ef32d2f4f992e82.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*g5LNYkKn8FzjWfjUWXATrQ.png"/></div></figure><p id="2f5a" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这个方法在textarea上的<code class="fe kt ku kv kw b">@mouseup</code>上被调用。它检查是否选择了整行，如果是，它将selected属性设置为true，这又会显示选项按钮。</p><p id="3151" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">剩下的就是处理扑救了。这是在编辑器组件中完成的。当您单击save时，它会将块转换为html，然后调用传入的保存回调函数:</p><figure class="lw lx ly lz gt is gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/f984ed9473731bb330ce7c0dd4787605.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*_l7UhIAUM14xPl1-E1TFZQ.png"/></div></figure><p id="ed50" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">就是这样！可以在这里全面看一下回购:<a class="ae ks" href="https://github.com/andrewhartnett/medium-styled-vue-editor" rel="noopener ugc nofollow" target="_blank">https://github.com/andrewhartnett/medium-styled-vue-editor</a></p><h2 id="e127" class="kx ky ix bd kz la lb dn lc ld le dp lf kf lg lh li kj lj lk ll kn lm ln lo lp bi translated">结论</h2><p id="a3ba" class="pw-post-body-paragraph ju jv ix jw b jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr ij bi translated">我有一个编辑器，我更有可能用它来在我的个人网站上写博客，我还有一个repo live，我会继续添加。在不久的将来，我可以看到添加图像上传支持和报价支持。最终，我想建立链接预览，但这是一个项目的另一天。</p><p id="ef07" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果这是您要使用的东西，那么为了您自己的目的，继续克隆/派生/窃取代码。我希望它能帮助那些写博客的人。</p><p id="8c79" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">下次见，感谢阅读！</p><h1 id="bfe0" class="my ky ix bd kz mz na nb lc nc nd ne lf nf ng nh li ni nj nk ll nl nm nn lo no bi translated">当你在这里的时候。在twitter上关注我:)</h1><p id="d9e2" class="pw-post-body-paragraph ju jv ix jw b jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr ij bi translated">【https://twitter.com/andyhartnett12 T2】号</p></div></div>    
</body>
</html>