<html>
<head>
<title>Nuxt.js — Plugins and Modules</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Nuxt.js —插件和模块</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/nuxt-js-plugins-and-modules-b0364dab5611?source=collection_archive---------4-----------------------#2020-12-28">https://blog.devgenius.io/nuxt-js-plugins-and-modules-b0364dab5611?source=collection_archive---------4-----------------------#2020-12-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/8603b615fb41c44401b6059b1afb39e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Gs3WU6lJYtnlhGzs"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@morningbrew?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">晨酿</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="866b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Nuxt.js 是一个基于 Vue.js 的应用框架。</p><p id="28fa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用它来创建服务器端渲染应用和静态站点。</p><p id="392c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解如何在客户端和服务器端环境中使用插件并创建模块。</p><h1 id="19fe" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">客户端或服务器端插件</h1><p id="2753" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以将插件配置为只在客户端或服务器端可用。</p><p id="ea6b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一种方法是在文件名中添加<code class="fe me mf mg mh b">client.js</code>来创建一个客户端专用插件。</p><p id="e6dd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以在文件名中添加<code class="fe me mf mg mh b">server.js</code>来创建一个服务器端的插件。</p><p id="57cb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，在<code class="fe me mf mg mh b">nuxt.config.js</code>中，我们可以这样写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="f776" class="mq lc iq mh b gy mr ms l mt mu">export default {<br/>  plugins: [<br/>    '~/plugins/foo.client.js',<br/>    '~/plugins/bar.server.js',<br/>    '~/plugins/baz.js'<br/>  ]<br/>}</span></pre><p id="b7eb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果没有后缀，那么插件在所有环境中都可用。</p><p id="5779" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用对象语法做同样的事情。</p><p id="7e30" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="b180" class="mq lc iq mh b gy mr ms l mt mu">export default {<br/>  plugins: [<br/>    { src: '~/plugins/both-sides.js' },<br/>    { src: '~/plugins/client-only.js', mode: 'client' },<br/>    { src: '~/plugins/server-only.js', mode: 'server' }<br/>  ]<br/>}</span></pre><p id="4532" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">可以将<code class="fe me mf mg mh b">mode</code>属性设置为<code class="fe me mf mg mh b">'client'</code>，使插件在客户端可用。</p><p id="ef53" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了使插件在服务器端可用，我们可以将<code class="fe me mf mg mh b">mode</code>设置为<code class="fe me mf mg mh b">'server'</code>。</p><p id="2fb4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于只在服务器端可用的插件，我们可以在运行代码之前检查插件代码中的<code class="fe me mf mg mh b">process.server</code>是否为<code class="fe me mf mg mh b">true</code>。</p><p id="47d3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同样，在静态页面上运行插件代码之前，我们可以检查<code class="fe me mf mg mh b">process.static</code>是否是<code class="fe me mf mg mh b">true</code>。</p><h1 id="ce44" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">Nuxt.js 模块</h1><p id="385b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">js 附带了一些模块，我们可以用它们来扩展 Nuxt 的核心功能。</p><p id="e777" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">@nuxt/http</code>用于发出 HTTP 请求。</p><p id="c0c4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">@nuxt/content</code>用于通过类似 MongoDB 的 API 编写内容和获取 Markdown、JSON、YAML 和 CSV 文件。</p><p id="4e04" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">@nuxtjs/axios</code>是一个模块，用于 Axios 集成以发出 HTTP 请求。</p><p id="e261" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">@nuxtjs/pwa</code>用于创建 PWAs。</p><p id="f7f3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">@nuxtjs/auth</code>用于添加认证。</p><h1 id="e63e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">编写一个模块</h1><p id="eee1" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以创建自己的模块。</p><p id="d754" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要添加一个，我们可以在<code class="fe me mf mg mh b">modules</code>文件夹中创建一个文件。</p><p id="6ed4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以创建一个<code class="fe me mf mg mh b">modules/simple.js</code>文件，并编写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="75d2" class="mq lc iq mh b gy mr ms l mt mu">export default function SimpleModule(moduleOptions) {<br/>  // ...<br/>}</span></pre><p id="e76d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以将该模块添加到<code class="fe me mf mg mh b">nuxt.config.js</code>中，以便我们可以使用它:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="594f" class="mq lc iq mh b gy mr ms l mt mu">modules: [<br/>  ['~/modules/simple', { token: '123' }]<br/>],</span></pre><p id="ec9c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后将第二个条目中的对象作为参数传递给<code class="fe me mf mg mh b">SimpleModule</code>函数。</p><p id="8765" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">模块可以是异步的。</p><h1 id="c06b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">仅生成模块</h1><p id="95d9" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以创建只构建模块，并将它们放在<code class="fe me mf mg mh b">nuxt.config.js</code>的<code class="fe me mf mg mh b">buildModules</code>数组中。</p><p id="7be0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><p id="5c0d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">modules/async.js</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="3660" class="mq lc iq mh b gy mr ms l mt mu">import fse from 'fs-extra'</span><span id="0d5f" class="mq lc iq mh b gy mv ms l mt mu">export default async function asyncModule() {<br/>  const pages = await fse.readJson('./pages.json')<br/>  console.log(pages);<br/>}</span></pre><p id="595e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们添加了<code class="fe me mf mg mh b">fs-extra</code>模块来读取文件。</p><p id="2c62" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该函数是异步的，所以它返回一个承诺，解析后的值就是我们返回的值。</p><p id="1d42" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe me mf mg mh b">nuxt.config.js</code>中，我们加上:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="9e2d" class="mq lc iq mh b gy mr ms l mt mu">buildModules: [<br/>  '~/modules/async'<br/>],</span></pre><p id="e3b4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">添加我们的模块。</p><p id="f5bd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该模块将在我们运行开发服务器或构建时加载。</p><h1 id="eaff" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="e689" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用 Nuxt 创建在客户端或服务器端可用的模块和插件。</p></div></div>    
</body>
</html>