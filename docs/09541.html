<html>
<head>
<title>Add Parallax Animation To Your Flutter App Using VelocityX and Sensor Plus</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 VelocityX 和 Sensor Plus 将视差动画添加到您的 Flutter 应用程序</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/add-parallax-animation-to-your-flutter-app-using-velocityx-and-sensor-plus-c0a832e4e12f?source=collection_archive---------6-----------------------#2022-08-27">https://blog.devgenius.io/add-parallax-animation-to-your-flutter-app-using-velocityx-and-sensor-plus-c0a832e4e12f?source=collection_archive---------6-----------------------#2022-08-27</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="8870" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">了解在 Flutter 中使用补间动画的新方法</h2></div><p id="26ad" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi ky translated">每个人都知道视差动画看起来很酷，真的很有趣，但不是每个人都知道将其实际应用到应用程序中有多困难。在这篇文章中，我将向你展示一个快速简单的方法，使用<code class="fe lh li lj lk b">TweenAnimationBuilder</code>小部件、transform 小部件和 2 个方便的包，将它添加到你的 Flutter 应用程序中。</p><div class="ll lm gp gr ln lo"><a href="https://youtube.com/shorts/jOK9zFSLhzU?feature=share" rel="noopener  ugc nofollow" target="_blank"><div class="lp ab fo"><div class="lq ab lr cl cj ls"><h2 class="bd io gy z fp lt fr fs lu fu fw im bi translated">使用 Flutter、VelocityX 和 Sensor_Plus 制作的视差效果</h2><div class="lv l"><h3 class="bd b gy z fp lt fr fs lu fu fw dk translated">展示本文最终产品的快速视频</h3></div><div class="lw l"><p class="bd b dl z fp lt fr fs lu fu fw dk translated">youtube.com</p></div></div></div></a></div><h2 id="2966" class="lx ly in bd lz ma mb dn mc md me dp mf kl mg mh mi kp mj mk ml kt mm mn mo mp bi translated">首先，我们需要什么来实现这个目标:</h2><ol class=""><li id="fbe7" class="mq mr in ke b kf ms ki mt kl mu kp mv kt mw kx mx my mz na bi translated">颤动(当然)</li><li id="df8b" class="mq mr in ke b kf nb ki nc kl nd kp ne kt nf kx mx my mz na bi translated">VelocityX 颤振包(不是强制性的，但帮助很大)</li><li id="281f" class="mq mr in ke b kf nb ki nc kl nd kp ne kt nf kx mx my mz na bi translated">传感器+颤振组件(非常重要)</li><li id="8ed4" class="mq mr in ke b kf nb ki nc kl nd kp ne kt nf kx mx my mz na bi translated">最后但并非最不重要的一点是在 Flutter 中使用构建器小部件的知识</li></ol><div class="ll lm gp gr ln lo"><a href="https://api.flutter.dev/flutter/widgets/TweenAnimationBuilder-class.html" rel="noopener  ugc nofollow" target="_blank"><div class="lp ab fo"><div class="lq ab lr cl cj ls"><h2 class="bd io gy z fp lt fr fs lu fu fw im bi translated">TweenAnimationBuilder 类-小部件库- Dart API</h2><div class="lv l"><h3 class="bd b gy z fp lt fr fs lu fu fw dk translated">小部件生成器，每当目标值改变时，它将小部件的属性动画化为目标值。的类型</h3></div><div class="lw l"><p class="bd b dl z fp lt fr fs lu fu fw dk translated">api.flutter.dev</p></div></div></div></a></div><h1 id="6e1a" class="ng ly in bd lz nh ni nj mc nk nl nm mf jt nn ju mi jw no jx ml jz np ka mo nq bi translated">我们开始吧</h1><p id="e9a7" class="pw-post-body-paragraph kc kd in ke b kf ms jo kh ki mt jr kk kl nr kn ko kp ns kr ks kt nt kv kw kx ig bi translated">好吧！现在您已经浏览了 TweenAnimationBuilder 文档，应该对它有了基本的了解。我鼓励您快速阅读 Sensor_Plus 软件包文档和 VelocityX 文档，因为它们将来会对您有所帮助。</p><p id="b6c5" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为了开始这样做，请确保您已经有一个想要添加的 Flutter 应用程序，或者只需在您的终端中运行<code class="fe lh li lj lk b">flutter create app-name</code>。</p><p id="0e1a" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">首先你需要打开<code class="fe lh li lj lk b">pubspec.yaml</code>文件，安装我之前提到的包(velocityx 和 sensor_plus)。</p><p id="6f5a" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">完成后，你要做的第二件事是进入你的<code class="fe lh li lj lk b">app-name/lib</code>目录并打开 main.dart。在这里你会看到许多生成的代码，你可以暂时不要它，只需创建另一个。<code class="fe lh li lj lk b">app-name/lib</code>中的 dart 文件，它将包含视差动画小部件。您可以随意命名该文件。</p><h1 id="a633" class="ng ly in bd lz nh ni nj mc nk nl nm mf jt nn ju mi jw no jx ml jz np ka mo nq bi translated">现在让我们开始编码</h1><p id="c238" class="pw-post-body-paragraph kc kd in ke b kf ms jo kh ki mt jr kk kl nr kn ko kp ns kr ks kt nt kv kw kx ig bi translated">一旦您在代码编辑器中打开这个文件，您就可以继续创建有状态小部件，或者使用附带 Flutter VSCode 扩展的<code class="fe lh li lj lk b">stfl</code> —有状态小部件生成器代码片段。你应该有这样的东西</p><figure class="nu nv nw nx gt ny"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="05f6" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">好了，现在你已经生成了一个基本的有状态小部件，是时候修改一些东西了。首先让我们将<code class="fe lh li lj lk b">TickerProviderStateMixin</code>添加到<code class="fe lh li lj lk b">_MyWidgetState</code>类中。</p><figure class="nu nv nw nx gt ny"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="0573" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">有了它，你就可以随心所欲地制作每秒 60 帧的动画了。并尽力阅读代码中的注释，因为代码在注释中的解释要比在文章中多得多。</p><h2 id="e2cc" class="lx ly in bd lz ma mb dn mc md me dp mf kl mg mh mi kp mj mk ml kt mm mn mo mp bi translated">把价值排除在外</h2><p id="3ca0" class="pw-post-body-paragraph kc kd in ke b kf ms jo kh ki mt jr kk kl nr kn ko kp ns kr ks kt nt kv kw kx ig bi translated">这里，我们将定义变量来保存我们将从 Sensor_Plus 包接收的角度值。</p><figure class="nu nv nw nx gt ny"><div class="bz fp l di"><div class="nz oa l"/></div><figcaption class="ob oc gj gh gi od oe bd b be z dk translated">花点时间看看评论</figcaption></figure><p id="9f75" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">好的，正如注释中已经解释的那样，带有角度的值用于存储我们将从<code class="fe lh li lj lk b">accelerometerEvents.listen</code>方法接收的数据。另一方面,<code class="fe lh li lj lk b">streamsub</code>值将被用作流订阅的数组。这里的 StreamSubscription 类用于正确键入数组，让 flutter 知道这是 StreamSubscription 对象的数组。每当你在流上使用<code class="fe lh li lj lk b">.listen</code>方法时，返回的对象是一个<code class="fe lh li lj lk b">StreamSubscription</code>对象。更多关于 StreamSubscription 如下。</p><div class="ll lm gp gr ln lo"><a href="https://api.flutter.dev/flutter/dart-async/StreamSubscription-class.html" rel="noopener  ugc nofollow" target="_blank"><div class="lp ab fo"><div class="lq ab lr cl cj ls"><h2 class="bd io gy z fp lt fr fs lu fu fw im bi translated">StreamSubscription 类- dart:异步库- Dart API</h2><div class="lv l"><h3 class="bd b gy z fp lt fr fs lu fu fw dk translated">dart:async 库中 StreamSubscription 类的 API 文档，用于 dart 编程语言。</h3></div><div class="lw l"><p class="bd b dl z fp lt fr fs lu fu fw dk translated">api.flutter.dev</p></div></div></div></a></div><p id="4ec3" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们让<code class="fe lh li lj lk b">build</code>函数返回一个<code class="fe lh li lj lk b">Column</code>小部件，因为如果没有返回任何东西，就会出现错误。</p><p id="748a" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在让我们调用<code class="fe lh li lj lk b">void initState</code>和<code class="fe lh li lj lk b">void dispose</code>，这样我们就可以初始化我们的<code class="fe lh li lj lk b">accelerometerEvents.listen</code>。我们还将在<code class="fe lh li lj lk b">.listen()</code>回调函数中改变 xAngle、prevXAngle、杨乐、prevYAngle、zAngle 和 prevZAngle 变量的状态。我们走吧👇</p><figure class="nu nv nw nx gt ny"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="ab65" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们利用<code class="fe lh li lj lk b">initState</code>和<code class="fe lh li lj lk b">dispose</code>函数来分别订阅和取消订阅流。</p><p id="1fd9" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">注意，在<code class="fe lh li lj lk b">streamsub.add</code>方法中，我们将<code class="fe lh li lj lk b">accelerometerEvents.listen()</code>添加到我们的流订阅数组中。在 listen 方法中，我们有一个函数，它给出了加速度计事件的实时值。事件对象有 3 个值:x、y 和 z。请确保在设置角度值的新状态之前设置了先前角度值的状态，这对接下来的操作非常重要。</p><h2 id="215b" class="lx ly in bd lz ma mb dn mc md me dp mf kl mg mh mi kp mj mk ml kt mm mn mo mp bi translated">动画时间到了</h2><p id="3b61" class="pw-post-body-paragraph kc kd in ke b kf ms jo kh ki mt jr kk kl nr kn ko kp ns kr ks kt nt kv kw kx ig bi translated">现在这些值正在实时更新，我们可以开始使用名为<code class="fe lh li lj lk b"><strong class="ke io">TweenAnimationBuilder</strong></code> <strong class="ke io"> </strong>的 flutter 小部件来使用它们。我们将使用我们之前添加的<code class="fe lh li lj lk b">Column</code>小部件，当然你可以使用任何你想要的容器小部件，但是我使用<code class="fe lh li lj lk b">Column</code>以防我想在小部件后添加任何东西。好吧，让我们开始吧</p><figure class="nu nv nw nx gt ny"><div class="bz fp l di"><div class="nz oa l"/></div><figcaption class="ob oc gj gh gi od oe bd b be z dk translated">注意小部件旁边的注释</figcaption></figure><p id="08cb" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在上面的代码片段中，我们使用了 2 个<code class="fe lh li lj lk b">TweenAnimationBuilder</code>小部件。这是因为我们将为 2 个轴的值制作动画，首先是 X 轴，然后是 y 轴。我们将通过<code class="fe lh li lj lk b">Transform</code>小部件来实现这一点。你可能想知道为什么我们要使用 zAngle 值，如果我们要制作 Y 轴的动画。这是因为你在 3D 空间移动设备的方式，利用 zAngle 可以产生最好的效果。正如您稍后将看到的，被解析为<code class="fe lh li lj lk b">rotateX</code>和<code class="fe lh li lj lk b">rotateY</code> <code class="fe lh li lj lk b">Matrix4.indentity()</code>方法的值看起来有点不匹配。好了，现在让我们来看看实际使用的值</p><figure class="nu nv nw nx gt ny"><div class="bz fp l di"><div class="nz oa l"/></div><figcaption class="ob oc gj gh gi od oe bd b be z dk translated">*(星号)注释将在下面解释</figcaption></figure><ul class=""><li id="e90e" class="mq mr in ke b kf kg ki kj kl of kp og kt oh kx oi my mz na bi translated">*1.这里我们传入了由<code class="fe lh li lj lk b">TweenAnimationBuilder</code>提供的动画<code class="fe lh li lj lk b">zValue</code>的负片。你可能会问为什么是负的，就像我之前说的，这是因为你在 3D 空间移动设备的方式。In 以一种更理想的方式翻译，就好像我们要使用正的<code class="fe lh li lj lk b">zValue</code>或生成一个 yValue。</li><li id="461e" class="mq mr in ke b kf nb ki nc kl nd kp ne kt nf kx oi my mz na bi translated">*2.在这里我们通过了<code class="fe lh li lj lk b">xValue</code>。是的，不是负面的，只是正面的<code class="fe lh li lj lk b">xValue</code>。</li></ul><p id="69ed" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我相信你有兴趣知道为什么这些值要除以 10。这是因为如果它们不除以 10，视差运动将是太多的事件，如果设备稍微转动。</p><ul class=""><li id="f399" class="mq mr in ke b kf kg ki kj kl of kp og kt oh kx oi my mz na bi translated">*3.我们在这里使用了<code class="fe lh li lj lk b">xValue</code>和<code class="fe lh li lj lk b">zValue</code>，并将它们乘以 8，以便为视差卡获得更好的阴影效果。</li></ul><p id="823b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这样我们就完成了视差动画，现在我们可以在我们的应用程序中看到它。我们需要做的就是将这个小部件作为一个小部件添加到我们的<code class="fe lh li lj lk b">main.dart</code>文件中。像这样</p><figure class="nu nv nw nx gt ny"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="29b5" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">要让你的<code class="fe lh li lj lk b">main.dart</code>文件看起来像这样，只要确保去掉你之前生成应用程序时附带的所有样板文件。将<code class="fe lh li lj lk b">NameOfParallaxWidget()</code>替换成你自己命名的视差小部件。</p><h1 id="0eb8" class="ng ly in bd lz nh ni nj mc nk nl nm mf jt nn ju mi jw no jx ml jz np ka mo nq bi translated">结论</h1><p id="2c87" class="pw-post-body-paragraph kc kd in ke b kf ms jo kh ki mt jr kk kl nr kn ko kp ns kr ks kt nt kv kw kx ig bi translated">现在，当你运行你的 flutter 应用程序时，你应该有这样的东西</p><figure class="nu nv nw nx gt ny gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/f9e626dea721734c254f4e011ad6e780.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*U3nZzK385WfOhUZkFzlutw.gif"/></div></figure><p id="4748" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这就是你的视差动画。您可以将这种方法应用到任何您想要制作动画的小部件上，只需将<code class="fe lh li lj lk b">VxBox</code>小部件更改为您想要制作动画的另一个小部件。你甚至可以在文本上使用它，但是最好是在文本容器上使用它😅。</p><p id="f823" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这是我的回购的链接</p><div class="ll lm gp gr ln lo"><a href="https://github.com/michaelessiet/flutter-test/blob/master/lib/widgets/parallaxnft_widget.dart" rel="noopener  ugc nofollow" target="_blank"><div class="lp ab fo"><div class="lq ab lr cl cj ls"><h2 class="bd io gy z fp lt fr fs lu fu fw im bi translated">主 michaelessiet/flutter-test/parallaxnft _ widget . dart</h2><div class="lv l"><h3 class="bd b gy z fp lt fr fs lu fu fw dk translated">此文件包含双向 Unicode 文本，其解释或编译可能与下面显示的不同…</h3></div><div class="lw l"><p class="bd b dl z fp lt fr fs lu fu fw dk translated">github.com</p></div></div><div class="om l"><div class="on l oo op oq om or ok lo"/></div></div></a></div><p id="7977" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">希望这篇文章能帮到你。如果是的话，为什么不留下掌声呢👏和分享😁。</p><p id="3ae9" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果您想添加到回购中，请随意留下一个 PR 或 fork 并进行试验。如果我做错了什么，不要不好意思在评论中告诉我。我一直在寻找改进的方法。</p><p id="fd3f" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">感谢阅读❤️有一个伟大的时间玩忽职守。</p></div><div class="ab cl os ot hr ou" role="separator"><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox"/></div><div class="ig ih ii ij ik"><div class="nu nv nw nx gt lo"><a href="https://devshogun.medium.com/pull-to-refresh-or-search-using-flutter-e06e57b3b5e2" rel="noopener follow" target="_blank"><div class="lp ab fo"><div class="lq ab lr cl cj ls"><h2 class="bd io gy z fp lt fr fs lu fu fw im bi translated">使用 Flutter 拉动以刷新或搜索</h2><div class="lv l"><h3 class="bd b gy z fp lt fr fs lu fu fw dk translated">嗨，伙计们，这篇文章将讲述如何使用 Flutter，VelocityX 和 Simple……</h3></div><div class="lw l"><p class="bd b dl z fp lt fr fs lu fu fw dk translated">devshogun.medium.com</p></div></div><div class="om l"><div class="oz l oo op oq om or ok lo"/></div></div></a></div><h2 id="56c4" class="lx ly in bd lz ma mb dn mc md me dp mf kl mg mh mi kp mj mk ml kt mm mn mo mp bi translated">看看我的其他一些文章👆</h2></div></div>    
</body>
</html>