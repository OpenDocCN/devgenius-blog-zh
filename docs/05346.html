<html>
<head>
<title>Javascript/Typescript Pass by Reference</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Javascript/Typescript通过引用传递</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/javascript-typescript-pass-by-reference-d7f273ce47af?source=collection_archive---------1-----------------------#2021-07-23">https://blog.devgenius.io/javascript-typescript-pass-by-reference-d7f273ce47af?source=collection_archive---------1-----------------------#2021-07-23</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="261c" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">为Javascript/Typescript提供类似C的宏函数</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/0a8fded8d0b2e1387136344bc6eaab4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tc90FhOr8U4x04kzqguVuA.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">图片来自Pixabay.com</figcaption></figure><h2 id="96f7" class="ks kt in bd ku kv kw dn kx ky kz dp la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">介绍</h2><p id="40cd" class="pw-post-body-paragraph lo lp in lq b lr ls jo lt lu lv jr lw lb lx ly lz lf ma mb mc lj md me mf mg ig bi translated">大家好，我的名字是Marcelo Mancini，又名Hipreme/MrcSnm，我主要是一名游戏开发人员，我一直在为开源社区编写大量代码。</p><h2 id="065b" class="ks kt in bd ku kv kw dn kx ky kz dp la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">摘要</h2><p id="6b08" class="pw-post-body-paragraph lo lp in lq b lr ls jo lt lu lv jr lw lb lx ly lz lf ma mb mc lj md me mf mg ig bi translated">一个插件，它将启用Javascript/Typescript代码中定义的宏函数。这样，你可以在脚本中传递引用变量，然后，你可以在任何地方调用宏函数。它的工作方式很像C，它会遵循一些规则进行智能文本替换。</p><h2 id="8ed4" class="ks kt in bd ku kv kw dn kx ky kz dp la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">它是如何工作的</h2><p id="bfa3" class="pw-post-body-paragraph lo lp in lq b lr ls jo lt lu lv jr lw lb lx ly lz lf ma mb mc lj md me mf mg ig bi translated">这是一个webpack加载器，它使用saves宏定义。定义总是从一个文件导入另一个文件。</p><p id="b017" class="pw-post-body-paragraph lo lp in lq b lr mh jo lt lu mi jr lw lb mj ly lz lf mk mb mc lj ml me mf mg ig bi translated">要添加到您的配置中，只需:</p><p id="bdac" class="pw-post-body-paragraph lo lp in lq b lr mh jo lt lu mi jr lw lb mj ly lz lf mk mb mc lj ml me mf mg ig bi translated"><code class="fe mm mn mo mp b">{ test: /\.(t|j)s$/, use: [{ loader: path.resolve('../define_macro-loader.js')}]}</code></p><p id="c9bd" class="pw-post-body-paragraph lo lp in lq b lr mh jo lt lu mi jr lw lb mj ly lz lf mk mb mc lj ml me mf mg ig bi translated">要在代码中应用它，只需调用以下代码:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="dcfc" class="pw-post-body-paragraph lo lp in lq b lr mh jo lt lu mi jr lw lb mj ly lz lf mk mb mc lj ml me mf mg ig bi translated">你可以注意到，它在第一次是相当奇怪的。因为我们设置的是v，应该是复制的值。</p><p id="9aea" class="pw-post-body-paragraph lo lp in lq b lr mh jo lt lu mi jr lw lb mj ly lz lf mk mb mc lj ml me mf mg ig bi translated">发生这种情况是因为这不是复制的值，而是传递给函数的实际值，因此，对“v”参数的任何更改都会改变传递给函数的参数，这样，我们就能够创建不复制值的函数。</p><p id="c58c" class="pw-post-body-paragraph lo lp in lq b lr mh jo lt lu mi jr lw lb mj ly lz lf mk mb mc lj ml me mf mg ig bi translated">在<code class="fe mm mn mo mp b">DEFINE</code>调用之后，你将能够调用你定义的变量，在那种情况下是<code class="fe mm mn mo mp b">GetRef</code>。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="6ce1" class="pw-post-body-paragraph lo lp in lq b lr mh jo lt lu mi jr lw lb mj ly lz lf mk mb mc lj ml me mf mg ig bi translated">用简单的就地替换来替换任何“返回”调用是足够聪明的。代码输出将是:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="e2e1" class="pw-post-body-paragraph lo lp in lq b lr mh jo lt lu mi jr lw lb mj ly lz lf mk mb mc lj ml me mf mg ig bi translated">所以这几乎是对任何代码片段的简单复制和粘贴，允许在javascript/typescript中使用变量引用。这让你想起指针了吗？GetRef(variable)的工作方式与&amp;variable非常相似</p><p id="10f7" class="pw-post-body-paragraph lo lp in lq b lr mh jo lt lu mi jr lw lb mj ly lz lf mk mb mc lj ml me mf mg ig bi translated">其他一些简单的例子:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><h2 id="62d5" class="ks kt in bd ku kv kw dn kx ky kz dp la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">催单</h2><ul class=""><li id="aa17" class="ms mt in lq b lr ls lu lv lb mu lf mv lj mw mg mx my mz na bi translated">不能在第一个文件中使用其他地方定义的宏。如果你想使用它，你需要建立一个间接层来使用它们，例如:index.ts需要“宏”，然后，你的app.ts将能够使用在macros.ts中定义的宏</li><li id="a0bf" class="ms mt in lq b lr nb lu nc lb nd lf ne lj nf mg mx my mz na bi translated">如果您进行任何类型的变量操作，它将为插入任何操作创建一个新的范围</li></ul><h2 id="2ce5" class="ks kt in bd ku kv kw dn kx ky kz dp la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">交互工作的推荐插件</h2><ul class=""><li id="ba6d" class="ms mt in lq b lr ls lu lv lb mu lf mv lj mw mg mx my mz na bi translated"><a class="ae ng" href="https://www.npmjs.com/package/babel-plugin-preval" rel="noopener ugc nofollow" target="_blank"> Babel Preval Plugin </a>，原因:你可以创建宏来获取文件名并在编译时对其进行预评估。preval对于宏变得更加有用，查看它在macro _FILENAME_NO_EXT上的用例。如果您检查输出，您会看到它快了多少。</li><li id="029c" class="ms mt in lq b lr nb lu nc lb nd lf ne lj nf mg mx my mz na bi translated"><a class="ae ng" href="https://www.npmjs.com/package/babel-plugin-ts-nameof" rel="noopener ugc nofollow" target="_blank"> Typescript Nameof Plugin </a>，原因:你可以将你的变量名保存为一个字符串。这个插件实际上是由宏授权的，因为你通过引用而不是值来获得变量，所以名字不会丢失。</li></ul><h2 id="ea92" class="ks kt in bd ku kv kw dn kx ky kz dp la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">特征</h2><ul class=""><li id="e68a" class="ms mt in lq b lr ls lu lv lb mu lf mv lj mw mg mx my mz na bi translated">不接受参数宏(但括号仍然是必要的)</li><li id="863c" class="ms mt in lq b lr nb lu nc lb nd lf ne lj nf mg mx my mz na bi translated">宏接受多个变量。这样，我们就有可能:</li></ul><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><blockquote class="nh ni nj"><p id="7f3f" class="lo lp nk lq b lr mh jo lt lu mi jr lw nl mj ly lz nm mk mb mc nn ml me mf mg ig bi translated">是的，有了新的宏，我们可以进行就地交换。</p></blockquote><ul class=""><li id="07b5" class="ms mt in lq b lr mh lu mi lb no lf np lj nq mg mx my mz na bi translated">在define中定义函数的可能性。例如:</li></ul><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="7773" class="pw-post-body-paragraph lo lp in lq b lr mh jo lt lu mi jr lw lb mj ly lz lf mk mb mc lj ml me mf mg ig bi translated">这样，Test将获得方法toString()，该方法将返回“Test”，不仅如此，您还可以为不同的类定义多少样板代码，并使用传递的参数对这些样板代码进行参数化，从而提高您的生产率。</p></div><div class="ab cl nr ns hr nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="ig ih ii ij ik"><h2 id="e5f6" class="ks kt in bd ku kv kw dn kx ky kz dp la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">酷！我想尝试一下</h2><p id="f7b4" class="pw-post-body-paragraph lo lp in lq b lr ls jo lt lu lv jr lw lb lx ly lz lf ma mb mc lj md me mf mg ig bi translated">只需找到您的package.json并编写以下代码:</p><p id="669c" class="pw-post-body-paragraph lo lp in lq b lr mh jo lt lu mi jr lw lb mj ly lz lf mk mb mc lj ml me mf mg ig bi translated"><code class="fe mm mn mo mp b">npm i -D @hipreme_entertainment/define_macro-loader</code></p></div><div class="ab cl nr ns hr nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="ig ih ii ij ik"><p id="e586" class="pw-post-body-paragraph lo lp in lq b lr mh jo lt lu mi jr lw lb mj ly lz lf mk mb mc lj ml me mf mg ig bi translated"><em class="nk">学习是我的生活方式，马塞洛·席尔瓦·纳西门托·曼奇尼</em></p><p id="116e" class="pw-post-body-paragraph lo lp in lq b lr mh jo lt lu mi jr lw lb mj ly lz lf mk mb mc lj ml me mf mg ig bi translated"><a class="ae ng" href="https://www.github.com/MrcSnm" rel="noopener ugc nofollow" target="_blank"> <em class="nk"> Github </em> </a></p><p id="e908" class="pw-post-body-paragraph lo lp in lq b lr mh jo lt lu mi jr lw lb mj ly lz lf mk mb mc lj ml me mf mg ig bi translated"><a class="ae ng" href="https://www.linkedin.com/in/mrcsnm" rel="noopener ugc nofollow" target="_blank"> <em class="nk">领英</em> </a></p><p id="1056" class="pw-post-body-paragraph lo lp in lq b lr mh jo lt lu mi jr lw lb mj ly lz lf mk mb mc lj ml me mf mg ig bi translated"><em class="nk"> Hipreme/MrcSnm </em></p></div></div>    
</body>
</html>