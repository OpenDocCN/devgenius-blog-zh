<html>
<head>
<title>Web Scraping With Playwright</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">剧作家的网络搜集</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/web-scraping-with-playwright-1d9960909061?source=collection_archive---------2-----------------------#2021-11-10">https://blog.devgenius.io/web-scraping-with-playwright-1d9960909061?source=collection_archive---------2-----------------------#2021-11-10</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="fd80" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">不管是谁在读这篇文章，你好，我们今天要做更多的网络搜集，这次我们将介绍剧作家</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/366b2796b87cefd541e4268577b18548.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UR84lIEVFvKkuJ0h1dhwZg.png"/></div></figure><p id="ce77" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">我们在建造什么</strong></p><p id="bada" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们正在构建一个简单的web scraper，它将获取任何子编辑的前25篇帖子，在本教程结束时，我们将拥有这个整齐放置的post对象数组</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kq"><img src="../Images/1e0f5115537497740b3bd7e2d7fe6d95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H5lqCjZy1TyCCoQHrOGCQQ.png"/></div></div></figure><p id="9a58" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">设置我们的项目</strong></p><p id="64a1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">使用<code class="fe kv kw kx ky b">mkdir reddit_scraper</code>创建一个新目录，然后使用<code class="fe kv kw kx ky b">cd reddit_scraper</code>导航到该目录</p><ol class=""><li id="3706" class="kz la in jm b jn jo jr js jv lb jz lc kd ld kh le lf lg lh bi translated">用<code class="fe kv kw kx ky b">npm init --y</code>初始化项目，然后点击回车</li><li id="aec2" class="kz la in jm b jn li jr lj jv lk jz ll kd lm kh le lf lg lh bi translated">用<code class="fe kv kw kx ky b">npm i --save playwright</code>安装剧作家，这需要一些时间，因为它需要安装3个浏览器的驱动程序</li><li id="d855" class="kz la in jm b jn li jr lj jv lk jz ll kd lm kh le lf lg lh bi translated">完成后，创建index.js，现在文件结构应该如下所示</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/3c55457f9a308c2f8271b02b8e67669d.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/format:webp/1*IT7JNIIfFP1vAvpgFluYbA.png"/></div></figure><p id="4abc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">到底什么是剧作家</strong></p><p id="5d21" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">剧作家是一个异步web自动化库，它使您，即开发人员，能够自动化web浏览器并完成需要用户交互的任务</p><p id="5c9c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">例如，你可以点击按钮，填写表格，登录你喜欢的网站，用鼠标和键盘做任何你想做的事情</p><p id="55c5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">它是由谷歌之前开发木偶师的同一个团队开发的，并由他们维护</p><p id="cec8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">剧作家为什么要进行网页抓取？</strong></p><p id="97c4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">web抓取最常见的问题之一是动态内容，这些内容只有在您与网站交互时才“可见”，例如，当您需要在每天的特定时间登录网站并填写一些表格时</p><p id="0a45" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">仅仅使用通用的抓取库，比如带<a class="ae lo" href="https://cheerio.js.org/" rel="noopener ugc nofollow" target="_blank"> cheerio </a>的<a class="ae lo" href="https://github.com/axios/axios" rel="noopener ugc nofollow" target="_blank"> axios </a>是无法完成这样的任务的，因为它们不支持自动化功能</p><p id="51fc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">让我们开始编码</strong></p><p id="953e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们做一个简单的例子，看看剧作家如何去google.com搜索任何东西，然后截图——这是我最喜欢的功能之一</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="8667" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">剧作家中的选择者</strong></p><p id="3015" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上面的例子中，我们必须与两个控件交互，一个文本字段和一个按钮，那么我们如何为我们正在自动化的任何web应用程序获取这些呢？</p><p id="dcd1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们使用<code class="fe kv kw kx ky b">type()</code>函数与任何文本字段进行交互，我们得到这个选择器的方法就是简单地使用这个语法<code class="fe kv kw kx ky b">input[ATTRIBUTE=VALUE]</code>，在我们的例子中，我们有一个带有值为‘q’的<code class="fe kv kw kx ky b">name</code>属性的输入标签，对吗？</p><p id="06c8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将<code class="fe kv kw kx ky b">click() </code>与按钮一起使用，按钮选择器即使不简单也一样简单，通常您可以使用您的凭证自动完成登录过程，并且登录按钮始终是一个具有设置为“提交”的<code class="fe kv kw kx ky b">type</code>属性的输入元素</p><p id="4083" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">所以经验法则<strong class="jm io"> <em class="lr">输入字段后跟方括号包括任何属性</em> </strong></p><p id="85d5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">获取选择器的另一种方法是右键单击元素&gt;检查元素，然后右键单击检查窗口中的html标记，然后选择复制&gt;复制选择器</p><p id="5482" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">从谷歌上抓取当前天气</strong></p><p id="477f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">另一个例子，我个人觉得很有用，就是用一个简单的谷歌搜索就可以得到任何一个城市的当前天气，所以让我们开始吧</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="86c4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">添加<code class="fe kv kw kx ky b">waitForNavigation()</code>是一个好主意，因为它告诉剧作家要等到页面完全加载</p><p id="5d6c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">抓取更复杂的页面</strong></p><p id="e8f6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在是吃主菜的时候了，reddit.com和抓取更多的内容，并通过更复杂的html结构进行解析</p><p id="caf7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">旧的reddit基本上是同一个reddit，但布局和结构不同，尽管它看起来没有创意，但它非常适合抓取，因为它没有那么动态，所以html结构不会改变和破坏我们的代码</p><p id="cb80" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">前往<a class="ae lo" href="https://old.reddit.com/r/askreddit" rel="noopener ugc nofollow" target="_blank">https://old.reddit.com/r/askreddit</a>并点击F12来检查页面，让我们尝试找到有意义的选择器来导航子编辑页面</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ls"><img src="../Images/d8844b604a43cafc18a123bb2d667af8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KDO4BcuJZ7dqHY1nkrjICg.png"/></div></div></figure><p id="11d7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">正如你所看到的，所有的帖子都有一个公共的选择器，它是一个div标签，带有一个“thing”类，所以首先我们需要抓取所有带有<code class="fe kv kw kx ky b">$$()</code>的帖子，然后简单地循环遍历它们，提取所需的数据，因为这些信息都在每个<code class="fe kv kw kx ky b">&lt;div class="thing"&gt;&lt;/div&gt;</code>中</p><p id="cea4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">返回所有帖子并循环遍历它们</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="0846" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们做到了！一个抓取子编辑首页所有帖子的reddit抓取器</p><p id="31cf" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">最终注释</strong></p><ul class=""><li id="83a5" class="kz la in jm b jn jo jr js jv lb jz lc kd ld kh lt lf lg lh bi translated">请务必仔细检查您想要提取的元素，因为嵌套元素可能会引起混淆</li><li id="68a3" class="kz la in jm b jn li jr lj jv lk jz ll kd lm kh lt lf lg lh bi translated">在浏览器中充分利用devtools，因为它们提供了提取选择器或js选择器的方法</li><li id="0fbd" class="kz la in jm b jn li jr lj jv lk jz ll kd lm kh lt lf lg lh bi translated">使用控制台测试您的选择器，看看它们是否返回您想要的信息</li><li id="a9e4" class="kz la in jm b jn li jr lj jv lk jz ll kd lm kh lt lf lg lh bi translated">要有耐心，因为网站经常改变他们的标记，甚至用验证码阻止这些抓取工具</li></ul><p id="4a57" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">结论</strong></p><p id="dc6d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Web自动化正在疯狂地兴起，随之而来的是无穷无尽的可能性，剧作家是执行web自动化的绝佳选择，在页面上执行javascript的能力也允许我们进行web抓取，这比常规方式更强大，因为这允许我们处理分页，还可以绕过登录屏幕</p><p id="beb6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">非常感谢你的时间和兴趣，如果你能走到这一步，♥</p></div></div>    
</body>
</html>