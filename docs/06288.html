<html>
<head>
<title>How JavaScript Works behind the scenes?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript如何在幕后工作？</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-javascript-works-behind-the-scenes-88c546173f32?source=collection_archive---------0-----------------------#2021-12-28">https://blog.devgenius.io/how-javascript-works-behind-the-scenes-88c546173f32?source=collection_archive---------0-----------------------#2021-12-28</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="8501" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">JavaScript代码执行中涉及的所有核心组件的概述。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/4ef29613ee8c243840b276df15b5f8be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dnbk_d4BSiIJ8ZRdfog8jg.jpeg"/></div></div></figure><p id="0c62" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">随着JavaScript越来越受欢迎，团队正在他们的堆栈中的许多层面上利用它的支持——前端、后端、混合应用、嵌入式设备等等。本文旨在更深入地挖掘JavaScript及其实际工作原理。</p><h1 id="b4d9" class="lk ll in bd lm ln lo lp lq lr ls lt lu jt lv ju lw jw lx jx ly jz lz ka ma mb bi translated">概观</h1><p id="e6bc" class="pw-post-body-paragraph ko kp in kq b kr mc jo kt ku md jr kw kx me kz la lb mf ld le lf mg lh li lj ig bi translated">几乎每个人都听说过V8引擎这个概念，大多数人都知道JavaScript是单线程的，或者它使用了回调队列。</p><p id="6afd" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在这篇文章中，我们将详细介绍所有这些概念，并解释JavaScript实际上是如何运行的。通过了解这些细节，您将能够编写更好的、非阻塞的应用程序，这些应用程序能够恰当地利用所提供的API。</p><p id="285d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果你对JavaScript相对陌生，这篇博文将帮助你理解为什么JavaScript与其他语言相比如此“怪异”。如果您是一名经验丰富的JavaScript开发人员，希望它能让您对每天使用的JavaScript运行时实际上是如何工作的有一些新的见解。</p><p id="03e8" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在本文中，我们将讨论JavaScript在运行时环境和浏览器中的内部工作。这将概述JavaScript代码执行中涉及的所有核心组件。我们将讨论以下组件:</p><ol class=""><li id="fcb6" class="mh mi in kq b kr ks ku kv kx mj lb mk lf ml lj mm mn mo mp bi translated">JavaScript引擎</li><li id="20e6" class="mh mi in kq b kr mq ku mr kx ms lb mt lf mu lj mm mn mo mp bi translated">JavaScript运行时环境</li><li id="80f7" class="mh mi in kq b kr mq ku mr kx ms lb mt lf mu lj mm mn mo mp bi translated">调用堆栈</li><li id="0e18" class="mh mi in kq b kr mq ku mr kx ms lb mt lf mu lj mm mn mo mp bi translated">并发和事件循环</li></ol><p id="86aa" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">让我们从JavaScript引擎开始。</p><h1 id="cdd3" class="lk ll in bd lm ln lo lp lq lr ls lt lu jt lv ju lw jw lx jx ly jz lz ka ma mb bi translated">JavaScript引擎</h1><p id="b6a1" class="pw-post-body-paragraph ko kp in kq b kr mc jo kt ku md jr kw kx me kz la lb mf ld le lf mg lh li lj ig bi translated">正如你以前可能听说过的，JavaScript是一种<strong class="kq io">解释编程语言</strong>。这意味着源代码在执行前不会被编译成二进制代码。</p><p id="a323" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">你的计算机如何理解如何处理一个纯文本脚本？</p><p id="a03e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这是JavaScript引擎的工作。JavaScript引擎只是一个执行JavaScript代码计算机程序。今天，JavaScript引擎内置在所有现代浏览器中。当JavaScript文件加载到浏览器中时，JavaScript引擎将从上到下执行文件的每一行(为了简化解释我们在JS中避免提升)。JavaScript引擎会逐行解析代码，转换成机器码然后执行。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/b40b1218bce2e398a1d05281006c623c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*BoZoWnaWz4b0Je8iPCHxVQ.png"/></div></figure><p id="e9d6" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">每个浏览器都有自己的JavaScript引擎，但最著名的引擎是谷歌的V8。V8引擎支持Google Chrome，也支持Node.js，后者是JavaScript运行时。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/fd5a81aa2de99f9f885427b24e0e8b67.png" data-original-src="https://miro.medium.com/v2/resize:fit:886/format:webp/1*4dOuG6zvGAWxobk3UhVN_Q.png"/></div><figcaption class="mx my gj gh gi mz na bd b be z dk translated">浏览器引擎</figcaption></figure><p id="ae5e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">该引擎由两个主要组件组成:<br/> *内存堆——这是内存分配发生的地方<br/> *调用堆栈——这是代码执行时堆栈帧所在的地方</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nb"><img src="../Images/a359e4a29660a066c08852b8dd1e648b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RLbK8nM3pfLWPu4qIUaWww.png"/></div></div></figure><p id="4403" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">任何JavaScript引擎总是包含一个调用栈和一个堆。调用堆栈是我们的代码实际执行的地方。那么堆就是一个非结构化的内存池，它存储了我们的应用程序需要的所有对象。</p><h1 id="1087" class="lk ll in bd lm ln lo lp lq lr ls lt lu jt lv ju lw jw lx jx ly jz lz ka ma mb bi translated">运行时</h1><p id="99b8" class="pw-post-body-paragraph ko kp in kq b kr mc jo kt ku md jr kw kx me kz la lb mf ld le lf mg lh li lj ig bi translated">到目前为止，我们已经讨论了JavaScript引擎，但是JavaScript引擎并不是孤立运行的。它与许多其他组件一起运行在一个称为JavaScript运行时环境的环境中。JRE负责使JavaScript异步。这就是JavaScript能够添加事件侦听器并异步发出HTTP请求的原因。</p><p id="4c70" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">JRE就像一个容器，由以下组件组成:</p><ol class=""><li id="297e" class="mh mi in kq b kr ks ku kv kx mj lb mk lf ml lj mm mn mo mp bi translated">JS引擎</li><li id="4a06" class="mh mi in kq b kr mq ku mr kx ms lb mt lf mu lj mm mn mo mp bi translated">Web API</li><li id="634f" class="mh mi in kq b kr mq ku mr kx ms lb mt lf mu lj mm mn mo mp bi translated">回调队列或消息队列</li><li id="4d99" class="mh mi in kq b kr mq ku mr kx ms lb mt lf mu lj mm mn mo mp bi translated">事件表</li><li id="0b41" class="mh mi in kq b kr mq ku mr kx ms lb mt lf mu lj mm mn mo mp bi translated">事件循环</li></ol><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nc"><img src="../Images/6eaafe204bfcf9b93edb7009d7bb935d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sV2l-ME3FC9wBUyLnPoNNA.png"/></div></div></figure><p id="9adf" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">然后，我们有如此受欢迎的<strong class="kq io">事件循环</strong>和<strong class="kq io">回调队列</strong>。</p><h1 id="dbe0" class="lk ll in bd lm ln lo lp lq lr ls lt lu jt lv ju lw jw lx jx ly jz lz ka ma mb bi translated">调用堆栈</h1><p id="d5e6" class="pw-post-body-paragraph ko kp in kq b kr mc jo kt ku md jr kw kx me kz la lb mf ld le lf mg lh li lj ig bi translated">JavaScript是一种单线程编程语言，这意味着它只有一个调用栈。因此它一次只能做一件事。</p><p id="8ee1" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">调用栈是一种数据结构，它基本上记录了我们在程序中的位置。如果我们进入一个函数，我们把它放在栈顶。如果我们从一个函数返回，我们从栈顶弹出。堆栈只能做这些。</p><p id="5384" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">让我们看一个例子。看一下下面的代码:</p><pre class="kd ke kf kg gt nd ne nf ng aw nh bi"><span id="bfc9" class="ni ll in ne b gy nj nk l nl nm">function multiply(x, y) {<br/>    return x * y;<br/>}function printSquare(x) {<br/>    var s = multiply(x, x);<br/>    console.log(s);<br/>}printSquare(5);</span></pre><p id="2faa" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">当引擎开始执行这段代码时，调用堆栈将为空。之后，步骤如下:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nc"><img src="../Images/4115dec0311a3457a1e406aed12d1383.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pJhM8I34lOnEjBt3.png"/></div></div></figure><p id="2fed" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">调用堆栈中的每个条目被称为一个<strong class="kq io">堆栈帧</strong>。</p><p id="48fd" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在单线程上运行代码非常容易，因为您不必处理多线程环境中出现的复杂情况，例如死锁。</p><p id="505e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">但是在单线程上运行也有很大的局限性。因为JavaScript只有一个调用栈。</p><h1 id="62d9" class="lk ll in bd lm ln lo lp lq lr ls lt lu jt lv ju lw jw lx jx ly jz lz ka ma mb bi translated">并发性&amp;事件循环</h1><p id="21ce" class="pw-post-body-paragraph ko kp in kq b kr mc jo kt ku md jr kw kx me kz la lb mf ld le lf mg lh li lj ig bi translated">当调用堆栈中的函数调用需要花费大量时间来处理时，会发生什么情况？例如，假设您想在浏览器中用JavaScript进行一些复杂的图像转换。</p><p id="af95" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">你可能会问——为什么这甚至是一个问题？问题是，虽然调用堆栈有函数要执行，但浏览器实际上不能做任何其他事情——它被阻塞了。这意味着浏览器无法渲染，无法运行任何其他代码，只是卡住了。如果你想让你的应用程序有流畅的用户界面，这就产生了问题。</p><p id="fbb3" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这还不是唯一的问题。一旦您的浏览器开始处理调用堆栈中的大量任务，它可能会在相当长的时间内停止响应。大多数浏览器会发出一个错误，询问你是否要终止网页。你可以在下面的文章中读到更多关于并发和事件循环的内容。</p><div class="nn no gp gr np nq"><a rel="noopener  ugc nofollow" target="_blank" href="/concurrency-multi-threading-multi-processing-asynchronous-programming-and-event-loop-1b8df9fa6c20"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd io gy z fp nv fr fs nw fu fw im bi translated">并发、多线程、多处理、异步编程和事件循环</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">并发、多线程、多处理、异步编程等概念之间的关系…</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">blog.devgenius.io</p></div></div><div class="nz l"><div class="oa l ob oc od nz oe km nq"/></div></div></a></div><p id="1a4e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我希望上面的文章能帮助你理解JS是如何工作的。现在，让我们在这里结束它。</p></div><div class="ab cl of og hr oh" role="separator"><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok"/></div><div class="ig ih ii ij ik"><p id="777f" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果你喜欢这篇文章，请广而告之。要获得我的新故事的更新，请关注我的<a class="ae om" href="https://adityayaduvanshi.medium.com/" rel="noopener"><strong class="kq io"/></a><strong class="kq io">和</strong> <a class="ae om" href="https://twitter.com/fixslyr" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io">推特</strong> </a> <strong class="kq io">。</strong></p></div></div>    
</body>
</html>