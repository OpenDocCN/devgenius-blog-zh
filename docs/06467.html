<html>
<head>
<title>How to Deploy Facial Recognition with Azure Face API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Azure Face API部署面部识别</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-deploy-facial-recognition-with-azure-face-api-9d877b645893?source=collection_archive---------9-----------------------#2022-01-10">https://blog.devgenius.io/how-to-deploy-facial-recognition-with-azure-face-api-9d877b645893?source=collection_archive---------9-----------------------#2022-01-10</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="34d1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Face API是微软azure AI支持的服务，可以分析和检测图像中的人脸。</p><p id="f4e4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Azure Face API允许您的应用程序将面部识别与单个API集成，消除了从头开发面部识别功能的麻烦。该服务提供最先进的算法，可以识别、检测和分析图像中的面部特征，使面部识别变得轻松自如。这篇文章讨论了Azure Face API服务的使用及其用例。</p><p id="66b9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">为什么要投资Azure Face API？</strong></p><p id="e180" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">面部识别和面部API是安全的重要方面，包括身份验证、出于隐私原因的面部模糊以及无数其他场景。面部应用编程接口可以帮助你建立安全的应用程序，内置控制安全访问帐户。如果没有基本的面部识别服务，您的应用程序上的数据很容易受到未经授权的访问，这可能会导致财务和数据损失。</p><h1 id="9e7c" class="ki kj in bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">Azure Face API用例</h1><p id="5aa4" class="pw-post-body-paragraph jk jl in jm b jn lg jp jq jr lh jt ju jv li jx jy jz lj kb kc kd lk kf kg kh ig bi translated">Azure Face API帮助您:</p><p id="cf59" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">1.身份验证</p><p id="752e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">API帮助您根据政府颁发的护照或其他身份证明文件来识别用户。身份验证场景包括新用户注册或开户、员工验证和在线评估。</p><p id="1c2a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">2.无接触访问控制</p><p id="cc4a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Azure面部识别消除了存在安全和卫生风险的物理卡。访问卡可能会丢失或被盗，而内置的API仍在服务中，没有任何延迟或中断。</p><p id="b400" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Azure Face API可用于机场、体育场、俱乐部、学校、健身房、医院以及任何需要加强其安全性的实体的签到。</p><p id="688e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">3.表面修订</p><p id="c77c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">面部编辑允许您模糊视频或图像中个人的面部，以保护他们的隐私。这有助于您识别照片或视频中的特定个人，而不会泄露其他人的身份。</p><p id="06b6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Azure Face API也有助于找到相似的面孔，以帮助面部识别。</p><h1 id="fc4d" class="ki kj in bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">如何入门Azure Face API使用面向？网</h1><p id="0eda" class="pw-post-body-paragraph jk jl in jm b jn lg jp jq jr lh jt ju jv li jx jy jz lj kb kc kd lk kf kg kh ig bi translated">要开始，获取您的<a class="ae ll" href="https://azure.microsoft.com/free/cognitive-services/" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> azure订阅</strong> </a>。入门是免费的。您可以在开始使用API时进行升级。</p><p id="25f4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">第一步:获取<a class="ae ll" href="https://visualstudio.microsoft.com/vs/" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> Visual Studio IDE </strong> </a>或者最新版本的<a class="ae ll" href="https://dotnet.microsoft.com/download/dotnet-core" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io">。网芯</strong> </a>。</p><p id="70fc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">步骤2:您的azure帐户需要拥有认知服务贡献者角色，以接受服务条款并创建资源。您可以联系管理员将此角色分配给您的帐户。</p><p id="cb75" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">步骤3:一旦分配了角色，您就可以在Azure门户中创建您的face资源来检索您的端点和密钥。资源部署后，单击“转到资源”。接下来，您将需要端点和密钥来将您的应用程序连接到Azure API。我们将在下面向您展示放置密钥和端点的位置。</p><p id="ee3c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">步骤4:在Visual Studio中，创建一个新的。NET核心应用程序并安装客户端库。在解决方案资源管理器中右键单击“项目解决方案”，然后选择“管理NuGet包”。在软件包中，选择“包含”和“预发布”并搜索“Microsoft。azure . Cognitive services . vision . face .在那里，选择版本2.7.0-preview.1，然后单击安装。</p><p id="6500" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">步骤5:找到项目目录并导航到名为“program.cs”的文件。在这里，添加以下代码:</p><p id="89d7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm">使用系统；</em></p><p id="1279" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm">使用系统。集合。泛型；</em></p><p id="9fba" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm">使用系统。木卫一；</em></p><p id="50a4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm">使用系统。Linq</em></p><p id="909c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm">使用系统。穿线；</em></p><p id="4c49" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm">使用系统。线程。任务；</em></p><p id="6824" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm">使用微软。azure . cognitive services . vision . face；</em></p><p id="a384" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm">使用微软。azure . cognitive services . vision . face . models；</em></p><p id="df26" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">步骤6:导航到Program类，并为我们在步骤3中讨论的端点和键添加变量。参见下面的代码。</p><p id="0cbe" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">//从Azure门户中的Face订阅获取订阅密钥和端点。</p><p id="3dfa" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm">const string SUBSCRIPTION _ KEY = " PASTE _ YOUR _ FACE _ SUBSCRIPTION _ KEY _ HERE "；</em></p><p id="950b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm"> const string端点= " PASTE _ YOUR _ FACE _ ENDPOINT _ HERE "；</em></p><p id="084c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">第7步:接下来，找到应用程序的main方法，并使用下面的代码添加调用。(这些调用将在后面实现。)</p><p id="ce6d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm"> //认证。</em></p><p id="de15" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm">iface client client = Authenticate(端点，SUBSCRIPTION _ KEY)；</em></p><p id="f598" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm"> //检测——从人脸中获取特征。</em></p><p id="e525" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm"> DetectFaceExtract(客户端，IMAGE_BASE_URL，RECOGNITION_MODEL4)。wait()；</em></p><p id="34d9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm"> //查找相似——从人脸列表中查找相似的人脸。</em></p><p id="3219" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm"> FindSimilar(客户端，IMAGE_BASE_URL，RECOGNITION_MODEL4)。wait()；</em></p><p id="5500" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm"> //验证—比较两幅图像是否为同一个人。</em></p><p id="b57c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm">验证(客户端，IMAGE_BASE_URL，RECOGNITION_MODEL4)。wait()；</em></p><p id="5b4a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm">//Identify——识别人物组中的一张(多张)脸(本例中创建人物组)。</em></p><p id="ae19" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm"> IdentifyInPersonGroup(客户端，IMAGE_BASE_URL，RECOGNITION_MODEL4)。wait()；</em></p><p id="7439" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm"> // LargePersonGroup —创建，然后获取数据。</em></p><p id="af95" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm"> LargePersonGroup(客户端，IMAGE_BASE_URL，RECOGNITION_MODEL4)。wait()；</em></p><p id="835b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm"> //面分组——自动将相似的面分组。</em></p><p id="388f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm">组(客户端，IMAGE_BASE_URL，RECOGNITION_MODEL4)。wait()；</em></p><p id="737c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm"> // FaceList —创建一个面部列表，然后获取数据</em></p><p id="1e9b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在我们继续之前，请注意下面的接口代表了Face客户端库最突出的特性。</p><p id="fb63" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">FaceClient代表使用面部识别服务的授权。所有的face服务功能都需要这个接口，包括类和实例的创建。它需要您的订阅信息才能启动。</p><p id="e6b1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm"> FaceOperations负责基本的人脸检测任务。</em></p><p id="fb07" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm"> DetectedFace表示关于一张脸的完整数据，从中你可以得到关于这张脸的更多信息。</em></p><p id="46a8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm"> FaceListOperations管理存储在云中的FaceList结构(携带不同的分类面)。</em></p><p id="82ec" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm">persongrouppersontextensions管理包含一组属于一个人的面孔的Person构造。</em></p><p id="01df" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm"> PersonGroupOperations管理包含一组不同的person对象的组结构。</em></p><p id="b5e2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">第8步:在这一步中，您将使用. NET的人脸客户端库来验证客户端，实现人脸检测、人脸识别、相似人脸功能。</p><p id="7041" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">验证客户端</p><p id="af97" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">对于此任务，创建一个新方法，并使用步骤3中的端点和关键数据进行初始化。</p><p id="c4a5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">接下来，使用您的密钥创建一个新对象“ApiKey ServiceClient Credentials”。</p><p id="ee15" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">接下来，您将把它与新的“FaceClient”对象的端点一起使用。参见下面的代码。</p><p id="fa34" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm"> /* </em></p><p id="923c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm"> *认证</em></p><p id="259a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm"> *使用订阅密钥和区域创建客户端。</em></p><p id="bc9d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm"> */ </em></p><p id="f203" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm">public static iface client Authenticate(字符串端点，字符串密钥)</em></p><p id="92f4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm"> { </em></p><p id="6760" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm">返回新的face client(new ApiKeyServiceClientCredentials(key)){ Endpoint = Endpoint }；</em></p><p id="fb46" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="lm"> } </em></p><p id="34b3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">步骤10:在这一步中，添加一个代码来检测图像中的人脸。它会将检测到的人脸的ID打印到控制台，并在程序的内存中存储一份副本。参见下面的代码。</p><p id="4c4d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">接下来，您可以使用下面的代码通过DetectedFace.faceRectangle属性在面周围绘制矩形。</p><p id="c9bc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">步骤11:接下来，创建一个PersonGroup来添加一个identity操作，该操作将一个图像与一个PersonGroup进行比较以进行识别。</p><p id="1c45" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">使用下面的代码创建一个包含六个不同对象的PersonGroup。添加字符串变量(如下所示)。请注意，字符串变量位于类的根，以正确表示ID。</p><p id="dda3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">接下来，在新方法中添加以下代码。这段代码将执行识别操作。请注意，此代码定义了变量“sourceImageFileName”。</p><p id="a4fc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">接下来，通过添加以下代码创建一个Person对象。请注意，每个Person对象都通过唯一的标识ID字符串链接到一个PersonGroup。添加代码时，将变量的client、RECOGNITION_MODEL和URL传递到方法中。</p><p id="1566" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">步骤12:培训新创建的人员组</p><p id="3dc2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">您需要从图像中提取面部数据，并在不同的人对象中进行分类。然后训练新创建的人员组，使面部特征识别或识别与每个人对象相关联。使用下面的代码启动这个过程。</p><p id="b3e7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">部署代码后，这个特定的Person组及其链接的Person对象就可以进行身份、验证和组操作了。</p><p id="dc28" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要启用面部识别，请添加以下代码。</p><p id="8911" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">下面的代码将把识别的结果打印到控制台。该应用程序会将源文件图像中的每一张脸与创建的PersonGroup中的一个人进行匹配。这也将结束您的识别方法。参见下面的代码。</p><p id="509c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">此外，您还可以让应用程序找到相似的脸，检测面部特征进行比较，并找到和打印匹配。识别方法类后，您可以通过单击IDE窗口顶部的“调试”来运行应用程序。</p></div></div>    
</body>
</html>