<html>
<head>
<title>Data Augmentation using Python for Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 进行深度学习的数据增强</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/data-augmentation-programming-e9a4703198be?source=collection_archive---------0-----------------------#2020-05-21">https://blog.devgenius.io/data-augmentation-programming-e9a4703198be?source=collection_archive---------0-----------------------#2020-05-21</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><figure class="im in gp gr io ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/b8d26f14177fe9452e263fbb2461ef4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*auFZ6Lz6OtOQE6woaJTCvw.png"/></div></div><figcaption class="iw ix gj gh gi iy iz bd b be z dk translated"><a class="ae ja" href="https://mir-s3-cdn-cf.behance.net/project_modules/max_1200/bd253797333277.5ec2cda43ec50.png" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><div class=""/><div class=""><h2 id="220f" class="pw-subtitle-paragraph ka jc jd bd b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dk translated">处理深度学习的小数据集。</h2></div><p id="6114" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">数据扩充是一种技术，可用于制作数据集中图像的更新副本，以人为增加训练数据集的大小。当训练数据集非常小时，这种技术非常有用。</p><p id="29c5" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">已经有很多关于这个概念的好文章发表了。我们可以参考其中的一些文章，在<a class="ae ja" href="https://medium.com/nanonets/how-to-use-deep-learning-when-you-have-limited-data-part-2-data-augmentation-c26971dc8ced" rel="noopener">数据增强</a>了解<a class="ae ja" href="https://medium.com/nanonets/nanonets-how-to-use-deep-learning-when-you-have-limited-data-f68c0b512cab" rel="noopener">何时使用</a>数据增强，以及其他重要概念。</p><p id="7a6b" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">想象一下，你害怕灭霸，并且相信他是真实存在的，并且有一天会造访地球。作为衡量的标志，您想要建立一个依靠摄像机输入的防御系统。当灭霸到达地球时，这个系统将被激活，对他从相机里得到的图像进行分类。为此，我们需要训练一个可靠的模型来激活防御系统。如果我们只有 10 张灭霸的照片，就很难建立一个可靠的模型来捕捉他的存在。</p><p id="98f9" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">因此，为了训练集有多个图片，我们可以考虑数据扩充。在<a class="ae ja" href="https://medium.com/nanonets/nanonets-how-to-use-deep-learning-when-you-have-limited-data-f68c0b512cab" rel="noopener">点击这里</a>中提到了何时使用增强的更好的例子和场景。让我们考虑下面的图像是一个我们想要执行数据扩充。</p><figure class="lp lq lr ls gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi lo"><img src="../Images/119336d66b1ec210d8530c88ff930a3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DLvpsJS9V5l1RgsHFRn4zg.jpeg"/></div></div><figcaption class="iw ix gj gh gi iy iz bd b be z dk translated">图片由 Matt McGloin 在<a class="ae ja" href="https://cosmicbook.news/avengers-infinity-war-characters-assemble-giant-poster" rel="noopener ugc nofollow" target="_blank"> comicbook.news </a></figcaption></figure><p id="fe31" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">在本文中，我将只关注数据扩充的编码部分。</p><p id="e5fc" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">首先，我们将看看如何使用 NumPy 来实现这一点，然后我们将讨论 Keras 中的图像预处理数据增强类，它为这项任务带来了简单性。</p><h2 id="2ec2" class="lt lu jd bd lv lw lx dn ly lz ma dp mb lb mc md me lf mf mg mh lj mi mj mk ml bi translated">使用 Numpy</h2><p id="5eac" class="pw-post-body-paragraph ks kt jd ku b kv mm ke kx ky mn kh la lb mo ld le lf mp lh li lj mq ll lm ln ig bi translated">导入所需的模块。</p><figure class="lp lq lr ls gt ip"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="3362" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">加载要处理的图像。</p><figure class="lp lq lr ls gt ip"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="bfe8" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated"><strong class="ku je">裁剪:</strong>通过裁剪，我们可以捕捉图像中需要的部分。这里我们随机裁剪来捕捉图像的随机窗口。从原始图像中裁剪过小的图像会导致信息丢失。</p><figure class="lp lq lr ls gt ip"><div class="bz fp l di"><div class="mr ms l"/></div></figure><figure class="lp lq lr ls gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi mt"><img src="../Images/be0029a1911b57a53be557953ae66930.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PNBg1woVH1o7PZrginiypg.png"/></div></div><figcaption class="iw ix gj gh gi iy iz bd b be z dk translated">从原始图像中随机裁剪的图像</figcaption></figure><p id="9f88" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated"><strong class="ku je">旋转图像:</strong>旋转图像，捕捉不同角度拍摄画面的实时效果。</p><figure class="lp lq lr ls gt ip"><div class="bz fp l di"><div class="mr ms l"/></div></figure><figure class="lp lq lr ls gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi mu"><img src="../Images/d99f5f9c4013ff3b7ce92735f355a819.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oWgnn-soRGVfEVqV-jQMlw.png"/></div></div><figcaption class="iw ix gj gh gi iy iz bd b be z dk translated">旋转图像后的样本输出</figcaption></figure><p id="4d28" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated"><strong class="ku je">图像移动或称为图像平移:</strong>这只不过是在某个方向上移动图片的像素，并在相反的方向上将移动的像素加回来。</p><figure class="lp lq lr ls gt ip"><div class="bz fp l di"><div class="mr ms l"/></div></figure><figure class="lp lq lr ls gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi mv"><img src="../Images/a722984d0fc1472a447a9afcc6279fb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cFkKyi2NgbbELw8G2kOapg.png"/></div></div><figcaption class="iw ix gj gh gi iy iz bd b be z dk translated">移动图像后的样本输出</figcaption></figure><p id="bb87" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">为了获得更好的效果，我们可以结合这些技术，因为我们将得到不同风格的增强图片。</p><p id="8031" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">我们已经看到，使用 NumPy 需要花费大量精力来手动更改图像数组的值，这不仅计算量大，而且需要大量代码，如上所述。</p><p id="cb60" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">现在，我们可以尝试使用 Keras 神经网络框架进行增强，这使得我们的工作容易得多。</p><h1 id="b89c" class="mw lu jd bd lv mx my mz ly na nb nc mb kj nd kk me km ne kn mh kp nf kq mk ng bi translated">使用张量流和 Keras</h1><p id="d353" class="pw-post-body-paragraph ks kt jd ku b kv mm ke kx ky mn kh la lb mo ld le lf mp lh li lj mq ll lm ln ig bi translated">TensorFlow 有一个单独的类，它通过许多不同的选项来处理数据扩充，而不仅仅是翻转、缩放和裁剪图像。</p><p id="d47b" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">通过使用 Keras，不需要手动调整像素。Keras 有处理这些事情的内置函数。因此，使用 Keras 进行增强所需的代码更少，而且有多种选择。</p><p id="6926" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">让我们看看 Keras 的 image preposing imagedata generator 类:</p><figure class="lp lq lr ls gt ip"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="298d" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">让我们看看常用数据论证技术的重要论点:</p><ul class=""><li id="f1f8" class="nh ni jd ku b kv kw ky kz lb nj lf nk lj nl ln nm nn no np bi translated"><strong class="ku je">旋转 _ 范围:</strong> Int。随机旋转的度数范围。</li><li id="3744" class="nh ni jd ku b kv nq ky nr lb ns lf nt lj nu ln nm nn no np bi translated"><strong class="ku je"> width_shift_range: </strong> Float，一维数组类型或 int —总宽度的一部分</li><li id="1224" class="nh ni jd ku b kv nq ky nr lb ns lf nt lj nu ln nm nn no np bi translated"><strong class="ku je">height _ shift _ range:</strong>Float，一维数组类型或 int —总高度的一部分</li><li id="ac37" class="nh ni jd ku b kv nq ky nr lb ns lf nt lj nu ln nm nn no np bi translated"><strong class="ku je"> brightness_range: </strong>两个浮点的元组或列表。选择亮度偏移值的范围。</li><li id="73e2" class="nh ni jd ku b kv nq ky nr lb ns lf nt lj nu ln nm nn no np bi translated"><strong class="ku je">剪切 _ 范围:</strong>浮动。剪切强度(逆时针方向的剪切角度，单位为度)</li><li id="3cef" class="nh ni jd ku b kv nq ky nr lb ns lf nt lj nu ln nm nn no np bi translated"><strong class="ku je"> zoom_range: </strong> Float 或【下，上】。随机缩放的范围。如果是浮点型，[lower，upper] = [1-zoom_range，1+zoom_range]。要缩放的整个图像的一部分。</li><li id="63e9" class="nh ni jd ku b kv nq ky nr lb ns lf nt lj nu ln nm nn no np bi translated"><strong class="ku je">水平 _ 翻转:</strong>布尔型。随机水平翻转输入。</li><li id="41ce" class="nh ni jd ku b kv nq ky nr lb ns lf nt lj nu ln nm nn no np bi translated"><strong class="ku je">垂直 _ 翻转:</strong>布尔型。随机垂直翻转输入。</li><li id="8a4d" class="nh ni jd ku b kv nq ky nr lb ns lf nt lj nu ln nm nn no np bi translated"><strong class="ku je">重新调整:</strong>重新调整因子。默认为无。如果无或为 0，则不应用重缩放，否则我们将数据乘以所提供的值(在应用所有其他变换之后)。</li><li id="416f" class="nh ni jd ku b kv nq ky nr lb ns lf nt lj nu ln nm nn no np bi translated"><strong class="ku je">预处理 _ 函数:</strong>将应用于每个输入的函数。该功能将在图像调整大小和放大后运行。该函数应该采用一个参数:一个图像(秩为 3 的 Numpy 张量),并且应该输出具有相同形状的 Numpy 张量。</li><li id="2ff3" class="nh ni jd ku b kv nq ky nr lb ns lf nt lj nu ln nm nn no np bi translated"><strong class="ku je"> data_format: </strong>图像数据格式，可以是“channels_first”，也可以是“channels_last”。</li><li id="a749" class="nh ni jd ku b kv nq ky nr lb ns lf nt lj nu ln nm nn no np bi translated">validation_split: Float 保留用于验证的图像比例(严格介于 0 和 1 之间)。</li><li id="58d1" class="nh ni jd ku b kv nq ky nr lb ns lf nt lj nu ln nm nn no np bi translated">dtype:用于生成的数组的 Dtype。</li></ul><p id="aaf1" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">更多细节和论据请查看 tf 文档<strong class="ku je"><a class="ae ja" href="https://www.tensorflow.org/api_docs/python/tf/keras/preprocessing/image/ImageDataGenerator" rel="noopener ugc nofollow" target="_blank"><strong class="ku je">。</strong></a></strong></p><p id="0133" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">现在，我们将使用一些最常见的技术来增强我们的图像，如翻转、旋转、宽度和高度移动、改变图像的亮度、缩放和重新缩放图像。</p><figure class="lp lq lr ls gt ip"><div class="bz fp l di"><div class="mr ms l"/></div></figure><figure class="lp lq lr ls gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi nv"><img src="../Images/087be70ca28658c04a575a5dbc8eaf49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zL4v89bEu_Yue-6avFdc-w.png"/></div></div><figcaption class="iw ix gj gh gi iy iz bd b be z dk translated">使用 Keras 增强后的示例输出</figcaption></figure><p id="9835" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">现在让我们看看如何扩充一个完整的数据集。我们将考虑 cifar10 数据集。</p><figure class="lp lq lr ls gt ip"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="b43f" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">从上面的例子中我们可以注意到，使用 Keras 进行数据扩充比使用 NumPy 更好。</p><p id="31e3" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">希望这些大量的增强图像可以帮助你激活你的防御系统，拯救我们的星球。</p><p id="f7a3" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">完整的木星笔记本可以在我的<a class="ae ja" href="https://github.com/sai-teja-ponugoti/Machine-Learning-Concepts" rel="noopener ugc nofollow" target="_blank"><strong class="ku je"><em class="nw">git hub</em></strong></a><strong class="ku je"><em class="nw">找到。</em>T15】</strong></p><p id="9ea4" class="pw-post-body-paragraph ks kt jd ku b kv kw ke kx ky kz kh la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">这是我的第一篇文章，请从现在开始就如何改进我的文章提供反馈。</p></div></div>    
</body>
</html>