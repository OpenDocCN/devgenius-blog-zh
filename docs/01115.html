<html>
<head>
<title>How does a Data Scientist Choose an Engagement Ring?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据科学家如何选择订婚戒指？</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-does-a-data-scientist-choose-an-engagement-ring-37c25ac3b568?source=collection_archive---------26-----------------------#2020-06-24">https://blog.devgenius.io/how-does-a-data-scientist-choose-an-engagement-ring-37c25ac3b568?source=collection_archive---------26-----------------------#2020-06-24</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/f60a9449e4d185a477e911c0328c5790.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZtTuwVFRM5cmu9Rs"/></div></div></figure><p id="efd8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">“为什么”一个人会发这样一个帖子应该没有什么问题。但是如果它不是非常清楚，我会把它留给你的想象力。我在这篇文章中使用的网站是:<a class="ae kt" href="https://www.brilliantearth.com/" rel="noopener ugc nofollow" target="_blank">https://www.brilliantearth.com/</a>这是一个很棒的网站，因为他们提供道德采购的钻石以及实验室制造的钻石。</p><h1 id="c273" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">项目的结构</h1><ul class=""><li id="a985" class="ls lt in jx b jy lu kc lv kg lw kk lx ko ly ks lz ma mb mc bi translated">库和设置</li><li id="7401" class="ls lt in jx b jy md kc me kg mf kk mg ko mh ks lz ma mb mc bi translated">找到数据</li><li id="52c6" class="ls lt in jx b jy md kc me kg mf kk mg ko mh ks lz ma mb mc bi translated">刮下来放入熊猫数据框</li><li id="c808" class="ls lt in jx b jy md kc me kg mf kk mg ko mh ks lz ma mb mc bi translated">格式</li><li id="ee97" class="ls lt in jx b jy md kc me kg mf kk mg ko mh ks lz ma mb mc bi translated">添加有趣的栏目</li><li id="61f8" class="ls lt in jx b jy md kc me kg mf kk mg ko mh ks lz ma mb mc bi translated">展示视觉效果</li></ul><h1 id="ff1a" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">图书馆</h1><p id="340f" class="pw-post-body-paragraph jv jw in jx b jy lu ka kb kc lv ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">有相当多的库参与了这个项目的创建。其中一些关键的是:beautifulsoup、plotly.express、regex、iPython.display、json 和 statsmodels.api。对于那些对我使用的所有库感兴趣的人，笔记本在我的<a class="ae kt" href="https://l.workplace.com/l.php?u=https%3A%2F%2Fgithub.com%2Fsupercoolgetsallthegirlsmax%2Fdiamonds&amp;h=AT2Sg5CuZ4tEJuzlajnj_kLMrKV9JToJv5-QBWsLMDKYyFidr6ubjzNjYT9XMiKMQf3B5IDp6iPcHKeKBLIWX6L-Qo4VXBWeHSUnoeQbe-cuk_gk9N6Xdao3xgT9tNDzVk42znsk-3NAx1I5QQ" rel="noopener ugc nofollow" target="_blank"> github </a>上。</p><h1 id="af7f" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">设置</h1><p id="fb74" class="pw-post-body-paragraph jv jw in jx b jy lu ka kb kc lv ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">我添加了一些 jupyter 显示设置，以便更容易地查看长 URL 和 request_header，因为我们将抓取网站。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="888b" class="mu kv in mq b gy mv mw l mx my">#set some display settings for notebooks<br/>pd.set_option('display.max_rows', 500)<br/>pd.set_option('display.max_columns', 500)<br/>pd.set_option('display.width', 1000)<br/># pd.set_option('display.max_colwidth', -1)</span><span id="421a" class="mu kv in mq b gy mz mw l mx my">#add headers in case you use chromedriver (captchas are no fun); namely used for chromedriver<br/>req_headers = {<br/>    'accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',<br/>    'accept-encoding': 'gzip, deflate, br',<br/>    'accept-language': 'en-US,en;q=0.8',<br/>    'upgrade-insecure-requests': '1',<br/>    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.3163.100 Safari/537.36'<br/>}</span></pre><h1 id="bd32" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">接下来我们的汤对象</h1><p id="084f" class="pw-post-body-paragraph jv jw in jx b jy lu ka kb kc lv ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">这只是用我们请求的 url 的内容创建了一个 soup 变量。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="d2e2" class="mu kv in mq b gy mv mw l mx my">#create session and soup object for the diamonds website and table<br/>with requests.Session() as s:<br/>    url = "<a class="ae kt" href="https://www.brilliantearth.com/design-your-own-engagement-ring/?sid=3755106&amp;dc=" rel="noopener ugc nofollow" target="_blank">https://www.brilliantearth.com/design-your-own-engagement-ring/?sid=3755106&amp;dc=</a>"<br/>    r = s.get(url, headers=req_headers)</span><span id="07b9" class="mu kv in mq b gy mz mw l mx my">#add contents of urls to soup variable from each url<br/>soup = BeautifulSoup(r.content, 'lxml')</span></pre><h1 id="5d4f" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">接下来是将我们的 url 内容转换成 json</h1><p id="ae3a" class="pw-post-body-paragraph jv jw in jx b jy lu ka kb kc lv ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">我这样做的原因是因为 beautifulsoup 在解析一些 html 标签时有所欠缺。所以我走了一条不同的路线来解析数据，将页面转换成 json 文本。Pandas 还有一些很酷的功能，可以将 json 转换成 dataframe。</p><p id="176f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">我采取的步骤:</strong></p><ul class=""><li id="75e3" class="ls lt in jx b jy jz kc kd kg na kk nb ko nc ks lz ma mb mc bi translated">检查页面元素</li><li id="000c" class="ls lt in jx b jy md kc me kg mf kk mg ko mh ks lz ma mb mc bi translated">选择网络选项卡</li><li id="3b01" class="ls lt in jx b jy md kc me kg mf kk mg ko mh ks lz ma mb mc bi translated">选择 XHR 选项卡</li><li id="d59d" class="ls lt in jx b jy md kc me kg mf kk mg ko mh ks lz ma mb mc bi translated">找到包含 URL/查询的正确 json 对象</li><li id="cbc4" class="ls lt in jx b jy md kc me kg mf kk mg ko mh ks lz ma mb mc bi translated">我使用的网站从 json 查询中提取了所有内容，所以这就是我需要找到的页面</li><li id="5a92" class="ls lt in jx b jy md kc me kg mf kk mg ko mh ks lz ma mb mc bi translated">使用在 XHR 找到的网址作为你的汤网址</li><li id="719c" class="ls lt in jx b jy md kc me kg mf kk mg ko mh ks lz ma mb mc bi translated">该 url 将带您到一个带有数据 json 的页面</li><li id="0ecd" class="ls lt in jx b jy md kc me kg mf kk mg ko mh ks lz ma mb mc bi translated">插入参数——这基本上类似于 sql 查询的 where 子句</li></ul><figure class="ml mm mn mo gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nd"><img src="../Images/046a2c68b2909c4be8c62f1ab509af4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Z839J-UJFVQ4idAO"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">检查元素，网络，xhr，json 对象，url</figcaption></figure><h1 id="6860" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">这是代码</h1><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="72cb" class="mu kv in mq b gy mv mw l mx my">#convert the url to a json object and pass in parameters (found in xhr of url (inspect element))<br/>import json<br/>import requests<br/>from pandas.io.json import json_normalize</span><span id="e2c9" class="mu kv in mq b gy mz mw l mx my">search_parameters = {<br/>'shapes': "Pear",<br/>'cuts': "Good,Very Good,Ideal,Super Ideal",<br/>'colors': "I,H,G,F,E,D",<br/>'clarities': "SI1,VS2,VS1,VVS2,VVS1,IF,FL",<br/>'polishes': "Good,Very Good,Excellent",<br/>'symmetries': "Good,Very Good,Excellent",<br/>'fluorescences': "Very Strong,Strong,Medium,Faint,None",<br/>'min_carat': "1.50",<br/>'max_carat': "11.02",<br/>'min_table': "50.00",<br/>'max_table': "86.00",<br/>'min_depth': "46.20",<br/>'max_depth': "629.00",<br/>'min_price': "470",<br/>'max_price': "40400",<br/>'stock_number': "",<br/>'row': "0",<br/>'page': "0,1,2,3,4,5",<br/>'requestedDataSize': "200",<br/>'order_by': "carat",<br/>'order_method': "desc",<br/>'currency': "$",<br/>'has_v360_video': "",<br/>'dedicated': "",<br/>'sid': "",<br/>'min_ratio': "1.00",<br/>'max_ratio': "2.75",<br/>'shipping_day': "",<br/>'MIN_PRICE': "470",<br/>'MAX_PRICE': "956970",<br/>'MIN_CARAT': "0.29",<br/>'MAX_CARAT': "11.02",<br/>'MIN_TABLE': "45",<br/>'MAX_TABLE': "86",<br/>'MIN_DEPTH': "46.2",<br/>'MAX_DEPTH': "629"<br/>}</span><span id="4ea0" class="mu kv in mq b gy mz mw l mx my">data = requests.get('<a class="ae kt" href="https://www.brilliantearth.com/loose-diamonds/list/?shapes=Pear&amp;cuts=Good%2CVery+Good%2CIdeal%2CSuper+Ideal&amp;colors=I%2CH%2CG%2CF%2CE%2CD&amp;clarities=SI1%2CVS2%2CVS1%2CVVS2%2CVVS1%2CIF%2CFL&amp;polishes=Good%2CVery+Good%2CExcellent&amp;symmetries=Good%2CVery+Good%2CExcellent&amp;fluorescences=Very+Strong%2CStrong%2CMedium%2CFaint%2CNone&amp;min_carat=1.50&amp;max_carat=11.02&amp;min_table=50.00&amp;max_table=86.00&amp;min_depth=46.20&amp;max_depth=629.00&amp;min_price=470&amp;max_price=40400&amp;stock_number=&amp;row=0&amp;page=2&amp;requestedDataSize=200&amp;order_by=carat&amp;order_method=desc&amp;currency=%24&amp;has_v360_video=&amp;dedicated=&amp;sid=3755106&amp;min_ratio=1.00&amp;max_ratio=2.75&amp;shipping_day=&amp;MIN_PRICE=470&amp;MAX_PRICE=956970&amp;MIN_CARAT=0.29&amp;MAX_CARAT=11.02&amp;MIN_TABLE=45&amp;MAX_TABLE=86&amp;MIN_DEPTH=46.2&amp;MAX_DEPTH=629'" rel="noopener ugc nofollow" target="_blank">https://www.brilliantearth.com/loose-diamonds/list/?shapes=Pear&amp;cuts=Good%2CVery+Good%2CIdeal%2CSuper+Ideal&amp;colors=I%2CH%2CG%2CF%2CE%2CD&amp;clarities=SI1%2CVS2%2CVS1%2CVVS2%2CVVS1%2CIF%2CFL&amp;polishes=Good%2CVery+Good%2CExcellent&amp;symmetries=Good%2CVery+Good%2CExcellent&amp;fluorescences=Very+Strong%2CStrong%2CMedium%2CFaint%2CNone&amp;min_carat=1.50&amp;max_carat=11.02&amp;min_table=50.00&amp;max_table=86.00&amp;min_depth=46.20&amp;max_depth=629.00&amp;min_price=470&amp;max_price=40400&amp;stock_number=&amp;row=0&amp;page=2&amp;requestedDataSize=200&amp;order_by=carat&amp;order_method=desc&amp;currency=%24&amp;has_v360_video=&amp;dedicated=&amp;sid=3755106&amp;min_ratio=1.00&amp;max_ratio=2.75&amp;shipping_day=&amp;MIN_PRICE=470&amp;MAX_PRICE=956970&amp;MIN_CARAT=0.29&amp;MAX_CARAT=11.02&amp;MIN_TABLE=45&amp;MAX_TABLE=86&amp;MIN_DEPTH=46.2&amp;MAX_DEPTH=629'</a>, params=search_parameters).json()<br/># uncomment this to print all data:<br/># print(json.dumps(data, indent=4))</span><span id="793b" class="mu kv in mq b gy mz mw l mx my">for d in data['diamonds']:<br/>    print('{:&lt;50} {:&lt;35} {} {} {} {} {} {} {} {} {} {} {} {} {} {}'.format(<br/>        d['title'], d['shape'], \<br/>        d['color'], d['clarity'], \<br/>        d['cut'], d['origin'], d['price'],\<br/>        d['length_width_ratio'], d['polish'], d['symmetry'],\<br/>        d['depth'], d['table'], d['girdle'],\<br/>        d['culet'], d['fluorescence'], d['length']\<br/>    ))</span></pre><figure class="ml mm mn mo gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ni"><img src="../Images/e19cadf7ce4640377e633bb99a94ac81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dhFkt8KmPI8OXHgk"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">它很丑，但它就在那里</figcaption></figure><h1 id="16fb" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">将 JSON 数据放入数据帧中</h1><p id="3dc2" class="pw-post-body-paragraph jv jw in jx b jy lu ka kb kc lv ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">不言自明。我们创建一个空的 dataframe 和空的 list，然后遍历 url (data)中的每个条目(d ),并将它们附加到 list 中。然后将该列表设置为等于数据帧。这将在 dataframe 中放置一列，每行/每个元素都有一个 json 对象。用 json_normalize()将数据规范化到单独的列中。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="4176" class="mu kv in mq b gy mv mw l mx my">#Put all the data in a dataframe<br/>df = pd.DataFrame()<br/>rows = []</span><span id="281f" class="mu kv in mq b gy mz mw l mx my">for d in data['diamonds']:<br/>#     print('{:&lt;4} {:&lt;10} {} {} {} {:&lt;7} {} {} {} {} {} {}'.format(<br/>#         d['title'], d['shape'], <br/>#         d['color'], d['clarity'], <br/>#         d['cut'], d['origin'], d['price'],<br/>#         d['length_width_ratio'], d['polish'], d['symmetry'],<br/>#         d['depth'], d['table'], d['girdle'],<br/>#         d['culet'], d['fluorescence']<br/>#     ))<br/>    rows.append(d)<br/>    <br/>df['rows'] = rows<br/>df = json_normalize(df['rows'])<br/>df</span></pre><figure class="ml mm mn mo gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nj"><img src="../Images/ce1735ddaf2816afd7b10a120457df57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lEw1qshwINUPwgIA"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">我们的数据框架！</figcaption></figure><h1 id="73e1" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">接下来，我们将创建一些函数，并将它们应用到新的 dataframe 列</h1><p id="b55c" class="pw-post-body-paragraph jv jw in jx b jy lu ka kb kc lv ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">我这样做的原因是为了获得每个 c(颜色、切工、克拉、净度)的临时排名。这将有助于我们确定整体最佳钻石，而不必做一些数学，我甚至不知道如何做。我们将对每个 Cs 做同样的事情:为最差的值返回 1，为最好的值返回最高的数字(给定可能值的范围)。最后，我们将使用 apply()将该函数应用于新的 dataframe 列。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="cb69" class="mu kv in mq b gy mv mw l mx my">#create rank functions<br/>def rank_func(df):<br/>    if df['cut'] == 'Fair':<br/>        return '1'<br/>    elif df['cut'] =='Good':<br/>        return '2'<br/>    elif df['cut'] =='Very Good':<br/>        return '3'<br/>    elif df['cut'] =='Ideal':<br/>        return '4'<br/>    elif df['cut'] =='Super Ideal':<br/>        return '5'<br/>    else:<br/>        return '0'</span><span id="acf4" class="mu kv in mq b gy mz mw l mx my">df['Cut_Rank'] = df.apply(rank_func, axis=1)<br/>df</span></pre><figure class="ml mm mn mo gt jo gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/bb77bdd79ff13d18c59c12e22a8c22ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:576/0*Uro2WRFTBF0BXD2X"/></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">看看 Cut_Rank 列吧！</figcaption></figure><h1 id="30d4" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">接下来我们将排列价格</h1><p id="d8ad" class="pw-post-body-paragraph jv jw in jx b jy lu ka kb kc lv ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">我选择了一种不同的方法来给价格分配一个等级——也就是说，因为我不想在价格变化很大的情况下让等级饱和。因此，首先我创建了一个列，用 round()方法将价格四舍五入到最接近的千位。然后我创建了一个带有密集参数的 price_rank 列——很难解释它的作用。但本质上，它给你的是整数，每个值都是按其排名的元素分组的。因此，它不会对每一行都应用唯一的排名—当值不唯一时，它会回收排名。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="601e" class="mu kv in mq b gy mv mw l mx my">#create a rank column for price<br/>df['price_thousands'] = df.price.round(decimals=-3)<br/>df['price_rank'] = df['price_thousands'].rank(ascending = 1,method='dense')<br/>df[['price_rank','price_thousands']].sort_values(by='price_rank')</span></pre><figure class="ml mm mn mo gt jo gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/9abdc27b679610eca0bca8776018cc56.png" data-original-src="https://miro.medium.com/v2/resize:fit:478/0*7PMocmNI8l9YfxLg"/></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">谁说我不懂四舍五入()和排名()？</figcaption></figure><h1 id="bc40" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">接下来，我们需要转换一些列，并创建真正的排名列</h1><p id="a97e" class="pw-post-body-paragraph jv jw in jx b jy lu ka kb kc lv ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">因为我们的大部分数据都是通过 json 函数获取的，所以如果原始数据类型在转换过程中与值不符，我不会感到奇怪。因此，我们转换它们，这很简单。然后，我们将创建一个列，将所有这些排名列相加，作为我们真正的临时排名系统。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="b9d3" class="mu kv in mq b gy mv mw l mx my">#convert datatypes<br/>df['Cut_Rank'] = df.Cut_Rank.astype(float)<br/>df['Color_Rank'] = df.Color_Rank.astype(float)<br/>df['Clarity_Rank'] = df.Clarity_Rank.astype(float)<br/>df['Carat_Rank'] = df.Carat_Rank.astype(float)<br/>df['price'] = df.price.astype(float)<br/>df['carat'] = df.carat.astype(float)</span><span id="3106" class="mu kv in mq b gy mz mw l mx my">#create a rank column that combines all c's<br/>df['CCCC_Rank'] = df['Cut_Rank'] + df['Color_Rank'] + df['Clarity_Rank'] + df['Carat_Rank']<br/>df['CCCC_Rank'] = df.CCCC_Rank.astype(float)<br/>df = df.sort_values(by='CCCC_Rank',ascending=False)<br/>df.sort_values(by=['CCCC_Rank','price'],ascending=False)</span></pre><figure class="ml mm mn mo gt jo gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/295f158802e7ce926d54da0396507987.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/0*NO-lPQw3D_IN59xC"/></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">现在我们有了一些非常有用的数据，格式非常有用！</figcaption></figure><h1 id="df41" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">接下来，我们要做一些很酷的事情，显示数据框中每个钻石的图像。你听到了。</h1><p id="e370" class="pw-post-body-paragraph jv jw in jx b jy lu ka kb kc lv ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">我认为看到真正的钻石可能会很酷——我的意思是，你为它付出了这么多，很难完全依靠数据来进行购买。所以，我至少会让你体验一下你花了 6 个月的时间才能买得起的东西。</p><p id="a477" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">首先，我们创建一个图像 url 列，其次，我们使该列成为所述图像的缩略图。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="c36a" class="mu kv in mq b gy mv mw l mx my">#1 remove everything but the url<br/>df['images_string'] = [','.join(map(str, l)) for l in df['images.real_images']]<br/>df['images_string'] = df['images_string'].replace(' ', '', regex=True)<br/>df['images_string'] = df['images_string'].replace("{'caption':'real_view','src':'//", '', regex=True)<br/>df['images_string'] = df['images_string'].replace("','alt':'RealDiamondImage','size':", '', regex=True)<br/>df['images_string'] = df['images_string'].str.split('[').str[0]<br/>df['images_string'] = "https://" + df['images_string']<br/>df['image_thumbnail'] = df['images_string']<br/>images = df['images_string']<br/>df['images_string']</span></pre><figure class="ml mm mn mo gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nn"><img src="../Images/4f192376bd91c37afee817438f066e1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/0*3kSBd2R9tXLohMvE"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">现在我们在 dataframe 列中有了 url 链接。你说得对。它是奇特的。</figcaption></figure><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="c91a" class="mu kv in mq b gy mv mw l mx my">#2 display diamond image in dataframe<br/>def path_to_image_html(path):<br/>    return '&lt;img src="'+ path + '" style=max-height:150px;"/&gt;'</span><span id="0f3e" class="mu kv in mq b gy mz mw l mx my">df1 = df[['price','shape','carat','cut','clarity','color','CCCC_Rank','symmetry','polish','origin','image_thumbnail']]</span><span id="f19f" class="mu kv in mq b gy mz mw l mx my">HTML(df1.to_html(escape=False, formatters=dict(image_thumbnail=path_to_image_html)))</span></pre><figure class="ml mm mn mo gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi no"><img src="../Images/45923c34a7c8108671ba3a6f80bca917.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*chPGWjbeMJ3nOo-_"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">啊啊啊啊啊</figcaption></figure><h1 id="c6c3" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">如果您想要描述数据的每一列，快速提示:</h1><p id="fe75" class="pw-post-body-paragraph jv jw in jx b jy lu ka kb kc lv ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">使用 describe()。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="0043" class="mu kv in mq b gy mv mw l mx my"><a class="ae kt" href="https://clarityinsights.workplace.com/hashtag/describe?__eep__=6&amp;source=note&amp;epa=HASHTAG" rel="noopener ugc nofollow" target="_blank">#describe</a> the dataframe<br/>df.describe().T</span></pre><figure class="ml mm mn mo gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi np"><img src="../Images/6eac6ae17942906c9f757efd7899d1a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*F4lsDriaAySyjPYM"/></div></div></figure><h1 id="ff4d" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">现在，我们的第一个悲伤的小情节</h1><p id="67c6" class="pw-post-body-paragraph jv jw in jx b jy lu ka kb kc lv ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">Seaborn 散点图。不多，但是又快又简单。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="948c" class="mu kv in mq b gy mv mw l mx my"><a class="ae kt" href="https://clarityinsights.workplace.com/hashtag/first?__eep__=6&amp;source=note&amp;epa=HASHTAG" rel="noopener ugc nofollow" target="_blank">#first</a> sad little plot<br/>sns.jointplot(x="CCCC_Rank", y="price", data=df)</span></pre><figure class="ml mm mn mo gt jo gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/9172a79534473eac7d059a55b8f3021e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/0*Wd9dk6mzfY9pjacJ"/></div></figure><h1 id="6f1f" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">在更酷的图表上:交互式 Plotly 分布图</h1><p id="9280" class="pw-post-body-paragraph jv jw in jx b jy lu ka kb kc lv ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">第一个图描述了 cccc_rank 和价格之间的分布，而第二个图描述了克拉和价格。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="7d04" class="mu kv in mq b gy mv mw l mx my"><a class="ae kt" href="https://clarityinsights.workplace.com/hashtag/scatter?__eep__=6&amp;source=note&amp;epa=HASHTAG" rel="noopener ugc nofollow" target="_blank">#scatter</a> plot<br/>fig = px.scatter(df<br/>, x="CCCC_Rank"<br/>, y="price"<br/>, color="CCCC_Rank"<br/>, size='carat'<br/>, hover_data=['upc']<br/>, trendline='ols')</span><span id="ae87" class="mu kv in mq b gy mz mw l mx my">fig.show()</span><span id="0f2a" class="mu kv in mq b gy mz mw l mx my">fig = px.scatter(df<br/>, x="carat"<br/>, y="price"<br/>, color="CCCC_Rank"<br/>, color_continuous_scale=px.colors.sequential.Viridis                 , size='carat'<br/>, hover_data=['upc']<br/>, trendline='ols')</span><span id="7fff" class="mu kv in mq b gy mz mw l mx my">fig.show()</span></pre><figure class="ml mm mn mo gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nr"><img src="../Images/3a1a99974f8c7a54ec19a1fdb43bb380.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Oc4hTVAzDSaY2oih"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">我选择了颜色。我是个艺术家。</figcaption></figure><h1 id="96d4" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">接下来我们有一些方框图</h1><p id="08eb" class="pw-post-body-paragraph jv jw in jx b jy lu ka kb kc lv ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">您可以添加更多的代码来将它们并排放在一起。我沿着小路走了几分钟，但很快意识到…谁在乎。如果你问我，那应该是 jupyter 的一个特色。任何人都不应该在这上面浪费时间。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="00e7" class="mu kv in mq b gy mv mw l mx my"><a class="ae kt" href="https://clarityinsights.workplace.com/hashtag/box?__eep__=6&amp;source=note&amp;epa=HASHTAG" rel="noopener ugc nofollow" target="_blank">#box</a> plots<br/>fig1 = px.box(df, x="CCCC_Rank", y="price")<br/># fig1.show()<br/>fig2 = px.box(df, x="clarity", y="price")<br/># fig2.show()<br/>fig3 = px.box(df, x="color", y="price")<br/>fig1.show(), fig2.show(), fig3.show()</span></pre><figure class="ml mm mn mo gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nr"><img src="../Images/3805946ee5eaff28745d5b3ec758da70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BMAm0uVn6yO0o7p6"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">我懒得改变这些颜色。你得到你所得到的。</figcaption></figure><h1 id="9e24" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">接下来，删除一些列</strong></h1><p id="ba29" class="pw-post-body-paragraph jv jw in jx b jy lu ka kb kc lv ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">我觉得这里面的栏目太多了，所以我们要去掉一些。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="443e" class="mu kv in mq b gy mv mw l mx my">#drop unecessary columns<br/>df.drop(['inventory_quantity_virtualwarehouse'<br/>                    ,'inventory_quantity_sanfrancisco'<br/>                    ,'inventory_quantity_philadelphia'<br/>                    ,'inventory_quantity_washingtondc'<br/>                    ,'inventory_quantity_losangeles'<br/>                    ,'inventory_quantity_chicago'<br/>                    ,'inventory_quantity_denver'<br/>                    ,'inventory_quantity_boston'<br/>                    ,'inventory_quantity_sandiego'<br/>                    ,'images.skin_tone'<br/>                    ,'images.similar_purchased'<br/>                    ,'images.purchased'<br/>                    ,'images.thumb_images'<br/>                    ,'images.shape'<br/>                    ,'images.sort_shapes'<br/>                    ,'orderby_short'<br/>                    ,'receiveby'<br/>                    ,'receiveby_short'<br/>                    ,'inventory_location'<br/>                    ,'is_christmas'<br/>                    ,'is_new_year'<br/>                    ,'real_diamond_image']<br/>        ,axis = 1, inplace = True)</span></pre><h1 id="e0e0" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">接下来，再来几张图表</h1><p id="7bc3" class="pw-post-body-paragraph jv jw in jx b jy lu ka kb kc lv ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">方框图——因为我觉得它们看起来很酷。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="80c8" class="mu kv in mq b gy mv mw l mx my">#some bar plots<br/>fig1 = px.bar(df, x="CCCC_Rank", y="price", color="color", barmode="group",<br/>             facet_row="shape", facet_col="color",<br/>             category_orders={"color": ["D", "E", "F", "G", "H", "I"],<br/>                              "shape": ["Pear"]})<br/>fig1.show()</span><span id="e21c" class="mu kv in mq b gy mz mw l mx my">fig2 = px.bar(df, x="CCCC_Rank", y="price", color="cut", barmode="group",<br/>             facet_row="shape", facet_col="cut",<br/>             category_orders={"color": ["D", "E", "F", "G", "H", "I"],<br/>                              "cut": ['Super Ideal', 'Ideal', 'Very Good', 'Good']})<br/>fig2.show()</span></pre><figure class="ml mm mn mo gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nr"><img src="../Images/72d14bc8655115ddd982ada2047a9468.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aOPzufN-I3qdbl6U"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated"><em class="ns"> #nofilter —我的意思是#nocaption </em></figcaption></figure><h1 id="75f4" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">散点图因为很明显。</strong></h1><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="4dda" class="mu kv in mq b gy mv mw l mx my"><a class="ae kt" href="https://clarityinsights.workplace.com/hashtag/similar?__eep__=6&amp;source=note&amp;epa=HASHTAG" rel="noopener ugc nofollow" target="_blank">#similar</a> to a pairplot in seaborn - a scatter_matrix plot</span><span id="f17e" class="mu kv in mq b gy mz mw l mx my">fig = px.scatter_matrix(df, dimensions=["color", "carat", "cut", "clarity", "price"], color="CCCC_Rank")<br/>fig.show()</span></pre><figure class="ml mm mn mo gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/fc965afe6bc79c79df9be34eb34dc8f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gloJwycHm_sNAWIP"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated"><em class="ns">就像 seaborn 的 pairplot，但是是交互式的</em></figcaption></figure><h1 id="fc82" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">最后但同样重要的是，parallel_categories 绘图。</strong></h1><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="4381" class="mu kv in mq b gy mv mw l mx my">#a couple plots to show trendlines and outliers<br/>fig = px.scatter(df, x="price"<br/>                 , y="CCCC_Rank"<br/>                 , color="carat"<br/>                 , size='carat'<br/>                 , hover_data=['upc']<br/>                 , trendline="ols")</span><span id="d2ac" class="mu kv in mq b gy mz mw l mx my">fig.show()</span><span id="6f6c" class="mu kv in mq b gy mz mw l mx my">fig = px.scatter(df, x="price"<br/>                 , y="carat"<br/>                 , color="CCCC_Rank"<br/>                 , size='carat'<br/>                 , hover_data=['upc']<br/>                 , trendline="ols")</span><span id="4cb0" class="mu kv in mq b gy mz mw l mx my">fig.show()</span></pre><figure class="ml mm mn mo gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/f60a9449e4d185a477e911c0328c5790.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZtTuwVFRM5cmu9Rs"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated"><em class="ns">可以说是最酷的情节</em></figcaption></figure><h1 id="d411" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">综上</h1><p id="b796" class="pw-post-body-paragraph jv jw in jx b jy lu ka kb kc lv ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">现在——你已经走了这么远；你已经自动收集了数据，创建了一个可用的数据框架，识别了异常值，提供了一种在线查看钻石的方法，并创建了一些交互式图表，把这些都扔掉了。没错，把我说的都扔出窗外，因为你要看到它才能决定买哪颗钻石！你不知道你不知道什么！你不知道它是否会比你喜欢的看起来更黄，你不知道特定的形状是否有太小的表面，即使它是一个大克拉，它可能仍然比更小克拉的钻石看起来更小。你，不知道。但是你可以说你已经尝试过分析了。我现在正在创造<a class="ae kt" href="https://clarityinsights.workplace.com/hashtag/analyticstry?__eep__=6&amp;source=note&amp;epa=HASHTAG" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"/></a></p><figure class="ml mm mn mo gt jo gh gi paragraph-image"><a href="https://www.buymeacoffee.com/31yearoldmoron"><div class="gh gi nu"><img src="../Images/ef461b3970ac58f55f8649cf7a9260a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:424/format:webp/1*jwJH0fl5PvWn77skm-mddA.png"/></div></a></figure><p id="296c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">感谢阅读。</strong></p><p id="47ae" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">最高出价</strong></p><p id="ffb7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> instagram: @data.env.y 或@maxbade </strong></p><p id="02f0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">github:@超冷 getsalltigirlsmax</strong></p><p id="aebb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> linkedin </strong> : @maxbade</p></div></div>    
</body>
</html>