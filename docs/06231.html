<html>
<head>
<title>Django &amp; Markdown Part 1 (rendering it)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Django &amp; Markdown 第 1 部分(渲染)</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/django-markdown-part-1-rendering-it-b61cbcbc833e?source=collection_archive---------3-----------------------#2021-12-23">https://blog.devgenius.io/django-markdown-part-1-rendering-it-b61cbcbc833e?source=collection_archive---------3-----------------------#2021-12-23</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="6d86" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Markdown 本质上是一种简单的方法，可以在你的网页中包含语法，而不需要输入冗长的带方括号的 html</p><p id="c54e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">从一开始就声明这一点很重要，我认为试图实现 Markdown 的人经常混淆安装 Markdown 编辑器和如何呈现 Markdown 之间的区别。</p><p id="938d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我不得不经常使用它来让它为我工作，我可以从许多 GitHub 提出的问题中看到，许多人都有同样的问题。具体来说，我想用围栏代码来渲染 Markdown，我也想要彩色语法！</p></div><div class="ab cl ki kj hr kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="ig ih ii ij ik"><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/22f61109ca42c4a6078f0f977a9afc8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZJmVR-PDJSlZx6i-bUkZ8w.png"/></div></div></figure><p id="7af2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们开始吧！我将使用一个名为<a class="ae lb" href="https://pypi.org/project/django-markdownify/" rel="noopener ugc nofollow" target="_blank"> Django-markdownify </a>的 Django 包，我还将演示如何添加一些额外的功能，如防护代码和彩色语法高亮显示。</p><h1 id="93aa" class="lc ld in bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">第 1 部分—设置:安装 django-markdownfify</h1><ol class=""><li id="f91a" class="ma mb in jm b jn mc jr md jv me jz mf kd mg kh mh mi mj mk bi translated">假设您已经有了一个 Django 项目，让我们使用终端/CLI(命令行界面)来安装这个包。</li></ol><p id="455c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe ml mm mn mo b">pip install django-markdownify</code></p><p id="8069" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">2.现在，在您的<em class="mp"> settings.py </em>文件中，在您的 INSTALLED_APPS 列表中包含“markdownify”。<br/>稍后，您需要确保行<code class="fe ml mm mn mo b">`django.contrib.staticfiles`</code>也包括在内。</p><pre class="kq kr ks kt gt mq mo mr ms aw mt bi"><span id="025c" class="mu ld in mo b gy mv mw l mx my">INSTALLED_APPS = [<br/>    'django.contrib.staticfiles', # &lt;-- make sure this is there too<br/>    ...<br/>    'markdownify'<br/>]</span></pre><p id="503d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">3.在您的 HTML 模板中包含加载 markdonify 功能的标签。</p><pre class="kq kr ks kt gt mq mo mr ms aw mt bi"><span id="560e" class="mu ld in mo b gy mv mw l mx my">{% load markdownify %} &lt;!-- this will load markdownify --&gt;<br/>&lt;html&gt;<br/>  &lt;head&gt;&lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;h1&gt;Posts&lt;/h1&gt;<br/>    {% for post in posts %}<br/>      &lt;h2&gt;{{post.title}}&lt;/h2&gt;<br/>      &lt;div&gt;<br/>        {{post.body | markdownify}} &lt;!-- note --&gt;<br/>      &lt;/div&gt;<br/>      &lt;hr&gt;<br/>    {% endfor %}<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="3f4d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上面的例子中，在第一行，我演示了如何使用<code class="fe ml mm mn mo b">{% load markdownify %}</code>加载 markdonify 标签，然后使用管道符号和函数<code class="fe ml mm mn mo b">markdonify</code>来表示哪个 Django 注入的数据库字段需要使用 markdown 语法进行转换。</p><h1 id="0981" class="lc ld in bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">第 2 部分:测试结果</h1><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/efa7aeb13ed4dfce82574584ac6bb75a.png" data-original-src="https://miro.medium.com/v2/resize:fit:618/format:webp/1*D8uWTaJAbsS9j9FE52Ebrg.png"/></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">以下是我在 Django 帖子中输入的示例文本</figcaption></figure><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ne"><img src="../Images/e19188e3d7b6e8ecea2049e7d32a0ead.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FIfZHcVnCKmecrqnG55LaQ.png"/></div></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">这是当前的输出</figcaption></figure><p id="b2d0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">有点效果了🤷‍♂️.但是标题实际上并没有起作用，我希望代码块也能起作用。看看下面生成的 HTML:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/6dcacb9e871d9e9ec4790df07be91e1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*APcFdanxZsYkWPB7nDz0mg.png"/></div></figure><p id="aa3e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">正确生成的 HTML 标签可以很好地生成项目符号甚至内联代码。</p><p id="e8c5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">4.在你的<em class="mp"> settings.py </em>文件中添加一些 Markdownify 的设置来正确处理隔离代码</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="2ffc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">本质上，上面的代码告诉 Markdownify 为哪个语法生成标签。我添加了一些默认标签中没有的标签，比如<code class="fe ml mm mn mo b">&lt;h#&gt;</code>、<code class="fe ml mm mn mo b">&lt;span&gt;</code>和<code class="fe ml mm mn mo b">class</code>。</p><p id="0f58" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">除了标记之外，我还添加了应该包含的扩展来检测隔离代码。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/3f670ee5c0fd75f4369adfcc2f215d8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:746/format:webp/1*9YZUtp3cActqwHhKMFZOnw.png"/></div></figure><p id="737b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">看看下面呈现的页面和 HTML 代码。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/082fb61f6656e5094c417d7d6f633bb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*BYxSbIi6Dc-5q6R5JVpxnw.png"/></div></figure><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/c56f038abd7dff4d7b19ac8388ce61ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/1*XjMPBTrGMC3ur5k2ueAG8Q.png"/></div></figure><p id="6a2b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">标题现在可以工作了，代码几乎可以正确显示了。有趣的是，Markdonify 正确地将代码突出显示为 Python。现在我们只想用一些颜色来显示语法。</p><h1 id="025f" class="lc ld in bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">第 3 部分——让它印刷得漂亮！</h1><p id="5ea2" class="pw-post-body-paragraph jk jl in jm b jn mc jp jq jr md jt ju jv nl jx jy jz nm kb kc kd nn kf kg kh ig bi translated">5.在 settings.py 文件的 markdownify 设置中，需要添加另一个名为 codehilite 的扩展名:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/55c496ce6563df3f072c09747f761205.png" data-original-src="https://miro.medium.com/v2/resize:fit:746/format:webp/1*KvidGrywDhVwGCCob1Aujg.png"/></div></figure><p id="5b9f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这在 Python-Markdown 页面<a class="ae lb" href="https://python-markdown.github.io/extensions/" rel="noopener ugc nofollow" target="_blank">扩展— Python-Markdown 3.3.6 文档</a>以及其他支持的扩展中有详细描述。这样做的目的是为已识别的隔离代码块生成带有颜色类的 HTML 代码。</p><p id="4dde" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">正如你在下面的例子中看到的，我们现在有了一个 HTML 输出，带有一个类<code class="fe ml mm mn mo b">codehilite</code>和 span 标签，用于不同的代码元素，比如关键字、整数等等。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi no"><img src="../Images/af90fd9e4ab1e95ee1eab6e2f78faf2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1D7GpNe1WfdYnDRzMvp7mQ.png"/></div></div></figure><p id="4f84" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我会给你额外的截图，结果几乎是一样的，尽管代码块的背景是灰色的。这里的 codehilite 文档<a class="ae lb" href="https://python-markdown.github.io/extensions/code_hilite/" rel="noopener ugc nofollow" target="_blank">也指出，为了给语法着色，我们需要安装另一个名为 Pygments 的 Python 库。→ </a><a class="ae lb" href="https://pypi.org/project/Pygments/" rel="noopener ugc nofollow" target="_blank"> Pygments PyPI </a></p><p id="5b16" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这个包产生了一个 CSS 文件，为产生的 codehilite 类着色语法。</p><p id="65ed" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">6.在 CLI/终端中运行以下命令进行安装</p><pre class="kq kr ks kt gt mq mo mr ms aw mt bi"><span id="f5cb" class="mu ld in mo b gy mv mw l mx my">pip install Pygments</span></pre><p id="7e0f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">7.然后运行下面的命令，用 codehilite 类的语法生成一个 CSS 文档，或者使用由<a class="ae lb" href="https://github.com/richleland/pygments-css" rel="noopener ugc nofollow" target="_blank"> GitHub 用户 Richleand </a>生成的样式表之一。</p><pre class="kq kr ks kt gt mq mo mr ms aw mt bi"><span id="9f92" class="mu ld in mo b gy mv mw l mx my">pygmentize -S default -f html -a .codehilite &gt; codehilite_styles.css</span></pre><p id="2073" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">8.最后，您需要将 CSS 文档添加到根目录下的 templates 目录中。</p><pre class="kq kr ks kt gt mq mo mr ms aw mt bi"><span id="2e0a" class="mu ld in mo b gy mv mw l mx my">+-- core<br/>+-- post<br/>+-- static<br/>|   +-- css<br/>|   |   +-- codehilite_styles.css *&lt;-- place into css dir*<br/>+-- manage.py</span></pre><p id="0fa5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">确保在 settings.py 文件中设置了静态文件目录。</p><pre class="kq kr ks kt gt mq mo mr ms aw mt bi"><span id="38b7" class="mu ld in mo b gy mv mw l mx my">STATIC_URL = '/static/'<br/>STATICFILES_DIRS = [<br/>   os.path.join(BASE_DIR, 'static/'),<br/>]</span></pre><p id="b53b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">9.实际上这是最后一步😂。您需要在模板中使用<code class="fe ml mm mn mo b">{% load static %}</code>标签，并使用 head 标签链接 CSS 文档。</p><pre class="kq kr ks kt gt mq mo mr ms aw mt bi"><span id="e55b" class="mu ld in mo b gy mv mw l mx my">{% load static %} &lt;!-- include the static tag --&gt; <br/>{% load markdownify %}<br/>&lt;html&gt;</span><span id="fbfd" class="mu ld in mo b gy np mw l mx my">&lt;!-- include the head tag here to load CSS --&gt;<br/>&lt;head&gt;<br/>   &lt;link rel="stylesheet" href="{% static    'css/codehilite_styles.css' %}"&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>    &lt;h1&gt;Posts&lt;/h1&gt;<br/>    {% for post in posts %}<br/>      &lt;h2&gt;{{post.title}}&lt;/h2&gt;<br/>      &lt;div&gt;<br/>        {{post.body | markdownify}}<br/>      &lt;/div&gt;<br/>      &lt;hr&gt;<br/>    {% endfor %}<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="1e1b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">所有这些应该会导致…</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/62a5ef2bd879a920b1a42bef59810d58.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*JiNmfWiF_uJbDHrv-yTwNQ.png"/></div></figure><p id="a730" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">正确格式化的减价、代码和语法着色。🎤⬇·哈比比斯·✌✌</p><p id="06db" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">别忘了那些掌声！</p><h1 id="fffc" class="lc ld in bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">更多来自我！</h1><p id="10b5" class="pw-post-body-paragraph jk jl in jm b jn mc jp jq jr md jt ju jv nl jx jy jz nm kb kc kd nn kf kg kh ig bi translated">我喜欢分享我学到的片段。如果你喜欢我的文章，考虑给我提供一些咖啡<a class="ae lb" href="https://ko-fi.com/bitfez" rel="noopener ugc nofollow" target="_blank">https://ko-fi.com/bitfez</a></p></div></div>    
</body>
</html>