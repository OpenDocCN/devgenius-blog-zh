<html>
<head>
<title>Node JS : Node Module System</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">节点 JS:节点模块系统</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/node-js-node-module-system-57f9a0022d?source=collection_archive---------10-----------------------#2022-03-05">https://blog.devgenius.io/node-js-node-module-system-57f9a0022d?source=collection_archive---------10-----------------------#2022-03-05</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><h1 id="79ac" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">节点 JS:节点模块系统</h1><h1 id="31ac" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">全局对象</h1><p id="327c" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">Node.js 全局对象本质上是全局的，它们在所有模块中都可用。我们不需要在应用程序中包含这些对象，而是可以直接使用它们。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi lg"><img src="../Images/e858bc977e2ab6f49f0af7df83e6f5a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M0muUcRaJwee8GTMWD2bxw.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">全局对象</figcaption></figure><h1 id="fcfe" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">组件</h1><p id="7137" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">Node.js 中的模块是一个简单或复杂的功能，组织在单个或多个 JavaScript 文件中，可以在整个 Node.js 应用程序中重用。</p><p id="5057" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">Node.js 中的每个模块都有自己的上下文，所以不能干扰其他模块，也不能污染全局范围。此外，每个模块可以放在单独的。js 文件放在单独的文件夹下。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi lg"><img src="../Images/f61f4fb29922601c37f40767bea83945.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M1pYXgRlYm2eEsKSpBn2Dg.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">组件</figcaption></figure><h1 id="17b5" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">创建模块</h1><p id="535a" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">要访问模块特性，您要做的第一件事就是导出它们。这是使用<a class="ae mb" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/export" rel="noopener ugc nofollow" target="_blank">导出</a>语句完成的。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi lg"><img src="../Images/c208312aa6571504960e2e754a32d1fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OyXVTooxF2_IPzAZ-_wOug.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">创建模块</figcaption></figure><h1 id="a3f2" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">装载模块</h1><p id="d852" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">运行 app.js 查看结果。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi lg"><img src="../Images/e0966c2c3e76a9b34f5f58c364c10e44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yeSmQ1nyv-B6PlxFjNQWlw.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">加载模块</figcaption></figure><h1 id="d5e1" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">模块包装函数</h1><p id="0552" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">在 Node.js 中，每个文件都有一个包装，它用一个函数来执行每个文件，因此 console.log(arguments)打印 Node 传递给包装函数的 5 个参数。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi lg"><img src="../Images/99fff881a5c8c6dab516f5e0d83c1aea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*auJiwdkZDK-VYq6CjR3-5w.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">模块包装函数</figcaption></figure><p id="768e" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">有趣的是，你可能在这里或那里使用过其中的一些，但是像我一样，你现在才发现为什么会发生这种情况。</p><p id="6f5b" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">模块和导出可以用来改变当前模块本身。模块有一个名为 exports 的对象，其默认值为{}</p><p id="9ce4" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">require 用于将其他模块导入您的文件/应用程序</p><p id="b72b" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">__filename 和 __dirname 是当前文件和当前工作目录的路径</p><h1 id="d454" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">路径模块</h1><p id="d095" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">path 模块提供了使用文件和目录路径的实用程序。可以使用以下方式访问它:</p><pre class="lh li lj lk gt mc md me mf aw mg bi"><span id="29eb" class="mh jl in md b gy mi mj l mk ml">const path = require('path');</span></pre><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi lg"><img src="../Images/3e0a876684d7eef60e5f380f223fab8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RnMnkMaZ414_K7-che1iDw.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">路径模块</figcaption></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi lg"><img src="../Images/358624f969ba2e0d31d7dcc9de275f68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*juvNerBPrZ1F-b7esJA2Aw.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">path.parse()</figcaption></figure><h1 id="9fe8" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">操作系统模块</h1><p id="7d14" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated"><code class="fe mm mn mo md b">os</code>模块提供了操作系统相关的实用方法和属性。可以使用以下方式访问它:</p><pre class="lh li lj lk gt mc md me mf aw mg bi"><span id="4c6e" class="mh jl in md b gy mi mj l mk ml">const os = require('os');</span></pre><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi mp"><img src="../Images/cd46120baa6bd0f68ee7203dfa157b9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CW7amtBE5Rj5zF-OEvPvgQ.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">操作系统模块</figcaption></figure><p id="8749" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">os.module 示例</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi mq"><img src="../Images/ef321ad49c9d2ee576ba35ece272701a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HM5vddA8cSnkMobbfEnGBg.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">操作系统（Operating System）</figcaption></figure><h1 id="9035" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">文件系统模块</h1><p id="c418" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated"><code class="fe mm mn mo md b">fs</code>模块支持以一种基于标准 POSIX 函数的方式与文件系统交互。</p><p id="75ae" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">要使用基于承诺的 API:</p><pre class="lh li lj lk gt mc md me mf aw mg bi"><span id="e93d" class="mh jl in md b gy mi mj l mk ml">import * as fs from 'fs/promises';</span></pre><p id="76a3" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">要使用回调和同步 API:</p><pre class="lh li lj lk gt mc md me mf aw mg bi"><span id="a065" class="mh jl in md b gy mi mj l mk ml">import * as fs from 'fs';</span></pre><p id="99da" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">所有文件系统操作都有同步、回调和基于承诺的形式，并且可以使用 CommonJS 语法和 ES6 模块(ESM)进行访问。</p><h1 id="ec30" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">许诺示例<a class="ae mb" href="https://nodejs.org/dist/latest-v16.x/docs/api/fs.html#promise-example" rel="noopener ugc nofollow" target="_blank"> # </a></h1><p id="4fb3" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">基于承诺的操作返回一个承诺，该承诺在异步操作完成时实现。</p><pre class="lh li lj lk gt mc md me mf aw mg bi"><span id="1ab7" class="mh jl in md b gy mi mj l mk ml">import { unlink } from 'fs/promises';</span><span id="ffc9" class="mh jl in md b gy mr mj l mk ml">try {<br/>  await unlink('/tmp/hello');<br/>  console.log('successfully deleted /tmp/hello');<br/>} catch (error) {<br/>  console.error('there was an error:', error.message);<br/>}</span></pre><h1 id="826c" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">回调示例<a class="ae mb" href="https://nodejs.org/dist/latest-v16.x/docs/api/fs.html#callback-example" rel="noopener ugc nofollow" target="_blank"> # </a></h1><p id="309d" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">回调表单将完成回调函数作为最后一个参数，并异步调用操作。传递给完成回调的参数取决于方法，但第一个参数总是为异常保留。如果操作成功完成，那么第一个参数是<code class="fe mm mn mo md b">null</code>或<code class="fe mm mn mo md b">undefined</code>。</p><pre class="lh li lj lk gt mc md me mf aw mg bi"><span id="6365" class="mh jl in md b gy mi mj l mk ml">import { unlink } from 'fs';</span><span id="e1ff" class="mh jl in md b gy mr mj l mk ml">unlink('/tmp/hello', (err) =&gt; {<br/>  if (err) throw err;<br/>  console.log('successfully deleted /tmp/hello');<br/>});</span></pre><p id="b0fe" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">当需要最大性能(在执行时间和内存分配方面)时，基于回调的<code class="fe mm mn mo md b">fs</code>模块 API 比使用 promise APIs 更好。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi ms"><img src="../Images/19772eed8cc15ffabd9fb92f3f6d2633.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BOb0multN2fPYLS2uc9PJA.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">fs.readdirSync</figcaption></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi mt"><img src="../Images/6312ef12972a98cab09e12e116fa6fb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XBdPms630fdLGSe4bh8Cow.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">fs.reddir</figcaption></figure><h1 id="8d53" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">模块事件</h1><p id="8b8f" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">Node.js 核心 API 的大部分是围绕惯用的异步事件驱动架构构建的，在该架构中，某些类型的对象(称为“发射器”)发出命名事件，这些事件导致调用<code class="fe mm mn mo md b">Function</code>对象(“监听器”)。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi mu"><img src="../Images/9557f00bb62b01be176256cd71049ec6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UvGbEVGemT9PGb2Hy3i2sQ.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">事件模块</figcaption></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi mt"><img src="../Images/3484b71cb0bcb14da7483043b62a6908.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m08A489Hc7-rmq_RxIM7Gw.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">扩展 EventEmitter</figcaption></figure><h1 id="8ae0" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">HTTP 模块</h1><p id="3d0c" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">要使用 HTTP 服务器和客户端，必须使用<code class="fe mm mn mo md b">require('http')</code>。</p><p id="df73" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">Node.js 中的 HTTP 接口旨在支持传统上难以使用的许多协议特性。尤其是大的、可能是块编码的消息。该接口很小心，从不缓冲整个请求或响应，因此用户能够传输数据流。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi mv"><img src="../Images/fda18a7e16c976dda81b0ae78abd88b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UXMoy4B2abTWpKx45h5dbg.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">http 模块</figcaption></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi mw"><img src="../Images/88b1ecadcb39e9c18d43dcba5f28a87a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N_hWpVF41IjpZG0MazlKdQ.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">浏览器上的 res</figcaption></figure></div></div>    
</body>
</html>