<html>
<head>
<title>Creating a Physics Based Character Controller in Unity</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 Unity 中创建基于物理的角色控制器</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/creating-a-physics-based-character-controller-in-unity-54ac9a23e2b3?source=collection_archive---------1-----------------------#2021-06-08">https://blog.devgenius.io/creating-a-physics-based-character-controller-in-unity-54ac9a23e2b3?source=collection_archive---------1-----------------------#2021-06-08</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/af9265dabe1d22fb72d8a634a40d0bfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/1*90il4QGC8VIKnkMXMpi9IQ.gif"/></div></div></figure><p id="e356" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我可以在角色上使用刚体，并使用刚体物理学。然而，我想完全控制所有的物理交互，所以我将使用一个<a class="ae kt" href="https://docs.unity3d.com/2021.1/Documentation/Manual/class-CharacterController.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">角色控制器</strong> </a>。</p><p id="b931" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">根据 Unity 手册<a class="ae kt" href="https://docs.unity3d.com/2021.1/Documentation/Manual/class-CharacterController.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">角色控制器</strong> </a></p><blockquote class="ku kv kw"><p id="005c" class="jv jw kx jx b jy jz ka kb kc kd ke kf ky kh ki kj kz kl km kn la kp kq kr ks ig bi translated"><strong class="jx io">角色控制器</strong>主要用于不使用<strong class="jx io">刚体</strong>物理的第三人称或第一人称玩家控制。</p></blockquote><p id="7b2f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">以及<a class="ae kt" href="https://docs.unity3d.com/2021.1/Documentation/ScriptReference/CharacterController.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">脚本 API </strong> </a></p><blockquote class="ku kv kw"><p id="2053" class="jv jw kx jx b jy jz ka kb kc kd ke kf ky kh ki kj kz kl km kn la kp kq kr ks ig bi translated">角色控制器可以让你轻松地进行受碰撞约束的运动，而不必处理刚体。</p><p id="13d5" class="jv jw kx jx b jy jz ka kb kc kd ke kf ky kh ki kj kz kl km kn la kp kq kr ks ig bi translated">角色控制器不受力的影响，只有在调用移动函数时才会移动。然后它将执行运动，但受到碰撞的约束。</p></blockquote><p id="f012" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这正是我想要的。我想要一些东西，我可以用它来移动我的场景，并根据碰撞来限制它的移动。</p><p id="94b2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我从我的播放器上移除了刚体，并添加了一个角色控制器</p><figure class="lc ld le lf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lb"><img src="../Images/b5df7c1d027bebccb7c632f67d63e49e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*_U7lU28UV6CQ7QW82Udaow.gif"/></div></div></figure><p id="5b33" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在我需要一个脚本来控制我的播放器。</p><figure class="lc ld le lf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lg"><img src="../Images/c260419550a64f890c159012c62d347d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*4NlmOO515Rthk9yaanaamA.gif"/></div></div></figure><h1 id="2d8a" class="lh li in bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">球员运动</h1><p id="1569" class="pw-post-body-paragraph jv jw in jx b jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko mj kq kr ks ig bi translated">因为这是一个平台游戏，我将水平移动角色，我将施加我自己的重力并允许玩家跳跃。我需要一个附在播放器上的角色控制器的引用。因为我将使用角色控制器进行移动，所以我将它作为<a class="ae kt" href="https://docs.unity3d.com/2021.1/Documentation/ScriptReference/RequireComponent.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">必需组件</strong> </a>，当我将玩家添加到游戏对象中时，它会将角色控制器添加到游戏对象中，这也将防止角色控制器从游戏对象中移除。我也不必在我的行为中添加任何错误检查，因为我保证角色控制器会在那里。</p><figure class="lc ld le lf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mk"><img src="../Images/745fcf989e5773926046c6f78fb6302b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*lOq-7Hc0yYHkzV6biVCq2A.gif"/></div></div></figure><h2 id="d6ea" class="ml li in bd lj mm mn dn ln mo mp dp lr kg mq mr lv kk ms mt lz ko mu mv md mw bi translated">水平移动</h2><p id="d4a7" class="pw-post-body-paragraph jv jw in jx b jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko mj kq kr ks ig bi translated">我缓存水平输入。然后我把移动方向的 x 轴设为水平移动乘以移动速度。最后，我使用<code class="fe mx my mz na b"><a class="ae kt" href="https://docs.unity3d.com/2021.1/Documentation/ScriptReference/CharacterController.Move.html" rel="noopener ugc nofollow" target="_blank"><strong class="jx io">CharacterControler.Move</strong></a></code>命令角色控制器移动</p><figure class="lc ld le lf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nb"><img src="../Images/d601281d5f1232e1a4e070807378f30e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*uHeEtzqeSq14g43UxV_J3w.gif"/></div></div></figure><p id="6b20" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我现在可以左右移动，请注意，当我撞到平台时，它会阻止我移动。</p><figure class="lc ld le lf gt jo gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/5d32649c6972dc664015878f16b21be6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/1*7uNr8alr085nz0WGzTm2kw.gif"/></div></figure><h2 id="f1cd" class="ml li in bd lj mm mn dn ln mo mp dp lr kg mq mr lv kk ms mt lz ko mu mv md mw bi translated">应用速度</h2><p id="3cbe" class="pw-post-body-paragraph jv jw in jx b jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko mj kq kr ks ig bi translated">接下来，我把我的运动改为方向和速度。这是为了以后我可以加入重力和跳跃。我从方向上去掉了水平移动的速度。我为速度添加了一个矢量 3。然后，我将速度 x 设置为移动方向乘以水平移动速度。然后我告诉角色控制器按照这个速度移动。</p><figure class="lc ld le lf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nd"><img src="../Images/c91e315b4f31fa1db6bf7ecdb74fcf94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Kj51-wmwjUnhppWonZ9vlg.gif"/></div></div></figure><h2 id="86da" class="ml li in bd lj mm mn dn ln mo mp dp lr kg mq mr lv kk ms mt lz ko mu mv md mw bi translated">运用重力</h2><p id="b87f" class="pw-post-body-paragraph jv jw in jx b jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko mj kq kr ks ig bi translated">对于重力，我有一个选择，我可以添加一个值来表示重力的大小，或者我可以使用 Unity 的物理系统提供的值。我可以修改这个值，方法是进入编辑-&gt;项目设置，然后选择物理，这里有一个重力值。也有一个 2D 物理，但我将使用三维物理。</p><figure class="lc ld le lf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ne"><img src="../Images/6ef1d793a74ff68b8f66c49cab7bc4fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*CXLgsumS2opSGA6Hvw8TWw.gif"/></div></div></figure><p id="b176" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我将添加一个值来决定我是否要使用重力。</p><p id="bb6b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在更新代码 I 缓存中，角色控制器是固定的。然后我检查它是否是接地的，这是我将添加的地方，除了能够跳跃之外，现在我什么也不做。如果我没有接地，那么我检查我是否在使用重力，如果是，我把<a class="ae kt" href="https://docs.unity3d.com/ScriptReference/Physics-gravity.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">物理重力</strong> </a>时间增量时间加到我的速度上。</p><figure class="lc ld le lf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nf"><img src="../Images/7861469444861d31fae471542e5958e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*dwnu4TWUz1im1YNPawiXJw.gif"/></div></div></figure><p id="3285" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在玩家倒在平台上。</p><figure class="lc ld le lf gt jo gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/7d1d2708a488980b226e9a3409dca1d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/1*oz3A2WyJwng9BSjofiDKow.gif"/></div></figure><h2 id="bbcb" class="ml li in bd lj mm mn dn ln mo mp dp lr kg mq mr lv kk ms mt lz ko mu mv md mw bi translated">允许玩家跳跃</h2><p id="a8d8" class="pw-post-body-paragraph jv jw in jx b jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko mj kq kr ks ig bi translated">我需要知道玩家能跳多高。在更新方法中，如果玩家被禁足，我会检查是否按下了跳转按钮(编辑-&gt;项目设置-&gt;输入管理器选项卡-&gt;轴-&gt;跳转)。如果按下了跳转按钮，我将 velocity.y 设置为跳转高度。</p><figure class="lc ld le lf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nf"><img src="../Images/c6a3b452a589c39e97b66dfcfe1a3582.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*cNj2wL4JkhVcTHOasdtuZQ.gif"/></div></div></figure><p id="3e23" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我现在可以表演一个跳跃，只要玩家站在一个平台上。</p><figure class="lc ld le lf gt jo gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/564e3daf0e5340ecbfe7240c13097148.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/1*2I3J1CXJSzn8KLw8E6Aj2g.gif"/></div></figure><p id="3cd7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我使用的是来自 Unity 资产商店的<a class="ae kt" href="https://assetstore.unity.com/packages/3d/props/exterior/polygon-prototype-low-poly-3d-art-by-synty-137126" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">多边形原型——Synty</strong>的低多边形 3D 艺术。我可以使用</a><a class="ae kt" href="https://assetstore.unity.com/packages/3d/props/polygon-starter-pack-low-poly-3d-art-by-synty-156819" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">免费多边形入门包——低多边形 3D Art by Synty </strong> </a>实现类似的效果。由于我目前正处于原型制作阶段，使用这些资源只是让我比使用 Unity 的内置原语看起来更好一点。</p><figure class="lc ld le lf gt jo gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/0a3d7403e667bb96b2bc33318e0ccf80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/1*v21swPyBdCt2h-Rl1j71mg.gif"/></div></figure><p id="d2ff" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了获得新的外观，我关闭了我在场景中添加的所有对象的网格渲染，然后将资产提供的不同预设添加到我的游戏对象中。</p><figure class="lc ld le lf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nj"><img src="../Images/8df40ec6acd2430634158dd721af5194.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*BqNgwS0HFwxFm_jgPD35ug.gif"/></div></div></figure></div></div>    
</body>
</html>