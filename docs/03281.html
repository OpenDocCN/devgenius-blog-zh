<html>
<head>
<title>Top starred near-ready JavaScript features</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">顶级的接近就绪的JavaScript特性</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/top-starred-near-ready-javascript-features-40c8ed3630bc?source=collection_archive---------7-----------------------#2020-10-19">https://blog.devgenius.io/top-starred-near-ready-javascript-features-40c8ed3630bc?source=collection_archive---------7-----------------------#2020-10-19</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/27fc1c8512b6bdec3d37607c395fcbdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IUtxvHyf9JMuKhSq.jpg"/></div></div></figure><p id="8c04" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">JS是不断发展的，在这篇文章中，我想谈谈已经完成的和即将问世的内容。社区已经欣赏了这些创新，并期待着它们。</p><p id="9b1e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">JS有几个级别的新特性批准。在本文中，我将讨论第2级和第3级的特性。</p><h1 id="86a8" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">第二阶段提案</h1><p id="ee7d" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">第二层的提议使用正式的规范语言精确地描述语法和语义。</p><p id="300b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们来看看第二阶段最有趣的功能:</p><h2 id="4e0c" class="lw ku in bd kv lx ly dn kz lz ma dp ld kg mb mc lh kk md me ll ko mf mg lp mh bi translated"><strong class="ak"> 1。</strong>装修工</h2><p id="2838" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">装饰器<code class="fe mi mj mk ml b">@decorator</code>是在定义期间在类元素或其他JavaScript语法形式上调用的<em class="mm">函数</em>，潜在地<em class="mm">包装</em>或<em class="mm">用装饰器返回的新值替换</em>它们。</p><p id="82bf" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">修饰类字段被视为包装getter/setter对以访问该存储。修饰存储对于观察/跟踪很有用，这一直是最初的遗留/实验性修饰器与类字段的[[Define]]语义相结合的一个痛点。这些语义基于Michel Weststrate的<a class="ae mn" href="https://github.com/tc39/proposal-decorators/issues/299" rel="noopener ugc nofollow" target="_blank">“诱捕装饰者”提议</a>。</p><p id="d199" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">装饰者也可以用<em class="mm">元数据</em>来注释一个类元素。这些是简单的、不受限制的对象属性，它们是从所有添加它们的装饰者那里收集来的，并作为一组嵌套对象在<code class="fe mi mj mk ml b">[Symbol.metadata]</code>属性中可用。</p><p id="0d68" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">例:<br/><strong class="jx io">@已记录。当一个方法开始和结束时，<code class="fe mi mj mk ml b">@logged</code>装饰器记录一个控制台消息</strong></p><figure class="mo mp mq mr gt jo"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="91f0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe mi mj mk ml b">@logged</code>可以作为装饰器在JavaScript中实现。</p><figure class="mo mp mq mr gt jo"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="65d4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">阅读更多关于提案的信息:<a class="ae mn" href="https://github.com/tc39/proposal-decorators" rel="noopener ugc nofollow" target="_blank">https://github.com/tc39/proposal-decorators</a></p><h2 id="b9ed" class="lw ku in bd kv lx ly dn kz lz ma dp ld kg mb mc lh kk md me ll ko mf mg lp mh bi translated">2.记录和元组</h2><p id="68de" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">这个提议为JavaScript引入了两个新的深度不可变的数据结构:</p><ul class=""><li id="9352" class="mu mv in jx b jy jz kc kd kg mw kk mx ko my ks mz na nb nc bi translated"><code class="fe mi mj mk ml b">Record</code>，一个深不可变的类物体结构<code class="fe mi mj mk ml b">#{ x: 1, y: 2 }</code></li><li id="4932" class="mu mv in jx b jy nd kc ne kg nf kk ng ko nh ks mz na nb nc bi translated"><code class="fe mi mj mk ml b">Tuple</code>，一个深度不可变的类数组结构<code class="fe mi mj mk ml b">#[1, 2, 3, 4]</code></li></ul><p id="5510" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">记录和元组只能包含基元和其他记录和元组。您可以将记录和元组视为“复合原语”。由于完全基于原语，而不是对象，记录和元组是完全不可变的。</p><p id="9a5f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">示例:</p><h2 id="0d87" class="lw ku in bd kv lx ly dn kz lz ma dp ld kg mb mc lh kk md me ll ko mf mg lp mh bi translated"><code class="fe mi mj mk ml b">Record</code></h2><figure class="mo mp mq mr gt jo"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h2 id="3381" class="lw ku in bd kv lx ly dn kz lz ma dp ld kg mb mc lh kk md me ll ko mf mg lp mh bi translated"><code class="fe mi mj mk ml b">Tuple</code></h2><figure class="mo mp mq mr gt jo"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="6080" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">阅读更多关于提案的信息:<a class="ae mn" href="https://github.com/tc39/proposal-record-tuple" rel="noopener ugc nofollow" target="_blank">https://github.com/tc39/proposal-record-tuple</a></p><h2 id="17d2" class="lw ku in bd kv lx ly dn kz lz ma dp ld kg mb mc lh kk md me ll ko mf mg lp mh bi translated">3.暂时的</h2><p id="f613" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated"><code class="fe mi mj mk ml b">Date</code>一直是ECMAScript长期以来的痛点。这就提出了<code class="fe mi mj mk ml b">Temporal</code>，一个充当顶级名称空间的全局<code class="fe mi mj mk ml b">Object</code>(就像<code class="fe mi mj mk ml b">Math</code>)，它为ECMAScript语言带来了一个现代的日期/时间API。关于动机的详细分类，请参见:<a class="ae mn" href="https://maggiepint.com/2017/04/09/fixing-javascript-date-getting-started/" rel="noopener ugc nofollow" target="_blank">修复JavaScript日期</a></p><p id="94e2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">Temporal通过以下方式解决这些问题:</p><ul class=""><li id="3058" class="mu mv in jx b jy jz kc kd kg mw kk mx ko my ks mz na nb nc bi translated">为日期和时间计算提供易于使用的API</li><li id="d887" class="mu mv in jx b jy nd kc ne kg nf kk ng ko nh ks mz na nb nc bi translated">对所有时区的一流支持，包括DST安全算法</li><li id="1494" class="mu mv in jx b jy nd kc ne kg nf kk ng ko nh ks mz na nb nc bi translated">只处理不可变的对象</li><li id="56a2" class="mu mv in jx b jy nd kc ne kg nf kk ng ko nh ks mz na nb nc bi translated">解析严格指定的字符串格式</li><li id="8e13" class="mu mv in jx b jy nd kc ne kg nf kk ng ko nh ks mz na nb nc bi translated">支持非公历日历</li></ul><p id="1912" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">示例:</p><ol class=""><li id="fad3" class="mu mv in jx b jy jz kc kd kg mw kk mx ko my ks ni na nb nc bi translated"><code class="fe mi mj mk ml b">Temporal.now</code>对象有几个给出当前时间和日期信息的方法。</li><li id="286e" class="mu mv in jx b jy nd kc ne kg nf kk ng ko nh ks ni na nb nc bi translated">A <code class="fe mi mj mk ml b">Temporal.Instant</code>代表一个固定的时间点(称为“精确时间”)，不考虑日历或位置。</li><li id="7b3e" class="mu mv in jx b jy nd kc ne kg nf kk ng ko nh ks ni na nb nc bi translated"><code class="fe mi mj mk ml b">Temporal.ZonedDateTime</code>是一种时区感知、日历感知的日期/时间类型，表示从地球上特定地区的角度来看，在特定的确切时间已经发生(或将发生)的真实事件。</li><li id="c00b" class="mu mv in jx b jy nd kc ne kg nf kk ng ko nh ks ni na nb nc bi translated"><code class="fe mi mj mk ml b">Temporal.Date</code>对象表示与特定时间或时区无关的日历日期。</li><li id="fa38" class="mu mv in jx b jy nd kc ne kg nf kk ng ko nh ks ni na nb nc bi translated"><code class="fe mi mj mk ml b">Temporal.Time</code>对象表示与特定日期或时区无关的挂钟时间。</li><li id="afa9" class="mu mv in jx b jy nd kc ne kg nf kk ng ko nh ks ni na nb nc bi translated"><code class="fe mi mj mk ml b">Temporal.DateTime</code>代表日历日期和挂钟时间，不包含时区信息</li><li id="6a90" class="mu mv in jx b jy nd kc ne kg nf kk ng ko nh ks ni na nb nc bi translated">一个<code class="fe mi mj mk ml b">Temporal.Duration</code>表示时间的长度。这用于日期/时间运算和测量<code class="fe mi mj mk ml b">Temporal</code>对象之间的差异。</li><li id="f556" class="mu mv in jx b jy nd kc ne kg nf kk ng ko nh ks ni na nb nc bi translated"><code class="fe mi mj mk ml b">Temporal.TimeZone</code>代表IANA时区、特定的UTC时差或UTC本身。</li><li id="d68a" class="mu mv in jx b jy nd kc ne kg nf kk ng ko nh ks ni na nb nc bi translated">一个<code class="fe mi mj mk ml b">Temporal.Calendar</code>代表一个日历系统。大多数代码将使用ISO 8601日历，但其他日历系统也是可用的。</li></ol><p id="0bbd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">阅读更多关于提案的信息:<a class="ae mn" href="https://github.com/tc39/proposal-temporal" rel="noopener ugc nofollow" target="_blank">https://github.com/tc39/proposal-temporal</a></p><h2 id="4b7b" class="lw ku in bd kv lx ly dn kz lz ma dp ld kg mb mc lh kk md me ll ko mf mg lp mh bi translated">4.领域</h2><p id="2e0d" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">领域是一个独特的全局环境，有自己的全局对象，包含自己的内部函数和内置函数。</p><p id="61b4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">Realms提案提供了一种新的机制，在新的全局对象和JavaScript内置集的上下文中执行JavaScript代码。</p><p id="707f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">API能够控制一个领域内不同程序的执行，为虚拟化提供了一个合适的机制。这在今天的Web平台上是不可能的，而提议的API旨在为所有JS环境提供一个无缝的解决方案。</p><p id="7d9e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">领域可以很好地应用于各种示例:</p><ul class=""><li id="3415" class="mu mv in jx b jy jz kc kd kg mw kk mx ko my ks mz na nb nc bi translated">基于Web的ide或任何类型的使用同源评估策略的第三方代码执行。</li><li id="3beb" class="mu mv in jx b jy nd kc ne kg nf kk ng ko nh ks mz na nb nc bi translated">DOM虚拟化(例如:Google AMP)</li><li id="0014" class="mu mv in jx b jy nd kc ne kg nf kk ng ko nh ks mz na nb nc bi translated">测试框架和报告器(浏览器内测试，也可以在节点中使用<code class="fe mi mj mk ml b">vm</code>)。</li><li id="d680" class="mu mv in jx b jy nd kc ne kg nf kk ng ko nh ks mz na nb nc bi translated">测试/模拟(例如:jsdom)</li><li id="9e71" class="mu mv in jx b jy nd kc ne kg nf kk ng ko nh ks mz na nb nc bi translated">大多数网络插件机制(如电子表格功能)。</li><li id="06fc" class="mu mv in jx b jy nd kc ne kg nf kk ng ko nh ks mz na nb nc bi translated">沙盒(例如:绿洲项目)</li><li id="e40c" class="mu mv in jx b jy nd kc ne kg nf kk ng ko nh ks mz na nb nc bi translated">服务器端渲染(避免冲突和数据泄漏)</li><li id="1050" class="mu mv in jx b jy nd kc ne kg nf kk ng ko nh ks mz na nb nc bi translated">浏览器内代码编辑器</li><li id="73f5" class="mu mv in jx b jy nd kc ne kg nf kk ng ko nh ks mz na nb nc bi translated">浏览器内翻译</li></ul><p id="17d0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">该提案的主要目标是提供一种适当的机制来控制程序的执行，提供一个新的全局对象、一组新的内部函数、对孵化器领域的全局对象的无默认访问、一个单独的模块图以及与孵化器领域的同步通信。</p><p id="05f1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">例子</p><figure class="mo mp mq mr gt jo"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="b3d7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">阅读更多关于提案的信息:<a class="ae mn" href="https://github.com/tc39/proposal-realms" rel="noopener ugc nofollow" target="_blank">https://github.com/tc39/proposal-realms</a></p><h1 id="e582" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">第三阶段提案</h1><p id="d179" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">第三层的建议表明，进一步的改进将需要来自实现和用户的反馈。</p><p id="48c4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们来看看最令人期待的第3阶段功能:</p><h2 id="57cf" class="lw ku in bd kv lx ly dn kz lz ma dp ld kg mb mc lh kk md me ll ko mf mg lp mh bi translated">1.类字段声明</h2><p id="b443" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">这个提议的目的是提供在类体内声明字段的能力。</p><p id="c3a9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">示例:</p><figure class="mo mp mq mr gt jo"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="1555" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在上面的例子中，您可以看到一个用语法<code class="fe mi mj mk ml b">x = 0</code>声明的字段。你也可以声明一个没有初始化器的字段为<code class="fe mi mj mk ml b">x</code>。通过预先声明字段，类定义变得更加自文档化；实例经历更少的状态转换，因为声明的字段总是存在的。</p><p id="e82e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">要使字段私有，只需给它们一个以<code class="fe mi mj mk ml b">#</code>开头的名称。</p><p id="c3ae" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">阅读有关提案的更多信息:<a class="ae mn" href="https://github.com/tc39/proposal-class-fields" rel="noopener ugc nofollow" target="_blank">https://github.com/tc39/proposal-class-fields</a></p><h2 id="58ad" class="lw ku in bd kv lx ly dn kz lz ma dp ld kg mb mc lh kk md me ll ko mf mg lp mh bi translated">2.顶级<code class="fe mi mj mk ml b">await</code></h2><p id="57e8" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">顶级<code class="fe mi mj mk ml b">await</code>使模块能够充当大型异步函数:有了顶级<code class="fe mi mj mk ml b">await</code>，ECMAScript模块(ESM)可以<code class="fe mi mj mk ml b">await</code>资源，导致其他模块在开始评估它们的身体之前等待。</p><p id="75ec" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">顶层<code class="fe mi mj mk ml b">await</code>让我们依靠模块系统本身来处理所有这些承诺，并确保事情得到很好的协调。上面的例子可以简单地写成和使用如下:</p><figure class="mo mp mq mr gt jo"><div class="bz fp l di"><div class="ms mt l"/></div></figure><figure class="mo mp mq mr gt jo"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="70cc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在<code class="fe mi mj mk ml b">awaiting.mjs</code>中的<code class="fe mi mj mk ml b">await</code>的承诺得到解决之前，<code class="fe mi mj mk ml b">usage.mjs</code>中的任何语句都不会执行，因此通过设计避免了竞争情况。这是一个扩展，如果<code class="fe mi mj mk ml b">awaiting.mjs</code>没有使用顶级<code class="fe mi mj mk ml b">await</code>，那么<code class="fe mi mj mk ml b">usage.mjs</code>中的任何语句都不会执行，直到<code class="fe mi mj mk ml b">awaiting.mjs</code>被加载并且它的所有语句都被执行。</p><p id="93bb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">阅读更多关于提案的信息:<a class="ae mn" href="https://github.com/tc39/proposal-top-level-await" rel="noopener ugc nofollow" target="_blank">https://github.com/tc39/proposal-top-level-await</a></p></div><div class="ab cl nj nk hr nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="ig ih ii ij ik"><p id="35f0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">还有更多第二阶段和第三阶段的提议，在这里阅读它们—<a class="ae mn" href="https://github.com/tc39/proposals" rel="noopener ugc nofollow" target="_blank">https://github.com/tc39/proposals</a></p><p id="fb0b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">感谢阅读！</p><p id="d401" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">P.S .如果你想在早期阶段了解更多关于最有趣的提议，请阅读此<a class="ae mn" href="https://medium.com/dev-genius/top-starred-javascript-features-at-early-stage-982de948f2ae" rel="noopener">https://medium . com/dev-genius/top-starred-JavaScript-features-at-early-phase-982 de 948 F2 AE</a>。</p></div></div>    
</body>
</html>