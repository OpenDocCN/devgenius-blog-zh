# 有效的 Java！谨慎使用变量

> 原文：<https://blog.devgenius.io/effective-java-use-varargs-judiously-d1bd824aa650?source=collection_archive---------4----------------------->

varargs 参数是 Java 的一个语法糖特性，它允许您定义一个参数，该参数允许调用者提供零个或多个已定义类型的参数。在接收函数中，这些值作为指定类型的数组提供。

让我们看一个简单的例子:

```
static int sum(int... args) {
  int sum = 0;
  for (int arg : args) {
    sum += arg;
  }
  return sum;
}
```

这种方法可以叫做像`sum(1,2)`当然会产生`3`或者`sum(1,2,3)`当然会产生`6`甚至`sum()`会产生`0`。

这种能力非常有用，但是在使用 varags 时会出现一些问题。让我们考虑其中的一些，以及我们如何克服挑战。

有时，您可能希望接受最少数量的参数。如上所述，varags 本身允许传入 0 到 n 个参数。我们可以考虑在运行时检查数组的大小。虽然这样做可行，但它的缺点是错误是在运行时而不是编译时被发现的。这种解决方案也可能是丑陋的，并且妨碍了真正的逻辑。尽管有更好的方法。考虑一下我们是否想最少用一个论点。解决这个问题的方法是给我们的方法两个参数。一个只是类型，第二个是 vararg 参数。这将迫使调用者在编译时至少提供一个参数。看起来可能是这样的:

```
static int min(int firstValue, int... restOfValues) {
  int currentMin = firstValue;
  for (int value : restOfValues) {
    if ( value < currentMin) {
      currentMin = value;
    } }
  return currentMin;
}
```

使用 vararg 参数的另一个潜在缺陷是在性能关键的应用程序中。这是因为每个方法调用都需要创建一个数组。如果这发生在循环中，这可能会产生可避免的内存压力，从而损害应用程序的性能。一种可能的缓解策略是，例如，如果 95%的函数调用方包含 3 个或更少的参数，您可以创建三个函数，分别使用 1、2 和 3 个参数类型的参数来处理 95%的调用方，第四个函数使用三个参数和一个 vararg 参数来处理剩下的 5%的调用方。这就是`EnumSet`对象帮助它保持良好性能的原因。很多时候这种优化是不合适的，但是在这种情况下，它可以是救命稻草。

总之，作为 Java 语言的一部分，varargs 参数是一个有用的特性。和所有的特性一样，这个特性也有一些粗糙的地方，我们应该注意。然而，当我们牢记这些事情时，我们可以对代码做一些很大的改进。