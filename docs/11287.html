<html>
<head>
<title>Time Series Analysis in R: Regression, Autoregressive Models, and Neural Networks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">R 中的时间序列分析:回归、自回归模型和神经网络</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/time-series-analysis-in-r-regression-autoregressive-models-and-neural-networks-c340720d06c6?source=collection_archive---------5-----------------------#2022-12-30">https://blog.devgenius.io/time-series-analysis-in-r-regression-autoregressive-models-and-neural-networks-c340720d06c6?source=collection_archive---------5-----------------------#2022-12-30</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="b7d4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在我深入时间序列之前，我想花点时间把这篇文章中使用的代码归功于波格丹一世·阿纳斯塔西。他有一门 Udemy 课程，叫做 R 中的时间序列预测:一种脚踏实地的方法，在那里我学到了这段代码。他已经允许我使用这个密码。我强烈推荐他的时间序列课程:</p><p id="300f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">阿纳斯塔西耶，b .(未注明)。<em class="ki">R 中的时间序列预测:一种脚踏实地的方法</em>。乌德米。检索于 2022 年 12 月 16 日，来自<a class="ae kj" href="https://www.udemy.com/course/time-series-forecasting-in-r-a-down-to-earth-approach/" rel="noopener ugc nofollow" target="_blank">https://www . udemy . com/course/time-series-forecasting-in-r-a-脚踏实地的方法/ </a></p><h1 id="ed70" class="kk kl in bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">回归</h1><p id="854f" class="pw-post-body-paragraph jk jl in jm b jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc kd lm kf kg kh ig bi translated">时间序列回归模型使用过去观察值的线性组合来预测未来观察值。我将展示趋势和季节性是如何被回归模型捕捉到的。</p><p id="9f37" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要求(ggplot2) <br/>要求(lubridate) <br/>要求(预测)<br/>要求(fpp2) <br/>要求(TSstudio)</p><p id="aec1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ts_plot(美国天然气)</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ln"><img src="../Images/384011d1c07c154c71cbf1a08bbec726.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FnaZeoQ4g0Ch0ScfaK6SZw.png"/></div></div></figure><p id="3e20" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#转换为数据帧<br/>us gas _ df&lt;-ts _ to _ prophet(us gas)</p><p id="24b4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">dim(usgas_df) <br/> .8 * 238</p><p id="0842" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">us gas _ trainus gas _ test&lt;-us gas _ df[191:238，]</p><p id="1fd5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">新测试新测试#48</p><p id="5b13" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">绘图(美国天然气公司 _df$y)</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi lz"><img src="../Images/698c2b43f25b3778f90b251138d1b322.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PYoENKuOb5o46Nd2pRcs1Q.png"/></div></div></figure><p id="4319" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#放大<br/>图(usgas_df$y[1:24])</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ma"><img src="../Images/895c50ef16bc4c05d6560528f5c8011c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2RjPilGu17e7CVB2lgWFAA.png"/></div></div></figure><p id="ed28" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#似乎有每月的季节性成分</p><p id="2ca9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#建立模型<br/>us gas _ train _ ts _ season&lt;-ts(us gas _ train $ y，freq=12) <br/> #freq = 12 以说明月份</p><p id="ff0e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">model _ season#线性趋势分量、二次趋势分量和季节分量，如果要在趋势保持二次的同时使季节分量相乘，则添加 lambda = 0</p><p id="405e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">型号 _ 季节</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi mb"><img src="../Images/e3a57e0662ed667cc768b5d779c0cd7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wxJcokRvLYMxrgiU9Mcb6A.png"/></div></div></figure><p id="bdfc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">总结(型号 _ 季节)</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi mc"><img src="../Images/e58b5c717baf9d062c8755548261bca2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xdXAfModhBhJW_HOudSkNA.png"/></div></div></figure><p id="d260" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">pred_season 精度(pred_season，usgas_test$y)</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi md"><img src="../Images/b14fa784426b60ce4d89124a746b6e76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5cnqFbanUZzFAhl_hxtMBQ.png"/></div></div></figure><p id="af31" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">us gas _ train $ pred _ train _ seasonus gas _ test $ pred _ test _ season&lt;-pred _ season $均值</p><p id="1cd2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">头(usgas_df) <br/>头(usgas_test)</p><p id="ae87" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">gg plot()+<br/>geom _ line(data = US Gas _ df，aes(ydm(ds)，y，group = 1))+<br/>geom _ line(data = US Gas _ train，aes(ydm(ds)，pred_train_season)，<br/> color="dodgerblue4 "，size=1)+<br/>geom _ line(data = US Gas _ test，aes(ydm(ds)，pred_test_season)，<br/> color="dodgerblue4 "，size = 1</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi me"><img src="../Images/b71c2cee2a89257b7302890a03871379.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pPeOXodfFQ1ZNvb8M9BSvg.png"/></div></div></figure><p id="50f3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">gg plot()+<br/>geom _ line(data = US Gas _ df[191:238，]，aes(ydm(ds)，y，group = 1))+<br/>geom _ line(data = US Gas _ test，aes(ydm(ds)，pred_test_season)，<br/> color="dodgerblue4 "，size = 1)+<br/>xlab(" Year ")+<br/>ylab("美国每月天然气消耗量")</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi mf"><img src="../Images/d3bfbf78f55486058576401fe8c723b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pgH-1T1zUmWj9U_B2mWJNQ.png"/></div></div></figure><h1 id="edd0" class="kk kl in bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">自回归模型</h1><p id="725c" class="pw-post-body-paragraph jk jl in jm b jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc kd lm kf kg kh ig bi translated">自相关测量数据与滞后的相关性，滞后是数据的延迟版本。例如，一阶滞后将被延迟一个周期，二阶滞后将被延迟两个周期。自相关和部分自相关函数可用于测量这些滞后。自回归过程值可以通过结合适当的滞后值由部分自相关函数来确定。例如，如果在第七个滞后有相关性，AR 等于 7 可能是一个好的选择。这可能需要一些尝试和错误。如果误差项具有模式，可以使用移动平均过程。MA 过程值可以通过参考自相关函数的滞后结果来确定。自回归和移动平均过程可以合并(ARMA)。值得注意的是，自回归模型要求时间序列是平稳的，这可以通过 Dickey-Fuller 检验来确认。如果数据碰巧不是静态的，可以使用差分法。如果包含滞后变量的差异，该模型是自回归综合移动平均(ARIMA)。</p><p id="28ae" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#自回归模型</p><p id="161b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"># simulations<br/>#创建 700 个值的二阶自回归模型<br/>set . seed(7)<br/>stat _ ts&lt;-ARIMA . sim(list(order = c(2，0，0)，ar=c(0.4，0.3))，n = 700)<br/>#定义阶向量，阶为 2，0 为差分度，0 为移动平均过程的阶<br/>#只有一个二次的 ar 过程<br/> plot(stat_ts</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi mg"><img src="../Images/adb77b948b9b79f62c81fe0ca168f016.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D-mm5OiH5duh2fmniXBOnw.png"/></div></div></figure><p id="2505" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#模拟一个三阶过程<br/>stat _ ts&lt;-ARIMA . sim(list(order = c(3，0，0)，ar=c(0.3，0.2，0.1))，n = 700)<br/>#定义阶向量，阶为 3，0 为差分度，0 为移动平均过程的阶<br/>#只有一个三阶 ar 过程，一个三阶 ar 过程<br/> plot(stat_ts)</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi mh"><img src="../Images/3fb895f1b8bfb780f7320b78d02ed0a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*32eyVK12lRmBzIO5k4-zBQ.png"/></div></div></figure><p id="41e2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#移动平均过程，过去误差项的线性组合<br/>#可用于改进模型，如果误差项具有某些模式<br/>stat _ ts&lt;-ARIMA . sim(list(order = c(0，0，2)，ma=c(-0.1，0.1)，n = 700)<br/>#第一个元素为 0，ar 过程不包括在此，差分度为 0，<br/># ma 过程为 2，然后用 ma 参数<br/>定义系数</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi mi"><img src="../Images/33c89ea36e59f12655e88b5e3aa889aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HcRvZf7TFdmbR6cd2eLw6A.png"/></div></div></figure><p id="adbf" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#模拟 ARMA 过程，(3，2)<br/>stat _ ts&lt;-ARIMA . sim(list(order = c(3，0，2)，ar=c(0.3，0.2，0.1)，MA=c(-0.1，0.1)，n=700) <br/> #order 3 自回归过程，0 差分，2 移动平均过程，然后指定 ar 和 ma 的系数<br/> plot(stat_ts)</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi mj"><img src="../Images/6f44923a9d7c0c1fd47cf6866fdcf465.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KQ_1q4fBxsBavFIu9Py3wQ.png"/></div></div></figure><p id="250d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#ARIMA，包含滞后变量的差分<br/>stat _ ts&lt;-ARIMA . sim(list(order = c(3，1，2)，ar=c(0.3，0.2，0.1)，MA=c(-0.1，0.1)，n=700) <br/> #ar 过程 3，差分 1，ma 过程 2<br/>quartz()<br/>【plot(stat _ ts)<br/>#模拟的时间序列不是平稳的，趋势不是恒定的</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi mk"><img src="../Images/4d928b3fddfc71dca6f39864b0fd95ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g2f5rAs3iogvMfB8udl-RA.png"/></div></div></figure><p id="de9c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我现在将使用我在回归中使用的相同的美国天然气公司数据集，并应用 ARIMA 模型。</p><p id="def5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">需求(预测)<br/>需求(t 系列)<br/>需求(ggplot2) <br/>需求(lubridate) <br/>需求(TSstudio)</p><p id="879d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#转换为数据帧<br/>数据()<br/> USgas <br/> ts_plot(USgas)</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ml"><img src="../Images/b4ff693eeb79ddd4ef86f8454a04e9fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9ldjfE4Gk2XCy4xSml1bsw.png"/></div></div></figure><p id="437b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">usgas_df 头(usgas_df) <br/>尾(usgas_df) #238 2</p><p id="29f2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi">.75 * 238 #179</p><p id="91cf" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#创建训练和测试集<br/>us gas _ train&lt;-us gas _ df[1:179，]<br/>us gas _ test&lt;-us gas _ df[180:238，]<br/>ntest&lt;-nrow(us gas _ test)<br/>ntest</p><p id="881e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#将训练集转换为时间序列<br/>us gas _ train _ ts&lt;-ts(us gas _ train $ y)</p><p id="61b9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#平稳性测试<br/> adf.test(usgas_train_ts，alternative = " stationary ")<br/># HO:&gt;. 05 序列不平稳<br/> #HA: &lt; .05 序列平稳<br/># p 值为 0.01，序列通过平稳性测试</p><p id="6e03" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#如果有必要进行差分:<br/># us gas _ train _ ts _ diff&lt;-diff(us gas _ train _ ts，differences = 1)</p><p id="66e0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">石英()<br/>Pacf(us gas _ train _ ts)#用于 AR 过程<br/> #13</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi mm"><img src="../Images/6caed1c1dbca62f4bbef83fdf757daf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2HoXg5lMbDMJcujS9sn7zA.png"/></div></div></figure><p id="709b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">石英()<br/>Acf(us gas _ train _ ts)#用于并购过程<br/> #22</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi mn"><img src="../Images/1e5487929075d6dddfbba9b2b25fc703.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f-gPwGlBW51yvBJplUKeSQ.png"/></div></div></figure><p id="a71e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#建立模型<br/>？Arima() <br/>模型&lt; - Arima(usgas_train_ts，order = c(13，0，22)，method = c(" ML ")<br/># ML 法是最大似然，备选项是最小化条件平方和" CSS "</p><p id="ad91" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">摘要(模型)</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi mo"><img src="../Images/a5fc64d1b949161145656c309fa312a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PRZ7WaSvDOmyvvmEs53Omw.png"/></div></div></figure><p id="b7b3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">石英()<br/>图(模型$拟合)</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi mp"><img src="../Images/5d7d043a55324b5dc93b16cdf06cfbeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sAVGkAlXZiImOXd1i49UdA.png"/></div></div></figure><p id="186c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">quartz() <br/>图(模型$残差)</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi mq"><img src="../Images/cad1fc540dc8298897da5a23fa117349.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wys9vxcCpZF2qsJ-idIUkQ.png"/></div></div></figure><p id="9a1a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#对测试集<br/> pred &lt; - forecast(model，h=ntest，level=0) <br/> accuracy(pred，usgas_test$y)进行预测</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi mr"><img src="../Images/b13271502df63a5f3fa3c421dedaa516.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JEcAlzRosZ17SZpZ-OmQZw.png"/></div></div></figure><p id="9d02" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">开发关闭()</p><p id="743d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">us gas _ train＄train _ predus gas _ test＄test _ pred&lt;-pred＄均值</p><p id="5eaa" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">负责人(美国气体测试)</p><p id="49fc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">gg plot()+<br/>geom _ line(data = US Gas _ df，aes(ydm(ds)，y，group = 1))+<br/>geom _ line(data = US Gas _ train，aes(ydm(ds)，train_pred)，<br/> color="dodgerblue4 "，size=1)+<br/>geom _ line(data = US Gas _ test，aes(ydm(ds)，test_pred)，<br/> color="dodgerblue4 "，size = 1)+【中</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ms"><img src="../Images/9891dce356a91fa8c308ee1a4d197792.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5svdcqB3a12eNjKPXpOPZQ.png"/></div></div></figure><p id="6bef" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">回归的第一个例子在这种情况下做了更好的预测，但是我喜欢比较不同的测试结果。</p><h1 id="bd8c" class="kk kl in bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">神经网络</h1><p id="0b4e" class="pw-post-body-paragraph jk jl in jm b jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc kd lm kf kg kh ig bi translated">受大脑神经连接的启发，神经网络是一种黑盒机器学习方法，由输入层、一个或多个隐藏层和预测输出层组成，在隐藏层中进行求和和激活，直到预测误差低于指定阈值。</p><p id="10cb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#神经网络<br/> #nnetar()创建滞后变量，删除具有缺失值的行，缩放预测值，删除并稍后重新实现趋势和季节性<br/>#参数 P，模型中包含的非季节性滞后的数量<br/> #P，季节性滞后的数量，1 为季节性滞后，0 为非季节性滞后<br/>#大小，隐藏层中的节点数量，默认为输入变量的数量加上 1<br/>#重复次数，用不同的随机起始权重构建的网络数量，默认为 20，默认为</p><p id="b0c9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">需求(预测)<br/>需求(tseries) <br/>需求(ggplot2) <br/>需求(lubridate) <br/>需求(TSstudio)</p><p id="0d7c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#转换为数据帧<br/>data()<br/>us gas<br/>ts _ plot(us gas)</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi mt"><img src="../Images/5315b8d5efbcdf4eb0d5217daea767b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kaT6SZw8wyB3xWorSuasCw.png"/></div></div></figure><p id="e4c6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">usgas_df 头(us gas _ df)<br/>dim(us gas _ df)# 238 2</p><p id="e708" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#创建训练和测试集<br/>us gas _ train&lt;-us gas _ df[1:179，]<br/>us gas _ test&lt;-us gas _ df[180:238，]<br/>ntest&lt;-nrow(us gas _ test)<br/>ntest</p><p id="c3e5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#将训练集转换为时间序列<br/>us gas _ train _ ts&lt;-ts(us gas _ train $ y)</p><p id="e7be" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#建立神经网络<br/>net&lt;-nnetar(us gas _ train _ ts，repeats = 20)<br/>#重复该过程 20 次，将通过平均 20 次结果得到预测</p><p id="b773" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">net$p #14 lags <br/> net$P #0 季节性 lags，series not seasonal<br/>net $ size # 8 隐藏层中的节点</p><p id="8e88" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">plot(net $ fitted)<br/>plot(net $ residuals)#没有前 14 个滞后的数据</p><p id="51fd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#在测试集中进行预测<br/> pred_net &lt; - forecast(net，h=ntest) <br/> pred_net$mean <br/>准确性(pred_net，usgas_test$y)</p><p id="d138" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">usgas_df$pred 头(us gas _ test)# 2014–12–01</p><p id="d498" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"># plot<br/>gg plot(US Gas _ df)+<br/>geom _ line(AES(ydm(ds)，y，group = 1))+<br/>geom _ line(AES(ydm(ds)，pred)，<br/> color="dodgerblue4 "，size = 1)+<br/>geom _ vline(AES(xintercept = ydm(" 2014–12–01 "))，color="darkorange2 "，size=.6)+ <br/> xlab</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi mu"><img src="../Images/5169ffbdffb4fb75c1759edf4b6aa97c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v90g0V9ZghUwdG3eXzZvAg.png"/></div></div></figure><p id="7622" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#前 14 个观察值没有预测，第一个回归示例再次明显优于神经网络</p><p id="965d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#第二个例子<br/>usv Sales #美国每月汽车总销量</p><p id="b3c1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ts_plot(美国销售)</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi mt"><img src="../Images/8b07ac5b568c9a1d0e5c0c30bfa211ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U5AslakSk0x6IrHVf7AjQA.png"/></div></div></figure><p id="43e1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">usvs _ dfhead(usvs _ df)<br/>dim(usvs _ df)# 528 2</p><p id="e711" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi">528*.75</p><p id="812f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#创建训练和测试集<br/>usvs _ train&lt;-usvs _ df[1:396，]<br/>usvs _ test&lt;-usvs _ df[397:528，]<br/>ntest&lt;-nrow(usvs _ test)<br/>ntest</p><p id="edbe" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#将训练集转换为时间序列<br/>usvs _ train _ ts&lt;-ts(usvs _ train $ y)</p><p id="5039" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#建立神经网络<br/>net&lt;-nnetar(usvs _ train _ ts，repeats = 20)<br/>#重复该过程 20 次，将通过平均 20 次结果得到预测</p><p id="32f4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">net$p #18 lags <br/> net$P #0 季节性 lags，series not seasonal<br/>net $ size # 10 节点在隐藏层</p><p id="bd72" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">plot(net $ fitted)<br/>plot(net $ residuals)#没有前 18 个滞后的数据</p><p id="e7e5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#在测试集中进行预测<br/> pred_net &lt; - forecast(net，h=ntest) <br/> pred_net$mean <br/>准确性(pred_net，usvs_test$y)</p><p id="99e1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">usvs_df$pred 负责人(usvs _ test)# 2009–01–01</p><p id="3cb4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"># plot<br/>gg plot(usvs _ df)+<br/>geom _ line(AES(ydm(ds)，y，group = 1))+<br/>geom _ line(AES(ydm(ds)，pred)，<br/> color="dodgerblue4 "，size = 1)+<br/>geom _ vline(AES(xintercept = ydm(" 2009–01–01 "))，color="darkorange2 "，size = . 6)+<br/>XL</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi mv"><img src="../Images/ecaf2a23a79285921bea88b5e85fcf4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k0tTfVoAqkM4C-7qj1nXyQ.png"/></div></div></figure><p id="daab" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#放大预测<br/> ggplot(usvs_df[397:528，])+ <br/> geom_line(aes(ydm(ds)，y，group = 1))+<br/>geom _ line(AES(ydm(ds)，pred)，<br/> color="dodgerblue4 "，size = 1)+<br/>geom _ vline(AES(xintercept = ydm(" 2009–01–01 "))，color="darkorange2</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi mw"><img src="../Images/f8b0aa53cb24ee97da1286f7efa5d6a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ipx-us8WyuK3zU54GObPnQ.png"/></div></div></figure><p id="7efa" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#最后一个例子<br/>usun Rate #美国每月平民失业率</p><p id="7645" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ts_plot(USUnRate)</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi mx"><img src="../Images/6ede181282cbb3c498105589b6c8fb84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*90CPwdo_Wp8winp5z1Ecvg.png"/></div></div></figure><p id="be28" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"># convert to data frame<br/>usun _ df&lt;-ts _ to _ prophet(usun rate)<br/>head(usun _ df)<br/>dim(usun _ df)# 864 2</p><p id="9f7b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi">864*.75</p><p id="47f1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#创建训练和测试集<br/>usun _ train&lt;-usun _ df[1:648，]<br/>usun _ test&lt;-usun _ df[649:864，]<br/>ntest&lt;-nrow(usun _ test)<br/>ntest</p><p id="d558" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#将训练集转换为时间序列<br/>usun _ train _ ts&lt;-ts(usun _ train $ y)</p><p id="c919" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#建立神经网络<br/>net&lt;-nnetar(usun _ train _ ts，repeats = 20)<br/>#重复该过程 20 次，将通过平均 20 次结果得到预测</p><p id="a2a0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">net$p #25 lags <br/> net$P #0 季节性 lags，series not seasonal<br/>net $ size # 13 隐藏层中的节点</p><p id="df41" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">plot(net $ fitted)<br/>plot(net $ residuals)#没有前 25 个滞后的数据</p><p id="c6dc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#在测试集中进行预测<br/> pred_net &lt; - forecast(net，h=ntest) <br/> pred_net$mean <br/>准确性(pred_net，usun_test$y)</p><p id="707a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">usun_df$pred 头(usun _ test)# 2002–01–01</p><p id="3213" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"># plot<br/>gg plot(usun _ df)+<br/>geom _ line(AES(ydm(ds)，y，group = 1))+<br/>geom _ line(AES(ydm(ds)，pred)，<br/> color="dodgerblue4 "，size = 1)+<br/>geom _ vline(AES(xintercept = ydm(" 2002–01–01 "))，color="darkorange2 "，size=.6)+ <br/> xlab</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="ab gu cl my"><img src="../Images/48b31ad5c721b25fe723ad3eb31792f9.png" data-original-src="https://miro.medium.com/v2/format:webp/1*M3NdSTxGYJY7UAudvQMVNA.png"/></div></figure><p id="b163" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">#放大预测<br/> ggplot(usun_df[649:864，])+ <br/> geom_line(aes(ydm(ds)，y，group = 1))+<br/>geom _ line(AES(ydm(ds)，pred)，<br/> color="dodgerblue4 "，size = 1)+<br/>geom _ vline(AES(xintercept = ydm(" 2002–01–01 "))，color="darkorange2</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi mz"><img src="../Images/682668cc0077d3fe92ebb4fa030449b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lKzCZgyaZxxL1eZotIbi9w.png"/></div></div></figure></div></div>    
</body>
</html>