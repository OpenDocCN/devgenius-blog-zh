# Git 中的樱桃采摘艺术

> 原文：<https://blog.devgenius.io/the-art-of-cherry-picking-in-git-b223025aaeb?source=collection_archive---------7----------------------->

![](img/e785862953481b9f7dec87bc5cb2053d.png)

默罕默德·阿敏·马苏德在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

Git 从未停止让我惊讶。它所包含的思考过程以及它是如何工作的是令人惊讶的。现在完全公开的是，我不会解释甚至探索 git 是如何在引擎盖下工作的。

这个故事宁愿解决如何樱桃挑选，而不是如何樱桃挑选内部工作。

第一个问题是，我们首先需要樱桃采摘的原因是什么？

假设您正在为分布式计算开发一个开源消息队列系统(或者只是假设您正在开发什么..)经过一段时间后，社区决定用它来创建一个稳定的产品。

因此，这意味着只有那些已经在社区代码库中得到充分测试和渗透的特性才会让位于产品代码库。现在在开源术语中，社区代码库将被称为上游的**和下游的【产品代码库】。原因是特性将从社区代码库转移到产品代码库，就像水从上游流向下游一样。**

需要记住的一点是，下游并不一定意味着产品被打包出售给客户。任何从实验代码库被认为是稳定的代码库在接受测试特性后，都将处于该实验代码库的下游。因此，这将意味着也可能有多个上游和下游代码库，并且上游-下游的概念对于我们将哪个代码库作为参考框架是主观的。

现在我们已经理解了上游和下游的概念，让我们继续讨论我们需要将特性从一个代码库转移到另一个代码库的部分。代码是由 git 维护的，因此每个特性[我假设代码提交是在一个问题或特性增强的情况下完成的，而不是在开发人员想推送代码的时候随意推送代码]，都将是上游的一个提交或一系列提交。

我们计划在下游合并的正是这些提交。问题是我们如何做到这一点？

我们是否打开两个平行的窗口并将代码从一个窗口复制到另一个窗口？【不！！]想象一个跨越整个项目的特性提交，并且有大量的代码变更[祝你手工合并好运]。

这就是 cherry pick 的用武之地。顾名思义，我们将精选樱桃[提交]并将其添加到派生的代码库中。

因此，在一个非常高级的视图中，您将在一个文件中列出要迁移的提交及其合并 id，然后只挑选这些特性添加到您的产品代码中。

既然我们已经理清了理论。[我希望你理解上游和下游的概念，以及为什么 cherry pick 是一个救生员]。我们举个例子来更好的理解吧【一个真实的例子】。

假设，我们有一个存储库 **sample-repo-up** ，您必须从中挑选出一个具有散列值 **qwd333r** 的特定提交(只是为了举例)..]到一个存储库 **sample-repo-dw** 。

第一步是克隆 **sample-repo-dw** (当然)，然后获取远程 repo 中的最新变更，并在其上重新构建工作分支。

一旦完成，就必须为这个新克隆的 repo 中的**样本 repo-up** 添加遥控器。这可以通过下面的命令来完成，

```
# git remote add <some_remote_name> <url_of_sample-repo-up>
```

一旦添加完成，我们必须获取最新的变更历史，以防样本回购。因此，必须再次运行 git fetch。

在进入挑选的最后阶段之前，在 **git show** 命令的帮助下验证散列是否存在。如果我们看到了 git commit 提交的细节，我们希望进行精选，那么我们就在正确的轨道上，否则我们必须回过头来看看是否使用了错误的散列。

最后，跑

```
# git cherry-pick <hash_value>
```

这将获取您想要挑选的提交，并开始合并过程。如果有任何合并冲突，git 会让您知道，否则您可以继续提交新合并的变更到 **sample-repo-dw** 。

现在，我无法在 git 上嵌入 XKCD 条带的图像，但这是我留给结论的。[链接](https://xkcd.com/1597/)