<html>
<head>
<title>How to create Tweet Automation with Google Apps Script from Google Sheet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何从 Google Sheet 使用 Google Apps 脚本创建 Tweet 自动化</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-create-tweet-automation-with-google-apps-script-from-google-sheet-a25b2f09ab1b?source=collection_archive---------3-----------------------#2022-08-23">https://blog.devgenius.io/how-to-create-tweet-automation-with-google-apps-script-from-google-sheet-a25b2f09ab1b?source=collection_archive---------3-----------------------#2022-08-23</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><figure class="im in gp gr io ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/749c740af5d077f6435935f923182eb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9L36R1D7vk74GkND"/></div></div><figcaption class="iw ix gj gh gi iy iz bd b be z dk translated">Souvik Banerjee 在<a class="ae ja" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><div class=""/><p id="709f" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">你在 twitter 上关注了一些很酷的创造者或开发者，他们有很多追随者。你希望跟随他们的道路，也成为一个创造者。你必须做的最重要的事情之一是不断为你的追随者和未来的追随者制作内容，让他们认为你的账户值得关注。</p><p id="213a" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">然后，你会发现一天到晚都发微博并不容易，可能有一天你会因为太忙或者懒得开账户。所以你会想，你关注的人是如何整天不停地发帖的？。</p><p id="6416" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">答案是自动化</p><p id="4ab7" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">他们中的大多数人通过转发旧的推文或准备模板来自动化他们的推文，推文将根据他们设置的时间自动创建。有很多 Twitter 自动化软件。我个人最初使用<a class="ae ja" href="https://zapier.com/" rel="noopener ugc nofollow" target="_blank"> Zapier </a>来自动化我的每日推特，直到我的免费账户被停止。但是我相信您可以找到提供相同服务的其他工具</p><p id="e925" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">但是，嘿，你是程序员，你可以写代码做到这一点，对不对？</p><p id="07af" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">嗯，这正是我所做的，在这篇文章中，我将分享我如何使用 Google Apps 脚本和 Google Sheet 编写 tweet automation。我创建了模板 tweet 和 thread，脚本将根据我放在 Google Sheet 中的模板自动创建 tweet 或 thread</p><p id="2f27" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们将一步一步地介绍如何做这件事。只要遵循这个教程，你就可以节省 100 多个小时的研究时间</p><h1 id="0577" class="ky kz jd bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">创建 Twitter 开发者账户</h1><p id="3ecf" class="pw-post-body-paragraph ka kb jd kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">第一步是创建 twitter 开发者账户。为了做到这一点，你需要去 https://developer.twitter.com 的 Twitter 开发者门户网站注册并访问 Twitter API。</p><figure class="mc md me mf gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi mb"><img src="../Images/936915778d3fca70faa51bc2fadf15cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q9ZZU8Fj2M4iCBV9fu1EvA.png"/></div></div></figure><p id="f7bf" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">填写所有信息注册后，您可以进入门户<a class="ae ja" href="https://developer.twitter.com/en/portal/dashboard" rel="noopener ugc nofollow" target="_blank">仪表板</a>开始创建新项目</p><h1 id="8f72" class="ky kz jd bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">创建新的 Twitter 项目</h1><p id="b76a" class="pw-post-body-paragraph ka kb jd kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">Twitter 根据项目和应用程序管理 API 访问。一般来说，项目允许你根据你打算如何使用 Twitter API 来组织你的工作，这样你就可以有效地管理你对 API 的访问并监控你的使用。根据您的访问级别，每个项目可以包含一个或多个应用程序</p><p id="2bb8" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在本教程中，我们将创建一个名为 Automation 的新项目，步骤如下</p><ol class=""><li id="f16c" class="mg mh jd kc b kd ke kh ki kl mi kp mj kt mk kx ml mm mn mo bi translated">单击创建项目</li></ol><figure class="mc md me mf gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi mb"><img src="../Images/10a2d4ade7154ca0119e1f6b70d62c5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sfAjaphHl2IoyLrExs5QzA.png"/></div></div></figure><p id="3d4c" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">2.命名你的项目，任何名字都可以。单击下一步</p><figure class="mc md me mf gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi mb"><img src="../Images/9337ad006be7aa51ebc5bdb68ec12ec0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iyAr1EavUW19jcL07dy08w.png"/></div></div></figure><p id="af24" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">3.选择用例，任何用例都可以。单击下一步</p><figure class="mc md me mf gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi mb"><img src="../Images/4e48344f00e1215120dcb593e5157601.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lcBorBtkV1o5IEuxDsEhZQ.png"/></div></div></figure><p id="7507" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">4.描述项目。单击下一步</p><figure class="mc md me mf gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi mb"><img src="../Images/ad7e9ddb5eb536c0d1c18dd905045f3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Po4Bp8rP-lt3bjVjq2wKhg.png"/></div></div></figure><p id="3857" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">5.设置应用程序名称。单击下一步</p><figure class="mc md me mf gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi mb"><img src="../Images/3006436723adb9dd9240718cacb02974.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TNgluJALnqdR-2RmZXeAug.png"/></div></div></figure><p id="6791" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">6.在密钥和令牌中，将 API 密钥和令牌复制到您的本地计算机。请注意，我们不会在此页面中使用密钥和令牌，因为它们是用于 OAuth1 的，我们稍后将为 OAuth2 生成新的密钥和令牌。</p><figure class="mc md me mf gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi mb"><img src="../Images/f571c5bd60307e880d5c349642fc09fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*no11kyqUGIbWTzho5yfByw.png"/></div></div></figure><p id="8058" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">完成所有这些信息后，如果您单击应用程序设置，您将看到此页面</p><figure class="mc md me mf gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi mb"><img src="../Images/44ac06f4d9c58cc6207b7a00d42a8d9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y4h3fOmG6uev50hGLL_9JA.png"/></div></div></figure><p id="d3bd" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们将在这里停止，但我们将在页面的后面再次回来。</p><h1 id="f5c2" class="ky kz jd bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">创建一个 Google 表单</h1><p id="0432" class="pw-post-body-paragraph ka kb jd kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">创建任何谷歌表。我们将在每一行中组织推文，对于每一行，我们可以有多个推文，稍后可以创建为 twitter 线程。参见下面的例子</p><figure class="mc md me mf gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi mb"><img src="../Images/3b526369b234895aa6ce811c11e82bf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*igKx7tuaPCBZ4D6XFIRFig.png"/></div></div></figure><p id="d4f2" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如您所见，在第一行中，我们只有一个 tweet 模板，即单元格 A1 中的“First Tweet”。该脚本稍后将从该模板中发出一条 tweet。第二行包含单元格 A2 和 B2 中的两条 tweets。这两个 tweet 模板将被创建为 Twitter 线程，用户可以点击“更多”按钮查看更多回复。这将有助于提高你的参与度。</p><p id="3502" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这个想法是，脚本将在特定的时间内循环遍历每一行，并发送该行中的所有模板。例如，您希望每 8 小时创建一条推文，那么第一个小时它将推文第一行，接下来的 8 小时它将推文第二行。如果当前行不包含 tweet，那么脚本将简单地重置计数器并返回到第一行</p><p id="b4cf" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">有了这个，一旦脚本运行，你所要做的就是在谷歌表单中添加更多的模板，脚本会处理剩下的事情</p><h1 id="c678" class="ky kz jd bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">创建 Google 企业应用套件脚本</h1><p id="4370" class="pw-post-body-paragraph ka kb jd kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">在 google 工作表中，通过点击菜单<strong class="kc je">扩展→应用脚本</strong>创建应用脚本。一个新的页面将显示如下</p><figure class="mc md me mf gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi mb"><img src="../Images/f501e2cd2c3652bfa8bc8120c9f033d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2mFbXYn7qNo6Kd2_qCY1nQ.png"/></div></div></figure><p id="7d1b" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">您可以用任何名称来命名项目。我暂时将我的命名为<strong class="kc je"> Twitter 自动化</strong>。这是我们编写代码的地方。</p><p id="ca5a" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">每个 Google Apps 脚本都包含 id 作为脚本或项目的标识。下一步我们将需要我们的应用程序脚本的 ID，所以让我们现在就获取它。</p><p id="12dc" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在“应用程序脚本”页面中，转到项目设置(左侧的齿轮图标)。下面的一页将显示出来，你可以看到你的脚本像我一样的 ID。</p><figure class="mc md me mf gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi mb"><img src="../Images/3222dc998228a4f50ef2c5bc2f3078a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JDW5OqKxxyGX94v7pq5BhQ.png"/></div></div></figure><h1 id="53f2" class="ky kz jd bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">设置 Twitter OAuth2 流</h1><p id="e68f" class="pw-post-body-paragraph ka kb jd kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">我们几乎已经准备好编写代码了。但在此之前，我们需要在我们的 twitter 应用程序中设置 OAuth2。返回 Twitter 开发者门户，进入你的应用设置</p><figure class="mc md me mf gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi mb"><img src="../Images/fa21a6f33593fde88c8cc135afa8c3fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QtZ0AbKZ_l1gJeds3FRFaA.png"/></div></div></figure><figure class="mc md me mf gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi mb"><img src="../Images/95273d865d4e9c982314114539108e4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MIMc7ZtJTATgB5PmhJrVkg.png"/></div></div></figure><p id="58bf" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果您向下滚动一点，您将看到用户身份验证设置部分。点击<strong class="kc je">设置</strong>按钮，会出现一个页面，你需要在这里输入一些信息</p><figure class="mc md me mf gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi mb"><img src="../Images/95273d865d4e9c982314114539108e4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MIMc7ZtJTATgB5PmhJrVkg.png"/></div></div></figure><p id="ba23" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们需要在该页面中输入三个重要信息，</p><p id="6cb9" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">(1)第一种是<strong class="kc je">类型的 App </strong>，只需选择<strong class="kc je">原生 App </strong>或<strong class="kc je"> Web App、自动化 App 或 Bot </strong>。我们可以选择第二个，因为它更适合我们的脚本。</p><p id="dd31" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">(2)第二个是<strong class="kc je">回调 URI </strong>，它是 twitter 帐户(将是我们自己的个人帐户)在权限授予过程后将被重定向的 URI。这是您在上一节中使用的 Google 企业应用套件脚本 ID。我们将要进入的 URI 在下面</p><p id="e870" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><a class="ae ja" href="https://script.google.com/macros/s/YOUR_SCRIPT_ID/usercallback" rel="noopener ugc nofollow" target="_blank">https://SCRIPT . Google . com/macros/d/YOUR _ SCRIPT _ ID/user callback</a>。</p><p id="65b9" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">您可以用脚本的 ID 替换 YOUR_SCRIPT_ID</p><p id="8990" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">(3)第三个是<strong class="kc je">网址</strong>，只是 App 的任意一个网站。可以给你个人网址。</p><p id="2979" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">一旦您提交了这三个信息，您可以按下一步按钮，下面页面将显示给您，包含两个信息，客户端 ID 和客户端密码。这两个秘密信息是你的脚本所需要的，你可以安全地把它保存在你的应用程序脚本中。现在，只需将它们都复制到您的本地计算机中。</p><figure class="mc md me mf gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi mb"><img src="../Images/5bab01a5633ee8be95fb646aba8e1370.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yEXjLSYfCgB2LQA-22Mujg.png"/></div></div></figure><h1 id="796e" class="ky kz jd bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">在应用程序脚本中安装 OAuth2 库</h1><p id="630a" class="pw-post-body-paragraph ka kb jd kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">现在我们已经准备好编写代码，但在此之前，我们将在我们的应用程序脚本中安装一个<a class="ae ja" href="https://github.com/googleworkspace/apps-script-oauth2" rel="noopener ugc nofollow" target="_blank"> OAuth2 </a>库。第一次在应用程序脚本中安装库有点棘手。但是您需要获得库的脚本 ID。之后，在应用程序脚本编辑器中按下<strong class="kc je">库</strong>按钮，粘贴库的 ID，按下<strong class="kc je">查找</strong>并点击<strong class="kc je">添加</strong>。对于 OAuth2 库，脚本 ID 是<code class="fe mp mq mr ms b">1B7FSrk5Zi6L1rSxxTDgDEUsPzlukDsi4KGuTMorsTQHhGBzBkMun4iDF</code></p><figure class="mc md me mf gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi mb"><img src="../Images/c901044753e1123fe40da3c79c4cda29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VY7R1xi03QAiFLQrvV-Zcg.png"/></div></div></figure><p id="c185" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果库添加成功，您将在库部分看到 OAuth2</p><figure class="mc md me mf gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi mb"><img src="../Images/f28237f0630b1addab98ec1305acc8d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3rZ4Wfkt7tPGlJ0QMulNjg.png"/></div></div></figure><h1 id="47b8" class="ky kz jd bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">开始写代码</h1><p id="e20b" class="pw-post-body-paragraph ka kb jd kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">我们需要创建三个主要函数</p><ol class=""><li id="f73a" class="mg mh jd kc b kd ke kh ki kl mi kp mj kt mk kx ml mm mn mo bi translated">函数从工作表中获取 tweet 模板</li><li id="6991" class="mg mh jd kc b kd mt kh mu kl mv kp mw kt mx kx ml mm mn mo bi translated">函数来创建 OAuth2 服务</li><li id="e37c" class="mg mh jd kc b kd mt kh mu kl mv kp mw kt mx kx ml mm mn mo bi translated">函数将推文发送到 Twitter 帐户</li></ol><p id="9754" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">还需要添加其他必要的函数，我们将在下面的小节中详细介绍它们，以帮助您理解代码的每个部分</p><h2 id="f329" class="my kz jd bd la mz na dn le nb nc dp li kl nd ne lm kp nf ng lq kt nh ni lu nj bi translated">从 Google Sheet 获取 Tweet 模板</h2><p id="68ca" class="pw-post-body-paragraph ka kb jd kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">下面是从 google sheet 获取 tweet 模板的代码</p><pre class="mc md me mf gt nk ms nl nm aw nn bi"><span id="bcbc" class="my kz jd ms b gy no np l nq nr">/**<br/> * Fetch the tweet from the google sheet<br/> * <a class="ae ja" href="http://twitter.com/param" rel="noopener ugc nofollow" target="_blank">@param</a> row row of the sheet, start from 1<br/> * <a class="ae ja" href="http://twitter.com/param" rel="noopener ugc nofollow" target="_blank">@param</a> col column of the sheet, start from 1<br/> * <a class="ae ja" href="http://twitter.com/return" rel="noopener ugc nofollow" target="_blank">@return</a> text of the tweet<br/> */<br/>function fetchTweet(row,col){<br/>  const sheets = SpreadsheetApp.getActiveSpreadsheet().getSheets();<br/>  const tweetSheet = sheets.find((sheet)=&gt;sheet.getName() == 'Sheet1');<br/>  return tweetSheet.getRange(row,col).getValue().toString();<br/>}</span></pre><h2 id="6e6e" class="my kz jd bd la mz na dn le nb nc dp li kl nd ne lm kp nf ng lq kt nh ni lu nj bi translated">OAuth2 服务</h2><p id="50cf" class="pw-post-body-paragraph ka kb jd kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">下一部分是创建 OAuth 服务的代码。</p><pre class="mc md me mf gt nk ms nl nm aw nn bi"><span id="e0f4" class="my kz jd ms b gy no np l nq nr">/**<br/> * Create the OAuth2 Twitter Service<br/> * <a class="ae ja" href="http://twitter.com/return" rel="noopener ugc nofollow" target="_blank">@return</a> OAuth2 service<br/> */<br/>function getService(){<br/>  var userProps = PropertiesService.getUserProperties();<br/>  pkceChallengeVerifier();<br/>  return OAuth2.createService('twitter')<br/>        .setAuthorizationBaseUrl('<a class="ae ja" href="https://twitter.com/i/oauth2/authorize'" rel="noopener ugc nofollow" target="_blank">https://twitter.com/i/oauth2/authorize'</a>)<br/>        .setTokenUrl('<a class="ae ja" href="https://api.twitter.com/2/oauth2/token?code_verifier='" rel="noopener ugc nofollow" target="_blank">https://api.twitter.com/2/oauth2/token?code_verifier='</a> + userProps.getProperty("code_verifier"))</span><span id="2f39" class="my kz jd ms b gy ns np l nq nr">// Set the client ID and secret.<br/>        .setClientId(CLIENT_ID)<br/>        .setClientSecret(CLIENT_SECRET)<br/>        .setCallbackFunction('authCallback')</span><span id="6589" class="my kz jd ms b gy ns np l nq nr">// Set the property store where authorized tokens should be persisted.<br/>        .setPropertyStore(userProps)<br/>        // Set the scopes to request (space-separated for Twitter services).<br/>        .setScope('users.read tweet.read offline.access tweet.write')<br/>  <br/>        // Add parameters in the authorization url<br/>        .setParam('response_type', 'code')<br/>        .setParam('code_challenge_method', 'S256')<br/>        .setParam('code_challenge', userProps.getProperty("code_challenge"))</span><span id="1d71" class="my kz jd ms b gy ns np l nq nr">.setTokenHeaders({<br/>          'Authorization': 'Basic ' + Utilities.base64Encode(CLIENT_ID + ':' + CLIENT_SECRET),<br/>          'Content-Type': 'application/x-www-form-urlencoded'<br/>        })<br/>}</span></pre><p id="cfd1" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><code class="fe mp mq mr ms b">getService()</code>函数需要两个函数，它们是<code class="fe mp mq mr ms b">pkceChallengerVerifier()</code>来为脚本访问 twitter 账户的许可生成挑战和验证，以及<code class="fe mp mq mr ms b">authCallback()</code>作为当一个账户授权访问我们的脚本时从 twitter 的回调。<code class="fe mp mq mr ms b">getService()</code>还需要两个常量<code class="fe mp mq mr ms b">CLIENT_ID</code>和<code class="fe mp mq mr ms b">CLIENT_SECRET</code>，这是我们从上一节的 Twitter 应用设置中获得的两个信息。</p><p id="3b58" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">另一个重要部分是 OAuth2 的范围。<a class="ae ja" href="https://developer.twitter.com/en/docs/twitter-api/tweets/manage-tweets/api-reference/post-tweets" rel="noopener ugc nofollow" target="_blank">为了用 twitter 账户</a>发送 tweet，我们需要用<code class="fe mp mq mr ms b">user.read tweet.read tweet.write</code>设置 OAuth2 的作用域。如果你注意到，我还添加了<code class="fe mp mq mr ms b">offline.access</code>，这个范围是必需的，这样我们只需要做一次访问授权过程。</p><p id="c111" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这里有<code class="fe mp mq mr ms b">pkceChallengerVerifier()</code>的内容</p><pre class="mc md me mf gt nk ms nl nm aw nn bi"><span id="1aca" class="my kz jd ms b gy no np l nq nr">/**<br/> * Generate PKCE Challenge Verifier for Permission for OAuth2 Twitter Service<br/> */<br/>function pkceChallengeVerifier(){<br/>  var userProps = PropertiesService.getUserProperties();<br/>  if(!userProps.getProperty('code_verifier')){<br/>    var verifier = "";<br/>    var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~";<br/>    for(var i =0;i&lt;128 ;i++){<br/>      verifier += possible.charAt(Math.floor(Math.random() * possible.length));<br/>    }</span><span id="4544" class="my kz jd ms b gy ns np l nq nr">var sha256hash = Utilities.computeDigest(Utilities.DigestAlgorithm.SHA_256, verifier);</span><span id="9b8c" class="my kz jd ms b gy ns np l nq nr">var challenge = Utilities.base64Encode(sha256hash)<br/>      .replace(/\+/g, '-')<br/>      .replace(/\//g, '_')<br/>      .replace(/=+$/, '')</span><span id="d8b4" class="my kz jd ms b gy ns np l nq nr">userProps.setProperty("code_verifier", verifier)<br/>    userProps.setProperty("code_challenge", challenge)<br/>  }<br/>}</span></pre><p id="88a3" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">以下是<code class="fe mp mq mr ms b">authCallback()</code>的内容</p><pre class="mc md me mf gt nk ms nl nm aw nn bi"><span id="c2b2" class="my kz jd ms b gy no np l nq nr">/**<br/> * Handles the OAuth callback.<br/> */<br/>function authCallback(request) {<br/>  var service = getService();<br/>  var authorized = service.handleCallback(request);<br/>  if (authorized) {<br/>    return HtmlService.createHtmlOutput('Success!');<br/>  } else {<br/>    return HtmlService.createHtmlOutput('Denied');<br/>  }<br/>}</span></pre><p id="97ff" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果您想更改服务范围，附加功能<code class="fe mp mq mr ms b">reset()</code>也很重要。在请求新的作用域之前，您需要重置服务</p><pre class="mc md me mf gt nk ms nl nm aw nn bi"><span id="8515" class="my kz jd ms b gy no np l nq nr">/**<br/> * Reset the OAuth2 Twitter Service<br/> */<br/>function reset() {<br/>  getService().reset();<br/>PropertiesService.getUserProperties().deleteProperty("code_challenge");<br/>PropertiesService.getUserProperties().deleteProperty("code_verifier");<br/>}</span></pre><h2 id="c67f" class="my kz jd bd la mz na dn le nb nc dp li kl nd ne lm kp nf ng lq kt nh ni lu nj bi translated">将 tweet 模板发送到 twitter API</h2><p id="c5d2" class="pw-post-body-paragraph ka kb jd kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">这里是<code class="fe mp mq mr ms b">sendTweet</code>的功能</p><pre class="mc md me mf gt nk ms nl nm aw nn bi"><span id="8d29" class="my kz jd ms b gy no np l nq nr">/**<br/> * Send the Tweet<br/> * <a class="ae ja" href="http://twitter.com/Param" rel="noopener ugc nofollow" target="_blank">@Param</a> tweet Text to tweet<br/> * <a class="ae ja" href="http://twitter.com/Param" rel="noopener ugc nofollow" target="_blank">@Param</a> replyTo id of the tweet to reply<br/> * <a class="ae ja" href="http://twitter.com/return" rel="noopener ugc nofollow" target="_blank">@return</a> the ID of the current Tweet<br/> */<br/>function sendTweet(tweet,replyTo){<br/>  var payload = {<br/>    text:tweet<br/>  }</span><span id="9833" class="my kz jd ms b gy ns np l nq nr">if(replyTo){<br/>    payload['reply'] = {<br/>      in_reply_to_tweet_id:replyTo<br/>    }<br/>  }<br/>  var service = getService();<br/>   if (service.hasAccess()) {<br/>    var url = `<a class="ae ja" href="https://api.twitter.com/2/tweets`" rel="noopener ugc nofollow" target="_blank">https://api.twitter.com/2/tweets`</a>;<br/>    var response = UrlFetchApp.fetch(url, {<br/>      method:'POST',<br/>      'contentType': 'application/json',<br/>      headers: {<br/>        Authorization: 'Bearer ' + service.getAccessToken()<br/>      },<br/>      muteHttpExceptions: true,<br/>      payload: JSON.stringify(payload)<br/>    });<br/>    var result = JSON.parse(response.getContentText());<br/>    return result.data.id;<br/>  } else {<br/>    var authorizationUrl = service.getAuthorizationUrl();<br/>    Logger.log('Open the following URL and re-run the script: %s',<br/>      authorizationUrl);<br/>  }<br/>}</span></pre><p id="24c3" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">该函数将向<a class="ae ja" href="https://developer.twitter.com/en/docs/twitter-api/tweets/manage-tweets/api-reference/post-tweets" rel="noopener ugc nofollow" target="_blank"> Twitter API 库</a>发送 HTTP POST 请求，以便将 tweet 发布到 Twitter 帐户。它将首先检查服务是否有访问权，如果没有访问权，它将打印授权 URL。</p><h2 id="9139" class="my kz jd bd la mz na dn le nb nc dp li kl nd ne lm kp nf ng lq kt nh ni lu nj bi translated">主要功能</h2><p id="4c90" class="pw-post-body-paragraph ka kb jd kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">准备好所有主要功能后，我们可以创建管理自动化逻辑的主要功能。这个想法是有一个全局计数器，每次脚本发布 tweet 时都会遍历 row，并在下一轮增加计数器。下面是主要功能</p><pre class="mc md me mf gt nk ms nl nm aw nn bi"><span id="bfa3" class="my kz jd ms b gy no np l nq nr">/**<br/> * Entry point to send the tweet<br/> */<br/>function dailyTweet(){<br/>  //get the counter, which is to be row<br/>  var counter = PropertiesService.getUserProperties().getProperty('counter')<br/>  if(!counter) {<br/>    counter = 1<br/>  }<br/>  else{<br/>    //parse to Integer because it's stored as string<br/>    counter = parseInt(counter)<br/>  }</span><span id="743d" class="my kz jd ms b gy ns np l nq nr">var row = counter;<br/>  var col = 1;</span><span id="edaf" class="my kz jd ms b gy ns np l nq nr">//get the first tweet<br/>  var tweet = fetchTweet(row,col);<br/>  var replyTo = undefined<br/>  //loop while tweet is available, it could be thread<br/>  while(tweet != ""){<br/>    replyTo = sendTweet(tweet,replyTo);<br/>    Logger.log(`tweet '${tweet} has been send with ID ${replyTo}'`);<br/>    tweet = fetchTweet(row,++col);<br/>  }</span><span id="7fae" class="my kz jd ms b gy ns np l nq nr">if(!replyTo &amp;&amp; tweet == ""){<br/>    //meaning no tweet, reset the counter<br/>    counter = 0;<br/>    Logger.log("No tweet, counter is reset");<br/>  }<br/>  //increament the counter and save it<br/>  counter ++;<br/>  PropertiesService.getUserProperties().setProperty('counter',counter);<br/>  <br/>}</span></pre><h2 id="3c59" class="my kz jd bd la mz na dn le nb nc dp li kl nd ne lm kp nf ng lq kt nh ni lu nj bi translated">完整的代码</h2><pre class="mc md me mf gt nk ms nl nm aw nn bi"><span id="e9ea" class="my kz jd ms b gy no np l nq nr">const CLIENT_ID = ''<br/>const CLIENT_SECRET = ''</span><span id="0a1f" class="my kz jd ms b gy ns np l nq nr">/**<br/> * Create the OAuth2 Twitter Service<br/> * <a class="ae ja" href="http://twitter.com/return" rel="noopener ugc nofollow" target="_blank">@return</a> OAuth2 service<br/> */<br/>function getService(){<br/>  var userProps = PropertiesService.getUserProperties();<br/>  pkceChallengeVerifier();<br/>  return OAuth2.createService('twitter')<br/>        .setAuthorizationBaseUrl('<a class="ae ja" href="https://twitter.com/i/oauth2/authorize'" rel="noopener ugc nofollow" target="_blank">https://twitter.com/i/oauth2/authorize'</a>)<br/>        .setTokenUrl('<a class="ae ja" href="https://api.twitter.com/2/oauth2/token?code_verifier='" rel="noopener ugc nofollow" target="_blank">https://api.twitter.com/2/oauth2/token?code_verifier='</a> + userProps.getProperty("code_verifier"))</span><span id="17ca" class="my kz jd ms b gy ns np l nq nr">// Set the client ID and secret.<br/>        .setClientId(CLIENT_ID)<br/>        .setClientSecret(CLIENT_SECRET)<br/>        .setCallbackFunction('authCallback')</span><span id="df30" class="my kz jd ms b gy ns np l nq nr">// Set the property store where authorized tokens should be persisted.<br/>        .setPropertyStore(userProps)<br/>        // Set the scopes to request (space-separated for Twitter services).<br/>        .setScope('users.read tweet.read offline.access tweet.write')<br/>  <br/>        // Add parameters in the authorization url<br/>        .setParam('response_type', 'code')<br/>        .setParam('code_challenge_method', 'S256')<br/>        .setParam('code_challenge', userProps.getProperty("code_challenge"))</span><span id="d8ef" class="my kz jd ms b gy ns np l nq nr">.setTokenHeaders({<br/>          'Authorization': 'Basic ' + Utilities.base64Encode(CLIENT_ID + ':' + CLIENT_SECRET),<br/>          'Content-Type': 'application/x-www-form-urlencoded'<br/>        })<br/>}<br/>/**<br/> * Reset the OAuth2 Twitter Service<br/> */<br/>function reset() {<br/>  getService().reset();<br/>  PropertiesService.getUserProperties().deleteProperty("code_challenge");<br/>  PropertiesService.getUserProperties().deleteProperty("code_verifier");<br/>}</span><span id="92d8" class="my kz jd ms b gy ns np l nq nr">/**<br/> * Generate PKCE Challenge Verifier for Permission for OAuth2 Twitter Service<br/> */<br/>function pkceChallengeVerifier(){<br/>  var userProps = PropertiesService.getUserProperties();<br/>  if(!userProps.getProperty('code_verifier')){<br/>    var verifier = "";<br/>    var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~";<br/>    for(var i =0;i&lt;128 ;i++){<br/>      verifier += possible.charAt(Math.floor(Math.random() * possible.length));<br/>    }</span><span id="621a" class="my kz jd ms b gy ns np l nq nr">var sha256hash = Utilities.computeDigest(Utilities.DigestAlgorithm.SHA_256, verifier);</span><span id="a31e" class="my kz jd ms b gy ns np l nq nr">var challenge = Utilities.base64Encode(sha256hash)<br/>      .replace(/\+/g, '-')<br/>      .replace(/\//g, '_')<br/>      .replace(/=+$/, '')</span><span id="ebb6" class="my kz jd ms b gy ns np l nq nr">userProps.setProperty("code_verifier", verifier)<br/>    userProps.setProperty("code_challenge", challenge)<br/>  }<br/>}<br/>/**<br/> * Handles the OAuth callback.<br/> */<br/>function authCallback(request) {<br/>  var service = getService();<br/>  var authorized = service.handleCallback(request);<br/>  if (authorized) {<br/>    return HtmlService.createHtmlOutput('Success!');<br/>  } else {<br/>    return HtmlService.createHtmlOutput('Denied');<br/>  }<br/>}</span><span id="8c0b" class="my kz jd ms b gy ns np l nq nr">/**<br/> * Send the Tweet<br/> * <a class="ae ja" href="http://twitter.com/Param" rel="noopener ugc nofollow" target="_blank">@Param</a> tweet Text to tweet<br/> * <a class="ae ja" href="http://twitter.com/Param" rel="noopener ugc nofollow" target="_blank">@Param</a> replyTo id of the tweet to reply<br/> * <a class="ae ja" href="http://twitter.com/return" rel="noopener ugc nofollow" target="_blank">@return</a> the ID of the current Tweet<br/> */<br/>function sendTweet(tweet,replyTo){<br/>  var payload = {<br/>    text:tweet<br/>  }</span><span id="2c71" class="my kz jd ms b gy ns np l nq nr">if(replyTo){<br/>    payload['reply'] = {<br/>      in_reply_to_tweet_id:replyTo<br/>    }<br/>  }</span><span id="fc68" class="my kz jd ms b gy ns np l nq nr">var service = getService();<br/>   if (service.hasAccess()) {<br/>    // <a class="ae ja" href="https://developer.twitter.com/en/docs/twitter-api/users/lookup/api-reference/get-users-by-username-username" rel="noopener ugc nofollow" target="_blank">https://developer.twitter.com/en/docs/twitter-api/users/lookup/api-reference/get-users-by-username-username</a><br/>    var url = `<a class="ae ja" href="https://api.twitter.com/2/tweets`" rel="noopener ugc nofollow" target="_blank">https://api.twitter.com/2/tweets`</a>;<br/>    var response = UrlFetchApp.fetch(url, {<br/>      method:'POST',<br/>      'contentType': 'application/json',<br/>      headers: {<br/>        Authorization: 'Bearer ' + service.getAccessToken()<br/>      },<br/>      muteHttpExceptions: true,<br/>      payload: JSON.stringify(payload)<br/>    });<br/>    var result = JSON.parse(response.getContentText());<br/>    return result.data.id;<br/>  } else {<br/>    var authorizationUrl = service.getAuthorizationUrl();<br/>    Logger.log('Open the following URL and re-run the script: %s',<br/>      authorizationUrl);<br/>  }<br/>}</span><span id="1477" class="my kz jd ms b gy ns np l nq nr">/**<br/> * Entry point to send the tweet<br/> */<br/>function dailyTweet(){<br/>  //get the counter, which is to be row<br/>  var counter = PropertiesService.getUserProperties().getProperty('counter')<br/>  if(!counter) {<br/>    counter = 1<br/>  }<br/>  else{<br/>    //parse to Integer because it's stored as string<br/>    counter = parseInt(counter)<br/>  }</span><span id="9039" class="my kz jd ms b gy ns np l nq nr">var row = counter;<br/>  var col = 1;</span><span id="4084" class="my kz jd ms b gy ns np l nq nr">//get the first tweet<br/>  var tweet = fetchTweet(row,col);<br/>  var replyTo = undefined<br/>  //loop while tweet is available, it could be thread<br/>  while(tweet != ""){<br/>    replyTo = sendTweet(tweet,replyTo);<br/>    Logger.log(`tweet '${tweet} has been send with ID ${replyTo}'`);<br/>    tweet = fetchTweet(row,++col);<br/>  }</span><span id="6246" class="my kz jd ms b gy ns np l nq nr">if(!replyTo &amp;&amp; tweet == ""){<br/>    //meaning no tweet, reset the counter<br/>    counter = 0;<br/>    Logger.log("No tweet, counter is reset");<br/>  }<br/>  //increament the counter and save it<br/>  counter ++;<br/>  PropertiesService.getUserProperties().setProperty('counter',counter);<br/>  <br/>}</span><span id="84b6" class="my kz jd ms b gy ns np l nq nr">/**<br/> * Fetch the tweet from the google sheet<br/> * <a class="ae ja" href="http://twitter.com/param" rel="noopener ugc nofollow" target="_blank">@param</a> row row of the sheet, start from 1<br/> * <a class="ae ja" href="http://twitter.com/param" rel="noopener ugc nofollow" target="_blank">@param</a> col column of the sheet, start from 1<br/> * <a class="ae ja" href="http://twitter.com/return" rel="noopener ugc nofollow" target="_blank">@return</a> text of the tweet<br/> */<br/>function fetchTweet(row,col){<br/>  const sheets = SpreadsheetApp.getActiveSpreadsheet().getSheets();<br/>  const tweetSheet = sheets.find((sheet)=&gt;sheet.getName() == 'tweet');<br/>  return tweetSheet.getRange(row,col).getValue().toString();<br/>}</span></pre><h1 id="f0c8" class="ky kz jd bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">测试脚本</h1><p id="1807" class="pw-post-body-paragraph ka kb jd kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">重要的是要确保我们的脚本是真的工作。一旦你写完了所有的代码，你就可以保存这个项目了。通过保存项目，在编辑器的工具栏中有一个功能列表，以及<strong class="kc je">运行</strong>按钮。尝试运行<code class="fe mp mq mr ms b">dailyTweet()</code>,看看推文是否真的在你的账户中发布</p><p id="ab5c" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">从脚本到您的 google 帐户可能会有几个访问请求来访问 google sheet，您只需授予权限，这样您的脚本就可以完美运行</p><h1 id="530c" class="ky kz jd bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">创建触发器</h1><p id="7a0c" class="pw-post-body-paragraph ka kb jd kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">一旦我们验证了<code class="fe mp mq mr ms b">dailyTweet()</code>正在工作，现在是时候决定什么时候触发这个功能了。我们可以使用 Apps 脚本的触发特性。到左侧点击<strong class="kc je">触发</strong>菜单</p><figure class="mc md me mf gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi mb"><img src="../Images/ca1bff24d5401e73510104465f00fdce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WqDkpQucGh6dRXVZn9CanQ.png"/></div></div></figure><p id="12b8" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">点击左下方的<strong class="kc je">添加触发器</strong>，会弹出对话框选择如何触发<code class="fe mp mq mr ms b">dailyTweet</code>功能。你应该在选择事件源中选择时间驱动，剩下的就看你自己决定了。</p><figure class="mc md me mf gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi mb"><img src="../Images/e4967bd05be3f3efa42e60f9e1b36a24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iQujxXQfgBrNBOQbFJFZyA.png"/></div></div></figure><h1 id="607d" class="ky kz jd bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">结论</h1><p id="099d" class="pw-post-body-paragraph ka kb jd kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">制作自动化的推特脚本是提升你的推特账户的一种方式。既然您已经运行了脚本，那么您可以随时向 Google Sheet 添加任何模板，并让脚本完成剩下的工作。</p><p id="4c3c" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果你有任何问题，或者你认为这篇文章还有更多需要补充的，请在评论区告诉我</p><p id="9f59" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">别忘了在 twitter @asyarif 上关注我</p></div></div>    
</body>
</html>