# 如何优雅地处理应用程序中的错误

> 原文：<https://blog.devgenius.io/how-to-handle-errors-gracefully-in-our-apps-31fbfd3f68c5?source=collection_archive---------36----------------------->

![](img/cf1b8f2c6d7d108454edd48230b470f8.png)

约翰·西门子在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

在我们的应用程序中优雅地处理错误，确保故障会很快被注意到，这样用户或开发人员就可以修复出现的问题。

在本文中，我们将看看如何以一种优雅的方式处理错误，使修复它们变得更容易。

# 提前崩溃

我们的程序应该尽早崩溃，这样我们就可以尽早发现问题。

例如，我们不应该让程序继续向数据库写入无效数据，而是应该检查数据是否被写入并在写入之前抛出错误。

这样，用户可以正确地重新输入数据，然后将其保存到数据库中。

一旦它在数据库中，那么我们将不得不去数据库修复它，这是非常困难的。

如果很多人输入了无效数据，而我们却让他们保存这些数据，那么很可能无法快速修复，这对每个人来说都是一场噩梦。

在大多数语言中，我们可以抛出异常来抛出错误。那么我们马上就会发现这个错误。

# 断言编程

如果我们不允许发生的事情不能发生，我们应该使用断言。

例如，如果我们不允许某个东西被`null`，那么我们应该在程序或函数继续运行之前检查它。

这样，我们就不会让无效值在我们的系统中传播。

# 保持断言打开

断言不会增加代码的开销。此外，我们不应该假设断言仅仅是由代码中的错误触发的。

它也可以由用户错误触发。因此，我们应该在任何环境下都让它们开着。

因此，关闭它们不会为我们节省任何资源，但会给我们带来很多问题。

我们不应该有有副作用的断言。这样，我们就知道我们要检查的正是我们要检查的。

如果我们在运行断言时产生副作用，那么我们可能会做一些我们没有预料到的事情，并检查副作用，即使我们检查了它们，我们也会遇到问题。

# 何时使用异常

只要有可能，就应该使用异常。例如，`try...catch`块比使用`if`和`else`来检查不同函数返回的状态代码要干净得多。

如果这些函数抛出异常，而不是返回错误值，那么如果我们捕捉到它们，然后优雅地处理它们，就会使我们的代码更加整洁。

当运行的代码可能出现错误时，我们应该使用它们。例如，如果一个函数在检查文件是否存在时抛出一个异常，那么我们需要捕捉错误并处理它。

如果文件必须在那里，那么我们可以在它不在那里的时候捕捉异常。如果它是可选的，那么我们可以检查文件是否存在，如果存在就运行一些代码。

在任何地方抛出和捕捉异常的程序都会遇到可读性和可维护性问题，因为当抛出异常时，它们会从一个地方跳到另一个地方。

此外，封装被破坏了，因为它们通过处理异常更紧密地耦合在一起。

# 错误处理程序是一种替代方法

我们也可以编写错误处理函数来优雅地处理错误，而不是到处抛出和捕捉异常。

我们可以在任何语言中使用它们，因为它们只是常规函数。

他们可以在一个中心位置处理所有的错误。我们可以只写一个错误处理程序，并在任何地方使用它们。

![](img/002a9fab2c2ec557ebf688fb713aa204.png)

Jacob Mejicanos 在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片

# 清理资源

我们的程序应该在需要的时候自我清理。例如，如果我们的程序将临时文件写入文件系统，那么我们应该在程序完成时清理它们。

这也包括当错误发生时程序结束的情况。我们必须确保在这种情况下释放资源。

这样，在我们的程序运行多次后，我们就不会有很多未使用的临时文件。

然而，如果我们程序的顶层结构负责清理资源，那么我们应该让他们去做。

如果没有，那么我们的代码应该为他们做这件事。

# 结论

我们的程序应该优雅地处理错误，并在使用后清理资源。

此外，错误应该尽早显示出来，以便相关人员可以更快地采取行动。