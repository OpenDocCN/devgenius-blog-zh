# TDD 与调试

> 原文：<https://blog.devgenius.io/tdd-vs-debugging-85c8ab53bac8?source=collection_archive---------8----------------------->

调试就像重建一个犯罪。这并不是一件容易的事，它既困难又费时。总的来说，避免犯罪比找到凶手更好。

![](img/72c7f6311136d39f7ac40cd6805ee41c.png)

> 在[计算机编程](https://en.wikipedia.org/wiki/Computer_programming)和[软件开发](https://en.wikipedia.org/wiki/Software_development)、**调试**是在[计算机程序](https://en.wikipedia.org/wiki/Computer_program)、[软件](https://en.wikipedia.org/wiki/Software)或[系统](https://en.wikipedia.org/wiki/Software_system)中发现并解决[*bug*](https://en.wikipedia.org/wiki/Software_bug)(妨碍正确运行的缺陷或问题)的过程。
> [https://en.wikipedia.org/wiki/Debugging](https://en.wikipedia.org/wiki/Debugging)

调试是我们为了理解为什么软件没有以预期的行为响应而被动做的事情。这是一个手动过程，调试的唯一原因是了解发生了什么。
像任何手工流程一样，调试非常耗时，调试的理由有哪些？。

## 我们的代码不容易理解

我知道很多人认为没有人愿意阅读你的代码，但是至少当你在产品中修复一个 bug 的时候，你会对一个简单易懂的代码非常感兴趣。在这种情况下，时间显然就是金钱。按照我们对犯罪的理解，未被污染的犯罪现场和被污染的犯罪现场是不同的。如果你的代码一团糟，你的工作会变得更加困难。

## 缺乏知识

我们不知道事情是如何运作的，也没有人可以询问，或者没有好的文档可以使用。有时，虽然我们编写了代码，但我们是在几个月或几年前编写的，我们什么都不记得了。从你写代码到你发现错误的时间对于快速修复它是至关重要的。
有什么东西可以记录我们的代码，表达应该发生什么的意图吗？。事实上，是的，我们代码的最佳文档已经过测试。测试是动态的文档，如果行为改变，它也需要改变，它会用您的代码一次又一次地编译和执行。测试是我们的代码如何工作的例子，好的测试可以帮助我们更快地理解在每个描述的场景中应该发生什么。

## 没有人想到在这种情况下

由于软件需要对任何可能的场景做出响应，如果我们没有定义它，系统的响应将不会是我们想要的。不确定性是软件开发的一部分，我们必须接受我们不能猜测一切，正如我们接受我们不能猜测未来一样。经过足够的尝试，所有可能的场景都会在生产中检验我们的代码。他们中的大多数是我们所期望的，但其他人不是。这就是为什么快速投入生产以尽可能快的速度学习是如此重要的原因，生产是帮助理解整个问题的环境。

调试是我们无法避免的事情(因为我们无法避免不确定性)，总会有一些我们不了解的情况，需要手动一步一步地运行我们的代码来查看发生了什么。但是如果我们在开发过程中一直将调试作为一种常见的实践，我们就有一个大问题，这是一种耗时的实践，有很长的反馈循环。我们的交货时间可能很糟糕。

**我认为过多的调试是一种气味，这通常意味着团队中的工程实践很差。**
由于调试是一个漫长的反馈循环(就像任何*手册*质量实践一样)，我们试图避免它一次性批量处理我们所有的变更。其中的一些形式是使用长期存在的分支，并在该特性的所有开发完成后进行手工测试。当事情出错时，我们进行调试。

TDD 可以帮助你在编写的每一步中停止使用调试作为理解代码的方法。 [TDD](/how-do-i-write-tests-17640185171c?sk=ce13d0bcefc8fc6d34a97acadb4b308a) 基本上是(顺序问题):

*   想想你想达到什么目的。
*   写一个测试来解释你想要达到的目标。(红色阶段)
*   编写满足您编写的测试的最少代码。(绿色阶段)
*   重构您的代码。(绿色阶段)

TDD 是一种迭代方法，所以如果完成一个 TDD 周期的时间很短，它会给出更好的结果。在几分钟内完成整个周期有助于您处于这样一种情况，即任何错误都可以更快地解决，因为您在代码编写后几分钟就发现了它。
重构你的代码有助于你在开发新功能时保持代码的简单性，为下次你需要时编写一个可理解的代码。
TDD 生成测试，帮助你将来理解代码在做什么。

如果您在进行 TDD 时发现了一个 bug，并且如果您在代码处于绿色状态时频繁提交。您可以决定进行调试，但也可以决定放弃您的更改并从这一小步开始。当你已经持续了几天或几周来完成你的长期分支中的整个特性时，第二个(重新开始)选项被完全丢弃，但是如果你用 TDD 在几分钟内完成了那个小的改变，那么大多数时间在安全点(绿色状态，你的最后一次提交)重新开始会更快。
时间在软件中至关重要，小步骤，每次绿色时提交。这将帮助你更好地理解当你发现一个 bug 时该做什么。

## 用 TDD 解决生产中的 bug

如果你在产品中发现一个 bug，你通常会做 TDD。对您来说，创建一个复制发现 bug 的场景的测试将会很容易。
确保你写的测试在执行时是红色的，并修复错误。
您已经修复了 bug，同时编写了一个测试，证明该 bug 不会在您的系统中再次出现。

发展不仅仅是打字，打字很简单，发展也是在每种情况下一直解决正确的问题。
**TDD 永远比打字+测试+调试快。**