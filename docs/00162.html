<html>
<head>
<title>Processing 14 GB files with Rust — Part 2 — Docker &amp; Testing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Rust处理14 GB文件—第2部分— Docker和测试</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/processing-14-gb-files-with-rust-part-2-docker-testing-ad8fa2652cbd?source=collection_archive---------0-----------------------#2020-04-11">https://blog.devgenius.io/processing-14-gb-files-with-rust-part-2-docker-testing-ad8fa2652cbd?source=collection_archive---------0-----------------------#2020-04-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="502c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">周末编码和写作</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/c8f80bcb986cf52d4ae17bf56a10f14c.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*Tbm10ZMaQ21eh0rBMjhX7w.jpeg"/></div><figcaption class="kt ku gj gh gi kv kw bd b be z dk translated">周末咖啡馆和代码</figcaption></figure><blockquote class="kx"><p id="e735" class="ky kz iq bd la lb lc ld le lf lg kk dk translated">“对于我们在做之前必须学习的东西，我们通过做来学习。”——亚里士多德</p></blockquote><p id="8c8d" class="pw-post-body-paragraph jn jo iq jp b jq lh js jt ju li jw jx jy lj ka kb kc lk ke kf kg ll ki kj kk ij bi translated">边做边学。总是让我朝着新的编程语言/技能前进。在上一篇文章中，我们从背景——为什么，到代码——如何开始。没机会看的话可以看这里的文章。</p><div class="lm ln gp gr lo lp"><a href="https://medium.com/@jayhuang75/processing-14-gb-files-with-rust-part-1-3b7b1458fc37" rel="noopener follow" target="_blank"><div class="lq ab fo"><div class="lr ab ls cl cj lt"><h2 class="bd ir gy z fp lu fr fs lv fu fw ip bi translated">用Rust处理14 GB文件—第1部分</h2><div class="lw l"><h3 class="bd b gy z fp lu fr fs lv fu fw dk translated">周末建设和学习</h3></div><div class="lx l"><p class="bd b dl z fp lu fr fs lv fu fw dk translated">medium.com</p></div></div><div class="ly l"><div class="lz l ma mb mc ly md kr lp"/></div></div></a></div><p id="3c5b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在第2部分中，我将关注如何利用Docker来执行本地测试。</p></div><div class="ab cl me mf hu mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ij ik il im in"><p id="8932" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我想阐明的一个关键要素是我们应该如何最大化我们的本地机器来覆盖开发周期的大部分，主要原因是成本。假设您或您的公司需要限制使用模拟数据/仅屏蔽数据。</p><p id="acb5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可能会和我争论，本地机器并不是全马力的，所以我们需要利用云。但是，你应该知道:</p><ol class=""><li id="e153" class="ml mm iq jp b jq jr ju jv jy mn kc mo kg mp kk mq mr ms mt bi translated">在这一天，你现在的本地机器应该足够强大，有时，在我以前的文章中，我甚至使用surface pro 6，它只有4个内核。我也相信，大多数数据工程师的笔记本电脑或mac电脑应该拥有最高端的规格。:)</li><li id="1d37" class="ml mm iq jp b jq mu ju mv jy mw kc mx kg my kk mq mr ms mt bi translated">对于云来说，总是有相关的成本，甚至你只是打印HelloWorld。</li></ol></div><div class="ab cl me mf hu mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ij ik il im in"><h2 id="7e6e" class="mz na iq bd nb nc nd dn ne nf ng dp nh jy ni nj nk kc nl nm nn kg no np nq nr bi translated">单位测试</h2><p id="45b6" class="pw-post-body-paragraph jn jo iq jp b jq ns js jt ju nt jw jx jy nu ka kb kc nv ke kf kg nw ki kj kk ij bi translated">其中一个关于Rust的有趣部分，真的是模拟的像Golang一样，很容易写单元测试。</p><p id="b14f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">单元测试不仅写起来有趣，而且让你思考如何以一种有效的方式组织你的代码。对于这个用例，MapReduce part-key函数可以重用，我将在第3部分中讨论这一点，我们将使用Azure stacks部署它，因此这两个函数<strong class="jp ir"> processing </strong>和<strong class="jp ir"> check_if_person </strong>需要编写测试代码。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ny nz di oa bf ob"><div class="gh gi nx"><img src="../Images/76335a17b30d98ca519a732b55a22a15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wwC5aqigPNoouROK85rDeg.png"/></div></div><figcaption class="kt ku gj gh gi kv kw bd b be z dk translated">重用MapReduce</figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ny nz di oa bf ob"><div class="gh gi nx"><img src="../Images/c45377736aed2714e580a246a79d89fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ha3tRDdqrneZFcJQ3z5oKg.png"/></div></div><figcaption class="kt ku gj gh gi kv kw bd b be z dk translated">单元测试</figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ny nz di oa bf ob"><div class="gh gi oc"><img src="../Images/c0058d22047eb0924c0bb08e51bf3b89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OTczXQAoDXDFZwMcuBzlCQ.png"/></div></div><figcaption class="kt ku gj gh gi kv kw bd b be z dk translated">单元测试结果</figcaption></figure><h2 id="8b98" class="mz na iq bd nb nc nd dn ne nf ng dp nh jy ni nj nk kc nl nm nn kg no np nq nr bi translated">构建dockerfile文件</h2><p id="95b3" class="pw-post-body-paragraph jn jo iq jp b jq ns js jt ju nt jw jx jy nu ka kb kc nv ke kf kg nw ki kj kk ij bi translated">我不想在这里花太多时间解释docker，尤其是它对SDLC的好处。然而，对于这个用例，我想使用docker并围绕运行基于容器的作业进行测试，看看它的性能如何。</p><p id="bb5e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，我将在第3部分解释我们如何将容器部署到云容器服务，比如AKS。不过，还是先从本地码头工人说起吧。在大多数情况下，我通常如下设置我的本地docker env:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi od"><img src="../Images/423401d67feda5e2e053c260ac4b9e6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*wJ-Hj1CTDZuKmM-sxVYj7w.png"/></div><figcaption class="kt ku gj gh gi kv kw bd b be z dk translated">docker系统信息</figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/b959b31d0249d41cfc6b454a97658dde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/1*OZ4qQ65AlH1QeyDFdw8_pg.png"/></div><figcaption class="kt ku gj gh gi kv kw bd b be z dk translated">dockerfile文件</figcaption></figure><p id="a809" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦docker-compose启动，我们可以看到作业正在运行，我使用<a class="ae of" href="https://dockstation.io/" rel="noopener ugc nofollow" target="_blank"> dockerStation </a>来捕获CPU和内存使用情况，以便很好地理解作业将在基于容器的env中运行。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ny nz di oa bf ob"><div class="gh gi og"><img src="../Images/07365c0d311ddcae11a53a9e16039e8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OCiLsH90W5DXOEI5nFo4zw.png"/></div></div><figcaption class="kt ku gj gh gi kv kw bd b be z dk translated">码头站</figcaption></figure><p id="aca4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在处理上下文的15 GB数据量上，使用情况似乎符合预期。</p><blockquote class="kx"><p id="4541" class="ky kz iq bd la lb oh oi oj ok ol kk dk translated">未完待续…</p></blockquote><p id="389e" class="pw-post-body-paragraph jn jo iq jp b jq lh js jt ju li jw jx jy lj ka kb kc lk ke kf kg ll ki kj kk ij bi translated">在第3部分中，我将着重于构建CI/CD管道并部署到AK。</p><div class="lm ln gp gr lo lp"><a href="https://medium.com/@jayhuang75/processing-14-gb-files-with-rust-part-3-azure-stacks-13dcf9dde014" rel="noopener follow" target="_blank"><div class="lq ab fo"><div class="lr ab ls cl cj lt"><h2 class="bd ir gy z fp lu fr fs lv fu fw ip bi translated">使用Rust处理14 GB文件—第3部分— Azure堆栈</h2><div class="lw l"><h3 class="bd b gy z fp lu fr fs lv fu fw dk translated">周末编码和写作</h3></div><div class="lx l"><p class="bd b dl z fp lu fr fs lv fu fw dk translated">medium.com</p></div></div><div class="ly l"><div class="om l ma mb mc ly md kr lp"/></div></div></a></div><p id="8c73" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">再次，保持安全和健康。关于我的其他文章，请查看下面的链接。</p><p id="e8e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae of" href="https://medium.com/@jayhuang75" rel="noopener">https://medium.com/@jayhuang75</a></p></div></div>    
</body>
</html>