<html>
<head>
<title>List, Dictionary, and Set Comprehensions in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 中的列表、字典和集合理解</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/list-dictionary-and-set-comprehensions-in-python-103c2a20191b?source=collection_archive---------1-----------------------#2020-07-10">https://blog.devgenius.io/list-dictionary-and-set-comprehensions-in-python-103c2a20191b?source=collection_archive---------1-----------------------#2020-07-10</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="5186" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">在 Python 中快速创建列表、字典或集合，无需使用 for 循环</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/777ad3caa3446eaf976f477adb94c388.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jwjjPadZYYnB0djPxDT1hg.jpeg"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk translated">一套完整的旋转石，图片由作者提供</figcaption></figure><p id="5531" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">Python 提供了三种类型的理解，可以用 Python 方便地创建基本的集合数据类型，可读性更好。</p><p id="447c" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">我将用例子来解释每一种理解。</p></div><div class="ab cl ls lt hv lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ik il im in io"><h1 id="6719" class="lz ma ir bd mb mc md me mf mg mh mi mj jx mk jy ml ka mm kb mn kd mo ke mp mq bi translated">列出理解</h1><p id="9057" class="pw-post-body-paragraph kw kx ir ky b kz mr js lb lc ms jv le lf mt lh li lj mu ll lm ln mv lp lq lr ik bi translated">列表理解是用 Python 快速创建列表的另一种方式。如果你发现自己使用 for 循环和<code class="fe mw mx my mz b">.append()</code>来创建一个列表，列表理解是一个很好的选择。</p><p id="0402" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">列表理解具有以下签名。</p><pre class="kh ki kj kk gu na mz nb nc aw nd bi"><span id="eac7" class="ne ma ir mz b gz nf ng l nh ni">[<em class="nj">expr</em> for <em class="nj">val </em>in <em class="nj">collection </em>if <em class="nj">condition</em>]</span></pre><p id="cf7c" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">您可以对以下内容使用列表理解:</p><ul class=""><li id="7b1e" class="nk nl ir ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">操纵列表</li><li id="721d" class="nk nl ir ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">提取信息</li><li id="f033" class="nk nl ir ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">过滤列表</li></ul><p id="a974" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">我将用四个不同的例子来解释列表理解的可能性。每个例子都展示了如何在有列表理解和没有列表理解的情况下实现该功能。</p><h2 id="bf25" class="ne ma ir bd mb ny nz dn mf oa ob dp mj lf oc od ml lj oe of mn ln og oh mp oi bi translated">1.计算数字 1 到 10 的平方</h2><p id="e569" class="pw-post-body-paragraph kw kx ir ky b kz mr js lb lc ms jv le lf mt lh li lj mu ll lm ln mv lp lq lr ik bi translated">此示例显示了计算数字 1 到 10 的平方的两种方法。第一个，第一到第三行使用<code class="fe mw mx my mz b">append</code>将数字的平方加到列表中。第二，在第五行，使用<em class="nj">列表理解</em>。计算平方的表达式是一样的，<code class="fe mw mx my mz b">i**2</code>。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="oj ok l"/></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk translated">计算数字 1 到 10 的平方</figcaption></figure><p id="9c11" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">正如您所看到的，带有<code class="fe mw mx my mz b">append</code>的版本使用了三行，而 list comprehension 使用单行完成了同样的任务。</p><h2 id="8c0c" class="ne ma ir bd mb ny nz dn mf oa ob dp mj lf oc od ml lj oe of mn ln og oh mp oi bi translated">2.从数字 1 到 10 中过滤奇数</h2><p id="651d" class="pw-post-body-paragraph kw kx ir ky b kz mr js lb lc ms jv le lf mt lh li lj mu ll lm ln mv lp lq lr ik bi translated">这个例子展示了从列表中过滤奇数的两种方法。第一种方法使用 for 循环和模运算符来计算余数。</p><p id="818a" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">第六行的第二个使用一个 if 语句的列表理解来过滤奇数。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="oj ok l"/></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk translated">过滤 1 到 10 范围内的奇数</figcaption></figure><p id="0927" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">结合 if 语句，行数的差异甚至更大——对于包含列表理解的解决方案，一行表示一行。</p><h2 id="ecd3" class="ne ma ir bd mb ny nz dn mf oa ob dp mj lf oc od ml lj oe of mn ln og oh mp oi bi translated">3.过滤 25 岁以上的人</h2><p id="eff0" class="pw-post-body-paragraph kw kx ir ky b kz mr js lb lc ms jv le lf mt lh li lj mu ll lm ln mv lp lq lr ik bi translated">下面的例子显示了如何使用列表理解来过滤所有 25 岁以上的人。</p><p id="44c0" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">用户列表包含三个字典。每本词典都包含一个人的姓名和年龄。我们过滤 25 岁以上的人的名字。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="oj ok l"/></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk translated">使用列表理解筛选人员</figcaption></figure><p id="9317" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">第 10 行的 List Comprehension 遍历所有用户，如果用户的年龄超过 25 岁，它将选择姓名。</p><h2 id="d244" class="ne ma ir bd mb ny nz dn mf oa ob dp mj lf oc od ml lj oe of mn ln og oh mp oi bi translated">4.创建标识矩阵</h2><p id="5577" class="pw-post-body-paragraph kw kx ir ky b kz mr js lb lc ms jv le lf mt lh li lj mu ll lm ln mv lp lq lr ik bi translated">大小为 n 的单位矩阵是一个 n 乘 n 的方阵，主对角线上只有 1。一个二乘二和一个三乘三的单位矩阵看起来像这样。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div class="gi gj ol"><img src="../Images/e5f0c30c0e4e7da51e1b40fd6a60527f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1234/0*6dbxzVk8chwbkf43.gif"/></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk translated">两个单位矩阵</figcaption></figure><p id="21db" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">在 Python 中，可以通过在一个列表中使用另一个列表来构造一个单位矩阵。</p><pre class="kh ki kj kk gu na mz nb nc aw nd bi"><span id="93b1" class="ne ma ir mz b gz nf ng l nh ni">[ [ 1, 0, 0 ],<br/>  [ 0, 1, 0 ],<br/>  [ 0, 0, 1 ] ]</span></pre><p id="065f" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">让我们看看如何在不使用 Python 中的列表理解的情况下创建这个单位矩阵。</p><p id="5132" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">这里我们使用了两个 for 循环，一个用于迭代行，另一个用于迭代列。如果列索引和行索引相同，我们追加一个 1；否则，我们加一个零。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="oj ok l"/></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk translated">用 Python 创建一个单位矩阵</figcaption></figure><p id="beeb" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">为了使用列表理解来实现这一点，我们使用第二次迭代。请参见下面的示例，该示例创建了相同的三乘三单位矩阵。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="oj ok l"/></div></figure></div><div class="ab cl ls lt hv lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ik il im in io"><h1 id="b9ff" class="lz ma ir bd mb mc md me mf mg mh mi mj jx mk jy ml ka mm kb mn kd mo ke mp mq bi translated">词典释义</h1><p id="a2e3" class="pw-post-body-paragraph kw kx ir ky b kz mr js lb lc ms jv le lf mt lh li lj mu ll lm ln mv lp lq lr ik bi translated">就像列表理解是快速创建列表的一种方式一样，字典理解是用 Python 快速创建字典的一种不同方式。</p><p id="2aec" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">字典理解有以下签名。</p><pre class="kh ki kj kk gu na mz nb nc aw nd bi"><span id="5c53" class="ne ma ir mz b gz nf ng l nh ni">{<em class="nj">expr</em> for <em class="nj">(key,value)</em> in <em class="nj">dictionary</em> if <em class="nj">condition</em>}</span></pre><p id="8e47" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">它们看起来很像列表综合，但是使用括号<strong class="ky is"> {} </strong>代替括号<strong class="ky is"> []。</strong></p><p id="0722" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">您可以使用字典理解:</p><ul class=""><li id="0b8f" class="nk nl ir ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">操纵字典</li><li id="de6c" class="nk nl ir ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">提取信息</li><li id="16af" class="nk nl ir ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">过滤词典</li></ul><p id="b07b" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">我将用三个不同的例子来解释字典理解的可能性。每个例子都展示了如何在有和没有字典理解的情况下实现该功能。</p><h2 id="3694" class="ne ma ir bd mb ny nz dn mf oa ob dp mj lf oc od ml lj oe of mn ln og oh mp oi bi translated">1.计算数字 1 到 10 的平方，并将其存储在字典中</h2><p id="a0b4" class="pw-post-body-paragraph kw kx ir ky b kz mr js lb lc ms jv le lf mt lh li lj mu ll lm ln mv lp lq lr ik bi translated">这个例子展示了用数字 1 到 10 的平方创建字典的两种方法。第一个，第一到第三行使用索引操作符<code class="fe mw mx my mz b">[]</code>向列表中添加一个方块。第五行的第二个使用列表理解。计算平方的表达式是一样的，<code class="fe mw mx my mz b">i**2</code>。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="oj ok l"/></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk translated">使用字典理解计算数字 1 到 10 的平方</figcaption></figure><h2 id="cb1b" class="ne ma ir bd mb ny nz dn mf oa ob dp mj lf oc od ml lj oe of mn ln og oh mp oi bi translated">2.过滤 25 岁以上的人</h2><p id="d153" class="pw-post-body-paragraph kw kx ir ky b kz mr js lb lc ms jv le lf mt lh li lj mu ll lm ln mv lp lq lr ik bi translated">这个例子展示了从字典中过滤 25 岁以上的人的两种方法。该字典包含 Person 类的三个实例。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="oj ok l"/></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk translated">使用字典理解按年龄筛选人员</figcaption></figure><p id="925f" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">该示例使用一个源代码行来执行使用字典理解的过滤，而不使用字典理解的示例需要四行代码。</p><h2 id="ba33" class="ne ma ir bd mb ny nz dn mf oa ob dp mj lf oc od ml lj oe of mn ln og oh mp oi bi translated">3.统计单词在句子中的出现次数</h2><p id="7d58" class="pw-post-body-paragraph kw kx ir ky b kz mr js lb lc ms jv le lf mt lh li lj mu ll lm ln mv lp lq lr ik bi translated">你可以用字典理解来计算一个句子中的单词。以下示例的前四行在不使用字典理解的情况下计算字符串中的单词。首先，它创建一个字典，分割字符串，并遍历单词。程序使用这个单词作为字典的关键字。如果该键已经存在，则计数加 1；它将计数设置为 1。</p><p id="f2f6" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">第六行的字典理解将消息拆分并创建一个集合。通过创建一个集合，所有的双字都被删除。它遍历所有唯一单词，并计算该唯一单词在拆分字符串中出现的次数。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="oj ok l"/></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk translated">统计有词典理解和没有词典理解的单词的频率</figcaption></figure></div><div class="ab cl ls lt hv lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ik il im in io"><h1 id="9af5" class="lz ma ir bd mb mc md me mf mg mh mi mj jx mk jy ml ka mm kb mn kd mo ke mp mq bi translated">集合理解</h1><p id="8494" class="pw-post-body-paragraph kw kx ir ky b kz mr js lb lc ms jv le lf mt lh li lj mu ll lm ln mv lp lq lr ik bi translated">我们在 Python 中可以使用的最后一种理解叫做集合理解。集合理解类似于列表理解，但是返回集合而不是列表。语法看起来更像是字典理解，因为我们使用花括号来创建集合。</p><p id="2e16" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">集合理解具有以下签名。</p><pre class="kh ki kj kk gu na mz nb nc aw nd bi"><span id="0b45" class="ne ma ir mz b gz nf ng l nh ni">{<em class="nj">expr</em> for <em class="nj">key</em> in <em class="nj">dictionary</em> if <em class="nj">condition</em>}</span></pre><h2 id="fc13" class="ne ma ir bd mb ny nz dn mf oa ob dp mj lf oc od ml lj oe of mn ln og oh mp oi bi translated">1.筛选表中某列的不同值</h2><p id="28b0" class="pw-post-body-paragraph kw kx ir ky b kz mr js lb lc ms jv le lf mt lh li lj mu ll lm ln mv lp lq lr ik bi translated">在第 12 行，使用集合理解来选择列表中人员的所有城市。该集合确保所有项目都是唯一的。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="oj ok l"/></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk translated">从人员列表中过滤不同的城市</figcaption></figure></div><div class="ab cl ls lt hv lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ik il im in io"><h1 id="6fe1" class="lz ma ir bd mb mc md me mf mg mh mi mj jx mk jy ml ka mm kb mn kd mo ke mp mq bi translated">理解的可读性</h1><p id="3f04" class="pw-post-body-paragraph kw kx ir ky b kz mr js lb lc ms jv le lf mt lh li lj mu ll lm ln mv lp lq lr ik bi translated">有人说理解很难读懂。我认为有时他们是对的，他们可能很难读懂。所以确保当你使用一个时，代码变得更可读。有时在理解中加入空格有助于提高可读性。</p></div><div class="ab cl ls lt hv lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ik il im in io"><h1 id="3960" class="lz ma ir bd mb mc md me mf mg mh mi mj jx mk jy ml ka mm kb mn kd mo ke mp mq bi translated"><strong class="ak">结论</strong></h1><p id="47e8" class="pw-post-body-paragraph kw kx ir ky b kz mr js lb lc ms jv le lf mt lh li lj mu ll lm ln mv lp lq lr ik bi translated">列表、字典或集合理解允许我们将一个序列转换成另一个序列。它们提供了一个紧凑的语法来完成这个任务，限制了代码的行数。</p><p id="90b8" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">理解遵循集合构建符号的数学形式，因此对于具有数学背景的程序员来说，它们可能特别直观。</p><p id="524b" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">尽管列表理解使你的代码更加简洁，但是确保我们最终的代码尽可能的易读是至关重要的。您应该避免特别长的单行代码，以确保您的代码是可维护的。</p><p id="8b34" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">感谢您的阅读！</p></div></div>    
</body>
</html>