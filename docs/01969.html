<html>
<head>
<title>Machine Learning Algorithm-Logistic Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习算法-逻辑回归</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/machine-learning-algorithm-logistic-regression-4bf0768b07da?source=collection_archive---------20-----------------------#2020-07-15">https://blog.devgenius.io/machine-learning-algorithm-logistic-regression-4bf0768b07da?source=collection_archive---------20-----------------------#2020-07-15</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/a6332fccfd1c37012c2428e24723700c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rmXSVr7NopG_hFH0XZsEPA.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated"><a class="ae jz" href="https://images.app.goo.gl/SJpTK12BybL9eYDV9" rel="noopener ugc nofollow" target="_blank">https://images.app.goo.gl/SJpTK12BybL9eYDV9</a></figcaption></figure><h1 id="6fc3" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">什么是回归？</h1><p id="07df" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">回归是预测分析中最流行的监督学习算法之一。回归模型需要数据集中输出变量和特征变量的知识。</p><p id="74da" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">以下是线性回归问题的几个例子:</p><p id="e916" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">1.医院可能对发现患者的总治疗费用如何随患者体重而变化感兴趣。</p><p id="42c4" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">2.餐馆想知道顾客下单后的等待时间和收入之间的关系。</p><p id="4d65" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">3.亚马逊、big basket 等电子商务公司希望了解失业率、婚姻状况、银行账户余额、降雨量等变量的影响。论不良资产的百分比</p><p id="9543" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">4.保险公司希望了解医疗费用和老龄化之间的关系。</p><p id="21cf" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">5.一个组织可能有兴趣发现产品产生的收入与价格、促销花费、竞争对手价格和促销费用等特征之间的关系。</p><h1 id="94ff" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">监督学习</h1><p id="10e2" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">督导式学习顾名思义就是表示督导作为老师的存在。训练数据将由与正确输出配对的输入组成。在训练期间，算法将在数据中搜索与期望输出相关的模式。在训练之后，它将接受新数据，该新数据将基于先前的训练数据来确定新输入将被分类为哪个标签。动机是预测新输入数据的正确标签。可以写成<strong class="la io"> Y=f(x)。</strong></p><h1 id="1165" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">逻辑回归</h1><p id="dcc6" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">它是一种统计机器学习算法，用于对数据进行分类。当因变量是分类变量时，它可以被应用。逻辑回归的目标是根据数据之间的关系将数据分配到各自的类中。逻辑回归的方程式可以写成</p><figure class="mc md me mf gt jo gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/29b2bb14b0d2c51f4a3caba1dc1db889.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*5Y4o7BWRP9LXBzPh7QqTnA.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">【https://images.app.goo.gl/oE1srjfA6NKVdqv5A T4】</figcaption></figure><p id="ce06" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">由逻辑回归形成的图表通常呈“s”形，Y 轴上的值总是在 0 和 1 之间:</p><figure class="mc md me mf gt jo gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/73a256fce48ab4374a8914f142ea1ee4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*aiM8RoaOngtT7J7NtRzfWA.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">逻辑回归。</figcaption></figure><p id="0ad8" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">逻辑回归的例子包括:</p><p id="96a8" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">1.假设我们对影响政治候选人是否赢得选举的因素感兴趣。结果(响应)变量是二进制的(0/1)；无论输赢。感兴趣的预测变量是花在竞选上的钱数、花在负面竞选上的时间以及候选人是否在职。</p><p id="e6ea" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">2.研究人员感兴趣的是变量，如 GRE(研究生考试成绩)，GPA(平均绩点)和本科院校的声望，如何影响研究生院的录取。响应变量“承认/不承认”是一个二元变量。</p><p id="cc62" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">3.确定收到的电子邮件是否是垃圾邮件。</p><p id="0837" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">4.以确定银行贷款是否被批准。</p><p id="58b9" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">5.不管肿瘤是不是恶性的。</p><p id="46f2" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">我们有许多类型的逻辑回归，如:</p><h2 id="1034" class="mh kb in bd kc mi mj dn kg mk ml dp kk lj mm mn ko ln mo mp ks lr mq mr kw ms bi translated">1.二元逻辑回归</h2><p id="c7fb" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">这是一种有两种结果的分类。例子包括收到的邮件是否是垃圾邮件。</p><h2 id="aa52" class="mh kb in bd kc mi mj dn kg mk ml dp kk lj mm mn ko ln mo mp ks lr mq mr kw ms bi translated"><strong class="ak"> 2。多项式逻辑回归</strong></h2><p id="e0e0" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">这是一种有两种以上结果的分类。例子包括汽车的价格是贵、中还是便宜。</p><h2 id="bc76" class="mh kb in bd kc mi mj dn kg mk ml dp kk lj mm mn ko ln mo mp ks lr mq mr kw ms bi translated">3.有序逻辑回归</h2><p id="0ad3" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">这是一种按顺序排列更多结果的分类，有序逻辑回归的一个例子是在 1-10 的范围内给幸福评分。</p><h1 id="81bf" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">让我们编码:</h1><p id="8879" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated"><strong class="la io">导入库</strong></p><figure class="mc md me mf gt jo gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/1b932226f477e927ff10a5f0a6c1552f.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/0*49CVB10u056YxQdR"/></div></figure><p id="f0c9" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">我只是导入了这个过程中需要的所有库</p><p id="7a84" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">Numpy →这是一个用于处理数组的库。</p><p id="083c" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">Pandas →将数据文件作为 Pandas 数据框加载并分析数据。</p><p id="585d" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">Matplotlib →我已经导入 pyplot 来绘制数据的图形。</p><h1 id="985b" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">导入数据集</h1><figure class="mc md me mf gt jo gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/135aac2d9063e94e809115b76a2e9633.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/0*qeiX5jx__kNqe-QW"/></div></figure><p id="5134" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">我们的文件是 CSV(逗号分隔值)格式，所以我们使用 pandas 导入文件。然后我们把数据分成因变量和自变量。x 被认为是独立的，Y 被认为是从属的。</p><h1 id="157a" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">训练装置和测试装置</h1><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mv"><img src="../Images/f83b8cc14cd0386169bc2622ad7bd4a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*utQCvrAeM1Of_lL0"/></div></div></figure><p id="c076" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">从 Sklearn 的子库 model_selection 中，我导入了 train_test_split，它用于分割训练集和测试集。我们可以使用 train_test_split 函数进行拆分。函数中的 test_size = 0.25 表示应该保留下来进行测试的数据的百分比。</p><h1 id="e2d8" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">特征缩放</h1><p id="4ef5" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">当我们处理一个模型时，确保值在相同的范围内是很重要的，否则很难将它传递给模型。为了解决这个问题，我提出了特征缩放。它是一种将固定范围内的数据中存在的独立特征标准化的技术。这是在数据预处理期间执行的。</p><p id="34d0" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">在我们的数据集中，我们有四个特征:</p><p id="b816" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">用户标识</p><p id="5b55" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">年龄</p><p id="e063" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">收入</p><p id="5112" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">自己的房子</p><p id="efb6" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">在这里，我们把年龄和收入作为自变量，把自己的房子作为因变量。在我们的独立变量中，年龄以十为单位，收入以千为单位，需要对这些变量应用特征缩放以获得最佳预测。</p><p id="25e0" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">sci-kit 学习库提供了一个类来缩放我们的数据，我们可以从预处理中使用 StandaradScaler 类。我们从库中导入类，我们将为它创建一个对象。我们将利用 fit_transform 方法将独立变量的训练集和测试集转换到相同的范围内。</p><figure class="mc md me mf gt jo gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/a4024ed448760f2985f22634b0a856ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/0*C5wNYfAZXQWdannb"/></div></figure><h1 id="a810" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">现在让我们来拟合数据</h1><p id="aa73" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">从子库线性模型 Sklearn 中，我们导入线性回归，并根据训练数据拟合模型。</p><figure class="mc md me mf gt jo gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/1778da779f417b07fc287953ed4b70c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/0*D2XSfuLe30x3-HRo"/></div></figure><h1 id="1a73" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">预测测试结果</h1><figure class="mc md me mf gt jo gh gi paragraph-image"><div class="gh gi my"><img src="../Images/efae6e66c9c8f12c04b83bff3095c1c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:632/0*G3CU67e9HdGQ46VN"/></div></figure><h1 id="91d6" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">评估指标</h1><p id="5264" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">简单地建立一个预测模型不是我们的动机。它是关于创建和选择一个模型，给出样本数据的高精度。因此，在计算预测值之前检查模型的准确性至关重要。我们将利用一种用于计算分类模型准确性的评估度量技术。下面详细讨论一下。</p><p id="5588" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated"><strong class="la io">混淆矩阵</strong></p><p id="dc62" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">它是机器学习中分类模型的一种性能测量技术，其中输出具有两个或更多类别。这是一个包含实际值和预测值的四种不同组合的表格。</p><figure class="mc md me mf gt jo gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/5f0cef658137187631b2c608541cee75.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/0*Bf8_upsy4tdhcDfM"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">https://images.app.goo.gl/NZJ2YNoNUqiBFVZR8<a class="ae jz" href="https://images.app.goo.gl/NZJ2YNoNUqiBFVZR8" rel="noopener ugc nofollow" target="_blank"/></figcaption></figure><p id="d280" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">让我们来理解混淆矩阵中的术语。</p><h2 id="5a03" class="mh kb in bd kc mi mj dn kg mk ml dp kk lj mm mn ko ln mo mp ks lr mq mr kw ms bi translated">真阳性(TP)</h2><p id="a20c" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">如果实际值和预测值都是真的，那么就是真正。例如，你预测一个观察是一个苹果，观察是一个苹果。</p><h2 id="a201" class="mh kb in bd kc mi mj dn kg mk ml dp kk lj mm mn ko ln mo mp ks lr mq mr kw ms bi translated">假阴性(FN)</h2><p id="8079" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">如果实际值为真，预测值为假，那么就是假阴性。例如，你预测一个观察不是一个苹果，但是观察是一个苹果。</p><h2 id="0474" class="mh kb in bd kc mi mj dn kg mk ml dp kk lj mm mn ko ln mo mp ks lr mq mr kw ms bi translated">假阳性</h2><p id="21e8" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">如果预测值为假，但实际值为真，则为假阳性。例如，你预测观察是一个苹果，但观察不是苹果。</p><h2 id="65e2" class="mh kb in bd kc mi mj dn kg mk ml dp kk lj mm mn ko ln mo mp ks lr mq mr kw ms bi translated">真阴性(TN)</h2><p id="60bc" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">如果预测值为假，实际值也为假，则为真阴性。例如，你预测观察不是苹果，观察也不是苹果。</p><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi na"><img src="../Images/04a8e8981c34df2d18918b6301fab1c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/0*Xw5Nu1jZmkXUJoMb"/></div></div></figure><p id="9b39" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">让我们从 metrics 类导入混淆矩阵并为其创建一个对象，然后我们将 y_test 和 y_pred 作为参数传递，以了解预测值的准确性。这里需要加上真正真负才能知道模型的表现。</p><p id="1df8" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">下面是我所做工作的总结:我加载了数据，将数据分为训练集和测试集，应用标准的 scaler 方法将数据归一化到相同的范围内，将回归模型拟合到训练数据，基于这些数据进行预测，并在测试数据上测试预测。</p></div><div class="ab cl nb nc hr nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="ig ih ii ij ik"><h1 id="439c" class="ka kb in bd kc kd ni kf kg kh nj kj kk kl nk kn ko kp nl kr ks kt nm kv kw kx bi translated">使用 python 实现:</h1><div class="nn no gp gr np nq"><a href="https://github.com/saimanoj1234/SAI/blob/master/logistic%20%281%29.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd io gy z fp nv fr fs nw fu fw im bi translated">saimanoj1234/SAI</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">permalink dissolve GitHub 是超过 5000 万开发人员的家园，他们一起工作来托管和审查代码，管理…</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">github.com</p></div></div><div class="nz l"><div class="oa l ob oc od nz oe jt nq"/></div></div></a></div></div></div>    
</body>
</html>