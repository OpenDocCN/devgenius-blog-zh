<html>
<head>
<title>How to Prepare and Send Your New Year Message Card with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python准备和发送你的新年信息卡</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-prepare-and-send-your-new-year-message-card-with-python-6ad4a8d01d00?source=collection_archive---------8-----------------------#2020-12-28">https://blog.devgenius.io/how-to-prepare-and-send-your-new-year-message-card-with-python-6ad4a8d01d00?source=collection_archive---------8-----------------------#2020-12-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0d4f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">用Python告别2020</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c96d14129a7887241d4caaaceff60707.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ce9U8CPM9_AfMW8y"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@jamie452?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">杰米·斯特里特</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="bbbb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你是一个喜欢给朋友或家人发新年信息卡的人，也许这次你想通过编程来实现。让我们开始…</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="da72" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">准备您的环境</h2><p id="e6df" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">我们需要创建一个虚拟环境，然后开始将依赖项与系统的其余部分隔离开来。</p><ul class=""><li id="b339" class="mx my iq ky b kz la lc ld lf mz lj na ln nb lr nc nd ne nf bi translated">如果您使用pip</li></ul><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="155e" class="lz ma iq nh b gy nl nm l nn no">python -m venv env<br/>source env/bin/activate<br/>pip install yagmail</span></pre><ul class=""><li id="dd27" class="mx my iq ky b kz la lc ld lf mz lj na ln nb lr nc nd ne nf bi translated">如果您使用pipenv</li></ul><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="decd" class="lz ma iq nh b gy nl nm l nn no">pipenv install yagmail<br/>pipenv shell</span></pre><p id="7be2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe np nq nr nh b"><a class="ae kv" href="https://pypi.org/project/yagmail/" rel="noopener ugc nofollow" target="_blank">yagmail</a></code>是一个Python包，用于与Gmail帐户交互，使发送电子邮件更容易。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="c580" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">实施和解释</h2><p id="4c20" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">该计划将有命令行参数和交互模式的支持。</p><p id="04b8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将有6个命令行参数，其中四个具有默认值。</p><ul class=""><li id="c8aa" class="mx my iq ky b kz la lc ld lf mz lj na ln nb lr nc nd ne nf bi translated"><code class="fe np nq nr nh b">-f</code>发件人邮件地址</li><li id="708b" class="mx my iq ky b kz ns lc nt lf nu lj nv ln nw lr nc nd ne nf bi translated"><code class="fe np nq nr nh b">-t</code>收件人邮件地址。多个邮件地址可以用一个文件给出，也可以用逗号分隔。</li><li id="6c2d" class="mx my iq ky b kz ns lc nt lf nu lj nv ln nw lr nc nd ne nf bi translated"><code class="fe np nq nr nh b">-s</code>邮件主题，默认值为“圣诞快乐”</li><li id="8df9" class="mx my iq ky b kz ns lc nt lf nu lj nv ln nw lr nc nd ne nf bi translated"><code class="fe np nq nr nh b">-m</code>消息正文</li><li id="0627" class="mx my iq ky b kz ns lc nt lf nu lj nv ln nw lr nc nd ne nf bi translated"><code class="fe np nq nr nh b">-b</code>背景色。您可以使用不带#前缀的颜色名称或代码。</li><li id="eca5" class="mx my iq ky b kz ns lc nt lf nu lj nv ln nw lr nc nd ne nf bi translated"><code class="fe np nq nr nh b">-c</code>文字颜色。此外，边框将采用这种颜色。</li></ul><p id="aee3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是从命令行获取这些参数的函数。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx ny l"/></div></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="bed8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果程序在没有参数的情况下执行，它将进入交互模式。否则，它将从参数中获取值。入口点函数如下所示。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="509d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">交互模式将通过以下功能逐一询问用户所需或可选的参数来处理。如果用户在没有输入值的情况下按enter键，将使用括号中显示的默认值。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="3795" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在获取参数的过程中，首先用下面的<code class="fe np nq nr nh b">MessageHeader</code>类构造消息头。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="bf9e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于允许多个收件人，<code class="fe np nq nr nh b">to_email</code>实例变量由逗号分隔的字符串、文件或单个邮件地址构成。</p><p id="cab0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，将使用<code class="fe np nq nr nh b">MessageContent</code>类获取参数，通过如下的<code class="fe np nq nr nh b">construct_html_message</code>方法将消息构造为HTML。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="79e5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">背景、文本和边框颜色根据给定的参数进行更新。</p><p id="852f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，将使用<code class="fe np nq nr nh b">send_email</code>方法发送HTML构造的消息。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx ny l"/></div></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="5a39" class="nz ma iq bd mb oa ob oc me od oe of mh jw og jx mk jz oh ka mn kc oi kd mq oj bi translated">例子</h1><ul class=""><li id="f311" class="mx my iq ky b kz ms lc mt lf ok lj ol ln om lr nc nd ne nf bi translated">使用带有默认主题、背景和文本颜色的参数</li></ul><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="b6f8" class="lz ma iq nh b gy nl nm l nn no">python new_year_message_automator.py -f codenineeight@gmail.com -t coskun.denize@gmail.com -m "I wish you a healthy and happy new year :)"</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi on"><img src="../Images/a46abf4daeee8d494bbcf1c1eb65efb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*yFw_5XSHtNpd1lnuMQ7_TA.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">第一个示例结果的作者截图</figcaption></figure><ul class=""><li id="f04a" class="mx my iq ky b kz la lc ld lf mz lj na ln nb lr nc nd ne nf bi translated">使用带有自定义主题和背景颜色的参数</li></ul><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="57ec" class="lz ma iq nh b gy nl nm l nn no">python new_year_message_automator.py -f codenineeight@gmail.com -t coskun.denize@gmail.com -m "I wish you a healthy and happy new year with your loved ones :)" -s "Happy New Year" -b indigo</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/89c770e5db640d65fb05cd3afb2a1b68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*5fiq8Y9dpdXNNXYrLmTyxg.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">第二个示例结果的作者截图</figcaption></figure><ul class=""><li id="0e7b" class="mx my iq ky b kz la lc ld lf mz lj na ln nb lr nc nd ne nf bi translated">使用默认文本颜色进行交互</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi op"><img src="../Images/a08a2d800f03cf7433c5f07ab5c28ed6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BjY9BTzUravDoW1EOG4cQg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">作者对第三个示例输入的截屏</figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/bb788a88c36fb066cbc5322189d46889.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*Jg_y1wjBz7rHMapL7tGmzQ.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">第三个示例结果的作者截图</figcaption></figure><p id="9086" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以在这里找到完整的代码。</p><p id="e6e8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当然，它可以进行更多的定制，变得更加健壮。是出于好意写的:)</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="764b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">借此机会祝你新年快乐。</p><p id="ef84" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">谢谢你的时间。</p></div></div>    
</body>
</html>