<html>
<head>
<title>Data Engineering Practice 1 â€” Downloading files</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">æ•°æ®å·¥ç¨‹å®è·µ 1 â€”ä¸‹è½½æ–‡ä»¶</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://blog.devgenius.io/data-engineering-practice-1-downloading-files-efe90deca751?source=collection_archive---------9-----------------------#2022-07-24">https://blog.devgenius.io/data-engineering-practice-1-downloading-files-efe90deca751?source=collection_archive---------9-----------------------#2022-07-24</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><figure class="im in gp gr io ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/cebd323856e8646f82929fc4bb0f41d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MikWPB-FBWu2PGV-"/></div></div><figcaption class="iw ix gj gh gi iy iz bd b be z dk translated"><a class="ae ja" href="https://unsplash.com/es/@sigmund?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">è¥¿æ ¼è’™å¾·</a>åœ¨<a class="ae ja" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹ç…§</figcaption></figure><div class=""/><p id="4f5b" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">ä½œä¸ºæ•°æ®å·¥ç¨‹å¸ˆï¼Œä½ éœ€è¦å¾ˆå¤šä¸åŒçš„æŠ€æœ¯æŠ€èƒ½æ¥æé«˜æ—¥å¸¸å·¥ä½œçš„æ•ˆç‡ã€‚å½“ä½ åˆšå¼€å§‹å­¦ä¹ å®ƒä»¬æ—¶ï¼Œæœ‰æ—¶ä¼šæ„Ÿåˆ°ä¸çŸ¥æ‰€æªã€‚å¦‚æœä½ ä¸€ç›´åœ¨åŠªåŠ›å¯»æ‰¾å¼€å§‹å­¦ä¹ å’Œå®æ–½äº‹æƒ…çš„æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ç¯‡æ–‡ç« å°±æ˜¯ä¸ºä½ å†™çš„ã€‚</p><p id="bed4" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">æ•°æ®æ— å¤„ä¸åœ¨ï¼Œæ„å»ºä»»ä½•æ•°æ®ç®¡é“çš„ç¬¬ä¸€æ­¥æ˜¯ä»ä¸åŒçš„æ¥æºè·å–æ•°æ®ã€‚</p><p id="d124" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">è¿™æ˜¯æ•°æ®å·¥ç¨‹å®è·µç³»åˆ—çš„ç¬¬ 1 éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†çœ‹çœ‹å¦‚ä½•èƒ½å¤Ÿä»ä¸€ä¸ª<code class="fe ky kz la lb b">HTTP</code>æºä¸‹è½½å¤šä¸ªæ–‡ä»¶å¹¶è§£å‹ç¼©å®ƒä»¬ï¼Œç”¨<code class="fe ky kz la lb b">Python</code>å°†å®ƒä»¬å­˜å‚¨åœ¨æœ¬åœ°ã€‚</p><p id="2c7f" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">æˆ‘å‘ç°è¿™ä¸ª github åº“å¾ˆæœ‰å¸®åŠ©ï¼Œé‡Œé¢æœ‰æ‰€æœ‰çš„ç»ƒä¹ é¢˜ï¼Œæˆ‘å°†åœ¨è¿™ç¯‡æ–‡ç« å’Œæ¥ä¸‹æ¥çš„æ–‡ç« ä¸­åˆ†äº«æˆ‘çš„è§£å†³æ–¹æ¡ˆã€‚</p><div class="im in gp gr io lc"><a href="https://github.com/danielbeach/data-engineering-practice" rel="noopener  ugc nofollow" target="_blank"><div class="ld ab fo"><div class="le ab lf cl cj lg"><h2 class="bd je gy z fp lh fr fs li fu fw jc bi translated">GitHub-Daniel beach/æ•°æ®å·¥ç¨‹å®è·µ:æ•°æ®å·¥ç¨‹å®è·µé—®é¢˜</h2><div class="lj l"><h3 class="bd b gy z fp lh fr fs li fu fw dk translated">æ•°æ®å·¥ç¨‹çš„ä¸»è¦éšœç¢ä¹‹ä¸€æ˜¯å¤§é‡å’Œå„ç§å„æ ·çš„æŠ€æœ¯æŠ€èƒ½ï¼Œå¯ä»¥è¦æ±‚åœ¨ä¸€ä¸ª</h3></div><div class="lk l"><p class="bd b dl z fp lh fr fs li fu fw dk translated">github.com</p></div></div><div class="ll l"><div class="lm l ln lo lp ll lq iu lc"/></div></div></a></div><h2 id="d903" class="lr ls jd bd lt lu lv dn lw lx ly dp lz kl ma mb mc kp md me mf kt mg mh mi mj bi translated">é—®é¢˜</h2><p id="379d" class="pw-post-body-paragraph ka kb jd kc b kd mk kf kg kh ml kj kk kl mm kn ko kp mn kr ks kt mo kv kw kx ig bi translated">æˆ‘ä»¬å¾—åˆ°äº†ä¸€äº› URLï¼Œæˆ‘ä»¬å¿…é¡»å°†è¿™äº› URL ä¸‹è½½åˆ°æœ¬åœ°çš„ä¸€ä¸ª<em class="mp">ä¸‹è½½</em>æ–‡ä»¶å¤¹ä¸­ã€‚ä¸‹è½½çš„å†…å®¹æ˜¯ä¸€ä¸ª zip æ–‡ä»¶ï¼Œæˆ‘ä»¬å¿…é¡»ä»è¿™ä¸ª zip æ–‡ä»¶ä¸­æå– csv æ–‡ä»¶å¹¶åˆ é™¤è¿™ä¸ª zip æ–‡ä»¶ã€‚</p><p id="da8b" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">åˆå§‹ä»£ç </p><pre class="mq mr ms mt gt mu lb mv mw aw mx bi"><span id="7d92" class="lr ls jd lb b gy my mz l na nb">import requests</span><span id="a7da" class="lr ls jd lb b gy nc mz l na nb">download_uris = [<br/>    '<a class="ae ja" href="https://divvy-tripdata.s3.amazonaws.com/Divvy_Trips_2018_Q4.zip'" rel="noopener ugc nofollow" target="_blank">https://divvy-tripdata.s3.amazonaws.com/Divvy_Trips_2018_Q4.zip'</a>,<br/>    '<a class="ae ja" href="https://divvy-tripdata.s3.amazonaws.com/Divvy_Trips_2019_Q1.zip'" rel="noopener ugc nofollow" target="_blank">https://divvy-tripdata.s3.amazonaws.com/Divvy_Trips_2019_Q1.zip'</a>,<br/>    '<a class="ae ja" href="https://divvy-tripdata.s3.amazonaws.com/Divvy_Trips_2019_Q2.zip'" rel="noopener ugc nofollow" target="_blank">https://divvy-tripdata.s3.amazonaws.com/Divvy_Trips_2019_Q2.zip'</a>,<br/>    '<a class="ae ja" href="https://divvy-tripdata.s3.amazonaws.com/Divvy_Trips_2019_Q3.zip'" rel="noopener ugc nofollow" target="_blank">https://divvy-tripdata.s3.amazonaws.com/Divvy_Trips_2019_Q3.zip'</a>,<br/>    '<a class="ae ja" href="https://divvy-tripdata.s3.amazonaws.com/Divvy_Trips_2019_Q4.zip'" rel="noopener ugc nofollow" target="_blank">https://divvy-tripdata.s3.amazonaws.com/Divvy_Trips_2019_Q4.zip'</a>,<br/>    '<a class="ae ja" href="https://divvy-tripdata.s3.amazonaws.com/Divvy_Trips_2020_Q1.zip'" rel="noopener ugc nofollow" target="_blank">https://divvy-tripdata.s3.amazonaws.com/Divvy_Trips_2020_Q1.zip'</a><br/>]</span><span id="0068" class="lr ls jd lb b gy nc mz l na nb">def main():<br/>    # your code here<br/>    pass</span><span id="89bd" class="lr ls jd lb b gy nc mz l na nb">if __name__ == '__main__':<br/>    main()</span></pre><h2 id="f843" class="lr ls jd bd lt lu lv dn lw lx ly dp lz kl ma mb mc kp md me mf kt mg mh mi mj bi translated">æ­¥éª¤ 1 â€”åœ¨æœ¬åœ°åˆ›å»ºä¸€ä¸ªä¸‹è½½æ–‡ä»¶å¤¹ã€‚</h2><pre class="mq mr ms mt gt mu lb mv mw aw mx bi"><span id="54c9" class="lr ls jd lb b gy my mz l na nb">import os </span><span id="3d87" class="lr ls jd lb b gy nc mz l na nb">def main():<br/>    directory = "downloads"<br/>    os.mkdir(directory)</span><span id="5ae9" class="lr ls jd lb b gy nc mz l na nb">    os.chdir(directory)<br/>    </span><span id="ce31" class="lr ls jd lb b gy nc mz l na nb">if __name__ == '__main__':<br/>    main()</span></pre><p id="91d6" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">ä¸ºäº†åˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œæˆ‘ä»¬ä½¿ç”¨ python çš„ os æ¨¡å—ï¼Œ<br/> <em class="mp"> os.mkdir </em>æ¥åˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œç„¶åæˆ‘ä»¬éœ€è¦ä½¿ç”¨<em class="mp"> os.chdir. <br/>å°†å½“å‰ç›®å½•æ›´æ”¹ä¸ºæŒ‡å‘è¿™ä¸ªä½ç½®ï¼Œå¦‚æœç›®å½•å·²ç»å­˜åœ¨ï¼Œå°†ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚</em></p><h2 id="80cd" class="lr ls jd bd lt lu lv dn lw lx ly dp lz kl ma mb mc kp md me mf kt mg mh mi mj bi translated">æ­¥éª¤ 2 â€”ä» URL è·å–å†…å®¹</h2><p id="dc63" class="pw-post-body-paragraph ka kb jd kc b kd mk kf kg kh ml kj kk kl mm kn ko kp mn kr ks kt mo kv kw kx ig bi translated">æˆ‘ä»¬ä½¿ç”¨ requests HTTP åº“å¹¶ä½¿ç”¨ get()æ–¹æ³•å‘é€ get è¯·æ±‚ã€‚get æ–¹æ³•è¿”å›ä¸€ä¸ª requests.response å¯¹è±¡ã€‚</p><pre class="mq mr ms mt gt mu lb mv mw aw mx bi"><span id="d76a" class="lr ls jd lb b gy my mz l na nb">import os</span><span id="9c04" class="lr ls jd lb b gy nc mz l na nb">def main():<br/>    directory = "downloads"<br/>    os.mkdir(directory)</span><span id="0dee" class="lr ls jd lb b gy nc mz l na nb">    os.chdir(directory)<br/>    for uri in download_uris:<br/>        response = requests.get(uri)</span><span id="4abb" class="lr ls jd lb b gy nc mz l na nb">if __name__ == '__main__':<br/>    main()</span></pre><h2 id="c3c9" class="lr ls jd bd lt lu lv dn lw lx ly dp lz kl ma mb mc kp md me mf kt mg mh mi mj bi translated">æ­¥éª¤ 3-è·å–æ–‡ä»¶å</h2><p id="1f1b" class="pw-post-body-paragraph ka kb jd kc b kd mk kf kg kh ml kj kk kl mm kn ko kp mn kr ks kt mo kv kw kx ig bi translated">ä¸ºäº†ä» URL ä¸­æå–æ–‡ä»¶åï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåä¸º get_file_name çš„ç‹¬ç«‹å‡½æ•°ï¼Œå¹¶å°† URL ä¼ é€’ç»™å®ƒã€‚</p><pre class="mq mr ms mt gt mu lb mv mw aw mx bi"><span id="94ce" class="lr ls jd lb b gy my mz l na nb">file_name = get_file_name(uri)</span></pre><p id="f7f1" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">è¿™ä¸ªå‡½æ•°é¦–å…ˆå°† URL å­—ç¬¦ä¸²åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œå¹¶ç”¨æ–œçº¿åˆ†å¼€ã€‚<br/>rsplit çš„è¯­æ³•</p><blockquote class="nd ne nf"><p id="bf86" class="ka kb mp kc b kd ke kf kg kh ki kj kk ng km kn ko nh kq kr ks ni ku kv kw kx ig bi translated"><em class="jd">å­—ç¬¦ä¸²</em>ã€‚rsplit( <em class="jd">åˆ†éš”ç¬¦ï¼Œæœ€å¤§æ‹†åˆ†</em>)</p></blockquote><pre class="mq mr ms mt gt mu lb mv mw aw mx bi"><span id="03f4" class="lr ls jd lb b gy my mz l na nb">def get_file_name(url):<br/>    li = url.rsplit("/",1)[1]<br/>    file_name = li.split(".")[0]<br/>    return file_name</span></pre><p id="b4a1" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">rsplit çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ–œæ ï¼Œè¿™æ„å‘³ç€å®ƒå¿…é¡»æ ¹æ®æ‰¾åˆ°æ–œæ çš„æ—¶é—´è¿›è¡Œæ‹†åˆ†ï¼Œæˆ‘ä»¬åªæ˜¯å¯¹å­—ç¬¦ä¸²çš„æœ€åä¸€éƒ¨åˆ†æ„Ÿå…´è¶£ï¼Œä»¥è·å¾—æ–‡ä»¶åï¼Œå› æ­¤æˆ‘ä»¬å°†å®ƒæ‹†åˆ†ä¸ºä¸¤éƒ¨åˆ†ã€‚è¿™ç§æ‹†åˆ†çš„ç»“æœå°†å­˜å‚¨åœ¨ä¸€ä¸ªåˆ—è¡¨ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä»è¿™ä¸ªåˆ—è¡¨ä¸­å–å‡ºç¬¬äºŒä¸ªå…ƒç´ ã€‚<br/>ç¬¬ä¸€é˜¶æ®µåçš„è¾“å‡ºä¸º</p><pre class="mq mr ms mt gt mu lb mv mw aw mx bi"><span id="29e9" class="lr ls jd lb b gy my mz l na nb"><a class="ae ja" href="https://divvy-tripdata.s3.amazonaws.com/Divvy_Trips_2018_Q4.zip'" rel="noopener ugc nofollow" target="_blank">Divvy_Trips_2018_Q4.zip</a></span></pre><p id="eb4f" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">æˆ‘ä»¬è¿˜åˆ é™¤äº†ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å†æ¬¡æ ¹æ®ç‚¹åˆ†éš”ç¬¦åˆ†å‰²è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶è¿”å›æ–‡ä»¶åã€‚</p><h2 id="fa77" class="lr ls jd bd lt lu lv dn lw lx ly dp lz kl ma mb mc kp md me mf kt mg mh mi mj bi translated">æ­¥éª¤ 4 â€”å°† csv æ–‡ä»¶å†™å…¥æœ¬åœ°</h2><p id="fed7" class="pw-post-body-paragraph ka kb jd kc b kd mk kf kg kh ml kj kk kl mm kn ko kp mn kr ks kt mo kv kw kx ig bi translated">ä¸ºäº†åœ¨æœ¬åœ°å†™å†…å®¹ï¼Œæˆ‘ä»¬ä½¿ç”¨ open æ–¹æ³•ï¼Œå…¶ä¸­æˆ‘ä»¬æŒ‡å®šç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºæ–‡ä»¶åï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ¨¡å¼ã€‚è¿™é‡Œï¼Œâ€œwâ€ä»£è¡¨å†™å…¥ï¼Œâ€œbâ€ä»£è¡¨å­—èŠ‚ã€‚</p><pre class="mq mr ms mt gt mu lb mv mw aw mx bi"><span id="dcc4" class="lr ls jd lb b gy my mz l na nb">open(file_name+'.zip','wb').write(response.content)</span></pre><h2 id="d4b7" class="lr ls jd bd lt lu lv dn lw lx ly dp lz kl ma mb mc kp md me mf kt mg mh mi mj bi translated">æ­¥éª¤ 5 â€”ä» zip æ–‡ä»¶ä¸­æå– CSV æ–‡ä»¶</h2><p id="f14c" class="pw-post-body-paragraph ka kb jd kc b kd mk kf kg kh ml kj kk kl mm kn ko kp mn kr ks kt mo kv kw kx ig bi translated">Python æä¾›äº†ä¸€ä¸ª<strong class="kc je"> zipfile </strong>æ¨¡å—ã€‚</p><p id="b252" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc je"> zipfile </strong>æ¨¡å—å…·æœ‰æ ¹æ®æ¡ä»¶è§£å‹å•ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶çš„å…¨éƒ¨åŠŸèƒ½ã€‚</p><p id="287c" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">æˆ‘ä»¬é¦–å…ˆè·å– zip å¯¹è±¡ä¸­æ‰€æœ‰æ–‡ä»¶åçš„åˆ—è¡¨ï¼Œå¹¶å¾ªç¯æ¯ä¸ªæ–‡ä»¶åã€‚<br/>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ£€æŸ¥æ–‡ä»¶åæ˜¯å¦ä»¥'ç»“å°¾ã€‚csv 'æ‰©å±•åï¼Œå¦‚æœæ˜¯ï¼Œæˆ‘ä»¬æå–è¯¥æ–‡ä»¶ã€‚</p><pre class="mq mr ms mt gt mu lb mv mw aw mx bi"><span id="3713" class="lr ls jd lb b gy my mz l na nb">with ZipFile(file_name+'.zip', 'r') as zipObject:<br/>           listOfFileNames = zipObject.namelist()<br/>           for fileName in listOfFileNames:<br/>               if fileName.endswith('.csv'):<br/>                   # Extract a single file from zip<br/>                   zipObject.extract(file_name+'.csv')</span></pre><h2 id="d743" class="lr ls jd bd lt lu lv dn lw lx ly dp lz kl ma mb mc kp md me mf kt mg mh mi mj bi translated">ç¬¬ 6 æ­¥â€”åˆ é™¤ zip</h2><p id="879f" class="pw-post-body-paragraph ka kb jd kc b kd mk kf kg kh ml kj kk kl mm kn ko kp mn kr ks kt mo kv kw kx ig bi translated">æœ€åï¼Œæˆ‘ä»¬é€šè¿‡ä½¿ç”¨ remove å‡½æ•°åˆ é™¤æ‰€æœ‰ zip æ–‡ä»¶æ¥æ¸…ç†æœ¬åœ°æ–‡ä»¶ã€‚</p><pre class="mq mr ms mt gt mu lb mv mw aw mx bi"><span id="4dff" class="lr ls jd lb b gy my mz l na nb">if os.path.exists(file_name+'.zip'):<br/>        os.remove(file_name+'.zip')</span></pre><h2 id="8378" class="lr ls jd bd lt lu lv dn lw lx ly dp lz kl ma mb mc kp md me mf kt mg mh mi mj bi translated">å®Œæ•´çš„ä»£ç â€”</h2><pre class="mq mr ms mt gt mu lb mv mw aw mx bi"><span id="132c" class="lr ls jd lb b gy my mz l na nb">import requests<br/>import os<br/>from zipfile import ZipFile</span><span id="9db7" class="lr ls jd lb b gy nc mz l na nb">download_uris = [<br/>    '<a class="ae ja" href="https://divvy-tripdata.s3.amazonaws.com/Divvy_Trips_2018_Q4.zip'" rel="noopener ugc nofollow" target="_blank">https://divvy-tripdata.s3.amazonaws.com/Divvy_Trips_2018_Q4.zip'</a>,<br/>    '<a class="ae ja" href="https://divvy-tripdata.s3.amazonaws.com/Divvy_Trips_2019_Q1.zip'" rel="noopener ugc nofollow" target="_blank">https://divvy-tripdata.s3.amazonaws.com/Divvy_Trips_2019_Q1.zip'</a>,<br/>    '<a class="ae ja" href="https://divvy-tripdata.s3.amazonaws.com/Divvy_Trips_2019_Q2.zip'" rel="noopener ugc nofollow" target="_blank">https://divvy-tripdata.s3.amazonaws.com/Divvy_Trips_2019_Q2.zip'</a>,<br/>    '<a class="ae ja" href="https://divvy-tripdata.s3.amazonaws.com/Divvy_Trips_2019_Q3.zip'" rel="noopener ugc nofollow" target="_blank">https://divvy-tripdata.s3.amazonaws.com/Divvy_Trips_2019_Q3.zip'</a>,<br/>    '<a class="ae ja" href="https://divvy-tripdata.s3.amazonaws.com/Divvy_Trips_2019_Q4.zip'" rel="noopener ugc nofollow" target="_blank">https://divvy-tripdata.s3.amazonaws.com/Divvy_Trips_2019_Q4.zip'</a>,<br/>    '<a class="ae ja" href="https://divvy-tripdata.s3.amazonaws.com/Divvy_Trips_2020_Q1.zip'" rel="noopener ugc nofollow" target="_blank">https://divvy-tripdata.s3.amazonaws.com/Divvy_Trips_2020_Q1.zip'</a><br/>]</span><span id="e147" class="lr ls jd lb b gy nc mz l na nb">def get_file_name(url):<br/>    li = url.rsplit("/",1)[1]<br/>    file_name = li.split(".")[0]<br/>    return file_name</span><span id="6903" class="lr ls jd lb b gy nc mz l na nb">def main():<br/>    directory = "downloads"<br/>    os.mkdir(directory)</span><span id="eaa3" class="lr ls jd lb b gy nc mz l na nb">    os.chdir(directory)<br/>    for uri in download_uris:<br/>        response = requests.get(uri)</span><span id="4e61" class="lr ls jd lb b gy nc mz l na nb">        file_name = get_file_name(uri)</span><span id="18c9" class="lr ls jd lb b gy nc mz l na nb">        open(file_name+'.zip','wb').write(response.content)</span><span id="c7d0" class="lr ls jd lb b gy nc mz l na nb">        with ZipFile(file_name+'.zip', 'r') as zipObject:<br/>           listOfFileNames = zipObject.namelist()<br/>           for fileName in listOfFileNames:<br/>               if fileName.endswith('.csv'):<br/>                   zipObject.extract(file_name+'.csv')<br/>        <br/>        if os.path.exists(file_name+'.zip'):<br/>            os.remove(file_name+'.zip')<br/></span><span id="31df" class="lr ls jd lb b gy nc mz l na nb">if __name__ == '__main__':<br/>    main()</span></pre><h2 id="66d9" class="lr ls jd bd lt lu lv dn lw lx ly dp lz kl ma mb mc kp md me mf kt mg mh mi mj bi translated">ç»“è®º</h2><p id="fe9a" class="pw-post-body-paragraph ka kb jd kc b kd mk kf kg kh ml kj kk kl mm kn ko kp mn kr ks kt mo kv kw kx ig bi translated">æˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨ Python ä¸­çš„è¯·æ±‚åº“ï¼Œå¹¶ä½¿ç”¨ get æ–¹æ³•è·å–ç»™å®š URL çš„å†…å®¹ã€‚æˆ‘ä»¬è®²è¿°äº†æ“ä½œç³»ç»Ÿæ¨¡å—çš„åŸºç¡€çŸ¥è¯†ï¼Œå®ƒå¸®åŠ©æˆ‘ä»¬æ‰§è¡Œåˆ›å»ºã€æ›´æ”¹å’Œåˆ é™¤ç›®å½•å’Œæ–‡ä»¶ç­‰ä»»åŠ¡ã€‚æˆ‘ä»¬è¿˜æåˆ°äº† python æä¾›çš„å¸®åŠ©æˆ‘ä»¬æå–æŸäº›æ–‡ä»¶çš„ zipfile æ¨¡å—ã€‚</p><p id="22a5" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">ç»ƒä¹  1 çš„å‚è€ƒé“¾æ¥</p><div class="im in gp gr io lc"><a href="https://github.com/danielbeach/data-engineering-practice/tree/main/Exercises/Exercise-1" rel="noopener  ugc nofollow" target="_blank"><div class="ld ab fo"><div class="le ab lf cl cj lg"><h2 class="bd je gy z fp lh fr fs li fu fw jc bi translated">æ•°æ®å·¥ç¨‹å®è·µ/ç»ƒä¹ /ç»ƒä¹ -1 åœ¨ä¸»ä¸¹å°¼å°”æµ·æ»©/æ•°æ®å·¥ç¨‹å®è·µ</h2><div class="lj l"><h3 class="bd b gy z fp lh fr fs li fu fw dk translated">åœ¨ç¬¬ä¸€ä¸ªç»ƒä¹ ä¸­ï¼Œæ‚¨å°†ç»ƒä¹  Python æŠ€èƒ½ï¼Œå¹¶äº†è§£ä¸€ä¸ªéå¸¸å¸¸è§çš„ä»»åŠ¡...æ­£åœ¨ä¸‹è½½â€¦</h3></div><div class="lk l"><p class="bd b dl z fp lh fr fs li fu fw dk translated">github.com</p></div></div><div class="ll l"><div class="nj l ln lo lp ll lq iu lc"/></div></div></a></div><p id="0664" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">æ•°æ®å·¥ç¨‹å®è·µâ€”ç¬¬äºŒéƒ¨åˆ†â€”<a class="ae ja" href="https://medium.com/@sameekshabhatia6/data-engineering-practice-ii-webscraping-and-file-downloading-with-python-cc2b89554d0f" rel="noopener">https://medium . com/@ sameekshabhatia 6/data-Engineering-practice-ii-web scraping-and-file-download-with-python-cc2b 89554 d0f</a></p><p id="dcad" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">è°¢è°¢ğŸ‘‹ğŸ»</p></div></div>    
</body>
</html>