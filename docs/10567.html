<html>
<head>
<title>#6 Deployment of all services</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">#6 所有服务的部署</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/6-deployment-of-all-services-1b87eb1072f2?source=collection_archive---------10-----------------------#2022-11-11">https://blog.devgenius.io/6-deployment-of-all-services-1b87eb1072f2?source=collection_archive---------10-----------------------#2022-11-11</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="1101" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">本内容面向那些对 REST 和 GraphQL 有基本了解的工程师。我们将陆续公布以下内容。</p><p id="db7d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"># 1<a class="ae ki" href="https://medium.com/@sofikul.m/design-my-todos-project-with-graphql-rest-microservices-482cffc7729b" rel="noopener">my-todos 项目设计</a></p><p id="49f7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae ki" href="https://medium.com/@sofikul.m/coding-graphql-services-eafd9235fdf7" rel="noopener"> #2 编码 GraphQL 服务(我们在此发帖)</a></p><p id="1970" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae ki" href="https://medium.com/@sofikul.m/6894d6f40ac0" rel="noopener"> #3 GraphQL 服务认证和授权</a></p><p id="a58c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae ki" href="https://medium.com/@sofikul.m/coding-graphql-gateway-service-b8516d4052d4" rel="noopener"> #4 编码 GraphQL 网关服务</a></p><p id="5968" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae ki" href="https://medium.com/@sofikul.m/coding-my-todos-web-to-consume-graphql-service-1e78302e7a04" rel="noopener"> #5 使用 Nuxt 对 my-todos web 进行编码</a></p><p id="0b90" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> <em class="kj"> #6 部署所有服务(你现在正在看这篇文章)</em> </strong></p></div><div class="ab cl kk kl hr km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="ig ih ii ij ik"><h1 id="c18f" class="kr ks in bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">我们要在这里讨论什么？</h1><p id="7a37" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv lr jx jy jz ls kb kc kd lt kf kg kh ig bi translated">由于我们已经在本地准备好了我们的服务，现在是时候在云中部署它们了。我们将使用<a class="ae ki" href="https://www.heroku.com" rel="noopener ugc nofollow" target="_blank"> heroku </a>云进行部署。</p><h1 id="b2da" class="kr ks in bd kt ku lu kw kx ky lv la lb lc lw le lf lg lx li lj lk ly lm ln lo bi translated">部署步骤</h1><p id="1e14" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv lr jx jy jz ls kb kc kd lt kf kg kh ig bi translated">我们需要执行以下步骤来将我们的 GraphQL 服务器部署到 heroku。</p><ul class=""><li id="ae6f" class="lz ma in jm b jn jo jr js jv mb jz mc kd md kh me mf mg mh bi translated">添加<code class="fe mi mj mk ml b">Procfile</code></li><li id="c5e8" class="lz ma in jm b jn mm jr mn jv mo jz mp kd mq kh me mf mg mh bi translated">将代码推送到 Github</li><li id="5e94" class="lz ma in jm b jn mm jr mn jv mo jz mp kd mq kh me mf mg mh bi translated">安装 Heroku CLI</li><li id="f35d" class="lz ma in jm b jn mm jr mn jv mo jz mp kd mq kh me mf mg mh bi translated">登录 Heroku</li><li id="345d" class="lz ma in jm b jn mm jr mn jv mo jz mp kd mq kh me mf mg mh bi translated">创建应用程序</li><li id="dbab" class="lz ma in jm b jn mm jr mn jv mo jz mp kd mq kh me mf mg mh bi translated">添加环境变量和数据库</li><li id="53fc" class="lz ma in jm b jn mm jr mn jv mo jz mp kd mq kh me mf mg mh bi translated">部署我们的应用并设置持续部署</li><li id="e0ae" class="lz ma in jm b jn mm jr mn jv mo jz mp kd mq kh me mf mg mh bi translated">试验</li></ul><h2 id="5bd7" class="mr ks in bd kt ms mt dn kx mu mv dp lb jv mw mx lf jz my mz lj kd na nb ln nc bi translated">添加 Procfile</h2><p id="b174" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv lr jx jy jz ls kb kc kd lt kf kg kh ig bi translated">这个文件包含启动服务器的命令。在我们的例子中，它包含以下内容。</p><pre class="nd ne nf ng gt nh ml ni bn nj nk bi"><span id="fab0" class="nl ks in ml b be nm nn l no np">npm start</span></pre><h2 id="1107" class="mr ks in bd kt ms mt dn kx mu mv dp lb jv mw mx lf jz my mz lj kd na nb ln nc bi translated">将代码推送到 Github</h2><p id="f171" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv lr jx jy jz ls kb kc kd lt kf kg kh ig bi translated">在进行部署之前，您应该在 Github <code class="fe mi mj mk ml b">develop</code>分支中推送您的代码。</p><h2 id="5b8e" class="mr ks in bd kt ms mt dn kx mu mv dp lb jv mw mx lf jz my mz lj kd na nb ln nc bi translated">安装 Heroku CLI</h2><p id="cd43" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv lr jx jy jz ls kb kc kd lt kf kg kh ig bi translated">让我们先在 Heroku 上创建一个账户。在终端中打开您的项目(如果您还没有这样做),然后运行下面的命令。</p><pre class="nd ne nf ng gt nh ml ni bn nj nk bi"><span id="9c76" class="nl ks in ml b be nm nn l no np">npm install heroku</span></pre><h2 id="e037" class="mr ks in bd kt ms mt dn kx mu mv dp lb jv mw mx lf jz my mz lj kd na nb ln nc bi translated">登录 heroku</h2><pre class="nd ne nf ng gt nh ml ni bn nj nk bi"><span id="a98e" class="nl ks in ml b be nm nn l no np">heroku login</span></pre><h2 id="2fc0" class="mr ks in bd kt ms mt dn kx mu mv dp lb jv mw mx lf jz my mz lj kd na nb ln nc bi translated">创建应用程序</h2><pre class="nd ne nf ng gt nh ml ni bn nj nk bi"><span id="da51" class="nl ks in ml b be nm nn l no np">heroku create my-todos-web-gql</span></pre><h2 id="bd37" class="mr ks in bd kt ms mt dn kx mu mv dp lb jv mw mx lf jz my mz lj kd na nb ln nc bi translated">添加环境变量和数据库</h2><p id="9b59" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv lr jx jy jz ls kb kc kd lt kf kg kh ig bi translated">现在打开你的<a class="ae ki" href="https://id.heroku.com/login" rel="noopener ugc nofollow" target="_blank"> heroku </a>仪表盘，进入你的浏览器。您应该会看到您已经创建的应用程序。</p><figure class="nd ne nf ng gt nr gh gi paragraph-image"><div role="button" tabindex="0" class="ns nt di nu bf nv"><div class="gh gi nq"><img src="../Images/538baf532e374df192c43f1564b4e10a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rJBKW992EAApuOcZ3cOUfg.png"/></div></div></figure><p id="4c8c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你能看到，哇🎉！</p><p id="3d12" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在让我们添加 heroku 应用程序配置变量。环境文件。点击应用程序，进入<code class="fe mi mj mk ml b">Settings</code>选项卡。</p><figure class="nd ne nf ng gt nr gh gi paragraph-image"><div role="button" tabindex="0" class="ns nt di nu bf nv"><div class="gh gi ny"><img src="../Images/a8c8682d62721b763bd3c2f91bd1b4bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mPupQyVwnlzVtOG3FAwukw.png"/></div></div></figure><p id="f105" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你正在使用 MongoDB，那么你可以在配置变量 MONGODB_URI 下提供 MongoDB 托管的 url，并在你的代码中使用它作为 process.env.MONGODB_URI。对于 MongoDB 托管，你可以使用<a class="ae ki" href="https://www.mongodb.com/cloud/atlas/lp/dcp?utm_content=rlsapostreg&amp;utm_source=google&amp;utm_campaign=search_gs_pl_evergreen_atlas_general_retarget-brand-postreg_gic-null_apac-all_ps-all_desktop_eng_lead&amp;utm_term=&amp;utm_medium=cpc_paid_search&amp;utm_ad=&amp;utm_ad_campaign_id=14412646494&amp;adgroup=131761134852&amp;gclid=Cj0KCQiAgribBhDkARIsAASA5bvyTu8nqqxhr2K3jNrFgFbH2xCscN3Lb2ATIlz7IV_Ywj6jvWDmJRsaArhsEALw_wcB" rel="noopener ugc nofollow" target="_blank"> Mongo Atlas </a>。</p><h2 id="e478" class="mr ks in bd kt ms mt dn kx mu mv dp lb jv mw mx lf jz my mz lj kd na nb ln nc bi translated">部署我们的应用并设置持续部署</h2><p id="fc7b" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv lr jx jy jz ls kb kc kd lt kf kg kh ig bi translated">现在点击<code class="fe mi mj mk ml b">Deploy</code>选项卡。选择<code class="fe mi mj mk ml b">Deployment method</code>下的<code class="fe mi mj mk ml b">Github</code>，选择您的回购和分行。当您在指定的分支中推送代码时，点击<code class="fe mi mj mk ml b">Automatic deploy</code>以启用下一次部署。</p><figure class="nd ne nf ng gt nr gh gi paragraph-image"><div role="button" tabindex="0" class="ns nt di nu bf nv"><div class="gh gi nz"><img src="../Images/9c0d7700602f4ebd6afb0dccdf120365.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-IxsZdi9KE-E-OhrW7ZT9Q.png"/></div></div></figure><p id="d03b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">点击<code class="fe mi mj mk ml b">Deploy Branch</code>开始手动部署。</p><figure class="nd ne nf ng gt nr gh gi paragraph-image"><div role="button" tabindex="0" class="ns nt di nu bf nv"><div class="gh gi oa"><img src="../Images/716ce51c9da32b550e699c4bcf0c91f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5jWE_Du47UDDddKXOE9z7w.png"/></div></div></figure><p id="28f9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在你有一个按钮告诉你在构建完成后选择<code class="fe mi mj mk ml b">view site</code>。点击它。这将在一个新标签页中打开你的应用。</p><h2 id="934a" class="mr ks in bd kt ms mt dn kx mu mv dp lb jv mw mx lf jz my mz lj kd na nb ln nc bi translated">试验</h2><p id="5b4b" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv lr jx jy jz ls kb kc kd lt kf kg kh ig bi translated">从<code class="fe mi mj mk ml b">Settings</code>选项卡中，您将获得服务的 URL。</p><figure class="nd ne nf ng gt nr gh gi paragraph-image"><div role="button" tabindex="0" class="ns nt di nu bf nv"><div class="gh gi ob"><img src="../Images/5151fa9a709776408a3c2b813dce48da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gWQPWgYwtfbRnz3bI8e7Yg.png"/></div></div></figure><p id="b735" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你点击这个，它将打开 GraphQL 游乐场。</p><figure class="nd ne nf ng gt nr gh gi paragraph-image"><div role="button" tabindex="0" class="ns nt di nu bf nv"><div class="gh gi oc"><img src="../Images/37b6691590a59652ba8312393ddd5833.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kw6HgGfYL4U3qqVj8pZW4A.png"/></div></div></figure><h1 id="d37c" class="kr ks in bd kt ku lu kw kx ky lv la lb lc lw le lf lg lx li lj lk ly lm ln lo bi translated">下一步是什么💁</h1><p id="24ed" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv lr jx jy jz ls kb kc kd lt kf kg kh ig bi translated">我们已经完成了我们承诺的所有六个条款。庆祝你的学习和成就🎉。现在你可以用现实生活项目弄脏你的手了，我要睡觉了😎。</p><blockquote class="od"><p id="9fcd" class="oe of in bd og oh oi oj ok ol om kh dk translated">继续学习！</p></blockquote></div></div>    
</body>
</html>