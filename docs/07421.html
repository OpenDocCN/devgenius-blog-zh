<html>
<head>
<title>React + Vite + Tailwind CSS+ twin.macro + storybook + svg imports as React Component.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React+Vite+Tailwind CSS+twin . macro+story book+SVG 作为 React 组件导入。</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/react-vite-tailwind-css-twin-macro-storybook-svg-imports-as-react-component-6b44d5e2641?source=collection_archive---------0-----------------------#2022-03-24">https://blog.devgenius.io/react-vite-tailwind-css-twin-macro-storybook-svg-imports-as-react-component-6b44d5e2641?source=collection_archive---------0-----------------------#2022-03-24</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/7574c095e282cad9ffb847a79ec5e7e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fCWdQ-VnhBOhWxuwENf4Dg.png"/></div></div></figure></div><div class="ab cl jv jw hr jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="ig ih ii ij ik"><p id="ec35" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated"><a class="ae la" href="https://vitejs.dev/" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> Vite </strong> </a>是新一代 JavaScript 构建工具，旨在改善 Webpack 的开发者在构建 JavaScript 应用时的体验。</p><p id="bd5e" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">像 Webpack 这样的基于 bundler 的工作流必须在单个浏览器请求之前处理整个 JavaScript 模块，而 Vite 只在单个浏览器请求之前处理依赖模块。当您的应用程序需要时，您的应用程序模块将由 Vite 进行转换和服务。这就是为什么 Vite 能够比 Webpack 更快地处理您的开发构建。</p><p id="e662" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">我有一个 react 应用程序，它包含故事书、twin.macro、tailwind 和使用 React 脚本的 story book。关于如何将这样的应用程序迁移到 Vite，没有一个单一的信息。以下是步骤</p></div><div class="ab cl jv jw hr jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="ig ih ii ij ik"><ol class=""><li id="44db" class="lb lc in ke b kf kg kj kk kn ld kr le kv lf kz lg lh li lj bi translated">从 package.json 中删除 react-scripts 并安装</li></ol><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="aa5a" class="lt lu in lp b gy lv lw l lx ly">npm install vite -D<br/>npm install <!-- -->@vitejs/plugin-react</span></pre><p id="fdd8" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">2.移除与 react-scripts 相关的包 json 脚本并添加 Vite 脚本</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="d86d" class="lt lu in lp b gy lv lw l lx ly">"scripts": {<br/>-    "start": "react-scripts start",<br/>-    "build": "react-scripts build",<br/>-    "test": "react-scripts test",<br/>-    "eject": "react-scripts eject"<br/>+    "start": "vite",<br/>+    "build": "vite build",<br/>+    "preview": vite preview"<br/>     }</span></pre><p id="d939" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">3.<a class="ae la" href="https://github.com/vitejs/vite/issues/769#issuecomment-780593283" rel="noopener ugc nofollow" target="_blank">将包含 JSX 的</a>文件从<code class="fe lz ma mb lp b">*.js</code>重命名为<code class="fe lz ma mb lp b">*.jsx</code>。</p><p id="ec44" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">我不需要这样做，因为我所有的文件都是. tsx。</p><p id="b6e4" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">4.<a class="ae la" href="https://vitejs.dev/guide/#index-html-and-project-root" rel="noopener ugc nofollow" target="_blank">将</a> <code class="fe lz ma mb lp b">public/index.html</code>移动到<code class="fe lz ma mb lp b">index.html</code>(项目根文件夹)。</p><p id="ebe2" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">5.从<code class="fe lz ma mb lp b">index.html</code>上移除<code class="fe lz ma mb lp b">%PUBLIC_URL%</code>:</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="6e0e" class="lt lu in lp b gy lv lw l lx ly">-  &lt;link rel="icon" href="%PUBLIC_URL%/favicon.ico" /&gt;<br/>+  &lt;link rel="icon" href="/favicon.ico" /&gt;<br/>-  &lt;link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" /&gt;<br/>+  &lt;link rel="apple-touch-icon" href="/logo192.png" /&gt;<br/>-  &lt;link rel="manifest" href="%PUBLIC_URL%/manifest.json" /&gt;<br/>+  &lt;link rel="manifest" href="/manifest.json" /&gt;</span></pre><p id="b9e1" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">6.在<code class="fe lz ma mb lp b">index.html</code>中添加入口点:</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="f037" class="lt lu in lp b gy lv lw l lx ly">  &lt;noscript&gt;You need to enable JavaScript to run app.&lt;/noscript&gt;<br/>  &lt;div id="root"&gt;&lt;/div&gt;<br/>+ &lt;script type="module" src="/src/index.jsx"&gt;&lt;/script&gt;</span></pre><p id="2e1d" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">7.添加一个<code class="fe lz ma mb lp b">vite.config.js</code>文件</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="6565" class="lt lu in lp b gy lv lw l lx ly">import { defineConfig } from 'vite';<br/>import react from '@vitejs/plugin-react';<br/><br/>export default defineConfig({<br/>  plugins: [react()],<br/>}</span></pre><p id="b5a6" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">至此，您可以从 Vite 文档或其他媒体文章中获得信息。现在当你跑的时候</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="9689" class="lt lu in lp b gy lv lw l lx ly">npm start</span></pre><p id="7739" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">Vite dev 服务器运行在<a class="ae la" href="http://localhost:3000," rel="noopener ugc nofollow" target="_blank"> http://localhost:3000，</a>但是 UI 没有呈现。我将列出所有故障以及我是如何解决的。</p><h1 id="a367" class="mc lu in bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">失败和解决方案</h1><ol class=""><li id="7033" class="lb lc in ke b kf mz kj na kn nb kr nc kv nd kz lg lh li lj bi translated">Svg 图标错误</li></ol><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="6a96" class="lt lu in lp b gy lv lw l lx ly">Uncaught SyntaxError: The requested module '/src/Icons/logo.svg?import' does not provide an export named 'ReactComponent'</span></pre><p id="41fc" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">我已经将 svg 文件作为 ReactComponent 导入到我的组件中。React scripts 内置了<code class="fe lz ma mb lp b"><a class="ae la" href="https://github.com/gregberge/svgr" rel="noopener ugc nofollow" target="_blank">svgr</a></code>，可以将 SVG 转换成随时可用的组件，这是 Vite 所没有的。</p><h2 id="c47a" class="lt lu in bd md ne nf dn mh ng nh dp ml kn ni nj mp kr nk nl mt kv nm nn mx no bi translated">分辨率:</h2><p id="f10b" class="pw-post-body-paragraph kc kd in ke b kf mz kh ki kj na kl km kn np kp kq kr nq kt ku kv nr kx ky kz ig bi translated">安装<a class="ae la" href="https://www.npmjs.com/package/vite-plugin-svgr" rel="noopener ugc nofollow" target="_blank"> vite-plugin-svgr </a> —将 SVG 转换成 React 组件的 vite 插件。</p><p id="abb8" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">更新<code class="fe lz ma mb lp b"> vite.config.js</code>文件</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="5ad9" class="lt lu in lp b gy lv lw l lx ly">import { defineConfig } from 'vite';<br/>import react from '@vitejs/plugin-react';<br/>import svgrPlugin from 'vite-plugin-svgr';<br/><br/>export default {<br/>  plugins: [<br/>     <!-- -->react(),<!-- -->    <br/>     svgrPlugin({<br/>      svgrOptions: {<br/>        icon: true,<br/>      },<br/>    }),<br/>  ],<br/>}</span></pre><p id="851f" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">2.巴别尔误差</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="5766" class="lt lu in lp b gy lv lw l lx ly">Uncaught ReferenceError: Process is not defined</span></pre><p id="e6c4" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">在 Vite 中，他们使用<code class="fe lz ma mb lp b">import.meta.env.*</code>来访问 ENV 变量，然而，一些像 Babel 这样的库在他们的源代码中使用<code class="fe lz ma mb lp b">process.env</code>，这导致了运行时错误<code class="fe lz ma mb lp b">Uncaught ReferenceError: process is not defined</code>。</p><h2 id="59c4" class="lt lu in bd md ne nf dn mh ng nh dp ml kn ni nj mp kr nk nl mt kv nm nn mx no bi translated">分辨率:</h2><p id="3c2e" class="pw-post-body-paragraph kc kd in ke b kf mz kh ki kj na kl km kn np kp kq kr nq kt ku kv nr kx ky kz ig bi translated">安装<a class="ae la" href="https://www.npmjs.com/package/vite-plugin-env-compatible" rel="noopener ugc nofollow" target="_blank">与 vite-plugin-env 兼容的</a>。这个插件支持设置前缀如<code class="fe lz ma mb lp b">VUE_APP_</code>或<code class="fe lz ma mb lp b">REACT_APP_</code>，并加载到 process.env</p><p id="a7bb" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">更新<code class="fe lz ma mb lp b"> vite.config.js</code>文件</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="a359" class="lt lu in lp b gy lv lw l lx ly">import { defineConfig } from 'vite';<br/>import react from '@vitejs/plugin-react';<br/>import svgrPlugin from 'vite-plugin-svgr';<br/>import envCompatible from 'vite-plugin-env-compatible';</span><span id="e232" class="lt lu in lp b gy ns lw l lx ly">export default {<br/>  plugins: [<br/>     <!-- -->react(),<br/>     <!-- -->envCompatible(),   <br/>     svgrPlugin({<br/>      svgrOptions: {<br/>        icon: true,<br/>      },<br/>    }),<br/>  ],<br/>}</span></pre><p id="8f45" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">3.双宏误差</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="2660" class="lt lu in lp b gy lv lw l lx ly">Uncaught TypeError:css is not a function</span></pre><p id="2176" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">我使用过 twin.macro 中的 css，如下所示:</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="0125" class="lt lu in lp b gy lv lw l lx ly">import { css } from 'twin.macro';</span><span id="eac7" class="lt lu in lp b gy ns lw l lx ly">const aspectSquare = css`{ aspect-ratio: 1; }`;</span></pre><h2 id="f1fe" class="lt lu in bd md ne nf dn mh ng nh dp ml kn ni nj mp kr nk nl mt kv nm nn mx no bi translated">分辨率:</h2><p id="e936" class="pw-post-body-paragraph kc kd in ke b kf mz kh ki kj na kl km kn np kp kq kr nq kt ku kv nr kx ky kz ig bi translated">安装 vite-plugin-babel- <a class="ae la" href="https://www.npmjs.com/package/vite-plugin-babel-macros" rel="noopener ugc nofollow" target="_blank">宏</a>。这个插件支持<a class="ae la" href="https://vitejs.dev/" rel="noopener ugc nofollow" target="_blank"> Vite </a>项目中的<a class="ae la" href="https://github.com/kentcdodds/babel-plugin-macros" rel="noopener ugc nofollow" target="_blank">巴别塔宏</a>。</p><p id="b4de" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">更新<code class="fe lz ma mb lp b">vite.config.js</code>文件</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="5675" class="lt lu in lp b gy lv lw l lx ly">import { defineConfig } from 'vite';<br/>import react from '@vitejs/plugin-react';<br/>import svgrPlugin from 'vite-plugin-svgr';<br/>import envCompatible from 'vite-plugin-env-compatible';<br/>import macrosPlugin from 'vite-plugin-babel-macros';</span><span id="a8b6" class="lt lu in lp b gy ns lw l lx ly">export default {<br/>  plugins: [<br/>     <!-- -->react(),<br/>     <!-- -->envCompatible(),<br/>     macrosPlugin(),  <br/>     svgrPlugin({<br/>      svgrOptions: {<br/>        icon: true,<br/>      },<br/>    }),<br/>  ],<br/>}</span></pre><p id="a159" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">4.没有应用顺风 Css</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="2f99" class="lt lu in lp b gy lv lw l lx ly">warn - The `content` option in your Tailwind CSS configuration is missing or empty.<br/>warn - Configure your content sources or your generated CSS will be missing styles.<br/>warn - https://tailwindcss.com/docs/content-configuration</span></pre><p id="3372" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">UI 没有出现错误，但是我的 UI 组件看起来很奇怪，因为没有应用 tailwind css。</p><h2 id="76b7" class="lt lu in bd md ne nf dn mh ng nh dp ml kn ni nj mp kr nk nl mt kv nm nn mx no bi translated">分辨率:</h2><p id="ac97" class="pw-post-body-paragraph kc kd in ke b kf mz kh ki kj na kl km kn np kp kq kr nq kt ku kv nr kx ky kz ig bi translated">安装<code class="fe lz ma mb lp b"><a class="ae la" href="https://windicss.org/integrations/vite.html" rel="noopener ugc nofollow" target="_blank">vite-plugin-windicss</a></code>。这个插件从<code class="fe lz ma mb lp b">tailwind.config.js</code>加载配置</p><p id="5384" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">更新<code class="fe lz ma mb lp b"> tailwind.config.js</code>文件</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="fd7e" class="lt lu in lp b gy lv lw l lx ly">  module.exports {<br/>  content: [<br/>+   "./index.html"<br/>    "./src/**/*.{js,jsx,ts,tsx}"<br/>    ]<br/>  }<br/>  ...</span></pre><p id="3b86" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">更新<code class="fe lz ma mb lp b"> vite.config.js</code>文件</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="87b9" class="lt lu in lp b gy lv lw l lx ly">import { defineConfig } from 'vite';<br/>import react from '@vitejs/plugin-react';<br/>import svgrPlugin from 'vite-plugin-svgr';<br/>import envCompatible from 'vite-plugin-env-compatible';<br/>import macrosPlugin from 'vite-plugin-babel-macros';<br/>import WindiCSS from 'vite-plugin-windicss'</span><span id="f132" class="lt lu in lp b gy ns lw l lx ly">export default {<br/>  plugins: [<br/>     <!-- -->react(),<br/>     <!-- -->envCompatible(),<br/>     macrosPlugin(),<br/>      <!-- -->WindiCSS(),<!-- -->     <br/>      svgrPlugin({<br/>      svgrOptions: {<br/>        icon: true,<br/>      },<br/>    }),<br/>  ],<br/>}</span></pre><p id="2b90" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">5.现在，一切看起来都很好，但我们也需要为故事书使用 vite，以保持一致。Storybook 也不适用于我现有 webpack5 builder。</p><h2 id="9f6f" class="lt lu in bd md ne nf dn mh ng nh dp ml kn ni nj mp kr nk nl mt kv nm nn mx no bi translated">分辨率:</h2><p id="2cce" class="pw-post-body-paragraph kc kd in ke b kf mz kh ki kj na kl km kn np kp kq kr nq kt ku kv nr kx ky kz ig bi translated">安装<a class="ae la" href="https://github.com/eirslett/storybook-builder-vite" rel="noopener ugc nofollow" target="_blank">故事书-构建器-邀请</a>。该插件从<code class="fe lz ma mb lp b">tailwind.config.js</code>加载配置。这允许你使用 Vite 来创建故事书。</p><p id="09f7" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">更新<code class="fe lz ma mb lp b">.storybook/main.js</code>文件</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="52f1" class="lt lu in lp b gy lv lw l lx ly">  module.exports = {<br/>      "stories": [<br/>      "../src/stories/**/*.stories.@(js|jsx|ts|tsx)"<br/>     ],<br/>  "framework": "@storybook/react",<br/>  core: {<br/>+   builder: "storybook-builder-vite"<br/>-   builder: "webpack5"<br/>   }<br/> }</span></pre><p id="7fef" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">6.故事书中的 Svg 图标错误</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="6e02" class="lt lu in lp b gy lv lw l lx ly">Uncaught SyntaxError: The requested module '/src/Icons/logo.svg?import' does not provide an export named 'ReactComponent'</span></pre><p id="feb1" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">现在 storybook-builder-vite 默认不读取<code class="fe lz ma mb lp b">vite.config.js</code>文件，这就是为什么我们得到上面的错误。</p><h2 id="c3cd" class="lt lu in bd md ne nf dn mh ng nh dp ml kn ni nj mp kr nk nl mt kv nm nn mx no bi translated">分辨率:</h2><p id="fc39" class="pw-post-body-paragraph kc kd in ke b kf mz kh ki kj na kl km kn np kp kq kr nq kt ku kv nr kx ky kz ig bi translated">在<code class="fe lz ma mb lp b">.storybook/main.js</code>中，我们需要覆盖 Vite 配置，如下所示:</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="b84c" class="lt lu in lp b gy lv lw l lx ly">const svgrPlugin = require('vite-plugin-svgr');</span><span id="64fa" class="lt lu in lp b gy ns lw l lx ly">module.exports = {<br/>  async viteFinal(config, { configType }) {<br/>    // customize the Vite config here<br/>    config.plugins = [<br/>      ...config.plugins,<br/>      svgrPlugin({<br/>        svgrOptions: {<br/>          icon: true,<br/>        },<br/>      })<br/>    ];<br/><br/>    // return the customized config<br/>    return config;<br/>  },<br/>  "stories": [<br/>      "../src/stories/**/*.stories.@(js|jsx|ts|tsx)"<br/>     ],<br/>  "framework": "@storybook/react",<br/>  core: {<br/>     builder: "storybook-builder-vite"<br/>   }<br/> }</span></pre><p id="f1f7" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">7.现在，我又在故事书里遇到了双宏错误</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="772c" class="lt lu in lp b gy lv lw l lx ly">Uncaught tw.div is not a function</span></pre><h2 id="df63" class="lt lu in bd md ne nf dn mh ng nh dp ml kn ni nj mp kr nk nl mt kv nm nn mx no bi translated">分辨率:</h2><p id="b303" class="pw-post-body-paragraph kc kd in ke b kf mz kh ki kj na kl km kn np kp kq kr nq kt ku kv nr kx ky kz ig bi translated">好了，现在我知道该怎么做了，我需要在 main.js 中添加 babel 宏和 tailwind vite 插件</p><p id="ebb5" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">更新<code class="fe lz ma mb lp b">.storybook/main.js</code>文件</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="e8e9" class="lt lu in lp b gy lv lw l lx ly">const svgrPlugin = require('vite-plugin-svgr');<br/>const macrosPlugin = require('vite-plugin-babel-macros)';<br/>const WindiCSS <!-- -->= require(<!-- -->'vite-plugin-windicss)'</span><span id="ecc3" class="lt lu in lp b gy ns lw l lx ly">module.exports = {<br/>  async viteFinal(config, { configType }) {<br/>    // customize the Vite config here<br/>    config.plugins = [<br/>      ...config.plugins,<br/>      macrosPlugin(),<br/>      <!-- -->WindiCSS(),<br/>      <!-- -->svgrPlugin({<br/>        svgrOptions: {<br/>          icon: true,<br/>        },<br/>      })<br/>    ];<br/><br/>    // return the customized config<br/>    return config;<br/>  },<br/>  "stories": [<br/>      "../src/stories/**/*.stories.@(js|jsx|ts|tsx)"<br/>     ],<br/>  "framework": "@storybook/react",<br/>  core: {<br/>     builder: "storybook-builder-vite"<br/>   }<br/> }</span></pre><p id="436d" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">7.故事书中的插件错误</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="8a41" class="lt lu in lp b gy lv lw l lx ly">TypeError: macrosPlugin is not a function.</span></pre><h2 id="7d91" class="lt lu in bd md ne nf dn mh ng nh dp ml kn ni nj mp kr nk nl mt kv nm nn mx no bi translated">分辨率:</h2><p id="b3b1" class="pw-post-body-paragraph kc kd in ke b kf mz kh ki kj na kl km kn np kp kq kr nq kt ku kv nr kx ky kz ig bi translated">出于某种原因，当使用“require”时，vite-plugin-babel-macros 和 vite-plugin-windicss 的默认值都显示为<code class="fe lz ma mb lp b">.default</code>。所以，我需要打电话。<code class="fe lz ma mb lp b">default()</code>。</p><p id="f5cd" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">更新<code class="fe lz ma mb lp b">.storybook/main.js</code>文件</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="6571" class="lt lu in lp b gy lv lw l lx ly">const svgrPlugin = require('vite-plugin-svgr');<br/>const macrosPlugin = require('vite-plugin-babel-macros)';<br/>const WindiCSS <!-- -->= require(<!-- -->'vite-plugin-windicss)'</span><span id="e3dd" class="lt lu in lp b gy ns lw l lx ly">module.exports = {<br/>  async viteFinal(config, { configType }) {<br/>    // customize the Vite config here<br/>    config.plugins = [<br/>      ...config.plugins,<br/>      macrosPlugin.default(),<br/>      <!-- -->WindiCSS<!-- -->.default<!-- -->(),<br/>      <!-- -->svgrPlugin({<br/>        svgrOptions: {<br/>          icon: true,<br/>        },<br/>      })<br/>    ];<br/><br/>    // return the customized config<br/>    return config;<br/>  },<br/>  "stories": [<br/>      "../src/stories/**/*.stories.@(js|jsx|ts|tsx)"<br/>     ],<br/>  "framework": "@storybook/react",<br/>  core: {<br/>     builder: "storybook-builder-vite"<br/>   }<br/> }</span></pre></div><div class="ab cl jv jw hr jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="ig ih ii ij ik"><p id="eef0" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">最后，故事书和本地开发服务器在所有这些变化之后都工作了。希望这对那些想转用 Vite 的人有所帮助。</p></div></div>    
</body>
</html>