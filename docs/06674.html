<html>
<head>
<title>Building a News App with Django and Newsapi</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Django 和 Newsapi 构建新闻应用</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/building-a-news-app-using-newsapi-and-django-fc09617dbbd5?source=collection_archive---------15-----------------------#2022-01-24">https://blog.devgenius.io/building-a-news-app-using-newsapi-and-django-fc09617dbbd5?source=collection_archive---------15-----------------------#2022-01-24</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/55c852b5e7996b11386c08525e458b93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Tz-1ebKQOHFHrY8c"/></div></div></figure><p id="b673" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">本文将展示如何使用 Django 和新闻 API 构建一个简单的新闻应用程序。该项目很容易，对于 Django 和 python 来说是一个很好的初学者项目。</p><p id="af69" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们将使用 newsapi 来显示不同类别的最新新闻。我们可以从不同的来源获取头条新闻，这个项目将使用 Django 获取新闻标题以及链接并显示出来，这样我们就可以点击链接阅读完整的故事。</p><p id="bf45" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">1/确保有一个新文件夹来存储这个项目。我们需要建立一个环境，这样我们就可以在其中安装我们项目的包。在项目文件夹内的终端中运行以下命令。</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="6289" class="lc ld in ky b gy le lf l lg lh">$ python -m venv env <br/>$ env\Scripts\activate</span></pre><p id="98a5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">2/安装 django 和 newsapi 包</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="e50c" class="lc ld in ky b gy le lf l lg lh">$ pip install django <br/>$ pip install newsapi-python</span></pre><p id="8061" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">3/现在我们将创建我们的项目:</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="64d2" class="lc ld in ky b gy le lf l lg lh">$ django-admin startproject news</span></pre><p id="6e67" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">4/ cd 到新闻目录。使用以下命令创建 newsapp:</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="4396" class="lc ld in ky b gy le lf l lg lh">$ python manage.py startapp newsapp</span></pre><ul class=""><li id="57a0" class="li lj in jx b jy jz kc kd kg lk kk ll ko lm ks ln lo lp lq bi translated">将此应用添加到<a class="ae lr" href="http://settings.py" rel="noopener ugc nofollow" target="_blank"> settings.py </a>中的 INSTALLED_APPS 列表</li></ul><p id="0004" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">5/尝试运行本地服务器，检查它是否正在运行:</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="54d2" class="lc ld in ky b gy le lf l lg lh">$ python manage.py runserver</span></pre><p id="568e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这将在<a class="ae lr" href="http://127.0.0.1:8000/," rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">运行我们的 app http://127 . 0 . 0 . 1:8000/</strong>，</a>在浏览器中查看。</p><p id="9eaf" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">6/从<a class="ae lr" href="https://newsapi.org/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io">newsapi.org</strong></a>处获取 apiKey。我们可以用这个键来检索新闻数据。</p><p id="e606" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">7/通过打开<a class="ae lr" href="http://views.py" rel="noopener ugc nofollow" target="_blank"> views.py </a>文件为应用程序创建视图。在视图中，我们将定义一个请求 web 响应的函数。响应将是一个 json 文件，因此我们需要从中提取所需的数据，并将其呈现为一个 html 文件。代码将类似于:</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="3f2b" class="lc ld in ky b gy le lf l lg lh">from django.shortcuts import render<br/>from newsapi import NewsApiClient <br/><br/># Create your views here.<br/>def home(request):<br/>    newsapi = NewsApiClient(api_key='yourapikey')<br/>    topnews = newsapi.get_top_headlines('cnn')   # source=ndtv, bbc-news, cnn,techcrunch,foxnews.<br/><br/>    latest = topnews['articles']<br/>    print(topnews)<br/>    title = []<br/>    desc = []<br/>    url = []<br/>    author = []<br/>    date = []<br/><br/>    for i in range(len(latest)):<br/>        news = latest[i]<br/><br/>        title.append(news['title'])<br/>        desc.append(news['description'])<br/>        url.append(news['url'])<br/>        author.append(news['author'])<br/>        date.append(news['publishedAt'])<br/><br/>    all_news = zip(title, desc, url, author, date)<br/><br/>    context = {<br/>        'all_news': all_news<br/>    }<br/><br/>    return render(request, "index.html", context)</span></pre><p id="6d38" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在上面，我们首先导入了库，然后定义了一个名为 home 的函数来接收请求。该函数从源“cnn”获取标题，然后呈现 html 模板。</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="5756" class="lc ld in ky b gy le lf l lg lh">newsapi.get_top_headlines(source= "cnn")</span></pre><p id="a196" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们还传递了存储新闻数据的上下文。</p><p id="99ab" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">8/创建一个 HTML 模板。</p><ul class=""><li id="4e43" class="li lj in jx b jy jz kc kd kg lk kk ll ko lm ks ln lo lp lq bi translated">在 newsapp 目录中创建一个模板文件夹。</li><li id="6c27" class="li lj in jx b jy ls kc lt kg lu kk lv ko lw ks ln lo lp lq bi translated">在模板文件夹中，创建一个新文件“index.html”</li></ul><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="dfb6" class="lc ld in ky b gy le lf l lg lh">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/><br/>&lt;head&gt;<br/>    &lt;meta charset="utf-8"&gt;<br/>    &lt;title&gt;News for you&lt;/title&gt;<br/><br/>    &lt;style&gt;<br/>        body {<br/>            margin: 0rem 20rem;<br/>        }<br/><br/>        a {<br/>            text-decoration: none;<br/>        }<br/><br/>        .header {<br/>            margin-top: 5px;<br/>            width: 100%;<br/>            border-radius: 5px;<br/>            padding: 10px;<br/>            background: darkgrey;<br/>            text-align: center;<br/>        }<br/>        .container {<br/>            margin: 0;<br/>            padding: 10px;<br/>        }<br/><br/><br/>        .list {<br/>            margin: 8px 5px;<br/>            border: 1px solid #111111c9;<br/>            padding: 10px;<br/>        }<br/>    &lt;/style&gt;<br/>    &lt;link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css"&gt;<br/>&lt;/head&gt;<br/><br/>&lt;body&gt;<br/>    &lt;div class="header"&gt;<br/>        &lt;h1&gt;&lt;a href="{% url 'home' %}"&gt;What's the News?&lt;/a&gt;&lt;/h1&gt;<br/>    &lt;/div&gt;<br/><br/>    &lt;div class="container"&gt;<br/>        {% for title, description, url, author, date in all_news %}<br/><br/>        &lt;div class="list"&gt;<br/>            &lt;a href="{{ url }}"&gt;<br/>                &lt;h4 class="post-title"&gt;{{ title }}&lt;/h2&gt;<br/>            &lt;/a&gt;<br/>            &lt;p class="post-subtitle"&gt;{{ description }}&lt;/p&gt;<br/><br/>            &lt;p&gt;Posted by &lt;a href="#"&gt;{{ author }}&lt;/a&gt; on {{ date }}&lt;/p&gt;<br/>        &lt;/div&gt;<br/><br/>        &lt;!-- Divider--&gt;<br/><br/>        {% endfor %}<br/><br/>    &lt;/div&gt;<br/>&lt;/body&gt;<br/><br/>&lt;/html&gt;</span></pre><p id="2960" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">9/为我们的视图定义一条路径。转到<a class="ae lr" href="http://urls.py" rel="noopener ugc nofollow" target="_blank"> urls.py </a>文件并提及视图的路径。</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="46be" class="lc ld in ky b gy le lf l lg lh">from django.contrib import admin<br/>from django.urls import path<br/>from newsapp import views<br/><br/>urlpatterns = [<br/>    path('admin/', admin.site.urls),<br/>    path('', views.home, name ='home'),<br/><br/>]</span></pre><p id="1dfd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">终于完成了，试着用</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="3cd3" class="lc ld in ky b gy le lf l lg lh">$ python manage.py runserver</span></pre><p id="f293" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">输出</strong></p><figure class="kt ku kv kw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lx"><img src="../Images/fedbab3c367aa60da4936b215c867d90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*W9QS3DUXj47lVT7r"/></div></div></figure><p id="62d7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">GitHub <a class="ae lr" href="https://github.com/Ugyenwangdi/DjangoNewsApp" rel="noopener ugc nofollow" target="_blank">链接</a></p><p id="e764" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">查看托管在<a class="ae lr" href="https://whatisthenews.herokuapp.com/" rel="noopener ugc nofollow" target="_blank"> heroku </a>上的应用程序</p></div><div class="ab cl ly lz hr ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ig ih ii ij ik"><p id="3741" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="mf">原载于</em><a class="ae lr" href="https://wulfi.hashnode.dev/building-a-news-app-using-newsapi-and-django" rel="noopener ugc nofollow" target="_blank"><em class="mf">https://wulfi . hash node . dev</em></a><em class="mf">。</em></p></div></div>    
</body>
</html>