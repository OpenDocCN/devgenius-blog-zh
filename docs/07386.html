<html>
<head>
<title>Efficiently Programming With defaultdict() Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 defaultdict() Python 高效编程</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/efficientl-programming-with-defaultdict-python-fc7bcc0ec074?source=collection_archive---------4-----------------------#2022-03-21">https://blog.devgenius.io/efficientl-programming-with-defaultdict-python-fc7bcc0ec074?source=collection_archive---------4-----------------------#2022-03-21</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/3467c4cfc90efd8f78598b37b7a0afe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6-0wY8xyTJUhvb3O0Tagkw.png"/></div></div></figure><p id="f966" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在这篇小文章中，我想向您展示一个让您的开发过程更加高效的小特性！</p><p id="300d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我会用例子给你看什么是 defaultdict()以及 dict()和 defaultdict()的区别。</p><h2 id="357d" class="kt ku in bd kv kw kx dn ky kz la dp lb kg lc ld le kk lf lg lh ko li lj lk ll bi translated">在这里可以观看关于 defaultdict()的视频:</h2><figure class="lm ln lo lp gt jo"><div class="bz fp l di"><div class="lq lr l"/></div></figure><h1 id="caa0" class="ls ku in bd kv lt lu lv ky lw lx ly lb lz ma mb le mc md me lh mf mg mh lk mi bi translated">dict() vs defaultdict()</h1><p id="8dcb" class="pw-post-body-paragraph jv jw in jx b jy mj ka kb kc mk ke kf kg ml ki kj kk mm km kn ko mn kq kr ks ig bi translated"><strong class="jx io"> Defaultdict </strong>是一个类似容器的字典，存在于模块<strong class="jx io">集合</strong>中。Defaultdict 是 dictionary 类的一个子类，它返回一个类似字典的对象。除了<strong class="jx io"> defaultdict 从不引发 KeyError </strong>之外，字典和 defaultdict 的功能几乎相同。它为不存在的键提供默认值。</p></div><div class="ab cl mo mp hr mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="ig ih ii ij ik"><p id="cd15" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">语法:</strong>default dict(default _ factory)<br/><strong class="jx io">参数:</strong></p><ul class=""><li id="7798" class="mv mw in jx b jy jz kc kd kg mx kk my ko mz ks na nb nc nd bi translated"><strong class="jx io"> default_factory: </strong>返回定义的字典的默认值的函数。如果这个参数不存在，那么字典会产生一个 KeyError。</li></ul><p id="fc30" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">实际上，你知道如果你试图把一个值追加到缺少键的字典中，你会得到一个 KeyError。</p><pre class="lm ln lo lp gt ne nf ng nh aw ni bi"><span id="a027" class="kt ku in nf b gy nj nk l nl nm">certificates = {}<br/>students = [“Michael”, “George”, “Jesica”]<br/>grades = [<br/>    {“History”: 50, “Mathematics”: 90, “Physics”: 70},<br/>    {“History”: 70, “Mathematics”: 85, “Physics”: 30},<br/>    {“History”: 60, “Mathematics”: 50, “Physics”: 60}<br/>]for index, value in enumerate(grades):<br/>    certificates[students[index]].append(value)<br/>&gt;&gt;&gt; KeyError: ‘Michael’</span></pre><p id="c907" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了避免这种错误，您可以构建以下“if”语句:</p><pre class="lm ln lo lp gt ne nf ng nh aw ni bi"><span id="10b5" class="kt ku in nf b gy nj nk l nl nm">for index, value in enumerate(grades):<br/>    if students[index] not in certificates:<br/>        certificates[students[index]] = []<br/>    certificates[students[index]].append(value)<br/>&gt;&gt;&gt; {<br/>    'Michael': [{'History': 50, 'Mathematics': 90, 'Physics': 70}],<br/>    'George': [{'History': 70, 'Mathematics': 85, 'Physics': 30}], <br/>    'Jesica': [{'History': 60, 'Mathematics': 50, 'Physics': 60}]<br/>}</span></pre><p id="cf44" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">但是您可以使用<strong class="jx io"> defaultdict() </strong>让您的代码更加清晰:</p><pre class="lm ln lo lp gt ne nf ng nh aw ni bi"><span id="d9c7" class="kt ku in nf b gy nj nk l nl nm">from collections import defaultdict</span><span id="a60c" class="kt ku in nf b gy nn nk l nl nm"><br/>certificates = defaultdict(list)<br/>for index, value in enumerate(grades):<br/>    certificates[students[index]].append(value)<br/>&gt;&gt;&gt; defaultdict(&lt;class ‘list’&gt;, {‘Michael’: [{‘History’: 50, ‘Mathematics’: 90, ‘Physics’: 70}], ‘George’: [{‘History’: 70, ‘Mathematics’: 85, ‘Physics’: 30}], ‘Jesica’: [{‘History’: 60, ‘Mathematics’: 50, ‘Physics’: 60}]})</span></pre><p id="a1f5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在上面的例子中，我们将<strong class="jx io"> default_factory </strong>设置为<strong class="jx io">列表</strong>，如果我们调用 missing key，我们将得到一个空列表<strong class="jx io"> [] </strong>作为 missing key 的默认值。我们也可以设置任何数据类型:<strong class="jx io"> int，str，dict，float，set，tuple，list </strong>。</p><p id="2cff" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们尝试所有这些数据类型并检查结果:</p><pre class="lm ln lo lp gt ne nf ng nh aw ni bi"><span id="a00b" class="kt ku in nf b gy nj nk l nl nm">test_dict = defaultdict(<strong class="nf io">int</strong>)<br/>&gt;&gt;&gt; 0</span><span id="b1cd" class="kt ku in nf b gy nn nk l nl nm">test_dict = defaultdict(<strong class="nf io">float</strong>)<br/>&gt;&gt;&gt; 0.0</span><span id="b257" class="kt ku in nf b gy nn nk l nl nm">test_dict = defaultdict(<strong class="nf io">dict</strong>)<br/>&gt;&gt;&gt; {}</span><span id="7d67" class="kt ku in nf b gy nn nk l nl nm">test_dict = defaultdict(<strong class="nf io">list</strong>)<br/>&gt;&gt;&gt; []</span><span id="419b" class="kt ku in nf b gy nn nk l nl nm">test_dict = defaultdict(<strong class="nf io">tuple</strong>)<br/>&gt;&gt;&gt; ()</span><span id="3e8e" class="kt ku in nf b gy nn nk l nl nm">test_dict = defaultdict(<strong class="nf io">set</strong>)<br/>&gt;&gt;&gt; set()</span><span id="757a" class="kt ku in nf b gy nn nk l nl nm">test_dict = defaultdict(<strong class="nf io">str</strong>)<br/>&gt;&gt;&gt; ‘’</span></pre><p id="311b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">此外，您可以设置自己的默认值。default_factory 必须是可调用的，这样我们就可以做下一步:</p><pre class="lm ln lo lp gt ne nf ng nh aw ni bi"><span id="6568" class="kt ku in nf b gy nj nk l nl nm">test_dict = defaultdict(lambda: “Default value by lambda”)<br/>test_dict[missing_key]<br/>&gt;&gt;&gt; ‘Default value by lambda’</span></pre><p id="c025" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">运筹学</p><pre class="lm ln lo lp gt ne nf ng nh aw ni bi"><span id="901d" class="kt ku in nf b gy nj nk l nl nm">def test_function():<br/>    return “Default value by usual function”</span><span id="e2c2" class="kt ku in nf b gy nn nk l nl nm">test_dict = defaultdict(test_function)<br/>&gt;&gt;&gt; ‘Default value by usual function’</span></pre><p id="54bb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">但是如果你不设置 default_factory，它将会是<strong class="jx io"> None </strong>，在这种情况下，如果你试图调用一个丢失的键，你会得到一个<strong class="jx io"> KeyError </strong></p><pre class="lm ln lo lp gt ne nf ng nh aw ni bi"><span id="681f" class="kt ku in nf b gy nj nk l nl nm">test_dict = defaultdict()<br/>test_dict[“missing_key”]<br/>&gt;&gt;&gt; KeyError: missing_key</span></pre><p id="3cab" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">留下你的评论，比如这个视频。</p><p id="f60b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">谢谢观看和良好的发展！回头见！</p></div></div>    
</body>
</html>