<html>
<head>
<title>How to create a connected account in Stripe with Node</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在带节点的条带中创建关联帐户</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-create-a-connected-account-in-stripe-with-node-c179c009458a?source=collection_archive---------2-----------------------#2020-12-06">https://blog.devgenius.io/how-to-create-a-connected-account-in-stripe-with-node-c179c009458a?source=collection_archive---------2-----------------------#2020-12-06</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="cbe7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">使用NodeJS和Express在Stripe中创建关联帐户</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5632e4bc8d159d1c7fb110d0b6fc5f20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PuX5JMId68sHPIK6"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@rupixen?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">rupixen.com</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><p id="efdb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在我的一个项目中，我必须集成一个支付平台，用户向我们付款，我们收取一些费用，然后我们需要转移一些钱给我们的提供商。我的第一个选择是看条纹。</p><p id="54d1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae ky" href="https://stripe.com" rel="noopener ugc nofollow" target="_blank"> Stripe </a>是一个支付基础设施，可以让开发者轻松支付。他们有几种产品，其中之一是关联客户。</p><p id="d999" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">随着<a class="ae ky" href="https://stripe.com/en-gb-es/connect" rel="noopener ugc nofollow" target="_blank">连接帐户</a>你可以向用户收费，收取一些费用，然后将其余的转移到另一个帐户，正是我想要的。</p><p id="fe76" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">配置此功能的第一步是创建条带帐户。然后创建将成为我们提供商的关联帐户。那我们开始吧。</p></div><div class="ab cl kz la hr lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="ig ih ii ij ik"><p id="e453" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">假设您已经有一个Stipe帐户，请转到仪表板。让我们使用测试数据，因此检查“查看测试数据”。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lg"><img src="../Images/9931a779f3d87974e2f9610b1b8bb60d.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/format:webp/1*zFFDuQAIpJvqe5ZLwQP-0Q.png"/></div></figure><p id="f140" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">然后，单击左侧面板中的设置选项，然后单击连接部分中的设置按钮。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lh"><img src="../Images/b72fce86dbf7d398c128ca5a67a04dfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oF-oM5HDPFvbv87KiInOzA.png"/></div></div></figure><p id="45fd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在本节中，您将配置您的品牌，即您的企业在入职和接受奖金时向用户展示的方式。</p><p id="8475" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这一页的底部，有一个集成部分。在这里，您将检查OAuth设置。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi li"><img src="../Images/93834cac7a48c7ff8a05122a0b5dbbe9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kj1kSZYXCtfj1DkgRyLAzQ.png"/></div></div></figure><p id="a968" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在重定向部分，您将添加一个URI并添加以下URL:http://localhost:3000/stripe/authorize</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lj"><img src="../Images/0dc5d5b640e7638d968921fcba3e0867.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1DdT1TT2H0WP46R90m0OFg.png"/></div></div></figure><p id="642e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在使用Stripe创建帐户后，用户将被重定向到该URL，以便在您的平台中验证该用户。<strong class="jm io">在生产数据中，您需要为您的生产URL </strong>进行更改。这只是为了测试。</p><p id="2277" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在我们已经配置好了，让我们创建我们服务器。我们将使用Node和Express。我不会解释如何创建节点和Express服务器，但是我会向您展示我使用的文件夹结构和依赖关系。</p><div class="kj kk kl km gt ab cb"><figure class="lk kn ll lm ln lo lp paragraph-image"><img src="../Images/87379355e210e3bd53922b770feddcce.png" data-original-src="https://miro.medium.com/v2/resize:fit:554/format:webp/1*j3yhShBl2KileV_ZxmP9Ug.png"/></figure><figure class="lk kn lq lm ln lo lp paragraph-image"><img src="../Images/1ede01899fd2bf3269b83d84a3c24a98.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*v9Ak7C_5oRszK_9E_urnZA.png"/></figure></div><p id="5c6d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要安装条带，您需要执行以下操作:</p><pre class="kj kk kl km gt lr ls lt lu aw lv bi"><span id="5e6b" class="lw lx in ls b gy ly lz l ma mb">npm install --save stripe</span></pre><p id="6f22" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在我们已经安装了Stripe，让我们配置我们的server.js</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="6eba" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们的条纹.路线. js</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="7256" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们的stripe.controller.js</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="2535" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">最后，我们的stripe.service.js</p><p id="4348" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这里，我们将添加以下内容:</p><p id="ae83" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">const stripe = require(' stripe ')(' client-ID ')，其中客户端ID是条带控制面板中的一个。</p><p id="34a8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在让我们创建一个函数来授权新帐户。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="8d46" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">对此的反应将是:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="5c5f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这里发生了什么？</p><p id="e3f2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">首先，Stripe将生成一个URL，以便用户可以创建自己的帐户。然后，它将重定向到我们在dasboard中添加的URL:</p><p id="c820" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">http://localhost:3000/stripe/authorize</p><p id="7bc3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">当用户重定向到那个URL时，我们的服务器将执行我们刚刚编写的函数。其中我们将接收授权码作为查询参数。</p><p id="3720" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在我们需要调用Stripe API: stripe.oauth.token，并发送从Stripe接收的代码。这将授权我们的用户。如果功能是成功的，我们可以重定向用户到一个网站，在那里我们可以告诉他，一切正常，如果不是显示他一个错误。</p><p id="c438" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要对此进行测试，请转到集成部分的仪表板，并单击<strong class="jm io"> test OAuth… </strong></p><p id="34a4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">复制<strong class="jm io">标准链接</strong>，打开，点击页面开头的<strong class="jm io">跳过此账户表单</strong>。这将执行您的服务器函数，然后将用户重定向到您在<strong class="jm io">RES . redirect(" customURL ")</strong>中创建函数时想要的位置。</p><p id="ea78" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这就是全部，现在我们已经创建了我们的用户，我们可以开始集成支付。下一步将是创建一个PaymentIntent，但我将在另一篇文章中介绍这一点。</p><p id="1577" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">谢谢，如果您有任何问题或任何改进代码的建议，请不要犹豫，给我写信。</p><p id="42c6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">更多关于Stripe的信息，你可以查看他们的网页:<a class="ae ky" href="https://stripe.com/docs/connect/oauth-express-accounts" rel="noopener ugc nofollow" target="_blank">https://stripe.com/docs/connect/oauth-express-accounts</a></p><p id="3c36" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">与我们合作:</p><div class="me mf gp gr mg mh"><a href="https://www.avilatek.com/en/" rel="noopener  ugc nofollow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd io gy z fp mm fr fs mn fu fw im bi translated">阿维拉泰克</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">技术创新的发展</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">www.avilatek.com</p></div></div><div class="mq l"><div class="mr l ms mt mu mq mv ks mh"/></div></div></a></div><p id="d10a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">领英:<a class="ae ky" href="https://www.linkedin.com/in/marcelo-laprea/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/marcelo-laprea/</a></p></div></div>    
</body>
</html>