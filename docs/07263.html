<html>
<head>
<title>How To Set Up A SNS Topic To Track Updates On Your S3 Bucket</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何设置一个社交网站主题来跟踪你的 S3 桶的更新</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-set-up-a-sns-topic-to-track-updates-on-your-s3-bucket-3b2184297071?source=collection_archive---------6-----------------------#2022-03-10">https://blog.devgenius.io/how-to-set-up-a-sns-topic-to-track-updates-on-your-s3-bucket-3b2184297071?source=collection_archive---------6-----------------------#2022-03-10</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/85ff6d4881a7fea8497d0e7eaf85b92b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zolqrrHlqBb7OrZwSVW6tQ.png"/></div></div></figure><p id="6530" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">欢迎回来参加我的最新项目！这个项目将是一个关于如何建立一个 SNS 主题的教程，给你更新你的 S3 桶直接到你的电子邮件。在我们开始之前，让我们来看一下一些定义和这个项目需要什么。</p><ul class=""><li id="7c9e" class="kt ku in jx b jy jz kc kd kg kv kk kw ko kx ks ky kz la lb bi translated">什么是 S3，什么是水桶？<a class="ae lc" href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/Welcome.html" rel="noopener ugc nofollow" target="_blank">亚马逊简单存储服务</a>(亚马逊 S3)是一种对象存储服务，提供行业领先的可扩展性、数据可用性、安全性和性能。S3 桶本质上是一个容纳对象/文件的容器。查看我链接的 AWS 文档以获得进一步的解释。</li><li id="54a1" class="kt ku in jx b jy ld kc le kg lf kk lg ko lh ks ky kz la lb bi translated">什么是 SNS，什么是 SNS 话题？<a class="ae lc" href="https://aws.amazon.com/sns/?whats-new-cards.sort-by=item.additionalFields.postDateTime&amp;whats-new-cards.sort-order=desc" rel="noopener ugc nofollow" target="_blank">亚马逊简单通知服务</a>(亚马逊 SNS)是一项全面管理的消息服务，适用于应用对应用(A2A)和应用对个人(A2P)的通信。一个 SNS 主题本质上是你将创建的 SNS 链接到你的 S3 桶。要获取电子邮件，我们必须为其设置订阅。查看 AWS 文档以获得对此的进一步解释。</li><li id="bfc0" class="kt ku in jx b jy ld kc le kg lf kk lg ko lh ks ky kz la lb bi translated">什么是 IAM，为什么我们需要创建一个用户帐户而不是根用户？<a class="ae lc" href="https://aws.amazon.com/iam/" rel="noopener ugc nofollow" target="_blank"> AWS 身份和访问管理(IAM) </a>提供跨所有 AWS 的细粒度访问控制。使用 IAM，您可以指定谁可以在什么条件下访问哪些服务和资源。借助 IAM 策略，您可以管理员工和系统的权限，以确保最低权限。记住，最小特权是针对云中安全性的<a class="ae lc" href="http://aws.amazon.com/" rel="noopener ugc nofollow" target="_blank">Amazon Web Services(AWS)</a><a class="ae lc" href="https://aws.amazon.com/architecture/well-architected/" rel="noopener ugc nofollow" target="_blank">架构良好的</a>最佳实践。这意味着只给用户完成特定任务所需的权限/访问权。不多不少。</li></ul><p id="04c1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">该项目的目标如下:</p><ol class=""><li id="e977" class="kt ku in jx b jy jz kc kd kg kv kk kw ko kx ks li kz la lb bi translated">创建 S3 存储桶</li><li id="2c6f" class="kt ku in jx b jy ld kc le kg lf kk lg ko lh ks li kz la lb bi translated">创建一个 SNS 主题，通知 S3 时段中的所有事件</li><li id="2aee" class="kt ku in jx b jy ld kc le kg lf kk lg ko lh ks li kz la lb bi translated">使用电子邮件订阅主题</li><li id="052c" class="kt ku in jx b jy ld kc le kg lf kk lg ko lh ks li kz la lb bi translated">通过在 S3 放置、更新和删除对象来确认它的工作。您应该会收到一封确认电子邮件。</li></ol><p id="bce0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">既然我们已经解决了这个问题，让我们开始这个聚会吧！</p><p id="aae8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">步骤 1- </strong>按照最低权限最佳实践创建一个 IAM 用户</p><figure class="lk ll lm ln gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lj"><img src="../Images/cfec4784d20347045e03862f6c9f38f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UypfnuVGvirRhZvTIvLWtA.png"/></div></div></figure><p id="6906" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">使用 AWS 控制台顶部的搜索栏，键入 IAM。填充后，选择蓝色的“添加用户”。一旦你这样做了，你将进入这个页面，你可以给你的用户一个名字，决定它将有什么样的访问权，以及决定用户的密码。我只是在登录时创建了一个密码，并选择坚持使用它，但最好的做法是在下次登录时要求重置密码。</p><figure class="lk ll lm ln gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lo"><img src="../Images/47480f6f6bfae28b34408ca938d9cef3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KdBn-jE9kvT49iRv11logA.png"/></div></div></figure><p id="1c77" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">接下来要做的事情是给你的用户权限，10 是他们一次可以拥有的最高权限。我选择给我的用户大部分的完全访问权限，仅仅是因为这个用户是我项目的主要帐户，而不是使用 root 帐户。我可能会根据项目切换权限。完成后，您可以选择使用现有的密钥，或者创建并下载一个新的密钥。我使用了一个已经创建并保存的密钥，但是如果您创建了一个新的密钥，我会记住它，并将其存储在您的计算机上的某个地方(例如您的桌面或下载文件夹)，这样您就不会丢失它。AWS CLI 需要这个密钥文件。</p><p id="4201" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">完成用户设置后，在控制台上登录您的用户帐户。不要忘记为您的用户设置 MFA(多因素身份验证),这是云的另一个安全最佳实践。完成后，继续下一步。</p><p id="ffad" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">第二步</strong> -创建你的社交网络话题</p><figure class="lk ll lm ln gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lp"><img src="../Images/ac88f91712124e7d8535850ca9954838.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bzUjQ1UYi1zXI07nU4TFsw.png"/></div></div></figure><p id="0cc8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">转到 AWS 控制台顶部，搜索 SNS(简单通知服务)。选择标准而不是先进先出，以获得直接的电子邮件通知，并命名您的 SNS 无论你想它是什么。与 S3 不同，它不需要非常独特，因为它不是全球性的服务。我们稍后会回来更新访问策略。</p><p id="6769" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">创建完成后，抓取 ARN 并将其复制到你电脑上的记事本应用程序中。</p><p id="4578" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">第 3 步- </strong>创建您的 S3 桶</p><figure class="lk ll lm ln gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lq"><img src="../Images/71ca02cb7491f84b66a2b6bf024de241.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vstzOisTRr17KNr1HqCoGQ.png"/></div></div></figure><p id="12e9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">转到 AWS 控制台的顶部，然后搜索 S3。在这里，点击“创建存储桶”,然后您将进入此页面。由于 S3 是一项全球性服务，请为您的 S3 桶创建一个独特的名称。您可以将其他所有内容保留为默认设置，然后按 create。</p><p id="5860" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">创建桶后，获取桶的 ARN，并将其复制到您之前创建的记事本应用程序中。</p><p id="7b19" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">步骤 4</strong>——更新您的 JSON 访问策略</p><figure class="lk ll lm ln gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lr"><img src="../Images/4f829bc2cdeb72575eb800f46d377804.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K95xFtrJY_l3Gnot6vfsiQ.png"/></div></div></figure><p id="1dc8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在，我们将转到 SNS 的 AWS 文档，并获取他们的 JSON 代码的副本，以便用我们自己的信息进行修改。我们将更改该文件中的多行内容，并用我们复制到记事本中的内容进行更新。</p><figure class="lk ll lm ln gt jo gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/404091a6e1dbfe74faacaf600899339b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*xxUOldo6-XVqo-bfsOaqFQ.png"/></div></figure><p id="b0ad" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这是我用我的资源中的信息编辑完我的记事本应用程序后，它在我的记事本应用程序上的样子。</p><figure class="lk ll lm ln gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lt"><img src="../Images/4abc833b0947439b65de7428e033070d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*70DpqtEAtQ9IlPfRjTip6Q.png"/></div></div></figure><p id="700a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">然后，我将这个新的 JSON 代码插入我的 SNS 服务的访问策略行，并按下 save。</p><p id="f635" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">步骤 5- </strong>创建订阅和 S3 通知</p><figure class="lk ll lm ln gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lu"><img src="../Images/67b897339cede288ff8aa6b892a80ea1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x5qv7er1UJW29R_MxLWFCg.png"/></div></div></figure><p id="de9c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">接下来，我们将通过点击 SNS 主页上的橙色按钮来创建我们的订阅。然后我们将被带到这个页面，在这里我们将选择我们的主题 ARN 和我们的交付协议。我选择了电子邮件，然后输入我的电子邮件地址。然后，您将收到一封电子邮件，您需要单击该邮件来确认协议并完全设置产品升级和技术支持服务。</p><figure class="lk ll lm ln gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lv"><img src="../Images/9cee21d537a25f82112c48f9cb750aa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qyi6crJXi8RETZP84Z818A.png"/></div></div></figure><p id="f221" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">确认电子邮件后，在 AWS 控制台中键入 S3，然后单击您创建的存储桶。接下来，您要做的是单击 bucket 的属性并向下滚动，直到看到事件通知。您可以在这里命名通知，并选择您希望收到通知的事件类型。我为这个特定的项目选择了它们。下一步是按保存！</p><figure class="lk ll lm ln gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lw"><img src="../Images/c5ace18b5d82bc8420ea14aaa8ec66ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WJJkvT-V8V-GQbNWw44VdA.png"/></div></div></figure><p id="f2b9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">赞成..我知道..不幸的是，如果您按照我的步骤操作，那么您将得到同样的访问策略错误消息。但是不用担心！我们将在下一步处理这个问题。</p><figure class="lk ll lm ln gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lx"><img src="../Images/0f8a28c04411c43393c92e48fc0a8d5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eajL09g-T4mjOpbT7rZATA.png"/></div></div></figure><p id="df83" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">然后，我回到 SNS 页面上的访问策略，重新阅读了从 AWS 文档中获得的 JSON 代码，并认为我实际上并不需要字符串代码部分，所以我将它完全从代码中删除。然后我回到 S3 的活动通知页面…</p><figure class="lk ll lm ln gt jo gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/7e75e75d235a4c936889e41d7cf8e3f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:866/format:webp/1*6iUVfD3Mr9UCyc4t_jCbGQ.png"/></div></figure><p id="28cd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">瞧啊。成功了…</p><p id="d6f7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">第 6 步- </strong>测试你的社交网站话题</p><p id="b8d8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">好了，我们终于快完成了！现在我们将通过上传文件，更新文件，然后删除文件来测试我们的创建。我们应该会收到来自 SNS 的通知，通知我们的电子邮件帐户进行所有三项操作…</p><figure class="lk ll lm ln gt jo gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/9321ac0be21898aa920c5ed7faecd8ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*KeFRHqEwvB6b9tYMv4vjuw.png"/></div></figure><p id="4bcd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">但是首先我们将创建一个文件来上传。我使用 CLI 创建了一个文件:</p><pre class="lk ll lm ln gt ma mb mc md aw me bi"><span id="535f" class="mf mg in mb b gy mh mi l mj mk">touch &lt;name of your file&gt;</span></pre><p id="140d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">然后，我使用 echo 命令在该文件中输入文本，并使用“&gt;”命令将其附加到 newfile 中</p><pre class="lk ll lm ln gt ma mb mc md aw me bi"><span id="4607" class="mf mg in mb b gy mh mi l mj mk">echo “&lt;your text&gt;” &gt; newfile</span></pre><figure class="lk ll lm ln gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ml"><img src="../Images/cd4ec455cccbc43260c1afee88f5f1cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eD2jps5i9vxko0vdMVMKpQ.png"/></div></div></figure><p id="b08a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">然后我把文件上传到了 S3。</p><figure class="lk ll lm ln gt jo gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/9ba76aea4d20a19107521e88fe05326c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*cHCKwOU_76_wRRHKj40fkA.png"/></div></figure><figure class="lk ll lm ln gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mn"><img src="../Images/6b7d5602819a9bc5be437712803029ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mjdLoAetx7cN5DHJxjaVmg.png"/></div></div></figure><p id="a33f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">文件上传后，我向文件中添加了更多的文本，并再次上传以更新和替换已经在 s3 bucket 中的原始文件。我使用的命令是(请记住“&gt; &gt;”命令允许您添加输入而不覆盖它):</p><pre class="lk ll lm ln gt ma mb mc md aw me bi"><span id="d1e8" class="mf mg in mb b gy mh mi l mj mk">echo “&lt;your new text&gt;” &gt;&gt; newfile</span></pre><p id="fd7f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">然后，我删除了“新文件”,以确保我收到了一封电子邮件，告知我关于我的 S3 水桶的变化…</p><figure class="lk ll lm ln gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mo"><img src="../Images/b9cbf0425db067e1060159c212e1ce30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ylEROmj1HR9YGNhKrlMrKw.png"/></div></div></figure><p id="f370" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这是我第一次上传“newfile”时收到的第一封来自 SNS 的邮件。</p><figure class="lk ll lm ln gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mp"><img src="../Images/69d723f42e49b72aa0472af6c98e01f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*co8yst6DiPTrWYmIlx99YQ.png"/></div></div></figure><p id="8f7a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这是我用新文本更新“新文件”并替换原来的时候收到的第二封电子邮件。</p><figure class="lk ll lm ln gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mq"><img src="../Images/dd0d23e2230f03131650ca8b7ad93bda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zmNeU8SMgUALSkfdypgA2g.png"/></div></div></figure><p id="6b0a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">最后，这是我从桶中删除“新文件”时收到的最后一条消息。</p><p id="ba93" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这结束了我的项目。感谢你坚持和我在一起，请<strong class="jx io">不要</strong>忘记分解你在 AWS 中创建的任何资源！</p></div></div>    
</body>
</html>