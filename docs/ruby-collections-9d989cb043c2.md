# 红宝石系列

> 原文：<https://blog.devgenius.io/ruby-collections-9d989cb043c2?source=collection_archive---------10----------------------->

![](img/2d41b9e800d5b73ef2fc4beb57e6703e.png)

佛朗哥·安东尼奥·乔瓦内拉在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片

处理数据是编程的一部分。数据存储、搜索和操作是程序员的常见任务。考虑第一个动作:存储。我们如何存储信息？对于大多数编程语言，解决方案是将它们组织成结构化的容器或集合。集合可以采取多种形式，但是将它们视为数据列表是很有用的。

我们将关注 Ruby 最常见的三种集合类型`String`、`Array`和`Hash`。

> "生活是瞬间的集合。"
> 
> —未知

# 元素引用

单个元素构成集合。要使用集合，我们必须首先了解它们的结构，以及如何引用和分配其中的单个元素。

## 字符串元素引用

字符串中的每个字符都由基于整数的索引表示。索引从零开始，剩余的每个索引值增加 1。该索引可用于查找特定字符。

还可以使用索引起点和返回的字符数来引用字符串中的多个字符。

Ruby 中的方法总是有返回值。当我们调用一个方法时，我们可以使用方法链接来调用另一个方法的返回值。

字符串不是真正的集合，尽管我们经常这样称呼它们。集合包含多个对象，而字符串只包含一个对象。单个字符不是对象，而是包含字符串值的对象的组成部分。

字符串的行为类似于集合，因为您可以单独访问和分配每个字符。当你用类似`str[2]`的东西访问字符串中的一个字符时，返回值是一个全新的字符串——每次你调用它，`str[2]`都会返回一个新的字符串:

## 数组元素引用

数组是按索引排序的元素列表，可以包含任何对象。为了保持元素的顺序，数组使用基于整数的索引。可以使用特定元素的索引来引用它。

数组中的一系列元素也可以以类似于字符串的方式被引用。

## 哈希元素引用

哈希是另一种流行的集合数据结构，它不使用基于整数的索引，而是使用键-值对，其中键或值可以是任何类型的 Ruby 对象。这使得元素的集合更加全面和更具描述性。

需要注意的是，上例中的`hsh[‘fruit’][0]`中的`[0]`指的是一个字符串元素引用。`hsh[‘fruit’]`返回字符串`‘apple’`，并在返回值上调用`[0]`。

用于初始化哈希的密钥必须是唯一的。另一方面，值可以复制:

我们可以使用 hash 的#keys 和#values 方法从 Hash 中获取键或值。这两种方法都会产生一个数组:

在前面的示例中，符号被用作键。虽然在 Ruby 中，散列键和值都可以是任何对象，但符号通常被用作键。Ruby 符号可以被认为是不可变的字符串。对散列键使用符号有几个好处，我们在这里不讨论，但是了解这个约定是很重要的。

# 边缘案例

当引用集合中的元素时，有一些事情可能会让您措手不及，您应该了解这些以避免代码中出现意外的行为。

## 出界指数

数组和字符串都是索引集合的例子。也就是说，我们可以使用索引来引用对象中的特定元素。

在这种情况下，引用越界索引会产生 nil。对于一个字符串来说，这不一定是个问题，因为我们知道 nil 是一个无效的返回值；但是，nil 可能是数组的有效返回值，因为数组可以包含任何其他类型的对象，包括 nil。

## 负指数

负索引可用于引用 String 和 Array 对象中的元素，从集合中的最后一个索引-1 开始，向后工作。

# 转换收藏

因为字符串和数组有相似之处，比如都是零索引集合，所以可以从一个转换到另一个，这是 Ruby 代码中的常见做法。这种类型的转换可以通过许多 Ruby 方法实现，包括`String#chars`和`Array#join`。

String#chars 返回单个字符的数组。

`Array#join`返回一个包含数组元素的字符串。

Hash 的`#to_a`方法返回一个数组。

`#to_a`返回的数组包含另外两个数组，每个数组包含一个符号和一个字符串。每个子数组对应于原始散列中的一个键值对。

Hash 有一个`#to_a`方法，Array 有一个`#to_h`方法。

# 分配元素

## 字符串元素赋值

使用字符串元素赋值符号，我们可以通过引用其索引来更改字符串中特定字符的值。如果我们想把一个句子中第一个单词的第一个字母换成大写字母，我们可以这样做。

## 数组元素赋值

我们可以分配数组元素，就像我们可以使用它们的索引来分配字符串中的单个字符一样。

## 哈希元素赋值

散列元素的赋值没有太大的不同。不使用索引赋值，而是使用哈希键。

# 结论

集合中元素的引用和赋值是一个非常重要的主题。我们可以使用各种方法来执行这些操作。这些概念是使用集合的基础，对它们的良好理解将使使用这些数据结构变得容易得多。