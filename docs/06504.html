<html>
<head>
<title>NodeJS Desktop Automation with RobotJS, (but with a program that could get you hÌ¶iÌ¶rÌ¶eÌ¶dÌ¶ firedğŸ˜„)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">NodeJSæ¡Œé¢è‡ªåŠ¨åŒ–ä¸RobotJSï¼Œ(ä½†ä¸ä¸€ä¸ªç¨‹åºï¼Œå¯ä»¥è®©ä½ hÌ¶iÌ¶rÌ¶eÌ¶dÌ¶è¢«è§£é›‡ğŸ˜„)</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://blog.devgenius.io/nodejs-desktop-automation-with-robotjs-but-with-a-program-that-could-get-you-h%CC%B6i%CC%B6r%CC%B6e%CC%B6d%CC%B6-fired-9f9fd4641d92?source=collection_archive---------18-----------------------#2022-01-12">https://blog.devgenius.io/nodejs-desktop-automation-with-robotjs-but-with-a-program-that-could-get-you-h%CC%B6i%CC%B6r%CC%B6e%CC%B6d%CC%B6-fired-9f9fd4641d92?source=collection_archive---------18-----------------------#2022-01-12</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="e080" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ä¸ä¹…å‰ï¼Œæˆ‘çœ‹åˆ°äº†ä¸€ä¸ªåä¸ºâ€œè½¯ä»¶å·¥ç¨‹å¸ˆçš„ä¸€å¤©â€çš„memeè§†é¢‘ï¼Œå…¶ä¸­å·¥ç¨‹å¸ˆç¼–å†™äº†ä¸€ä¸ªè„šæœ¬ï¼Œè®©ä»–çš„ç”µè„‘è‡ªåŠ¨æ‰“å¼€ï¼Œæ‰“å¼€Slackï¼Œå¹¶åœ¨ä»–ç¡è§‰æ—¶å®šæœŸç§»åŠ¨é¼ æ ‡ï¼Œä»¥ä½¿å…¶çœ‹èµ·æ¥åƒæ˜¯åœ¨åŒæ—¶åœ¨çº¿å’Œå·¥ä½œã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f0cc488899245d38f149922a4ce26043.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FE3gCvqcFc-cinlB2f2hXg.jpeg"/></div></div></figure><p id="4cee" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æˆ‘ä»¬å°†ä½¿ç”¨[RobotJSæ¨¡å—](ã€http://robotjs.io/ã€‘)ç”¨NodeJSç¼–å†™ä¸€ä¸ªç±»ä¼¼çš„ç¨‹åºã€‚RobotJSæ˜¯ä¸€ä¸ªè·¨å¹³å°çš„æ¡Œé¢è‡ªåŠ¨åŒ–åº“ã€‚</p><p id="3fc0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">è¿™åªæ˜¯å‡ºäºæ•™è‚²ç›®çš„ã€‚ğŸ˜Š</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="kv kw l"/></div></figure><h1 id="df86" class="kx ky in bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">æ­¥ä¼</h1><ul class=""><li id="ede8" class="lv lw in jm b jn lx jr ly jv lz jz ma kd mb kh mc md me mf bi translated">è¿è¡Œ<code class="fe mg mh mi mj b">npm install yargs robotjs</code>å®‰è£…æ‰€éœ€çš„ä¾èµ–é¡¹ã€‚</li><li id="8761" class="lv lw in jm b jn mk jr ml jv mm jz mn kd mo kh mc md me mf bi translated">åˆ›å»ºä¸€ä¸ª<code class="fe mg mh mi mj b">app.js</code>æ–‡ä»¶å¹¶ç²˜è´´ä¸‹é¢çš„ä»£ç ã€‚(æˆ‘æ¥è§£é‡Šä»£ç ):</li></ul><pre class="kj kk kl km gt mp mj mq mr aw ms bi"><span id="3c4d" class="mt ky in mj b gy mu mv l mw mx">// app.js<br/>const yargs = require("yargs");<br/>const { hideBin } = require("yargs/helpers");</span><span id="9c8d" class="mt ky in mj b gy my mv l mw mx">const arg = yargs(hideBin(process.argv))<br/>  .command("$0 [interval]", true, (yargs) =&gt; {<br/>    yargs<br/>      .positional("interval", {<br/>        type: "number",<br/>        describe: "the interval in second",<br/>      })<br/>      .default("interval", 60); // 60 seconds default<br/>  })<br/>  .usage("runs a desktop automator to run key your  mmouse move at interval")<br/>  .example(<br/>    "$0 -mk 3",<br/>    "moves the mouse and press the keyboard after three seconds"<br/>  )<br/>  .option("m", {<br/>    description: "enable the mouse",<br/>    type: "boolean",<br/>  })<br/>  .option("k", {<br/>    description: "enable the keyboard",<br/>    type: "boolean",<br/>  })<br/>  .default("m", true)<br/>  .help("h").argv;</span></pre><p id="5550" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ä¸Šé¢çš„ä»£ç é…ç½®äº†æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºéœ€è¦çš„å‚æ•°é€‰é¡¹ï¼Œè¿˜å®šä¹‰äº†ä¸€ä¸ªCLIæ¥å£æ¥æè¿°è¿è¡Œ<code class="fe mg mh mi mj b">node app.js -h</code>æ—¶çš„åº”ç”¨ç¨‹åºã€‚æˆ‘ä»¬å°†é€‰æ‹©åªè¿è¡Œé”®ç›˜æŒ‰é”®('-k ')ã€é¼ æ ‡ç§»åŠ¨('-m ')æˆ–ä¸¤è€…éƒ½è¿è¡Œ('-mk ')ï¼Œå¹¶ä»¥ç§’ä¸ºå•ä½å®šä¹‰äº‹ä»¶çš„æ—¶é—´é—´éš”ã€‚æˆ‘åœ¨è¿™é‡Œå†™äº†ä¸€ç¯‡å…³äºè§£æNodeJS CLIå‚æ•°çš„æ–‡ç« ã€‚</p><ul class=""><li id="d919" class="lv lw in jm b jn jo jr js jv mz jz na kd nb kh mc md me mf bi translated">æˆ‘ä»¬å°†å®šä¹‰å¸ƒå°”å˜é‡æ¥ç¡®å®šè¦æ‰§è¡Œçš„æ“ä½œ:</li></ul><pre class="kj kk kl km gt mp mj mq mr aw ms bi"><span id="1a6b" class="mt ky in mj b gy mu mv l mw mx">let is_both;<br/>let is_mouse;<br/>let is_keyboard;</span></pre><ul class=""><li id="8f20" class="lv lw in jm b jn jo jr js jv mz jz na kd nb kh mc md me mf bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å®šä¹‰ç§»åŠ¨é¼ æ ‡å’ŒæŒ‰é”®ç›˜çš„å‡½æ•°:</li></ul><pre class="kj kk kl km gt mp mj mq mr aw ms bi"><span id="a1f7" class="mt ky in mj b gy mu mv l mw mx">function moveMouseBackAndForth() {<br/> robot.moveMouseSmooth(200, 200);<br/>  robot.moveMouseSmooth(400, 400);<br/>}</span><span id="9e42" class="mt ky in mj b gy my mv l mw mx">function pressKeyBoard() {<br/>  robot.keyTap("shift");<br/>}</span></pre><ul class=""><li id="2a97" class="lv lw in jm b jn jo jr js jv mz jz na kd nb kh mc md me mf bi translated">ç„¶åæˆ‘ä»¬å°†æ ¹æ®ä¼ é€’çš„å‚æ•°è°ƒç”¨å‡½æ•°ã€‚æ•´ä¸ªä»£ç å°†å¦‚ä¸‹æ‰€ç¤º:</li></ul><pre class="kj kk kl km gt mp mj mq mr aw ms bi"><span id="29ba" class="mt ky in mj b gy mu mv l mw mx">const yargs = require("yargs");<br/>const robot = require("robotjs");<br/>const { hideBin } = require("yargs/helpers");</span><span id="2f55" class="mt ky in mj b gy my mv l mw mx">let is_both;<br/>let is_mouse;<br/>let is_keyboard;</span><span id="2e45" class="mt ky in mj b gy my mv l mw mx">const arg = yargs(hideBin(process.argv))<br/>  .command("$0 [interval]", true, (yargs) =&gt; {<br/>    yargs<br/>      .positional("interval", {<br/>        type: "number",<br/>        describe: "the interval in second",<br/>      })<br/>      .default("interval", 60); // 60 seconds default<br/>  })<br/>  .usage("runs a desktop automator to run key your  mmouse move at interval")<br/>  .example(<br/>    "$0 -mk 3",<br/>    "moves the mouse and press the keyboard after three seconds"<br/>  )<br/>  .option("m", {<br/>    description: "enable the mouse",<br/>    type: "boolean",<br/>  })<br/>  .option("k", {<br/>    description: "enable the keyboard",<br/>    type: "boolean",<br/>  })<br/>  .default("m", true)<br/>  .help("h").argv;</span><span id="0ba9" class="mt ky in mj b gy my mv l mw mx">let { m, k, interval } = arg;<br/>// multiply seconds by 1000 to get milliseconds<br/>interval = interval * 1000;</span><span id="ea66" class="mt ky in mj b gy my mv l mw mx">if (m &amp;&amp; k) is_both = true;<br/>else {<br/>  if (m) is_mouse = true;<br/>  else if (k) is_keyboard = true;<br/>}</span><span id="be60" class="mt ky in mj b gy my mv l mw mx">function moveMouseBackAndForth() {<br/>  robot.moveMouseSmooth(200, 200);<br/>  robot.moveMouseSmooth(400, 400);<br/>}</span><span id="65db" class="mt ky in mj b gy my mv l mw mx">function pressKeyBoard() {<br/>  robot.keyTap("shift");<br/>}</span><span id="5c9c" class="mt ky in mj b gy my mv l mw mx">if (is_both) {<br/>  setInterval(() =&gt; {<br/>    moveMouseBackAndForth();<br/>    pressKeyBoard();<br/>  }, interval);<br/>} else if (is_keyboard) setInterval(pressKeyBoard, interval);<br/>else {<br/>  setInterval(moveMouseBackAndForth, interval);<br/>}</span></pre><ul class=""><li id="77ff" class="lv lw in jm b jn jo jr js jv mz jz na kd nb kh mc md me mf bi translated">æ¯éš”3ç§’è¿è¡Œ<code class="fe mg mh mi mj b">node app.js -m 3</code>ç§»åŠ¨é¼ æ ‡ã€‚</li></ul><p id="aa3d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æ„Ÿè°¢æ‚¨é€šè¯»ã€‚ä½ æ„¿æ„è®©ç¨‹åºåšåˆ«çš„äº‹æƒ…è€Œä¸æ˜¯æŒ‰é”®ç›˜å—ï¼Ÿ</p><blockquote class="nc nd ne"><p id="849f" class="jk jl nf jm b jn jo jp jq jr js jt ju ng jw jx jy nh ka kb kc ni ke kf kg kh ig bi translated">ä½ å¯ä»¥ä»è¿™ä¸ª<a class="ae ku" href="https://gist.github.com/zt4ff/741c98081f5802997fca1244b0a1b6bf" rel="noopener ugc nofollow" target="_blank"> Github gist </a>ä¸­å¾—åˆ°ä»£ç ã€‚</p></blockquote><p id="3f70" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æˆ‘å°†æ„Ÿè°¢æ‚¨çš„åé¦ˆå’Œé—®é¢˜ã€‚</p></div></div>    
</body>
</html>