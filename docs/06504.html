<html>
<head>
<title>NodeJS Desktop Automation with RobotJS, (but with a program that could get you h̶i̶r̶e̶d̶ fired😄)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">NodeJS桌面自动化与RobotJS，(但与一个程序，可以让你h̶i̶r̶e̶d̶被解雇😄)</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/nodejs-desktop-automation-with-robotjs-but-with-a-program-that-could-get-you-h%CC%B6i%CC%B6r%CC%B6e%CC%B6d%CC%B6-fired-9f9fd4641d92?source=collection_archive---------18-----------------------#2022-01-12">https://blog.devgenius.io/nodejs-desktop-automation-with-robotjs-but-with-a-program-that-could-get-you-h%CC%B6i%CC%B6r%CC%B6e%CC%B6d%CC%B6-fired-9f9fd4641d92?source=collection_archive---------18-----------------------#2022-01-12</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="e080" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">不久前，我看到了一个名为“软件工程师的一天”的meme视频，其中工程师编写了一个脚本，让他的电脑自动打开，打开Slack，并在他睡觉时定期移动鼠标，以使其看起来像是在同时在线和工作。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f0cc488899245d38f149922a4ce26043.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FE3gCvqcFc-cinlB2f2hXg.jpeg"/></div></div></figure><p id="4cee" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将使用[RobotJS模块](【http://robotjs.io/】)用NodeJS编写一个类似的程序。RobotJS是一个跨平台的桌面自动化库。</p><p id="3fc0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这只是出于教育目的。😊</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="kv kw l"/></div></figure><h1 id="df86" class="kx ky in bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">步伐</h1><ul class=""><li id="ede8" class="lv lw in jm b jn lx jr ly jv lz jz ma kd mb kh mc md me mf bi translated">运行<code class="fe mg mh mi mj b">npm install yargs robotjs</code>安装所需的依赖项。</li><li id="8761" class="lv lw in jm b jn mk jr ml jv mm jz mn kd mo kh mc md me mf bi translated">创建一个<code class="fe mg mh mi mj b">app.js</code>文件并粘贴下面的代码。(我来解释代码):</li></ul><pre class="kj kk kl km gt mp mj mq mr aw ms bi"><span id="3c4d" class="mt ky in mj b gy mu mv l mw mx">// app.js<br/>const yargs = require("yargs");<br/>const { hideBin } = require("yargs/helpers");</span><span id="9c8d" class="mt ky in mj b gy my mv l mw mx">const arg = yargs(hideBin(process.argv))<br/>  .command("$0 [interval]", true, (yargs) =&gt; {<br/>    yargs<br/>      .positional("interval", {<br/>        type: "number",<br/>        describe: "the interval in second",<br/>      })<br/>      .default("interval", 60); // 60 seconds default<br/>  })<br/>  .usage("runs a desktop automator to run key your  mmouse move at interval")<br/>  .example(<br/>    "$0 -mk 3",<br/>    "moves the mouse and press the keyboard after three seconds"<br/>  )<br/>  .option("m", {<br/>    description: "enable the mouse",<br/>    type: "boolean",<br/>  })<br/>  .option("k", {<br/>    description: "enable the keyboard",<br/>    type: "boolean",<br/>  })<br/>  .default("m", true)<br/>  .help("h").argv;</span></pre><p id="5550" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">上面的代码配置了我们的应用程序需要的参数选项，还定义了一个CLI接口来描述运行<code class="fe mg mh mi mj b">node app.js -h</code>时的应用程序。我们将选择只运行键盘按键('-k ')、鼠标移动('-m ')或两者都运行('-mk ')，并以秒为单位定义事件的时间间隔。我在这里写了一篇关于解析NodeJS CLI参数的文章。</p><ul class=""><li id="d919" class="lv lw in jm b jn jo jr js jv mz jz na kd nb kh mc md me mf bi translated">我们将定义布尔变量来确定要执行的操作:</li></ul><pre class="kj kk kl km gt mp mj mq mr aw ms bi"><span id="1a6b" class="mt ky in mj b gy mu mv l mw mx">let is_both;<br/>let is_mouse;<br/>let is_keyboard;</span></pre><ul class=""><li id="8f20" class="lv lw in jm b jn jo jr js jv mz jz na kd nb kh mc md me mf bi translated">接下来，我们将定义移动鼠标和按键盘的函数:</li></ul><pre class="kj kk kl km gt mp mj mq mr aw ms bi"><span id="a1f7" class="mt ky in mj b gy mu mv l mw mx">function moveMouseBackAndForth() {<br/> robot.moveMouseSmooth(200, 200);<br/>  robot.moveMouseSmooth(400, 400);<br/>}</span><span id="9e42" class="mt ky in mj b gy my mv l mw mx">function pressKeyBoard() {<br/>  robot.keyTap("shift");<br/>}</span></pre><ul class=""><li id="2a97" class="lv lw in jm b jn jo jr js jv mz jz na kd nb kh mc md me mf bi translated">然后我们将根据传递的参数调用函数。整个代码将如下所示:</li></ul><pre class="kj kk kl km gt mp mj mq mr aw ms bi"><span id="29ba" class="mt ky in mj b gy mu mv l mw mx">const yargs = require("yargs");<br/>const robot = require("robotjs");<br/>const { hideBin } = require("yargs/helpers");</span><span id="2f55" class="mt ky in mj b gy my mv l mw mx">let is_both;<br/>let is_mouse;<br/>let is_keyboard;</span><span id="2e45" class="mt ky in mj b gy my mv l mw mx">const arg = yargs(hideBin(process.argv))<br/>  .command("$0 [interval]", true, (yargs) =&gt; {<br/>    yargs<br/>      .positional("interval", {<br/>        type: "number",<br/>        describe: "the interval in second",<br/>      })<br/>      .default("interval", 60); // 60 seconds default<br/>  })<br/>  .usage("runs a desktop automator to run key your  mmouse move at interval")<br/>  .example(<br/>    "$0 -mk 3",<br/>    "moves the mouse and press the keyboard after three seconds"<br/>  )<br/>  .option("m", {<br/>    description: "enable the mouse",<br/>    type: "boolean",<br/>  })<br/>  .option("k", {<br/>    description: "enable the keyboard",<br/>    type: "boolean",<br/>  })<br/>  .default("m", true)<br/>  .help("h").argv;</span><span id="0ba9" class="mt ky in mj b gy my mv l mw mx">let { m, k, interval } = arg;<br/>// multiply seconds by 1000 to get milliseconds<br/>interval = interval * 1000;</span><span id="ea66" class="mt ky in mj b gy my mv l mw mx">if (m &amp;&amp; k) is_both = true;<br/>else {<br/>  if (m) is_mouse = true;<br/>  else if (k) is_keyboard = true;<br/>}</span><span id="be60" class="mt ky in mj b gy my mv l mw mx">function moveMouseBackAndForth() {<br/>  robot.moveMouseSmooth(200, 200);<br/>  robot.moveMouseSmooth(400, 400);<br/>}</span><span id="65db" class="mt ky in mj b gy my mv l mw mx">function pressKeyBoard() {<br/>  robot.keyTap("shift");<br/>}</span><span id="5c9c" class="mt ky in mj b gy my mv l mw mx">if (is_both) {<br/>  setInterval(() =&gt; {<br/>    moveMouseBackAndForth();<br/>    pressKeyBoard();<br/>  }, interval);<br/>} else if (is_keyboard) setInterval(pressKeyBoard, interval);<br/>else {<br/>  setInterval(moveMouseBackAndForth, interval);<br/>}</span></pre><ul class=""><li id="77ff" class="lv lw in jm b jn jo jr js jv mz jz na kd nb kh mc md me mf bi translated">每隔3秒运行<code class="fe mg mh mi mj b">node app.js -m 3</code>移动鼠标。</li></ul><p id="aa3d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">感谢您通读。你愿意让程序做别的事情而不是按键盘吗？</p><blockquote class="nc nd ne"><p id="849f" class="jk jl nf jm b jn jo jp jq jr js jt ju ng jw jx jy nh ka kb kc ni ke kf kg kh ig bi translated">你可以从这个<a class="ae ku" href="https://gist.github.com/zt4ff/741c98081f5802997fca1244b0a1b6bf" rel="noopener ugc nofollow" target="_blank"> Github gist </a>中得到代码。</p></blockquote><p id="3f70" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我将感谢您的反馈和问题。</p></div></div>    
</body>
</html>