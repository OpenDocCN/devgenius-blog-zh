<html>
<head>
<title>Relationships in MongoDB</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">MongoDB ä¸­çš„å…³ç³»</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://blog.devgenius.io/relationships-in-mongodb-927b0c24ecd0?source=collection_archive---------4-----------------------#2022-10-31">https://blog.devgenius.io/relationships-in-mongodb-927b0c24ecd0?source=collection_archive---------4-----------------------#2022-10-31</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/159a990eb207e935a7c4524ea368e64b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*T3T-wfrUg1s1K3mh.png"/></div></div></figure><p id="2b79" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">å…³äº MongoDB ä¸­çš„å…³ç³»ã€æ–¹æ³•ã€å…³ç³»ç±»å‹ã€ç¤ºä¾‹å’Œç‰¹æ€§çš„åŸºæœ¬æ–‡ç« ã€‚</p><h1 id="8c8c" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">MongoDB ä¸­çš„å…³ç³»</h1><p id="2289" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">å®¹æ˜“æ··æ·†çš„ä¸€ä¸ªæ ‡å‡†æ˜¯æœ¯è¯­éå…³ç³»æ•°æ®åº“æˆ–æ²¡æœ‰å…³ç³»çš„ NoSQLï¼Œä½†äº‹å®æ˜¯ MongoDB å‡ å¹´æ¥ä¸€ç›´å…è®¸é€šè¿‡ä¸€ä¸ªç§°ä¸ºâ€œå¼•ç”¨â€çš„æ¦‚å¿µæ¥å®ç°å…³ç³»ï¼Œç”šè‡³å®˜æ–¹æ–‡æ¡£ä¹Ÿè°ˆåˆ°å…³ç³»æ•°æ®åº“ä¸­å·²çŸ¥çš„åŸºæ•°å’Œå…¶ä»–ç‰¹å¾ï¼ŒåŒºåˆ«åœ¨äº MongoDB æ²¡æœ‰å¿ å®åœ°éµå®ˆ er(å®ä½“å…³ç³»)æ¨¡å‹å’Œå…³ç³»æ•°æ®åº“çš„å…¶ä»–ç‰¹æ€§ã€‚</p><h1 id="b7fa" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">å…³ç³»æ–¹æ³•</h1><p id="55f4" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">MongoDB ä¸­çš„å…³ç³»å¯ä»¥ç”¨ä¸¤ç§ä¸åŒçš„æ–¹æ³•å»ºæ¨¡:åµŒå…¥å…³ç³»æˆ–å¼•ç”¨å…³ç³»ï¼Œè¿™äº›æ–¹æ³•çš„é€‰æ‹©å°†å–å†³äºè§£å†³çš„è¯¡è¾©ç±»å‹å’Œæ•°æ®å»ºæ¨¡å†³ç­–ã€‚ä»¥ä¸‹æ˜¯å¯¹æ¯ç§æ–¹æ³•çš„ç®€è¦æè¿°:</p><ul class=""><li id="218c" class="lw lx in jx b jy jz kc kd kg ly kk lz ko ma ks mb mc md me bi translated"><strong class="jx io">åµŒå…¥å…³ç³»</strong>:æ¶‰åŠå­˜å‚¨åµŒå…¥çˆ¶æ–‡æ¡£ä¸­çš„å­æ–‡æ¡£çš„å…³ç³»ã€‚</li></ul><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mf"><img src="../Images/4146e27f0a34924c8f73686ad2a4062a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*3ziEdQ_O1CQ--BKWu-zt8A.png"/></div></div></figure><ul class=""><li id="4622" class="lw lx in jx b jy jz kc kd kg ly kk lz ko ma ks mb mc md me bi translated">å¼•ç”¨å…³ç³»:é€šè¿‡å¼•ç”¨è¿æ¥ä¸åŒé›†åˆçš„å…³ç³»ã€‚é€šè¿‡å…¬å…±å±æ€§æˆ–é”®è¿›è¡Œå¼•ç”¨ã€‚è¿™äº›å¼•ç”¨å¯ä»¥æœ‰ä¸¤ç§ç±»å‹ï¼›<a class="ae mk" href="https://www.mongodb.com/docs/manual/reference/database-references/#manual-references" rel="noopener ugc nofollow" target="_blank">æ‰‹åŠ¨å‚è€ƒ</a>æˆ–<a class="ae mk" href="https://www.mongodb.com/docs/manual/reference/database-references/#dbrefs" rel="noopener ugc nofollow" target="_blank"> DBRefs </a>ã€‚</li></ul><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ml"><img src="../Images/b2157e7b2b2aa63a9d84095ec58acf64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SJT9Xrh6OYnE0qZysBp7JQ.png"/></div></div></figure><p id="de62" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">è¿™äº›å…³ç³»å¯ä»¥å…·æœ‰ä»¥ä¸‹ç±»å‹çš„åŸºæ•°:</p><ul class=""><li id="fac4" class="lw lx in jx b jy jz kc kd kg ly kk lz ko ma ks mb mc md me bi translated">1:1 â€”ä¸€å¯¹ä¸€ã€‚</li><li id="ed39" class="lw lx in jx b jy mm kc mn kg mo kk mp ko mq ks mb mc md me bi translated">1:N â€”ä¸€å¯¹å¤šã€‚</li><li id="1e2b" class="lw lx in jx b jy mm kc mn kg mo kk mp ko mq ks mb mc md me bi translated">N:M â€”å¤šå¯¹å¤šã€‚</li></ul><p id="71d6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">æ³¨æ„</strong> ğŸ§:æœ¬æ–‡å°†å…³æ³¨ä¸å¼•ç”¨çš„æ–¹æ³•å’Œæ‰‹å·¥ç±»å‹çš„å…³ç³»ï¼Œå¯¹è”åˆä½¿ç”¨èšåˆæ“ä½œç¬¦ã€‚</p><h1 id="f07f" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">æŸ¥æ‰¾è¿ç®—ç¬¦</h1><p id="19eb" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">MongoDB ä¸ºæˆ‘ä»¬æä¾›çš„åˆ›å»ºæ–‡æ¡£é—´å…³ç³»çš„å·¥å…·ä¹‹ä¸€æ˜¯$lookup æ“ä½œç¬¦ã€‚è¯¥æ“ä½œç¬¦æ—¨åœ¨ä½¿ç”¨å·¦å¤–è¿æ¥æ–¹æ³•å°†ä¿¡æ¯ä»ä¸€ä¸ªæ–‡æ¡£åˆå¹¶åˆ°å¦ä¸€ä¸ªæ–‡æ¡£ã€‚</p><p id="30c8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">å¥æ³•</p><pre class="mg mh mi mj gt mr ms mt mu aw mv bi"><span id="802e" class="mw ku in ms b gy mx my l mz na">{   <br/>  $lookup: {       <br/>    from: &lt;collection to join&gt;,     <br/>    localField: &lt;field from the input documents&gt;,       <br/>    foreignField: &lt;field from "from" collection&gt;,<br/>    as: &lt;output array field&gt;     <br/>  }<br/>}</span></pre><h1 id="ed36" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">å…³ç³» 1:1</h1><p id="ead8" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">é€šè¿‡ä½¿ç”¨ç›¸åŒå€¼çš„å…±äº«é”®å±æ€§é“¾æ¥æ¥è‡ªä¸åŒé›†åˆçš„ä¸¤ä¸ªæ–‡æ¡£ï¼Œå¯ä»¥åˆ›å»ºä¸€å¯¹ä¸€çš„å…³ç³»ã€‚é€šå¸¸ï¼Œåˆ›å»ºè¿™ç§å…³ç³»çš„æœ€ä½³æ–¹å¼æ˜¯è®©å­é›†åˆæŸ¥è¯¢ç¬¬ä¸€ä¸ªé›†åˆçš„é”®å€¼ã€‚ObjectIds é€šå¸¸ç”¨äºå»ºç«‹è¿æ¥ï¼Œå°½ç®¡å®ƒå¯ä»¥æ˜¯ä»»ä½•å…¶ä»–ç±»å‹ã€‚</p><pre class="mg mh mi mj gt mr ms mt mu aw mv bi"><span id="6290" class="mw ku in ms b gy mx my l mz na">// Users collection<br/>{<br/>  "_id" : ObjectId("6342ef6f73d381100e27b8e4"),<br/>  "name" : "Juan",<br/>  "age" : 40<br/>}</span><span id="a949" class="mw ku in ms b gy nb my l mz na">// Address collection<br/>{<br/>  "_id" : ObjectId("6342efb173d381100e27b8e5"),<br/>  "street" : "Fifth Avenue",<br/>  "number" : 1421.0,<br/>  "city" : "New York",<br/>  "user_id" : ObjectId("6342ef6f73d381100e27b8e4") <br/>}</span><span id="cd6a" class="mw ku in ms b gy nb my l mz na">// Query<br/>db.getCollection("employees").aggregate({<br/>  $lookup: {<br/>    from: "address",<br/>    localField: "_id",<br/>    foreignField: "user_id",<br/>    as: "address"<br/>  }<br/>})</span><span id="e003" class="mw ku in ms b gy nb my l mz na">// Result<br/>{<br/>  "_id" : ObjectId("6342ef6f73d381100e27b8e4"),<br/>  "name" : "Juan",<br/>  "age" : 40.0,<br/>  "address" : [{<br/>    "_id" : ObjectId("6342efb173d381100e27b8e5"),<br/>    "street" : "Fifth Avenue",<br/>    "number" : 1421.0,<br/>    "city" : "New York",<br/>    "user_id" : ObjectId("6342ef6f73d381100e27b8e4")<br/>  }]<br/>}</span></pre><h1 id="359d" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">å…³ç³» 1:N</h1><p id="3bf4" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">ä¸€å¯¹å¤šå…³ç³»æ˜¯é€šè¿‡å°†ä¸€ä¸ªé›†åˆä¸­çš„æ–‡æ¡£é“¾æ¥åˆ°å¦ä¸€ä¸ªé›†åˆä¸­çš„å¤šä¸ªæ–‡æ¡£æ¥åˆ›å»ºçš„ã€‚æåˆ°è¿™ç§å…³ç³»å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å®ç°ï¼Œä½†æ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„é€‰æ‹©æ˜¯ä½¿ç”¨é€’å¢å’Œå¯å˜æ•°ç»„ï¼Œè¿™å°†åœ¨ä¸‹é¢æ˜¾ç¤ºã€‚</p><pre class="mg mh mi mj gt mr ms mt mu aw mv bi"><span id="2900" class="mw ku in ms b gy mx my l mz na">// Authors Collection<br/>{<br/>  "_id" : ObjectId("63430b9e73d381100e27b8e9"),<br/>  "name" : "J. K. Rowling",<br/>  "books" : [<br/>     ObjectId("63430b8a73d381100e27b8e7"),<br/>     ObjectId("63430b8a73d381100e27b8e8")<br/>  ]<br/>}</span><span id="f844" class="mw ku in ms b gy nb my l mz na">// Books Collection<br/>{<br/>  "_id" : ObjectId("63430b8a73d381100e27b8e7"),<br/>  "name" : "Philosopher's Stone"<br/>},<br/>{<br/>  "_id" : ObjectId("63430b8a73d381100e27b8e8"),<br/>  "name" : "Chamber of Secrets"<br/>}</span><span id="7bb5" class="mw ku in ms b gy nb my l mz na">// Query<br/>db.getCollection("authors").aggregate({<br/>  $lookup: {<br/>    from: "books",<br/>    localField: "books",<br/>    foreignField: "_id",<br/>    as: "books"<br/>  }<br/>})</span><span id="2581" class="mw ku in ms b gy nb my l mz na">// Result<br/>{<br/>  "_id" : ObjectId("63430b9e73d381100e27b8e9"),<br/>  "name" : "J. K. Rowling",<br/>  "books" : [{<br/>    "_id" : ObjectId("63430b8a73d381100e27b8e7"),<br/>    "name" : "Philosopher's Stone"<br/>  },<br/>  {<br/>    "_id" : ObjectId("63430b8a73d381100e27b8e8"),<br/>    "name" : "Chamber of Secrets"<br/>  }<br/> ]<br/>}</span></pre><h1 id="66e0" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">å…³ç³» N:M</h1><p id="6fc9" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">å¤šå¯¹å¤šå…³ç³»æ˜¯é€šè¿‡å°†ä¸€ä¸ªé›†åˆä¸­çš„å¤šä¸ªæ–‡æ¡£ä¸å¦ä¸€ä¸ªé›†åˆä¸­çš„å¤šä¸ªæ–‡æ¡£ç›¸å…³è”æ¥åˆ›å»ºçš„ã€‚åŒæ ·ï¼Œä¸ºäº†å®ç°è¿™ç§å…³ç³»ï¼Œä½¿ç”¨äº†å‡ ç§ç­–ç•¥ï¼Œå…¶ä¸­å¯¹äºç¤ºä¾‹ï¼Œæˆ‘ä»¬å°†ç»§ç»­ä½¿ç”¨é€’å¢å’Œå¯å˜çŸ©é˜µã€‚</p><pre class="mg mh mi mj gt mr ms mt mu aw mv bi"><span id="a755" class="mw ku in ms b gy mx my l mz na">// Orders collection<br/>{<br/>  "_id" : ObjectId("634312b873d381100e27b8ea"),<br/>  "company" : "Microsoft",<br/>  "products" : [<br/>    ObjectId("634312f073d381100e27b8ec"),<br/>    ObjectId("634312f073d381100e27b8ed")<br/>  ]<br/>},<br/>{<br/>  "_id" : ObjectId("634312b873d381100e27b8eb"),<br/>  "company" : "Apple",<br/>  "products" : [<br/>    ObjectId("634312f073d381100e27b8ed")<br/>  ]<br/>}</span><span id="2954" class="mw ku in ms b gy nb my l mz na">// Products collection<br/>{<br/>  "_id" : ObjectId("634312f073d381100e27b8ec"),<br/>  "name" : "Mouse logitech",<br/>  "orders" : [<br/>    ObjectId("634312b873d381100e27b8ea")<br/>  ]<br/>},<br/>{<br/>  "_id" : ObjectId("634312f073d381100e27b8ed"),<br/>  "name" : "Keyboard logitech",<br/>  "orders" : [<br/>    ObjectId("634312b873d381100e27b8ea"),<br/>    ObjectId("634312b873d381100e27b8eb")<br/>  ]<br/>}</span><span id="8ed5" class="mw ku in ms b gy nb my l mz na">// Query( can be queried from both endsm the example only products )<br/>db.getCollection("products").aggregate({<br/>  $lookup: {<br/>   from: "orders",<br/>   localField: "orders",<br/>   foreignField: "_id",<br/>   as: "orders"<br/>  }<br/> }<br/>)</span><span id="2144" class="mw ku in ms b gy nb my l mz na">// Result<br/>{<br/>  "_id" : ObjectId("634312f073d381100e27b8ec"),<br/>  "name" : "Mouse logitech",<br/>  "orders" : [{<br/>    "_id" : ObjectId("634312b873d381100e27b8ea"),<br/>    "company" : "Microsoft",<br/>    "products" : [<br/>      ObjectId("634312f073d381100e27b8ec"),<br/>      ObjectId("634312f073d381100e27b8ed")<br/>     ]<br/>   }<br/> ]<br/>},<br/>{<br/>  "_id" : ObjectId("634312f073d381100e27b8ed"),<br/>  "name" : "Keyboard logitech",<br/>  "orders" : [{<br/>    "_id" : ObjectId("634312b873d381100e27b8ea"),<br/>    "company" : "Microsoft",<br/>    "products" : [<br/>      ObjectId("634312f073d381100e27b8ec"),<br/>      ObjectId("634312f073d381100e27b8ed")<br/>    ]<br/>   },<br/>   {<br/>   "_id" : ObjectId("634312b873d381100e27b8eb"),<br/>   "company" : "Apple",<br/>   "products" : [<br/>     ObjectId("634312f073d381100e27b8ed")<br/>    ]<br/>   }<br/>  ]<br/>}</span></pre><h1 id="7838" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">MongoDB ä¸­çš„å…³ç³»èµ„æº</h1><ul class=""><li id="a25b" class="lw lx in jx b jy lr kc ls kg nc kk nd ko ne ks mb mc md me bi translated"><a class="ae mk" href="https://www.mongodb.com/docs/manual/applications/data-models/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io">MongoDB</strong></a>ä¸­çš„æ¨¡å‹æ•°æ®å’Œæ¨¡å¼:ç»“æ„ç­–ç•¥ï¼Œä¾‹å­ï¼Œæœ€å¸¸è§çš„æ¨¡å¼ã€‚</li><li id="b8ed" class="lw lx in jx b jy mm kc mn kg mo kk mp ko mq ks mb mc md me bi translated"><a class="ae mk" href="https://www.mongodb.com/docs/manual/reference/operator/aggregation/lookup/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io">$æŸ¥æ‰¾è¿ç®—ç¬¦</strong> </a>:å®šä¹‰ã€è¯­æ³•å’Œç¤ºä¾‹ã€‚</li></ul></div><div class="ab cl nf ng hr nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ig ih ii ij ik"><p id="6ee2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">æ„Ÿè°¢ä½ è¿œé“è€Œæ¥ï¼Œå¦‚æœä½ è§‰å¾—è¿™å¾ˆæœ‰ç”¨ï¼Œåˆ«å¿˜äº†é¼“æŒğŸ‘ã€‚è®¢é˜…ä»¥æ¥æ”¶æ›´å¤šå†…å®¹ğŸ””ã€‚</p><p id="532c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">å¦‚æœä½ éœ€è¦é¢å¤–çš„å¸®åŠ©ï¼Œè¯·è”ç³»æˆ‘ğŸ¤ ã€‚</p><ul class=""><li id="60b4" class="lw lx in jx b jy jz kc kd kg ly kk lz ko ma ks mb mc md me bi translated">âœ‰ï¸ <a class="ae mk" href="mailto:dcortes.net@gmail.com" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">ç»™æˆ‘å‘é‚®ä»¶</strong> </a></li><li id="323a" class="lw lx in jx b jy mm kc mn kg mo kk mp ko mq ks mb mc md me bi translated">ğŸ¤<a class="ae mk" href="https://www.linkedin.com/in/dcortesnet/" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">åœ¨ LinkedIn ä¸Šè”ç³»æˆ‘</strong> </a></li><li id="cbe1" class="lw lx in jx b jy mm kc mn kg mo kk mp ko mq ks mb mc md me bi translated">ğŸ“®<a class="ae mk" href="https://twitter.com/dcortes_net" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">åœ¨ Twitter ä¸Šè”ç³»æˆ‘</strong> </a></li></ul><p id="0dc2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">éå¸¸æ„Ÿè°¢æ‚¨çš„é˜…è¯»ï¼Œæˆ‘æ„Ÿè°¢æ‚¨çš„æ—¶é—´ã€‚</p></div></div>    
</body>
</html>