<html>
<head>
<title>Serve Python App on Nginx</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 Nginx 上提供 Python 应用</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/serve-python-app-on-nginx-6bc57ceaed4c?source=collection_archive---------1-----------------------#2022-03-03">https://blog.devgenius.io/serve-python-app-on-nginx-6bc57ceaed4c?source=collection_archive---------1-----------------------#2022-03-03</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="d19b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">读者们好，在这篇博客中，我将使用 flask 框架创建一个 python 应用程序，并将其设置在 Gunicorn 应用服务器上，启动该应用程序并配置 Nginx web 服务器。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b6032f8c6d43e48f55d0c8e166e15fe1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*s8pDWBcAmnmmw7g9.png"/></div></div></figure><blockquote class="ku kv kw"><p id="9e13" class="jk jl kx jm b jn jo jp jq jr js jt ju ky jw jx jy kz ka kb kc la ke kf kg kh ig bi translated"><strong class="jm io">第一步:安装 python 虚拟环境的 python pip3 等包。</strong></p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lb"><img src="../Images/e4ecdfc500c702e15c7d5ce23c8a0cc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XqKr3s2GUtxIw4wZ"/></div></div></figure><blockquote class="ku kv kw"><p id="8402" class="jk jl kx jm b jn jo jp jq jr js jt ju ky jw jx jy kz ka kb kc la ke kf kg kh ig bi translated"><strong class="jm io">第二步:创建 python 虚拟环境</strong></p></blockquote><p id="c92d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">什么是 python 虚拟环境？</strong></p><ul class=""><li id="3f22" class="lc ld in jm b jn jo jr js jv le jz lf kd lg kh lh li lj lk bi translated">当您在使用相同包的不同版本的不同 python 项目上工作时，这很有用。因此，在这种情况下，虚拟环境有助于分别维护两个项目的依赖关系。它将创建两个不同的环境，并将每个项目的依赖关系保持在特定环境的范围内。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ll"><img src="../Images/278531369c7d0fef71487ab10dae3279.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*owV4tQv_tPoUDiHx"/></div></div></figure><p id="3911" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在创建一个目录并移入目录，在该目录中创建一个虚拟环境来存储 python 项目需求。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lm"><img src="../Images/5c8359f083ec01b2f2990226cf139939.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/0*u_YRyvlyQ5m-jwUL"/></div></figure><p id="52b9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">激活环境</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/d6609ff4cd38f4ebb478efd850a222fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/0*xUxMjizo00Hz6mfg"/></div></figure><blockquote class="ku kv kw"><p id="959d" class="jk jl kx jm b jn jo jp jq jr js jt ju ky jw jx jy kz ka kb kc la ke kf kg kh ig bi translated"><strong class="jm io">步骤 3:设置烧瓶应用程序</strong></p></blockquote><p id="6140" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这里，我们将安装 flask 和 gunicorn，并创建一个简单的应用程序。</p><p id="4ba3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> Flask: </strong>它是 python 的一个 web 框架，用于在 python 中构建 web 应用。</p><p id="97c9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> Gunicorn: </strong>它是一个纯 python 的 HTTP server WSGI 应用。</p><p id="dc45" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> WSGI: </strong>它是一个 web 服务器网关接口。它用于将来自 web 服务器(如 Apache 或 NGINX)的请求转发到后端 Python web 应用程序或框架。</p><p id="31dd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">安装车轮</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lo"><img src="../Images/93ea72ee8c16085f435e8bd05d7c843d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/0*U5iI7qjCrLQTFIuW"/></div></div></figure><p id="680e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">安装喷枪和烧瓶</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lp"><img src="../Images/adb5dddab4b9bc1ce4c8d17b553b1b0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2GvMl90496YbkE1M"/></div></div></figure><p id="647f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">使用 flask 创建一个示例 web 应用程序。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lp"><img src="../Images/28935b1878c41bec649fea74f3395236.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ngbkJiDJRH7bzVy8"/></div></div></figure><p id="9dfe" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">允许接入端口为 5000。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/ecc38ab0b7fbfb35a1195a042250e9bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/0*GRajiBChj24RKD2D"/></div></figure><p id="4155" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">测试应用程序</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi gj"><img src="../Images/1867ce1bb7d896c6262f3088bd28db63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CNHX4y1pnYWjZ9YX"/></div></div></figure><p id="0633" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们可以看到它正在 5000 端口上运行。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lr"><img src="../Images/71d1289ca4e6ae4a9f7ede6ed5df20e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zJ8t7325_hms1A7G"/></div></div></figure><p id="04e8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">创建 WSGI 入口点</p><p id="72ac" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">创建一个文件作为应用程序的入口点。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ls"><img src="../Images/a98ae30233df5f671b093dc0ab41854f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DSti-d3RKH2xYEnn"/></div></div></figure><blockquote class="ku kv kw"><p id="3f55" class="jk jl kx jm b jn jo jp jq jr js jt ju ky jw jx jy kz ka kb kc la ke kf kg kh ig bi translated"><strong class="jm io">步骤 4:配置 Gunicorn </strong></p></blockquote><p id="2722" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">传递入口点的名称</p><p id="b50b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">还要指定要绑定的接口和端口，以便应用程序可以在公共可用的接口上启动。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lt"><img src="../Images/92c74181d1e6cee1c43fb93dcbd93352.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RYd3Bj6d27P_wutE"/></div></div></figure><p id="44e9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">您可以看到它正在使用 Gunicorn 服务器运行</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lu"><img src="../Images/02a2e022c6397e8a53a06bf40bb606b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XzszIgwWboDap5es"/></div></div></figure><p id="3b73" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">创建 systemd 服务单元文件，以便在服务器重新启动时自动启动 Gunicorn 和 server flask web 应用程序。</p><p id="b476" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">【单元】:</strong>该部分用于指定元数据和依赖关系。</p><p id="f0cf" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">【服务】:</strong>这个部分将指定我们想要运行的用户和组。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lp"><img src="../Images/5769166c14a7bc8de59a96fe690537a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fguKFaaDZGF_eVYo"/></div></div></figure><p id="9585" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">启动并启用服务</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/233960409ff72b17a3a2b49de7ffd497.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pdFAMwzeT09K1VbT"/></div></div></figure><blockquote class="ku kv kw"><p id="6d33" class="jk jl kx jm b jn jo jp jq jr js jt ju ky jw jx jy kz ka kb kc la ke kf kg kh ig bi translated"><strong class="jm io">步骤 5:配置 Nginx 来代理请求</strong></p></blockquote><p id="9b4f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在站点可用文件夹中创建一个文件并传递代理</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/3109da7710b7affed3719ad1cff8eb47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PUcxTtqs23wPBigW"/></div></div></figure><p id="8872" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">创建一个软链接</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lw"><img src="../Images/a28c0bc207bd5d4769fc4fdaa36251fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XFHTdJK75uhCSzZj"/></div></div></figure><p id="1b10" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">编辑主机文件，并在该文件中为您的域添加主机</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/72b13bf3db438346fbf4d76fa606464a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HnS2vCfmHtx2UX9j"/></div></div></figure><p id="2940" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">检查 nginx 中的语法</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/993a1aaeb177e88b8b9e51546557bf7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/0*t_1baLOrYTJIj3BM"/></div></figure><p id="6926" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">授予对 nginx 的完全访问权限</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/0b7200c7286dde1bde4632a21f1b799d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/0*csbcEqna5RgvDDOk"/></div></figure><p id="2544" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">重启 nginx 并在浏览器中输入 krupa.local，它将服务于您的 python 应用程序。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lz"><img src="../Images/642814e5315a392d0b92be6bcaaaec4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*44ARg2doC7jwFDMW"/></div></div></figure><p id="b1b6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">谢谢大家！！！</p></div></div>    
</body>
</html>