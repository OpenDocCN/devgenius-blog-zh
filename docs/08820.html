<html>
<head>
<title>Build an uNFT marketplace with Next.js, Cosmic and Stripe integration</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用 Next.js、Cosmic 和 Stripe 集成构建 uNFT 市场</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/build-an-unft-marketplace-with-next-js-cosmic-and-stripe-integration-9fdfc872c1e8?source=collection_archive---------13-----------------------#2022-07-12">https://blog.devgenius.io/build-an-unft-marketplace-with-next-js-cosmic-and-stripe-integration-9fdfc872c1e8?source=collection_archive---------13-----------------------#2022-07-12</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><figure class="im in gp gr io ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/f2732716ad5c3b1c2bce94c4834d1bd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*p0DNH5e9fmSIOSbr6RbBqQ.gif"/></div></div></figure><div class=""/><p id="ce13" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在本教程中，我将向您展示如何使用 Next.js、Cosmic 和 Stripe 构建一个市场应用程序。完成后，您将具备使用这些强大工具构建自己项目的基础。让我们开始吧。</p><p id="b940" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">额外的功能包括部署到<a class="ae kt" href="https://vercel.com/" rel="noopener ugc nofollow" target="_blank"> Vercel </a>，黑暗和光明模式，并使用<a class="ae kt" href="https://www.searchmetrics.com/glossary/google-lighthouse/" rel="noopener ugc nofollow" target="_blank"> Lighthouse </a>来衡量网站的<a class="ae kt" href="https://web.dev/vitals/" rel="noopener ugc nofollow" target="_blank">核心 web 生命指标</a>的性能，这大大增加了用户的体验和<a class="ae kt" href="https://nextjs.org/learn/seo/introduction-to-seo/webcrawlers" rel="noopener ugc nofollow" target="_blank">网站在 SEO 搜索结果中的可见性</a>(该应用的 Lighthouse 得分如下所示)。</p><figure class="kv kw kx ky gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi ku"><img src="../Images/8287ddd73e0789e9edd28dabb7977de6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yyH65T8WQeZl_gK9"/></div></div></figure><p id="0416" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">亲们，如果喜欢请<a class="ae kt" href="https://www.producthunt.com/posts/unft-marketplace" rel="noopener ugc nofollow" target="_blank"> <strong class="jx iz">在<a class="ae kt" href="https://www.producthunt.com/posts/unft-marketplace" rel="noopener ugc nofollow" target="_blank"> <strong class="jx iz">品猎</strong> </a>中向上投</strong> </a>。</p><h2 id="18f4" class="kz la iy bd lb lc ld dn le lf lg dp lh kg li lj lk kk ll lm ln ko lo lp lq lr bi translated">我们将使用的工具</h2><ul class=""><li id="3725" class="ls lt iy jx b jy lu kc lv kg lw kk lx ko ly ks lz ma mb mc bi translated"><a class="ae kt" href="https://nextjs.org/" rel="noopener ugc nofollow" target="_blank"> Next.js </a> —可扩展的高性能<strong class="jx iz"> React.js </strong>现代 web 开发框架。提供大量现成的功能，如混合渲染、路由预取、自动图像优化和国际化。</li><li id="4b8f" class="ls lt iy jx b jy md kc me kg mf kk mg ko mh ks lz ma mb mc bi translated"><a class="ae kt" href="https://www.cosmicjs.com/" rel="noopener ugc nofollow" target="_blank"> Cosmic </a> —快速、全面管理的<a class="ae kt" href="https://www.cosmicjs.com/headless-cms" rel="noopener ugc nofollow" target="_blank"> headless CMS </a>，使我们能够快速管理和创建网站内容，包括 UGC(用户生成的内容)。</li><li id="874b" class="ls lt iy jx b jy md kc me kg mf kk mg ko mh ks lz ma mb mc bi translated"><a class="ae kt" href="https://stripe.com/" rel="noopener ugc nofollow" target="_blank"> Stripe </a> —支付基础设施，提供 API 工具以接收一次性和订阅支付。</li></ul><h2 id="27e2" class="kz la iy bd lb lc ld dn le lf lg dp lh kg li lj lk kk ll lm ln ko lo lp lq lr bi translated">TL；速度三角形定位法(dead reckoning)</h2><p id="5e4e" class="pw-post-body-paragraph jv jw iy jx b jy lu ka kb kc lv ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated"><a class="ae kt" href="https://github.com/cosmicjs/unft-marketplace" rel="noopener ugc nofollow" target="_blank">查看代码</a> <br/> <a class="ae kt" href="https://unft-marketplace-cosmicjs.vercel.app/" rel="noopener ugc nofollow" target="_blank">查看现场演示</a> <br/> <a class="ae kt" href="https://www.cosmicjs.com/apps/unft-marketplace" rel="noopener ugc nofollow" target="_blank">安装 app 模板</a></p><figure class="kv kw kx ky gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi ku"><img src="../Images/03590ce66edc7b85956d128e3ce5c343.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IUEfBWemQ1M0E3bN"/></div></div></figure><h2 id="12cc" class="kz la iy bd lb lc ld dn le lf lg dp lh kg li lj lk kk ll lm ln ko lo lp lq lr bi translated">首先，我们需要提供架构和设计</h2><blockquote class="ml mm mn"><p id="f30a" class="jv jw mo jx b jy jz ka kb kc kd ke kf mp kh ki kj mq kl km kn mr kp kq kr ks ig bi translated">设计从根本上讲就是把东西拆开，然后再组装起来。把东西分成可以组合的东西，这就是设计。— <a class="ae kt" href="https://www.infoq.com/presentations/Design-Composition-Performance/" rel="noopener ugc nofollow" target="_blank">里奇希基</a>。</p></blockquote><h2 id="ae22" class="kz la iy bd lb lc ld dn le lf lg dp lh kg li lj lk kk ll lm ln ko lo lp lq lr bi translated"><a class="ae kt" href="https://www.freecodecamp.org/news/the-model-view-controller-pattern-mvc-architecture-and-frameworks-explained/" rel="noopener ugc nofollow" target="_blank"> MVC </a>代表模型-视图-控制器软件设计模式</h2><p id="f0ce" class="pw-post-body-paragraph jv jw iy jx b jy lu ka kb kc lv ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">以下是每个组件的含义:</p><ul class=""><li id="1ecb" class="ls lt iy jx b jy jz kc kd kg ms kk mt ko mu ks lz ma mb mc bi translated"><strong class="jx iz">模型</strong>:包含所有数据逻辑的后端。<a class="ae kt" href="https://docs.cosmicjs.com/#use-cases" rel="noopener ugc nofollow" target="_blank"> Cosmic </a>对象类型(<strong class="jx iz"> Multiple 或 Singleton </strong>)帮助我们创建动态的、可伸缩的数据结构，它们转换的本质独立于外部世界。</li><li id="508f" class="ls lt iy jx b jy md kc me kg mf kk mg ko mh ks lz ma mb mc bi translated"><strong class="jx iz">视图(UI) </strong>:前端或图形用户界面(GUI)。对于它，我们使用 React，它被描述为 MVC 中的“<strong class="jx iz">V”</strong>层。</li><li id="67c1" class="ls lt iy jx b jy md kc me kg mf kk mg ko mh ks lz ma mb mc bi translated"><strong class="jx iz">控制器</strong>:应用程序的大脑控制数据如何显示。我们使用 React 的上下文 API 将状态从呈现视图中分离出来，并促进业务逻辑的重用。</li></ul><figure class="kv kw kx ky gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi ku"><img src="../Images/6b1e44cd182587cd125ac5c08dd38391.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TJL3rOIxtHwJF_zi"/></div></div></figure><p id="614a" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">MVC 模式用于现代 web 应用程序，因为它允许应用程序可伸缩、可维护且易于扩展。</p><h2 id="5895" class="kz la iy bd lb lc ld dn le lf lg dp lh kg li lj lk kk ll lm ln ko lo lp lq lr bi translated">使用 Next.js 设置项目</h2><p id="9b72" class="pw-post-body-paragraph jv jw iy jx b jy lu ka kb kc lv ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated"><strong class="jx iz"> Next.js </strong>着手改善两件事:<strong class="jx iz">开发者和用户体验</strong>并且是一个完整的工具包来构建超快的反应应用。Next.js 提供了一种抽象，可以解决最常见、最普通、最复杂的任务，比如路由、内部化和图像优化。默认情况下，Next.js 会预先呈现每个页面。这意味着 Next.js <em class="mo">提前为每个页面生成 HTML</em>，而不是由客户端 JavaScript 来完成。预渲染可以带来更好的性能和 SEO。<br/> Next.js 有<a class="ae kt" href="https://nextjs.org/learn/basics/data-fetching/two-forms" rel="noopener ugc nofollow" target="_blank">预渲染</a>两种形式:<a class="ae kt" href="https://nextjs.org/docs/basic-features/pages#static-generation-recommended" rel="noopener ugc nofollow" target="_blank"> <strong class="jx iz">静态生成</strong></a><strong class="jx iz">【SSG】</strong><a class="ae kt" href="https://nextjs.org/docs/basic-features/pages#server-side-rendering" rel="noopener ugc nofollow" target="_blank"><strong class="jx iz">服务器端渲染</strong> </a> <strong class="jx iz"> (SSR) </strong>。</p><ul class=""><li id="5e6c" class="ls lt iy jx b jy jz kc kd kg ms kk mt ko mu ks lz ma mb mc bi translated"><a class="ae kt" href="https://nextjs.org/docs/basic-features/pages#static-generation-recommended" rel="noopener ugc nofollow" target="_blank"> <strong class="jx iz">静态生成</strong> </a>是在<strong class="jx iz">构建时间</strong>生成 HTML 的预渲染方法。预渲染的 HTML 然后在每个请求中被<em class="mo">重用</em>。</li><li id="2da4" class="ls lt iy jx b jy md kc me kg mf kk mg ko mh ks lz ma mb mc bi translated"><a class="ae kt" href="https://nextjs.org/docs/basic-features/pages#server-side-rendering" rel="noopener ugc nofollow" target="_blank"> <strong class="jx iz">服务器端渲染</strong> </a>是针对<strong class="jx iz">每个请求</strong>生成 HTML 的预渲染方法。</li></ul><p id="653b" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在我们的项目中，我们使用<a class="ae kt" href="https://nextjs.org/docs/basic-features/pages#server-side-rendering" rel="noopener ugc nofollow" target="_blank"> <strong class="jx iz">服务器端渲染</strong> </a>来处理动态数据和总是最新的预渲染页面。</p><figure class="kv kw kx ky gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi ku"><img src="../Images/3a63f0ea9cf3f8b263834ec572634fbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hyVfVheb76p4wSek"/></div></div></figure><p id="4d30" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">首先，我们将创建一个包含工具和配置的<a class="ae kt" href="https://nextjs.org/docs" rel="noopener ugc nofollow" target="_blank"> Next.js </a>应用程序。对于本教程，您将需要<a class="ae kt" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank"> Node.js </a> 12.22.0 或更高版本。打开终端，粘贴或键入</p><pre class="kv kw kx ky gt mv mw mx my aw mz bi"><span id="ba2a" class="kz la iy mw b gy na nb l nc nd">npx create-next-app@latest unft-marketplace <br/>#or <br/>yarn create next-app unft-marketplace</span></pre><p id="e570" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">进入新目录，使用包管理器如<code class="fe ne nf ng mw b">npm</code>、<code class="fe ne nf ng mw b">yarn</code>或<code class="fe ne nf ng mw b">pnpm</code>安装依赖项，然后在开发模式下启动应用程序:</p><pre class="kv kw kx ky gt mv mw mx my aw mz bi"><span id="3d12" class="kz la iy mw b gy na nb l nc nd">cd unft-marketplace <br/>npm install cosmicjs stripe @stripe/stripe-js sass <br/>npm run dev <br/># or <br/>yarn dev</span></pre><figure class="kv kw kx ky gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi ku"><img src="../Images/08d167dbcb8fe4233c90b626d690af67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7wJSxj34v6LHmOEJ"/></div></div></figure><p id="e7d9" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">要使用模板 UI，您需要在<a class="ae kt" href="https://github.com/cosmicjs/unft-marketplace" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上克隆它。打开终端，粘贴或键入此代码以安装所有依赖项，然后运行它。</p><pre class="kv kw kx ky gt mv mw mx my aw mz bi"><span id="0a8f" class="kz la iy mw b gy na nb l nc nd">git clone https://github.com/cosmicjs/unft-marketplace <br/>cd unft-marketplace <br/>npm install <br/>#or <br/>yarn install </span><span id="d8eb" class="kz la iy mw b gy nh nb l nc nd">npm run dev <br/>#or <br/>yarn dev</span></pre><p id="2ab2" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在浏览器中打开<a class="ae kt" href="http://localhost:3000/" rel="noopener ugc nofollow" target="_blank"> http://localhost:3000 </a>查看禁欲者主页。</p><h2 id="a09a" class="kz la iy bd lb lc ld dn le lf lg dp lh kg li lj lk kk ll lm ln ko lo lp lq lr bi translated">使用 Next.js 管理应用编程接口密钥/秘密</h2><p id="b6d8" class="pw-post-body-paragraph jv jw iy jx b jy lu ka kb kc lv ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">当使用 API 密钥和秘密时，我们需要确保我们将它们保密并且不受版本控制，同时方便地将它们作为<code class="fe ne nf ng mw b">.env</code>变量使用。您需要在项目的根目录下创建一个. env 文件。登录<a class="ae kt" href="https://app.cosmicjs.com/" rel="noopener ugc nofollow" target="_blank">宇宙</a>，从<code class="fe ne nf ng mw b">Bucket Settings &gt; API Access</code>取以下值:</p><pre class="kv kw kx ky gt mv mw mx my aw mz bi"><span id="518f" class="kz la iy mw b gy na nb l nc nd">NEXT_PUBLIC_COSMIC_BUCKET_SLUG=your_cosmic_slug<br/>NEXT_PUBLIC_COSMIC_READ_KEY=your_cosmic_read_key<br/>COSMIC_WRITE_KEY=your_cosmic_write_key</span><span id="cbbb" class="kz la iy mw b gy nh nb l nc nd">NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=your_stripe_key<br/>STRIPE_SECRET_KEY=your_stripe_secret_key</span></pre><p id="b572" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">前缀<code class="fe ne nf ng mw b">NEXT_PUBLIC_</code>自动向浏览器公开这个变量。Next.js 将在构建/呈现时将这些值插入到公开可见的源代码中。因此，请确保不要将此前缀用于秘密值！以同样的方式登录到<a class="ae kt" href="https://dashboard.stripe.com/login" rel="noopener ugc nofollow" target="_blank">条纹</a>和<strong class="jx iz">的开发者</strong>部分拿走你的钥匙。</p><p id="3c72" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">前缀<code class="fe ne nf ng mw b">NEXT_PUBLIC_</code>自动向浏览器公开这个变量。Next.js 将在构建/呈现时将这些值插入到公开可见的源代码中。因此，请确保不要将此前缀用于秘密值！以同样的方式登录到<a class="ae kt" href="https://dashboard.stripe.com/login" rel="noopener ugc nofollow" target="_blank">条纹</a>和<strong class="jx iz">开发者</strong>部分拿走你的钥匙。</p><h2 id="7e8e" class="kz la iy bd lb lc ld dn le lf lg dp lh kg li lj lk kk ll lm ln ko lo lp lq lr bi translated">Next.js API 路由</h2><p id="18ec" class="pw-post-body-paragraph jv jw iy jx b jy lu ka kb kc lv ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">Next.js <a class="ae kt" href="https://nextjs.org/docs/api-routes/introduction" rel="noopener ugc nofollow" target="_blank"> API 路由</a>以在 Next.js 应用内创建 API 端点。它们将被部署为<strong class="jx iz">无服务器功能</strong>(也称为<strong class="jx iz">T21)。在我们的例子中，为了通过参数过滤宇宙内容，我们将在<code class="fe ne nf ng mw b">pages/api</code>目录中创建一个名为<code class="fe ne nf ng mw b">filter.js</code>的文件，其格式如下:</strong></p><figure class="kv kw kx ky gt ip"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="1d23" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">Next.js <a class="ae kt" href="https://nextjs.org/docs/api-routes/introduction" rel="noopener ugc nofollow" target="_blank"> API 路由</a>以在 Next.js 应用内创建 API 端点。它们将被部署为<strong class="jx iz">无服务器功能</strong>(也称为<strong class="jx iz"> Lambdas </strong>)。在我们的例子中，为了通过参数过滤宇宙内容，我们将在<code class="fe ne nf ng mw b">pages/api</code>目录中创建一个名为<code class="fe ne nf ng mw b">filter.js</code>的文件，其格式如下:</p><p id="bee9" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">注意<code class="fe ne nf ng mw b">req</code>是<a class="ae kt" href="https://nodejs.org/api/http.html#http_class_http_incomingmessage" rel="noopener ugc nofollow" target="_blank"> http 的一个实例。IncomingMessage </a>，加上一些预建的<a class="ae kt" href="https://nextjs.org/docs/api-routes/api-middlewares" rel="noopener ugc nofollow" target="_blank">中间件</a>和<code class="fe ne nf ng mw b">res</code>就是<a class="ae kt" href="https://nodejs.org/api/http.html#http_class_http_serverresponse" rel="noopener ugc nofollow" target="_blank"> http 的一个实例。ServerResponse </a>，加上一些<a class="ae kt" href="https://nextjs.org/docs/api-routes/response-helpers" rel="noopener ugc nofollow" target="_blank">辅助函数</a>。</p><figure class="kv kw kx ky gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi ku"><img src="../Images/cdc34eb0499256da69943513799d61c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fFkVUr_veO_9kzei.gif"/></div></div></figure><h1 id="73b4" class="nk la iy bd lb nl nm nn le no np nq lh nr ns nt lk nu nv nw ln nx ny nz lq oa bi translated">宇宙特征概述和集成</h1><p id="d2b3" class="pw-post-body-paragraph jv jw iy jx b jy lu ka kb kc lv ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">Cosmic 是一个很棒的无头 CMS，它使我们能够在一个方便的托管仪表板中建模、管理和存储我们的内容和媒体，然后使用可用的 API 工具获取我们的内容。API 提供了现成的搜索和过滤功能，这使得在我们的应用程序中构建搜索和过滤功能变得很容易。<strong class="jx iz"> Cosmic 为创建互动、独立和动态的网站提供完整的现代功能和特性</strong>。</p><figure class="kv kw kx ky gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi ku"><img src="../Images/450d8c9d1a0ea46a96228e1b50724e0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GKdD0SVwKyWfA69-"/></div></div></figure><p id="a3fe" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx iz">可定制的 API </strong> —从管理仪表板为 API 构建模式、模型和控制器。为了方便起见，Cosmic 提供了 REST 和 graph QL API。<br/> <strong class="jx iz"> Webhooks </strong> —在任何需要的地方回拨，获得开箱即用的功能。<br/> <a class="ae kt" href="https://docs.cosmicjs.com/examples/basic-queries" rel="noopener ugc nofollow" target="_blank"> <strong class="jx iz">查询</strong> </a> —允许您通过<strong class="jx iz">搜索、过滤和排序</strong>找到您数据中的正确资产。您可以使用一些<a class="ae kt" href="https://docs.cosmicjs.com/examples/advanced-queries" rel="noopener ugc nofollow" target="_blank">高级查询</a>来创建更精细的搜索功能。<br/> <a class="ae kt" href="https://docs.cosmicjs.com/examples/add-media" rel="noopener ugc nofollow" target="_blank"> <strong class="jx iz">添加媒体和对象</strong> </a> —您可以使用 Cosmic API 在应用程序中启用用户生成的内容。用户可以在您定义的数据模型中上传和创建交互式内容。Cosmic 不仅是一个完全托管的内容管理系统，而且 API 还可以用于创建用户生成的内容体验。</p><h2 id="d14e" class="kz la iy bd lb lc ld dn le lf lg dp lh kg li lj lk kk ll lm ln ko lo lp lq lr bi translated">宇宙入门</h2><p id="b3da" class="pw-post-body-paragraph jv jw iy jx b jy lu ka kb kc lv ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">第一步是创建一个<a class="ae kt" href="https://app.cosmicjs.com/signup" rel="noopener ugc nofollow" target="_blank">免费宇宙账户</a>到<a class="ae kt" href="https://app.cosmicjs.com/signup" rel="noopener ugc nofollow" target="_blank">宇宙仪表盘</a>和一个新项目。让我们选择“从头开始”选项。</p><figure class="kv kw kx ky gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi ku"><img src="../Images/844af254212127ba33b22e82ccbae689.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*O0nbh03ediI1EBhg"/></div></div></figure><p id="d5ac" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><a class="ae kt" href="https://docs.cosmicjs.com/#use-cases" rel="noopener ugc nofollow" target="_blank">宇宙</a>对象类型(<strong class="jx iz">多个或单个</strong>)帮助我们创建动态的、可伸缩的、可重用的数据结构和内容模型。创建模型部分，从零开始很容易，定义了“内容模型”中的“元字段”。对于跨多个对象使用的可重用模型，选择<strong class="jx iz">多对象类型</strong>。对于我们的项目，我们将创建一个可重用的<strong class="jx iz">产品</strong>对象类型<strong class="jx iz">模型</strong>，使用<strong class="jx iz">多个</strong>对象与<strong class="jx iz">类别</strong>的关系。这将使我们能够将<strong class="jx iz">产品</strong>添加到<strong class="jx iz">类别</strong>或从中删除，并能够按类别进行搜索和过滤。</p><figure class="kv kw kx ky gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi ku"><img src="../Images/22da0782ef420a77c935001d3d9ae431.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*30sySHWrAmJ-EIxc"/></div></div></figure><p id="88c8" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在为我们的产品创建内容模型之后，您可以开始从仪表板添加产品，如下所示:</p><figure class="kv kw kx ky gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi ku"><img src="../Images/9391677017c6497cc8bc75c4b9e3df31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*s7Xs3o57jg4DAtv5"/></div></div></figure><p id="64d4" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">您可以通过按照以下模式设计创建对象类型来定义其他内容模型:</p><ul class=""><li id="9979" class="ls lt iy jx b jy jz kc kd kg ms kk mt ko mu ks lz ma mb mc bi translated">唯一模型的单例，</li><li id="456a" class="ls lt iy jx b jy md kc me kg mf kk mg ko mh ks lz ma mb mc bi translated">可重用模型的倍数。</li></ul><p id="ebca" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">使用 Cosmic <a class="ae kt" href="https://docs.cosmicjs.com/examples/basic-queries" rel="noopener ugc nofollow" target="_blank">查询</a>，您可以根据<strong class="jx iz">搜索、过滤和排序</strong>标准快速找到特定内容。</p><figure class="kv kw kx ky gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi ku"><img src="../Images/6878655f921fa3cf5eafd5e6848cc160.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*duIFnvBuXhpgLIP9"/></div></div></figure><h2 id="da6f" class="kz la iy bd lb lc ld dn le lf lg dp lh kg li lj lk kk ll lm ln ko lo lp lq lr bi translated">用户生成的内容</h2><p id="dd7d" class="pw-post-body-paragraph jv jw iy jx b jy lu ka kb kc lv ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">使用 Cosmic 功能向<a class="ae kt" href="https://docs.cosmicjs.com/examples/add-media" rel="noopener ugc nofollow" target="_blank"> <strong class="jx iz">添加媒体和对象</strong> </a> <strong class="jx iz">、</strong>登录的用户可以上传和创建他们自己的表单提交的内容。对于我们的用例，用户可以创建新的<strong class="jx iz">产品</strong>添加到市场上销售。</p><figure class="kv kw kx ky gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi ku"><img src="../Images/3cdf478597800f7dd714fd378f26ad4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CHblTTnPZigFi2TB"/></div></div></figure><p id="3c03" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">将文件和动态内容上传到 Next.js 需要 API 路由，因为我们需要将密钥安全地存储在服务器端环境变量中。下面简单介绍一下如何用 React 和<a class="ae kt" href="https://nextjs.org/docs/api-routes/introduction" rel="noopener ugc nofollow" target="_blank"> Next.js API routes </a>使用<code class="fe ne nf ng mw b">formidable</code>、<code class="fe ne nf ng mw b">fs</code>和<a class="ae kt" href="https://docs.cosmicjs.com/examples/add-media" rel="noopener ugc nofollow" target="_blank"> Cosmic </a> <code class="fe ne nf ng mw b">bucket.addMedia</code>方法上传文件。</p><figure class="kv kw kx ky gt ip"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h2 id="7fbc" class="kz la iy bd lb lc ld dn le lf lg dp lh kg li lj lk kk ll lm ln ko lo lp lq lr bi translated">条带概述和集成</h2><p id="9330" class="pw-post-body-paragraph jv jw iy jx b jy lu ka kb kc lv ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated"><a class="ae kt" href="https://stripe.com/docs/checkout/quickstart" rel="noopener ugc nofollow" target="_blank"> <strong class="jx iz"> Stripe </strong> </a>提供了一种在你的应用中捕捉支付的方式。就像 Cosmic 为内容基础设施做了所有繁重的工作一样，Stripe 提供电子商务基础设施和工具，为您的客户构建愉快的支付体验，而不考虑所销售的服务或产品。</p><figure class="kv kw kx ky gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi ku"><img src="../Images/8bc19a5519d4a404fc5d36238c31edfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BZtyss0A_PLnHj_e.gif"/></div></div></figure><p id="af47" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">由于<a class="ae kt" href="https://stripe.com/docs/security" rel="noopener ugc nofollow" target="_blank"> PCI 合规要求</a>，Stripe.js 库必须从 Stripe 的服务器加载。这在使用服务器端渲染的应用程序时产生了挑战，因为窗口对象在服务器上不可用。为了帮助我们管理这种复杂性，Stripe 提供了一个<a class="ae kt" href="https://github.com/stripe/stripe-js" rel="noopener ugc nofollow" target="_blank">加载包装器</a>，允许像 es 模块一样导入 Stripe.js:</p><figure class="kv kw kx ky gt ip"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="f512" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">Stripe.js 是作为<code class="fe ne nf ng mw b">import '@stripe/stripe-js'</code>语句的副作用加载的。</p><p id="45e0" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx iz">创建条带检出会话</strong></p><p id="c48e" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在您的服务器上添加一个端点，创建一个<a class="ae kt" href="https://stripe.com/docs/api/checkout/sessions" rel="noopener ugc nofollow" target="_blank"> <strong class="jx iz">结帐会话</strong> </a>。结帐会话控制您的客户在付款页面上看到的内容，如行项目、订单金额和货币以及可接受的付款方式。此外，您可以直接在<a class="ae kt" href="https://dashboard.stripe.com/settings/payment_methods" rel="noopener ugc nofollow" target="_blank"> <strong class="jx iz">条纹仪表盘</strong> </a>中启用或禁用支付方式。</p><figure class="kv kw kx ky gt ip"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h2 id="a161" class="kz la iy bd lb lc ld dn le lf lg dp lh kg li lj lk kk ll lm ln ko lo lp lq lr bi translated">后续步骤</h2><p id="5dcd" class="pw-post-body-paragraph jv jw iy jx b jy lu ka kb kc lv ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">虽然这个 marketplace 应用程序主要是为了了解这些现代解决方案的概念验证，但它是一个很好的基础。有可能添加新功能，例如:</p><ol class=""><li id="8848" class="ls lt iy jx b jy jz kc kd kg ms kk mt ko mu ks ob ma mb mc bi translated">显示订单的用户帐户页面</li><li id="44a2" class="ls lt iy jx b jy md kc me kg mf kk mg ko mh ks ob ma mb mc bi translated">展示购买的 jpegs 图片的用户资料页面</li><li id="2dbf" class="ls lt iy jx b jy md kc me kg mf kk mg ko mh ks ob ma mb mc bi translated">评论系统捕捉评论和对话</li><li id="0ced" class="ls lt iy jx b jy md kc me kg mf kk mg ko mh ks ob ma mb mc bi translated">用于购物的比特币/闪电期权</li></ol><h1 id="87c1" class="nk la iy bd lb nl nm nn le no np nq lh nr ns nt lk nu nv nw ln nx ny nz lq oa bi translated">结论</h1><p id="df27" class="pw-post-body-paragraph jv jw iy jx b jy lu ka kb kc lv ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">我希望您喜欢这篇教程，它探索了如何使用强大的 API 优先工具来构建一个全功能的 marketplace 应用程序。这个动态的、功能性的、可定制的、完全集成的 uNFT 市场由<strong class="jx iz"> Next.js、</strong> <strong class="jx iz"> Cosmic 和 Stripe </strong>提供支持，也可以为其他类型的企业定制。请随意使用代码，并按照您喜欢的方式使用它！</p></div></div>    
</body>
</html>