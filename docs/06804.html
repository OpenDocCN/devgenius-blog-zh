<html>
<head>
<title>Compilation Process for C Programs, how does it works?!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">C 程序的编译程序，它是如何工作的？！</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/compilation-process-for-c-programs-how-does-it-works-55333238415e?source=collection_archive---------13-----------------------#2022-02-04">https://blog.devgenius.io/compilation-process-for-c-programs-how-does-it-works-55333238415e?source=collection_archive---------13-----------------------#2022-02-04</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><figure class="im in gp gr io ip gh gi paragraph-image"><div class="gh gi il"><img src="../Images/c8effbe0b8f714647c22cf894527a5b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*DR3ruiS9Pp-YfClA.jpg"/></div></figure><div class=""/><p id="143b" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">再说 C，是什么？</p><p id="e7f1" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">c 是一种通用的、过程化的计算机编程语言，这意味着它是用来在广泛的应用领域中构建软件的。</p><p id="a36b" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">作为一名程序员，你可能需要用任何编辑器以文本文件的形式编写它的源代码，然后它必须被编译成机器代码。</p><figure class="kq kr ks kt gt ip gh gi paragraph-image"><div class="gh gi kp"><img src="../Images/27ac054f67e1cfda82441709aa77ab08.png" data-original-src="https://miro.medium.com/v2/resize:fit:602/format:webp/1*K2MmrLwK9pcCaaWZssfFBA.png"/></div></figure><p id="23b4" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">为了做到这一点，在你的代码被编译之前有 4 个步骤:预处理，编译，汇编，链接。</p><p id="c987" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">我将在这篇文章中使用这个例子</p><figure class="kq kr ks kt gt ip gh gi paragraph-image"><div class="gh gi ku"><img src="../Images/60f072e87701e3fd6934d5f365ae267f.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*IrmoPogHLrj1rhAsZubOkQ.png"/></div></figure><h1 id="5047" class="kv kw iu bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated"><strong class="ak">预处理:</strong></h1><p id="bf3e" class="pw-post-body-paragraph jr js iu jt b ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk lx km kn ko ig bi translated">这是第一步，预处理器处理指令，指令是以#开头的命令，然后它开始删除注释，展开宏和代码中包含的文件。</p><p id="b115" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">如果您碰巧包含一个头文件，比如#include <stdio.h>，它将搜索名为 stdio.h 的文件，并将头文件复制到源代码文件中。使用#define 定义的常量也是由预处理程序生成的。</stdio.h></p><p id="f6b1" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">要打印预处理阶段的结果，将<code class="fe ly lz ma mb b">-E</code>选项传递给<code class="fe ly lz ma mb b">gcc</code></p><pre class="kq kr ks kt gt mc mb md me aw mf bi"><span id="7a15" class="mg kw iu mb b gy mh mi l mj mk">gcc -E hello_world.c</span></pre><figure class="kq kr ks kt gt ip gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/169d82e8af61785a12b61a016840458d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*4pcBSV_vPEvld-0mrACGiA.png"/></div></figure><h1 id="0f6c" class="kv kw iu bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">编译:</h1><p id="c0a1" class="pw-post-body-paragraph jr js iu jt b ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk lx km kn ko ig bi translated">现在我们进行第二步，这是预处理器的输出将生成特定于目标处理器架构的汇编语言。这些将是一种中级的人类可读语言。</p><p id="a198" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">为了保存编译阶段的结果，将<code class="fe ly lz ma mb b">-S</code>选项传递给<code class="fe ly lz ma mb b">gcc</code>:</p><pre class="kq kr ks kt gt mc mb md me aw mf bi"><span id="3b88" class="mg kw iu mb b gy mh mi l mj mk">gcc -S hello_world.c</span></pre><p id="41de" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">将创建一个名为 hello_world.s 的文件，其中包含汇编指令，输出如下:</p><figure class="kq kr ks kt gt ip gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/1bdc9b2eb07cf6303aac9f14abec36f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*jt0QYuEC2J1NKoE9A7zz6A.png"/></div></figure><h1 id="83ad" class="kv kw iu bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">装配</h1><p id="3de6" class="pw-post-body-paragraph jr js iu jt b ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk lx km kn ko ig bi translated">共同供应商...集合！这是第三步，汇编程序将代码转换成纯二进制代码或机器码。也称为目标代码。</p><p id="7bba" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">如果我们想保存组装阶段的结果，我们需要将<code class="fe ly lz ma mb b">-c</code>选项传递给<code class="fe ly lz ma mb b">gcc</code>:</p><pre class="kq kr ks kt gt mc mb md me aw mf bi"><span id="6aff" class="mg kw iu mb b gy mh mi l mj mk">gcc -c hello_world.c</span></pre><p id="5e18" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">将创建一个名为<code class="fe ly lz ma mb b">hello_world.o</code>的文件，其中包含程序的目标代码。</p><figure class="kq kr ks kt gt ip gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/ccc8512f19386f63a1ec235d6dea838e.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/1*Gtnbp9q3GdOXUj4IO-O5Pg.png"/></div></figure><p id="a253" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">但是如果我们想要检查它的内容，我们需要通过运行以下命令之一来使用命令<code class="fe ly lz ma mb b">hexdump</code>或<code class="fe ly lz ma mb b">od</code>:</p><pre class="kq kr ks kt gt mc mb md me aw mf bi"><span id="e3c0" class="mg kw iu mb b gy mh mi l mj mk">hexdump hello_world.o<br/>od -c hello_world.o</span></pre><figure class="kq kr ks kt gt ip gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/f317921929c73224e9a0696a6236be41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*Ropm5a8wsdMgX2fOwQ04xA.png"/></div></figure><h1 id="74cc" class="kv kw iu bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">链接:</h1><p id="ec48" class="pw-post-body-paragraph jr js iu jt b ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk lx km kn ko ig bi translated">现在，为了伟大的结局…编译的最后一步，整个代码将被链接器从多个模块合并成一个模块。如果我们使用库，这些库将链接到我们的代码。在某些情况下，如静态链接，来自库的代码将被复制到可执行文件中，另一方面，使用动态链接，代码不会被复制，它只在二进制文件中包含库的名称。</p><p id="27c9" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">在我们的“Hello，World”程序中，链接器将为<code class="fe ly lz ma mb b">puts</code>函数添加目标代码。结果将是一个可执行文件，如果不带选项运行，该文件的名称将是<code class="fe ly lz ma mb b">a.out</code>。为了更好的命名，你需要将<code class="fe ly lz ma mb b">-o</code>选项传递给<code class="fe ly lz ma mb b">gcc</code>:</p><pre class="kq kr ks kt gt mc mb md me aw mf bi"><span id="6287" class="mg kw iu mb b gy mh mi l mj mk">gcc -o hello_world hello_world.c</span></pre><figure class="kq kr ks kt gt ip gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/72fae55ae5cc3552711ff749d2ccc510.png" data-original-src="https://miro.medium.com/v2/resize:fit:514/format:webp/1*-iZjby9D_l0veE-hDtWrtQ.png"/></div></figure><h1 id="fa88" class="kv kw iu bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">感谢您的阅读！</h1><p id="61aa" class="pw-post-body-paragraph jr js iu jt b ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk lx km kn ko ig bi translated">我希望这个解释对您有用，记得阅读 gcc 手册页以获得更多信息。愿原力与你同在！</p><figure class="kq kr ks kt gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi mq"><img src="../Images/dbc28cfd460f2592956867764b685259.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NYeHitLXEwhSARyNmMMBSw.png"/></div></div></figure></div></div>    
</body>
</html>