<html>
<head>
<title>Security in React Native applications — AsyncStorage</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React本机应用程序中的安全性—异步存储</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/security-in-react-native-applications-asyncstorage-4a619d923638?source=collection_archive---------7-----------------------#2020-07-17">https://blog.devgenius.io/security-in-react-native-applications-asyncstorage-4a619d923638?source=collection_archive---------7-----------------------#2020-07-17</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/9d8349e0cd4a801492e2886d9d3ed006.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tWttRxtjEjnJ4YYa-Gy01g.jpeg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">来源:https://www.pexels.com/@fotios-photos</figcaption></figure><p id="d764" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">大多数程序员发现很明显不要在代码中存储敏感的API键或环境变量。从应用捆绑包中获得这样的密钥需要几秒钟。然而，人们往往会忘记，这不是唯一的地方，这应该得到保护。</p><p id="3b1f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">想象开发一个下载和存储数据的应用程序。它可能是观看过的电影列表或旧的购物清单，但如果应用程序获取并保存医疗数据或信用卡信息会怎样？</p></div><div class="ab cl ky kz hr la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ig ih ii ij ik"><h1 id="3599" class="lf lg in bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">异步存储的局限性</h1><p id="119e" class="pw-post-body-paragraph ka kb in kc b kd md kf kg kh me kj kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">根据<a class="ae jz" href="https://reactnative.dev/docs/security#async-storage" rel="noopener ugc nofollow" target="_blank">官方RN文档</a>，AsyncStorage是一个异步且未加密的键值存储。因为它是未加密的，所以在AsyncStorage中保存的任何内容都不应该被认为是安全的。</p><blockquote class="mi mj mk"><p id="5668" class="ka kb ml kc b kd ke kf kg kh ki kj kk mm km kn ko mn kq kr ks mo ku kv kw kx ig bi translated"><strong class="kc io"> Android: </strong> AsyncStorage使用数据库保存数据(RocksDB或SQLite)。</p><p id="e03e" class="ka kb ml kc b kd ke kf kg kh ki kj kk mm km kn ko mn kq kr ks mo ku kv kw kx ig bi translated"><strong class="kc io"> iOS: </strong> AsyncStorage在UserDefaults中存储小值，在文件中存储大值。</p></blockquote><p id="414d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在这一点上，有些人可能会问—这两个平台上的潜在威胁是什么？</p><p id="3968" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在Android上，没有root权限是无法读取应用数据的。坏消息是，人们可以很容易地找到大多数可用的设备，然后读取数据。</p><p id="46fa" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们在iOS上持久化数据的方式更糟糕。AsyncStorage不允许指定哪些值属于用户默认值，哪些值属于文件。这并不幸运，因为存储在<em class="ml">文档</em>或<em class="ml">库/缓存</em>中的数据是加密的，但用户默认值并未加密，它们很容易被访问。此外，存储在<em class="ml"> Documents </em>目录下的任何内容都可能被iCloud同步，因此在重新安装应用程序时，我们的用户可能会获得旧数据。</p></div><div class="ab cl ky kz hr la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ig ih ii ij ik"><h1 id="1429" class="lf lg in bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">有没有办法让异步存储更安全？</h1><p id="b7e1" class="pw-post-body-paragraph ka kb in kc b kd md kf kg kh me kj kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">Android平台的一个建议解决方案是数据库中的数据持久性，通过Keystore系统进行额外的加密。不幸的是，这需要在本机端添加一些代码，更不幸的是，没有以包的形式存在这样的解决方案。</p><p id="be77" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在某些情况下，<a class="ae jz" href="https://github.com/mCodex/react-native-sensitive-info" rel="noopener ugc nofollow" target="_blank">react-native-sensitive-info</a>库应该可以完成这个任务。它将数据存储在SharedPreferences中。SharedPreferences的主要目的是存储未嵌套的键值数据，因此请仅使用它来以这种格式持久存储数据。否则，它可能会严重影响应用程序的性能。</p><p id="ed83" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">另一件可能有助于提高整体安全级别的事情是升级minSdkVersion。不能将密钥库用于运行版本低于23的设备。实际上，这意味着不再支持运行在低于6.0版本的Android上的设备。</p><p id="9d81" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">对于iOS应用程序来说，事情变得越来越复杂。钥匙串服务应该可以处理少量的数据，而且有各种关于内存不足的错误报告。修补AsyncStorage库并设置更高的保护级别，同时添加允许在<em class="ml">库/缓存</em>目录下自动保存文件的部分，可以在许多用例中有所帮助。</p></div><div class="ab cl ky kz hr la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ig ih ii ij ik"><h1 id="f1bd" class="lf lg in bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">结论</h1><p id="9ca0" class="pw-post-body-paragraph ka kb in kc b kd md kf kg kh me kj kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">AsyncStorage不是存储敏感数据的最佳位置，在实施任何与AsyncStorage相关的任务之前，请仔细考虑潜在的风险。每个解决方案都有额外的成本，因此在开始修补AsyncStorage之前，最好先退一步检查一下，在此用例中是否不可避免地要在AsyncStorage中保存敏感数据。</p></div></div>    
</body>
</html>