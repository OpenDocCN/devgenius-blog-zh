<html>
<head>
<title>Time Series with Python: Data Operations</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 中的时间序列:数据操作</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/time-series-with-python-data-operations-f88b2e791aba?source=collection_archive---------3-----------------------#2022-12-26">https://blog.devgenius.io/time-series-with-python-data-operations-f88b2e791aba?source=collection_archive---------3-----------------------#2022-12-26</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="1481" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">如何在 Python 中操作时间序列数据？</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/398fb637b6f89ab5746707377e1c3c13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ePRqUW9I9F9Bxijw5cenug.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">照片由<a class="ae ks" href="https://unsplash.com/@yiorgosntrahas?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Yiorgos Ntrahas </a>在<a class="ae ks" href="https://unsplash.com/images/stock?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="6fb4" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">时序数据是一种在一段时间内收集的数据，通常以固定的时间间隔收集。它通常用于金融、经济和气象等领域，并经常被分析以了解一段时间内的趋势和模式。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/ce9d87cec2be7dea39d3c0a1fa7f8152.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*9Lo-V9EGLQTnV6uVkunXlQ.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">美国 1953-2009 年结核病发病率。<a class="ae ks" href="https://en.wikipedia.org/wiki/Time_series" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="d051" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Pandas 是一个强大而流行的 Python 开源数据操作库，特别适合处理时间序列数据。它提供了一系列工具和函数，使得加载、操作和分析时间序列数据变得容易。</p><p id="7357" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在这篇博文中，我们将探索使用 Pandas 操作时间序列数据的一些关键技术。我们将涵盖诸如索引和切片时间序列数据，重采样和滚动窗口计算等主题，以及其他有用的功能。</p><h1 id="7b13" class="lq lr in bd ls lt lu lv lw lx ly lz ma jt mb ju mc jw md jx me jz mf ka mg mh bi translated">数据类型</h1><p id="45fb" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">在 Python 中，没有专门用于表示日期的内置数据类型。然而，Python 标准库中的<code class="fe mn mo mp mq b">datetime</code>模块提供了将日期作为<code class="fe mn mo mp mq b">datetime</code>对象的工具，这些对象是存储日期和时间的数据类型。</p><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="3338" class="mv lr in mq b be mw mx l my mz">import datetime<br/><br/>t = datetime.datetime.now()<br/>print(f"type: {type(t)} and t: {t}")<br/>#type: &lt;class 'datetime.datetime'&gt; and t: 2022-12-26 14:20:51.278230</span></pre><p id="8b64" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">日期通常以字符串的形式出现在我们处理的数据集或阅读的文件中。因此，我们需要用这些字符串格式进行<code class="fe mn mo mp mq b">datetime</code>对象转换。</p><p id="7280" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">日期的可能字符串格式:</p><ul class=""><li id="1209" class="na nb in kv b kw kx kz la lc nc lg nd lk ne lo nf ng nh ni bi translated"><code class="fe mn mo mp mq b">YYYY-MM-DD</code>(如 2022-01-01)</li><li id="688a" class="na nb in kv b kw nj kz nk lc nl lg nm lk nn lo nf ng nh ni bi translated"><code class="fe mn mo mp mq b">YYYY/MM/DD</code>(例如 2022 年 1 月 1 日)</li><li id="a967" class="na nb in kv b kw nj kz nk lc nl lg nm lk nn lo nf ng nh ni bi translated"><code class="fe mn mo mp mq b">DD-MM-YYYY</code>(例如 2022 年 1 月 1 日)</li><li id="4ac8" class="na nb in kv b kw nj kz nk lc nl lg nm lk nn lo nf ng nh ni bi translated"><code class="fe mn mo mp mq b">DD/MM/YYYY</code>(例如 2022 年 1 月 1 日)</li><li id="59b7" class="na nb in kv b kw nj kz nk lc nl lg nm lk nn lo nf ng nh ni bi translated"><code class="fe mn mo mp mq b">MM-DD-YYYY</code>(例如 2022 年 1 月 1 日)</li><li id="f9e1" class="na nb in kv b kw nj kz nk lc nl lg nm lk nn lo nf ng nh ni bi translated"><code class="fe mn mo mp mq b">MM/DD/YYYY</code>(例如 2022 年 1 月 1 日)</li><li id="2f37" class="na nb in kv b kw nj kz nk lc nl lg nm lk nn lo nf ng nh ni bi translated"><code class="fe mn mo mp mq b">HH:MM:SS</code>(例如 11:30:00)</li><li id="984b" class="na nb in kv b kw nj kz nk lc nl lg nm lk nn lo nf ng nh ni bi translated"><code class="fe mn mo mp mq b">HH:MM:SS AM/PM</code>(如上午 11:30:00)</li><li id="8281" class="na nb in kv b kw nj kz nk lc nl lg nm lk nn lo nf ng nh ni bi translated"><code class="fe mn mo mp mq b">HH:MM AM/PM</code>(如上午 11:30)</li></ul><p id="6c51" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><code class="fe mn mo mp mq b">strptime</code>函数将一个字符串和一个格式字符串作为参数，并返回一个<code class="fe mn mo mp mq b">datetime</code>对象。</p><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="f5b4" class="mv lr in mq b be mw mx l my mz">string = '2022-01-01 11:30:09'<br/>t = datetime.datetime.strptime(string, "%Y-%m-%d %H:%M:%S")<br/>print(f"type: {type(t)} and t: {t}")<br/>#type: &lt;class 'datetime.datetime'&gt; and t: 2022-01-01 11:30:09</span></pre><p id="0d6a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">格式代码:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi no"><img src="../Images/29c998cd07d36012d0e2c6b5bd52f010.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sLN6z1a2AWQUeDE3x8x54g.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">格式化代码列表。<a class="ae ks" href="https://docs.python.org/3/library/datetime.html" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="1d29" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">您还可以使用<code class="fe mn mo mp mq b">strftime</code>函数将<code class="fe mn mo mp mq b">datetime</code>对象转换回使用指定格式字符串的字符串表示。</p><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="32b9" class="mv lr in mq b be mw mx l my mz">t = datetime.datetime.now()<br/>t_string = t.strftime("%m/%d/%Y, %H:%M:%S")<br/>#12/26/2022, 14:38:47<br/><br/>t_string = t.strftime("%b/%d/%Y, %H:%M:%S")<br/>#Dec/26/2022, 14:39:32</span></pre><p id="313a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io"> Unix time </strong> (POSIX time 或 epoch time)，是一种用单一数值表示时间的系统。它表示自协调世界时(UTC)1970 年 1 月 1 日星期四 00:00:00 以来经过的秒数。</p><p id="ccb5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Unix 时间和时间戳经常互换使用。Unix 时间是创建时间戳的标准化版本。通常，整数或浮点数据类型用于存储时间戳和 Unix 时间。</p><p id="97e5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们可以使用<code class="fe mn mo mp mq b">time</code>模块的<code class="fe mn mo mp mq b">mktime</code>方法将<code class="fe mn mo mp mq b">datetime</code>对象转换成 Unix 时间整数。同样，<code class="fe mn mo mp mq b">datetime</code>模块的<code class="fe mn mo mp mq b">fromtimestamp</code>方法反之亦然。</p><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="d7e9" class="mv lr in mq b be mw mx l my mz">#convert datetime to unix time<br/>import time<br/>from datetime import datetime<br/><br/>t = datetime.now()<br/>unix_t = int(time.mktime(t.timetuple()))<br/>#1672055277<br/><br/>#convert unix time to datetime<br/>unix_t = 1672055277<br/>t = datetime.fromtimestamp(unix_t)<br/>#2022-12-26 14:47:57</span></pre><p id="65cc" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们可以使用<code class="fe mn mo mp mq b">dateutil</code>模块的<code class="fe mn mo mp mq b">parser</code>方法来解析日期的正式字符串，以获得日期时间对象。</p><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="2f88" class="mv lr in mq b be mw mx l my mz">from dateutil import parser<br/>date = parser.parse("29th of October, 1923")<br/>#datetime.datetime(1923, 10, 29, 0, 0)</span></pre><h2 id="79b3" class="np lr in bd ls nq nr dn lw ns nt dp ma lc nu nv mc lg nw nx me lk ny nz mg oa bi translated">熊猫</h2><p id="58cc" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">Pandas 提供了三种日期数据类型:</p><ul class=""><li id="b2c4" class="na nb in kv b kw kx kz la lc nc lg nd lk ne lo nf ng nh ni bi translated"><code class="fe mn mo mp mq b">Timestamp</code>或<code class="fe mn mo mp mq b">DatetimeIndex</code>:它的功能类似于其他索引类型，但也具有时间序列操作的专门功能。</li></ul><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="573b" class="mv lr in mq b be mw mx l my mz">t = pd.to_datetime("29/10/1923", dayfirst=True)<br/>#Timestamp('1923-10-29 00:00:00')<br/><br/>t = pd.Timestamp('2019-01-01', tz = 'Europe/Berlin')<br/>#Timestamp('2019-01-01 00:00:00+0100', tz='Europe/Berlin')<br/><br/>t = pd.to_datetime(["04/23/1920", "10/29/1923"])<br/>#DatetimeIndex(['1920-04-23', '1923-10-29'], dtype='datetime64[ns]', freq=None)</span></pre><ul class=""><li id="8175" class="na nb in kv b kw kx kz la lc nc lg nd lk ne lo nf ng nh ni bi translated"><code class="fe mn mo mp mq b">period</code>或<code class="fe mn mo mp mq b">PeriodIndex</code>:有开始和结束的时间间隔。它由固定的音程组成。</li></ul><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="9db8" class="mv lr in mq b be mw mx l my mz">t = pd.to_datetime(["04/23/1920", "10/29/1923"])<br/>period = t.to_period("D")<br/>#PeriodIndex(['1920-04-23', '1923-10-29'], dtype='period[D]')</span></pre><ul class=""><li id="91df" class="na nb in kv b kw kx kz la lc nc lg nd lk ne lo nf ng nh ni bi translated"><code class="fe mn mo mp mq b">Timedelta</code>或<code class="fe mn mo mp mq b">TimedeltaIndex</code>:是两个日期之间的间隔。</li></ul><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="3c4d" class="mv lr in mq b be mw mx l my mz">delta = pd.TimedeltaIndex(data =['1 days 03:00:00', <br/>                                '2 days 09:05:01.000030'])<br/>"""<br/>TimedeltaIndex(['1 days 02:00:00', '1 days 06:05:01.000030'], <br/>               dtype='timedelta64[ns]', freq=None)<br/>"""</span></pre><p id="2ece" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在 Pandas 中，我们可以使用<code class="fe mn mo mp mq b">to_datetime</code>方法将对象转换为<code class="fe mn mo mp mq b">datetime</code>数据类型或进行任何其他转换。</p><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="2aff" class="mv lr in mq b be mw mx l my mz">import pandas as pd<br/>df = pd.read_csv("dataset.txt")<br/>df.head()<br/><br/>"""<br/><br/>  date       value<br/>0 1991-07-01 3.526591<br/>1 1991-08-01 3.180891<br/>2 1991-09-01 3.252221<br/>3 1991-10-01 3.611003<br/>4 1991-11-01 3.565869<br/>"""<br/><br/>df.info()<br/><br/>"""<br/>&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>RangeIndex: 204 entries, 0 to 203<br/>Data columns (total 2 columns):<br/> #   Column  Non-Null Count  Dtype  <br/>---  ------  --------------  -----  <br/> 0   date    204 non-null    object <br/> 1   value   204 non-null    float64<br/>dtypes: float64(1), object(1)<br/>memory usage: 3.3+ KB<br/>"""<br/><br/># Convert to datetime<br/>df["date"] = pd.to_datetime(df["date"], format = "%Y-%m-%d")<br/><br/>df.info()<br/><br/>"""<br/>&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>RangeIndex: 204 entries, 0 to 203<br/>Data columns (total 2 columns):<br/> #   Column  Non-Null Count  Dtype         <br/>---  ------  --------------  -----         <br/> 0   date    204 non-null    datetime64[ns]<br/> 1   value   204 non-null    float64       <br/>dtypes: datetime64[ns](1), float64(1)<br/>memory usage: 3.3 KB<br/>"""<br/><br/># Convert to Unix<br/>df['unix_time'] = df['date'].apply(lambda x: x.timestamp())<br/>df.head()<br/>"""<br/>  date       value    unix_time<br/>0 1991-07-01 3.526591 678326400.0<br/>1 1991-08-01 3.180891 681004800.0<br/>2 1991-09-01 3.252221 683683200.0<br/>3 1991-10-01 3.611003 686275200.0<br/>4 1991-11-01 3.565869 688953600.0<br/>"""<br/><br/>df["date_converted_from_unix"] = pd.to_datetime(df["unix_time"], unit = "s")<br/>df.head()<br/>"""<br/>  date       value    unix_time    date_converted_from_unix<br/>0 1991-07-01 3.526591 678326400.0 1991-07-01<br/>1 1991-08-01 3.180891 681004800.0 1991-08-01<br/>2 1991-09-01 3.252221 683683200.0 1991-09-01<br/>3 1991-10-01 3.611003 686275200.0 1991-10-01<br/>4 1991-11-01 3.565869 688953600.0 1991-11-01<br/>"""</span></pre><p id="5b3e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们也可以用<code class="fe mn mo mp mq b">parse_dates</code>参数在任何文件中声明日期列。</p><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="799c" class="mv lr in mq b be mw mx l my mz">df = pd.read_csv("dataset.txt", parse_dates=["date"])<br/>df.info()<br/><br/>"""<br/>&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>RangeIndex: 204 entries, 0 to 203<br/>Data columns (total 2 columns):<br/> #   Column  Non-Null Count  Dtype         <br/>---  ------  --------------  -----         <br/> 0   date    204 non-null    datetime64[ns]<br/> 1   value   204 non-null    float64       <br/>dtypes: datetime64[ns](1), float64(1)<br/>memory usage: 3.3 KB<br/>"""</span></pre><p id="bfbd" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">最好将日期列作为数据集的索引。</p><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="2fd8" class="mv lr in mq b be mw mx l my mz">df.set_index("date",inplace=True)<br/><br/>"""<br/>            Value<br/>date <br/>1991-07-01 3.526591<br/>1991-08-01 3.180891<br/>1991-09-01 3.252221<br/>1991-10-01 3.611003<br/>1991-11-01 3.565869<br/>... ...<br/>2008-02-01 21.654285<br/>2008-03-01 18.264945<br/>2008-04-01 23.107677<br/>2008-05-01 22.912510<br/>2008-06-01 19.431740<br/>"""</span></pre><p id="3e6b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Numpy 也有自己的 datetime 类型。特别是在计算大型数据集时，矢量化非常有用，应该使用。因此，我们可能想要利用<code class="fe mn mo mp mq b">np.datetime64</code>数据类型。</p><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="445c" class="mv lr in mq b be mw mx l my mz">import numpy as np<br/>arr_date = np.array('2000-01-01', dtype=np.datetime64)<br/>arr_date<br/>#array('2000-01-01', dtype='datetime64[D]')<br/><br/>#broadcasting<br/>arr_date = arr_date + np.arange(30)<br/>"""<br/>array(['2000-01-01', '2000-01-02', '2000-01-03', '2000-01-04',<br/>       '2000-01-05', '2000-01-06', '2000-01-07', '2000-01-08',<br/>       '2000-01-09', '2000-01-10', '2000-01-11', '2000-01-12',<br/>       '2000-01-13', '2000-01-14', '2000-01-15', '2000-01-16',<br/>       '2000-01-17', '2000-01-18', '2000-01-19', '2000-01-20',<br/>       '2000-01-21', '2000-01-22', '2000-01-23', '2000-01-24',<br/>       '2000-01-25', '2000-01-26', '2000-01-27', '2000-01-28',<br/>       '2000-01-29', '2000-01-30'], dtype='datetime64[D]')<br/>"""</span></pre><h1 id="2b14" class="lq lr in bd ls lt lu lv lw lx ly lz ma jt mb ju mc jw md jx me jz mf ka mg mh bi translated">功能</h1><p id="8d30" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">下面列出了一些可能对时间序列有用的函数。我们到达 series 对象的<code class="fe mn mo mp mq b">dt</code>类，并以那种方式访问 datetime 方法。</p><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="aef6" class="mv lr in mq b be mw mx l my mz">df = pd.read_csv("dataset.txt", parse_dates=["date"])<br/>df["date"].dt.day_name()<br/><br/>"""<br/>0        Monday<br/>1      Thursday<br/>2        Sunday<br/>3       Tuesday<br/>4        Friday<br/>         ...   <br/>199      Friday<br/>200    Saturday<br/>201     Tuesday<br/>202    Thursday<br/>203      Sunday<br/>Name: date, Length: 204, dtype: object<br/>"""</span></pre><h2 id="cec7" class="np lr in bd ls nq nr dn lw ns nt dp ma lc nu nv mc lg nw nx me lk ny nz mg oa bi translated">DataReader</h2><p id="3f81" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated"><code class="fe mn mo mp mq b">pandas_datareader</code>是<code class="fe mn mo mp mq b">pandas</code>库的侧作之一。多亏了这个包，我们可以在一行代码中访问许多财务数据。你可以在这里找到文档<a class="ae ks" href="https://pandas-datareader.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="9cbc" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="ob"> pip 安装 pandas-datareader </em></p><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="7222" class="mv lr in mq b be mw mx l my mz">from pandas_datareader import wb<br/>#GDP per Capita From World Bank<br/>df = wb.download(indicator='NY.GDP.PCAP.KD', <br/>                 country=['US', 'FR', 'GB', 'DK', 'NO'], start=1960, end=2019)<br/><br/>"""<br/>                   NY.GDP.PCAP.KD<br/>country       year                <br/>Denmark       2019    57203.027794<br/>              2018    56563.488473<br/>              2017    55735.764901<br/>              2016    54556.068955<br/>              2015    53254.856370<br/>...                            ...<br/>United States 1964    21599.818705<br/>              1963    20701.269947<br/>              1962    20116.235124<br/>              1961    19253.547329<br/>              1960    19135.268182<br/><br/>[300 rows x 1 columns]<br/>"""</span></pre><h2 id="1cbf" class="np lr in bd ls nq nr dn lw ns nt dp ma lc nu nv mc lg nw nx me lk ny nz mg oa bi translated">范围</h2><p id="b780" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">我们可以使用熊猫的<code class="fe mn mo mp mq b">date_range</code>方法定义一个日期范围。</p><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="629e" class="mv lr in mq b be mw mx l my mz">pd.date_range(start="2021-01-01", end="2022-01-01", freq="D")<br/><br/>"""<br/>DatetimeIndex(['2021-01-01', '2021-01-02', '2021-01-03', '2021-01-04',<br/>               '2021-01-05', '2021-01-06', '2021-01-07', '2021-01-08',<br/>               '2021-01-09', '2021-01-10',<br/>               ...<br/>               '2021-12-23', '2021-12-24', '2021-12-25', '2021-12-26',<br/>               '2021-12-27', '2021-12-28', '2021-12-29', '2021-12-30',<br/>               '2021-12-31', '2022-01-01'],<br/>              dtype='datetime64[ns]', length=366, freq='D')<br/>"""<br/><br/>pd.date_range(start="2021-01-01", end="2022-01-01", freq="BM")<br/><br/>"""<br/>DatetimeIndex(['2021-01-29', '2021-02-26', '2021-03-31', '2021-04-30',<br/>               '2021-05-31', '2021-06-30', '2021-07-30', '2021-08-31',<br/>               '2021-09-30', '2021-10-29', '2021-11-30', '2021-12-31'],<br/>              dtype='datetime64[ns]', freq='BM')<br/>"""<br/><br/>fridays  = pd.date_range('2022-11-01', '2022-12-31', freq="W-FRI")<br/>"""<br/>DatetimeIndex(['2022-11-04', '2022-11-11', '2022-11-18', '2022-11-25',<br/>               '2022-12-02', '2022-12-09', '2022-12-16', '2022-12-23',<br/>               '2022-12-30'],<br/>              dtype='datetime64[ns]', freq='W-FRI')<br/>"""</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oc"><img src="../Images/afa3569a4b252bf07349e5f2123218db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uGblq9d8OMZ_GHFUAoTz5Q.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">偏移别名表。<a class="ae ks" href="https://pandas.pydata.org/docs/user_guide/timeseries.html#timeseries-offset-aliases" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="6210" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们可以使用<code class="fe mn mo mp mq b">timedelta_range</code>方法逐步创建一个时间序列。</p><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="c4e1" class="mv lr in mq b be mw mx l my mz">t = pd.timedelta_range(0, periods=10, freq="H")<br/><br/>"""<br/>TimedeltaIndex(['0 days 00:00:00', '0 days 01:00:00', '0 days 02:00:00',<br/>                '0 days 03:00:00', '0 days 04:00:00', '0 days 05:00:00',<br/>                '0 days 06:00:00', '0 days 07:00:00', '0 days 08:00:00',<br/>                '0 days 09:00:00'],<br/>               dtype='timedelta64[ns]', freq='H')<br/>"""</span></pre><h2 id="bd8d" class="np lr in bd ls nq nr dn lw ns nt dp ma lc nu nv mc lg nw nx me lk ny nz mg oa bi translated">格式</h2><p id="7c69" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">我们可以用<code class="fe mn mo mp mq b">dt.strftime</code>方法改变日期列的格式。</p><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="fb34" class="mv lr in mq b be mw mx l my mz">df["new_date"] = df["date"].dt.strftime("%b %d, %Y")<br/>df.head()<br/>"""<br/>  date       value    new_date<br/>0 1991-07-01 3.526591 Jul 01, 1991<br/>1 1991-08-01 3.180891 Aug 01, 1991<br/>2 1991-09-01 3.252221 Sep 01, 1991<br/>3 1991-10-01 3.611003 Oct 01, 1991<br/>4 1991-11-01 3.565869 Nov 01, 1991<br/>"""</span></pre><h2 id="5846" class="np lr in bd ls nq nr dn lw ns nt dp ma lc nu nv mc lg nw nx me lk ny nz mg oa bi translated">从语法上分析</h2><p id="37d4" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">我们可以解析 datetime 对象并获得日期的子成分。</p><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="5b21" class="mv lr in mq b be mw mx l my mz">df["year"] = df["date"].dt.year<br/>df["month"] = df["date"].dt.month<br/>df["day"] = df["date"].dt.day<br/>df["calendar"] = df["date"].dt.date<br/>df["hour"] = df["date"].dt.time<br/>df.head()<br/>"""<br/>  date       value    year month day calendar   hour<br/>0 1991-07-01 3.526591 1991 7     1   1991-07-01 00:00:00<br/>1 1991-08-01 3.180891 1991 8     1   1991-08-01 00:00:00<br/>2 1991-09-01 3.252221 1991 9     1   1991-09-01 00:00:00<br/>3 1991-10-01 3.611003 1991 10    1   1991-10-01 00:00:00<br/>4 1991-11-01 3.565869 1991 11    1   1991-11-01 00:00:00<br/>"""</span></pre><p id="ab57" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">或者，我们可以重新加入他们。</p><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="59e5" class="mv lr in mq b be mw mx l my mz">df["date_joined"] = pd.to_datetime(df[["year","month","day"]])<br/>print(df["date_joined"])<br/>"""<br/>0     1991-07-01<br/>1     1991-08-01<br/>2     1991-09-01<br/>3     1991-10-01<br/>4     1991-11-01<br/>         ...    <br/>199   2008-02-01<br/>200   2008-03-01<br/>201   2008-04-01<br/>202   2008-05-01<br/>203   2008-06-01<br/>Name: date_joined, Length: 204, dtype: datetime64[ns]<br/>"""</span></pre><h2 id="f858" class="np lr in bd ls nq nr dn lw ns nt dp ma lc nu nv mc lg nw nx me lk ny nz mg oa bi translated">过滤</h2><p id="beef" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">我们可以用<code class="fe mn mo mp mq b">loc</code>的方法来过滤<code class="fe mn mo mp mq b">DataFrame</code>。</p><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="d436" class="mv lr in mq b be mw mx l my mz">df = df.loc["2021-01-01":"2021-01-10"]</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi od"><img src="../Images/d5e3f8d012686853d1702c0c0f366599.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jpfpToAsBFg7kyjUCGpMQg.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">数据框。图片由作者提供。</figcaption></figure><p id="c189" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><code class="fe mn mo mp mq b">truncate</code>是另一种选择。</p><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="4a8f" class="mv lr in mq b be mw mx l my mz">df_truncated = df.truncate('2021-01-05', '2022-01-10')</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oe"><img src="../Images/b74a4f9de19a14768e2c1d715ff7890a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i5u6dMBUg3eyo4qQ-crW1g.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">df _ 已截断。图片由作者提供。</figcaption></figure><h1 id="5b85" class="lq lr in bd ls lt lu lv lw lx ly lz ma jt mb ju mc jw md jx me jz mf ka mg mh bi translated">操作</h1><p id="ff2f" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">让我们看看如何对时间序列数据集中的值执行操作。</p><p id="5cae" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们创建一个股票数据集在例子中使用。为此，我们可以使用<code class="fe mn mo mp mq b">yfinance</code>库。</p><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="b16f" class="mv lr in mq b be mw mx l my mz">#get google stock price data<br/>import yfinance as yf<br/>start_date = '2020-01-01'<br/>end_date = '2023-01-01'<br/>ticker = 'GOOGL'<br/>df = yf.download(ticker, start_date, end_date)<br/>df.head()<br/><br/>"""<br/>Date       Open      High      Low       Close     Adj Close Volume     <br/>2020-01-02 67.420502 68.433998 67.324501 68.433998 68.433998 27278000<br/>2020-01-03 67.400002 68.687500 67.365997 68.075996 68.075996 23408000<br/>2020-01-06 67.581497 69.916000 67.550003 69.890503 69.890503 46768000<br/>2020-01-07 70.023003 70.175003 69.578003 69.755501 69.755501 34330000<br/>2020-01-08 69.740997 70.592499 69.631500 70.251999 70.251999 35314000<br/>"""</span></pre><h2 id="8f26" class="np lr in bd ls nq nr dn lw ns nt dp ma lc nu nv mc lg nw nx me lk ny nz mg oa bi translated">差异</h2><p id="1de6" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated"><code class="fe mn mo mp mq b">DataFrame</code>中一个元素与另一个元素之间的差异。</p><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="93f0" class="mv lr in mq b be mw mx l my mz">#subtract that day's value from the previous day<br/>df["Diff_Close"] = df["Close"].diff()<br/>#Subtract that day's value from the day's value 2 days ago<br/>df["Diff_Close_2Days"] = df["Close"].diff(periods=2)</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi of"><img src="../Images/41970ffd64ef8d91140fa0eb6fff0815.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z2W-HuHDTtE1xhSKUT98BQ.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">数据框。图片由作者提供。</figcaption></figure><h2 id="1dfb" class="np lr in bd ls nq nr dn lw ns nt dp ma lc nu nv mc lg nw nx me lk ny nz mg oa bi translated">累计总数</h2><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="699f" class="mv lr in mq b be mw mx l my mz">df["Volume_Cumulative"] = df["Volume"].cumsum()</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi of"><img src="../Images/7ce62a9884db5a5294dfec5612296438.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7-g1uYAlczcMIiVF1K1odg.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">累积总和。图片由作者提供。</figcaption></figure><h2 id="57f2" class="np lr in bd ls nq nr dn lw ns nt dp ma lc nu nv mc lg nw nx me lk ny nz mg oa bi translated">翻滚吧</h2><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi og"><img src="../Images/fb0de8962dbad889780c09b556f5df6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/1*BvUZyRXp4xb-o8xzeZbgJw.gif"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">女士们先生们:跛行 Bizkit。<a class="ae ks" href="https://getyarn.io/yarn-clip/5a3f6f55-ac10-4729-b260-3689d793a356" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="28dc" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">务必执行滚动窗口计算(移动平均)。</p><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="6cfe" class="mv lr in mq b be mw mx l my mz">df["Close_Rolling_14"] = df["Close"].rolling(14).mean()<br/>df.tail()</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oh"><img src="../Images/94abd3fc61894edddcd054e4aa7a7f15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rufH8L24bXAIEx0DFaL8QA.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">数据框。图片由作者提供。</figcaption></figure><p id="176f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们画出移动平均线。</p><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="b171" class="mv lr in mq b be mw mx l my mz">import seaborn as sns<br/>import matplotlib.pyplot as plt<br/>fig = plt.figure(figsize = (14, 8))<br/>ax = sns.lineplot(df.index,df["Close"])<br/>ax = sns.lineplot(df.index,df["Close_Rolling_14"])<br/>ax.set(xlabel='date', ylabel='Close Price', title='Google Stock Close Price &amp; 14 Moving Average')<br/>plt.show()</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oi"><img src="../Images/197368bd2fe44c08c4d1eeafa8806196.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e-DxGrs63eQ9ja2FM_Hp4w.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">图片由作者提供。</figcaption></figure><p id="ebfb" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">参数:</p><ul class=""><li id="e1cc" class="na nb in kv b kw kx kz la lc nc lg nd lk ne lo nf ng nh ni bi translated"><strong class="kv io">居中</strong>:决定滚动窗口是否应该以当前观察为中心。</li><li id="3461" class="na nb in kv b kw nj kz nk lc nl lg nm lk nn lo nf ng nh ni bi translated"><strong class="kv io"> min_periods </strong>:窗口中产生结果所需的最小观察次数。</li></ul><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="bf73" class="mv lr in mq b be mw mx l my mz">s = pd.Series([1, 2, 3, 4, 5])<br/><br/>#the rolling window will be centered on each observation<br/>rolling_mean = s.rolling(window=3, center=True).mean()<br/>"""<br/>0    NaN<br/>1    2.0<br/>2    3.0<br/>3    4.0<br/>4    NaN<br/>dtype: float64<br/>Explanation:<br/>first window: [na 1 2] = na<br/>second window: [1 2 3] = 2<br/>"""<br/><br/># the rolling window will not be centered, <br/>#and will instead be anchored to the left side of the window<br/>rolling_mean = s.rolling(window=3, center=False).mean()<br/>"""<br/>0    NaN<br/>1    NaN<br/>2    2.0<br/>3    3.0<br/>4    4.0<br/>dtype: float64<br/>Explanation:<br/>first window: [na na 1] = na<br/>second window: [na 1 2] = na<br/>third window: [1 2 3] = 2<br/>"""</span></pre><h2 id="1709" class="np lr in bd ls nq nr dn lw ns nt dp ma lc nu nv mc lg nw nx me lk ny nz mg oa bi translated">改变</h2><p id="9d72" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">Pandas 有两种方法，<code class="fe mn mo mp mq b">shift()</code>和<code class="fe mn mo mp mq b">tshift()</code>，允许您以指定的频率倍数移动数据或时间序列的索引。<code class="fe mn mo mp mq b">shift()</code>移动数据，而<code class="fe mn mo mp mq b">tshift()</code>移动索引。</p><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="ee88" class="mv lr in mq b be mw mx l my mz">#shift the data<br/>df_shifted = df.shift(5,axis=0)<br/>df_shifted.head(10)<br/><br/>#shift the indexes<br/>df_tshifted = df.tshift(periods = 4, freq = 'D')<br/>df_tshifted.head(10)</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oj"><img src="../Images/95c7305025a0338b3930bd0396675b1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*et-cdRwr7qUqfisJzr3KKA.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">df _ shifted。图片由作者提供。</figcaption></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oj"><img src="../Images/4d1a9e6fa7a01d7b9585994d94b07037.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UnBxJ4oY00vtilJuueHIiQ.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">df _ 已转移。图片由作者提供。</figcaption></figure><h2 id="686b" class="np lr in bd ls nq nr dn lw ns nt dp ma lc nu nv mc lg nw nx me lk ny nz mg oa bi translated">时期</h2><p id="3d3f" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated"><code class="fe mn mo mp mq b">dt.to_period</code>从日期创建周期。偏移量字符串必须传递到函数中。</p><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="7e2b" class="mv lr in mq b be mw mx l my mz">df["Period"] = df["Date"].dt.to_period('W')</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ok"><img src="../Images/1ad92f7a366a8b749d71dc6d113f27e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WkVEqy_ocUmCob1QwLc12w.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">每周一次。图片由作者提供。</figcaption></figure><h2 id="784b" class="np lr in bd ls nq nr dn lw ns nt dp ma lc nu nv mc lg nw nx me lk ny nz mg oa bi translated">频率</h2><p id="5faa" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated"><code class="fe mn mo mp mq b">asfreq</code>方法用于将一个时间序列转换到一个指定的频率。</p><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="8da7" class="mv lr in mq b be mw mx l my mz">monthly_data = df.asfreq('M', method='ffill')</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oj"><img src="../Images/52bce166451f1a594a3d4b0b206b04d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1wADhwjQ6ZoTvm_RIBbmzw.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">月度数据。图片由作者提供。</figcaption></figure><p id="43b8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">参数:</p><ul class=""><li id="8ecb" class="na nb in kv b kw kx kz la lc nc lg nd lk ne lo nf ng nh ni bi translated"><strong class="kv io"> freq </strong>:数据转换的频率。这可以使用字符串别名(例如，<code class="fe mn mo mp mq b">'M'</code>表示每月，<code class="fe mn mo mp mq b">'H'</code>表示每小时)或<code class="fe mn mo mp mq b">pandas</code>偏移对象来指定。</li><li id="54e2" class="na nb in kv b kw nj kz nk lc nl lg nm lk nn lo nf ng nh ni bi translated"><strong class="kv io">方法</strong>:转换频率时如何填写缺失值。这可以是一个字符串，如<code class="fe mn mo mp mq b">'ffill'</code>(向前填充)或<code class="fe mn mo mp mq b">'bfill'</code>(向后填充)。</li></ul><h2 id="5a4f" class="np lr in bd ls nq nr dn lw ns nt dp ma lc nu nv mc lg nw nx me lk ny nz mg oa bi translated">抽样</h2><p id="e71e" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated"><code class="fe mn mo mp mq b">resample </code>是一种很有用的方法，可以很容易地改变时间序列的频率并对其进行重采样。我们可以进行上采样(到更高的频率)或下采样(到更低的频率)。因为我们在改变频率，所以我们需要使用一个聚合函数(比如平均值、最大值等等。).</p><p id="7a8b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><code class="fe mn mo mp mq b">resample</code>方法的参数:</p><ul class=""><li id="6d8a" class="na nb in kv b kw kx kz la lc nc lg nd lk ne lo nf ng nh ni bi translated"><strong class="kv io">规则</strong>:数据重新采样的频率。这可以使用字符串别名(例如，<code class="fe mn mo mp mq b">'M'</code>表示每月，<code class="fe mn mo mp mq b">'H'</code>表示每小时)或<code class="fe mn mo mp mq b">pandas</code>偏移对象来指定。</li></ul><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="259d" class="mv lr in mq b be mw mx l my mz">#down sample<br/>monthly_data = df.resample('M').mean()<br/>#up sample<br/>minute_data = data.resample('T').ffill()</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ol"><img src="../Images/da13f873dd2a210a37ef737aa54eb67f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cN5NxUNl9Mf3SJcqzSMm-Q.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">月度数据。图片由作者提供。</figcaption></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi om"><img src="../Images/e133989eb1c2a8c8c00de5d12075620c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CGmo0Quc3B3t15Lphy9cJw.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">微小数据。图片由作者提供。</figcaption></figure><h2 id="52b6" class="np lr in bd ls nq nr dn lw ns nt dp ma lc nu nv mc lg nw nx me lk ny nz mg oa bi translated">百分比变动</h2><p id="e263" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">我们可以使用<code class="fe mn mo mp mq b">pct_change</code>方法来计算日期之间的百分比变化。</p><pre class="kd ke kf kg gt mr mq ms bn mt mu bi"><span id="4b36" class="mv lr in mq b be mw mx l my mz">df["PCT"] = df["Close"].pct_change(periods=2)<br/>print(df["PCT"])<br/>"""<br/>Date<br/>2020-01-02         NaN<br/>2020-01-03         NaN<br/>2020-01-06    0.021283<br/>2020-01-07    0.024671<br/>2020-01-08    0.005172<br/>                ...   <br/>2022-12-19   -0.026634<br/>2022-12-20   -0.013738<br/>2022-12-21    0.012890<br/>2022-12-22   -0.014154<br/>2022-12-23   -0.003907<br/>Name: PCT, Length: 752, dtype: float64<br/>"""</span></pre><h1 id="be2f" class="lq lr in bd ls lt lu lv lw lx ly lz ma jt mb ju mc jw md jx me jz mf ka mg mh bi translated">结论</h1><p id="2dfa" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">总之，如果你要处理时间序列，你应该知道使这成为可能的基本操作，你应该能够使用快捷方式使你的工作更容易和更快。</p><p id="42c8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在 Pandas 和 NumPy 等库的帮助下，可以对时间序列数据执行各种操作，包括过滤、聚合和转换。通过学习如何有效地使用这些库，您可以获得对数据的宝贵见解，并根据您的分析做出明智的决策。</p><p id="544d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">感谢阅读。</p><h1 id="012a" class="lq lr in bd ls lt lu lv lw lx ly lz ma jt mb ju mc jw md jx me jz mf ka mg mh bi translated">阅读更多</h1><div class="on oo gp gr op oq"><a href="https://python.plainenglish.io/how-to-plot-candlestick-chart-in-python-9dba1cea70e3" rel="noopener  ugc nofollow" target="_blank"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd io gy z fp ov fr fs ow fu fw im bi translated">如何用 Python 绘制烛台图？</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">用 Plotly 软件包实现蜡烛图</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">python .平原英语. io</p></div></div><div class="oz l"><div class="pa l pb pc pd oz pe km oq"/></div></div></a></div><div class="on oo gp gr op oq"><a href="https://towardsdev.com/line-chart-in-python-matplotlib-seaborn-plotly-f576c630e97d" rel="noopener  ugc nofollow" target="_blank"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd io gy z fp ov fr fs ow fu fw im bi translated">Python 中的折线图(Matplotlib、Seaborn、Plotly)</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">折线图在 Python 中的实现</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">towardsdev.com</p></div></div><div class="oz l"><div class="pf l pb pc pd oz pe km oq"/></div></div></a></div><div class="on oo gp gr op oq"><a href="https://medium.com/mlearning-ai/about-the-importance-of-data-in-machine-learning-ffa66657ee77" rel="noopener follow" target="_blank"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd io gy z fp ov fr fs ow fu fw im bi translated">关于数据在机器学习中的重要性</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">你一直想知道但不敢问的关于数据的一切</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">medium.com</p></div></div><div class="oz l"><div class="pg l pb pc pd oz pe km oq"/></div></div></a></div><div class="on oo gp gr op oq"><a href="https://medium.com/@okanyenigun/optimization-of-pandas-performance-on-large-data-c4cbe6b1b064" rel="noopener follow" target="_blank"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd io gy z fp ov fr fs ow fu fw im bi translated">Pandas 在大数据上的性能优化</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">提高熊猫包装性能的方法</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">medium.com</p></div></div><div class="oz l"><div class="ph l pb pc pd oz pe km oq"/></div></div></a></div><div class="on oo gp gr op oq"><a href="https://awstip.com/how-fast-is-your-light-gbm-2d447b728130" rel="noopener  ugc nofollow" target="_blank"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd io gy z fp ov fr fs ow fu fw im bi translated">你的光 GBM 有多快？</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">为什么光 GBM 快？解释和实施</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">awstip.com</p></div></div><div class="oz l"><div class="pi l pb pc pd oz pe km oq"/></div></div></a></div><h1 id="919d" class="lq lr in bd ls lt lu lv lw lx ly lz ma jt mb ju mc jw md jx me jz mf ka mg mh bi translated">来源</h1><p id="027d" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated"><a class="ae ks" href="https://docs.python.org/3/library/datetime.html" rel="noopener ugc nofollow" target="_blank">https://docs.python.org/3/library/datetime.html</a></p><p id="b534" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><a class="ae ks" href="https://www.geeksforgeeks.org/how-to-convert-datetime-to-unix-timestamp-in-python/" rel="noopener ugc nofollow" target="_blank">https://www . geeks forgeeks . org/how-to-convert-datetime-to-UNIX-timestamp-in-python/</a></p><p id="9712" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><a class="ae ks" href="https://www.geeksforgeeks.org/how-to-convert-datetime-to-unix-timestamp-in-python/" rel="noopener ugc nofollow" target="_blank">https://www . geeks forgeeks . org/how-to-convert-datetime-to-UNIX-timestamp-in-python/</a></p><p id="e3bf" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">【https://pandas-datareader.readthedocs.io/en/latest/ T4】</p><p id="d934" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><a class="ae ks" href="https://pypi.org/project/yfinance/" rel="noopener ugc nofollow" target="_blank">https://pypi.org/project/yfinance/</a></p><p id="9144" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><a class="ae ks" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.resample.html" rel="noopener ugc nofollow" target="_blank">https://pandas . pydata . org/pandas-docs/stable/reference/API/pandas。DataFrame.resample.html</a></p><p id="ef71" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><a class="ae ks" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.rolling.html" rel="noopener ugc nofollow" target="_blank">https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.rolling.html</a></p><p id="deb5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><a class="ae ks" href="https://numpy.org/doc/stable/reference/arrays.datetime.html" rel="noopener ugc nofollow" target="_blank">https://numpy.org/doc/stable/reference/arrays.datetime.html</a></p></div></div>    
</body>
</html>