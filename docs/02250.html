<html>
<head>
<title>What You Don’t Know About Flexible Search</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于灵活搜索，你不知道的是</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/what-you-dont-know-about-flexible-search-8e3c0f454f27?source=collection_archive---------5-----------------------#2020-07-25">https://blog.devgenius.io/what-you-dont-know-about-flexible-search-8e3c0f454f27?source=collection_archive---------5-----------------------#2020-07-25</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="168c" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">如何编写有用的灵活搜索查询</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/9abb9dc174865cd698159f3a3a426031.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KUsXkEJEUzflNvMC"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk translated">由<a class="ae kw" href="https://unsplash.com/@lukechesser?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">卢克·切瑟</a>在<a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure></div><div class="ab cl kx ky hv kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ik il im in io"><h1 id="b456" class="le lf ir bd lg lh li lj lk ll lm ln lo jx lp jy lq ka lr kb ls kd lt ke lu lv bi translated">什么是灵活搜索？</h1><blockquote class="lw lx ly"><p id="61ef" class="lz ma mb mc b md me js mf mg mh jv mi mj mk ml mm mn mo mp mq mr ms mt mu mv ik bi translated">FlexibleSearchService是一个基于SQL的项目类型搜索，它允许对属性值以及直接对数据库列进行搜索。与SQL语句不同，FlexibleSearch查询可以包含对hybris平台中项目(产品、单位、客户等)的引用，作为查询语句的一部分(标记为<strong class="mc is"> { </strong>和<strong class="mc is"> } </strong>)。来自help.sap.com</p></blockquote><p id="afbf" class="pw-post-body-paragraph lz ma ir mc b md me js mf mg mh jv mi mw mk ml mm mx mo mp mq my ms mt mu mv ik bi translated">Hybris开发人员经常使用灵活的搜索，所以了解它很重要。灵活的搜索为hybris模型的内部工作提供了一个细粒度的接口。生成的SQL查询相当复杂，所以开发人员不必学习这些。</p><p id="9f40" class="pw-post-body-paragraph lz ma ir mc b md me js mf mg mh jv mi mw mk ml mm mx mo mp mq my ms mt mu mv ik bi translated">如果没有灵活的搜索查询，创建新的<a class="ae kw" href="https://lucene.apache.org/solr/" rel="noopener ugc nofollow" target="_blank"> Solr </a>索引或创建新的<a class="ae kw" href="https://www.baeldung.com/java-dao-pattern" rel="noopener ugc nofollow" target="_blank"> DAO </a>是不可能的。提取模型间条件的模型，可以用这个特性来完成，因为BackOffice不能提供这个功能。</p><p id="d521" class="pw-post-body-paragraph lz ma ir mc b md me js mf mg mh jv mi mw mk ml mm mx mo mp mq my ms mt mu mv ik bi translated">灵活搜索查询的执行是在hybris管理控制台中完成的。<a class="ae kw" href="https://help.sap.com/doc/a4265d5ea8314eb2929e6cf6fb8e35a5/1811/en-US/de/hybris/platform/servicelayer/search/FlexibleSearchService.html" rel="noopener ugc nofollow" target="_blank">如果要在DAO中使用，需要使用FlexibleSearchService </a>。</p></div><div class="ab cl kx ky hv kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ik il im in io"><h1 id="ab01" class="le lf ir bd lg lh li lj lk ll lm ln lo jx lp jy lq ka lr kb ls kd lt ke lu lv bi translated">获取项目</h1><p id="74c0" class="pw-post-body-paragraph lz ma ir mc b md mz js mf mg na jv mi mw nb ml mm mx nc mp mq my nd mt mu mv ik bi translated">要在Java中使用它，您需要创建一个查询字符串。把它作为灵活搜索服务的一个论据。</p><pre class="kh ki kj kk gu ne nf ng nh aw ni bi"><span id="f100" class="nj lf ir nf b gz nk nl l nm nn">```Java<br/>String query = "SELECT {" + UnitModel.PK + "} FROM {" + UnitModel._TYPECODE + "}`<br/>```</span></pre><p id="e318" class="pw-post-body-paragraph lz ma ir mc b md me js mf mg mh jv mi mw mk ml mm mx mo mp mq my ms mt mu mv ik bi translated">要获取类型的实体，需要创建这样的查询。在这个查询中，我们正在获取类型为<code class="fe no np nq nf b">YourCustomer</code>的每个属性的条目，在<code class="fe no np nq nf b">userName</code>中有一个感叹号。</p><pre class="kh ki kj kk gu ne nf ng nh aw ni bi"><span id="8b8f" class="nj lf ir nf b gz nk nl l nm nn">SELECT * FROM {YourCustomer} WHERE {userName} LIKE ‘%!%’</span></pre></div><div class="ab cl kx ky hv kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ik il im in io"><h1 id="387f" class="le lf ir bd lg lh li lj lk ll lm ln lo jx lp jy lq ka lr kb ls kd lt ke lu lv bi translated">连接表格</h1><p id="1f69" class="pw-post-body-paragraph lz ma ir mc b md mz js mf mg na jv mi mw nb ml mm mx nc mp mq my nd mt mu mv ik bi translated">该查询将根据外键将订单与单位连接起来。嵌套查询仅用于获取具有特定属性集的模型。</p><p id="05f3" class="pw-post-body-paragraph lz ma ir mc b md me js mf mg mh jv mi mw mk ml mm mx mo mp mq my ms mt mu mv ik bi translated">在测试特定行为时，基于条件连接模型非常有用。这在Backoffice中是无法复制的，这是查询的一个优势。</p><pre class="kh ki kj kk gu ne nf ng nh aw ni bi"><span id="a0c0" class="nj lf ir nf b gz nk nl l nm nn">SELECT {o.prop1}, {u.prop2} FROM { Order as o JOIN Unit as u ON {o. unit} = {u.pk} } WHERE {o.unit} IN ({{ SELECT {pk} FROM {Unit} WHERE {prop2} IS NOT NULL}})</span></pre></div><div class="ab cl kx ky hv kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ik il im in io"><h1 id="3265" class="le lf ir bd lg lh li lj lk ll lm ln lo jx lp jy lq ka lr kb ls kd lt ke lu lv bi translated">嵌套查询</h1><p id="521d" class="pw-post-body-paragraph lz ma ir mc b md mz js mf mg na jv mi mw nb ml mm mx nc mp mq my nd mt mu mv ik bi translated">有时在开发过程中，我们有一些带有剩余外键的模型。模型的外键指向不存在的模型。嵌套查询帮助我找到了这些模型。</p><p id="4ea9" class="pw-post-body-paragraph lz ma ir mc b md me js mf mg mh jv mi mw mk ml mm mx mo mp mq my ms mt mu mv ik bi translated">首先，我搜索了所有具有外键集的类型，并检查是否有任何具有该键的模型。这样我们就找到了<code class="fe no np nq nf b">Type</code>的现有模型。在搜索不在该集合中的键后，我们得到剩余的外键。</p><pre class="kh ki kj kk gu ne nf ng nh aw ni bi"><span id="1813" class="nj lf ir nf b gz nk nl l nm nn">SELECT * FROM {Type} WHERE {fKey} NOT IN ({{ SELECT {pk} FROM {AbstractType} WHERE {pk} IN ({{SELECT {fKey} FROM {Type} WHERE {fKey} IS NOT NULL}}) }})</span></pre></div><div class="ab cl kx ky hv kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ik il im in io"><p id="01ab" class="pw-post-body-paragraph lz ma ir mc b md me js mf mg mh jv mi mw mk ml mm mx mo mp mq my ms mt mu mv ik bi translated">感谢您阅读这篇文章。</p></div></div>    
</body>
</html>