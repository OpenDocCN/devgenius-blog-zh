<html>
<head>
<title>Ambassador Pattern 101</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">大使模式 101</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/ambassador-pattern-101-399fd38b0662?source=collection_archive---------8-----------------------#2022-05-08">https://blog.devgenius.io/ambassador-pattern-101-399fd38b0662?source=collection_archive---------8-----------------------#2022-05-08</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="3a47" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这篇博客是我们从零开始讨论 101 个<strong class="jm io"> </strong>概念的系列文章的一部分，读者的入门知识有限。本文属于<strong class="jm io"> <em class="ki">中级</em> </strong>系列，因为它涉及对<strong class="jm io">大使模式</strong>的理解——主要用作与业务应用程序/客户机协同运行的独立代理服务。</p><p id="3855" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">101 系列中的一些早期博客如下:</p><p id="c44f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae kj" rel="noopener ugc nofollow" target="_blank" href="/api-101-773ec501b485"><strong class="jm io">API 101</strong></a><a class="ae kj" rel="noopener ugc nofollow" target="_blank" href="/async-communication-101-b04d5c95333a"><strong class="jm io"><br/>异步通信 101</strong></a><strong class="jm io"><br/></strong><a class="ae kj" rel="noopener ugc nofollow" target="_blank" href="/database-101-13d593ec4078"><strong class="jm io">数据库 101</strong></a><strong class="jm io"><br/></strong><a class="ae kj" rel="noopener ugc nofollow" target="_blank" href="/database-design-101-7c019d69b97f"><strong class="jm io">数据库设计 101</strong></a><strong class="jm io"><br/><a class="ae kj" rel="noopener ugc nofollow" target="_blank" href="/deployment-strategies-101-ee2badd60799"><strong class="jm io">部署策略 101 </strong> </a></strong></p><h1 id="2cdb" class="kk kl in bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">什么是大使模式？</h1><p id="27ee" class="pw-post-body-paragraph jk jl in jm b jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc kd lm kf kg kh ig bi translated">Ambassador 是<a class="ae kj" href="https://docs.microsoft.com/en-us/azure/architecture/patterns/sidecar" rel="noopener ugc nofollow" target="_blank"> s <strong class="jm io"> ide-car 模式</strong> </a> <strong class="jm io"> </strong>的一个特例，它使用一个公共的协同定位服务/容器(在基于 Kubernetes/Docker 的部署的情况下)来卸载公共客户端连接功能，例如<strong class="jm io">监控、日志、路由、安全性、弹性</strong>。大使服务通过提供 L7 特性，如<strong class="jm io"> HTTP 重试、断路器模式、请求头修改等，充当用多种语言和框架编写的遗留服务的可重用代理解决方案。</strong> Ambassador 版本和基础设施可以独立于业务应用程序/容器进行发布和扩展，这使其成为满足业务领域非功能性需求的合适选择。</p><h1 id="eccd" class="kk kl in bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">大使当边车</h1><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ln"><img src="../Images/4770088178714612589aa45028d8aff3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*brkLcF-i8-B6urFZBHrwtQ.jpeg"/></div></div></figure><h1 id="7847" class="kk kl in bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">顺序流程</h1><ol class=""><li id="8406" class="lz ma in jm b jn li jr lj jv mb jz mc kd md kh me mf mg mh bi translated">应用程序容器通过<strong class="jm io">大使代理</strong>向远程<strong class="jm io">服务 B/服务 C </strong>发送请求</li><li id="6112" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">代理边车将跟踪信息添加到请求头中。还通过为<a class="ae kj" href="https://www.cloudflare.com/en-in/learning/access-management/what-is-mutual-tls/#:~:text=Mutual%20TLS%2C%20or%20mTLS%20for,TLS%20certificates%20provides%20additional%20verification." rel="noopener ugc nofollow" target="_blank"> <strong class="jm io">相互 TLS </strong> </a> <strong class="jm io">添加证书来加密请求。</strong>另外开始测量请求延迟。</li><li id="3efa" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">远程<strong class="jm io">服务 B/服务 C </strong>接收请求，并在发回响应消息之前验证请求头。</li><li id="b26f" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">大使端汽车接收返回的响应并记录请求等待时间。</li><li id="887b" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">应用程序容器接收最终的响应。</li></ol><h1 id="b4da" class="kk kl in bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">用例</h1><ol class=""><li id="d96a" class="lz ma in jm b jn li jr lj jv mb jz mc kd md kh me mf mg mh bi translated">当遗留服务以多种语言构建，并且为每个客户端添加网络/路由功能的开发时间和成本与添加到通用的基于代理的解决方案相比非常高时。</li><li id="9860" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">当常见的非功能性架构模式(如 c <strong class="jm io">电路中断、应用程序插装、速率限制</strong>具有独立于客户端应用程序的策略时。</li><li id="b8b2" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">具有分片数据库/消息传递层和多个正在运行的基础设施实例/节点的应用程序，因此需要使用通用组件对配置进行抽象。</li></ol><h1 id="73f4" class="kk kl in bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">应用程序分片示例</h1><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi mn"><img src="../Images/8de400253e164ecb7aea291eea278c18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zDVC98s4SIB2fi9zwOkVSQ.jpeg"/></div></div></figure><h1 id="eafa" class="kk kl in bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">限制</h1><ol class=""><li id="8675" class="lz ma in jm b jn li jr lj jv mb jz mc kd md kh me mf mg mh bi translated">具有关键延迟要求和端到端往返的应用程序请求可能会受到额外的侧车代理的影响</li><li id="eac4" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">具有与客户端代码/语言深度集成的连接需求的应用程序以及通过代理隔离请求是不可伸缩的。</li></ol><h1 id="c7cd" class="kk kl in bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">摘要</h1><p id="b498" class="pw-post-body-paragraph jk jl in jm b jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc kd lm kf kg kh ig bi translated">我们讨论了 Ambassador 模式的基础知识，这是一种流行的设计模式，有助于在不构建基于端到端服务网格的集成解决方案的情况下，实现遗留应用程序需求的现代化。在 Kubernetes 世界中，大使代理可以作为服务清单文件部署，并随应用程序单元一起扩展</p><p id="abc0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="ki">如需反馈，请留言至</em><strong class="jm io"><em class="ki">Amit[dot]894[at]Gmail[dot]com</em></strong><em class="ki">或联系</em><a class="ae kj" href="https://about.me/amit_raj" rel="noopener ugc nofollow" target="_blank"><em class="ki">https://about.me/amit_raj</em></a><em class="ki">的任何链接。</em></p></div></div>    
</body>
</html>