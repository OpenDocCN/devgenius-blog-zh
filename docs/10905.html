<html>
<head>
<title>How to use Google cloud vision API to detect landmarks in image upload in Laravel</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在 Laravel 中使用 Google cloud vision API 检测图片上传中的地标</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-use-google-cloud-vision-api-to-detect-landmarks-in-image-upload-in-laravel-4e8976982dc8?source=collection_archive---------13-----------------------#2022-12-06">https://blog.devgenius.io/how-to-use-google-cloud-vision-api-to-detect-landmarks-in-image-upload-in-laravel-4e8976982dc8?source=collection_archive---------13-----------------------#2022-12-06</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><figure class="im in gp gr io ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/ab78f1df454f3bcb4e6432f83662c306.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tnjXW1WiVKqL2ov-"/></div></div></figure><div class=""/><p id="6b90" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在本文中，我们将了解如何使用 Google cloud vision API 在 Laravel 应用程序中检测图像上传中的地标。</p><p id="bbba" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><a class="ae kt" href="https://cloud.google.com/vision/docs/detecting-landmarks" rel="noopener ugc nofollow" target="_blank">检测地标</a></p><p id="2800" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">地标检测对于检测图像中常见的自然和人造结构是有用的。</p><p id="03f4" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了检测和检索图像中的产品地标信息，Google vision API 就派上了用场。</p><p id="cc72" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在本教程<a class="ae kt" href="https://alemsbaja.hashnode.dev/how-to-use-google-cloud-vision-api-safe-search-detection-to-detect-explicit-content-on-image-uploads-in-laravel" rel="noopener ugc nofollow" target="_blank">如何使用 Google cloud vision API 安全搜索检测来检测 Laravel </a>中图片上传的露骨内容中，我们详细介绍了如何创建 Google Cloud Platform (GCP)项目、服务帐户凭证以及将 cloud vision 软件包集成到 Laravel 中。</p><p id="8dd2" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了保持这篇文章的简短，我们将直接探讨徽标检测如何在图像文件上传上工作，因为我们已经有了一个用于上传文件的<a class="ae kt" href="https://github.com/RaphAlemoh/google_cloud_vision_features/blob/main/resources/views/uploads/create.blade.phpt" rel="noopener ugc nofollow" target="_blank">表单。</a></p><figure class="kv kw kx ky gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi ku"><img src="../Images/fbfa650ed519a020db54a67bc7ad75bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZUDrS-Cp7M_3jWyi"/></div></div></figure><p id="4b45" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">注意:为了清楚起见，每个特征在 web.php 文件中都有自己的路径。</p><p id="21b4" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">您也可以检查 Github 上的一个特定分支，查看它的实现。</p><ul class=""><li id="6d4a" class="kz la iy jx b jy jz kc kd kg lb kk lc ko ld ks le lf lg lh bi translated">检测局部图像中的界标</li></ul><p id="d7bc" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这里有一个<a class="ae kt" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/master/vision/src/detect_landmark.php" rel="noopener ugc nofollow" target="_blank">存储库</a>及其集成的例子。</p><ul class=""><li id="0398" class="kz la iy jx b jy jz kc kd kg lb kk lc ko ld ks le lf lg lh bi translated">导入类</li></ul><pre class="kv kw kx ky gt li lj lk bn ll lm bi"><span id="4ca7" class="ln lo iy lj b be lp lq l lr ls">use Google\Cloud\Vision\V1\ImageAnnotatorClient;<br/>// this HtmlStringclass is used to format the text detected on the image<br/>use Illuminate\Support\HtmlString;</span></pre><ul class=""><li id="0a86" class="kz la iy jx b jy jz kc kd kg lb kk lc ko ld ks le lf lg lh bi translated">对上传的图像运行 landmarkDetection</li></ul><pre class="kv kw kx ky gt li lj lk bn ll lm bi"><span id="05d1" class="ln lo iy lj b be lp lq l lr ls">    public function detectLandmarks(Request $request)<br/>    {<br/><br/>        $request-&gt;validate([<br/>            'avatar' =&gt; 'required|image|max:10240',<br/>        ]);<br/><br/>        try {<br/><br/>            $imageAnnotator = new ImageAnnotatorClient([<br/>                //we can also keep the details of the google cloud json file in an env and read it as an object here<br/>                'credentials' =&gt; config_path('laravel-cloud.json')<br/>            ]);<br/><br/>            # annotate the image<br/>            $image = file_get_contents($request-&gt;file("avatar"));<br/>            $response = $imageAnnotator-&gt;landmarkDetection($image);<br/>            $landmarks = $response-&gt;getLandmarkAnnotations();<br/><br/>            $number_landmarks = count($landmarks);<br/>            $landmark_content = '';<br/><br/>            printf('%d landmark found:' . PHP_EOL, count($landmarks));<br/>            foreach ($landmarks as $landmark) {<br/>                $landmark_content .= "{$landmark-&gt;getDescription()}";<br/>                print($landmark-&gt;getDescription() . PHP_EOL);<br/>            }<br/><br/><br/>            $formatted_landmark = new HtmlString($landmark_content);<br/><br/>            return redirect()-&gt;route('home')<br/>                -&gt;with('success', "Landmark detection successful!!! Number of Landmarks:  $number_landmarks Formatted Landmark found on image uploaded: $formatted_landmark");<br/>        } catch (Exception $e) {<br/>            return $e-&gt;getMessage();<br/>        }<br/>        $imageAnnotator-&gt;close();<br/>    }<br/><br/></span></pre><ul class=""><li id="d4b2" class="kz la iy jx b jy jz kc kd kg lb kk lc ko ld ks le lf lg lh bi translated">我们将上传此图像，并查看如何检测上传图像中的徽标</li></ul><figure class="kv kw kx ky gt ip gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/c9b0dd93da9789d25b2d8c5399086957.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/0*KsYnhTUFVgnGyaJy"/></div></figure><ul class=""><li id="80e6" class="kz la iy jx b jy jz kc kd kg lb kk lc ko ld ks le lf lg lh bi translated">在上传的图像中检测到地标</li></ul><figure class="kv kw kx ky gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi lu"><img src="../Images/18cad1cb3ea312e1c09f06c187e54d5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Vz4h9rBlRn0sbdC3"/></div></div></figure><p id="3cc6" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx iz">检测到的地标是圣瓦西里大教堂</strong></p><ul class=""><li id="64f0" class="kz la iy jx b jy jz kc kd kg lb kk lc ko ld ks le lf lg lh bi translated">检测远程图像中的文本(谷歌云存储，Cloudinary，S3 桶等)</li></ul><p id="65a1" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了在远程图像(云或网络)上执行 Vision API 地标检测，只需在请求中指定文件 URL。</p><p id="1b3e" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx iz">注意:当从 HTTP/HTTPS URL 获取图像时，Google 不能保证请求会被完成。如果指定的主机拒绝请求(例如，由于请求限制或 DoS 阻止)，或者如果 Google 为了防止滥用而限制对站点的请求，您的请求可能会失败。作为最佳实践，不要依赖生产应用程序的外部托管映像。</strong></p><p id="9ad5" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">只需将上传文件名替换为互联网或远程存储上的图像 URL</p><pre class="kv kw kx ky gt li lj lk bn ll lm bi"><span id="cda9" class="ln lo iy lj b be lp lq l lr ls">     $image = 'file_path...https://googleapis.com.......png';<br/><br/>            //run the image details detection feature on the image<br/>            $response = $imageAnnotatorClient-&gt;landmarkDetection($image);</span></pre><p id="fe66" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">下面是教程<a class="ae kt" href="https://github.com/RaphAlemoh/google_cloud_vision_features" rel="noopener ugc nofollow" target="_blank">资源库</a></p><p id="eeab" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">感谢您阅读本文！！！。</p><p id="4dea" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果你觉得这篇文章有帮助，请分享给你的网络，并随时使用评论区的问题，答案和贡献。</p></div><div class="ab cl lv lw hr lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="ig ih ii ij ik"><p id="ed97" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="mc">原发布于</em><a class="ae kt" href="https://alemsbaja.hashnode.dev/how-to-use-google-cloud-vision-api-to-detect-landmarks-in-image-upload-in-laravel" rel="noopener ugc nofollow" target="_blank"><em class="mc">https://alemsbaja . hashnode . dev</em></a><em class="mc">。</em></p></div></div>    
</body>
</html>