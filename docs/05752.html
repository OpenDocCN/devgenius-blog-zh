<html>
<head>
<title>User Registration Service</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用户注册服务</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/user-registration-service-5c1739321eb7?source=collection_archive---------1-----------------------#2021-10-19">https://blog.devgenius.io/user-registration-service-5c1739321eb7?source=collection_archive---------1-----------------------#2021-10-19</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="3388" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">用户注册一个应用会怎么样？</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/eaaa6d530f785b9741e5e48edc0a0db9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fUHJLkoMdOV-l1OJ"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">照片由<a class="ae ks" href="https://unsplash.com/@mr_williams_photography?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">迈卡·威廉姆斯</a>在<a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="28d7" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi lp translated">这些天我们有如此多的应用程序需要我们注册才能访问它们的应用程序。如果注册成功，我们就可以登录应用程序。让我们了解一下当我们注册任何应用程序时，后台发生了什么。</p><h2 id="011c" class="ly lz in bd ma mb mc dn md me mf dp mg lc mh mi mj lg mk ml mm lk mn mo mp mq bi translated">用户注册</h2><p id="5084" class="pw-post-body-paragraph kt ku in kv b kw mr jo ky kz ms jr lb lc mt le lf lg mu li lj lk mv lm ln lo ig bi translated">注册请求必须提供一个用户对象作为键/值属性的集合。集合必须包含标记为 identity 的属性以及<code class="fe mw mx my mz b">password</code>属性。此外，如果您的应用程序被配置为确认注册用户的电子邮件地址，那么<code class="fe mw mx my mz b">email</code>属性是必需的。</p><p id="be29" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">方法:</em>发布</p><p id="79d6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">端点 URL : </em></p><pre class="kd ke kf kg gt nb mz nc nd aw ne bi"><span id="b366" class="ly lz in mz b gy nf ng l nh ni">http://localhost:8080/api/users/register</span></pre><p id="bbca" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">请求头:</em>内容类型:应用程序/json</p><p id="496c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">其中<code class="fe mw mx my mz b">Content-Type</code>必须设置为<code class="fe mw mx my mz b">application/json</code>。此标题是强制性的。</p><p id="d2a2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">请求正文:</em></p><pre class="kd ke kf kg gt nb mz nc nd aw ne bi"><span id="3e75" class="ly lz in mz b gy nf ng l nh ni">{  <br/>  "first_name" : value,  <br/>  "last_name" : value,  <br/>  "email" : value,<br/>  "password" : value <br/>}</span></pre><p id="5692" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">响应正文:</em></p><pre class="kd ke kf kg gt nb mz nc nd aw ne bi"><span id="fea5" class="ly lz in mz b gy nf ng l nh ni">{<br/>  "objectId" : value,<br/>  "first_name" : value,  <br/>  "last_name" : value,  <br/>  "email" : value,<br/>  "password" : value <br/>}</span></pre><p id="10e1" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">错误代码:</em></p><p id="907a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">当服务器端报告错误时，它以下列格式返回一个 JSON 对象:</p><pre class="kd ke kf kg gt nb mz nc nd aw ne bi"><span id="2f72" class="ly lz in mz b gy nf ng l nh ni">{  <br/>  "message" : error-message,  <br/>  "code" : error-code  <br/>}</span></pre><h2 id="c6a3" class="ly lz in bd ma mb mc dn md me mf dp mg lc mh mi mj lg mk ml mm lk mn mo mp mq bi translated">创建电子邮件确认 URL</h2><p id="e6dc" class="pw-post-body-paragraph kt ku in kv b kw mr jo ky kz ms jr lb lc mt le lf lg mu li lj lk mv lm ln lo ig bi translated">确认电子邮件包含一个特殊链接，用户单击该链接可以确认他们的电子邮件地址。当点击链接且链接未过期时，用户状态从<code class="fe mw mx my mz b">EMAIL_CONFIRMATION_PENDING</code>变为<code class="fe mw mx my mz b">ENABLED</code>。发送给用户的电子邮件可以使用 Amazon Simple Email Service 创建。有些场景需要在应用程序逻辑中生成链接，例如，如果您需要通过文本消息发送出去，或者如果您需要动态生成确认电子邮件。下面的 API 用于获取用户的确认 URL。</p><p id="ab6d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">方法:</em>贴</p><p id="e561" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">端点 URL : </em></p><pre class="kd ke kf kg gt nb mz nc nd aw ne bi"><span id="d45e" class="ly lz in mz b gy nf ng l nh ni">http://localhost:8080/api/users/resendconfirmation/&lt;identity&gt;</span></pre><p id="d502" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">其中，Users 表中标记为 identity 的列中的<code class="fe mw mx my mz b">&lt;identity&gt;</code>值。默认情况下，应用程序将<code class="fe mw mx my mz b">email</code>作为标识列。在这种情况下，API 的参数应该是用户的电子邮件地址。</p><p id="8c75" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">请求头:</em>内容类型:应用程序/json</p><p id="f62a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">其中<code class="fe mw mx my mz b">Content-Type</code>必须设置为<code class="fe mw mx my mz b">application/json</code>。此标题是强制性的。</p><p id="4d73" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">请求正文:</em>无</p><p id="52c4" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">响应体:</em>一个 JSON 文档，结构如下。</p><pre class="kd ke kf kg gt nb mz nc nd aw ne bi"><span id="8e7a" class="ly lz in mz b gy nf ng l nh ni">{  <br/>  "confirmationURL": "https://xxxx.backendless.app/api/............"  <br/>}</span></pre><p id="25ac" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">错误代码:</em></p><p id="119d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">当服务器端报告错误时，它以下列格式返回一个 JSON 对象:</p><pre class="kd ke kf kg gt nb mz nc nd aw ne bi"><span id="a45f" class="ly lz in mz b gy nf ng l nh ni">{  <br/>  "message" : error-message,  <br/>  "code" : error-code  <br/>}</span></pre><h2 id="a403" class="ly lz in bd ma mb mc dn md me mf dp mg lc mh mi mj lg mk ml mm lk mn mo mp mq bi translated">电子邮件验证</h2><p id="d190" class="pw-post-body-paragraph kt ku in kv b kw mr jo ky kz ms jr lb lc mt le lf lg mu li lj lk mv lm ln lo ig bi translated">该 API 向用户重新发送电子邮件确认消息。它仅适用于启用了“要求电子邮件确认”选项的应用程序。如果用户状态是“电子邮件确认待定”，则重新发送带有确认链接的电子邮件，否则会出现错误。</p><p id="5a94" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">方法:</em>发布</p><p id="624d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">端点 URL : </em></p><pre class="kd ke kf kg gt nb mz nc nd aw ne bi"><span id="f9d1" class="ly lz in mz b gy nf ng l nh ni">http://localhost:8080/api/users/resendconfirmation/&lt;identity&gt;</span></pre><p id="02a5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">其中，Users 表中标记为 identity 的列中的<code class="fe mw mx my mz b">&lt;identity&gt;</code>值。默认情况下，应用程序将<code class="fe mw mx my mz b">email</code>作为标识列。在这种情况下，API 的参数应该是用户的电子邮件地址。</p><p id="9e99" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">请求头:</em>内容类型:应用程序/json</p><p id="1a92" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">其中<code class="fe mw mx my mz b">Content-Type</code>必须设置为<code class="fe mw mx my mz b">application/json</code>。此标题是强制性的。</p><p id="d133" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">请求正文:</em>无</p><p id="a31b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">响应正文:</em>无。如果 API 请求成功完成，这意味着已经向用户发送了电子邮件确认消息。否则，将返回一个错误。</p><p id="9dac" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">错误代码:</em></p><p id="7af7" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">当服务器端报告错误时，它以下列格式返回一个 JSON 对象:</p><pre class="kd ke kf kg gt nb mz nc nd aw ne bi"><span id="08f7" class="ly lz in mz b gy nf ng l nh ni">{  <br/>  "message" : error-message,  <br/>  "code" : error-code  <br/>}</span></pre><h2 id="69ea" class="ly lz in bd ma mb mc dn md me mf dp mg lc mh mi mj lg mk ml mm lk mn mo mp mq bi translated">用户登录</h2><p id="a9ca" class="pw-post-body-paragraph kt ku in kv b kw mr jo ky kz ms jr lb lc mt le lf lg mu li lj lk mv lm ln lo ig bi translated">登录操作需要两个属性:一个标记为用户身份，另一个是密码。它自动将<code class="fe mw mx my mz b">"AuthenticatedUser"</code>角色分配给所有成功登录的用户。该角色可用于区分经过身份验证的用户和来宾对各种资源(数据库中的数据、文件、消息传递通道)的访问。</p><p id="4ebf" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">方法:</em>贴</p><p id="6728" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">端点 URL : </em></p><pre class="kd ke kf kg gt nb mz nc nd aw ne bi"><span id="15bb" class="ly lz in mz b gy nf ng l nh ni">http://localhost:8080/api/users/login</span></pre><p id="2672" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">请求头:</em>内容类型:应用程序/json</p><p id="715f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">其中<code class="fe mw mx my mz b">Content-Type</code>必须设置为<code class="fe mw mx my mz b">application/json</code>。此标题是强制性的。</p><p id="b396" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">请求正文:</em></p><pre class="kd ke kf kg gt nb mz nc nd aw ne bi"><span id="2e16" class="ly lz in mz b gy nf ng l nh ni">{  <br/>  "login" : value,<br/>  "password" : value <br/>}</span></pre><p id="e02b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><code class="fe mw mx my mz b">"login"</code>键必须包含标记为 identity 的属性值。身份用于登录和恢复密码操作。当用户注册时，服务器将确保身份属性的值是唯一的。</p><p id="3b0d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">响应正文:</em></p><pre class="kd ke kf kg gt nb mz nc nd aw ne bi"><span id="26c1" class="ly lz in mz b gy nf ng l nh ni">{  <br/>  "objectId" : value,  <br/>  "user-token": value,   <br/>  "prop-name1":value,  <br/>  "prop-name2":value,  <br/>  "prop-name3":value,  <br/>  ...  <br/>}</span></pre><p id="c676" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><code class="fe mw mx my mz b">objectId</code>属性是服务器分配给用户帐户的唯一标识符。<code class="fe mw mx my mz b">user-token</code>值标识由登录操作发起的用户会话。这两个值<code class="fe mw mx my mz b">objectId</code>和<code class="fe mw mx my mz b">user-token</code>都是更新数据库中的用户所必需的。</p><p id="0607" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">错误代码:</em></p><p id="ca53" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">当服务器端报告错误时，它以下列格式返回一个 JSON 对象:</p><pre class="kd ke kf kg gt nb mz nc nd aw ne bi"><span id="a5b8" class="ly lz in mz b gy nf ng l nh ni">{  <br/>  "message" : error-message,  <br/>  "code" : error-code  <br/>}</span></pre><h2 id="4d75" class="ly lz in bd ma mb mc dn md me mf dp mg lc mh mi mj lg mk ml mm lk mn mo mp mq bi translated">维护用户会话</h2><p id="3bf9" class="pw-post-body-paragraph kt ku in kv b kw mr jo ky kz ms jr lb lc mt le lf lg mu li lj lk mv lm ln lo ig bi translated">登录 API 中返回的<code class="fe mw mx my mz b">user-token</code>值必须在后续请求中使用，以便维护用户会话。该值唯一标识服务器上的用户和会话，并用于实施安全策略、应用用户和角色权限以及跟踪使用率分析。对于登录后发出的所有请求，必须在 HTTP 头中发送<code class="fe mw mx my mz b">user-token</code>值:</p><pre class="kd ke kf kg gt nb mz nc nd aw ne bi"><span id="4f95" class="ly lz in mz b gy nf ng l nh ni">"user-token" : value</span></pre><h2 id="2782" class="ly lz in bd ma mb mc dn md me mf dp mg lc mh mi mj lg mk ml mm lk mn mo mp mq bi translated">验证用户登录</h2><p id="9a26" class="pw-post-body-paragraph kt ku in kv b kw mr jo ky kz ms jr lb lc mt le lf lg mu li lj lk mv lm ln lo ig bi translated"><code class="fe mw mx my mz b">user-token</code>值可以保存在客户端应用程序中，以便在应用程序重启时使用。这有助于简化用户体验，因为应用程序的用户不需要再次登录。但是，当应用程序重新启动时，它需要检查底层用户令牌以及用户会话是否仍然有效。这可以通过下面的 API 来实现:</p><p id="c347" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">方法:</em>获取</p><p id="4a0d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">端点 URL : </em></p><pre class="kd ke kf kg gt nb mz nc nd aw ne bi"><span id="143a" class="ly lz in mz b gy nf ng l nh ni">http://localhost:8080/api/users/isvalidusertoken/&lt;userToken&gt;</span></pre><p id="7ae2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">其中<code class="fe mw mx my mz b">&lt;userToken&gt;</code>用于验证。用户令牌的值作为登录 API 请求的结果返回。</p><p id="4e94" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">返回值:</em></p><p id="0cd7" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果令牌有效，服务器返回布尔值<code class="fe mw mx my mz b">true</code>，否则返回<code class="fe mw mx my mz b">false</code>。</p><h2 id="ac0f" class="ly lz in bd ma mb mc dn md me mf dp mg lc mh mi mj lg mk ml mm lk mn mo mp mq bi translated">注销</h2><p id="ec5c" class="pw-post-body-paragraph kt ku in kv b kw mr jo ky kz ms jr lb lc mt le lf lg mu li lj lk mv lm ln lo ig bi translated">注销操作终止用户会话，并解除<code class="fe mw mx my mz b">AuthenticatedUser</code>角色与客户端应用程序发出的后续请求的关联。</p><p id="0985" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">方法:</em>获取</p><p id="445d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">端点 URL : </em></p><pre class="kd ke kf kg gt nb mz nc nd aw ne bi"><span id="6578" class="ly lz in mz b gy nf ng l nh ni">http://localhost:8080/api/users/logout</span></pre><p id="b2da" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">请求标题:</em></p><pre class="kd ke kf kg gt nb mz nc nd aw ne bi"><span id="9fb0" class="ly lz in mz b gy nf ng l nh ni">user-token: value-of-the-user-token-header-from-login</span></pre><p id="84a0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">其中<code class="fe mw mx my mz b">user-token</code>是前面登录操作的响应中返回的值。该值标识要注销的用户。此标题是强制性的。</p><p id="1e57" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">错误代码:</em></p><p id="f6ed" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">当服务器端报告错误时，它以下列格式返回一个 JSON 对象:</p><pre class="kd ke kf kg gt nb mz nc nd aw ne bi"><span id="ff07" class="ly lz in mz b gy nf ng l nh ni">{  <br/>  "message" : error-message,  <br/>  "code" : error-code  <br/>}</span></pre><p id="1b5a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在本文中，我们讨论了用户注册的细节。许多应用程序也在使用 OAuth。OAuth 用于授权网站或应用程序访问它们在其他网站上的信息，但不提供密码。我们将在以后的文章中讨论 OAuth 工作流。敬请关注。快乐学习！🎃</p></div></div>    
</body>
</html>