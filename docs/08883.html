<html>
<head>
<title>Design patterns for Microservices</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">微服务的设计模式</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/design-patterns-for-microservices-1399eea583b7?source=collection_archive---------10-----------------------#2022-07-16">https://blog.devgenius.io/design-patterns-for-microservices-1399eea583b7?source=collection_archive---------10-----------------------#2022-07-16</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="c61b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在本文中，我们将讨论微服务的聚合器模式。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b235f950df94a50bb7f4bbbc121317d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CRURlQZjAJYADiBv03YvMQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">聚合器模式</figcaption></figure><ul class=""><li id="10a4" class="ky kz in jm b jn jo jr js jv la jz lb kd lc kh ld le lf lg bi translated">有 3 种不同的方法来实现聚合模式。</li></ul><ol class=""><li id="6a29" class="ky kz in jm b jn jo jr js jv la jz lb kd lc kh lh le lf lg bi translated">平行聚合</li><li id="721d" class="ky kz in jm b jn li jr lj jv lk jz ll kd lm kh lh le lf lg bi translated">链聚集</li><li id="568d" class="ky kz in jm b jn li jr lj jv lk jz ll kd lm kh lh le lf lg bi translated">分支聚集</li></ol><ul class=""><li id="23f9" class="ky kz in jm b jn jo jr js jv la jz lb kd lc kh ld le lf lg bi translated">让我们考虑一个为公司实现微服务平台场景。</li></ul><p id="d2c7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">设计:</strong></p><ul class=""><li id="fcf2" class="ky kz in jm b jn jo jr js jv la jz lb kd lc kh ld le lf lg bi translated">服务 1:获取个人(员工)信息的服务</li><li id="32ce" class="ky kz in jm b jn li jr lj jv lk jz ll kd lm kh ld le lf lg bi translated">服务 2:获取休假信息的服务</li><li id="02b5" class="ky kz in jm b jn li jr lj jv lk jz ll kd lm kh ld le lf lg bi translated">服务三:评估信息服务</li><li id="5923" class="ky kz in jm b jn li jr lj jv lk jz ll kd lm kh ld le lf lg bi translated">服务号 4:分配信息服务</li></ul><p id="9327" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">消费者:</strong></p><ol class=""><li id="55a4" class="ky kz in jm b jn jo jr js jv la jz lb kd lc kh lh le lf lg bi translated">考勤管理系统</li><li id="d8be" class="ky kz in jm b jn li jr lj jv lk jz ll kd lm kh lh le lf lg bi translated">项目管理系统</li></ol><blockquote class="ln lo lp"><p id="94c4" class="jk jl lq jm b jn jo jp jq jr js jt ju lr jw jx jy ls ka kb kc lt ke kf kg kh ig bi translated">假设给我们一个任务，将这个单片系统转换成基于微服务的系统。</p></blockquote><ul class=""><li id="07da" class="ky kz in jm b jn jo jr js jv la jz lb kd lc kh ld le lf lg bi translated">采取考勤制度。它需要两项服务。(个人信息服务和请假信息服务)。因此，现在我们应该尝试创建一个服务来消费这两个服务，并向消费者提供反馈。该新服务将接受来自消费者的请求，并调用个人信息和离开信息服务，汇总这些响应并发送回消费者。</li><li id="eb6b" class="ky kz in jm b jn li jr lj jv lk jz ll kd lm kh ld le lf lg bi translated">当您调用这个出勤服务时，它可以做三件事。</li></ul><ol class=""><li id="6748" class="ky kz in jm b jn jo jr js jv la jz lb kd lc kh lh le lf lg bi translated">并行聚集(分散聚集模式):向个人信息服务和离开信息服务发送并行过程，得到那些响应，并聚集那些类型的单个响应，并发送给消费者</li></ol><p id="642b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">2.链式聚合:所以我不认为休假信息依赖于个人信息。但是它仍然不知道如何从 ID 收集信息。现在，我们可以调用个人信息服务，然后获取员工代码，并将其传递给休假信息服务，获取休假信息。然后，我们可以将聚合器响应发送回消费者。</p><blockquote class="ln lo lp"><p id="4a43" class="jk jl lq jm b jn jo jp jq jr js jt ju lr jw jx jy ls ka kb kc lt ke kf kg kh ig bi translated">假设个人信息服务需要 10 ms 的响应时间，而离开信息系统需要 10 ms 的响应时间。因此，在并行聚合中，我们可以在 10 ms 内获得这两种信息(理论上)。</p><p id="a48a" class="jk jl lq jm b jn jo jp jq jr js jt ju lr jw jx jy ls ka kb kc lt ke kf kg kh ig bi translated">但是如果你一个接一个地进行，就像在链式方法中，第一个调用需要 10 毫秒，第二个调用需要 10 毫秒，那么总的响应时间是 20 毫秒。</p><p id="d2d8" class="jk jl lq jm b jn jo jp jq jr js jt ju lr jw jx jy ls ka kb kc lt ke kf kg kh ig bi translated">这并不意味着并行聚合适合每一种实现，对于编码过程这样的场景，我们必须坚持使用链式方法。</p></blockquote><p id="1046" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">3.分支:假设用户将发送一个雇员 ID 和他的分支机构代码，因此您调用个人信息服务，如果分支机构代码与销售有关，我们可以调用销售信息服务。如果分支代码与开发人员<strong class="jm io"> </strong>相关，则提取与该员工相关的项目分配信息。</p><ul class=""><li id="92bf" class="ky kz in jm b jn jo jr js jv la jz lb kd lc kh ld le lf lg bi translated">这意味着基于一些因素的分支，我们决定它应该指向哪里。</li></ul></div><div class="ab cl lu lv hr lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ig ih ii ij ik"><ul class=""><li id="c7a5" class="ky kz in jm b jn jo jr js jv la jz lb kd lc kh ld le lf lg bi translated">所以请记住，当您执行这种类型的服务时，您需要确保您的授权/认证流程是如何工作的，因为如果认证令牌验证过程需要 5 毫秒，那么 3 个服务将需要 15 毫秒。但问题是，响应周期中的每一毫秒都非常重要。我们应该在往返过程中尽可能节省时间。</li><li id="92b6" class="ky kz in jm b jn li jr lj jv lk jz ll kd lm kh ld le lf lg bi translated">作为解决方案，我们可以有单独的身份管理服务，您可以通过该身份管理服务向聚合服务发送流量。</li></ul><p id="4016" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">参考:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mb mc l"/></div></figure><ul class=""><li id="2a5c" class="ky kz in jm b jn jo jr js jv la jz lb kd lc kh ld le lf lg bi translated">因此，我的下一篇文章将包含如何将断路器模式用于微服务。</li></ul></div></div>    
</body>
</html>