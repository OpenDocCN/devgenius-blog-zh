<html>
<head>
<title>Breaking down docker for data science</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">分解数据科学的 docker</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/breaking-down-docker-for-data-science-6fabb752b087?source=collection_archive---------19-----------------------#2022-01-10">https://blog.devgenius.io/breaking-down-docker-for-data-science-6fabb752b087?source=collection_archive---------19-----------------------#2022-01-10</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="72fd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你曾经在 VM 上手动设置过数据库或者任何像 apache Kafka 这样的开源工具吗？为实验或者甚至为生产建立基础设施是相当麻烦的，而且复制整个环境甚至更困难。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/9fd6889977b61b764a713f0052bc5524.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*e8u6teTHyalPejIBauj4Jw.png"/></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk translated">来源:<a class="ae ku" href="https://www.docker.com/sites/default/files/d8/2019-07/Moby-logo.png" rel="noopener ugc nofollow" target="_blank">图片</a></figcaption></figure><h2 id="bfa9" class="kv kw in bd kx ky kz dn la lb lc dp ld jv le lf lg jz lh li lj kd lk ll lm ln bi translated">那么“码头工人”到底是什么？</h2><p id="c5b3" class="pw-post-body-paragraph jk jl in jm b jn lo jp jq jr lp jt ju jv lq jx jy jz lr kb kc kd ls kf kg kh ig bi translated">根据官方定义——“Docker 是一组平台即服务产品，使用操作系统级虚拟化来交付称为容器的软件包中的软件。容器是相互隔离的，捆绑了它们自己的软件、库和配置文件；他们可以通过明确定义的渠道相互交流。”</p><p id="71da" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在让我们试着用更简单的逻辑来理解这一点。</p><p id="8d1c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">假设您有一台笔记本电脑，在虚拟环境中手动安装了 python 3.8 和几个库，本地运行 postgresql。现在，您觉得需要在五个不同的云虚拟机中进行完全相同的设置，在这种情况下，复制整个环境可能会很繁琐。</p><p id="b0a0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">仍然手动操作的最佳情况是设置 shell 脚本来自动化整个过程，但是如果您的笔记本电脑使用 windows 作为操作系统，而目标虚拟机使用不同的 Linux 发行版，如 CentOS、Ubuntu 等，该怎么办呢？在某些情况下，您可能会发现这些脚本的行为会因操作系统的构建而有所不同。</p><p id="31fb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在本地设备上创建一个虚拟机怎么样？当然，这就是虚拟化的用武之地。简而言之，你现在可以在同一台笔记本电脑上同时运行不同的操作系统，并且它们的资源可以共享。一个虚拟机有一个功能齐全的操作系统发行版，一切都按预期运行。</p><p id="9738" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">太好了！还是没那么伟大？？</p><p id="4e54" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这里的问题是:你需要所有这些功能吗？由于其特性，操作系统本身具有巨大的尺寸。这可以进一步优化。</p><p id="2a08" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因此，请将 Docker 想象成一个运行封装环境的引擎，或者更确切地说，一个具有您特别提到的极简特性的虚拟机，并且具有足够的操作系统来实现预期的功能。容器只不过是这些独立运行的优化环境，它们共享来自主机的资源。您可以使用使容器能够与本地网络、vpc 或公共网络通信的端口来进一步启用网络。当您停止 docker 容器时，您还可以将您的本地或任何持久存储挂载到这些 docker 容器中的一个，以持久保存更改。</p><h1 id="d23e" class="lt kw in bd kx lu lv lw la lx ly lz ld ma mb mc lg md me mf lj mg mh mi lm mj bi translated">数据科学为什么要用 Docker？</h1><p id="fa79" class="pw-post-body-paragraph jk jl in jm b jn lo jp jq jr lp jt ju jv lq jx jy jz lr kb kc kd ls kf kg kh ig bi translated">如果您一直在本地计算机上使用 pip 和 conda 等包管理器试验 data science 包，在虚拟环境中摸索解决包依赖性，或者由于环境变化而在复制结果时遇到问题。有时，在实验的名义下，我们会在本地环境中发狂，我们可能会错误地破坏一些依赖关系，甚至我们的 GPU 驱动程序配置，Docker 可以为您解决所有这些问题。</p><h2 id="99ca" class="kv kw in bd kx ky kz dn la lb lc dp ld jv le lf lg jz lh li lj kd lk ll lm ln bi translated">为什么</h2><p id="be58" class="pw-post-body-paragraph jk jl in jm b jn lo jp jq jr lp jt ju jv lq jx jy jz lr kb kc kd ls kf kg kh ig bi translated">你可以运行一个完整的 juypter 环境(有或者没有 conda 环境)。此外，您可以通过最少的设置获得 GPU 支持。有许多 docker 映像支持 GPU，因为它们有高效使用所需的正确版本的驱动程序。例如:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mk ml l"/></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk translated">用于设置容器的 docker 文件</figcaption></figure><p id="6176" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你可以找到许多官方组织，比如 tensorflow 和 T2 py torch，公开展示他们的官方图片。您可能需要阅读概述页面上的信息，以决定适合您的用例的图像标签，但这些通常是不言自明的。例如，上面我们使用了已经配置了 tensorflow 的 jupyter，但是如果你喜欢自己安装所有东西，并且只需要基本 env，你可以尝试<a class="ae ku" href="https://hub.docker.com/r/conda/miniconda3/" rel="noopener ugc nofollow" target="_blank"> miniconda </a>或 plain ol' <a class="ae ku" href="https://hub.docker.com/r/jupyter/base-notebook" rel="noopener ugc nofollow" target="_blank"> jupyter </a> nb。</p><p id="055e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">您可以将您的笔记本和 requirements.txt 复制到 docker 容器中，或者您可以挂载该卷(基本上只是将您的本地存储附加到 docker 容器中),以防您的文件太大，因为这会严重影响 docker 映像的构建大小。换句话说，你的文件不会被打包在容器中，如果你需要与任何人共享设置，你也必须与容器一起单独共享文件。</p><p id="4bda" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">您可以通过执行以下操作来运行示例:</p><pre class="kj kk kl km gt mm mn mo mp aw mq bi"><span id="be48" class="kv kw in mn b gy mr ms l mt mu">git clone <a class="ae ku" href="https://github.com/smiraldr/docker-jupyter-sample.git" rel="noopener ugc nofollow" target="_blank">https://github.com/smiraldr/docker-jupyter-sample.git</a></span><span id="71fd" class="kv kw in mn b gy mv ms l mt mu">cd docker-jupyter-sample/app</span><span id="7091" class="kv kw in mn b gy mv ms l mt mu">docker build -t my_tf_jupyterenv .</span><span id="37e7" class="kv kw in mn b gy mv ms l mt mu">docker run -v /Users/smiralrashinkar/Desktop/free/docker-jupyter-sample/app/notebooks:/app -p 80:80 my_tf_jupyterenv:latest <br/>#after -v remove the path and paste your own path</span></pre><p id="347b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">然后，您可以前往您的 localhost:80，瞧！你让你的 jupyter 实验室在这个容器里运行。此外，您可以在 jupyterlab 上看到您的笔记本，因为我们已经从本地机器上安装了一个卷。</p><p id="c63f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，如果你想共享这个环境或在云上部署它，你可以简单地将容器推到 dockerhub 或使用各种解决方案部署它，如 Google cloud run。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi mw"><img src="../Images/f57f9fff05e5010d3602646ae00359d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Yaghxdz-eA6Acuoe2wgNkQ.gif"/></div></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk translated">Docker +数据科学= ❤️ |来源:<a class="ae ku" href="https://dribbble.com/shots/3122897-Nyan-Whale" rel="noopener ugc nofollow" target="_blank">图片</a>(作者允许使用)</figcaption></figure></div></div>    
</body>
</html>