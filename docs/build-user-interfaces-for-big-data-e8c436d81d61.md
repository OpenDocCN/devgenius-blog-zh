# 如何为大数据构建用户界面

> 原文：<https://blog.devgenius.io/build-user-interfaces-for-big-data-e8c436d81d61?source=collection_archive---------1----------------------->

## 设计和开发在压力下不会崩溃的高性能用户界面

![](img/feb89116949f325707bc43206d2b0ac6.png)

在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上由 [Carlos Muza](https://unsplash.com/@kmuza?utm_source=medium&utm_medium=referral) 拍摄的照片

在现代世界中，数据已经成为最有价值的商品之一。公司集体花费数十亿美元来寻找、塑造和分析它。

> 这种转变的结果是，我们可用的数据量已经超出了我们传统的查看方式

现在，全世界的工程师都在重新思考我们使用的技术，并采用各种策略来确保他们有能力处理这种信息的增长。

面向用户的元素也不例外。假设它可以开箱即用地呈现数百万个数据点是不现实的。

我最近在一家初创公司的团队中，负责构建网络监控工具的前端。这里的挑战是我们预期必须处理并以有价值的方式呈现给客户的大量事件。

在这个巨大的挑战中，有几个问题是我们必须回答的，如果这个产品要成功的话，其中有一个特别突出。

# 我们如何创造稳定的用户体验？

这个问题没有单一的解决方案。实现这一目标需要技术和技巧的结合，这可以分为几类:

1.  **增强认知刺激** —用户几乎立即需要认知刺激。数字消费的增加导致人类大脑变得不耐烦。屏幕上没有内容的每一秒钟都不利于用户与应用程序的互动，而在大数据领域，这些时间可能会越来越长。
2.  **控制数据的涌入** —太多，应用程序会变得没有反应。太少，你的产品就失去了价值。如果不能以一种高性能的方式提供有意义的见解，你就不能期望你的产品繁荣，所以找到一个平衡点是至关重要的。
3.  **最大化数据处理能力** —我们需要最大化我们能够在前端处理的数据量。如果有有效的处理方法，控制流入的数量就不是问题了。
4.  **增加外部响应时间**—通过花些时间改进 API 响应时间，我们可以加快数据刷新，带来更流畅的体验。

让我们更详细地看看这些类别中的每一个。

![](img/41e0c3745ae04b130108204174f73ce8.png)

阿曼达·达尔比约恩在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片

# 增强认知刺激

要让动态内容立即为用户所用，我们能做的并不多。服务器必须处理请求、查询数据，然后通过质量不确定的网络做出响应。

传统上，在此过程中，我们会显示一个加载程序或空白屏幕。这两者都不足以保持人脑受到刺激。我们需要做的是将一些智能设计融入到用户界面中，以提高**的感知性能**。

> “感知性能是衡量用户认为你的网站有多快的一个标准”——Matt West

## 乐观 UI

为了给你的应用程序留下比实际更快的印象，我们可以将 API 响应从 UI 更新中分离出来。通过这种方式，我们不必再等待成功或失败的消息，然后再推进 UI 更改。相反，当有响应时，我们会追溯性地通知用户。

一个很好的例子发生在流行的消息应用程序中。当您发送消息时，它会被推送到主聊天窗口，等待发送。如果成功，将显示“已发送”通知。如果传递失败，会显示一条错误消息，通常会与 CTA 一起重新发送。

> **这在大数据环境下意味着什么？**

在处理 API 请求时(考虑到我们要处理的数据量很大，这可能需要几秒钟的时间),我们没有闲着，而是开始为响应设置 UI。例如，将图表轴缩放到正确的时间范围，或者将新的过滤器移动到“选定的过滤器”列表中。

*乐观 UI 在变异数据时效果最好。如果我们要找回它，我们该怎么做？*

## 骨架屏幕

在过去的几年里，骨架屏幕变得越来越流行。它们现在是脸书和 Youtube 等公司构建的界面的基本组成部分。

> 框架屏幕是页面的一种变体，它模仿布局而不提供内容

在检索内容时，我们用动态数据替换模拟布局的单个元素。通常骨骼屏幕会包含一个脉动或闪烁的动画来给人一种进度的印象。

一个书面的解释将不会做的概念公正，所以这里有一个行动中的骨架屏幕的代码笔

如果你有兴趣阅读更多关于骷髅屏幕的内容，Bill Chung 写了一篇很棒的文章。

使用这两种方法应该会吸引用户的注意力，直到服务器返回所需的数据，这将我们带到下一个类别。

![](img/6bec7a1f8e334497c9d0f89f2eea6f53.png)

普拉特克·斯里瓦斯塔瓦在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片

# 控制数据的流入

我们已经讨论了感知性能，现在让我们来谈谈*实际*性能*。*

在构建我们的网络监控工具时，我们需要考虑用于查看它的各种设备。并不是所有的都足够强大，能够处理我们预期产生的大量数据。

利用两种技术来降低这种风险。

## **铲斗**

在软件工程中，数据桶有几种定义。在这种情况下，它是将数据分批到时间间隔中。让我们用一个例子来说明这个概念。

假设您有一个时间序列图，x 轴是以分钟为单位的时间，y 轴是任意的度量值。在一个小时的过程中，服务器接收到 200 万个事件。

如果没有分桶，这些都将被传递到 UI，从而导致性能问题。通过分时段，我们可以将一个小时分成 60 个 1 分钟的间隔。

对于每 1 分钟的时间间隔，我们将对出现的所有数据点进行平均测量。

> 现在我们只需要担心 60 个数据点

这里的代价是我们严重降低了数据的价值。作为响应，前端将允许用户更改时间范围，用新的时间参数触发存储桶刷新。通过这样做，可以保留在粒度级别深入研究数据的能力。

## **惰性加载**

> “延迟加载是一种等到需要时才加载资源的方法，而不是提前加载。这可以通过减少初始页面加载时需要加载和解析的资源量来提高性能。—希拉·西蒙斯

在“控制数据流入”的上下文中，我们讨论的是通过将 API 请求分成两类来减少请求的数量——屏幕上的和屏幕外的。

如果一个组件不在屏幕上，我们会延迟它的请求，直到它的预期位置接近屏幕。像 [react-lazyload](https://www.npmjs.com/package/react-lazyload) 这样的库可以轻松实现。

> 延迟不必要的请求将有助于加速初始加载，更快地向用户传递有价值的信息

因此，现在有一个问题，当用户滚动时会有多个数据加载。这听起来可能不是什么大问题，但同样，在处理大数据时，这很快就会成为一个问题。

为了补救这一点，我们可以迭代技术。我们没有将屏幕外 API 调用推迟到组件出现在屏幕上，而是将它们推迟到视图内 API 请求完成之后。

结合使用这些方法应该可以最大限度地减少加载数据时的冻结。然而，这只是工作的一半。现在，在与数据交互时，重点需要转移到提高性能上。

![](img/86cf31effce20c46d0ace03f0b0c4788.png)

托马斯·凯利在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

# 最大化数据处理**能力**

一旦我们的数据在客户端，用户将开始以各种方式改变它。

这可能需要用户设备上的大量资源。为了最大限度地减少这种情况，我们预先汇总了我们的数据，并使用大 O 符号来确保我们对其执行的任何功能都尽可能高效。

## 预汇总数据

为了避免前端不必要的计算，我们提前执行计算，并将它们存储在数据库中。

假设应用程序始终需要显示两个测量值。如果这种情况只发生一次—它并不昂贵，我们也不必担心预聚合。如果这种情况发生了数百万次，那么先发制人地运行这些计算将减轻客户端的压力，使其能够专注于用户驱动的交互。

作为使用数据库进行预聚合的替代方法，也可以在运行时进行预聚合。

虽然您可以手动完成这项工作，但是使用像[*cross filter*](https://crossfilter.github.io/crossfilter/)*这样的库可以简化这个过程。*

在运行时这样做的警告是，在应用程序加载时需要额外的处理能力。一旦完成，对数据执行过滤和缩减等功能将会快得多。

在运行时这样做的好处是，您可以更好地控制可以聚合的内容，因为您不必使用持久存储。

## 大 O 符号

代码效率经常被忽视，这有利于快速开发特性。学习如何度量并降低代码的复杂性是将效率植入编程的一个很好的方法，而大 O 符号是一个很好的帮助系统。

> 如果我们忽视效率，用户行为可能会使界面崩溃

在处理资源密集型代码(如迭代)时，最好始终保持谨慎，并考虑以下几点:

*   这段代码可能处理多少数据？
*   是否存在不必要的复杂迭代？
*   有嵌套迭代吗？
*   迭代可以早破吗？

当涉及到代码复杂性时，需要考虑很多因素，但是花时间学习如何降低代码复杂性是非常值得的。

你可以在这里阅读更多关于大 O 符号[的内容。](https://rob-bell.net/2009/06/a-beginners-guide-to-big-o-notation/)

![](img/44fffa963b7d1d32bb9e46d1ac350bd8.png)

照片由 [Shiro hatori](https://unsplash.com/@shiroscope?utm_source=medium&utm_medium=referral) 在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄

# 增加外部响应时间

我们已经讨论了如何优化用户界面的内部响应。那么，外部优化呢？

使用 Redis 之类的工具缓存客户端就绪数据现在很常见。然而，我们可以在内存中存储多少数据是有限制的，因为它不是最便宜的存储选项。

考虑到数据量，我们必须引入更智能的缓存方式，才能真正充分利用数据。

## **相邻缓存**

我们不仅缓存静态数据，还缓存与当前视图相似的数据。

例如，我们之前讨论过将数据分成 5 分钟的间隔。我们以很高的成功率预测，用户将希望在这些时间间隔内看到细化的数据。通过预先缓存这些数据，可以减少用于检索数据的 API 的响应时间。

## **自适应缓存**

用户通常会有一套一致的行为。他们通常会访问相同的页面或选择相同的过滤器。随着时间的推移，我们可以开始预测这些模式，并在登录时抢先缓存相关数据。这将有助于在缓存成本和保持高缓存命中率之间取得平衡。

自适应缓存可以被视为一种更智能的、尽管复杂的相邻缓存形式，因为它更准确，因为它是为用户量身定制的。

*这两种形式的缓存并不相互排斥，但是在一起使用时，可以确保不会出现数据重复。*

# 我们如何避免性能增强的倒退？

O 一旦你开发了你的应用程序，不要因为不符合以前的性能驱动标准的新功能而倒退，这一点很重要。

> 开发人员应该体验性能

这通常被视为事后的想法，对于数据吞吐量极小的应用程序来说可能没问题。然而，如果我们正在构建一个涉及大数据的系统，它必须在每个人的脑海中占据首要位置。

## 文档和入职培训

假设你的应用在市场上表现良好，扩大你的团队将成为优先事项。在这段时间里，遵守纪律并确保你以正确的方式成长是至关重要的。

> 记住——两倍的开发人员并不等于两倍的工作量

新工程师需要时间来熟悉这个系统。在没有结构化的入职流程的情况下，将它们推向深入可能会导致功能实现的增加，但也会损害产品的质量和性能。

## 自动化

自动化可以捕捉开发人员可能错过的任何东西。理想情况下，您希望开发人员在构建特性时考虑到性能。然而，作为最后一道防线，自动化可以成为救命稻草。

它可以涵盖任何内容，从使用诸如 [Pingdom](https://www.pingdom.com/) 之类的工具的页面加载时间，到使用定制的构建管道作业检查内存泄漏。

T 这些技术代表了对挑战的高级回应，我们需要克服这些挑战来开发一个界面，处理从构思到交付的大量数据。

还有许多其他伟大的战术。我强烈建议在确定路线图之前彻底研究和探索多种途径，尤其是在前端生态系统以如此高的速度不断发展的情况下。

> 每年都会有创新出现，改善我们在前端处理数据的方式

跟上他们的步伐是确保你开发的应用程序性能稳定的好方法，可以让你把注意力转移到提供优秀的功能上。