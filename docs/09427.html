<html>
<head>
<title>Chrono: the git time machine</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">超时空:git 时间机器</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/chrono-the-git-time-machine-c52e75b48f5c?source=collection_archive---------2-----------------------#2022-08-20">https://blog.devgenius.io/chrono-the-git-time-machine-c52e75b48f5c?source=collection_archive---------2-----------------------#2022-08-20</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/f2848af267aa3ac8f9e60d46d1a06b86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-6fdfdAFtzBeWHhdfGnMKw.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">秒表计时标志</figcaption></figure><p id="497e" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">如果你从事编程，你可能听说过/使用过 git，它是一个版本控制系统，人们常说</p><blockquote class="kx ky kz"><p id="5ea2" class="jz ka la kb b kc kd ke kf kg kh ki kj lb kl km kn lc kp kq kr ld kt ku kv kw ig bi translated">“Git 是一台时间机器”</p></blockquote><p id="1a32" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">因为如果您愿意，可以回滚到以前的版本。</p><p id="ee6b" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">这听起来很棒，但事实是这样的</p><h1 id="f3e9" class="le lf in bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">问题是</h1><p id="6afc" class="pw-post-body-paragraph jz ka in kb b kc mc ke kf kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw ig bi translated">想象你在做一个项目，有一个<code class="fe mh mi mj mk b">main</code>分公司，一个<code class="fe mh mi mj mk b">dev</code>分公司，你从<code class="fe mh mi mj mk b">dev</code>分支到你自己的<code class="fe mh mi mj mk b">feature</code>分公司在那里工作，然后和<code class="fe mh mi mj mk b">dev</code>合并，到目前为止还不错。</p><p id="cc8b" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">有一天，你正在开发一个特性或者修复一个 bug，这花费了你很长时间，让你很头疼，所以你继续工作，忘记了 git 的存在，然后你解决了这个 bug！不错！</p><ul class=""><li id="c2fe" class="ml mm in kb b kc kd kg kh kk mn ko mo ks mp kw mq mr ms mt bi translated">很好，它工作了！我很快就会承诺</li><li id="a6cd" class="ml mm in kb b kc mu kg mv kk mw ko mx ks my kw mq mr ms mt bi translated">*查看文件*</li><li id="40f1" class="ml mm in kb b kc mu kg mv kk mw ko mx ks my kw mq mr ms mt bi translated">这仍然是混乱的</li><li id="3cb1" class="ml mm in kb b kc mu kg mv kk mw ko mx ks my kw mq mr ms mt bi translated">我想我会先清理我的代码并重构</li><li id="dfe9" class="ml mm in kb b kc mu kg mv kk mw ko mx ks my kw mq mr ms mt bi translated">*触摸代码*</li><li id="0252" class="ml mm in kb b kc mu kg mv kk mw ko mx ks my kw mq mr ms mt bi translated">妈的，我把它弄坏了</li><li id="f4c8" class="ml mm in kb b kc mu kg mv kk mw ko mx ks my kw mq mr ms mt bi translated">我甚至不能回去，因为我没有承诺</li><li id="4caa" class="ml mm in kb b kc mu kg mv kk mw ko mx ks my kw mq mr ms mt bi translated">啊，是的，git 是一个时间机器</li></ul><p id="6ad7" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我专门创造了一个工具来解决这个问题，它叫做<strong class="kb io"> Chrono，</strong></p><p id="ec8f" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><a class="ae mz" href="https://github.com/hazyuun/Chrono" rel="noopener ugc nofollow" target="_blank">https://github.com/hazyuun/Chrono</a></p><p id="7e1c" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我会在文末再详细说！</p><h1 id="e243" class="le lf in bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">可能的解决方案</h1><h2 id="180d" class="na lf in bd lg nb nc dn lk nd ne dp lo kk nf ng ls ko nh ni lw ks nj nk ma nl bi translated">解决方案 0</h2><p id="8518" class="pw-post-body-paragraph jz ka in kb b kc mc ke kf kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw ig bi translated">等待物理学家发现回到过去的方法</p><h2 id="4b1c" class="na lf in bd lg nb nc dn lk nd ne dp lo kk nf ng ls ko nh ni lw ks nj nk ma nl bi translated">解决方案 1</h2><p id="1844" class="pw-post-body-paragraph jz ka in kb b kc mc ke kf kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw ig bi translated">在做某件事的时候继续提交，我的意思是无论如何提交，即使代码仍然很乱，你也可以在以后修改你的提交</p><p id="97f4" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">假设您像这样提交了 5 次</p><pre class="nm nn no np gt nq mk nr ns aw nt bi"><span id="3f0e" class="na lf in mk b gy nu nv l nw nx">$ git log --decorate --graph --branches --oneline<br/>* ??????? (HEAD -&gt; mybranch) Everything is alright<br/>* ??????? Fixed a bug<br/>* ??????? Changed that but code is still messy<br/>* ??????? Changed this but code is messy<br/>* ??????? Added feature</span></pre><p id="76a9" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">其中<code class="fe mh mi mj mk b">???????</code>是哈希</p><p id="baa2" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">现在你不想要所有的提交，里面一片混乱，所以你可能想把这 5 个提交“合并”成一个。</p><p id="f568" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">您可以通过使用 git rebase 来做到这一点，首先运行</p><pre class="nm nn no np gt nq mk nr ns aw nt bi"><span id="d52a" class="na lf in mk b gy nu nv l nw nx">$ git rebase -i HEAD~5</span></pre><p id="4640" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><code class="fe mh mi mj mk b">-i</code>表示交互(我们稍后会看到)</p><p id="fc7d" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><code class="fe mh mi mj mk b">HEAD~5</code>是您想要编辑的最后一个提交的父级，您也可以像<code class="fe mh mi mj mk b">HEAD~N</code>一样查看它，其中 N 是您想要编辑的提交的数量。</p><p id="5a1b" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">很好，现在一个编辑器将会打开，你提交的内容在最上面，还有一堆以<code class="fe mh mi mj mk b">#</code>开始的注释帮助你</p><pre class="nm nn no np gt nq mk nr ns aw nt bi"><span id="47a0" class="na lf in mk b gy nu nv l nw nx">pick ??????? Added feature<br/>pick ??????? Changed this but code is messy<br/>pick ??????? Changed that but code is still messy<br/>pick ??????? Fixed a bug<br/>pick ??????? Everything is alright</span></pre><p id="94e4" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">现在，您可以将这些<code class="fe mh mi mj mk b">pick</code>更改为<code class="fe mh mi mj mk b">squash</code>或者只是<code class="fe mh mi mj mk b">s</code>来压缩它们，对除第一个提交之外的每个提交都这样做，您只能将一个提交压缩到其父提交中。</p><p id="e053" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">现在它应该看起来像这样</p><pre class="nm nn no np gt nq mk nr ns aw nt bi"><span id="7171" class="na lf in mk b gy nu nv l nw nx">pick ??????? Added feature<br/>s ??????? Changed this but code is messy<br/>s ??????? Changed that but code is still messy<br/>s ??????? Fixed a bug<br/>s ??????? Everything is alright</span></pre><p id="6bd5" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">保存并退出编辑器，另一个编辑器会出现，告诉你制作一个提交消息，这样做，你就完成了！</p><p id="cf1f" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">但请注意，您仍然可以通过找到 HEAD 使用</strong> <code class="fe mh mi mj mk b"><strong class="kb io">git reflog</strong></code> <strong class="kb io">的位置并返回到该位置来撤销此操作，因此您的混乱可能仍然存在，有一种方法可以删除仅在</strong> <code class="fe mh mi mj mk b"><strong class="kb io">git reflog</strong></code> <strong class="kb io">中可见的内容，但那是另一天的事情</strong></p><h2 id="c946" class="na lf in bd lg nb nc dn lk nd ne dp lo kk nf ng ls ko nh ni lw ks nj nk ma nl bi translated">解决方案 2</h2><p id="a04d" class="pw-post-body-paragraph jz ka in kb b kc mc ke kf kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw ig bi translated">进入<a class="ae mz" href="https://github.com/hazyuun/Chrono" rel="noopener ugc nofollow" target="_blank"> <strong class="kb io">超时空</strong> </a> <strong class="kb io"> </strong>！</p><p id="a96e" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">Chrono 是我专门为此制作的工具，它会在每次事件发生时自动提交到 git 存储库中的临时分支中(事件是可定制的)，这样，如果出现任何问题，您都可以回滚到特定的时间点。当你完成后，你可以把所有的临时提交合并成一个。</p><p id="3c5f" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><a class="ae mz" href="https://github.com/hazyuun/Chrono" rel="noopener ugc nofollow" target="_blank">https://github.com/hazyuun/Chrono</a></p><p id="76d5" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">下面是它的使用方法:</p><p id="2066" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">第一步:创建一个 chrono 分支并签出它</strong></p><p id="a7e0" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">为了避免弄乱你的存储库，Chrono 只能推送到它自己的分支，所以从为 chrono 创建一个分支开始</p><pre class="nm nn no np gt nq mk nr ns aw nt bi"><span id="8296" class="na lf in mk b gy nu nv l nw nx">$ git branch chrono</span></pre><p id="eeee" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">git 结帐到它</p><pre class="nm nn no np gt nq mk nr ns aw nt bi"><span id="71f5" class="na lf in mk b gy nu nv l nw nx">$ git checkout chrono</span></pre><p id="a9ab" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">步骤 2:启动秒表计时功能</strong> <br/>启动秒表计时功能，使用</p><pre class="nm nn no np gt nq mk nr ns aw nt bi"><span id="471e" class="na lf in mk b gy nu nv l nw nx">$ chrono session start</span></pre><p id="5b0c" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">从现在开始，每当事件发生时，chrono 将自动提交更改，事件可使用<code class="fe mh mi mj mk b">chrono.yaml</code>文件定制(详情见下文)</p><p id="789b" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">第三步:挤压合并并删除超时空分支</strong> <br/>完成后，你可以将超时空分支合并(推荐挤压合并)到你原来的分支(姑且称之为 original_branch)</p><pre class="nm nn no np gt nq mk nr ns aw nt bi"><span id="9921" class="na lf in mk b gy nu nv l nw nx">$ git checkout original_branch<br/>$ git merge --squash chrono</span></pre><p id="472e" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">然后，如果一切如预期，您可以提交合并</p><pre class="nm nn no np gt nq mk nr ns aw nt bi"><span id="f4d8" class="na lf in mk b gy nu nv l nw nx">$ git commit -m "Your commit message"</span></pre><p id="71e7" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">并删除超时空分支</p><pre class="nm nn no np gt nq mk nr ns aw nt bi"><span id="ec23" class="na lf in mk b gy nu nv l nw nx">$ git branch -D chrono</span></pre><p id="d908" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">配置文件 <br/>把一个名为<code class="fe mh mi mj mk b">chrono.yml</code>的文件放在你的库的根目录下，这里是一个配置文件的例子</p><pre class="nm nn no np gt nq mk nr ns aw nt bi"><span id="a0c4" class="na lf in mk b gy nu nv l nw nx"># Events when to automatically commit<br/>events:<br/> - periodic:<br/>     period: 5<br/>     files: ["src/", "file.txt"]<br/><br/> - save:<br/>     files: ["notes.txt"]<br/> <br/># Use files: ["."] if you want all files to be commited</span></pre><ul class=""><li id="3fda" class="ml mm in kb b kc kd kg kh kk mn ko mo ks mp kw mq mr ms mt bi translated"><strong class="kb io">周期性</strong>每 N 秒触发一次</li><li id="375c" class="ml mm in kb b kc mu kg mv kk mw ko mx ks my kw mq mr ms mt bi translated"><strong class="kb io">保存</strong>触发每次文件保存</li></ul><p id="7774" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">如果您想在使用<code class="fe mh mi mj mk b">files: [“.”]</code>时排除一些文件，只需使用您的常规<code class="fe mh mi mj mk b">.gitignore</code>文件即可</p><p id="7847" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">仅此而已！</p><p id="8dc8" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">祝你白天/晚上愉快！</p><h1 id="1dd8" class="le lf in bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">链接</h1><ul class=""><li id="4734" class="ml mm in kb b kc mc kg md kk ny ko nz ks oa kw mq mr ms mt bi translated">超时空储存库:<a class="ae mz" href="https://github.com/hazyuun/Chrono" rel="noopener ugc nofollow" target="_blank">https://github.com/hazyuun/Chrono</a></li></ul></div></div>    
</body>
</html>