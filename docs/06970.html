<html>
<head>
<title>Predicting The Price of A Car Using Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习预测汽车价格</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/predicting-the-price-of-a-car-using-machine-learning-eefbf19fda26?source=collection_archive---------5-----------------------#2022-02-15">https://blog.devgenius.io/predicting-the-price-of-a-car-using-machine-learning-eefbf19fda26?source=collection_archive---------5-----------------------#2022-02-15</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/535deb9253a2f6903a38363a9a4f61f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PQqm2Zp_eB8_KwJ47KI5fA.png"/></div></div></figure><p id="07de" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">汽车是人们拥有的交通工具之一。有些人买车是为了日常使用。有些人买车是因为他们对过去有美好的回忆。有些人甚至买了一辆车来完成他的收藏。买车需要花很多心思，比如价格。"一辆汽车的合适价格是多少？"为了回答这个问题，我试图通过建立一个预测汽车价格的机器学习模型来提供帮助。在制造这个机器学习模型时，我使用了来自<a class="ae kt" href="https://www.kaggle.com/CooperUnion/cardataset" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>的数据集。</p></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h1 id="27bb" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">数据剖析</h1><p id="a40f" class="pw-post-body-paragraph jv jw in jx b jy lz ka kb kc ma ke kf kg mb ki kj kk mc km kn ko md kq kr ks ig bi translated">在建立机器学习模型之前，我会做数据剖析。什么是数据分析？</p><blockquote class="me mf mg"><p id="7a9e" class="jv jw mh jx b jy jz ka kb kc kd ke kf mi kh ki kj mj kl km kn mk kp kq kr ks ig bi translated">数据分析是使用描述性统计对数据进行汇总。创建数据概要旨在对数据有很强的理解，以编译框架分析和可视化数据。</p></blockquote><h2 id="28d5" class="ml lc in bd ld mm mn dn lh mo mp dp ll kg mq mr lp kk ms mt lt ko mu mv lx mw bi translated">导入数据</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="1847" class="ml lc in nc b gy ng nh l ni nj">#DATA PROFILING<br/>#Importing Data<br/>import pandas as pd<br/>pd.set_option('display.max_columns',None)<br/>df = pd.read_csv('Data Harga Mobil Sesuai Spesifikasi.csv')</span></pre><p id="fe72" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">第一步是初始化库，使用<strong class="jx io">熊猫</strong>将数据集导入 python，并将其指定为<strong class="jx io"> df </strong>。从 Kaggle 下载的数据将保存为<strong class="jx io">' Data Harga Mobil Sesuai spesifikasi . CSV '。</strong></p><h2 id="dc1f" class="ml lc in bd ld mm mn dn lh mo mp dp ll kg mq mr lp kk ms mt lt ko mu mv lx mw bi translated">显示数据的长度</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="64aa" class="ml lc in nc b gy ng nh l ni nj">#Showing The Length of The Data<br/>print("\nThe Length of The Data: ", len(df))</span></pre><p id="6ecc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">第二步是使用<strong class="jx io"> len() </strong>显示数据集中有多少数据。结果是这个数据的大小是 11914。</p><h2 id="bd94" class="ml lc in bd ld mm mn dn lh mo mp dp ll kg mq mr lp kk ms mt lt ko mu mv lx mw bi translated">显示数据的形状</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="f3f5" class="ml lc in nc b gy ng nh l ni nj">#Showing The Shape of The Data<br/>print("\nThe Shape of The Data: ", df.shape)</span></pre><p id="d5dd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">第三步是使用<strong class="jx io">显示数据的形状。形状</strong>。结果是该数据有 11914 行和 16 列。</p><h2 id="17b0" class="ml lc in bd ld mm mn dn lh mo mp dp ll kg mq mr lp kk ms mt lt ko mu mv lx mw bi translated">显示数据的信息</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="9b95" class="ml lc in nc b gy ng nh l ni nj">#Showing The Information of The Data<br/>print("\nThe Information of The Data: ")<br/>print(df.info())</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/acafb18040932146682a739b114ff886.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*AtoE1WPoqrHBd9tEQUpDgQ.png"/></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd ld">图一。</strong>数据的信息</figcaption></figure><p id="95d7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">第四步是使用<strong class="jx io">从数据中获取信息。info() </strong></p><h2 id="b466" class="ml lc in bd ld mm mn dn lh mo mp dp ll kg mq mr lp kk ms mt lt ko mu mv lx mw bi translated">显示统计计算</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="71ec" class="ml lc in nc b gy ng nh l ni nj">#Showing The Statistical Calculations<br/>print("\nThe The Statistical Calculations: ")<br/>print(df.describe().T)</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi np"><img src="../Images/6fc5511da10982ceeb6bd0ae141609fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*BwZxzZl3LMMp0tmtJLCOAg.png"/></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd ld">图二。</strong>统计计算的结果</figcaption></figure><p id="ed2c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">第五步是使用<strong class="jx io">显示数据的统计分析。</strong>形容()。</p><h2 id="f858" class="ml lc in bd ld mm mn dn lh mo mp dp ll kg mq mr lp kk ms mt lt ko mu mv lx mw bi translated">显示唯一的数据</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="d9d8" class="ml lc in nc b gy ng nh l ni nj">#Showing The Unique Data<br/>print("\nThe The Unique Data: ")<br/>print(df.nunique())</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/c6a86d437dda78d766a7933820f22440.png" data-original-src="https://miro.medium.com/v2/resize:fit:436/format:webp/1*xfKC3TnMKfLagXu7_Memxw.png"/></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd ld">图三。</strong>每列中具有唯一值的数据量</figcaption></figure><p id="1a47" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">数据分析的第六步是使用函数<strong class="jx io">显示每一列的唯一数据。努尼克()</strong>。</p><h2 id="c8a7" class="ml lc in bd ld mm mn dn lh mo mp dp ll kg mq mr lp kk ms mt lt ko mu mv lx mw bi translated">更改列名和列值</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="f1ac" class="ml lc in nc b gy ng nh l ni nj">#Changing The Column's Name And The Column's Value<br/>kolom_string = list(df.dtypes[df.dtypes == 'object'].index)<br/>for col in kolom_string:<br/>    df[col] = df[col].str.lower().str.replace(' ', '_')<br/><br/>df.rename(columns ={'MSRP': 'Price',<br/>                    'Make': 'Car Brand',<br/>                    'Engine HP': 'HP',<br/>                    'Driven_Wheels':'Driven Mode',<br/>                    'highway MPG':'KML-H',<br/>                    'city mpg':'KML-C'}, inplace=True)</span></pre><p id="21d6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如<strong class="jx io">图 1 </strong>所示，数据集上的列名不明确。例如，MSRP 列包含汽车的价格。因此，我将更改该列的名称。对于列的值，我将把它改为小写，并使用下划线。</p><h2 id="7bd1" class="ml lc in bd ld mm mn dn lh mo mp dp ll kg mq mr lp kk ms mt lt ko mu mv lx mw bi translated">寻找相关性</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="c659" class="ml lc in nc b gy ng nh l ni nj">#Looking For A Correlation<br/>import numpy as np<br/>import seaborn as sns<br/>import matplotlib.pyplot as plt<br/>plt.figure(figsize=(17, 15))<br/>corr_mask = np.triu(df.corr())<br/>h_map = sns.heatmap(df.corr(), mask=corr_mask, annot=True, cmap='Blues')<br/>plt.yticks(rotation=360)<br/>plt.show()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nr"><img src="../Images/232e67d8e26545d5511a19f714be8203.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zgg2a2fwxTIJ31pC3-GpLA.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd ld">图 4。</strong>热图关联</figcaption></figure><p id="a83b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">数据分析的最后一步是寻找每个数据的相关性。这部分我就用<strong class="jx io"> Seaborn </strong>、<strong class="jx io"> Matplotlib </strong>和<strong class="jx io"> Numpy </strong>。</p></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h1 id="e87a" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">数据清理</h1><p id="c9fa" class="pw-post-body-paragraph jv jw in jx b jy lz ka kb kc ma ke kf kg mb ki kj kk mc km kn ko md kq kr ks ig bi translated">在数据分析之后，我将进行数据清理。什么是数据清理？</p><blockquote class="me mf mg"><p id="67b6" class="jv jw mh jx b jy jz ka kb kc kd ke kf mi kh ki kj mj kl km kn mk kp kq kr ks ig bi translated">数据清理是指识别不正确、不完整、不准确、不相关或丢失的数据，然后根据需要对其进行修改、替换或删除的过程。</p></blockquote><p id="2d00" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在进行数据清理之前，我将创建一个名为<strong class="jx io">hapus _ 离群值</strong>的函数，接收参数<strong class="jx io">数据</strong>和<strong class="jx io"> x </strong>。该函数的目的是更容易去除异常值。我将解释什么是异常值？</p><blockquote class="me mf mg"><p id="d452" class="jv jw mh jx b jy jz ka kb kc kd ke kf mi kh ki kj mj kl km kn mk kp kq kr ks ig bi translated">异常值是在数据集或图形的整体值模式中显著突出的极值。</p></blockquote><p id="3897" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这里有一个去除异常值的函数。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="e3a6" class="ml lc in nc b gy ng nh l ni nj">#DATA CLEANSING<br/>#Create a function to remove the outliers<br/>def hapus_outliers(data, x):<br/>    Q1 = data[x].quantile(0.25)<br/>    Q3 = data[x].quantile(0.75)<br/>    IQR = Q3 - Q1<br/>    data = data[~((data[x] &lt; (Q1 - 1.5 * IQR)) | (data[x] &gt; (Q3 + 1.5 * IQR)))]<br/>    return data</span></pre><p id="0b99" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在数据清理中，需要做的步骤是处理每一列中的缺失值，移除每一列中的异常值，并擦除重复的数据。</p><h2 id="03c1" class="ml lc in bd ld mm mn dn lh mo mp dp ll kg mq mr lp kk ms mt lt ko mu mv lx mw bi translated">查找每一列中缺失的值</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="ef27" class="ml lc in nc b gy ng nh l ni nj">#Looking For The Missing Value in Each Column<br/>print("\nLooking For The Missing Value in Each Column: ")<br/>print(df.isnull().sum())</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/123cd4e6c96d9dd6f7b7258dc0488770.png" data-original-src="https://miro.medium.com/v2/resize:fit:424/format:webp/1*RH2S-J5XLKdybsMOy9MfZw.png"/></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd ld">图 5。</strong>各栏缺失值金额</figcaption></figure><p id="e5c4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我使用<strong class="jx io"> isnull() </strong>和<strong class="jx io"> sum() </strong>来找出缺失的值有多少。<strong class="jx io">发动机燃油类型</strong>有 3 个缺失值、<strong class="jx io"> 69 个</strong>缺失值、<strong class="jx io"> HP </strong>有 3 个<strong class="jx io"> 30 个</strong>缺失值、<strong class="jx io">发动机气缸</strong>有 4 个<strong class="jx io">缺失值、<strong class="jx io">门数</strong>有 6 个</strong>缺失值、<strong class="jx io">市场类别</strong>有<strong class="jx io"> 3742 </strong>缺失值。</p><h2 id="3432" class="ml lc in bd ld mm mn dn lh mo mp dp ll kg mq mr lp kk ms mt lt ko mu mv lx mw bi translated">删除不必要的列</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="78aa" class="ml lc in nc b gy ng nh l ni nj">#Removing Unnecessary Column<br/>df = df.drop(['Popularity','Number of Doors','KML-H','KML-C','Market Category'], axis=1)</span></pre><h2 id="6a67" class="ml lc in bd ld mm mn dn lh mo mp dp ll kg mq mr lp kk ms mt lt ko mu mv lx mw bi translated">检查价格栏</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="c779" class="ml lc in nc b gy ng nh l ni nj">#Checking The Price Column<br/>print("\nChecking The Price Column")<br/>sns.histplot(df['Price'])<br/>plt.show()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/ce7a23be2a7b258536c02f8d86e6f7b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*dIEpNH-fZ7vG9ftOkJKvtQ.png"/></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd ld">图 6。</strong>价格栏可视化</figcaption></figure><p id="8303" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">第一步是通过使用<strong class="jx io"> seaborn </strong>和<strong class="jx io"> matplotlib </strong>可视化数据来检查价格栏。如<strong class="jx io">图 6 </strong>所示，<strong class="jx io">价格</strong>栏有异常值。为了克服这些异常值，我将使用我之前创建的名为<strong class="jx io">的函数删除它们。</strong></p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="bf3a" class="ml lc in nc b gy ng nh l ni nj">df = hapus_outliers(df, 'Price')</span></pre><p id="086e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在移除价格列中的异常值后，我将在每一列中查找缺失的值。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="643c" class="ml lc in nc b gy ng nh l ni nj">print("\nThe Amount of Missing Value in Each Column After Removing The Outliers in The Price Column:")<br/>print(df.isnull().sum())</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nu"><img src="../Images/54bdc42878d8f37d190944980760420a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vEopzSlVSnn_-EN8TNc1Kw.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd ld">图 7。</strong>剔除价格栏异常值后各栏缺失值金额</figcaption></figure><p id="214d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在<strong class="jx io">图 7 </strong>中，剔除异常值后<strong class="jx io"> HP </strong>栏中的缺失值变为<strong class="jx io"> 56 </strong>。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="f357" class="ml lc in nc b gy ng nh l ni nj">print("\nThe Shape of The Data After Removing The Outliers: ", df.shape)</span></pre><p id="9428" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">剔除价格列中的异常值后，该数据有<strong class="jx io"> 10918 行</strong>和<strong class="jx io"> 11 列</strong>。</p><h2 id="cc4d" class="ml lc in bd ld mm mn dn lh mo mp dp ll kg mq mr lp kk ms mt lt ko mu mv lx mw bi translated">查看汽车品牌专栏</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="dbd7" class="ml lc in nc b gy ng nh l ni nj">#Checking The Car Brand Column<br/>print("\nChecking The Car Brand Column")<br/>sns.catplot(x='Car Brand', y='Price', data=df, height=5, aspect=2)<br/>plt.xticks(rotation=90)<br/>plt.show()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nv"><img src="../Images/945aa8720cb1ccfb419bc97f161891ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AL_9F31K8A2zPNroOce16A.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd ld">图 8。</strong>汽车品牌栏目可视化</figcaption></figure><h2 id="c97a" class="ml lc in bd ld mm mn dn lh mo mp dp ll kg mq mr lp kk ms mt lt ko mu mv lx mw bi translated">检查年度列</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="61b3" class="ml lc in nc b gy ng nh l ni nj">#Checking The Year Column<br/>print("\nChecking The Year Column")<br/>sns.catplot(x='Year', y='Price', data=df, height=5, aspect=2)<br/>plt.xticks(rotation=90)<br/>plt.show()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nv"><img src="../Images/3158d34bd45c1611747e94daf5ee0169.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vqPHQ9wiMtD8_eYU9IuQMw.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd ld">图 9。</strong>年度栏目可视化</figcaption></figure><h2 id="5bba" class="ml lc in bd ld mm mn dn lh mo mp dp ll kg mq mr lp kk ms mt lt ko mu mv lx mw bi translated">检查发动机燃料类型栏</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="8f8b" class="ml lc in nc b gy ng nh l ni nj">#Checking The Engine Fuel Type Column<br/>print("\nChecking The Engine Fuel Type Column")<br/>sns.catplot(x='Engine Fuel Type', y='Price', data=df, height=5, aspect=2)<br/>plt.xticks(rotation=90)<br/>plt.show()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nr"><img src="../Images/ab57a787d7c01ba3e314e85794b99546.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O1YzFDczMcBTUy-lqSxPig.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd ld">图 10。</strong>可视化发动机燃料类型栏</figcaption></figure><p id="e45a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">发动机燃料类型栏中缺少的值的数量是三个。在<strong class="jx io">图 10 </strong>中，在发动机燃料类型一栏中，有 10 种数据:<br/> -【高级 _ 无铅 _(必需)’<br/>-【普通 _ 无铅】-<br/>-【高级 _ 无铅 _(推荐)’<br/>-【灵活燃料 _(无铅/e85)’<br/>-【柴油】-<br/>-【电动】-<br/>-【灵活燃料 _(高级 _ 无铅 _ 推荐/e85)’<br/>-【天然气】-<br/>-【灵活燃料 _】</p><p id="9f6e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在我找到发动机类型燃料列中填充的是哪种数据之后，我将查看这一列中缺少的值。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="1395" class="ml lc in nc b gy ng nh l ni nj">print("\nThe Data on The Engine Fuel Type Column That Has A Missing Value:")<br/>print(df.loc[(df['Engine Fuel Type'].isnull())])</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/961adfd9a29f1997e0f5d0c84428595a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/1*U3i4X9EKZ2O9ihd-Zm_VqA.png"/></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd ld">图 11。</strong>发动机燃料类型栏中的数据缺少值</figcaption></figure><p id="b151" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在<strong class="jx io">图 11 </strong>中，价值缺失的汽车是铃木维罗纳。铃木维罗纳使用普通无铅汽油。所以我要把这个丢失的值变成一个<strong class="jx io">‘regular _ 无铅’</strong>。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="729c" class="ml lc in nc b gy ng nh l ni nj">df['Engine Fuel Type'] = df['Engine Fuel Type'].fillna('regular_unleaded')</span></pre><p id="02d2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在用<strong class="jx io">‘普通 _ 无铅’</strong>替换了丢失的值之后，我将在每一列中查找丢失的值。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="3b42" class="ml lc in nc b gy ng nh l ni nj">print("\nThe Amount of Missing Value in Each Column After Handling Missing Value in The Engine Fuel Type Column: ")<br/>print(df.isnull().sum())</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nx"><img src="../Images/dc307de05900a4206a78f6dc8775d59a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bBVH7MKClr3KFn1DWxUfxw.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd ld">图 12。</strong>处理发动机燃料类型栏中的缺失值后，每栏中缺失值的数量</figcaption></figure><p id="0ef2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在<strong class="jx io">图 12 </strong>中，对缺失值进行处理后，<strong class="jx io">发动机燃料类型</strong>栏中的缺失值变为<strong class="jx io"> 0 </strong>。</p><h2 id="935e" class="ml lc in bd ld mm mn dn lh mo mp dp ll kg mq mr lp kk ms mt lt ko mu mv lx mw bi translated">检查发动机气缸列</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="4806" class="ml lc in nc b gy ng nh l ni nj">#Checking The Engine Cylinders Column<br/>print("\nChecking The Engine Cylinders Column")<br/>sns.catplot(x='Engine Cylinders', y='Price', data=df, height=5, aspect=2)<br/>plt.show()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nv"><img src="../Images/b41accb2366e63195db21ef435ac614d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sOm9l0EozJu2DWirEyb47g.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd ld">图十三。</strong>发动机气缸列的可视化</figcaption></figure><p id="8f9d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在我发现发动机气缸列中填充的是哪种数据之后，我将查看这一列中缺少的值。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="9641" class="ml lc in nc b gy ng nh l ni nj">print("\nThe Data on The Engine Cylinders Column That Has A Missing Value:")<br/>print(df.loc[(df['Engine Cylinders'].isnull())])</span></pre><p id="610d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">从上面的代码来看，价值缺失的车分别是<strong class="jx io">雪佛兰 Bolt EV </strong>、<strong class="jx io">大众 E-Golf </strong>、<strong class="jx io">丰田 Rav4 EV </strong>、<strong class="jx io">马自达 RX-7 </strong>、<strong class="jx io">马自达 RX-8 </strong>。<strong class="jx io">雪佛兰 Bolt EV，大众 E-Golf，丰田 Rav4 EV </strong>都是电动车，所以它没有汽缸。<strong class="jx io">马自达 RX-7 </strong>和<strong class="jx io">马自达 RX-8 </strong>不使用发动机气缸而是使用转子发动机。所以我要把这个丢失的值变成<strong class="jx io"> 0 </strong>。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="45c7" class="ml lc in nc b gy ng nh l ni nj">df['Engine Cylinders'] = df['Engine Cylinders'].fillna(0)</span></pre><p id="8730" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在用<strong class="jx io"> 0 </strong>替换丢失的值后，我将在每一列中查找丢失的值。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="a720" class="ml lc in nc b gy ng nh l ni nj">print("\nThe Amount of Missing Value in Each Column After Handling Missing Value in The Engine Cylinders Column:")<br/>print(df.isnull().sum())</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ny"><img src="../Images/7dd17782e9fa3dfc1b47bca83c59dfab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xAy5o7evjJVI-wsiUdPxig.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd ld">图 14。</strong>处理发动机气缸列中的缺失值后，每列中缺失值的数量</figcaption></figure><p id="b182" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在<strong class="jx io">图 14 </strong>中，处理缺失值后<strong class="jx io">发动机气缸</strong>栏中的缺失值变为<strong class="jx io"> 0 </strong>。</p><h2 id="494d" class="ml lc in bd ld mm mn dn lh mo mp dp ll kg mq mr lp kk ms mt lt ko mu mv lx mw bi translated">检查高压柱</h2><p id="b769" class="pw-post-body-paragraph jv jw in jx b jy lz ka kb kc ma ke kf kg mb ki kj kk mc km kn ko md kq kr ks ig bi translated">HP 列中有 56 个缺失值；我会调查丢失的价值。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="9a32" class="ml lc in nc b gy ng nh l ni nj">#Checking the HP Column<br/>print("\nChecking the HP Column")<br/>print(df.loc[(df['HP'].isnull())])</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/e0ee376d0d0418d9c8d291cbb46d243d.png" data-original-src="https://miro.medium.com/v2/resize:fit:394/format:webp/1*DDdX_ldgdKUz5UQSQrfkvw.png"/></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd ld">表 1。</strong>HP 列上有缺失值的数据</figcaption></figure><p id="cc81" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">已经在<strong class="jx io">表 1 </strong>中提到的汽车有一个马力(HP) 如下:<br/> - <a class="ae kt" href="https://www.edmunds.com/fiat/500e/2015/features-specs/" rel="noopener ugc nofollow" target="_blank">菲亚特 500e </a>的马力是 111 <br/> - <a class="ae kt" href="https://www.edmunds.com/lincoln/continental/2017/features-specs/" rel="noopener ugc nofollow" target="_blank">林肯欧陆</a>的马力是 305 <br/> - <a class="ae kt" href="https://www.edmunds.com/lincoln/mkz/2017/features-specs/" rel="noopener ugc nofollow" target="_blank">林肯 MKZ </a>的马力是 245 <br/> - <a class="ae kt" href="https://www.edmunds.com/ford/escape/2017/suv/features-specs/" rel="noopener ugc nofollow" target="_blank">福特逸动</a>的马力是 179 <br/> - <a class="ae kt" href="https://www.auto123.com/en/new-cars/technical-specs/ford/freestar/2005/base/se/" rel="noopener ugc nofollow" target="_blank">福特自由之星</a>的马力是 201 <br/> - <a class="ae kt" href="https://www.edmunds.com/ford/focus/2015/features-specs/" rel="noopener ugc nofollow" target="_blank">福特福克斯</a> 150 <br/> - <a class="ae kt" href="https://www.oto.com/en/mobil-baru/tesla/model-s/performance" rel="noopener ugc nofollow" target="_blank">特斯拉 Model S </a>的马力是 1020 <br/> - <a class="ae kt" href="https://www.kiamedia.com/us/en/models/soul-ev/2018/specifications" rel="noopener ugc nofollow" target="_blank">起亚 Soul EV </a>的马力是 109 <br/> - <a class="ae kt" href="https://evcompare.io/cars/toyota/toyota_rav4_ev_2012-2014/" rel="noopener ugc nofollow" target="_blank">丰田 Rav4 EV </a>的马力是 154 <br/> - <a class="ae kt" href="https://www.caranddriver.com/honda/fit-ev/specs" rel="noopener ugc nofollow" target="_blank">本田飞度 EV </a>的马力是 123 <br/> - <a class="ae kt" href="https://www.caranddriver.com/mitsubishi/i-miev/specs" rel="noopener ugc nofollow" target="_blank">三菱 I-Miev </a>的马力是 66<br/>-</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="5383" class="ml lc in nc b gy ng nh l ni nj">df.loc[(df['Car Brand'] == 'fiat') &amp; (df['Model'] == '500e')] = df.loc[(df['Car Brand'] == 'fiat') &amp; (df['Model'] == '500e')].fillna(111)<br/>df.loc[(df['Car Brand'] == 'lincoln') &amp; (df['Model'] == 'continental')] = df.loc[(df['Car Brand'] == 'lincoln') &amp; (df['Model'] == 'continental')].fillna(305)<br/>df.loc[(df['Car Brand'] == 'lincoln') &amp; (df['Model'] == 'mkz')] = df.loc[(df['Car Brand'] == 'lincoln') &amp; (df['Model'] == 'mkz')].fillna(245)<br/>df.loc[(df['Car Brand'] == 'ford') &amp; (df['Model'] == 'escape')] = df.loc[(df['Car Brand'] == 'ford') &amp; (df['Model'] == 'escape')].fillna(179)<br/>df.loc[(df['Car Brand'] == 'ford') &amp; (df['Model'] == 'freestar')] = df.loc[(df['Car Brand'] == 'ford') &amp; (df['Model'] == 'freestar')].fillna(201)<br/>df.loc[(df['Car Brand'] == 'ford') &amp; (df['Model'] == 'focus')] = df.loc[(df['Car Brand'] == 'ford') &amp; (df['Model'] == 'focus')].fillna(160)<br/>df.loc[(df['Car Brand'] == 'chevrolet') &amp; (df['Model'] == 'impala')] = df.loc[(df['Car Brand'] == 'chevrolet') &amp; (df['Model'] == 'impala')].fillna(305)<br/>df.loc[(df['Car Brand'] == 'nissan') &amp; (df['Model'] == 'leaf')] = df.loc[(df['Car Brand'] == 'nissan') &amp; (df['Model'] == 'leaf')].fillna(150)<br/>df.loc[(df['Car Brand'] == 'tesla') &amp; (df['Model'] == 'model_s')] = df.loc[(df['Car Brand'] == 'tesla') &amp; (df['Model'] == 'model_s')].fillna(1020)<br/>df.loc[(df['Car Brand'] == 'kia') &amp; (df['Model'] == 'soul_ev')] = df.loc[(df['Car Brand'] == 'kia') &amp; (df['Model'] == 'soul_ev')].fillna(109)<br/>df.loc[(df['Car Brand'] == 'toyota') &amp; (df['Model'] == 'rav4_ev')] = df.loc[(df['Car Brand'] == 'toyota') &amp; (df['Model'] == 'rav4_ev')].fillna(154)<br/>df.loc[(df['Car Brand'] == 'honda') &amp; (df['Model'] == 'fit_ev')] = df.loc[(df['Car Brand'] == 'honda') &amp; (df['Model'] == 'fit_ev')].fillna(123)<br/>df.loc[(df['Car Brand'] == 'mitsubishi') &amp; (df['Model'] == 'i-miev')] = df.loc[(df['Car Brand'] == 'mitsubishi') &amp; (df['Model'] == 'i-miev')].fillna(66)<br/>df.loc[(df['Car Brand'] == 'mercedes-benz') &amp; (df['Model'] == 'm-class')] = df.loc[(df['Car Brand'] == 'mercedes-benz') &amp; (df['Model'] == 'm-class')].fillna(200)</span></pre><p id="d9ab" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">替换丢失的值后，我将在每一列中查找丢失的值。</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="4662" class="ml lc in nc b gy ng nh l ni nj">print("\nThe Amount of Missing Value in Each Column After Handling Missing Value in The HP Column:")<br/>print(df.isnull().sum())</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi gj"><img src="../Images/9f0f0a1b3126cd0bc2d3ddffe536d69e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1GPbyQnHxsYd9qL-zrGFHg.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd ld">图 15。</strong>处理 HP 列中缺失值后每列中缺失值的数量</figcaption></figure><p id="4747" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在<strong class="jx io">图 15 </strong>中，对缺失值进行处理后，<strong class="jx io">惠普</strong>栏中的缺失值变为<strong class="jx io"> 0 </strong>。</p><h2 id="ba15" class="ml lc in bd ld mm mn dn lh mo mp dp ll kg mq mr lp kk ms mt lt ko mu mv lx mw bi translated">删除重复数据</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="b398" class="ml lc in nc b gy ng nh l ni nj">#Removing Duplicated Data<br/>print("\nRemoving Duplicated Data")<br/>df.drop_duplicates(inplace=True)<br/>print('\nThe Shape of The Data After Removing The Duplicated Data: ', df.shape)</span></pre><p id="b072" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在本节中，我将删除重复的数据。删除重复数据后，该数据有<strong class="jx io"> 10189 行</strong>和<strong class="jx io"> 11 列</strong>。</p></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h1 id="54be" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">数据集上的标签转换</h1><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="057e" class="ml lc in nc b gy ng nh l ni nj">print("\nLabel Encoding on The Dataset")<br/>car_brand = pd.get_dummies(df['Car Brand'], drop_first=True)<br/>model = pd.get_dummies(df['Model'], drop_first=True)<br/>engine_fuel_type = pd.get_dummies(df['Engine Fuel Type'], drop_first=True)<br/>transmission_type = pd.get_dummies(df['Transmission Type'], drop_first=True)<br/>driven_mode = pd.get_dummies(df['Driven Mode'], drop_first=True)<br/>vehicle_size = pd.get_dummies(df['Vehicle Size'], drop_first=True)<br/>vehicle_style = pd.get_dummies(df['Vehicle Style'], drop_first=True)</span><span id="b461" class="ml lc in nc b gy oa nh l ni nj">df = df.drop(['Car Brand',<br/>              'Model',<br/>              'Engine Fuel Type',<br/>              'Transmission Type',<br/>              'Driven Mode',<br/>              'Vehicle Size',<br/>              'Vehicle Style'], axis=1)</span><span id="5100" class="ml lc in nc b gy oa nh l ni nj">df = pd.concat([car_brand,<br/>                model,<br/>                engine_fuel_type,<br/>                transmission_type,<br/>                driven_mode,<br/>                vehicle_size,<br/>                vehicle_style,<br/>                df], axis=1)</span></pre></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h1 id="ef22" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">分离要素和标签</h1><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="5a4c" class="ml lc in nc b gy ng nh l ni nj">#Separating Features and Labels<br/>X = df.drop('Price', axis=1)<br/>y = df['Price'].astype(int)</span></pre><p id="aaa3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">特征是描述性的属性，而标签是您试图预测或预测的内容。所以我会做两个变量；第一个变量是只有特征的 X 和只有标签的 y。</p></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h1 id="d608" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">准备培训、测试和验证数据集</h1><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="18a9" class="ml lc in nc b gy ng nh l ni nj">#Preparing Training, Testing, And Validating Dataset<br/>from sklearn.model_selection import train_test_split<br/>X_train_full, X_test, y_train_full, y_test = train_test_split(X, y, test_size=0.2, random_state=42)<br/>X_train, X_val, y_train, y_val = train_test_split(X_train_full, y_train_full, test_size=0.2, random_state=42)</span></pre></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h1 id="9b85" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">构建机器学习模型</h1><p id="2cf7" class="pw-post-body-paragraph jv jw in jx b jy lz ka kb kc ma ke kf kg mb ki kj kk mc km kn ko md kq kr ks ig bi translated">下一步是建立一个机器学习模型。在这一部分，我将进行 A/B 测试。什么是 A/B 测试？</p><blockquote class="me mf mg"><p id="89e1" class="jv jw mh jx b jy jz ka kb kc kd ke kf mi kh ki kj mj kl km kn mk kp kq kr ks ig bi translated">根据《哈佛商业评论》<a class="ae kt" href="https://hbr.org/2017/06/a-refresher-on-ab-testing" rel="noopener ugc nofollow" target="_blank"/>，A/B 测试是一种比较两个版本的东西以找出哪个更好的方法。</p></blockquote><p id="1f50" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我将比较<strong class="jx io">线性回归</strong>、<strong class="jx io">决策回归器</strong>、<strong class="jx io">随机森林回归器</strong>、<strong class="jx io">套索</strong>和<strong class="jx io">岭</strong>。</p><h2 id="6322" class="ml lc in bd ld mm mn dn lh mo mp dp ll kg mq mr lp kk ms mt lt ko mu mv lx mw bi translated">线性回归</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="b090" class="ml lc in nc b gy ng nh l ni nj">#Build a Machine Learning Model LinearRegression<br/>from sklearn.linear_model import LinearRegression<br/>model_linreg = LinearRegression()<br/>model_linreg = model_linreg.fit(X_train, y_train)<br/>y_pred_linreg = model_linreg.predict(X_test)<br/><br/>#Evaluating The Machine Learning Model<br/>from sklearn.metrics import mean_squared_error, mean_absolute_error<br/>import numpy as np<br/><br/>#Mean Squared Error<br/>mse = mean_squared_error(y_test, y_pred_linreg)<br/>print('\nMean squared error dari Testing Set:', round(mse))<br/><br/>#Mean Absolute Error<br/>mae = mean_absolute_error(y_test, y_pred_linreg)<br/>print('Mean absolute error dari Testing Set:', round(mae))<br/><br/>#Root Mean Squared Error<br/>rmse = np.sqrt(mse)<br/>print('Root Mean Squared Error dari Testing Set:', round(rmse))</span></pre><h2 id="d7ad" class="ml lc in bd ld mm mn dn lh mo mp dp ll kg mq mr lp kk ms mt lt ko mu mv lx mw bi translated">决策树</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="358b" class="ml lc in nc b gy ng nh l ni nj">#Build a Machine Learning Model DecisionTree<br/>from sklearn.tree import DecisionTreeRegressor<br/>model_dtr = DecisionTreeRegressor(random_state=42)<br/>model_dtr = model_dtr.fit(X_train, y_train)<br/>y_pred_dtr = model_dtr.predict(X_test)<br/><br/>#Evaluating The Machine Learning Model<br/>from sklearn.metrics import mean_squared_error, mean_absolute_error<br/>import numpy as np<br/><br/>#Mean Squared Error<br/>mse = mean_squared_error(y_test, y_pred_dtr)<br/>print('\nMean squared error dari Testing Set:', round(mse))<br/><br/>#Mean Absolute Error<br/>mae = mean_absolute_error(y_test, y_pred_dtr)<br/>print('Mean absolute error dari Testing Set:', round(mae))<br/><br/>#Root Mean Squared Error<br/>rmse = np.sqrt(mse)<br/>print('Root Mean Squared Error dari Testing Set:', round(rmse))</span></pre><h2 id="285f" class="ml lc in bd ld mm mn dn lh mo mp dp ll kg mq mr lp kk ms mt lt ko mu mv lx mw bi translated">随机森林</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="ad8e" class="ml lc in nc b gy ng nh l ni nj">#Build a Machine Learning Model RandomForest<br/>from sklearn.ensemble import RandomForestRegressor<br/>model_rfr = RandomForestRegressor(random_state=42)<br/>model_rfr = model_rfr.fit(X_train, y_train)<br/>y_pred_rfr = model_rfr.predict(X_test)<br/><br/>#Evaluating The Machine Learning Model<br/>from sklearn.metrics import mean_squared_error, mean_absolute_error<br/>import numpy as np<br/><br/>#Mean Squared Error<br/>mse = mean_squared_error(y_test, y_pred_rfr)<br/>print('\nMean squared error dari Testing Set:', round(mse))<br/><br/>#Mean Absolute Error<br/>mae = mean_absolute_error(y_test, y_pred_rfr)<br/>print('Mean absolute error dari Testing Set:', round(mae))<br/><br/>#Root Mean Squared Error<br/>rmse = np.sqrt(mse)<br/>print('Root Mean Squared Error dari Testing Set:', round(rmse))</span></pre><h2 id="0dae" class="ml lc in bd ld mm mn dn lh mo mp dp ll kg mq mr lp kk ms mt lt ko mu mv lx mw bi translated">套索</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="0231" class="ml lc in nc b gy ng nh l ni nj">#Build a Machine Learning Model Lasso<br/>from sklearn.linear_model import Lasso<br/>model_lasso = Lasso(random_state=42)<br/>model_lasso = model_lasso.fit(X_train, y_train)<br/>y_pred_lasso = model_lasso.predict(X_test)<br/><br/>#Evaluating The Machine Learning Model<br/>from sklearn.metrics import mean_squared_error, mean_absolute_error<br/>import numpy as np<br/><br/>#Mean Squared Error<br/>mse = mean_squared_error(y_test, y_pred_lasso)<br/>print('\nMean squared error dari Testing Set:', round(mse))<br/><br/>#Mean Absolute Error<br/>mae = mean_absolute_error(y_test, y_pred_lasso)<br/>print('Mean absolute error dari Testing Set:', round(mae))<br/><br/>#Root Mean Squared Error<br/>rmse = np.sqrt(mse)<br/>print('Root Mean Squared Error dari Testing Set:', round(rmse))</span></pre><h2 id="57fa" class="ml lc in bd ld mm mn dn lh mo mp dp ll kg mq mr lp kk ms mt lt ko mu mv lx mw bi translated">山脉</h2><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="9a72" class="ml lc in nc b gy ng nh l ni nj">#Build a Machine Learning Model Ridge<br/>from sklearn.linear_model import Ridge<br/>model_ridge = Ridge(random_state=42)<br/>model_ridge = model_ridge.fit(X_train, y_train)<br/>y_pred_ridge = model_ridge.predict(X_test)<br/><br/>#Evaluating The Machine Learning Model<br/>from sklearn.metrics import mean_squared_error, mean_absolute_error<br/>import numpy as np<br/><br/>#Mean Squared Error<br/>mse = mean_squared_error(y_test, y_pred_ridge)<br/>print('\nMean squared error dari Testing Set:', round(mse))<br/><br/>#Mean Absolute Error<br/>mae = mean_absolute_error(y_test, y_pred_ridge)<br/>print('Mean absolute error dari Testing Set:', round(mae))<br/><br/>#Root Mean Squared Error<br/>rmse = np.sqrt(mse)<br/>print('Root Mean Squared Error dari Testing Set:', round(rmse))</span></pre></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h1 id="2c15" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">机器学习模型的评价</h1><p id="1db5" class="pw-post-body-paragraph jv jw in jx b jy lz ka kb kc ma ke kf kg mb ki kj kk mc km kn ko md kq kr ks ig bi translated">构建机器学习模型后的下一个阶段是评估该模型。在这个评估过程中，我会查看<strong class="jx io">均方误差</strong>、<strong class="jx io">平均绝对误差</strong>、<strong class="jx io">均方根误差</strong>值。我会用<strong class="jx io">最小 RMSE 值</strong>来决定哪个更好。</p><h2 id="70a7" class="ml lc in bd ld mm mn dn lh mo mp dp ll kg mq mr lp kk ms mt lt ko mu mv lx mw bi translated">线性回归</h2><p id="4ced" class="pw-post-body-paragraph jv jw in jx b jy lz ka kb kc ma ke kf kg mb ki kj kk mc km kn ko md kq kr ks ig bi translated">采用线性回归的结果为<strong class="jx io"> 12227717 MSE，2495 MAE，3497 RMSE。</strong></p><h2 id="7def" class="ml lc in bd ld mm mn dn lh mo mp dp ll kg mq mr lp kk ms mt lt ko mu mv lx mw bi translated">决策树回归器</h2><p id="6194" class="pw-post-body-paragraph jv jw in jx b jy lz ka kb kc ma ke kf kg mb ki kj kk mc km kn ko md kq kr ks ig bi translated">使用决策树回归器的结果为<strong class="jx io"> 16094808 MSE、2667 MAE 和 4012 RMSE。</strong></p><h2 id="4b68" class="ml lc in bd ld mm mn dn lh mo mp dp ll kg mq mr lp kk ms mt lt ko mu mv lx mw bi translated">随机森林回归器</h2><p id="b975" class="pw-post-body-paragraph jv jw in jx b jy lz ka kb kc ma ke kf kg mb ki kj kk mc km kn ko md kq kr ks ig bi translated">使用随机森林回归器的结果是<strong class="jx io"> 12398483 MSE、2380 MAE 和 3521 RMSE。</strong></p><h2 id="24cc" class="ml lc in bd ld mm mn dn lh mo mp dp ll kg mq mr lp kk ms mt lt ko mu mv lx mw bi translated">套索</h2><p id="1efc" class="pw-post-body-paragraph jv jw in jx b jy lz ka kb kc ma ke kf kg mb ki kj kk mc km kn ko md kq kr ks ig bi translated">使用套索的结果是<strong class="jx io"> 13948854 MSE、2789 MAE 和 3735 RMSE。</strong></p><h2 id="5591" class="ml lc in bd ld mm mn dn lh mo mp dp ll kg mq mr lp kk ms mt lt ko mu mv lx mw bi translated">山脉</h2><p id="6c70" class="pw-post-body-paragraph jv jw in jx b jy lz ka kb kc ma ke kf kg mb ki kj kk mc km kn ko md kq kr ks ig bi translated">使用 Ridge 的结果是<strong class="jx io"> 13800444 MSE、2763 MAE 和 3715 RMSE。</strong></p><p id="0bd1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">从这个评估中，我得出结论:使用线性回归的机器学习模型具有最小的 RMSE。</p></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h1 id="7680" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">机器学习模型的可视化</h1><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="c2b1" class="ml lc in nc b gy ng nh l ni nj">#Visualize The Machine Learning Model<br/>fig = plt.figure(figsize=(17, 10))<br/>df = df.sort_values(by=['Price'])<br/>plt.scatter(range(X.shape[0]), y, color='red', label='Real')<br/>plt.scatter(range(X.shape[0]), model.predict(X), marker='.', label='Predict')<br/>plt.legend(loc='best', prop={'size': 8})<br/>plt.show()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nr"><img src="../Images/40522928f2f807e8411ba077e2759eb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JDguxMOOGOupaEuOlVYogw.png"/></div></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated"><strong class="bd ld">图 16。</strong>机器学习模型线性回归的可视化</figcaption></figure></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h1 id="e517" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">机器学习模型的验证</h1><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="6cb1" class="ml lc in nc b gy ng nh l ni nj">#Validating The Machine Learning Model<br/>for i in range(5):<br/>    real = y_val.iloc[i]<br/>    pred = int(model_linreg.predict(X_val.iloc[i].to_frame().T)[0])<br/>    print(f'Real Value      -----&gt;&gt;&gt;&gt;&gt; {real} $\n'<br/>          f'Predicted Value -----&gt;&gt;&gt;&gt;&gt; {pred} $')<br/>    print()</span></pre><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/6fe49f0543a873c671915ba2badfb1cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*zN6rXgV3DBrvOX-N5NkG5Q.png"/></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated">表 2。线性回归机器学习模型的验证</figcaption></figure></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><figure class="mx my mz na gt jo"><div class="bz fp l di"><div class="oc od l"/></div></figure></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><p id="146a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这就是我给你的；如果你对这个项目有意见、建议或疑问，你可以联系我。谢谢，非常感谢你花时间阅读这篇文章。</p></div></div>    
</body>
</html>