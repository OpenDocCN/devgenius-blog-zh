<html>
<head>
<title>Solving Common Vue Problems — Child to Parent Communication, and Computed Properties vs Methods</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">解决常见的Vue问题——子到父的通信，计算属性与方法</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/solving-common-vue-problems-child-to-parent-communication-and-computed-properties-vs-methods-d16fd840f6c3?source=collection_archive---------10-----------------------#2020-06-26">https://blog.devgenius.io/solving-common-vue-problems-child-to-parent-communication-and-computed-properties-vs-methods-d16fd840f6c3?source=collection_archive---------10-----------------------#2020-06-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/096ba47ffeb055a9ed688ed633ba1003.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pvUoHguQIAjo2tDl"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">由<a class="ae kc" href="https://unsplash.com/@tararaye?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Tara Raye </a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="d4c3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vue.js让开发前端应用变得简单。然而，我们仍有可能遇到问题。</p><p id="0df2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇文章中，我们将看看一些常见的问题，并看看如何解决它们。</p><h1 id="85e7" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">强制Vue重新加载</h1><p id="5aaf" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用<code class="fe me mf mg mh b">this.$forceUpdate();</code>来强制重载一个Vue组件。</p><p id="9043" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，这并不是解决大多数问题的好办法。</p><p id="5a42" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们组件上的数据应该用其他方法更新。</p><h1 id="dbbb" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">方法与计算属性</h1><p id="721c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">方法的计算属性是不同的，尽管它们都是函数。</p><p id="bbf5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">计算属性是返回从其他值派生的值的函数。</p><p id="6f07" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，如果我们有一个字符串形式的<code class="fe me mf mg mh b">message</code>状态，我们可以在一个计算属性中返回一个被尊崇的版本:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="9fb5" class="mq lc iq mh b gy mr ms l mt mu">computed: {<br/>  reversedMessage() {<br/>    return this.message.split('').reverse().join('')<br/>  }<br/>}</span></pre><p id="99d4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后它可以作为<code class="fe me mf mg mh b">this.reveresedMessage</code>在组件中被访问。</p><p id="b2a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在模板中，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="7fca" class="mq lc iq mh b gy mr ms l mt mu">{{ reversedMessage }}</span></pre><p id="0cd1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">去访问它。</p><p id="b01c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它只是一个getter函数，所以我们不能直接给它设置一个新值。</p><p id="7bef" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">方法是可以在模板中组件或访问方法的其他部分调用的函数。</p><p id="f9d5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以通过编写以下内容来编写方法:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="eaf1" class="mq lc iq mh b gy mr ms l mt mu">methods:{<br/>  search(keyword){<br/>    return this.names.filter(n =&gt; n.includes(keyword))<br/>  }<br/>}</span></pre><p id="17df" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们可以通过编写以下代码在组件中调用它:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="1e5d" class="mq lc iq mh b gy mr ms l mt mu">this.search('foo');</span></pre><p id="850d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">或者我们可以在模板中这样调用它:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="ac66" class="mq lc iq mh b gy mr ms l mt mu">search('foo')</span></pre><h1 id="8ad6" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在父事件上调用子组件中的函数</h1><p id="2f3e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以在子组件上调用一个函数，方法是在子组件上分配一个ref，然后在其中调用一个函数。</p><p id="0dcc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，如果我们的子组件如下:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="f9d4" class="mq lc iq mh b gy mr ms l mt mu">const ChildComponent = {<br/>  template: '&lt;div&gt;{{value}}&lt;/div&gt;',<br/>  data: function () {<br/>    return {<br/>      value: 0<br/>    };<br/>  },<br/>  methods: {<br/>    setValue(value) {<br/>      this.value = value;<br/>    }<br/>  }<br/>}</span></pre><p id="3bd7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以从父节点调用它:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="7f4c" class="mq lc iq mh b gy mr ms l mt mu">new Vue({<br/>  el: '#app',<br/>  components: {<br/>    'child-component': ChildComponent<br/>  },<br/>  methods: {<br/>    click() {<br/>      this.$refs.childComponent.setValue(5);<br/>    }<br/>  }<br/>})</span></pre><p id="093f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">鉴于我们有:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="c9b4" class="mq lc iq mh b gy mr ms l mt mu">&lt;div id="app"&gt;<br/>  &lt;child-component ref="childComponent"&gt;&lt;/child-component&gt;<br/>  &lt;button @click="click"&gt;Click&lt;/button&gt;  <br/>&lt;/div&gt;</span></pre><p id="8e7c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们把<code class="fe me mf mg mh b">childComponent</code>裁判指派给了<code class="fe me mf mg mh b">child-component</code>。</p><p id="193a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后可以像我们在<code class="fe me mf mg mh b">setValue</code>中做的那样通过ref访问子方法。</p><h1 id="37be" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">部署Vue应用程序</h1><p id="e54c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用<code class="fe me mf mg mh b">npm run build</code>命令部署一个Vue应用程序。</p><p id="12eb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这将构建应用程序。</p><h1 id="6e6d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">[Vue warn]:属性或方法未在实例上定义，但在呈现过程中被引用'错误</h1><p id="9121" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">发生此错误是因为状态或方法不在组件代码中，但在模板中定义了它。</p><p id="4166" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们在模板中引用一个方法，那么我们必须在<code class="fe me mf mg mh b">methods</code>部分中有它。</p><p id="6a39" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，如果我们有:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="215c" class="mq lc iq mh b gy mr ms l mt mu">const app = new Vue({<br/>  el: "#settings",<br/>  data,<br/>  methods: {<br/>    setValue(index) {<br/>      //...<br/>    }<br/>  }<br/>});</span></pre><p id="d044" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以在模板中引用它:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="46ca" class="mq lc iq mh b gy mr ms l mt mu">&lt;button @click='<!-- -->setValue<!-- -->(index)'&gt; set value &lt;/button&gt;</span></pre><p id="1e2a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们访问一个状态，那么我们必须将它包含在我们用<code class="fe me mf mg mh b">data</code>方法返回的对象中。</p><p id="def7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，如果我们有:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="773f" class="mq lc iq mh b gy mr ms l mt mu">const app = new Vue({<br/>  el: "#settings",<br/>  data(){<br/>    return {<br/>      prop: 'foo'<br/>    }<br/>  }<br/>});</span></pre><p id="ce8e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们可以通过编写以下内容在模板中访问它:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="a238" class="mq lc iq mh b gy mr ms l mt mu">{{ prop }}</span></pre><p id="7b95" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">否则，我们会得到一个错误。</p><h1 id="df75" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在Vue.js中显示未转义的HTML</h1><p id="36f9" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用<code class="fe me mf mg mh b">v-html</code>指令在Vue.js中显示未转义的HTML。</p><p id="e1ab" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="36f4" class="mq lc iq mh b gy mr ms l mt mu">&lt;div v-html="htmlContent"&gt; &lt;/div&gt;</span></pre><p id="382e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后假设<code class="fe me mf mg mh b">htmlContent</code>是一个包含HTML代码的字符串，就直接显示出来。</p><h1 id="c8a3" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">从父数据访问子数据</h1><p id="6d57" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以发出一个事件，将数据从子节点发送到父节点。</p><p id="5f25" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，在《孩子》中，我们可以这样写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="9743" class="mq lc iq mh b gy mr ms l mt mu">this.$emit('event', 'foo');</span></pre><p id="9ce4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">'foo'</code>是要发出的数据，<code class="fe me mf mg mh b">'event'</code>是事件名称。</p><p id="7be1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在母体内，我们可以通过书写来听它:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="4954" class="mq lc iq mh b gy mr ms l mt mu">&lt;chilld-component @event='doSomething($event)'&gt;&lt;/child-component&gt;</span></pre><p id="f883" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设子组件叫做<code class="fe me mf mg mh b">child-component</code>，我们可以监听它发出的<code class="fe me mf mg mh b">event</code>事件。</p><p id="7ad9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以通过使用拥有数据的<code class="fe me mf mg mh b">$event</code>对象来获取数据。</p><p id="fd41" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这种情况下，<code class="fe me mf mg mh b">$event</code>就是<code class="fe me mf mg mh b">'foo'</code>。</p><p id="ae0b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以对它做一些事情，比如像上面那样将它传递给<code class="fe me mf mg mh b">doSomething</code>方法。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/98d6588fa4eebe903e7c152707912c63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ly63DHfwcpjwIbcH"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://unsplash.com/@yakimadesign?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">乔丹·罗兰</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="1b0c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="5098" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用<code class="fe me mf mg mh b">this.$forceUpdate()</code>方法强制页面重新加载。</p><p id="18a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了按原样显示HTML，我们可以使用<code class="fe me mf mg mh b">v-html</code>指令。</p><p id="63eb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以通过调用<code class="fe me mf mg mh b">this.$emit</code>将数据从子节点传递给父节点。</p></div></div>    
</body>
</html>