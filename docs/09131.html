<html>
<head>
<title>Crime dataset analysis using basic SQL queries</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用基本 SQL 查询的犯罪数据集分析</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/crime-dataset-analysis-using-basic-sql-queries-d81d4e7caa52?source=collection_archive---------5-----------------------#2022-08-01">https://blog.devgenius.io/crime-dataset-analysis-using-basic-sql-queries-d81d4e7caa52?source=collection_archive---------5-----------------------#2022-08-01</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="3fe8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">嗨！</p><p id="21bb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这篇文章中，我使用了我在谷歌数据分析认证项目中学到的一些基本 SQL 查询来分析一个公共犯罪数据集。</p><p id="4523" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这个数据集在 BigQuery 上有:<a class="ae ki" href="https://console.cloud.google.com/bigquery?project=project-c5w1&amp;ws=!1m5!1m4!4m3!1sbigquery-public-data!2saustin_crime!3scrime" rel="noopener ugc nofollow" target="_blank">big query—Project C5 w1—Google Cloud console</a></p><p id="afc0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">也可以在 kaggle 上找到:<a class="ae ki" href="https://www.kaggle.com/datasets/jboysen/austin-crime" rel="noopener ugc nofollow" target="_blank">奥斯丁犯罪统计| Kaggle </a></p><p id="0937" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">该表及其模式的快速预览显示它有 18 列和 116，675 行，如下所示。如此庞大的数据集意味着可以从中获得大量见解，并且可以运行大量查询。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/218ddc422c04e7676ebb810f82fa1750.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VRHwtk_JJweI4BNl"/></div></div></figure><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/59d98478f648810be681cd7a5007903f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EygTw7c1TALAQo3F"/></div></div></figure><p id="ba14" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我的第一步是决定我想从这个庞大的数据集中获得什么样的见解。这个数据分析阶段是<strong class="jm io">提问</strong>阶段。</p><p id="12c0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">以下是我想到的问题:</p><ol class=""><li id="a0c7" class="kv kw in jm b jn jo jr js jv kx jz ky kd kz kh la lb lc ld bi translated">哪个警区的整体犯罪事件数量最多？</li><li id="91dd" class="kv kw in jm b jn le jr lf jv lg jz lh kd li kh la lb lc ld bi translated">上面那个区什么犯罪率最高？</li><li id="ed03" class="kv kw in jm b jn le jr lf jv lg jz lh kd li kh la lb lc ld bi translated">哪一年这个地区的犯罪率最高？</li><li id="76b9" class="kv kw in jm b jn le jr lf jv lg jz lh kd li kh la lb lc ld bi translated">在这一特定罪行发生率最高的年份，这一罪行的破案率是多少？</li><li id="098e" class="kv kw in jm b jn le jr lf jv lg jz lh kd li kh la lb lc ld bi translated">计算通过逮捕清除每个事件的时间长度(以天为单位)。</li></ol><p id="c338" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">接下来，我进入了数据分析的下一阶段。<strong class="jm io">准备</strong>阶段。在这里，我创建了一个表，它只包含我从这个庞大的数据集中需要的列和行。</p><p id="1945" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">对于我想从这个数据集中获得的洞察力，我只需要<em class="lj"> unique_key、address、district、primary_type、description、timestamp、year、clearance_date 和 clearance_status 这几列。</em></p><p id="e4dc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我使用下面的查询来选择所需的列。我还使用 CAST 函数将 timestamp 和 clearance_date 列从 datetime 格式更改为 date only。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi lk"><img src="../Images/7d033269a9a8585213a770857a4c1c8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JYxyJXF68ahQZDSW"/></div></div></figure><p id="1f6a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我将结果保存为新的 BigQuery 表:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi ll"><img src="../Images/2f45534a95762013bbe322b5279cc5af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*A-2BGHHPkESf-c4b"/></div></div></figure><p id="8ba4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我移动到这个新表，并继续进行数据分析的<strong class="jm io">过程</strong>阶段。<strong class="jm io"> </strong>在这里，我按照下面列出的步骤对新表进行了一些清理。</p><p id="95e4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">首先，我检查了每一列的空值。</p><p id="f24d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我从第一列<em class="lj"> unique_key </em>开始，运行下面的查询。唯一键列有一个空值，如下所示。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi lm"><img src="../Images/a16b1bbdc0f456fa0813a9aebaa9db38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ki8Fx7GEhUdpdKAG"/></div></div></figure><p id="083b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我对新表中的所有列重复这个过程，发现 clearance_date 和 clearance_status 列中有 5114 行包含 null 值。我发现 clearance_date 列中的 null 值在 column_status 日期中有对应的 null 值。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi ln"><img src="../Images/c957efe7d0373de5d16f147d18aedac1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Z-sSF6782Nou5ogN"/></div></div></figure><p id="82b0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">由于我的见解包括使用不同类型的许可状态进行计算，并且样本大小为 116，675 个事件，因此我从表中删除了 5115 个空行(1 个 unique_key 行和 5114 个 clearance_status/date 行)，从而将样本大小减少到 111，560。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi lo"><img src="../Images/f7c7376d37ad93eaefba46d1e3efe5de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-TqMmuuuEMEcZNGQ"/></div></div></figure><p id="44c9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我再次运行查询来检查空值，以验证所有的空值都已被删除。</p><p id="eaed" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">数据清理过程的下一步是找出我的数据集中有多少个警区。我使用了下面的查询，显示了 12 个不同的警区。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi lp"><img src="../Images/28ae87157cc7d5e97347520a5fe83c20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_dnodh5Ld1CgHGh_"/></div></div></figure><p id="78b3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我还运行了一个查询来揭示数据集中不同类型的犯罪。这揭示了 18 种不同类型的犯罪。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi lq"><img src="../Images/92eea141f80330b26ab83c569c8b8f9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QclQEDHKIKpz4vFT"/></div></div></figure><p id="1f8d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上面的结果中，除了 Agg 攻击，还有严重攻击。快速的谷歌搜索显示这两个词是相同的。因此，为了保持一致，我使用下面的查询将所有具有 Agg 攻击的行更改为严重攻击。这使得<em class="lj">初级 _ 类型</em>一栏中的 3932 行从 Agg 攻击变为加重攻击，并将<em class="lj">初级 _ 类型</em>从 18 减少到 17。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi lr"><img src="../Images/9faa1f75d79a5e3d4d8a428dd9bd12b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aLt9PNwfZzZws2Jm"/></div></div></figure><p id="49a5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我再次运行查询以显示不同的 primary_type，以确保我的数据得到更新，并且只有 17 种不同的 primary _ type 犯罪</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi ls"><img src="../Images/a1f6bf10f9ded8ed166e55edf19820ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZCog2yRmYpdaC54b"/></div></div></figure><p id="415f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi">.</p><p id="089a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">然后我进入了数据分析过程的<strong class="jm io">分析</strong>阶段。</p><p id="e7ba" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">问题 1: <strong class="jm io">哪个警区的整体罪案数字最高？</strong></p><p id="3f46" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了回答这个问题，我使用了下面的查询，该查询显示“D”区有 15，831 起事件。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi lt"><img src="../Images/2a0d8e31ab8c0f1136e6be4491266e26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8T8RS2KzTNVAzFoZ"/></div></div></figure><p id="1fa4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这意味着我想从该数据集获得的所有见解都将基于 d 区。</p><p id="0928" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">问题 2: <strong class="jm io">以上区(D 区)什么犯罪发案率最高？</strong></p><p id="a799" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我使用了下面的查询，结果显示盗窃犯罪率最高，共有 7904 起。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi lu"><img src="../Images/a900e429b8de3dd1140c2cea696e9503.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*O13gpenuFevc8O1H"/></div></div></figure><p id="2d13" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">好的，这意味着进一步的分析将基于 D 区的盗窃犯罪。</p><p id="338b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">问题 3: <strong class="jm io">哪一年这个地区的犯罪率最高？(D 区盗窃案)</strong></p><p id="b15c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">首先，我使用下面的查询来查找整个数据集覆盖的 D 区的不同年份，结果显示年份范围从 2014 年到 2016 年。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi lv"><img src="../Images/731349bba90ab172e1e6154ed12dc8c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bv7ZkcFfv4Nc5rsL"/></div></div></figure><p id="d508" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">下一步是找出 d 区每年发生的 7904 起盗窃事件中有多少起。</p><p id="7ea5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">下面的查询显示盗窃发生在 2015 年和 2016 年。</p><p id="bc73" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">2014 年的盗窃事件没有结果起初很奇怪，但 2015 年的 4035 起盗窃事件和 2016 年的 3869 起盗窃事件加起来总共有 7904 起盗窃事件。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi lw"><img src="../Images/ab6b03c11f9e849e433a22fc25174e86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_3v-n_UZxLDTlxSw"/></div></div></figure><p id="14ae" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我有兴趣找出为什么 2014 年没有盗窃犯罪，但这将偏离我计划回答的问题，所以希望我会在另一篇文章中深入探讨这个问题。</p><p id="c4bc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这意味着后续分析将基于 D 区 2015 年的盗窃事件。</p><p id="9723" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">问题 4: <strong class="jm io">这一特定犯罪在最高年份的结案率是多少？</strong></p><p id="6e01" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我使用下面的查询计算了 2015 年 D 区盗窃事件的 clearance_status，得到了下面的结果。</p><p id="5d94" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这表明，2015 年在 D 区发生的 4035 起盗窃事件中，只有 585 起通过逮捕得以清除。</p><p id="fd4b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">(注:我把所有的通关状态数字加起来，以确保我的数字加起来是 4035)</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi lx"><img src="../Images/a41ea3957e841f07c38ce63982f92414.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-lK-Ulg8bzOOHJ5P"/></div></div></figure><p id="4c52" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">问题 5: <strong class="jm io">计算通过逮捕清除每个事件的时间长度(以天为单位)。</strong></p><p id="b7e8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为此，我使用了简单的 SQL 计算和提取函数，如下面的查询所示:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi ly"><img src="../Images/74c1daf25c5bb4277532b099a332694a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AdqJs-gNAhUTlf-q"/></div></div></figure><p id="506c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">最右边一栏中的结果显示了 2015 年 D 区每起盗窃事件实施逮捕所需的时间长度(以天为单位)。</p><p id="5f25" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">从所有这些问题中可以进行很多深入的分析，但我的目标是使用大约 8 条 SQL 语句。对于这个分析，我最终使用了 SELECT DISTINCT、CAST、UPDATE、GROUP BY、ORDER BY、EXTRACT、DELETE、COUNT 和 COUNT(*)函数/语句。</p><p id="5bf5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">欢迎反馈和建议。</p><p id="3d9b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">谢谢大家！</p></div></div>    
</body>
</html>