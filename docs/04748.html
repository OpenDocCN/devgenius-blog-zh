<html>
<head>
<title>Improve your unit tests with AssertJ</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 AssertJ 改进你的单元测试</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/improve-your-unit-tests-with-assertj-469f56ffc411?source=collection_archive---------4-----------------------#2021-04-30">https://blog.devgenius.io/improve-your-unit-tests-with-assertj-469f56ffc411?source=collection_archive---------4-----------------------#2021-04-30</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/d3902ee69b65320163167a37f0d6d569.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xxiwXXAjMnGM-akM"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated"><a class="ae jz" href="https://unsplash.com/@jeshoots?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">JESHOOTS.COM</a>在<a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><p id="7b38" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">您可能正在编写单元测试，如果不是，您可能应该这样做。在我的职业生涯中，我参加了很多关于如何正确写作的研讨会和演讲。我一直强调的一点是，这些测试要有可理解的输出。没有什么比单元测试失败并显示类似<code class="fe ky kz la lb b">Failed. True != False</code>的消息更糟糕的了，你该怎么办呢？使用所有测试框架提供的标准断言函数，您可以通过使用正确的函数、提供额外的消息等来稍微改进这一点...它并不完美，有时工作量很大。</p><p id="9f20" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">AssertJ 来了。这是一个简单的库，旨在改进您的断言。我认为这对于我的测试需求是必不可少的。它提供了各种各样的断言、最新的错误消息。此外，它还提高了代码的可读性，理解您想要断言的内容非常简单。</p><h1 id="16d9" class="lc ld in bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">装置</h1><p id="fb9f" class="pw-post-body-paragraph ka kb in kc b kd ma kf kg kh mb kj kk kl mc kn ko kp md kr ks kt me kv kw kx ig bi translated">AssertJ 可以在 Maven central 上获得，所以安装就像添加一个测试依赖项一样简单。</p><pre class="mf mg mh mi gt mj lb mk ml aw mm bi"><span id="b699" class="mn ld in lb b gy mo mp l mq mr">&lt;dependency&gt;<br/> &lt;groupId&gt;org.assertj&lt;/groupId&gt;<br/> &lt;artifactId&gt;assertj-core&lt;/artifactId&gt;<br/> &lt;version&gt;3.19.0&lt;/version&gt;<br/> &lt;scope&gt;test&lt;/scope&gt;<br/>&lt;/dependency&gt;</span></pre><h1 id="e8b9" class="lc ld in bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">使用</h1><p id="c89b" class="pw-post-body-paragraph ka kb in kc b kd ma kf kg kh mb kj kk kl mc kn ko kp md kr ks kt me kv kw kx ig bi translated">在本文中，我将通过几个例子来说明 AssertJ 有多棒。这些示例将在 JUnit5 中完成，结构如下。</p><pre class="mf mg mh mi gt mj lb mk ml aw mm bi"><span id="3d70" class="mn ld in lb b gy mo mp l mq mr">class DtoComparisonTest {<br/><br/> @Test<br/> void testComparison() {<br/> var x = new TestedDto("a", "c", new TestedNestedDto(1, 2));<br/> var y = new TestedDto("a", "b", new TestedNestedDto(1, 3));<br/><br/> Assertions.assertThat(x).isEqualTo(y);<br/> }<br/><br/> @Data<br/> @AllArgsConstructor<br/> private static class TestedDto {<br/><br/> String firstString;<br/> String secondString;<br/> TestedNestedDto nested;<br/> }<br/><br/> @Data<br/> @AllArgsConstructor<br/> private static class TestedNestedDto {<br/> int firstInt;<br/> int secondInt;<br/> }<br/><br/>}</span></pre><p id="8381" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这个例子比较了<code class="fe ky kz la lb b">x</code>和<code class="fe ky kz la lb b">y</code>对象，并输出了下面的错误信息。</p><pre class="mf mg mh mi gt mj lb mk ml aw mm bi"><span id="f453" class="mn ld in lb b gy mo mp l mq mr">org.opentest4j.AssertionFailedError: <br/>Expecting:<br/> &lt;DtoComparisonTest.TestedDto(firstString=a, secondString=c, nested=DtoComparisonTest.TestedNestedDto(firstInt=1, secondInt=2))&gt;<br/>to be equal to:<br/> &lt;DtoComparisonTest.TestedDto(firstString=a, secondString=b, nested=DtoComparisonTest.TestedNestedDto(firstInt=1, secondInt=3))&gt;<br/>but was not.<br/>Expected :DtoComparisonTest.TestedDto(firstString=a, secondString=b, nested=DtoComparisonTest.TestedNestedDto(firstInt=1, secondInt=3))<br/>Actual :DtoComparisonTest.TestedDto(firstString=a, secondString=c, nested=DtoComparisonTest.TestedNestedDto(firstInt=1, secondInt=2))</span></pre><p id="556f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">多棒啊。</p><p id="b69e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">它有很多针对 String 的内置断言。让我们看一些例子:</p><pre class="mf mg mh mi gt mj lb mk ml aw mm bi"><span id="7007" class="mn ld in lb b gy mo mp l mq mr">@Test<br/> void testComparison() {<br/><br/> var x = new TestedDto("Dragon", "Goblin", new TestedNestedDto(1, 2));<br/><br/> Assertions.assertThat(x.getFirstString())<br/> .startsWith("D")<br/> .endsWith("n")<br/> .isLowerCase();<br/> }</span></pre><p id="f786" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这将输出</p><pre class="mf mg mh mi gt mj lb mk ml aw mm bi"><span id="dbcf" class="mn ld in lb b gy mo mp l mq mr">java.lang.AssertionError: <br/>Expecting &lt;"Dragon"&gt; to be a lowercase</span></pre><p id="c884" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">想象一下这样做并得到与普通断言相同的输出。</p><p id="402b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">它还有大量的内置收藏。</p><pre class="mf mg mh mi gt mj lb mk ml aw mm bi"><span id="e11e" class="mn ld in lb b gy mo mp l mq mr">@Test<br/> void testComparison() {<br/><br/> var x = new TestedDto("a", "b", new TestedNestedDto(1, 2));<br/> var y = new TestedDto("c", "d", new TestedNestedDto(1, 2));<br/> var collection = Arrays.asList(x, y);<br/><br/> Assertions.assertThat(collection)<br/> .hasSize(2)<br/> .contains(x)<br/> .allMatch(tested -&gt; tested.getNested().getFirstInt() == 1)<br/> .anyMatch(tested -&gt; tested.getSecondString().equals("b"))<br/> .containsNull();<br/> }</span></pre><p id="10b4" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">打印此错误消息:</p><pre class="mf mg mh mi gt mj lb mk ml aw mm bi"><span id="605f" class="mn ld in lb b gy mo mp l mq mr">java.lang.AssertionError: <br/>Expecting:<br/> &lt;[DtoComparisonTest.TestedDto(firstString=a, secondString=b, nested=DtoComparisonTest.TestedNestedDto(firstInt=1, secondInt=2)),<br/> DtoComparisonTest.TestedDto(firstString=c, secondString=d, nested=DtoComparisonTest.TestedNestedDto(firstInt=1, secondInt=2))]&gt;<br/>to contain a &lt;null&gt; element</span></pre><p id="73f5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我非常喜欢这个图书馆。它非常简单，可以极大地改善您的测试。我建议您今天就开始使用它(也可以深入研究他们的文档，AssertJ 还有很多内容)。</p></div><div class="ab cl ms mt hr mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ig ih ii ij ik"><p id="1620" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">更多类似的建议，你可以在推特上关注我。</p></div><div class="ab cl ms mt hr mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ig ih ii ij ik"><p id="30de" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="mz">原载于 2021 年 4 月 30 日</em><a class="ae jz" href="https://dev.to/pavel_polivka/improve-your-unit-tests-with-assertj-35m2" rel="noopener ugc nofollow" target="_blank"><em class="mz">https://dev . to</em></a><em class="mz">。</em></p></div></div>    
</body>
</html>