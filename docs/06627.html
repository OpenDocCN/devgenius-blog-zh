<html>
<head>
<title>Commit Verification in GitHub</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">GitHub 中的提交验证</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/commit-verification-in-github-90adae7ed8a6?source=collection_archive---------14-----------------------#2022-01-20">https://blog.devgenius.io/commit-verification-in-github-90adae7ed8a6?source=collection_archive---------14-----------------------#2022-01-20</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><blockquote class="jk jl jm"><p id="1b85" class="jn jo jp jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ig bi translated">不要错过最后关于 VS 代码和 Git 的额外提示。</p></blockquote><p id="0583" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">在一个随机的工作日，我检查了存储库中的提交，发现 CTO 的提交显示了一个绿色的验证徽章。经过一番研究发现，GitHub 有一个<a class="ae kp" href="https://docs.github.com/en/authentication/managing-commit-signature-verification" rel="noopener ugc nofollow" target="_blank">提交验证</a>的功能。基本上，它将您的提交标记为已验证，以便其他人知道该提交来自可信来源。此外，它给你所有的提交一个看起来很酷的验证徽章。所以，我尝试了一下，一些来自社交媒体的人请求我帮助他们做这件事。几天后，我开始写这个…</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi kq"><img src="../Images/3ca539c3cb41a2d26b182f19776e5d45.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*ZHI9Fo0OIEumPkZ4uxxxcw.jpeg"/></div></figure><h2 id="d062" class="ky kz in bd la lb lc dn ld le lf dp lg km lh li lj kn lk ll lm ko ln lo lp lq bi translated">先决条件</h2><ul class=""><li id="b0f9" class="lr ls in jq b jr lt jv lu km lv kn lw ko lx kl ly lz ma mb bi translated">电子邮件验证了<a class="ae kp" href="http://github.com" rel="noopener ugc nofollow" target="_blank"> GitHub </a>账户。</li><li id="0248" class="lr ls in jq b jr mc jv md km me kn mf ko mg kl ly lz ma mb bi translated">基本的命令行知识。</li><li id="7f0c" class="lr ls in jq b jr mc jv md km me kn mf ko mg kl ly lz ma mb bi translated">基本的<a class="ae kp" href="https://www.ssl2buy.com/wiki/what-is-a-public-and-private-key-pair" rel="noopener ugc nofollow" target="_blank">键对</a>知识。</li></ul></div><div class="ab cl mh mi hr mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ig ih ii ij ik"><p id="d2b1" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">要做到这一点，有三个主要步骤。在下面的段落中，我将向你展示 Ubuntu 和 Windows 的步骤。</p><ul class=""><li id="b3fc" class="lr ls in jq b jr js jv jw km mo kn mp ko mq kl ly lz ma mb bi translated">生成密钥对。</li><li id="9bd5" class="lr ls in jq b jr mc jv md km me kn mf ko mg kl ly lz ma mb bi translated">将公钥添加到您的 GitHub 配置文件中。</li><li id="8377" class="lr ls in jq b jr mc jv md km me kn mf ko mg kl ly lz ma mb bi translated">用它签名确认。</li></ul></div><div class="ab cl mh mi hr mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ig ih ii ij ik"><h2 id="ae95" class="ky kz in bd la lb lc dn ld le lf dp lg km lh li lj kn lk ll lm ko ln lo lp lq bi translated">生成密钥对</h2><p id="960a" class="pw-post-body-paragraph jn jo in jq b jr lt jt ju jv lu jx jy km mr kb kc kn ms kf kg ko mt kj kk kl ig bi translated">根据 GitHub，您可以使用 GPG 或 S/MIME 生成密钥对。在这里，我会告诉你如何使用 GPG 只。</p><p id="c6ad" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">对于<strong class="jq io"> Windows </strong>用户:</p><ul class=""><li id="29ee" class="lr ls in jq b jr js jv jw km mo kn mp ko mq kl ly lz ma mb bi translated">下载并安装您自己选择的 GPG 密钥生成器客户端或<a class="ae kp" href="https://www.gpg4win.org/" rel="noopener ugc nofollow" target="_blank"> GPG4Win </a>。它将安装一个名为 Kleopatra 的 GUI。</li><li id="1023" class="lr ls in jq b jr mc jv md km me kn mf ko mg kl ly lz ma mb bi translated">之后，将全局 git 配置路径添加到 gnupg(如果还没有添加的话)。</li></ul><pre class="kr ks kt ku gt mu mv mw mx aw my bi"><span id="874a" class="ky kz in mv b gy mz na l nb nc">git config --global gpg.program "<em class="jp">C:\Program Files (x86)\GnuPG\bin</em>"</span></pre><ul class=""><li id="1e7a" class="lr ls in jq b jr js jv jw km mo kn mp ko mq kl ly lz ma mb bi translated">启动 Kleopatra 并创建一个新对。它会询问你的名字和电子邮件。使用您使用的姓名和电子邮件。GitHub 建议使用 4096 位加密，如果你愿意，你可以使用密码来保护你的密钥对。</li></ul><p id="8f0d" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">对于 Ubuntu 用户:</p><ul class=""><li id="384f" class="lr ls in jq b jr js jv jw km mo kn mp ko mq kl ly lz ma mb bi translated">如果您使用的是 20.04 及更高版本，gpg 应该已经安装了。如果没有，运行该命令</li></ul><pre class="kr ks kt ku gt mu mv mw mx aw my bi"><span id="672a" class="ky kz in mv b gy mz na l nb nc">sudo apt install gnupg</span></pre><ul class=""><li id="7f19" class="lr ls in jq b jr js jv jw km mo kn mp ko mq kl ly lz ma mb bi translated">接下来运行 gpg key gen 命令，选择 RSA 并输入全名和您在 GitHub 中使用的电子邮件。</li></ul><pre class="kr ks kt ku gt mu mv mw mx aw my bi"><span id="b51e" class="ky kz in mv b gy mz na l nb nc">gpg --full-generate-key</span></pre><ul class=""><li id="40f1" class="lr ls in jq b jr js jv jw km mo kn mp ko mq kl ly lz ma mb bi translated">如果您想保护您的密钥对，请添加密码短语。</li><li id="50fe" class="lr ls in jq b jr mc jv md km me kn mf ko mg kl ly lz ma mb bi translated">现在，您可以通过键入以下命令来查看关键细节:</li></ul><pre class="kr ks kt ku gt mu mv mw mx aw my bi"><span id="2555" class="ky kz in mv b gy mz na l nb nc">gpg --list-secret-keys --keyid-format=long<!-- --> </span></pre></div><div class="ab cl mh mi hr mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ig ih ii ij ik"><p id="7c5c" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">现在，我们已经生成了要使用的密钥对，让我们继续下一步。</p><h2 id="62eb" class="ky kz in bd la lb lc dn ld le lf dp lg km lh li lj kn lk ll lm ko ln lo lp lq bi translated">向 GitHub 添加公钥</h2><p id="2751" class="pw-post-body-paragraph jn jo in jq b jr lt jt ju jv lu jx jy km mr kb kc kn ms kf kg ko mt kj kk kl ig bi translated">在这一步中，我们需要生成公钥并将其添加到我们的配置文件中。添加到个人资料非常简单。我们需要复制公钥，然后进入设置&gt; SSH 和 GPG 密钥&gt;新 GPG 密钥&gt;粘贴密钥&gt;添加 GPG 密钥。</p><p id="9d36" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">对于<strong class="jq io"> Windows </strong>用户:</p><ul class=""><li id="d23f" class="lr ls in jq b jr js jv jw km mo kn mp ko mq kl ly lz ma mb bi translated">打开 Kleopatra，您将看到刚刚创建的密钥对的详细信息。</li><li id="0156" class="lr ls in jq b jr mc jv md km me kn mf ko mg kl ly lz ma mb bi translated">双击它会出现一个提示，并点击导出。</li><li id="bf9a" class="lr ls in jq b jr mc jv md km me kn mf ko mg kl ly lz ma mb bi translated">您将看到完整的公钥。现在复制全文。</li></ul><p id="3990" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">对于<strong class="jq io"> Ubuntu </strong>用户:</p><ul class=""><li id="a1b8" class="lr ls in jq b jr js jv jw km mo kn mp ko mq kl ly lz ma mb bi translated">转到命令行并找到密钥 id。</li></ul><pre class="kr ks kt ku gt mu mv mw mx aw my bi"><span id="b345" class="ky kz in mv b gy mz na l nb nc">gpg --list-secret-keys --keyid-format=long</span></pre><ul class=""><li id="58ee" class="lr ls in jq b jr js jv jw km mo kn mp ko mq kl ly lz ma mb bi translated">然后运行这个命令，它将在终端中打印公钥。</li></ul><pre class="kr ks kt ku gt mu mv mw mx aw my bi"><span id="948d" class="ky kz in mv b gy mz na l nb nc">gpg --armor --export key_id<br/># Prints the GPG key ID, in ASCII armor format</span></pre><ul class=""><li id="1f98" class="lr ls in jq b jr js jv jw km mo kn mp ko mq kl ly lz ma mb bi translated">从头到尾复制 GPG 键。</li></ul></div><div class="ab cl mh mi hr mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ig ih ii ij ik"><p id="d134" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">现在 GitHub 知道了公钥，我们就快完成了！</p><h2 id="dfc7" class="ky kz in bd la lb lc dn ld le lf dp lg km lh li lj kn lk ll lm ko ln lo lp lq bi translated">签名提交</h2><p id="2e7a" class="pw-post-body-paragraph jn jo in jq b jr lt jt ju jv lu jx jy km mr kb kc kn ms kf kg ko mt kj kk kl ig bi translated">这是获得我们想要的绿色徽章的最后一步！因为，我们已经完成了最困难的部分，这就像在公园散步。</p><ul class=""><li id="eb2e" class="lr ls in jq b jr js jv jw km mo kn mp ko mq kl ly lz ma mb bi translated">首先进入 GitHub 配置文件的“设置”&gt;“SSH 和 GPG 键”,打开“未签名提交未验证”标志。[ <em class="jp">可选的</em></li><li id="eefe" class="lr ls in jq b jr mc jv md km me kn mf ko mg kl ly lz ma mb bi translated">然后在 git 全局配置中添加我们在上一步中获得的 key_id。</li></ul><pre class="kr ks kt ku gt mu mv mw mx aw my bi"><span id="9b01" class="ky kz in mv b gy mz na l nb nc">git config --global user.signingkey key_id</span></pre><ul class=""><li id="57c7" class="lr ls in jq b jr js jv jw km mo kn mp ko mq kl ly lz ma mb bi translated">接下来，转到本地 git 存储库，使用以下命令提交您的更改</li></ul><pre class="kr ks kt ku gt mu mv mw mx aw my bi"><span id="2815" class="ky kz in mv b gy mz na l nb nc">git commit -S -m "commit message"<br/># Creates a signed commit</span></pre><ul class=""><li id="5887" class="lr ls in jq b jr js jv jw km mo kn mp ko mq kl ly lz ma mb bi translated">现在，如果你去 GitHub 并检查提交，你会看到验证徽章。</li></ul><p id="4737" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">就这样，我们完成了这个过程。</p><h2 id="a8cc" class="ky kz in bd la lb lc dn ld le lf dp lg km lh li lj kn lk ll lm ko ln lo lp lq bi translated">结论</h2><p id="77b2" class="pw-post-body-paragraph jn jo in jq b jr lt jt ju jv lu jx jy km mr kb kc kn ms kf kg ko mt kj kk kl ig bi translated">耶！我们已经成功地配置了 GitHub 概要文件来推送经过验证的提交。现在，我们所有的未来提交将显示一个非常酷的徽章！也许我们应该创建一个认证徽章邪教。开个玩笑！感谢你坚持完成这三个部分。如果你面临任何问题，请在评论中告诉我。我会尽力帮你。到那时再见！</p><h2 id="dd07" class="ky kz in bd la lb lc dn ld le lf dp lg km lh li lj kn lk ll lm ko ln lo lp lq bi translated">奖金</h2><p id="a7e2" class="pw-post-body-paragraph jn jo in jq b jr lt jt ju jv lu jx jy km mr kb kc kn ms kf kg ko mt kj kk kl ig bi translated">这一部分只有在你使用 VS 代码作为你的代码编辑器和 git 的情况下才适用。</p><p id="4670" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">如您所见，我们需要在每个提交中添加一个<em class="jp"> -S </em>来使提交签名。如果你和我一样，那就没意思了。我们可以告诉 git 记住默认情况下签署每个提交:</p><pre class="kr ks kt ku gt mu mv mw mx aw my bi"><span id="898a" class="ky kz in mv b gy mz na l nb nc">git config --global commit.gpgsign true</span></pre><p id="2566" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">要告诉 VS 代码类似的事情，转到 settings.json 文件并添加这个键值:</p><pre class="kr ks kt ku gt mu mv mw mx aw my bi"><span id="38f5" class="ky kz in mv b gy mz na l nb nc">"git.enableCommitSigning": true,</span></pre><p id="ff95" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">现在，VS 代码将从 GitHub GUI 扩展中自动执行签名提交。</p></div></div>    
</body>
</html>