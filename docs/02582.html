<html>
<head>
<title>Node.js Best Practices — Security and Setup</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Node.js最佳实践—安全性和设置</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/node-js-best-practices-security-and-setup-56630d995409?source=collection_archive---------8-----------------------#2020-08-13">https://blog.devgenius.io/node-js-best-practices-security-and-setup-56630d995409?source=collection_archive---------8-----------------------#2020-08-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/b0b77e651afe7f9d4ea37b6309233560.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8YOVzBT4l2kvPERo"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@natthornley?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">娜塔莉·索恩利</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="f191" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">像任何类型的应用程序一样，JavaScript应用程序也必须写得很好。</p><p id="9a1d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">否则，我们以后会遇到各种各样的问题。</p><p id="96a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看在编写节点应用程序时应该遵循的一些最佳实践。</p><h1 id="68a1" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">为NPM或纱线配置2FA</h1><p id="527c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们应该为我们的包存储库启用双因素认证，这样攻击者就不能轻易得到它们。</p><p id="908a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">开启它将使攻击者没有机会访问我们的回购。</p><h1 id="fbfd" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">修改会话中间件设置</h1><p id="cc5c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">应该修改会话中间件设置，以避免暴露任何有助于攻击者的东西。</p><p id="a139" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，应移除<code class="fe me mf mg mh b">X-Powered-By</code>标题。</p><p id="e1ec" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样，攻击者就无法识别我们使用的是什么框架。</p><p id="9a97" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Cookies也应该通过安全连接发送。</p><p id="170b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么攻击者就无法接入我们的连接来获取他们想要的信息。</p><h1 id="7790" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">通过明确设置进程崩溃的时间来避免DOS攻击</h1><p id="a5e8" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">如果我们的流程过载，那么它们应该会崩溃，这样我们就可以通过捕捉这些错误来优雅地处理这些情况。</p><p id="addb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这意味着攻击者无法继续他们的DOS攻击，延长我们服务的停机时间。</p><p id="7d71" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，当这些事件发生时，我们应该警惕自己。</p><h1 id="5ad2" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">防止不安全的重定向</h1><p id="15ec" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们不应该让攻击者将用户重定向到他们想去的任何地方。</p><p id="2a63" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了防止这种情况，我们制作自己的URL，以便重定向总是重定向到我们想要的地方，而不是攻击者想要的地方。</p><h1 id="5bad" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">避免向NPM登记处泄露机密</h1><p id="12d5" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">NPM登记处不是用来存储秘密的。</p><p id="58e5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们应该避免在那里公布任何秘密。</p><p id="9efe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们可以将不想发布的内容添加到<code class="fe me mf mg mh b">.npmignore</code>文件中。</p><p id="9bb7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样，我们就不会将API密钥、密码和其他秘密暴露给公众。</p><h1 id="5178" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">不要阻塞事件循环</h1><p id="e3e8" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们的代码不应该阻塞事件循环。</p><p id="77e9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是因为节点应用程序是单线程的。</p><p id="eb09" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这意味着我们应该对长期运行的流程使用异步代码。</p><p id="2c72" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">需要长时间运行的同步代码会阻止我们应用程序的其余部分运行。</p><p id="e1c7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用异步代码，用户不会看到延迟。</p><h1 id="c491" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">比起Lodash等第三方工具，更喜欢本地JS方法</h1><p id="3f18" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">如果有本地JavaScript方法可用，那么我们应该使用它们而不是第三方库。</p><p id="17f6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">需要的依赖越少，我们的应用就会越快越小。</p><p id="639c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，代替Lodash数组方法，我们应该用本地JavaScript数组方法。</p><h1 id="a057" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">用npm init启动每个新项目</h1><p id="3007" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们应该用<code class="fe me mf mg mh b">npm init</code>开始每个新项目，这样我们的项目就有了一个<code class="fe me mf mg mh b">package.json</code>。</p><p id="3582" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同样，我们可以添加<code class="fe me mf mg mh b">--yes</code>来用默认值设置所有选项。</p><p id="6c4f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="5975" class="mq lc iq mh b gy mr ms l mt mu">$ mkdir my-app<br/>$ cd my-app<br/>$ npm init --yes</span></pre><p id="e765" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们用默认选项创建带有<code class="fe me mf mg mh b">package.json</code>的<code class="fe me mf mg mh b">my-app</code>项目文件夹。</p><h1 id="2b76" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用ES6+</h1><p id="0273" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">是时候使用最新的JavaScript特性了。</p><p id="ed8c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它们比旧的语法好得多。</p><p id="cb70" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最新版本的Node支持它。</p><p id="fc84" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们应该使用像箭头功能，传播和休息等功能。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/496a0db67dbed695caafc20a35515e94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7yezTG8y5Hq4S2as"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">乔尔·内维斯在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><h1 id="3d76" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="fcaa" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们应该坚持一些好的实践，比如使用现代特性、异步代码等等。</p></div></div>    
</body>
</html>