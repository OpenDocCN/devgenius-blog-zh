<html>
<head>
<title>How To SetUp an EC2 Instance Using The CLI And Installing A Virtual Python Environment</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用CLI设置EC2实例并安装虚拟Python环境</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-setup-an-ec2-instance-using-the-cli-and-installing-a-virtual-python-environment-51b1b850dd67?source=collection_archive---------2-----------------------#2021-04-20">https://blog.devgenius.io/how-to-setup-an-ec2-instance-using-the-cli-and-installing-a-virtual-python-environment-51b1b850dd67?source=collection_archive---------2-----------------------#2021-04-20</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/369e9fddee5c0e86dc490f5a05faaf08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FOJD85eVG_yZsr8KzOAyYg.jpeg"/></div></div></figure><p id="3e5a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">你好，感谢再次加入我的节目！在本实验中，我们将学习如何通过AWS命令行界面(CLI)设置Python环境。如果你想知道AWS CLI是什么，它的用途是什么，请查看我的题为“从CLI创建自动缩放组”的实验室。在该实验中，我介绍了什么是AWS CLI，以及使用它代替AWS控制台GUI的好处。如果你不熟悉Python，我强烈建议你看看我的上一篇博客“如何使用Python创建品牌名称生成器”。该实验室更深入地研究了Python是什么以及它的用途。</p><p id="1ec0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">*在我们开始之前，给你一些建议——对于登录AWS或填写命令所需的任何信息，请将其保存在一个文件中，这样只有你才能访问它。这也将使你更容易参考，而不是不断地寻找信息。</p><p id="6566" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">好了，现在我已经说清楚了，让我们开始派对吧！</p><p id="71d7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">第一步:</strong>创建新用户</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi kt"><img src="../Images/557c91046227c76ecf1ee251ccc22231.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6m5AyXugkgT41ufONKBnZg.png"/></div></div></figure><p id="2f7e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">1a)登录AWS控制台，转到搜索栏并键入IAM来创建一个新用户。在那里，选择标有“添加用户”的蓝色图标。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ky"><img src="../Images/863bb592b458ee40b816dea47bac4325.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*whJ1MDvUXYetEzWivMRunw.png"/></div></div></figure><p id="7dfb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">1b)一旦您为用户提供了名称，请确保您选中了该复选框，以便为他提供编程访问权限以及AWS管理控制台访问权限。为用户提供一个自定义密码是一种很好的做法，同时选中强制用户在下次登录时创建新密码的复选框，但这不是本实验的要求。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi kz"><img src="../Images/06e89d81805838f0dd1cbca9a9290994.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e3VsCrUiB2ujEaDg5yQYhA.png"/></div></div></figure><p id="b4d3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">1c)成功创建用户后，请确保将访问密钥ID和秘密访问密钥保存到记事本或其他安全的地方。这些是以该用户身份成功登录AWS CLI所必需的。</p><p id="c6ba" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">此外，这个VPC和用户将被拆除的时候，这个博客张贴，以避免任何人试图登录，哈哈。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi la"><img src="../Images/ea8c4b37a3bb713278fcc325e1052b95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KOG28_FbX-vZrvS-L49-rA.png"/></div></div></figure><p id="a7d8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">1d)现在事情变得有趣了。登录到您的CLI并输入命令“aws configure”。这就是需要之前信息的地方。使用您保存的信息，使用您的新用户凭据成功配置AWS CLI。完成后，请跟随我进行下一步。仅供参考，我在本实验中屏蔽了我的访问密钥和保密密钥，但您的密钥将完全显示在CLI中。</p><p id="5947" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">第2步:</strong>从命令行界面配置您的VPC</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lb"><img src="../Images/409cf8c80ace7484d2db045dea07190d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7hIgQDTlmbN7nVJhV1_O_Q.png"/></div></div></figure><p id="5f9d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">2a)使用命令“aws ec2 describe-vpcs”确保您使用的是要配置的正确的VPC。这只是为了确保在您继续之前一切都准备好了。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lc"><img src="../Images/10fc867699b5ff4b952c2785a6b54920.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wRCjueeXXwAWHCu_XexbpQ.png"/></div></div></figure><p id="40fd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">2b)下一步是为您的VPC创建一个安全组。您的EC2实例将需要这一点，以允许您通过SSH来下载您的Python环境。使用以下命令创建您的安全组。它应该返回安全组ID。</p><p id="cef9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">AWS ec2 create-security-group-group-name project 5-description "<em class="ld">随便你怎么命名</em>-VPC-id<em class="ld">yourvpcid</em></p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi le"><img src="../Images/c5ef8dbc6fbcff13982e40d70f15da89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lvvxUO5A25JzGjpYVaVh4g.png"/></div></div></figure><p id="fc2d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">2c)配置安全组后，使用下一个命令打开端口22。一旦将这个安全组连接到EC2，端口22允许您SSH到EC2。出于习惯，我也打开了端口80，但这不是本实验所必需的。当它没有给你回报的时候，你就知道你成功了。您可以随时检查控制台，以确保您的命令确实得到执行。以下是命令:</p><p id="80ec" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">AWS ec2 authorize-security-group-ingress-group-id<em class="ld">yoursecuritygroup-</em>协议TCP-port<em class="ld">whateveryouwanttoopen</em>CIDR<em class="ld">yourvpcid</em></p><p id="6541" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">第三步:创建您的EC2</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lf"><img src="../Images/01c36a8aa7b0be4df6db4b374a5d1fa4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gxyn6o8hl0LPD-gNF2tuuQ.png"/></div></div></figure><p id="af2d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">3a)好的，一旦你到了这一步，回到AWS控制台并选择你想要选择的AMI。获取该实例的AMI，并将其放在记事本中，因为下面的命令将需要它。我个人选择了Ubuntu。请记住，无论您选择什么样的图像，都可能有自己的命令。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lg"><img src="../Images/0bae2f29a5ee6a9e4b18a170e1c671db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yUEkPqFK2NYtuVtDHWGJEA.png"/></div></div></figure><p id="eea9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">3b)执行到这一步后，您将使用AWS EC2控制台中的信息创建实例。此外，请确保您选择的密钥对保存在您计算机上您可以访问的文件夹下。使用以下命令创建实例:</p><p id="4fe2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">AWS ec2 run-instances-image-id<em class="ld">ami you choosed</em>-instance-type<em class="ld">whever size you want</em>-key-name<em class="ld">your key</em></p><p id="bdb3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">使用此命令将您的安全组附加到它:</p><p id="e3ce" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">AWS ec2 modify-instance-attribut-instance-id<em class="ld">yoursinstanceid</em>-groups<em class="ld">yoursecuritygroupid</em></p><p id="41c8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">步骤4: </strong>登录到您的实例</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lh"><img src="../Images/793844f5eaead9720521ee5f0f6babbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kmWr073Lx3Wbf0rnFSKBfg.png"/></div></div></figure><p id="cb65" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">4a)执行到这一步后，转到AWS控制台，在搜索栏中键入EC2。在那里，单击Instances并选择您刚刚创建的实例ID，然后选择“Connect”。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi li"><img src="../Images/5f63924b1c56366e77176ce9f706e565.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2STlrMKQLzh1FN_zEZiOsQ.png"/></div></div></figure><p id="a1e6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">4b)选择“连接”后，选择“SSH客户端”,您的屏幕应该类似于我在上面直接发布的内容。您需要复制AWS为您创建的示例，并将其放入您的CLI中。但是在你做之前，使用CLI命令“cd”将目录切换到你保存密钥对文档的地方，然后键入你的文件夹名。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lj"><img src="../Images/e8210a90f1606c4749eb3a0f0ad3959e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0VNA5AhGxamcQDmhxsBpjQ.png"/></div></div></figure><p id="a755" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">4c)进入该目录后，将实例连接示例粘贴到您的CLI中。然后，您的CLI应该开始连接，您的最后一行应该是您的实例的私有IPv4地址，等待您的下一个命令。一旦你看到这一点，你就成功地连接到了它。</p><p id="ae7f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">步骤5: </strong>将Python环境下载到您的实例中</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lk"><img src="../Images/2c09413cfe5c292f586f492a60b34818.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wUJbbM1ryoPPIYoUxSsrjg.png"/></div></div></figure><p id="2d5a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">5a)好了，我们差不多完成了。下一步是将Python环境下载到您的实例中。但是在这之前，最好更新和升级您的实例。请记住，您的sudo命令将根据您选择的实例而变化。</p><ul class=""><li id="b8b1" class="ll lm in jx b jy jz kc kd kg ln kk lo ko lp ks lq lr ls lt bi translated">使用命令"<em class="ld"> sudo apt update </em>"来更新您的实例</li><li id="6394" class="ll lm in jx b jy lu kc lv kg lw kk lx ko ly ks lq lr ls lt bi translated">接下来使用“<em class="ld"> sudo apt upgrade </em>”来升级您的实例</li></ul><p id="f95b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">然后在实例中创建一个路径，从环境中下载所有的包和库。你可以使用命令"<em class="ld"> mkdir </em>"然后给这个文件夹取你想要的名字。完成后，将目录切换到该文件夹，然后使用以下命令安装Python环境:</p><p id="6f56" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">sudo安装python3-venv</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lz"><img src="../Images/896c942b0d017397d2caa5dd8809b6b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*37OTHtDT-jBsWO6Px3RDdA.png"/></div></div></figure><p id="ad0d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">5b)要激活环境，请键入:</p><p id="080c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">来源<em class="ld">whateveryounamedyourfolder</em>/bin/activate</p><p id="6781" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">步骤6 </strong> <em class="ld"> : </em>创建并运行您的Python测试程序</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ma"><img src="../Images/7e0cf6eac486920c17cdb50bdc2e2361.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ujKbAW8qe27yM4ZW1rhcSQ.png"/></div></div></figure><p id="cfb0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">6a)在最后一步，我们将通过Python创建一个测试程序。您可以使用您喜欢的任何文本编辑器来创建“hello.py”程序，但是我个人选择(并且推荐本实验使用)保持简单，使用Vim。您可以运行Vim并创建程序，只需输入命令“<em class="ld"> vim hello.py”。</em></p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mb"><img src="../Images/1f056d5ccaff79630476b70e300729f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ELuw10Iuj4wpcRc8sVWNgQ.png"/></div></div></figure><p id="79e8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">6b)然后，您将进入该屏幕输入您的代码。在这里你可以输入任何你想要文本编辑器执行的命令。要开始插入代码，只需点击“I”进入插入模式。一旦进入插入模式，只需输入print("Hello World！").您可以通过按键盘上的escape键来保存此代码。要保存它，键入分号“:”，然后键入wq并按回车键。这将您的代码保存到文件中，以便在您输入命令后执行。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ma"><img src="../Images/7e0cf6eac486920c17cdb50bdc2e2361.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ujKbAW8qe27yM4ZW1rhcSQ.png"/></div></div></figure><p id="3ac9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">6c)现在输入"<em class="ld"> python3 hello.py </em>"让python执行你的文件。你会立即看到Python打印的“Hello World！”对着屏幕。</p><p id="f795" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我的实验室到此结束。谢谢你坚持和我在一起！</p></div></div>    
</body>
</html>