<html>
<head>
<title>Iceberg + Spark + Trino + Dagster: modern, open-source data stack demo</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Iceberg + Spark + Trino + Dagster:现代开源数据堆栈演示</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/modern-data-stack-demo-5d75dcdfba50?source=collection_archive---------0-----------------------#2022-07-04">https://blog.devgenius.io/modern-data-stack-demo-5d75dcdfba50?source=collection_archive---------0-----------------------#2022-07-04</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="d50d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我在两个月前组装了这个<strong class="jm io">ngods</strong>(<strong class="jm io">n</strong>ew<strong class="jm io">g</strong>generation<strong class="jm io">开源</strong>T8】dATA<strong class="jm io">s</strong>tack)并在此后的两个项目中使用了它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/763db58e2ed74d5395524ca924c8afe7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WuyYWh7h-Vrdc6Kq2W4IOw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">ngods 架构</figcaption></figure><p id="ce39" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我发现数据堆栈可以很好地从小数据(几 GB)扩展到中等大小的数据(几百 GB)。它也比基于使用定价的云数据栈便宜得多(例如，雪花、红移或 BigQuery)。</p><p id="696a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我创建了一个简单的演示来展示它的能力。您可以将它作为自己项目的起点。</p><p id="97f8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这个演示可以在这个<a class="ae ky" href="https://github.com/zsvoboda/ngods-stocks" rel="noopener ugc nofollow" target="_blank"> GitHub 库</a>中找到。它从 Yahoo Finance API 中检索选定的股票代码数据历史，将其存储在数据仓库中，对其进行转换，并为机器学习预测和数据可视化提供分析模型。</p><p id="0b6b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">该演示使用<a class="ae ky" href="https://databricks.com/fr/glossary/medallion-architecture" rel="noopener ugc nofollow" target="_blank"> medallion 架构</a>和三个数据阶段:青铜级、白银级和黄金级。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi kz"><img src="../Images/bd07ed4d80e49fc74560329e1e33148d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l4yg9KvBs6mnoBvD7FCLZg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">圆形建筑</figcaption></figure><ul class=""><li id="2c01" class="la lb in jm b jn jo jr js jv lc jz ld kd le kh lf lg lh li bi translated"><strong class="jm io">青铜</strong>数据级以其原始数据源的形式存储数据。这个阶段使用<a class="ae ky" href="https://iceberg.apache.org/" rel="noopener ugc nofollow" target="_blank"> Apache Iceberg </a>进行数据存储。</li><li id="6642" class="la lb in jm b jn lj jr lk jv ll jz lm kd ln kh lf lg lh li bi translated"><strong class="jm io">银</strong>数据阶段存储清理和转换后的数据，这些数据混合了来自铜阶段的原始数据。这个阶段也用<a class="ae ky" href="https://iceberg.apache.org/" rel="noopener ugc nofollow" target="_blank">阿帕奇冰山</a>。</li><li id="5a34" class="la lb in jm b jn lj jr lk jv ll jz lm kd ln kh lf lg lh li bi translated"><strong class="jm io">黄金</strong>数据阶段实现分析模型(维度、事实等。).我决定在这个阶段使用 Postgres 数据库。</li></ul><p id="5cd5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ngods 数据栈使用<a class="ae ky" href="https://www.getdbt.com/" rel="noopener ugc nofollow" target="_blank"> dbt </a>进行数据转换。dbt 在<a class="ae ky" href="https://spark.apache.org/" rel="noopener ugc nofollow" target="_blank"> Apache Spark </a>中执行 SQL，用于青铜级和白银级的数据转换。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lo"><img src="../Images/96f882f422c30749e2ee685b0e261d3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6w9jS0TaJem3Xx-zYmrBWQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Apache Spark 在青铜级和白银级数据阶段执行数据转换。</figcaption></figure><p id="8db9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">dbt 必须在白银和黄金数据阶段之间移动数据，因为黄金阶段使用 Postgres。我决定使用<a class="ae ky" href="https://trino.io/" rel="noopener ugc nofollow" target="_blank"> Trino </a>将 Apache Iceberg 和 Postgres 中的所有 medallion 数据阶段映射到一个数据库中的模式。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lp"><img src="../Images/593de32a8f8941a3c4828435549d48bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e8ChkPThzSTiFO9Q1t5YxQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Trino federates 访问所有 medallion 数据阶段。</figcaption></figure><p id="4063" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ngods 使用<a class="ae ky" href="https://dagster.io/" rel="noopener ugc nofollow" target="_blank"> Dagster </a>来编排数据仓库初始化、股票数据下载和 dbt 数据转换。我喜欢 Dragster 的 Python 代码的可扩展性。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lq"><img src="../Images/2cbd80f353a0624d4dff83a3958d2be0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qBEQkVn9hmr_E_SThR3htQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Dagster 编排。</figcaption></figure><p id="ccb6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我用<a class="ae ky" href="https://cube.dev/" rel="noopener ugc nofollow" target="_blank"> cube.dev </a>和<a class="ae ky" href="https://www.metabase.com/" rel="noopener ugc nofollow" target="_blank"> Metabase </a>构建了分析层。Cube.dev 公开了一个具有维度和指标的无头分析模型。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lr"><img src="../Images/791637c9d0cd03206e23bd2362430215.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E63rtJ69-GIDdtEl1uh1zg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Cube.dev 无头分析数据模型。</figcaption></figure><p id="45a6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">元数据库连接到此模型进行数据可视化(报告和仪表板)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ls"><img src="../Images/8196584b543d03f066bf36bb3f5231ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cBrhHh8iOlrXQM2ggLdKQA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">元数据库自助服务数据可视化。</figcaption></figure><p id="432e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我还用<a class="ae ky" href="https://jupyter.org/" rel="noopener ugc nofollow" target="_blank"> Jupyter 笔记本</a>进行未来股票走势的机器学习预测(ARIMA 时间序列模型)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lt"><img src="../Images/ebd42fbba9ec93063f5196359b7fa07a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DrAUWDuIC__fveyHLlR4Mw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">苹果(AAPL)股价走势预测与 ARIMA。</figcaption></figure><p id="3ceb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">您可以通过几个<a class="ae ky" href="https://github.com/zsvoboda/ngods-stocks" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io">快速步骤</strong> </a>运行此演示。</p></div></div>    
</body>
</html>