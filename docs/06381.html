<html>
<head>
<title>Automate “Last modified” dates in your documentation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自动化文档中的“最后修改”日期</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/automate-last-modified-dates-in-your-documentation-35ea367aee3?source=collection_archive---------22-----------------------#2022-01-03">https://blog.devgenius.io/automate-last-modified-dates-in-your-documentation-35ea367aee3?source=collection_archive---------22-----------------------#2022-01-03</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="c939" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">自动化重复的文档任务将消除人为错误，并保持文档的结构化。</h2></div><p id="f58c" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">本文的目的是解释如何自动更新XML数据，在本例中是最后修改日期。我的希望是，你可以利用这一点来建立自己的自动化，以提高自己工作的生产率和准确性。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi ky"><img src="../Images/22f546fdeb4482ab2fb0ba1bef836f7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4Gv41ByZlusuBkZ1"/></div></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk translated">由<a class="ae lo" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae lo" href="https://unsplash.com/@clemhlrdt?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Clément Hélardot </a>拍摄</figcaption></figure></div><div class="ab cl lp lq hr lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ig ih ii ij ik"><h2 id="055d" class="lw lx in bd ly lz ma dn mb mc md dp me kl mf mg mh kp mi mj mk kt ml mm mn mo bi translated">场景</h2><p id="aea1" class="pw-post-body-paragraph kc kd in ke b kf mp jo kh ki mq jr kk kl mr kn ko kp ms kr ks kt mt kv kw kx ig bi translated">假设您正在处理一个发布历史页面。发布历史有一部分包含每个API的最后修改。<br/>以下名为<code class="fe mu mv mw mx b">lastmodified.xml</code>的XML片段代表发布历史的结构化XML:</p><pre class="kz la lb lc gt my mx mz na aw nb bi"><span id="6871" class="lw lx in mx b gy nc nd l ne nf">&lt;file name="Release history"&gt;<br/>        &lt;update name="API01"&gt;<br/>                &lt;type&gt;Create&lt;/type&gt;<br/>                &lt;returns&gt;TXT&lt;/returns&gt;<br/>                &lt;maxSize&gt;1000&lt;/maxSize&gt;<br/>                &lt;lastModified&gt;2021-11-07&lt;/lastModified&gt;<br/>        &lt;/update&gt;<br/>        &lt;update name="API02"&gt;<br/>                &lt;type&gt;Update&lt;/type&gt;<br/>                &lt;returns&gt;TXT&lt;/returns&gt;<br/>                &lt;maxSize&gt;1000&lt;/maxSize&gt;<br/>                &lt;lastModified&gt;2021-10-29&lt;/lastModified&gt;<br/>        &lt;/update&gt;<br/>&lt;/file&gt;</span></pre><p id="7a42" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">一位开发人员已经指示您更新文档，使其达到API可以创建的最大大小，并从1000千字节更新到1400千字节。</p><h2 id="1548" class="lw lx in bd ly lz ma dn mb mc md dp me kl mf mg mh kp mi mj mk kt ml mm mn mo bi translated">复杂的情况</h2><p id="ca82" class="pw-post-body-paragraph kc kd in ke b kf mp jo kh ki mq jr kk kl mr kn ko kp ms kr ks kt mt kv kw kx ig bi translated">这个要求很简单。然而，开发者不确定他们什么时候会公开这个改变。<br/>您为最大尺寸更新准备您的更改。然后，在没有警告的情况下，您的开发人员通知您他们已经更新了API，您的文档也应该更新了。</p><p id="c9ea" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">恐慌模式来袭。你真的更新了你的文档吗？你还需要添加什么吗？上次修改日期是什么时候？</p><h2 id="0f29" class="lw lx in bd ly lz ma dn mb mc md dp me kl mf mg mh kp mi mj mk kt ml mm mn mo bi translated">解决方案</h2><p id="9e71" class="pw-post-body-paragraph kc kd in ke b kf mp jo kh ki mq jr kk kl mr kn ko kp ms kr ks kt mt kv kw kx ig bi translated">只需几行代码，您就可以自动更新您的“最后修改字段”,并帮助缓解一些恐慌。</p><p id="0c8a" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">将以下python文件添加到与XML文件相同的目录中:</p><pre class="kz la lb lc gt my mx mz na aw nb bi"><span id="0e6e" class="lw lx in mx b gy nc nd l ne nf">import xml.etree.ElementTree as ET<br/>from datetime import datetime<br/></span><span id="4925" class="lw lx in mx b gy ng nd l ne nf">class TimestampUpdater:<br/>    # Constructor<br/>    def __init__(self, filepath):<br/>        self.meta_file = filepath<br/>        self.tree = ET.parse(self.meta_file)</span><span id="0b91" class="lw lx in mx b gy ng nd l ne nf">    # To get xml data<br/>    def getMetadataTree(self):<br/>        return self.tree</span><span id="d91b" class="lw lx in mx b gy ng nd l ne nf">    # to get xml data root<br/>    def getMetadataRoot(self):<br/>        return self.tree.getroot()</span><span id="7bbe" class="lw lx in mx b gy ng nd l ne nf">    # to compare current date to lastmodified date<br/>    def updateLastModified(self):<br/>        today = datetime.now()<br/>        # add your XML paths here<br/>        for testfile in self.getMetadataRoot().findall("update"):<br/>            lastmodified = testfile.find("lastModified")<br/>            previous_update = datetime.strptime(lastmodified.text, "%Y-%m-%d")<br/>            if previous_update &lt; today:<br/>                lastmodified.text = today.strftime("%Y-%m-%d")<br/>                self.getMetadataTree().write(self.meta_file)<br/></span><span id="fcf4" class="lw lx in mx b gy ng nd l ne nf"># print lastmodified date to file<br/>def print_file_content(filename):<br/>    with open(filename, "r") as fh:<br/>        for line in fh:<br/>            print(line.rstrip())<br/></span><span id="2202" class="lw lx in mx b gy ng nd l ne nf"># print diff to console<br/>if __name__ == "__main__":<br/>    # rename your file name here<br/>    metafile = "lastmodified.xml"<br/>    print("\n====Before updating:====")<br/>    print_file_content(metafile)<br/>    updater = TimestampUpdater(metafile)<br/>    updater.updateLastModified()<br/>    print("\n====After updating:====")<br/>    print_file_content(metafile)</span></pre><p id="42fa" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">保存并运行您的python脚本来更新您的<code class="fe mu mv mw mx b">lastmodified.xml</code>文件。</p><p id="07b2" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">以下是输出示例:</p><pre class="kz la lb lc gt my mx mz na aw nb bi"><span id="74f2" class="lw lx in mx b gy nc nd l ne nf">&lt;file name="Release history"&gt;<br/>        &lt;update name="API01"&gt;<br/>                &lt;type&gt;Create&lt;/type&gt;<br/>                &lt;returns&gt;TXT&lt;/returns&gt;<br/>                &lt;maxSize&gt;1400&lt;/maxSize&gt;<br/>                <strong class="mx io">&lt;lastModified&gt;2022-01-03&lt;/lastModified&gt;</strong><br/>        &lt;/update&gt;<br/>        &lt;update name="API02"&gt;<br/>                &lt;type&gt;Update&lt;/type&gt;<br/>                &lt;returns&gt;TXT&lt;/returns&gt;<br/>                &lt;maxSize&gt;1400&lt;/maxSize&gt;<br/>                <strong class="mx io">&lt;lastModified&gt;2022-01-03&lt;/lastModified&gt;</strong><br/>        &lt;/update&gt;<br/>&lt;/file&gt;</span></pre><p id="dd21" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">XML属性被正确地更新为今天的日期。现在，您可以发布XML，而不必担心日期格式应用不正确、忘记关闭XML标记或某些内容已经过时。</p></div><div class="ab cl lp lq hr lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ig ih ii ij ik"><p id="cff9" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我知道你将如何在你自己的文档中利用自动化。我很乐意听到您使用的任何其他想法和工作流程。</p><h2 id="61d4" class="lw lx in bd ly lz ma dn mb mc md dp me kl mf mg mh kp mi mj mk kt ml mm mn mo bi translated">来源:</h2><p id="1a4c" class="pw-post-body-paragraph kc kd in ke b kf mp jo kh ki mq jr kk kl mr kn ko kp ms kr ks kt mt kv kw kx ig bi translated">我在这篇文章中使用了以下灵感来源:</p><ul class=""><li id="27e9" class="nh ni in ke b kf kg ki kj kl nj kp nk kt nl kx nm nn no np bi translated"><a class="ae lo" href="https://docs.python.org/3/library/datetime.html" rel="noopener ugc nofollow" target="_blank">日期时间</a>文档。</li><li id="43b9" class="nh ni in ke b kf nq ki nr kl ns kp nt kt nu kx nm nn no np bi translated"><a class="ae lo" href="https://docs.python.org/3/library/xml.etree.elementtree.html" rel="noopener ugc nofollow" target="_blank">元素树XML </a>文档。</li><li id="4ea0" class="nh ni in ke b kf nq ki nr kl ns kp nt kt nu kx nm nn no np bi translated"><a class="ae lo" href="https://stackoverflow.com/questions/63605557/updating-xml-node-value-using-the-condition-in-python" rel="noopener ugc nofollow" target="_blank">堆栈溢出</a>问答。</li></ul><p id="c942" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">你也可以使用我的<a class="ae lo" href="https://github.com/rachfop/Automate-Last-modified-dates/tree/main" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>来开始这篇文章。</p></div></div>    
</body>
</html>