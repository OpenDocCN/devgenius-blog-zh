<html>
<head>
<title>Using Python Pandas to turn ISO Country Codes into a string to use as values for a SQL Query</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python Pandas 将 ISO 国家代码转换成字符串，用作 SQL 查询的值</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/using-python-pandas-to-turn-iso-country-codes-into-a-string-to-use-as-values-for-a-sql-query-ad598bdd17d1?source=collection_archive---------2-----------------------#2022-12-09">https://blog.devgenius.io/using-python-pandas-to-turn-iso-country-codes-into-a-string-to-use-as-values-for-a-sql-query-ad598bdd17d1?source=collection_archive---------2-----------------------#2022-12-09</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><h1 id="f6f9" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">摘要、代码、资源</h1><h2 id="7610" class="ki jl in bd jm kj kk dn jq kl km dp ju kn ko kp jy kq kr ks kc kt ku kv kg kw bi translated">问题</h2><p id="8819" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh kn li lj lk kq ll lm ln kt lo lp lq lr ig bi translated">当使用 SQL 查询一个表(<a class="ae ls" href="https://data.worldbank.org/indicator/st.int.arvl" rel="noopener ugc nofollow" target="_blank">基于这个数据集</a>)时，您意识到您的一个列使用了 3 个字符的 ISO 国家代码。然而，除了<em class="lt">实际的</em>国家代码之外，这些 3 字符代码中的一些不是国家，而是地理区域或国家组。如何过滤掉行，只剩下国家<em class="lt">和</em>？</p><h2 id="5eae" class="ki jl in bd jm kj kk dn jq kl km dp ju kn ko kp jy kq kr ks kc kt ku kv kg kw bi translated">回答</h2><p id="ce50" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh kn li lj lk kq ll lm ln kt lo lp lq lr ig bi translated">使用 Python Pandas 库抓取 ISO 国家代码并将这些值转换成一个字符串。然后将该字符串用作后续 SQL 查询的值(可能如下所示):</p><pre class="lu lv lw lx gt ly lz ma bn mb mc bi"><span id="4869" class="md jl in lz b be me mf l mg mh">SELECT * FROM [your_table]<br/>WHERE country_code IN ([values from the generated list-as-string separated by commas and encased by single / double quotes]);</span></pre><h1 id="0f80" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">密码</h1><pre class="lu lv lw lx gt ly lz ma bn mb mc bi"><span id="cd94" class="md jl in lz b be me mf l mg mh"># Libraries used in this code<br/>from bs4 import BeautifulSoup<br/>import requests<br/>import csv <br/>import pandas as pd <br/><br/># I found these ISO country codes on the below URL. Pandas makes it easy to read HTML and manipulate it. Very cool!<br/>iso_codes = pd.read_html("https://www.iban.com/country-codes")<br/><br/># I create a data frame, starting at an index of 0.<br/>df = iso_codes[0]<br/><br/># But really, all I care about is the 3-digit country code. So I'll make that the df (dataframe) and strip out the index<br/>df = df['Alpha-3 code'].to_string(index=False)<br/><br/># From here, I'll save this little guy as a text file.<br/>with open("./countries.txt", "w") as f:<br/>    f.write(df)<br/><br/># I'll set up a list. *** This was my approach, but if you find a better way, feel free to comment or adjust. ***<br/>my_list = []<br/><br/># Then I'll open that text file and read it in.<br/>file = open("./countries.txt", "r")<br/>countries = file.read()<br/><br/># I need to remove the "new line" identifiers, so I'm doing that here. <br/>my_list = countries.split('\n')<br/><br/># Once I do that, I can create two new strings. I do this with f-Strings. Great article on using them here: https://realpython.com/python-f-strings/ <br/><br/># I have two options here: one where the codes are contained by single quotes, the other with double quotes. Oracle Autonomous Database likes single quotes, but your DB may differ.<br/><br/>countries_string_single_quotes = ','.join(f"'{x}'" for x in my_list)<br/><br/>countries_string_double_quotes = ','.join(f'"{x}"' for x in my_list)<br/><br/># From here, I take those strings and save them in a text file. You don't have to do this; you can print and copy/paste the string. But this might be an excellent addition if you want to refer to these later without running all the code. <br/><br/>with open("./countries_as_list_single_quotes.txt", "a") as f:<br/>    f.write(countries_string_single_quotes)<br/><br/>with open("./countries_as_list_double_quotes.txt", "a") as f:<br/>    f.write(countries_string_double_quotes)</span></pre><h2 id="a65c" class="ki jl in bd jm kj kk dn jq kl km dp ju kn ko kp jy kq kr ks kc kt ku kv kg kw bi translated">GitHub 回购详细信息</h2><p id="a7cd" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh kn li lj lk kq ll lm ln kt lo lp lq lr ig bi translated">你可以在我的<a class="ae ls" href="https://github.com/chrishoina/reddit" rel="noopener ugc nofollow" target="_blank"> GitHub 库</a>中找到这篇文章的代码。该存储库包括以下内容:</p><ul class=""><li id="0aac" class="mi mj in kz b la mk le ml kn mm kq mn kt mo lr mp mq mr ms bi translated">我为解决这个问题创建的<a class="ae ls" href="https://github.com/chrishoina/reddit/blob/main/iso_codes_pandas.py" rel="noopener ugc nofollow" target="_blank"> Python 代码</a></li><li id="016e" class="mi mj in kz b la mt le mu kn mv kq mw kt mx lr mp mq mr ms bi translated">一个<code class="fe my mz na lz b"><a class="ae ls" href="https://github.com/chrishoina/reddit/blob/main/countries.txt" rel="noopener ugc nofollow" target="_blank">countries.txt</a></code> <a class="ae ls" href="https://github.com/chrishoina/reddit/blob/main/countries.txt" rel="noopener ugc nofollow" target="_blank">文件</a>，在代码中途生成(用于以后处理的临时占位符)</li><li id="f2a6" class="mi mj in kz b la mt le mu kn mv kq mw kt mx lr mp mq mr ms bi translated"><a class="ae ls" href="https://github.com/chrishoina/reddit/blob/main/countries_as_list_single_quotes.txt" rel="noopener ugc nofollow" target="_blank">‘单引号’。txt 文件</a>—3 个字符的 ISO 国家代码被格式化为一个字符串。这些值用<strong class="kz io">单引号</strong>括起来；通篇逗号</li><li id="2c8c" class="mi mj in kz b la mt le mu kn mv kq mw kt mx lr mp mq mr ms bi translated"><a class="ae ls" href="https://github.com/chrishoina/reddit/blob/main/countries_as_list_double_quotes.txt" rel="noopener ugc nofollow" target="_blank">“双引号”。txt 文件</a>—3 个字符的 ISO 国家代码被格式化为一个字符串。这些值用<strong class="kz io">双引号</strong>括起来；通篇逗号</li></ul><h2 id="5df9" class="ki jl in bd jm kj kk dn jq kl km dp ju kn ko kp jy kq kr ks kc kt ku kv kg kw bi translated">资源</h2><ul class=""><li id="d065" class="mi mj in kz b la lb le lf kn nb kq nc kt nd lr mp mq mr ms bi translated"><a class="ae ls" href="https://www.reddit.com/r/datasets/comments/zehqsv/world_bank_tourism_dataset_how_to_remove/" rel="noopener ugc nofollow" target="_blank">最初的 Reddit 帖子</a>提示了这个帖子</li><li id="9d3f" class="mi mj in kz b la mt le mu kn mv kq mw kt mx lr mp mq mr ms bi translated"><a class="ae ls" href="https://www.iban.com/country-codes" rel="noopener ugc nofollow" target="_blank">ISO 国家代码列表</a>(又名“Alpha-3”)</li><li id="c84f" class="mi mj in kz b la mt le mu kn mv kq mw kt mx lr mp mq mr ms bi translated"><a class="ae ls" href="https://data.worldbank.org/indicator/st.int.arvl" rel="noopener ugc nofollow" target="_blank">世界银行国际旅游，到达人数图表</a>(是什么导致了这篇文章)</li></ul><p id="a753" class="pw-post-body-paragraph kx ky in kz b la mk lc ld le ml lg lh kn ne lj lk kq nf lm ln kt ng lp lq lr ig bi translated">计算机编程语言</p><ul class=""><li id="ed17" class="mi mj in kz b la mk le ml kn mm kq mn kt mo lr mp mq mr ms bi translated"><a class="ae ls" href="https://www.geeksforgeeks.org/how-to-read-text-file-into-list-in-python/" rel="noopener ugc nofollow" target="_blank">将一个. txt 文件读入一个列表</a></li><li id="7d99" class="mi mj in kz b la mt le mu kn mv kq mw kt mx lr mp mq mr ms bi translated"><a class="ae ls" href="https://stackoverflow.com/questions/64978308/remove-n-python-from-calling-a-txt-file" rel="noopener ugc nofollow" target="_blank">从文本文件中移除换行符(又名“\n”)</a></li><li id="5c14" class="mi mj in kz b la mt le mu kn mv kq mw kt mx lr mp mq mr ms bi translated"><a class="ae ls" href="https://stackoverflow.com/questions/12007686/join-a-list-of-strings-in-python-and-wrap-each-string-in-quotation-marks" rel="noopener ugc nofollow" target="_blank">使用 F 字符串迭代</a>(针对这种特殊情况)</li></ul><p id="4d84" class="pw-post-body-paragraph kx ky in kz b la mk lc ld le ml lg lh kn ne lj lk kq nf lm ln kt ng lp lq lr ig bi translated">熊猫</p><ul class=""><li id="1061" class="mi mj in kz b la mk le ml kn mm kq mn kt mo lr mp mq mr ms bi translated"><a class="ae ls" href="https://pbpython.com/pandas-html-table.html" rel="noopener ugc nofollow" target="_blank">用熊猫阅读 HTML 表格</a></li><li id="709d" class="mi mj in kz b la mt le mu kn mv kq mw kt mx lr mp mq mr ms bi translated"><a class="ae ls" href="https://pandas.pydata.org/docs/reference/api/pandas.read_html.html" rel="noopener ugc nofollow" target="_blank">熊猫</a> <code class="fe my mz na lz b"><a class="ae ls" href="https://pandas.pydata.org/docs/reference/api/pandas.read_html.html" rel="noopener ugc nofollow" target="_blank">read_html</a></code> <a class="ae ls" href="https://pandas.pydata.org/docs/reference/api/pandas.read_html.html" rel="noopener ugc nofollow" target="_blank">功能</a></li><li id="4bf6" class="mi mj in kz b la mt le mu kn mv kq mw kt mx lr mp mq mr ms bi translated"><a class="ae ls" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_string.html" rel="noopener ugc nofollow" target="_blank">熊猫数据帧</a> <code class="fe my mz na lz b"><a class="ae ls" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_string.html" rel="noopener ugc nofollow" target="_blank"> to_string </a></code> <a class="ae ls" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_string.html" rel="noopener ugc nofollow" target="_blank"> API </a></li></ul><p id="a491" class="pw-post-body-paragraph kx ky in kz b la mk lc ld le ml lg lh kn ne lj lk kq nf lm ln kt ng lp lq lr ig bi translated">结构化查询语言</p><ul class=""><li id="1ac1" class="mi mj in kz b la mk le ml kn mm kq mn kt mo lr mp mq mr ms bi translated"><a class="ae ls" href="https://docs.data.world/documentation/sql/concepts/intermediate/IN_and_NOT_IN.html" rel="noopener ugc nofollow" target="_blank">关于 IN 和 NOT IN 表达式的有用文章</a></li><li id="5151" class="mi mj in kz b la mt le mu kn mv kq mw kt mx lr mp mq mr ms bi translated"><a class="ae ls" href="https://swcarpentry.github.io/sql-novice-survey/03-filter/" rel="noopener ugc nofollow" target="_blank">数据库和用 SQL 过滤</a>文章</li></ul></div><div class="ab cl nh ni hr nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="ig ih ii ij ik"><h1 id="6379" class="jk jl in bd jm jn no jp jq jr np jt ju jv nq jx jy jz nr kb kc kd ns kf kg kh bi translated">深入了解</h1><h2 id="1f50" class="ki jl in bd jm kj kk dn jq kl km dp ju kn ko kp jy kq kr ks kc kt ku kv kg kw bi translated">背景</h2><p id="2477" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh kn li lj lk kq ll lm ln kt lo lp lq lr ig bi translated">前几天在 r/datasets 子编辑里偶然发现<a class="ae ls" href="https://redd.it/zehqsv" rel="noopener ugc nofollow" target="_blank">这个问题</a>:</p><figure class="lu lv lw lx gt nt"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="3ca7" class="pw-post-body-paragraph kx ky in kz b la mk lc ld le ml lg lh kn ne lj lk kq nf lm ln kt ng lp lq lr ig bi translated">我花了一上午的时间思考如何着手这件事，经过反复试验，我制定了一个计划。我决定获取 ISO 国家代码列表(我在这里找到了<a class="ae ls" href="https://www.iban.com/country-codes" rel="noopener ugc nofollow" target="_blank">和</a>)，并在 SQL 语句中使用它们作为过滤值(稍后在<a class="ae ls" href="https://www.oracle.com/database/sqldeveloper/technologies/db-actions/" rel="noopener ugc nofollow" target="_blank"> Oracle SQL Developer Web </a>)。</p><p id="3b9c" class="pw-post-body-paragraph kx ky in kz b la mk lc ld le ml lg lh kn ne lj lk kq nf lm ln kt ng lp lq lr ig bi translated">经过一些研究，我找到了成功查询的正确 SQL 语法。</p><pre class="lu lv lw lx gt ly lz ma bn mb mc bi"><span id="3d42" class="md jl in lz b be me mf l mg mh">SELECT * FROM [your_table]<br/>WHERE country_code IN ([values from the generated list-as-string separated by commas and encased by single / double quotes]);</span></pre><p id="b692" class="pw-post-body-paragraph kx ky in kz b la mk lc ld le ml lg lh kn ne lj lk kq nf lm ln kt ng lp lq lr ig bi translated">从那时起，我知道我需要逆向研究那些 ISO 国家代码。意思是我需要像这样的东西:</p><figure class="lu lv lw lx gt nt gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi nw"><img src="../Images/6bc43191c28e9f40a8247fc731795b34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8E6zo8oxQprD7KUgSCQxGg.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk translated">我感兴趣的国家代码列。</figcaption></figure><figure class="lu lv lw lx gt nt gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi oh"><img src="../Images/0b12403d8f79d32845efa9b29057108a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6DM1TYjI4kZoB0DzzkCdsQ.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk translated">查看这个表的 HTML，我对其中的元素感兴趣。</figcaption></figure><p id="be43" class="pw-post-body-paragraph kx ky in kz b la mk lc ld le ml lg lh kn ne lj lk kq nf lm ln kt ng lp lq lr ig bi translated">把它变成更可行的东西。事实证明，抓住这个非常简单。在这个练习中，我主要使用 Pandas，但是首先，我需要导入一些库:</p><pre class="lu lv lw lx gt ly lz ma bn mb mc bi"><span id="65d3" class="md jl in lz b be me mf l mg mh"># Libraries used in this code<br/>from bs4 import BeautifulSoup<br/>import requests<br/>import csv <br/>import pandas as pd </span></pre><p id="05c5" class="pw-post-body-paragraph kx ky in kz b la mk lc ld le ml lg lh kn ne lj lk kq nf lm ln kt ng lp lq lr ig bi translated">接下来我就用熊猫的<code class="fe my mz na lz b">read_html</code>函数(这个感觉像作弊，但是很不可思议)来读表。</p><pre class="lu lv lw lx gt ly lz ma bn mb mc bi"><span id="e2e7" class="md jl in lz b be me mf l mg mh"># I found these ISO country codes on the below URL. Pandas makes it easy to read HTML and manipulate it. Very cool!<br/>iso_codes = pd.read_html("https://www.iban.com/country-codes")<br/><br/># I create a data frame, starting at an index of 0.<br/>df = iso_codes[0]</span></pre><p id="1ea0" class="pw-post-body-paragraph kx ky in kz b la mk lc ld le ml lg lh kn ne lj lk kq nf lm ln kt ng lp lq lr ig bi translated">这很疯狂，但这是打印输出的样子:</p><figure class="lu lv lw lx gt nt gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi oi"><img src="../Images/edee62547cdcabd51394d16cdbe00611.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*57-IOgZLDRfT3RAE7hw4dQ.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk translated">熊猫<code class="fe my mz na lz b">read_html()</code>功能<em class="oj">强大</em>。</figcaption></figure><p id="5b52" class="pw-post-body-paragraph kx ky in kz b la mk lc ld le ml lg lh kn ne lj lk kq nf lm ln kt ng lp lq lr ig bi translated">如果你眯着眼睛，你可以在图像中看到一个“Alpha-2 代码”和一个“Alpha-3 代码”列。从这里，我需要分离出 3 代码列。所以我把数据框改造成了单列；删除索引(这是可选的，如果需要，可以保留索引；也许您想在数据库中创建一个单独的表)。</p><pre class="lu lv lw lx gt ly lz ma bn mb mc bi"><span id="758d" class="md jl in lz b be me mf l mg mh"># But really, all I care about is the 3-digit country code. So I'll make that the df (dataframe) and strip out the index<br/>df = df['Alpha-3 code'].to_string(index=False)</span></pre><p id="e273" class="pw-post-body-paragraph kx ky in kz b la mk lc ld le ml lg lh kn ne lj lk kq nf lm ln kt ng lp lq lr ig bi translated">我会将此数据框保存为. txt 文件。</p><pre class="lu lv lw lx gt ly lz ma bn mb mc bi"><span id="c571" class="md jl in lz b be me mf l mg mh"># From here, I'll save this little guy as a text file.<br/>with open("./countries.txt", "w") as f:<br/>    f.write(df)</span></pre><p id="a918" class="pw-post-body-paragraph kx ky in kz b la mk lc ld le ml lg lh kn ne lj lk kq nf lm ln kt ng lp lq lr ig bi translated">这只是暂时的(仅供参考:这是我能想出如何做到这一点的唯一方法)。它看起来会像这样:</p><figure class="lu lv lw lx gt nt gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi ok"><img src="../Images/0b6a06bbcb763cc54fbc408dc8f7d834.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vTvc3ypT9voDgDhRBNQu2A.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk translated">暂时的。3 字符 ISO 国家代码的 txt 文件。</figcaption></figure><p id="e217" class="pw-post-body-paragraph kx ky in kz b la mk lc ld le ml lg lh kn ne lj lk kq nf lm ln kt ng lp lq lr ig bi translated">接下来，我获取临时文本文件并读入它。我将把它添加到一个列表中，所以我将首先创建一个空列表(恰当地命名为“<code class="fe my mz na lz b">my_list</code>”)。我还需要从列表中删除换行符；否则，如果我不这样做，那么当我创建我的值的字符串(在最后一步中)时，该字符串将如下所示:</p><figure class="lu lv lw lx gt nt gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi ol"><img src="../Images/423358314486ad7cda1bf8191184379e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*skUTDJHlYvamuu_NvJI8qA.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk translated">带有“\n”字符的“国家”字符串。</figcaption></figure><p id="2c04" class="pw-post-body-paragraph kx ky in kz b la mk lc ld le ml lg lh kn ne lj lk kq nf lm ln kt ng lp lq lr ig bi translated">我用这段代码删除了换行符:</p><pre class="lu lv lw lx gt ly lz ma bn mb mc bi"><span id="1d3a" class="md jl in lz b be me mf l mg mh"># I need to remove the "new line" identifiers, so I'm doing that here. <br/>my_list = countries.split('\n')</span></pre><p id="ccef" class="pw-post-body-paragraph kx ky in kz b la mk lc ld le ml lg lh kn ne lj lk kq nf lm ln kt ng lp lq lr ig bi translated"><em class="lt">几乎是</em>的值串看起来像这样:</p><figure class="lu lv lw lx gt nt gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi oh"><img src="../Images/35c68141b26620b33c3f0f148aeda68e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dMo5NCKoMRKBOe09b6hNwA.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk translated">新的行字符现在已被删除。</figcaption></figure><p id="ac92" class="pw-post-body-paragraph kx ky in kz b la mk lc ld le ml lg lh kn ne lj lk kq nf lm ln kt ng lp lq lr ig bi translated">我使用 F-Strings 创建以下两个字符串:分别是<code class="fe my mz na lz b">countries_strings_single_quotes</code>和<code class="fe my mz na lz b">countries_strings_double_quotes</code>。需要学习 F 字符串(或者，更正式的说法是，<em class="lt">文字字符串插值</em>)？没问题！查看以下三个资源:</p><ul class=""><li id="d0d2" class="mi mj in kz b la mk le ml kn mm kq mn kt mo lr mp mq mr ms bi translated"><a class="ae ls" href="https://realpython.com/python-f-strings/" rel="noopener ugc nofollow" target="_blank">更实用的文章</a></li><li id="b7c7" class="mi mj in kz b la mt le mu kn mv kq mw kt mx lr mp mq mr ms bi translated"><a class="ae ls" href="https://peps.python.org/pep-0498/" rel="noopener ugc nofollow" target="_blank">更具技术性的摘要/提案</a></li><li id="71c8" class="mi mj in kz b la mt le mu kn mv kq mw kt mx lr mp mq mr ms bi translated"><a class="ae ls" href="https://docs.python.org/3/reference/lexical_analysis.html#f-strings" rel="noopener ugc nofollow" target="_blank">直接来自 Python 文档</a></li></ul><p id="4c78" class="pw-post-body-paragraph kx ky in kz b la mk lc ld le ml lg lh kn ne lj lk kq nf lm ln kt ng lp lq lr ig bi translated">F 弦的代码如下。我循环遍历我的 _list 并用逗号分隔 x(我正在迭代的东西)(这就是连接)。</p><pre class="lu lv lw lx gt ly lz ma bn mb mc bi"><span id="edea" class="md jl in lz b be me mf l mg mh"># Once I do that, I can create two new strings. I do this with f-Strings. Great article on using them here: https://realpython.com/python-f-strings/ <br/><br/># I have two options here: one where the codes are contained by single quotes, the other with double<br/># quotes. Oracle Autonomous Database likes single quotes, but your DB may differ.<br/><br/>countries_string_single_quotes = ','.join(f"'{x}'" for x in my_list)<br/><br/>countries_string_double_quotes = ','.join(f'"{x}"' for x in my_list)</span></pre><figure class="lu lv lw lx gt nt gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi oh"><img src="../Images/fd7506fef190cb076b632f37e6898771.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EXj6LkMg5KofsH1FAQppEw.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk translated">新的<em class="oj">单引号字符串。</em></figcaption></figure><figure class="lu lv lw lx gt nt gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi oh"><img src="../Images/b09a07807263f2b55e87a544f3327f1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BtJi1pEod9vP-SHIkbkNsA.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk translated">新的双引号字符串。</figcaption></figure><p id="a5b3" class="pw-post-body-paragraph kx ky in kz b la mk lc ld le ml lg lh kn ne lj lk kq nf lm ln kt ng lp lq lr ig bi translated">而现在我有了这两个对象(它们叫对象吗？？).我会将它们分别保存为文本文件。一个文件的 3 个字符的代码用单引号括起来，另一个用双引号括起来。代码:</p><pre class="lu lv lw lx gt ly lz ma bn mb mc bi"><span id="7862" class="md jl in lz b be me mf l mg mh"># From here, I take those strings and save them in a text file. You don't have to do this; you can print<br/># and copy/paste the string. But this might be a nice addition if you want to refer to these later <br/># without running all the code. <br/><br/>with open("./countries_as_list_single_quotes.txt", "a") as f:<br/>    f.write(countries_string_single_quotes)<br/><br/>with open("./countries_as_list_double_quotes.txt", "a") as f:<br/>    f.write(countries_string_double_quotes)</span></pre><p id="5969" class="pw-post-body-paragraph kx ky in kz b la mk lc ld le ml lg lh kn ne lj lk kq nf lm ln kt ng lp lq lr ig bi translated">文本文件现在看起来像这样:</p><figure class="lu lv lw lx gt nt gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi om"><img src="../Images/c1b47d08a541fdbaa5faa62561887037.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cUVxNgdFXaYqep3zZk1e5Q.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk translated">国家代码现在用一个长字符串表示。很酷，是吧？</figcaption></figure><h1 id="e759" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">SQL 时间</h1><p id="d958" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh kn li lj lk kq ll lm ln kt lo lp lq lr ig bi translated">我们到了！让你看看我现在能做什么！</p><p id="1c82" class="pw-post-body-paragraph kx ky in kz b la mk lc ld le ml lg lh kn ne lj lk kq nf lm ln kt ng lp lq lr ig bi translated">我从世界银行获取 CSV 数据，并将其加载到我的自治数据库中。我们回来的实习生蕾拉制作了一个视频，展示了如何做到这一点；你可以在这里查看:</p><figure class="lu lv lw lx gt nt"><div class="bz fp l di"><div class="on nv l"/></div></figure><p id="66c6" class="pw-post-body-paragraph kx ky in kz b la mk lc ld le ml lg lh kn ne lj lk kq nf lm ln kt ng lp lq lr ig bi translated">一旦我的表被创建，我就做了一个<code class="fe my mz na lz b">SELECT [columns] FROM</code>。在这里你可以看到我的“开始状态”。</p><figure class="lu lv lw lx gt nt gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi oo"><img src="../Images/a89f6c90c047cee0c84dc2396d69a822.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vkn9KAFFOm531M26BU67qg.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk translated">乍一看，这看起来不错。</figcaption></figure><figure class="lu lv lw lx gt nt gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi op"><img src="../Images/9fbad8ae7a749f51328d18d7a3882945.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yq-Te-FuMpOEfPXXAE0gRg.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk translated">但是一旦你向下滚动，你可以看到所有的非国家和地区。</figcaption></figure><p id="74e9" class="pw-post-body-paragraph kx ky in kz b la mk lc ld le ml lg lh kn ne lj lk kq nf lm ln kt ng lp lq lr ig bi translated">有 266 个条目；有些是国家，有些不是。如果你还记得的话，最初的问题问的是如何过滤掉非国家。下一个！</p><p id="7242" class="pw-post-body-paragraph kx ky in kz b la mk lc ld le ml lg lh kn ne lj lk kq nf lm ln kt ng lp lq lr ig bi translated">这是最精彩的部分。我可以将我创建的字符串用于 SQL 查询，如下所示:</p><pre class="lu lv lw lx gt ly lz ma bn mb mc bi"><span id="4154" class="md jl in lz b be me mf l mg mh">SELECT * from ADMIN.REDDIT_TABLE<br/>WHERE COUNTRY_CODE IN('AFG','ALA','ALB','DZA','ASM','AND','AGO','AIA','ATA',<br/>'ATG','ARG','ARM','ABW','AUS','AUT','AZE','BHS','BHR','BGD','BRB','BLR','BEL',<br/>'BLZ','BEN','BMU','BTN','BOL','BES','BIH','BWA','BVT','BRA','IOT','BRN','BGR',<br/>'BFA','BDI','CPV','KHM','CMR','CAN','CYM','CAF','TCD','CHL','CHN','CXR','CCK',<br/>'COL','COM','COD','COG','COK','CRI','CIV','HRV','CUB','CUW','CYP','CZE','DNK',<br/>'DJI','DMA','DOM','ECU','EGY','SLV','GNQ','ERI','EST','SWZ','ETH','FLK','FRO',<br/>'FJI','FIN','FRA','GUF','PYF','ATF','GAB','GMB','GEO','DEU','GHA','GIB','GRC',<br/>'GRL','GRD','GLP','GUM','GTM','GGY','GIN','GNB','GUY','HTI','HMD','VAT','HND',<br/>'HKG','HUN','ISL','IND','IDN','IRN','IRQ','IRL','IMN','ISR','ITA','JAM','JPN',<br/>'JEY','JOR','KAZ','KEN','KIR','PRK','KOR','KWT','KGZ','LAO','LVA','LBN','LSO',<br/>'LBR','LBY','LIE','LTU','LUX','MAC','MKD','MDG','MWI','MYS','MDV','MLI','MLT',<br/>'MHL','MTQ','MRT','MUS','MYT','MEX','FSM','MDA','MCO','MNG','MNE','MSR','MAR',<br/>'MOZ','MMR','NAM','NRU','NPL','NLD','NCL','NZL','NIC','NER','NGA','NIU','NFK',<br/>'MNP','NOR','OMN','PAK','PLW','PSE','PAN','PNG','PRY','PER','PHL','PCN','POL',<br/>'PRT','PRI','QAT','REU','ROU','RUS','RWA','BLM','SHN','KNA','LCA','MAF','SPM',<br/>'VCT','WSM','SMR','STP','SAU','SEN','SRB','SYC','SLE','SGP','SXM','SVK','SVN',<br/>'SLB','SOM','ZAF','SGS','SSD','ESP','LKA','SDN','SUR','SJM','SWE','CHE','SYR',<br/>'TWN','TJK','TZA','THA','TLS','TGO','TKL','TON','TTO','TUN','TUR','TKM','TCA',<br/>'TUV','UGA','UKR','ARE','GBR','UMI','USA','URY','UZB','VUT','VEN','VNM','VGB',<br/>'VIR','WLF','ESH','YEM','ZMB','ZWE')<br/>ORDER BY COUNTRY_CODE ASC;</span></pre><p id="9281" class="pw-post-body-paragraph kx ky in kz b la mk lc ld le ml lg lh kn ne lj lk kq nf lm ln kt ng lp lq lr ig bi translated">一旦我执行了 SQL 语句，就只剩下列表中的国家了。我在另一个窗口中打开了结果，这样您就可以看到一个样本。</p><figure class="lu lv lw lx gt nt gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi oq"><img src="../Images/af326cab265a5dab891bad8144795f86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YjLnqpqJ9U-_lBb2_huXJw.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk translated">运行中的 SQL 查询—使用新的字符串形式的值。</figcaption></figure><figure class="lu lv lw lx gt nt gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi or"><img src="../Images/150f5830881ed85cebae3cfd0d71d6f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NY1pCndovq5heQEvnh3FFw.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk translated">另一个窗口中的 SQL 查询结果。</figcaption></figure><h1 id="0485" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">结束了</h1><p id="4b0b" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh kn li lj lk kq ll lm ln kt lo lp lq lr ig bi translated">所以是的，就是这样！我不知道这是不是最好的方式，但这很有趣。我很好奇(如果你已经走了这么远)，你怎么看？你会怎么做？让我知道。</p><p id="cbea" class="pw-post-body-paragraph kx ky in kz b la mk lc ld le ml lg lh kn ne lj lk kq nf lm ln kt ng lp lq lr ig bi translated">还有两件事:记得分享这个和…</p><h1 id="b3a8" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">别忘了跟着</h1><p id="af87" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh kn li lj lk kq ll lm ln kt lo lp lq lr ig bi translated">如果您还没有分享或关注，请务必分享或关注:</p><ul class=""><li id="0d20" class="mi mj in kz b la mk le ml kn mm kq mn kt mo lr mp mq mr ms bi translated"><a class="ae ls" href="https://twitter.com/chrishoina" rel="noopener ugc nofollow" target="_blank">推特</a></li><li id="f5ef" class="mi mj in kz b la mt le mu kn mv kq mw kt mx lr mp mq mr ms bi translated"><a class="ae ls" href="https://www.youtube.com/user/chrishoina/" rel="noopener ugc nofollow" target="_blank"> YouTube </a></li><li id="037a" class="mi mj in kz b la mt le mu kn mv kq mw kt mx lr mp mq mr ms bi translated"><a class="ae ls" href="https://www.tiktok.com/@chrishoina" rel="noopener ugc nofollow" target="_blank">抖音</a></li><li id="d3b8" class="mi mj in kz b la mt le mu kn mv kq mw kt mx lr mp mq mr ms bi translated"><a class="ae ls" href="http://followthecoffee.com" rel="noopener ugc nofollow" target="_blank">博客</a></li><li id="7156" class="mi mj in kz b la mt le mu kn mv kq mw kt mx lr mp mq mr ms bi translated"><a class="ae ls" href="https://github.com/chrishoina" rel="noopener ugc nofollow" target="_blank"> GitHub </a></li><li id="c095" class="mi mj in kz b la mt le mu kn mv kq mw kt mx lr mp mq mr ms bi translated"><a class="ae ls" href="https://www.linkedin.com/in/chrishoina/" rel="noopener ugc nofollow" target="_blank">领英</a></li><li id="af1b" class="mi mj in kz b la mt le mu kn mv kq mw kt mx lr mp mq mr ms bi translated"><a class="ae ls" href="https://mastodon.technology/web/@chrishoina" rel="noopener ugc nofollow" target="_blank">乳齿象</a></li><li id="6eea" class="mi mj in kz b la mt le mu kn mv kq mw kt mx lr mp mq mr ms bi translated"><a class="ae ls" href="https://discord.gg/seYeAPgq9E" rel="noopener ugc nofollow" target="_blank">不和谐</a></li><li id="bbed" class="mi mj in kz b la mt le mu kn mv kq mw kt mx lr mp mq mr ms bi translated"><a class="ae ls" href="https://stackoverflow.com/users/9552864/chris-hoina" rel="noopener ugc nofollow" target="_blank">堆栈溢出</a></li></ul></div></div>    
</body>
</html>