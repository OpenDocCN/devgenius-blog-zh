<html>
<head>
<title>SQL Series: Perform Product Sales Analysis using SQL | Track Product Metrics &amp; Performance</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQL 系列:使用 SQL 执行产品销售分析|跟踪产品指标和性能</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/sql-series-perform-product-sales-analysis-using-sql-track-product-metrics-performance-f432358ad108?source=collection_archive---------4-----------------------#2022-06-12">https://blog.devgenius.io/sql-series-perform-product-sales-analysis-using-sql-track-product-metrics-performance-f432358ad108?source=collection_archive---------4-----------------------#2022-06-12</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="edf3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">使用 SQL </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e98558f677105142c3fbaea4dffc88c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7U7uFjmNVryLE-HdzLCPNw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">使用 SQL 进行产品分析</figcaption></figure><p id="e9f8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">产品销售分析有助于推动持续改进和增长。当我们分析产品销售数据并有效利用它时，整个团队就为成功做好了准备。分析产品销售数据至关重要，尤其是在提高产品性能和跟踪给定产品的预测时。它帮助我们确定表现最好的产品或功能，以及可能落后的产品或功能。花时间在你的数字上是至关重要的。它让我们能够定期找到提高产品销量的方法。它还能带来更准确的预测，这意味着我们的产品有更合适的规划和目标。</p><p id="d7b3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们用<em class="ky"> AdventureWorks </em>用 SQL 进行产品销售分析。让我们定义几个业务问题来帮助我们分析产品:</p><ul class=""><li id="978e" class="kz la in jm b jn jo jr js jv lb jz lc kd ld kh le lf lg lh bi translated">按产品划分的总销售额。</li><li id="40ae" class="kz la in jm b jn li jr lj jv lk jz ll kd lm kh le lf lg lh bi translated">收益好的 10 大产品。</li><li id="df97" class="kz la in jm b jn li jr lj jv lk jz ll kd lm kh le lf lg lh bi translated">生产成本最低的十大产品。</li><li id="6cc2" class="kz la in jm b jn li jr lj jv lk jz ll kd lm kh le lf lg lh bi translated">不同产品类别之间的销售额差异。</li></ul><p id="8043" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">相关视频教程可在<a class="ae ln" href="https://www.youtube.com/watch?v=fJpzn8nDCnw" rel="noopener ugc nofollow" target="_blank"> YouTube </a>上找到。</p><p id="b99d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在本练习中，我们将重点关注产品表和销售表。让我们创建一个数据库图表来突出显示我们将使用的表。让我们选择产品表，<em class="ky"> DimProduct </em>，<em class="ky"> DimProductCategory </em>，<em class="ky"> DimProductSubcategory </em>。除了产品，让我们引入<em class="ky"> FactInternetSales </em>。这包含我们产品的销售指标。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lo"><img src="../Images/a625f03a4802decb9b6867a00d141fb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_1QLkUNi7PJOVzSz26B8QQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">AdventureWorks 表概述</figcaption></figure><p id="92a6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将在分析中加入这些表，以获得业务问题的答案。所以，我们的第一个问题是按产品显示总销售额。这将有助于我们确定每种产品的销售额。所以，我们先从产品表中选择。我们将<em class="ky"> DimProduct </em>表连接到<em class="ky"> FactInternetSales </em>以获得销售额。我们将利用内部连接，然后在<em class="ky"> ProductKey </em>列上连接这些表。</p><pre class="kj kk kl km gt lp lq lr ls aw lt bi"><span id="5e96" class="lu lv in lq b gy lw lx l ly lz">Select<br/>	p.EnglishProductName AS product_name,<br/>	SUM(f.SalesAmount) AS sales_amount<br/>from DimProduct p<br/>inner join FactInternetSales f on p.ProductKey = f.ProductKey<br/>Group By p.EnglishProductName<br/>Order by SUM(f.SalesAmount) DESC</span></pre><p id="8a42" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了得到一个产品的总销售额，我们使用了一个名为<em class="ky"> SUM </em>的聚合函数。聚合函数对一组值执行计算，并返回单个值。当我们使用聚合函数时，我们必须使用 group by。<em class="ky"> GROUP BY </em>语句对产品名称行中具有相同值的行进行分组，例如，我们将得到一行“通用自行车架”产品以及销售额值。我们必须在 Group By 中列出没有聚合函数的列。我们使用实际的列名，而不是别名。</p><p id="0a0d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们可以回答第二个问题，对这个查询稍加修改。要获得销售额最高的前十种产品，我们可以使用前十个子句。除此之外，我们还可以指定 order by 子句。我们将按照销售额列以降序对结果集进行排序。下降的关键词是 DESC。让我们运行查询，我们得到销售额最高的前十个产品。</p><pre class="kj kk kl km gt lp lq lr ls aw lt bi"><span id="23af" class="lu lv in lq b gy lw lx l ly lz">Select top 10 <br/>	p.EnglishProductName AS product_name,<br/>	SUM(f.SalesAmount) AS sales_amount<br/>from DimProduct p<br/>inner join FactInternetSales f on p.ProductKey = f.ProductKey<br/>Group By p.EnglishProductName<br/>Order by SUM(f.SalesAmount) DESC</span></pre><p id="0c58" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">接下来是生产成本最低的十大产品。因此，我们可以保持该查询打开，并将销售额列与总产品成本交换。在这种情况下，我们需要成本最低的产品。因此，我们将使用关键字 ASC 按升序对 totalproductcost 查询进行排序</p><pre class="kj kk kl km gt lp lq lr ls aw lt bi"><span id="9505" class="lu lv in lq b gy lw lx l ly lz">Select top 10 <br/>	p.EnglishProductName AS product_name,<br/>	SUM(f.TotalProductCost) AS sales_amount<br/>from DimProduct p<br/>inner join FactInternetSales f on p.ProductKey = f.ProductKey<br/>Group By p.EnglishProductName<br/>Order by SUM(f.TotalProductCost) ASC</span></pre><p id="fc9f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这个查询给出了产品成本最低的前十种产品。</p><p id="94ff" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">对于下一个问题，我们将从产品转移到类别表。这是一个高层次的产品分组。因此，我们将获得销售的高级视图。如果你在 BI 工具中制作一个可视化的东西，那么它将是一个完美的候选。不管怎样，让我们添加产品子类别表。你可能会说，等等，我们正试图按产品类别显示销售额，那么我们为什么要添加子类别表呢？这是一个合理的问题。但是,“产品”表连接到“产品”子类别，而“子类别”表连接到类别。因此，我们在<em class="ky"> ProductSubCategoryKey </em>上连接产品表。然后，我们将产品类别表加入到<em class="ky"> ProductCategory </em>键的子类别中。我们已经有了 FactInternetSales<em class="ky">T5。因此，我们将销售额列带回来。让我们删除<em class="ky">前十个</em>子句，通过</em>子句固定<em class="ky">顺序，并使其降序排列。</em></p><pre class="kj kk kl km gt lp lq lr ls aw lt bi"><span id="038b" class="lu lv in lq b gy lw lx l ly lz">Select <br/>	pc.EnglishProductCategoryName AS product_category,<br/>        SUM(f.SalesAmount) AS total_sales<br/>From DimProduct p<br/>inner join DimProductSubcategory ps on p.ProductSubcategoryKey = ps.ProductSubcategoryKey<br/>inner join DimProductCategory pc on ps.ProductCategoryKey = pc.ProductCategoryKey<br/>inner join FactInternetSales f on f.ProductKey = p.ProductKey<br/>Group by pc.EnglishProductCategoryName<br/>Order by SUM(f.SalesAmount) DESC</span></pre><p id="d386" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">就这样了，伙计们。我们已经成功地回答了业务问题，并使用 SQL 进行了产品销售分析。我们按产品计算了销售额，并展示了表现最佳的产品。此外，我们以最低的生产成本提供顶级产品。最后，我们探讨了产品类别的表现。暂时就这些了。</p><p id="a22f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">结论</strong></p><ul class=""><li id="4439" class="kz la in jm b jn jo jr js jv lb jz lc kd ld kh le lf lg lh bi translated">我们使用 SQL 计算了产品的总销售额。</li><li id="1a76" class="kz la in jm b jn li jr lj jv lk jz ll kd lm kh le lf lg lh bi translated">我们已经成功地展示了销售额最高、生产成本最低的产品。</li><li id="07db" class="kz la in jm b jn li jr lj jv lk jz ll kd lm kh le lf lg lh bi translated">我们计算了不同产品类别的销售额。</li><li id="f3bd" class="kz la in jm b jn li jr lj jv lk jz ll kd lm kh le lf lg lh bi translated">完整的代码可以在<a class="ae ln" href="https://github.com/hnawaz007/pythondataanalysis/blob/main/SQL/Product%20Analysis%20using%20SQL.md" rel="noopener ugc nofollow" target="_blank">这里</a>找到</li></ul></div></div>    
</body>
</html>