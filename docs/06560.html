<html>
<head>
<title>Using Chart.js with React.js to create responsive line charts that show progress over time in reference to a goal.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Chart.js 和 React.js 创建响应式折线图，显示与目标相关的进度。</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/using-chart-js-with-react-to-create-a-line-chart-showing-progress-over-time-3e34377b1391?source=collection_archive---------2-----------------------#2022-01-17">https://blog.devgenius.io/using-chart-js-with-react-to-create-a-line-chart-showing-progress-over-time-3e34377b1391?source=collection_archive---------2-----------------------#2022-01-17</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div class="gh gi jk"><img src="../Images/f16d988dad8ce3ff2995f0560ab902ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*f3F3iQWZbvYsISbzwCqDZQ.png"/></div></figure><h1 id="c9c4" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">摘要</h1><p id="40f0" class="pw-post-body-paragraph kp kq in kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ig bi translated">这篇文章描述了如何使用 React.js、<a class="ae ln" href="https://www.chartjs.org/docs/latest/" rel="noopener ugc nofollow" target="_blank"> Chart.js </a>和<a class="ae ln" href="https://www.npmjs.com/package/react-chartjs-2" rel="noopener ugc nofollow" target="_blank"> react-chartjs-2 </a>创建一个类似于我在<a class="ae ln" href="https://lovely-nutrition-weight-loss.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">可爱的营养减肥跟踪器</a>中创建的折线图。它从用户那里接受一组签入对象。每个对象都包括带有相关日期的数据(重量)。该数据沿时间笛卡尔 x 轴绘制。</p><p id="9d7c" class="pw-post-body-paragraph kp kq in kr b ks lo ku kv kw lp ky kz la lq lc ld le lr lg lh li ls lk ll lm ig bi translated">类似这样的图表对于显示数据相对于预测或目标随时间的变化非常有用。它也有助于可视化两个或多个数据集之间的比较。</p><h1 id="03d2" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">应用程序的描述</h1><p id="3ebe" class="pw-post-body-paragraph kp kq in kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ig bi translated">我将首先描述图表所在的应用程序，然后描述如何创建图表。</p><h2 id="a16d" class="lt js in bd jt lu lv dn jx lw lx dp kb la ly lz kf le ma mb kj li mc md kn me bi translated">技术堆栈</h2><p id="402e" class="pw-post-body-paragraph kp kq in kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ig bi translated">它是一个 mono-repo 全栈应用程序，具有 Rails API 后端、Postgres 数据库和通过 Heroku 部署的 React.js 前端。</p><h2 id="2473" class="lt js in bd jt lu lv dn jx lw lx dp kb la ly lz kf le ma mb kj li mc md kn me bi translated">链接</h2><p id="275c" class="pw-post-body-paragraph kp kq in kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ig bi translated">下面是应用的链接:<a class="ae ln" href="https://lovely-nutrition-weight-loss.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">可爱的营养减肥追踪器</a></p><p id="daf8" class="pw-post-body-paragraph kp kq in kr b ks lo ku kv kw lp ky kz la lq lc ld le lr lg lh li ls lk ll lm ig bi translated">这里有一个<a class="ae ln" href="https://github.com/jsnidar/lovely-nutrition-weight-loss" rel="noopener ugc nofollow" target="_blank">链接</a>到 Github 上的回购。</p><h2 id="7f12" class="lt js in bd jt lu lv dn jx lw lx dp kb la ly lz kf le ma mb kj li mc md kn me bi translated">用户体验</h2><p id="5b50" class="pw-post-body-paragraph kp kq in kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ig bi translated">用户可以注册一个帐户，或者如果他们已经有一个帐户，他们可以登录到他们的帐户。一旦他们登录，用户可以创建一个签到，并输入他们的体重和日期。他们还可以创建带有开始日期、结束日期和目标权重的目标。当他们有一个签到和目标时，他们将在主屏幕上看到一个图表，在一个线形图上显示目标和他们朝着目标取得的进展。用户可以创建、编辑和删除目标和签入。</p><p id="f604" class="pw-post-body-paragraph kp kq in kr b ks lo ku kv kw lp ky kz la lq lc ld le lr lg lh li ls lk ll lm ig bi translated">这里有一个<a class="ae ln" href="https://watch.screencastify.com/v/W1fjBS6PIxBKOmXFbyQg" rel="noopener ugc nofollow" target="_blank">链接</a>到用户体验的视频演示。</p><h1 id="2edb" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">创建图表</h1><h2 id="361b" class="lt js in bd jt lu lv dn jx lw lx dp kb la ly lz kf le ma mb kj li mc md kn me bi translated">安装依赖项</h2><p id="fea8" class="pw-post-body-paragraph kp kq in kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ig bi translated">首先，我需要安装图表所需的库。我用的是 npm，但是你也可以用 CDN。</p><p id="bda9" class="pw-post-body-paragraph kp kq in kr b ks lo ku kv kw lp ky kz la lq lc ld le lr lg lh li ls lk ll lm ig bi translated"><strong class="kr io">如果您正在使用 Rails 创建一个 mono-repo 应用程序，您需要在安装这些依赖项之前将 cd 放入客户端文件夹，或者在每次安装一个依赖项时键入</strong> <code class="fe mf mg mh mi b"><strong class="kr io">--prefix client</strong></code> <strong class="kr io">(例如</strong> <code class="fe mf mg mh mi b"><strong class="kr io">npm install chart.js --prefix client</strong></code> <strong class="kr io">)。如果你有一个单独的后端和前端回购，那么你只需将它们安装在你的前端回购。</strong></p><p id="a01d" class="pw-post-body-paragraph kp kq in kr b ks lo ku kv kw lp ky kz la lq lc ld le lr lg lh li ls lk ll lm ig bi translated"><strong class="kr io">安装 Chart.js 和 react-chartjs-2 </strong></p><p id="b18f" class="pw-post-body-paragraph kp kq in kr b ks lo ku kv kw lp ky kz la lq lc ld le lr lg lh li ls lk ll lm ig bi translated"><code class="fe mf mg mh mi b">npm install --save react-chartjs-2 chart.js</code></p><p id="8f9c" class="pw-post-body-paragraph kp kq in kr b ks lo ku kv kw lp ky kz la lq lc ld le lr lg lh li ls lk ll lm ig bi translated">下面是<strong class="kr io">链接到</strong><a class="ae ln" href="https://www.chartjs.org/docs/latest/getting-started/installation.html" rel="noopener ugc nofollow" target="_blank"><strong class="kr io">chart . js</strong></a><strong class="kr io">和</strong><a class="ae ln" href="https://www.npmjs.com/package/react-chartjs-2" rel="noopener ugc nofollow" target="_blank"><strong class="kr io">react-chart js-2</strong></a><strong class="kr io">文档</strong>。我建议至少在继续之前扫描它们。如果熟悉<strong class="kr io"> Bootstrap </strong>和<strong class="kr io">React</strong><strong class="kr io">Bootstrap</strong>的话，chart.js 和 react-chartjs-2 的交互方式是一样的。React-chartjs-2 使导入组件变得快速简单，但是要定制这些组件，您需要遵循 Chart.js 文档。</p><p id="69c8" class="pw-post-body-paragraph kp kq in kr b ks lo ku kv kw lp ky kz la lq lc ld le lr lg lh li ls lk ll lm ig bi translated"><strong class="kr io">安装</strong><a class="ae ln" href="https://github.com/chartjs/chartjs-adapter-date-fns" rel="noopener ugc nofollow" target="_blank"><strong class="kr io">chart js-adapter-date-fns</strong></a><strong class="kr io">以便在 Chart.js. </strong>中使用一个 <a class="ae ln" href="https://www.chartjs.org/docs/latest/axes/cartesian/time.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kr io">时间笛卡尔轴</strong> </a> <strong class="kr io"/></p><p id="1226" class="pw-post-body-paragraph kp kq in kr b ks lo ku kv kw lp ky kz la lq lc ld le lr lg lh li ls lk ll lm ig bi translated"><code class="fe mf mg mh mi b">npm install date-fns chartjs-adapter-date-fns --save</code></p><p id="cdd2" class="pw-post-body-paragraph kp kq in kr b ks lo ku kv kw lp ky kz la lq lc ld le lr lg lh li ls lk ll lm ig bi translated">时间笛卡尔轴显示日期，因此数据之间的距离反映了两个数据点之间的时间。为了用 Chart.js 做到这一点，你需要一个日期库— <a class="ae ln" href="https://date-fns.org/" rel="noopener ugc nofollow" target="_blank"> date-fns </a> —和它安装的适配器—<a class="ae ln" href="https://github.com/chartjs/chartjs-adapter-date-fns" rel="noopener ugc nofollow" target="_blank">chart js-adapter-date-fns</a>。另外，在浏览器中处理日期和时间时，date-fns 是一个非常好的资源。如果你以前没有这样做过，把他们的网站加入书签，当你这样做的时候再回去看看，你不会后悔的！</p><h2 id="7543" class="lt js in bd jt lu lv dn jx lw lx dp kb la ly lz kf le ma mb kj li mc md kn me bi translated">导入依赖关系</h2><p id="a6c7" class="pw-post-body-paragraph kp kq in kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ig bi translated">现在我已经安装了我的依赖项，我创建了一个 GoalChart.js 文件，并将它们导入其中。</p><pre class="mj mk ml mm gt mn mi mo mp aw mq bi"><span id="19fa" class="lt js in mi b gy mr ms l mt mu">import {<br/>  Chart as ChartJS,<br/>  registerables,<br/>} from ‘chart.js’;<br/>import { Line } from ‘react-chartjs-2’;<br/>import ‘chartjs-adapter-date-fns’;<br/>import {enGB} from ‘date-fns/locale’;<br/>//this sets the display language. In the documentation it uses "de", which will display dates in German.<br/>ChartJS.register(…registerables);</span></pre><h2 id="02d9" class="lt js in bd jt lu lv dn jx lw lx dp kb la ly lz kf le ma mb kj li mc md kn me bi translated">返回图表组件</h2><pre class="mj mk ml mm gt mn mi mo mp aw mq bi"><span id="4f61" class="lt js in mi b gy mr ms l mt mu">return(<br/>  &lt;Container className="border border-secondary"&gt;<br/>    &lt;Row&gt;<br/>      &lt;Line<br/>        options={options}<br/>        data={data}<br/>        style={{vh:50}}<br/>        datasetIdKey="id"<br/>      /&gt;<br/>    &lt;/Row&gt;<br/>  &lt;/Container&gt;<br/>)</span></pre><p id="749a" class="pw-post-body-paragraph kp kq in kr b ks lo ku kv kw lp ky kz la lq lc ld le lr lg lh li ls lk ll lm ig bi translated">Line 组件像其他 react 组件一样工作，但是它接受选项、数据和样式作为道具。它还可以接受一个用于区分数据集的<code class="fe mf mg mh mi b">datasetIdKey</code>。</p><h2 id="4e60" class="lt js in bd jt lu lv dn jx lw lx dp kb la ly lz kf le ma mb kj li mc md kn me bi translated">时间笛卡尔轴的格式化图表选项</h2><p id="69c0" class="pw-post-body-paragraph kp kq in kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ig bi translated">图表使用一个<a class="ae ln" href="https://www.chartjs.org/docs/latest/general/options.html" rel="noopener ugc nofollow" target="_blank">选项对象</a>来自定义图表选项。我将只讨论特定于时间笛卡尔轴的选项。为了使用时间笛卡尔轴，我需要定制对象<code class="fe mf mg mh mi b">options.scales</code>中的 scales 关键点。<code class="fe mf mg mh mi b">options.scales</code>应该是这样的:</p><pre class="mj mk ml mm gt mn mi mo mp aw mq bi"><span id="8ac7" class="lt js in mi b gy mr ms l mt mu">scales: {<br/>  y: {<br/>    title: {display: true, text: “Weight in lbs”}<br/>  },<br/>  x: {<br/>    adapters: {<br/>      date: {locale: enGB},<br/>      type: “time”,<br/>      distribution: “linear”,<br/>      time: {<br/>        parser: “yyyy-MM-dd”,<br/>        unit: “month”<br/>      },<br/>      title: {<br/>        display: true,<br/>        text: “Date”<br/>      }<br/>    }<br/>  }<br/>},</span></pre><p id="15a5" class="pw-post-body-paragraph kp kq in kr b ks lo ku kv kw lp ky kz la lq lc ld le lr lg lh li ls lk ll lm ig bi translated">y 轴非常直。它将显示该轴的标题，该标题将是文本键处的字符串值。</p><p id="aa07" class="pw-post-body-paragraph kp kq in kr b ks lo ku kv kw lp ky kz la lq lc ld le lr lg lh li ls lk ll lm ig bi translated"><code class="fe mf mg mh mi b"><strong class="kr io">options.scales.x.adapters</strong></code></p><p id="09de" class="pw-post-body-paragraph kp kq in kr b ks lo ku kv kw lp ky kz la lq lc ld le lr lg lh li ls lk ll lm ig bi translated">x 刻度需要一个以这种方式格式化的 adapters 对象来使用时间笛卡尔轴。这是我用来设置它的文档。每个键上都有几个选项可供选择。以下是解释一些重要密钥的信息:</p><ul class=""><li id="301e" class="mv mw in kr b ks lo kw lp la mx le my li mz lm na nb nc nd bi translated"><code class="fe mf mg mh mi b">adapters.date.locale</code>设置日期显示的语言。在<a class="ae ln" href="https://github.com/chartjs/chartjs-adapter-date-fns#locale-support-via-scale-options" rel="noopener ugc nofollow" target="_blank">文档</a>中，他们使用<code class="fe mf mg mh mi b">locale: de</code>将日期语言设置为德语。我想要英语，所以我把它改成了<code class="fe mf mg mh mi b">enGB</code>。</li><li id="abe4" class="mv mw in kr b ks ne kw nf la ng le nh li ni lm na nb nc nd bi translated"><code class="fe mf mg mh mi b">adapters.time</code>设置日期显示时的格式。</li><li id="af62" class="mv mw in kr b ks ne kw nf la ng le nh li ni lm na nb nc nd bi translated"><code class="fe mf mg mh mi b">adapters.time.parser</code>可以定制，并遵循日期-fns 文档中的<a class="ae ln" href="https://date-fns.org/v2.28.0/docs/parse" rel="noopener ugc nofollow" target="_blank">解析参数。</a></li></ul><h2 id="4bc1" class="lt js in bd jt lu lv dn jx lw lx dp kb la ly lz kf le ma mb kj li mc md kn me bi translated">格式化数据对象</h2><p id="e3d5" class="pw-post-body-paragraph kp kq in kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ig bi translated">数据对象包含一个键<code class="fe mf mg mh mi b">datasets</code>，它保存一个数据集对象数组。</p><pre class="mj mk ml mm gt mn mi mo mp aw mq bi"><span id="2f29" class="lt js in mi b gy mr ms l mt mu">const data = {<br/>  datasets: [<br/>    {<br/>      label: ‘Check-Ins’,<br/>      data: goalCheckIns,<br/>      borderColor: ‘rgb(53, 162, 235)’,<br/>      backgroundColor: ‘rgba(53, 162, 235, 0.5)’,<br/>      showLine: true<br/>    },<br/>    {<br/>      label: ‘Goal’,<br/>      data: [<br/>        {x: startDate, y: currentWeight}, <br/>        {x: endDate, y: currentGoal.goal_weight}<br/>      ],<br/>      borderColor: ‘#FFCE0E’,<br/>      backgroundColor: ‘#FFCE0E’,<br/>      borderDash: [3]<br/>    }<br/>  ],<br/>};</span></pre><p id="7527" class="pw-post-body-paragraph kp kq in kr b ks lo ku kv kw lp ky kz la lq lc ld le lr lg lh li ls lk ll lm ig bi translated">每个数据集对象都有一个<code class="fe mf mg mh mi b">label</code>键，Chart.js 用它来区分数据集，类似于 React 使用的<code class="fe mf mg mh mi b">key</code>属性。<code class="fe mf mg mh mi b">data</code>键保存一个数据对象数组。其他键提供样式信息，如<code class="fe mf mg mh mi b">borderColor</code>。</p><p id="a361" class="pw-post-body-paragraph kp kq in kr b ks lo ku kv kw lp ky kz la lq lc ld le lr lg lh li ls lk ll lm ig bi translated">涉及日期的数据需要遵循以下格式:</p><figure class="mj mk ml mm gt jo gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/622baca0e24bdfab742289ff0de12b99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*2iynAiGhUrnrzKvsv1oXRw.png"/></div><figcaption class="nk nl gj gh gi nm nn bd b be z dk translated"><a class="ae ln" href="https://www.chartjs.org/docs/latest/general/data-structures.html#object" rel="noopener ugc nofollow" target="_blank">https://www . chart js . org/docs/latest/general/data-structures . html # object</a></figcaption></figure><p id="c610" class="pw-post-body-paragraph kp kq in kr b ks lo ku kv kw lp ky kz la lq lc ld le lr lg lh li ls lk ll lm ig bi translated"><code class="fe mf mg mh mi b">x</code>包含此格式的日期字符串，而<code class="fe mf mg mh mi b">y</code>包含为该日期绘制的值。在我的项目中，<code class="fe mf mg mh mi b">x</code>是用户签到的日期，<code class="fe mf mg mh mi b">y</code>是他们的体重。</p><h1 id="7bab" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">JavaScript 日期问题</h1><p id="2bde" class="pw-post-body-paragraph kp kq in kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ig bi translated">这种数据格式的问题是，根据您加载页面的时间，日期会以不同的方式显示，通常会相差一天。这是因为您需要考虑浏览器加载的时间。</p><h2 id="db70" class="lt js in bd jt lu lv dn jx lw lx dp kb la ly lz kf le ma mb kj li mc md kn me bi translated">将日期字符串转换为日期对象以控制时间</h2><p id="0413" class="pw-post-body-paragraph kp kq in kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ig bi translated">我重新格式化了代码，将每个日期字符串转换成一个日期对象。从数据库获取的日期数据以字符串形式出现(例如“2021–12–14”代表 2021 年 12 月 24 日)。当我以这种格式在图表中输入数据时，它并不准确，因为它将包括数据加载到组件中的时间。</p><p id="986e" class="pw-post-body-paragraph kp kq in kr b ks lo ku kv kw lp ky kz la lq lc ld le lr lg lh li ls lk ll lm ig bi translated">我通过调试发现，如果我使用这个语法<code class="fe mf mg mh mi b">new Date(year, monthIndex, day)</code>使用<a class="ae ln" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/Date" rel="noopener ugc nofollow" target="_blank"> Date()构造函数</a>，它解决了这个问题(例如。<code class="fe mf mg mh mi b">new Date(2021, 11, 24)</code>)。注意:月份是零索引的，所以 11 是第 12 个月。由于没有输入小于天的时间单位，因此每个时间被设置为上午 12:00。这样，当我加载数据时，时间会保持不变。</p><p id="b16d" class="pw-post-body-paragraph kp kq in kr b ks lo ku kv kw lp ky kz la lq lc ld le lr lg lh li ls lk ll lm ig bi translated">我想让我的代码保持干燥，所以我在 App.js 中声明了这些变量，并将它们作为道具发送到 GoalChart.js。</p><pre class="mj mk ml mm gt mn mi mo mp aw mq bi"><span id="1840" class="lt js in mi b gy mr ms l mt mu">const year = (date) =&gt; date.slice(0,4)<br/>const month = (date) =&gt; parseInt(date.slice(5,7)) - 1<br/>const day = (date) =&gt; date.slice(8,10)</span></pre><p id="b360" class="pw-post-body-paragraph kp kq in kr b ks lo ku kv kw lp ky kz la lq lc ld le lr lg lh li ls lk ll lm ig bi translated">对于<code class="fe mf mg mh mi b">month</code>,我需要将它转换成一个整数并减去 1，因为月份的索引是 0。</p><h2 id="5fcf" class="lt js in bd jt lu lv dn jx lw lx dp kb la ly lz kf le ma mb kj li mc md kn me bi translated">按日期对象排序</h2><p id="66b0" class="pw-post-body-paragraph kp kq in kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ig bi translated">我通过按日期对用户的目标数组进行排序并选择数组中的最后一个目标来选择当前目标。</p><pre class="mj mk ml mm gt mn mi mo mp aw mq bi"><span id="932f" class="lt js in mi b gy mr ms l mt mu">const currentGoal = currentUser.goals.sort(function(a,b){<br/>  return new Date(<br/>    year(a.goal_end_date),<br/>    month(a.goal_end_date),<br/>    day(a.goal_end_date)<br/>  ) - new Date(<br/>    year(b.goal_end_date),<br/>    month(b.goal_end_date),<br/>    day(b.goal_end_date)  <br/>  );<br/>})[currentUser.goals.length -1]</span></pre><p id="84e0" class="pw-post-body-paragraph kp kq in kr b ks lo ku kv kw lp ky kz la lq lc ld le lr lg lh li ls lk ll lm ig bi translated">然后，我将开始日期和结束日期保存到变量中。</p><pre class="mj mk ml mm gt mn mi mo mp aw mq bi"><span id="9745" class="lt js in mi b gy mr ms l mt mu">const startDate = new Date(<br/>  year(currentGoal.goal_start_date),<br/>  month(currentGoal.goal_start_date),<br/>  day(currentGoal.goal_start_date)<br/>)</span><span id="3e69" class="lt js in mi b gy no ms l mt mu">const endDate = new Date(<br/>  year(currentGoal.goal_end_date),<br/>  month(currentGoal.goal_end_date),<br/>  day(currentGoal.goal_end_date)<br/>)</span></pre><p id="11a6" class="pw-post-body-paragraph kp kq in kr b ks lo ku kv kw lp ky kz la lq lc ld le lr lg lh li ls lk ll lm ig bi translated">我用这些日期作为虚线目标趋势线的数据点。</p><pre class="mj mk ml mm gt mn mi mo mp aw mq bi"><span id="d296" class="lt js in mi b gy mr ms l mt mu">{<br/>  label: ‘Goal’,<br/>  data: [<br/>    {x: startDate, y: currentWeight}, <br/>    {x: endDate, y: currentGoal.goal_weight}<br/>  ],<br/>  borderColor: ‘#FFCE0E’,<br/>  backgroundColor: ‘#FFCE0E’,<br/>  borderDash: [3]<br/>}</span></pre><h2 id="1441" class="lt js in bd jt lu lv dn jx lw lx dp kb la ly lz kf le ma mb kj li mc md kn me bi translated">比较日期对象</h2><p id="f900" class="pw-post-body-paragraph kp kq in kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ig bi translated">当在 sort 方法之外比较两个 date 对象时，我试图使用这个逻辑，但它不起作用。所以经过一些搜索和调试，我决定使用<a class="ae ln" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/valueOf" rel="noopener ugc nofollow" target="_blank"> valueOf()方法</a>。</p><p id="6eab" class="pw-post-body-paragraph kp kq in kr b ks lo ku kv kw lp ky kz la lq lc ld le lr lg lh li ls lk ll lm ig bi translated">在后端，我没有创建一个连接表来关联签到和目标。我想保持灵活性，因为多个目标可以同时进行。</p><p id="87c5" class="pw-post-body-paragraph kp kq in kr b ks lo ku kv kw lp ky kz la lq lc ld le lr lg lh li ls lk ll lm ig bi translated">因此，我使用当前目标的日期范围来确定哪些签到符合目标。我声明了<code class="fe mf mg mh mi b">goalCheckIns</code>，并使用 forEach 将一个对象<code class="fe mf mg mh mi b">{x: checkIn.date, y: checkIn.weight}</code>推入数组。</p><pre class="mj mk ml mm gt mn mi mo mp aw mq bi"><span id="b497" class="lt js in mi b gy mr ms l mt mu">let goalCheckIns = []<br/>currentUser.check_ins.forEach(checkIn =&gt; {<br/>  const checkInDate = new Date(<br/>    year(checkIn.date),<br/>    month(checkIn.date),<br/>    day(checkIn.date)<br/>  )<br/>  if(<br/>    checkInDate.valueOf() &gt;= startDate.valueOf() &amp;&amp;<br/>    checkInDate.valueOf() &lt;= endDate.valueOf()<br/>  ){<br/>    goalCheckIns.push({x: checkIn.date, y: checkIn.weight})<br/>  }<br/>})</span></pre><p id="4391" class="pw-post-body-paragraph kp kq in kr b ks lo ku kv kw lp ky kz la lq lc ld le lr lg lh li ls lk ll lm ig bi translated">然后，我把它们按日期分类。</p><pre class="mj mk ml mm gt mn mi mo mp aw mq bi"><span id="45b6" class="lt js in mi b gy mr ms l mt mu">goalCheckIns = goalCheckIns.sort(function(a,b){<br/>  return new Date(a.x.valueOf()) - new Date(b.x.valueOf());<br/>})</span></pre><p id="c536" class="pw-post-body-paragraph kp kq in kr b ks lo ku kv kw lp ky kz la lq lc ld le lr lg lh li ls lk ll lm ig bi translated">现在，图表完全正常，并显示了与目标相关的正确日期！</p><h1 id="6f59" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">结论</h1><p id="6a70" class="pw-post-body-paragraph kp kq in kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ig bi translated">使用这些方法，我能够绘制一个在时间笛卡尔轴上有两条线的折线图。我希望这篇教程也能帮助你做到这一点！</p></div></div>    
</body>
</html>