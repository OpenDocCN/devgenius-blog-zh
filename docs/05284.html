<html>
<head>
<title>How to Get the Coordinates of a Mouse Click on a Canvas Element?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何获取鼠标点击画布元素的坐标？</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-get-the-coordinates-of-a-mouse-click-on-a-canvas-element-d5dc288c19e8?source=collection_archive---------2-----------------------#2021-07-13">https://blog.devgenius.io/how-to-get-the-coordinates-of-a-mouse-click-on-a-canvas-element-d5dc288c19e8?source=collection_archive---------2-----------------------#2021-07-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/aa8fef7de29b6b207ac380ab5dca9183.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IrWmrAo22mXYl9E-"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@sweetmangostudios?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Ricky Kharawala </a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="66b3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有时，我们可能想获得鼠标在HTML画布元素上的坐标。</p><p id="59d0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究如何获取鼠标点击画布元素的坐标。</p><h1 id="447d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">添加mousedown事件处理程序</h1><p id="b828" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以从从<code class="fe me mf mg mh b">mousedown</code>事件处理程序获得的事件对象中获得鼠标点击的坐标。</p><p id="c833" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以编写以下HTML:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="2266" class="mq lc iq mh b gy mr ms l mt mu">&lt;canvas style="width: 200px; height: 100px"&gt;<br/>&lt;/canvas&gt;</span></pre><p id="7b29" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以编写下面的JavaScript代码:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="695e" class="mq lc iq mh b gy mr ms l mt mu">const canvas = document.querySelector('canvas')<br/>const ctx = canvas.getContext("2d");<br/>ctx.moveTo(0, 0);<br/>ctx.lineTo(200, 100);<br/>ctx.stroke();</span><span id="1e45" class="mq lc iq mh b gy mv ms l mt mu">const getCursorPosition = (canvas, event) =&gt; {<br/>  const rect = canvas.getBoundingClientRect()<br/>  const x = event.clientX - rect.left<br/>  const y = event.clientY - rect.top<br/>  console.log(x, y)<br/>}</span><span id="1037" class="mq lc iq mh b gy mv ms l mt mu">canvas.addEventListener('mousedown', (e) =&gt; {<br/>  getCursorPosition(canvas, e)<br/>})</span></pre><p id="eece" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们添加一个宽200像素，高100像素的画布元素。</p><p id="c729" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们用<code class="fe me mf mg mh b">document.querySelector</code>方法得到画布元素。</p><p id="f57b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们用<code class="fe me mf mg mh b">getContext</code>方法得到画布的上下文。</p><p id="1f47" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们调用<code class="fe me mf mg mh b">moveTo</code>将光标移动到给定的x，y坐标。</p><p id="5e3c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们称<code class="fe me mf mg mh b">lineTo</code>为给定的x，y坐标画一条线。</p><p id="0313" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们调用<code class="fe me mf mg mh b">stroke</code>来画线。</p><p id="6c9b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们创建<code class="fe me mf mg mh b">getCursorPosition</code>函数来获取画布和事件参数。</p><p id="7eed" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们调用<code class="fe me mf mg mh b">canvas.getBoundingClientRect</code>来获取<code class="fe me mf mg mh b">rect</code>对象，该对象具有<code class="fe me mf mg mh b">left</code>和<code class="fe me mf mg mh b">top</code>属性来获取左上角的x和y坐标。</p><p id="1d2f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们从拥有我们点击的屏幕的鼠标坐标的<code class="fe me mf mg mh b">event.clientX</code>和<code class="fe me mf mg mh b">event.clientY</code>属性中减去这个值。</p><p id="54c8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，<code class="fe me mf mg mh b">x</code>和<code class="fe me mf mg mh b">y</code>拥有我们在画布上点击的鼠标坐标。</p><p id="78e7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们调用<code class="fe me mf mg mh b">canvas.addEventListener</code>来添加<code class="fe me mf mg mh b">mousedown</code>事件监听器。</p><p id="f9cf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在其中，我们调用<code class="fe me mf mg mh b">getCursorPosition</code>来获取我们在画布上单击的鼠标坐标并记录下来。</p><p id="7a4e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">x</code>和<code class="fe me mf mg mh b">y</code>以像素为单位。</p><p id="1793" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以从<code class="fe me mf mg mh b">event</code>对象中获取<code class="fe me mf mg mh b">offsetX</code>和<code class="fe me mf mg mh b">offsetY</code>属性，以获得我们单击的画布的坐标。</p><p id="e0c6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="2c5a" class="mq lc iq mh b gy mr ms l mt mu">const canvas = document.querySelector('canvas')<br/>const ctx = canvas.getContext("2d");<br/>ctx.moveTo(0, 0);<br/>ctx.lineTo(200, 100);<br/>ctx.stroke();</span><span id="ad24" class="mq lc iq mh b gy mv ms l mt mu">const getCursorPosition = (canvas, event) =&gt; {<br/>  const x = event.offsetX<br/>  const y = event.offsetY<br/>  console.log(x, y)<br/>}</span><span id="55af" class="mq lc iq mh b gy mv ms l mt mu">canvas.addEventListener('mousedown', (e) =&gt; {<br/>  getCursorPosition(canvas, e)<br/>})</span></pre><p id="a35a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">不用计算就能得到鼠标坐标。</p><h1 id="4a23" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="0058" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用来自<code class="fe me mf mg mh b">mousedown</code>事件对象的一些属性获得我们在画布上点击的位置的鼠标坐标。</p></div></div>    
</body>
</html>