<html>
<head>
<title>Install packages from GitHub Packages in CI/CD</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从CI/CD中的GitHub包安装包</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/install-packages-from-github-packages-in-ci-cd-9a0c8d463375?source=collection_archive---------8-----------------------#2021-11-26">https://blog.devgenius.io/install-packages-from-github-packages-in-ci-cd-9a0c8d463375?source=collection_archive---------8-----------------------#2021-11-26</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="3577" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">在CI/CD中安装定制软件包的解决方案</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/7fa7fe16e3aa7332494186465d6c93f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YrFclRUNquhahpGm"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated"><a class="ae ks" href="https://unsplash.com/@bochelly?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">博凯利</a>先生在<a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="d096" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我认为每个团队之前都面临这个问题，我们在GitHub上找到了一个很棒的库，但它并不能100%满足团队要求。有些团队会选择分叉它，定制它并发布在GitHub包中。</p><p id="0f06" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这是一个很好的解决方案，但新的问题是，如何在您的团队CI/CD流程中安装这个定制的包？</p></div><div class="ab cl lp lq hr lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ig ih ii ij ik"><p id="29c9" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这个问题的要点是:</p><p id="9c98" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">如何解决GitHub包要求的认证？</strong></p><ol class=""><li id="7cdd" class="lw lx in kv b kw kx kz la lc ly lg lz lk ma lo mb mc md me bi translated">从GitHub安装包需要一个访问令牌。无论公私。<br/>可以查看这个<a class="ae ks" href="https://github.community/t/download-from-github-package-registry-without-authentication/14407/135" rel="noopener ugc nofollow" target="_blank">讨论</a>。</li><li id="8520" class="lw lx in kv b kw mf kz mg lc mh lg mi lk mj lo mb mc md me bi translated">对CI/CD中的GitHub包进行身份验证。</li></ol><p id="c714" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在这种情况下，我将展示GitLab Runner的解决方案，但我认为该解决方案对其他CI/CD服务也很有效。</p></div><div class="ab cl lp lq hr lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ig ih ii ij ik"><h1 id="9546" class="mk ml in bd mm mn mo mp mq mr ms mt mu jt mv ju mw jw mx jx my jz mz ka na nb bi translated">生成访问令牌</h1><p id="2d8e" class="pw-post-body-paragraph kt ku in kv b kw nc jo ky kz nd jr lb lc ne le lf lg nf li lj lk ng lm ln lo ig bi translated">正如我们在上一节中分析的那样，我们需要一个访问令牌。</p><p id="3851" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">所以首先打开GitHub，进入开发者设置页面。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nh"><img src="../Images/7c61445a105ed18884bdbbc8d07b83fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6aYW5w2bm73JX1ld860X9A.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">开发者设置页面</figcaption></figure><p id="606b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">然后，单击“生成新令牌”。您应该会看到如下图所示的页面。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ni"><img src="../Images/acae54256c19eaa53b31f5d27aa4cc67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*krQFItH_PWSd6lf5JZQxQQ.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">新建个人访问令牌页面</figcaption></figure><p id="4017" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们需要的唯一功能是“读取:包”。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nj"><img src="../Images/ae34c2ff267673518a5f2f938f55c6d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_lbzImxRT2JWn3Cmn08PGw.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">新令牌已生成！</figcaption></figure><p id="26c8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在我们得到了新的访问令牌！我建议备份这个令牌，因为这是唯一一次看到它的机会。</p><h1 id="5378" class="mk ml in bd mm mn nk mp mq mr nl mt mu jt nm ju mw jw nn jx my jz no ka na nb bi translated">设置CI/CD环境变量</h1><p id="b7b2" class="pw-post-body-paragraph kt ku in kv b kw nc jo ky kz nd jr lb lc ne le lf lg nf li lj lk ng lm ln lo ig bi translated">CI/CD环境变量允许我们将访问令牌传递给容器。(或者您可以在映像或容器配置中进行硬编码，但实际上..？</p><p id="cba4" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在这种情况下，我们将这个变量命名为“GITHUB _ PKG _令牌”。值请设置如下</p><pre class="kd ke kf kg gt np nq nr ns aw nt bi"><span id="f4e7" class="nu ml in nq b gy nv nw l nx ny">//npm.pkg.github.com/:_authToken=YOUR_TOKEN</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nz"><img src="../Images/ca8d92a683ce71add9a39f3a21e80316.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KnjjFDFZDKHsxACCjKHMDw.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">CI/CD环境设置页面</figcaption></figure><p id="8016" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">出于安全原因，请记住在CI/CD日志中屏蔽您访问令牌。</p><h1 id="cf8d" class="mk ml in bd mm mn nk mp mq mr nl mt mu jt nm ju mw jw nn jx my jz no ka na nb bi translated">创建并配置。CI/CD容器中的npmrc</h1><p id="a31c" class="pw-post-body-paragraph kt ku in kv b kw nc jo ky kz nd jr lb lc ne le lf lg nf li lj lk ng lm ln lo ig bi translated">现在我们能够在CI/CD容器中获得访问密钥，我们需要做的就是创建。带有访问令牌npmrc。</p><p id="cf04" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在本例中，这个CI/CD进程使用基于Linux的映像节点:16。</p><p id="8cb7" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">因此，我们应该在您的业务逻辑之前运行下面的脚本。</p><pre class="kd ke kf kg gt np nq nr ns aw nt bi"><span id="f81f" class="nu ml in nq b gy nv nw l nx ny">- touch ~/.npmrc<br/>- printf "$GITHUB_PKG_TOKEN" &gt;&gt; ~/.npmrc</span></pre><p id="9955" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">搞定了。享受您的定制套餐！</p></div><div class="ab cl lp lq hr lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ig ih ii ij ik"><p id="213e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">虽然这篇文章描述了如何处理GitHub包，但是你可以将这个解决方案用于所有其他需要认证来安装包的平台。</p><p id="ad36" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">感谢观看！请关注我在<a class="ae ks" href="https://ckmo.me" rel="noopener ugc nofollow" target="_blank">我的作品集网站</a>的更新。</p></div><div class="ab cl lp lq hr lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ig ih ii ij ik"><p id="63a3" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="oa">更多内容尽在</em><a class="ae ks" href="http://blog.devgenius.io" rel="noopener ugc nofollow" target="_blank"><em class="oa">blog . dev genius . io</em></a><em class="oa">。</em></p></div></div>    
</body>
</html>