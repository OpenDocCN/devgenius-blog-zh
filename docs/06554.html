<html>
<head>
<title>How to Automate Cloud Governance on Azure?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在 Azure 上自动化云治理？</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-automate-cloud-governance-on-azure-f392bd971f2f?source=collection_archive---------9-----------------------#2022-01-16">https://blog.devgenius.io/how-to-automate-cloud-governance-on-azure-f392bd971f2f?source=collection_archive---------9-----------------------#2022-01-16</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="9464" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">本博客是系列文章的一部分，我们从零起点开始为初学者讨论<strong class="jm io"> DevOps </strong>概念。本文来自<em class="ki">中级</em>系列，因为它涉及了解<strong class="jm io">A</strong><a class="ae kj" href="https://docs.microsoft.com/en-us/azure/governance/policy/overview" rel="noopener ugc nofollow" target="_blank"><strong class="jm io">zure Policy</strong></a><strong class="jm io"/>服务的工作，以确保客户 Azure 账户中创建的资源的合规性。</p><p id="ec2b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">云系列的一些早期博客如下。</p><p id="2da1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae kj" rel="noopener ugc nofollow" target="_blank" href="/building-a-simple-fraud-detector-on-aws-7d01f0259fa8"><strong class="jm io">AWS 欺诈检测</strong></a><strong class="jm io"><br/></strong><a class="ae kj" rel="noopener ugc nofollow" target="_blank" href="/aws-config-iam-compliance-85220763bee5"><strong class="jm io">安全-自动化</strong></a><strong class="jm io"><br/></strong><a class="ae kj" rel="noopener ugc nofollow" target="_blank" href="/custom-docker-bridge-networks-how-to-run-containers-b8d40c51bab2"><strong class="jm io">定制码头桥网</strong> </a></p><h1 id="a656" class="kk kl in bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">什么是 Azure 保单？</h1><p id="0a6c" class="pw-post-body-paragraph jk jl in jm b jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc kd lm kf kg kh ig bi translated">Azure Policy 是一项全面管理的 Azure 服务，为客户提供了一个即插即用的模型，以便为在<a class="ae kj" href="https://www.javatpoint.com/what-is-microsoft-azure-subscription" rel="noopener ugc nofollow" target="_blank"> <em class="ki">订阅</em> </a> <em class="ki">、</em> <a class="ae kj" href="https://docs.microsoft.com/en-us/azure/governance/azure-management" rel="noopener ugc nofollow" target="_blank"> <em class="ki">管理组</em> </a>或<em class="ki"/>T42<em class="ki">资源组</em> 范围内创建的资源创建可重用的合规性策略。该服务支持已有<strong class="jm io">内置策略</strong>和<strong class="jm io">自定义策略</strong>，可根据用户定义的范围和嵌套条件进行扩展。该服务对其所有用户都有一个<a class="ae kj" href="https://azure.microsoft.com/en-us/pricing/details/azure-policy/?WT.mc_id=thomasmaurer-blog-thmaure" rel="noopener ugc nofollow" target="_blank"> <em class="ki">免费定价模型</em> <strong class="jm io"> </strong> </a>，使得安全模块处于所有自动化框架的最前沿。</p><h2 id="805a" class="ln kl in bd km lo lp dn kq lq lr dp ku jv ls lt ky jz lu lv lc kd lw lx lg ly bi translated">保单定义和分配</h2><p id="59b4" class="pw-post-body-paragraph jk jl in jm b jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc kd lm kf kg kh ig bi translated">一个完整的 Azure 策略的生命周期有两个关键步骤——在帐户中触发自动合规之前的<strong class="jm io">定义</strong>和<strong class="jm io">分配</strong>。这种关系是一对多的，即一个定义可以被重新分配 N 次。一个<strong class="jm io">策略定义</strong>是一组实施效果<a class="ae kj" href="https://docs.microsoft.com/en-us/azure/governance/policy/concepts/effects" rel="noopener ugc nofollow" target="_blank">审核/拒绝/附加/修改</a>的条件。通过<strong class="jm io">策略分配</strong>步骤来为要发生的策略效果分配资源范围。</p><h1 id="2f89" class="kk kl in bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">Azure 策略自动化概述</h1><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi lz"><img src="../Images/59f7c2d153f63134f9ea5fd2ad564739.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*utwWTu7fq1C6UYjsJWwcKg.png"/></div></div><figcaption class="ml mm gj gh gi mn mo bd b be z dk translated"><strong class="bd km"> Azure 策略生命周期</strong></figcaption></figure><h2 id="a22a" class="ln kl in bd km lo lp dn kq lq lr dp ku jv ls lt ky jz lu lv lc kd lw lx lg ly bi translated">内置策略示例</h2><p id="5ce8" class="pw-post-body-paragraph jk jl in jm b jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc kd lm kf kg kh ig bi translated"><strong class="jm io"> SKU 限制</strong> - <br/>该政策旨在限制开发者创建与虚拟机可用的任何 SKU 选项无关的资源。这种实施有助于降低更高 SKU 的云成本，并通过最大限度地减少虚拟机配置的变化来优化运营支持。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi mp"><img src="../Images/74529fcf3ba4ef2cfbe0d8e681966983.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m0-QVNWMFTtQxEsQ6Ma9WQ.png"/></div></div><figcaption class="ml mm gj gh gi mn mo bd b be z dk translated"><strong class="bd km">虚拟机 SKU 受到 Azure 策略的限制</strong></figcaption></figure><h2 id="93e5" class="ln kl in bd km lo lp dn kq lq lr dp ku jv ls lt ky jz lu lv lc kd lw lx lg ly bi translated">自定义策略示例</h2><p id="bafc" class="pw-post-body-paragraph jk jl in jm b jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc kd lm kf kg kh ig bi translated"><strong class="jm io">位置限制</strong> - <br/>云部署模型中的资源位置对于解决邻近性和性能需求非常关键。因此，建议将所有资源保存在靠近实际客户的有限区域内。该策略有助于在资源组中创建的所有资源上实施相同的策略。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi mq"><img src="../Images/b81e0cc9be74876dc801abce96d12edb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LBeoBKQcvBLi47oLDyCAlA.png"/></div></div><figcaption class="ml mm gj gh gi mn mo bd b be z dk translated"><strong class="bd km">位置策略执行。</strong></figcaption></figure><h1 id="909f" class="kk kl in bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">Azure 策略平台自动化</h1><h2 id="41cc" class="ln kl in bd km lo lp dn kq lq lr dp ku jv ls lt ky jz lu lv lc kd lw lx lg ly bi translated">安装 Terraform</h2><p id="0d4d" class="pw-post-body-paragraph jk jl in jm b jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc kd lm kf kg kh ig bi translated">使用给定博客中的步骤—<a class="ae kj" rel="noopener ugc nofollow" target="_blank" href="/public-cloud-first-static-website-7d6f7c6f794">https://blog . dev genius . io/public-cloud-first-static-website-7d 6 f 7 c 6 f 794</a></p><h2 id="c5f7" class="ln kl in bd km lo lp dn kq lq lr dp ku jv ls lt ky jz lu lv lc kd lw lx lg ly bi translated">固有政策</h2><p id="42e0" class="pw-post-body-paragraph jk jl in jm b jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc kd lm kf kg kh ig bi translated">对于内置策略，定义已经可用，只需要将分配资源添加到<strong class="jm io">main . TF .</strong><em class="ki">policy _ definition _ id</em>可以从 Azure portal 的策略中获得。</p><figure class="ma mb mc md gt me"><div class="bz fp l di"><div class="mr ms l"/></div></figure><h2 id="d463" class="ln kl in bd km lo lp dn kq lq lr dp ku jv ls lt ky jz lu lv lc kd lw lx lg ly bi translated">自定义策略</h2><p id="240d" class="pw-post-body-paragraph jk jl in jm b jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc kd lm kf kg kh ig bi translated">对于自定义策略，这两个定义以及分配资源组件都需要添加到<strong class="jm io">main . TF .</strong><em class="ki">policy _ definition _ id</em>用作分配变量，并在运行时进行配置。</p><figure class="ma mb mc md gt me"><div class="bz fp l di"><div class="mr ms l"/></div></figure><h2 id="3237" class="ln kl in bd km lo lp dn kq lq lr dp ku jv ls lt ky jz lu lv lc kd lw lx lg ly bi translated">运行模块</h2><pre class="ma mb mc md gt mt mu mv mw aw mx bi"><span id="c28a" class="ln kl in mu b gy my mz l na nb"><strong class="mu io">Initialising Modules<br/></strong>terraform init</span><span id="897b" class="ln kl in mu b gy nc mz l na nb"><strong class="mu io">Planning Modules<br/></strong>terraform plan</span><span id="db86" class="ln kl in mu b gy nc mz l na nb"><strong class="mu io">Applying Modules<br/></strong>terraform apply</span></pre><h1 id="befa" class="kk kl in bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">政策的验证</h1><p id="a606" class="pw-post-body-paragraph jk jl in jm b jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc kd lm kf kg kh ig bi translated">登录到<strong class="jm io"> Azure 门户</strong>，通过单击所选资源/资源组上的 Azure 策略左导航选项来验证以下内容。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi nd"><img src="../Images/a755150979ef2974a30079c4e233808a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YapVJOWnzdc9oie_SgJeGA.png"/></div></div><figcaption class="ml mm gj gh gi mn mo bd b be z dk translated"><strong class="bd km">政策合规状态</strong></figcaption></figure><h1 id="5ba3" class="kk kl in bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">额外资源</h1><div class="ne nf gp gr ng nh"><a href="https://github.com/amit894/azure-policy-terraform" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd io gy z fp nm fr fs nn fu fw im bi translated">GitHub-Amit 894/azure-Policy-terraform:用于 Azure 策略的 terra form</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">github.com</p></div></div><div class="nq l"><div class="nr l ns nt nu nq nv mj nh"/></div></div></a></div><p id="d607" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="ki">如需反馈，请留言至</em><strong class="jm io"><em class="ki">Amit[dot]894[at]Gmail[dot]com</em></strong><em class="ki">或联系 https://about.me/amit_raj</em><em class="ki">的任意链接。</em></p></div></div>    
</body>
</html>