<html>
<head>
<title>Add TreeMaps into Our React App with the Visx Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Visx库将树形图添加到React应用程序中</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/add-treemaps-into-our-react-app-with-the-visx-library-7c0ba0094376?source=collection_archive---------4-----------------------#2021-04-06">https://blog.devgenius.io/add-treemaps-into-our-react-app-with-the-visx-library-7c0ba0094376?source=collection_archive---------4-----------------------#2021-04-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/9dcd042bcfaca81b135abc6ebecb747c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CQH8l9SY46vFPM4f"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@maritafox?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Marita Kavelashvili </a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="31d4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Visx是一个库，让我们可以轻松地将图形添加到React应用程序中。</p><p id="ee07" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解如何使用它将treemaps添加到React应用程序中。</p><h1 id="396e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">安装所需的软件包</h1><p id="2968" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们必须安装一些模块。</p><p id="61e8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们运行:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="89df" class="mn lc iq mj b gy mo mp l mq mr">npm i @visx/group @visx/hierarchy @visx/mock-data @visx/responsive @visx/scale</span></pre><p id="8e2b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">安装软件包。</p><h1 id="0120" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">添加树形图</h1><p id="abfa" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过编写以下代码将树形图添加到React应用程序中:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="3a86" class="mn lc iq mj b gy mo mp l mq mr">import React, { useState } from "react";<br/>import { Group } from "@visx/group";<br/>import {<br/>  Treemap,<br/>  hierarchy,<br/>  stratify,<br/>  treemapSquarify,<br/>  treemapBinary,<br/>  treemapDice,<br/>  treemapResquarify,<br/>  treemapSlice,<br/>  treemapSliceDice<br/>} from "@visx/hierarchy";<br/>import shakespeare from "@visx/mock-data/lib/mocks/shakespeare";<br/>import { scaleLinear } from "@visx/scale";</span><span id="3f01" class="mn lc iq mj b gy ms mp l mq mr">const color1 = "#f3e9d2";<br/>const color2 = "#4281a4";<br/>const background = "#114b5f";</span><span id="1a66" class="mn lc iq mj b gy ms mp l mq mr">const colorScale = scaleLinear({<br/>  domain: [0, Math.max(...shakespeare.map((d) =&gt; d.size || 0))],<br/>  range: [color2, color1]<br/>});</span><span id="1262" class="mn lc iq mj b gy ms mp l mq mr">const data = stratify()<br/>  .id((d) =&gt; d.id)<br/>  .parentId((d) =&gt; d.parent)(shakespeare)<br/>  .sum((d) =&gt; d.size || 0);</span><span id="4e57" class="mn lc iq mj b gy ms mp l mq mr">const tileMethods = {<br/>  treemapSquarify,<br/>  treemapBinary,<br/>  treemapDice,<br/>  treemapResquarify,<br/>  treemapSlice,<br/>  treemapSliceDice<br/>};</span><span id="0b84" class="mn lc iq mj b gy ms mp l mq mr">const defaultMargin = { top: 10, left: 10, right: 10, bottom: 10 };</span><span id="34bb" class="mn lc iq mj b gy ms mp l mq mr">function Example({ width, height, margin = defaultMargin }) {<br/>  const [tileMethod, setTileMethod] = useState("treemapSquarify");<br/>  const xMax = width - margin.left - margin.right;<br/>  const yMax = height - margin.top - margin.bottom;<br/>  const root = hierarchy(data).sort((a, b) =&gt; (b.value || 0) - (a.value || 0));</span><span id="3064" class="mn lc iq mj b gy ms mp l mq mr">  return width &lt; 10 ? null : (<br/>    &lt;div&gt;<br/>      &lt;label&gt;tile method&lt;/label&gt;{" "}<br/>      &lt;select<br/>        onClick={(e) =&gt; e.stopPropagation()}<br/>        onChange={(e) =&gt; setTileMethod(e.target.value)}<br/>        value={tileMethod}<br/>      &gt;<br/>        {Object.keys(tileMethods).map((tile) =&gt; (<br/>          &lt;option key={tile} value={tile}&gt;<br/>            {tile}<br/>          &lt;/option&gt;<br/>        ))}<br/>      &lt;/select&gt;<br/>      &lt;div&gt;<br/>        &lt;svg width={width} height={height}&gt;<br/>          &lt;rect width={width} height={height} rx={14} fill={background} /&gt;<br/>          &lt;Treemap<br/>            top={margin.top}<br/>            root={root}<br/>            size={[xMax, yMax]}<br/>            tile={tileMethods[tileMethod]}<br/>            round<br/>          &gt;<br/>            {(treemap) =&gt; (<br/>              &lt;Group&gt;<br/>                {treemap<br/>                  .descendants()<br/>                  .reverse()<br/>                  .map((node, i) =&gt; {<br/>                    const nodeWidth = node.x1 - node.x0;<br/>                    const nodeHeight = node.y1 - node.y0;<br/>                    return (<br/>                      &lt;Group<br/>                        key={`node-${i}`}<br/>                        top={node.y0 + margin.top}<br/>                        left={node.x0 + margin.left}<br/>                      &gt;<br/>                        {node.depth === 1 &amp;&amp; (<br/>                          &lt;rect<br/>                            width={nodeWidth}<br/>                            height={nodeHeight}<br/>                            stroke={background}<br/>                            strokeWidth={4}<br/>                            fill="transparent"<br/>                          /&gt;<br/>                        )}<br/>                        {node.depth &gt; 2 &amp;&amp; (<br/>                          &lt;rect<br/>                            width={nodeWidth}<br/>                            height={nodeHeight}<br/>                            stroke={background}<br/>                            fill={colorScale(node.value || 0)}<br/>                          /&gt;<br/>                        )}<br/>                      &lt;/Group&gt;<br/>                    );<br/>                  })}<br/>              &lt;/Group&gt;<br/>            )}<br/>          &lt;/Treemap&gt;<br/>        &lt;/svg&gt;<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span><span id="7bec" class="mn lc iq mj b gy ms mp l mq mr">export default function App() {<br/>  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;Example width={500} height={300} /&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="0729" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe mt mu mv mj b">color1</code>和<code class="fe mt mu mv mj b">color2</code>变量为树形图分区添加颜色。</p><p id="941c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">background</code>有背景色。</p><p id="400d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们创建<code class="fe mt mu mv mj b">colorScale</code>变量来为分区创建颜色变量。</p><p id="7ec0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们用<code class="fe mt mu mv mj b">stratify</code>方法将数据转换成可以用于树形图的结构。</p><p id="f444" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，在<code class="fe mt mu mv mj b">Example</code>组件中，我们添加一个下拉菜单来显示平铺方法选项。</p><p id="0a7c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这让我们可以为树形图设置平铺格式。</p><p id="33fe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">之后，我们添加<code class="fe mt mu mv mj b">Treemap</code>组件来添加树形图。</p><p id="ba29" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在它的渲染属性中，我们调用<code class="fe mt mu mv mj b">descendants</code>来获得后代。</p><p id="af3c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们调用<code class="fe mt mu mv mj b">reverse</code>来反推数据。</p><p id="7a69" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">map</code>将它们映射到<code class="fe mt mu mv mj b">rect</code> s，以便我们渲染分区。</p><p id="183d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们根据深度级别对它们进行不同的渲染。</p><h1 id="f981" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="b866" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过Visx库轻松地将树形图添加到React应用程序中。</p></div></div>    
</body>
</html>