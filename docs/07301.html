<html>
<head>
<title>GGplot2 Crash Course: Bar Chart</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">GGplot2 速成班:条形图</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/ggplot2-crash-course-bar-chart-8a268e3ab35d?source=collection_archive---------4-----------------------#2022-03-13">https://blog.devgenius.io/ggplot2-crash-course-bar-chart-8a268e3ab35d?source=collection_archive---------4-----------------------#2022-03-13</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div class="gh gi jk"><img src="../Images/0e4a2324dbf0773b872870ee33c56f61.png" data-original-src="https://miro.medium.com/v2/resize:fit:480/format:webp/1*tMHvRCV16BFoJbU2F-o3rw.png"/></div></figure><h1 id="e092" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated"><strong class="ak">等等……不是直方图吗？</strong></h1><figure class="kq kr ks kt gt jo gh gi paragraph-image"><div class="gh gi kp"><img src="../Images/05e57fb22e6f2ec68ef19d18de605cd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/format:webp/1*tVtBr2FTan26yuos2bAczA.png"/></div></figure><p id="bc80" class="pw-post-body-paragraph ku kv in kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">我们已经讨论了如何制作一个<a class="ae ls" href="https://medium.com/@arthur.he/ggplot2-crash-course-histogram-ccacf51870f9" rel="noopener"> <em class="lt">直方图</em> </a>，今天我们将继续揭开一些制作一个令人惊叹的条形图的秘密成分。</p><p id="c61e" class="pw-post-body-paragraph ku kv in kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">正如我们之前讨论的，直方图应该在可视化连续变量时使用，而条形图只适用于分类变量…</p><blockquote class="lu lv lw"><p id="5c25" class="ku kv lt kw b kx ky kz la lb lc ld le lx lg lh li ly lk ll lm lz lo lp lq lr ig bi translated">抱歉打断一下…但是我不得不说，我仍然对连续变量和分类变量之间的区别有点困惑。能详细说说吗？</p></blockquote><p id="11bd" class="pw-post-body-paragraph ku kv in kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">当然可以！让我展示两者的一些例子！</p><p id="fa50" class="pw-post-body-paragraph ku kv in kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated"><strong class="kw io"> <em class="lt">连续变量</em> </strong>:表示可测的量(区间内的任意值)。这些值可以以自然的方式排序。定量变量的例子有:</p><p id="1606" class="pw-post-body-paragraph ku kv in kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">1:人体高度</p><p id="01db" class="pw-post-body-paragraph ku kv in kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">2:房价</p><p id="f354" class="pw-post-body-paragraph ku kv in kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">3:温度</p><p id="b949" class="pw-post-body-paragraph ku kv in kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">4:人体重量等。</p><p id="13f0" class="pw-post-body-paragraph ku kv in kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated"><strong class="kw io"> <em class="lt">分类变量</em> </strong>:代表一组可能的<br/>类别的一组值，这些类别不能以自然的方式排序，例如:</p><p id="fd71" class="pw-post-body-paragraph ku kv in kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">1:眼睛颜色</p><p id="84dc" class="pw-post-body-paragraph ku kv in kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">2:国籍</p><p id="ca7c" class="pw-post-body-paragraph ku kv in kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">3:性别</p><p id="929f" class="pw-post-body-paragraph ku kv in kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">4:流派等。</p><blockquote class="lu lv lw"><p id="69a8" class="ku kv lt kw b kx ky kz la lb lc ld le lx lg lh li ly lk ll lm lz lo lp lq lr ig bi translated">这就说得通了！</p></blockquote><p id="7f46" class="pw-post-body-paragraph ku kv in kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">太好了！现在开始我们的教程吧！</p></div><div class="ab cl ma mb hr mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="ig ih ii ij ik"><h1 id="d209" class="jr js in bd jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ml km kn ko bi translated"><strong class="ak">数据导入</strong></h1><p id="ef03" class="pw-post-body-paragraph ku kv in kw b kx mm kz la lb mn ld le lf mo lh li lj mp ll lm ln mq lp lq lr ig bi translated">本教程将使用的数据是包<code class="fe mr ms mt mu b">mosaicData</code>中的<code class="fe mr ms mt mu b">Marriage</code>。如果你的 R 里没有安装，也不要慌！只需运行这一行命令，一切就都准备好了:</p><p id="2227" class="pw-post-body-paragraph ku kv in kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated"><code class="fe mr ms mt mu b">install.packages('mosaicData')</code></p><figure class="kq kr ks kt gt jo"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="a08b" class="pw-post-body-paragraph ku kv in kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">婚姻数据集包含阿拉巴马州莫比尔县 98 个人的婚姻记录。我们将通过<code class="fe mr ms mt mu b">race</code>显示婚礼参与者的分布来练习制作条形图。</p><h1 id="3766" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">条形图</h1><figure class="kq kr ks kt gt jo"><div class="bz fp l di"><div class="mv mw l"/></div></figure><figure class="kq kr ks kt gt jo gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/03ffdd8fb600655330a12950d649178e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1314/format:webp/1*C78TiM2W7MKZ0Sg_EQXbcg.png"/></div></figure><p id="9118" class="pw-post-body-paragraph ku kv in kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">太好了！现在我们有了第一个柱状图！首先，传递数据参数，并为<code class="fe mr ms mt mu b">aes()</code>函数指定分类变量。</p><blockquote class="lu lv lw"><p id="c994" class="ku kv lt kw b kx ky kz la lb lc ld le lx lg lh li ly lk ll lm lz lo lp lq lr ig bi translated">够直观了，但是我如何为图表添加标题、更改颜色和切换到不同的主题呢？</p></blockquote><p id="7b39" class="pw-post-body-paragraph ku kv in kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">别担心！您可以通过向<code class="fe mr ms mt mu b">geom_bar</code>和<code class="fe mr ms mt mu b">labs </code>功能添加选项来修改<code class="fe mr ms mt mu b">fill</code>中的条形填充和边框颜色<code class="fe mr ms mt mu b">color</code>，编辑绘图标签，以及输入标题。如果你想定制主题，你可以使用<code class="fe mr ms mt mu b">ggthemes</code>包。点击查看可用主题选项<a class="ae ls" href="https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="kq kr ks kt gt jo"><div class="bz fp l di"><div class="mv mw l"/></div></figure><figure class="kq kr ks kt gt jo gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/528a26af54ba3f198e362d4904391f5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1314/format:webp/1*0NKXrM8IhkrPfUuHGcbn3Q.png"/></div></figure><blockquote class="lu lv lw"><p id="95d8" class="ku kv lt kw b kx ky kz la lb lc ld le lx lg lh li ly lk ll lm lz lo lp lq lr ig bi translated">看起来不错！但是如果我想显示百分比而不是<strong class="kw io">计数呢？</strong></p></blockquote><p id="5be1" class="pw-post-body-paragraph ku kv in kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">好问题！一如既往的可行！对于条形图，代码<code class="fe mr ms mt mu b">aes(x=race)</code>实际上是<code class="fe mr ms mt mu b">aes(x = race, y = ..count..)</code>的快捷方式，其中<code class="fe mr ms mt mu b">..count..</code>是另一个代表每个类别中绝对频率的变量。您可以通过设置<code class="fe mr ms mt mu b">y = ..count.. / <strong class="kw io">sum</strong>(..count..)</code>来计算百分比。</p><figure class="kq kr ks kt gt jo"><div class="bz fp l di"><div class="mv mw l"/></div></figure><figure class="kq kr ks kt gt jo gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/aaf02e15b6c9c6c637b96092dfdfaf61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1314/format:webp/1*_Y9viev1NyN0WUVCKzmIWQ.png"/></div></figure><blockquote class="lu lv lw"><p id="65e3" class="ku kv lt kw b kx ky kz la lb lc ld le lx lg lh li ly lk ll lm lz lo lp lq lr ig bi translated">哇，真好！但是如果类别按升序或降序排序会不会很好？</p></blockquote><p id="c884" class="pw-post-body-paragraph ku kv in kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">确实！按频率对条形进行排序通常能提供直观的信息。为了实现这一点，我们将创建一个新的数据集<code class="fe mr ms mt mu b">sort_dat</code>来计算每个比赛类别中的参与者数量，然后我们使用<code class="fe mr ms mt mu b">reorder</code>函数来按频率对类别进行排序。选项<code class="fe mr ms mt mu b">stat="identity"</code>通知绘图功能不要计算计数，因为它们是直接指定的。</p><p id="525e" class="pw-post-body-paragraph ku kv in kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">注意:</p><ol class=""><li id="7649" class="my mz in kw b kx ky lb lc lf na lj nb ln nc lr nd ne nf ng bi translated"><code class="fe mr ms mt mu b">reorder(race, -n)</code>按降序排序</li><li id="15d4" class="my mz in kw b kx nh lb ni lf nj lj nk ln nl lr nd ne nf ng bi translated"><code class="fe mr ms mt mu b">reorder(race, n)</code>按升序排序</li></ol><figure class="kq kr ks kt gt jo"><div class="bz fp l di"><div class="mv mw l"/></div></figure><figure class="kq kr ks kt gt jo gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/dfe21a6cee93cc139ad7db8c6748175c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1314/format:webp/1*z1m21ldZVGawWL6WIxDA9w.png"/></div></figure></div><div class="ab cl ma mb hr mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="ig ih ii ij ik"><h1 id="3c1d" class="jr js in bd jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ml km kn ko bi translated">堆积条形图、分组条形图和水平条形图</h1><p id="c226" class="pw-post-body-paragraph ku kv in kw b kx mm kz la lb mn ld le lf mo lh li lj mp ll lm ln mq lp lq lr ig bi translated">对于教程的这一部分，我们将使用另一个分类变量<code class="fe mr ms mt mu b">officialTitle</code>。首先，我们来看看如何制作水平条形图</p><figure class="kq kr ks kt gt jo"><div class="bz fp l di"><div class="mv mw l"/></div></figure><figure class="kq kr ks kt gt jo gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/c51637373da92b847e91cbf5fdf87c52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1314/format:webp/1*N-5yMwdYPyOC4OBU4wm3Fw.png"/></div></figure><blockquote class="lu lv lw"><p id="1d75" class="ku kv lt kw b kx ky kz la lb lc ld le lx lg lh li ly lk ll lm lz lo lp lq lr ig bi translated">太棒了。我能不能也在这个横条图中加入种族类别？</p></blockquote><p id="7f23" class="pw-post-body-paragraph ku kv in kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">当然啦！我认为看到各种主持人的种族分布会很有帮助。</p><p id="f639" class="pw-post-body-paragraph ku kv in kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated"><em class="lt">实现这一点的两种方式</em>:</p><h2 id="7ab3" class="nm js in bd jt nn no dn jx np nq dp kb lf nr ns kf lj nt nu kj ln nv nw kn nx bi translated">堆积条形图</h2><figure class="kq kr ks kt gt jo"><div class="bz fp l di"><div class="mv mw l"/></div></figure><figure class="kq kr ks kt gt jo gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/9f987a6674b27670de5d242dc902d322.png" data-original-src="https://miro.medium.com/v2/resize:fit:1314/format:webp/1*8qcpjiqFtzWQTW7iteqC1A.png"/></div></figure><h2 id="a27c" class="nm js in bd jt nn no dn jx np nq dp kb lf nr ns kf lj nt nu kj ln nv nw kn nx bi translated">分组条形图</h2><figure class="kq kr ks kt gt jo"><div class="bz fp l di"><div class="mv mw l"/></div></figure><figure class="kq kr ks kt gt jo gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/76b704d78763a516c66aaef23cef2876.png" data-original-src="https://miro.medium.com/v2/resize:fit:1314/format:webp/1*oXNyAiqlQ5l6xn_rrh4dCA.png"/></div></figure><blockquote class="lu lv lw"><p id="5707" class="ku kv lt kw b kx ky kz la lb lc ld le lx lg lh li ly lk ll lm lz lo lp lq lr ig bi translated">可爱！但是我不太喜欢这种配色方案，另外，我喜欢用精确的数字值来标记每个条形…</p></blockquote><p id="98ab" class="pw-post-body-paragraph ku kv in kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">嗯，这可能涉及一些技术上的调整。实际上，我不会对每个术语讨论太多(这不是本课程的目标)，我们还需要为它构建一个新的数据集。</p><h1 id="5519" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">配色方案和数字标签</h1><h2 id="49d1" class="nm js in bd jt nn no dn jx np nq dp kb lf nr ns kf lj nt nu kj ln nv nw kn nx bi translated">数据过滤</h2><figure class="kq kr ks kt gt jo"><div class="bz fp l di"><div class="mv mw l"/></div></figure><figure class="kq kr ks kt gt jo gh gi paragraph-image"><div class="ab gu cl ny"><img src="../Images/99f747b444201d817e2758e260c04e08.png" data-original-src="https://miro.medium.com/v2/format:webp/1*96PJ2Z7tcsSsl78w02oW4g.png"/></div></figure><h2 id="adc0" class="nm js in bd jt nn no dn jx np nq dp kb lf nr ns kf lj nt nu kj ln nv nw kn nx bi translated">堆积条形图</h2><figure class="kq kr ks kt gt jo"><div class="bz fp l di"><div class="mv mw l"/></div></figure><figure class="kq kr ks kt gt jo gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/fd1de5b526c039a632145e65907f54fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1314/format:webp/1*4XZj3D1GKSdH1emo0sbkug.png"/></div></figure><p id="97a4" class="pw-post-body-paragraph ku kv in kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">有许多调色板可以从中选择<a class="ae ls" href="https://www.datanovia.com/en/blog/ggplot-colors-best-tricks-you-will-love/" rel="noopener ugc nofollow" target="_blank">，我在这个图中使用了<code class="fe mr ms mt mu b">colorbrewer</code>调色板。</a></p><p id="fffe" class="pw-post-body-paragraph ku kv in kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">对于<code class="fe mr ms mt mu b">colorbrewer</code>，请记住:</p><ul class=""><li id="a401" class="my mz in kw b kx ky lb lc lf na lj nb ln nc lr nz ne nf ng bi translated"><code class="fe mr ms mt mu b">scale_fill_brewer()</code>用于箱形图、条形图、小提琴图、点状图等</li><li id="4986" class="my mz in kw b kx nh lb ni lf nj lj nk ln nl lr nz ne nf ng bi translated">线和点的<code class="fe mr ms mt mu b">scale_color_brewer()</code>或<code class="fe mr ms mt mu b">scale_colour_brewer()</code></li></ul><h2 id="9f27" class="nm js in bd jt nn no dn jx np nq dp kb lf nr ns kf lj nt nu kj ln nv nw kn nx bi translated">分组条形图</h2><figure class="kq kr ks kt gt jo"><div class="bz fp l di"><div class="mv mw l"/></div></figure><figure class="kq kr ks kt gt jo gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/fbba55845951e74a36b657a171c952de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1314/format:webp/1*VogVSl7BNU6STwHTWvH9Gw.png"/></div></figure><p id="3183" class="pw-post-body-paragraph ku kv in kw b kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">现在利用你在自己的数据分析中学到的东西！敬请期待！</p></div></div>    
</body>
</html>