<html>
<head>
<title>I made over 1,000 code reviews — this is what I learned</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我做了1000多次代码审查——这是我学到的</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/i-made-over-1-000-code-reviews-this-is-what-i-learned-1f64c6a594e4?source=collection_archive---------6-----------------------#2020-06-04">https://blog.devgenius.io/i-made-over-1-000-code-reviews-this-is-what-i-learned-1f64c6a594e4?source=collection_archive---------6-----------------------#2020-06-04</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="5728" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在过去的3年里，我已经审查了1，000多个拉取(合并)请求。在那段时间里，我学到了很多东西——主要是关于如何不审查代码，如何使过程不那么痛苦，什么是高质量的代码等等。</p><h1 id="b1b0" class="ki kj in bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">拉请求只需要做一件事</h1><p id="f6c3" class="pw-post-body-paragraph jk jl in jm b jn lg jp jq jr lh jt ju jv li jx jy jz lj kb kc kd lk kf kg kh ig bi translated">这是最重要的事情要小心！</p><p id="a99a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在进行代码评审时，你需要记住很多东西。<em class="ll">“这背后的意图是什么？”</em>，<em class="ll">“这怎么符合代码的其余部分？”</em>和<em class="ll">“这个性能好吗？”</em>只是一些需要回答的问题。因此，当你有一个集中的拉式请求试图解决一个问题时，其中一些问题会变得更容易回答。</p><p id="de03" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">另一个重要的方面是拉请求的大小。更大的请求需要成倍增加的时间来审查。当我知道我需要花15分钟以上的时间来处理这个请求时，你将不得不等上几个小时。</p><p id="9a42" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">更大的拉取请求也有更多的错误，因此获得批准的时间也将显著增加。这意味着您的代码可能要等待几天才能获得批准。如果你的公司是敏捷的，那会增加合并冲突的机会，这是非常痛苦的。</p><blockquote class="lm ln lo"><p id="9a86" class="jk jl ll jm b jn jo jp jq jr js jt ju lp jw jx jy lq ka kb kc lr ke kf kg kh ig bi translated">最好的办法是将拉请求分成有意义的部分——一个拉请求应该只解决一件事。</p></blockquote><p id="9c91" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因此，要小心常见的陷阱，比如<em class="ll">重命名</em>、<em class="ll">代码泛化</em>等等。尽管这是无辜的，也是出于好意，但它转移了对重要部分的关注——提高代码质量和减少错误数量。在另一个拉动请求中实现你的天才想法。</p><h1 id="b12c" class="ki kj in bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">尽可能多地自动化检查</h1><p id="43a7" class="pw-post-body-paragraph jk jl in jm b jn lg jp jq jr lh jt ju jv li jx jy jz lj kb kc kd lk kf kg kh ig bi translated">继续这个概念，评审员必须记住很多东西，这也包括检查代码格式、适当文档的存在、可通过的测试等等。我记得我不得不考虑所有这些的时候——这既分散注意力又耗费时间。</p><p id="0a3a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">好的一面是解决方案非常简单——将所有检查集成到CI管道中。每当有人提交一个pull请求时，它就运行所有的检查，并且在所有检查通过之前不允许合并。作为审阅者，您再也不用担心格式问题了。</p><p id="3fb3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="ll">自动化测试</em>有助于确保作者没有破坏任何东西，并且测试仍然通过。根据您的测试方法，这很容易成为您的拉请求配置项中最重要的检查。</p><p id="736c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">自动化代码格式化使得所有关于理想行长度或在哪里添加新行的争论都消失了。作为一个团队，只需选择一组格式化规则，并将其交给自动格式化程序。这将使你摆脱许多麻烦。如果你在同意一种格式上有问题，看看谷歌、脸书或其他一些大公司是怎么做的。</p><p id="af65" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="ll">自动化lint </em>检查器对于像Python这样代码格式影响代码逻辑的语言也非常重要。大多数Python的代码格式化程序只会格式化他们确信不会影响任何逻辑的代码。通过添加棉绒检查器，您可以覆盖所有内容。</p><p id="ad3e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一些值得称赞的是<em class="ll">类型检查器</em>和<em class="ll">文档检查器</em>，但是最重要的是对你和你的团队有意义的自动化检查。如果你认为某件事会有帮助，那就说出来，尝试一两个星期。</p><h1 id="d293" class="ki kj in bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">与作者一起回顾代码</h1><p id="0fde" class="pw-post-body-paragraph jk jl in jm b jn lg jp jq jr lh jt ju jv li jx jy jz lj kb kc kd lk kf kg kh ig bi translated">这使得审查过程更快，因为您可以更快地与作者迭代代码，并分享您的观点。作者还可以更好地解释他的方法背后的推理，比如他是否已经尝试了一些东西，以及为什么没有成功。</p><p id="cd95" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这也可能是一个与人更多联系的好机会，这很重要。当你的开发伙伴看到你在他们的个人和业务发展上投资，他们会感激你的。这对你和作者来说也是一个很好的机会来练习你们的交流，这对一个运作良好的团队来说是至关重要的。</p><p id="cd82" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">不过，注意不要做过头了。一些拉取请求太小、太简单，无法进行任何有影响力的对话。在这种情况下，与作者坐下来谈可能是浪费时间。</p><h1 id="615c" class="ki kj in bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">写评论的时候要考虑周全</h1><p id="4d3d" class="pw-post-body-paragraph jk jl in jm b jn lg jp jq jr lh jt ju jv li jx jy jz lj kb kc kd lk kf kg kh ig bi translated">如果你比代码的作者更有经验，你需要考虑到你如何表达事情很重要。写得好的批评可以让开发人员在未来变得更好，但也可以粉碎一些人的梦想。</p><p id="a08a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我发现最有效的方法是问开放式的问题——这并不咄咄逼人，甚至鼓励开发人员进行批判性思考。这是否会比告诉别人解决方案花费更多的时间？是的，短期的。但是从长远来看，你在帮助他们成长，他们不太可能重复他们的错误。</p><p id="f2b1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">所以，下次有人在for循环中而不是之前打开文件时，不要直接指出来，而是问<em class="ll">“你如何降低这里的复杂性？”</em>。这将意味着很多。</p><h1 id="8d22" class="ki kj in bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">添加一个名为“我在本地运行了这段代码”的标志</h1><p id="ebaf" class="pw-post-body-paragraph jk jl in jm b jn lg jp jq jr lh jt ju jv li jx jy jz lj kb kc kd lk kf kg kh ig bi translated">最困扰我的事情是在一些小的拉请求中发现一个错误，由于这个错误，一个功能根本不能工作。这意味着开发人员甚至没有运行代码——可能认为没有必要，因为变化很小。</p><p id="d052" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这种情况发生了几次后，我添加了一个名为<em class="ll">的标志，并在本地运行了这段代码</em>，这彻底解决了问题。我不再审查那些不在本地运行的代码，人们也不会撒谎。没有什么不好的感觉，因为我们都知道应该这样做。</p><h1 id="808d" class="ki kj in bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">其他新闻</h1><p id="226b" class="pw-post-body-paragraph jk jl in jm b jn lg jp jq jr lh jt ju jv li jx jy jz lj kb kc kd lk kf kg kh ig bi translated">我受到启发要写更多，所以我开了一个<a class="ae ls" href="https://devwayoflife.com/" rel="noopener ugc nofollow" target="_blank">博客</a>。如果你对这类内容感兴趣，请随时查看并订阅。</p></div></div>    
</body>
</html>