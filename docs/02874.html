<html>
<head>
<title>SharePoint Site Templates</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SharePoint 网站模板</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/sharepoint-site-templates-c7f9f3e70b0b?source=collection_archive---------3-----------------------#2020-09-07">https://blog.devgenius.io/sharepoint-site-templates-c7f9f3e70b0b?source=collection_archive---------3-----------------------#2020-09-07</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><figure class="im in gp gr io ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/2629e882d3a11964b821769f7ac4e3e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gbA5IMgX0wQeZN1Y"/></div></div></figure><div class=""/><p id="be49" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果您想使用<strong class="jx iz">客户端对象模型</strong>创建一个新的 SharePoint 站点，您可以使用类<strong class="jx iz"> WebCreationInformation </strong>来指定站点的属性，然后通过将站点添加到 web 来创建它。</p><p id="bbc7" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">但是，需要传递一个唯一的<strong class="jx iz">模板类型</strong>作为参数。此参数是一个字符串，必须与可用模板的名称之一匹配。</p><p id="6dc0" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">要获得所有可用模板的列表，您可以在 PowerShell 中运行命令<strong class="jx iz"> Get-SpoWebTemplate </strong>。下表概述了所有可用的模板。</p><figure class="ku kv kw kx gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi kt"><img src="../Images/36b226ea3334232e6d919e4613e36882.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/0*_PhkeFdRpNvP94N7"/></div></div></figure><p id="a476" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">作为微软<strong class="jx iz">包中包含的库。SharePointOnline.CSOM </strong>没有为可用模板提供任何枚举器。我创建了下面的代码片段。</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="1b2c" class="ld le iy kz b gy lf lg l lh li">using System.Runtime.Serialization;<br/></span><span id="40ba" class="ld le iy kz b gy lj lg l lh li">namespace SharePoint.Models<br/>{<br/>    public enum WebTemplate<br/>    {<br/>        [EnumMember(Value = "GLOBAL#0")]<br/>        GlobalTemplate,<br/>        [EnumMember(Value = "STS#0")]<br/>        TeamSite,<br/>        [EnumMember(Value = "STS#1")]<br/>        BlankSite,<br/>        [EnumMember(Value = "STS#2")]<br/>        DocumentWorkspace,<br/>        [EnumMember(Value = "MPS#0")]<br/>        BasicMeetingWorkspace,<br/>        [EnumMember(Value = "MPS#1")]<br/>        BlankMeetingWorkspace,<br/>        [EnumMember(Value = "MPS#2")]<br/>        DecisionMeetingWorkspace,<br/>        [EnumMember(Value = "MPS#3")]<br/>        SocialMeetingWorkspace,<br/>        [EnumMember(Value = "MPS#4")]<br/>        MultipageMeetingWorkspace,<br/>        [EnumMember(Value = "CENTRALADMIN#0")]<br/>        CentralAdminSite,<br/>        [EnumMember(Value = "WIKI#0")]<br/>        WikiSite,<br/>        [EnumMember(Value = "BLOG#0")]<br/>        Blog,<br/>        [EnumMember(Value = "SGS#0")]<br/>        GroupWorkSite,<br/>        [EnumMember(Value = "TENANTADMIN#0")]<br/>        TenantAdminSite,<br/>        [EnumMember(Value = "ACCSRV#0")]<br/>        AccessServicesSite,<br/>        [EnumMember(Value = "ACCSRV#1")]<br/>        AssetsWebDatabase,<br/>        [EnumMember(Value = "ACCSRV#3")]<br/>        CharitableContributionsWebDatabase,<br/>        [EnumMember(Value = "ACCSRV#4")]<br/>        ContactsWebDatabase,<br/>        [EnumMember(Value = "ACCSRV#6")]<br/>        IssuesWebDatabase,<br/>        [EnumMember(Value = "ACCSRV#5")]<br/>        ProjectsWebDatabase,<br/>        [EnumMember(Value = "BDR#0")]<br/>        DocumentCenter,<br/>        [EnumMember(Value = "EXPRESS#0")]<br/>        ExpressTeamSite,<br/>        [EnumMember(Value = "OFFILE#1")]<br/>        RecordsCenter,<br/>        [EnumMember(Value = "EHS#0")]<br/>        ExpressHostedSite,<br/>        [EnumMember(Value = "OSRV#0")]<br/>        SharedServicesAdministrationSite,<br/>        [EnumMember(Value = "PowerPointBroadcast#0")]<br/>        PowerPointBroadcastSite,<br/>        [EnumMember(Value = "PPSMASite#0")]<br/>        BusinessIntelligenceCenter,<br/>        [EnumMember(Value = "SPS#0")]<br/>        SharePointPortalServerSite,<br/>        [EnumMember(Value = "SPSPERS#0")]<br/>        SharePointPortalServerPersonalSpace,<br/>        [EnumMember(Value = "SPSMSITE#0")]<br/>        PersonalizationSite,<br/>        [EnumMember(Value = "SPSTOC#0")]<br/>        ContentsAreaTemplate,<br/>        [EnumMember(Value = "SPSTOPIC#0")]<br/>        TopicAreatemplate,<br/>        [EnumMember(Value = "SPSNEWS#0")]<br/>        NewsSite,<br/>        [EnumMember(Value = "CMSPUBLISHING#0")]<br/>        PublishingSite,<br/>        [EnumMember(Value = "BLANKINTERNET#0")]<br/>        PublishingSiteBlank,<br/>        [EnumMember(Value = "BLANKINTERNET#1")]<br/>        PressReleasesSite,<br/>        [EnumMember(Value = "BLANKINTERNET#2")]<br/>        PublishingSiteWithWorkflow,<br/>        [EnumMember(Value = "SPSNHOME#0")]<br/>        NewsHomeSite,<br/>        [EnumMember(Value = "SPSSITES#0")]<br/>        SiteDirectory,<br/>        [EnumMember(Value = "SPSCOMMU#0")]<br/>        CommunityAreaTemplate,<br/>        [EnumMember(Value = "SPSREPORTCENTER#0")]<br/>        ReportCenter,<br/>        [EnumMember(Value = "SPSPORTAL#0")]<br/>        CollaborationPortal,<br/>        [EnumMember(Value = "SRCHCEN#0")]<br/>        EnterpriseSearchCenter,<br/>        [EnumMember(Value = "PROFILES#0")]<br/>        Profiles,<br/>        [EnumMember(Value = "BLANKINTERNETCONTAINER#0")]<br/>        PublishingPortal,<br/>        [EnumMember(Value = "SPSMSITEHOST#0")]<br/>        MySiteHost,<br/>        [EnumMember(Value = "ENTERWIKI#0")]<br/>        EnterpriseWiki,<br/>        [EnumMember(Value = "SRCHCENTERLITE#0")]<br/>        BasicSearchCenter,<br/>        [EnumMember(Value = "SRCHCENTERFAST#0")]<br/>        FastSearchCenter,<br/>        [EnumMember(Value = "TenantAdminSpo#0")]<br/>        SharePointOnlineTenantAdmin,<br/>        [EnumMember(Value = "visprus#0")]<br/>        VisioProcessRepository,<br/>    }<br/>}</span></pre><p id="f20a" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了访问<strong class="jx iz"> EnumMember </strong>属性，我们必须使用下面的 Enum 扩展方法。</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="55c1" class="ld le iy kz b gy lf lg l lh li">using System;<br/>using System.Linq;<br/>using System.Runtime.Serialization;<br/>using System.Reflection;<br/>using System.ComponentModel;<br/></span><span id="1fae" class="ld le iy kz b gy lj lg l lh li">namespace SharePoint.Extensions<br/>{<br/>    public static class EnumExtensions<br/>    {<br/>        public static string GetMemberAttributeValue(this Enum source)<br/>        {<br/>            Type enumType = source.GetType();<br/>            if (!enumType.IsEnum)<br/>            {<br/>                throw new ArgumentException("source must be an enumerated type");<br/>            }<br/></span><span id="24f6" class="ld le iy kz b gy lj lg l lh li">            var memInfo = enumType.GetMember(source.ToString());<br/>            var attr = memInfo.FirstOrDefault()?.GetCustomAttributes(false).OfType&lt;EnumMemberAttribute&gt;().FirstOrDefault();<br/>            if (attr != null)<br/>            {<br/>                return attr.Value;<br/>            }<br/>            return null;<br/>        }<br/>    }<br/>}</span></pre><p id="1dd0" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在，使用以下代码在 SharePoint 上创建一个新网站就足够了:</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="7d4c" class="ld le iy kz b gy lf lg l lh li">WebCreationInformation webCreationInfo = new WebCreationInformation<br/>{<br/>  Title = "Title",<br/>  Url = "url",<br/>  WebTemplate = WebTemplate.ExpressTeamSite.GetMemberAttributeValue(),<br/>  Description = "Description",<br/>  UseSamePermissionsAsParentSite = true<br/>};</span><span id="4249" class="ld le iy kz b gy lj lg l lh li">ctx.Site.RootWeb.Webs.Add(webCreationInfo);<br/>ctx.ExecuteQuery();</span></pre></div></div>    
</body>
</html>