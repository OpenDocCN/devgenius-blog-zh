<html>
<head>
<title>DiffUtil in multiple columns list with different items</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">具有不同项目的多列列表中的差异</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/diffutil-in-multiple-columns-list-with-different-items-ae52a8134f0a?source=collection_archive---------9-----------------------#2022-02-08">https://blog.devgenius.io/diffutil-in-multiple-columns-list-with-different-items-ae52a8134f0a?source=collection_archive---------9-----------------------#2022-02-08</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/de6cd7ae949b6d6d6c97af78c576471b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4wNOZmTuXaYaa3xX"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">图片由<a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae jz" href="https://unsplash.com/@ineka?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Ine Carriquiry </a>拍摄</figcaption></figure><p id="9ad1" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">你好！今天我将讨论如何在你的项目中实现<a class="ae jz" href="https://developer.android.com/reference/androidx/recyclerview/widget/DiffUtil" rel="noopener ugc nofollow" target="_blank"> DiffUtil </a>以及多列列表的情况。这是最终结果👇</p><div class="ky kz la lb gt ab cb"><figure class="lc jo ld le lf lg lh paragraph-image"><img src="../Images/0a2a9de814bdcdc02ee6d06406074729.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/1*buSzAnQNmSMVlT_bLNH2tQ.gif"/></figure><figure class="lc jo ld le lf lg lh paragraph-image"><img src="../Images/07909a489c90821d88ba63090a8b6ef8.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/1*v7iDJESpZAs2CFI3cgZDvg.gif"/></figure></div><p id="4e5a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果你想知道:"<em class="li">嘿，我怎样才能创建这样的多列列表呢？</em>”，我有答案了…😅查看我的<strong class="kc io"> </strong> <a class="ae jz" href="https://medium.com/r?url=https%3A%2F%2Fserjantarbuz.medium.com%2Frecyclerview-with-different-items-and-multiple-columns-grid-724618d5d4e4" rel="noopener"> <strong class="kc io">上一篇</strong> </a>关于它。</p></div><div class="ab cl lj lk hr ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="ig ih ii ij ik"><h2 id="e67c" class="lq lr in bd ls lt lu dn lv lw lx dp ly kl lz ma mb kp mc md me kt mf mg mh mi bi translated">关于<a class="ae jz" href="https://developer.android.com/reference/androidx/recyclerview/widget/DiffUtil" rel="noopener ugc nofollow" target="_blank"> <strong class="ak"> DiffUtil </strong> </a> |为了什么？</h2><p id="e22f" class="pw-post-body-paragraph ka kb in kc b kd mj kf kg kh mk kj kk kl ml kn ko kp mm kr ks kt mn kv kw kx ig bi translated">这个有用的东西藏在<a class="ae jz" href="https://developer.android.com/jetpack/androidx/releases/recyclerview" rel="noopener ugc nofollow" target="_blank"> RecyclerView </a>库里面。需要比较两个列表(以前的和新的)并调用<a class="ae jz" href="https://developer.android.com/reference/androidx/recyclerview/widget/RecyclerView.Adapter" rel="noopener ugc nofollow" target="_blank">recycle view。适配器</a>为每个差异通知函数。此外，它比以前使用的功能更有优势:</p><p id="a411" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">🔹更好的性能<br/>🔹少码<br/>🔹一起玩的漂亮动画</p><p id="433e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我想这也回答了这个问题:“<em class="li">为什么我们要用</em><a class="ae jz" href="https://developer.android.com/reference/androidx/recyclerview/widget/DiffUtil" rel="noopener ugc nofollow" target="_blank"><em class="li">DiffUtil</em></a><em class="li">？</em>😇</p><h2 id="64e7" class="lq lr in bd ls lt lu dn lv lw lx dp ly kl lz ma mb kp mc md me kt mf mg mh mi bi translated">如何开始？</h2><p id="95b5" class="pw-post-body-paragraph ka kb in kc b kd mj kf kg kh mk kj kk kl ml kn ko kp mm kr ks kt mn kv kw kx ig bi translated">主要我们将使用<a class="ae jz" href="https://developer.android.com/reference/androidx/recyclerview/widget/RecyclerView.Adapter" rel="noopener ugc nofollow" target="_blank">适配器</a>类，对它们进行一些转换，并创建一些新的。首先，让我们为所有的<a class="ae jz" href="https://developer.android.com/reference/androidx/recyclerview/widget/RecyclerView.Adapter" rel="noopener ugc nofollow" target="_blank">适配器</a>创建一个新的父类，它将实现<a class="ae jz" href="https://medium.com/r?url=https%3A%2F%2Fdeveloper.android.com%2Freference%2Fandroidx%2Frecyclerview%2Fwidget%2FDiffUtil" rel="noopener"> DiffUtil </a>。</p><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="9b84" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">关于该类的一些重要注意事项:</p><ul class=""><li id="8fdf" class="mq mr in kc b kd ke kh ki kl ms kp mt kt mu kx mv mw mx my bi translated">变量<a class="ae jz" href="https://developer.android.com/reference/androidx/recyclerview/widget/DiffUtil.DiffResult" rel="noopener ugc nofollow" target="_blank"><em class="li">diff result</em></a><em class="li"/>是库工作的结果(计算两个列表的差)。</li><li id="ad63" class="mq mr in kc b kd mz kh na kl nb kp nc kt nd kx mv mw mx my bi translated">抽象变量<em class="li"> diff </em>(带父<em class="li"> ParentDiff &lt; T &gt; </em>)忙于比较条目以及如何在列表中识别它们。</li><li id="e690" class="mq mr in kc b kd mz kh na kl nb kp nc kt nd kx mv mw mx my bi translated">您可能会注意到<em class="li"> setList </em>函数上方的注释。这意味着(对于类实现)需要在<em class="li"> this.list 中复制<em class="li"> list </em>(这是参数)的条目。</em>只设置新的 list -这还不够。它将防止<a class="ae jz" href="https://developer.android.com/reference/androidx/recyclerview/widget/DiffUtil" rel="noopener ugc nofollow" target="_blank"> DiffUtil </a> <em class="li"> list </em>(如果你存储的<em class="li"> list </em>发生了一些变化)内的变化，并使动画以正确的方式工作。</li></ul><p id="32c3" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">下面介绍父类的实现。因为与<a class="ae jz" href="https://serjantarbuz.medium.com/recyclerview-with-different-items-and-multiple-columns-grid-724618d5d4e4" rel="noopener">上一篇</a>代码相似，所以不全。注意<em class="li">设置列表</em>功能(再次😃)，并非所有项目都复制到这里(跳过<em class="li">对象</em>有静态数据的项目)。</p><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="mo mp l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">您可以在 GitHub 中找到完整的代码(文章末尾的项目链接)</figcaption></figure><h2 id="24a4" class="lq lr in bd ls lt lu dn lv lw lx dp ly kl lz ma mb kp mc md me kt mf mg mh mi bi translated"><strong class="ak">文章更新(22.02.22) </strong></h2><p id="36c0" class="pw-post-body-paragraph ka kb in kc b kd mj kf kg kh mk kj kk kl ml kn ko kp mm kr ks kt mn kv kw kx ig bi translated">最近我为自己发现了一个类<a class="ae jz" href="https://developer.android.com/reference/androidx/recyclerview/widget/ListAdapter" rel="noopener ugc nofollow" target="_blank"> ListAdapter </a>，它与<em class="li"> ParrentDiffAdapter </em>非常相似。但是这样更好，因为在后台线程上计算列表之间的差异。在<a class="ae jz" href="https://developer.android.com/reference/androidx/recyclerview/widget/ListAdapter" rel="noopener ugc nofollow" target="_blank"> ListAdapter </a>的文档页面中，你可以找到如何实现这个类。</p><h2 id="a3b0" class="lq lr in bd ls lt lu dn lv lw lx dp ly kl lz ma mb kp mc md me kt mf mg mh mi bi translated">比较类别</h2><p id="644f" class="pw-post-body-paragraph ka kb in kc b kd mj kf kg kh mk kj kk kl ml kn ko kp mm kr ks kt mn kv kw kx ig bi translated">现在，关于<em class="li"> ParentDiff </em>及其子<em class="li"> TestDiff </em>。都是<a class="ae jz" href="https://developer.android.com/reference/kotlin/androidx/recyclerview/widget/DiffUtil.Callback" rel="noopener ugc nofollow" target="_blank">难度的实现。回调</a>。基于这个回调实现，适配器将调用通知函数。文档是这样描述的:</p><blockquote class="ne nf ng"><p id="c24a" class="ka kb li kc b kd ke kf kg kh ki kj kk nh km kn ko ni kq kr ks nj ku kv kw kx ig bi translated">DiffUtil 在计算两个列表之间的差异时使用的回调类。</p></blockquote><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="mo mp l"/></div></figure><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="mo mp l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">一般项目-如在 DiffAdapter 中</figcaption></figure><p id="6556" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">关于重要时刻的一些评论:</p><ul class=""><li id="069f" class="mq mr in kc b kd ke kh ki kl ms kp mt kt mu kx mv mw mx my bi translated"><em class="li"> areItemsTheSame </em> —该功能用于识别不同列表中的相同对象(例如通过<em class="li"> id </em>)。</li><li id="ad99" class="mq mr in kc b kd mz kh na kl nb kp nc kt nd kx mv mw mx my bi translated"><em class="li"> areContentsTheSame </em> —这个函数看起来和听起来都像前一个函数，但是它们不同。这一个用于在识别相同项目后比较内容(在第一个功能工作后)。</li><li id="ae06" class="mq mr in kc b kd mz kh na kl nb kp nc kt nd kx mv mw mx my bi translated">使用<a class="ae jz" href="https://kotlinlang.org/" rel="noopener ugc nofollow" target="_blank">Kotlin</a><a class="ae jz" href="https://kotlinlang.org/docs/data-classes.html" rel="noopener ugc nofollow" target="_blank">T5】数据类 </a>进行条目内容的比较，非常方便。</li></ul><h2 id="2caf" class="lq lr in bd ls lt lu dn lv lw lx dp ly kl lz ma mb kp mc md me kt mf mg mh mi bi translated">如何从 UI 类调用 magic？🌠</h2><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="0e2c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">就这些了，伙计们！🐷很简单，不是吗？感谢阅读，我希望你喜欢它，这篇文章会有用的！🙌别忘了媒体👏👏👏如果你喜欢这个。</p><p id="8533" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这个测试项目的完整代码你可以在这里找到<a class="ae jz" href="https://github.com/SerjantArbuz/AdapterExample" rel="noopener ugc nofollow" target="_blank"/>，你也可以自己安装 app 并检查。祝你好运！</p></div></div>    
</body>
</html>