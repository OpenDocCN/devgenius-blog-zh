<html>
<head>
<title>The Amazing World of SQL Unions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQL 联合的神奇世界</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/sql-union-d8da2536ddec?source=collection_archive---------12-----------------------#2022-07-23">https://blog.devgenius.io/sql-union-d8da2536ddec?source=collection_archive---------12-----------------------#2022-07-23</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/23c4a20e8a329543b80259a24d98979b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uiYmhDw5P7hVQJXl12kjFg.png"/></div></div></figure><p id="4a2b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="kt">在本文中，我们将讨论如何使用 UNION 操作符将多个 SELECT 查询合并成一个结果集，以及 UNION 的多种形式和 UNION 与 JOIN 之间的区别。</em></p></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><p id="1cc3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">了解组合查询</strong></p><p id="c8fa" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi lb translated"><span class="l lc ld le bm lf lg lh li lj di">大多数 SQL 查询中都有一个</span>单选择语句，它从一个或多个表中检索数据。使用 SQL 时，多个查询(许多 SELECT 语句)可以返回一个查询结果集。联合或复合查询是这些合并查询的传统名称。</p><p id="7009" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">对同一个表组合两个查询通常会获得与具有各种 WHERE 子句约束的单个查询相同的结果。换句话说，可以为任何包含多个 WHERE 子句的 SELECT 语句提供组合查询。</p><p id="c94c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">创建组合查询</strong></p><p id="e1c1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">使用<code class="fe lk ll lm ln b">UNION</code>操作符组合 SQL 查询。使用<code class="fe lk ll lm ln b">UNION</code>，您可以指定多个<code class="fe lk ll lm ln b">SELECT</code>语句，它们的结果可以组合成一个结果集。</p><p id="6c7b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">为什么组合查询</strong></p><ol class=""><li id="f5a0" class="lo lp in jx b jy jz kc kd kg lq kk lr ko ls ks lt lu lv lw bi translated">在单个查询中从不同的表中返回结构相似的数据。</li><li id="c5a7" class="lo lp in jx b jy lx kc ly kg lz kk ma ko mb ks lt lu lv lw bi translated">对单个表执行多个查询，并将数据作为一个查询返回。</li></ol><figure class="md me mf mg gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mc"><img src="../Images/bde88d23531e26645d5be5dee81da402.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i5c7C2HsZO0wZ6LUnGV7Qg.png"/></div></div></figure><p id="1f49" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们直接开始吧！</p><h2 id="83c6" class="mh mi in bd mj mk ml dn mm mn mo dp mp kg mq mr ms kk mt mu mv ko mw mx my mz bi translated"><em class="na">联管节</em>操作员</h2><p id="5f72" class="pw-post-body-paragraph jv jw in jx b jy nb ka kb kc nc ke kf kg nd ki kj kk ne km kn ko nf kq kr ks ig bi translated"><code class="fe lk ll lm ln b">Union</code>操作符从两个表中返回行。如果单独使用，<code class="fe lk ll lm ln b">UNION</code>将返回不同的行列表。使用<code class="fe lk ll lm ln b">UNION ALL</code>，返回两个表中的所有行。当您希望将两个独立查询的结果排序为一个组合结果时，<code class="fe lk ll lm ln b">UNION</code>非常有用。</p><figure class="md me mf mg gt jo gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/33a52ccbec64a3690dce7523d62dc953.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*YqjO8AR9U7HNKEZ2MpEAyA.png"/></div></figure><h2 id="ffc6" class="mh mi in bd mj mk ml dn mm mn mo dp mp kg mq mr ms kk mt mu mv ko mw mx my mz bi translated">交集运算符</h2><p id="16a9" class="pw-post-body-paragraph jv jw in jx b jy nb ka kb kc nc ke kf kg nd ki kj kk ne km kn ko nf kq kr ks ig bi translated">使用 intersect 运算符返回两个表之间共有的行；它从左右查询中返回唯一的行。当您想要查找两个查询之间的共同结果时，此查询非常有用。</p><figure class="md me mf mg gt jo gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/865f7583e333a09c07a41cde30e6f944.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*VnPEoFsxuJ36ppLjlIn4bw.png"/></div></figure><h2 id="51d7" class="mh mi in bd mj mk ml dn mm mn mo dp mp kg mq mr ms kk mt mu mv ko mw mx my mz bi translated">Except 运算符</h2><p id="ec66" class="pw-post-body-paragraph jv jw in jx b jy nb ka kb kc nc ke kf kg nd ki kj kk ne km kn ko nf kq kr ks ig bi translated">使用 EXCEPT 运算符只返回左侧查询中找到的行。它从左侧查询中返回右侧查询结果中没有的唯一行。当您希望查找一个集合中的行而不是另一个集合中的行时，此查询非常有用。例如，创建非客户的所有供应商的列表。</p><figure class="md me mf mg gt jo gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/28e58cfe1a1b23b04ff559b1ef72c420.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*yb3nOY94CVoFBG4xvCddUQ.png"/></div></figure></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h2 id="f9b5" class="mh mi in bd mj mk ml dn mm mn mo dp mp kg mq mr ms kk mt mu mv ko mw mx my mz bi translated"><code class="fe lk ll lm ln b"><strong class="ak">UNION</strong></code> <strong class="ak">规则</strong></h2><ol class=""><li id="4f3c" class="lo lp in jx b jy nb kc nc kg nh kk ni ko nj ks lt lu lv lw bi translated">一个 UNION 必须由两个或多个 SELECT 语句组成，用关键字 UNION 分隔(例如，如果要组合四个 SELECT 语句，就要使用三个 UNION 关键字)。</li><li id="13b4" class="lo lp in jx b jy lx kc ly kg lz kk ma ko mb ks lt lu lv lw bi translated">每个联合查询必须使用相同的列、表达式或聚合函数(一些 DBMSs 甚至要求列以相同的顺序列出)。</li><li id="1bfe" class="lo lp in jx b jy lx kc ly kg lz kk ma ko mb ks lt lu lv lw bi translated">列的数据类型必须兼容。它们不必具有相同的名称或类型，但必须是 DBMS 可以隐式转换的类型(例如，不同的数值类型或不同的日期类型)。</li></ol><h2 id="86be" class="mh mi in bd mj mk ml dn mm mn mo dp mp kg mq mr ms kk mt mu mv ko mw mx my mz bi translated"><strong class="ak">包含或消除重复行</strong></h2><p id="0cc7" class="pw-post-body-paragraph jv jw in jx b jy nb ka kb kc nc ke kf kg nd ki kj kk ne km kn ko nf kq kr ks ig bi translated">UNION 会自动删除查询结果集中的任何重复行(换句话说，它的行为就像单个 SELECT 中的多个 WHERE 子句条件一样)。</p><p id="086f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这是 UNION 的默认行为，但是如果您愿意，可以更改它。事实上，如果您希望返回所有匹配的所有事件，您可以使用 UNION ALL 而不是 UNION。</p><h2 id="ce41" class="mh mi in bd mj mk ml dn mm mn mo dp mp kg mq mr ms kk mt mu mv ko mw mx my mz bi translated"><strong class="ak">注</strong> : <strong class="ak">其他</strong> <code class="fe lk ll lm ln b"><strong class="ak">UNION</strong></code> <strong class="ak">类型</strong></h2><p id="d2f3" class="pw-post-body-paragraph jv jw in jx b jy nb ka kb kc nc ke kf kg nd ki kj kk ne km kn ko nf kq kr ks ig bi translated">一些 DBMSs 支持另外两种类型的联合。EXCEPT(也称为 MINUS)只能用于检索存在于第一个表中的行，而不能检索存在于第二个表中的行，而 INTERSECT 只能检索存在于两个表中的行。然而，在实践中，很少使用这些联合类型，因为联接可以获得相同的结果。</p><h2 id="581c" class="mh mi in bd mj mk ml dn mm mn mo dp mp kg mq mr ms kk mt mu mv ko mw mx my mz bi translated"><strong class="ak">注</strong>:</h2><p id="e0d2" class="pw-post-body-paragraph jv jw in jx b jy nb ka kb kc nc ke kf kg nd ki kj kk ne km kn ko nf kq kr ks ig bi translated">在实践中，当您需要组合来自多个表的数据时，<code class="fe lk ll lm ln b">UNION</code>非常有用，甚至是那些列名不匹配的表，在这种情况下，您可以将<code class="fe lk ll lm ln b">UNION</code>和别名组合起来检索一组结果。</p></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h2 id="86bb" class="mh mi in bd mj mk ml dn mm mn mo dp mp kg mq mr ms kk mt mu mv ko mw mx my mz bi translated">连接和联合的区别</h2><h2 id="7c9f" class="mh mi in bd mj mk ml dn mm mn mo dp mp kg mq mr ms kk mt mu mv ko mw mx my mz bi translated">连接</h2><ol class=""><li id="c0cb" class="lo lp in jx b jy nb kc nc kg nh kk ni ko nj ks lt lu lv lw bi translated">JOIN 根据多个表之间的匹配条件组合这些表中的数据。</li><li id="ae19" class="lo lp in jx b jy lx kc ly kg lz kk ma ko mb ks lt lu lv lw bi translated">它将数据合并到新列中。</li><li id="e4cb" class="lo lp in jx b jy lx kc ly kg lz kk ma ko mb ks lt lu lv lw bi translated">从每个表中选择的列数可能不同。</li><li id="cf61" class="lo lp in jx b jy lx kc ly kg lz kk ma ko mb ks lt lu lv lw bi translated">从每个表中选择的对应列的数据类型可以不同。</li><li id="e588" class="lo lp in jx b jy lx kc ly kg lz kk ma ko mb ks lt lu lv lw bi translated">它可能不会返回不同的列。</li></ol><h2 id="0b0e" class="mh mi in bd mj mk ml dn mm mn mo dp mp kg mq mr ms kk mt mu mv ko mw mx my mz bi translated">联盟</h2><ol class=""><li id="d2ef" class="lo lp in jx b jy nb kc nc kg nh kk ni ko nj ks lt lu lv lw bi translated">SQL 组合了两个或多个 SELECT 语句的结果集。</li><li id="1c96" class="lo lp in jx b jy lx kc ly kg lz kk ma ko mb ks lt lu lv lw bi translated">它将数据合并到新行中</li><li id="eacd" class="lo lp in jx b jy lx kc ly kg lz kk ma ko mb ks lt lu lv lw bi translated">从每个表中选择的列数应该相同。</li><li id="0336" class="lo lp in jx b jy lx kc ly kg lz kk ma ko mb ks lt lu lv lw bi translated">从每个表中选择的对应列的数据类型应该相同。</li><li id="03c2" class="lo lp in jx b jy lx kc ly kg lz kk ma ko mb ks lt lu lv lw bi translated">它返回不同的行。</li></ol></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h2 id="6763" class="mh mi in bd mj mk ml dn mm mn mo dp mp kg mq mr ms kk mt mu mv ko mw mx my mz bi translated">我希望你觉得这篇文章有趣！</h2></div></div>    
</body>
</html>