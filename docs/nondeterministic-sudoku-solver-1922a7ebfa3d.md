# 非确定性数独求解器

> 原文：<https://blog.devgenius.io/nondeterministic-sudoku-solver-1922a7ebfa3d?source=collection_archive---------18----------------------->

利用`amb`特殊形式解决球拍/方案中的数独

![](img/a4b43d49e7e4f99f32401e14867cdfed.png)

使用 amb 形式和逻辑编程风格解决数独

附带的代码可以在[这里找到](https://github.com/ericbreyer/NondeterministicSudoku)

# 灵感

我看到了这个视频，在视频中我被介绍给了 Amb 的接线员。它立即看起来像黑魔法，所以我研究了它的工作原理和实现。

# Amb

`amb`是模糊选择(nondeterminism)运算符。它接受一个可能性列表，并评估出一个允许程序成功的选项。在实践中，“amb”通常从左到右尝试其选项，但理论上，评估顺序并不重要，因此“不确定性”。

`assert`，有时也是`require`，定义了程序必须满足的谓词。如果断言失败，程序的当前分支被放弃，新的`amb`形式的可能性被尝试，直到断言成立。

这是我选择使用的`amb`的实现。
它定义了两个延续，一个成功(sk)和一个失败(fk)。成功延续是为了将`amb`的下一个可能性传递给。创建失败延续是为了在尝试路径之前捕获程序的状态。如果程序在这种可能性下失败了，它会放弃一切，将程序恢复到这个时间点，准备好继续进行下一个可能性的尝试(注意`...`，为每个可能性创建一个`call/cc` / `fk`“块”以允许`amb`在从失败中返回后尝试下一个可能性)。

由于在调用前一个`amb`的失败之前尝试`amb`的所有可能性的性质，为`amb`表单寻找一组有效选项的实际底层逻辑是深度优先搜索。在确定这种策略解决问题的效率时，理解这一点很有用(尽管迭代或传统的递归深度优先搜索可能比所有`call/cc`开销`amb`所需的更有效)。

进一步阅读和实现我查阅了:
-[http://community.schemewiki.org/?amb](http://community.schemewiki.org/?amb)
-[http://www.sfu.ca/~tjd/383summer2019/scheme-amb.html](http://www.sfu.ca/~tjd/383summer2019/scheme-amb.html)
-[http://wiki.c2.com/?AmbSpecialForm](http://wiki.c2.com/?AmbSpecialForm)
-[https://gist.github.com/Liudx1985/11308921](https://gist.github.com/Liudx1985/11308921)

# 逻辑编程

逻辑编程是一种编程风格，其中程序员:
1。陈述关于问题域的事实(比如数独方块的可能值)2。做出关于域的事实的断言(方块中的数字必须满足数独约束)
3。查询或提出问题，关于领域的事实(给出一个有效的数独)

这是一个声明性的而不是命令性的编程范例:告诉计算机**做什么**而不是**如何做**。

`amb`适合这种风格。
- `amb`语句是关于领域的事实
- `assert`语句是关于领域的断言
-询问变量值是一个查询

# 解决数独

这种风格应该使解决数独变得简单。它字面上叫做逻辑谜题。理论上，我们只需要用`(amb 1 2 3 4 5 6 7 8 9)`、`assert`填充所有的空白方格，让每一行都有唯一的数字，等等。，然后要求登板。这是可行的，但需要很长时间。首先声明所有的‘AMB’然后断言将搜索许多不需要搜索的死角(并且不会在适当的 DFS 算法中)。更好的方法是一个一个地走。

一个方块一个方块地检查和断言，减少了在永远不可能工作的路径中的大量搜索，就好像方块不工作，它永远不会进一步搜索。一次声明所有的`amb`总是从可能性树的最底层开始搜索，并把它变成一个更暴力的算法。

然后我们只需要在每一个未解的方块上运行这个函数。逻辑编程还在这里:
1。首先声明平方必须是整数 1-9
2。然后断言它必须满足数独规则
3。我们在解决每一个方块

后查询最终的棋盘，这是解决一个数独游戏所需的全部算法。剩下的代码是以正确的格式构建数独板，应用`solveSquare`，并创建一个 GUI。我觉得`amb`很吸引人，感觉仍然像魔术一样。你只需要告诉程序你想要什么，它就会创造和毁灭宇宙，让时间倒流，直到它神奇地产生一个有效的结果。

# 关于作者

Eric Breyer 是莱斯大学的计算机科学本科生。你可以在他的[网站](http://www.ericbreyer.com/)以及 [GitHub](https://github.com/ericbreyer) 和 [LinkedIn](https://www.linkedin.com/in/eric-breyer/) 上找到他。