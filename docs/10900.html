<html>
<head>
<title>Browser Testing With Laravel Dusk</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Laravel Dusk 进行浏览器测试</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/browser-testing-with-laravel-dusk-aeef2e8b30f8?source=collection_archive---------8-----------------------#2022-12-06">https://blog.devgenius.io/browser-testing-with-laravel-dusk-aeef2e8b30f8?source=collection_archive---------8-----------------------#2022-12-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="dcc7" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Laravel 从头开始创建管理面板——第 18 部分</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/89f54bc4fe28e39156f99102831381d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*Ogde7GbJZPgN8vegGjkWfA.png"/></div></figure><p id="4422" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">通常，后端开发人员使用 PHPUnit 来测试后端功能。默认的 Laravel 支持<a class="ae lj" href="https://laravel.com/docs/9.x/testing" rel="noopener ugc nofollow" target="_blank"> PHPUnit </a>。但是我们需要对应用进行端到端的测试，包括前端。为了实现这一点，我们需要使用浏览器测试。Laravel 也支持浏览器测试。</p><h1 id="9261" class="lk ll iq bd lm ln lo lp lq lr ls lt lu jw lv jx lw jz lx ka ly kc lz kd ma mb bi translated">拉勒维尔黄昏</h1><p id="f823" class="pw-post-body-paragraph kn ko iq kp b kq mc jr ks kt md ju kv kw me ky kz la mf lc ld le mg lg lh li ij bi translated">Laravel Dusk 是一个 Laravel 包，用于在 Laravel 应用程序上运行浏览器测试。</p><blockquote class="mh mi mj"><p id="c28d" class="kn ko mk kp b kq kr jr ks kt ku ju kv ml kx ky kz mm lb lc ld mn lf lg lh li ij bi translated">默认情况下，Dusk 不要求您在机器上安装 JDK 或 Selenium。相反，Dusk 使用一个独立的 chrome 驱动程序。但是，您可以随意使用任何其他 Selenium 驱动程序。</p></blockquote><h2 id="1a20" class="mo ll iq bd lm mp mq dn lq mr ms dp lu kw mt mu lw la mv mw ly le mx my ma mz bi translated">1.安装 Laravel 黄昏</h2><p id="2eb6" class="pw-post-body-paragraph kn ko iq kp b kq mc jr ks kt md ju kv kw me ky kz la mf lc ld le mg lg lh li ij bi translated">我们可以使用下面的 composer 命令添加黄昏包。</p><blockquote class="mh mi mj"><p id="d339" class="kn ko mk kp b kq kr jr ks kt ku ju kv ml kx ky kz mm lb lc ld mn lf lg lh li ij bi translated">如果您正在手动注册 Dusk 的服务提供者，您不应该在您的生产环境中注册它，因为这样做会导致任意用户能够通过您的应用程序进行身份验证。</p></blockquote><pre class="kg kh ki kj gt na nb nc bn nd ne bi"><span id="b942" class="nf ll iq nb b be ng nh l ni nj">./vendor/bin/sail composer require --dev laravel/dusk</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="gh gi nk"><img src="../Images/f9ba186df45ef742488db28c5f0d46d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GUxGkIqxp4zXXOHd5q_FCA.png"/></div></div></figure><p id="1439" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">添加包后，我们需要执行<code class="fe np nq nr nb b">dusk:install</code> Artisan 命令。</p><pre class="kg kh ki kj gt na nb nc bn nd ne bi"><span id="c1b8" class="nf ll iq nb b be ng nh l ni nj">./vendor/bin/sail artisan dusk:install</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="gh gi ns"><img src="../Images/49daa0de7398cbc7e21b84fe1e409aab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GRABnPATQrU2zw3TUAESfg.png"/></div></div></figure><p id="20de" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">这个<code class="fe np nq nr nb b">dusk:install</code>命令将在你的项目上创建一个<code class="fe np nq nr nb b">tests/Browser</code>目录。示例测试被添加到<code class="fe np nq nr nb b">ExampleTest.php</code>文件中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/75324074902083b07e4aa0d5838dc5d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/1*Sjlb7s1R_2LzQHpATyeJ5A.png"/></div></figure><h2 id="7799" class="mo ll iq bd lm mp mq dn lq mr ms dp lu kw mt mu lw la mv mw ly le mx my ma mz bi translated">2.URL 设置</h2><p id="e631" class="pw-post-body-paragraph kn ko iq kp b kq mc jr ks kt md ju kv kw me ky kz la mf lc ld le mg lg lh li ij bi translated">在中的<code class="fe np nq nr nb b">APP_URL</code>上指定正确的应用程序 URL。环境文件。通常，我们在 sail 中使用本地主机。</p><pre class="kg kh ki kj gt na nb nc bn nd ne bi"><span id="9113" class="nf ll iq nb b be ng nh l ni nj">APP_URL=http://localhost</span></pre><h2 id="37cf" class="mo ll iq bd lm mp mq dn lq mr ms dp lu kw mt mu lw la mv mw ly le mx my ma mz bi translated">3.环境设置</h2><p id="c4d4" class="pw-post-body-paragraph kn ko iq kp b kq mc jr ks kt md ju kv kw me ky kz la mf lc ld le mg lg lh li ij bi translated">你可以通过在下面的名字上创建一个环境文件来为黄昏创建你自己的环境文件。</p><p id="7947" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">在项目的根目录下创建一个<code class="fe np nq nr nb b">.env.dusk.{environment}</code>文件。例如，您应该创建一个<code class="fe np nq nr nb b">.env.dusk.local</code>文件。</p><p id="d44e" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">因此，您可以通过使用环境文件来更改用于黄昏测试的数据库。</p><h2 id="a9ff" class="mo ll iq bd lm mp mq dn lq mr ms dp lu kw mt mu lw la mv mw ly le mx my ma mz bi translated">4.运行测试</h2><p id="d5d8" class="pw-post-body-paragraph kn ko iq kp b kq mc jr ks kt md ju kv kw me ky kz la mf lc ld le mg lg lh li ij bi translated">为了理解黄昏测试，我们将分析并运行现有的<code class="fe np nq nr nb b">ExampleTest.php</code>测试。</p><p id="7485" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">ExampleTest.php 包含以下代码</p><pre class="kg kh ki kj gt na nb nc bn nd ne bi"><span id="0d9f" class="nf ll iq nb b be ng nh l ni nj">&lt;?php<br/><br/>namespace Tests\Browser;<br/><br/>use Illuminate\Foundation\Testing\DatabaseMigrations;<br/>use Laravel\Dusk\Browser;<br/>use Tests\DuskTestCase;<br/><br/>class ExampleTest extends DuskTestCase<br/>{<br/>    /**<br/>     * A basic browser test example.<br/>     *<br/>     * @return void<br/>     */<br/>    public function testBasicExample()<br/>    {<br/>        $this-&gt;browse(function (Browser $browser) {<br/>            $browser-&gt;visit('/')<br/>                    -&gt;assertSee('Laravel');<br/>        });<br/>    }<br/>}</span></pre><p id="155b" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><code class="fe np nq nr nb b">browse</code>方法将用于创建一个浏览器实例。然后使用 browser <code class="fe np nq nr nb b">visit</code>方法导航到应用程序中给定的 URI。</p><p id="1f9f" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">assertSee 是一个<a class="ae lj" href="https://laravel.com/docs/9.x/dusk#available-assertions" rel="noopener ugc nofollow" target="_blank">断言方法</a>,用于检查给定的文本是否出现在页面断言中。</p><p id="44ba" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我们可以通过启动 Sail 并运行<code class="fe np nq nr nb b">dusk</code>命令来运行 Dusk 测试套件</p><pre class="kg kh ki kj gt na nb nc bn nd ne bi"><span id="2af4" class="nf ll iq nb b be ng nh l ni nj">./vendor/bin/sail dusk</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="gh gi nu"><img src="../Images/6ba5ee824c5fca8bada1b8d7fe77dd63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H9gYzFaBAysIdGYvepWClg.png"/></div></div></figure><p id="8245" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">帆黄昏成功地执行，没有任何错误。</p><h2 id="b263" class="mo ll iq bd lm mp mq dn lq mr ms dp lu kw mt mu lw la mv mw ly le mx my ma mz bi translated">5.测试失败</h2><p id="4f33" class="pw-post-body-paragraph kn ko iq kp b kq mc jr ks kt md ju kv kw me ky kz la mf lc ld le mg lg lh li ij bi translated">当测试失败时，Dusk 会自动截图并保存到<code class="fe np nq nr nb b">screenshots</code>文件夹。</p><p id="bb75" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">现在，我们将通过将<code class="fe np nq nr nb b">assertSee</code>更改为其他文本来使您的测试失败。</p><pre class="kg kh ki kj gt na nb nc bn nd ne bi"><span id="664b" class="nf ll iq nb b be ng nh l ni nj">    public function testBasicExample()<br/>    {<br/>        $this-&gt;browse(function (Browser $browser) {<br/>            $browser-&gt;visit('/')<br/>                    -&gt;assertSee('Laravel not found');<br/>        });<br/>    }</span></pre><p id="ade7" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">这次<code class="fe np nq nr nb b">sail dusk</code>会显示保存在<code class="fe np nq nr nb b">tests\Browser\screenshots</code>文件夹中的错误信息和主页截图。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="gh gi nv"><img src="../Images/82ab8cb53b183b97381cc1b96fdce085.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M7eSFuDewIABsFLiZLBBbw.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/1f36596821cb835adc77f42211241119.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*WeFdkNAevKjaeIz6dwLEBw.png"/></div></figure><p id="a6db" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">主页的截图</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="gh gi nx"><img src="../Images/6bc390148326328d9e94ac20bab97c65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NYDsL-RbBjwalVL0r2_TNA.png"/></div></div></figure><p id="d276" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我们了解基本的 Laravel Dusk 测试套件是如何工作的。因此我们可以为零件创建自己的测试。</p></div><div class="ab cl ny nz hu oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="ij ik il im in"><p id="3806" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">Laravel 管理面板可在 https://github.com/balajidharma/basic-laravel-admin-panel 的<a class="ae lj" href="https://github.com/balajidharma/basic-laravel-admin-panel" rel="noopener ugc nofollow" target="_blank">获得。安装管理面板并分享您的反馈。</a></p></div><div class="ab cl ny nz hu oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="ij ik il im in"><p id="c9a5" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">感谢您的阅读。</p><p id="3279" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">敬请关注更多内容！</p><p id="1780" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><em class="mk">跟我来</em><a class="ae lj" href="https://balajidharma.medium.com/" rel="noopener"><strong class="kp ir"><em class="mk">balajidharma.medium.com</em></strong></a>。</p></div><div class="ab cl ny nz hu oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="ij ik il im in"><p id="64b1" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">上一部分—第 17 部分:<a class="ae lj" rel="noopener ugc nofollow" target="_blank" href="/how-to-debug-laravel-app-using-laravel-debugbar-ec51a8587786">如何使用 Laravel Debugbar 调试 Laravel App</a></p><p id="6f60" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">下一部分—第 19 部分:<a class="ae lj" rel="noopener ugc nofollow" target="_blank" href="/how-to-create-your-own-laravel-packages-2b68da22506a">如何创建自己的 Laravel 包</a></p></div></div>    
</body>
</html>