<html>
<head>
<title>Developing Azure Functions with .Net 6.0 and core tools</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用开发 Azure 函数。Net 6.0 和核心工具</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/developing-azure-functions-with-net-6-0-7-0-and-core-tools-48875ef3b85?source=collection_archive---------3-----------------------#2022-12-11">https://blog.devgenius.io/developing-azure-functions-with-net-6-0-7-0-and-core-tools-48875ef3b85?source=collection_archive---------3-----------------------#2022-12-11</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><p id="7740" class="pw-post-body-paragraph jo jp ir jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ik bi translated">我是 CLI 工具的忠实粉丝，尽管<strong class="jq is">Visual Studio</strong>&amp;<strong class="jq is">Visual Studio 代码</strong>提供了出色的支持，我还是想写一篇关于使用核心工具创建和运行 azure 函数的文章。</p><figure class="kn ko kp kq gu kr gi gj paragraph-image"><div class="gi gj km"><img src="../Images/0ac64e8a12b62a8992ce9ced5864db7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/format:webp/1*6iRqEJE9L8TO2UUboOUogg.png"/></div></figure><h1 id="a2ba" class="ku kv ir bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">先决条件</h1><p id="074f" class="pw-post-body-paragraph jo jp ir jq b jr ls jt ju jv lt jx jy jz lu kb kc kd lv kf kg kh lw kj kk kl ik bi translated">要继续，请确保您具备以下条件:</p><ul class=""><li id="5d76" class="lx ly ir jq b jr js jv jw jz lz kd ma kh mb kl mc md me mf bi translated">。Net 6 SDK ( <a class="ae mg" href="https://learn.microsoft.com/en-us/azure/azure-functions/dotnet-isolated-in-process-differences" rel="noopener ugc nofollow" target="_blank">)。Net 7 SDK 用于隔离工人</a>。运行命令<strong class="jq is">dot net—list-SDK</strong>来验证. net 的最新版本。</li><li id="8ba7" class="lx ly ir jq b jr mh jv mi jz mj kd mk kh ml kl mc md me mf bi translated"><a class="ae mg" href="https://learn.microsoft.com/en-us/azure/azure-functions/functions-run-local?tabs=v4%2Cwindows%2Ccsharp%2Cportal%2Cbash#install-the-azure-functions-core-tools" rel="noopener ugc nofollow" target="_blank"> Azure 功能核心工具</a>。运行命令<strong class="jq is">func–version</strong>确认 Azure function core tools 的最新版本。为了<a class="ae mg" href="https://learn.microsoft.com/en-us/azure/azure-functions/functions-run-local?tabs=v4%2Cwindows%2Ccsharp%2Cportal%2Cbash#changing-core-tools-versions" rel="noopener ugc nofollow" target="_blank">升级 azure function </a> core tools 的版本，使用 npm 命令:<strong class="jq is">NPM install-g azure-functions-core-tools @ 4—unsafe-perm true</strong></li></ul><blockquote class="mm"><p id="794f" class="mn mo ir bd mp mq mr ms mt mu mv kl dk translated"><a class="ae mg" href="https://learn.microsoft.com/en-us/azure/azure-functions/dotnet-isolated-process-guide#supported-versions" rel="noopener ugc nofollow" target="_blank"> Azure 不支持。Net 7 来创建进程内。Net Azure 函数。在进程中，Azure 函数支持. Net 的 LTS(长期支持)版本</a></p></blockquote><h1 id="27a2" class="ku kv ir bd kw kx ky kz la lb lc ld le lf mw lh li lj mx ll lm ln my lp lq lr bi translated">功能初始化</h1><p id="20af" class="pw-post-body-paragraph jo jp ir jq b jr ls jt ju jv lt jx jy jz lu kb kc kd lv kf kg kh lw kj kk kl ik bi translated">对 cmd 或 PowerShell 窗口上的进程内 azure 函数使用以下命令。</p><pre class="kn ko kp kq gu mz na nb bn nc nd bi"><span id="aa1f" class="ne kv ir na b be nf ng l nh ni">func init SampleProject</span></pre><p id="4b17" class="pw-post-body-paragraph jo jp ir jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ik bi translated"><strong class="jq is">选择点网</strong></p><figure class="kn ko kp kq gu kr gi gj paragraph-image"><div class="gi gj nj"><img src="../Images/42016f70270fdab067477d0e7a28c6b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*CIShYBjfi_ZGkKRSq_VsqA.png"/></div></figure><p id="4c1e" class="pw-post-body-paragraph jo jp ir jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ik bi translated"><strong class="jq is">选择 C# </strong></p><figure class="kn ko kp kq gu kr gi gj paragraph-image"><div class="gi gj nk"><img src="../Images/e5e1ba3c7bcdbf335779adc07d529024.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/1*uEA0cfusP0eRwFPq7oVLyw.png"/></div></figure><p id="f811" class="pw-post-body-paragraph jo jp ir jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ik bi translated">该命令将使用 func init 命令中提供的名称创建一个新文件夹。在我们的例子中，它将是 SampleProject。</p><figure class="kn ko kp kq gu kr gi gj paragraph-image"><div class="gi gj nl"><img src="../Images/164bc772fdfafac1d0f0c95b505d694c.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*P0DXGodSL9H8u1DXpf84gA.png"/></div></figure><p id="541f" class="pw-post-body-paragraph jo jp ir jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ik bi translated">目录 SampleProject 由以下文件组成:</p><figure class="kn ko kp kq gu kr gi gj paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gi gj nm"><img src="../Images/ead987db522e1cb58f68fce96d8f2012.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WpR1sLxoNswBdkfuvokLdw.png"/></div></div></figure><p id="efa7" class="pw-post-body-paragraph jo jp ir jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ik bi translated"><strong class="jq is"> local.settings.json </strong></p><ul class=""><li id="0e74" class="lx ly ir jq b jr js jv jw jz lz kd ma kh mb kl mc md me mf bi translated">Local.settings.json 保存本地开发的应用程序设置。我们不应该将这个文件签入到我们的代码库中。</li><li id="d71e" class="lx ly ir jq b jr mh jv mi jz mj kd mk kh ml kl mc md me mf bi translated">Azure 函数需要存储帐户才能执行。但是，在开发阶段，您并不需要。我们可以使用现有的存储帐户或标志<strong class="jq is"> UseDevelopmentStorage </strong>来指示本地开发。</li></ul><figure class="kn ko kp kq gu kr gi gj paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gi gj nr"><img src="../Images/a62bcfcfa132bb81870180e7a770020c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YjljYgRgOcj_FPhQhsa0dQ.png"/></div></div></figure><p id="be97" class="pw-post-body-paragraph jo jp ir jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ik bi translated"><strong class="jq is"> host.json </strong></p><p id="3869" class="pw-post-body-paragraph jo jp ir jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ik bi translated">host.json 文件包含运行时特定的配置。</p><h2 id="9115" class="ns kv ir bd kw nt nu dn la nv nw dp le jz nx ny li kd nz oa lm kh ob oc lq od bi translated"><strong class="ak">具有独立工作进程的 Azure 函数</strong></h2><p id="ab36" class="pw-post-body-paragraph jo jp ir jq b jr ls jt ju jv lt jx jy jz lu kb kc kd lv kf kg kh lw kj kk kl ik bi translated">运行下面提到的命令，使用隔离的工作进程创建 azure 函数。由于独立的工作进程支持. net7，我们可以使用 option -target-framework 来利用最新的。网络版。</p><pre class="kn ko kp kq gu mz na nb bn nc nd bi"><span id="5874" class="ne kv ir na b be nf ng l nh ni">func init SampleProj — worker-runtime dotnet-isolated — target-framework net7.0</span></pre></div><div class="ab cl oe of hv og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="ik il im in io"><h1 id="50e6" class="ku kv ir bd kw kx ol kz la lb om ld le lf on lh li lj oo ll lm ln op lp lq lr bi translated">新功能</h1><p id="25d4" class="pw-post-body-paragraph jo jp ir jq b jr ls jt ju jv lt jx jy jz lu kb kc kd lv kf kg kh lw kj kk kl ik bi translated">使用<strong class="jq is"> func new </strong>命令在功能应用程序中创建新功能。</p><figure class="kn ko kp kq gu kr gi gj paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gi gj oq"><img src="../Images/43ed039594036e35873799e029fb9f14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jXLZJOsWyOdcdRwr1JcVJQ.png"/></div></div></figure><p id="3587" class="pw-post-body-paragraph jo jp ir jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ik bi translated">我将使用 HttpTrigger。这意味着可以使用 HTTP URL 访问该函数。</p><p id="53bd" class="pw-post-body-paragraph jo jp ir jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ik bi translated">提供函数名:</p><figure class="kn ko kp kq gu kr gi gj paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gi gj or"><img src="../Images/b781a70a574663b10c77722c9da56b0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*518goLbhfG1Tplf57YPC8g.png"/></div></div></figure><figure class="kn ko kp kq gu kr gi gj paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gi gj os"><img src="../Images/31e7b65419cc3169beffeb07b95a064a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ecAxXK2yAzjh1nb_whVKrQ.png"/></div></div></figure><p id="d93d" class="pw-post-body-paragraph jo jp ir jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ik bi translated">让我们回顾一下创建的文件夹:</p><figure class="kn ko kp kq gu kr gi gj paragraph-image"><div class="gi gj ot"><img src="../Images/e4a8d72f6d61084dba7ab9516b0cf905.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*MnMGAocRa5bF2bIIyLjw3w.png"/></div></figure><h2 id="51f5" class="ns kv ir bd kw nt nu dn la nv nw dp le jz nx ny li kd nz oa lm kh ob oc lq od bi translated">功能 1.cs</h2><p id="3737" class="pw-post-body-paragraph jo jp ir jq b jr ls jt ju jv lt jx jy jz lu kb kc kd lv kf kg kh lw kj kk kl ik bi translated">此函数的入口点是 function1.cs。代码如下所示:</p><pre class="kn ko kp kq gu mz na nb bn nc nd bi"><span id="49f2" class="ne kv ir na b be nf ng l nh ni">using System;<br/>using System.IO;<br/>using System.Threading.Tasks;<br/>using Microsoft.AspNetCore.Mvc;<br/>using Microsoft.Azure.WebJobs;<br/>using Microsoft.Azure.WebJobs.Extensions.Http;<br/>using Microsoft.AspNetCore.Http;<br/>using Microsoft.Extensions.Logging;<br/>using Newtonsoft.Json;<br/>namespace SampleProject<br/>{<br/> public static class function1<br/> {<br/>   [FunctionName(“function1”)]<br/>   public static async Task&lt;IActionResult&gt; Run(<br/>   [HttpTrigger(AuthorizationLevel.Function, “get”, “post”, Route = null)] HttpRequest req,<br/>   ILogger log)<br/>   {<br/>   log.LogInformation(“C# HTTP trigger function processed a request.”);<br/>   string name = req.Query[“name”];<br/>   string requestBody = await new StreamReader(req.Body).ReadToEndAsync();<br/>   dynamic data = JsonConvert.DeserializeObject(requestBody);<br/>   name = name ?? data?.name;<br/>   string responseMessage = string.IsNullOrEmpty(name)<br/>   ? “This HTTP triggered function executed successfully. Pass a name in the query string or in the request body for a personalized response.”<br/>   : $”Hello, {name}. This HTTP triggered function executed successfully.”;<br/>   return new OkObjectResult(responseMessage);<br/>   }<br/> }<br/>}</span></pre></div><div class="ab cl oe of hv og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="ik il im in io"><h1 id="0a91" class="ku kv ir bd kw kx ol kz la lb om ld le lf on lh li lj oo ll lm ln op lp lq lr bi translated">功能启动</h1><p id="6087" class="pw-post-body-paragraph jo jp ir jq b jr ls jt ju jv lt jx jy jz lu kb kc kd lv kf kg kh lw kj kk kl ik bi translated">运行命令<strong class="jq is">‘func start’</strong>命令运行该功能</p><figure class="kn ko kp kq gu kr gi gj paragraph-image"><div class="gi gj ou"><img src="../Images/b37d1ffd38406e2485b17bd02059b9bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*Hh1F9Xl-9oBxgoB-Jih1fg.png"/></div></figure><p id="74ae" class="pw-post-body-paragraph jo jp ir jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ik bi translated">将函数 URL 放在浏览器中:</p><p id="86b0" class="pw-post-body-paragraph jo jp ir jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ik bi translated"><a class="ae mg" href="http://localhost:7071/api/function1" rel="noopener ugc nofollow" target="_blank">T5】http://localhost:7071/API/function 1T7】</a></p><figure class="kn ko kp kq gu kr gi gj paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gi gj ov"><img src="../Images/c50b0bbf10e22d14f8f80aa8167fa809.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CLbrG5pesExwhFWsc6Ob2Q.png"/></div></div></figure><p id="6176" class="pw-post-body-paragraph jo jp ir jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ik bi translated"><a class="ae mg" href="http://localhost:7071/api/function1?name=HelloWorld" rel="noopener ugc nofollow" target="_blank"><strong class="jq is">http://localhost:7071/API/function 1？name = hello world</strong>T11】</a></p><figure class="kn ko kp kq gu kr gi gj paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gi gj ov"><img src="../Images/a52ce3d30eb83cff1e33d1d4f37c8a4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XpEcun3f59UHeIPg_ueJUA.png"/></div></div></figure></div><div class="ab cl oe of hv og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="ik il im in io"><p id="3e73" class="pw-post-body-paragraph jo jp ir jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ik bi translated">页（page 的缩写）s-Medium 是一个阅读、写作和向其他作者学习的绝佳平台。如果你想加入我的旅程，今天就加入<a class="ae mg" href="https://tarunbhatt9784.medium.com/membership" rel="noopener"> medium </a>。</p></div></div>    
</body>
</html>