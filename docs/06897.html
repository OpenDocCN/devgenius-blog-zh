<html>
<head>
<title>Sends Contact Form via Sendgrid Marketing Campaigns API in NestJS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过 NestJS 中的 Sendgrid 营销活动 API 发送联系人表单</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/sends-contact-form-via-sendgrid-marketing-campaigns-api-in-nestjs-4fa6c096e1df?source=collection_archive---------20-----------------------#2022-02-09">https://blog.devgenius.io/sends-contact-form-via-sendgrid-marketing-campaigns-api-in-nestjs-4fa6c096e1df?source=collection_archive---------20-----------------------#2022-02-09</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="eb15" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">在 Sendgrid 营销活动 API 中收集潜在客户数据</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/c1ad8c2d7e60a0e57a9e5c9ec3ca78df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aqbT_sDIfrtTj1OD"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated"><a class="ae ks" href="https://unsplash.com/@storyfuel?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Melanie Deziel </a>在<a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="012c" class="kt ku in bd kv kw kx ky kz la lb lc ld jt le ju lf jw lg jx lh jz li ka lj lk bi translated">介绍</h1><p id="7061" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">Sendgrid 是一种电子邮件递送服务。根据 Sendgrid 官员的说法，</p><blockquote class="mh"><p id="20c9" class="mi mj in bd mk ml mm mn mo mp mq mg dk translated"><strong class="ak"> SendGrid 是一个基于云的 SMTP 提供商，允许您发送电子邮件，而无需维护电子邮件服务器。SendGrid 管理所有技术细节，从扩展基础设施到 ISP 拓展和信誉监控，再到白名单服务和实时分析。</strong></p></blockquote><figure class="ms mt mu mv mw kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mr"><img src="../Images/b36f7841a240b6ea3440b824ed400ea0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9OunWZug3e0BDdZ0.png"/></div></div></figure><p id="5248" class="pw-post-body-paragraph ll lm in ln b lo mx jo lq lr my jr lt lu mz lw lx ly na ma mb mc nb me mf mg ig bi translated">Sendgrid 可以帮助你发送电子邮件。那边主要有两个产品。</p><h2 id="d21a" class="nc ku in bd kv nd ne dn kz nf ng dp ld lu nh ni lf ly nj nk lh mc nl nm lj nn bi translated"><strong class="ak"> 1。电子邮件 API </strong></h2><p id="36ef" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">在那里，你可以发送电子邮件，创建电子邮件模板等。</p><h2 id="3bec" class="nc ku in bd kv nd ne dn kz nf ng dp ld lu nh ni lf ly nj nk lh mc nl nm lj nn bi translated"><strong class="ak"> 2。电子邮件营销</strong></h2><p id="8e89" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">对于此功能，您可以创建一个联系表单、选择细分、标记您的客户的订阅，等等。</p><p id="d889" class="pw-post-body-paragraph ll lm in ln b lo mx jo lq lr my jr lt lu mz lw lx ly na ma mb mc nb me mf mg ig bi translated">现在，我将和你们一起讨论电子邮件营销。</p><p id="cb13" class="pw-post-body-paragraph ll lm in ln b lo mx jo lq lr my jr lt lu mz lw lx ly na ma mb mc nb me mf mg ig bi translated">哦，看看这个。</p><ul class=""><li id="c65c" class="no np in ln b lo mx lr my lu nq ly nr mc ns mg nt nu nv nw bi translated">首先，如果你还没有在 Sendgrid 上创建帐户，我建议你创建它。</li><li id="eabb" class="no np in ln b lo nx lr ny lu nz ly oa mc ob mg nt nu nv nw bi translated">如果已经完成，登录并访问设置上的 API 键子菜单。</li></ul><p id="55a4" class="pw-post-body-paragraph ll lm in ln b lo mx jo lq lr my jr lt lu mz lw lx ly na ma mb mc nb me mf mg ig bi translated"><code class="fe oc od oe of b">Settings &gt; API Keys</code>。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi og"><img src="../Images/00abbc1d1893b9c16dd077e47f839182.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ULbKlcUlr5Cz5InCzEySxw.png"/></div></div></figure><p id="6a55" class="pw-post-body-paragraph ll lm in ln b lo mx jo lq lr my jr lt lu mz lw lx ly na ma mb mc nb me mf mg ig bi translated">并创建您的 API 密钥，在这一节中，我不会分享如何创建它，我假设您已经有了 API 密钥。</p><ul class=""><li id="789d" class="no np in ln b lo mx lr my lu nq ly nr mc ns mg nt nu nv nw bi translated">然后，转到营销菜单，然后转到自定义字段子菜单。</li></ul><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oh"><img src="../Images/fc9fd06e41fc8f87cd4449bda66a12d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AtDA6_fGNy5EQL3rOiV0kg.png"/></div></div></figure><p id="0e20" class="pw-post-body-paragraph ll lm in ln b lo mx jo lq lr my jr lt lu mz lw lx ly na ma mb mc nb me mf mg ig bi translated">请点击<code class="fe oc od oe of b">New Custom Field</code>。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oi"><img src="../Images/334b69774f9ae03c069e9dfd9798572e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9EgovWXWI7SBABUycdBUTQ.png"/></div></div></figure><p id="1160" class="pw-post-body-paragraph ll lm in ln b lo mx jo lq lr my jr lt lu mz lw lx ly na ma mb mc nb me mf mg ig bi translated">字段名就像 html 标签上的<code class="fe oc od oe of b">name</code>。我还没有试过这个单词在一个字段名上有 2 个或更多。比如<code class="fe oc od oe of b">firstname</code>，我不知道这个词应该是<code class="fe oc od oe of b">first_name</code>、<code class="fe oc od oe of b">firstName</code>还是 like，因为原来的词只是打字<code class="fe oc od oe of b">firstname</code>。</p><p id="99fa" class="pw-post-body-paragraph ll lm in ln b lo mx jo lq lr my jr lt lu mz lw lx ly na ma mb mc nb me mf mg ig bi translated">确定之后，选择字段类型。有<code class="fe oc od oe of b">text</code>、<code class="fe oc od oe of b">number</code>、<code class="fe oc od oe of b">date</code>。</p><p id="4baa" class="pw-post-body-paragraph ll lm in ln b lo mx jo lq lr my jr lt lu mz lw lx ly na ma mb mc nb me mf mg ig bi translated">然后，点击<code class="fe oc od oe of b">Create Field</code>。</p><p id="3736" class="pw-post-body-paragraph ll lm in ln b lo mx jo lq lr my jr lt lu mz lw lx ly na ma mb mc nb me mf mg ig bi translated">为你想要的做那些步骤。创建自定义字段后的下一步是代码会话。</p><ul class=""><li id="3f6c" class="no np in ln b lo mx lr my lu nq ly nr mc ns mg nt nu nv nw bi translated"><code class="fe oc od oe of b">Disclaimer</code>:这个环节是为了解 Nestjs 行为的你们准备的。因为我只穿我觉得重要的衣服。</li></ul><p id="d42e" class="pw-post-body-paragraph ll lm in ln b lo mx jo lq lr my jr lt lu mz lw lx ly na ma mb mc nb me mf mg ig bi translated">所以，打开你的文本编辑器，让我们来做魔术表演吧。</p><ul class=""><li id="188f" class="no np in ln b lo mx lr my lu nq ly nr mc ns mg nt nu nv nw bi translated">创建<code class="fe oc od oe of b">env</code>文件。添加<code class="fe oc od oe of b">SENDGRID_API_KEY</code>和<code class="fe oc od oe of b">SENDGRID_BASE_URL</code>。因为 API 的 url 是 https://api.sendgrid.com/<a class="ae ks" href="https://api.sendgrid.com/" rel="noopener ugc nofollow" target="_blank">的</a></li><li id="f6b2" class="no np in ln b lo nx lr ny lu nz ly oa mc ob mg nt nu nv nw bi translated">然后，创建控制器文件，</li></ul><pre class="kd ke kf kg gt oj of ok ol aw om bi"><span id="827f" class="nc ku in of b gy on oo l op oq">import { Controller, Post } from "@nestjs/common";<br/>const client = require('@sendgrid/client');<br/>require('dotenv').config();</span><span id="c53b" class="nc ku in of b gy or oo l op oq">@Controller('sendgrid')<br/>export class SendgridController {<br/>    @Post('contacts/store')<br/>        async store() {<br/>            client.setApiKey(process.env.SENDGRID_API_KEY);<br/>            client.setDefaultRequest({baseUrl: 'https://api.sendgrid.com/'});<br/>            const request = {<br/>                url: `/v3/marketing/field_definitions`,<br/>                method: 'GET',<br/>            }<br/>            let newCustomFields: any[] = []<br/>            let newReservedFields: any[] = []<br/>            return client.request(request)<br/>              .then(([response, body]) =&gt; {<br/>                  const { custom_fields: customFields, reserved_fields: reservedFields } = body<br/>                  newCustomFields = [...customFields]<br/>                  newReservedFields = [...reservedFields]<br/>                  return {<br/>                      newCustomFields,<br/>                      newReservedFields<br/>                  }<br/>               }).then(response =&gt; {<br/>                  const { newCustomFields, newReservedFields } = response<br/>                  const customFieldsPayload = {<br/>                      "harga_unit": "2000000000",<br/>                      "lokasi_unit": "Jakarta, Indonesia"<br/>                  }</span><span id="22b1" class="nc ku in of b gy or oo l op oq">                  const newObjPayload = {}<br/>                  newCustomFields.forEach(field =&gt; newObjPayload[field.id] = customFieldsPayload[field.name])<br/>                  return newObjPayload<br/>               }).then(response =&gt; {<br/>                  const data = {<br/>                      "contacts": [<br/>                          {<br/>                              "last_name": "Pandhu",<br/>                              "first_name": "Wibowo",<br/>                              "email": "pandhuspace@gmail.com",<br/>                              "custom_fields": {...response}<br/>                          }<br/>                      ]<br/>                  };<br/>                  const request = {<br/>                      url: `/v3/marketing/contacts`,<br/>                      method: 'PUT',<br/>                      body: data<br/>                  }<br/>                  return client.request(request)<br/>                    .then(([response, body]) =&gt; {<br/>                        console.log(response.statusCode);<br/>                        console.log(response.body);<br/>                        return 'OK'<br/>                    }).catch(error =&gt; {<br/>                        console.error(error.response.body);<br/>                        return error.response.body<br/>                    });<br/>                }).catch(error =&gt; {<br/>                    console.error(error);<br/>                    return error.response.body<br/>                });<br/>            }<br/>        }</span></pre><p id="3116" class="pw-post-body-paragraph ll lm in ln b lo mx jo lq lr my jr lt lu mz lw lx ly na ma mb mc nb me mf mg ig bi translated">不要忘记将您的控制器分配给模块。让我们试试你的邮差/失眠或者别的什么。</p><ul class=""><li id="f60a" class="no np in ln b lo mx lr my lu nq ly nr mc ns mg nt nu nv nw bi translated">最后一步，检查<code class="fe oc od oe of b">Contacts</code>子菜单中的数据。然后，单击全局类型。</li></ul><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oh"><img src="../Images/461369fee9dc4e8f7bb274ae4fadd150.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9B98wOFiY2uVjArpsfOnQQ.png"/></div></div></figure><p id="c690" class="pw-post-body-paragraph ll lm in ln b lo mx jo lq lr my jr lt lu mz lw lx ly na ma mb mc nb me mf mg ig bi translated">如果你选择一个，细节会是这样的。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi og"><img src="../Images/84ef090e11d6150de737763a5cd17db3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uJArMxWQEXdtpmiSe8_s5Q.png"/></div></div></figure><p id="5940" class="pw-post-body-paragraph ll lm in ln b lo mx jo lq lr my jr lt lu mz lw lx ly na ma mb mc nb me mf mg ig bi translated">所有步骤都已经完成。现在，轮到你来试试了。感谢阅读，快乐的编码伙伴们！！！</p><h1 id="2a08" class="kt ku in bd kv kw kx ky kz la lb lc ld jt le ju lf jw lg jx lh jz li ka lj lk bi translated">警惕！</h1><p id="a492" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">如果你们来自<strong class="ln io">印度尼西亚</strong>并且想要支持我更多的写作，希望你们能从钱包里拿出一点来。你可以通过一些方式分享你的天赋，</p><h2 id="b9c6" class="nc ku in bd kv nd ne dn kz nf ng dp ld lu nh ni lf ly nj nk lh mc nl nm lj nn bi translated">萨韦里亚</h2><p id="a572" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated"><a class="ae ks" href="https://saweria.co/pandhuwibowo" rel="noopener ugc nofollow" target="_blank">https://saweria.co/pandhuwibowo</a></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi os"><img src="../Images/0089e6c52b43886c90f7f853a7b8a73b.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*xFmG4J1rW-MHyEqO_mzIaw.png"/></div></figure><h2 id="b9fb" class="nc ku in bd kv nd ne dn kz nf ng dp ld lu nh ni lf ly nj nk lh mc nl nm lj nn bi translated">特拉克特尔</h2><p id="c63d" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated"><a class="ae ks" href="https://trakteer.id/goodpeopletogivemoney" rel="noopener ugc nofollow" target="_blank">https://trakteer.id/goodpeopletogivemoney</a></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/d26e4901a3c5106b7c99a3c8a99d74a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:536/format:webp/1*Q-ZYOzqJ6R3ijDlVlM5JMw.jpeg"/></div></figure></div></div>    
</body>
</html>