<html>
<head>
<title>How to containerize Python application with Docker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用 Docker 容器化 Python 应用</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-containerize-python-application-with-docker-ce930b192c68?source=collection_archive---------13-----------------------#2022-09-15">https://blog.devgenius.io/how-to-containerize-python-application-with-docker-ce930b192c68?source=collection_archive---------13-----------------------#2022-09-15</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><figure class="im in gp gr io ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/656b26dd42a963865578405165e19a20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YMDaAnQdbBi5ys5VhZ-CGA.png"/></div></div></figure><div class=""/><p id="732a" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx iz">目录</strong></p><ol class=""><li id="4334" class="kt ku iy jx b jy jz kc kd kg kv kk kw ko kx ks ky kz la lb bi translated">为什么要用 dockers？</li><li id="5a3b" class="kt ku iy jx b jy lc kc ld kg le kk lf ko lg ks ky kz la lb bi translated">创建自动化 Python 脚本</li><li id="0a03" class="kt ku iy jx b jy lc kc ld kg le kk lf ko lg ks ky kz la lb bi translated">为 Python 脚本创建 Docker 文件</li><li id="af5e" class="kt ku iy jx b jy lc kc ld kg le kk lf ko lg ks ky kz la lb bi translated">为 Python 脚本生成 Docker 图像</li><li id="4f62" class="kt ku iy jx b jy lc kc ld kg le kk lf ko lg ks ky kz la lb bi translated">运行需要人工输入 docker 图像</li></ol><p id="c609" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx iz"> 1。为什么要用 dockers？</strong></p><p id="4a4f" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">Docker 使开发者能够通过使用容器来开发和部署应用程序。容器是一个软件包，它允许开发人员将应用程序与其可执行文件、需求、配置、库打包在一起；简而言之，运行该特定应用程序所需的一切。我们收到的最终产品是 Docker 图像。通过创建 Docker 映像，开发人员不必担心应用程序能否在任何给定的系统上正确执行。这个过程减少了应用程序的部署时间，并使用了最少的客户端系统资源。现在让我们向码头工人的世界迈出第一步，创造我们自己的码头工人形象。对于本教程，我假设你已经安装了 Docker 和 Python。</p><p id="5868" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx iz"> 2。创建自动化 Python 脚本</strong></p><p id="1636" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">你曾经觉得你不知道该看什么，只是想感到惊讶，那么我给你掩护，我的朋友。让我们编写一个快速的 python 脚本，从 IMDB 中抓取 250 部收视率最高的电影，并向您推荐一部随机电影。因为这是一篇与 Docker 相关的文章，所以我们不会深入 python 脚本的细节。</p><figure class="lh li lj lk gt ip"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="f043" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx iz"> 3。为 Python 脚本创建 Docker 文件</strong></p><p id="8844" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">一旦我们有了 python 脚本，我们需要创建一个 docker 文件。docker 文件基本上是构建图像的蓝图。Docker 映像是运行容器(即您的应用程序)的模板。现在在同一个目录中创建一个名为 Dockerfile 的文件。我建议使用 visual studio 代码，因为它有微软认证的 Docker 扩展。</p><p id="e66b" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">编写 Docker 文件的第一步是指定基本映像。因为我们正在使用 python，所以我们将使用 python 图像。</p><p id="4669" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe ln lo lp lq b">FROM python:3.8</code></p><p id="2834" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">接下来，我们需要在 Docker 文件中添加可执行代码，在本例中是我们的。py 文件。指定的格式是:</p><ol class=""><li id="6e4f" class="kt ku iy jx b jy jz kc kd kg kv kk kw ko kx ks ky kz la lb bi translated">“添加”命令</li><li id="37ee" class="kt ku iy jx b jy lc kc ld kg le kk lf ko lg ks ky kz la lb bi translated">后跟可执行文件的名称“file.py”</li><li id="0971" class="kt ku iy jx b jy lc kc ld kg le kk lf ko lg ks ky kz la lb bi translated">然后是我们的 exe 文件的目的地，在这个例子中是“.”因为我们的代码在同一个目录中</li></ol><p id="7a77" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe ln lo lp lq b">ADD main.py .</code></p><p id="47a2" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">之后，我们需要安装第三方库。其格式为:</p><ol class=""><li id="d769" class="kt ku iy jx b jy jz kc kd kg kv kk kw ko kx ks ky kz la lb bi translated">命令“运行”</li><li id="ea69" class="kt ku iy jx b jy lc kc ld kg le kk lf ko lg ks ky kz la lb bi translated">接下来是“pip 安装”</li><li id="b4a5" class="kt ku iy jx b jy lc kc ld kg le kk lf ko lg ks ky kz la lb bi translated">后跟所需库的名称</li></ol><p id="5100" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe ln lo lp lq b">RUN pip install beautifulsoup4 requests</code></p><p id="70b5" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">最后是容器运行时执行的命令语句。</p><p id="abf6" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe ln lo lp lq b">CMD ["python" , "./main.py"]</code></p><p id="3e2f" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">您的 docker 文件应该如下所示:</p><figure class="lh li lj lk gt ip"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="5266" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">瞧啊。你的文件准备好了。</p><p id="bf07" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx iz"> 4。为 Python 脚本生成 Docker 图像</strong></p><p id="975f" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在让我们建立一个 docker 图像。在终端中执行命令</p><p id="0bfa" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe ln lo lp lq b">docker build -t movie-randomizer .</code></p><p id="abe3" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">此命令中的“.”最后指定 docker 文件的目的地。执行该命令后，您最终得到了 docker 图像。</p><p id="0d9a" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">接下来，我们需要运行 docker 映像，为此我们将使用命令</p><p id="b174" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe ln lo lp lq b">docker run movie-randomizer</code></p><p id="4585" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这应该会给你这样的输出</p><p id="0935" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe ln lo lp lq b">Good Will Hunting (1997) Rating: 8.3 Starring: Gus Van Sant (dir.), Robin Williams, Matt Damon</code></p><p id="3db0" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">恭喜你！！！你终于编写了你的第一个 python 脚本并成功执行了它。</p><p id="0012" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx iz"> 5。运行需要人工输入的 docker 映像</strong></p><p id="f33b" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在，让我们说，我们需要运行一个脚本，其中包括某种人类交互。让我们修改一下我们的 python 脚本，以防我们已经看过了建议的电影并想跳过它。在代码中实现以下更改。</p><figure class="lh li lj lk gt ip"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="28ac" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在构建 docker 映像并执行<code class="fe ln lo lp lq b">docker run movie-randomizer</code></p><p id="0830" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这将导致:</p><p id="ec33" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe ln lo lp lq b">tmp = input(“Would you like another suggestion? kindly type [y]es or [n]o. “)<br/>EOFError: EOF when reading a line</code></p><p id="28bc" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了避免这种错误，我们需要在运行映像时进行一些更改。您需要使用的命令是:</p><p id="d503" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe ln lo lp lq b">docker run -i -t movie-randomizer</code></p><p id="9ed5" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这里的“-i”代表用户输入的交互模式，而“-t”代表 sudo 终端，即用户可以书写他/她的输入的终端。执行该命令后，您已经学会了如何运行交互式 docker 图像。</p><p id="f5a4" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这是所有的乡亲。愿原力与你同在！</p></div></div>    
</body>
</html>