# React 的自定义钩子初学者指南

> 原文：<https://blog.devgenius.io/how-to-use-custom-hooks-in-react-to-fetch-data-2862c8e417f5?source=collection_archive---------8----------------------->

在这篇博客中，我们将学习如何开始使用 React 中的定制钩子。

我们将首先使用以下命令创建一个 React 应用程序:

一旦脚本执行完毕，您希望将目录更改为 **my-app** 并运行 **npm run start** 或者如果您使用 yarn 作为包管理器，请运行 yarn start，这将打开[T5 上的开发服务器。](http://localhost:3000)

我们将在编写任何代码之前进行一些清理，您想要删除 logo，从 **App.css** 中删除全部内容，从 **index.css** 中删除全部内容，从 **App.js** 中的 header 标记中删除 **jsx** 并删除 **App.js 中的所有 import 语句。**最后删除 **React。来自 **index.js** 文件的 StrictMode** 代码。现在你应该有更清晰的代码来完成工作了。现在你想安装 **axios** 来帮助我们使用公共 API 获取数据。

我们将在 **src** 下创建一个 **hooks** 目录，并创建一个名为 **useFetchData.js.** 的文件，在该文件中我们将有以下代码。我稍后会解释我们正在做什么。

自定义钩子只是 javascript 函数，函数名以**开头，使用**。**使用**的目的是让 React 知道这不是一个常规函数，但它需要被视为钩子，然后允许 React 控制该函数的使用，以遵循钩子的标准和规则。现在我们知道了什么是定制钩子，让我们探索一下使用定制钩子的一些好处。

定制钩子允许我们在函数中使用内置钩子，而不需要功能组件，它帮助我们将业务逻辑从组件中抽象出来，使组件的代码更加清晰可读，显然使用定制钩子还有很多好处。

让我们研究一下我们之前添加的代码，以了解发生了什么。

场景:我们正在尝试从公共 API 中获取数据，在那里我们将获得随机的狗图像，这些图像将用于在 UI 中显示。

**执行:**在第 4–6 行中，我们设置状态来管理我们的**加载**、**成功**和**失败**状态。

我们将创建一个依赖于 **url** 的 **useEffect** 钩子，每次组件调用这个定制钩子并且 url 改变时，我们将获取数据。

在运行 axios 获取数据之前，我们将 *loading* 状态设置为 true，这意味着我们即将发出请求或者我们处于请求周期的中间。如果请求成功，我们将进入第 12 行的程序块，其中将把*加载*状态设置为*假*，并将**数据**设置为*数据*状态。如果出现某种网络错误或请求没有通过，我们将在 **catch** 块中处理错误，并在第 31 行设置错误消息，同时将*加载*状态设置为 *false* 。

我们正在定义一个名为 **fetchMoreData** 的函数，它与 **useEffect** 具有相同的内容，这个函数的目的是当我们的组件中有 *onClick* 事件时触发 fetch，我们将在后面的博客中探讨。

现在，在我们的定制钩子上唯一未完成的任务是导出一个带有 *loading* 、 *data* 、 *error 和 fetchMoreData* 函数的对象，我们将在我们的组件中使用这些函数。现在，我们已经完成了我们的定制钩子，我们可以继续对 **App.js** 文件进行修改。

这就是我们将要添加到我们的 **App.js** 文件中的内容。稍后我会解释这是怎么回事。

在 **App.js** 中，我们正在导入我们之前构建的定制钩子。在第 4 行，我们将请求 url 作为参数传递给我们的自定义钩子。由于这个钩子返回了一个对象，我们正在对进行*析构，以获得*正在加载*、*数据*、*错误*和 *fetchMoreData* 来管理我们 UI 中的各种状态。*

我们的 *html* 非常简单，我们有一个带有 *onClick* 的按钮，在这里我们调用 *fetchMoreData* ，这将在我们每次点击按钮时触发 API 调用。如果*加载*状态为*真*，我们显示 *h2* 标签和加载…文本，如果有*数据*我们通过从*数据*对象中获取消息数据字段来显示图像，如果有*错误*我们在 h2 标签内显示*错误*。

这就是使用定制钩子获取数据所需的全部内容。祝贺您，您已经成功创建了一个自定义挂钩。

如果你喜欢博客，请在 [github](https://github.com/sudiparyal185) 上关注我。

您可以在以下网址找到完整的源代码:

[](https://github.com/sudiparyal185/custom-hook-to-fetch-data) [## GitHub-sudiparyal 185/custom-hook-to-fetch-data:这使用自定义钩子从公共…

### 这个项目是用 Create React App 引导的。在项目目录中，您可以运行:在…中运行应用程序

github.com](https://github.com/sudiparyal185/custom-hook-to-fetch-data) 

请关注我更多编程博客。谢谢你。