<html>
<head>
<title>How to secure your data when applications enter in the background?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">当应用程序进入后台时，如何保护您的数据？</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-secure-your-data-when-applications-enter-in-the-background-8675970817e2?source=collection_archive---------22-----------------------#2020-06-16">https://blog.devgenius.io/how-to-secure-your-data-when-applications-enter-in-the-background-8675970817e2?source=collection_archive---------22-----------------------#2020-06-16</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><figure class="im in gp gr io ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/0521f40bd68581b418380734cbe52788.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QRYrbCDXcDmUU9fK66YgAA.jpeg"/></div></div></figure><div class=""/><p id="7df6" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们大多数人在使用应用程序时，或者当我们丢失手机时，或者当我们的手机锁定时，都很关心数据。你从来没有想过:app在后台会怎么样，我的数据安全吗？嗯，它们可能是，但这取决于我们如何保存数据和您如何使用您的设备的实施。</p><p id="5be9" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在移动安全体验中，最看重的是用户如何使用手机。实现高安全性是开发人员和用户之间的终生伙伴关系。他们中没有一个人能够单独保护数据。用户应该对他们使用手机的方式负责，信任OEM并为服务付费，而不是欺骗系统来获得更多免费的东西，因为在工业社会没有什么是免费的。</p><h1 id="c12c" class="kt ku iy bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">当你的手机应用程序进入后台时会发生什么？</h1><figure class="ls lt lu lv gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi lr"><img src="../Images/44bd54ca1794cfcc97c6a548621844b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IXMoBfmWCg9jBUdF"/></div></div></figure><p id="41dd" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在IOS中，当应用程序进入后台时，操作系统会拍摄当前屏幕的快照，并保存它，以便在我们打开后台进程时提供实时的应用程序外观。还有一点需要提及的是，当我们将应用程序放在后台时，只要操作系统没有超出我们可以自己做出正确决定的内存，IOS就不会破坏数据和ViewController实例。</p><pre class="ls lt lu lv gt lw lx ly lz aw ma bi"><span id="ba6d" class="mb ku iy lx b gy mc md l me mf">override func didReceiveMemoryWarning() {</span><span id="2ed8" class="mb ku iy lx b gy mg md l me mf">&lt;#code#&gt;</span><span id="e503" class="mb ku iy lx b gy mg md l me mf">}</span></pre><h1 id="6727" class="kt ku iy bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">黑盒里发生了什么？</h1><p id="f36b" class="pw-post-body-paragraph jv jw iy jx b jy mh ka kb kc mi ke kf kg mj ki kj kk mk km kn ko ml kq kr ks ig bi translated">当你的应用程序在后台移动时，操作系统会给你的当前视图拍一张快照，当你按两次home键时，它就可以用在应用程序选择器中。当应用程序在后台运行时，应用程序不应该做任何保留资源的操作。IOS本身冻结了所有正在进行的活动，并允许我们通过释放我们在这个时间分配的所有资源来这样做，就像I/O操作保存正在进行的工作一样。将使用操作系统拍摄的快照，而不是保持应用程序运行，并将在应用程序返回前台或关闭后删除。因为它是保存在我们设备中的快照，所以我们有一些安全隐患。</p><ol class=""><li id="f615" class="mm mn iy jx b jy jz kc kd kg mo kk mp ko mq ks mr ms mt mu bi translated">如果有人能够访问设备，他们可以提取位于应用程序包中的快照。</li><li id="6f36" class="mm mn iy jx b jy mv kc mw kg mx kk my ko mz ks mr ms mt mu bi translated">如果我们与其他人共享该设备，即使由于我们实施的生物识别验证，他们无法打开应用程序，他们也可以通过双击home键轻松查看该快照。拍摄的机密数据仍然可见且易于阅读。(见上图)</li></ol><h1 id="7cd6" class="kt ku iy bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">解决办法？</h1><p id="522f" class="pw-post-body-paragraph jv jw iy jx b jy mh ka kb kc mi ke kf kg mj ki kj kk mk km kn ko ml kq kr ks ig bi translated">IOS为我们提供了跟踪应用程序何时进入后台的可能性，因此，我们可以采取措施保护特定数据不被拍摄快照。我们可以用两种方法做到这一点。</p><ul class=""><li id="52b0" class="mm mn iy jx b jy jz kc kd kg mo kk mp ko mq ks na ms mt mu bi translated">通过对所有屏幕实施此解决方案来隐藏所有内容</li><li id="fb78" class="mm mn iy jx b jy mv kc mw kg mx kk my ko mz ks na ms mt mu bi translated">当我们认为相关时，通过实施此解决方案仅隐藏敏感数据。</li></ul><p id="bfe0" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="nb">实现整个app的快照数据防止:</em></p><pre class="ls lt lu lv gt lw lx ly lz aw ma bi"><span id="38d7" class="mb ku iy lx b gy mc md l me mf">lazy var imageView : UIImageView = {</span><span id="cabe" class="mb ku iy lx b gy mg md l me mf">let imgView = UIImageView(frame: window!.frame)</span><span id="a05b" class="mb ku iy lx b gy mg md l me mf">imgView.image = UIImage(named: "secret")</span><span id="06c2" class="mb ku iy lx b gy mg md l me mf">return imgView</span><span id="ca0b" class="mb ku iy lx b gy mg md l me mf">}()</span><span id="9d90" class="mb ku iy lx b gy mg md l me mf">func applicationWillResignActive(_ application: UIApplication) {</span><span id="70f9" class="mb ku iy lx b gy mg md l me mf">self.window?.addSubview(imageView)</span><span id="9223" class="mb ku iy lx b gy mg md l me mf">}</span><span id="7af3" class="mb ku iy lx b gy mg md l me mf">func applicationWillEnterForeground(_ application: UIApplication) {</span><span id="7e13" class="mb ku iy lx b gy mg md l me mf">self.imageView.removeFromSuperview()</span><span id="8f7f" class="mb ku iy lx b gy mg md l me mf">}</span></pre><p id="ed2b" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为整个应用程序实施快照阻止:</p><pre class="ls lt lu lv gt lw lx ly lz aw ma bi"><span id="947c" class="mb ku iy lx b gy mc md l me mf">override func viewDidLoad() {</span><span id="b542" class="mb ku iy lx b gy mg md l me mf">super.viewDidLoad()</span><span id="b7e5" class="mb ku iy lx b gy mg md l me mf">// Do any additional setup after loading the view.</span><span id="9255" class="mb ku iy lx b gy mg md l me mf">NotificationCenter.default.addObserver(forName: UIApplication.willResignActiveNotification, object: nil, queue: OperationQueue.main, using: {</span><span id="6efe" class="mb ku iy lx b gy mg md l me mf">_ in</span><span id="154c" class="mb ku iy lx b gy mg md l me mf">print("In Background")</span><span id="8e6c" class="mb ku iy lx b gy mg md l me mf">self.secureView.text = "I replaced secret Content"</span><span id="b05b" class="mb ku iy lx b gy mg md l me mf">})</span><span id="c0f7" class="mb ku iy lx b gy mg md l me mf">NotificationCenter.default.addObserver(forName: UIApplication.didBecomeActiveNotification, object: nil, queue: OperationQueue.main, using: {</span><span id="0575" class="mb ku iy lx b gy mg md l me mf">_ in</span><span id="9caa" class="mb ku iy lx b gy mg md l me mf">print("In Background")</span><span id="4097" class="mb ku iy lx b gy mg md l me mf">self.secureView.text = "I am very secret content!"</span><span id="a52a" class="mb ku iy lx b gy mg md l me mf">})</span><span id="619d" class="mb ku iy lx b gy mg md l me mf">}</span><span id="ef83" class="mb ku iy lx b gy mg md l me mf">override func viewWillDisappear(_ animated: Bool) {</span><span id="ae6d" class="mb ku iy lx b gy mg md l me mf">NotificationCenter.default.removeObserver(self)</span><span id="d83b" class="mb ku iy lx b gy mg md l me mf">super.viewWillDisappear(animated)</span><span id="31ad" class="mb ku iy lx b gy mg md l me mf">}</span></pre><p id="b347" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">Android实现简单，和IOS一脉相承。我发现把它们都加在这里很琐碎，但是如果你需要任何帮助，请联系我。</p><p id="9427" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">希望这篇文章对你提高应用程序的安全性有所帮助。如果你需要任何帮助或建议，请随时联系我。</p><p id="add2" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">实现细节<a class="ae nc" href="https://github.com/EsmeraldiBejolli/secure-background-snapshot" rel="noopener ugc nofollow" target="_blank"> GitHub </a></p><p id="27a3" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">关注我的<a class="ae nc" href="https://www.linkedin.com/in/esmeraldi-bejolli/" rel="noopener ugc nofollow" target="_blank">链接</a></p><p id="a152" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果您想了解更多关于移动安全的信息，欢迎加入<a class="ae nc" href="https://www.linkedin.com/groups/8839523/" rel="noopener ugc nofollow" target="_blank">移动安全</a>小组</p></div></div>    
</body>
</html>