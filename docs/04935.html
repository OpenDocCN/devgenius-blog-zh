<html>
<head>
<title>How to Build a Datepicker Component with Vue.js 3?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Vue.js 3构建一个Datepicker组件？</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-build-a-datepicker-component-with-vue-js-3-5ea46e04e150?source=collection_archive---------2-----------------------#2021-05-24">https://blog.devgenius.io/how-to-build-a-datepicker-component-with-vue-js-3-5ea46e04e150?source=collection_archive---------2-----------------------#2021-05-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/7373071694110edc1d99ba77bb5f2e29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Q8LsHCZHphr9p6Jh"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@jasonthedesigner?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">杰森·理查德</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="5d5f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有时，我们想在Vue 3应用程序中构建自己的日期选择器组件，让用户选择日期。</p><p id="eee7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看如何用Vue 3构建一个日期选择器组件。</p><h1 id="5692" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">用Vue.js 3构建一个Datepicker组件</h1><p id="ecbc" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过创建一个接受<code class="fe me mf mg mh b">modelValue</code>属性并发出<code class="fe me mf mg mh b">update:modelValue</code>事件的组件来构建我们自己的输入组件。</p><p id="132f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这两件事合在一起就和<code class="fe me mf mg mh b">v-model</code>指令一样。</p><p id="a7ae" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们可以编写以下代码来创建一个日期选择器并使用它。</p><p id="9646" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">App.vue</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="68c6" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;DatePicker v-model="date" /&gt;<br/>  &lt;p&gt;{{ date }}&lt;/p&gt;<br/>&lt;/template&gt;</span><span id="4630" class="mq lc iq mh b gy mv ms l mt mu">&lt;script&gt;<br/>import DatePicker from "./components/DatePicker.vue";</span><span id="3085" class="mq lc iq mh b gy mv ms l mt mu">export default {<br/>  name: "App",<br/>  components: {<br/>    DatePicker,<br/>  },<br/>  data() {<br/>    return {<br/>      date: new Date(2020, 1, 1),<br/>    };<br/>  },<br/>};<br/>&lt;/script&gt;</span></pre><p id="892b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">components/DatePicker.vue</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="2ebe" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div id="date-picker"&gt;<br/>    &lt;div&gt;<br/>      &lt;label&gt;year&lt;/label&gt;<br/>      &lt;br /&gt;<br/>      &lt;select v-model="year"&gt;<br/>        &lt;option v-for="y in years" :key="y"&gt;<br/>          {{ y }}<br/>        &lt;/option&gt;<br/>      &lt;/select&gt;<br/>    &lt;/div&gt;<br/>    &lt;div&gt;<br/>      &lt;label&gt;month&lt;/label&gt;<br/>      &lt;br /&gt;<br/>      &lt;select v-model="month"&gt;<br/>        &lt;option v-for="m in 12" :key="m" :value="m - 1"&gt;<br/>          {{ m }}<br/>        &lt;/option&gt;<br/>      &lt;/select&gt;<br/>    &lt;/div&gt;<br/>    &lt;div&gt;<br/>      &lt;label&gt;day&lt;/label&gt;<br/>      &lt;br /&gt;<br/>      &lt;select v-model="day"&gt;<br/>        &lt;option v-for="d in maxDate" :key="d"&gt;<br/>          {{ d }}<br/>        &lt;/option&gt;<br/>      &lt;/select&gt;<br/>    &lt;/div&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="958a" class="mq lc iq mh b gy mv ms l mt mu">&lt;style scoped&gt;<br/>#date-picker {<br/>  display: flex;<br/>}</span><span id="01ff" class="mq lc iq mh b gy mv ms l mt mu">#date-picker div {<br/>  margin-right: 10px;<br/>}<br/>&lt;/style&gt;</span><span id="7d86" class="mq lc iq mh b gy mv ms l mt mu">&lt;script&gt;<br/>import moment from "moment";</span><span id="a66b" class="mq lc iq mh b gy mv ms l mt mu">export default {<br/>  name: "DatePicker",<br/>  props: {<br/>    modelValue: Date,<br/>  },<br/>  data() {<br/>    return {<br/>      years: [],<br/>      year: new Date().getFullYear(),<br/>      month: 0,<br/>      day: 1,<br/>    };<br/>  },<br/>  methods: {<br/>    emitDate() {<br/>      const { year, month, day } = this;<br/>      this.$emit("update:modelValue", new Date(year, month, day).toString());<br/>    },<br/>  },<br/>  watch: {<br/>    year() {<br/>      this.emitDate();<br/>    },<br/>    month() {<br/>      this.emitDate();<br/>    },<br/>    day() {<br/>      this.emitDate();<br/>    },<br/>  },<br/>  computed: {<br/>    maxDate() {<br/>      const { month } = this;<br/>      if ([0, 2, 4, 6, 7, 9, 11].includes(month)) {<br/>        return 31;<br/>      } else if ([3, 5, 8, 10].includes(month)) {<br/>        return 30;<br/>      }<br/>      return 28;<br/>    },<br/>  },<br/>  beforeMount() {<br/>    const currentYear = new Date().getFullYear();<br/>    for (let i = -100; i &lt;= 100; i++) {<br/>      this.years.push(currentYear + i);<br/>    }<br/>    const d = moment(this.modelValue);<br/>    this.year = +d.format("YYYY");<br/>    this.month = +d.format("MM") - 1;<br/>    this.day = +d.format("DD");<br/>  },<br/>};<br/>&lt;/script&gt;</span></pre><p id="8d44" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe me mf mg mh b">App.vue</code>中，我们添加了<code class="fe me mf mg mh b">DatePicker</code>组件，并用<code class="fe me mf mg mh b">v-model</code>将其绑定到一个日期字符串。</p><p id="a036" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe me mf mg mh b">Date</code>构造函数创建日期字符串。</p><p id="70f6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我们从<code class="fe me mf mg mh b">modelValue</code>道具中得到它时，它会自动转换成一个字符串。</p><p id="1088" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面，我们展示了<code class="fe me mf mg mh b">date</code>值。</p><p id="1770" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在<code class="fe me mf mg mh b">DatePicker.vue</code>中，我们添加3个选择元素，让我们选择年、月和日。</p><p id="7fbf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe me mf mg mh b">v-model</code>将<code class="fe me mf mg mh b">select</code>元素值绑定到反应属性。</p><p id="e3eb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">month</code>的<code class="fe me mf mg mh b">value</code>以0开始，以11结束，以匹配<code class="fe me mf mg mh b">Date</code>构造器接受的内容。</p><p id="7372" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们使用<code class="fe me mf mg mh b">v-for</code>来呈现选项值的数字。</p><p id="946a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们向<code class="fe me mf mg mh b">style</code>标签添加一些样式，使下拉列表并排显示，并在它们之间添加边距。</p><p id="0231" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们有了组件对象。</p><p id="a816" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该组件采用字符串形式的<code class="fe me mf mg mh b">modelValue</code>属性。</p><p id="4382" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">data</code>返回我们用于模板的反应属性。</p><p id="bb40" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">years</code>是我们稍后将填充的year下拉列表的年份数组。</p><p id="98f5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">year</code>、<code class="fe me mf mg mh b">month</code>和<code class="fe me mf mg mh b">day</code>设置为默认值。</p><p id="0207" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们用<code class="fe me mf mg mh b">emitDate</code>方法发出带有日期字符串的<code class="fe me mf mg mh b">update:modelValue</code>事件。</p><p id="2b89" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在<code class="fe me mf mg mh b">year</code>、<code class="fe me mf mg mh b">month</code>和<code class="fe me mf mg mh b">day</code>观察器中调用它，这样当这些值发生变化时它就会运行。</p><p id="9de4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们添加<code class="fe me mf mg mh b">maxDate</code> computed属性来返回我们可以根据选择的月份设置的最大天数。</p><p id="6a14" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因为JavaScript <code class="fe me mf mg mh b">Date</code>构造函数使用从0开始的月份，我们检查从0到11的月份值，其中0是一月，11是十二月。</p><p id="e11b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，在<code class="fe me mf mg mh b">beforeMount</code>钩子中，我们用当前年份前后的100年来填充<code class="fe me mf mg mh b">years</code>数组。</p><p id="24eb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们得到<code class="fe me mf mg mh b">modelValue</code>属性的值并解析年、月和日的值</p><p id="c5e2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用moment对象自带的<code class="fe me mf mg mh b">format</code>方法进行解析。</p><p id="75c9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，当我们更改下拉列表中的选项时，我们应该看到选项反映在下面的文本中。</p><h1 id="9369" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="3663" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用Vue 3轻松创建一个下拉组件。</p></div></div>    
</body>
</html>