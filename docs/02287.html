<html>
<head>
<title>Setup ESLint + Prettier + AirBnB Style with Create React App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Create React应用程序设置ESLint+beauty+AirBnB风格</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/setup-eslint-prettier-airbnb-style-with-create-react-app-f2b4fda1ce5a?source=collection_archive---------1-----------------------#2020-07-27">https://blog.devgenius.io/setup-eslint-prettier-airbnb-style-with-create-react-app-f2b4fda1ce5a?source=collection_archive---------1-----------------------#2020-07-27</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="7ec4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="ki">原发于我的</em> <a class="ae kj" href="https://www.andrewmin.info/blog/react-setup/" rel="noopener ugc nofollow" target="_blank"> <em class="ki">博客</em> </a></p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi kk"><img src="../Images/b3b31037e403526641048f566cd75fcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NkarLR-m_KfAi5ecGQGFtw.jpeg"/></div></div><figcaption class="kw kx gj gh gi ky kz bd b be z dk translated">React、ESLint、React和AirBnB徽标。</figcaption></figure><h1 id="4572" class="la lb in bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">概观</h1><p id="498c" class="pw-post-body-paragraph jk jl in jm b jn ly jp jq jr lz jt ju jv ma jx jy jz mb kb kc kd mc kf kg kh ig bi translated">有许多工具可以帮助lint和格式化您的JavaScript代码，以至于设置一个项目会变得很复杂。我将展示如何用一些最流行的<a class="ae kj" href="https://eslint.org/" rel="noopener ugc nofollow" target="_blank"> ESLint </a>和<a class="ae kj" href="https://prettier.io/" rel="noopener ugc nofollow" target="_blank">prettle</a>来建立一个React项目，同时也集成AirBnB流行的<a class="ae kj" href="https://airbnb.io/javascript/" rel="noopener ugc nofollow" target="_blank">风格指南</a>。</p><p id="2fea" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">对于本指南，您需要安装Node.js，因为它捆绑了<code class="fe md me mf mg b">npm</code>和<code class="fe md me mf mg b">npx</code>、Node<strong class="jm io">P</strong>package<strong class="jm io">M</strong>anager和<strong class="jm io">N</strong>pm<strong class="jm io">P</strong>package e<strong class="jm io">X</strong>executor。<code class="fe md me mf mg b">npm</code>将软件包安装到您的项目中，而<code class="fe md me mf mg b">npx</code>运行软件包二进制文件。</p><h1 id="496a" class="la lb in bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">创建React应用程序</h1><p id="ab75" class="pw-post-body-paragraph jk jl in jm b jn ly jp jq jr lz jt ju jv ma jx jy jz mb kb kc kd mc kf kg kh ig bi translated">如果你还没有React应用，使用<a class="ae kj" href="https://github.com/facebook/create-react-app#create-react-app--" rel="noopener ugc nofollow" target="_blank">创建React应用</a>为你设置一个。它将自动创建一个具有依赖关系的单页React应用程序(React、Babel、Webpack等)。)和基本项目结构。README有一个完整的指南，但是本质上你所要做的就是运行Create React App package脚本，用<code class="fe md me mf mg b">npx</code>然后<code class="fe md me mf mg b">cd</code>进入项目目录。</p><pre class="kl km kn ko gt mh mg mi mj aw mk bi"><span id="d572" class="ml lb in mg b gy mm mn l mo mp">npx create-react-app my-app<br/>cd my-app</span></pre><h1 id="8a98" class="la lb in bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">ESLint + AirBnB</h1><p id="06ae" class="pw-post-body-paragraph jk jl in jm b jn ly jp jq jr lz jt ju jv ma jx jy jz mb kb kc kd mc kf kg kh ig bi translated">ESLint是一个<strong class="jm io"> linter </strong>，它将分析你的代码并找到常见问题，同时还会识别与AirBnB的风格指南不一致的风格(如果配置了的话)。</p><p id="fad6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了安装ESLint并设置一个配置文件，我们将使用另一个<code class="fe md me mf mg b">npx</code>包脚本。</p><pre class="kl km kn ko gt mh mg mi mj aw mk bi"><span id="920b" class="ml lb in mg b gy mm mn l mo mp">npx eslint --init</span></pre><p id="20fa" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">该脚本将询问一些问题，然后继续将其依赖项安装到<code class="fe md me mf mg b">./package.json</code>的<code class="fe md me mf mg b">devDependencies</code>部分。它还创建了包含所有配置的<code class="fe md me mf mg b">./.eslintrc.json</code>。</p><pre class="kl km kn ko gt mh mg mi mj aw mk bi"><span id="4eb7" class="ml lb in mg b gy mm mn l mo mp">? How would you like to use ESLint? To check syntax, find problems, and enforce code style<br/>? What type of modules does your project use? JavaScript modules (import/export)<br/>? Which framework does your project use? React<br/>? Does your project use TypeScript? No<br/>? Where does your code run? Browser<br/>? How would you like to define a style for your project? Use a popular style guide<br/>? Which style guide do you want to follow? Airbnb: https://github.com/airbnb/javascript<br/>? What format do you want your config file to be in? JSON</span></pre><p id="7b17" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">然而，Create React App中的react-scripts包需要一个旧版本的ESLint，这可以从运行<code class="fe md me mf mg b">npm start</code>会抛出一条很长的错误消息看出。为了解决这个问题，我手动将<code class="fe md me mf mg b">./package.json</code>中的<code class="fe md me mf mg b">eslint</code>降级为错误消息中显示的所需版本。截至发稿时，我将ESLint从<code class="fe md me mf mg b">^7.5.0</code>降级为<code class="fe md me mf mg b">^6.6.0</code>，然后运行<code class="fe md me mf mg b">npm install</code>。</p><p id="e4c3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">此外，Create React App工具链使用<a class="ae kj" href="https://babeljs.io/" rel="noopener ugc nofollow" target="_blank"> Babel </a>将新的JavaScript特性移植到旧版本中，以便在旧浏览器中运行。然而，ESLint解析器没有跟上JavaScript的变化，所以我们需要使用<code class="fe md me mf mg b">babel-eslint</code>解析器。在<code class="fe md me mf mg b">./.eslintrc.json</code>中，添加:</p><pre class="kl km kn ko gt mh mg mi mj aw mk bi"><span id="cef3" class="ml lb in mg b gy mm mn l mo mp">"parser": "babel-eslint"</span></pre><p id="0982" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要运行linter，对src目录中的一个文件或每个<code class="fe md me mf mg b">.js</code>和<code class="fe md me mf mg b">.jsx</code>文件运行ESLint包脚本。</p><pre class="kl km kn ko gt mh mg mi mj aw mk bi"><span id="afd9" class="ml lb in mg b gy mm mn l mo mp">npx eslint 'src/**/*.{js,jsx}'</span></pre><h1 id="d15a" class="la lb in bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">较美丽</h1><p id="dd0e" class="pw-post-body-paragraph jk jl in jm b jn ly jp jq jr lz jt ju jv ma jx jy jz mb kb kc kd mc kf kg kh ig bi translated">更漂亮的是一个代码格式化器，它可以识别并自动修复代码中的风格问题。为了安装，我们需要安装3个包——<code class="fe md me mf mg b">prettier</code>本身,<code class="fe md me mf mg b">eslint-plugin-prettier</code>将Prietter集成到ESLint中，而<code class="fe md me mf mg b">eslint-config-prettier</code>将关闭与Prettier冲突的ESLint规则。</p><p id="766e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">(不要忘记将这些包添加到<code class="fe md me mf mg b">./package.json</code>的<code class="fe md me mf mg b">--save-dev</code>标志)</p><pre class="kl km kn ko gt mh mg mi mj aw mk bi"><span id="5294" class="ml lb in mg b gy mm mn l mo mp">npm install prettier eslint-plugin-prettier eslint-config-prettier --save-dev</span></pre><p id="2f41" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在我们必须给<code class="fe md me mf mg b">./.eslintrc.json</code>添加一些东西来让ESLint和Prettier一起工作。</p><ol class=""><li id="140e" class="mq mr in jm b jn jo jr js jv ms jz mt kd mu kh mv mw mx my bi translated">将<code class="fe md me mf mg b">"prettier"</code>添加到<code class="fe md me mf mg b">plugins</code>部分。</li><li id="e240" class="mq mr in jm b jn mz jr na jv nb jz nc kd nd kh mv mw mx my bi translated">在<code class="fe md me mf mg b">extends</code>部分增加<code class="fe md me mf mg b">"prettier"</code>和<code class="fe md me mf mg b">prettier/react</code>。</li><li id="4b94" class="mq mr in jm b jn mz jr na jv nb jz nc kd nd kh mv mw mx my bi translated">将<code class="fe md me mf mg b">"prettier/prettier": "error"</code>添加到<code class="fe md me mf mg b">rules</code>部分。也可以将“错误”改为“警告”。</li></ol><p id="6189" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，如果我们运行<code class="fe md me mf mg b">npx eslint 'src/**'</code>，我们也可以看到来自更漂亮的警告/错误。要运行格式化和简单的修复，我们可以运行:</p><pre class="kl km kn ko gt mh mg mi mj aw mk bi"><span id="fbad" class="ml lb in mg b gy mm mn l mo mp">npx eslint 'src/**/*.{js,jsx}' --fix</span></pre><h1 id="61f7" class="la lb in bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">更多配置</h1><p id="5886" class="pw-post-body-paragraph jk jl in jm b jn ly jp jq jr lz jt ju jv ma jx jy jz mb kb kc kd mc kf kg kh ig bi translated">首先，向<code class="fe md me mf mg b">./.eslintrc.json</code>中的<code class="fe md me mf mg b">rules</code>部分添加条目允许您禁用某些ESLint规则。以下是我个人喜欢禁用的一些规则。</p><ul class=""><li id="b062" class="mq mr in jm b jn jo jr js jv ms jz mt kd mu kh ne mw mx my bi translated"><code class="fe md me mf mg b">"react/jsx-filename-extension": [1, { "extensions": [".js", ".jsx"] }]</code> -允许JSX在<code class="fe md me mf mg b">*.js</code>文件中做出反应。(默认情况下，AirBnB强制React组件具有<code class="fe md me mf mg b">*.jsx</code>扩展名)</li><li id="30c6" class="mq mr in jm b jn mz jr na jv nb jz nc kd nd kh ne mw mx my bi translated"><code class="fe md me mf mg b">"react/state-in-constructor": "off"</code>——允许你将状态声明为类变量，而不是在React组件的构造函数中。</li></ul><p id="e5cb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">接下来，我们可以通过创建一个<code class="fe md me mf mg b">./.prettierrc</code>文件并更改一些<a class="ae kj" href="https://prettier.io/docs/en/options.html" rel="noopener ugc nofollow" target="_blank">选项</a>来进行更漂亮的配置。以下是我想改变的一些选项。</p><ul class=""><li id="974a" class="mq mr in jm b jn jo jr js jv ms jz mt kd mu kh ne mw mx my bi translated"><code class="fe md me mf mg b">"printWidth": 100</code> -将最大线宽改为100个字符(默认为80)</li><li id="0bbf" class="mq mr in jm b jn mz jr na jv nb jz nc kd nd kh ne mw mx my bi translated"><code class="fe md me mf mg b">"singleQuote": true</code> -对字符串使用单引号，这是AirBnB的风格(默认为false)</li></ul><p id="9c8d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">到目前为止，您的文件可能看起来像这样。</p><p id="7ccc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe md me mf mg b">package.json</code></p><pre class="kl km kn ko gt mh mg mi mj aw mk bi"><span id="efd1" class="ml lb in mg b gy mm mn l mo mp">{<br/>  ...<br/>  "devDependencies": {<br/>    "eslint": "6.6.0",<br/>    "eslint-config-airbnb": "^18.2.0",<br/>    "eslint-config-prettier": "^6.11.0",<br/>    "eslint-plugin-import": "^2.22.0",<br/>    "eslint-plugin-jsx-a11y": "^6.3.1",<br/>    "eslint-plugin-prettier": "^3.1.4",<br/>    "eslint-plugin-react": "^7.20.3",<br/>    "eslint-plugin-react-hooks": "^4.0.8",<br/>    "prettier": "^2.0.5"<br/>  }<br/>}</span></pre><p id="4f96" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe md me mf mg b">.eslintrc.json</code></p><pre class="kl km kn ko gt mh mg mi mj aw mk bi"><span id="0dac" class="ml lb in mg b gy mm mn l mo mp">{<br/>    "env": {<br/>        "browser": true,<br/>        "es6": true<br/>    },<br/>    "parser": "babel-eslint",<br/>    "extends": [<br/>        "plugin:react/recommended",<br/>        "airbnb",<br/>        "prettier",<br/>        "prettier/react"<br/>    ],<br/>    "globals": {<br/>        "Atomics": "readonly",<br/>        "SharedArrayBuffer": "readonly"<br/>    },<br/>    "parserOptions": {<br/>        "ecmaFeatures": {<br/>            "jsx": true<br/>        },<br/>        "ecmaVersion": 2018,<br/>        "sourceType": "module"<br/>    },<br/>    "plugins": [<br/>        "react",<br/>        "prettier"<br/>    ],<br/>    "rules": {<br/>        "prettier/prettier": "error",<br/>        "react/jsx-filename-extension": [1, { "extensions": [".js", ".jsx"] }],<br/>        "react/state-in-constructor": "off"<br/>    }<br/>}</span></pre><p id="2c0a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe md me mf mg b">.prettierrc</code></p><pre class="kl km kn ko gt mh mg mi mj aw mk bi"><span id="126b" class="ml lb in mg b gy mm mn l mo mp">{<br/>    "printWidth": 100,<br/>    "singleQuote": true<br/>}</span></pre><h1 id="6333" class="la lb in bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">与VSCode集成</h1><p id="acec" class="pw-post-body-paragraph jk jl in jm b jn ly jp jq jr lz jt ju jv ma jx jy jz mb kb kc kd mc kf kg kh ig bi translated">为了在代码中显示ESLint警告并在VSCode中自动运行格式化，我们需要安装2个扩展。</p><h1 id="183f" class="la lb in bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">埃斯林特</h1><ul class=""><li id="2d70" class="mq mr in jm b jn ly jr lz jv nf jz ng kd nh kh ne mw mx my bi translated">安装<a class="ae kj" href="https://github.com/Microsoft/vscode-eslint" rel="noopener ugc nofollow" target="_blank"> ESLint扩展</a></li><li id="1bd0" class="mq mr in jm b jn mz jr na jv nb jz nc kd nd kh ne mw mx my bi translated">好了</li></ul><h1 id="21d6" class="la lb in bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">较美丽</h1><ul class=""><li id="c4be" class="mq mr in jm b jn ly jr lz jv nf jz ng kd nh kh ne mw mx my bi translated">安装<a class="ae kj" href="https://github.com/prettier/prettier-vscode" rel="noopener ugc nofollow" target="_blank">漂亮的加长件</a></li><li id="0b16" class="mq mr in jm b jn mz jr na jv nb jz nc kd nd kh ne mw mx my bi translated">编辑VSCode <code class="fe md me mf mg b">settings.json</code></li><li id="fbf0" class="mq mr in jm b jn mz jr na jv nb jz nc kd nd kh ne mw mx my bi translated">添加<br/> <code class="fe md me mf mg b">"[javascript]": { "editor.defaultFormatter": "esbenp.prettier-vscode", }<br/></code>将JavaScript文件的格式化程序改为更漂亮的。</li><li id="7b7d" class="mq mr in jm b jn mz jr na jv nb jz nc kd nd kh ne mw mx my bi translated">如果您也使用<code class="fe md me mf mg b">*.jsx</code>文件，对<code class="fe md me mf mg b">[javascriptreact]</code>进行与上述相同的设置</li><li id="06e1" class="mq mr in jm b jn mz jr na jv nb jz nc kd nd kh ne mw mx my bi translated">现在运行<code class="fe md me mf mg b">Format Document</code>将使用更漂亮</li><li id="d16f" class="mq mr in jm b jn mz jr na jv nb jz nc kd nd kh ne mw mx my bi translated">有关更多详细信息，请参见扩展自述文件(例如，保存时运行格式化)</li></ul><p id="ec90" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="ki">原贴于我的</em> <a class="ae kj" href="https://www.andrewmin.info/blog/react-setup/" rel="noopener ugc nofollow" target="_blank"> <em class="ki">博客</em> </a></p></div></div>    
</body>
</html>