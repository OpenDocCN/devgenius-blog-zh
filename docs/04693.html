<html>
<head>
<title>How to create a Video Chat Application with a custom STUN and TURN server</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•åˆ›å»ºä¸€ä¸ªè§†é¢‘èŠå¤©åº”ç”¨ç¨‹åºä¸è‡ªå®šä¹‰çœ©æ™•å’Œè½¬å‘æœåŠ¡å™¨</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://blog.devgenius.io/how-to-create-a-video-chat-application-with-a-custom-stun-and-turn-server-8c6258542324?source=collection_archive---------0-----------------------#2021-04-21">https://blog.devgenius.io/how-to-create-a-video-chat-application-with-a-custom-stun-and-turn-server-8c6258542324?source=collection_archive---------0-----------------------#2021-04-21</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="0119" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æ„å»ºæˆ‘ä»¬è‡ªå·±çš„åº”ç”¨ç¨‹åºå¾ˆé…·ã€‚ä»Šå¤©æˆ‘ä»¬å°†å¼€å‘æˆ‘ä»¬è‡ªå·±çš„è§†é¢‘èŠå¤©åº”ç”¨ç¨‹åºã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†å¼€å‘ä¸€ä¸ªåªä¸º2ä¸ªç”¨æˆ·çš„åº”ç”¨ç¨‹åºã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3704d3478389e80a8c871e197f5234f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AgFecu8ar2yjTCES"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Š<a class="ae ky" href="https://unsplash.com/@visuals?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">è§†è§‰</a>çš„ç…§ç‰‡</figcaption></figure><h1 id="b7da" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">å†…å®¹</h1><ol class=""><li id="1607" class="lx ly in jm b jn lz jr ma jv mb jz mc kd md kh me mf mg mh bi translated">åŸºç¡€</li><li id="8255" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">ä½¿ç”¨çš„æŠ€æœ¯ã€‚</li><li id="ad8c" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">äº†è§£WebRTCã€‚</li><li id="82cd" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">ä»€ä¹ˆæ˜¯ä¿¡å·ï¼Ÿ</li><li id="f81a" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">WebRTCæ˜¯å¦‚ä½•å·¥ä½œçš„(ä¸¾ä¾‹)ï¼Ÿ</li><li id="7ca4" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">æˆ‘ä»¬é¢ä¸´çš„é—®é¢˜</li><li id="015b" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">è®¾ç½®TURNå’ŒSTUNServerã€‚</li><li id="4976" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">æˆ‘ä»¬æ¥ç¼–ç å§ã€‚</li></ol><h1 id="9610" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">åŸºç¡€</h1><ul class=""><li id="775d" class="lx ly in jm b jn lz jr ma jv mb jz mc kd md kh mn mf mg mh bi translated"><strong class="jm io"> IP </strong>:è¿æ¥åˆ°äº’è”ç½‘çš„æ¯å°è®¾å¤‡éƒ½ä½¿ç”¨IPåœ°å€è¿›è¡Œè¯†åˆ«ã€‚</li><li id="9874" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh mn mf mg mh bi translated"><strong class="jm io">ç«¯å£</strong>:ç³»ç»Ÿä¸­çš„æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ä¸€ä¸ªç«¯å£å·ï¼Œä½¿ç”¨è¯¥ç«¯å£å·å¯ä»¥å°†æ¥è‡ªäº’è”ç½‘çš„æ•°æ®å®šå‘åˆ°è®¾å¤‡ä¸­çš„æ­£ç¡®ä½ç½®ã€‚</li></ul><p id="8ee3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">çŸ¥è¯†</strong>:æœ‰65536ä¸ªç«¯å£å¯ç”¨ã€‚</p><h1 id="e18b" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated"><strong class="ak">ä½¿ç”¨çš„æŠ€æœ¯</strong></h1><ol class=""><li id="3a55" class="lx ly in jm b jn lz jr ma jv mb jz mc kd md kh me mf mg mh bi translated">WebRTC</li><li id="be8c" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">NodeJS</li><li id="e09d" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">ExpressJs</li><li id="df80" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">Socket.io(ç”¨äºä¿¡ä»¤)</li><li id="264f" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">AWS &amp; Kurento(ç”¨äºè®¾ç½®STUNå’ŒTURNæœåŠ¡å™¨)</li></ol><h1 id="9e4d" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated"><strong class="ak">äº†è§£WebRTC </strong></h1><p id="fbdb" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mo jx jy jz mp kb kc kd mq kf kg kh ig bi translated">åœ¨è¿™ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†äº†è§£ä½¿ç”¨WebRTCå¼€å‘åº”ç”¨ç¨‹åºæ‰€éœ€çš„å„ç§æ¦‚å¿µã€‚</p><p id="e608" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">åœ¨èŠå¤©ç½‘ç»œåº”ç”¨ä¸­ï¼Œå½“ä¸¤ä¸ªæˆ–æ›´å¤šçš„è®¾å¤‡å¼€å§‹å‘é€ä¿¡æ¯æ—¶ï¼Œå®ƒä»¬åœ¨åˆ°è¾¾æ¥æ”¶è€…ä¹‹å‰ä¼šé€šè¿‡æœåŠ¡å™¨ã€‚ä½†æ˜¯åœ¨éŸ³é¢‘å’Œè§†é¢‘é€šä¿¡ä¹‹é—´æœ‰ä¸€ä¸ªæœåŠ¡å™¨ä¼šå¯¼è‡´æ»åã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦å®æ—¶æ•°æ®ä¼ è¾“æ¥å®ç°å®Œç¾çš„é€šä¿¡ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨WebRTCè¿™ç§å¼€æºæ¡†æ¶ä¸ºåº”ç”¨ç¨‹åºæä¾›å®æ—¶é€šä¿¡ã€‚</p><p id="8301" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">WebRTCå¼€å‘äººå‘˜åœ¨å¼€å‘æ˜“äºä½¿ç”¨çš„APIæ–¹é¢åšäº†å‡ºè‰²çš„å·¥ä½œã€‚</p><p id="bb24" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">WebRTCä»£è¡¨Webå®æ—¶é€šä¿¡ã€‚å®ƒæ”¯æŒç‚¹å¯¹ç‚¹(è®¾å¤‡åˆ°è®¾å¤‡)é€šä¿¡ï¼Œä¸­é—´æ²¡æœ‰ä»»ä½•æœåŠ¡å™¨ï¼Œå¹¶å…è®¸åœ¨è¿æ¥çš„è®¾å¤‡ä¹‹é—´äº¤æ¢æ•°æ®ã€‚åœ¨WebRTCä¸­ï¼ŒæœåŠ¡å™¨çš„è§’è‰²ä»…é™äºå¸®åŠ©ä¸¤ä¸ªæˆ–æ›´å¤šè®¾å¤‡å‘ç°å½¼æ­¤å¹¶å»ºç«‹ç›´æ¥è¿æ¥ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mr"><img src="../Images/b231de95063ac08c85eedec6e512eb71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KOazsO-ysOPAt1B1hEsszg.jpeg"/></div></div></figure><h1 id="ae5d" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated"><strong class="ak">ä¿¡ä»¤</strong></h1><p id="5292" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mo jx jy jz mp kb kc kd mq kf kg kh ig bi translated">åœ¨äººä»¬å¼€å§‹ç›¸äº’äº¤æµä¹‹å‰ï¼Œä»–ä»¬çš„ç³»ç»Ÿéœ€è¦çŸ¥é“å¾ˆå¤šå…³äºåœºæ™¯çš„ä¿¡æ¯ï¼Œæ¯”å¦‚</p><ul class=""><li id="ba2a" class="lx ly in jm b jn jo jr js jv ms jz mt kd mu kh mn mf mg mh bi translated">å¦‚æœæœ‰ä»»ä½•å…¶ä»–è®¾å¤‡å¯ç”¨äºé€šä¿¡ã€‚</li><li id="42ca" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh mn mf mg mh bi translated">å…¶ä»–è®¾å¤‡çš„ç½‘ç»œæ•°æ®ï¼Œå¦‚IPå’Œç«¯å£ã€‚</li><li id="c7ac" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh mn mf mg mh bi translated">é”™è¯¯æ¶ˆæ¯ã€‚</li><li id="6e81" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh mn mf mg mh bi translated">ä¼šè¯æ§åˆ¶æ¶ˆæ¯ã€‚</li><li id="173e" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh mn mf mg mh bi translated">å…³äºå°†ç”±å¦ä¸€è®¾å¤‡å‘é€çš„æ•°æ®çš„åª’ä½“å…ƒæ•°æ®ã€‚</li></ul><p id="4225" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ä¿¡ä»¤æ˜¯ä¸€ä¸ªæœ¯è¯­ï¼Œç”¨äºæè¿°åè°ƒåˆå§‹é€šä¿¡å¹¶å®ç°è®¾å¤‡é—´å…ƒæ•°æ®å‘é€çš„æœºåˆ¶ã€‚ä¸€æ—¦å»ºç«‹äº†ç›´æ¥è¿æ¥ï¼Œæ­¤åå°±æ²¡æœ‰ä¿¡ä»¤çš„ä½œç”¨äº†ã€‚</p><p id="872a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">é»˜è®¤æƒ…å†µä¸‹ï¼ŒWebRTCä¸ä½¿ç”¨ä»»ä½•ä¿¡å·æœºåˆ¶ã€‚æˆ‘ä»¬ä½¿ç”¨socket.ioè¿›è¡Œä¿¡å·ä¼ è¾“ã€‚</p><p id="7c15" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">ä¼šè¯æè¿°åè®®</strong></p><p id="a8c1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ä¼šè¯æè¿°åè®®æ˜¯ä¸€ç§æ ¼å¼ï¼Œåª’ä½“å…ƒæ•°æ®ä»¥è¿™ç§æ ¼å¼ä¼ è¾“ï¼Œä»¥ä¾¿WebRTCå‘æŒ¥ä½œç”¨ã€‚</p><h1 id="ac4c" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">WebRTCå¦‚ä½•å·¥ä½œ(ç¤ºä¾‹)</h1><p id="0281" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mo jx jy jz mp kb kc kd mq kf kg kh ig bi translated">è®©æˆ‘ä»¬è€ƒè™‘Likså’Œkarthå†³å®šè¿›è¡Œè§†é¢‘èŠå¤©ã€‚Karthè®©liksæ‰“ç”µè¯ã€‚è®©æˆ‘ä»¬è®¨è®ºä¸€ä¸‹åç«¯æ˜¯å¦‚ä½•å·¥ä½œçš„</p><ol class=""><li id="7e24" class="lx ly in jm b jn jo jr js jv ms jz mt kd mu kh me mf mg mh bi translated">Liksåˆ›å»ºä¸€ä¸ª<code class="fe mv mw mx my b">RTCPeerConnection</code>å¯¹è±¡ã€‚</li><li id="4aeb" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">Liksä½¿ç”¨<code class="fe mv mw mx my b">RTCPeerConnection</code> <code class="fe mv mw mx my b">createOffer()</code>æ–¹æ³•åˆ›å»ºæŠ¥ä»·(SDPä¼šè¯æè¿°)ã€‚</li><li id="1115" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">Liksè°ƒç”¨<code class="fe mv mw mx my b">setLocalDescription()</code>å°†åˆ›å»ºçš„offer(ä¼šè¯æè¿°)è®¾ç½®ä¸ºå°†è¦åˆ›å»ºçš„è¿æ¥ä¸­çš„æœ¬åœ°åª’ä½“çš„æè¿°ã€‚</li><li id="56be" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">Liks stringifiesæä¾›å¹¶ä½¿ç”¨ä¿¡å·æœºåˆ¶å‘é€ç»™Karthã€‚</li><li id="5b0f" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">Karthæ‰“ç”µè¯ç»™<code class="fe mv mw mx my b">setRemoteDescription()</code>å‘Šè¯‰ä»–Liksçš„æŠ¥ä»·ï¼Œè¿™æ ·ä»–çš„<code class="fe mv mw mx my b">RTCPeerConnection</code>å°±çŸ¥é“Liksçš„è®¾ç½®äº†ã€‚</li><li id="aae7" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">Karthè°ƒç”¨<code class="fe mv mw mx my b">createAnswer()</code>,è¿™ä¸ªæˆåŠŸçš„å›è°ƒå‡½æ•°è¢«ä¼ é€’ä¸€ä¸ªæœ¬åœ°ä¼šè¯æè¿°â€”â€”Karth answerã€‚</li><li id="06bc" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">Karthé€šè¿‡è°ƒç”¨<code class="fe mv mw mx my b">setLocalDescription()</code>å°†å…¶ç­”æ¡ˆè®¾ç½®ä¸ºæœ¬åœ°æè¿°ã€‚</li><li id="0272" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">ç„¶åï¼ŒKarthä½¿ç”¨ä¿¡å·æœºåˆ¶å°†ä»–çš„å­—ç¬¦ä¸²ç­”æ¡ˆå‘é€ç»™Liksã€‚</li><li id="427d" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">Liksä½¿ç”¨<code class="fe mv mw mx my b">setRemoteDescription()</code>å°†Karth answerè®¾ç½®ä¸ºè¿œç¨‹ä¼šè¯æè¿°ã€‚</li></ol><p id="a201" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ç°åœ¨Likså’ŒKarthä¹Ÿéœ€è¦äº¤æ¢ç½‘ç»œä¿¡æ¯ã€‚â€œå¯»æ‰¾å€™é€‰è€…â€æ˜¯æŒ‡ä½¿ç”¨ICEæ¡†æ¶å¯»æ‰¾ç½‘ç»œæ¥å£å’Œç«¯å£çš„è¿‡ç¨‹ã€‚</p><ol class=""><li id="f87e" class="lx ly in jm b jn jo jr js jv ms jz mt kd mu kh me mf mg mh bi translated">Liksç”¨ä¸€ä¸ª<code class="fe mv mw mx my b">onicecandidate</code>å¤„ç†ç¨‹åºåˆ›å»ºäº†ä¸€ä¸ª<code class="fe mv mw mx my b">RTCPeerConnection</code>å¯¹è±¡ã€‚</li><li id="638c" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">å½“ç½‘ç»œå€™é€‰å˜å¾—å¯ç”¨æ—¶ï¼Œè°ƒç”¨è¯¥å¤„ç†ç¨‹åºã€‚</li><li id="c99f" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">åœ¨å¤„ç†ç¨‹åºä¸­ï¼ŒLiksé€šè¿‡å®ƒä»¬çš„ä¿¡ä»¤é€šé“å‘Karthå‘é€å­—ç¬¦ä¸²åŒ–çš„å€™é€‰æ•°æ®ã€‚</li><li id="c6f1" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">å½“Karth <strong class="jm io"> </strong>ä»Liksè·å¾—å€™é€‰æ¶ˆæ¯æ—¶ï¼Œä»–è°ƒç”¨<code class="fe mv mw mx my b">addIceCandidate()</code>å°†å€™é€‰æ¶ˆæ¯æ·»åŠ åˆ°è¿œç¨‹å¯¹ç­‰æè¿°ä¸­ã€‚</li></ol><h1 id="7442" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">æˆ‘ä»¬é¢ä¸´çš„é—®é¢˜</h1><p id="ca76" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mo jx jy jz mp kb kc kd mq kf kg kh ig bi translated">å¦‚æœè®¾å¤‡è¿æ¥åˆ°åŒä¸€ä¸ªç½‘ç»œï¼Œæˆ‘ä»¬å°±ä¸ä¼šé‡åˆ°NATé—®é¢˜ã€‚</p><ul class=""><li id="5bf9" class="lx ly in jm b jn jo jr js jv ms jz mt kd mu kh mn mf mg mh bi translated">ç²¾çµ</li><li id="f9f1" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh mn mf mg mh bi translated">é˜²ç«å¢™</li></ul><p id="079e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> NAT </strong></p><p id="e51b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">IPæ˜¯æ ‡è¯†è¿æ¥åˆ°äº’è”ç½‘çš„è®¾å¤‡çš„åœ°å€ã€‚ä»é€»è¾‘ä¸Šè®²ï¼Œæ‚¨å¯èƒ½ä¼šè®¤ä¸ºæ¯å°è¿æ¥åˆ°äº’è”ç½‘çš„è®¾å¤‡éƒ½å¿…é¡»æœ‰ä¸€ä¸ªå”¯ä¸€çš„IPåœ°å€ã€‚ä½†è¿™å¹¶ä¸å®Œå…¨æ­£ç¡®ã€‚</p><p id="4b94" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">IPv4åœ°å€æœ‰32ä½é•¿ï¼Œè¿™æ„å‘³ç€å¤§çº¦æœ‰40äº¿ä¸ªå”¯ä¸€çš„åœ°å€ã€‚æˆªè‡³2018å¹´åº•ï¼Œçº¦æœ‰220äº¿å°è®¾å¤‡è¿æ¥åˆ°äº’è”ç½‘ã€‚å“¦ï¼Œç­‰ç­‰ï¼Œè¿™æ€ä¹ˆå¯èƒ½ï¼Œè¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆæ˜¯çº³ç‰¹ã€‚</p><p id="7bcd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ç»´æŠ¤äº’è”ç½‘çš„äººæŠŠæ•´ä¸ªIPv4åœ°å€èŒƒå›´åˆ†æˆä¸¤ç»„</p><ul class=""><li id="3baf" class="lx ly in jm b jn jo jr js jv ms jz mt kd mu kh mn mf mg mh bi translated">å…¬å…±IPåœ°å€</li><li id="7c8b" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh mn mf mg mh bi translated">ç§æœ‰IPåœ°å€ã€‚</li></ul><p id="3555" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ç°åœ¨ï¼Œæ¯ä¸ªå…¬æœ‰IPåœ°å€åªèƒ½åˆ†é…ç»™ä¸€å°è®¾å¤‡ï¼Œè€Œç§æœ‰IPåœ°å€åˆ™ä¸èƒ½ã€‚æ›´å¤šç»†èŠ‚è¯·çœ‹ä¸‹å›¾ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/aafc62400f0e0a1ad4cfa45bf5f7f779.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MG6nI4HpN-e4bjdUrkEyPw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">è¿™å°±æ˜¯NATçš„å·¥ä½œæ–¹å¼</figcaption></figure><p id="b8c7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">å› æ­¤ï¼Œåœ¨æŸç§ç¨‹åº¦ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥è¯´æ¯å°è®¾å¤‡éƒ½æœ‰ä¸¤ä¸ªIPåœ°å€ç§æœ‰IPåœ°å€å’Œå…¬å…±IPåœ°å€ã€‚</p><p id="8b5d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">è¿™å¯èƒ½ä¼šç»™WebRTCå¸¦æ¥é—®é¢˜ï¼Œå› ä¸ºç½‘ç»œICEå€™é€‰åŒ…å«è®¾å¤‡çš„ç§æœ‰IPåœ°å€ï¼Œè€Œä¸æ˜¯å…¬å…±IPåœ°å€ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»æ‰¾åˆ°ä¸€ç§æ–¹æ³•è®©æµè§ˆå™¨çŸ¥é“å…¬å…±IPåœ°å€ï¼Œä»¥ä¾¿å®ƒå¯ä»¥åˆ›å»ºåŒ…å«å…¬å…±IPåœ°å€çš„å€™é€‰åœ°å€ã€‚è§£å†³æ–¹æ¡ˆæ˜¯ä¸€ä¸ªSTUNæœåŠ¡å™¨ã€‚å½“ä¸€ä¸ªè®¾å¤‡è¯·æ±‚STUNæœåŠ¡å™¨æ—¶ï¼ŒSTUNæœåŠ¡å™¨ç”¨ä¸€æ¡åŒ…å«è¯¥è®¾å¤‡æ‰€è¿æ¥çš„è·¯ç”±å™¨çš„å…¬å…±IPçš„æ¶ˆæ¯æ¥å“åº”ã€‚</p><p id="3247" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">é˜²ç«å¢™</strong></p><p id="4a35" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ç³»ç»Ÿä½¿ç”¨é˜²ç«å¢™æ¥é˜»æ­¢å¯ç–‘å’Œå±é™©çš„ç«¯å£å’Œåº”ç”¨ç¨‹åºã€‚ç”±äºWebRTCä½¿ç”¨å‡ ä¸ªéæ ‡å‡†ç«¯å£ï¼Œä¸€äº›é˜²ç«å¢™ä¸å…è®¸åœ¨ä¸¤ä¸ªæµè§ˆå™¨ä¹‹é—´å»ºç«‹ç›´æ¥è¿æ¥ã€‚</p><p id="3cbb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">å› æ­¤ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªTURNæœåŠ¡å™¨ã€‚TURNæœåŠ¡å™¨åŸºæœ¬ä¸Šå……å½“ä¸­ç»§æœåŠ¡å™¨ï¼Œå³å¦‚æœç›´æ¥è¿æ¥å¤±è´¥ï¼Œåˆ™åœ¨ä¸¤ä¸ªå¯¹ç­‰ä½“ä¹‹é—´ç›´æ¥ä¸­ç»§æµé‡ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/f373344992d0c2a82eba1a15f3e4c859.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WgMlbrOKOJ7uooRW_7B17A.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">è¿™å°±æ˜¯è½¬å¼¯çš„åŸç†</figcaption></figure><p id="67f3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">è¦å°†TURNå’ŒSTUNä¸WebRTCé›†æˆï¼Œæˆ‘ä»¬åªéœ€å°†åŒ…å«TURNå’ŒSTUNæœåŠ¡å™¨URLçš„å¯¹è±¡ä½œä¸ºå‚æ•°ä¼ é€’ç»™RTCPeerConnection()ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/5d9c82b21ff5d281fd0ce1392110f671.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*08mkUDljvtI1t4zTVzCOpA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">è¿™æ˜¯å»ºç­‘çš„æ ·å­</figcaption></figure><h1 id="5ed4" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated"><strong class="ak">è®¾ç½®å›åˆå’Œçœ©æ™•æœåŠ¡å™¨</strong></h1><ol class=""><li id="69f1" class="lx ly in jm b jn lz jr ma jv mb jz mc kd md kh me mf mg mh bi translated">è®¾ç½®æ‚¨çš„AWSå¸æˆ·ã€‚</li><li id="42ba" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">åˆ›å»ºä¸€ä¸ªEC2å®ä¾‹(æˆ‘æ›´å–œæ¬¢ä½¿ç”¨Ubuntuå…è´¹å±‚)</li><li id="5ef8" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><strong class="jm io">æ‰“å¼€å®‰å…¨ç»„ä¸­çš„é˜²ç«å¢™ç«¯å£</strong></li></ol><p id="7cd4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="nb"> 3478 TCP &amp; UDPç«¯å£</em></p><p id="3cd3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="nb">49152â€“65535 UDPç«¯å£</em></p><p id="707f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">4.<strong class="jm io">æ—‹è½¬å®‰è£…</strong></p><p id="6892" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="nb"> sudo apt-getæ›´æ–°<br/> sudo apt-getå®‰è£…è¿”å›</em></p><p id="b2a2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">5.<strong class="jm io">åœ¨å¯åŠ¨æ—¶å¯åŠ¨Coturnå®ˆæŠ¤è¿›ç¨‹</strong></p><pre class="kj kk kl km gt nc my nd ne aw nf bi"><span id="108f" class="ng la in my b gy nh ni l nj nk">sudo nano /etc/default/coturn</span></pre><p id="ec8b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æ‰¾åˆ°ä¸‹é¢ä¸€è¡Œï¼Œé€šè¿‡åˆ é™¤#æ¥å–æ¶ˆæ³¨é‡Šï¼Œä»¥å°†Coturnä½œä¸ºè‡ªåŠ¨ç³»ç»ŸæœåŠ¡å®ˆæŠ¤ç¨‹åºè¿è¡Œã€‚</p><pre class="kj kk kl km gt nc my nd ne aw nf bi"><span id="341d" class="ng la in my b gy nh ni l nj nk">#TURNSERVER_ENABLED=1</span></pre><p id="4c07" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ä¿å­˜å¹¶å…³é—­æ–‡ä»¶ã€‚ç„¶åï¼Œæ‚¨å¯ä»¥é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥å¯åŠ¨CoturnæœåŠ¡</p><pre class="kj kk kl km gt nc my nd ne aw nf bi"><span id="2da0" class="ng la in my b gy nh ni l nj nk">$ systemctl start coturn</span></pre><p id="d798" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> 6ã€‚åˆ›å»ºä¸€ä¸ªç”¨æˆ·è½¬åˆ°ä¸‹ä¸€æ­¥ï¼Œç¼–è¾‘ä¸»é…ç½®æ–‡ä»¶ã€‚</strong></p><p id="ef97" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ç„¶åæ‰“å¼€æˆ–åˆ›å»º/etc/turnserver.confæ–‡ä»¶ï¼Œç²˜è´´ä»¥ä¸‹å†…å®¹ã€‚å°†<username>ã€<password>å’Œ<public_ip_address>å€¼æ›¿æ¢ä¸ºå„è‡ªçš„å€¼ã€‚</public_ip_address></password></username></p><pre class="kj kk kl km gt nc my nd ne aw nf bi"><span id="910f" class="ng la in my b gy nh ni l nj nk"># TURN fingerprints in messages.<br/>fingerprint<br/>#TURN static user account for long-term credential mechanism.<br/>user=&lt;USERNAME&gt;:&lt;PASSWORD&gt;<br/>#TURN long-term credential mechanism<br/>lt-cred-mech<br/>#TURN realm used for the long-term credential mechanism<br/>realm=&lt;YOUR_DOMAIN&gt;<br/>#Setting up log file<br/>log-file=/var/log/turnserver/turnserver.log<br/>#Disable log file rollover and use log file name as-is<br/>simple-log<br/>#The external IP address of this server.<br/>external-ip=&lt;AWS_PUBLIC_IP_ADDRESS&gt;</span></pre><p id="805d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">7ã€‚ <strong class="jm io">é‡å¯è¿”å›æœåŠ¡</strong></p><pre class="kj kk kl km gt nc my nd ne aw nf bi"><span id="b0e6" class="ng la in my b gy nh ni l nj nk">$ sudo service coturn restart</span></pre><p id="bf1f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">8ã€‚è®©æˆ‘ä»¬æµ‹è¯•æˆ‘ä»¬çš„å·¥ä½œ</p><p id="7c36" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">è¿›å…¥æ¶“æµå†°é¡µé¢ï¼Œè¾“å…¥ä½ è‡ªå·±çš„æœåŠ¡å™¨è¯¦æƒ…ã€‚</p><pre class="kj kk kl km gt nc my nd ne aw nf bi"><span id="aa55" class="ng la in my b gy nh ni l nj nk">STUN or TURN URI: turn:&lt;PUBLIC_IP_ADDRESS&gt;:3478<br/>TURN username: &lt;USERNAME&gt;<br/>TURN password: &lt;PASSWORD&gt;</span></pre><p id="5686" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ç„¶åå•å‡»æ·»åŠ æœåŠ¡å™¨ï¼Œç„¶åå•å‡»â€œæ”¶é›†å€™é€‰äººâ€æŒ‰é’®ã€‚å¦‚æœæ‚¨å·²ç»æ­£ç¡®é…ç½®äº†æ‰€æœ‰å†…å®¹ï¼Œé‚£ä¹ˆæ‚¨åº”è¯¥ä¼šçœ‹åˆ°â€œDoneâ€ä½œä¸ºæœ€ç»ˆç»“æœã€‚</p><h1 id="7077" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">è®©æˆ‘ä»¬ç¼–ç å§</h1><ol class=""><li id="9334" class="lx ly in jm b jn lz jr ma jv mb jz mc kd md kh me mf mg mh bi translated"><strong class="jm io">ä¸‹è½½èŠ‚ç‚¹ã€‚Js </strong></li><li id="5382" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><strong class="jm io">åˆ›å»ºä¸€ä¸ªèŠ‚ç‚¹é¡¹ç›®</strong></li></ol><ul class=""><li id="2cff" class="lx ly in jm b jn jo jr js jv ms jz mt kd mu kh mn mf mg mh bi translated">åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹ã€‚è¿™ä¸ªæ–‡ä»¶å¤¹å°†æ˜¯æˆ‘ä»¬é¡¹ç›®çš„æ ¹ç›®å½•ã€‚</li><li id="71bf" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh mn mf mg mh bi translated">æ‰“å¼€è¯¥æ–‡ä»¶å¤¹ä¸­çš„terminal/CMDå¹¶è¿è¡Œnpm initå‘½ä»¤ã€‚</li><li id="6543" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh mn mf mg mh bi translated">è¾“å…¥æç¤ºçš„è¯¦ç»†ä¿¡æ¯æˆ–è·³è¿‡å®ƒä»¬</li><li id="066f" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh mn mf mg mh bi translated">è¿™å°†åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªpackage.jsonæ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶å°†åŒ…å«å…³äºæˆ‘ä»¬çš„é¡¹ç›®çš„æ‰€æœ‰å¿…è¦ä¿¡æ¯ï¼Œå¦‚é¡¹ç›®ä¾èµ–æ€§ã€‚</li></ul><p id="5da7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">3.<strong class="jm io">å®‰è£…ä¾èµ–é¡¹</strong></p><ul class=""><li id="4eea" class="lx ly in jm b jn jo jr js jv ms jz mt kd mu kh mn mf mg mh bi translated"><code class="fe mv mw mx my b">npm install express socket.io --save</code></li></ul><p id="6a16" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">4.<strong class="jm io">åˆ›å»ºæ–‡ä»¶å’Œæ–‡ä»¶å¤¹</strong></p><ul class=""><li id="1f4c" class="lx ly in jm b jn jo jr js jv ms jz mt kd mu kh mn mf mg mh bi translated">åœ¨æ ¹æ–‡ä»¶å¤¹ä¸­åˆ›å»ºindex.jsæ–‡ä»¶</li><li id="770c" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh mn mf mg mh bi translated">åœ¨æ ¹æ–‡ä»¶å¤¹ä¸­åˆ›å»ºå…¬å…±å’Œè§†å›¾æ–‡ä»¶å¤¹</li><li id="3a82" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh mn mf mg mh bi translated">åœ¨è§†å›¾æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªç´¢å¼•ã€‚ejsæ–‡ä»¶</li></ul><p id="2883" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">5.<strong class="jm io">index . jsä¸­çš„ç¼–ç åç«¯(åœ¨æ ¹æ–‡ä»¶å¤¹ä¸­)</strong></p><pre class="kj kk kl km gt nc my nd ne aw nf bi"><span id="91c6" class="ng la in my b gy nh ni l nj nk">'use strict';<br/><br/>//Loading dependencies &amp; initializing express<br/>var os = require('os');<br/>var express = require('express');<br/>var app = express();<br/>var http = require('http');<br/>//For signalling in WebRTC<br/>var socketIO = require('socket.io');<br/><br/><br/>app.use(express.static('public'))<br/><br/>app.get("/", function(req, res){<br/>	res.render("index.ejs");<br/>});<br/><br/>var server = http.createServer(app);<br/><br/>server.listen(process.env.PORT || 8000);<br/><br/>var io = socketIO(server);<br/><br/>io.sockets.on('connection', function(socket) {<br/><br/>	// Convenience function to log server messages on the client.<br/>	// Arguments is an array like object which contains all the arguments of log(). <br/>	// To push all the arguments of log() in array, we have to use apply().<br/>	function log() {<br/>	  var array = ['Message from server:'];<br/>	  array.push.apply(array, arguments);<br/>	  socket.emit('log', array);<br/>	}<br/>  <br/>    <br/>    //Defining Socket Connections<br/>    socket.on('message', function(message, room) {<br/>	  log('Client said: ', message);<br/>	  // for a real app, would be room-only (not broadcast)<br/>	  socket.in(room).emit('message', message, room);<br/>	});<br/>  <br/>	socket.on('create or join', function(room) {<br/>	  log('Received request to create or join room ' + room);<br/>  <br/>	  var clientsInRoom = io.sockets.adapter.rooms[room];<br/>	  var numClients = clientsInRoom ? Object.keys(clientsInRoom.sockets).length : 0;<br/>	  log('Room ' + room + ' now has ' + numClients + ' client(s)');<br/>  <br/>	  if (numClients === 0) {<br/>		socket.join(room);<br/>		log('Client ID ' + socket.id + ' created room ' + room);<br/>		socket.emit('created', room, socket.id);<br/>  <br/>	  } else if (numClients === 1) {<br/>		log('Client ID ' + socket.id + ' joined room ' + room);<br/>		io.sockets.in(room).emit('join', room);<br/>		socket.join(room);<br/>		socket.emit('joined', room, socket.id);<br/>		io.sockets.in(room).emit('ready');<br/>	  } else { // max two clients<br/>		socket.emit('full', room);<br/>	  }<br/>	});<br/>  <br/>	socket.on('ipaddr', function() {<br/>	  var ifaces = os.networkInterfaces();<br/>	  for (var dev in ifaces) {<br/>		ifaces[dev].forEach(function(details) {<br/>		  if (details.family === 'IPv4' &amp;&amp; details.address !== '127.0.0.1') {<br/>			socket.emit('ipaddr', details.address);<br/>		  }<br/>		});<br/>	  }<br/>	});<br/>  <br/>	socket.on('bye', function(){<br/>	  console.log('received bye');<br/>	});<br/>  <br/>  });</span></pre><p id="8ea3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> 6ã€‚åœ¨å…¬å…±åœºæ‰€åˆ›å»ºæ–‡ä»¶å’Œæ–‡ä»¶å¤¹</strong></p><ul class=""><li id="d97b" class="lx ly in jm b jn jo jr js jv ms jz mt kd mu kh mn mf mg mh bi translated">åœ¨publicä¸­åˆ›å»ºCSSæ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨å…¶ä¸­åˆ›å»ºstyles.cssæ–‡ä»¶ã€‚</li><li id="6d93" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh mn mf mg mh bi translated">åœ¨publicä¸­åˆ›å»ºJsæ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨å…¶ä¸­åˆ›å»ºmain.jså’Œconfig.jsæ–‡ä»¶ã€‚</li></ul><p id="6011" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> 7ã€‚æ›´æ–°ç´¢å¼•ä¸­çš„å‰ç«¯ä»£ç ã€‚è§†å›¾æ–‡ä»¶å¤¹ä¸­çš„ejs</strong></p><pre class="kj kk kl km gt nc my nd ne aw nf bi"><span id="b017" class="ng la in my b gy nh ni l nj nk">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/><br/>&lt;head&gt;<br/><br/>  &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;<br/>  <br/>  &lt;!-- Import Google Fonts --&gt;<br/>  &lt;link href="https://fonts.googleapis.com/css2?family=Baloo+Tamma+2:wght@400;500;600&amp;family=Josefin+Slab&amp;display=swap" rel="stylesheet"&gt;<br/>  <br/>  &lt;!-- Import CSS file --&gt;<br/>  &lt;link rel="stylesheet" href="/css/styles.css"&gt;<br/><br/>  &lt;!-- &lt;link rel="stylesheet" href="/css/main.css" /&gt; --&gt;<br/><br/>&lt;/head&gt;<br/><br/>&lt;body class="h-100"&gt;<br/>  &lt;div class="h-100" id="video_display"&gt;<br/>	&lt;div id ="video_container" class="align-items-center" style="margin-top: 10%;"&gt;<br/>      		&lt;div class="local_div" id="div1" style=""&gt;<br/>			&lt;!-- For playing local video --&gt;<br/>			&lt;video id="localVideo" class="" autoplay muted playsinline&gt;&lt;/video&gt;<br/>		&lt;/div&gt;<br/>		&lt;div class="remote_div" id="div2"&gt;<br/>			&lt;!-- For playing local audio --&gt;<br/>			&lt;video id="remoteVideo" class="" autoplay playsinline&gt;&lt;/video&gt;<br/>		&lt;/div&gt;<br/>    	&lt;/div&gt;<br/>  &lt;/div&gt;<br/><br/>  &lt;!-- Import SocketIO for signalling --&gt;<br/>  &lt;script src="/socket.io/socket.io.js"&gt;&lt;/script&gt;<br/><br/>  &lt;!-- Import WebRTC adapter for compatibility with all the browsers  --&gt;<br/>  &lt;script src="https://webrtc.github.io/adapter/adapter-latest.js"&gt;&lt;/script&gt;<br/>  <br/>  &lt;!-- Import TURN config --&gt;<br/>  &lt;script src="js\config.js"&gt;&lt;/script&gt;<br/><br/>  &lt;!-- Import script containing WebRTC related functions --&gt;<br/>  &lt;script src="js\main.js"&gt;&lt;/script&gt;<br/>  <br/>&lt;/body&gt;<br/><br/>&lt;/html&gt;</span></pre><p id="a9d8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> 8ã€‚styles.cssä»£ç </strong></p><pre class="kj kk kl km gt nc my nd ne aw nf bi"><span id="4098" class="ng la in my b gy nh ni l nj nk">*, ::after, ::before {<br/>    box-sizing: border-box;<br/>}<br/><br/><br/>html {<br/>	display: block;<br/>	line-height: 1.15;<br/>}<br/><br/>div {<br/>	display: block;<br/>}<br/><br/>body {<br/>	margin: 0;<br/>    line-height: 1.5;<br/>    color: #212529;<br/>    text-align: left;<br/>	display: block;<br/>	background-color: #0080AD;<br/>	font-family: 'Baloo Tamma 2', cursive;<br/>}<br/><br/>.h-100 {<br/>	height: 100%!important;<br/>}<br/><br/>.row {<br/>    display: -ms-flexbox;<br/>    display: flex;<br/>    -ms-flex-wrap: wrap;<br/>    flex-wrap: wrap;<br/><br/>}<br/><br/>.ml-auto, .mx-auto {<br/>    margin-left: auto!important;<br/>}<br/><br/>.mr-auto, .mx-auto {<br/>    margin-right: auto!important;<br/>}<br/><br/>.font-weight-bold {<br/>    font-weight: 600!important;<br/>}<br/><br/>.text-center {<br/>    text-align: center!important;<br/>}<br/><br/><br/>.jumbotron {<br/>    background-color: #e9ecef;<br/>}<br/><br/><br/><br/>.align-items-center {<br/>    -ms-flex-align: center!important;<br/>    align-items: center!important;<br/>}<br/><br/><br/>.container {<br/>    margin-right: auto;<br/>    margin-left: auto;<br/>}<br/><br/><br/><br/>/* For Desktop  */<br/>	.col-12 {<br/>		position: relative;<br/>		width: 40%;<br/>	}<br/><br/>	.jumbotron {<br/>		padding: 2rem 1rem;<br/>		margin-bottom: 2rem;<br/>		border-radius: .3rem;<br/>	}<br/><br/>	#h1 {<br/>		font-size: 1.5rem;<br/>		font-weight: 300;<br/>		line-height: 1.2;<br/>		margin-bottom: 1rem!important;<br/>		margin-top: 0px!important;<br/>	}<br/>	<br/>	<br/><br/>@media (orientation: landscape) {<br/>	.btn-danger {<br/>		display:block;<br/>		font-size : 15px;<br/>		margin:auto;<br/>		width: 15%;<br/>		height: 25px;<br/>		color: #fff;<br/>		background-color: #25274d;<br/>		border-color: #25274d;<br/>	}<br/>		<br/>	.btn {<br/>		display:block;<br/>		font-size : 15px;<br/>		margin:auto;<br/>		margin-right:0px;<br/>		width: 15%;<br/>		height: 25px;<br/>		color: #fff;<br/>		background-color: #25274d;<br/>		border-color: #25274d;<br/>	}<br/>	<br/>	.btn_option {<br/>		display:block;<br/>		font-size : 15px;<br/>		margin:auto;<br/>		width: 50%;<br/>		height: 25px;<br/>		color: #fff;<br/>		background-color: #25274d;<br/>		border-color: #25274d;<br/>	}<br/>	<br/>	<br/>	<br/>	#room_value {<br/>		margin-left: 20px;<br/>	}<br/>	<br/>	.local_div {<br/>		width:33%;<br/>		float:left<br/>	}<br/><br/>	.remote_div {<br/>		width:33%;<br/>		float:left<br/>	}<br/><br/>	.remote2_div {<br/>		width:33%;<br/>		float:left<br/>	}<br/><br/>	#video_container {<br/>		display: flex;<br/>		width: 85%;<br/>		margin: auto;<br/>		height: 80% <br/>	}<br/>	<br/>	video {<br/>		width:100%;<br/>	}<br/><br/>}<br/>/* For Mobile */<br/><br/>@media (orientation: portrait)<br/>{<br/>	.row {<br/>		margin-right: -15px;<br/>		margin-left: -15px;<br/>	}<br/><br/>	.col-12 {<br/>		padding-right: 15px;<br/>		padding-left: 15px;<br/>		position: relative;<br/>		width: 100%;<br/>	}<br/><br/>	.container {<br/>		max-width: 310px;<br/>		padding-right: 5px;<br/>		padding-left: 5px;<br/>	}<br/><br/>	.jumbotron {<br/>		/* padding: 0.02rem 2rem; */<br/>		padding: 2rem 1rem;<br/>		margin-bottom: 2rem;<br/>		border-radius: .3rem;<br/>	}<br/><br/>	#h1 {<br/>		font-size: 1.5rem;<br/>		font-weight: 300;<br/>		line-height: 1.2;<br/>		margin-bottom: 1rem!important;<br/>		margin-top: 0px!important;<br/>	}<br/><br/>	#label_name {<br/>		font-size: 17px;<br/>		width: 100%;<br/>	}<br/><br/>	.form-group {<br/>    margin-bottom: 1rem;<br/>	}<br/><br/>	.form-control {<br/>		height:35px;<br/>		font-size:20px;<br/>		display: block;<br/>		width: 100%;<br/>		padding: .375rem .75rem;<br/>		font-weight: 400;<br/>		line-height: 1.5;<br/>		color: #495057;<br/>		background-color: #fff;<br/>		background-clip: padding-box;<br/>		border: 1px solid #ced4da;<br/>		border-radius: .25rem;<br/>		transition: border-color .15s ease-in-out,box-shadow .15s ease-in-out;<br/>	}<br/><br/>	.btn {<br/>		font-size : 16px;<br/>		width: 100%;<br/>		height: 35px;<br/>		color: #fff;<br/>		background-color: #25274d;<br/>		border-color: #25274d;<br/>	}<br/><br/>	.local_div {<br/>		display: flex<br/>		;<br/>		width: 100%;<br/>		position:relative;<br/>    overflow:hidden;<br/>    z-index:-1;<br/>	}<br/><br/>	.remote_div {<br/>		width: 120px;<br/>		display: block;<br/>		position:absolute;<br/>		top:0px;<br/>		right:0px;<br/>		z-index:1;<br/>	}<br/><br/>	.remote2_div {<br/>		width: 120px;<br/>		display: block;<br/>		position:absolute;<br/>		top:95px;<br/>		right:0px;<br/>		z-index:1;<br/>	}<br/><br/>	#video_container {<br/>		height: 80%;<br/>		position:relative;<br/>		display:flex;<br/>		flex-wrap:wrap<br/>	}<br/>	<br/>	.remote_div video {<br/>		-ms-flex: 0 0 100%;<br/>		flex: 0 0 100%;<br/>		max-width: 100%;<br/>	}<br/><br/>	.remote2_div video {<br/>		-ms-flex: 0 0 100%;<br/>		flex: 0 0 100%;<br/>		max-width: 100%;<br/>	}<br/>	<br/>	.btn-danger {<br/>		font-size : 16px;<br/>		width: 100%;<br/>		height: 35px;<br/>		color: #fff;<br/>		background-color: #25274d;<br/>		border-color: #25274d;<br/>	}<br/>	<br/>}</span></pre><p id="cd20" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> 9ã€‚æ›´æ–°main.jsæ–‡ä»¶</strong></p><pre class="kj kk kl km gt nc my nd ne aw nf bi"><span id="3729" class="ng la in my b gy nh ni l nj nk">'use strict';<br/><br/>//Defining some global utility variables<br/>var isChannelReady = false;<br/>var isInitiator = false;<br/>var isStarted = false;<br/>var localStream;<br/>var pc;<br/>var remoteStream;<br/>var turnReady;<br/><br/>//Initialize turn/stun server here<br/>//turnconfig will be defined in public/js/config.js<br/>var pcConfig = turnConfig;<br/><br/>//Set local stream constraints<br/>var localStreamConstraints = {<br/>    audio: true,<br/>    video: true<br/>  };<br/><br/><br/>// Prompting for room name:<br/>var room = prompt('Enter room name:');<br/><br/>//Initializing socket.io<br/>var socket = io.connect();<br/><br/>//Ask server to add in the room if room name is provided by the user<br/>if (room !== '') {<br/>  socket.emit('create or join', room);<br/>  console.log('Attempted to create or  join room', room);<br/>}<br/><br/>//Defining socket events<br/><br/>//Event - Client has created the room i.e. is the first member of the room<br/>socket.on('created', function(room) {<br/>  console.log('Created room ' + room);<br/>  isInitiator = true;<br/>});<br/><br/>//Event - Room is full<br/>socket.on('full', function(room) {<br/>  console.log('Room ' + room + ' is full');<br/>});<br/><br/>//Event - Another client tries to join room<br/>socket.on('join', function (room){<br/>  console.log('Another peer made a request to join room ' + room);<br/>  console.log('This peer is the initiator of room ' + room + '!');<br/>  isChannelReady = true;<br/>});<br/><br/>//Event - Client has joined the room<br/>socket.on('joined', function(room) {<br/>  console.log('joined: ' + room);<br/>  isChannelReady = true;<br/>});<br/><br/>//Event - server asks to log a message<br/>socket.on('log', function(array) {<br/>  console.log.apply(console, array);<br/>});<br/><br/><br/>//Event - for sending meta for establishing a direct connection using WebRTC<br/>//The Driver code<br/>socket.on('message', function(message, room) {<br/>    console.log('Client received message:', message,  room);<br/>    if (message === 'got user media') {<br/>      maybeStart();<br/>    } else if (message.type === 'offer') {<br/>      if (!isInitiator &amp;&amp; !isStarted) {<br/>        maybeStart();<br/>      }<br/>      pc.setRemoteDescription(new RTCSessionDescription(message));<br/>      doAnswer();<br/>    } else if (message.type === 'answer' &amp;&amp; isStarted) {<br/>      pc.setRemoteDescription(new RTCSessionDescription(message));<br/>    } else if (message.type === 'candidate' &amp;&amp; isStarted) {<br/>      var candidate = new RTCIceCandidate({<br/>        sdpMLineIndex: message.label,<br/>        candidate: message.candidate<br/>      });<br/>      pc.addIceCandidate(candidate);<br/>    } else if (message === 'bye' &amp;&amp; isStarted) {<br/>      handleRemoteHangup();<br/>    }<br/>});<br/>  <br/><br/><br/>//Function to send message in a room<br/>function sendMessage(message, room) {<br/>  console.log('Client sending message: ', message, room);<br/>  socket.emit('message', message, room);<br/>}<br/><br/><br/><br/>//Displaying Local Stream and Remote Stream on webpage<br/>var localVideo = document.querySelector('#localVideo');<br/>var remoteVideo = document.querySelector('#remoteVideo');<br/>console.log("Going to find Local media");<br/>navigator.mediaDevices.getUserMedia(localStreamConstraints)<br/>.then(gotStream)<br/>.catch(function(e) {<br/>  alert('getUserMedia() error: ' + e.name);<br/>});<br/><br/>//If found local stream<br/>function gotStream(stream) {<br/>  console.log('Adding local stream.');<br/>  localStream = stream;<br/>  localVideo.srcObject = stream;<br/>  sendMessage('got user media', room);<br/>  if (isInitiator) {<br/>    maybeStart();<br/>  }<br/>}<br/><br/><br/>console.log('Getting user media with constraints', localStreamConstraints);<br/><br/>//If initiator, create the peer connection<br/>function maybeStart() {<br/>  console.log('&gt;&gt;&gt;&gt;&gt;&gt;&gt; maybeStart() ', isStarted, localStream, isChannelReady);<br/>  if (!isStarted &amp;&amp; typeof localStream !== 'undefined' &amp;&amp; isChannelReady) {<br/>    console.log('&gt;&gt;&gt;&gt;&gt;&gt; creating peer connection');<br/>    createPeerConnection();<br/>    pc.addStream(localStream);<br/>    isStarted = true;<br/>    console.log('isInitiator', isInitiator);<br/>    if (isInitiator) {<br/>      doCall();<br/>    }<br/>  }<br/>}<br/><br/>//Sending bye if user closes the window<br/>window.onbeforeunload = function() {<br/>  sendMessage('bye', room);<br/>};<br/><br/><br/>//Creating peer connection<br/>function createPeerConnection() {<br/>  try {<br/>    pc = new RTCPeerConnection(pcConfig);<br/>    pc.onicecandidate = handleIceCandidate;<br/>    pc.onaddstream = handleRemoteStreamAdded;<br/>    pc.onremovestream = handleRemoteStreamRemoved;<br/>    console.log('Created RTCPeerConnnection');<br/>  } catch (e) {<br/>    console.log('Failed to create PeerConnection, exception: ' + e.message);<br/>    alert('Cannot create RTCPeerConnection object.');<br/>    return;<br/>  }<br/>}<br/><br/>//Function to handle Ice candidates generated by the browser<br/>function handleIceCandidate(event) {<br/>  console.log('icecandidate event: ', event);<br/>  if (event.candidate) {<br/>    sendMessage({<br/>      type: 'candidate',<br/>      label: event.candidate.sdpMLineIndex,<br/>      id: event.candidate.sdpMid,<br/>      candidate: event.candidate.candidate<br/>    }, room);<br/>  } else {<br/>    console.log('End of candidates.');<br/>  }<br/>}<br/><br/>function handleCreateOfferError(event) {<br/>  console.log('createOffer() error: ', event);<br/>}<br/><br/>//Function to create offer<br/>function doCall() {<br/>  console.log('Sending offer to peer');<br/>  pc.createOffer(setLocalAndSendMessage, handleCreateOfferError);<br/>}<br/><br/>//Function to create answer for the received offer<br/>function doAnswer() {<br/>  console.log('Sending answer to peer.');<br/>  pc.createAnswer().then(<br/>    setLocalAndSendMessage,<br/>    onCreateSessionDescriptionError<br/>  );<br/>}<br/><br/>//Function to set description of local media<br/>function setLocalAndSendMessage(sessionDescription) {<br/>  pc.setLocalDescription(sessionDescription);<br/>  console.log('setLocalAndSendMessage sending message', sessionDescription);<br/>  sendMessage(sessionDescription, room);<br/>}<br/><br/>function onCreateSessionDescriptionError(error) {<br/>  trace('Failed to create session description: ' + error.toString());<br/>}<br/><br/>//Function to play remote stream as soon as this client receives it<br/>function handleRemoteStreamAdded(event) {<br/>  console.log('Remote stream added.');<br/>  remoteStream = event.stream;<br/>  remoteVideo.srcObject = remoteStream;<br/>}<br/><br/>function handleRemoteStreamRemoved(event) {<br/>  console.log('Remote stream removed. Event: ', event);<br/>}<br/><br/>function hangup() {<br/>  console.log('Hanging up.');<br/>  stop();<br/>  sendMessage('bye',room);<br/>}<br/><br/>function handleRemoteHangup() {<br/>  console.log('Session terminated.');<br/>  stop();<br/>  isInitiator = false;<br/>}<br/><br/>function stop() {<br/>  isStarted = false;<br/>  pc.close();<br/>  pc = null;<br/>}</span></pre><p id="5678" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> 10ã€‚æ›´æ–°config.jsæ–‡ä»¶</strong></p><pre class="kj kk kl km gt nc my nd ne aw nf bi"><span id="d92b" class="ng la in my b gy nh ni l nj nk">turnConfig = {<br/>    iceServers: [<br/>    {   <br/>      urls: [ "stun:&lt;YOUR_URL&gt;" ]<br/>    }, <br/>    {   <br/>      username: "likhith",   <br/>      credential: "password",   <br/>      urls: [       <br/>        "turn:&lt;YOUR_URL&gt;:3478?transport=udp",       <br/>        "turn:&lt;YOUR_URL&gt;:3478?transport=tcp",       <br/>       ]<br/>     }<br/>   ]<br/>}</span></pre><h1 id="5778" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">æ­å–œä½ ã€‚ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</h1><p id="5876" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mo jx jy jz mp kb kc kd mq kf kg kh ig bi translated">æˆ‘ä»¬åšåˆ°äº†ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ğŸ¥µğŸ¥µğŸ¥µğŸ¥µğŸ¥µğŸ¥µğŸ¥µğŸ¥µğŸ¥µğŸ¥µğŸ¥µ</p><ul class=""><li id="3763" class="lx ly in jm b jn jo jr js jv ms jz mt kd mu kh mn mf mg mh bi translated">åœ¨æˆ‘ä»¬é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹æ‰“å¼€ä¸€ä¸ªç»ˆç«¯ã€‚</li><li id="7880" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh mn mf mg mh bi translated">è¿è¡Œä»¥ä¸‹å‘½ä»¤â€” node <code class="fe mv mw mx my b">index.js</code>ã€‚</li><li id="7cf7" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh mn mf mg mh bi translated">æ‰“å¼€è°·æ­Œæµè§ˆå™¨ï¼Œè®¿é—®<code class="fe mv mw mx my b">localhost:8000</code>ã€‚è¾“å…¥æˆ¿é—´åç§°(æ¯”å¦‚foo)ã€‚ä½ åº”è¯¥çœ‹çœ‹ä½ çš„è§†é¢‘ã€‚</li><li id="a6cd" class="lx ly in jm b jn mi jr mj jv mk jz ml kd mm kh mn mf mg mh bi translated">æ‰“å¼€ä¸€ä¸ªæ–°æ ‡ç­¾é¡µå¹¶è®¿é—®<code class="fe mv mw mx my b">localhost:8000</code>ã€‚è¾“å…¥ç›¸åŒçš„æˆ¿é—´åç§°(foo)ã€‚æ‚¨ç°åœ¨åº”è¯¥ä¼šçœ‹åˆ°ä¸¤ä¸ªè§†é¢‘å…ƒç´ ã€‚</li></ul></div></div>    
</body>
</html>