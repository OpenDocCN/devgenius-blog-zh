<html>
<head>
<title>Quick Start with Apache DolphinScheduler Machine Learning Workflow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Apache DolphinScheduler 机器学习工作流程快速入门</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/quick-start-with-apache-dolphinscheduler-machine-learning-workflow-ee267e606cae?source=collection_archive---------11-----------------------#2022-12-05">https://blog.devgenius.io/quick-start-with-apache-dolphinscheduler-machine-learning-workflow-ee267e606cae?source=collection_archive---------11-----------------------#2022-12-05</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/818a38220a5576f08eb5665b8c04b81b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dWAAz388x6G32PD5eahFyA.png"/></div></div></figure><h1 id="9e5e" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">摘要</h1><p id="186c" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">随着 Apache DolphinScheduler 3.1.0 的发布，增加了许多 AI 组件，以帮助用户更高效地在 Apache DolphinScheduler 上构建机器学习工作流。</p><p id="b5bc" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">本文详细描述了如何用一些机器学习环境来设置 DolphinScheduler。还通过实验示例介绍了 MLflow 组件和 DVC 组件的使用。</p><h1 id="9e56" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">DolphinScheduler 和机器学习环境</h1><h2 id="b23c" class="lw jw in bd jx lx ly dn kb lz ma dp kf le mb mc kj li md me kn lm mf mg kr mh bi translated">测试程序</h2><p id="68d1" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">所有代码可以在<a class="ae mi" href="https://github.com/jieguangzhou/dolphinscheduler-ml-tutorial" rel="noopener ugc nofollow" target="_blank">https://github . com/Jie Guangzhou/dolphin scheduler-ml-tutorial</a>找到</p><p id="40ea" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">获取代码</p><pre class="mj mk ml mm gt mn mo mp bn mq mr bi"><span id="d8ac" class="ms jw in mo b be mt mu l mv mw">git clone &lt;https://github.com/jieguangzhou/dolphinscheduler-ml-tutorial.git&gt;<br/>git checkout dev</span></pre><h2 id="69b3" class="lw jw in bd jx lx ly dn kb lz ma dp kf le mb mc kj li md me kn lm mf mg kr mh bi translated">安装环境</h2><p id="f5bb" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated"><strong class="kv io">康达</strong></p><p id="efeb" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">只需按照官方网站安装它，并将 Conda 的路径添加到环境变量中</p><p id="f0f1" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">安装后，mlflow 和 dvc 命令将被安装在 conda 的 bin 目录中。</p><pre class="mj mk ml mm gt mn mo mp bn mq mr bi"><span id="84e5" class="ms jw in mo b be mt mu l mv mw">pip install mlflow==1.30.0 dvc</span></pre><h2 id="5c04" class="lw jw in bd jx lx ly dn kb lz ma dp kf le mb mc kj li md me kn lm mf mg kr mh bi translated">Java8 环境</h2><pre class="mj mk ml mm gt mn mo mp bn mq mr bi"><span id="4eab" class="ms jw in mo b be mt mu l mv mw">sudo apt-get update<br/>sudo apt-get install openjdk-8-jdk<br/>java -version</span></pre><p id="3685" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">配置 Java 环境变量，~/。bashrc 或者~/。zshrc</p><pre class="mj mk ml mm gt mn mo mp bn mq mr bi"><span id="b5e6" class="ms jw in mo b be mt mu l mv mw"># Confirm that your jdk is as below and configure the environment variables<br/>export JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64<br/>export PATH=$PATH:$JAVA_HOME/bin</span></pre><h2 id="0689" class="lw jw in bd jx lx ly dn kb lz ma dp kf le mb mc kj li md me kn lm mf mg kr mh bi translated">阿帕奇海豚调度程序 3.1.0</h2><p id="61a0" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">下载海豚调度程序 3.1.0</p><pre class="mj mk ml mm gt mn mo mp bn mq mr bi"><span id="1ca0" class="ms jw in mo b be mt mu l mv mw"># Go to the following directory (you can install in other directories, for the convenience of replication, in this case, the installation is performed in the following directory)<br/>cd first-example/install_dolphinscheduler<br/>## install DolphinScheduler<br/>wget &lt;https://dlcdn.apache.org/dolphinscheduler/3.1.0/apache-dolphinscheduler-3.1.0-bin.tar.gz&gt;<br/>tar -zxvf apache-dolphinscheduler-3.1.0-bin.tar.gz<br/>rm apache-dolphinscheduler-3.1.0-bin.tar.gz</span></pre><p id="7ea2" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">在 DolphinScheduler 中配置 Conda 环境和 Python 环境</p><pre class="mj mk ml mm gt mn mo mp bn mq mr bi"><span id="0f9d" class="ms jw in mo b be mt mu l mv mw">## Configure conda environment and default python environment<br/>cp common.properties apache-dolphinscheduler-3.1.0-bin/standalone-server/conf<br/>echo "export PATH=$(which conda)/bin:\\$PATH" &gt;&gt; apache-dolphinscheduler-3.1.0-bin/bin/env/dolphinscheduler_env.sh<br/>echo "export PYTHON_HOME=$(dirname $(which conda))/python" &gt;&gt; apache-dolphinscheduler-3.1.0-bin/bin/env/dolphinscheduler_env.sh</span></pre><ul class=""><li id="005f" class="mx my in kv b kw lr la ls le mz li na lm nb lq nc nd ne nf bi translated">dolphinscheduler-mlflow 配置</li></ul><p id="63cf" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">当使用 MLFLOW 组件时，GitHub 上的 dolphinscheduler-mlflow 项目将被用作参考，因此如果您无法获得正确的网络连接，可以通过以下步骤替换存储库源代码</p><p id="5e8f" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">首先执行 git 克隆<https:/></p><p id="a044" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">然后将 common.properties 中 ml.mlflow.preset_repository 字段的值更改为下载的默认路径</p><p id="9cb6" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">启动海豚调度程序</p><pre class="mj mk ml mm gt mn mo mp bn mq mr bi"><span id="b661" class="ms jw in mo b be mt mu l mv mw">## start DolphinScheduler<br/>cd apache-dolphinscheduler-3.1.0-bin<br/>bash bin/dolphinscheduler-daemon.sh start standalone-server<br/>## You can view the log using the following command<br/># tail -500f standalone-server/logs/dolphinscheduler-standalone.log</span></pre><p id="d2ca" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">一旦启动，等待服务启动，你将被带到 DolphinScheduler 页面</p><p id="0400" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">打开<a class="ae mi" href="http://localhost:12345/dolphinscheduler/ui" rel="noopener ugc nofollow" target="_blank">http://localhost:12345/dolphinscheduler/ui</a>就会看到 dolphin scheduler 页面</p><p id="45a5" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">账号:admin，密码:dolphinscheduler123</p><figure class="mj mk ml mm gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/5526324ea0aea701a07313a6f5166170.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SqdDeMrP3iOQKVnWL6AKXA.png"/></div></div></figure><h2 id="8568" class="lw jw in bd jx lx ly dn kb lz ma dp kf le mb mc kj li md me kn lm mf mg kr mh bi translated">MLflow</h2><p id="66f5" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">MLflow 跟踪服务器的启动相对简单，只需使用命令 docker run-name ml flow-p 5000:5000-d jalonzjg/ml flow:latest 即可启动</p><p id="cbd7" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">打开<a class="ae mi" href="http://localhost:5000" rel="noopener ugc nofollow" target="_blank"> http://localhost:5000 </a>，就能找到 MLflow 模型和测试管理页面</p><figure class="mj mk ml mm gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/b3dd595859d55d040d34c34fb2387a9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pid1nNpb1gqYSJMW2JdQKA.png"/></div></div></figure><p id="0ec4" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">这个镜像的 docker 文件可以在 first-example/docker-ml flow/docker file 中找到</p><h1 id="5168" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">组件介绍</h1><p id="fe53" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">本文中使用了 5 种主要类型的组件</p><h2 id="e22d" class="lw jw in bd jx lx ly dn kb lz ma dp kf le mb mc kj li md me kn lm mf mg kr mh bi translated">外壳组件</h2><p id="1afb" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">shell 组件用于运行 SHELL 类型的任务</p><h2 id="8b5e" class="lw jw in bd jx lx ly dn kb lz ma dp kf le mb mc kj li md me kn lm mf mg kr mh bi translated">PYTHON 组件</h2><p id="33d6" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">python 组件用于运行 PYTHON 类型的任务</p><h2 id="5292" class="lw jw in bd jx lx ly dn kb lz ma dp kf le mb mc kj li md me kn lm mf mg kr mh bi translated">条件组件</h2><p id="cf2c" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">条件是一个条件节点，它根据上游任务的运行状态来确定应该运行哪个下游任务。</p><h2 id="9d57" class="lw jw in bd jx lx ly dn kb lz ma dp kf le mb mc kj li md me kn lm mf mg kr mh bi translated">MLFLOW 组件</h2><p id="71a1" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">MLFLOW 组件用于在基于 dolphinscheduler-mlflow 库的 DolphinScheduler 上运行 MLflow 项目，以实现分类场景的预构建算法和 AutoML 功能，并在 mlflow 跟踪服务器上部署模型</p><h2 id="b852" class="lw jw in bd jx lx ly dn kb lz ma dp kf le mb mc kj li md me kn lm mf mg kr mh bi translated">DVC 组件</h2><p id="fd63" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">DVC 组件用于 DolphinScheduler 上机器学习中的数据版本化，比如将特定数据注册为特定版本，下载特定版本的数据。</p><p id="09ee" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">在上述五个组成部分中</p><ul class=""><li id="1a89" class="mx my in kv b kw lr la ls le mz li na lm nb lq nc nd ne nf bi translated">SHELL 组件和 PYTHON 组件是基础组件，可以运行多种任务。</li><li id="3104" class="mx my in kv b kw ng la nh le ni li nj lm nk lq nc nd ne nf bi translated">条件是可以动态控制工作流操作逻辑的逻辑组件。</li><li id="0a69" class="mx my in kv b kw ng la nh le ni li nj lm nk lq nc nd ne nf bi translated">MLFLOW 组件和 DVC 组件是机器学习类型的组件，可用于促进工作流内的机器学习场景特征能力的易用性。</li></ul><h1 id="b748" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">机器学习工作流</h1><p id="c45c" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">工作流程由三部分组成。</p><ul class=""><li id="95c4" class="mx my in kv b kw lr la ls le mz li na lm nb lq nc nd ne nf bi translated">第一部分是前期准备，如数据下载、数据版本化管理库等。；这是一次性的准备。</li><li id="9c05" class="mx my in kv b kw ng la nh le ni li nj lm nk lq nc nd ne nf bi translated">第二部分是训练模型工作流程:包括数据预处理、训练模型和模型评估</li><li id="8300" class="mx my in kv b kw ng la nh le ni li nj lm nk lq nc nd ne nf bi translated">第三部分是部署工作流，包括模型部署和接口测试。</li></ul><h2 id="c8f3" class="lw jw in bd jx lx ly dn kb lz ma dp kf le mb mc kj li md me kn lm mf mg kr mh bi translated">初步准备工作流程</h2><p id="d382" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">创建一个目录来存储所有的过程数据 mkdir /tmp/ds-ml-example</p><p id="32f1" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">在程序的开始，我们需要下载测试数据并初始化 DVC 存储库以进行数据版本控制</p><p id="00ab" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">以下所有命令都在 dolphin scheduler-ml-tutorial/first-example 目录中运行</p><p id="68b9" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">因为我们通过 pydolphinscheduler 提交工作流，所以让我们安装 pip install Apache-dolphinscheduler = = 3 . 1 . 0</p><p id="5709" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated"><strong class="kv io">工作流程(下载数据):下载测试数据</strong></p><p id="56ed" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">命令:pydolphin scheduler YAML-f pyds/download _ data . YAML</p><p id="408f" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">按顺序执行以下两个任务</p><p id="1780" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">1.Install-dependencies:安装下载脚本中需要的 python 依赖包</p><p id="a5df" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">2.下载数据:将数据集下载到/tmp/ds-ml-example/raw</p><figure class="mj mk ml mm gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/e0eac613c7dd54fffe08d9a3aa4f9d48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1hIntPm7joCcnu0mumFXFw.png"/></div></div></figure><p id="c405" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated"><strong class="kv io">工作流(dvc_init_local):初始化 dvc 数据版本管理库</strong></p><p id="da8e" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">命令:pydolphin scheduler YAML-f pyds/init _ DVC _ repo . YAML</p><p id="f65d" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">按顺序执行以下任务</p><p id="5d16" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">1.create_git_repo:在本地环境中创建一个空的 git 存储库</p><p id="39f4" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">2.init_dvc:将存储库转换为 dvc 类型的存储库以进行数据版本控制</p><p id="e61e" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">3.条件:确定 init_dvc 任务的状态，如果成功，则执行报告成功消息，否则执行报告错误消息</p><figure class="mj mk ml mm gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/f0bd057e5a921f53d8f46afe0f1bd23b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*laB00czMzsyxKDckXWHdYg.png"/></div></div></figure><h2 id="cd4f" class="lw jw in bd jx lx ly dn kb lz ma dp kf le mb mc kj li md me kn lm mf mg kr mh bi translated">培训模型工作流程</h2><p id="5397" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">在训练模型部分，工作流程包括数据预处理、模型训练和模型评估。</p><p id="0506" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated"><strong class="kv io">工作流程(下载-数据):数据预处理</strong></p><p id="996b" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">命令:pydolphin scheduler YAML-f pyds/prepare _ data . YAML</p><figure class="mj mk ml mm gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/539f7798013c2af19c6ca5e94cf60460.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a5Xbvxhajkx_MdmymW9Cdg.png"/></div></div></figure><p id="80ae" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">按顺序执行以下任务</p><p id="c026" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">1.data_preprocessing:预处理数据，出于演示的目的，我们在这里只执行了一个简单的截断过程</p><p id="e7c4" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">2.upload_data:将数据上传到存储库，并将其注册为特定版本 v1</p><p id="0594" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">下图显示了 git 存储库中的信息</p><figure class="mj mk ml mm gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nl"><img src="../Images/3782f4e4eb8a77c69663776f7b8f4098.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*Cm8kri9ux9s0i7v-7pv9Fw.png"/></div></div></figure><p id="a7d0" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated"><strong class="kv io">工作流(train_model):培训模型</strong></p><p id="23f1" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">命令:pydolphin scheduler YAML-f pyds/train _ model . YAML</p><p id="481c" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">按顺序执行以下任务</p><p id="51e8" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">1.clean_exists_data:删除潜在重复测试生成的历史数据/tmp/ds-ml-example/train_data</p><p id="bfb1" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">2.pull_data:将 v1 数据拉至/tmp/ds-ml-example/train_data</p><p id="bbbd" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">3.train_automl:使用 MLFLOW 组件的 automl 函数训练分类模型，并将其注册到 MLflow 跟踪服务器，如果当前模型版本 F1 是最高的，则将其注册为生产版本。</p><p id="3190" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">4.推断:使用 mlflow CLI 导入一小部分数据进行批量推断</p><p id="8500" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">5.评估:获得推理的结果，并再次对模型进行简单的评估，包括新数据的度量、计划的标签分布等。</p><figure class="mj mk ml mm gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/9d59dbf9909bc4fbeed815c55bd79a51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*auxerp1eImhLnNVkrXejsg.png"/></div></div></figure><p id="4c85" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">在 train_automl 完成其操作后，可在 MLflow 跟踪服务器(<a class="ae mi" href="http://localhost:5000" rel="noopener ugc nofollow" target="_blank"> http://localhost:5000 </a>)中查看测试结果和模型。</p><figure class="mj mk ml mm gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/b804dd4c3ab6cc24ba4854f929ad8f0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*65mJYYRPJ2X7N5ixJ2d6dQ.png"/></div></div></figure><p id="8c4d" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">评估任务完成后，可以查看评估任务的操作日志。</p><figure class="mj mk ml mm gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/4f77aa45d3d38969da506697c5f23e2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*91_W6XBi5v49QGpCMEqkTg.png"/></div></div></figure><h2 id="5ffa" class="lw jw in bd jx lx ly dn kb lz ma dp kf le mb mc kj li md me kn lm mf mg kr mh bi translated">部署流程工作流</h2><p id="79d8" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated"><strong class="kv io">工作流(部署模型):部署模型</strong></p><p id="1d03" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">运行:pydolphin scheduler YAML-f pyds/deploy . YAML</p><p id="2bdb" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">按顺序运行以下任务。</p><p id="dacf" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">1.kill-server:关闭之前的服务器</p><p id="e34f" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">2.部署模型:部署模型</p><p id="f01c" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">3.测试服务器:测试服务器</p><figure class="mj mk ml mm gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/34edb468e60c6637d2d9e90c8a7a375a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TU6yCBmf1zdJV_ttFk2V-Q.png"/></div></div></figure><p id="e13e" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">如果手动启动此工作流，界面将如下所示，只需输入端口号和型号版本号。</p><figure class="mj mk ml mm gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nm"><img src="../Images/1b7e827fac0e76e8c2b0ad31b45e3c6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*37A6Iv3svP3Gob2tJCRgAg.png"/></div></div></figure><h2 id="400b" class="lw jw in bd jx lx ly dn kb lz ma dp kf le mb mc kj li md me kn lm mf mg kr mh bi translated">整合工作流程</h2><p id="532a" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">对于实际使用，在获得稳定的工作流迭代后，整个过程需要链接在一起，例如在获得新版本后，然后训练模型，如果它执行得更好，则部署模型。</p><p id="44b3" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">例如，我们切换到生产版本 git check out first-example-production</p><p id="07c4" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">这两个版本的区别在于:</p><p id="d9d3" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">1.在 train_and_deploy.yaml 中有一个额外的工作流定义，用于组合各种工作流</p><p id="ff0f" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">2.修改预处理脚本以获取 v2 数据</p><p id="34d5" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">3.将每个子工作流定义中的标志更改为 false，并让 train_and_deploy.yaml 一致运行。</p><p id="b2bc" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">运行:pydolphin scheduler YAML-f pyds/train _ and _ deploy . YAML</p><p id="1bb5" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">下图中的每个任务都是一个子工作流任务，对应于上述三个工作流。</p><figure class="mj mk ml mm gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/bf0c639cc6283081c34e2572a0fb44ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N0F_EfuMIWu5Gj0GCFH9eQ.png"/></div></div></figure><p id="dff1" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">如下图，在操作之后获得了模型的新版本 version2，并且已经注册为生产版本</p><figure class="mj mk ml mm gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/3494ed9ab0e2688c7dfad0b1cfd3075e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HYWs2nZnmPwL3B89DS8bRg.png"/></div></div></figure><figure class="mj mk ml mm gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/595774f4573a4b170337d939ac3b8187.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A7DgyquFRfs9Rk0goJ3x-g.png"/></div></div></figure><h1 id="2e20" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">摘要</h1><p id="376d" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">本文描述了如何开始使用 Apache DolphinScheduler 来构建机器学习工作流，希望能够帮助您:</p><p id="dd55" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">1.了解如何构建 Apache DolphinScheduler、Conda、MLflow 服务环境</p><p id="5534" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">2.快速运行机器学习工作流的能力</p><p id="ed11" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">📌📌欢迎填写<a class="ae mi" href="https://www.surveymonkey.com/r/7CHHWGW" rel="noopener ugc nofollow" target="_blank">本次调查</a>来反馈您的用户体验或您对 Apache DolphinScheduler 的想法:)</p><p id="dde4" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">https://www.surveymonkey.com/r/7CHHWGW<a class="ae mi" href="https://www.surveymonkey.com/r/7CHHWGW" rel="noopener ugc nofollow" target="_blank"/></p></div></div>    
</body>
</html>