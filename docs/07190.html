<html>
<head>
<title>A guide to writing good commit messages in Git</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 Git 中编写良好提交消息的指南</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/a-guide-to-writing-good-commit-messages-in-git-4e513e887b6b?source=collection_archive---------5-----------------------#2022-03-04">https://blog.devgenius.io/a-guide-to-writing-good-commit-messages-in-git-4e513e887b6b?source=collection_archive---------5-----------------------#2022-03-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d821e99931d63c26ab5a79b6ab307cda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_zx-Ur4eVwAOMOZH"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">来自 Pexels 的 Tim Gouw</figcaption></figure><p id="987e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你在你的磁盘上有一个名为“版本 1”的存档文件的时间应该是遥远的。我打赌你会使用一些像 GitHub 这样的版本控制工具。因此，每当您想要将代码添加到项目中时，都必须编写提交。您是否曾经想过您的提交消息是否是好的？也许你不喜欢写它们，想知道为什么每次想推代码的时候都要这么做。毕竟变化还不够充分吗？</p><p id="5bf6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本文将帮助您创建一个好的提交消息。它会给你(对我来说)一个很好的模式，让你第一眼就能看到这个提交消息中发生了什么。</p><h1 id="f4ef" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">为什么提交消息很重要？</h1><p id="753b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">那么，改变足够了吗？在我看来(我也希望其他人如此)，答案是否定的！</p><p id="243c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是为什么呢？</p><p id="4d38" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">提交消息有很多用途。这是在项目中与其他开发人员交流的第一种方式。变更定义了你如何实现某事，但是提交消息解释了你为什么要这么做。它必须给出足够的上下文，以避免贡献者想知道为什么一些代码是这样写的。有了适当的解释，你就不会花宝贵的时间问自己为什么一个开发者会推出这段代码。在某些情况下，比如开源项目，如果你不给他们最起码的信息，比如一条精心编写的提交消息，忙碌的维护人员甚至不会阅读你的代码。</p><p id="989d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">彼得·赫特勒写道:</p><blockquote class="me mf mg"><p id="c1fd" class="kd ke mh kf b kg kh ki kj kk kl km kn mi kp kq kr mj kt ku kv mk kx ky kz la ij bi translated"><em class="iq">任何软件项目都是一个协作项目。它至少有两个开发者，最初的开发者和几周或几个月后思路早已离开车站时的最初开发者。</em> <a class="ae kc" href="http://who-t.blogspot.com/2009/12/on-commit-messages.html" rel="noopener ugc nofollow" target="_blank"> <em class="iq">【彼得·赫特勒(打开新窗口)</em> </a></p></blockquote><p id="ab6f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">总而言之，他会告诉我们:</p><p id="67d8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">“承诺信息不仅是给你的同事的，也是给你未来的彼得·赫特勒的”</p><p id="53f4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一个项目是为了长期维护而设计的。有时候，在一段代码被写出来几年后，你可能会问自己为什么它会被写成那样。这个星期，我在 6 个月前编写的一个函数中遇到了这种情况。有了一个写得很好的提交消息，就更容易回到您写这个变更时的思想状态。</p><p id="9c34" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">关注你的提交信息也可以简化你的日常生活。一些工具因为有了有意义的提交历史而变得更加有趣，比如一些 git 命令<strong class="kf ir"> log </strong>，<strong class="kf ir"> rebase </strong>，<strong class="kf ir"> cherry-pick </strong>，…当你度假回来时，一个简单的<strong class="kf ir">git log——漂亮的</strong>会给你很多关于你的同事在你离开时做了什么的信息。编写好的提交消息迫使你分割你的变更，使得用<strong class="kf ir"> git log -p </strong>检查变得更容易。</p><p id="1516" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">说到审查，你有没有因为开发人员做的一些改变而挣扎着改变你的代码？如果提交消息具有真正的意义，那么知道为什么要进行更改就变得更容易了。这使得重定基数的结果更容易预测。另一个例子是 git 责备命令，顺便说一下，它不是用来取笑你的同事，而是给你特定代码行的上下文。当你想重构一段代码时，它会非常有用。</p><p id="6dc8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后但同样重要的是，一个结构良好的提交历史允许在项目的两个版本之间生成变更日志，以通知用户发生了什么变化。</p><p id="f587" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是开始花时间编写好的提交消息的大量理由。</p><h1 id="e37e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">如何编写一个好的提交消息</h1><p id="0a8b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">既然你已经确信提交消息是重要的，那么让我们来谈谈如何写出好的消息。</p><p id="26a5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，这些提交消息不一致，这使得它们难以阅读。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="4e3c" class="mu lc iq mq b gy mv mw l mx my">fixex bug #72 <br/>did some perfomance stuff<br/>Remove built files<br/>Add tests #81<br/>hope it work<br/>forgot files</span></pre><blockquote class="me mf mg"><p id="e503" class="kd ke mh kf b kg kh ki kj kk kl km kn mi kp kq kr mj kt ku kv mk kx ky kz la ij bi translated"><em class="iq">风格。标记语法、换行、语法、大小写、标点符号。把这些东西拼出来，去掉猜测，尽可能的简单。最终的结果将是一个非常一致的日志，不仅读起来很愉快，而且确实会定期被阅读。内容。提交消息(如果有)的正文应该包含什么样的信息？它不应该包含什么？元数据。应该如何发布跟踪 id、拉动式请求编号等。被引用？</em> <a class="ae kc" href="https://chris.beams.io/posts/git-commit/" rel="noopener ugc nofollow" target="_blank"> <em class="iq"> Chris Beams —如何编写 Git 提交消息(打开新窗口)</em> </a></p></blockquote><p id="f90f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的例子中，我们看到一些提交是混乱的，因为这个意思分散在不止一个提交中。为了防止这种情况，Chris 说必须存在一个满足 7 条规则的提交模式来编写一个好的提交消息</p><ol class=""><li id="3188" class="mz na iq kf b kg kh kk kl ko nb ks nc kw nd la ne nf ng nh bi translated">用一个空行将主题和正文分开</li><li id="ebf6" class="mz na iq kf b kg ni kk nj ko nk ks nl kw nm la ne nf ng nh bi translated">将主题行限制在 50 个字符以内</li><li id="4941" class="mz na iq kf b kg ni kk nj ko nk ks nl kw nm la ne nf ng nh bi translated">大写主题行</li><li id="3489" class="mz na iq kf b kg ni kk nj ko nk ks nl kw nm la ne nf ng nh bi translated">不要以句号结束主题行</li><li id="4472" class="mz na iq kf b kg ni kk nj ko nk ks nl kw nm la ne nf ng nh bi translated">在主题行中使用祈使语气</li><li id="a905" class="mz na iq kf b kg ni kk nj ko nk ks nl kw nm la ne nf ng nh bi translated">在 72 个字符处换行</li><li id="d5f6" class="mz na iq kf b kg ni kk nj ko nk ks nl kw nm la ne nf ng nh bi translated">用身体来解释什么和为什么以及如何</li></ol><p id="cab2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我个人应用这些规则的子集:</p><ol class=""><li id="354c" class="mz na iq kf b kg kh kk kl ko nb ks nc kw nd la ne nf ng nh bi translated">将主题行限制在 48 个字符以内</li><li id="2811" class="mz na iq kf b kg ni kk nj ko nk ks nl kw nm la ne nf ng nh bi translated">大写主题行</li><li id="5b8b" class="mz na iq kf b kg ni kk nj ko nk ks nl kw nm la ne nf ng nh bi translated">在主题行中使用祈使语气</li></ol><p id="6628" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">不仅角色限制迫使你简洁，这是一个伟大的技能，而且它与很多工具非常契合。</p><p id="b339" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我倾向于认为完美是好的敌人。这就是为什么我没有讨论提交消息体。我认为我们在总结方面有足够的工作要做。但我也想补充一条规则:</p><ol class=""><li id="7c20" class="mz na iq kf b kg kh kk kl ko nb ks nc kw nd la ne nf ng nh bi translated">添加票证或任务 ID</li></ol><p id="79d3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">大多数时候，我们在代码审查过程中使用工具进行讨论，如 GitHub 或 Azure DevOps。关于变更的所有信息至少会在那里描述。我添加了这条关于跟踪 ID 的规则，这样就很容易找到相关的拉/合并请求。编写提交主体比添加跟踪 id 更好，因为如果您更改您的 repository manager 解决方案，您将丢失所有这些宝贵的上下文信息，并且您的跟踪 id 将毫无用处。</p><p id="6fe3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是一个应用了这些规则的提交历史示例</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="b017" class="mu lc iq mq b gy mv mw l mx my">Make core independent from the git client (#171)<br/>Upgrade Docker image version (#167)<br/>Add maven preset (#172)<br/>Add a generic preset using configuration file (#160)<br/>Improve error messages for preset system (#161)<br/>Publish Canary version on master push (#141)</span></pre><p id="a329" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有一个一致的风格使它更容易阅读。您可以弄清楚变更的上下文，如果可能的话，您还可以看到应用的票证。最重要的是在您的团队中找到共同的规则，以确保有一个结构良好的提交历史。对于这一点，有一些惯例可以帮助你找到这些，但我们稍后将回到这个主题。</p><p id="4600" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你很难找到你应该写什么信息，也许你应该把你的承诺分成更小的部分。Peter Hutterer 在他的文章中列举了几个例子，在这些例子中，很难找到一个好的提交消息，因为您的提交补丁可能不符合逻辑。</p><h1 id="8e2d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">提交约定</h1><p id="0393" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">如前所述，您应该定义一个提交约定(可能是为您的团队或者您的整个开发部门)。存在大量开源提交约定，它们可能是很好的灵感来源。它们还附带了一个完整的生态系统，包括帮助您编写提交消息、生成 changelog、创建发布等等的工具。很多事情可能会花费大量的时间。有很好的文档记录，所以您不必编写关于您自己的提交消息约定的文档。</p><p id="424a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将讨论其中的两个<a class="ae kc" href="https://www.conventionalcommits.org/en/v1.0.0/" rel="noopener ugc nofollow" target="_blank">常规提交(打开新窗口)</a>和<a class="ae kc" href="https://gitmoji.carloscuesta.me/" rel="noopener ugc nofollow" target="_blank"> gitmoji(打开新窗口)</a>。</p><h1 id="c20f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">常规提交</h1><p id="4757" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">这是一个受角度提交消息指南启发的规范。它有一些有趣的规则，比如:</p><ul class=""><li id="d039" class="mz na iq kf b kg kh kk kl ko nb ks nc kw nd la nn nf ng nh bi translated">提交必须以类型(feat，fix)为前缀</li><li id="52ff" class="mz na iq kf b kg ni kk nj ko nk ks nl kw nm la nn nf ng nh bi translated">可能会提供一个范围来指出代码库的特定部分(对于 mono repo 来说确实很有趣)</li><li id="0f9f" class="mz na iq kf b kg ni kk nj ko nk ks nl kw nm la nn nf ng nh bi translated">重大变更必须包含在页脚部分</li></ul><p id="919b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以下是必须使用此规范构造提交消息的方式:</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="b1f5" class="mu lc iq mq b gy mv mw l mx my">[optional scope]: &lt;description&gt;</span><span id="284c" class="mu lc iq mq b gy no mw l mx my">[optional body]</span><span id="4e17" class="mu lc iq mq b gy no mw l mx my">[optional footer(s)]</span></pre><p id="99e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要了解更多信息，您可以查看他们的<a class="ae kc" href="https://www.conventionalcommits.org/en/v1.0.0/#specification" rel="noopener ugc nofollow" target="_blank">规格(打开新窗口)</a></p><h1 id="e062" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">吉特莫吉</h1><p id="5d5b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我喜欢表情符号，每个人都喜欢它，❤，gitmoji 致力于使用表情符号对提交进行分类。我认为可视化提交原因非常合适，所以我认为这个约定对每个人都有好处。</p><p id="02d2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我在之前的 gitmoji-changelog 提交示例中没有完全诚实。现在你应该已经猜到了，有一个缺失的部分。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="e390" class="mu lc iq mq b gy mv mw l mx my">:recycle: Make core independent from the git client (#171)<br/>:whale: Upgrade Docker image version (#167)<br/>:sparkles: Add maven preset (#172)<br/>:sparkles: Add a generic preset using configuration file (#160)<br/>:recycle: Improve error messages for preset system (#161)<br/>:construction_worker: Publish Canary version on master push (#141)</span></pre><p id="a9d3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些文本别名在 Slack、Discord 等工具中被广泛使用……大多数存储库管理器工具，如 GitHub 或 GitLab、AzureDevops 解释它们并在它们的 UI 中很好地显示它们:</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="a873" class="mu lc iq mq b gy mv mw l mx my">♻️ Make core independent from the git client (#171)<br/>🐳 Upgrade Docker image version (#167)<br/>✨ Add maven preset (#172)<br/>✨ Add a generic preset using configuration file (#160)<br/>♻️ Improve error messages for preset system (#161)<br/>👷‍♂️ Publish Canary version on master push (#141)</span></pre><p id="1c8c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我喜欢这个约定，因为我一眼就知道提交了什么样的更改。它附带了一个 cli 叫做<a class="ae kc" href="https://github.com/carloscuesta/gitmoji-cli" rel="noopener ugc nofollow" target="_blank"> gitmoji-cli(打开新窗口)</a>帮助你写提交消息，我为它做了一个 changelog 生成器。</p><p id="7557" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">他们还有更多。请记住，这些是指导方针，您可以将它们混合在一起，以满足您的需求。</p></div><div class="ab cl np nq hu nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ij ik il im in"><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="d366" class="mu lc iq mq b gy mv mw l mx my"><strong class="mq ir">Want to Connect?</strong></span><span id="2c5f" class="mu lc iq mq b gy no mw l mx my">Say Hello on: <a class="ae kc" href="https://www.linkedin.com/in/sascha-peter-bajonczak-32a17a2a/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>, <a class="ae kc" href="https://github.com/sbajonczak" rel="noopener ugc nofollow" target="_blank">GitHub</a>, and <a class="ae kc" href="https://blog.bajonczak.com/" rel="noopener ugc nofollow" target="_blank">Blog</a>.</span></pre></div></div>    
</body>
</html>