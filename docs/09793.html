<html>
<head>
<title>Data-Viz for Economics using WDI package in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 R 中使用 WDI 包的经济学数据</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/data-visualization-for-economics-using-wdi-package-in-r-d2da5a542f8b?source=collection_archive---------5-----------------------#2022-09-13">https://blog.devgenius.io/data-visualization-for-economics-using-wdi-package-in-r-d2da5a542f8b?source=collection_archive---------5-----------------------#2022-09-13</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="149e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">过早辍学的女孩更有可能过早结婚或生孩子，而这种成本会越来越大:</p><ul class=""><li id="57fd" class="kj kk in jm b jn jo jr js jv kl jz km kd kn kh ko kp kq kr bi translated">在女孩们在情感或生理上还没有准备好的时候就成为妻子或母亲会影响她们自己和孩子的健康。</li><li id="49cc" class="kj kk in jm b jn ks jr kt jv ku jz kv kd kw kh ko kp kq kr bi translated">较低的教育程度也意味着即使在家庭内部，代理也较少。</li><li id="d742" class="kj kk in jm b jn ks jr kt jv ku jz kv kd kw kh ko kp kq kr bi translated">过早辍学减少了进入劳动力市场的机会，导致更高的贫困率和更低的社会参与率。</li></ul><p id="da20" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">下面的<a class="ae ki" href="http://Atlas of Sustainable Development Goals 2018" rel="noopener ugc nofollow" target="_blank">图</a>将开发女孩潜力的重要性分为两个指标:生育率和入学率。在明确这种关系之前，我们经历了许多背景(还有更多)。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi kx"><img src="../Images/7422ecff1c2ec3d51fe3df163a445a2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*44mpUwXqtbUGRdtv9tQJJw.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">来源:【2018 年可持续发展目标图集</figcaption></figure><p id="d147" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">同样，有如此多的发展指标，以至于选择正确的关系来探索一个问题可能会令人生畏。仅世界发展指标就有超过 1400 个指标。</p><p id="2e6c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这篇文章中，我演示了如何一次绘制多个散点图。Vincent Arel-Bundock 的<a class="ae ki" href="https://cran.r-project.org/web/packages/WDI/WDI.pdf" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> WDI 包</strong> </a>和<a class="ae ki" href="https://ggplot2.tidyverse.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> ggplot2 </strong> </a>都是你需要的。WDI 允许你从<a class="ae ki" href="https://datacatalog.worldbank.org/search/dataset/0037712/World-Development-Indicators" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io">世界银行数据目录</strong> </a>中直接找到并调用指标给 r</p><p id="fb81" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这种练习有助于快速获得多种视觉效果，以了解团体或国家相对于彼此的立场。本练习将考察不同国家的财富水平登记指标(<a class="ae ki" href="https://data.worldbank.org/indicator/NY.GDP.PCAP.KD" rel="noopener ugc nofollow" target="_blank">人均国内生产总值，2015 年定值美元</a>)，但你也可以用其他指标代替。</p><p id="a242" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">人均 GDP 是衡量国家财富的一个常用指标。此处，数值以对数标度表示。由于财富增长可能是指数增长，对数 GDP 创造了更线性的人均 GDP 增长。</p><ul class=""><li id="34a1" class="kj kk in jm b jn jo jr js jv kl jz km kd kn kh ko kp kq kr bi translated">记住<a class="ae ki" href="https://towardsdatascience.com/correlation-is-not-causation-ae05d03c1f53#:~:text=About%20correlation%20and%20causation,correlation%2C%20but%20it's%20not%20causation." rel="noopener" target="_blank"> <strong class="jm io">关联≠因果</strong> </a>。除了阅读现有的研究和文献，这些情节有助于理解发展的一般模式和群体的立场。绘制多个时间点的图表(如上)或一次绘制许多事情的图表(一个国家是否在十项主要发展指标中有几项未达标？)缩小了我们的发现范围。</li><li id="24c2" class="kj kk in jm b jn ks jr kt jv ku jz kv kd kw kh ko kp kq kr bi translated">请访问<a class="ae ki" href="https://www.worldbank.org/en/research/dime/data-and-analytics" rel="noopener ugc nofollow" target="_blank"> DIME Analytics </a>的<a class="ae ki" href="https://worldbank.github.io/stata-visual-library/" rel="noopener ugc nofollow" target="_blank"> Stata 可视化库</a>和<a class="ae ki" href="https://worldbank.github.io/r-econ-visual-library/" rel="noopener ugc nofollow" target="_blank"> R Econ 可视化库</a>，了解对发展和经济学有用的更多可复制的可视化示例。</li></ul><h2 id="590a" class="ln lo in bd lp lq lr dn ls lt lu dp lv jv lw lx ly jz lz ma mb kd mc md me mf bi translated">第一步。检索数据</h2><p id="b8db" class="pw-post-body-paragraph jk jl in jm b jn mg jp jq jr mh jt ju jv mi jx jy jz mj kb kc kd mk kf kg kh ig bi translated">加载包:</p><figure class="ky kz la lb gt lc"><div class="bz fp l di"><div class="ml mm l"/></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">加载库</figcaption></figure><p id="0a04" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将使用的第一个 WDI 命令 WDIsearch()返回包含指定字符串的指示器列表。从列表中提取指标。</p><figure class="ky kz la lb gt lc"><div class="bz fp l di"><div class="ml mm l"/></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">搜索指示器</figcaption></figure><p id="d6f4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">该查询返回了 27 个指标。下面是输出的预览:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/6f38fb18f3ffdda490286a809e7018ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*O0sCq-iyyp7mkCVk0YHyDA.png"/></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">ind(列表)输出</figcaption></figure><p id="9862" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们稍后将使用 name 列。</p><p id="199d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要获取数据，请运行 WDI()。该命令有非常灵活的参数来获得您正在寻找的数据的精确组合。这个例子寻找每个国家最近的人均 GDP 值和注册指标。一些国家有相当过时的数据，所以我只查询了过去 10 年的数据。</p><p id="b992" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="mo">注意:API 并不完善，一些不可用的指标将被跳过。我有一个警告消息，是关于一些已经下载的指示器的，所以一定要检查你的输出。</em></p><figure class="ky kz la lb gt lc"><div class="bz fp l di"><div class="ml mm l"/></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">从 WDI 获取数据()</figcaption></figure><p id="18ba" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">dataframe 为每个指标、一个国家的地区、收入和贷款组返回一列。搜索还包括聚合。</p><p id="a818" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因为指标在不同的年份更新，您会注意到数据集在不同的国家和年份是唯一的，并且指标中有许多缺失值。</p><p id="e749" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">下一步将介绍如何为制图准备数据集。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi mp"><img src="../Images/bcfa1064f74c1528369e8bded7bcd1bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OpifRoTLnVv0IWdBw_JtZg.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">数据库(数据帧)输出</figcaption></figure><h2 id="e577" class="ln lo in bd lp lq lr dn ls lt lu dp lv jv lw lx ly jz lz ma mb kd mc md me mf bi translated">第二步。准备数据集</h2><p id="2185" class="pw-post-body-paragraph jk jl in jm b jn mg jp jq jr mh jt ju jv mi jx jy jz mj kb kc kd mk kf kg kh ig bi translated">因为我们正在查看给定时间内国家之间的快照，所以我们不需要<em class="mo"> year </em>变量。相反，我们将折叠指示器，以允许<em class="mo"> country </em>成为 ID 变量。</p><p id="5f6d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">首先，提取指示器列名的列表。然后，对于所有这些列，用第一个可用值填写每个国家的所有行。这将为拥有超过一年数据的每个国家创建相同的行。现在，您可以通过 iso3c(国家代码)删除数据中的重复项。</p><p id="da06" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">请注意，这个步骤只起作用，因为每个指标只有一个<em class="mo"> </em>值，所以它将所有年份合并为一个。</p><figure class="ky kz la lb gt lc"><div class="bz fp l di"><div class="ml mm l"/></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">将国家作为 ID</figcaption></figure><p id="f938" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，每个国家的所有数据都应该在一行中:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/b35bd998b415cadd957859aa1fc4b1df.png" data-original-src="https://miro.medium.com/v2/resize:fit:870/format:webp/1*yNZwSBX-dcxWSMY38xxWLg.png"/></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">清洗后的数据库</figcaption></figure><p id="e3d3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">回到我们提取指示器名称和标签的第一步，我们将把这个列表与查询结果合并。稍后，我们将使用<em class="mo"> df_ind </em>遍历图表的指示器。</p><p id="4d39" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">最后，从数据集中删除聚合数据，因为匿名化后它们实际上无法与国家数据点进行比较。我包括了两个例外——<strong class="jm io">东亚和太平洋</strong>和<strong class="jm io">高收入</strong>作为澳门特区的对等参照，它们将在图表中突出显示。</p><figure class="ky kz la lb gt lc"><div class="bz fp l di"><div class="ml mm l"/></div></figure><h2 id="0d26" class="ln lo in bd lp lq lr dn ls lt lu dp lv jv lw lx ly jz lz ma mb kd mc md me mf bi translated">第三步。循环绘制指示器</h2><p id="2522" class="pw-post-body-paragraph jk jl in jm b jn mg jp jq jr mh jt ju jv mi jx jy jz mj kb kc kd mk kf kg kh ig bi translated">最后要做的事情是绘制一切。这段代码循环遍历每个指标，同时保持人均 GDP 不变。我已经对代码进行了注释，但是如果您有任何问题，请联系我们。</p><figure class="ky kz la lb gt lc"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="c6af" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了节省空间，我将在这里展示两个图，而不是二十多个图。但是你可以在这里做一些简单的比较:</p><div class="ky kz la lb gt ab cb"><figure class="mr lc ms mt mu mv mw paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><img src="../Images/9d17dee42bf295b3a7b83f476d9823a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*fn7ZHbxDUJQe0IBmp6FSdw.jpeg"/></div></figure><figure class="mr lc ms mt mu mv mw paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><img src="../Images/c57cc28506d5c5a0f975a16ce68b0007.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*e4gizJEtWi8o22EVG6ZLew.jpeg"/></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk mx di my mz translated">各年级女生入学率和人均国内生产总值百分比。</figcaption></figure></div><p id="ba98" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一眼望去，澳门的人均 GDP 在全球名列前茅。它落后于女小学生，其财富份额低于预期。尽管如此，它在所有方面的价值都高于其地区平均值(东亚和太平洋地区)。</p><p id="c5db" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在两个年级之间，澳门的女生入学比例保持一致，而两个同龄群体的变化表明不同年龄的性别动态存在差异。</p><h2 id="c2c3" class="ln lo in bd lp lq lr dn ls lt lu dp lv jv lw lx ly jz lz ma mb kd mc md me mf bi translated"><strong class="ak">版本 2: </strong></h2><p id="0809" class="pw-post-body-paragraph jk jl in jm b jn mg jp jq jr mh jt ju jv mi jx jy jz mj kb kc kd mk kf kg kh ig bi translated">您也可以通过突出显示图表中的其他点来转移您的焦点。当按收入组给国家着色时，我们看到，随着国家达到更高的收入分类，女性入学率的差异减少。差异的数量和方向也因年级而异。</p><p id="7bb6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">对澳门来说，尽管入学人数不及其他高收入国家，但也不算太落后。</p><div class="ky kz la lb gt ab cb"><figure class="mr lc ms mt mu mv mw paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><img src="../Images/18dd47afe2019d57ea7c7df5fb5c254e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*6Y6rm9D4OeXOU_OMayx37A.jpeg"/></div></figure><figure class="mr lc ms mt mu mv mw paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><img src="../Images/989d21d96d621a480baef63cadb21b29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*ivD9IAUZP1LRzVjuaWqm3A.jpeg"/></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk mx di my mz translated">各年级女生入学率和人均国内生产总值百分比。按收入群体分类。</figcaption></figure></div><h2 id="b445" class="ln lo in bd lp lq lr dn ls lt lu dp lv jv lw lx ly jz lz ma mb kd mc md me mf bi translated"><strong class="ak">寻找指标的替代方式:</strong></h2><p id="e5da" class="pw-post-body-paragraph jk jl in jm b jn mg jp jq jr mh jt ju jv mi jx jy jz mj kb kc kd mk kf kg kh ig bi translated">如果您没有一组有针对性的指标可以查看，那么可以从<a class="ae ki" href="https://datacatalog.worldbank.org/search/dataset/0037712/World-Development-Indicators" rel="noopener ugc nofollow" target="_blank">世界银行数据目录</a>中查找元数据文件。我使用 zip 文件中的 WDISeries.csv。数据集包括指标名称、定义及其所属的主题。</p><p id="2d97" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我在下面添加了一个示例代码，在这里我将数据过滤为<em class="mo">公共部门:政策&amp;机构</em>主题，提取 WDI 命令的指示器名称，以及图形 y 轴的标签。从这里开始，你可以重复上面的步骤，用公共部门变量来绘制人均 GDP。</p><figure class="ky kz la lb gt lc"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="9dd1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">感谢阅读，请让我知道这是否有用，如果有你想在未来看到的补充！</p></div></div>    
</body>
</html>