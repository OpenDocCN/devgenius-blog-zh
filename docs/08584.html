<html>
<head>
<title>Pandas: Dealing with String list within a DataFrame</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫:处理数据帧中的字符串列表</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/pandas-dealing-with-string-list-within-a-dataframe-31b949cd92a?source=collection_archive---------5-----------------------#2022-06-26">https://blog.devgenius.io/pandas-dealing-with-string-list-within-a-dataframe-31b949cd92a?source=collection_archive---------5-----------------------#2022-06-26</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/bfe5d9e51d22d958fae2c638a75f3865.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OeFeZVhJcZFOwzqNthGzrw.jpeg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">帕斯卡尔·迈耶在<a class="ae jz" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="e644" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">对于数据帧中的正则表达式，大多数 Pandas 用户都熟悉<code class="fe ky kz la lb b">.extract()</code>、<code class="fe ky kz la lb b">.replace()</code>和<code class="fe ky kz la lb b">.findall()</code>。这些函数主要帮助数据提取和清理，尤其是字符串数据类型。然而，其他熊猫方法也有助于正则表达式。本教程的目的是在处理 DataFrame 单元格中的字符串值列表时，更好地了解这些函数的用法。重点将放在以下职能上:</p><ul class=""><li id="6b92" class="lc ld in kc b kd ke kh ki kl le kp lf kt lg kx lh li lj lk bi translated">包含( )</li><li id="ff07" class="lc ld in kc b kd ll kh lm kl ln kp lo kt lp kx lh li lj lk bi translated">设置。交集( )</li><li id="a9e3" class="lc ld in kc b kd ll kh lm kl ln kp lo kt lp kx lh li lj lk bi translated">设置。差异( )</li></ul></div><div class="ab cl lq lr hr ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ig ih ii ij ik"><h1 id="bfa3" class="lx ly in bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">包含( )</h1><p id="d05a" class="pw-post-body-paragraph ka kb in kc b kd mv kf kg kh mw kj kk kl mx kn ko kp my kr ks kt mz kv kw kx ig bi translated">我们从熊猫开始。Series.str.contains 函数测试模式或正则表达式(regex)是否包含在序列或索引的字符串中。它根据给定的模式或正则表达式是否包含在一个系列或索引的字符串中，输出一个布尔系列或索引。此链接提供了语法中参数的更多详细信息。</p><h2 id="7285" class="na ly in bd lz nb nc dn md nd ne dp mh kl nf ng ml kp nh ni mp kt nj nk mt nl bi translated"><em class="nm">语法</em></h2><p id="e55d" class="pw-post-body-paragraph ka kb in kc b kd mv kf kg kh mw kj kk kl mx kn ko kp my kr ks kt mz kv kw kx ig bi translated"><em class="nn"> Series.str.contains(pat，case=True，flags=0，na=None，regex=True) </em></p><p id="c5f8" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">该链接给出了语法中参数的更多细节。</p><h2 id="c409" class="na ly in bd lz nb nc dn md nd ne dp mh kl nf ng ml kp nh ni mp kt nj nk mt nl bi translated">示例 1:在表达式或字符串列表中查找字符串。</h2><p id="f7f9" class="pw-post-body-paragraph ka kb in kc b kd mv kf kg kh mw kj kk kl mx kn ko kp my kr ks kt mz kv kw kx ig bi translated">熊猫的文献参考。Series.str.contains 给出了如何使用 Series 和 Index 函数以及如何处理<code class="fe ky kz la lb b">NaN</code>的示例。在本教程中，我们想看看这个函数是如何处理数据帧中的列表的。</p><p id="af87" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们首先创建一个数据集<code class="fe ky kz la lb b">df</code>，这是 5 个人的购物清单。数据集有两列<code class="fe ky kz la lb b">Ordered</code>和<code class="fe ky kz la lb b">Delivered</code>。每一行代表这个人点了什么和送了什么。</p><pre class="no np nq nr gt ns lb nt nu aw nv bi"><span id="c113" class="na ly in lb b gy nw nx l ny nz">import pandas as pd<br/>df = pd.DataFrame({'Ordered': ['Egg, Milk, Bread', 'Sugar, Milk', 'Egg, Oil', 'Sugar, Bread', 'Oil, Bread, Sugar'], <br/>                    'Delivered': ['Egg, Bread', 'Bread, Sugar', 'Egg, Oil', 'Milk, Bread', 'Oil, Sugar']})<br/>df</span></pre><figure class="no np nq nr gt jo gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/4eeb4bed710b25fed05ce45645a2951a.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*scFIDRVjM4dhK8xgS-DSkg.png"/></div></figure><p id="5148" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">对于<code class="fe ky kz la lb b">Example 1</code>，我们希望找到哪个订单有<code class="fe ky kz la lb b">Eggs</code>或<code class="fe ky kz la lb b">Oil</code>。</p><pre class="no np nq nr gt ns lb nt nu aw nv bi"><span id="4acc" class="na ly in lb b gy nw nx l ny nz"> df['Ordered'].str.contains('Egg|Oil')</span></pre><figure class="no np nq nr gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ob"><img src="../Images/e1986b1e726e25765267087125f2c76f.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/format:webp/1*x3k7udEylBnY6mh-7wbp3w.png"/></div></div></figure><p id="6751" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">当字符串中出现<code class="fe ky kz la lb b">Egg</code>或<code class="fe ky kz la lb b">Oil</code>时，函数返回<strong class="kc io"> True </strong>。</p></div><div class="ab cl lq lr hr ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ig ih ii ij ik"><h1 id="863d" class="lx ly in bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">设置。交集( )方法</h1><p id="f3dd" class="pw-post-body-paragraph ka kb in kc b kd mv kf kg kh mw kj kk kl mx kn ko kp my kr ks kt mz kv kw kx ig bi translated"><code class="fe ky kz la lb b">Set()</code>和<code class="fe ky kz la lb b">Intersection()</code>是返回包含两个或更多集合之间相似性的集合的方法。返回的集合只包含同时存在于两个集合中的项目。</p><h2 id="7656" class="na ly in bd lz nb nc dn md nd ne dp mh kl nf ng ml kp nh ni mp kt nj nk mt nl bi translated">句法</h2><blockquote class="oc od oe"><p id="b2de" class="ka kb nn kc b kd ke kf kg kh ki kj kk of km kn ko og kq kr ks oh ku kv kw kx ig bi translated">设置(x)。交集(集合(y))</p></blockquote><p id="7883" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在我们的下一个例子中，我们将比较这两列的字符串值，并找到相似的值。</p><h2 id="489e" class="na ly in bd lz nb nc dn md nd ne dp mh kl nf ng ml kp nh ni mp kt nj nk mt nl bi translated">示例 2:比较两列</h2><p id="ce94" class="pw-post-body-paragraph ka kb in kc b kd mv kf kg kh mw kj kk kl mx kn ko kp my kr ks kt mz kv kw kx ig bi translated">要找出哪些订购的商品已经交付，为此，我们必须将单元格拆分成一个列表，并使用<code class="fe ky kz la lb b">set( )</code>和<code class="fe ky kz la lb b">intersection</code>方法进行检查。我们通过创建另一个专栏<code class="fe ky kz la lb b">check</code>来做到这一点</p><pre class="no np nq nr gt ns lb nt nu aw nv bi"><span id="d58d" class="na ly in lb b gy nw nx l ny nz">check = df.apply(lambda x: (set(x['Ordered'].split(', '))<br/>          .intersection(set(x['Delivered'].split(', ')))), <br/>           axis = 1)<br/>check</span></pre><figure class="no np nq nr gt jo gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/600a767c5ad3d5070e5b7aae5662b18b.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*evXd2duL6U9MgXv7d_bMyg.png"/></div></figure><h2 id="fb1c" class="na ly in bd lz nb nc dn md nd ne dp mh kl nf ng ml kp nh ni mp kt nj nk mt nl bi translated">示例 3:比较两个具有精确值的列</h2><p id="b978" class="pw-post-body-paragraph ka kb in kc b kd mv kf kg kh mw kj kk kl mx kn ko kp my kr ks kt mz kv kw kx ig bi translated">要找出交付的项目，请与订单完全匹配。<code class="fe ky kz la lb b">Set( )</code>方法可以帮助做到这一点，如下所示。</p><pre class="no np nq nr gt ns lb nt nu aw nv bi"><span id="e8e1" class="na ly in lb b gy nw nx l ny nz">check2 = df.apply(lambda x: (set(x['Ordered'].split(', ')) == <br/>                 (set(x['Delivered'].split(', ')))), axis = 1)<br/>check2</span></pre><figure class="no np nq nr gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oi"><img src="../Images/43b0903ad49cb79b94c5f4ae9bebddfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*_rc_D_YCzqxaN8R5T9WFjw.png"/></div></div></figure></div><div class="ab cl lq lr hr ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ig ih ii ij ik"><h1 id="5368" class="lx ly in bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">设置。差分( )方法</h1><p id="81eb" class="pw-post-body-paragraph ka kb in kc b kd mv kf kg kh mw kj kk kl mx kn ko kp my kr ks kt mz kv kw kx ig bi translated"><code class="fe ky kz la lb b">Difference()</code>返回一个集合，其中包含只存在于集合 x 中而不存在于集合 y 中的项目:</p><h2 id="12fd" class="na ly in bd lz nb nc dn md nd ne dp mh kl nf ng ml kp nh ni mp kt nj nk mt nl bi translated">句法</h2><blockquote class="oc od oe"><p id="e634" class="ka kb nn kc b kd ke kf kg kh ki kj kk of km kn ko og kq kr ks oh ku kv kw kx ig bi translated">设置(x)。差异(集合(y))</p></blockquote><p id="9fd9" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在我们的下一个例子中，我们将比较这两列的字符串值，并找到相似的值。</p><h2 id="9b9d" class="na ly in bd lz nb nc dn md nd ne dp mh kl nf ng ml kp nh ni mp kt nj nk mt nl bi translated">示例 4:比较具有不同值的两列</h2><p id="8db7" class="pw-post-body-paragraph ka kb in kc b kd mv kf kg kh mw kj kk kl mx kn ko kp my kr ks kt mz kv kw kx ig bi translated">以找出哪些订购的项目没有交付，以及没有订购的已交付项目。如下所示。</p><pre class="no np nq nr gt ns lb nt nu aw nv bi"><span id="24b6" class="na ly in lb b gy nw nx l ny nz">check3 = df.apply(lambda x: (set(x['Ordered'].split(', '))<br/>           .difference(set(x['Delivered'].split(', ')))), axis = 1)<br/>check3</span></pre><figure class="no np nq nr gt jo gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/eea8a1f6a57a7f0c4a238b5d3f77d18c.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/format:webp/1*6y2pztk9pQBQlr2qZoTLpw.png"/></div></figure><p id="92c1" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">要检查哪些已交付的项目没有订购，我们只需交换代码中<code class="fe ky kz la lb b">Ordered</code>和<code class="fe ky kz la lb b">Delivered</code>的位置。</p><pre class="no np nq nr gt ns lb nt nu aw nv bi"><span id="cc2e" class="na ly in lb b gy nw nx l ny nz">check4 = df.apply(lambda x: (set(x['Delivered'].split(', '))<br/>           .difference(set(x['Ordered'].split(', ')))), axis = 1)<br/>check4</span></pre><figure class="no np nq nr gt jo gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/300d0a6fc6d8849f695d663f182f3c1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*YW0Au7K08FbGzu4HvFidIA.png"/></div></figure></div><div class="ab cl lq lr hr ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ig ih ii ij ik"><h1 id="1df6" class="lx ly in bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">结论</h1><p id="b97f" class="pw-post-body-paragraph ka kb in kc b kd mv kf kg kh mw kj kk kl mx kn ko kp my kr ks kt mz kv kw kx ig bi translated">在本教程中，我们学习了 Python pandas <code class="fe ky kz la lb b">contains()</code>、<code class="fe ky kz la lb b">Set.Intersection()</code>和<code class="fe ky kz la lb b">difference()</code>访问 DataFrame 单元格中的字符串列表的方法。</p></div></div>    
</body>
</html>