<html>
<head>
<title>What not to do in SQL !</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQL 中不要做的事情！</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/sql-best-practices-61d048b53619?source=collection_archive---------8-----------------------#2022-12-20">https://blog.devgenius.io/sql-best-practices-61d048b53619?source=collection_archive---------8-----------------------#2022-12-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/3c6b625935e63cded1326eb4c655e487.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IC3D5VX3_KH3TnCU"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">穆罕默德·诺哈西在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="fa2e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些最佳实践包括编写 SQL 查询、开发文档的指南，以及演示这些实践的示例。当您自己使用 SQL 时，这是一个有用的资源，因为您可以通过转到适当的部分来快速回顾这些原则。<br/>把它想象成 SQL 的现场指南！</p><h1 id="0815" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">大写和区分大小写</h1><p id="ee1e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">通常，在使用 SQL<strong class="kf ir">时，大写是无关紧要的。<strong class="kf ir">选择</strong>也可以写成<strong class="kf ir">选择</strong>或者<strong class="kf ir">选择</strong>。他们都工作！然而，如果你坚持使用大写字母，你的问题会显得更专业。</strong></p><p id="2589" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用所有大写字母作为子句开头，像专家一样编写<strong class="kf ir"> SQL </strong>查询(例如<strong class="kf ir"> SELECT、FROM、WHERE </strong>等)。).</p><p id="ad8e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">函数要全部大写，比如<strong class="kf ir"> SUM()。</strong>(参见本文后面关于蛇案的部分。)列名应该都是小写的。<strong class="kf ir">驼峰式</strong>应用于表名(参见本指南后面的<strong class="kf ir">驼峰式</strong>一节)。这保持了查询的一致性，使查询更容易理解，同时对运行查询时检索的数据没有影响。大写唯一重要的时候是在引号里面(更多关于引号的内容在下面)。</p><h2 id="ef6f" class="me lc iq bd ld mf mg dn lh mh mi dp ll ko mj mk lp ks ml mm lt kw mn mo lx mp bi translated">SQL 方言</h2><p id="5704" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">不同的<strong class="kf ir"> SQL </strong>数据库供应商使用 SQL 的方式可能略有不同。方言是这些差异的名称。一些 SQL 语言区分大小写。<strong class="kf ir"> BigQuery </strong>就是其中之一。另一个是<strong class="kf ir"> Vertica </strong>。<br/>然而，大多数——包括<strong class="kf ir"> MySQL </strong>、<strong class="kf ir"> PostgreSQL </strong>和<strong class="kf ir">SQL Server</strong>——都不关心大小写。</p><p id="81d6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这意味着，如果您搜索 country code = "us "，将返回所有带有" us "、" us "、" Us "和" uS "的条目。<strong class="kf ir"> BigQuery </strong>不以这种方式运行。由于<strong class="kf ir"> BigQuery </strong>区分大小写，相同的搜索只会产生国家代码与“us”完全匹配的条目的结果。如果国家代码是“美国”，BigQuery 不会在结果中包含这些条目</p><h1 id="c919" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">单引号或双引号:“”或“”</h1><p id="0548" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">当提到字符串时，使用单引号“”还是双引号“”通常并不重要。例如，<strong class="kf ir"> SELECT </strong>是一个子句起始符。<br/> <strong class="kf ir"> SQL </strong>会把<strong class="kf ir">选择</strong>当作一个文本字符串，如果你用引号把它括起来，比如'<strong class="kf ir">选择</strong>或者'<strong class="kf ir">选择</strong>。您的查询需要一个 SELECT 子句，因此会产生错误。</p><p id="1f03" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是，在两种情况下，您选择使用的报价类型很重要:</p><ul class=""><li id="d36d" class="mq mr iq kf b kg kh kk kl ko ms ks mt kw mu la mv mw mx my bi translated">当您需要字符串在任何 SQL 方言中都可以被识别时</li><li id="74af" class="mq mr iq kf b kg mz kk na ko nb ks nc kw nd la mv mw mx my bi translated">当字符串包含撇号或引号时</li></ul><p id="df0e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在每种 SQL 语言中，什么是可接受的，什么是不可接受的，这是有标准的。</p><blockquote class="ne nf ng"><p id="6b22" class="kd ke nh kf b kg kh ki kj kk kl km kn ni kp kq kr nj kt ku kv nk kx ky kz la ij bi translated">但是对字符串使用单引号是一种惯例，几乎适用于所有的 SQL 方言。</p></blockquote><p id="80c2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这有助于消除很多困惑。因此，如果我们想在 WHERE 子句中引用美国这个国家(例如，country_code = 'US ')，那么在字符串' US '两边使用单引号。</p><p id="0cd0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第二种情况是当你的字符串包含引号。<br/>考虑一个有两列的表格——每个朋友一列——和一个名为 FavoriteFoods 的喜爱食物列。</p><figure class="nm nn no np gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/9f0c080dafbf285d4338755ca341ff81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*29mLWyzRXEx2VgCBnYVGmw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">有报价数据的字段</figcaption></figure><p id="8908" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可能会注意到雷切尔最喜欢的食物中有一个撇号。如果您在 WHERE 子句中使用单引号来查找喜欢这种食物的朋友，它看起来会像这样:</p><figure class="nm nn no np gt jr gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/b8f5d57dfc30f5c7d2af03d503aec7bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1314/format:webp/1*IRqtemmHOo1Kpa3-Kq9_GA.png"/></div></figure><p id="83dd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">这将失败。</strong> <br/>如果执行此查询，您将收到一条错误消息。因为以一个引号开始并以另一个引号结束的文本字符串被<strong class="kf ir"> SQL </strong>识别，所以情况就是这样。因此，<strong class="kf ir"> SQL </strong>认为在上面的错误查询中，您正在寻找的最喜欢的食物是“Shepherd”。由于 Shepherd 中的撇号，字符串只有“Shepherd”</p><blockquote class="ne nf ng"><p id="72b4" class="kd ke nh kf b kg kh ki kj kk kl km kn ni kp kq kr nj kt ku kv nk kx ky kz la ij bi translated">一般来说，在这种特殊情况下，您应该只使用双引号来代替单引号。</p></blockquote><p id="cf9e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这种情况下，您的查询将如下所示:</p><figure class="nm nn no np gt jr gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/72fbf4fdd3e8e881424e99fe889908ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/1*AMw1ln1L-cXcmL3MOSmANg.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">使用双引号</figcaption></figure><p id="8ebe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> SQL </strong>将单引号或双引号作为文本字符串的第一个字符。因为这个字符串以双引号开始，<strong class="kf ir"> SQL </strong>将会预测这个字符串将以另一个双引号结束。因为撇号受到保护，所以结果将是“牧羊人馅饼”而不是“牧羊人”</p><h1 id="0a3f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">作为提醒的注释</h1><p id="bccc" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">随着你对 SQL 的熟练掌握，你将能够快速阅读和理解查询。然而，在查询中添加注释可以提醒您的目标。此外，如果你分享你的问题，它有助于其他人理解你的问题。例如:</p><figure class="nm nn no np gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ns"><img src="../Images/8de60293d9eceb66c0f0ae2802bb2939.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jRMm0M-deyUv3SxdDSxpMQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">注释示例 SQL</figcaption></figure><p id="b16c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的查询中，您可以使用<strong class="kf ir"> # </strong>来代替两个破折号，-，但是请记住#在所有的<strong class="kf ir"> SQL </strong>方言中都不被识别(<strong class="kf ir"> MySQL </strong>不识别<strong class="kf ir"> # </strong>)。所以最好使用——并与之保持一致。当使用-向查询添加注释时，数据库查询引擎将忽略-后同一行中的所有内容。它将从下一行开始继续处理查询。这是一个单行注释的例子，你也可以创建一个多行注释，以/*开始，以*/结束。</p><figure class="nm nn no np gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/52f9ddd5d2b08c2e51a5a9fd775beb16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6geMMmfI1bAj7Ndb443sVw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">多行注释</figcaption></figure><h1 id="568d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">列的 Snake_case 名称</h1><p id="eb79" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">务必确保查询的输出具有易于理解的名称。如果您创建了一个新列(比如通过计算或连接新字段)，新列将获得一个通用的默认名称(例如 f0)。例如:</p><figure class="nm nn no np gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nu"><img src="../Images/4dd41389d6079370ecfb9ccf5acfc391.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JgaCZvK9WnwlhVoQ2fh-Hw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">已创建列的通用默认名称</figcaption></figure><p id="314e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">结果是:</p><figure class="nm nn no np gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nv"><img src="../Images/1f665279e902680627f9aaecbd7705e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7hCMRAXDwIcLhjLtIp_jDA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">创建的新列的结果</figcaption></figure><p id="9258" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因为在前面提到的查询中没有标识它们，所以前两列被称为 f0 和 f1。<strong class="kf ir"> SQL </strong>的默认值为 f0、f1、f2 等。为了确保最后两列的名称出现在查询结果中，我们将它们命名为 total tickets 和 number of purchases。这就是为什么给你的列起一个相关的名字总是一个聪明的主意，尤其是在使用函数的时候。您希望能够在运行查询后快速理解您的结果，就像我们在示例中提到的最后两列。</p><blockquote class="ne nf ng"><p id="d19c" class="kd ke nh kf b kg kh ki kj kk kl km kn ni kp kq kr nj kt ku kv nk kx ky kz la ij bi translated">您可能还注意到，列名中的每个单词之间都有一个下划线。名称中不应该使用空格。</p></blockquote><p id="5f2f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果“total_tickets”包含一个空格并且类似于“total tickets”，SUM(tickets)将被 SQL<strong class="kf ir">重命名为“total”</strong></p><blockquote class="ne nf ng"><p id="4ac4" class="kd ke nh kf b kg kh ki kj kk kl km kn ni kp kq kr nj kt ku kv nk kx ky kz la ij bi translated">由于空间的原因，SQL 会将名称视为“total”，不会理解您所说的“tickets”是什么意思因此，SQL 名称中的空格是有害的。永远不要省略空格。建议使用蛇皮箱。</p></blockquote><p id="d439" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">换句话说，不要写“total tickets”，它在两个单词之间包含一个空格，而要写“total_tickets”，用下划线代替空格。同样，这可能因不同的<strong class="kf ir"> SQL </strong>方言而异。例如，Zoho analytics 中的 SQL 编辑器可以识别列名中的空格。如前所述，避免空格是最佳实践。</p><h1 id="f1c6" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">表的茶色名称</h1><p id="9cc4" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">命名表时，也可以使用<strong class="kf ir"> CamelCase </strong>大写。<br/> <strong class="kf ir">驼色</strong>大写是指每个单词以大写字母开头，看起来像一只双峰(双峰)骆驼。因此，TicketsByOccasion 表中使用了<strong class="kf ir"> CamelCase </strong>大写。请注意，也使用了<strong class="kf ir">茶色</strong>，第一个单词不需要大写。有些人使用术语<strong class="kf ir"> CamelCase </strong>和<strong class="kf ir"> PascalCase </strong>来区分这两种类型，CamelCase 只在首字母不大写时使用，比如单峰骆驼，ticketsByOccasion 就是这种情况。</p><p id="1995" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">驼色最终只是一种时尚选择。还有其他选项来命名您的表，例如:</p><ul class=""><li id="f849" class="mq mr iq kf b kg kh kk kl ko ms ks mt kw mu la mv mw mx my bi translated">全部大写或全部小写，例如 TICKETSBYOCCASION</li><li id="9cff" class="mq mr iq kf b kg mz kk na ko nb ks nc kw nd la mv mw mx my bi translated">与蛇 _ 情况下，像门票 _ 由 _ 场合</li></ul><p id="76a4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于专业用途，不建议使用全部小写或大写字母的选项，因为阅读您的表名会很困难。</p><p id="37b3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从技术上来说，第二种选择，蛇案，是可以接受的。当单词由下划线分隔时，表名很容易阅读，但是因为还要添加下划线，所以表名可能会变得很长。写作也需要更多的时间。如果你经常使用这张桌子，它会变得令人厌烦。</p><blockquote class="ne nf ng"><p id="7a4c" class="kd ke nh kf b kg kh ki kj kk kl km kn ni kp kq kr nj kt ku kv nk kx ky kz la ij bi translated">总之，在命名表时，您可以自由选择 snake case 或 camelCase。确保您的表名一致且易于阅读。了解您的组织是否也有特定的表命名方法。如果他们这样做了，为了一致起见，总是使用他们的命名约定。</p></blockquote><h1 id="9adc" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">刻痕</h1><p id="11b1" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">一般来说，您希望查询中每一行的长度保持在 100 个字符:</p><figure class="nm nn no np gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nw"><img src="../Images/c1b21eabc7539756c918d523c8ce3b03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KxuURoyLXIponUM85Fx_4g.png"/></div></div></figure><p id="ba3b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个查询很难阅读，也很难进行故障诊断或编辑。现在，这里有一个查询，我们坚持使用&lt;= 100 character rule:</p><figure class="nm nn no np gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nx"><img src="../Images/c9a12c088f468705451625406ce49108.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PEAIQ4Qe6KWmttKo4N3qBA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Indentation of SQL query</figcaption></figure><p id="f7aa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Now it is much easier to understand what you are trying to do in the <strong class="kf ir"> SELECT </strong>子句。当然，两个查询运行起来都不会有问题，因为缩进在<strong class="kf ir"> SQL </strong>中无关紧要。但是适当的缩进对于保持行短仍然很重要。任何阅读你的问题的人都会重视它，包括你自己！</p><blockquote class="ny"><p id="6303" class="nz oa iq bd ob oc od oe of og oh la dk translated">这些编写 SQL 查询的最佳实践将作为 SQL 领域指南来帮助您！</p></blockquote><p id="c35e" class="pw-post-body-paragraph kd ke iq kf b kg oi ki kj kk oj km kn ko ok kq kr ks ol ku kv kw om ky kz la ij bi translated"><a class="ae kc" href="https://www.linkedin.com/in/anmolpanna/" rel="noopener ugc nofollow" target="_blank"> —感谢您的阅读并随时联系我</a> <br/> <a class="ae kc" href="https://medium.com/membership/@anmolpanna" rel="noopener"> —想成为会员阅读更多</a></p></div></div>    
</body>
</html>