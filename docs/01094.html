<html>
<head>
<title>Part 2: Stop Using If-Else Statements</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">第 2 部分:停止使用 If-Else 语句</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/part-2-stop-using-if-else-statements-ae4b0bec5bad?source=collection_archive---------5-----------------------#2020-06-24">https://blog.devgenius.io/part-2-stop-using-if-else-statements-ae4b0bec5bad?source=collection_archive---------5-----------------------#2020-06-24</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><h2 id="898d" class="ip iq ir bd b dl is it iu iv iw ix dk iy translated" aria-label="kicker paragraph">应用设计模式:策略</h2><div class=""/><div class=""><h2 id="033a" class="pw-subtitle-paragraph jx ja ir bd b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko dk translated">让我们再来看看如何替换 if-else 语句。</h2></div><p id="c818" class="pw-post-body-paragraph kp kq ir kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk ik bi translated">好吧，我们都同意到处使用 If-Else 语句是一种糟糕的做法。</p><p id="b6c9" class="pw-post-body-paragraph kp kq ir kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk ik bi translated">毫无疑问，从周日开始，你已经遇到了六种让你头疼的假设语句。<strong class="kr jb">龌龊的</strong>分支和<strong class="kr jb">不明确的</strong>职责。我们还不如在那里拍一些照片，只是为了开心和欢笑。</p><p id="fb8f" class="pw-post-body-paragraph kp kq ir kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk ik bi translated">教官和老师都爱 If-Else。这是他们的锤子，一切都是钉子。必须决定执行哪个逻辑？使用 If-Else。想创建工厂？使用 If-Else。你已经明白了…</p><p id="573e" class="pw-post-body-paragraph kp kq ir kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk ik bi translated">我们将把下面这个说明性的热点问题重构为可扩展的产品。</p><figure class="lq lr ls lt gu lu gi gj paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gi gj lp"><img src="../Images/fa626cbad4f9b561521d3461bcd0f252.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QogTHclv3MAQAxl0ZQgDSg.png"/></div></div><figcaption class="mb mc gk gi gj md me bd b be z dk translated">看起来很可怕。是的，它也可以用 switch 来实现。这种代码仍然很普遍。</figcaption></figure><p id="9e47" class="pw-post-body-paragraph kp kq ir kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk ik bi translated">你知道这不好。但它是可以修复的。稍微重构一下，我们就回到了高度可扩展和可维护的代码，它会让你睡得像个婴儿。</p><h2 id="4054" class="mf mg ir bd mh mi mj dn mk ml mm dp mn ky mo mp mq lc mr ms mt lg mu mv mw ix bi translated">"那么，我们如何替换这些令人痛苦的 If-Else 语句呢？"</h2><p id="5993" class="pw-post-body-paragraph kp kq ir kr b ks mx kb ku kv my ke kx ky mz la lb lc na le lf lg nb li lj lk ik bi translated">使用策略对象和类型发现。</p><p id="419b" class="pw-post-body-paragraph kp kq ir kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk ik bi translated">您可能已经听说过策略模式，但可能仍会暗自好奇模糊到底是怎么回事。下面是对一种模式的简单介绍，这种模式将改变你将来编写分支的方式。</p><blockquote class="nc"><p id="13b3" class="nd ne ir bd nf ng nh ni nj nk nl lk dk translated">我们经常需要根据某些条件来决定执行哪个逻辑。</p><p id="ac1f" class="nd ne ir bd nf ng nh ni nj nk nl lk dk translated">通过创建一组具有公共接口的类，结合类型发现，我们可以很容易地交换执行哪个逻辑，而不需要 If-Else。</p></blockquote><p id="edb4" class="pw-post-body-paragraph kp kq ir kr b ks nm kb ku kv nn ke kx ky no la lb lc np le lf lg nq li lj lk ik bi translated">不错吧。我们只是调用一个专用对象的方法，而不是用无尽的 If-Else 分支语句来扩展我们的应用程序。</p><p id="fd37" class="pw-post-body-paragraph kp kq ir kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk ik bi translated">我们将重构上面的代码，确保我们坚持坚实的原则。尤其是考虑到打开/关闭原则。</p><h1 id="6f18" class="nr mg ir bd mh ns nt nu mk nv nw nx mn kg ny kh mq kj nz kk mt km oa kn mw ob bi translated">演示时间</h1><p id="c1c8" class="pw-post-body-paragraph kp kq ir kr b ks mx kb ku kv my ke kx ky mz la lb lc na le lf lg nb li lj lk ik bi oc translated">首先，我们从可怕的 If-Else 语句中提取逻辑，并把它放在不同的策略类中。同时，我们创建一个公共界面。</p><figure class="lq lr ls lt gu lu gi gj paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gi gj ol"><img src="../Images/79d610b0f04ddf676741b139af8af18c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FtIH4F5iQKdzZATTjyTrRg.png"/></div></div></figure><p id="6f8e" class="pw-post-body-paragraph kp kq ir kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk ik bi translated">每个策略类都实现了公共接口。此外，我在类上应用了一个属性，这为我们提供了一个友好的策略名称。属性类将在本文后面定义。</p><p id="2efe" class="pw-post-body-paragraph kp kq ir kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk ik bi oc translated">然后，我们在 Order 类中创建一个方法，该方法将策略接口作为一个参数。下面是整个 Order 类的一个片段。</p><figure class="lq lr ls lt gu lu gi gj paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gi gj om"><img src="../Images/a17097b2c22cd0620b6950054475c8d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k3hCFxy4J4qENkQGYnsrcw.png"/></div></div></figure><p id="b422" class="pw-post-body-paragraph kp kq ir kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk ik bi translated">这允许我们将逻辑委托给专门的类，而不是编写可怕的、不容易扩展的 if-else 语句。</p><p id="d122" class="pw-post-body-paragraph kp kq ir kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk ik bi oc translated">现在，我们实际上从一开始的示例中删除了 If-Else 地狱。</p><p id="346e" class="pw-post-body-paragraph kp kq ir kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk ik bi translated">这为我们应用程序提供了一些真正的可扩展性。</p><figure class="lq lr ls lt gu lu gi gj paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gi gj on"><img src="../Images/2cfadeff90c8ea23fb39015587001cdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dDa4mwOyRmKNDMdZm8C_PA.png"/></div></div></figure><p id="f2f3" class="pw-post-body-paragraph kp kq ir kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk ik bi translated">让我们简要地浏览一下类型发现过程。</p><p id="c32f" class="pw-post-body-paragraph kp kq ir kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk ik bi translated">我们正在构建一个包含实现公共接口的所有类型的字典，并使用属性中的名称作为键。</p><p id="7e3a" class="pw-post-body-paragraph kp kq ir kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk ik bi translated">然后，我们让用户在控制台中输入一些匹配输出格式化程序名称的文本。</p><p id="0b7a" class="pw-post-body-paragraph kp kq ir kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk ik bi translated">基于输入，我们首先在字典中找到相应的类型，并创建该类型的实例。</p><p id="2364" class="pw-post-body-paragraph kp kq ir kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk ik bi translated">该实例被传递给订单的 GenerateOutput 方法。</p><p id="0108" class="pw-post-body-paragraph kp kq ir kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk ik bi translated">毫无疑问，更多的是代码。但是它将允许我们动态地发现新的格式器策略，因为它们被添加到解决方案中。一些如果-否则不会提供给你的东西，无论指导者如何努力去推动它。</p><h2 id="b86c" class="mf mg ir bd mh mi mj dn mk ml mm dp mn ky mo mp mq lc mr ms mt lg mu mv mw ix bi translated">还有一件事…</h2><p id="f032" class="pw-post-body-paragraph kp kq ir kr b ks mx kb ku kv my ke kx ky mz la lb lc na le lf lg nb li lj lk ik bi translated">如果您想知道策略类上面的<code class="fe ll lm ln lo b">[OutputFormatterName("")]</code>，实现如下所示。</p><figure class="lq lr ls lt gu lu gi gj paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gi gj oo"><img src="../Images/75af8cf23d296392a027106a82377492.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O8O9vzQOzITrfn-5NBkl6A.png"/></div></div></figure><p id="4a2a" class="pw-post-body-paragraph kp kq ir kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk ik bi translated">一个非常简单的属性类，为我们提供了一个友好的显示名称。</p><h2 id="32b4" class="mf mg ir bd mh mi mj dn mk ml mm dp mn ky mo mp mq lc mr ms mt lg mu mv mw ix bi translated">“如果我需要一种新的方法来格式化输出，该怎么办？</h2><p id="396e" class="pw-post-body-paragraph kp kq ir kr b ks mx kb ku kv my ke kx ky mz la lb lc na le lf lg nb li lj lk ik bi translated">您创建了一个实现了<code class="fe ll lm ln lo b">IOrderOutputStrategy</code>的新类。说实话就这么简单。类型发现过程将负责向应用程序“注册”新的格式化程序。</p><p id="3469" class="pw-post-body-paragraph kp kq ir kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk ik bi translated">通过在订单上定义<code class="fe ll lm ln lo b">GenerateOuput</code>方法，我们不需要使用 If-Else 来分支我们的代码。我们只是把责任委托给专门的类。</p><h2 id="3e87" class="mf mg ir bd mh mi mj dn mk ml mm dp mn ky mo mp mq lc mr ms mt lg mu mv mw ix bi translated">"同样，你创建了许多类来做一些简单的事情！"</h2><p id="18a8" class="pw-post-body-paragraph kp kq ir kr b ks mx kb ku kv my ke kx ky mz la lb lc na le lf lg nb li lj lk ik bi translated">当然，有很多额外的课程。但是它们非常简单。</p><p id="dd98" class="pw-post-body-paragraph kp kq ir kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk ik bi translated">它们有着源自功能需求的有意义的名字。其他开发者会从一开始就意识到他们的目的。</p><p id="4a7f" class="pw-post-body-paragraph kp kq ir kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk ik bi translated">我也可以和业务人员一起浏览逻辑，他们完全理解我所说的内容，只需要一点点帮助——毕竟这是代码。</p><p id="6373" class="pw-post-body-paragraph kp kq ir kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk ik bi translated">我们真的应该限制我们的表达能力，只是为了适应那些被 If-Else 卡住的人吗？</p><h2 id="39c3" class="mf mg ir bd mh mi mj dn mk ml mm dp mn ky mo mp mq lc mr ms mt lg mu mv mw ix bi translated">"但是不会有 If-Else 没问题的情况吗？"</h2><p id="9d0a" class="pw-post-body-paragraph kp kq ir kr b ks mx kb ku kv my ke kx ky mz la lb lc na le lf lg nb li lj lk ik bi translated">当然可以。有时候……如果你喜欢竞争性编程，写一些需要高度优化的东西，如果你知道某些东西绝对不会改变(直到它改变)——或者做一个大学作业。教练们喜欢这样。</p></div><div class="ab cl op oq hv or" role="separator"><span class="os bw bk ot ou ov"/><span class="os bw bk ot ou ov"/><span class="os bw bk ot ou"/></div><div class="ik il im in io"><pre class="lq lr ls lt gu ow lo ox oy aw oz bi"><span id="2fd0" class="mf mg ir lo b gz pa pb l pc pd"><strong class="lo jb">Resources for the curious<br/></strong>--------------------------<br/><a class="ae pe" href="https://refactoring.guru/design-patterns/strategy" rel="noopener ugc nofollow" target="_blank">Examples by Refactoring Guru</a></span><span id="8238" class="mf mg ir lo b gz pf pb l pc pd"><a class="ae pe" href="https://sourcemaking.com/design_patterns/strategy" rel="noopener ugc nofollow" target="_blank">Examples by SourceMaking</a></span><span id="7bf6" class="mf mg ir lo b gz pf pb l pc pd"><a class="ae pe" href="https://app.pluralsight.com/library/courses/c-sharp-code-more-object-oriented/table-of-contents" rel="noopener ugc nofollow" target="_blank">How to make your code more Object-Oriented by Zoran Horvat</a></span><span id="a5cb" class="mf mg ir lo b gz pf pb l pc pd"><a class="ae pe" href="https://app.pluralsight.com/library/courses/c-sharp-design-patterns-strategy/table-of-contents" rel="noopener ugc nofollow" target="_blank">C# Design Patterns: Strategy by Filip Ekberg</a></span></pre><figure class="lq lr ls lt gu lu gi gj paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gi gj pg"><img src="../Images/1984373df9633c42635523daa86cd2fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ng-Y5U08drqhQp3j.png"/></div></div></figure><div class="ph pi gq gs pj pk"><a href="https://medium.com/swlh/stop-using-if-else-statements-f4d2323e6e4" rel="noopener follow" target="_blank"><div class="pl ab fp"><div class="pm ab pn cl cj po"><h2 class="bd jb gz z fq pp fs ft pq fv fx ja bi translated">停止使用 If-Else 语句</h2><div class="pr l"><h3 class="bd b gz z fq pp fs ft pq fv fx dk translated">编写干净、可维护的代码，不使用 if-else。</h3></div><div class="ps l"><p class="bd b dl z fq pp fs ft pq fv fx dk translated">medium.com</p></div></div><div class="pt l"><div class="pu l pv pw px pt py lz pk"/></div></div></a></div><div class="ph pi gq gs pj pk"><a href="https://medium.com/swlh/dont-use-database-generated-ids-d703d35e9cc4" rel="noopener follow" target="_blank"><div class="pl ab fp"><div class="pm ab pn cl cj po"><h2 class="bd jb gz z fq pp fs ft pq fv fx ja bi translated">不要使用数据库生成的 id</h2><div class="pr l"><h3 class="bd b gz z fq pp fs ft pq fv fx dk translated">不要让数据库来管理你的应用程序</h3></div><div class="ps l"><p class="bd b dl z fq pp fs ft pq fv fx dk translated">medium.com</p></div></div><div class="pt l"><div class="pz l pv pw px pt py lz pk"/></div></div></a></div><div class="ph pi gq gs pj pk"><a href="https://medium.com/swlh/stop-checking-for-nulls-5f9f857ddf72" rel="noopener follow" target="_blank"><div class="pl ab fp"><div class="pm ab pn cl cj po"><h2 class="bd jb gz z fq pp fs ft pq fv fx ja bi translated">停止检查空值</h2><div class="pr l"><h3 class="bd b gz z fq pp fs ft pq fv fx dk translated">空对象模式、工厂方法——让我们看看一些生产就绪代码！</h3></div><div class="ps l"><p class="bd b dl z fq pp fs ft pq fv fx dk translated">medium.com</p></div></div><div class="pt l"><div class="qa l pv pw px pt py lz pk"/></div></div></a></div><div class="ph pi gq gs pj pk"><a href="https://medium.com/swlh/dynamic-command-dispatching-in-c-d3abe21b3d1b" rel="noopener follow" target="_blank"><div class="pl ab fp"><div class="pm ab pn cl cj po"><h2 class="bd jb gz z fq pp fs ft pq fv fx ja bi translated">C#中的动态命令调度</h2><div class="pr l"><h3 class="bd b gz z fq pp fs ft pq fv fx dk translated">让我们保持这一个简短和甜蜜</h3></div><div class="ps l"><p class="bd b dl z fq pp fs ft pq fv fx dk translated">medium.com</p></div></div><div class="pt l"><div class="qb l pv pw px pt py lz pk"/></div></div></a></div><div class="ph pi gq gs pj pk"><a href="https://medium.com/swlh/lets-add-some-functionality-e7b1f4701ba9" rel="noopener follow" target="_blank"><div class="pl ab fp"><div class="pm ab pn cl cj po"><h2 class="bd jb gz z fq pp fs ft pq fv fx ja bi translated">扩展你的类而不修改它们</h2><div class="pr l"><h3 class="bd b gz z fq pp fs ft pq fv fx dk translated">简单明了的扩展超过了修改</h3></div><div class="ps l"><p class="bd b dl z fq pp fs ft pq fv fx dk translated">medium.com</p></div></div><div class="pt l"><div class="qc l pv pw px pt py lz pk"/></div></div></a></div><figure class="lq lr ls lt gu lu gi gj paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gi gj pg"><img src="../Images/745b6019f001879654cae7d29d306420.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*LZ0-rAawOB4iv6uI.png"/></div></div></figure><p id="cc49" class="pw-post-body-paragraph kp kq ir kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk ik bi translated"><strong class="kr jb"> Nicklas Millard </strong>是一名软件开发工程师，供职于一家发展最快的银行，负责构建任务关键型金融服务基础设施。</p><p id="7bfa" class="pw-post-body-paragraph kp kq ir kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk ik bi translated">此前，他是 Big4 的高级技术顾问，为商业客户和政府机构开发软件。</p><blockquote class="qd qe qf"><p id="71d7" class="kp kq qg kr b ks kt kb ku kv kw ke kx qh kz la lb qi ld le lf qj lh li lj lk ik bi translated"><a class="ae pe" href="https://www.youtube.com/channel/UCaUy83EAkVdXsZjF3xGSvMw" rel="noopener ugc nofollow" target="_blank">新的 YouTube 频道(@Nicklas Millard) </a></p><p id="6546" class="kp kq qg kr b ks kt kb ku kv kw ke kx qh kz la lb qi ld le lf qj lh li lj lk ik bi translated"><em class="ir">接通</em><a class="ae pe" href="https://www.linkedin.com/in/nicklasmillard/" rel="noopener ugc nofollow" target="_blank">T5】LinkedInT7】</a></p></blockquote></div></div>    
</body>
</html>