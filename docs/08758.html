<html>
<head>
<title>Terraform Code Scan using SonarCloud &amp; Azure DevOps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 SonarCloud 和 Azure DevOps 进行 Terraform 代码扫描</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/terraform-code-scan-using-sonarcloud-azure-devops-6f39bb66b82c?source=collection_archive---------1-----------------------#2022-07-08">https://blog.devgenius.io/terraform-code-scan-using-sonarcloud-azure-devops-6f39bb66b82c?source=collection_archive---------1-----------------------#2022-07-08</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/05e303c5a50c27a7653e43681afc0d77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aAuvVnYu2rS_z7iMXuWaaA.jpeg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">地形-声纳云</figcaption></figure><p id="024f" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在本文中，我将解释如何在 Azure DevOps pipeline 中使用 SonarCloud 扫描您的 terraform 代码</p><h1 id="7cfc" class="kx ky in bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">SonarCloud 是什么？</h1><p id="29e7" class="pw-post-body-paragraph jz ka in kb b kc lv ke kf kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ig bi translated">SonarCloud 是一种基于云的代码分析服务，旨在检测 25 种不同编程语言中的代码质量问题，持续确保代码的可维护性、可靠性和安全性。</p><h1 id="0198" class="kx ky in bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">SonarCloud 是做什么的？</h1><p id="83d7" class="pw-post-body-paragraph jz ka in kb b kc lv ke kf kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ig bi translated">SonarCloud 在<em class="ma">静态代码分析</em>中使用最先进的技术，在您和您的团队编写的代码中发现问题和潜在问题。</p><p id="e0fb" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">静态分析被称为<em class="ma">静态</em>，因为它不依赖于实际运行代码(对运行代码的分析被称为<em class="ma">动态分析</em>)。因此，SonarCloud 提供了一个额外的验证层，不同于自动化测试和人工代码审查。</p><p id="da59" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">问题的早期检测确保更少的问题进入过程的后期阶段，并最终有助于提高产品代码的整体质量。</p><p id="a2c8" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">先决条件:</strong></p><ol class=""><li id="c7a2" class="mb mc in kb b kc kd kg kh kk md ko me ks mf kw mg mh mi mj bi translated">您有一个 Azure DevOps 项目，其中包含用于扫描的 Terraform 代码</li><li id="7175" class="mb mc in kb b kc mk kg ml kk mm ko mn ks mo kw mg mh mi mj bi translated">您有一个有效的 SonarCloud 项目</li></ol><p id="3514" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">要注册并创建一个免费的组织和项目，请遵循官方文档</p><div class="mp mq gp gr mr ms"><a href="https://docs.sonarcloud.io/getting-started/overview/" rel="noopener  ugc nofollow" target="_blank"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd io gy z fp mx fr fs my fu fw im bi translated">入门指南</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">要使用 SonarCloud 分析您的代码，它必须托管在一个受支持的 DevOps 平台上，并且您必须登录…</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">docs.sonarcloud.io</p></div></div><div class="nb l"><div class="nc l nd ne nf nb ng jt ms"/></div></div></a></div><p id="6113" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">3.在您的 Azure DevOps 项目上安装 SonarCloud 扩展</p><p id="4489" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">转到 Visual Studio Marketplace 并将该扩展添加到您的项目中。</p><div class="mp mq gp gr mr ms"><a href="https://marketplace.visualstudio.com/items?itemName=SonarSource.sonarcloud" rel="noopener  ugc nofollow" target="_blank"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd io gy z fp mx fr fs my fu fw im bi translated">SonarCloud - Visual Studio 市场</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">Azure DevOps 的扩展——跨项目分支和拉请求检测错误、漏洞和代码气味。</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">marketplace.visualstudio.com</p></div></div><div class="nb l"><div class="nh l nd ne nf nb ng jt ms"/></div></div></a></div><p id="6134" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">4.为 SonarCloud 创建服务连接</p><p id="73d3" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">转到项目设置→服务连接</p><p id="eb6e" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">点击新服务连接并选择 SonarCloud</p><figure class="nj nk nl nm gt jo gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/284d057cb8beeedfa5eb0c7fcd14bd38.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*Xqe8UPaiqQTOjT_GVZIk4A.jpeg"/></div></figure><p id="c90e" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">提供令牌、服务连接名称和描述，然后单击“验证并保存”</p><figure class="nj nk nl nm gt jo gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/e705286f29fcfdc6d7b6adb52e8a0e50.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*QrSFQJeczohAYr-qV1fqbw.jpeg"/></div></figure><blockquote class="no np nq"><p id="8a77" class="jz ka ma kb b kc kd ke kf kg kh ki kj nr kl km kn ns kp kq kr nt kt ku kv kw ig bi translated">要生成令牌，请转到 sonarcloud 组织，然后转到我的帐户→安全性</p><p id="bd8a" class="jz ka ma kb b kc kd ke kf kg kh ki kj nr kl km kn ns kp kq kr nt kt ku kv kw ig bi translated">提供令牌名称，然后单击“生成并复制令牌”</p></blockquote><figure class="nj nk nl nm gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nu"><img src="../Images/8023169a984d60d17776961167153644.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jd3txHrGFnEbRooCWxnj9g.jpeg"/></div></div></figure><figure class="nj nk nl nm gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nv"><img src="../Images/36f0f08425ded535c5bd65ab45d6de7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hEK-BcweSJfbgfa1RzzMPg.jpeg"/></div></div></figure><h1 id="5710" class="kx ky in bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">步骤:</h1><p id="195d" class="pw-post-body-paragraph jz ka in kb b kc lv ke kf kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ig bi translated">我们将在 SonarCloud 扫描活动中包括 3 项任务</p><ol class=""><li id="06cb" class="mb mc in kb b kc kd kg kh kk md ko me ks mf kw mg mh mi mj bi translated">变量</li></ol><pre class="nj nk nl nm gt nw nx ny nz aw oa bi"><span id="b22f" class="ob ky in nx b gy oc od l oe of">variables:<br/>  - name: SonarProjectName<br/>    value: 'dummyvalue'<br/>  - name: SonarProjectKey<br/>    value: 'dummykey'<br/># Please put your actual values in variables<br/># You can put the variables in a variable group and keep them as secret</span></pre><blockquote class="no np nq"><p id="fbc8" class="jz ka ma kb b kc kd ke kf kg kh ki kj nr kl km kn ns kp kq kr nt kt ku kv kw ig bi translated">cliProjectKey 和 cliProjectName 将在 SonarCloud 项目中可用。转到 SonarCloud 中您的项目，然后单击信息</p></blockquote><p id="c30f" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">2.声纳云准备任务</p><pre class="nj nk nl nm gt nw nx ny nz aw oa bi"><span id="3bf6" class="ob ky in nx b gy oc od l oe of">- task: SonarCloudPrepare@1<br/>    inputs:<br/>      SonarCloud: 'SonarCloud-ServiceConnection'<br/>      organization: 'myorg'<br/>      scannerMode: 'CLI'<br/>      configMode: 'manual'<br/>      cliProjectKey: '$(SonarProjectKey)'<br/>      cliProjectName: '$(SonarProjectName)'<br/>      cliSources: '$(System.DefaultWorkingDirectory)/TF'</span></pre><p id="8d47" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">2.声纳云扫描任务</p><pre class="nj nk nl nm gt nw nx ny nz aw oa bi"><span id="17c3" class="ob ky in nx b gy oc od l oe of">- task: SonarCloudAnalyze@1<br/>    displayName: SonarCloud Scan</span></pre><p id="e708" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">3.发布声纳云结果</p><pre class="nj nk nl nm gt nw nx ny nz aw oa bi"><span id="e3bc" class="ob ky in nx b gy oc od l oe of">- task: SonarCloudPublish@1<br/>    displayName: SonarCloud Publish<br/>    inputs:<br/>      pollingTimeoutSec: '300'</span></pre><p id="627d" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">完成 yaml </strong></p><pre class="nj nk nl nm gt nw nx ny nz aw oa bi"><span id="2b7f" class="ob ky in nx b gy oc od l oe of">trigger: none</span><span id="1daf" class="ob ky in nx b gy og od l oe of">pool:<br/>  vmImage: ubuntu-latest<br/>variables:<br/>  - name: SonarProjectName<br/>    value: 'dummyvalue'<br/>  - name: SonarProjectKey<br/>    value: 'dummykey'<br/># Please put your actual values in variables<br/>steps:<br/>  - task: SonarCloudPrepare@1<br/>    inputs:<br/>      SonarCloud: 'SonarCloud-ServiceConnection'<br/>      organization: 'myorg'<br/>      scannerMode: 'CLI'<br/>      configMode: 'manual'<br/>      cliProjectKey: '$(SonarProjectKey)'<br/>      cliProjectName: '$(SonarProjectName)'<br/>      cliSources: '$(System.DefaultWorkingDirectory)/TF'<br/>  - task: SonarCloudAnalyze@1<br/>    displayName: SonarCloud Scan<br/>  - task: SonarCloudPublish@1<br/>    displayName: SonarCloud Publish<br/>    inputs:<br/>      pollingTimeoutSec: '300'</span></pre></div><div class="ab cl oh oi hr oj" role="separator"><span class="ok bw bk ol om on"/><span class="ok bw bk ol om on"/><span class="ok bw bk ol om"/></div><div class="ig ih ii ij ik"><p id="b59c" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">sonar cloud 中的样本扫描结果</strong></p><figure class="nj nk nl nm gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oo"><img src="../Images/cf28f0171c2cab50b5d669e06e51ee1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D0Vu-OfPqvDeVMgD9554tA.jpeg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">结果</figcaption></figure><p id="8d58" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">其他资源:</strong></p><div class="mp mq gp gr mr ms"><a href="https://docs.sonarcloud.io/getting-started/overview/" rel="noopener  ugc nofollow" target="_blank"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd io gy z fp mx fr fs my fu fw im bi translated">入门指南</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">要使用 SonarCloud 分析您的代码，它必须托管在一个受支持的 DevOps 平台上，并且您必须登录…</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">docs.sonarcloud.io</p></div></div><div class="nb l"><div class="nc l nd ne nf nb ng jt ms"/></div></div></a></div><div class="mp mq gp gr mr ms"><a href="https://docs.sonarcloud.io/improving/overview/" rel="noopener  ugc nofollow" target="_blank"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd io gy z fp mx fr fs my fu fw im bi translated">改进您的代码</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">SonarCloud 旨在集成到您的日常开发工作流程中，以便分析结果以…</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">docs.sonarcloud.io</p></div></div><div class="nb l"><div class="op l nd ne nf nb ng jt ms"/></div></div></a></div><div class="mp mq gp gr mr ms"><a href="https://github.com/babula000/TF" rel="noopener  ugc nofollow" target="_blank"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd io gy z fp mx fr fs my fu fw im bi translated">GitHub - babula000/TF</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">github.com</p></div></div><div class="nb l"><div class="oq l nd ne nf nb ng jt ms"/></div></div></a></div><p id="db73" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我希望你喜欢阅读这篇文章，随时添加你的评论、想法或反馈，不要忘记在 linkedin 上联系。</p></div></div>    
</body>
</html>