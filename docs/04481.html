<html>
<head>
<title>Create a Simple React Whiteboard with the Visx Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Visx库创建一个简单的React白板</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/create-a-simple-react-whiteboard-with-the-visx-library-b7b65c71c7d9?source=collection_archive---------1-----------------------#2021-03-22">https://blog.devgenius.io/create-a-simple-react-whiteboard-with-the-visx-library-b7b65c71c7d9?source=collection_archive---------1-----------------------#2021-03-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/0dc5b3e782b2aaf92b4ba0b937731020.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5wEpVufwgx_3Rpn7"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Mia Baker 在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><p id="2710" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Visx是一个库，让我们可以轻松地将图形添加到React应用程序中。</p><p id="ee07" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解如何使用它在React应用程序中添加一个简单的白板。</p><h1 id="396e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">安装所需的软件包</h1><p id="2968" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们必须安装一些模块。</p><p id="61e8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们运行:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="89df" class="mn lc iq mj b gy mo mp l mq mr">npm i @visx/curve @visx/drag @visx/gradient @visx/responsive @visx/shape</span></pre><p id="8e2b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">安装软件包。</p><h1 id="4761" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">创建白板</h1><p id="04ad" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过添加模块提供的项目来创建白板。</p><p id="dc1c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们写道:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="c9a2" class="mn lc iq mj b gy mo mp l mq mr">import React, { useCallback, useState } from "react";<br/>import { LinePath } from "@visx/shape";<br/>import { useDrag } from "@visx/drag";<br/>import { curveBasis } from "@visx/curve";<br/>import { LinearGradient } from "@visx/gradient";</span><span id="c6c8" class="mn lc iq mj b gy ms mp l mq mr">function Example({ data = [], width, height }) {<br/>  const [lines, setLines] = useState(data);<br/>  const onDragStart = useCallback(<br/>    (currDrag) =&gt; {<br/>      setLines((currLines) =&gt; [<br/>        ...currLines,<br/>        [{ x: currDrag.x, y: currDrag.y }]<br/>      ]);<br/>    },<br/>    [setLines]<br/>  );<br/>  const onDragMove = useCallback(<br/>    (currDrag) =&gt; {<br/>      setLines((currLines) =&gt; {<br/>        const nextLines = [...currLines];<br/>        const newPoint = {<br/>          x: currDrag.x + currDrag.dx,<br/>          y: currDrag.y + currDrag.dy<br/>        };<br/>        const lastIndex = nextLines.length - 1;<br/>        nextLines[lastIndex] = [...(nextLines[lastIndex] || []), newPoint];<br/>        return nextLines;<br/>      });<br/>    },<br/>    [setLines]<br/>  );<br/>  const {<br/>    x = 0,<br/>    y = 0,<br/>    dx,<br/>    dy,<br/>    isDragging,<br/>    dragStart,<br/>    dragEnd,<br/>    dragMove<br/>  } = useDrag({<br/>    onDragStart,<br/>    onDragMove,<br/>    resetOnStart: true<br/>  });</span><span id="c253" class="mn lc iq mj b gy ms mp l mq mr">  return width &lt; 10 ? null : (<br/>    &lt;div className="DragII" style={{ touchAction: "none" }}&gt;<br/>      &lt;svg width={width} height={height}&gt;<br/>        &lt;LinearGradient id="stroke" from="#ff614e" to="#ffdc64" /&gt;<br/>        &lt;rect fill="#04002b" width={width} height={height} rx={14} /&gt;<br/>        {lines.map((line, i) =&gt; (<br/>          &lt;LinePath<br/>            key={`line-${i}`}<br/>            fill="transparent"<br/>            stroke="url(#stroke)"<br/>            strokeWidth={3}<br/>            data={line}<br/>            curve={curveBasis}<br/>            x={(d) =&gt; d.x}<br/>            y={(d) =&gt; d.y}<br/>          /&gt;<br/>        ))}</span><span id="ca50" class="mn lc iq mj b gy ms mp l mq mr">        &lt;g&gt;<br/>          {isDragging &amp;&amp; (<br/>            &lt;rect<br/>              width={width}<br/>              height={height}<br/>              onMouseMove={dragMove}<br/>              onMouseUp={dragEnd}<br/>              fill="transparent"<br/>            /&gt;<br/>          )}<br/>          {isDragging &amp;&amp; (<br/>            &lt;g&gt;<br/>              &lt;rect<br/>                fill="white"<br/>                width={8}<br/>                height={8}<br/>                x={x + dx - 4}<br/>                y={y + dy - 4}<br/>                pointerEvents="none"<br/>              /&gt;<br/>              &lt;circle<br/>                cx={x}<br/>                cy={y}<br/>                r={4}<br/>                fill="transparent"<br/>                stroke="white"<br/>                pointerEvents="none"<br/>              /&gt;<br/>            &lt;/g&gt;<br/>          )}<br/>          &lt;rect<br/>            fill="transparent"<br/>            width={width}<br/>            height={height}<br/>            onMouseDown={dragStart}<br/>            onMouseUp={isDragging ? dragEnd : undefined}<br/>            onMouseMove={isDragging ? dragMove : undefined}<br/>            onTouchStart={dragStart}<br/>            onTouchEnd={isDragging ? dragEnd : undefined}<br/>            onTouchMove={isDragging ? dragMove : undefined}<br/>          /&gt;<br/>        &lt;/g&gt;<br/>      &lt;/svg&gt;<br/>      &lt;style jsx&gt;{`<br/>        .DragII {<br/>          display: flex;<br/>          flex-direction: column;<br/>          user-select: none;<br/>        }</span><span id="22d6" class="mn lc iq mj b gy ms mp l mq mr">        svg {<br/>          margin: 1rem 0;<br/>          cursor: crosshair;<br/>        }</span><span id="0261" class="mn lc iq mj b gy ms mp l mq mr">        .deets {<br/>          display: flex;<br/>          flex-direction: row;<br/>          font-size: 12px;<br/>        }<br/>        .deets &gt; div {<br/>          margin: 0.25rem;<br/>        }<br/>      `}&lt;/style&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span><span id="d4c0" class="mn lc iq mj b gy ms mp l mq mr">export default function App() {<br/>  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;Example width={500} height={300} /&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="6bc0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe mt mu mv mj b">Example</code>组件中，我们有白板。</p><p id="1e9b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有<code class="fe mt mu mv mj b">lines</code>状态来跟踪这些行。</p><p id="bc27" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">lines</code>数组由<code class="fe mt mu mv mj b">onDragStart</code>函数设置。</p><p id="f71d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每当我们开始拖动鼠标，我们添加到<code class="fe mt mu mv mj b">lines</code>数组。</p><p id="7a03" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这条线从鼠标的x和y坐标开始。</p><p id="453b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">onDragMove</code>事件处理函数让我们根据鼠标的坐标添加线条。</p><p id="88c9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将这两个函数传递给<code class="fe mt mu mv mj b">useDrag</code>钩子，让我们在拖动时画线。</p><p id="3243" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe mt mu mv mj b">return</code>语句中，我们通过调用<code class="fe mt mu mv mj b">lines</code>数组上的<code class="fe mt mu mv mj b">map</code>来呈现<code class="fe mt mu mv mj b">LinePath</code>。</p><p id="ff24" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">data</code>被传入<code class="fe mt mu mv mj b">line</code>函数来渲染该行。</p><p id="518e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当<code class="fe mt mu mv mj b">isDragging</code>为<code class="fe mt mu mv mj b">true</code>时，也就是我们拖动鼠标的时候，就会显示<code class="fe mt mu mv mj b">circle</code>来渲染标记。</p><p id="c6a5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">rect</code>拖动时绘制一个透明矩形。</p><p id="7913" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">标签有我们想要为白板设置的样式。</p><h1 id="f4d6" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="e21f" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">借助Visx库，我们可以在React应用中轻松创建一个简单的白板。</p></div></div>    
</body>
</html>