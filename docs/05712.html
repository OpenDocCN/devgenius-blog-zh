<html>
<head>
<title>Boost My Wearable or How To Send/Receive Data from Watch to Smartphone</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">提升我的可穿戴设备或如何从手表向智能手机发送/接收数据</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/boost-my-wearable-or-how-to-send-receive-data-from-watch-to-smartphone-83655e57e429?source=collection_archive---------0-----------------------#2021-10-10">https://blog.devgenius.io/boost-my-wearable-or-how-to-send-receive-data-from-watch-to-smartphone-83655e57e429?source=collection_archive---------0-----------------------#2021-10-10</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><h1 id="5439" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">介绍</h1><p id="50ee" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">所以，正如你已经知道的…</p><p id="9b5b" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">是的，说“正如你已经知道的，可穿戴设备已经在几年前来到我们身边”是很明显的，但是我还没有为我的故事开头发明任何好的“开头”。但是，是的，你们中的一些人(甚至可能是大多数人)目前正在使用 alien Wear OS 设备或那些正常的设备，这些设备来自三星。</p><p id="a0a5" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">简单的用户，他们还没有进入开发阶段，至少现在还没有，甚至不要去猜测，在操作系统方面有什么不同。</p><p id="ec29" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">当你的一些父母来的时候，会问这样的问题:“嘿，给我做一个应用程序，当行星游行来的时候，独角兽会把彩虹糖果送到我们的房子里。没有吗？可恶，你是程序员！”</p><p id="ad38" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">多讨厌啊！</p><p id="6e4b" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">我开始解释，有 X 个问题与 Y 个情况密切相关，而 Z 则积极地不允许这样做。</p><h1 id="1dc1" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">开始穿吧！</h1><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi ll"><img src="../Images/aacaf219e1a11f6afe4a82e8124f9630.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*XXKc-9gogZAchTLx.jpg"/></div></div></figure><p id="3678" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">哦，等等，我忘了说，那个代码是写在<strong class="kk io">科特林</strong>上的，一定要……知道<strong class="kk io">科特林</strong>，使用<strong class="kk io">科特林</strong>，做一个<strong class="kk io">科特林</strong>，不要在复制/粘贴<strong class="kk io">科特林</strong>代码时混淆:)</p></div><div class="ab cl lx ly hr lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ig ih ii ij ik"><p id="de16" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">有一次……吃午饭时，我在纠结这样一个问题:我如何将数据发送到可穿戴设备，并把动作传回我的智能手机，它已经与智能手机配对了。是的，我已经找到了一些解决方案，这让我可以开始这项任务。</p><p id="1183" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated"><em class="me"> ~对于那些还不熟悉可穿戴应用的人来说，这篇文章下面有一个创建 Wear OS 项目的链接。</em></p><p id="aa2f" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">因此，主要的事情是创建一个基本的 Android 应用程序和 Wear OS 应用程序，将它们绑定在一起。要点是在不丢失任何数据的情况下将数据发送到可穿戴设备。其实很简单:</p><pre class="lm ln lo lp gt mf mg mh mi aw mj bi"><span id="2d39" class="mk jl in mg b gy ml mm l mn mo">val dataClient = Wearable.getDataClient(context)<br/>val putDataMapRequest = PutDataMapRequest.create(path)<br/>val dataMap = putDataMapRequest.dataMap<br/>dataMap.putString(key, message)<br/>val putDataRequest = putDataMapRequest.asPutDataRequest().setUrgent()<br/>val putDataTask = dataClient.putDataItem(putDataRequest)<br/>putDataTask.addOnCompleteListener { task -&gt;</span><span id="cdc9" class="mk jl in mg b gy mp mm l mn mo"><br/>    Log.e(“HANDHELD”, “Save &amp; prepare data to wearable -onComplete<br/>    listener-”)<br/></span><span id="ceec" class="mk jl in mg b gy mp mm l mn mo">    if (task.result != null) {<br/>        val dataMapItem =            DataMapItem.fromDataItem(task.result!!).dataMap<br/>    }</span><span id="c66e" class="mk jl in mg b gy mp mm l mn mo">}</span></pre><p id="4dfb" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">那么这部分代码是做什么的呢？</p><p id="0d91" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">初始化<strong class="kk io">数据客户端</strong>，我们能够使用<em class="me">数据地图</em>-映射变量将密钥和消息放入地图中，以发送到能够从目的地点获取该数据的可穿戴设备，用于任何天知道的原因/解决方案。</p><p id="e8f6" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">我们的数据映射将由<strong class="kk io"> putDataMapRequest </strong>作为<em class="me">数据请求</em>用<strong class="kk io"> setUrgent() </strong>函数处理，这意味着数据将被立即发送并且没有延迟(因为这通常发生在<strong class="kk io">非紧急数据项</strong>中)。<br/>然后，我们用<strong class="kk io"> addOnCompleteListener </strong>创建任务<strong class="kk io"> putDataTask </strong>来检查数据发送是否有效。此外，我们可以检查我们的<strong class="kk io">数据图</strong>是否包含我们计划发送给 Wearable 的数据。</p><p id="7074" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated"><strong class="kk io">注意！</strong>所有这些代码处理任何你喜欢的类，你应该在 Android 应用程序中创建(添加到清单等)。).更多与 Wear OS 相关的代码将在下一篇文章中披露，致力于 Wear OS 的使用。</p></div><div class="ab cl lx ly hr lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ig ih ii ij ik"><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/9d93f21bb753c6e4f62857060e35d1d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:394/format:webp/1*JKPLi-da-om2ENOnZAdmkQ.png"/></div></figure><p id="65ae" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">还有什么？我们需要在 Wear OS 应用程序中接收这些数据。</p><p id="601a" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">在穿戴端的任何类中，实现<strong class="kk io"> DataClient。OnDataChangedListener </strong>并覆盖<strong class="kk io"> onDataChanged() </strong>类:</p><pre class="lm ln lo lp gt mf mg mh mi aw mj bi"><span id="f68c" class="mk jl in mg b gy ml mm l mn mo">override fun onDataChanged(p0: DataEventBuffer) {<br/>     for (event in p0) {<br/>           if (event.getType() == DataEvent.TYPE_CHANGED) {<br/>                 val item = event.getDataItem()<br/>                 val uri = item.getUri()<br/>                 val path = uri.getPath()<br/>                 val nodeId = item.getUri().getAuthority()<br/>                 val dataItem = DataMapItem.fromDataItem(item)<br/>                 val dataMap = (dataItem as DataMapItem).dataMap</span><span id="014b" class="mk jl in mg b gy mp mm l mn mo">if (dataMap.getString("message_key") != null) {<br/>     if (dataMap.getString("message_key") == "hello_world") {</span><span id="7542" class="mk jl in mg b gy mp mm l mn mo">          finish()<br/>     }</span><span id="910c" class="mk jl in mg b gy mp mm l mn mo">else if (dataMap.getString("message_key") == "goodbye_world") {<br/>     finish()<br/>}</span><span id="9615" class="mk jl in mg b gy mp mm l mn mo">else{<br/>     finish()<br/>}<br/>}<br/>}<br/>}<br/>}</span></pre><p id="a494" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">使用起来也很简单。我们覆盖了<strong class="kk io"> onDataChanged() </strong>函数来检查事件是否发生在我们的可穿戴设备上及其类型，初始化与我们的<em class="me"> dataItem </em>相关的所有变量，从 Android 应用程序映射。</p><p id="6cdc" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">最后，通过<em class="me"> 'message_key' </em>检查我们的<strong class="kk io"> dataMap.getString() </strong>是否包含声明的字符串值:它是<em class="me"> "hello_world" </em>还是<em class="me"> "goodbye_world" </em>，以 finish()结束我们的 for 循环。</p></div><div class="ab cl lx ly hr lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ig ih ii ij ik"><p id="6558" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">想象一下，你需要从 Android 应用程序向 Wearable 发送你的步数、公里数、消息、到达你的手持应用程序的通知等。使用这个简单的方法，有很多想法可以发送到你的可穿戴设备上。</p><p id="f033" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">我之所以决定写这篇文章，是因为我要浏览几乎所有的代码行，来描述从哪里发送的内容以及发送到哪里的内容。对那些人来说，有时需要再读一遍才能明白。当然，这个教程在 developer.android.com 网站上也有介绍。尽管如此，我还是决定指向特定的地方，让读者和我的订阅者更喜欢它。希望你喜欢这篇小文章，如果你有任何问题，请在下面的评论中留下，我会尽我所能回答。祝你周末工作愉快！</p><p id="512e" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">原文链接，与 War OS 实现相关:<a class="ae mr" href="https://developer.android.com/training/wearables/get-started/creating" rel="noopener ugc nofollow" target="_blank">https://developer . Android . com/training/wearables/get-started/creating</a></p></div></div>    
</body>
</html>