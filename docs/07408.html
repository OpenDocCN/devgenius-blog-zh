<html>
<head>
<title>Android Jetpack Compose — Basic</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Android Jetpack 撰写-基本版</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/android-jetpack-compose-basic-b8972e86a049?source=collection_archive---------7-----------------------#2022-03-22">https://blog.devgenius.io/android-jetpack-compose-basic-b8972e86a049?source=collection_archive---------7-----------------------#2022-03-22</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><blockquote class="jk jl jm"><p id="e759" class="jn jo jp jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ig bi translated">Jetpack compose 是一个 UI 开发工具包，允许您构建声明性 UI 组件。</p></blockquote><p id="f6d3" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">在 android 中，所有视图都是树形结构。因此，每当发生任何用户事件或数据变化时，UI 层次结构都需要用最新的数据进行更新，这是一项非常昂贵的工作。</p><p id="211c" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">这就是为什么声明式 UI 是解决这个问题的高级 UI 构建解决方案。当数据更新时，Compose 智能地决定 UI 的哪个部分需要更新。</p><p id="73f1" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">使用 composable 函数构建一个 UI。您可以在函数上使用<code class="fe kp kq kr ks b">@Composable</code>注释来创建组合函数。当你声明一个函数是可组合的，编译器会理解这个函数需要把数据转换成 UI。</p><pre class="kt ku kv kw gt kx ks ky kz aw la bi"><span id="6616" class="lb lc in ks b gy ld le l lf lg">@Composable<br/>fun MessageCard(name: String) {<br/>    Text(text = "Hello $name!")<br/>}</span></pre><ul class=""><li id="391a" class="lh li in jq b jr js jv jw km lj kn lk ko ll kl lm ln lo lp bi translated">可组合函数应该将数据作为输入，函数实现会将数据转换成 UI。</li><li id="34cb" class="lh li in jq b jr lq jv lr km ls kn lt ko lu kl lm ln lo lp bi translated">可组合函数应该总是从大写字母开始。</li><li id="ceaf" class="lh li in jq b jr lq jv lr km ls kn lt ko lu kl lm ln lo lp bi translated">可组合函数不应返回任何内容。</li></ul><p id="d92c" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">如果您想预览您的组合 UI，那么您需要在可组合函数上添加<code class="fe kp kq kr ks b">@Preview</code>注释。</p><h2 id="0bd4" class="lb lc in bd lv lw lx dn ly lz ma dp mb km mc md me kn mf mg mh ko mi mj mk ml bi translated">合成中的数据流</h2><p id="52c4" class="pw-post-body-paragraph jn jo in jq b jr mm jt ju jv mn jx jy km mo kb kc kn mp kf kg ko mq kj kk kl ig bi translated">(1)用户事件</p><figure class="kt ku kv kw gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi mr"><img src="../Images/60bd60ad4ade9a7754873f6d30aad719.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3rnl1RzR1rS6pQfh.png"/></div></div></figure><p id="082e" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">当任何用户事件发生时，它将从底部的小部件(节点)通知到顶部的小部件。</p><p id="eb1f" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">(2)数据变更</p><figure class="kt ku kv kw gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi mr"><img src="../Images/868fe7ff3fd91928b9303664fcea1d7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*e00L4gM-KOM31QFt.png"/></div></div></figure><p id="790e" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">当数据库或从网络接收的数据发生变化时，新数据将从顶层小部件(节点)发送到底层小部件。</p><h2 id="21b4" class="lb lc in bd lv lw lx dn ly lz ma dp mb km mc md me kn mf mg mh ko mi mj mk ml bi translated">改编</h2><p id="5965" class="pw-post-body-paragraph jn jo in jq b jr mm jt ju jv mn jx jy km mo kb kc kn mp kf kg ko mq kj kk kl ig bi translated">在传统的 XML UI 视图中有一个 setter 方法，所以在数据发生变化时，可以使用 setter 方法来更新 UI 上的新数据。</p><p id="035c" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">在 Compose 中，要更新数据，需要用新数据再次调用 composable 函数，这被称为重组。在重组中，compose 智能地决定 UI 的哪个部分需要改变，而不是重绘整个 UI。</p><h2 id="eb2b" class="lb lc in bd lv lw lx dn ly lz ma dp mb km mc md me kn mf mg mh ko mi mj mk ml bi translated">组合函数行为</h2><p id="7f81" class="pw-post-body-paragraph jn jo in jq b jr mm jt ju jv mn jx jy km mo kb kc kn mp kf kg ko mq kj kk kl ig bi translated"><em class="jp"> (1)编写以任意顺序执行的函数</em></p><pre class="kt ku kv kw gt kx ks ky kz aw la bi"><span id="319f" class="lb lc in ks b gy ld le l lf lg">@Composable<br/>fun ButtonRow() {<br/>    MyHome {<br/>        Tab1Screen()<br/>        Tab2Screen()<br/>        Tab3Screen()<br/>    }<br/>}</span></pre><p id="edfe" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">这里，系统不保证组合函数将按 Tab1Screen()、Tab2Screen()、Tab3Screen()的顺序执行。</p><p id="8820" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">请不要犯类似于从 Tab1Screen 初始化变量并在 Tab2Screen()中使用它的错误。</p><p id="16e9" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated"><em class="jp"> (2)作曲功能可以并行运行</em></p><p id="eb3d" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">优化重组 android 系统并行运行合成函数。因此，compose 函数可能在线程池的不同线程中执行。在这种情况下，如果您正在调用 ViewModel 的函数，那么请确保从多个线程执行是线程安全的。</p><p id="e25d" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated"><em class="jp"> (3)重组尽可能跳过</em></p><p id="c2e4" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">在重组过程中，它只重组被更新的特定部分。</p><figure class="kt ku kv kw gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi mz"><img src="../Images/414f18debb8d869edf486081d6f37550.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wdKdS9Ltz8IMdZWSNn8NnA.png"/></div></div></figure><p id="20d1" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated"><em class="jp"> (4)重组乐观</em></p><p id="217c" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">重组是乐观的，意味着组合函数期望它应该在值再次改变和重组发生之前被执行。如果重组正在进行，并且在其完成之前，如果新值改变，则重组被取消，并且用新值开始重组。</p><p id="5329" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">(5)可组合的函数可能会非常频繁地运行</p><p id="36a9" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">在某些可能的情况下，compose 函数运行得过于频繁，所以请确保不要在 compose 函数上执行任何 CPU 密集型工作(在单独的线程上执行)。</p><h2 id="bf5c" class="lb lc in bd lv lw lx dn ly lz ma dp mb km mc md me kn mf mg mh ko mi mj mk ml bi translated">行列</h2><p id="c606" class="pw-post-body-paragraph jn jo in jq b jr mm jt ju jv mn jx jy km mo kb kc kn mp kf kg ko mq kj kk kl ig bi translated">在 jetpack compose 中，您可以在行(水平)和列(垂直)中排列可组合 UI 元素。</p><figure class="kt ku kv kw gt ms"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="kt ku kv kw gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nc"><img src="../Images/0aed7fb929853e009fda6170bbafad65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m12sc66pKLBf_vIuxyZb6Q.png"/></div></div></figure><p id="0e75" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">如果将合成布局与 XML 布局进行比较，那么</p><figure class="kt ku kv kw gt ms gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/77023ddf691a2c760b59037d3df84717.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*C7L2IY2Co52veUtOFoo8GA.png"/></div></figure><figure class="kt ku kv kw gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ne"><img src="../Images/a6bfdcc2c0eb8d64d7f3738d28489ef4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HVtVOE1XD_Bm2j0s.png"/></div></div></figure><h2 id="3be5" class="lb lc in bd lv lw lx dn ly lz ma dp mb km mc md me kn mf mg mh ko mi mj mk ml bi translated"><strong class="ak">修改器</strong></h2><p id="6feb" class="pw-post-body-paragraph jn jo in jq b jr mm jt ju jv mn jx jy km mo kb kc kn mp kf kg ko mq kj kk kl ig bi translated">现在，如果你想改变可组合 UI 元素的属性，比如大小、形状、填充等等。在那里你可以使用修饰语。</p><figure class="kt ku kv kw gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nf"><img src="../Images/c063a7da9fd916e57a6b76f3290ad834.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9LoSxYr_Eqx9K7EXawZE2Q.png"/></div></div></figure><figure class="kt ku kv kw gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ng"><img src="../Images/82c9c113680da399112065cb1003f4b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W4ycfE02Nx_-u2stcF9m9w.png"/></div></div></figure><p id="8438" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">形状、颜色和字体是材料设计的三个基本支柱。在修改器的帮助下，你可以改变这个属性，美化 UI。</p><figure class="kt ku kv kw gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi mz"><img src="../Images/27b38338f4e675f5558615806d33453c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ycxlgOREYUk-LjFmTRs95w.png"/></div></div></figure><figure class="kt ku kv kw gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nh"><img src="../Images/4e5bd7f9f83b9c71ff03d7d037245e41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wqqrM-_RgrQOsR81Wd2NzQ.png"/></div></div></figure><p id="44f2" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">在下一个即将到来的系列中，我们将继续学习一些关于 Android Jetpack Compose 的新知识。</p></div></div>    
</body>
</html>