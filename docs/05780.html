<html>
<head>
<title>How to Read Excel Files Using Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用熊猫阅读 Excel 文件</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/reading-excel-files-with-pandas-the-basics-6a6be9cc8763?source=collection_archive---------1-----------------------#2021-10-27">https://blog.devgenius.io/reading-excel-files-with-pandas-the-basics-6a6be9cc8763?source=collection_archive---------1-----------------------#2021-10-27</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="dc72" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">关于如何使用熊猫阅读 Excel 文件的指南。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/8921b25fcc5b5961b81bdf3bc0e05b2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8pw3vuU7qzS7p4qxNvB-8g.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">照片由<a class="ae ks" href="https://pixabay.com/users/myrfa-3126475/" rel="noopener ugc nofollow" target="_blank">米尔法</a>从<a class="ae ks" href="https://pixabay.com/" rel="noopener ugc nofollow" target="_blank">皮克斯拜</a>拍摄</figcaption></figure><p id="a34b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">读写文件通常是你需要在编码中能够执行的基本过程之一。读取数据——假设这次是在 Excel 中——相当简单，但是，在不太理想的情况下，一些细节可能会派上用场。</p><p id="7698" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">鉴于您正在读入数据以进行进一步操作，我们将使用<strong class="kv io"> Pandas </strong>来完成这项任务。这听起来可能是一个很大的假设，但是从 Excel 文件中读取数据以便对其不做任何事情的人相对较少。我抓住机会，你不是其中之一。</p><p id="c17d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们开始吧:这是您想要阅读的文件:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi lp"><img src="../Images/0459647aa8a80f2035ec4f177b7b5411.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GRUsMPUhq89giVfD"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">作者截图</figcaption></figure><p id="ca81" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我给你的不是一个大的，但是更多的数据不适合截图。在不同的文件扩展名中有不同的读取方法，在我们的例子中，我使用的是 XLSX 文件，它需要 pandas 的<code class="fe lq lr ls lt b">read_excel()</code>方法。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi lu"><img src="../Images/6aad7081bc56929043d0e6a7a6aece32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mfEKkVkNFbGOwRZj"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">作者截图</figcaption></figure><p id="d2e6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">非常有效——现在您的数据被加载到 DataFrame 对象中。通常这就是全部了——你给出一个文件名(和路径，以防它和你的脚本不在同一个目录中),读取文件，然后开始。棘手的是，当你不得不使用任何参数时，就像我对“引擎”所做的那样——你注意到了吗？</p><p id="8e8e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">小故事:<strong class="kv io"> XLRD </strong>是熊猫读取 Excel 文件的默认引擎，碰巧<strong class="kv io"> XLRD </strong>停止支持 XLSX 文件。如果你想读一个，你需要 pip 安装<strong class="kv io"> openpyxl </strong>，并设置它为阅读引擎而不是默认的。</p><p id="5815" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们看看其他一些参数，看看它们能做什么(完整文档请访问<a class="ae ks" href="https://pandas.pydata.org/docs/reference/api/pandas.read_excel.html" rel="noopener ugc nofollow" target="_blank">文档</a>)！</p><blockquote class="lv lw lx"><p id="00a9" class="kt ku ly kv b kw kx jo ky kz la jr lb lz ld le lf ma lh li lj mb ll lm ln lo ig bi translated">如果你想让我保持咖啡因创造更多这样的内容，请考虑支持我，只要一杯咖啡。</p></blockquote><figure class="kd ke kf kg gt kh gh gi paragraph-image"><a href="https://buymeacoffee.com/zoltanguba2"><div class="gh gi mc"><img src="../Images/42de2d890e13d488021d94ea1a1b9877.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*SMZM9K5hha91xzFtSBS88Q.png"/></div></a></figure><h2 id="2444" class="md me in bd mf mg mh dn mi mj mk dp ml lc mm mn mo lg mp mq mr lk ms mt mu mv bi translated"><strong class="ak">工作表名称</strong></h2><p id="af9c" class="pw-post-body-paragraph kt ku in kv b kw mw jo ky kz mx jr lb lc my le lf lg mz li lj lk na lm ln lo ig bi translated">默认情况下，如果有多个工作表，pandas 将读取文件的第一个工作表:如果您想选择另一个工作表，您可以提供工作表的索引(当然从 0 开始)，或者以字符串形式提供工作表名称。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nb"><img src="../Images/2e45548df4704fbaf4b26c3c859a9fcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*C0sEO_HR3MXYPru4"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">作者截图</figcaption></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nc"><img src="../Images/a168a71bf0e91baabd601512ff8a6957.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lcW8QI4oJsKA_xC_"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">作者截图</figcaption></figure><p id="1bc8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">请注意，您可以提供一个表名/索引列表来读取多个表，在这种情况下，返回值将是一个字典，键是表名/索引。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nd"><img src="../Images/3187d91896f436f931db4efeefb74ff1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*x6j2PKv54Kjk4l0G"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">作者截图</figcaption></figure><h2 id="fc6d" class="md me in bd mf mg mh dn mi mj mk dp ml lc mm mn mo lg mp mq mr lk ms mt mu mv bi translated"><strong class="ak">表头</strong></h2><p id="e4a8" class="pw-post-body-paragraph kt ku in kv b kw mw jo ky kz mx jr lb lc my le lf lg mz li lj lk na lm ln lo ig bi translated">如果您的数据碰巧在第一行之外的某个地方有标题行，您当然可以指定它的位置。如果没有，应该加上 none，并在下一个参数中指定(理想情况下)列名，<strong class="kv io"> names </strong>。</p><h2 id="5d9d" class="md me in bd mf mg mh dn mi mj mk dp ml lc mm mn mo lg mp mq mr lk ms mt mu mv bi translated"><strong class="ak">名字</strong></h2><p id="59a4" class="pw-post-body-paragraph kt ku in kv b kw mw jo ky kz mx jr lb lc my le lf lg mz li lj lk na lm ln lo ig bi translated">您可以在此列出列的名称。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ne"><img src="../Images/2ade61bd1e1d4219392968d831178faa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yPzY0ZDtGZzC0StP"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">作者截图</figcaption></figure><h2 id="935b" class="md me in bd mf mg mh dn mi mj mk dp ml lc mm mn mo lg mp mq mr lk ms mt mu mv bi translated"><strong class="ak">用途</strong></h2><p id="44fb" class="pw-post-body-paragraph kt ku in kv b kw mw jo ky kz mx jr lb lc my le lf lg mz li lj lk na lm ln lo ig bi translated">尽管将数据帧缩小到比最初加载的列数更少是相当容易的，但是如果输入中有很多列，并且事先知道不会用到很多列，则应该使用“usecols”参数来提供希望在数据帧中使用的列。您有多种选择:</p><ul class=""><li id="dde8" class="nf ng in kv b kw kx kz la lc nh lg ni lk nj lo nk nl nm nn bi translated">以字符串形式提供 Excel 列字母，可以是逗号分隔的(如果有多个)，也可以是一个范围，例如“A，B，C”，(“A:C”)，</li><li id="359f" class="nf ng in kv b kw no kz np lc nq lg nr lk ns lo nk nl nm nn bi translated">列的索引列表，例如[1，2，4]，</li><li id="304f" class="nf ng in kv b kw no kz np lc nq lg nr lk ns lo nk nl nm nn bi translated">列名列表，例如[“字符 ID”、“字符名称”、“房屋”]，</li><li id="f1e1" class="nf ng in kv b kw no kz np lc nq lg nr lk ns lo nk nl nm nn bi translated">一个可调用的，遍历列名并返回评估为 True 的列名，</li><li id="28f2" class="nf ng in kv b kw no kz np lc nq lg nr lk ns lo nk nl nm nn bi translated">如果没有，所有列都将包含在数据框架中。</li></ul><h2 id="2b06" class="md me in bd mf mg mh dn mi mj mk dp ml lc mm mn mo lg mp mq mr lk ms mt mu mv bi translated"><strong class="ak"> nrows </strong></h2><p id="6776" class="pw-post-body-paragraph kt ku in kv b kw mw jo ky kz mx jr lb lc my le lf lg mz li lj lk na lm ln lo ig bi translated">在数据帧中只包含某些行。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nt"><img src="../Images/0e54c87f3649cc6a277e32c9bd18843a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Z4ADtJ1hpyfc-DD2"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">作者截图</figcaption></figure><h2 id="9577" class="md me in bd mf mg mh dn mi mj mk dp ml lc mm mn mo lg mp mq mr lk ms mt mu mv bi translated"><strong class="ak"> skipfooter </strong></h2><p id="e66b" class="pw-post-body-paragraph kt ku in kv b kw mw jo ky kz mx jr lb lc my le lf lg mz li lj lk na lm ln lo ig bi translated">您可以提供要从数据集末尾截断的行数。</p></div><div class="ab cl nu nv hr nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="ig ih ii ij ik"><p id="81ec" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">当然，您可以使用更多的选项，首先，我认为这些选项最有可能在您最初的几次文件读取练习中派上用场。请务必阅读<a class="ae ks" href="https://pandas.pydata.org/docs/reference/api/pandas.read_excel.html" rel="noopener ugc nofollow" target="_blank">文档</a>了解更多细节，一般来说也是如此——你肯定能学到很多东西。</p><p id="2dda" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在你知道了。感谢您的阅读。</p><p id="037b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="ly">更多内容请看</em><a class="ae ks" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="ly">plain English . io</em></a><em class="ly">。报名参加我们的</em> <a class="ae ks" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <em class="ly">免费周报在这里</em> </a> <em class="ly">。</em></p></div></div>    
</body>
</html>