<html>
<head>
<title>Create a React Filled Line Graph with the Visx Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Visx库创建一个反应填充线图</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/create-a-react-filled-line-graph-with-the-visx-library-8c9e0907ed76?source=collection_archive---------3-----------------------#2021-03-12">https://blog.devgenius.io/create-a-react-filled-line-graph-with-the-visx-library-8c9e0907ed76?source=collection_archive---------3-----------------------#2021-03-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/776d2948687c4fd2fc74d945da9f1028.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rLa9c2QL1r2DWezb"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://unsplash.com/@ninjason?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Jason Leung </a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="36b5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Visx是一个库，让我们可以轻松地将图形添加到React应用程序中。</p><p id="5429" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解如何使用它将填充线图添加到React应用程序中。</p><h1 id="bd3b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">入门指南</h1><p id="3d62" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">首先，我们必须安装Visx提供的几个模块。,</p><p id="d745" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了安装条形图所需的，我们运行:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="e8c7" class="mn lc iq mj b gy mo mp l mq mr">$ npm install --save @visx/axis @visx/curve @visx/gradient @visx/grid @visx/group @visx/mock-data @visx/react-spring @visx/responsive @visx/shape @visx/scale</span></pre><p id="21f0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">@visx/mock-data</code>库有模拟数据，我们可以在条形图中使用。</p><h1 id="fd07" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">添加填充线图</h1><p id="81bb" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">要添加填充线图，我们写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="01fa" class="mn lc iq mj b gy mo mp l mq mr">import React, { useState, useMemo } from "react";<br/>import AreaClosed from "@visx/shape/lib/shapes/AreaClosed";<br/>import { curveMonotoneX } from "@visx/curve";<br/>import {<br/>  scaleUtc,<br/>  scaleLinear,<br/>  scaleLog,<br/>  scaleBand,<br/>  coerceNumber<br/>} from "@visx/scale";<br/>import { Orientation } from "@visx/axis";<br/>import {<br/>  AnimatedAxis,<br/>  AnimatedGridRows,<br/>  AnimatedGridColumns<br/>} from "@visx/react-spring";<br/>import { LinearGradient } from "@visx/gradient";<br/>import { timeFormat } from "d3-time-format";</span><span id="68ce" class="mn lc iq mj b gy mv mp l mq mr">export const backgroundColor = "#da7cff";<br/>const axisColor = "#fff";<br/>const tickLabelColor = "#fff";<br/>export const labelColor = "#340098";<br/>const gridColor = "#6e0fca";<br/>const margin = {<br/>  top: 40,<br/>  right: 150,<br/>  bottom: 20,<br/>  left: 50<br/>};</span><span id="7bb6" class="mn lc iq mj b gy mv mp l mq mr">const tickLabelProps = () =&gt; ({<br/>  fill: tickLabelColor,<br/>  fontSize: 12,<br/>  fontFamily: "sans-serif",<br/>  textAnchor: "middle"<br/>});</span><span id="60cb" class="mn lc iq mj b gy mv mp l mq mr">const getMinMax = (vals) =&gt; {<br/>  const numericVals = vals.map(coerceNumber);<br/>  return [Math.min(...numericVals), Math.max(...numericVals)];<br/>};</span><span id="cf1b" class="mn lc iq mj b gy mv mp l mq mr">function Example({<br/>  width: outerWidth = 800,<br/>  height: outerHeight = 800,<br/>  showControls = true<br/>}) {<br/>  const width = outerWidth - margin.left - margin.right;<br/>  const height = outerHeight - margin.top - margin.bottom;<br/>  const [dataToggle] = useState(true);<br/>  const [animationTrajectory] = useState("center");</span><span id="06c0" class="mn lc iq mj b gy mv mp l mq mr">  const axes = useMemo(() =&gt; {<br/>    const linearValues = dataToggle ? [0, 2, 4, 6, 8, 10] : [6, 8, 10, 12];</span><span id="9e0e" class="mn lc iq mj b gy mv mp l mq mr">  return [<br/>      {<br/>        scale: scaleLinear({<br/>          domain: getMinMax(linearValues),<br/>          range: [0, width]<br/>        }),<br/>        values: linearValues,<br/>        tickFormat: (v, index, ticks) =&gt;<br/>          index === 0<br/>            ? "first"<br/>            : index === ticks[ticks.length - 1].index<br/>            ? "last"<br/>            : `${v}`,<br/>        label: "linear"<br/>      }<br/>    ];<br/>  }, [dataToggle, width]);</span><span id="54f0" class="mn lc iq mj b gy mv mp l mq mr">  if (width &lt; 10) return null;</span><span id="65f2" class="mn lc iq mj b gy mv mp l mq mr">  const scalePadding = 40;<br/>  const scaleHeight = height / axes.length - scalePadding;</span><span id="595e" class="mn lc iq mj b gy mv mp l mq mr">  const yScale = scaleLinear({<br/>    domain: [100, 0],<br/>    range: [scaleHeight, 0]<br/>  });</span><span id="56c3" class="mn lc iq mj b gy mv mp l mq mr">  return (<br/>    &lt;&gt;<br/>      &lt;svg width={outerWidth} height={outerHeight}&gt;<br/>        &lt;LinearGradient<br/>          id="visx-axis-gradient"<br/>          from={backgroundColor}<br/>          to={backgroundColor}<br/>          toOpacity={0.5}<br/>        /&gt;<br/>        &lt;rect<br/>          x={0}<br/>          y={0}<br/>          width={outerWidth}<br/>          height={outerHeight}<br/>          fill={"url(#visx-axis-gradient)"}<br/>          rx={14}<br/>        /&gt;<br/>        &lt;g transform={`translate(${margin.left},${margin.top})`}&gt;<br/>          {axes.map(({ scale, values, label, tickFormat }, i) =&gt; (<br/>            &lt;g<br/>              key={`scale-${i}`}<br/>              transform={`translate(0, ${i * (scaleHeight + scalePadding)})`}<br/>            &gt;<br/>              &lt;AnimatedGridRows<br/>                key={`gridrows-${animationTrajectory}`}<br/>                scale={yScale}<br/>                stroke={gridColor}<br/>                width={width}<br/>                numTicks={dataToggle ? 1 : 3}<br/>                animationTrajectory={animationTrajectory}<br/>              /&gt;<br/>              &lt;AnimatedGridColumns<br/>                key={`gridcolumns-${animationTrajectory}`}<br/>                scale={scale}<br/>                stroke={gridColor}<br/>                height={scaleHeight}<br/>                numTicks={dataToggle ? 5 : 2}<br/>                animationTrajectory={animationTrajectory}<br/>              /&gt;<br/>              &lt;AreaClosed<br/>                data={values.map((x) =&gt; [<br/>                  (scale(x) ?? 0) +<br/>                    ("bandwidth" in scale &amp;&amp;<br/>                    typeof scale.bandwidth !== "undefined"<br/>                      ? scale.bandwidth() / 2<br/>                      : 0),<br/>                  yScale(10 + Math.random() * 90)<br/>                ])}<br/>                yScale={yScale}<br/>                curve={curveMonotoneX}<br/>                fill={gridColor}<br/>                fillOpacity={0.2}<br/>              /&gt;<br/>              &lt;AnimatedAxis<br/>                key={`axis-${animationTrajectory}`}<br/>                orientation={Orientation.bottom}<br/>                top={scaleHeight}<br/>                scale={scale}<br/>                tickFormat={tickFormat}<br/>                stroke={axisColor}<br/>                tickStroke={axisColor}<br/>                tickLabelProps={tickLabelProps}<br/>                tickValues={<br/>                  label === "log" || label === "time" ? undefined : values<br/>                }<br/>                numTicks={label === "time" ? 6 : undefined}<br/>                label={label}<br/>                labelProps={{<br/>                  x: width + 30,<br/>                  y: -10,<br/>                  fill: labelColor,<br/>                  fontSize: 18,<br/>                  strokeWidth: 0,<br/>                  stroke: "#fff",<br/>                  paintOrder: "stroke",<br/>                  fontFamily: "sans-serif",<br/>                  textAnchor: "start"<br/>                }}<br/>                animationTrajectory={animationTrajectory}<br/>              /&gt;<br/>            &lt;/g&gt;<br/>          ))}<br/>        &lt;/g&gt;<br/>      &lt;/svg&gt;<br/>    &lt;/&gt;<br/>  );<br/>}</span><span id="5c75" class="mn lc iq mj b gy mv mp l mq mr">export default function App() {<br/>  return (<br/>    &lt;div&gt;<br/>      &lt;Example width="500" height="300" /&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="e9f9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们添加了<code class="fe ms mt mu mj b">backgroundColor</code>来设置背景颜色。</p><p id="bcc9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">axisColor</code>有轴色。</p><p id="cc92" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">tickLabelColor</code>具有x轴刻度标签的颜色。</p><p id="4ea1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">labelColor</code>具有y轴标签颜色。</p><p id="b65d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">gridColor</code>有网格颜色。</p><p id="a2b1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe ms mt mu mj b">tickLabelProps</code>功能改变文本样式。</p><p id="e7be" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了添加图表内容，我们添加了<code class="fe ms mt mu mj b">axes</code>数组。</p><p id="63a3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们从<code class="fe ms mt mu mj b">dataToggle</code>对象计算图形的值。</p><p id="fb2b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">linearValues</code>有线性刻度值。</p><p id="e0ee" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe ms mt mu mj b">yScale</code>对象来添加y轴值。</p><p id="40d9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们返回的JSX中，我们添加了SVG，<code class="fe ms mt mu mj b">rect</code> rectangle元素，然后在<code class="fe ms mt mu mj b">axes.map</code>回调中，我们返回图形。</p><p id="5aba" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">图中有一个包含SVG组的<code class="fe ms mt mu mj b">g</code>元素。</p><p id="20cc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">AnimatedGridRows</code>具有动画网格行。</p><p id="ec88" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将<code class="fe ms mt mu mj b">yScale</code>值传递给它来显示y值。</p><p id="a582" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">stroke</code>设定冲程。</p><p id="267b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">width</code>设置宽度。</p><p id="559a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">AnimatedGridColumns</code>有网格列。</p><p id="fbef" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">numTicks</code>让我们设置x轴上的刻度数。</p><p id="d7ad" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用类似的代码用<code class="fe ms mt mu mj b">AnimatedGridColumns</code>组件来添加列。</p><p id="bbcc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">AreaClosed</code>有填充线图。</p><p id="4fdd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">AnimatedAxis</code>具有动画x轴。</p><p id="015f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe ms mt mu mj b">labelProps</code>设置标签样式。</p><p id="b5b4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">tickValues</code>有刻度值。</p><h1 id="0e2b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="1980" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用Visx在React应用程序中添加填充线图。</p></div></div>    
</body>
</html>