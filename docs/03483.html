<html>
<head>
<title>How to Create a Youtube downloader with Javascript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用 Javascript 创建 Youtube 下载器</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/creating-youtube-downloader-in-javascript-5b7e20215271?source=collection_archive---------0-----------------------#2020-11-10">https://blog.devgenius.io/creating-youtube-downloader-in-javascript-5b7e20215271?source=collection_archive---------0-----------------------#2020-11-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/19a7b5633214b1853c05b20528fa6c2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*m4wai9Vqhl5822_X"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">由<a class="ae kc" href="https://unsplash.com/@cardmapr?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> CardMapr </a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><p id="508c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Youtube 是当今最著名的视频流媒体网站，甚至世界上 98%的人都在使用 youtube，甚至安卓手机也内置了谷歌安装的 youtube。我认为这是事实，youtube 是谷歌最受欢迎的产品，让我们转移到今天的话题，JavaScript 的 Youtube 下载器。因此，我们将通过如何开发一个 youtube 下载器来下载你的计算机上的任何 youtube 视频或播放列表，我们可以使用任何编程语言来编写这个 python，C++甚至 java。但是我喜欢 JavaScript，所以我会继续使用它，好吧，不浪费时间，让我们直接开始编码。我们需要 NodeJs 来编译 JavaScript 代码，如果您已经安装了 NodeJs，那么您可以转到库安装部分，或者不只是下载最新版本的 NodeJs 并将其安装在您的 windows、Linux 或任何操作系统上。接下来我们需要一个 JavaScript 模块名为<strong class="kf ir"> <em class="lb"> youtube-dl，</em> </strong> <em class="lb"> </em>复制下面的命令并粘贴到命令提示符中。</p><p id="718f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lc ld le lf b"><em class="lb">npm i youtube-dl</em></code></p><h1 id="b178" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated"><strong class="ak">编码部分</strong></h1><p id="2c21" class="pw-post-body-paragraph kd ke iq kf b kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw mi ky kz la ij bi translated">创建一个 youtube.js 文件并在代码编辑器中打开它，让我们从在脚本中导入 youtube-dl 库开始。</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="7cba" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第一行，我们在常量变量 fs 中加载 fs 模块，该模块主要用于读写视频文件，下一行，我们在常量变量 youtube-dl 中加载我们的主模块。加载完所需的模块后，我们只需使用 youtubedl()函数，在该函数中我们传递 youtube 视频的 URL 和格式。注意，我们将格式编号设置为 18，即 320p mp4 格式，如果您想在 youtube 视频中设置高清格式或您喜欢的任何格式，请访问<em class="lb"/><a class="ae kc" href="https://gist.github.com/sidneys/7095afe4da4ae58694d128b1034e01e2" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir"><em class="lb">YouTube _ format _ number</em></strong></a><strong class="kf ir">。</strong>让我们移动到程序的另一部分，正在下载视频检查下面的代码。</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="b3e5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你注意到了，在第 4 行我们将<strong class="kf ir"> <em class="lb"> youtubedl() </em> </strong>保存在常量视频变量中，而在第 10 行我们使用该视频变量来调用函数 info。下一行使用 javascript console.log 函数在命令提示符下输出 youtube 信息。上次我们使用 fs 模块以 mp4 格式编写我们的文件，如果你看到我们使用<strong class="kf ir"> <em class="lb"> video.pipe </em> </strong>函数和<strong class="kf ir"><em class="lb">fs . createwrtierstream</em></strong>一起下载我们的视频。Video.pipe 只是以编码形式给出视频数据，fs 函数会将视频转换为 mp4 格式并保存到您的 PC 上。</p><h1 id="f0e8" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">下载播放列表</h1><p id="0e85" class="pw-post-body-paragraph kd ke iq kf b kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw mi ky kz la ij bi translated">第一部分非常容易开发，我们的下载器将面临的下一个挑战是下载一个带有<em class="lb"/><strong class="kf ir"><em class="lb">YouTube _ dl</em></strong>的播放列表。让我们开始开发下载整个播放列表的 javascript 代码，我们将再次使用相同的模块来检查下面的代码。</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="2f16" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如您看到的代码，我们刚刚创建了一个名为 playlist 的函数，并传递参数“URL”，现在该 URL 将是我们要传递的播放列表 URL，接下来我们使用<code class="fe lc ld le lf b"><em class="lb">youtubedl()</em></code>函数将其存储在 video 变量中，在下一行中，我们使用 video.on()函数(实际上是 youtubedl 函数)定义了一个错误处理程序。在该函数中，如果我们的程序在运行时出现任何错误或 bug，程序将返回 console.log 函数，说明错误并告知发生的错误类型。从第 14 行到第 19 行，如果你已经看到我们正在使用 video.on()函数，在这个函数中，我们将播放列表的大小信息存储在 size 变量中，然后<code class="fe lc ld le lf b"><strong class="kf ir"><em class="lb">path.join(__dirname + ‘/’, size + ‘.mp4’)</em></strong><em class="lb"> </em></code>将定义一个 size.mp4 视频大小，它将被我们从中获取的大小信息所替换。size()和下一行我们使用 fs 流模块在 javascript 文件所在的目录中输出我们的播放列表视频。从第 21 行到第 31 行，我们实际上在命令行上打印了一些东西，没错，我们让移动条与您在一些软件安装中看到的一样，移动条向右移动，告诉他们安装完成的百分比，但在这种情况下，我们使用它来告诉有多少视频数据被下载。我们使用 stdout()来制作这个 bar，它是 javascript 的一个内置函数。</p><h1 id="4949" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated"><strong class="ak">获取视频信息</strong></h1><p id="4824" class="pw-post-body-paragraph kd ke iq kf b kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw mi ky kz la ij bi translated">我们将进一步探索 youtube_dl 库，让我们开发一个 javascript 代码，它将在命令提示符下打印出视频信息。</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="a318" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第一件事首先需要(" youtube_dl ")在我们的 js 文件中加载库下一行我们使用可选参数(如果你不想的话可以忽略它)这个参数在 youtube 中保存你的登录细节。下一行是 youtube_dl 的新函数，我们正在使用 getInfo()，该函数接受 URL，选项参数，一个指示错误消息的函数，if(err)throw err JavaScript 条件，我们正在检查如果出现错误，只需抛出它并停止程序，否则移动到 if 条件体，该条件体使用 console.log 函数打印我们的视频信息。</p><h1 id="57ce" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated"><strong class="ak">使用代理:</strong></h1><p id="0e32" class="pw-post-body-paragraph kd ke iq kf b kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw mi ky kz la ij bi translated">有时，youtube 视频仅限于特定国家，因此为了避免这种情况，我们将在 youtubedl()函数中使用可选的代理参数，只需将代理和端口号作为参数与 youtube 视频 URL 一起传递。如果你检查下面的代码，你会更。</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><h1 id="0012" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">下载字幕</h1><p id="2c14" class="pw-post-body-paragraph kd ke iq kf b kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw mi ky kz la ij bi translated">当你的母语不是这种特定语言时，字幕是非常有用的，youtube 视频有视频上传者编辑的多个字幕，我们只下载视频而不下载字幕是不好的，youtube_dl 模块有一些下载视频字幕的功能。</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="42d8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们分解代码，了解其中发生了什么，像往常一样，第一步是在 Js 文件中加载模块接下来我们创建一个 URL 常量变量，在其中传递一个 youtube 视频 URL，然后我们创建 options 变量，保存 youtubedl()函数的可选参数，如果您注意到我在每个参数后添加了注释，如果您选中 format 是 ttml，您可以将其设置为 vtt， 两者都是字幕文件的格式接下来我们可以定义目录名(你可以在这里添加目录路径)，最后，我们调用 youtubedl()函数 getsubs()传递所有参数。</p><p id="41e5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们刚刚创建了一个很棒的 javascript youtube 下载器，你可以在 web 应用程序或任何基于 javascript 的应用程序中使用该代码，也可以在你的网站上使用。希望这篇文章有一天能帮到你。请随意分享你的观点。</p></div></div>    
</body>
</html>