<html>
<head>
<title>How To Convert Date Format in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在 R 中转换日期格式</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/r-for-haters-how-to-convert-date-format-50583214e1c8?source=collection_archive---------5-----------------------#2022-12-15">https://blog.devgenius.io/r-for-haters-how-to-convert-date-format-50583214e1c8?source=collection_archive---------5-----------------------#2022-12-15</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="eef4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">最近，我参与了多个项目，包括数据集中的日期时间字段。很多时候我需要把日期时间转换成<strong class="jm io"> ISO 8601 日期格式</strong>(例如:<code class="fe ki kj kk kl b"><strong class="jm io">YYYY-MM-DD</strong></code>)。我一直在处理的日期字段来自各种类型。特别是，当将多个数据集连接在一起时，当这些格式不一致时，可能会引入<code class="fe ki kj kk kl b"><strong class="jm io">NA </strong></code>值。此外，我无法计算持续时间或创建以文本形式存储日期字段的图表。当我的工作量变慢的时候，手动整理永远不会是问题。但是你需要从长远考虑，每次你手动清理这些字段都会增加大量的时间。作为数据分析师，我们还有其他优先事项要完成。出于这个原因，我喜欢在处理<strong class="jm io">日期时间格式</strong>时分享一些想法和见解，以便我们可以提高工作效率。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/cd514f15d152694d273f857036f3d655.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MrKuIUzr2XMk62OAb-WQ5A.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">如何在 R 中转换日期格式</figcaption></figure></div><div class="ab cl lc ld hr le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ig ih ii ij ik"><p id="b68f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在从事大型项目时，我们经常从不同的来源收集数据。这解释了为什么在很多情况下，即使相同的字段也有不同的格式。由于这种不一致性，data analyst 无法加快数据清理过程。我注意到很多次日期字段被存储为文本、数字或一堆不同的格式。</p><p id="ae64" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一些流行的日期格式类型:</p><ul class=""><li id="d7ec" class="lj lk in jm b jn jo jr js jv ll jz lm kd ln kh lo lp lq lr bi translated"><code class="fe ki kj kk kl b"><strong class="jm io">MM/DD/YYYY</strong> (12/24/1990)</code></li><li id="ba43" class="lj lk in jm b jn ls jr lt jv lu jz lv kd lw kh lo lp lq lr bi translated"><code class="fe ki kj kk kl b"><strong class="jm io">DD/MM/YYYY</strong> (24/12/1990)</code></li><li id="036d" class="lj lk in jm b jn ls jr lt jv lu jz lv kd lw kh lo lp lq lr bi translated"><code class="fe ki kj kk kl b"><strong class="jm io">YYYY/MM/DD</strong> (1990/12/24)</code></li></ul><p id="95af" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">点击 了解更多不同日期时间格式<a class="ae lx" href="https://www.ibm.com/docs/en/cmofz/10.1.0?topic=SSQHWE_10.1.0/com.ibm.ondemand.mp.doc/arsa0257.htm" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io">。</strong></a></p><p id="b5d6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">浏览完这些格式后，现在您对数据集中的日期字段会是什么样子有了更好的了解。要从一种格式转换成另一种格式，我们需要告诉计算机正确的方式。如果我们没有正确地指定，结果可能与我们的预期完全不同。我们如何告诉计算机我们到底想要什么？</p><p id="3543" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">日期格式汇总表</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ly"><img src="../Images/ab01d06e621e59e82a5c2eccfead68b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vXZh2NyUHFBuTpaFZOh2Ow.png"/></div></div></figure><p id="0238" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">还有很多，但我只是在这里得到一些。如果我们有日期作为<code class="fe ki kj kk kl b"><strong class="jm io">2022–12–24</strong></code>，计算机理解它是<code class="fe ki kj kk kl b"><strong class="jm io">%Y-%m-%d</strong></code>格式。同样，<code class="fe ki kj kk kl b"><strong class="jm io">24 Dec 2022</strong></code>，电脑消化为<code class="fe ki kj kk kl b"><strong class="jm io">%d %b %Y</strong></code> <strong class="jm io"> </strong>(中间有空格)。这里重要的是<strong class="jm io">符号</strong>，分隔符可以是<strong class="jm io">破折号</strong> (-)、<strong class="jm io">空格</strong>()、<strong class="jm io">正斜杠</strong> (/)等等。</p></div><div class="ab cl lc ld hr le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ig ih ii ij ik"><h1 id="0906" class="lz ma in bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">场景 1</h1><p id="ffce" class="pw-post-body-paragraph jk jl in jm b jn mx jp jq jr my jt ju jv mz jx jy jz na kb kc kd nb kf kg kh ig bi translated">让我们仔细看看一个具体的例子。我有一个如下格式的数据集，我想把<strong class="jm io">生日</strong>列转换成我的计算机系统格式(<code class="fe ki kj kk kl b"><strong class="jm io">YYYY-MM-DD</strong></code>，我们该怎么做？</p><pre class="kn ko kp kq gt nc kl nd bn ne nf bi"><span id="597c" class="ng ma in kl b be nh ni l nj nk">library(dplyr)<br/>df &lt;- data.frame(BIRTHDAY = c("24/12/1990", "01/07/1980"))</span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/53956b08a3389e94ebc2e5f33130b4ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:456/format:webp/1*INw7Hq9E7W-lA4SRkQZydg.png"/></div></figure><p id="b32b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">您可以使用<code class="fe ki kj kk kl b"><strong class="jm io">as.Date() </strong></code>功能，输入数据和格式如下。</p><pre class="kn ko kp kq gt nc kl nd bn ne nf bi"><span id="3502" class="ng ma in kl b be nh ni l nj nk">df &lt;- df %&gt;% <br/>  mutate(NEW_FORMAT = as.Date(as.character(BIRTHDAY), format = "%d/%m/%Y"))</span></pre><p id="e017" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">结果如预期那样工作。基本上，你告诉计算机，他们把生日列当作格式为<code class="fe ki kj kk kl b"><strong class="jm io">“%d/%m/%Y”</strong></code> <strong class="jm io">(日/月/年)</strong>的字符，并借助<code class="fe ki kj kk kl b"><strong class="jm io">as.Date()</strong> </code>函数把它转换成你的计算机系统日期格式。我的电脑系统有<code class="fe ki kj kk kl b"><strong class="jm io">YYYY-MM-DD</strong></code>(2022–12–15)格式，你的可能和我的不一样，所以你可以在你的新专栏里期待不同的结果。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/fd5fbfb21d7b9e7c4c5df680f6823c1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*0PerFqBJAYZVT5b1LowIaA.png"/></div></figure></div><div class="ab cl lc ld hr le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ig ih ii ij ik"><h1 id="dd60" class="lz ma in bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">场景 2</h1><p id="aaed" class="pw-post-body-paragraph jk jl in jm b jn mx jp jq jr my jt ju jv mz jx jy jz na kb kc kd nb kf kg kh ig bi translated">现在假设您的数据在同一列中有多种格式，如何将所有这些格式转换成一种格式？</p><pre class="kn ko kp kq gt nc kl nd bn ne nf bi"><span id="8a7f" class="ng ma in kl b be nh ni l nj nk">df &lt;- data.frame(date_time = c("24/12/1990", "01/07/1980", "2000-12-24", <br/>                               "24 Nov 2005", "September 24, 2010", <br/>                                "Jul 24, 2016", "12/24/21"))</span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/cdd32002aca4b827b1d3d7ef35efb4e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:514/format:webp/1*otxdLDLpl6oWKzrKUUAemQ.png"/></div></figure><p id="2e37" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因为还有许多其他格式，在这个例子中，我只得到其中的一些，你可能会在你的数据集中看到其他不同的格式。但是不要担心，一旦你理解了基本的，你可以很容易地调整。</p><p id="018d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这种情况下，我们可以应用与场景 1 相同的方法，场景 1 只指定一种格式。现在，我们需要指定所有这些格式，并将其放入一个向量中。让我们和我一起指定这些格式。</p><pre class="kn ko kp kq gt nc kl nd bn ne nf bi"><span id="649b" class="ng ma in kl b be nh ni l nj nk">Specification:<br/>24/12/1990: =&gt; %d/%m/%Y<br/>01/07/1980: =&gt; %m/%d/%Y<br/>2000-12-24: =&gt; %Y-%m-%d<br/>24 Nov 2005: =&gt; %d %b %Y<br/>September 24, 2010: =&gt; %B %d, %Y<br/>Jul 24, 2016: =&gt; %b %d, %Y<br/>12/24/21: =&gt; %m/%d/%y</span></pre><pre class="no nc kl nd bn ne nf bi"><span id="3d8d" class="ng ma in kl b be nh ni l nj nk">df &lt;- df %&gt;% <br/>  mutate(NEW_FORMAT = as.Date(as.character(BIRTHDAY), <br/>format = c("%d/%m/%Y", "%m/%d/%Y", "%Y-%m-%d", <br/>"%d %b %Y", "%B %d, %Y", "%b %d, %Y", "%m/%d/%y")))</span></pre><p id="8d7d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你告诉计算机，嘿，把生日作为字符与上述日期格式之一，如果格式匹配，那么把它转换成你的计算机系统的日期格式。如果没有，它将返回 NA 值。结果如下:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi np"><img src="../Images/e37dbcfbce328c7ffdabb717ed0a140e.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*z6TdpK2FpSvTmZvYqC0DBA.png"/></div></figure><p id="d003" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在您知道了如何将多种日期格式转换成一种格式。每当你在你的数据中看到一个新的格式时，你可以把向量 c() 添加到<strong class="jm io">格式中。在这一步，如果您想创建一个函数供将来重用，我们鼓励您这样做。</strong></p><pre class="kn ko kp kq gt nc kl nd bn ne nf bi"><span id="7930" class="ng ma in kl b be nh ni l nj nk">convert_date &lt;- function(date_data){<br/>  as.Date(as.character(date_data), <br/>format = c("%d/%m/%Y", "%m/%d/%Y", "%Y-%m-%d", "%d %b %Y", <br/>"%B %d, %Y", "%b %d, %Y", "%m/%d/%y")) <br/>}<br/>df &lt;- df %&gt;% <br/>  mutate(NEW_FORMAT = convert_date(BIRTHDAY))</span></pre><p id="102c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">它返回相同的结果，现在每次需要转换日期数据时，只需要一行代码。如果发现新的数据格式，只需将该格式添加到函数中。</p></div><div class="ab cl lc ld hr le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ig ih ii ij ik"><h1 id="8ad9" class="lz ma in bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">场景 3</h1><p id="71c4" class="pw-post-body-paragraph jk jl in jm b jn mx jp jq jr my jt ju jv mz jx jy jz na kb kc kd nb kf kg kh ig bi translated">在这种情况下，将各种数据格式转换成一种格式非常简单。只用一行代码就可以使用<code class="fe ki kj kk kl b"><strong class="jm io">lubridate</strong> </code>包。使用上面相同的例子</p><pre class="kn ko kp kq gt nc kl nd bn ne nf bi"><span id="ade5" class="ng ma in kl b be nh ni l nj nk">library(dplyr)<br/>library(lubridate)<br/>df &lt;- data.frame(BIRTHDAY = c("24/12/1990", "01/07/1980", "2000-12-24", <br/>                              "24 Nov 2005", "September 24, 2010", <br/>                              "Jul 24, 2016", "12/24/21")) <br/>df &lt;- df %&gt;% <br/>  mutate(converted_date = parse_date_time(BIRTHDAY, <br/>orders = c("mdy", "dmy", "ymd")))</span></pre><p id="c80b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">它返回如下相同的输出:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/dcd24421d02bb858ea4631821a160776.png" data-original-src="https://miro.medium.com/v2/resize:fit:690/format:webp/1*YV4oZpaOQX4hLZouAMOSlw.png"/></div></figure><p id="4ea2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">同样，有多种方法可以将日期格式从一种格式转换为另一种格式。我画出不同的场景，分析解决问题的不同方法。通过这样做，我们学会了如何逐步找到解决方案。这被认为是进一步问题的基础。当我们将问题分解成小的种类时，逐个处理会容易得多。访问<a class="ae lx" href="https://lubridate.tidyverse.org/reference/parse_date_time.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io">这里</strong> </a> <strong class="jm io"> </strong>了解更多关于<code class="fe ki kj kk kl b"><strong class="jm io">parse_date_time</strong> </code>和<code class="fe ki kj kk kl b"><strong class="jm io">lubridate</strong> </code>套餐的信息。</p></div><div class="ab cl lc ld hr le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ig ih ii ij ik"><h1 id="7aff" class="lz ma in bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">场景 4</h1><p id="20b1" class="pw-post-body-paragraph jk jl in jm b jn mx jp jq jr my jt ju jv mz jx jy jz na kb kc kd nb kf kg kh ig bi translated">哇哇哇，今天文章的四个不同场景。有时你想转换成特定的格式，而不是你的计算机系统格式。假设你想把<code class="fe ki kj kk kl b"><strong class="jm io">2016/07/24</strong></code>转换成<code class="fe ki kj kk kl b"><strong class="jm io">Jul 2016</strong></code> <strong class="jm io">，</strong>我们该怎么做呢？</p><p id="9829" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">有时，经理想要一份带有图表的报告，他/她只想根据<strong class="jm io">月</strong>和<strong class="jm io">年</strong>进行过滤。只用月份和年份来转换日期非常方便。您可以使用<code class="fe ki kj kk kl b"><strong class="jm io">format()</strong> </code>功能，通过该功能您可以输入日期列并输入需要转换的格式。让我们看看这个例子。</p><p id="ca9e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">使用与<strong class="jm io">场景 3 </strong>相同的示例，现在我们只添加一个具有<strong class="jm io">月</strong>和<strong class="jm io">年</strong>格式的列。</p><pre class="kn ko kp kq gt nc kl nd bn ne nf bi"><span id="ccf7" class="ng ma in kl b be nh ni l nj nk">df &lt;- data.frame(BIRTHDAY = c("24/12/1990", "01/07/1980", "2000-12-24", <br/>                              "24 Nov 2005", "September 24, 2010", <br/>                              "Jul 24, 2016", "12/24/21")) <br/>df &lt;- df %&gt;% <br/>  mutate(NEW_FORMAT = parse_date_time(BIRTHDAY, <br/>  orders = c("mdy", "dmy", "ymd"))) %&gt;% <br/>  mutate(DESIRED_FORMAT = format(NEW_FORMAT, "%b %Y"))</span></pre><p id="1e1d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">看起来是这样的:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/57608d04608c03090b192216155dde90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*LJR5h3uUvC82ip4AMSpx4Q.png"/></div></figure><p id="df4d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">通过一些简便的方法来处理日期类型，现在您可以稍微提高您的生产率。通过每天一点一点的改进，它将会产生巨大的影响。</p></div><div class="ab cl lc ld hr le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ig ih ii ij ik"><h1 id="3964" class="lz ma in bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">参考资料:</h1><p id="8585" class="pw-post-body-paragraph jk jl in jm b jn mx jp jq jr my jt ju jv mz jx jy jz na kb kc kd nb kf kg kh ig bi translated">Lubridate 包:<a class="ae lx" href="https://lubridate.tidyverse.org/reference/parse_date_time.html" rel="noopener ugc nofollow" target="_blank">用户友好的日期时间解析函数—parse _ date _ time lubridate(tidyverse.org)</a></p><p id="88a7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">日期格式:<a class="ae lx" href="https://www.r-bloggers.com/2013/08/date-formats-in-r/" rel="noopener ugc nofollow" target="_blank">R | R-bloggers 中的日期格式</a></p><p id="5c4e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ISO 日期时间格式:<a class="ae lx" href="https://www.techtarget.com/whatis/definition/ISO-date-format#:~:text=The%20ISO%20standard%20takes%20a,or%202022%2D07%2D15." rel="noopener ugc nofollow" target="_blank">什么是 ISO 日期时间格式？(techtarget.com)</a></p><p id="156b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">IBM 日期和时间格式:<a class="ae lx" href="https://www.ibm.com/docs/en/cmofz/10.1.0?topic=SSQHWE_10.1.0/com.ibm.ondemand.mp.doc/arsa0257.htm" rel="noopener ugc nofollow" target="_blank">日期和时间格式— IBM 文档</a></p></div></div>    
</body>
</html>