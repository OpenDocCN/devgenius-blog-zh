<html>
<head>
<title>Vuex 4 — Mutations</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Vuex 4 —突变</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/vuex-4-mutations-6a0852668038?source=collection_archive---------6-----------------------#2020-12-15">https://blog.devgenius.io/vuex-4-mutations-6a0852668038?source=collection_archive---------6-----------------------#2020-12-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/f758fad799db95d3c4636742ca37a17b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*X1Tf-jx_xj3OBO2X"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">罗斯·芬登在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="9fb1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vuex 4 处于测试阶段，可能会有变化。</p><p id="15d0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vuex 是一个流行的 Vue 状态管理库。</p><p id="a15e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vuex 4 是专为 Vue 3 设计的版本。</p><p id="5bb2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解如何将 Vuex 4 与 Vue 3 配合使用。</p><h1 id="d938" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">对象风格提交</h1><p id="1cf0" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以向<code class="fe me mf mg mh b">commit</code>方法传递一个对象。</p><p id="4b3b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="d377" class="mq lc iq mh b gy mr ms l mt mu">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;script src="https://unpkg.com/vue@next"&gt;&lt;/script&gt;<br/>    &lt;script src="https://unpkg.com/vuex@4.0.0-beta.4/dist/vuex.global.js"&gt;&lt;/script&gt;<br/>    &lt;title&gt;App&lt;/title&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="app"&gt;<br/>      &lt;button @click="decrement"&gt;decrement&lt;/button&gt;<br/>      &lt;p&gt;{{count}}&lt;/p&gt;<br/>    &lt;/div&gt;<br/>    &lt;script&gt;<br/>      const store = new Vuex.Store({<br/>        state: {<br/>          count: 0<br/>        },<br/>        mutations: {<br/>          decrement(state, payload) {<br/>            state.count -= payload.amount;<br/>          }<br/>        }<br/>      });<br/>      const app = Vue.createApp({<br/>        methods: {<br/>          decrement() {<br/>            this.$store.commit({<br/>              type: "decrement",<br/>              amount: 5<br/>            });<br/>          }<br/>        },<br/>        computed: {<br/>          count() {<br/>            return this.$store.state.count;<br/>          }<br/>        }<br/>      });<br/>      app.use(store);<br/>      app.mount("#app");<br/>    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="5f4e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将一个对象传递给<code class="fe me mf mg mh b">this.$store.commit</code>方法。</p><p id="bf1e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">除了<code class="fe me mf mg mh b">type</code>之外的属性会出现在<code class="fe me mf mg mh b">payload</code>对象中。</p><p id="6eda" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们可以在<code class="fe me mf mg mh b">decrement</code>突变方法中用<code class="fe me mf mg mh b">payload.amount</code>访问<code class="fe me mf mg mh b">amount</code>属性。</p><p id="3eca" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">突变遵循 Vue 3 的反应性规则，因此每当一个反应性状态变量被更新时，存储状态就会改变。</p><h1 id="8fdf" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">对突变类型使用常数</h1><p id="776b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以对突变类型使用常数。</p><p id="8da9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="8602" class="mq lc iq mh b gy mr ms l mt mu">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;script src="https://unpkg.com/vue@next"&gt;&lt;/script&gt;<br/>    &lt;script src="https://unpkg.com/vuex@4.0.0-beta.4/dist/vuex.global.js"&gt;&lt;/script&gt;<br/>    &lt;title&gt;App&lt;/title&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="app"&gt;<br/>      &lt;button @click="decrement"&gt;decrement&lt;/button&gt;<br/>      &lt;p&gt;{{count}}&lt;/p&gt;<br/>    &lt;/div&gt;<br/>    &lt;script&gt;<br/>      const DECREMENT = "decrement";</span><span id="c7ef" class="mq lc iq mh b gy mv ms l mt mu">      const store = new Vuex.Store({<br/>        state: {<br/>          count: 0<br/>        },<br/>        mutations: {<br/>          [DECREMENT](state) {<br/>            state.count -= 1;<br/>          }<br/>        }<br/>      });<br/>      const app = Vue.createApp({<br/>        methods: {<br/>          decrement() {<br/>            this.$store.commit(DECREMENT);<br/>          }<br/>        },<br/>        computed: {<br/>          count() {<br/>            return this.$store.state.count;<br/>          }<br/>        }<br/>      });<br/>      app.use(store);<br/>      app.mount("#app");<br/>    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="cc8c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们传入了一个<code class="fe me mf mg mh b">DECREMENT</code>常量，作为<code class="fe me mf mg mh b">mutations</code>属性和<code class="fe me mf mg mh b">commit</code>方法中的变异名称。</p><p id="7930" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这对于在多个地方重用同一个名称很有用。</p><h1 id="3a15" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">突变必须是同步的</h1><p id="af0d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">突变必须是同步的。</p><p id="223b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是因为它里面的代码必须按顺序运行，这样我们才能跟踪代码。</p><h1 id="6a64" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在组件中进行突变</h1><p id="b354" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以调用<code class="fe me mf mg mh b">mapMutations</code>方法来将我们的突变映射到一个方法。</p><p id="ee89" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="65d5" class="mq lc iq mh b gy mr ms l mt mu">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;script src="https://unpkg.com/vue@next"&gt;&lt;/script&gt;<br/>    &lt;script src="https://unpkg.com/vuex@4.0.0-beta.4/dist/vuex.global.js"&gt;&lt;/script&gt;<br/>    &lt;title&gt;App&lt;/title&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="app"&gt;<br/>      &lt;button <a class="ae kc" href="http://twitter.com/click" rel="noopener ugc nofollow" target="_blank">@click</a>="decrement"&gt;decrement&lt;/button&gt;<br/>      &lt;p&gt;{{count}}&lt;/p&gt;<br/>    &lt;/div&gt;<br/>    &lt;script&gt;<br/>      const store = new Vuex.Store({<br/>        state: {<br/>          count: 0<br/>        },<br/>        mutations: {<br/>          decrement(state) {<br/>            state.count -= 1;<br/>          }<br/>        }<br/>      });<br/>      const app = Vue.createApp({<br/>        methods: {<br/>          ...Vuex.mapMutations(["decrement"])<br/>        },<br/>        computed: {<br/>          count() {<br/>            return this.$store.state.count;<br/>          }<br/>        }<br/>      });<br/>      app.use(store);<br/>      app.mount("#app");<br/>    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="f540" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将<code class="fe me mf mg mh b">Vuex.mapMutations</code>方法调用为一个方法。</p><p id="49ef" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，当我们单击“减量”按钮时，我们可以运行它。</p><p id="3d51" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我们用<code class="fe me mf mg mh b">mapMutations</code>映射突变时，有效载荷是受支持的。</p><p id="f1b3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以将一个突变映射到一个具有不同名称的方法:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="a055" class="mq lc iq mh b gy mr ms l mt mu">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;script src="https://unpkg.com/vue@next"&gt;&lt;/script&gt;<br/>    &lt;script src="https://unpkg.com/vuex@4.0.0-beta.4/dist/vuex.global.js"&gt;&lt;/script&gt;<br/>    &lt;title&gt;App&lt;/title&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="app"&gt;<br/>      &lt;button <a class="ae kc" href="http://twitter.com/click" rel="noopener ugc nofollow" target="_blank">@click</a>="subtract"&gt;decrement&lt;/button&gt;<br/>      &lt;p&gt;{{count}}&lt;/p&gt;<br/>    &lt;/div&gt;<br/>    &lt;script&gt;<br/>      const store = new Vuex.Store({<br/>        state: {<br/>          count: 0<br/>        },<br/>        mutations: {<br/>          decrement(state) {<br/>            state.count -= 1;<br/>          }<br/>        }<br/>      });<br/>      const app = Vue.createApp({<br/>        methods: {<br/>          ...Vuex.mapMutations({<br/>            subtract: "decrement"<br/>          })<br/>        },<br/>        computed: {<br/>          count() {<br/>            return this.$store.state.count;<br/>          }<br/>        }<br/>      });<br/>      app.use(store);<br/>      app.mount("#app");<br/>    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="67bd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用传递给<code class="fe me mf mg mh b">mapMutations</code>的对象的键将<code class="fe me mf mg mh b">decrement</code>突变映射到<code class="fe me mf mg mh b">subtract</code>方法。</p><h1 id="bf14" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="0b28" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以在各种中创建和突变来改变 Vuex 状态数据。</p></div></div>    
</body>
</html>