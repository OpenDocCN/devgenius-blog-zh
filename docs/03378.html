<html>
<head>
<title>React Tips — colspan, Active Links, API Calls, and Multiple Refs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React提示—列跨度、活动链接、API调用和多个引用</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/react-tips-colspan-active-links-api-calls-and-multiple-refs-90db250e6785?source=collection_archive---------11-----------------------#2020-10-27">https://blog.devgenius.io/react-tips-colspan-active-links-api-calls-and-multiple-refs-90db250e6785?source=collection_archive---------11-----------------------#2020-10-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/bc21ab2dfbd9620ade2dafab47ffd0d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HIrGsBdrXybCeMGh"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">由<a class="ae kc" href="https://unsplash.com/@leilaboujnane?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Leila Boujnane </a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><p id="bed8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">React是一个用于创建web应用程序和移动应用程序的流行库。</p><p id="f2a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解一些编写更好的React应用程序的技巧。</p><h1 id="4922" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">用React中的钩子进行API调用</h1><p id="1dd3" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以在<code class="fe me mf mg mh b">useEffect</code>钩子中进行API调用。</p><p id="2bb6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="da79" class="mq lc iq mh b gy mr ms l mt mu">function User() {<br/>  const [firstName, setFirstName] = React.useState();<br/>  <br/>  React.useEffect(() =&gt; {<br/>    fetch('https://randomuser.me/api/')<br/>      .then(results =&gt; results.json())<br/>      .then(data =&gt; {<br/>        const {name} = data.results[0];<br/>        setFirstName(name.first);<br/>      });<br/>  }, []); </span><span id="6958" class="mq lc iq mh b gy mv ms l mt mu">  return (<br/>    &lt;div&gt;<br/>      Name: {firstName}<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="7b65" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在<code class="fe me mf mg mh b">useEffect</code>回调中调用<code class="fe me mf mg mh b">fetch</code>来获取数据。</p><p id="7fef" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们用<code class="fe me mf mg mh b">setFirstName</code>设置<code class="fe me mf mg mh b">firstNam,e</code>状态。</p><p id="4493" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们向第二个参数<code class="fe me mf mg mh b">useEffect</code>传递一个空数组，使回调只在组件挂载上运行。</p><p id="80a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们在return语句中呈现<code class="fe me mf mg mh b">firstName</code>。</p><p id="f89d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们希望在属性改变时加载数据，那么我们将属性传递给第二个参数中的数组。</p><h1 id="a024" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">反应跨列</h1><p id="c73e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用<code class="fe me mf mg mh b">colSpan</code>属性添加colspan属性。</p><p id="9434" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="48f4" class="mq lc iq mh b gy mr ms l mt mu">&lt;td colSpan={6} /&gt;</span></pre><h1 id="ac19" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">如何在React路由器中设置活动链接的样式</h1><p id="75ba" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用React Router的<code class="fe me mf mg mh b">NavLink</code>组件来设计一个活动链接。</p><p id="d9fa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="8b2d" class="mq lc iq mh b gy mr ms l mt mu">&lt;NavLink to="/profile" activeClassName="selected"&gt;<br/>  profile<br/>&lt;/NavLink&gt;</span></pre><p id="eff6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当链接处于活动状态时，<code class="fe me mf mg mh b">activeClassName</code>允许我们设置的类名。</p><p id="15ac" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">还有一个<code class="fe me mf mg mh b">activeStyle</code>道具，让我们为活动链接传入样式。</p><p id="26b4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="a6ae" class="mq lc iq mh b gy mr ms l mt mu">&lt;NavLink<br/>  to="/profile"<br/>  activeStyle={{<br/>    fontWeight: "bold",<br/>    color: "green"<br/>  }}<br/>&gt;<br/>  profile<br/>&lt;/NavLink&gt;</span></pre><p id="901a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们传入一个带有我们想要应用的样式的对象。</p><p id="7484" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">CSS属性名称全部改为camel case。</p><h1 id="7666" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">如果输入值按状态变化，则触发onChange</h1><p id="bf5f" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以在处理程序中设置状态。</p><p id="6cc1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用<code class="fe me mf mg mh b">Event</code>构造函数触发我们想要的事件。</p><p id="1be7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="f20e" class="mq lc iq mh b gy mr ms l mt mu">class App extends React.Component {<br/>  constructor(props) {<br/>    super(props)<br/>    this.state = {<br/>      value: 'foo'<br/>    }<br/>  }</span><span id="ac80" class="mq lc iq mh b gy mv ms l mt mu">  handleChange (e) {<br/>    console.log('changed')<br/>  }</span><span id="0ee3" class="mq lc iq mh b gy mv ms l mt mu">  handleClick () {<br/>    this.setState({ value: 'something' })<br/>    const event = new Event('input', { bubbles: true });<br/>    this.input.dispatchEvent(event);<br/>  }<br/>  render () {<br/>    return (<br/>      &lt;div&gt;<br/>        &lt;input readOnly value={this.state.value} onChange={(e) =&gt; this.handleChange(e)} ref={(input)=&gt; this.input = input} /&gt;<br/>        &lt;button onClick={this.handleClick.bind(this)}&gt;update input&lt;/button&gt;<br/>      &lt;/div&gt;<br/>    )<br/>  }<br/>}</span></pre><p id="283d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有一个按钮，它有一个点击处理程序。</p><p id="e099" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那就是<code class="fe me mf mg mh b">handleClick</code>法。</p><p id="eb05" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们在它上面调用<code class="fe me mf mg mh b">setState</code>来设置<code class="fe me mf mg mh b">value</code>状态。</p><p id="9aa9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们创建一个输入事件，并让它冒泡。</p><p id="6a21" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后用<code class="fe me mf mg mh b">dispatchEvent</code>触发输入上的事件。</p><h1 id="e46c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">用React添加Google登录按钮</h1><p id="a9a9" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以在React组件中添加一个google登录按钮，方法是在组件加载时加载Google登录代码。</p><p id="b950" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="c25a" class="mq lc iq mh b gy mr ms l mt mu">componentDidMount() {<br/>  gapi.signin2.render('g-signin2', {<br/>    'scope': 'https://www.googleapis.com/auth/plus.login',<br/>    'width': 200,<br/>    'height': 50,<br/>    'longtitle': true,<br/>    'theme': 'dark',<br/>    'onsuccess': this. onSignIn<br/>  });  <br/>}</span></pre><p id="0e7f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们调用API附带的<code class="fe me mf mg mh b">gapi.signin2.render</code>方法。</p><p id="3118" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它被添加到<code class="fe me mf mg mh b">componentDidMount</code>中，以便在组件加载时运行。</p><p id="23e4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用函数组件，我们可以编写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="f0b6" class="mq lc iq mh b gy mr ms l mt mu">useEffect(() =&gt; {<br/>  window.gapi.signin2.render('g-signin2', {<br/>    'scope': 'https://www.googleapis.com/auth/plus.login',<br/>    'width': 200,<br/>    'height': 50,<br/>    'longtitle': true,<br/>    'theme': 'dark',<br/>    'onsuccess': onSignIn<br/>  })<br/>}, [])</span></pre><p id="6913" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在<code class="fe me mf mg mh b">useEffect</code>回调中调用相同的方法。</p><p id="0509" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第二个参数中的空数组确保它仅在组件加载时加载。</p><h1 id="bf6a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">对带挂钩的元素数组使用多个引用</h1><p id="2443" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以在<code class="fe me mf mg mh b">useEffect</code>回调中创建多个引用。</p><p id="b417" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="a57f" class="mq lc iq mh b gy mr ms l mt mu">const List = ({ arr }) =&gt; {<br/>  const arrLength = arr.length;<br/>  const [elRefs, setElRefs] = React.useState([]);</span><span id="6c04" class="mq lc iq mh b gy mv ms l mt mu">  React.useEffect(() =&gt; {<br/>    setElRefs(elRefs =&gt; (<br/>      Array(arrLength).fill().map((_, i) =&gt; elRefs[i] || ReactcreateRef())<br/>    ));<br/>  }, [arrLength]);</span><span id="5c00" class="mq lc iq mh b gy mv ms l mt mu">  return (<br/>    &lt;div&gt;<br/>      {arr.map((el, i) =&gt; (<br/>        &lt;div ref={elRefs[i]}&gt;...&lt;/div&gt;<br/>      ))}<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="d124" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe me mf mg mh b">useState</code>钩子创建了一个数组。</p><p id="d4a8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们调用从<code class="fe me mf mg mh b">useState</code>返回的<code class="fe me mf mg mh b">setElRefs</code>并调用<code class="fe me mf mg mh b">fill</code>来创建一个空槽数组。</p><p id="76a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们调用<code class="fe me mf mg mh b">map</code>来创建引用或返回一个现有的引用。</p><p id="ddd0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们通过索引将ref传递给div。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/dc40ea788d999c415dfbf31beca55448.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*feataVn4IWZpJjbS"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@hariprasad000?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Hari Nandakumar </a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h1 id="8c45" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="aaa1" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过将多个引用映射到数组来添加它们。</p><p id="8af3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以在<code class="fe me mf mg mh b">useEffect</code>回调中进行API调用。</p><p id="5703" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">NavLink</code>当处于活动状态时，可以对其进行设计。</p></div></div>    
</body>
</html>