<html>
<head>
<title>7 — Important SQL Queries for Interview</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">7 —面试的重要 SQL 查询</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/6-important-sql-queries-for-interview-33e4f2331089?source=collection_archive---------2-----------------------#2022-10-22">https://blog.devgenius.io/6-important-sql-queries-for-interview-33e4f2331089?source=collection_archive---------2-----------------------#2022-10-22</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jk jl jm jn gh gi paragraph-image"><div class="ab gu cl jo"><img src="../Images/15e46fadc724842b92ef9fe2dd4d5f00.png" data-original-src="https://miro.medium.com/v2/format:webp/1*apmI-V1D6D8nRfRF5Q3XYQ.png"/></div></figure><h2 id="4044" class="jr js in bd jt ju jv dn jw jx jy dp jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">1)从列中提取空值</h2><p id="26c0" class="pw-post-body-paragraph kn ko in kp b kq kr ks kt ku kv kw kx ka ky kz la ke lb lc ld ki le lf lg lh ig bi translated">通常一个问题可能出现在有许多空条目的地方，面试官告诉我们删除它。在这种情况下，SQL 查询将如下所示:</p><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="43ad" class="jr js in ln b gy lr ls l lt lu">SELECT * FROM table WHERE column IS NULL</span></pre><h2 id="af3a" class="jr js in bd jt ju jv dn jw jx jy dp jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">2)或 vs SQL 中的 Union，哪一个更快</h2><p id="49c7" class="pw-post-body-paragraph kn ko in kp b kq kr ks kt ku kv kw kx ka ky kz la ke lb lc ld ki le lf lg lh ig bi translated">当我们有两个条件时，就使用“AND”和“OR”从句。当我们想同时选择 X 和 Y 时，我们使用 AND 运算符。当我们想选择 X 或 Y 时，我们使用 or 运算符。</p><p id="c026" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated">现在，联合功能也与 OR 相同。这里，SQL UNION 子句/运算符用于组合两个或多个 SELECT 语句的结果，而不返回任何重复的行。</p><p id="029e" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated">带有 WHERE 子句的 OR 运算符的基本语法如下</p><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="2dca" class="jr js in ln b gy lr ls l lt lu">SELECT column1, column2, columnN <br/>FROM table_name<br/>WHERE [condition1] OR [condition2]...OR [conditionN]</span></pre><p id="c7db" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated">UNION 子句的基本语法如下</p><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="2693" class="jr js in ln b gy lr ls l lt lu">SELECT column1 [, column2 ]<br/>FROM table1 [, table2 ]<br/>[WHERE condition]<br/><br/>UNION<br/><br/>SELECT column1 [, column2 ]<br/>FROM table1 [, table2 ]<br/>[WHERE condition]</span></pre><p id="97cc" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated">当比较 OR 和 UNION 时，有趣的是 UNION 命令比 OR 更快</p><h2 id="7940" class="jr js in bd jt ju jv dn jw jx jy dp jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">3)连接查询</h2><p id="963a" class="pw-post-body-paragraph kn ko in kp b kq kr ks kt ku kv kw kx ka ky kz la ke lb lc ld ki le lf lg lh ig bi translated">连接在 SQL 中非常重要，对于面试也是如此。SQL Joins 子句用于组合数据库中两个或多个表的记录。下图描述了在哪个场景中应该使用哪个连接。</p><figure class="li lj lk ll gt jn gh gi paragraph-image"><div class="ab gu cl jo"><img src="../Images/23158c09f6f4a1f4cf4ad6f50822c90c.png" data-original-src="https://miro.medium.com/v2/format:webp/1*fiNDD0SFlmIOH9h_JknC7Q.png"/></div></figure><p id="5724" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated">用于连接的 SQL 查询如下:</p><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="dff5" class="jr js in ln b gy lr ls l lt lu">SELECT table1.column1, table2.column2...<br/>FROM table1<br/>&lt;JOIN&gt; table2<br/>ON table1.common_field = table2.common_field;</span></pre><p id="c4e8" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated">如你所见，我们需要两样东西。首先，我们需要指定应用哪个连接，其次，我们需要指定两个表中的公共键。</p><h2 id="eb56" class="jr js in bd jt ju jv dn jw jx jy dp jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">4)条件语句</h2><p id="cfa4" class="pw-post-body-paragraph kn ko in kp b kq kr ks kt ku kv kw kx ka ky kz la ke lb lc ld ki le lf lg lh ig bi translated">如果你编码过，你可能知道 if-else 语句。人们也可以在 SQL 中实现这样的 if-else 条件。</p><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="58a9" class="jr js in ln b gy lr ls l lt lu">SELECT any_column ,<br/>	CASE <br/>		WHEN &lt;condition&gt; THEN &lt;output&gt;<br/>		WHEN &lt;condition&gt; THEN &lt;output&gt;<br/>	ELSE &lt;output&gt; <br/>	END AS &lt;resulting_col_name&gt;<br/>FROM &lt;TABLE&gt;</span></pre><p id="c87b" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated"><strong class="kp io"> <em class="ma">小心第一行的逗号</em> </strong></p><p id="564b" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated">示例 1:-</p><p id="2d7b" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated">编写一个 SQL 查询来计算每个雇员的奖金。如果员工的 ID 是奇数，并且员工的姓名不是以字符“M”开头，则员工的奖金是其工资的 100%。否则员工的奖金为 0。</p><figure class="li lj lk ll gt jn gh gi paragraph-image"><div class="ab gu cl jo"><img src="../Images/3dd5847c6590d617e93bb2749d7e051a.png" data-original-src="https://miro.medium.com/v2/format:webp/1*FPgrlqJZdLjladUugB4A9A.png"/></div></figure><p id="ec07" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated">select employee_id，case when employee_id % 2=0 或 name regexp '^m' then 0 else salary end as bonus from employee order by employee _ id；</p><p id="6a97" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated">这里，REGEXP 是正则表达式。</p><p id="4424" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated"><em class="ma">你也可以使用类似的操作，但我喜欢使用正则表达式</em></p><p id="1897" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated">示例 2:使用 UPDATE 命令和 case 语句</p><p id="2181" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated">编写一个 SQL 查询，用一条 update 语句交换所有“f”和“m”值(即，将所有“f”值改为“m ”,反之亦然),并且没有中间临时表。</p><figure class="li lj lk ll gt jn gh gi paragraph-image"><div class="ab gu cl jo"><img src="../Images/fb8a298ed5192529bb240c1061dc588a.png" data-original-src="https://miro.medium.com/v2/format:webp/1*JXYWnuNTvLEJpAivQqhYmQ.png"/></div></figure><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="8c4d" class="jr js in ln b gy lr ls l lt lu">/* Write your PL/SQL query statement below */<br/>update Salary <br/>set sex = case when sex='m' then 'f' else 'm'<br/>end</span></pre><h2 id="fb7f" class="jr js in bd jt ju jv dn jw jx jy dp jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">5)利用表格的对象</h2><p id="880e" class="pw-post-body-paragraph kn ko in kp b kq kr ks kt ku kv kw kx ka ky kz la ke lb lc ld ki le lf lg lh ig bi translated">很多时候，可能会要求问题在同一个表上执行操作，我们需要多个对象。这可以按如下方式创建:</p><p id="8c5e" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated">选择对象。*来自表 obj 从表 obj 中删除 obj；</p><p id="6e06" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated"><strong class="kp io">举例:- </strong></p><p id="76e0" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated">编写一个 SQL 查询来删除所有重复的电子邮件，只保留一个具有最小 id 的唯一电子邮件。请注意，您应该编写 DELETE 语句，而不是 SELECT 语句。</p><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="c8ef" class="jr js in ln b gy lr ls l lt lu">Input: <br/>Person table:<br/>+----+------------------+<br/>| id | email            |<br/>+----+------------------+<br/>| 1  | john@example.com |<br/>| 2  | bob@example.com  |<br/>| 3  | john@example.com |<br/>+----+------------------+</span><span id="7ba9" class="jr js in ln b gy mb ls l lt lu">Output: <br/>+----+------------------+<br/>| id | email            |<br/>+----+------------------+<br/>| 1  | john@example.com |<br/>| 2  | bob@example.com  |<br/>+----+------------------+</span><span id="bfd0" class="jr js in ln b gy mb ls l lt lu">delete p1 from Person p1, Person p2 where p1.email=p2.email and p1.id&gt;p2.id;</span></pre><h2 id="2bff" class="jr js in bd jt ju jv dn jw jx jy dp jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">6)很少与字符串相关的操作</h2><p id="cd05" class="pw-post-body-paragraph kn ko in kp b kq kr ks kt ku kv kw kx ka ky kz la ke lb lc ld ki le lf lg lh ig bi translated">(I)用于索引<br/>子串(col，start_index，end_index)</p><p id="9649" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated">(二)获取管柱长度<br/>长度()</p><p id="319b" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated">(三)转换成上壳体或下壳体<br/>上()或下()</p><p id="32a3" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated">(iv)串联两个字符串<br/> Concat()或+</p><p id="61cb" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated">(v)提取子串<br/> Substring()</p><p id="ee3b" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated">(六)聚合字符串函数<br/> Group_concat()</p><h2 id="cdbe" class="jr js in bd jt ju jv dn jw jx jy dp jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">7)分组和聚合功能</h2><p id="de3f" class="pw-post-body-paragraph kn ko in kp b kq kr ks kt ku kv kw kx ka ky kz la ke lb lc ld ki le lf lg lh ig bi translated">GROUP BY 语句将具有相同值的行分组到汇总行中，如“查找每个国家的客户数量”。</p><p id="d6a8" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated">GROUP BY 语句通常与聚合函数(COUNT()、MAX()、MIN()、SUM()、AVG())一起使用，按一个或多个列对结果集进行分组。</p><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="54bb" class="jr js in ln b gy lr ls l lt lu">SELECT column_name(s)<br/>FROM table_name<br/>WHERE condition<br/>GROUP BY column_name(s);</span><span id="7b00" class="jr js in ln b gy mb ls l lt lu">SELECT  AGRE_FUN( col ) AS name  FROM table GROUP BY column</span></pre><p id="6123" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated"><strong class="kp io">例子:- </strong></p><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="9eb8" class="jr js in ln b gy lr ls l lt lu">SELECT Shippers.ShipperName, COUNT(Orders.OrderID) AS NumberOfOrders FROM Orders<br/>LEFT JOIN Shippers ON Orders.ShipperID = Shippers.ShipperID<br/>GROUP BY ShipperName;</span></pre><p id="81cd" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated">现在，如果我们想在 group-by 中应用条件，那么我们使用 HAVING 子句</p><p id="9ef4" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated">将 HAVING 子句添加到 SQL 中，因为 WHERE 关键字不能与聚合函数一起使用。</p><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="abf5" class="jr js in ln b gy lr ls l lt lu">SELECT column_name(s)<br/>FROM table_name<br/>WHERE condition<br/>GROUP BY column_name(s)<br/>HAVING condition<br/>ORDER BY column_name(s);</span></pre><h2 id="fb7d" class="jr js in bd jt ju jv dn jw jx jy dp jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">提问面试问题示例</h2><p id="7c63" class="pw-post-body-paragraph kn ko in kp b kq kr ks kt ku kv kw kx ka ky kz la ke lb lc ld ki le lf lg lh ig bi translated">编写一个 SQL 查询来报告 Employee 表中第二高的薪水。如果没有第二高的薪水，查询应该报告 null。</p><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="348b" class="jr js in ln b gy lr ls l lt lu">Input: <br/>Employee table:<br/>+----+--------+<br/>| id | salary |<br/>+----+--------+<br/>| 1  | 100    |<br/>| 2  | 200    |<br/>| 3  | 300    |<br/>+----+--------+<br/>Output: <br/>+---------------------+<br/>| SecondHighestSalary |<br/>+---------------------+<br/>| 200                 |<br/>+---------------------+</span></pre><p id="ba4a" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated">我们来走一遍如何实现:<br/> (1)我们把不是最大的工资拿出来所以，</p><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="7911" class="jr js in ln b gy lr ls l lt lu">SELECT max(salary) FROM Employee</span></pre><p id="f753" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated">(2)我们将在运算符中使用</p><p id="98fa" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated">IN 运算符允许您在 WHERE 子句中指定多个值。IN 运算符是多个 or 条件的简写。</p><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="42c2" class="jr js in ln b gy lr ls l lt lu">SELECT max(salary) AS SecondHighestSalary FROM Employee where salary NOT IN (SELECT max(salary) FROM Employee)</span></pre></div><div class="ab cl mc md hr me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ig ih ii ij ik"><p id="01e8" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated"><em class="ma">更多练习:参考</em><a class="ae mj" href="https://leetcode.com/study-plan/sql/" rel="noopener ugc nofollow" target="_blank"><em class="ma">https://leetcode.com/study-plan/sql/</em></a></p><p id="7720" class="pw-post-body-paragraph kn ko in kp b kq lv ks kt ku lw kw kx ka lx kz la ke ly lc ld ki lz lf lg lh ig bi translated">谢谢大家！看了我的文章。</p></div></div>    
</body>
</html>