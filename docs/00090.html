<html>
<head>
<title>How To Add Siri Shortcuts in Your App in Swift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在 Swift 的应用程序中添加 Siri 快捷方式</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-add-siri-shortcuts-in-your-app-in-swift-7afb61934c4e?source=collection_archive---------0-----------------------#2019-11-20">https://blog.devgenius.io/how-to-add-siri-shortcuts-in-your-app-in-swift-7afb61934c4e?source=collection_archive---------0-----------------------#2019-11-20</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="93c4" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">在你的应用中实现 Siri 快捷方式比你想象的要容易</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/54e3ed0149561635bebb251094dd85c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*D4OLAVpx1L-tIsBs"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk translated">照片由<a class="ae kw" href="https://unsplash.com/@emilep?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">émile Perron</a>在<a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="6846" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">随着 iOS 12 的发布，苹果允许开发者创建可以与 Siri 一起使用的自定义意图。这项新功能让开发人员可以在应用程序中创建自定义操作，无需打开应用程序就可以用 Siri 触发。</p><p id="5d79" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在今天的教程中，你将学习如何使用一个简单的快捷键，当 Siri 调用它时，它会执行一个动作。</p></div><div class="ab cl lt lu hv lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ik il im in io"><h1 id="c28b" class="ma mb ir bd mc md me mf mg mh mi mj mk jx ml jy mm ka mn kb mo kd mp ke mq mr bi translated">入门指南</h1><p id="39f8" class="pw-post-body-paragraph kx ky ir kz b la ms js lc ld mt jv lf lg mu li lj lk mv lm ln lo mw lq lr ls ik bi translated">首先，打开<a class="ae kw" href="https://developer.apple.com/xcode/" rel="noopener ugc nofollow" target="_blank"> Xcode </a>并创建一个新项目。选择单视图应用程序。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj mx"><img src="../Images/b6ec9f8ecc7ec0c34a8257f4f8e0579a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sd0OGHAeVNNLQMtHgrKF4w.png"/></div></div></figure><p id="7481" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">转到您的目标设置、签名和功能，并添加 Siri。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj my"><img src="../Images/5702288199002a8ea081e93ac0aa82e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r-k3DOBXzKNivW5hGywT-g.png"/></div></div></figure><p id="7362" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">现在右键单击项目文件夹，然后单击新建文件。然后，过滤<em class="mz">意图</em>并点击“下一步”以创建一个 SiriKit 意图定义文件，我们将在接下来的步骤中很快用到它。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj na"><img src="../Images/b285b0db8d6a42ffd9db1cf975561c46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Fa8SBJ8Qq47adbuiF9c0A.png"/></div></div></figure></div><div class="ab cl lt lu hv lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ik il im in io"><h1 id="2d4e" class="ma mb ir bd mc md me mf mg mh mi mj mk jx ml jy mm ka mn kb mo kd mp ke mq mr bi translated">履行</h1><p id="d110" class="pw-post-body-paragraph kx ky ir kz b la ms js lc ld mt jv lf lg mu li lj lk mv lm ln lo mw lq lr ls ik bi translated">我们开始创造一个新的意图。选择 intents 文件，点击屏幕底部的+,然后选择 New Intent。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nb"><img src="../Images/19da15f72f74afcb08a9f24c2b213c7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RiKPNV0-3Nv2LPCnMyzVxA.png"/></div></div></figure><p id="ad38" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">现在为意图设置标题和描述<em class="mz">并保存。</em></p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nc"><img src="../Images/a428db7042a623291b685dc94223376f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Km_8w_AgB1hmrG47B3wDYg.png"/></div></div></figure><p id="9a41" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">继续您的<code class="fe nd ne nf ng b">ViewController</code>并添加以下代码:</p><pre class="kh ki kj kk gu nh ng ni nj aw nk bi"><span id="5946" class="nl mb ir ng b gz nm nn l no np">import UIKit<br/>import IntentsUI<br/><br/>class ViewController: UIViewController {<br/><br/>    override func viewDidLoad() {<br/>        super.viewDidLoad()<br/>        // Do any additional setup after loading the view.<br/>        addSiriButton(to: self.view)<br/>    }<br/><br/>    func addSiriButton(to view: UIView) {<br/>    if #available(iOS 12.0, *) {<br/>        let button = INUIAddVoiceShortcutButton(style: .whiteOutline)<br/>            button.shortcut = INShortcut(intent: intent )<br/>            button.delegate = self<br/>            button.translatesAutoresizingMaskIntoConstraints = false<br/>            view.addSubview(button)<br/>            view.centerXAnchor.constraint(equalTo: button.centerXAnchor).isActive = true<br/>            view.centerYAnchor.constraint(equalTo: button.centerYAnchor).isActive = true<br/>        }<br/>    <br/>    }<br/>    <br/>    func showMessage() {<br/>        let alert = UIAlertController(title: "Done!", message: "This is your first shortcut action!", preferredStyle: UIAlertController.Style.alert)<br/>        alert.addAction(UIAlertAction(title: "OK", style: .default, handler: nil))<br/>        self.present(alert, animated: true, completion: nil)<br/>    }<br/><br/>}<br/><br/>extension ViewController {<br/>    @available(iOS 12.0, *)<br/>    public var intent: DoSomethingIntent {<br/>        let testIntent = DoSomethingIntent()<br/>        testIntent.suggestedInvocationPhrase = "Test command"<br/>        return testIntent<br/>    }<br/>}<br/><br/>extension ViewController: INUIAddVoiceShortcutButtonDelegate {<br/>    @available(iOS 12.0, *)<br/>    func present(_ addVoiceShortcutViewController: INUIAddVoiceShortcutViewController, for addVoiceShortcutButton: INUIAddVoiceShortcutButton) {<br/>        addVoiceShortcutViewController.delegate = self<br/>        addVoiceShortcutViewController.modalPresentationStyle = .formSheet<br/>        present(addVoiceShortcutViewController, animated: true, completion: nil)<br/>    }<br/>    <br/>    @available(iOS 12.0, *)<br/>    func present(_ editVoiceShortcutViewController: INUIEditVoiceShortcutViewController, for addVoiceShortcutButton: INUIAddVoiceShortcutButton) {<br/>        editVoiceShortcutViewController.delegate = self<br/>        editVoiceShortcutViewController.modalPresentationStyle = .formSheet<br/>        present(editVoiceShortcutViewController, animated: true, completion: nil)<br/>    }<br/>    <br/>    <br/>}<br/><br/>extension ViewController: INUIAddVoiceShortcutViewControllerDelegate {<br/>    @available(iOS 12.0, *)<br/>    func addVoiceShortcutViewController(_ controller: INUIAddVoiceShortcutViewController, didFinishWith voiceShortcut: INVoiceShortcut?, error: Error?) {<br/>        controller.dismiss(animated: true, completion: nil)<br/>    }<br/>    <br/>    @available(iOS 12.0, *)<br/>    func addVoiceShortcutViewControllerDidCancel(_ controller: INUIAddVoiceShortcutViewController) {<br/>        controller.dismiss(animated: true, completion: nil)<br/>    }<br/>    <br/>    <br/>}<br/><br/>extension ViewController: INUIEditVoiceShortcutViewControllerDelegate {<br/>    @available(iOS 12.0, *)<br/>    func editVoiceShortcutViewController(_ controller: INUIEditVoiceShortcutViewController, didUpdate voiceShortcut: INVoiceShortcut?, error: Error?) {<br/>        controller.dismiss(animated: true, completion: nil)<br/>    }<br/>    <br/>    @available(iOS 12.0, *)<br/>    func editVoiceShortcutViewController(_ controller: INUIEditVoiceShortcutViewController, didDeleteVoiceShortcutWithIdentifier deletedVoiceShortcutIdentifier: UUID) {<br/>        controller.dismiss(animated: true, completion: nil)<br/>    }<br/>    <br/>    @available(iOS 12.0, *)<br/>    func editVoiceShortcutViewControllerDidCancel(_ controller: INUIEditVoiceShortcutViewController) {<br/>        controller.dismiss(animated: true, completion: nil)<br/>    }<br/>}</span></pre><p id="9710" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">现在，如果你运行应用程序，你应该有一个空白的屏幕，中间有一个按钮，可以将我们刚刚创建的快捷方式添加到 Siri 中。您可以点击按钮，使用默认文本或设置新的文本来触发快捷方式。</p><p id="a235" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">现在，如果你触发 Siri 并说出选择的命令，你的应用程序将自动打开！</p><div class="kh ki kj kk gu ab cb"><figure class="nq kl nr ns nt nu nv paragraph-image"><img src="../Images/3a249fad79142fe174e8daa69e6f8afd.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*tNe6y1_6iat-sDrzS4iKNw.png"/></figure><figure class="nq kl nw ns nt nu nv paragraph-image"><img src="../Images/a1f613191fa659974f60aaeaf8d8bf99.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/1*pP1ouBF7Zu3uPtFErqV8ig.gif"/></figure></div><p id="0788" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">现在，当我们对 Siri 说出命令时，我们的应用程序就会打开，但我们必须做什么才能将这个短语链接到我们应用程序中的特定操作？</p><p id="70a8" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">首先，转到<code class="fe nd ne nf ng b">Main.storyboard</code>并在 StoryboardID 属性上设置 ViewController。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nc"><img src="../Images/8ba579493cd565c33b9879398ee36168.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aAlfKFTGCdHsu2YTuvWuuw.png"/></div></div></figure><p id="803a" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">现在在<code class="fe nd ne nf ng b">SceneDelegate.swift</code>(iOS 13 上)或者<code class="fe nd ne nf ng b">AppDelegate.swift</code>(iOS 13 之前)上，复制以下代码(这是针对<code class="fe nd ne nf ng b">SceneDelegate</code>的版本，但是在<code class="fe nd ne nf ng b">AppDelegate</code>上添加的方法真的很类似):</p><pre class="kh ki kj kk gu nh ng ni nj aw nk bi"><span id="d147" class="nl mb ir ng b gz nm nn l no np">func scene(_ scene: UIScene, continue userActivity: NSUserActivity) {<br/>        if let _ = userActivity.interaction?.intent as? DoSomethingIntent {<br/><br/>            if let windowScene = scene as? UIWindowScene {<br/>                self.window = UIWindow(windowScene: windowScene)<br/>                let storyboard = UIStoryboard(name: "Main", bundle: nil)<br/>                let initialViewController = storyboard.instantiateViewController(withIdentifier: "ViewController") as! ViewController<br/>                self.window!.rootViewController = initialViewController<br/>                self.window!.makeKeyAndVisible()<br/>                initialViewController.showMessage()<br/>            }<br/>        }<br/>    }</span></pre></div><div class="ab cl lt lu hv lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ik il im in io"><h1 id="e18e" class="ma mb ir bd mc md me mf mg mh mi mj mk jx ml jy mm ka mn kb mo kd mp ke mq mr bi translated">试验</h1><p id="72e8" class="pw-post-body-paragraph kx ky ir kz b la ms js lc ld mt jv lf lg mu li lj lk mv lm ln lo mw lq lr ls ik bi translated">最后，你已经准备好测试你的应用了！告诉 Siri 你的命令，结果应该是这样的:</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nx"><img src="../Images/0b0a53a63bd48ef962911c2db660df04.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*tkt5IvjqaIczyOV4WsTG2Q.jpeg"/></div></div></figure></div><div class="ab cl lt lu hv lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ik il im in io"><figure class="kh ki kj kk gu kl gi gj paragraph-image"><a href="https://www.buymeacoffee.com/nicolidomenico"><div class="gi gj ny"><img src="../Images/2a5f4681ef2bdba5652dc9b023b668a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D-JJemrcn63kKj3lPBwZ5w.png"/></div></a></figure><h1 id="0c87" class="ma mb ir bd mc md nz mf mg mh oa mj mk jx ob jy mm ka oc kb mo kd od ke mq mr bi translated">完整代码</h1><p id="3c40" class="pw-post-body-paragraph kx ky ir kz b la ms js lc ld mt jv lf lg mu li lj lk mv lm ln lo mw lq lr ls ik bi translated">你可以在<a class="ae kw" href="https://github.com/domeniconicoli/SiriKitIntentsUIExample" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到完整代码。</p><p id="b924" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">感谢您的阅读。如果你有任何问题或建议，请在评论中告诉我。</p></div></div>    
</body>
</html>