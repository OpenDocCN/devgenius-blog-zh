<html>
<head>
<title>How to Tag and Push a Docker Image to a Private Registry</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何标记Docker映像并将其推送到私有注册表</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-tag-and-push-a-docker-image-to-a-private-registry-2a676bf4c5a2?source=collection_archive---------0-----------------------#2021-01-07">https://blog.devgenius.io/how-to-tag-and-push-a-docker-image-to-a-private-registry-2a676bf4c5a2?source=collection_archive---------0-----------------------#2021-01-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/eef6c5cb1d95c4c12a27260e56efc97e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OGTMSJ4wjeCk0gyWxAMrYA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://unsplash.com/@rubavi78?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">rubén Bagües</a>在<a class="ae kc" href="https://unsplash.com/s/photos/container?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的原始照片；logo由<a class="ae kc" href="https://www.google.com/url?sa=i&amp;url=https%3A%2F%2Fwww.docker.com%2Fcompany%2Fnewsroom%2Fmedia-resources&amp;psig=AOvVaw0-FD1aPtAUpd4UTZDPP3Lh&amp;ust=1610080968382000&amp;source=images&amp;cd=vfe&amp;ved=0CA0QjhxqFwoTCMiPoJOBie4CFQAAAAAdAAAAABAD" rel="noopener ugc nofollow" target="_blank"> Docker </a>制作；作者:Tremaine Eto</figcaption></figure><p id="2b7b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设您正在本地机器上开发一个应用程序<code class="fe lb lc ld le b">sandbox/tremaine-test-app</code>，并且刚刚制作了映像。当您运行<code class="fe lb lc ld le b">$ docker images</code>时，您可以在保存到您机器的所有其他图像中看到该图像。</p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="lj lk l"/></div></figure><p id="04b5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，您希望将它推送到您的私有Docker存储库中，以便您在全国各地的朋友可以提取它，然后在他们的机器上运行和测试它。但是，您想要更改图像的名称，并且您还想要将它标记为<code class="fe lb lc ld le b">SNAPSHOT</code>版本，以强调它并不是真正的正式发布。</p><p id="ff3b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">除了可能重新命名图像的纯粹美学原因之外，标记也很重要，因为它告诉Docker您希望将图像放在注册中心的哪个存储库中。</p><h1 id="249d" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">贴上标签！</h1><p id="0ddb" class="pw-post-body-paragraph kd ke iq kf b kg mj ki kj kk mk km kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">这里的关键是标记图像。这基本上意味着你重新命名的形象。它遵循以下格式:</p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="lj lk l"/></div></figure><p id="4e5e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">标签是可选的，由括号表示，必须由ASCII字符、数字、下划线、句点和破折号组成；另外，<em class="mo">不能以句号或破折号开始</em>，不能超过128个字符。</p><p id="0f71" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lb lc ld le b">yourRegistryHost:&lt;port&gt;</code>对应于您的私有Docker注册表的主机名以及一个端口，如果需要的话。这是为了以后你推新标记的Docker图像。</p><p id="3763" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">原来有很多不同的方法可以用来标记局部图像。</p><h2 id="ae65" class="mp lm iq bd ln mq mr dn lr ms mt dp lv ko mu mv lz ks mw mx md kw my mz mh na bi translated">按图像ID标记</h2><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="lj lk l"/></div></figure><p id="f8c5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们看一看本文前面<code class="fe lb lc ld le b">$ docker images</code>给我们的列表，我们会看到这些图像对应的图像id。我们可以在这个命令中使用其中的一个，Docker的CLI将知道引用该ID。</p><p id="dea7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在前面的例子中，<code class="fe lb lc ld le b">sandbox/tremaine-test-app</code>有一个<code class="fe lb lc ld le b">1.0.0</code>和一个<code class="fe lb lc ld le b">latest</code>版本，但是它们的映像id是相同的。那是因为他们在现实中是同一个形象；如果有更多不同版本的<code class="fe lb lc ld le b">sandbox/tremaine-test-app</code>标签，那么该标签不一定是最新的<em class="mo">标签，因此它们可能具有不同的图像id。</em></p><p id="7307" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这个例子和所有后续的例子中，我们用<code class="fe lb lc ld le b">tremaine/hello-world:1.0.0-SNAPSHOT</code>标记我们的本地<code class="fe lb lc ld le b">sandbox/tremaine-test-app</code>图像。</p><p id="7b88" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过这样做，我们说我们想要有一个名为<code class="fe lb lc ld le b">hello-world</code>的图像的新标签，并把版本标签<code class="fe lb lc ld le b">1.0.0-SNAPSHOT</code>放在<code class="fe lb lc ld le b">tremaine</code>库中。</p><h2 id="7c96" class="mp lm iq bd ln mq mr dn lr ms mt dp lv ko mu mv lz ks mw mx md kw my mz mh na bi translated">按图像名称标记</h2><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="lj lk l"/></div></figure><p id="5b7b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这种情况下，我们明确使用图像名称作为源图像。我喜欢这种方法，因为与复制和粘贴图像ID相比，它更容易记住我的图像名称。</p><p id="4c75" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这种情况下，我们没有在我们的源(最左边)图像中指定标签，因此Docker将推断它是用于<code class="fe lb lc ld le b">latest</code>标签的。</p><h2 id="4846" class="mp lm iq bd ln mq mr dn lr ms mt dp lv ko mu mv lz ks mw mx md kw my mz mh na bi translated">按名称和标签标记</h2><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="lj lk l"/></div></figure><p id="f935" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这与上一个例子非常相似，但是在这个例子中，我们不希望它默认为源图像的<code class="fe lb lc ld le b">latest</code>标签。因此，我们特别指定了<code class="fe lb lc ld le b">1.0.0</code>。</p><h1 id="30b3" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">推它！</h1><p id="7e40" class="pw-post-body-paragraph kd ke iq kf b kg mj ki kj kk mk km kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">现在我们已经有了标记的图像，<code class="fe lb lc ld le b">yourRegistryHost:&lt;port&gt;/tremaine/hello-world:1.0.0-SNAPSHOT</code>，我们可以用一个简单的命令将它推送到我们的私有Docker注册中心:</p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="lj lk l"/></div></figure><p id="fa4a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于映像中已经有了Docker主机，Docker会知道将它推到那里。</p></div><div class="ab cl nb nc hu nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="ij ik il im in"><p id="c204" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">推送需要一点时间，但当一切都结束后，你的朋友将能够运行<code class="fe lb lc ld le b">$ docker pull</code>将图像拉至他们的机器，然后随心所欲地运行它。</p><p id="079c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在随后发表的一篇文章中，我将介绍一些关于<code class="fe lb lc ld le b">$ docker push</code>的更好的细节和选项。</p></div><div class="ab cl nb nc hu nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="ij ik il im in"><h2 id="9796" class="mp lm iq bd ln mq mr dn lr ms mt dp lv ko mu mv lz ks mw mx md kw my mz mh na bi translated">来源</h2><ul class=""><li id="638c" class="ni nj iq kf b kg mj kk mk ko nk ks nl kw nm la nn no np nq bi translated"><a class="ae kc" href="https://docs.docker.com/engine/reference/commandline/tag/#examples" rel="noopener ugc nofollow" target="_blank"> Docker标签文件</a></li></ul><div class="nr ns gp gr nt nu"><a href="https://tremaineeto.medium.com/membership" rel="noopener follow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">通过我的推荐链接加入媒体</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">tremaineeto.medium.com</p></div></div><div class="od l"><div class="oe l of og oh od oi jw nu"/></div></div></a></div></div></div>    
</body>
</html>