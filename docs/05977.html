<html>
<head>
<title>How to Create and Manipulate SQL Databases with Python(Introduction to Python SQL Libraries)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python创建和操作SQL数据库(Python SQL库简介)</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-create-and-manipulate-sql-databases-with-python-introduction-to-python-sql-libraries-194774c20418?source=collection_archive---------1-----------------------#2021-11-30">https://blog.devgenius.io/how-to-create-and-manipulate-sql-databases-with-python-introduction-to-python-sql-libraries-194774c20418?source=collection_archive---------1-----------------------#2021-11-30</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="f8cb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">连接SQL server和Python的简单步骤</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ab8a3aeaca374950ec2755e35939e9cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*teVnxRQ0QN36xkVS"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Emile Perron 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="476d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Python和SQL是数据科学领域中使用的两种重要的脚本语言。</p><p id="c347" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在本教程中，我将向您介绍一些概念，并讨论如何使用库连接sql server和Python。</p><p id="6eac" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在本文中，我们将讨论如何将关系数据库中的数据直接提取到机器学习管道中，并使用python脚本在SQL server中导入和修改数据库。</p><p id="7c4d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将介绍以下几点:</p><ul class=""><li id="2c3b" class="kz la in jm b jn jo jr js jv lb jz lc kd ld kh le lf lg lh bi translated">为什么要学习如何一起使用Python和SQL？</li><li id="e7b1" class="kz la in jm b jn li jr lj jv lk jz ll kd lm kh le lf lg lh bi translated">用Python连接到SQL Server</li><li id="8fbb" class="kz la in jm b jn li jr lj jv lk jz ll kd lm kh le lf lg lh bi translated">从Python字典创建新的表和记录</li><li id="d51f" class="kz la in jm b jn li jr lj jv lk jz ll kd lm kh le lf lg lh bi translated">用数据填充表格</li><li id="626f" class="kz la in jm b jn li jr lj jv lk jz ll kd lm kh le lf lg lh bi translated">读取数据</li><li id="5b8f" class="kz la in jm b jn li jr lj jv lk jz ll kd lm kh le lf lg lh bi translated">追加记录</li><li id="5e92" class="kz la in jm b jn li jr lj jv lk jz ll kd lm kh le lf lg lh bi translated">更新记录</li><li id="33f3" class="kz la in jm b jn li jr lj jv lk jz ll kd lm kh le lf lg lh bi translated">删除记录</li></ul><h1 id="ed00" class="ln lo in bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">为什么使用Python和SQL？</h1><p id="644c" class="pw-post-body-paragraph jk jl in jm b jn ml jp jq jr mm jt ju jv mn jx jy jz mo kb kc kd mp kf kg kh ig bi translated">对于数据分析师和数据科学家来说，Python有很多优势。python中有如此多的开源库，使得这个工具如此强大。</p><p id="f30c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">虽然数据集有不同种类的来源，但在许多情况下，数据将存储在关系数据库中。关系数据库是一种极其高效、强大和广泛使用的方式来<a class="ae ky" href="https://en.wikipedia.org/wiki/Create,_read,_update_and_delete" rel="noopener ugc nofollow" target="_blank">创建、读取、更新和删除各种数据。正如您所知，数据存储在数据库中，我们使用SQL脚本提取这些信息，了解如何结合使用Python和SQL将为您在处理数据和进行数据操作时带来更多优势。</a></p><h1 id="961d" class="ln lo in bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">入门指南</h1><p id="bca5" class="pw-post-body-paragraph jk jl in jm b jn ml jp jq jr mm jt ju jv mn jx jy jz mo kb kc kd mp kf kg kh ig bi translated">在本教程中，我们将使用JUPYTER笔记本和Microsoft SQL server。</p><p id="613a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将使用PYODBC库来连接SQL server和Python。</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="02c6" class="mv lo in mr b gy mw mx l my mz">pip install pyodbc</span></pre><p id="96e7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">运行上述代码后，PYODBC库将被安装在系统中。</p><h1 id="c380" class="ln lo in bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">导入库</h1><p id="5f80" class="pw-post-body-paragraph jk jl in jm b jn ml jp jq jr mm jt ju jv mn jx jy jz mo kb kc kd mp kf kg kh ig bi translated">在Python中，我们要做的第一件事就是导入我们的库。</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="888b" class="mv lo in mr b gy mw mx l my mz">%load_ext autotime   # used to track the speed</span><span id="a26f" class="mv lo in mr b gy na mx l my mz">import pandas as pd<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns</span><span id="759c" class="mv lo in mr b gy na mx l my mz">import time</span><span id="b8e2" class="mv lo in mr b gy na mx l my mz">import warnings<br/>warnings.filterwarnings("ignore", category=FutureWarning)<br/>pd.options.mode.chained_assignment = None  # default='warn'</span><span id="7f7f" class="mv lo in mr b gy na mx l my mz">import pyodbc</span></pre><h1 id="180b" class="ln lo in bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">正在连接到Microsoft SQL Server:</h1><p id="b738" class="pw-post-body-paragraph jk jl in jm b jn ml jp jq jr mm jt ju jv mn jx jy jz mo kb kc kd mp kf kg kh ig bi translated">现在我们需要执行下面的代码来连接SQL server和Jupyter notebook。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/373115abdf986ed782fe14a2286c7fb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3nnnC4XfJHwmNwz_OSSpFA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">SQL Server -Python连接成功</figcaption></figure><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="b9e8" class="mv lo in mr b gy mw mx l my mz">conn = pyodbc.connect('Driver={SQL Server};'<br/>                      'Server=Server name;'<br/>                      'Database=Database name;'<br/>                      'Trusted_Connection=yes;')<br/>cursor = conn.cursor()</span></pre><h1 id="1e28" class="ln lo in bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">创建新数据库</h1><p id="ff6b" class="pw-post-body-paragraph jk jl in jm b jn ml jp jq jr mm jt ju jv mn jx jy jz mo kb kc kd mp kf kg kh ig bi translated">现在我们已经建立了连接，下一步是在我们的服务器上创建一个新的数据库。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/d26ba3ccf3165ff9fd50d9598115314f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n-yqcHWMb8NIGIIJ2CrviQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">此代码将在Microsoft SQL server中创建test_df2表</figcaption></figure><p id="c4cc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在Python中创建数据框，我们将在表test_df2中将其导出到SQL server。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/4f82f6cb3fc7dc21b8795d05a6a1ca3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tLirTDgmQc-P0ZldolLDRQ.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/3e67dff24393dfda306d725ab75beaf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2bBkIdgZenPCFXahBjo4BA.png"/></div></div></figure><p id="ee19" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，下面的脚本将在SQL server中导出数据框</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/6941147305324d27334c826d54b22953.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eqz5q12GLZl_v8qnlA3N5A.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">数据框被导出到数据库</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/165dcf8034c22cf987c64dce4016a096.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*RFqGPNUNXIFGRGwpRoF0sw.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">在服务器中导出</figcaption></figure><h1 id="1587" class="ln lo in bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">读取数据</h1><p id="b837" class="pw-post-body-paragraph jk jl in jm b jn ml jp jq jr mm jt ju jv mn jx jy jz mo kb kc kd mp kf kg kh ig bi translated">现在我们有了一个可以使用的功能数据库。作为一名数据科学家，在您工作的项目中，您通常会接触现有的数据库。了解如何从这些数据库中提取数据，然后将数据输入到python数据管道中，这将非常有用。这是我们接下来要做的。</p><p id="1eb5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们用一个简单的查询来试试see，看看它是如何工作的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/96465317ff7e5c40c246f3ce8fe60b12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HZ_Fq_e4HRk_7BCV-1iSkQ.png"/></div></div></figure><ol class=""><li id="5a97" class="kz la in jm b jn jo jr js jv lb jz lc kd ld kh ni lf lg lh bi translated"><strong class="jm io">使用Python追加表中的记录:</strong></li></ol><p id="3877" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们可以通过运行以下代码在现有的表中添加记录:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/0cfa8c9606d6adc4d18361e48914e7e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QGRoNTEYP9XlF_aEJDdoSg.png"/></div></div></figure><p id="48b1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> 2。使用Python更新表中的记录:</strong></p><p id="9f2d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果您想要更新记录，那么您必须执行下面的代码来更新表中的记录</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/f061f1172ec59120e9a4ea0aa793a74b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IQsbjk4SxPOUcWALUlEpXw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Ankit的记录更新</figcaption></figure><p id="53dd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们来看看结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/992493283af4be0744829e5fed78ee38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*baEMmrThWCvn_97Pypq6Yg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">记录已被更新</figcaption></figure><p id="5c6b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> 3。使用Python删除SQL Server中的记录:</strong></p><p id="4278" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">假设您想从'<strong class="jm io"> test_df2' </strong>表中删除年龄为10的记录。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/bd910e308a6530ed3b5e42b3e31e7dc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S9ncGCPb-iqcHnAcH9mNYw.png"/></div></div></figure><p id="374a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们检查一下记录:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/018819cd25de2fe41b1d52ba37c36d5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vfb9CTet2a80BtZtlSFfnw.png"/></div></div></figure><h1 id="5a23" class="ln lo in bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">结论</h1><p id="327a" class="pw-post-body-paragraph jk jl in jm b jn ml jp jq jr mm jt ju jv mn jx jy jz mo kb kc kd mp kf kg kh ig bi translated">在本教程中，我们已经涵盖了许多重要的概念</p><p id="c303" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们已经学习了如何创建新的表和记录，我们已经了解了如何从现有的数据库中提取数据并将其加载到pandas数据框中，我们还学习了如何导出数据库中的记录，然后进行检索，然后我们已经完成了一些数据操作，如追加、更新和删除记录。</p><p id="1096" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我希望这篇文章能帮助你并节省大量的时间。如果你有任何建议，请告诉我。</p><p id="d8e7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">快乐编码。</p><p id="7392" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"><em class="no">Prabhat Pathak</em></strong><em class="no">(</em><a class="ae ky" href="https://www.linkedin.com/in/prabhat-pathak-029b6466/" rel="noopener ugc nofollow" target="_blank"><em class="no">Linkedin简介</em> </a> <em class="no">)数据科学顾问。</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/68600c1dbf4d796799ab7d2a80600502.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JzO35XErcxcu2iQx"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@grakozy?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">格雷格·拉科齐</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure></div><div class="ab cl nq nr hr ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ig ih ii ij ik"><p id="8df7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="no">更多内容请看</em><a class="ae ky" href="http://blog.devgenius.io" rel="noopener ugc nofollow" target="_blank"><em class="no">blog . dev genius . io</em></a><em class="no">。</em></p></div></div>    
</body>
</html>