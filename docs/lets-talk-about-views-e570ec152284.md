# 我们来谈谈看法

> 原文：<https://blog.devgenius.io/lets-talk-about-views-e570ec152284?source=collection_archive---------6----------------------->

![](img/49fa1aad04144dcda7b6c883d87c2eab.png)

保罗·斯科鲁普斯卡斯在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

SQL 视图是一个非常强大的工具，但有时会被忽略。有了所有这些 ORM 框架、Spring 数据等等，我们有时会忘记最强大的解决方案是使用 SQL。

在这篇短文中，我将讨论使用视图的优点和缺点。使用它们的决定取决于你。

# 为什么是的？

## 商业规则

您是否有一个业务逻辑(只显示发布日期之后的文章),您正在编写用于与该业务部分交互的大多数查询？通过将这些业务规则放到一个视图中，您可以确保数据的统一描述。通过这样做，从长远来看，你在这个逻辑上会有更少的问题。同样，当逻辑改变时，你只有一个地方可以改变它。

## 复杂查询逻辑

你是否曾经写过如此冗长复杂的 Hibernate 查询，以至于几分钟后就看不懂了？通过隐藏视图定义背后的复杂逻辑来简化查询。对于更具体的用例，SQL 是语言的最佳选择，你选择的 ORM 将不能处理更复杂的东西，如窗口函数等。此外，代码维护将更加简单，因为你将只做大多数 CRUD 操作。

## 一致性

您是否曾经更改过数据库中的表结构，导致长时间的重构会话，修复所有引用这些表的查询？视图可以作为表的接口。当您更改表时，您可能只需要修改视图定义就可以得到相同的视图。

## 安全性

您是否曾经需要限制对表中某些数据的访问(比如用户的个人数据)？或者向另一个团队提供访问权限，而不希望他们拥有完全访问权限？通过视图，您可以限制表格，允许视图中的数据共享、提供给您的团队等

# 为什么没有？

## 查询性能

很容易忘记视图背后可能有非常复杂的逻辑，并且每次访问视图时都需要运行查询。

一些 DB 引擎将允许您在视图上创建索引，或者创建称为物化视图的东西(来自查询的数据存储在一个表中，该表根据一些规则进行刷新)。

## 数据修改

并非所有视图都支持数据修改。只有最简单的，必须有一个主键和所有的字段。当你有连接和多表结构时，你就不走运了。

您仍然可以使用表来修改数据，使用视图来查询逻辑。

## 轻便

视图是数据库引擎的一部分。它们是按照您选择的 DB 引擎的特定风格编写的。如果你需要支持多种引擎，这可能不太适合你。否则，我会去它，每 10 年切换一次引擎不是使用这个可怕的功能的借口。

要获得更多类似的信息，你可以在 Twitter 上关注我。

*原载于 2021 年 3 月 23 日*[*https://dev . to*](https://dev.to/pavel_polivka/let-s-talk-about-views-1clp)*。*