<html>
<head>
<title>What happens when you type ‘gcc main.c’?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">当你输入“gcc main.c”时会发生什么？</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/what-happens-when-you-type-gcc-main-c-4e9ec816829a?source=collection_archive---------10-----------------------#2020-06-11">https://blog.devgenius.io/what-happens-when-you-type-gcc-main-c-4e9ec816829a?source=collection_archive---------10-----------------------#2020-06-11</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><figure class="im in gp gr io ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/2a8ee0d9d3cf265055cabee918ef6cd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PaOF4hxePjav4eihNBAbhw.png"/></div></div></figure><div class=""/><p id="1845" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在这篇博客中，我将解释一个 C 文件变成可执行文件的整个过程。首先，你必须从定义基本概念开始，比如什么是编译器，一个. c 文件必须经历什么过程。</p><h2 id="5013" class="kt ku iy bd kv kw kx dn ky kz la dp lb kg lc ld le kk lf lg lh ko li lj lk ll bi translated">什么是编译器？</h2><p id="193a" class="pw-post-body-paragraph jv jw iy jx b jy lm ka kb kc ln ke kf kg lo ki kj kk lp km kn ko lq kq kr ks ig bi translated">编译器是一种计算机程序，它将以一种编程语言编写的程序翻译成另一种编程语言，生成机器能够解释的等价程序。通常，第二语言是机器语言，但它也可以是中间代码(字节码)，或简单的文本。这个翻译过程被称为编译。</p><h2 id="9bc7" class="kt ku iy bd kv kw kx dn ky kz la dp lb kg lc ld le kk lf lg lh ko li lj lk ll bi translated">它是如何工作的</h2><p id="07cf" class="pw-post-body-paragraph jv jw iy jx b jy lm ka kb kc ln ke kf kg lo ki kj kk lp km kn ko lq kq kr ks ig bi translated">翻译过程在内部由执行不同逻辑操作的几个阶段组成。将这些阶段视为翻译器中的独立部分是有用的，并且它们实际上可以被编写为单独编码的操作，尽管在实践中它们经常被集成在一起。</p><figure class="ls lt lu lv gt ip gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/5d86ef245eb2950a2d1d9dca1414bdac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*9tX8f7oFQMt6KU7qvERN_g.png"/></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">编译器经历的过程</figcaption></figure><p id="ba70" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">一个 C 文件要成为可执行文件，需要经过四个阶段:</p><p id="8d76" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">1.预处理</p><p id="9fc3" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">2.汇编</p><p id="c081" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">3.装配</p><p id="8f40" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">4.连接</p><h2 id="5131" class="kt ku iy bd kv kw kx dn ky kz la dp lb kg lc ld le kk lf lg lh ko li lj lk ll bi translated">1.预处理</h2><p id="eb7b" class="pw-post-body-paragraph jv jw iy jx b jy lm ka kb kc ln ke kf kg lo ki kj kk lp km kn ko lq kq kr ks ig bi translated">这是源代码通过的第一个阶段。在此阶段，将完成以下任务:</p><p id="74d0" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">注释被删除</p><p id="0773" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">宏名被替换为代码</p><p id="dbf2" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">头文件包含在源代码中</p><p id="86b5" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">预处理步骤创建一个包含。一.分机。如果您运行 gcc -E main.c 命令，您可以看到预处理过的源代码，它被发送到标准输出。</p><h2 id="6001" class="kt ku iy bd kv kw kx dn ky kz la dp lb kg lc ld le kk lf lg lh ko li lj lk ll bi translated">2.收集</h2><p id="7c0a" class="pw-post-body-paragraph jv jw iy jx b jy lm ka kb kc ln ke kf kg lo ki kj kk lp km kn ko lq kq kr ks ig bi translated">完成预处理阶段后，编译器的下一步是将 print.i 作为输入，对其进行编译，并生成中间编译输出或汇编代码。</p><p id="b6b4" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">编译阶段创建一个“main.s”文件。</p><h2 id="ad7e" class="kt ku iy bd kv kw kx dn ky kz la dp lb kg lc ld le kk lf lg lh ko li lj lk ll bi translated">3.装配</h2><p id="9c05" class="pw-post-body-paragraph jv jw iy jx b jy lm ka kb kc ln ke kf kg lo ki kj kk lp km kn ko lq kq kr ks ig bi translated">在这一阶段，print.s 文件被作为输入，并生成一个中间文件 print.o。这个文件也称为目标文件，包含机器指令。在这个阶段，只有已有的代码被转换成机器语言，像 printf()这样的函数调用没有被解析。</p><p id="875e" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">因为这个阶段的输出是一个机器级的文件，正如你在下图中看到的，它是完全不可读的。</p><h2 id="6c9c" class="kt ku iy bd kv kw kx dn ky kz la dp lb kg lc ld le kk lf lg lh ko li lj lk ll bi translated">4.连接</h2><p id="bf9a" class="pw-post-body-paragraph jv jw iy jx b jy lm ka kb kc ln ke kf kg lo ki kj kk lp km kn ko lq kq kr ks ig bi translated">这是将函数调用和它们的定义链接起来的最后阶段。它创建一个输出文件，这是一个编译后的可执行文件。有了 out 文件，您就可以运行程序了。</p><figure class="ls lt lu lv gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi ma"><img src="../Images/acb6414f5c66c9f02ca3054d6c9195c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*vDTCsgV-cKhJ5wbeR2_mog.png"/></div></div></figure><p id="4ef4" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这些都在编译过程中。下一个 blob 见。不要停止学习！</p></div></div>    
</body>
</html>