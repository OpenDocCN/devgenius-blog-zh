<html>
<head>
<title>Added Security Measures and Changes in TLS 1.3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TLS 1.3 中增加了安全措施和变化</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/added-security-measures-and-changes-in-tls-1-3-fd93bbfecb8f?source=collection_archive---------0-----------------------#2021-04-30">https://blog.devgenius.io/added-security-measures-and-changes-in-tls-1-3-fd93bbfecb8f?source=collection_archive---------0-----------------------#2021-04-30</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><h2 id="af99" class="il im in bd b dl io ip iq ir is it dk iu translated" aria-label="kicker paragraph"><a class="ae ep" href="https://www.0snet.com/" rel="noopener ugc nofollow" target="_blank">第 0 根安全网络(0SNET) </a></h2><div class=""/><div class=""><h2 id="6d50" class="pw-subtitle-paragraph jt iw in bd b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk dk translated">看看 TLS 协议的新版本以及对其前身的更新</h2></div><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/274ca1df0913bf2dfdc6ca8028b01114.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ttb3_KqKffMQfKBl"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">由<a class="ae lb" href="https://unsplash.com/@pawel_czerwinski?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">paweczerwi ski</a>在<a class="ae lb" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="df68" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi ly translated">当一个新版本的软件发布时，它可能是为了修补安全漏洞，修正错误，提供新的功能和增强。类似地，每隔几年就会发布新的协议版本。这些较新的版本在很大程度上保留了相同的目标，但加入了新的要求和挑战。</p><p id="373b" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">一些协议，如<strong class="le ix"> SMTP </strong>甚至没有版本，可能永远不会有更新的版本，而<strong class="le ix"> TLS —传输层安全</strong>协议将永远有。在<strong class="le ix"> TLS </strong>协议中保持了可用性、兼容性和安全性的良好平衡。并且，随着技术的成熟，提供了额外的安全保证，例如前向保密，并且旧的加密算法被废弃或者它们的弱点被解决。</p><p id="1fd1" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated"><strong class="le ix"> TLS 1.3 </strong>的变化是显著的。这个新版本修改了建立加密参数的握手序列，更新了版本协商机制，加密了所有消息(除了前两条)，并提供了新的零往返时间(<strong class="le ix"> 0-RTT </strong>)模式，以降低延迟，但代价是安全性。</p><blockquote class="mh"><p id="b05f" class="mi mj in bd mk ml mm mn mo mp mq lx dk translated"><strong class="ak"> 0-RTT </strong>要求服务器维护状态，在没有状态的情况下，范围需要被限制到幂等应用</p></blockquote></div><div class="ab cl mr ms hr mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ig ih ii ij ik"><h1 id="99fb" class="my mz in bd na nb nc nd ne nf ng nh ni kc nj kd nk kf nl kg nm ki nn kj no np bi translated">信号交换协议</h1><p id="85d6" class="pw-post-body-paragraph lc ld in le b lf nq jx lh li nr ka lk ll ns ln lo lp nt lr ls lt nu lv lw lx ig bi translated">在握手过程中，客户端和服务器相互验证身份，协商协议版本，并生成加密密钥。在<strong class="le ix"> TLS 1.2 </strong>中，这一切都很清楚，即。，人们可以对网络上的数据包进行解码和解析，以查看整个 TLS 握手过程。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nv"><img src="../Images/a75082121d8f44ce5469f86bf77fab70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V5lVfdF6PxJrh5Lf2llVnA.png"/></div></div></figure><p id="5fb5" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">这仍然是安全的，并且保持了应用数据的机密性，因为一旦握手完成，它们总是被加密发送。但是，作为握手一部分的应用程序细节没有加密。这包括 TLS 证书中的<strong class="le ix"> commonName </strong>、<strong class="le ix"> subjectAltName </strong>字段、<em class="nw"> server_name </em> extension 中的域名等。</p><p id="43b0" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">在<strong class="le ix"> TLS 1.3 </strong>中，不再是这种情况。该协议的新版本引入了两个新的加密通道，它们可以交错使用。一个是在握手期间发送早期应用数据(下面在<strong class="le ix"> 0-RTT </strong>模式中解释),另一个是加密握手消息。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nx"><img src="../Images/2f497ad60baaedd0b37de32aa78b4c3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*An-CZZ_r5oxhbAKC3CZq8g.png"/></div></div></figure><p id="a4bb" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">除了<strong class="le ix"> ClientHello </strong>和<strong class="le ix"> ServerHello </strong>消息外，<strong class="le ix"> TLS 1.3 </strong>中的所有内容都是加密的。</p></div><div class="ab cl mr ms hr mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ig ih ii ij ik"><h1 id="2437" class="my mz in bd na nb nc nd ne nf ng nh ni kc nj kd nk kf nl kg nm ki nn kj no np bi translated">向后兼容性</h1><p id="c316" class="pw-post-body-paragraph lc ld in le b lf nq jx lh li nr ka lk ll ns ln lo lp nt lr ls lt nu lv lw lx ig bi translated">TLS 兼容服务器有一个协商机制，可以与不支持较新版本的客户端一起使用较旧版本的 TLS。这种机制以前非常简单，客户端公布它支持的最高 TLS 版本，服务器根据它可以支持的内容选择 TLS 版本。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ny"><img src="../Images/4964a923db3075d53cbbd1b2e6692404.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fTzbBddULHUVV110mtEIAA.png"/></div></div></figure><p id="4c76" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated"><strong class="le ix"> TLS 1.3 </strong>通过扩展<em class="nw"> supported_versions </em>引入了新的机制，在<strong class="le ix"> ClientHello </strong>消息中包含了客户端支持的版本列表，以及服务器在<strong class="le ix"> ServerHello </strong>消息中选择的 TLS 版本。缺少此扩展表示<strong class="le ix"> TLS 1.2 </strong>或更低。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nz"><img src="../Images/eab4ab833da02d1f5e8bd1c7dec081b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XxYP2AEKSdzp9tZDpt--fg.png"/></div></div></figure><p id="6246" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">在<strong class="le ix"> TLS 1.3 </strong>中增加了一个额外的降级保护机制，也建议用于旧版本，以防止版本降级攻击。</p><h2 id="e86b" class="oa mz in bd na ob oc dn ne od oe dp ni ll of og nk lp oh oi nm lt oj ok no it bi translated">更改密码规格</h2><p id="be51" class="pw-post-body-paragraph lc ld in le b lf nq jx lh li nr ka lk ll ns ln lo lp nt lr ls lt nu lv lw lx ig bi translated">关于<em class="nw"> change_cipher_spec </em>消息的注释。这些消息在<strong class="le ix"> TLS 1.3 </strong>中的握手中不起作用，但是在握手期间仍然可能存在，只是被客户端和服务器忽略。它们只是为了<a class="ae lb" href="https://tools.ietf.org/html/rfc8446#appendix-D.4" rel="noopener ugc nofollow" target="_blank">中间盒兼容性</a>而存在。</p></div><div class="ab cl mr ms hr mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ig ih ii ij ik"><h1 id="2150" class="my mz in bd na nb nc nd ne nf ng nh ni kc nj kd nk kf nl kg nm ki nn kj no np bi translated">密码套件</h1><p id="9d56" class="pw-post-body-paragraph lc ld in le b lf nq jx lh li nr ka lk ll ns ln lo lp nt lr ls lt nu lv lw lx ig bi translated">密码组表示在 TLS 会话建立过程中使用的一组特定的加密算法。在以前的 TLS 版本中，密码套件将包括密钥交换、加密和 mac 算法，如<a class="ae lb" href="https://tools.ietf.org/html/rfc5246#appendix-A.5" rel="noopener ugc nofollow" target="_blank">TLS _ DHE _ RSA _ WITH _ AES _ 256 _ CBC _ sha 256</a>。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ol"><img src="../Images/10450b734edb9e14256683250f3ced98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*22AEmCCy2jWcYYFwWMAFOA.png"/></div></div></figure><p id="c007" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated"><strong class="le ix"> TLS 1.3 </strong>将密钥交换算法与<a class="ae lb" href="https://tools.ietf.org/html/rfc8446#appendix-B.4" rel="noopener ugc nofollow" target="_blank">密码套件</a>分离。因此，例如，当您在浏览器中检查所使用的密码套件时，如果您没有看到公钥算法，请不要感到惊讶。密钥交换算法通过 TLS 扩展<a class="ae lb" href="https://tools.ietf.org/html/rfc8446#section-4.2.7" rel="noopener ugc nofollow" target="_blank"> <em class="nw"> supported_groups </em> </a>和<a class="ae lb" href="https://tools.ietf.org/html/rfc8446#section-4.2.3" rel="noopener ugc nofollow" target="_blank"><em class="nw">signature _ algorithms</em></a>单独协商。</p></div><div class="ab cl mr ms hr mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ig ih ii ij ik"><h1 id="dbf6" class="my mz in bd na nb nc nd ne nf ng nh ni kc nj kd nk kf nl kg nm ki nn kj no np bi translated">0-RTT 模式-零往返时间</h1><p id="b583" class="pw-post-body-paragraph lc ld in le b lf nq jx lh li nr ka lk ll ns ln lo lp nt lr ls lt nu lv lw lx ig bi translated">顾名思义，<strong class="le ix"> TLS 1.3 </strong>允许客户端立即发送数据，无需等待服务器的响应。这减少了应用程序中的延迟，但要求服务器在早期会话中通过<strong class="le ix"> NewSessionTicket </strong>消息向客户端发送预共享密钥。</p><p id="23f1" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">从预共享密钥中导出的<a class="ae lb" href="https://tools.ietf.org/html/rfc8446#page-93" rel="noopener ugc nofollow" target="_blank">早期秘密</a>用于加密紧随<strong class="le ix"> ClientHello </strong>之后发送的应用数据。<strong class="le ix"> ClientHello </strong>中出现的扩展<em class="nw"> early_data </em>是服务器切换到<strong class="le ix"> 0-RTT </strong>模式的指示。</p><p id="b942" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">没有预共享密钥和对<a class="ae lb" href="https://tools.ietf.org/html/rfc8446#section-4.2.10" rel="noopener ugc nofollow" target="_blank"> <em class="nw"> early_data </em> </a>扩展的支持，<strong class="le ix"> 0-RTT </strong>模式是不可能的。此外，为了避免重放攻击，<strong class="le ix"> 0-RTT </strong>要求服务器<a class="ae lb" href="https://tools.ietf.org/html/rfc8446#section-8" rel="noopener ugc nofollow" target="_blank">维护状态</a>，否则需要将范围限制在<a class="ae lb" href="https://tools.ietf.org/html/rfc8446#appendix-E.5" rel="noopener ugc nofollow" target="_blank">幂等应用</a>。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi om"><img src="../Images/97a0b1324d790ee58c31993f238d84b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4wi-LySXX6RS3mBYx2sbDg.png"/></div></div></figure><blockquote class="on oo op"><p id="15ae" class="lc ld nw le b lf lg jx lh li lj ka lk oq lm ln lo or lq lr ls os lu lv lw lx ig bi translated">第二类攻击无法在 TLS 层阻止，必须由任何应用程序来处理。请注意，其客户端实现任何类型的重试行为的任何应用程序都已经需要实现某种类型的防重放防御。</p></blockquote><p id="cfa9" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">除非客户端和服务器实现的<strong class="le ix"> 0-RTT </strong>模式可以确保一个密钥只使用<a class="ae lb" href="https://tools.ietf.org/html/rfc8446#section-8.1" rel="noopener ugc nofollow" target="_blank">一次</a>，应用层将需要决定服务器接受<strong class="le ix"> 0-RTT </strong>数据是否安全。在许多情况下，处理<strong class="le ix"> 0-RTT </strong>数据可能是安全的，例如通过<strong class="le ix"> HTTPS </strong>提供静态内容。</p></div><div class="ab cl mr ms hr mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ig ih ii ij ik"><h1 id="a303" class="my mz in bd na nb nc nd ne nf ng nh ni kc nj kd nk kf nl kg nm ki nn kj no np bi translated">将来的</h1><p id="0ca2" class="pw-post-body-paragraph lc ld in le b lf nq jx lh li nr ka lk ll ns ln lo lp nt lr ls lt nu lv lw lx ig bi translated">较新版本的 TLS 比以前的版本提供了更好的安全性。它几乎完全加密了握手，提供了前向保密，并抛弃了许多旧的/不安全的算法。虽然这对个人来说很好，但组织可能会发现使用这一新版本很难审计加密的 TLS 流量。</p><p id="3348" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">最初的<strong class="le ix"> TLS 1.2 </strong>协议于 2008 年 3 月获得批准。它多年来不断更新，经受住了时间的考验。因此，没有理由认为它会很快消失。不过，<strong class="le ix"> TLS 1.3 </strong>是未来。</p><h1 id="391e" class="my mz in bd na nb ot nd ne nf ou nh ni kc ov kd nk kf ow kg nm ki ox kj no np bi translated">参考资料:</h1><ol class=""><li id="62f7" class="oy oz in le b lf nq li nr ll pa lp pb lt pc lx pd pe pf pg bi translated"><strong class="le ix"> TLS 1.2 </strong>，<a class="ae lb" href="https://tools.ietf.org/html/rfc5246" rel="noopener ugc nofollow" target="_blank">https://tools.ietf.org/html/rfc5246</a></li><li id="4143" class="oy oz in le b lf ph li pi ll pj lp pk lt pl lx pd pe pf pg bi translated"><strong class="le ix"> TLS 1.3 </strong>，<a class="ae lb" href="https://tools.ietf.org/html/rfc8446" rel="noopener ugc nofollow" target="_blank">https://tools.ietf.org/html/rfc8446</a></li></ol></div><div class="ab cl mr ms hr mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ig ih ii ij ik"><p id="aa85" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated"><em class="nw">在第 0 根，我们提供解决方案</em> <a class="ae lb" href="https://www.0snet.com/" rel="noopener ugc nofollow" target="_blank"> <em class="nw">第 0 根安全网络— 0SNet </em> </a> <em class="nw">使用 TLS 客户端证书保护组织的内部 web 应用。看看我们的产品吧，它很容易部署，可以在</em><a class="ae lb" href="https://0snet.info/#install.aws" rel="noopener ugc nofollow" target="_blank"><em class="nw">AWS</em></a><em class="nw"/><a class="ae lb" href="https://0snet.info/#install.gcp" rel="noopener ugc nofollow" target="_blank"><em class="nw">GCP</em></a><em class="nw">和</em><a class="ae lb" href="https://0snet.info/#install.azu" rel="noopener ugc nofollow" target="_blank"><em class="nw">Azure</em></a><em class="nw">上找到。</em></p></div></div>    
</body>
</html>