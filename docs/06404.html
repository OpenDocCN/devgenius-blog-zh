<html>
<head>
<title>Custom Docker Bridge Networks— How to run Containers?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">定制 Docker 桥接网络——如何运行容器？</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/custom-docker-bridge-networks-how-to-run-containers-b8d40c51bab2?source=collection_archive---------3-----------------------#2022-01-05">https://blog.devgenius.io/custom-docker-bridge-networks-how-to-run-containers-b8d40c51bab2?source=collection_archive---------3-----------------------#2022-01-05</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="57a1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这篇博客是我们从零开始讨论<strong class="jm io"> DevOps </strong>概念系列的一部分。本文来自于<strong class="jm io"> <em class="ki">中级</em> </strong>系列，因为它涉及到了解本地 Docker 桥上的<a class="ae kj" href="https://docs.docker.com/network/" rel="noopener ugc nofollow" target="_blank"> <em class="ki"> </em> <strong class="jm io"> <em class="ki"> Docker 联网</em> </strong> </a>和一个小的<strong class="jm io"> Hello World <em class="ki"> </em> </strong>例子。</p><p id="3e94" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这一系列中的一些早期博客如下。</p><p id="9f9b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae kj" href="https://awstip.com/aws-lambda-simple-tweetbot-2f2f83fbe161" rel="noopener ugc nofollow" target="_blank"><strong class="jm io">TweetBot</strong></a><strong class="jm io"><br/></strong><a class="ae kj" href="https://towardsdev.com/deploying-on-azure-functions-github-actions-a8f2a98acc0f" rel="noopener ugc nofollow" target="_blank"><strong class="jm io">Azure 功能-GitHub 动作</strong></a><strong class="jm io"><br/></strong><a class="ae kj" rel="noopener ugc nofollow" target="_blank" href="/aws-config-iam-compliance-85220763bee5"><strong class="jm io">安全-自动化</strong> </a></p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div class="gh gi kk"><img src="../Images/ba77fa56bd9a32b0aede0a9f75537e4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:588/format:webp/1*if2TU4sdpi6a9xxMHHkQCQ.png"/></div></figure><h1 id="da3b" class="ks kt in bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">Docker 是什么？</h1><p id="9a8d" class="pw-post-body-paragraph jk jl in jm b jn lq jp jq jr lr jt ju jv ls jx jy jz lt kb kc kd lu kf kg kh ig bi translated">Docker 是一个开源包管理器，用于将软件部署为称为容器的隔离包。它是操作系统级虚拟化的扩展，内核允许多个用户空间实例共存。与<a class="ae kj" href="https://en.wikipedia.org/wiki/Hypervisor" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io">虚拟机管理程序</strong> </a> <strong class="jm io"> </strong>不同，后者<strong class="jm io"> </strong>用于在云资源上运行虚拟机，容器共享操作系统的内核，使其轻量级且快速启动和运行。</p><h1 id="9421" class="ks kt in bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">Docker 网络类型</h1><p id="d493" class="pw-post-body-paragraph jk jl in jm b jn lq jp jq jr lr jt ju jv ls jx jy jz lt kb kc kd lu kf kg kh ig bi translated">为了与运行容器的主机上的应用程序通信，有各种网络配置用于路由流量。两种常见 Docker 网络选项的简要说明:</p><p id="5544" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">网桥— </strong>默认网络驱动程序，在主机和容器之间创建网络隔离。它使用隔离子网将虚拟 IP 分配给正在运行的容器。</p><p id="7e7c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">主机— </strong>在独立容器的情况下，主机和容器之间的隔离可以使用主机网络来移除。在这种配置中，主机的实际子网 IP 地址用于运行容器。</p><p id="4a22" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">还有另一个 docker 网络驱动程序，如<strong class="jm io"> Overlay/Macvlan/None </strong>用于复杂的用例。</p><h1 id="2206" class="ks kt in bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">用户定义的桥</h1><p id="97e9" class="pw-post-body-paragraph jk jl in jm b jn lq jp jq jr lr jt ju jv ls jx jy jz lt kb kc kd lu kf kg kh ig bi translated">docker 守护进程使用默认的桥来托管任何新创建的容器。然而，该选项有一定的局限性，因此最好创建<strong class="jm io">用户定义的桥</strong>。默认网桥的一些主要区别如下-</p><p id="916d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">i) <strong class="jm io">更好的网络隔离</strong>——不相关的服务/容器可以使用不同的定制桥/子网来隔离，以避免任何不安全的通信和增强的安全性。<br/> ii) <strong class="jm io">自动 DNS 解析- </strong>共享同一个用户定义桥的多个<strong class="jm io"> </strong>容器除了使用 IP 之外，还可以使用 DNS 相互通信。<strong class="jm io"> <br/> </strong> iii) <strong class="jm io">容器的连接/分离</strong> -运行中的容器可以跨用户定义的桥进行迁移。默认网桥中的相同选项要求正在运行的容器在迁移前停止。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi lv"><img src="../Images/e05b8cdaa735004b374f6844bdd5f5f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7bie5fDxCi4G5RBZOMVqQw.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated"><strong class="bd ku">隔离用户定义的桥</strong></figcaption></figure><p id="6a33" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上图中，<strong class="jm io">服务 A/服务 B </strong>、<strong class="jm io">服务 C/服务 D </strong>可以相互通信，也可以与主机通信。但是<strong class="jm io">服务 A/服务 B </strong> - <strong class="jm io">服务 C/服务 D </strong>之间存在网络隔离</p><h2 id="d638" class="me kt in bd ku mf mg dn ky mh mi dp lc jv mj mk lg jz ml mm lk kd mn mo lo mp bi translated">创建用户定义的桥</h2><p id="264f" class="pw-post-body-paragraph jk jl in jm b jn lq jp jq jr lr jt ju jv ls jx jy jz lt kb kc kd lu kf kg kh ig bi translated">创建用户定义的网桥的第一步是使用以下命令创建虚拟网络</p><pre class="kl km kn ko gt mq mr ms mt aw mu bi"><span id="7426" class="me kt in mr b gy mv mw l mx my">docker network create my-net</span></pre><p id="400e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">可以使用以下命令检查虚拟网络</p><pre class="kl km kn ko gt mq mr ms mt aw mu bi"><span id="8d99" class="me kt in mr b gy mv mw l mx my">docker inspect create my-net</span></pre><p id="6235" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">上面的输出将显示所创建子网上的网关详细信息、CIDR 数据块/ IP4/IP6 设置</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mz"><img src="../Images/8e64e87d7f70ad126a05c3270af2ff9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vEIwhgEd1yzJgr455UtnyQ.png"/></div></div></figure><p id="0211" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">完成上述步骤后，网络就可以在相同的</p><h2 id="32d8" class="me kt in bd ku mf mg dn ky mh mi dp lc jv mj mk lg jz ml mm lk kd mn mo lo mp bi translated">在用户定义的桥上运行容器。</h2><p id="0518" class="pw-post-body-paragraph jk jl in jm b jn lq jp jq jr lr jt ju jv ls jx jy jz lt kb kc kd lu kf kg kh ig bi translated"><strong class="jm io">创建 Hello World DockerFile 文件</strong></p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="5082" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">打造 Hello World 形象</strong></p><pre class="kl km kn ko gt mq mr ms mt aw mu bi"><span id="257a" class="me kt in mr b gy mv mw l mx my">docker build . -t hello-world:1.0.0</span></pre><p id="8438" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">在用户定义的桥上运行 Hello World 容器</strong></p><pre class="kl km kn ko gt mq mr ms mt aw mu bi"><span id="4ad1" class="me kt in mr b gy mv mw l mx my">docker run -p 80:80  --name hello-world --network my-net hello-world:1.0.0</span></pre><h2 id="abde" class="me kt in bd ku mf mg dn ky mh mi dp lc jv mj mk lg jz ml mm lk kd mn mo lo mp bi translated">确认</h2><p id="07e1" class="pw-post-body-paragraph jk jl in jm b jn lq jp jq jr lr jt ju jv ls jx jy jz lt kb kc kd lu kf kg kh ig bi translated">在网络浏览器上打开端点<a class="ae kj" href="http://localhost/test.html" rel="noopener ugc nofollow" target="_blank">http://localhost/test . html</a></p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi nc"><img src="../Images/4848dc402327514c42c10fd95c8494e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*10pxDFRbRcxnr_6cQswASQ.png"/></div></div></figure><h2 id="70fa" class="me kt in bd ku mf mg dn ky mh mi dp lc jv mj mk lg jz ml mm lk kd mn mo lo mp bi translated">额外资源</h2><div class="nd ne gp gr nf ng"><a href="https://github.com/amit894/docker-images" rel="noopener  ugc nofollow" target="_blank"><div class="nh ab fo"><div class="ni ab nj cl cj nk"><h2 class="bd io gy z fp nl fr fs nm fu fw im bi translated">GitHub - amit894/docker-images:学习 docker 的报告</h2><div class="nn l"><h3 class="bd b gy z fp nl fr fs nm fu fw dk translated">用于学习 Docker docker 从容器注册表中拉取图像 Docker 推送图像到容器…</h3></div><div class="no l"><p class="bd b dl z fp nl fr fs nm fu fw dk translated">github.com</p></div></div><div class="np l"><div class="nq l nr ns nt np nu kq ng"/></div></div></a></div><p id="d9af" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="ki">如需反馈，请留言至</em><strong class="jm io"><em class="ki">Amit[dot]894[at]Gmail[dot]com</em></strong><em class="ki">或联系 https://about.me/amit_raj</em><a class="ae kj" href="https://about.me/amit_raj" rel="noopener ugc nofollow" target="_blank"><em class="ki">的任何链接。</em></a></p></div></div>    
</body>
</html>