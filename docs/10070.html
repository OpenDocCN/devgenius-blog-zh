<html>
<head>
<title>Simplify usage of Lens API with @use-lens and graphql-codegen</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过@use-lens 和 graphql-codegen 简化 Lens API 的使用</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/simplify-usage-of-lens-api-with-use-lens-and-graphql-codegen-62fbc43a0557?source=collection_archive---------13-----------------------#2022-10-04">https://blog.devgenius.io/simplify-usage-of-lens-api-with-use-lens-and-graphql-codegen-62fbc43a0557?source=collection_archive---------13-----------------------#2022-10-04</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><figure class="im in gp gr io ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/651e493174c0c4625a73a969bd613615.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kyonSUBlzlfhd5-TlJ2ItA.png"/></div></div></figure><div class=""/><h1 id="f2d5" class="jv jw iy bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">🔗链接</h1><ul class=""><li id="13f9" class="kt ku iy kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated"><a class="ae ll" href="https://github.com/andriishupta" rel="noopener ugc nofollow" target="_blank"> andriishupta | Github </a></li><li id="ba88" class="kt ku iy kv b kw lm ky ln la lo lc lp le lq lg lh li lj lk bi translated"><a class="ae ll" href="https://github.com/use-lens/use-lens" rel="noopener ugc nofollow" target="_blank">使用镜头| Github </a></li><li id="1a28" class="kt ku iy kv b kw lm ky ln la lo lc lp le lq lg lh li lj lk bi translated"><a class="ae ll" href="https://docs.lens.xyz/" rel="noopener ugc nofollow" target="_blank">镜头 API </a></li><li id="3e74" class="kt ku iy kv b kw lm ky ln la lo lc lp le lq lg lh li lj lk bi translated"><a class="ae ll" href="https://the-guild.dev/graphql/codegen" rel="noopener ugc nofollow" target="_blank"> GraphQL 代码生成器</a></li></ul><h1 id="f3ba" class="jv jw iy bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">📰发布于</h1><ul class=""><li id="44ab" class="kt ku iy kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated"><a class="ae ll" href="https://blog.andriishupta.dev/" rel="noopener ugc nofollow" target="_blank">哈希节点💻</a></li><li id="f6ba" class="kt ku iy kv b kw lm ky ln la lo lc lp le lq lg lh li lj lk bi translated"><a class="ae ll" href="https://andriishupta.medium.com/" rel="noopener">中型✍️ </a></li><li id="8083" class="kt ku iy kv b kw lm ky ln la lo lc lp le lq lg lh li lj lk bi translated"><a class="ae ll" href="https://dev.to/andriishupta" rel="noopener ugc nofollow" target="_blank">开发社区👩‍💻👨‍💻</a></li></ul><h1 id="d02c" class="jv jw iy bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">🤓介绍</h1><p id="d013" class="pw-post-body-paragraph lr ls iy kv b kw kx lt lu ky kz lv lw la lx ly lz lc ma mb mc le md me mf lg ig bi translated">最近，我使用 Lens API 构建了一些 playground 应用程序，并注意到了一个重复的任务:我为每个项目创建了 Lens API 查询和变异，并使用<a class="ae ll" href="https://the-guild.dev/graphql/codegen" rel="noopener ugc nofollow" target="_blank"> GraphQL 代码生成器</a>将 React hooks 用于 Apollo 客户端。</p><p id="f48a" class="pw-post-body-paragraph lr ls iy kv b kw mg lt lu ky mh lv lw la mi ly lz lc mj mb mc le mk me mf lg ig bi translated">在第二次做同样的工作后，我决定创建一个更容易使用 Lens API 的库，这样可以节省我做实际工作的时间。</p><p id="21b2" class="pw-post-body-paragraph lr ls iy kv b kw mg lt lu ky mh lv lw la mi ly lz lc mj mb mc le mk me mf lg ig bi translated">我从来没有创建过开源包，认为这样做是一种很棒的体验，即使只有我会使用它😅。</p><p id="d4ed" class="pw-post-body-paragraph lr ls iy kv b kw mg lt lu ky mh lv lw la mi ly lz lc mj mb mc le mk me mf lg ig bi translated">npm <a class="ae ll" href="https://www.npmjs.com/org/use-lens" rel="noopener ugc nofollow" target="_blank"> @use-lens </a>到目前为止包含 2 个包——<em class="ml">CLI</em>和<em class="ml"> react-apollo </em>。在本文的后面，我将解释如何以及何时使用它们，同样的信息可以在<a class="ae ll" href="https://github.com/use-lens/use-lens/#-usage" rel="noopener ugc nofollow" target="_blank"> repo 的 README.md </a>中找到。我将在文章的后面解释我是如何最好地使用<code class="fe mm mn mo mp b">@use-lens/*</code>的。</p><p id="ead2" class="pw-post-body-paragraph lr ls iy kv b kw mg lt lu ky mh lv lw la mi ly lz lc mj mb mc le mk me mf lg ig bi translated">此外，我非常喜欢 Lens 协议，所以我创建了 Github 组织<a class="ae ll" href="https://github.com/use-lens" rel="noopener ugc nofollow" target="_blank"> Use Lens </a>，我计划在那里开发和发布一些基于 Lens 的工具、示例和应用程序。</p><h1 id="60b2" class="jv jw iy bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">技术</h1><blockquote class="mq mr ms"><p id="b824" class="lr ls ml kv b kw mg lt lu ky mh lv lw mt mi ly lz mu mj mb mc mv mk me mf lg ig bi translated">Lens Protocol 是一个可组合的去中心化社交图，随时可供您构建，因此您可以专注于创建出色的体验，而不是扩展您的用户。</p><p id="feab" class="lr ls ml kv b kw mg lt lu ky mh lv lw mt mi ly lz mu mj mb mc mv mk me mf lg ig bi translated">拥有自己的内容。拥有你的社交图谱。拥有您的数据。</p></blockquote><p id="0431" class="pw-post-body-paragraph lr ls iy kv b kw mg lt lu ky mh lv lw la mi ly lz lc mj mb mc le mk me mf lg ig bi translated">如果你已经读到这里——你知道什么是镜头 API，以及如何使用它。如果你是来检查<code class="fe mm mn mo mp b">@use-lens</code>或者只是来检查如何生成 GraphQL 代码——在这里自学 Lens 协议和 API:</p><p id="ca2d" class="pw-post-body-paragraph lr ls iy kv b kw mg lt lu ky mh lv lw la mi ly lz lc mj mb mc le mk me mf lg ig bi translated">🌿<a class="ae ll" href="https://docs.lens.xyz" rel="noopener ugc nofollow" target="_blank"> docs.lens.xyz </a>。</p><p id="a7a5" class="pw-post-body-paragraph lr ls iy kv b kw mg lt lu ky mh lv lw la mi ly lz lc mj mb mc le mk me mf lg ig bi translated"><a class="ae ll" href="https://the-guild.dev/graphql/codegen" rel="noopener ugc nofollow" target="_blank"> GraphQL 代码生成器</a>——这是一个工具，它通过一个简单的 CLI 从您的 GraphQL 模式和操作中构建易于使用的代码，该 CLI 带有许多用于不同框架的插件:React、Next.js、Svelte、Vue with Apollo、URLQ 和其他——只要您能想到的。</p><h1 id="2c69" class="jv jw iy bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">🧑‍💻如何</h1><h1 id="505b" class="jv jw iy bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">用<a class="ae ll" href="https://github.com/use-lens/use-lens/tree/main/packages/cli" rel="noopener ugc nofollow" target="_blank"> @use-lens/cli </a>生成</h1><pre class="mw mx my mz gt na mp nb nc aw nd bi"><span id="e0df" class="ne jw iy mp b gy nf ng l nh ni">npm install --save-dev @use-lens/cli<br/>use-lens generate %PACKAGE%</span></pre><p id="f4ec" class="pw-post-body-paragraph lr ls iy kv b kw mg lt lu ky mh lv lw la mi ly lz lc mj mb mc le mk me mf lg ig bi translated">使用 npx</p><pre class="mw mx my mz gt na mp nb nc aw nd bi"><span id="c7c1" class="ne jw iy mp b gy nf ng l nh ni">npx @use-lens/cli generate %PACKAGE%</span></pre><p id="2e3d" class="pw-post-body-paragraph lr ls iy kv b kw mg lt lu ky mh lv lw la mi ly lz lc mj mb mc le mk me mf lg ig bi translated">这会将 Lens API 的基本文件复制到您的 repo 中，并运行<code class="fe mm mn mo mp b">graphql-codegen</code>来生成代码。默认情况下，它会转到<code class="fe mm mn mo mp b">src/lens-api/index.ts</code>。从这里，你可以调整<code class="fe mm mn mo mp b">tsconfig.json</code>来使用<code class="fe mm mn mo mp b">@use-lens</code>缩短，所以它会感觉像一个包的用法。更多关于如何做的信息<a class="ae ll" href="https://github.com/use-lens/use-lens/tree/main/packages/cli#optional-tsconfigs-paths" rel="noopener ugc nofollow" target="_blank">请点击</a>。</p><h1 id="50d4" class="jv jw iy bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">与<code class="fe mm mn mo mp b">@use-lens/*</code></h1><p id="7555" class="pw-post-body-paragraph lr ls iy kv b kw kx lt lu ky kz lv lw la lx ly lz lc ma mb mc le md me mf lg ig bi translated">简单的<code class="fe mm mn mo mp b">npm install --save @use-lens/%PACKAGE%</code>并把它作为一个普通包使用。</p><pre class="mw mx my mz gt na mp nb nc aw nd bi"><span id="c790" class="ne jw iy mp b gy nf ng l nh ni">import {<br/>  GlobalProtocolStatsDocument,<br/>  GlobalProtocolStats as GlobalProtocolStatsType,<br/>  useGlobalProtocolStatsQuery,<br/>  useGlobalProtocolStatsLazyQuery,<br/>} from '@use-lens/react-apollo'</span></pre><h1 id="5dc5" class="jv jw iy bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">手动 GraphQL 代码生成器</h1><p id="b3d1" class="pw-post-body-paragraph lr ls iy kv b kw kx lt lu ky kz lv lw la lx ly lz lc ma mb mc le md me mf lg ig bi translated">默认的方法很简单，可以遵循正式文件<a class="ae ll" href="https://the-guild.dev/graphql/codegen/docs/getting-started" rel="noopener ugc nofollow" target="_blank">这里</a></p><p id="9665" class="pw-post-body-paragraph lr ls iy kv b kw mg lt lu ky mh lv lw la mi ly lz lc mj mb mc le mk me mf lg ig bi translated">在高层次上:</p><ul class=""><li id="5445" class="kt ku iy kv b kw mg ky mh la nj lc nk le nl lg lh li lj lk bi translated">安装<code class="fe mm mn mo mp b">@graphql-codegen/cli</code></li><li id="88ae" class="kt ku iy kv b kw lm ky ln la lo lc lp le lq lg lh li lj lk bi translated">为你的堆栈选择一个插件:例如，<a class="ae ll" href="https://www.the-guild.dev/graphql/codegen/plugins/typescript/typescript-react-apollo" rel="noopener ugc nofollow" target="_blank"> react-apollo </a>并安装它</li><li id="1363" class="kt ku iy kv b kw lm ky ln la lo lc lp le lq lg lh li lj lk bi translated">获取您的 GraphQL 模式和文档</li><li id="e7bc" class="kt ku iy kv b kw lm ky ln la lo lc lp le lq lg lh li lj lk bi translated">为<code class="fe mm mn mo mp b">graphql-codegen</code>创建基本<code class="fe mm mn mo mp b">codegen.yml</code></li><li id="a538" class="kt ku iy kv b kw lm ky ln la lo lc lp le lq lg lh li lj lk bi translated">运行<code class="fe mm mn mo mp b">graphql-codegen</code></li></ul><p id="92c4" class="pw-post-body-paragraph lr ls iy kv b kw mg lt lu ky mh lv lw la mi ly lz lc mj mb mc le mk me mf lg ig bi translated">在您的<code class="fe mm mn mo mp b">codegen.yml</code>中，您应该指定模式、文档、保存位置和内容:</p><pre class="mw mx my mz gt na mp nb nc aw nd bi"><span id="c873" class="ne jw iy mp b gy nf ng l nh ni">schema: schema.graphql # full schema; could be HTTP link<br/>documents: documents.graphql # queries and mutations that you want to have<br/>generates:<br/>  ./src/my-api/index.ts: # where to save<br/>    plugins:<br/>      - typescript<br/>      - typescript-operations<br/>      - typescript-react-apollo # stack that you are going to use</span></pre><h1 id="0d02" class="jv jw iy bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">⚠️警告</h1><p id="196f" class="pw-post-body-paragraph lr ls iy kv b kw kx lt lu ky kz lv lw la lx ly lz lc ma mb mc le md me mf lg ig bi translated">🌿<a class="ae ll" href="https://docs.lens.xyz/docs/introduction" rel="noopener ugc nofollow" target="_blank">docs.lens.xyz/docs/introduction</a>:</p><blockquote class="mq mr ms"><p id="7500" class="lr ls ml kv b kw mg lt lu ky mh lv lw mt mi ly lz mu mj mb mc mv mk me mf lg ig bi translated">这个 API 是测试版，还没有完成生产，这意味着我们可以在任何时候改变模式和端点，而不会警告或通知你。当这个 API 生产就绪时，我们将删除这个测试警告，并努力确保没有任何变化，除非需要对协议本身进行重大更改。</p></blockquote><p id="9e5c" class="pw-post-body-paragraph lr ls iy kv b kw mg lt lu ky mh lv lw la mi ly lz lc mj mb mc le mk me mf lg ig bi translated">镜头 API 没有量产完成，<code class="fe mm mn mo mp b">@use-lens/*</code>也是。请在生产时记住这一点。</p><h1 id="cc66" class="jv jw iy bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">推荐用途</h1><p id="f8b8" class="pw-post-body-paragraph lr ls iy kv b kw kx lt lu ky kz lv lw la lx ly lz lc ma mb mc le md me mf lg ig bi translated">如果你想用镜头 API 玩<strong class="kv iz">——不要犹豫，安装一些<code class="fe mm mn mo mp b">@use-lens/*</code>包——它会给你所有你需要的开始。</strong></p><p id="e32b" class="pw-post-body-paragraph lr ls iy kv b kw mg lt lu ky mh lv lw la mi ly lz lc mj mb mc le mk me mf lg ig bi translated">如果你想让<strong class="kv iz">有更多的控制权</strong>——使用<code class="fe mm mn mo mp b">@use-lens/cli</code>在本地生成代码。这将复制包中包含的基本文件，并运行<code class="fe mm mn mo mp b">graphql-codegen</code>。</p><p id="ec84" class="pw-post-body-paragraph lr ls iy kv b kw mg lt lu ky mh lv lw la mi ly lz lc mj mb mc le mk me mf lg ig bi translated">你可以用<code class="fe mm mn mo mp b">codegen.yml</code>做更多的事情。</p><h1 id="cb91" class="jv jw iy bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">👨‍🏫与阿波罗客户互动</h1><p id="03b3" class="pw-post-body-paragraph lr ls iy kv b kw kx lt lu ky kz lv lw la lx ly lz lc ma mb mc le md me mf lg ig bi translated">对于<code class="fe mm mn mo mp b">@use-lens/react-apollo</code>，我准备了一个如何使用它的例子。</p><p id="d3fd" class="pw-post-body-paragraph lr ls iy kv b kw mg lt lu ky mh lv lw la mi ly lz lc mj mb mc le mk me mf lg ig bi translated">点击查看源代码<a class="ae ll" href="https://github.com/use-lens/use-lens/tree/main/examples/react-apollo" rel="noopener ugc nofollow" target="_blank"/></p><figure class="mw mx my mz gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi nm"><img src="../Images/323080416cf9c99821570ceaeab098e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LR5B3kWI50wvbKwP"/></div></div></figure><figure class="mw mx my mz gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi nn"><img src="../Images/7fc843b698296da65038493bd03b8304.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*28JptHa7V6BThmtg"/></div></div></figure><h1 id="749d" class="jv jw iy bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">🤝镜头 API 文档</h1><p id="dd35" class="pw-post-body-paragraph lr ls iy kv b kw kx lt lu ky kz lv lw la lx ly lz lc ma mb mc le md me mf lg ig bi translated">完整的镜头 api 文档集取自<a class="ae ll" href="https://github.com/lens-protocol/api-examples" rel="noopener ugc nofollow" target="_blank"> api-examples </a>，这是一份显示如何使用镜头 API 的镜头协议报告。Lens API 文档中给出了相同(或相似)的查询示例。</p><h1 id="982b" class="jv jw iy bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">📚摘要</h1><p id="983c" class="pw-post-body-paragraph lr ls iy kv b kw kx lt lu ky kz lv lw la lx ly lz lc ma mb mc le md me mf lg ig bi translated">如果你想使用 Lens API 看看它是什么——通过使用<a class="ae ll" href="https://github.com/use-lens/use-lens" rel="noopener ugc nofollow" target="_blank"> @use-lens </a>或<a class="ae ll" href="https://the-guild.dev/graphql/codegen" rel="noopener ugc nofollow" target="_blank"> GraphQL 代码生成器</a>来简化你的开发者体验。</p><p id="91cb" class="pw-post-body-paragraph lr ls iy kv b kw mg lt lu ky mh lv lw la mi ly lz lc mj mb mc le mk me mf lg ig bi translated">感谢阅读！🙇</p></div><div class="ab cl no np hr nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ig ih ii ij ik"><p id="3ffa" class="pw-post-body-paragraph lr ls iy kv b kw mg lt lu ky mh lv lw la mi ly lz lc mj mb mc le mk me mf lg ig bi translated"><em class="ml">原发布于</em><a class="ae ll" href="https://blog.andriishupta.dev/simplify-usage-of-lens-api-with-use-lens-and-graphql-codegen" rel="noopener ugc nofollow" target="_blank"><em class="ml">https://blog . andriishupta . dev</em></a><em class="ml">。</em></p></div></div>    
</body>
</html>