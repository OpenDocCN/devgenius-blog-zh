<html>
<head>
<title>Intro to Hooks in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React中的挂钩简介</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/intro-to-hooks-in-react-a2406891480b?source=collection_archive---------34-----------------------#2020-07-12">https://blog.devgenius.io/intro-to-hooks-in-react-a2406891480b?source=collection_archive---------34-----------------------#2020-07-12</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="e197" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们如何在React中应用<code class="fe ki kj kk kl b">useState()</code>和<code class="fe ki kj kk kl b">useEffect()</code>？</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/eb3f977d19328e8e08ed9436cef4560a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BNZqzOuoEzuCwuy-hLpU1g.jpeg"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">鱼钩</figcaption></figure><p id="f806" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要理解hooks，您应该对以下内容有一个很好的理解:</p><ul class=""><li id="ba3c" class="lc ld in jm b jn jo jr js jv le jz lf kd lg kh lh li lj lk bi translated">反应16.8+</li><li id="5b00" class="lc ld in jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated">状态和道具</li><li id="fd90" class="lc ld in jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated">生命周期方法</li><li id="c3fb" class="lc ld in jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated">功能组件</li></ul><h1 id="2490" class="lq lr in bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">什么是钩子？</h1><p id="6149" class="pw-post-body-paragraph jk jl in jm b jn mo jp jq jr mp jt ju jv mq jx jy jz mr kb kc kd ms kf kg kh ig bi translated">钩子是16.8版本中为React添加的JavaScript函数。它们允许开发人员“挂钩”react特性并操纵状态，而无需编写类。它们的目的不是从React中删除类组件，而是节省在类、函数、高阶组件和渲染道具之间切换的时间。当您第一次开始练习钩子时，最好先用不复杂的组件来尝试它们，然后再编写更复杂的组件，看看它们的全部潜力。它们也可以<strong class="jm io">仅</strong>用于功能组件。</p><h1 id="ef4b" class="lq lr in bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">useState()挂钩</h1><p id="8d9a" class="pw-post-body-paragraph jk jl in jm b jn mo jp jq jr mp jt ju jv mq jx jy jz mr kb kc kd ms kf kg kh ig bi translated">要声明state，您必须设置两个变量，在本例中我们将使用<code class="fe ki kj kk kl b">count</code>和<code class="fe ki kj kk kl b">setCount</code>，并将其设置为等于<code class="fe ki kj kk kl b">useState()</code>函数。传递给<code class="fe ki kj kk kl b">useState()</code>函数的参数将是我们的初始值。我们必须设置两个变量，因为<code class="fe ki kj kk kl b">useState()</code>返回一对值。让我们把它编码出来！</p><pre class="kn ko kp kq gt mt kl mu mv aw mw bi"><span id="f2df" class="mx lr in kl b gy my mz l na nb">import React, {useState} from 'react';</span><span id="3cd4" class="mx lr in kl b gy nc mz l na nb">function Counter() {</span><span id="1b4a" class="mx lr in kl b gy nc mz l na nb">//Here we declared 'count' and 'setCount'<br/>//count is set to equal 0, and setCount is our function that we will use to update state later</span><span id="b4e2" class="mx lr in kl b gy nc mz l na nb"> const [count, setCount] = useState(0);</span><span id="c508" class="mx lr in kl b gy nc mz l na nb">}</span></pre><p id="7e37" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们之所以把<code class="fe ki kj kk kl b">count</code>和<code class="fe ki kj kk kl b">setCount</code>放在一个数组中，是因为如前所述，<code class="fe ki kj kk kl b">useState()</code>返回一对值。这被称为<strong class="jm io">数组析构。</strong>引擎盖下基本就是这个样子。</p><pre class="kn ko kp kq gt mt kl mu mv aw mw bi"><span id="ec8a" class="mx lr in kl b gy my mz l na nb">let counterVariable = useState(0);<br/>let counter = counterVariable[0];<br/>let setCounter = counterVariable[1]; </span></pre><p id="2ff4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">回到我们的函数，如果我们想要读取我们的当前状态，我们可以像这样将<code class="fe ki kj kk kl b">count</code>变量添加到我们的返回中。</p><pre class="kn ko kp kq gt mt kl mu mv aw mw bi"><span id="d0cc" class="mx lr in kl b gy my mz l na nb">import React, {useState} from 'react';</span><span id="b7a0" class="mx lr in kl b gy nc mz l na nb">function Counter() {</span><span id="c11a" class="mx lr in kl b gy nc mz l na nb">//Here we declared 'count' and 'setCount' to equal 0<br/> const [count, setCount] = useState(0);</span><span id="545c" class="mx lr in kl b gy nc mz l na nb"> return (<br/>  &lt;div&gt;<br/>   &lt;h1&gt;You clicked me {count} times!&lt;/h1&gt;<br/>  &lt;/div&gt;<br/> );<br/>}</span></pre><p id="0581" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">接下来，让我们添加一个按钮和一些功能，使我们的计数器增加每次点击按钮。为此，我们将调用我们声明的另一个变量<code class="fe ki kj kk kl b">setCount</code>，它是function，类似于类组件中的<code class="fe ki kj kk kl b">this.setState()</code>。让我们看看那是什么样子。</p><pre class="kn ko kp kq gt mt kl mu mv aw mw bi"><span id="57ca" class="mx lr in kl b gy my mz l na nb">import React, {useState} from 'react';</span><span id="94e2" class="mx lr in kl b gy nc mz l na nb">function Counter() {</span><span id="421a" class="mx lr in kl b gy nc mz l na nb"> const [count, setCount] = useState(0);</span><span id="d1c7" class="mx lr in kl b gy nc mz l na nb">return (<br/>  &lt;div&gt;<br/>   &lt;h1&gt;You clicked me {count} times!&lt;/h1&gt;</span><span id="5e21" class="mx lr in kl b gy nc mz l na nb">   &lt;button onClick={() -&gt; setCount(count + 1)}<br/>    Click me!!<br/>   &lt;/button&gt;<br/>  &lt;/div&gt;<br/> );<br/>}</span></pre><p id="f39c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这就是我们的计数器功能！如果一开始这一切都没有意义，那也没关系。这肯定是需要习惯的东西，并且再次从简单的功能开始，然后在此基础上进行构建。只是需要大量的练习！</p><h1 id="165a" class="lq lr in bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">useEffect()挂钩</h1><p id="5498" class="pw-post-body-paragraph jk jl in jm b jn mo jp jq jr mp jt ju jv mq jx jy jz mr kb kc kd ms kf kg kh ig bi translated"><code class="fe ki kj kk kl b">useEffect()</code>钩子允许你在应用程序中执行副作用。该功能类似于<code class="fe ki kj kk kl b">componentDidMount</code>、<code class="fe ki kj kk kl b">componentDidUpdate</code>和<code class="fe ki kj kk kl b">componentWillUnmount</code>。你可以把<code class="fe ki kj kk kl b">useEffect()</code>想象成这三种功能的组合！整洁对吗？</p><p id="8744" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在类组件中，你通常需要在这两个函数中有重复代码的<code class="fe ki kj kk kl b">componentDidMount</code>和<code class="fe ki kj kk kl b">componentDidUpdate</code>。相反，使用钩子，你只需调用<code class="fe ki kj kk kl b">useEffect()</code>并传入你想要挂载的东西，react就会自动知道何时更新它，何时卸载它。让我们用之前的例子来说明如何利用这一点。</p><pre class="kn ko kp kq gt mt kl mu mv aw mw bi"><span id="6338" class="mx lr in kl b gy my mz l na nb">import React, {useState, useEffect} from 'react';</span><span id="c6d7" class="mx lr in kl b gy nc mz l na nb">function Counter() {</span><span id="8fea" class="mx lr in kl b gy nc mz l na nb"> const [count, setCount] = useState(0);</span><span id="5ac7" class="mx lr in kl b gy nc mz l na nb"> useEffect(() =&gt; {<br/>  document.title = `You clicked me ${count} times!`;<br/>})</span><span id="57cb" class="mx lr in kl b gy nc mz l na nb">return (<br/>  &lt;div&gt;<br/>   &lt;h1&gt;You clicked me {count} times!&lt;/h1&gt;<br/>    &lt;button onClick={() -&gt; setCount(count + 1)}<br/>    Click me!!<br/>    &lt;/button&gt;<br/>  &lt;/div&gt;<br/> );<br/>}</span></pre><p id="7621" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们传入<code class="fe ki kj kk kl b">useEffect()</code>的函数就是效果。在我们的函数中，我们以文档的标题为目标。当react渲染这个组件时，它会记住我们在<code class="fe ki kj kk kl b">useEffect()</code>中使用的效果，并在DOM更新后运行<em class="nd">。同样值得注意的是，传递给<code class="fe ki kj kk kl b">useEffect()</code>的函数在每次渲染时都会有所不同，因为它总是拥有<code class="fe ki kj kk kl b">count</code>的当前更新值。每次我们的应用程序重新渲染时，我们实际上是用预定的不同效果替换了之前的效果。</em></p><h2 id="58e5" class="mx lr in bd ls ne nf dn lw ng nh dp ma jv ni nj me jz nk nl mi kd nm nn mm no bi translated">使用useEffect()清理</h2><p id="2b83" class="pw-post-body-paragraph jk jl in jm b jn mo jp jq jr mp jt ju jv mq jx jy jz mr kb kc kd ms kf kg kh ig bi translated">假设您正在使用API构建一个社交媒体应用程序，并且想要添加一个“添加朋友”功能。当使用类时，你必须使用<code class="fe ki kj kk kl b">componentDidMount()</code>和<code class="fe ki kj kk kl b">componentWillUnmount()</code>来改变状态，当一个用户成为另一个用户的“朋友”或“解除朋友”时。有了钩子，<code class="fe ki kj kk kl b">useEffect()</code>让同时处理这两种功能变得更加容易。</p><pre class="kn ko kp kq gt mt kl mu mv aw mw bi"><span id="4db1" class="mx lr in kl b gy my mz l na nb">import React, { useState, useEffect } from 'react';</span><span id="1c01" class="mx lr in kl b gy nc mz l na nb">function Add(props) {</span><span id="7205" class="mx lr in kl b gy nc mz l na nb"> const [isFriended, setIsFriended] = useState(null)</span><span id="96bb" class="mx lr in kl b gy nc mz l na nb"> const handleFriendChange = (status) {<br/>  setIsFriended(status.isFriended);<br/>}</span><span id="9fed" class="mx lr in kl b gy nc mz l na nb"> useEffect(() =&gt; {<br/>  SocialMediaAPI.addFriend(props.friend.id, handleFriendChange)</span><span id="0a32" class="mx lr in kl b gy nc mz l na nb">  //This function will trigger when the component unmounts<br/>  return () =&gt; {<br/>   SocialMediaAPI.removeFriend(props.friend.id, handleFriendChange);<br/>  }<br/> })<br/>}</span></pre><p id="a853" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">简单来说就是<code class="fe ki kj kk kl b">useState()</code>和<code class="fe ki kj kk kl b">useEffect()</code>！如果你想深入了解，了解其他类型的钩子，或者想学习如何创建自己的钩子，请查看下面的文档。黑客快乐！</p><div class="np nq gp gr nr ns"><a href="https://reactjs.org/docs/hooks-intro.html" rel="noopener  ugc nofollow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd io gy z fp nx fr fs ny fu fw im bi translated">介绍钩子-反应</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">钩子是React 16.8中的新增功能。它们允许您使用状态和其他React特性，而无需编写类。这个…</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">reactjs.org</p></div></div><div class="ob l"><div class="oc l od oe of ob og kw ns"/></div></div></a></div><div class="np nq gp gr nr ns"><a href="https://reactjs.org/docs/hooks-reference.html" rel="noopener  ugc nofollow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd io gy z fp nx fr fs ny fu fw im bi translated">钩子API参考-反应</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">钩子是React 16.8中的新增功能。它们允许您使用状态和其他React特性，而无需编写类。这个…</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">reactjs.org</p></div></div><div class="ob l"><div class="oh l od oe of ob og kw ns"/></div></div></a></div></div></div>    
</body>
</html>