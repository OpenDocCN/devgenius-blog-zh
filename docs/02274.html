<html>
<head>
<title>Vue Tips — Slots, Vue Router, and Mutations</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Vue 提示—插槽、Vue 路由器和突变</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/vue-tips-slots-vue-router-and-mutations-93c2ffca5bce?source=collection_archive---------6-----------------------#2020-07-26">https://blog.devgenius.io/vue-tips-slots-vue-router-and-mutations-93c2ffca5bce?source=collection_archive---------6-----------------------#2020-07-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/77f1f6950940b65277f6cd5bbcab1f16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pr-q_0oxjetuI90V"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://unsplash.com/@joyceromero?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">乔伊斯·罗梅罗</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="14a8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vue.js 是一个用于创建前端 web 应用程序的流行框架。</p><p id="f2a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解一些编写更好的 Vue.js 应用程序的技巧。</p><h1 id="a1a9" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">如何传递包装组件中的插槽</h1><p id="5849" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">为了传递包装组件中的插槽，我们可以遍历所有插槽，并将它们传递给子组件。</p><p id="22d3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="478d" class="mn lc iq mj b gy mo mp l mq mr">&lt;wrapper&gt;<br/>  &lt;parent-table v-bind="$attrs" v-on="$listeners"&gt;</span><span id="4dc4" class="mn lc iq mj b gy ms mp l mq mr">    &lt;slot v-for="slot in Object.keys($slots)" :name="slot" :slot="slot"/&gt;</span><span id="8889" class="mn lc iq mj b gy ms mp l mq mr">    &lt;template v-for="slot in Object.keys($scopedSlots)" :slot="slot" slot-scope="scope"&gt;<br/>      &lt;slot :name="slot" v-bind="scope"/&gt;<br/>    &lt;/template&gt;</span><span id="11da" class="mn lc iq mj b gy ms mp l mq mr">  &lt;/parent-table&gt;<br/>&lt;/wrapper&gt;</span></pre><p id="b319" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe mt mu mv mj b">$slots</code>变量得到槽。</p><p id="4691" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们使用<code class="fe mt mu mv mj b">Object.keys</code>来获取插槽的名称，这样我们就可以遍历所有的插槽，并将名称传递下去。</p><p id="aae4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同样，我们可以用<code class="fe mt mu mv mj b">$scopedSlots</code>变量遍历作用域槽。</p><p id="8223" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们以同样的方式获取密钥，并用<code class="fe mt mu mv mj b">v-for</code>以同样的方式循环遍历它们。</p><p id="4bd1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在 Vue 2.6 中，引入了<code class="fe mt mu mv mj b">v-slot=</code>指令来让 is 向下传递插槽。</p><p id="2f1b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="9847" class="mn lc iq mj b gy mo mp l mq mr">&lt;wrapper&gt;<br/>  &lt;parent-table v-bind="$attrs" v-on="$listeners"&gt;<br/>    &lt;template v-for="(_, slot) of $scopedSlots" v-slot:[slot]="scope"&gt;<br/>      &lt;slot :name="slot" v-bind="scope"/&gt;<br/>    &lt;/template&gt;<br/>  &lt;/parent-table&gt;<br/>&lt;/wrapper&gt;</span></pre><p id="b272" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe mt mu mv mj b">v-for</code>循环通过插槽。</p><p id="e151" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe mt mu mv mj b">$scopedSlots</code>变量获取作用域槽。</p><p id="e612" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">slot</code>又是槽名。</p><p id="5363" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这一次，我们将它作为修饰符传递给<code class="fe mt mu mv mj b">v-slot</code>指令，以传递已命名的槽。</p><p id="e66b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">scope</code>具有作用域槽中的作用域。</p><p id="a3bc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们使用<code class="fe mt mu mv mj b">v-bind</code>来获取范围。</p><p id="a162" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">而我们</p><p id="432f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">或者，我们可以使用渲染函数来传递插槽。</p><p id="b14d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="98fe" class="mn lc iq mj b gy mo mp l mq mr">render(h) {<br/>  const children = Object.keys(this.$slots)<br/>    .map(slot =&gt; h('template', { slot }, this.$slots[slot]))</span><span id="ac9e" class="mn lc iq mj b gy ms mp l mq mr">  return h('wrapper', [<br/>    h('parent-table', {<br/>      attrs: this.$attrs,<br/>      on: this.$listeners,<br/>      scopedSlots: this.$scopedSlots,<br/>    }, children)<br/>  ])<br/>}</span></pre><p id="2761" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe mt mu mv mj b">this.$slots</code>属性获取插槽。</p><p id="fdc4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们调用<code class="fe mt mu mv mj b">Object.keys</code>来获取插槽名称。</p><p id="6727" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们调用它的<code class="fe mt mu mv mj b">map</code>来将插槽名称映射到<code class="fe mt mu mv mj b">template</code>组件。</p><p id="41f2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们向下传递插槽名称和范围。</p><p id="4149" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们返回一个带有<code class="fe mt mu mv mj b">parent-table</code>组件的<code class="fe mt mu mv mj b">wrapper</code>组件，组件带有监听器、属性和作用域槽，而<code class="fe mt mu mv mj b">children</code>是子组件。</p><h1 id="b67c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">从 Vue.js 中的 URL 获取查询参数</h1><p id="554c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用<code class="fe mt mu mv mj b">this.$route.query</code>属性从 Vue 中的 URL 获取查询参数。</p><p id="bc90" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了获得查询参数<code class="fe mt mu mv mj b">foo=bar</code>，我们编写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="3708" class="mn lc iq mj b gy mo mp l mq mr">this.$route.query.foo</span></pre><p id="996a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们得到<code class="fe mt mu mv mj b">'bar'</code>作为值。</p><p id="8b18" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设我们在 Vue 应用中使用 Vue 路由器，这是可用的。</p><p id="67b2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们没有添加它，我们可以写:</p><p id="b2e8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">index.html</code></p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="2e81" class="mn lc iq mj b gy mo mp l mq mr">&lt;script src="https://unpkg.com/vue-router"&gt;&lt;/script&gt;</span></pre><p id="f433" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">index.js</code></p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="d842" class="mn lc iq mj b gy mo mp l mq mr">const router = new VueRouter({<br/>  mode: 'history',<br/>  routes: [<br/>    { <br/>      path: '/page', <br/>      name: 'page', <br/>      component: PageComponent<br/>    }<br/>  ]<br/>});</span><span id="a67f" class="mn lc iq mj b gy ms mp l mq mr">const vm = new Vue({<br/>  router,<br/>  el: '#app',<br/>  mounted() {<br/>    const q = this.$route.query.q;<br/>    console.log(q)<br/>  },<br/>});</span></pre><p id="4d63" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">去得到它。</p><p id="4759" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们创建了<code class="fe mt mu mv mj b">VueRouter</code>实例，并将其传递给我们传递给<code class="fe mt mu mv mj b">Vue</code>构造函数的对象。</p><p id="f900" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">routes</code>有航线。</p><h1 id="9ba8" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">用 Vuex 向突变传递多个参数</h1><p id="acc4" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">要用 Vuex 传递多个参数给 action，我们可以传递一个对象作为有效负载。</p><p id="0784" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以通过编写以下内容来创建我们的突变:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="9940" class="mn lc iq mj b gy mo mp l mq mr">mutations: {<br/>  setToken(state, { token, expiration }) {<br/>    localStorage.setItem('token', token);<br/>    localStorage.setItem('expiration', expiration);<br/>  }<br/>}</span></pre><p id="e8ad" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有一个对象作为第二个参数。</p><p id="0452" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它具有<code class="fe mt mu mv mj b">token</code>和<code class="fe mt mu mv mj b">expiration</code>属性。</p><p id="8675" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以通过写下:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="8089" class="mn lc iq mj b gy mo mp l mq mr">store.commit('setToken', {<br/>  token,<br/>  expiration,<br/>});</span></pre><p id="0324" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们使用对象中的<code class="fe mt mu mv mj b">token</code>和<code class="fe mt mu mv mj b">expiration</code>属性调用<code class="fe mt mu mv mj b">setToken</code>变异作为第二个参数。</p><h1 id="c031" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">用 Vue 路由器重新加载路由</h1><p id="958c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">要用 Vue Route 重新加载一条路由，我们可以调用<code class="fe mt mu mv mj b">this.$router.go()</code>方法。</p><p id="7976" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果它没有参数，那么它将重新加载当前路线。</p><p id="cf2f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还可以为路由器视图中的<code class="fe mt mu mv mj b">key</code>属性添加一个唯一的值:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="5176" class="mn lc iq mj b gy mo mp l mq mr">&lt;router-view :key="$route.fullPath"&gt;&lt;/router-view&gt;</span></pre><p id="958d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样，当路径改变时它会注意到，并触发用新数据重新加载组件。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/4f1bac37608e9afd49927d96d55f8fb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7WLLopaliJHXB-XP"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@dienyportinanni?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Dieny Portinanni </a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h1 id="45d3" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="1860" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用<code class="fe mt mu mv mj b">this.$router.go()</code>重新加载我们的路线。</p><p id="4f1c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有许多方法可以将作用域传递给子级。</p><p id="8524" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果使用 Vue 路由器，我们可以在组件中获得查询参数。</p><p id="0545" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要将多段数据传递给一个变异，我们可以将一个包含所有数据的对象传递给变异。</p></div></div>    
</body>
</html>