<html>
<head>
<title>Kubernetes Imperative Commands Every Engineer Should Learn</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">每个工程师都应该学习的命令</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/kubernetes-imperative-commands-every-engineer-should-learn-3b5d8217fa29?source=collection_archive---------2-----------------------#2020-08-05">https://blog.devgenius.io/kubernetes-imperative-commands-every-engineer-should-learn-3b5d8217fa29?source=collection_archive---------2-----------------------#2020-08-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="ed6f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，您将了解kubernetes提供的基本命令，这些命令将允许您更有效地创建和部署对象，并作为一名DevOps工程师脱颖而出。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/b44b04924dd407d4e978c024be827ff6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dlbrVjk21mkfBiRRFmXVKg.jpeg"/></div></div></figure></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="da19" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用kubernetes时，您将主要使用YAML定义文件以声明的方式创建对象。</p><p id="fd88" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是，命令式命令有助于快速完成一次性任务，并轻松生成定义文件模板，从而节省大量时间。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="45e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">开始之前，请熟悉以下命令参数:</p><p id="095b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe le lf lg lh b">--dry-run</code>:默认情况下，一旦执行该命令，资源就会被创建。</p><p id="667e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe le lf lg lh b">--dry-run=client</code>:这将<strong class="jp ir">而不是</strong>创建资源。相反，kubernetes会告诉你是否有可能召唤这个物体。</p><p id="b72e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe le lf lg lh b">-o yaml</code>:这将在屏幕上输出YAML格式的资源定义文件。</p><p id="ddb6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">结合使用后两者可以方便地生成资源定义文件。稍后，您可以根据需要修改它，而不是从头开始编写文件。</p><p id="6a44" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如，下面生成一个POD清单文件:</p><pre class="km kn ko kp gt li lh lj lk aw ll bi"><span id="c15c" class="lm ln iq lh b gy lo lp l lq lr">kubectl run nginx --image=nginx --dry-run=client -o yaml</span></pre><p id="0d7d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们来看看用于生成pod的更多命令。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="78f2" class="ls ln iq bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">Pod命令</h1><p id="0cad" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">创建NGINX Pod:</p><pre class="km kn ko kp gt li lh lj lk aw ll bi"><span id="58c8" class="lm ln iq lh b gy lo lp l lq lr">kubectl run nginx --image=nginx</span></pre><p id="d3a4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">生成POD清单YAML文件:</p><pre class="km kn ko kp gt li lh lj lk aw ll bi"><span id="94aa" class="lm ln iq lh b gy lo lp l lq lr">kubectl run nginx --image=nginx --dry-run=client -o yaml</span></pre><p id="1dae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">提醒一下，<strong class="jp ir"> -o yaml </strong>参数告诉kubectl输出一个yaml文件，而<strong class="jp ir"> —模拟运行</strong>指示kubernetes<strong class="jp ir">而不是</strong>创建POD。</p><p id="0592" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，让我们了解与部署相关的命令。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="e131" class="ls ln iq bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">部署命令</h1><p id="546f" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">要从命令行创建部署，请执行以下操作:</p><pre class="km kn ko kp gt li lh lj lk aw ll bi"><span id="6d36" class="lm ln iq lh b gy lo lp l lq lr">kubectl create deployment --image=nginx nginx</span></pre><p id="65d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">生成部署YAML文件模板:</p><pre class="km kn ko kp gt li lh lj lk aw ll bi"><span id="807c" class="lm ln iq lh b gy lo lp l lq lr">kubectl create deployment --image=nginx nginx --dry-run=client -o yaml</span></pre><blockquote class="mu mv mw"><p id="aa90" class="jn jo mx jp b jq jr js jt ju jv jw jx my jz ka kb mz kd ke kf na kh ki kj kk ij bi translated"><strong class="jp ir"> kubectl创建部署</strong>没有<strong class="jp ir"> —副本</strong>选项。话虽如此，如果您希望扩展部署，您必须首先创建它，然后使用<strong class="jp ir"> kubectl scale </strong>命令扩展它。</p></blockquote><p id="f547" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下命令将创建一个名为“nginx-deployment.yaml”的部署YAML定义文件:</p><pre class="km kn ko kp gt li lh lj lk aw ll bi"><span id="9566" class="lm ln iq lh b gy lo lp l lq lr">kubectl create deployment --image=nginx nginx --dry-run=client -o yaml &gt; nginx-deployment.yaml</span></pre><p id="10a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">同样，<strong class="jp ir"> -o </strong>参数告诉kubectl输出一个yaml文件，而<strong class="jp ir">&gt;nginx-deployment . YAML</strong>参数为kubectl提供所需的输出文件名。</p><p id="0d00" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，您可以根据需要修改YAML文件。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="eec6" class="ls ln iq bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">服务命令</h1><p id="ea2d" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">以下命令创建一个名为“redis-service”的服务，类型为<strong class="jp ir"> ClusterIP </strong>，目的是在端口6379上显示redis pod。</p><pre class="km kn ko kp gt li lh lj lk aw ll bi"><span id="ec7c" class="lm ln iq lh b gy lo lp l lq lr">kubectl expose pod redis --port=6379 --name redis-service --dry-run=client -o yaml</span></pre><blockquote class="mu mv mw"><p id="a557" class="jn jo mx jp b jq jr js jt ju jv jw jx my jz ka kb mz kd ke kf na kh ki kj kk ij bi translated">注意:这将自动使用POD的标签作为选择器</p></blockquote><p id="6b05" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">备选方案:</p><pre class="km kn ko kp gt li lh lj lk aw ll bi"><span id="34ae" class="lm ln iq lh b gy lo lp l lq lr">kubectl create service clusterip redis --tcp=6379:6379 --dry-run=client -o yaml</span></pre><p id="9794" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上面的命令不会使用POD的标签作为选择器，而是假设选择器为app=redis。您不能将选择器作为选项传入。或者，在创建服务<strong class="jp ir">之前生成文件并修改选择器。</strong></p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="4d8a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下命令创建一个名为nginx的NodePort类型的服务，以在节点上的端口30080上公开nginx pod的端口80:</p><pre class="km kn ko kp gt li lh lj lk aw ll bi"><span id="c325" class="lm ln iq lh b gy lo lp l lq lr">kubectl expose pod nginx --port=80 --name nginx-service --type=NodePort --dry-run=client -o yaml</span></pre><blockquote class="mu mv mw"><p id="8a24" class="jn jo mx jp b jq jr js jt ju jv jw jx my jz ka kb mz kd ke kf na kh ki kj kk ij bi translated">注意:这将自动使用pod的标签作为选择器，但是您不能指定节点端口。您必须生成一个定义文件，然后在使用pod创建服务之前手动添加节点端口。</p></blockquote><p id="f332" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">或者</p><pre class="km kn ko kp gt li lh lj lk aw ll bi"><span id="c469" class="lm ln iq lh b gy lo lp l lq lr">kubectl create service nodeport nginx --tcp=80:80 --node-port=30080 --dry-run=client -o yaml</span></pre><p id="fbc3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这不会将pod的标签用作选择器。</p><p id="d647" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后几个命令有自己的挑战:一个不能接受选择器，另一个不能接受节点端口。在我看来，我建议使用<code class="fe le lf lg lh b">kubectl expose</code>命令。</p><p id="282c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果需要指定节点端口，请使用相同的命令生成一个定义文件，并在创建服务之前手动输入节点端口。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="31c8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你喜欢这个教程，我建议你看看我在kubernetes上关于YAML文件的帖子。</p><div class="nb nc gp gr nd ne"><a href="https://medium.com/dev-genius/understanding-yaml-files-in-kubernetes-f0121b40abbc" rel="noopener follow" target="_blank"><div class="nf ab fo"><div class="ng ab nh cl cj ni"><h2 class="bd ir gy z fp nj fr fs nk fu fw ip bi translated">了解Kubernetes中的YAML文件</h2><div class="nl l"><h3 class="bd b gy z fp nj fr fs nk fu fw dk translated">读完这篇文章后，你将理解使用YAML定义文件创建kubernetes对象的基础。你…</h3></div><div class="nm l"><p class="bd b dl z fp nj fr fs nk fu fw dk translated">medium.com</p></div></div><div class="nn l"><div class="no l np nq nr nn ns kv ne"/></div></div></a></div><p id="a60e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mx">原载于</em><a class="ae nt" href="https://luispreciado.blog/posts/kubernetes/core-concepts/imperative-commands" rel="noopener ugc nofollow" target="_blank"><em class="mx">https://luispreciado . blog</em></a><em class="mx">。</em></p></div></div>    
</body>
</html>