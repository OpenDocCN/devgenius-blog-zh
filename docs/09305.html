<html>
<head>
<title>♻️Waste Classification by Building Convolutional Neural Network (CNN) using TensorFlow ♻️</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用张量流♻️构建卷积神经网络的♻️Waste 分类</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/%EF%B8%8Fwaste-classification-by-building-convolutional-neural-network-cnn-using-tensorflow-%EF%B8%8F-8dca408a0c0b?source=collection_archive---------10-----------------------#2022-08-13">https://blog.devgenius.io/%EF%B8%8Fwaste-classification-by-building-convolutional-neural-network-cnn-using-tensorflow-%EF%B8%8F-8dca408a0c0b?source=collection_archive---------10-----------------------#2022-08-13</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div class="gh gi jk"><img src="../Images/f1c9d7d8f6fb0afa4c2968599aef2194.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*e2kdmwqe-1GxUQ2KDq8x7w.png"/></div><figcaption class="jr js gj gh gi jt ju bd b be z dk translated">废物分类</figcaption></figure><h1 id="d90a" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">问题:-垃圾分类</h1><blockquote class="kt ku kv"><p id="de00" class="kw kx ky kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">废物管理在我国是一个大问题。大多数废物最终被填埋。这导致了许多问题，例如:</p><p id="fc42" class="kw kx ky kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated"><em class="in">垃圾填埋场增加<br/>富营养化<br/>动物消耗有毒废物<br/>渗滤液<br/>毒素增加<br/>土地、水和空气污染</em></p></blockquote><figure class="lw lx ly lz gt jo gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/e9f4e19d901dc6ae77cfa093bc4b18c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*W9L72nsY5eGqB6sU6BHqJA.png"/></div><figcaption class="jr js gj gh gi jt ju bd b be z dk translated">废物倾倒</figcaption></figure><blockquote class="ma"><p id="ead0" class="mb mc in bd md me mf mg mh mi mj lu dk translated"><strong class="ak">方法:通过使用物联网和机器学习/深度来自动化流程</strong></p></blockquote><figure class="ml mm mn mo mp jo gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/7978a6f5784bd3b8ffde031f0c6058f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*32IPJZ46HFgI7dpE5p_Q7w.png"/></div></figure></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><p id="0f43" class="pw-post-body-paragraph kw kx in kz b la lb lc ld le lf lg lh mx lj lk ll my ln lo lp mz lr ls lt lu ig bi translated"><strong class="kz io">任务:垃圾图像分类</strong></p><p id="afb6" class="pw-post-body-paragraph kw kx in kz b la lb lc ld le lf lg lh mx lj lk ll my ln lo lp mz lr ls lt lu ig bi translated">数据集包含废物图像，即有机和可回收物品。</p><p id="56b6" class="pw-post-body-paragraph kw kx in kz b la lb lc ld le lf lg lh mx lj lk ll my ln lo lp mz lr ls lt lu ig bi translated">数据集取自 Kaggle : [ <a class="ae na" href="https://www.kaggle.com/datasets/techsash/waste-classification-data" rel="noopener ugc nofollow" target="_blank">数据集链接</a> ]</p><figure class="lw lx ly lz gt jo gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/b999e0dd060afaf486abd06583e0b178.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*Rs_3_qKh8haXi_zXwhBs_A.png"/></div></figure><p id="d840" class="pw-post-body-paragraph kw kx in kz b la lb lc ld le lf lg lh mx lj lk ll my ln lo lp mz lr ls lt lu ig bi translated">数据集分为训练数据(85%)和测试数据(15%)</p><p id="deaa" class="pw-post-body-paragraph kw kx in kz b la lb lc ld le lf lg lh mx lj lk ll my ln lo lp mz lr ls lt lu ig bi translated">训练数据— 22564 张图像测试数据— 2513 张图像</p></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><p id="b76c" class="pw-post-body-paragraph kw kx in kz b la lb lc ld le lf lg lh mx lj lk ll my ln lo lp mz lr ls lt lu ig bi translated">让我们试着解决图像分类的这个问题陈述；精确的二值图像分类，因为只有两个类别。</p><p id="3372" class="pw-post-body-paragraph kw kx in kz b la lb lc ld le lf lg lh mx lj lk ll my ln lo lp mz lr ls lt lu ig bi translated">我们可以用深度学习来解决二值图像分类问题。</p><p id="8ddd" class="pw-post-body-paragraph kw kx in kz b la lb lc ld le lf lg lh mx lj lk ll my ln lo lp mz lr ls lt lu ig bi translated">具体可以用卷积神经网络(CNN)s 来解决。</p></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><figure class="lw lx ly lz gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nc"><img src="../Images/0305ab873e5c0c93463b61c6bab65b39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*94UtGUXQ075wmBbuOSurKQ.png"/></div></div><figcaption class="jr js gj gh gi jt ju bd b be z dk translated">图片摘自<a class="ae na" href="http://introtodeeplearning.com/slides/6S191_MIT_DeepLearning_L3.pdf" rel="noopener ugc nofollow" target="_blank">http://introtodeeplearning . com/slides/6s 191 _ MIT _ deep learning _ L3 . pdf</a></figcaption></figure></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><p id="5b18" class="pw-post-body-paragraph kw kx in kz b la lb lc ld le lf lg lh mx lj lk ll my ln lo lp mz lr ls lt lu ig bi translated">如果你一般不知道什么是深度学习或者 CNN，可以参考这个视频:<a class="ae na" href="https://www.youtube.com/watch?v=uapdILWYTzE" rel="noopener ugc nofollow" target="_blank">【链接】</a> &amp;我们将使用<a class="ae na" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> Tensorflow </a>构建一个 CNN</p></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><figure class="lw lx ly lz gt jo gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/636106bb6bbca51b5f2bb44fd87d947f.png" data-original-src="https://miro.medium.com/v2/resize:fit:852/format:webp/1*9LqO7_9CNKYWEo93Ea9KYQ.png"/></div></figure><p id="e86a" class="pw-post-body-paragraph kw kx in kz b la lb lc ld le lf lg lh mx lj lk ll my ln lo lp mz lr ls lt lu ig bi translated">Tensorflow:一个端到端的开源机器学习平台</p></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><p id="2e68" class="pw-post-body-paragraph kw kx in kz b la lb lc ld le lf lg lh mx lj lk ll my ln lo lp mz lr ls lt lu ig bi translated">步骤 1-加载依赖项并浏览目录</p><pre class="lw lx ly lz gt ni nj nk nl aw nm bi"><span id="0864" class="nn jw in nj b gy no np l nq nr">import numpy as np <br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import matplotlib.image as mpimg<br/>import os<br/>for dir_path, dir_names, filenames <strong class="nj io">in</strong> os.walk("../input/waste-classification-data/"):<br/>    print(f"There are <strong class="nj io">{</strong>len(dir_names)<strong class="nj io">}</strong> directories &amp; <strong class="nj io">{</strong>len(filenames)<strong class="nj io">}</strong> images in the <strong class="nj io">{</strong>dir_path<strong class="nj io">}</strong> directory")</span></pre></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><p id="2136" class="pw-post-body-paragraph kw kx in kz b la lb lc ld le lf lg lh mx lj lk ll my ln lo lp mz lr ls lt lu ig bi translated">步骤 2-深入探索数据</p><pre class="lw lx ly lz gt ni nj nk nl aw nm bi"><span id="a073" class="nn jw in nj b gy no np l nq nr"><em class="ky"># class_names</em><br/>import pathlib<br/>train_dir = r"../input/waste-classification-data/dataset/DATASET/TRAIN/"<br/>test_dir = r"../input/waste-classification-data/dataset/DATASET/TEST/"<br/>train_path = pathlib.Path(train_dir)<br/>class_names = np.array(sorted([item.name for item <strong class="nj io">in</strong> train_path.glob("*")]))<br/>class_names</span></pre></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><pre class="ni nj nk nl aw nm bi"><span id="b2d3" class="nn jw in nj b gy ns nt nu nv nw np l nq nr">array(['O', 'R'], dtype='&lt;U1')</span></pre><p id="76d0" class="pw-post-body-paragraph kw kx in kz b la lb lc ld le lf lg lh mx lj lk ll my ln lo lp mz lr ls lt lu ig bi translated">这里‘O’:代表有机类&amp;‘R’:代表可回收物类</p></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><pre class="lw lx ly lz gt ni nj nk nl aw nm bi"><span id="b74f" class="nn jw in nj b gy no np l nq nr"><em class="ky"># Create a function to view the images from train &amp; test directories</em><br/>import random<br/>def view_random_image(target_dir,target_class):<br/>    <em class="ky"># set the path</em><br/>    target_folder = target_dir+"/"+target_class<br/>    <em class="ky"># get a random image </em><br/>    random_img = random.sample(os.listdir(target_folder), 1)<br/>    print(random_img)<br/>    <br/>    <em class="ky"># plot the image using matplotlib</em><br/>    img = mpimg.imread(target_folder + "/" + random_img[0])<br/>    plt.imshow(img)<br/>    plt.title(f"<strong class="nj io">{</strong>target_class<strong class="nj io">}</strong>")<br/>    plt.axis("off");<br/>    print(f"Image shape : <strong class="nj io">{</strong>img.shape<strong class="nj io">}</strong>")</span></pre></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><pre class="ni nj nk nl aw nm bi"><span id="66c5" class="nn jw in nj b gy ns nt nu nv nw np l nq nr">img = view_random_image(target_dir=train_dir,target_class="O")</span></pre></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><figure class="lw lx ly lz gt jo gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/5884a31bee0907f87bb0d0701be45f6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/format:webp/1*qzVO4LSPiC2rAQptU2vL1Q.png"/></div><figcaption class="jr js gj gh gi jt ju bd b be z dk translated">上述函数的输出</figcaption></figure><pre class="lw lx ly lz gt ni nj nk nl aw nm bi"><span id="5f83" class="nn jw in nj b gy no np l nq nr">img = view_random_image(target_dir=train_dir,target_class="R")</span></pre></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><figure class="lw lx ly lz gt jo gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/063890070e04e5022915d4a43238af50.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*PqPcACbncfaOnjx8QDKxlA.png"/></div><figcaption class="jr js gj gh gi jt ju bd b be z dk translated">上述函数的输出</figcaption></figure></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><p id="1c4a" class="pw-post-body-paragraph kw kx in kz b la lb lc ld le lf lg lh mx lj lk ll my ln lo lp mz lr ls lt lu ig bi translated">步骤 3-让我们通过以下步骤构建一个端到端的 CNN:</p><blockquote class="kt ku kv"><p id="0aa5" class="kw kx ky kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">加载数据</p><p id="b93e" class="kw kx ky kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">创建数据加载器和小型批处理</p><p id="b3a4" class="kw kx ky kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">创建/建立有线电视新闻网</p><p id="9e4a" class="kw kx ky kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">评价</p><p id="7056" class="kw kx ky kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">重复直到满意为止</p></blockquote></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><pre class="lw lx ly lz gt ni nj nk nl aw nm bi"><span id="cc28" class="nn jw in nj b gy no np l nq nr">import tensorflow as tf<br/>from tensorflow.keras.preprocessing.image import ImageDataGenerator</span></pre><blockquote class="kt ku kv"><p id="3a15" class="kw kx ky kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated"><a class="ae na" href="https://www.tensorflow.org/api_docs/python/tf/keras/preprocessing/image/ImageDataGenerator" rel="noopener ugc nofollow" target="_blank"> ImageDataGenerator </a>:通过实时数据增强生成批量的张量图像数据。</p></blockquote></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><pre class="lw lx ly lz gt ni nj nk nl aw nm bi"><span id="cc82" class="nn jw in nj b gy no np l nq nr">train_data_gen = ImageDataGenerator(rescale=1./255)<br/>test_data_gen = ImageDataGenerator(rescale=1./255)</span></pre><blockquote class="kt ku kv"><p id="9ff2" class="kw kx ky kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">重新调整因子。默认为无。如果无或为 0，则不应用重缩放，否则我们将数据乘以所提供的值(在应用所有其他变换之后)。</p></blockquote></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><pre class="lw lx ly lz gt ni nj nk nl aw nm bi"><span id="e210" class="nn jw in nj b gy no np l nq nr">train_data = train_data_gen.flow_from_directory(directory=train_dir,<br/>                                             target_size=(224, 224),<br/>                                             batch_size=32,<br/>                                             class_mode="binary")<br/><br/>test_data = train_data_gen.flow_from_directory(directory=test_dir,<br/>                                             target_size=(224,224),<br/>                                             batch_size=32,<br/>                                             class_mode="binary")</span></pre><blockquote class="kt ku kv"><p id="6ff6" class="kw kx ky kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated"><code class="fe nz oa ob nj b">directory</code>字符串，目标目录的路径。每个类应该包含一个子目录。任何 PNG，JPG，BMP，PPM 或 TIF 图像在每个子目录下的目录树将包括在生成器中。</p><p id="aec1" class="kw kx ky kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated"><code class="fe nz oa ob nj b">target_size</code>整数元组<code class="fe nz oa ob nj b">(height, width)</code>，默认为<code class="fe nz oa ob nj b">(256,256)</code>。找到的所有图像将被调整到的尺寸。在我们的例子中，我们认为它是(224，224)</p><p id="4b93" class="kw kx ky kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated"><code class="fe nz oa ob nj b">class_mode</code>“分类”、“二元”、“稀疏”、“输入”或无之一。默认:“分类”。在我们的例子中，我们认为是“二进制”</p><p id="a2d7" class="kw kx ky kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated"><code class="fe nz oa ob nj b">batch_size</code>数据批次的大小(默认为 32)。</p></blockquote></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><pre class="lw lx ly lz gt ni nj nk nl aw nm bi"><span id="a779" class="nn jw in nj b gy no np l nq nr">Found 22564 images belonging to 2 classes.<br/>Found 2513 images belonging to 2 classes.</span></pre></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><pre class="ni nj nk nl aw nm bi"><span id="7358" class="nn jw in nj b gy ns nt nu nv nw np l nq nr">from tensorflow.keras.layers import Dense, Flatten, Conv2D, MaxPool2D<br/>from tensorflow.keras import Sequential<br/>from tensorflow.keras.activations import relu,sigmoid, softmax<br/>from tensorflow.keras.optimizers import Adam, SGD</span></pre></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><pre class="ni nj nk nl aw nm bi"><span id="ac94" class="nn jw in nj b gy ns nt nu nv nw np l nq nr">model_1 = tf.keras.Sequential([<br/>    Conv2D(10, 3, input_shape=(224,224,3), activation="relu"),<br/>    MaxPool2D(2),<br/>    Conv2D(10, 3, activation="relu"),<br/>    MaxPool2D(2),<br/>    Flatten(),<br/>    Dense(1, activation="sigmoid")<br/>])<br/><br/>model_1.compile(loss="binary_crossentropy",<br/>               optimizer=Adam(),<br/>               metrics=["accuracy"])<br/><br/>history_1 = model_1.fit(train_data,<br/>                       epochs=5,<br/>                       steps_per_epoch=len(train_data),<br/>                       validation_data=test_data,<br/>                       validation_steps = len(test_data))</span></pre></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><figure class="lw lx ly lz gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi oc"><img src="../Images/7368e621a183cd763efd48fdd6933566.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Hp9nq9itLiah_5QGoqMBQ.png"/></div></div><figcaption class="jr js gj gh gi jt ju bd b be z dk translated">图片摘自<a class="ae na" href="http://introtodeeplearning.com/slides/6S191_MIT_DeepLearning_L3.pdf" rel="noopener ugc nofollow" target="_blank">http://introtodeeplearning . com/slides/6s 191 _ MIT _ deep learning _ L3 . pdf</a></figcaption></figure></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><pre class="lw lx ly lz gt ni nj nk nl aw nm bi"><span id="3a63" class="nn jw in nj b gy no np l nq nr">model_1.summary()</span></pre><figure class="lw lx ly lz gt jo gh gi paragraph-image"><div class="gh gi od"><img src="../Images/46a00024be182372518c739b74962667.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*aMxuAfyFtZf-j7nF1-OIFw.png"/></div></figure></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><pre class="lw lx ly lz gt ni nj nk nl aw nm bi"><span id="5956" class="nn jw in nj b gy no np l nq nr">model_1.evaluate(test_data)</span></pre><figure class="lw lx ly lz gt jo gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/4a0a05a847c61baaecc4f013a8036498.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*alGu_uD0jbsQnx0pxEe13g.png"/></div></figure></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><pre class="lw lx ly lz gt ni nj nk nl aw nm bi"><span id="6f43" class="nn jw in nj b gy no np l nq nr"><em class="ky"># plot accuracy &amp; loss curves</em><br/>def plot_loss_curves(history):<br/>    <em class="ky"># get loss</em><br/>    loss = history.history["loss"]<br/>    val_loss = history.history["val_loss"]<br/>    <em class="ky"># get accuracy</em><br/>    accuracy = history.history["accuracy"]<br/>    val_accuracy = history.history["val_accuracy"]<br/>    <br/>    <em class="ky"># epochs</em><br/>    epochs =range(len(history.history["loss"]))<br/>    <em class="ky"># plot loss</em><br/>    plt.plot(epochs, loss, label="Training Loss")<br/>    plt.plot(epochs, val_loss, label="Val Loss")<br/>    plt.title("Loss Curves")<br/>    plt.xlabel("Epcohs")<br/>    plt.legend()<br/>    <br/>    <em class="ky"># plot accuracy</em><br/>    plt.figure()<br/>    plt.plot(epochs, accuracy, label="Training Accuracy")<br/>    plt.plot(epochs, val_accuracy, label="Val Accuracy")<br/>    plt.title("Accuracy Curves")<br/>    plt.xlabel("Epochs")<br/>    plt.legend();<br/></span></pre></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><pre class="ni nj nk nl aw nm bi"><span id="571f" class="nn jw in nj b gy ns nt nu nv nw np l nq nr">plot_loss_curves(history_1)</span></pre></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><figure class="lw lx ly lz gt jo gh gi paragraph-image"><div class="gh gi of"><img src="../Images/8282c452896cf6906ba5cc3d5f9d33ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*1dOxyeFO0zJ-haP_U8JNog.png"/></div></figure><figure class="lw lx ly lz gt jo gh gi paragraph-image"><div class="gh gi og"><img src="../Images/053eb5150b54031cee36dddc0d02c9de.png" data-original-src="https://miro.medium.com/v2/resize:fit:690/format:webp/1*WHPDKsUs9g0MfBlfuVzTDg.png"/></div></figure></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><figure class="lw lx ly lz gt jo gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/26bb1333fd1710955259879ec1865090.png" data-original-src="https://miro.medium.com/v2/resize:fit:380/format:webp/1*_sQtehs4VS3ILK_VT2o9mg.png"/></div></figure><h1 id="55c3" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">让我们建立一个简单的 CNN/小 VGG 模型:2</h1><pre class="lw lx ly lz gt ni nj nk nl aw nm bi"><span id="35e9" class="nn jw in nj b gy no np l nq nr">model_2 = Sequential([<br/>    Conv2D(10, 3, input_shape=(224, 224, 3), activation="relu"),<br/>    Conv2D(10, 3, activation="relu"),<br/>    MaxPool2D(2),<br/>    Conv2D(10, 3, activation="relu"),<br/>    Conv2D(10, 3, activation="relu"),<br/>    MaxPool2D(2),<br/>    Flatten(),<br/>    Dense(1, activation="sigmoid")<br/>])<br/><br/>model_2.compile(loss="binary_crossentropy",<br/>               optimizer=tf.keras.optimizers.Adam(),<br/>               metrics=["accuracy"])<br/><br/>history_2 = model_2.fit(train_data,<br/>                       epochs=5,<br/>                       steps_per_epoch = len(train_data),<br/>                       validation_data=test_data,<br/>                       validation_steps=len(test_data))</span></pre></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><pre class="ni nj nk nl aw nm bi"><span id="aeca" class="nn jw in nj b gy ns nt nu nv nw np l nq nr">model_2.evaluate(test_data)</span></pre><figure class="lw lx ly lz gt jo gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/b0671f3f119fb03d725ece3b04a06f8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*5GPk-FyNhq_zgBIEFRpsog.png"/></div></figure></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><figure class="lw lx ly lz gt jo gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/4bc6f40e5de4331ac0d9b16a55006252.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/format:webp/1*1d9QjdoBBWNuoZOXnXqVoA.png"/></div></figure><p id="a1b3" class="pw-post-body-paragraph kw kx in kz b la lb lc ld le lf lg lh mx lj lk ll my ln lo lp mz lr ls lt lu ig bi translated">这足以让 CNN 入门，然后执行一系列实验，直到达到所需的性能指标。</p><p id="612c" class="pw-post-body-paragraph kw kx in kz b la lb lc ld le lf lg lh mx lj lk ll my ln lo lp mz lr ls lt lu ig bi translated">为了获得更多改进，我们可以尝试训练:</p><blockquote class="kt ku kv"><p id="a114" class="kw kx ky kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">更多时代</p><p id="1d65" class="kw kx ky kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">随着数据的增加</p><p id="2a30" class="kw kx ky kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">有更多层</p><p id="9b7a" class="kw kx ky kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">有更多的神经元</p><p id="fb16" class="kw kx ky kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">具有不同的激活功能</p></blockquote></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><p id="c04f" class="pw-post-body-paragraph kw kx in kz b la lb lc ld le lf lg lh mx lj lk ll my ln lo lp mz lr ls lt lu ig bi translated">我们能够用仅仅 2 个简单的 CNN 模型和仅仅 5 个时期得到好的结果。</p><figure class="lw lx ly lz gt jo gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/1ddf018404ad54a9c94f1f290ce41fe6.png" data-original-src="https://miro.medium.com/v2/resize:fit:612/format:webp/1*NpQ7s5WX-O2RSjoKs7RD0A.png"/></div></figure><p id="35bd" class="pw-post-body-paragraph kw kx in kz b la lb lc ld le lf lg lh mx lj lk ll my ln lo lp mz lr ls lt lu ig bi translated"><strong class="kz io">参考文献:</strong></p><div class="ol om gp gr on oo"><a href="https://www.tensorflow.org/" rel="noopener  ugc nofollow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd io gy z fp ot fr fs ou fu fw im bi translated">张量流</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">一个面向所有人的端到端开源机器学习平台。探索 TensorFlow 灵活的工具生态系统…</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">www.tensorflow.org</p></div></div><div class="ox l"><div class="oy l oz pa pb ox pc jp oo"/></div></div></a></div><div class="ol om gp gr on oo"><a href="http://introtodeeplearning.com/" rel="noopener  ugc nofollow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd io gy z fp ot fr fs ou fu fw im bi translated">麻省理工深度学习 6。S191</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">麻省理工学院关于深度学习方法的入门课程，应用于计算机视觉，自然语言处理…</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">introtodeeplearning.com</p></div></div><div class="ox l"><div class="pd l oz pa pb ox pc jp oo"/></div></div></a></div><p id="19e7" class="pw-post-body-paragraph kw kx in kz b la lb lc ld le lf lg lh mx lj lk ll my ln lo lp mz lr ls lt lu ig bi translated"><a class="ae na" href="https://www.udemy.com/course/tensorflow-developer-certificate-machine-learning-zero-to-mastery/" rel="noopener ugc nofollow" target="_blank">https://www . udemy . com/course/tensor flow-开发者-证书-机器学习-零到精通/ </a></p></div></div>    
</body>
</html>