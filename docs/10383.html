<html>
<head>
<title>How to build a One-Time-Password(OTP) Verification API with Rust and Twilio</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用 Rust 和 Twilio 构建一次性密码(OTP)验证 API</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-build-a-one-time-password-otp-verification-api-with-rust-and-twilio-d6dfc44052fa?source=collection_archive---------2-----------------------#2022-10-29">https://blog.devgenius.io/how-to-build-a-one-time-password-otp-verification-api-with-rust-and-twilio-d6dfc44052fa?source=collection_archive---------2-----------------------#2022-10-29</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/8637d2877b6e3f6ce70b10cd65c89b9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U_iiNTQgcAAp4EAqAFNYuA.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">涉及</figcaption></figure><p id="aafe" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">组织总是在寻找创新的方法来应对他们平台上的威胁和漏洞。他们不断投资人力资源和技术，以帮助构建和发布安全的应用程序。双因素身份认证、身份验证器应用程序和生物识别等是组织为保持平台安全而采用的一些创新方法。</p><p id="2cce" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在这篇文章中，我们将学习如何使用 Rust 和 Twilio 的验证服务来构建使用电话号码验证用户身份的 API。在这篇文章中，我们将使用 Actix Web 来构建我们的 API。然而，同样的方法也适用于任何基于 Rust 的框架。</p><h1 id="5b85" class="kx ky in bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">先决条件</h1><p id="d686" class="pw-post-body-paragraph jz ka in kb b kc lv ke kf kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ig bi translated">要完全掌握本教程中介绍的概念，需要满足以下要求:</p><ul class=""><li id="4003" class="ma mb in kb b kc kd kg kh kk mc ko md ks me kw mf mg mh mi bi translated">对铁锈的基本认识</li><li id="177b" class="ma mb in kb b kc mj kg mk kk ml ko mm ks mn kw mf mg mh mi bi translated">Twilio 账户；<a class="ae mo" href="https://marketplace.zoom.us/" rel="noopener ugc nofollow" target="_blank"><strong class="kb io"/></a><a class="ae mo" href="https://www.twilio.com/try-twilio" rel="noopener ugc nofollow" target="_blank"><strong class="kb io">ignup</strong></a><strong class="kb io"/>对于一个试用账户来说是完全免费的。</li></ul><h1 id="1687" class="kx ky in bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">入门指南</h1><p id="9605" class="pw-post-body-paragraph jz ka in kb b kc lv ke kf kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ig bi translated">首先，我们需要导航到所需的目录，并在我们的终端中运行以下命令:</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="a917" class="my ky in mu b gy mz na l nb nc">cargo new rust-sms-verification &amp;&amp; cd rust-sms-verification</span></pre><p id="f0a1" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">该命令创建一个名为<code class="fe nd ne nf mu b">rust-sms-verification</code>的 Rust 项目，并导航到项目目录。</p><p id="6fb3" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">接下来，我们通过修改<code class="fe nd ne nf mu b">Cargo.toml</code>文件的<code class="fe nd ne nf mu b">[dependencies]</code>部分来安装所需的依赖项，如下所示:</p><figure class="mp mq mr ms gt jo"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="7d50" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><code class="fe nd ne nf mu b">actix-web = “4”</code>是一个基于 Rust 的框架，用于构建 web 应用。</p><p id="9b61" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><code class="fe nd ne nf mu b">serde = { version = “1.0.145”, features = [“derive”] }</code>是一个序列化和反序列化 Rust 数据结构的框架。例如，将 Rust 结构转换为 JSON，反之亦然。</p><p id="255b" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><code class="fe nd ne nf mu b">dotenv = “0.15.0”</code>是一个管理环境变量的机箱。</p><p id="1726" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><code class="fe nd ne nf mu b">reqwest = { version = “0.11”, features = [“json”] }</code>是一个 HTTP 请求箱。</p><p id="fbd2" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io"> <em class="ni"> PS </em> </strong> <em class="ni">:上述板条箱中使用的</em> <code class="fe nd ne nf mu b"><em class="ni">feature</em></code> <em class="ni">标志启用板条箱的特定功能。</em></p><p id="3b08" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我们需要运行下面的命令来安装依赖项:</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="ff72" class="my ky in mu b gy mz na l nb nc">cargo build</span></pre><h1 id="4147" class="kx ky in bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">构建我们的应用程序</h1><p id="82dc" class="pw-post-body-paragraph jz ka in kb b kc lv ke kf kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ig bi translated">有一个好的项目结构是很重要的，因为它使项目可维护，并使我们和其他人更容易阅读我们的代码库。</p><p id="bff4" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">为此，我们需要导航到<code class="fe nd ne nf mu b">src</code>目录，并在该文件夹中创建一个<code class="fe nd ne nf mu b">models.rs</code>、<code class="fe nd ne nf mu b">services.rs</code>和<code class="fe nd ne nf mu b">handlers.rs</code>文件。</p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/768fb8d2ae29d77b113c3a271d27f14e.png" data-original-src="https://miro.medium.com/v2/resize:fit:518/format:webp/0*Tma8G1co_CzM5d2V.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">更新的文件夹结构</figcaption></figure><p id="9fb5" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><code class="fe nd ne nf mu b">models.rs</code>用于构建我们的应用数据</p><p id="29f2" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><code class="fe nd ne nf mu b">services.rs</code>用于抽象我们的应用程序逻辑</p><p id="04c7" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><code class="fe nd ne nf mu b">handlers.r</code> s 代表构建我们的 API</p><p id="b38f" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">最后，我们需要将这些文件声明为一个模块，并将它们导入到如下所示的<code class="fe nd ne nf mu b">main.rs</code>文件中:</p><figure class="mp mq mr ms gt jo"><div class="bz fp l di"><div class="ng nh l"/></div></figure><h1 id="72e0" class="kx ky in bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">设置 Twilio</h1><p id="01c1" class="pw-post-body-paragraph jz ka in kb b kc lv ke kf kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ig bi translated">为了在我们的 API 中启用 OTP 验证，我们需要登录到我们的<a class="ae mo" href="https://console.twilio.com/" rel="noopener ugc nofollow" target="_blank"> Twilio 控制台</a>来获取我们的<strong class="kb io">帐户 SID </strong>和一个<strong class="kb io"> Auth 令牌</strong>。我们需要将这些参数放在手边，因为我们需要它们来配置和构建我们的 API。</p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nk"><img src="../Images/3e0aadbf0528ee8bed509fa5d7a60a23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hA_K_OpPh_meLPkw.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">Twilio 证书</figcaption></figure><p id="f3f7" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">创建验证服务<br/> </strong> Twilio 提供安全可靠的服务，通过短信、语音和电子邮件无缝验证用户身份。在我们的例子中，我们将使用 SMS 选项通过电话号码来验证用户。为此，导航至<strong class="kb io">浏览产品</strong>选项卡，滚动至<strong class="kb io">账户安全</strong>部分，并点击<strong class="kb io">验证</strong>按钮。</p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nl"><img src="../Images/9510b999581c8927d61d06f1d0518fc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1g5jeEFW2h6j4_xv.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">验证帐户</figcaption></figure><p id="c0f0" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">导航到<strong class="kb io">服务</strong>选项卡，点击<strong class="kb io">创建新的</strong>按钮，输入<strong class="kb io">短信服务</strong>作为友好名称，打开<strong class="kb io">短信</strong>选项，然后<strong class="kb io">创建</strong>。</p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nl"><img src="../Images/667c53a437c20802043df04af3ff4e98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*e33XkYpLf4eT_0O-.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">创建新服务</figcaption></figure><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nl"><img src="../Images/a8f7425e28eaa9ca0e5b4f87edc2cf74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*W2UYYI1jJoRYMuL3.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">输入详细信息</figcaption></figure><p id="5846" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在创建时，我们需要复制<strong class="kb io">服务 SID。在构建我们的 API 时，它也会派上用场。</strong></p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nl"><img src="../Images/0b0ddd28c08c952e7336ab6f21727688.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*oPf2hHwVP3N2JwTS.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">服务 SID</figcaption></figure><p id="8c7a" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">启用地理权限<br/> </strong>地理权限是 Twilio 为控制其服务的使用而设置的机制。它提供了一个工具来启用和禁用从 Twilio 帐户接收语音呼叫和短信的国家。</p><p id="cb1e" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">要启用短信，我们需要在搜索栏中搜索短信地理权限，点击<strong class="kb io">短信地理权限</strong>结果，然后<strong class="kb io">查看</strong>短信提供商运营的国家。</p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nm"><img src="../Images/d31e0fec0428b11a384c9d5ef2d15a80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*l7ReM_2GZPcz6sgJ.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">搜索</figcaption></figure><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nn"><img src="../Images/461c50c348396a341f07b6520ac151e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*F0BezaJs3rRJp1Yt.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">检查运营国家</figcaption></figure><h1 id="3836" class="kx ky in bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">在 Rust 中创建 OTP 验证 API</h1><p id="2dbf" class="pw-post-body-paragraph jz ka in kb b kc lv ke kf kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ig bi translated">配置完成后，我们可以按照步骤开始构建我们的 API。</p><p id="9a99" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">添加环境变量<br/> </strong>接下来，我们需要在根目录下创建一个<code class="fe nd ne nf mu b">.env</code>文件，并添加下面的代码片段:</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="90b4" class="my ky in mu b gy mz na l nb nc">TWILIO_ACCOUNT_SID=&lt;ACCOUNT SID&gt;<br/>TWILIO_AUTHTOKEN=&lt;AUTH TOKEN&gt;<br/>TWILIO_SERVICES_ID=&lt;SERVICE ID&gt;</span></pre><p id="852b" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">如前所述，我们可以从 Twilio 控制台和服务设置中获得所需的凭证。</p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nk"><img src="../Images/df0d68f3d3366a601ce4f7a3c6c1caa0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cIGrpbBuU-TOaXTA.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">Twilio 控制台</figcaption></figure><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nl"><img src="../Images/baf9f366dbc3732ff8597bec642bf83a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*mYt_XavNtUXJgKcx.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">服务设置</figcaption></figure><p id="6cbb" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">创建 API 模型<br/> </strong>接下来，我们需要创建模型来表示我们的应用程序数据。为此，我们需要修改<code class="fe nd ne nf mu b">model.rs</code>文件，如下所示:</p><figure class="mp mq mr ms gt jo"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="b655" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">上面的代码片段执行了以下操作:</p><ul class=""><li id="d379" class="ma mb in kb b kc kd kg kh kk mc ko md ks me kw mf mg mh mi bi translated">导入所需的依赖项</li><li id="f75d" class="ma mb in kb b kc mj kg mk kk ml ko mm ks mn kw mf mg mh mi bi translated">创建具有 API 请求体所需属性的<code class="fe nd ne nf mu b">OTPData</code>和<code class="fe nd ne nf mu b">VerifyOTPData</code>结构</li><li id="8924" class="ma mb in kb b kc mj kg mk kk ml ko mm ks mn kw mf mg mh mi bi translated">创建具有 API 响应所需属性的<code class="fe nd ne nf mu b">OTPResponse</code>、<code class="fe nd ne nf mu b">OTPVerifyResponse</code>和<code class="fe nd ne nf mu b">APIResponse</code>结构</li></ul><p id="82d4" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io"><em class="ni">PS</em></strong><em class="ni">:</em><code class="fe nd ne nf mu b"><em class="ni">#[serde(rename_all = “camelCase”)] </em></code><em class="ni">宏将 snake case 属性转换为 camel case，derive 宏增加了对序列化、反序列化和克隆的实现支持。</em></p><p id="f904" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">创建 API 服务 Twilio 提供了一个开放的 API 规范来访问他们的服务。在本节中，我们将使用验证服务来发送和验证 OTP。为此，首先，我们需要更新如下所示的<code class="fe nd ne nf mu b">services.rs</code>文件:</p><figure class="mp mq mr ms gt jo"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="8bcd" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">上面的代码片段执行了以下操作:</p><ul class=""><li id="ce16" class="ma mb in kb b kc kd kg kh kk mc ko md ks me kw mf mg mh mi bi translated">导入所需的依赖项</li><li id="b70a" class="ma mb in kb b kc mj kg mk kk ml ko mm ks mn kw mf mg mh mi bi translated">创建一个<code class="fe nd ne nf mu b">TwilioService</code>结构</li><li id="8711" class="ma mb in kb b kc mj kg mk kk ml ko mm ks mn kw mf mg mh mi bi translated">创建一个向<code class="fe nd ne nf mu b">TwilioService</code>结构添加方法的实现块</li><li id="b4d7" class="ma mb in kb b kc mj kg mk kk ml ko mm ks mn kw mf mg mh mi bi translated">添加一个<code class="fe nd ne nf mu b">env_loader</code>助手方法来加载环境变量</li><li id="4374" class="ma mb in kb b kc mj kg mk kk ml ko mm ks mn kw mf mg mh mi bi translated">添加一个<code class="fe nd ne nf mu b">send_otp</code>方法，该方法将<code class="fe nd ne nf mu b">phone_number</code>作为参数，并返回<code class="fe nd ne nf mu b">OTPResponse</code>或描述错误的字符串。该方法还执行以下操作:<br/> - <strong class="kb io">第 20–22 行</strong> : —使用<code class="fe nd ne nf mu b">env_loader</code>助手方法创建所需的环境变量<br/> - <strong class="kb io">第 24–27 行</strong>:通过用所需的参数<br/> - <strong class="kb io">第 29–33 行</strong>格式化来创建<code class="fe nd ne nf mu b">url</code>:创建 API 请求头并将其设置为表单类型<br/> - <strong class="kb io">第 35–37 行</strong> 接收 OTP 并将发送 OTP 的通道设置为<code class="fe nd ne nf mu b">sms<br/></code> - <strong class="kb io">第 39–46 行</strong>:使用<code class="fe nd ne nf mu b">reqwest</code>库创建一个客户端实例，通过传入所需的认证参数、请求头和表单主体<br/> - <strong class="kb io">第 48–57 行</strong>:返回适当的响应来对 Twilio API 进行 HTTP 调用</li></ul><p id="51e4" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">最后，我们需要添加一个方法来验证发送的 OTP，如下所示:</p><figure class="mp mq mr ms gt jo"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="6aed" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">上面的代码片段类似于<code class="fe nd ne nf mu b">send_otp</code>方法。但是，我们将<code class="fe nd ne nf mu b">url</code>更改为验证检查 URL，将表单主体中的<code class="fe nd ne nf mu b">Channel</code>更改为<code class="fe nd ne nf mu b">Code</code>，并通过检查响应状态为<code class="fe nd ne nf mu b">approved</code>来返回适当的响应。</p><p id="c535" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">创建 API 处理程序<br/> </strong>随着服务的完全配置，我们可以使用它们来创建我们的 API 处理程序。为此，我们需要更新<code class="fe nd ne nf mu b">handlers.rs</code>，如下所示:</p><figure class="mp mq mr ms gt jo"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="90e4" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">上面的代码片段执行了以下操作:</p><ul class=""><li id="99a2" class="ma mb in kb b kc kd kg kh kk mc ko md ks me kw mf mg mh mi bi translated">导入所需的依赖项</li><li id="9263" class="ma mb in kb b kc mj kg mk kk ml ko mm ks mn kw mf mg mh mi bi translated">创建一个带有<code class="fe nd ne nf mu b">/otp</code> API 路由的<code class="fe nd ne nf mu b">send_otp</code>处理程序，该处理程序使用<code class="fe nd ne nf mu b">send_otp</code>服务发送 OTP，并使用<code class="fe nd ne nf mu b">APIResponse</code>返回适当的响应</li><li id="9d4f" class="ma mb in kb b kc mj kg mk kk ml ko mm ks mn kw mf mg mh mi bi translated">创建一个带有<code class="fe nd ne nf mu b">/verifyOTP</code> API 路由的<code class="fe nd ne nf mu b">verify_otp</code>处理程序，该处理程序使用<code class="fe nd ne nf mu b">verify_otp</code>服务来验证 OTP，并使用<code class="fe nd ne nf mu b">APIResponse</code>返回适当的响应</li></ul><p id="1768" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">完成后，我们需要更新<code class="fe nd ne nf mu b">main.rs</code>文件以包含我们的应用程序入口点，并使用<code class="fe nd ne nf mu b">send_otp</code>和<code class="fe nd ne nf mu b">verify_otp</code>处理程序。</p><figure class="mp mq mr ms gt jo"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="54e5" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">上面的代码片段执行了以下操作:</p><ul class=""><li id="224d" class="ma mb in kb b kc kd kg kh kk mc ko md ks me kw mf mg mh mi bi translated">导入所需的依赖项</li><li id="a327" class="ma mb in kb b kc mj kg mk kk ml ko mm ks mn kw mf mg mh mi bi translated">创建一个新的服务器，它添加了<code class="fe nd ne nf mu b">send_otp</code>和<code class="fe nd ne nf mu b">verify_otp</code>处理程序，并在<code class="fe nd ne nf mu b">localhost:8080</code>上运行</li></ul><p id="51c8" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">完成后，我们可以使用下面的命令启动开发服务器:</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="37ce" class="my ky in mu b gy mz na l nb nc">cargo run main.go</span></pre><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi no"><img src="../Images/d52981e58a7e08ba532c0ac6c8580662.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*twg5ySOpUF-3rXfl.png"/></div></div></figure><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi np"><img src="../Images/d9a202c7064aaa4c1abc944a9fb254dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GjZ-E1BpRVHXAiCa.PNG"/></div></div></figure><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nq"><img src="../Images/a8a4deb5bd6ba43b69866bc1086612c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tFbg07vcCRcEWP5C.png"/></div></div></figure><p id="51a7" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我们也可以通过导航到 Twilio 上<strong class="kb io">日志</strong>的<strong class="kb io">验证</strong>选项卡来验证消息日志</p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nr"><img src="../Images/08ca375d2b50520f1f3261c5fa847a29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8UT0nKSfciJkMfhy.png"/></div></div></figure><h1 id="fa06" class="kx ky in bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">结论</h1><p id="ecd0" class="pw-post-body-paragraph jz ka in kb b kc lv ke kf kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ig bi translated">这篇文章讨论了如何使用 Rust 和 Twilio 的验证服务创建检查和验证用户电话号码的 API。除了基于 SMS 的验证，Twilio 还提供多种服务，将身份验证无缝集成到新的或现有的代码库中。</p><p id="e655" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">这些资源可能会有所帮助:</p><ul class=""><li id="6d3f" class="ma mb in kb b kc kd kg kh kk mc ko md ks me kw mf mg mh mi bi translated"><a class="ae mo" href="https://www.twilio.com/docs/verify/api/service" rel="noopener ugc nofollow" target="_blank"> Twilio 验证服务</a></li><li id="876a" class="ma mb in kb b kc mj kg mk kk ml ko mm ks mn kw mf mg mh mi bi translated"><a class="ae mo" href="https://github.com/seanmonstar/reqwest" rel="noopener ugc nofollow" target="_blank"> Reqwest HTTP 库</a></li></ul></div></div>    
</body>
</html>