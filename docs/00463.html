<html>
<head>
<title>Shorthand Control Expressions in Ruby</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Ruby中的速记控制表达式</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/shorthand-control-expressions-in-ruby-dbed2be299db?source=collection_archive---------13-----------------------#2020-06-08">https://blog.devgenius.io/shorthand-control-expressions-in-ruby-dbed2be299db?source=collection_archive---------13-----------------------#2020-06-08</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/86e2c048769158458a4628e6be329ae7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8rAYkE0SWDaMYLIcMt7LlQ.jpeg"/></div></div></figure><h1 id="471b" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">如果，除非，三元运算符和触发器</h1><p id="f2de" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">作为一个Ruby初学者，当我在Stackoverflow中寻找答案时，经常会遇到一些对我来说很神秘的问题。在这里，我想分享一些我觉得有用或有趣的速记，从简单的一行if/unless语句到三元运算符和触发器。</p></div><div class="ab cl ls lt hr lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ig ih ii ij ik"><h1 id="5e6b" class="jv jw in bd jx jy lz ka kb kc ma ke kf kg mb ki kj kk mc km kn ko md kq kr ks bi translated">1.修饰语如果和除非</h1><p id="e7e7" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">有时你需要一个条件语句，用‘if-end’来写整个语句会很麻烦。在这种情况下,“如果”和“除非”这个修饰语就派上了用场。</p><p id="279d" class="pw-post-body-paragraph kt ku in kv b kw me ky kz la mf lc ld le mg lg lh li mh lk ll lm mi lo lp lq ig bi translated">这是一个简单的if语句的例子。如果'<em class="mj">true</em>'——在ruby中这意味着除了nil和false之外的任何值——那么做点什么。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="8d43" class="mt jw in mp b gy mu mv l mw mx">if true <br/>  puts "the test resulted in a true-value"<br/>end</span></pre><p id="09b2" class="pw-post-body-paragraph kt ku in kv b kw me ky kz la mf lc ld le mg lg lh li mh lk ll lm mi lo lp lq ig bi translated">这个可以缩短一行。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="9ed5" class="mt jw in mp b gy mu mv l mw mx">puts "the test resulted in a true-value" if true</span></pre><p id="a89b" class="pw-post-body-paragraph kt ku in kv b kw me ky kz la mf lc ld le mg lg lh li mh lk ll lm mi lo lp lq ig bi translated"><code class="fe my mz na mp b">unless</code>表达式与<code class="fe my mz na mp b">if</code>表达式相反。所以简单来说就是'<em class="mj">如果不为真'</em>或者'<em class="mj">如果为假'</em>。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="689e" class="mt jw in mp b gy mu mv l mw mx">unless true<br/>  puts "the value is a false-value"<br/>end</span></pre><p id="b256" class="pw-post-body-paragraph kt ku in kv b kw me ky kz la mf lc ld le mg lg lh li mh lk ll lm mi lo lp lq ig bi translated">这个可以缩短一行。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="3c73" class="mt jw in mp b gy mu mv l mw mx">puts "the value is a false-value" unless true</span></pre><p id="d414" class="pw-post-body-paragraph kt ku in kv b kw me ky kz la mf lc ld le mg lg lh li mh lk ll lm mi lo lp lq ig bi translated">重要的是<strong class="kv io"/><strong class="kv io"/><code class="fe my mz na mp b">if / unless</code>的左边是满足测试/条件时要执行的语句，<code class="fe my mz na mp b">if / unless</code>的右边是测试/条件表达式</p><h1 id="7bdd" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">2.三元if</h1><p id="24b9" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">三元表达式对我来说是一个既迷人又困惑的表达式。它把简单的<code class="fe my mz na mp b">if-else-end</code>表达得整整齐齐。但是因为可读性，建议‘三元if’只用于简单的条件句。</p><p id="75c4" class="pw-post-body-paragraph kt ku in kv b kw me ky kz la mf lc ld le mg lg lh li mh lk ll lm mi lo lp lq ig bi translated"><strong class="kv io">三元表达式的基本结构是:</strong></p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="46fc" class="mt jw in mp b gy mu mv l mw mx">condition ? true : false</span></pre><p id="7959" class="pw-post-body-paragraph kt ku in kv b kw me ky kz la mf lc ld le mg lg lh li mh lk ll lm mi lo lp lq ig bi translated">一个简单的例子是:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="409d" class="mt jw in mp b gy mu mv l mw mx">[].empty? ? “Yes” : “No”</span></pre><p id="9d42" class="pw-post-body-paragraph kt ku in kv b kw me ky kz la mf lc ld le mg lg lh li mh lk ll lm mi lo lp lq ig bi translated">这与以下内容相同:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="dd74" class="mt jw in mp b gy mu mv l mw mx">if [].empty?<br/>  "Yes"<br/>else<br/>  "No"<br/>end</span></pre><p id="7620" class="pw-post-body-paragraph kt ku in kv b kw me ky kz la mf lc ld le mg lg lh li mh lk ll lm mi lo lp lq ig bi translated">此示例显示了使用三元表达式的可读性问题。</p><p id="207f" class="pw-post-body-paragraph kt ku in kv b kw me ky kz la mf lc ld le mg lg lh li mh lk ll lm mi lo lp lq ig bi translated">下面是默认的if-else语句，用于检查散列中是否存在<code class="fe my mz na mp b">"name"</code>键，如果找到该键，则返回一个连接值，如果没有找到，则创建<code class="fe my mz na mp b">"name"</code>键。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="1cdb" class="mt jw in mp b gy mu mv l mw mx">hash = { }</span><span id="c562" class="mt jw in mp b gy nb mv l mw mx">if hash.key?("name")<br/>  hash["name"]<br/>else <br/>  hash["name"] = "Anne" <br/>end</span></pre><p id="8663" class="pw-post-body-paragraph kt ku in kv b kw me ky kz la mf lc ld le mg lg lh li mh lk ll lm mi lo lp lq ig bi translated">这在三元表达式中是:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="30e9" class="mt jw in mp b gy mu mv l mw mx">hash.key?("key_name") ? hash["key_name"] : hash["key_name"] = value</span></pre><p id="a1b2" class="pw-post-body-paragraph kt ku in kv b kw me ky kz la mf lc ld le mg lg lh li mh lk ll lm mi lo lp lq ig bi translated">就个人而言，在这种情况下，我更喜欢默认的<code class="fe my mz na mp b">if-else-end</code>表达式，而不是三元表达式。当它变得有点长时，它会更清晰，可读性更好，所以我建议在使用它时要记住可读性。</p><ul class=""><li id="df0e" class="nc nd in kv b kw me la mf le ne li nf lm ng lq nh ni nj nk bi translated">参考文献—<a class="ae lr" href="https://ruby-doc.org/core-2.7.0/doc/syntax/control_expressions_rdoc.html#label-Ternary+if" rel="noopener ugc nofollow" target="_blank">ruby-doc.org</a></li></ul><h1 id="4942" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">3.触发器</h1><p id="91f1" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">触发器是一种罕见的条件表达式。在Ruby 2.6中，由于缺乏对它的了解和不正确的用法，它几乎被删除了。但是几个开发者不同意，声称它在文本处理和脚本方面有帮助。所以在Ruby 2.7中又回来了。</p><p id="6460" class="pw-post-body-paragraph kt ku in kv b kw me ky kz la mf lc ld le mg lg lh li mh lk ll lm mi lo lp lq ig bi translated">触发器使用范围运算符两点(<code class="fe my mz na mp b">..</code>)和三点(<code class="fe my mz na mp b">...</code>)。它之所以被称为触发器，是因为当范围条件的开始匹配时，它“打开”——<em class="mj">返回</em> <em class="mj">真</em>，当范围条件的结束也匹配时，它“关闭”——<em class="mj">返回</em> <em class="mj">假</em>。另外，它必须用在条件句中，如<code class="fe my mz na mp b">if</code>、<code class="fe my mz na mp b">while</code>、<code class="fe my mz na mp b">unless</code>、<code class="fe my mz na mp b">until</code>等。包括修饰形式。我知道，这听起来令人困惑。让我们看一个例子。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="fd13" class="mt jw in mp b gy mu mv l mw mx">1.upto(5) do |i|<br/>  puts i if i==2...i==4<br/>end<br/>2<br/>3<br/>4<br/>=&gt;1</span></pre><p id="bc45" class="pw-post-body-paragraph kt ku in kv b kw me ky kz la mf lc ld le mg lg lh li mh lk ll lm mi lo lp lq ig bi translated">在这里，你看到当<code class="fe my mz na mp b">i==2</code> <em class="mj">，</em>返回<code class="fe my mz na mp b">true</code>时，从2开始执行<code class="fe my mz na mp b">puts i</code>。当它到达4时，第二个条件<code class="fe my mz na mp b">i==4</code>匹配并返回<code class="fe my mz na mp b">false</code>，所以它在4之后停止<code class="fe my mz na mp b">puts i</code>。</p><p id="f889" class="pw-post-body-paragraph kt ku in kv b kw me ky kz la mf lc ld le mg lg lh li mh lk ll lm mi lo lp lq ig bi translated">另一件要小心的事情是使用带三点(<code class="fe my mz na mp b">...</code>)运算符的触发器，因为它排除了它的结束值。当传递start和end的相同范围值时，它不会在第二个条件中返回' false '。在下面的例子中，你可以看到它一直持续到循环结束。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="4074" class="mt jw in mp b gy mu mv l mw mx"># using (...) -&gt; excludes its ending value<br/>(1..10).each do |i| <br/>  puts i if i==5...i==5<br/>end <br/>5<br/>6<br/>7<br/>8<br/>9<br/>10<br/>=&gt; 1..10</span><span id="e211" class="mt jw in mp b gy nb mv l mw mx"># using (...) -&gt; includes its ending value<br/>(1..10).each do |i| <br/>  puts i if i==5..i==5<br/>end <br/>5<br/>=&gt; 1..10</span></pre><p id="976c" class="pw-post-body-paragraph kt ku in kv b kw me ky kz la mf lc ld le mg lg lh li mh lk ll lm mi lo lp lq ig bi translated">我个人还没有发现人字拖的用途，但是一旦我发现了，我一定会写一篇关于它的文章。</p><p id="e5de" class="pw-post-body-paragraph kt ku in kv b kw me ky kz la mf lc ld le mg lg lh li mh lk ll lm mi lo lp lq ig bi translated">我在下面包含了一些触发器用例的链接。</p><div class="nl nm gp gr nn no"><a href="https://rocket-science.ru/hacking/2018/02/22/flip-flop-real-application" rel="noopener  ugc nofollow" target="_blank"><div class="np ab fo"><div class="nq ab nr cl cj ns"><h2 class="bd io gy z fp nt fr fs nu fu fw im bi translated">触发器在ruby中的实际应用</h2><div class="nv l"><h3 class="bd b gy z fp nt fr fs nu fu fw dk translated">ruby继承了Perl的哲学，即有多种方法来做同样的事情。我从…那里继承了这种哲学</h3></div><div class="nw l"><p class="bd b dl z fp nt fr fs nu fu fw dk translated">火箭科学. ru</p></div></div></div></a></div><div class="nl nm gp gr nn no"><a href="https://nithinbekal.com/posts/ruby-flip-flop/" rel="noopener  ugc nofollow" target="_blank"><div class="np ab fo"><div class="nq ab nr cl cj ns"><h2 class="bd io gy z fp nt fr fs nu fu fw im bi translated">Ruby中的触发器运算符</h2><div class="nv l"><h3 class="bd b gy z fp nt fr fs nu fu fw dk translated">触发器操作符是Ruby的奇怪特性之一，大多数人甚至都没有意识到。这是…</h3></div><div class="nw l"><p class="bd b dl z fp nt fr fs nu fu fw dk translated">nithinbekal.com</p></div></div><div class="nx l"><div class="ny l nz oa ob nx oc jt no"/></div></div></a></div><ul class=""><li id="c348" class="nc nd in kv b kw me la mf le ne li nf lm ng lq nh ni nj nk bi translated">参考文献—<a class="ae lr" href="https://ruby-doc.org/core-2.7.0/doc/syntax/control_expressions_rdoc.html#label-Flip-Flop" rel="noopener ugc nofollow" target="_blank">ruby-doc.org</a></li></ul></div></div>    
</body>
</html>