<html>
<head>
<title>Getting Python To Run In Your Browser — Using PyScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 PyScript 让 Python 在您的浏览器中运行</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/getting-python-to-run-in-your-browser-using-pyscript-1477b90d345d?source=collection_archive---------4-----------------------#2022-09-08">https://blog.devgenius.io/getting-python-to-run-in-your-browser-using-pyscript-1477b90d345d?source=collection_archive---------4-----------------------#2022-09-08</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="9bf9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们建立一个倒计时网页。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b0571d4bfa54bbdca79d154bda6e28fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k50P2C8KE_9jPOyJqDyjcg.png"/></div></div></figure></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h1 id="1da0" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">介绍</h1><p id="8401" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">又有新浪潮了！作为数据科学、机器学习和后端语言，Python 一直是第二大和最受欢迎的语言，JavaScript 作为前端和后端语言都占据了第一位。现在 python 想靠近前端，或者更好地将后端远离服务器。所以它不会是服务器代码，它只是脚本，它将在浏览器内部运行。</p><p id="b6c5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">本质上，在浏览器中使用 python，您的后端代码只需下载一次，就可以像 JavaScript 一样继续在浏览器中运行。所以服务器只提供它一次，就像其他文件、css、javascript 图像一样。</p><p id="16b3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这是由一种叫做网络组装的新技术实现的。</p><p id="50fb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">网络上的 WhatsApp 和我们手机上的很不一样。PyScript 可以解决这个问题。网飞可以利用压缩技术来确保数据成本不会阻止潜在客户，甚至 YouTube 和其他流媒体服务也可以利用这一点。那些允许下载的网站也可以提供不同的文件类型和大小供用户选择。我真的认为 PyScript 在多媒体和 web 方面有一席之地。</p><h1 id="2e7c" class="lb lc in bd ld le me lg lh li mf lk ll lm mg lo lp lq mh ls lt lu mi lw lx ly bi translated">装置</h1><p id="08e5" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">对于安装，PyScript 并不真的需要安装，你只需要把它链接到你的网页上。要将所有的 python 代码放在 html 中，您不需要服务器，但是要在单独的 python 文件中运行一些代码，您需要一个服务器。所以我们将安装一个服务器，一个轻量级的服务器。在我们可以在服务器上运行 python 之前，我们需要一个 ASGI web 框架。我们不会真的在服务器上运行 python，但是服务器将为浏览器提供文件，就像它为浏览器提供图像、css、javascript 和 html 一样。python 将在浏览器中运行。所以我们将使用这些库或技术。</p><ul class=""><li id="d9d3" class="mj mk in jm b jn jo jr js jv ml jz mm kd mn kh mo mp mq mr bi translated">FastAPI——Python 中发展最快的框架之一</li><li id="e30c" class="mj mk in jm b jn ms jr mt jv mu jz mv kd mw kh mo mp mq mr bi translated">uvicon——FastAPI 推荐的服务器。</li><li id="c208" class="mj mk in jm b jn ms jr mt jv mu jz mv kd mw kh mo mp mq mr bi translated">w3 . css——互联网上最小的 CSS 框架。最适合我们的使用案例</li></ul><h2 id="6f77" class="mx lc in bd ld my mz dn lh na nb dp ll jv nc nd lp jz ne nf lt kd ng nh lx ni bi translated">FastAPI</h2><p id="e9b2" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">要安装 FastAPI，请打开命令提示符或终端并执行</p><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="774b" class="mx lc in nk b gy no np l nq nr">$ pip install fastapi</span></pre><h2 id="36fc" class="mx lc in bd ld my mz dn lh na nb dp ll jv nc nd lp jz ne nf lt kd ng nh lx ni bi translated">紫玉米</h2><p id="7e50" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">要安装 Uvicorn，打开命令提示符或终端并执行</p><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="fe51" class="mx lc in nk b gy no np l nq nr">$ pip install "uvicorn[standard]"</span></pre><h2 id="1f14" class="mx lc in bd ld my mz dn lh na nb dp ll jv nc nd lp jz ne nf lt kd ng nh lx ni bi translated">W3.css</h2><p id="a74b" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">我们将从这个<a class="ae ns" href="https://www.w3schools.com/w3css/4/w3.css" rel="noopener ugc nofollow" target="_blank">链接</a>将 w3.css 链接到 webapp，您也可以下载到您的本地计算机上。</p><h2 id="0a9e" class="mx lc in bd ld my mz dn lh na nb dp ll jv nc nd lp jz ne nf lt kd ng nh lx ni bi translated">PyScript</h2><p id="5e24" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">PyScript 提供了两个文件供您链接。一个是 css 文件，当 PyScript 准备好它的组件时，它在页面上绘制一个加载器。另一个是作为 Javascript 文件的入口点。</p><p id="fc98" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">PyScript 自己的网站 PyScript.net 上提供了获取这些文件的链接。从那里，您可以选择安装选项并获得这两个文件。</p><p id="7fce" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">CSS:<link rel="”stylesheet”" href="”https://pyscript.net/alpha/pyscript.css&quot;"/>T3】js:&lt;script defer src = " https://py script . net/alpha/py script . js "&gt;&lt;/script&gt;</p><h2 id="4a58" class="mx lc in bd ld my mz dn lh na nb dp ll jv nc nd lp jz ne nf lt kd ng nh lx ni bi translated">背景图像</h2><p id="1a17" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">使用的背景图片是 Hasan Albari 的照片:<a class="ae ns" href="https://www.pexels.com/photo/silver-and-black-laptop-computer-1229861" rel="noopener ugc nofollow" target="_blank">https://www . pexels . com/Photo/silver-and-black-laptop-computer-1229861</a>。</p><p id="024e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">下载它或者你可以在你的电脑上使用任何合适的图片。把它复制到文件夹<strong class="jm io"> <em class="nt">图片</em> </strong>或者你可以直接使用链接。</p><p id="a74f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">所有安装和设置都已完成</strong>。</p></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h2 id="9b49" class="mx lc in bd ld my mz dn lh na nb dp ll jv nc nd lp jz ne nf lt kd ng nh lx ni bi translated">设置目录结构</h2><p id="a620" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">为 web 应用程序创建一个文件夹，命名为 say<strong class="jm io"> <em class="nt"> launchpage。</em> </strong>在里面再创建一个文件夹，命名为<strong class="jm io"> <em class="nt"> static </em> </strong>，然后创建另外 3 个文件夹，命名为<strong class="jm io"> <em class="nt"> css </em> </strong>、<strong class="jm io"> <em class="nt"> images </em> </strong>和<strong class="jm io"> <em class="nt"> python </em> </strong>，直接放在<strong class="jm io"> <em class="nt"> static </em> </strong>文件夹里面。<strong class="jm io"> <em class="nt"> python </em> </strong>文件夹会包含你自己的 python 代码。因此，您的文件夹结构应该如下所示:</p><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="e6f1" class="mx lc in nk b gy no np l nq nr">launchpage<br/>  /- static<br/>    -- css<br/>    -- images<br/>    -- python</span></pre></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h1 id="1b36" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">前端</h1><p id="2f09" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">现在，在我们编写 python 代码之前，我们应该先用 HTML 和 CSS 编写一个前端。</p><p id="efc5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在项目目录下创建一个文件，命名为 index.html。</p><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="8f57" class="mx lc in nk b gy no np l nq nr">launchpage<br/>  -  index.html<br/>  /- static<br/>    -- css<br/>    -- images<br/>    -- python</span></pre><p id="4b3e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">打开<strong class="jm io"><em class="nt">index.html</em></strong>并用此代码填充</p><blockquote class="nu nv nw"><p id="becf" class="jk jl nt jm b jn jo jp jq jr js jt ju nx jw jx jy ny ka kb kc nz ke kf kg kh ig bi translated">index.html</p></blockquote><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="f594" class="mx lc in nk b gy no np l nq nr">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;</span><span id="4078" class="mx lc in nk b gy oa np l nq nr">&lt;head&gt;<br/>    &lt;meta charset="UTF-8"/&gt;<br/>    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"/&gt;<br/>    &lt;title&gt;Lauchpage&lt;/title&gt;<br/>    &lt;link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css" /&gt;</span><span id="8339" class="mx lc in nk b gy oa np l nq nr">    &lt;style&gt;<br/>        html, body {<br/>            height: 100%;<br/>            width: 100%;<br/>        }</span><span id="a815" class="mx lc in nk b gy oa np l nq nr">        body {<br/>            background-image: url('./static/images/pexels.jpg');<br/>            background-size: cover;<br/>            color: white;<br/>        }</span><span id="c3d9" class="mx lc in nk b gy oa np l nq nr">        main {<br/>            width: 100%;<br/>            height: 100%;<br/>            display: flex;<br/>            align-items: center;<br/>            justify-content: center;<br/>        }</span><span id="74dc" class="mx lc in nk b gy oa np l nq nr">        .time-cont {<br/>            display: flex;<br/>            flex-wrap: nowrap;<br/>            align-items: baseline;<br/>            justify-content: center;<br/>        }</span><span id="d9b0" class="mx lc in nk b gy oa np l nq nr">    &lt;/style&gt;<br/>&lt;/head&gt;</span><span id="f757" class="mx lc in nk b gy oa np l nq nr">&lt;body&gt;</span><span id="8132" class="mx lc in nk b gy oa np l nq nr">&lt;main class="w3-display-container"&gt;<br/>    &lt;div class="w3-display-middle"&gt;<br/>        &lt;h1 class="w3-jumbo"&gt;Coming Soon!&lt;/h1&gt;<br/>        &lt;div class="time-cont"&gt;<br/>            &lt;p id="time_p" class="w3-large w3-center"&gt;10Days 12Hrs 15mns 45s&lt;/p&gt;<br/>            &lt;span&gt;&amp;nbsp;more&lt;/span&gt;<br/>        &lt;/div&gt;<br/>    &lt;/div&gt;<br/>&lt;/main&gt;</span><span id="b653" class="mx lc in nk b gy oa np l nq nr">&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="237f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="nt">上面的代码是一个普通的 html 文档，有几行 css 在</em> <strong class="jm io"> <em class="nt">样式</em> </strong> <em class="nt">标签中声明。尸体的背景是哈桑·阿尔巴里的照片。图像的 url 是一个相对路径，现在我们在前面使用一个点。这是在我们使用服务器提供服务之前。除了图像之外，我们只有两个文本，即将到来的和我们的模拟时间字符串。注意，声明我们的时间字符串的</em><strong class="jm io"><em class="nt">&lt;p&gt;</em></strong><em class="nt">标签有一个 id，就是</em><strong class="jm io"><em class="nt">time _ p</em></strong><em class="nt">。ID 是脚本语言通常与 HTML 元素通信的方式。</em></p><p id="c268" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">右键单击该文件，选择打开方式，然后选择您最喜欢的浏览器，您应该会看到类似这样的内容，呈现在您的浏览器中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b3fb0a5095d89260028cadb522a885ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rspz1JGOX4qeBr2rb-RC1w.png"/></div></div></figure><p id="c0e4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在我们的前端做好了。很短，是吧？</p></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h1 id="010d" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">后端</h1><p id="e305" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">对于 PyScript，后端在短时间内是后端，因为它实际上将在浏览器内部运行。我们不能说的是，‘服务器端代码’，后端是允许的。所以让我们继续我们的后端。</p><p id="3dc0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在 launchpage 文件夹中创建一个文件，并将其命名为 main.py，因此您的目录结构应该如下所示</p><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="fb1d" class="mx lc in nk b gy no np l nq nr">launchpage<br/>  -  index.html<br/>  -  main.py<br/>  /- static<br/>    -- css<br/>    -- images<br/>    -- python</span></pre><p id="3b89" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">打开 main.py 并用以下代码填充它</p><blockquote class="nu nv nw"><p id="a61c" class="jk jl nt jm b jn jo jp jq jr js jt ju nx jw jx jy ny ka kb kc nz ke kf kg kh ig bi translated">main.py</p></blockquote><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="823d" class="mx lc in nk b gy no np l nq nr">from fastapi import FastAPI<br/>from fastapi.responses import HTMLResponse<br/>from fastapi.staticfiles import StaticFiles</span><span id="c2e3" class="mx lc in nk b gy oa np l nq nr"><br/>app = FastAPI()</span><span id="f62c" class="mx lc in nk b gy oa np l nq nr">app.mount('/static', StaticFiles(directory='static'), name='static')</span><span id="d49d" class="mx lc in nk b gy oa np l nq nr"><br/>@app.get("/", response_class=HTMLResponse)<br/>def read_root():<br/>    with open('index.html', 'r') as ind:<br/>        data = ind.read()<br/>    return HTMLResponse(data)</span></pre><p id="267c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上面的代码中，我们有 python 导入语句。 <strong class="jm io"> <em class="nt"> FastAPI </em> </strong> <em class="nt">为主接口，</em><strong class="jm io"><em class="nt">html response</em></strong><em class="nt">为针对 JSON 的响应或其他形式的响应，这意味着响应不会被格式化为默认的 JSON 格式。</em><strong class="jm io"><em class="nt">app . mount</em></strong><em class="nt">代码确保当 url 以'/static '(' https://domain . com/Static ')开头时，它应该作为一个静态文件目录来处理，其中目录是' Static '，这意味着静态文件夹与我们的 main.py 文件在同一个文件夹中。最复杂的代码，也许是</em><strong class="jm io"><em class="nt">@ app . get</em></strong><em class="nt">decorator，这意味着当用户用 get 请求查询服务器的'/' ('https://domain.com/')路径时，它应该运行</em><strong class="jm io"><em class="nt">read _ root</em></strong><em class="nt">函数。在</em><strong class="jm io"><em class="nt">read _ root</em></strong><em class="nt">函数中，我们读取 index.html 并将内容以 HTML </em>的形式返回给用户</p><p id="8405" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">然后在 index.html 中使用。/static 并将其更改为/static。</p><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="d695" class="mx lc in nk b gy no np l nq nr">...<br/>    &lt;title&gt;Lauchpage&lt;/title&gt;<br/>    &lt;link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css" /&gt;</span><span id="8914" class="mx lc in nk b gy oa np l nq nr">    &lt;style&gt;<br/>        html, body {<br/>            height: 100%;<br/>            width: 100%;<br/>        }</span><span id="992a" class="mx lc in nk b gy oa np l nq nr">        body {<br/>            background-image: url('/static/images/pexels.jpg');<br/>            background-size: cover;<br/>            color: white;<br/>        }<br/>...</span></pre><p id="4d28" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要运行这个，正如我们已经达到的程度，您需要启动服务器。打开命令提示符或终端，并执行以下操作:</p><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="9c02" class="mx lc in nk b gy no np l nq nr">$ uvicorn main:app --reload</span></pre><p id="3963" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="nt"/><strong class="jm io"><em class="nt">main:app</em></strong><em class="nt">正在调用 main.py 文件并运行 main . py</em><strong class="jm io"><em class="nt">中我们声明为</em><strong class="jm io"><em class="nt">app = FastAPI()</em></strong><em class="nt">的</em></strong><em class="nt">app 变量</em></p><p id="6064" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">运行这个，你应该看到和以前一样的东西。唯一的变化是，现在我们不使用点相对路径，以服务于我们的形象。接下来，我们将开始编写 python 代码，这些代码将来自服务器。</p><h2 id="6ae0" class="mx lc in bd ld my mz dn lh na nb dp ll jv nc nd lp jz ne nf lt kd ng nh lx ni bi translated">Hello 浏览器</h2><p id="c3d8" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">让我们编写第一个在浏览器中运行的 python 代码。</p><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="a0f2" class="mx lc in nk b gy no np l nq nr">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;</span><span id="c2a1" class="mx lc in nk b gy oa np l nq nr">&lt;head&gt;<br/>    &lt;meta charset="UTF-8"/&gt;<br/>    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"/&gt;<br/>    &lt;title&gt;Lauchpage&lt;/title&gt;<br/>    &lt;link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css" /&gt;<br/>    &lt;link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" /&gt;</span><span id="41e2" class="mx lc in nk b gy oa np l nq nr">    &lt;style&gt;</span><span id="714a" class="mx lc in nk b gy oa np l nq nr">        ...</span><span id="4b04" class="mx lc in nk b gy oa np l nq nr">    &lt;/style&gt;<br/>    &lt;script defer src="https://pyscript.net/alpha/pyscript.js"&gt;&lt;/script&gt;<br/>&lt;/head&gt;</span><span id="7e29" class="mx lc in nk b gy oa np l nq nr">&lt;body&gt;</span><span id="c4c6" class="mx lc in nk b gy oa np l nq nr">&lt;main class="w3-display-container"&gt;<br/>    &lt;div class="w3-display-middle"&gt;<br/>        &lt;h1 class="w3-jumbo"&gt;Coming Soon!&lt;/h1&gt;<br/>        &lt;div class="time-cont"&gt;<br/>            &lt;p id="time_p" class="w3-large w3-center"&gt;10Days 12Hrs 15mns 45s&lt;/p&gt;<br/>            &lt;span&gt;&amp;nbsp;more&lt;/span&gt;<br/>        &lt;/div&gt;<br/>        &lt;py-script&gt;<br/>            print('Hello Browser')<br/>        &lt;/py-script&gt;<br/>    &lt;/div&gt;<br/>&lt;/main&gt;</span><span id="ed2a" class="mx lc in nk b gy oa np l nq nr">&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="d798" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="nt">上面的代码链接了 PyScript 的 css 和 JavaScript。然后我们有了一个</em><strong class="jm io"><em class="nt">&lt;py-script&gt;</em></strong><em class="nt">标签，从里面我们可以运行 python 代码，目前我们只打印'</em><strong class="jm io"><em class="nt">Hello Browser</em></strong><em class="nt">'</em></p><p id="3d6a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因为 Uvicorn 是用 reload 参数调用的，所以您应该能够刷新页面并看到如下内容。如果你已经关闭了它，在终端中再次运行 Uvicorn 代码，然后刷新你的浏览器</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1f8cacaae8c18783532f42b6c7eba6a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MpZwlJxac7TyAHatK8rWFQ.png"/></div></div></figure><p id="86f1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">对于现在的<strong class="jm io"> Hello Browser </strong>，打印在我们定义<strong class="jm io"> &lt; py-script &gt; </strong>标签的地方，在<strong class="jm io"> span </strong>的父<strong class="jm io"> div </strong>之后。但是将来我们会对现有的 html 元素进行修改。</p><p id="a93d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">创建一个新文件 countdown.py，这样你的目录结构应该是这样的:</p><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="d6b3" class="mx lc in nk b gy no np l nq nr">launchpage<br/>  -  index.html<br/>  -  main.py<br/>  /- static<br/>    -- css<br/>    -- images<br/>    /- python<br/>      -  countdown.py</span></pre><p id="5d8e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">打开 countdown.py 文件，并用以下代码填充它。</p><blockquote class="nu nv nw"><p id="b9dd" class="jk jl nt jm b jn jo jp jq jr js jt ju nx jw jx jy ny ka kb kc nz ke kf kg kh ig bi translated">倒计时. py</p></blockquote><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="b8ac" class="mx lc in nk b gy no np l nq nr">from datetime import datetime</span><span id="cceb" class="mx lc in nk b gy oa np l nq nr"><br/>DATE_MAP = ('s', 'mns', 'Hrs', 'Days', 'Months', 'Years')</span><span id="cb74" class="mx lc in nk b gy oa np l nq nr"><br/>def get_time() -&gt; str:<br/>    dt = datetime(2022, 10, 1, 0, 0, 0)<br/>    delta = dt - datetime.now()<br/>    cleaned_delta = str(delta).replace(' days, ', ':')<br/>    deltas = cleaned_delta.split('.')[0].split(':')<br/>    x = len(deltas)<br/>    stmts = []</span><span id="6b79" class="mx lc in nk b gy oa np l nq nr">    for i in range(x):<br/>        ind = x - 1 - i<br/>        stmt = deltas[i] + DATE_MAP[ind]<br/>        stmts.append(stmt)</span><span id="0be0" class="mx lc in nk b gy oa np l nq nr">return ' '.join(stmts)</span></pre><p id="b854" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上面的代码中，我们有一个元组，它以简短的形式存储秒、分和小时，以完整的形式存储日期的名称，没有任何偏见，只是常规。然后有一个函数从 2022 年 10 月 1 日减去我们当前的日期，看看我们还剩多少天，多少小时等等。它将结果作为字符串返回</p><p id="d25e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在将<strong class="jm io"> countdown.py </strong>文件导入到 index.html 中</p><blockquote class="nu nv nw"><p id="4650" class="jk jl nt jm b jn jo jp jq jr js jt ju nx jw jx jy ny ka kb kc nz ke kf kg kh ig bi translated">index.html</p></blockquote><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="8855" class="mx lc in nk b gy no np l nq nr">    ...</span><span id="2743" class="mx lc in nk b gy oa np l nq nr">    &lt;/style&gt;<br/>    &lt;script defer src="https://pyscript.net/alpha/pyscript.js"&gt;&lt;/script&gt;<br/>    &lt;py-env&gt;<br/>        - paths:<br/>            - /static/python/countdown.py<br/>    &lt;/py-env&gt;</span><span id="dd22" class="mx lc in nk b gy oa np l nq nr">&lt;/head&gt;</span><span id="9aca" class="mx lc in nk b gy oa np l nq nr">&lt;body&gt;</span><span id="dfe7" class="mx lc in nk b gy oa np l nq nr">...</span></pre><p id="ad6f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="nt">在上面的代码中，我们添加了一个</em><strong class="jm io"><em class="nt">&lt;py-env&gt;</em></strong><em class="nt">标签在</em><strong class="jm io"><em class="nt">&lt;head&gt;</em></strong><em class="nt">里面，然后导入我们的</em><strong class="jm io"><em class="nt">count down . py</em></strong><em class="nt">，考虑到我们为 FastAPI 配置的静态文件夹设置，放在 main.py 文件中。</em></p><p id="d35d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在删除 hello browser 代码，并像在 python 中一样导入这个文件</p><blockquote class="nu nv nw"><p id="1e96" class="jk jl nt jm b jn jo jp jq jr js jt ju nx jw jx jy ny ka kb kc nz ke kf kg kh ig bi translated">main.py</p></blockquote><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="3c53" class="mx lc in nk b gy no np l nq nr">            ...</span><span id="511e" class="mx lc in nk b gy oa np l nq nr">            &lt;span&gt;&amp;nbsp;more&lt;/span&gt;<br/>        &lt;/div&gt;<br/>        &lt;py-script&gt;<br/>            from countdown import get_time<br/>        &lt;/py-script&gt;<br/>    &lt;/div&gt;<br/>&lt;/main&gt;</span><span id="c96d" class="mx lc in nk b gy oa np l nq nr">...</span></pre><p id="dde8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在使用<strong class="jm io"> <em class="nt"> asyncio </em> </strong>，让我们调用在<strong class="jm io"> <em class="nt"> countdown.py </em> </strong>中声明的<strong class="jm io"> <em class="nt"> get_time </em> </strong>函数来给我们每秒剩余的时间字符串。</p><blockquote class="nu nv nw"><p id="458a" class="jk jl nt jm b jn jo jp jq jr js jt ju nx jw jx jy ny ka kb kc nz ke kf kg kh ig bi translated">main.py</p></blockquote><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="cc25" class="mx lc in nk b gy no np l nq nr">...</span><span id="0e7d" class="mx lc in nk b gy oa np l nq nr">&lt;py-script&gt;<br/>    from countdown import get_time<br/>    import asyncio</span><span id="e88c" class="mx lc in nk b gy oa np l nq nr"><br/>    async def tell_time():<br/>        while True:<br/>            time_p = Element('time_p').write(get_time())<br/>            await asyncio.sleep(1)</span><span id="40f0" class="mx lc in nk b gy oa np l nq nr"><br/>    pyscript.run_until_complete(tell_time())</span><span id="7773" class="mx lc in nk b gy oa np l nq nr">&lt;/py-script&gt;</span><span id="b54f" class="mx lc in nk b gy oa np l nq nr">...</span></pre><p id="7f21" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="nt">在上面的代码中，我们使用</em><strong class="jm io"><em class="nt">async</em></strong><em class="nt">关键字定义了一个函数。这个函数调用我们的</em><strong class="jm io"><em class="nt">get _ time</em></strong><em class="nt">函数，并把它的返回字符串写成</em><strong class="jm io"><em class="nt">time _ p</em></strong><em class="nt">的内部文本，也就是那个带有“</em><strong class="jm io"><em class="nt">10 days 12 hrs 15 MnS 45s<strong class="jm io">标签的</strong></em><strong class="jm io"><em class="nt">&lt;p&gt;</em></strong><em class="nt">它在一个</em> <strong class="jm io"> <em class="nt">而</em> </strong> <em class="nt">循环中这样做，永远运行。它只休眠一秒钟，所以这段代码运行时，时间字符串每秒都会改变。然后我们调用</em><strong class="jm io"><em class="nt">pyscript . run _ until _ complete</em></strong><em class="nt">来运行</em><strong class="jm io"><em class="nt">async</em></strong><em class="nt">函数</em><strong class="jm io"><em class="nt">tell _ time</em></strong><em class="nt">。在这种情况下，它将永远不会完成。这证明 python 确实在浏览器中运行，因为你可以在页面加载完成后关闭服务器，你仍然可以永远得到时间更新。</em></strong></p><p id="78e8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在完整的 index.html 文件应该看起来像这样</p><blockquote class="nu nv nw"><p id="eb43" class="jk jl nt jm b jn jo jp jq jr js jt ju nx jw jx jy ny ka kb kc nz ke kf kg kh ig bi translated">index.html</p></blockquote><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="8c92" class="mx lc in nk b gy no np l nq nr">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;</span><span id="f9ae" class="mx lc in nk b gy oa np l nq nr">&lt;head&gt;<br/>&lt;meta charset="UTF-8"/&gt;<br/>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"/&gt;<br/>&lt;title&gt;Launchpage&lt;/title&gt;<br/>&lt;link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css" /&gt;<br/>&lt;link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" /&gt;</span><span id="17fe" class="mx lc in nk b gy oa np l nq nr">&lt;style&gt;<br/>html, body {<br/>height: 100%;<br/>width: 100%;<br/>}</span><span id="b39a" class="mx lc in nk b gy oa np l nq nr">body {<br/>background-image: url('/static/images/pexels.jpg');<br/>background-size: cover;<br/>color: white;<br/>}</span><span id="84e5" class="mx lc in nk b gy oa np l nq nr">main {<br/>width: 100%;<br/>height: 100%;<br/>display: flex;<br/>align-items: center;<br/>justify-content: center;<br/>}</span><span id="804d" class="mx lc in nk b gy oa np l nq nr">.time-cont {<br/>display: flex;<br/>flex-wrap: nowrap;<br/>align-items: baseline;<br/>justify-content: center;<br/>}</span><span id="96ba" class="mx lc in nk b gy oa np l nq nr">&lt;/style&gt;</span><span id="d495" class="mx lc in nk b gy oa np l nq nr">&lt;script defer src="https://pyscript.net/alpha/pyscript.js"&gt;&lt;/script&gt;</span><span id="9bfc" class="mx lc in nk b gy oa np l nq nr">&lt;py-env&gt;<br/>- paths:<br/>- /static/python/countdown.py<br/>&lt;/py-env&gt;</span><span id="bc0d" class="mx lc in nk b gy oa np l nq nr">&lt;/head&gt;<br/>&lt;body&gt;</span><span id="c0da" class="mx lc in nk b gy oa np l nq nr">&lt;main class="w3-display-container"&gt;<br/>&lt;div class="w3-display-middle"&gt;<br/>&lt;h1 class="w3-jumbo"&gt;Coming Soon!&lt;/h1&gt;<br/>&lt;div class="time-cont"&gt;<br/>&lt;p id="time_p" class="w3-large w3-center"&gt;10Days 12Hrs 15mns 45s&lt;/p&gt;&lt;span&gt;&amp;nbsp;more&lt;/span&gt;<br/>&lt;/div&gt;</span><span id="74bd" class="mx lc in nk b gy oa np l nq nr">&lt;py-script&gt;<br/>from countdown import get_time<br/>import asyncio</span><span id="6bc3" class="mx lc in nk b gy oa np l nq nr"><br/>async def tell_time():<br/>while True:<br/>time_p = Element('time_p').write(get_time())<br/>await asyncio.sleep(1)</span><span id="159f" class="mx lc in nk b gy oa np l nq nr"><br/>pyscript.run_until_complete(tell_time())</span><span id="169c" class="mx lc in nk b gy oa np l nq nr">&lt;/py-script&gt;<br/>&lt;/div&gt;</span><span id="ec21" class="mx lc in nk b gy oa np l nq nr">&lt;/main&gt;</span><span id="172a" class="mx lc in nk b gy oa np l nq nr">&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="4f59" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，当您刷新页面或重新运行 uvicorn 时，您应该会看到类似这样的内容:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b0571d4bfa54bbdca79d154bda6e28fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k50P2C8KE_9jPOyJqDyjcg.png"/></div></div></figure><p id="1374" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">全部完成！</p></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h1 id="d773" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">最后的想法</h1><p id="ce61" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">目前 PyScript 正在大量开发中，它也有点不稳定。将它安装到您的服务器上以增加加载时间，还没有完全完成。但是这将很快完成，加载时间会更快。文档也很害怕，但是 python 社区已经准备好了。</p><p id="a672" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">当 PyScript 处于实验模式时，它的潜在改编也应该处于实验模式，在你的家里和办公室，作为爱好项目和资金充足的研究。一起前途一片光明。</p><p id="b6f3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">再见。</p></div></div>    
</body>
</html>