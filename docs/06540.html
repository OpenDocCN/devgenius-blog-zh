<html>
<head>
<title>How to schedule your first batch job with Azure Batch Job service?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用 Azure 批处理作业服务安排您的第一个批处理作业？</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-schedule-your-first-batch-job-with-azure-batch-job-service-c5d1c5601de4?source=collection_archive---------6-----------------------#2022-01-15">https://blog.devgenius.io/how-to-schedule-your-first-batch-job-with-azure-batch-job-service-c5d1c5601de4?source=collection_archive---------6-----------------------#2022-01-15</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="aaec" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">拥有大量客户的大型应用程序的组织在后台运行多个任务，这些任务可以是从处理数据、测试新功能到处理账单等任何任务。现在，设计和角色对于用高性能计算(HPC)并行完成所有大规模工作同样重要。</p><p id="ad3b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Azure 批处理作业服务让您能够高效地在并行和高性能计算应用程序中运行大规模作业。您可以执行并行任务，如数据处理、图像分析、软件测试等。在本教程中，我们将了解什么是 Azure 批处理作业服务？它是如何工作的，如何用它来安排您的第一批作业？</p><p id="3ad8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">什么是 Azure 批处理服务？</strong></p><p id="4e04" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Azure Batch Service 是 Azure 的一项计算服务，用于对简单到大型复杂操作进行批处理。它管理超过应用程序能力的应用程序工作负载，将其划分为多个作业，然后在不同的虚拟机中并行运行这些作业。</p><p id="645b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">例如，如果您需要在您的应用程序中处理大量数据，这可能会导致崩溃、昂贵的服务器成本和缓慢的速度，并且无法保证完成结果。Azure Batch Service 接受工作负载，并将其分成多个节点(虚拟机)，这些节点并行运行应用程序的不同部分。你可以说节点正在执行的任务是整个工作负载的子集。</p><p id="ac06" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">Azure 批量服务定价</strong></p><p id="7782" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Azure 批处理服务没有额外的费用。您需要为正在使用的资源付费，例如虚拟机和存储。</p><p id="43a6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">使用 Azure Batch Service 有什么好处？</strong></p><p id="edfc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">●它可以自动计算从单个节点到多个节点的功率扩展。</p><p id="ff93" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">●您不必为批量服务付费，您只需为其他资源付费。</p><p id="6c81" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">●您可以更快地管理高容量任务或大量数据。</p><p id="b7c2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">批量服务的用例</strong></p><p id="0dfa" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Azure Batch service 可用于批量运行本质上并行且紧密耦合的应用程序。例如:</p><p id="46c1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">●软件测试执行</p><p id="7cd9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">●媒体转码</p><p id="efe7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">● VFX 和 3D 图像渲染</p><p id="5309" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">●金融风险建模</p><p id="84a5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">●流体动力学</p><p id="64a6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">●多节点人工智能训练</p><p id="1d28" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">●光学字符识别</p><p id="7585" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">【Azure 批处理服务是如何工作的？</p><p id="76dd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">它创建一个称为计算节点的虚拟机池，并在这些节点上安装您运行的应用程序。您不需要为集群或作业调度安装和管理任何额外的软件。这个我们来详细了解一下。这是一张解释 Azure 批处理服务工作原理的图片。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b796b5d1faf1765eba560c2d5efb612b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*40c5mRnODXwUW7EG7Ib82w.png"/></div></div></figure><ol class=""><li id="7dd7" class="ku kv in jm b jn jo jr js jv kw jz kx kd ky kh kz la lb lc bi translated">文件和应用程序被上传到 Azure 存储帐户。文件数据可以是应用程序使用的任何类型，如视频、文档或图像文件。应用程序可以处理您的数据。</li><li id="a54c" class="ku kv in jm b jn ld jr le jv lf jz lg kd lh kh kz la lb lc bi translated">在您的批处理帐户和作业中创建计算节点的批处理池来运行任务。这里，虚拟机是指执行任务的计算节点。当我们向作业添加任务时，该任务被设置为由计算节点执行。</li><li id="c1c9" class="ku kv in jm b jn ld jr le jv lf jz lg kd lh kh kz la lb lc bi translated">在任务执行之前，应用程序安装在节点上，如果还没有安装的话。此外，输入数据也被下载。从存储帐户下载完成后，任务将在分配的节点上执行。</li><li id="ba3e" class="ku kv in jm b jn ld jr le jv lf jz lg kd lh kh kz la lb lc bi translated">当任务运行时，您可以查询和监视它们。</li><li id="f484" class="ku kv in jm b jn ld jr le jv lf jz lg kd lh kh kz la lb lc bi translated">一旦任务完成，输出数据就会上传到 Azure storage。</li><li id="16db" class="ku kv in jm b jn ld jr le jv lf jz lg kd lh kh kz la lb lc bi translated">接下来，您可以下载处理过的数据。</li></ol><p id="9d43" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">使用 Azure 批处理服务运行您的第一个批处理作业</strong></p><p id="9844" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，让我们看看如何使用 Azure Batch Service 创建您的第一个批处理作业。</p><ol class=""><li id="4945" class="ku kv in jm b jn jo jr js jv kw jz kx kd ky kh kz la lb lc bi translated">打开您的 Azure 云门户并创建新的资源组。</li><li id="54b7" class="ku kv in jm b jn ld jr le jv lf jz lg kd lh kh kz la lb lc bi translated">在门户首页搜索<strong class="jm io">批量账户</strong>，点击<strong class="jm io">创建批量账户。</strong></li><li id="c3ba" class="ku kv in jm b jn ld jr le jv lf jz lg kd lh kh kz la lb lc bi translated">选择<strong class="jm io">资源组</strong>并输入<strong class="jm io">批处理帐户名。</strong>帐户名必须唯一。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi li"><img src="../Images/083ecd7ae19172239d0b22101cbc090f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8BSikVlxoC1bJ-NhCO7nZw.png"/></div></div></figure><p id="20e0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">4.选择存储帐户。如果您已经有一个存储帐户，则可以选择创建一个新帐户。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lj"><img src="../Images/75bc2784f9963bfe44ce25b802cac948.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9yl2Q_F0-QrYgRMFVily5Q.png"/></div></div></figure><p id="c81b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">5.点击<strong class="jm io">审查+创建</strong>，然后点击<strong class="jm io">创建。</strong>您的批量账户将被创建。</p><p id="f33a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">创建一个计算节点池</strong></p><p id="a322" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们已经创建了一个<strong class="jm io">批处理帐户</strong>，现在我们将创建一个节点池，其中包含两个运行 Azure Marketplace 的 windows 服务器的节点。</p><ol class=""><li id="ad48" class="ku kv in jm b jn jo jr js jv kw jz kx kd ky kh kz la lb lc bi translated">转到您的批处理帐户，选择<strong class="jm io">池</strong>，然后在<strong class="jm io">添加上创建。</strong></li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/8c8c8eff9be2dcbe9ba527122093ece6.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*-EViDj-UOrsspJYS8z7NoQ.png"/></div></figure><p id="bdf6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">2.输入一个池 ID，它基本上类似于您的池的名称。并输入显示名称。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f9b5e2f954430ea23fb20c0aa56063de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oXMF93DITyybhWW9WyPvrw.png"/></div></div></figure><p id="5e3c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">3.向下滚动，在<strong class="jm io">操作系统</strong>部分，输入以下详细信息。</p><p id="d681" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">图像类型:市场</p><p id="18c3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">发布者:microsoftwindowsserver</p><p id="67ea" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">报价:windowsserver</p><p id="2d1f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">SKU:2019-数据中心-核心-小型磁盘</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a404ff14474e71f6241c5da973bd8537.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cANmPd874Hbf73Dbh2-PLQ.png"/></div></div></figure><p id="c5a1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">4.再次向下滚动到<strong class="jm io">节点大小</strong>并输入以下详细信息。</p><p id="1826" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">节点定价层:标准 _A1_v2</p><p id="4e65" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">目标专用节点:2</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b93ef92084fa861069cbf2e8df6f89c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_5tXHXnVYm9x5FhBn7I4-A.png"/></div></div></figure><p id="117b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">5.将作业列表保留为默认，点击<strong class="jm io">确定</strong>创建池。将立即创建池，但在计算节点分配方面需要一些时间。同时，我们可以创建<strong class="jm io">作业</strong>和<strong class="jm io">任务。</strong></p><p id="3969" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">创建工作</strong></p><p id="5ddc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">批处理作业就像多个任务的逻辑组。由于我们有一个池，现在让我们为它创建一个作业。</p><ol class=""><li id="1e0b" class="ku kv in jm b jn jo jr js jv kw jz kx kd ky kh kz la lb lc bi translated">转到您的<strong class="jm io">批处理帐户</strong>，点击<strong class="jm io">工作</strong>，然后<strong class="jm io">添加。</strong></li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d6299cef38f58693cd5f5704d2da06b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t-gDIclySKNsV85Iqgy3UQ.png"/></div></div></figure><p id="8377" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">2.输入职务名称并选择您的人才库。将其他一切保留为默认，并点击<strong class="jm io">确定。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0d2f03c5fdc8f1970387e0758d0d41bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WY2_Hbx2Nj1-DXnIw2YEBA.png"/></div></div></figure><p id="0983" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">创建任务</strong></p><p id="a9a7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在您的批处理帐户中，选择您的作业，在这里您将创建一个示例任务。通常，我们创建多个任务，但这里我们将创建两个相同的任务来运行命令行并显示批处理环境，然后等待 90 秒。</p><ol class=""><li id="90b4" class="ku kv in jm b jn jo jr js jv kw jz kx kd ky kh kz la lb lc bi translated">选择<strong class="jm io">添加</strong>并输入您的<strong class="jm io">任务 ID。</strong></li><li id="ca4d" class="ku kv in jm b jn ld jr le jv lf jz lg kd lh kh kz la lb lc bi translated">在命令行中输入—cmd/c“set AZ _ BATCH &amp; time out/t 90 &gt; NUL”</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8d66531b5a62e7cae53d405d2e74dad8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j9HqMpLuSUP07wfOcliwlQ.png"/></div></div></figure><p id="da60" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">3.将其他内容保留为默认值，并点击<strong class="jm io">提交。</strong>使用不同的任务 ID 和相同的命令行命令创建另一个任务。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ll"><img src="../Images/c201d106d42f456c6656f0623353193b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K7OFWAIAca-F_Grz57RHGA.png"/></div></div></figure><p id="98d9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">创建任务后，如果一个节点可用，那么一个任务将在其上运行，batch 将在另一个节点上启动第二个任务。要查看输出，选择一个任务，然后选择标准输出的<strong class="jm io"> <em class="lm"> stdout.txt </em> </strong>文件。它将显示 Azure 批处理环境变量。</p><p id="c335" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">结论</strong></p><p id="e3bd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">当你有一个大的工作负载时，Azure Batch Service 是一个以更高的性能并行运行多个进程的好方法。在本教程中，我们看到了如何创建第一个批处理作业来显示节点的环境变量。</p></div></div>    
</body>
</html>