# Linux ç³»ç»Ÿå’Œæ•…éšœæ’é™¤å·¥å…·

> åŸæ–‡ï¼š<https://blog.devgenius.io/linux-system-and-troubleshooting-tools-1a3385b53753?source=collection_archive---------3----------------------->

> **æ•…éšœæ’é™¤**æ˜¯[é—®é¢˜è§£å†³](https://en.wikipedia.org/wiki/Problem_solving)çš„ä¸€ç§å½¢å¼ï¼Œå¸¸ç”¨äºä¿®å¤æœºå™¨æˆ–ç³»ç»Ÿä¸Šçš„æ•…éšœäº§å“æˆ–æµç¨‹ã€‚è¿™æ˜¯ä¸€ä¸ªåˆä¹é€»è¾‘çš„ã€ç³»ç»Ÿçš„å¯»æ‰¾é—®é¢˜æ ¹æºçš„è¿‡ç¨‹ï¼Œç›®çš„æ˜¯è§£å†³é—®é¢˜ï¼Œå¹¶ä½¿äº§å“æˆ–è¿‡ç¨‹å†æ¬¡è¿è¡Œâ€”â€”ç»´åŸºç™¾ç§‘

![](img/829f6e8877c289e125c145937a0a6b20.png)

å½“å‡ºç°é‡å¤§ä¸­æ–­å’ŒæŠ¥å‘Šçš„é”™è¯¯æ—¶ï¼Œå¾ˆè‡ªç„¶åœ°è¦å¼€å§‹æ•…éšœæ’é™¤ï¼Œå¹¶è¯•å›¾å°½å¿«æ‰¾åˆ°æ ¹æœ¬åŸå› ã€‚è™½ç„¶ç¡®å®šæ ¹æœ¬åŸå› æ˜¯ç¬¬ä¸€ååº”ï¼Œä½†æ¨èçš„è¡ŒåŠ¨æ–¹é’ˆæ˜¯ ***ä½¿ç³»ç»Ÿåœ¨è¿™ç§æƒ…å†µä¸‹å°½å¯èƒ½å¥½åœ°å·¥ä½œã€‚*** ç±»ä¼¼äºé©¾é©¶é£æœºï¼Œé£è¡Œå‘˜è¢«æ•™å¯¼åœ¨ç´§æ€¥æƒ…å†µä¸‹é©¾é©¶é£æœºï¼›ä¸è®©é£æœºå®‰å…¨ç€é™†ç›¸æ¯”ï¼Œæ’é™¤æ•…éšœæ˜¯æ¬¡è¦çš„ã€‚

æœ¬æ–‡å°†ä»‹ç»ä¸€ç§ç³»ç»Ÿçš„æ•…éšœæ’é™¤æ–¹æ³•å’Œ linux å·¥å…·ï¼Œä»¥äº†è§£ç³»ç»Ÿæ•…éšœå¹¶æœ‰æ•ˆåœ°è§£å†³é—®é¢˜ã€‚(éå¸¸æ„Ÿè°¢æˆ‘çš„å¯¼å¸ˆæ•™ç»™æˆ‘è¿™äº›æœ‰ç”¨çš„ linux ç³»ç»Ÿå·¥å…·ï¼ï¼)

# >>æ—¥å¿—

åœ¨ä»»ä½•å¼€å‘äººå‘˜çš„å·¥å…·åŒ…ä¸­ï¼Œæ—¥å¿—è®°å½•éƒ½æ˜¯ä¸€ä¸ªæ–¹ä¾¿çš„å¥½å·¥å…·ï¼Œå¯ä»¥ä¿®å¤ä»»ä½•é—®é¢˜ã€‚æ—¥å¿—æ–‡ä»¶å…è®¸æ‚¨å¿«é€Ÿäº†è§£åº”ç”¨ç¨‹åºçš„è¡Œä¸ºã€‚å¯¼å‡ºå…³äºæ¯ä¸ªæ“ä½œå’Œç³»ç»ŸçŠ¶æ€çš„ä¿¡æ¯å¯ä»¥æ›´å®¹æ˜“åœ°åˆ†ææŸä¸ªè¿›ç¨‹åœ¨ç»™å®šæ—¶é—´ç‚¹æ­£åœ¨åšä»€ä¹ˆã€‚ä¸€äº›é‡è¦çš„ Linux ç³»ç»Ÿæ—¥å¿—åŒ…æ‹¬`/var/log/syslog`ã€`/var/log/auth.log`ã€`/var/log/kern.log`å’Œ`/var/log/dmesg`ã€‚

å¯¹äºè°ƒè¯•æ¥è¯´ï¼ŒStacktraces ä¹Ÿæ˜¯æ‚¨æœ€å¥½çš„æœ‹å‹ã€‚ä»æ£€æŸ¥æŠ¥å‘Šçš„é”™è¯¯å¼€å§‹ï¼Œä½¿ç”¨å †æ ˆè·Ÿè¸ªå›æº¯ç¨‹åºçš„å†»ç»“çŠ¶æ€ï¼Œæ‰¾å‡ºå¦‚ä½•ä¿®å¤é—®é¢˜ã€‚åœ¨æ•´ä¸ªå †æ ˆä¸­è·Ÿè¸ªè¯·æ±‚æä¾›äº†ä¸€ç§å¼ºå¤§çš„æ–¹æ³•æ¥æ›´å¥½åœ°äº†è§£åˆ†å¸ƒå¼ç³»ç»Ÿæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

å¯¹ç³»ç»Ÿè®¾è®¡çš„é€å½»ç†è§£æœ‰åŠ©äºæå‡ºå…³äºå“ªé‡Œå‡ºé”™çš„å‡è®¾ã€‚æ˜¯æ—¶å€™æ·±å…¥æŒ–æ˜æœ‰é—®é¢˜çš„ä¸»æœºä»¥ç¡®å®šåŸå› äº†ã€‚

# >>æµç¨‹

æ•…éšœæ’é™¤è¿‡ç¨‹çš„ä¸‹ä¸€æ­¥æ˜¯è°ƒæŸ¥ä¸»æœºï¼Œä»¥æ£€æŸ¥å»¶è¿Ÿã€CPU ä½¿ç”¨ç‡æˆ–æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹æ•°é‡æ˜¯å¦å¢åŠ ã€‚è¿›ç¨‹ç›‘æ§æ˜¯æœ€å…¨é¢çš„å·¥å…·ä¹‹ä¸€ï¼Œå¯ä»¥çœ‹åˆ°ä¸€ä¸ªåº”ç”¨ç¨‹åºæ­£åœ¨åšä»€ä¹ˆã€‚

> æˆ‘ä»¬æ˜¯å¦æœ€å¤§åŒ–äº†ç³»ç»Ÿèµ„æºï¼Ÿ

```
**top**- command that provides a dynamic real-time view of a running system**htop** - command to interactively monitor the systemâ€™s vital resources or serverâ€™s processes in real time
```

***htop****æ˜¯ä¸€æ¬¾æ›´æ¼‚äº®ã€æ›´é²œè‰³çš„æœ€æ–°ç‰ˆæœ¬ ***top*** ä½¿å¾—***htop****æˆä¸ºè§£å†³æœåŠ¡å™¨æ€§èƒ½é—®é¢˜çš„æ›´å¥½å·¥å…·ã€‚**

*****htop*** æ˜¾ç¤ºæœåŠ¡å™¨ä¸Šæ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…çš„å®æ—¶æ¦‚è§ˆã€‚æˆ‘ä»¬ä¸€çœ¼å°±èƒ½çœ‹åˆ°ä»¥ä¸‹å†…å®¹:**

*   **æ‚¨çš„æœåŠ¡å™¨ä¸Šçš„å•ä¸ª CPU çš„æ•°é‡åŠå…¶èµ„æºåˆ†åˆ«ç»†åˆ†**
*   **æŒ‰è¿›ç¨‹ç»†åˆ†çš„ RAM ä½¿ç”¨æƒ…å†µ**
*   **äº¤æ¢ç”¨æ³•**
*   **ä»»åŠ¡æ€»æ•°ã€çº¿ç¨‹æ•°å’Œæ­£åœ¨è¿è¡Œçš„ä»»åŠ¡æ•°**
*   **1 åˆ†é’Ÿã€5 åˆ†é’Ÿã€10 åˆ†é’Ÿå¹³å‡è´Ÿè½½**
*   **ç³»ç»Ÿæ­£å¸¸è¿è¡Œæ—¶é—´å’Œå½“å‰æ—¶é—´**
*   **æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹â€”[PID | User | Priority | Niceness | Virtual Image | Resident Size | Shared Mem Size | CPU % | Memory % | Time | Command**

**![](img/0ea22ce26212ec846991a21cdceac7df.png)**

**htop å‘½ä»¤**

**ä¸€æ—¦æ‚¨ç¡®å®šäº†å¯ç–‘çš„æµç¨‹ï¼Œé‚£ä¹ˆæ‚¨å¯èƒ½å¸Œæœ›å°†é‡ç‚¹æ”¾åœ¨è¯¥æµç¨‹ä¸Šã€‚å¯ä»¥ä½¿ç”¨***top***/**/*htop***å‘½ä»¤:**

```
****top -p $PID****
```

**å¦‚æœè¿›ç¨‹çœ‹èµ·æ¥è¡Œä¸ºæ­£å¸¸ï¼Œä½†æ˜¯ç³»ç»Ÿçš„å†…å­˜ä½¿ç”¨é«˜äºå¹³å‡å€¼ï¼Œæˆ‘ä»¬å¯ä»¥è¯¦ç»†æ£€æŸ¥å†…å­˜ä½¿ç”¨ã€‚**

# **>>å†…å­˜**

**è¦æ‰¾å‡ºæœåŠ¡å™¨ä¸Šå†…å­˜æ¶ˆè€—å¢åŠ çš„åŸå› ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å·¥å…·æ¥è¯†åˆ«å†…å­˜å¯†é›†å‹åº”ç”¨ç¨‹åºï¼Œå¹¶é‡Šæ”¾å†…å­˜å’Œä¼˜åŒ–æ€§èƒ½:**

```
****free** - display amount of free and used memory in the system**
```

**ä½¿ç”¨ **top/htop** å‘½ä»¤ï¼Œä»…æ˜¾ç¤ºç©ºé—²å’Œå·²ç”¨å†…å­˜é‡ã€‚ **free** å‘½ä»¤æ˜¾ç¤º:ç©ºé—²å’Œä½¿ç”¨çš„ç‰©ç†å†…å­˜æ€»é‡ï¼Œç³»ç»Ÿä¸­çš„äº¤æ¢å†…å­˜æ€»é‡ï¼Œå†…æ ¸ä½¿ç”¨çš„ç¼“å†²åŒºå’Œç¼“å­˜ã€‚**

**OOM é»‘ä»”æ˜¯å½“ç³»ç»Ÿå†…å­˜ä¸¥é‡ä¸è¶³æ—¶ï¼Œlinux å†…æ ¸ä½¿ç”¨çš„ä¸€ä¸ªè¿›ç¨‹ã€‚è¿™æ˜¯å› ä¸ºæœåŠ¡å™¨ä¸Šçš„è¿›ç¨‹æ¶ˆè€—äº†å¤§é‡å†…å­˜ï¼Œç³»ç»Ÿéœ€è¦å°†å†…å­˜åˆ†é…ç»™å…¶ä»–è¿›ç¨‹ã€‚å¦‚æœç³»ç»Ÿä¸Šæ²¡æœ‰å¯ç”¨äº¤æ¢ï¼Œå†…æ ¸ä¼šç»™æ¯ä¸ªæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ä¸€ä¸ªåä¸º ***ooo_score*** çš„åˆ†æ•°ï¼Œè¯¥åˆ†æ•°å†³å®šäº†åœ¨å¯ç”¨å†…å­˜ä¸è¶³çš„æƒ…å†µä¸‹è¯¥è¿›ç¨‹è¢«ç»ˆæ­¢çš„å¯èƒ½æ€§ã€‚**

**å¦‚æœå¯ç”¨äº¤æ¢ï¼Œå†…å­˜é¡µé¢å°†è¢«å¤åˆ¶åˆ°ç¡¬ç›˜ä¸Šåˆ†é…çš„*äº¤æ¢ç©ºé—´*ä¸­ï¼Œä»¥é‡Šæ”¾è¯¥é¡µé¢çš„å†…å­˜ã€‚æ£€æŸ¥**åœ†ç›˜**çš„æˆªé¢**

```
****df** - report file system disk space usage**
```

****df** æ˜¾ç¤ºåŒ…å«æ¯ä¸ªæ–‡ä»¶åå‚æ•°çš„æ–‡ä»¶ç³»ç»Ÿä¸Šçš„å¯ç”¨ç£ç›˜ç©ºé—´é‡ã€‚**

# **>>ç£ç›˜**

**äº¤æ¢ç©ºé—´çš„ä¸»è¦åŠŸèƒ½æ˜¯å½“å®é™… RAM å¡«æ»¡å¹¶ä¸”éœ€è¦æ›´å¤šç©ºé—´æ—¶ï¼Œç”¨ç£ç›˜ç©ºé—´ä»£æ›¿ RAM å†…å­˜ã€‚å†…æ ¸ä½¿ç”¨å†…å­˜ç®¡ç†ç¨‹åºæ¥æ£€æµ‹æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„å†…å­˜å—(æˆ–å†…å­˜é¡µ),å¹¶å°†è¿™äº›å†…å­˜é¡µäº¤æ¢åˆ°ç¡¬ç›˜ä¸Šçš„ç‰¹æ®Šåˆ†åŒºã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥ç›‘æ§ç£ç›˜ I/O ç»Ÿè®¡ä¿¡æ¯:**

```
****iostat** - report CPU statistics and I/O statistics for devices, partitions and NFS**
```

****iostat** å‘½ä»¤ç”¨äºç›‘æ§ç³»ç»Ÿ I/O è®¾å¤‡åŠ è½½ã€‚å®ƒé€šè¿‡è§‚å¯Ÿè®¾å¤‡ç›¸å¯¹äºå…¶å¹³å‡ä¼ è¾“æ—¶é—´çš„æ´»åŠ¨æ—¶é—´æ¥å®ç°è¿™ä¸€ç‚¹ã€‚ç±»ä¼¼äº **iostat** å‘½ä»¤ï¼Œ **vmstat** å‘½ä»¤æŠ¥å‘Šè™šæ‹Ÿå†…å­˜ç»Ÿè®¡æ•°æ®å’Œå…³äºç³»ç»Ÿäº‹ä»¶çš„ä¿¡æ¯ï¼Œä¾‹å¦‚ CPU è´Ÿè½½ã€åˆ†é¡µã€ç³»ç»Ÿè°ƒç”¨ç­‰ã€‚`vmstat -S`å¯ç”¨äºæ˜¾ç¤º*äº¤æ¢ç»Ÿè®¡ã€‚***

```
****iotop** - simple top-like I/O monitor**
```

****iotop** æ˜¯ä¸€ä¸ª Linux ä¸Šçš„äº¤äº’å¼ I/O ç›‘æ§å·¥å…·ï¼Œå°±åƒ **htop** ä¸€æ ·ï¼Œå¯ä»¥è½»æ¾ç›‘æ§ Linux ä¸Šæ¯ä¸ªè¿è¡Œè¿›ç¨‹çš„ç£ç›˜è¯»å†™å¸¦å®½ä½¿ç”¨æƒ…å†µã€‚å¯¹äºç³»ç»Ÿç®¡ç†æ¥è¯´ï¼Œå®ƒæ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œå¯ä»¥è·Ÿè¸ªå¯èƒ½å¯¼è‡´é«˜ç£ç›˜ I/O è¯»/å†™çš„ç‰¹å®šè¿›ç¨‹ã€‚å®ƒè¿˜æ˜¾ç¤ºçº¿ç¨‹æˆ–è¿›ç¨‹åœ¨æ¢å…¥å’Œç­‰å¾… I/O æ—¶èŠ±è´¹çš„æ—¶é—´ç™¾åˆ†æ¯”ã€‚**

**å…¶ä»–å‘½ä»¤åŒ…æ‹¬`iotop`ã€`atop`å’Œ`dstat`**

# **>>ç½‘ç»œ**

**å¯¹äºç½‘ç»œï¼Œæˆ‘ä»¬æœ€æ„Ÿå…´è¶£çš„æ˜¯ååé‡(æ¯ç§’è¯·æ±‚æ•°â€”å¸¦å®½)ã€‚æˆ‘ä»¬æƒ³è¦æ£€æŸ¥**é€Ÿç‡**(æ¯ç§’æ¯”ç‰¹æ•°çš„è¯»å†™å¸¦å®½)å’Œ**åˆ©ç”¨ç‡**(è¯»å†™å¸¦å®½é™¤ä»¥ç½‘ç»œçš„æœ€å¤§å¸¦å®½)ã€‚ä¸€äº›æœ‰ç”¨çš„ç½‘ç»œè°ƒè¯•å·¥å…·å¯ä»¥åº”å¯¹å»¶è¿Ÿé«˜å³°å’Œå¤±è´¥çš„è¯·æ±‚ï¼ŒåŒ…æ‹¬:**

```
****netstat** - prints network connections, routing tables, interface statistics, masquerade connections, and multicast memberships**
```

**netstat å‘Šè¯‰ä½ å“ªäº›è¿›ç¨‹æ­£åœ¨å“ªäº›ç«¯å£ä¸Šè¿è¡Œã€‚å®ƒæ˜¯ä¸€ä¸ªé‡è¦çš„ç½‘ç»œè¿æ¥ç›‘æ§å·¥å…·ï¼Œå¯ä»¥æ˜¾ç¤ºè¿›å‡ºè¿æ¥ã€è·¯ç”±è¡¨ã€ç«¯å£ç›‘å¬å’Œä½¿ç”¨ç»Ÿè®¡ï¼›æœ€è¿‘çš„ä¸€ä¸ªå‘½ä»¤æ˜¯`ss`ã€‚**

**![](img/7da5dff042c96b9b65b91e381d87bf34.png)**

```
****tcpdump** - dump traffic on a network**
```

**tcpdump æ˜¯ä¸€ä¸ªæ•°æ®ç½‘ç»œåŒ…åˆ†æå™¨ã€‚å®ƒå…è®¸ç”¨æˆ·æ˜¾ç¤ºé€šè¿‡ç½‘ç»œä¼ è¾“æˆ–æ¥æ”¶çš„ TCP/IP å’Œå…¶ä»–æ•°æ®åŒ…ã€‚å®ƒå¯ç”¨äºæ’é™¤ç½‘ç»œæ•…éšœï¼Œä¹Ÿå¯ç”¨ä½œå®‰å…¨å·¥å…·ã€‚è¦æ‰“å°å‡ºè¦æŸ¥çœ‹çš„æ•°æ®åŒ…ï¼Œè¯·ä½¿ç”¨`tcpdump -A`ã€‚**

```
****netcat** - arbitary TCP and UDP connections and listens** 
```

**ä½¿ç”¨ **nectatï¼Œ**ä½ å¯ä»¥æ‰“å¼€ TCP è¿æ¥ï¼Œå‘é€ UDP æ•°æ®åŒ…ï¼Œç›‘å¬ä»»æ„ UDP å’Œ TCP ç«¯å£ï¼Œç«¯å£æ‰«æç­‰ç­‰ã€‚å®ƒå……å½“åç«¯å·¥å…·ï¼Œå…è®¸ç«¯å£æ‰«æå’Œç«¯å£ç›‘å¬ï¼Œæ­¤å¤–è¿˜å…è®¸æ–‡ä»¶ä¼ è¾“ã€‚**

## **èµ„æº:**

*   **[https://jvns.ca/debugging-zine.pdf](https://jvns.ca/debugging-zine.pdf)**
*   **[https://medium . com/@ Steve . mus hero/linuxs-sre-golden-signals-af 5a a26 ebae](https://medium.com/@steve.mushero/linuxs-sre-golden-signals-af5aaa26ebae)**
*   **[https://landing . Google . com/sre/sre-book/chapters/effective-trouble shooting/](https://landing.google.com/sre/sre-book/chapters/effective-troubleshooting/)**
*   **[https://www . euro VPS . com/blog/important-Linux-log-files-you-must-be-monitoring/](https://www.eurovps.com/blog/important-linux-log-files-you-must-be-monitoring/)**

**æ•…éšœæ’é™¤æ°¸è¿œä¸ä¼šåƒæˆ‘ä»¬ç†æƒ³åŒ–çš„æ¨¡å‹é‚£æ ·æ¸…æ™°ï¼Œå¹¶ä¸”åƒä»»ä½•å…¶ä»–æŠ€èƒ½ä¸€æ ·éœ€è¦å®è·µã€‚å¯¹äºé‡åˆ°ç³»ç»Ÿé—®é¢˜çš„äººå’Œè§£å†³é—®é¢˜çš„äººæ¥è¯´ï¼Œè¿™äº›æ­¥éª¤å¯ä»¥ä½¿æ•…éšœè¯Šæ–­è¿‡ç¨‹ä¸é‚£ä¹ˆç—›è‹¦ï¼Œå¹¶ä¸”æ›´æœ‰æ•ˆç‡ã€‚é‡‡ç”¨ç³»ç»Ÿçš„æ•…éšœæ’é™¤æ–¹æ³•æœ‰åŠ©äºå‡å°‘å½±å“æ—¶é—´å’Œé™åˆ¶æœåŠ¡æ¢å¤æ—¶é—´ï¼Œå¹¶ä¸ºç”¨æˆ·å¸¦æ¥æ›´å¥½çš„ä½“éªŒã€‚**

**ç©å¾—å¼€å¿ƒï¼Œæ°¸è¿œä¸è¦å¿˜è®°æ£€æŸ¥æ—¥å¿—ï¼ğŸ“**