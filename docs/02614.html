<html>
<head>
<title>ReactJS — Simple Understanding Redux With Redux-Saga</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">react js——用 Redux-Saga 简单理解 Redux</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/reactjs-simple-understanding-redux-with-redux-saga-f635e273e24a?source=collection_archive---------0-----------------------#2020-08-16">https://blog.devgenius.io/reactjs-simple-understanding-redux-with-redux-saga-f635e273e24a?source=collection_archive---------0-----------------------#2020-08-16</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="5b3c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Redux 没有你想的那么复杂！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/41266e158ff8c22275ef2f0967dd453e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bg7G80YGJ1LUY9H4tgqt6A.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">ReactJS —简单理解 Redux 和 Redux-Saga</figcaption></figure><p id="079a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">再次回到 ReactJS。尽管如此，在自由式语言中，JavaScript！</p><p id="ce23" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">又来了，我们回来讨论<strong class="jm io">状态管理，</strong>现在我们使用 Redux！我将用这个 React &amp; Redux-Saga 制作一个简单的应用程序，这样你就可以完全理解发生了什么。</p><p id="45b2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你不知道<strong class="jm io">状态管理</strong>是什么，我建议你先看看我的文章，它讨论了使用带有 React 的上下文 API 的基本状态管理。</p><div class="ky kz gp gr la lb"><a href="https://medium.com/dev-genius/reactjs-manage-your-state-nicely-with-context-1ed3090a6a46" rel="noopener follow" target="_blank"><div class="lc ab fo"><div class="ld ab le cl cj lf"><h2 class="bd io gy z fp lg fr fs lh fu fw im bi translated">ReactJS——利用上下文很好地管理您的状态</h2><div class="li l"><h3 class="bd b gy z fp lg fr fs lh fu fw dk translated">用一种反应的方式表达你的状态</h3></div><div class="lj l"><p class="bd b dl z fp lg fr fs lh fu fw dk translated">medium.com</p></div></div><div class="lk l"><div class="ll l lm ln lo lk lp ks lb"/></div></div></a></div><p id="0631" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">那我们就直接进入主题吧…</p></div><div class="ab cl lq lr hr ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ig ih ii ij ik"><h1 id="b4a3" class="lx ly in bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">遵循这篇文章的要求</h1><ol class=""><li id="1aae" class="mv mw in jm b jn mx jr my jv mz jz na kd nb kh nc nd ne nf bi translated">非常基础的 JavaScript(ES6)。</li><li id="1e1e" class="mv mw in jm b jn ng jr nh jv ni jz nj kd nk kh nc nd ne nf bi translated">非常基本的反应。</li></ol><h1 id="a656" class="lx ly in bd lz ma nl mc md me nm mg mh mi nn mk ml mm no mo mp mq np ms mt mu bi translated">跟随这篇文章的必备工具</h1><h2 id="ffa6" class="nq ly in bd lz nr ns dn md nt nu dp mh jv nv nw ml jz nx ny mp kd nz oa mt ob bi translated">1.NodeJS</h2><p id="0c1d" class="pw-post-body-paragraph jk jl in jm b jn mx jp jq jr my jt ju jv oc jx jy jz od kb kc kd oe kf kg kh ig bi translated">重要的是 NodeJS 本身，因为 NodeJS 带有<strong class="jm io"> NPM </strong>，在这种情况下，我们将使用它来安装 ReactJS。你可以在这里下载(<a class="ae of" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank">https://nodejs.org/en</a>)。我推荐安装<strong class="jm io"> LTS </strong>版本，我写这篇文章的时候用的是 v 12 . 2 . 0<em class="og">。</em></p><h2 id="e8c0" class="nq ly in bd lz nr ns dn md nt nu dp mh jv nv nw ml jz nx ny mp kd nz oa mt ob bi translated">2.文字编辑器</h2><p id="f3cb" class="pw-post-body-paragraph jk jl in jm b jn mx jp jq jr my jt ju jv oc jx jy jz od kb kc kd oe kf kg kh ig bi translated">有很多文本编辑器，在这篇文章中我更喜欢使用<strong class="jm io"> Sublime Text 3 </strong>，因为它平滑而轻便，你可以在这里下载(<a class="ae of" href="https://www.sublimetext.com/" rel="noopener ugc nofollow" target="_blank">https://www.sublimetext.com/</a>)。<br/>如果你想使用文本编辑器，比如<strong class="jm io"> VScode </strong>或<strong class="jm io"> Atom，</strong>只要选择适合你的工具就可以了。</p><h2 id="45c0" class="nq ly in bd lz nr ns dn md nt nu dp mh jv nv nw ml jz nx ny mp kd nz oa mt ob bi translated">3.Redux 开发工具扩展</h2><p id="7558" class="pw-post-body-paragraph jk jl in jm b jn mx jp jq jr my jt ju jv oc jx jy jz od kb kc kd oe kf kg kh ig bi translated">这是可选的，Redux Devtools 扩展是为了帮助开发人员使用 Redux，这个 Redux Devtools 扩展使开发人员可以跟踪应用程序中正在发生的事情，例如从服务器获取数据等等。这是一个来自浏览器的扩展，如果你使用 chrome，你可以在这里下载这个(<a class="ae of" href="https://chrome.google.com/webstore/detail/redux-devtools/lmhkpmbekcpmknklioeibfkpmmfibljd?hl=en" rel="noopener ugc nofollow" target="_blank">https://chrome . Google . com/web store/detail/redux-devtools/lmhkpmbekcpmmknlioeibfkpmmfibljd？hl=en </a>)。</p></div><div class="ab cl lq lr hr ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ig ih ii ij ik"><h1 id="44cb" class="lx ly in bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">Redux 是什么？</h1><p id="1fa0" class="pw-post-body-paragraph jk jl in jm b jn mx jp jq jr my jt ju jv oc jx jy jz od kb kc kd oe kf kg kh ig bi translated">根据文档，Redux 是…</p><blockquote class="oh"><p id="52e9" class="oi oj in bd ok ol om on oo op oq kh dk translated">Redux 是 JavaScript 应用程序的可预测状态容器。</p><p id="00c3" class="oi oj in bd ok ol om on oo op oq kh dk translated">它帮助您编写行为一致、在不同环境(客户机、服务器和本机)中运行、易于测试的应用程序。</p></blockquote><p id="69bb" class="pw-post-body-paragraph jk jl in jm b jn or jp jq jr os jt ju jv ot jx jy jz ou kb kc kd ov kf kg kh ig bi translated">一个非常简单的解释，它是你的状态的容器。例如，您有一个 todo 状态，然后在 redux 中控制您的 todo 状态。因为 redux 用于状态管理，包含了所有与组件或用户交互的状态。不要困惑，如果你跟着这篇文章走，你会明白的。</p><p id="e01e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">您可以在 Redux 文档中阅读更多内容:</p><div class="ky kz gp gr la lb"><a href="https://redux.js.org/introduction/getting-started" rel="noopener  ugc nofollow" target="_blank"><div class="lc ab fo"><div class="ld ab le cl cj lf"><h2 class="bd io gy z fp lg fr fs lh fu fw im bi translated">Redux | Redux 入门</h2><div class="li l"><h3 class="bd b gy z fp lg fr fs lh fu fw dk translated">Redux 是 JavaScript 应用程序的可预测状态容器。它帮助您编写行为一致的应用程序…</h3></div><div class="lj l"><p class="bd b dl z fp lg fr fs lh fu fw dk translated">redux.js.org</p></div></div><div class="lk l"><div class="ow l lm ln lo lk lp ks lb"/></div></div></a></div><h1 id="8234" class="lx ly in bd lz ma nl mc md me nm mg mh mi nn mk ml mm no mo mp mq np ms mt mu bi translated">那么什么是 Redux-Saga 呢？</h1><p id="313f" class="pw-post-body-paragraph jk jl in jm b jn mx jp jq jr my jt ju jv oc jx jy jz od kb kc kd oe kf kg kh ig bi translated">根据 Redux-Saga 的文档…</p><blockquote class="oh"><p id="60a2" class="oi oj in bd ok ol om on oo op oq kh dk translated">Redux-Saga 是一个库，旨在使应用程序副作用(即异步的事情，如数据获取和不纯的事情，如访问浏览器缓存)更容易管理，更有效地执行，易于测试，并更好地处理故障。</p></blockquote><p id="7266" class="pw-post-body-paragraph jk jl in jm b jn or jp jq jr os jt ju jv ot jx jy jz ou kb kc kd ov kf kg kh ig bi translated">Redux-Saga 基本上是你的 Redux 的中间件。为什么我需要一个 Redux 的中间件？</p><p id="87e2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">答案</strong>。使用简单的基本 Redux，您只能通过分派一个动作来进行简单的同步更新。<strong class="jm io">中间件扩展了商店的功能，让你可以编写与商店交互的异步逻辑</strong>。—根据 Redux-Thunk docs(Redux 拥有的另一个中间件)。</p><p id="5dbb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你可以在这里的文档中阅读更多的 Redux-Saga，它非常吸引人。</p><div class="ky kz gp gr la lb"><a href="https://redux-saga.js.org/" rel="noopener  ugc nofollow" target="_blank"><div class="lc ab fo"><div class="ld ab le cl cj lf"><h2 class="bd io gy z fp lg fr fs lh fu fw im bi translated">读我</h2><div class="li l"><h3 class="bd b gy z fp lg fr fs lh fu fw dk translated">redux-saga 是一个旨在使应用程序副作用(即异步的东西，如数据获取和…</h3></div><div class="lj l"><p class="bd b dl z fp lg fr fs lh fu fw dk translated">redux-saga.js.org</p></div></div></div></a></div><h1 id="13ff" class="lx ly in bd lz ma nl mc md me nm mg mh mi nn mk ml mm no mo mp mq np ms mt mu bi translated">为什么一定要 Redux-Saga？</h1><p id="a7f7" class="pw-post-body-paragraph jk jl in jm b jn mx jp jq jr my jt ju jv oc jx jy jz od kb kc kd oe kf kg kh ig bi translated">基本上，Redux-Saga 比<a class="ae of" href="https://github.com/reduxjs/redux-thunk" rel="noopener ugc nofollow" target="_blank"> Redux-Thunk </a>更强大。为什么？根据文档，以下是解释…</p><ol class=""><li id="0afc" class="mv mw in jm b jn jo jr js jv ox jz oy kd oz kh nc nd ne nf bi translated">它使用一个名为 Generators 的 ES6 特性来使那些<strong class="jm io">异步流易于读取、写入和测试</strong>。<em class="og">(如果你不熟悉它们</em> <a class="ae of" href="https://redux-saga.js.org/docs/ExternalResources.html" rel="noopener ugc nofollow" target="_blank"> <em class="og">这里有一些介绍性链接</em> </a> <em class="og"> ) </em>通过这样做，这些异步流看起来就像你的标准同步 JavaScript 代码。(有点像<code class="fe pa pb pc pd b">async</code> / <code class="fe pa pb pc pd b">await</code>，但是生成器有一些我们需要的更棒的特性)</li><li id="6e04" class="mv mw in jm b jn ng jr nh jv ni jz nj kd nk kh nc nd ne nf bi translated">您可能以前使用过<code class="fe pa pb pc pd b">redux-thunk</code>来处理您的数据获取。与 redux-thunk 相反，您不会陷入回调地狱，您可以轻松地测试您的异步流，并且您的操作保持纯净。</li></ol><h1 id="645d" class="lx ly in bd lz ma nl mc md me nm mg mh mi nn mk ml mm no mo mp mq np ms mt mu bi translated">该不该用 Redux？</h1><p id="672e" class="pw-post-body-paragraph jk jl in jm b jn mx jp jq jr my jt ju jv oc jx jy jz od kb kc kd oe kf kg kh ig bi translated">正确答案是，视情况而定。因为你不能强迫你的应用程序在你开始一个项目的时候都使用 redux，你必须调查你的情况，你的应用程序是否使用 Redux。或者你的应用程序需要你所在州的一个真实的来源，那么就使用 Redux。</p></div><div class="ab cl lq lr hr ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ig ih ii ij ik"><h1 id="a24e" class="lx ly in bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">用 Redux 和 Redux-Saga 制作 App</h1><p id="ca09" class="pw-post-body-paragraph jk jl in jm b jn mx jp jq jr my jt ju jv oc jx jy jz od kb kc kd oe kf kg kh ig bi translated">我们要开发什么样的应用程序？为了简化这篇文章，我要做一个 Todo 应用程序，你可以很容易理解，我使用了一个用于 API 的<a class="ae of" href="https://jsonplaceholder.typicode.com/todos" rel="noopener ugc nofollow" target="_blank"> JSONPlaceholder </a>，这对练习很有好处。下面是用 Redux-Saga 实现 Redux 的简单步骤。我们开始吧。</p><p id="e8f4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我假设你已经安装了 NodeJS，因为我们稍后会处理 NPM。</p><h2 id="d836" class="nq ly in bd lz nr ns dn md nt nu dp mh jv nv nw ml jz nx ny mp kd nz oa mt ob bi translated">1.安装 ReactJS(如果已经安装了 ReactJS，请跳过这一步)</h2><p id="1830" class="pw-post-body-paragraph jk jl in jm b jn mx jp jq jr my jt ju jv oc jx jy jz od kb kc kd oe kf kg kh ig bi translated">我们将在全球范围内安装 ReactJS，为此，请打开您的终端/ CMD 并开始键入以下命令。</p><pre class="kj kk kl km gt pe pd pf pg aw ph bi"><span id="0cda" class="nq ly in pd b gy pi pj l pk pl">npm i -g create-react-app</span></pre><h2 id="f670" class="nq ly in bd lz nr ns dn md nt nu dp mh jv nv nw ml jz nx ny mp kd nz oa mt ob bi translated">2.创建 React 项目</h2><p id="8ad4" class="pw-post-body-paragraph jk jl in jm b jn mx jp jq jr my jt ju jv oc jx jy jz od kb kc kd oe kf kg kh ig bi translated">成功安装 ReactJS 后，你将开始一个项目。为此，请键入以下命令。对于这个项目，我将把它叫做<strong class="jm io">反应-状态-管理</strong>，你可以随便叫它什么。</p><pre class="kj kk kl km gt pe pd pf pg aw ph bi"><span id="9fe7" class="nq ly in pd b gy pi pj l pk pl">npx create-react-app react-state-management</span></pre><h2 id="2492" class="nq ly in bd lz nr ns dn md nt nu dp mh jv nv nw ml jz nx ny mp kd nz oa mt ob bi translated">3.为 React 项目安装依赖项</h2><p id="de87" class="pw-post-body-paragraph jk jl in jm b jn mx jp jq jr my jt ju jv oc jx jy jz od kb kc kd oe kf kg kh ig bi translated">创建 React 项目后，您可以进入该项目或在文本编辑器中打开它，并使用该命令开始安装一些依赖项。</p><p id="6c00" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这些依赖项包含我们将用于状态管理的 redux。</p><pre class="kj kk kl km gt pe pd pf pg aw ph bi"><span id="bcd4" class="nq ly in pd b gy pi pj l pk pl">npm i -S redux react-redux redux-devtools-extension redux-saga axios</span></pre><p id="ae43" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我要重复上面发生的事情。</p><ul class=""><li id="c894" class="mv mw in jm b jn jo jr js jv ox jz oy kd oz kh pm nd ne nf bi translated"><strong class="jm io"> redux </strong>，本质上就是 redux 本身。</li><li id="73ee" class="mv mw in jm b jn ng jr nh jv ni jz nj kd nk kh pm nd ne nf bi translated">react-redux ，我们要用它来连接 react 和 redux。</li><li id="a891" class="mv mw in jm b jn ng jr nh jv ni jz nj kd nk kh pm nd ne nf bi translated">redux-devtools-extension ，它只是一个软件包，用于将我们的 React-redux 应用程序集成到我们为调试 Redux 而安装的扩展中。</li><li id="0196" class="mv mw in jm b jn ng jr nh jv ni jz nj kd nk kh pm nd ne nf bi translated">当然，这是我们将要使用的 redux-saga 中间件的一个包。</li><li id="fbeb" class="mv mw in jm b jn ng jr nh jv ni jz nj kd nk kh pm nd ne nf bi translated"><strong class="jm io"> axios，</strong>只是一个简单的 HTTP 客户端与服务器交互。</li></ul><h2 id="4f6b" class="nq ly in bd lz nr ns dn md nt nu dp mh jv nv nw ml jz nx ny mp kd nz oa mt ob bi translated">4.为我们的应用程序创建文件夹结构</h2><p id="5bf5" class="pw-post-body-paragraph jk jl in jm b jn mx jp jq jr my jt ju jv oc jx jy jz od kb kc kd oe kf kg kh ig bi translated">因此，在这一步中，我们将创建一个文件夹结构，我们将在其中放置文件，并使其便于开发使用。</p><p id="889f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">所以文件应该是这样的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pn"><img src="../Images/e94dcc912a97e24efbfa4c0de1f0d545.png" data-original-src="https://miro.medium.com/v2/resize:fit:476/format:webp/1*F6ubIoNFhocN3dN-OrnJYA.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">文件夹结构</figcaption></figure><p id="baf5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">与 redux 相关的所有内容都将被放在<strong class="jm io"> redux </strong>文件夹中。</p><p id="3651" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你不喜欢看这个图片，看看这个文件夹的结构，但是它还是一样的。</p><pre class="kj kk kl km gt pe pd pf pg aw ph bi"><span id="645a" class="nq ly in pd b gy pi pj l pk pl">src/<br/>  components/<br/>    TodoForm.js<br/>    Todo.js<br/>    TodoItem.js<br/>  redux/<br/>    actions/<br/>      todo-action.js<br/>    api/<br/>      todo-api.js<br/>    reducers/<br/>      index.js<br/>      todo-reducer.js<br/>    sagas/<br/>      index.js<br/>    store.js</span></pre><h2 id="5463" class="nq ly in bd lz nr ns dn md nt nu dp mh jv nv nw ml jz nx ny mp kd nz oa mt ob bi translated">5.为 Redux 制作 store.js</h2><p id="4006" class="pw-post-body-paragraph jk jl in jm b jn mx jp jq jr my jt ju jv oc jx jy jz od kb kc kd oe kf kg kh ig bi translated">我们要做的第一件事是准备我们的 Redux。因此，我将在<strong class="jm io"> src </strong>文件夹中创建一个文件夹，并将其命名为<strong class="jm io"> redux </strong>。在里面，我们将创建一个名为<strong class="jm io"> store.js </strong>的文件。这个文件将用于我们的应用程序连接到 Redux。这是代码。代码非常简单明了。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="po pp l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Redux store.js</figcaption></figure><p id="31b0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">但是，不要运行那个代码，它还没有完成，我们必须创建另一个文件来使<strong class="jm io"> store.js </strong>工作。</p><h2 id="7cef" class="nq ly in bd lz nr ns dn md nt nu dp mh jv nv nw ml jz nx ny mp kd nz oa mt ob bi translated">6.采取行动</h2><p id="ed72" class="pw-post-body-paragraph jk jl in jm b jn mx jp jq jr my jt ju jv oc jx jy jz od kb kc kd oe kf kg kh ig bi translated">什么是行动？在这种情况下，action 将用常量填充，这些常量定义了我们的应用程序要做什么。例如，向服务器发出请求。代码类似于<code class="fe pa pb pc pd b">const GET_TODOS = GET_TODOS</code>。</p><p id="8879" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">就这样？是啊。这很有帮助，因为当我们向 reducer 发出请求时，这将减少应用程序中的拼写错误。因此，在我们刚刚创建的<strong class="jm io"> redux </strong>文件夹中，我将创建一个名为<strong class="jm io"> actions </strong>的文件夹，在<strong class="jm io"> actions </strong>文件夹中，我将创建一个名为<strong class="jm io"> todo-action.js </strong>的文件。这是代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="po pp l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">待办事项操作</figcaption></figure><h2 id="1e92" class="nq ly in bd lz nr ns dn md nt nu dp mh jv nv nw ml jz nx ny mp kd nz oa mt ob bi translated">7.制造减速器</h2><p id="4354" class="pw-post-body-paragraph jk jl in jm b jn mx jp jq jr my jt ju jv oc jx jy jz od kb kc kd oe kf kg kh ig bi translated">那么，reducer 是什么？在我们的应用中，ReactJS 中的 Reducer 是确定状态变化的手段。如果你想改变状态，在这里控制你所有的状态。在 redux 中，您的状态在这里定义。</p><p id="4538" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这里，我也想导入<strong class="jm io">动作</strong>，因为我们将处理一个分派这个减速器的函数。</p><p id="3aa1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因此，仍然在<strong class="jm io"> redux </strong>文件夹中，我将创建一个名为<strong class="jm io"> reducers </strong>的新文件夹，在<strong class="jm io"> reducers </strong>文件夹中，我将创建一个名为<strong class="jm io"> todo-reducer.js 的文件。</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="po pp l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Todo 缩减器</figcaption></figure><p id="781f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你看到上面的代码，你会看到，缩减器是用来把状态转换成新值的，对吗？代码在那里是不言自明的。</p><h2 id="980d" class="nq ly in bd lz nr ns dn md nt nu dp mh jv nv nw ml jz nx ny mp kd nz oa mt ob bi translated">8.注册减速器</h2><p id="ee0c" class="pw-post-body-paragraph jk jl in jm b jn mx jp jq jr my jt ju jv oc jx jy jz od kb kc kd oe kf kg kh ig bi translated">在这一步中，我们将注册刚刚在上面创建的减速器。代码非常简单。这里，还是在<strong class="jm io"> reducers </strong>文件夹里，我要做一个名为<strong class="jm io"> index.js </strong>的文件，这个文件也叫<strong class="jm io"> rootReducer </strong>，我们在<strong class="jm io"> store.js </strong>里用过。这是代码，代码解释得很清楚。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="po pp l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">根部减速器</figcaption></figure><h2 id="d649" class="nq ly in bd lz nr ns dn md nt nu dp mh jv nv nw ml jz nx ny mp kd nz oa mt ob bi translated">9.制作 API</h2><p id="074d" class="pw-post-body-paragraph jk jl in jm b jn mx jp jq jr my jt ju jv oc jx jy jz od kb kc kd oe kf kg kh ig bi translated">在这里，我们将请求与服务器交互。</p><p id="735a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我将在<strong class="jm io"> src </strong>文件夹中创建一个名为<strong class="jm io"> api </strong>的文件夹(小写)。<strong class="jm io"> </strong>在<strong class="jm io"> api </strong>文件夹中，我将创建一个名为<strong class="jm io"> todo-api.js </strong>的文件。这个文件包含向服务器发出请求的函数。这是代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="po pp l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">待办事项 API</figcaption></figure><p id="62dc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这只是一个简单的向服务器发出请求的函数。</p><h2 id="a825" class="nq ly in bd lz nr ns dn md nt nu dp mh jv nv nw ml jz nx ny mp kd nz oa mt ob bi translated"><strong class="ak"> 10。制作传奇</strong></h2><p id="51e3" class="pw-post-body-paragraph jk jl in jm b jn mx jp jq jr my jt ju jv oc jx jy jz od kb kc kd oe kf kg kh ig bi translated">我们刚刚在那里创建的所有代码和文件的核心将在这一步中正确运行。我将在<strong class="jm io"> src </strong>文件夹中创建一个文件夹，我将它命名为<strong class="jm io"> sagas </strong>。在这个<strong class="jm io"> sagas </strong>文件夹中，我将创建一个名为<strong class="jm io"> todo-saga.js </strong>的文件。在这个<strong class="jm io">中，todo-saga.js </strong>将包含我们的<strong class="jm io">动作，以及将要分派一个<strong class="jm io">缩减器</strong>的 api </strong>。这是代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="po pp l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">托多传奇</figcaption></figure><p id="0b78" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我觉得你搞混了，“那里到底发生了什么事”<strong class="jm io"/>？我要重复上面发生的事情。</p><ol class=""><li id="c6d6" class="mv mw in jm b jn jo jr js jv ox jz oy kd oz kh nc nd ne nf bi translated">Redux-Saga 使用来自 ES6 的<strong class="jm io">生成器</strong>，基本上和<code class="fe pa pb pc pd b">async/await</code>一样但是它使用<strong class="jm io"> yield </strong>作为关键字，<em class="og">里面所有包裹</em> <strong class="jm io"> <em class="og">生成器</em> </strong> <em class="og">必须调用使用</em><strong class="jm io"><em class="og">yield</em></strong><em class="og">。</em>如果你想了解更多关于发电机的知识，可以访问这个<a class="ae of" href="https://redux-saga.js.org/docs/ExternalResources.html" rel="noopener ugc nofollow" target="_blank">链接</a>。</li><li id="a298" class="mv mw in jm b jn ng jr nh jv ni jz nj kd nk kh nc nd ne nf bi translated"><strong class="jm io">放</strong>，是为了从佐贺调度减速器，<strong class="jm io">放</strong>是它里面的接受对象，在我们的例子中，我们使用<strong class="jm io">型</strong>和<strong class="jm io">有效载荷</strong>作为对象。</li><li id="7bc7" class="mv mw in jm b jn ng jr nh jv ni jz nj kd nk kh nc nd ne nf bi translated"><strong class="jm io">调用</strong>，用于调用一个函数，在本例中，我们调用一个与服务器交互的函数。<strong class="jm io">调用</strong>在第一个参数中接受一个函数，第二个参数是免费的，在本例中，用于将有效载荷传递给函数。</li><li id="e289" class="mv mw in jm b jn ng jr nh jv ni jz nj kd nk kh nc nd ne nf bi translated"><strong class="jm io"> takeLatest </strong>，用于触发异步请求。但是，如果<strong class="jm io">采用最新的</strong>触发，任何之前运行的异步任务都将被取消。这对我们的情况很好，在这种情况下，我们不希望在用户已经发出请求的情况下，每次用户发出请求时都启动 create todo。</li><li id="7a08" class="mv mw in jm b jn ng jr nh jv ni jz nj kd nk kh nc nd ne nf bi translated"><strong class="jm io"> takeEvery </strong>，<strong class="jm io"> </strong>也用于<strong class="jm io"> </strong>触发一个异步请求，但是，如果有一个异步任务在后台运行，它不会被取消，否则，它将同时异步运行。任何使用<strong class="jm io"> takeEvery、</strong>的生成器都将被称为<strong class="jm io"> watchers </strong>。</li><li id="369b" class="mv mw in jm b jn ng jr nh jv ni jz nj kd nk kh nc nd ne nf bi translated">注意，你看我一直在做一个叫<strong class="jm io">的后缀请求</strong>？你可以看到我分派了不同的动作？这是因为如果你调度相同的动作，你将得到一个无限循环！</li></ol><p id="be9d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">之后，仍然在<strong class="jm io"> sagas </strong>文件夹中，我要做一个名为<strong class="jm io"> index.js </strong>的文件，也就是我们在<strong class="jm io"> store.js </strong>中导入的<strong class="jm io"> rootSaga </strong>。这是代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="po pp l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">根传奇</figcaption></figure><p id="091e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我要再次重复上面发生的事情。</p><p id="9321" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">本质上，上面的代码是正确的。但是如果你有更多的传奇，你必须让一个新的后代成为一个新的传奇，类似于，<code class="fe pa pb pc pd b">spawn(anotherSaga)</code></p><p id="950c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">那么，什么产卵呢？spawn 用于为传奇故事创建一个新的孩子。如果你使用这个 spawn，每次出现错误等请求时，父进程不会被取消，它将继续运行，错误本身将被独立处理。</p><p id="d7ee" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我希望，我在里面说的有意义。如果你想挖掘更多，你可以访问关于这个<strong class="jm io"> redux-saga </strong>的 API 参考。链接如下:</p><p id="a637" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae of" href="https://redux-saga.js.org/docs/api/" rel="noopener ugc nofollow" target="_blank">https://redux-saga.js.org/docs/api/</a></p><h2 id="074f" class="nq ly in bd lz nr ns dn md nt nu dp mh jv nv nw ml jz nx ny mp kd nz oa mt ob bi translated">11.让我们的应用发挥作用</h2><p id="fae3" class="pw-post-body-paragraph jk jl in jm b jn mx jp jq jr my jt ju jv oc jx jy jz od kb kc kd oe kf kg kh ig bi translated">好了，<strong class="jm io">这里介绍一下本文的主要内容</strong>。在这一步，我们将使这个应用程序和 Redux 准备使用。</p><p id="654e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> 11.1。创建 Todo 组件。</strong></p><p id="e7b3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我将在<strong class="jm io"> src </strong>文件夹中创建一个名为<strong class="jm io">组件</strong>的文件夹。在里面，我将为组件创建一个名为<strong class="jm io"> Todo.js </strong>的文件，下面是代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="po pp l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">待办事项组件</figcaption></figure><p id="d66a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">代码非常简单，它解释了如何与 redux 交互。本质上，当您想要将组件连接到 Redux 时，您必须:</p><ul class=""><li id="ce57" class="mv mw in jm b jn jo jr js jv ox jz oy kd oz kh pm nd ne nf bi translated">将<strong class="jm io">连接到 react-redux 的</strong>上。</li><li id="290c" class="mv mw in jm b jn ng jr nh jv ni jz nj kd nk kh pm nd ne nf bi translated">获取<strong class="jm io">动作</strong>将 saga 发送到减速器。(记得导入请求的<strong class="jm io"/>)因为我们要在<code class="fe pa pb pc pd b">export default function* todoSaga()</code>内部调度，而不是像<code class="fe pa pb pc pd b">getAllTodos</code>那样的函数</li><li id="3c2e" class="mv mw in jm b jn ng jr nh jv ni jz nj kd nk kh pm nd ne nf bi translated"><strong class="jm io">mapStateToProps</strong>&amp;<strong class="jm io">mapdispatctoprops</strong>用于获取<strong class="jm io">状态</strong>和<strong class="jm io">调度</strong>，你要将这些变量传递给<strong class="jm io">连接</strong>函数，第一个参数是针对<strong class="jm io">状态</strong>，第二个参数是针对<strong class="jm io">调度</strong>。这个来自<strong class="jm io"> mapDispatchToProps </strong>的<strong class="jm io"> dispatch </strong>函数与来自 saga 的<strong class="jm io"> put </strong>相同，它是接受对象，在这种情况下，我们使用<strong class="jm io"> type </strong>和<strong class="jm io"> payload </strong>作为对象。</li></ul><p id="b3f1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> 11.2。创建 TodoForm 组件。</strong></p><p id="e34e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">尽管如此，在<strong class="jm io">组件</strong>文件夹中，我将创建一个名为<strong class="jm io"> TodoForm.js </strong>的文件。这是代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="po pp l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">待办事项表单</figcaption></figure><p id="46aa" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">代码与<strong class="jm io"> Todo.js </strong>相同，但功能不同。</p><p id="c88d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">11.3。创建 TodoItem 组件。</p><p id="39df" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">尽管如此，在<strong class="jm io">组件</strong>文件夹中，我将创建一个名为<strong class="jm io"> TodoItem.js </strong>的文件。这是代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="po pp l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">待办事项</figcaption></figure><p id="6c5c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">请注意，我正在使用<strong class="jm io">双击</strong>删除待办事项。</p><p id="2eab" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> 11.3。更新 App.js </strong></p><p id="c8d3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了让这个应用程序工作，你只需将你的<strong class="jm io"> App.js </strong>文件更新到这个。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="po pp l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">应用</figcaption></figure><p id="032d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">本质上，您只需要使用这个将<strong class="jm io"> store.js </strong>传递给提供者</p><pre class="kj kk kl km gt pe pd pf pg aw ph bi"><span id="0f0c" class="nq ly in pd b gy pi pj l pk pl">&lt;Provider store={store}&gt;<br/>  // Your app in here...<br/>&lt;/Provider&gt;</span></pre><p id="34a1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">就是这样！终于可以运行这个 app 了！要运行此应用程序，请编写以下命令</p><pre class="kj kk kl km gt pe pd pf pg aw ph bi"><span id="b4b7" class="nq ly in pd b gy pi pj l pk pl">npm start </span></pre><p id="5785" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这是应用程序的结果，我正在使用 chrome 打开 redux 开发工具。如你所见，redux 开发工具正在跟踪我在那里做什么。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pq"><img src="../Images/4c6d07b9eb112eedda4a4db7be6e654e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*WsHu8qa3pGQHmC5VFBdq3w.gif"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">应用程序的结果</figcaption></figure><p id="cea8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我知道这看起来很丑，但我们在这里关注的是<strong class="jm io">还原</strong>和<strong class="jm io">还原-传奇</strong>。你完全可以打造自己的风格。我这样做的原因很简单。</p></div><div class="ab cl lq lr hr ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ig ih ii ij ik"><h1 id="796f" class="lx ly in bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">结论</h1><p id="b586" class="pw-post-body-paragraph jk jl in jm b jn mx jp jq jr my jt ju jv oc jx jy jz od kb kc kd oe kf kg kh ig bi translated">当你的应用程序需要一个单一的真实来源时，使用 Redux 对一个大的可扩展的应用程序是很好的。之所以使用<strong class="jm io"> Redux </strong>是因为它易于维护，让你的代码更加结构化，让你的 React 应用更加健壮。我之前提到过一个叫做 redux-thunk 的中间件，也许你也想试试？但是，上次我在用<strong class="jm io"> redux-thunk </strong>的时候，代码乱糟糟的，不知道哈哈。</p><p id="94a5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我希望你明白在那里发生了什么，如果你仍然困惑，请留下讨论，如果你喜欢就鼓掌。</p><p id="880b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">谢谢，下一篇文章再见！</p><p id="51a8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">下面是本文的代码。</p><div class="ky kz gp gr la lb"><a href="https://github.com/hudaprs/react_state_management_saga" rel="noopener  ugc nofollow" target="_blank"><div class="lc ab fo"><div class="ld ab le cl cj lf"><h2 class="bd io gy z fp lg fr fs lh fu fw im bi translated">hudaprs/react _ state _ management _ saga</h2><div class="li l"><h3 class="bd b gy z fp lg fr fs lh fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="lj l"><p class="bd b dl z fp lg fr fs lh fu fw dk translated">github.com</p></div></div><div class="lk l"><div class="pr l lm ln lo lk lp ks lb"/></div></div></a></div></div></div>    
</body>
</html>