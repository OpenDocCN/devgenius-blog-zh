<html>
<head>
<title>DA Portfolio Project- ETL/Database Design/ MySQL (Part II)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">DA 组合项目-ETL/数据库设计/ MySQL(第二部分)</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/da-portfolio-project-etl-database-design-mysql-part-ii-2e5aac3fc827?source=collection_archive---------5-----------------------#2022-08-12">https://blog.devgenius.io/da-portfolio-project-etl-database-design-mysql-part-ii-2e5aac3fc827?source=collection_archive---------5-----------------------#2022-08-12</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/f1a698e395f9884a6457017aab9361c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jz0LN7B-9GQnI5MV"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">在<a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae jz" href="https://unsplash.com/@frostroomhead?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Rodion Kutsaev </a>拍照</figcaption></figure><p id="d30c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在本系列的前一部分中，我们为项目创建了一个单独的环境，并安装了我们需要的库。今天我们将从编码开始！</p><p id="5715" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在，我必须澄清这个项目是关于什么的。因为我对武侠片非常着迷，所以我选择了它作为这个项目的主题。我以这样一种方式制作了它，这是一件非常有趣的事情，想象一下我甚至忘记我正在编码的场景。所以我所做的基本上是创建一个数据库，在一个叫做<em class="ky">万会</em>的特殊地方保存所有教派的信息。我们有所有的教派，属于他们的人，关于他们的信息，教派之间的联盟和各自拥有的武器。我是如此专注，以至于我为它创建了一个完整的场景，只是从我的文件中复制粘贴它，可以在这里找到<a class="ae jz" href="https://github.com/Armonia1999/Database-design-ETL-MySQL/blob/main/wanhui_ETL.ipynb" rel="noopener ugc nofollow" target="_blank"><strong class="kc io"><em class="ky"/></strong></a>。</p><blockquote class="kz la lb"><p id="0c71" class="ka kb ky kc b kd ke kf kg kh ki kj kk lc km kn ko ld kq kr ks le ku kv kw kx ig bi translated">万惠市民数据库设计</p><p id="28bd" class="ka kb ky kc b kd ke kf kg kh ki kj kk lc km kn ko ld kq kr ks le ku kv kw kx ig bi translated">万惠社最高统治者陈诚已经联系我们，解决他的问题。据他说，很多武术家开始放弃他们的教派并消失了。巧合的是，随机的暴力行为开始在该国不同地区发生，他怀疑胭脂武术家是幕后黑手。此外，一些教派开始变得过于强大，他怀疑他们可能试图联合起来推翻他。这就是为什么他想让我们设计一个数据库，用所有公民的信息填充它，这样他就可以跟踪他们的行动。有点可疑，但我们还是同意了，因为报酬实在太好了，让人无法拒绝。</p><p id="fb07" class="ka kb ky kc b kd ke kf kg kh ki kj kk lc km kn ko ld kq kr ks le ku kv kw kx ig bi translated">在问了他更多的问题以便能够掌握我们正在处理的事情之后，我们了解到以下信息:</p><p id="075a" class="ka kb ky kc b kd ke kf kg kh ki kj kk lc km kn ko ld kq kr ks le ku kv kw kx ig bi translated">万会基本上是建立在一群教派之上的，这些教派有许多人属于它，他们都在它的土地上训练和生活。</p><p id="5505" class="ka kb ky kc b kd ke kf kg kh ki kj kk lc km kn ko ld kq kr ks le ku kv kw kx ig bi translated">一些教派之间有一些联盟，原因是为了扩大他们的知识和业务。不与其他教派结盟并不一定意味着他们是敌人，毕竟他们都追随最高统治者。</p><p id="e1f8" class="ka kb ky kc b kd ke kf kg kh ki kj kk lc km kn ko ld kq kr ks le ku kv kw kx ig bi translated">人们可以培养不同的东西，例如他们培养阴影的力量，或者自然。这应该包括在数据库中。</p><p id="823a" class="ka kb ky kc b kd ke kf kg kh ki kj kk lc km kn ko ld kq kr ks le ku kv kw kx ig bi translated">公民力量有 9 个等级:1-3 为初级，4-6 为中级，最后 7-9 为高级。</p><p id="f097" class="ka kb ky kc b kd ke kf kg kh ki kj kk lc km kn ko ld kq kr ks le ku kv kw kx ig bi translated">我们只对 15-77 岁的人感兴趣，因为其他人并不构成太大威胁。</p><p id="74e8" class="ka kb ky kc b kd ke kf kg kh ki kj kk lc km kn ko ld kq kr ks le ku kv kw kx ig bi translated">作为初始设计，我们的数据库中需要 4 个表:</p><p id="8a58" class="ka kb ky kc b kd ke kf kg kh ki kj kk lc km kn ko ld kq kr ks le ku kv kw kx ig bi translated"><strong class="kc io"> Citizens </strong>保存公民个人信息的表格。</p><p id="f638" class="ka kb ky kc b kd ke kf kg kh ki kj kk lc km kn ko ld kq kr ks le ku kv kw kx ig bi translated"><strong class="kc io">门派</strong>表格，保存门派信息。</p><p id="203c" class="ka kb ky kc b kd ke kf kg kh ki kj kk lc km kn ko ld kq kr ks le ku kv kw kx ig bi translated"><strong class="kc io">联盟</strong>表看哪些门派相处融洽。</p><p id="b76f" class="ka kb ky kc b kd ke kf kg kh ki kj kk lc km kn ko ld kq kr ks le ku kv kw kx ig bi translated"><strong class="kc io">盘点</strong>表格，记录每个门派拥有的武器。</p><p id="a300" class="ka kb ky kc b kd ke kf kg kh ki kj kk lc km kn ko ld kq kr ks le ku kv kw kx ig bi translated">显然，数据库将被篡改，因为我们继续下去，但现在这是我们想要的。</p></blockquote><p id="87db" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这是目前的 ER 图:</p><figure class="lg lh li lj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lf"><img src="../Images/0504cbab082e13e65496e4bcc3888efd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G2gwuc0HDoIRiwdrOS19XA.png"/></div></div></figure><p id="9505" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">研究一下，然后继续前进。</p><p id="cccc" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">基本上现在我们将做一个 ETL 过程:提取，转换，加载。让我们开始提取:</p><p id="e3c2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在开始搜集之前，让我们输入不需要太多努力的简单数据。</p><figure class="lg lh li lj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lk"><img src="../Images/e11b5694383d7f28b496f440cc72c401.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fojadfMFC898Cyzycyh72A.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">小薯条</figcaption></figure><p id="bd96" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这让我做了很多清醒的梦来想出它们，哈哈。稍后我们将使用这些列表来填充数据库。既然小薯条已经不碍事了，那就抓紧时间吧。</p><p id="5074" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">首先，让我们导入我们需要的所有东西:</p><figure class="lg lh li lj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ll"><img src="../Images/42adb42cf791f74f76b85158c49ccac2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m7agopUbDKWRthTyN6Nl8A.png"/></div></div></figure><p id="99d3" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Selenium 用于抓取，faker 用于导入假数据，pandas 使我们可以构建一些数据框架，numpy 在将数据插入数据库时选择一些随机选择(也有 random)，时间等待几秒钟当抓取我们的数据时，selenium 库中已经有一个，但我更喜欢这个，csv 从我的 csv 文件中读取数据，最后 mysql 连接器连接到我们的 MySQL 工作台。</p><p id="567f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们走吧。我们将从搜集教派名称开始。</p><figure class="lg lh li lj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lm"><img src="../Images/f079c347b402960bd56547b286eb7db8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uv9iy_s5buAEMd7pA6sn2g.png"/></div></div></figure><p id="b2f2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们将网站如代码所示，这是它看起来的样子的一个片段:</p><figure class="lg lh li lj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ln"><img src="../Images/dbcb6ba1d7c0f820577e21b41644d0a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9wBKOZqhrPdTp3FPb9y4hA.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated"><a class="ae jz" href="https://www.fantasynamegenerators.com/wuxia-sect-names.php" rel="noopener ugc nofollow" target="_blank">https://www.fantasynamegenerators.com/wuxia-sect-names.php</a></figcaption></figure><p id="fea1" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">正如你所看到的，它列出了 10 个名字，我们可以用做合适的教派名称。通过点击“获取姓名”,你可以获得额外的 10 分，以此类推。现在我应该提到，有时它显示一个名字两次或三次，所以为了满足我需要的教派数量，它循环 10 次，这意味着最多 100 个教派名称。我们不会用光所有的钱，但最好有比我们需要的多一点的钱，以防万一。</p><p id="1af4" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">然后，我们将所有结果保存在 csv 文件中。我为什么要这么做？只是为了安全起见。事实是，我的另一个收集名字的功能花了很长时间。下面这张照片会让你感受到我的巨大痛苦:</p><figure class="lg lh li lj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lo"><img src="../Images/78b7c4076a5f160c0c5b6b631a6ec71d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i7CN6Iliz5gaaqFOFqJJgw.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">悲伤的时光</figcaption></figure><p id="1f15" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如您所见，代码在 700+分钟后崩溃，超过了 11 个小时！只是因为我的笔记本电脑与无线网络断开了连接，而我却不知道。11 个小时算不了什么，因为我甚至不能得到我的结果。所以，是的，总是保持备份作为 csv 或什么。</p><p id="7250" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">好了，我们有了各自的教派名称。现在让我们来看看公民的名字:</p><figure class="lg lh li lj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lp"><img src="../Images/1ad1e3133dc12818c6e6b9cf97de93db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2f1PYU7Jk-4GWTo6-IOCdg.png"/></div></div></figure><p id="1c15" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这一次，网站给我们每个循环 5 个名字，所以我让它运行了 10，000 次，这也没有用。因为我以为我会得到 4 万到 5 万个没有出现的名字。相反，它给了我一堆重复的名字，总共有 8000 个。没关系，我们可以这样做。这让我想到了下一步，生成假数据。</p><figure class="lg lh li lj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lq"><img src="../Images/e1096fdec2e53fd9c2e53290ae1b806f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kMR83DswDInUeZVBvcm95Q.png"/></div></div></figure><p id="cf23" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">循环的数量可能会吓到你，但它实际上运行不到一分钟！再次重复了很多，但我们会尽可能使用。</p><p id="dbdf" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">接下来我做的事情只是因为。可以跳过。我还用汉字生成了一堆中文名字，只是因为它们更贴近我的内心。但没有使用作为基础，因为我不能保证每个人看到我的项目可以阅读中文。所以我坚持用罗马化的。</p><blockquote class="kz la lb"><p id="c66f" class="ka kb ky kc b kd ke kf kg kh ki kj kk lc km kn ko ld kq kr ks le ku kv kw kx ig bi translated">有趣的事实:我在大学学习期间，纯粹出于好奇，选修了大约 8 个学分的普通话。最后得了满分。</p></blockquote><figure class="lg lh li lj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lr"><img src="../Images/7135bc99541de42cea297a883a32e03f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kBTFWj1-34yHN9vIR_iBUQ.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">是啊，一百万个循环…</figcaption></figure><p id="79c6" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这给了我 43000 个不同的名字！太好了。</p><p id="dca4" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这就是提取我们的数据。现在我们将对它进行一点改造。</p><p id="3d7b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们从抓取网站得到的名字和从 faker 得到的名字有一个很大的区别。订单。通过刮取获得的名字是这样的顺序:姓+名，而冒名者的名字则相反。所以我们想用姓在前的那个，把所有这些名字连在一个地方。</p><figure class="lg lh li lj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ls"><img src="../Images/c508b23d9280d80d950cc0b33c867b0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VKGo1-XUOMmhr32Lj6KTSw.png"/></div></div></figure><figure class="lg lh li lj gt jo gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/d04e8a68859ba285c8da3567a0fbaa6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*OkyBCeQVAc6eRpt7YmnVhQ.png"/></div></figure><figure class="lg lh li lj gt jo gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/cbe6352a8592c5ebac0e96567a79f8ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*JhFqq_dE_ZjWnGsNQIGH7g.png"/></div></figure><p id="4fa9" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在，我们已经提取了数据，并对其进行了一些转换。剩下的就是开始设计一个数据库，把它们加载进去。这将发生在明天的第三部分。现在只要确保你得到了如何刮，从 csv 文件读取工作。自己运行并探索一下。除了已经在 GitHub 上的 jupyter 笔记本之外，我现在将创建一个 python 文件，这样你就可以快速运行它了。因为笔记本有点麻烦。</p><p id="143b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">更新:链接到 python 文件<a class="ae jz" href="https://github.com/Armonia1999/Database-design-ETL-MySQL/blob/main/ETL.PY" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io"> <em class="ky">这里</em> </strong> </a>。只要做必要的改变，就应该是这样。</p><p id="1374" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi">See you tomorrow ! 拜拜 ♥</p></div></div>    
</body>
</html>