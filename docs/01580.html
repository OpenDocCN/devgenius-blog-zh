<html>
<head>
<title>Test your React Native app with Detox</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Detox 测试你的 React 原生应用</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/test-your-react-native-app-with-detox-316bafaadb65?source=collection_archive---------8-----------------------#2020-07-07">https://blog.devgenius.io/test-your-react-native-app-with-detox-316bafaadb65?source=collection_archive---------8-----------------------#2020-07-07</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="4f58" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="ki">在本文中，您将了解如何添加 E2E 移动应用程序测试，只需几个步骤即可对原生应用程序+0.62 和 Detox +16.11 做出反应。</em></p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/10653103de631786162bb171a785614e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K-j5npfR4mEC5ARjpjfMxQ.jpeg"/></div></div></figure><p id="9bc4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">几周前，我被邀请做一个关于排毒的演讲。我目前正在使用它大约 3/4 个月，虽然我不是 javascript 或 React 本地专家，但将它添加到应用程序并开始使用它是非常容易的。这是我做的同样的演讲，但是是用词！以及一些代码细节:)</p><h1 id="2f0b" class="kv kw in bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">什么是排毒？</h1><p id="5e4f" class="pw-post-body-paragraph jk jl in jm b jn lt jp jq jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ig bi translated">你会发现，根据定义，排毒的创造者说:</p><p id="65dc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="ki">“排毒是针对移动应用的灰盒 E2E 测试”</em></p><p id="f21f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这意味着你需要知道，至少在基础上，你的应用程序的结构。</p><p id="ea55" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一件很酷的事情是，你可以用它来测试 React 本地应用程序以及本地 Android 或 IOs 应用程序(<strong class="jm io">跨平台</strong>)。同样重要的是，你可以选择你喜欢的<strong class="jm io">测试跑步者</strong>(可以是 Jest、Mocha 等)。另一个很酷的特性是，它最初是为 CI 设计的，所以集成到 Travis 是可能的；您也可以处理同步。</p><p id="2b32" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我之前提到过“<em class="ki">创造者</em>”，这是我发现非常有趣的事情，因为你可能已经知道排毒是由<a class="ae ly" href="https://www.wix.engineering/" rel="noopener ugc nofollow" target="_blank"> WixEnginnering 开发的。</a>我亲自观看了关于排毒的演示视频，他们在视频中解释了使用<a class="ae ly" href="http://appium.io/" rel="noopener ugc nofollow" target="_blank"> Appium </a>几年后所面临的问题和困难，以及他们当时是如何决定创建自己的框架的。我发现了这个特别有趣的想法，即使用一个工具一段时间，然后决定创建一个新的工具并使它成功。</p><h1 id="7d40" class="kv kw in bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">哪些图书馆使用？</h1><p id="39f5" class="pw-post-body-paragraph jk jl in jm b jn lt jp jq jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ig bi translated">但是 Detox 并没有从零开始，他们重新使用了众所周知的库来测试每个平台:</p><p id="a4e7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae ly" href="https://developer.android.com/training/testing/espresso" rel="noopener ugc nofollow" target="_blank"> expresso </a></p><p id="c05c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae ly" href="https://github.com/google/EarlGrey" rel="noopener ugc nofollow" target="_blank">早期灰色</a></p><p id="5797" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">不打算深入这些库，但是我想提到这个细节，因为一旦你面临错误(构建错误或任何其他类型的错误，当你创建测试时)，你会发现知道在哪里看和在 StackOverflow 中使用哪个关键字是非常有用的。</p><h1 id="8ed0" class="kv kw in bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">开始吧！</h1><p id="155c" class="pw-post-body-paragraph jk jl in jm b jn lt jp jq jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ig bi translated">要在<strong class="jm io"> ios </strong>上运行，您需要:</p><ul class=""><li id="7b99" class="lz ma in jm b jn jo jr js jv mb jz mc kd md kh me mf mg mh bi translated">Xcode 10.2+带有 Xcode 命令行工具</li><li id="10ee" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">装有 macOS 的 Mac(至少 macOS High Sierra 10.13.6)</li><li id="0181" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><a class="ae ly" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank">节点. js </a></li><li id="2005" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><a class="ae ly" href="https://brew.sh/" rel="noopener ugc nofollow" target="_blank">最新自制</a></li><li id="c6bc" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><a class="ae ly" href="https://github.com/wix/AppleSimulatorUtils" rel="noopener ugc nofollow" target="_blank"> applesimutils </a></li><li id="b21b" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">排毒 Cli</li></ul><p id="3c7e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要在<strong class="jm io"> android </strong>上运行，您需要:</p><ul class=""><li id="cba7" class="lz ma in jm b jn jo jr js jv mb jz mc kd md kh me mf mg mh bi translated"><a class="ae ly" href="https://developer.android.com/studio/?gclid=EAIaIQobChMI2_CLur6f6gIVlAqRCh1NUwKwEAAYASAAEgL3efD_BwE&amp;gclsrc=aw.ds" rel="noopener ugc nofollow" target="_blank">安卓工作室</a>和<a class="ae ly" href="https://developer.android.com/studio/run/managing-avds" rel="noopener ugc nofollow" target="_blank"> AVD 经理</a></li><li id="5fe6" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">排毒 cli</li><li id="9418" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><a class="ae ly" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank"> Node.js </a></li></ul><p id="9a6e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">假设您已经有了所有的依赖项，您只想添加 Detox，然后执行:</p><pre class="kk kl km kn gt mn mo mp mq aw mr bi"><span id="a88c" class="ms kw in mo b gy mt mu l mv mw">npm install -g detox-cli</span></pre><p id="faaa" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在您需要将它添加到您的项目中:</p><pre class="kk kl km kn gt mn mo mp mq aw mr bi"><span id="b546" class="ms kw in mo b gy mt mu l mv mw">npm install detox --save-dev</span></pre><p id="9478" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">运行之后，您将看到对 package.json 配置的新依赖:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi mx"><img src="../Images/3ed96c6589e8c9c4f3fe487597f7d645.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z4YPb9qE6kF1Ts0fCqnQLA.png"/></div></div><figcaption class="my mz gj gh gi na nb bd b be z dk translated"><a class="ae ly" href="https://github.com/TamaraTorres/DetoxDemo/blob/master/package.json" rel="noopener ugc nofollow" target="_blank"> package.json </a></figcaption></figure><p id="fe50" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">下一步将决定您将使用哪个测试转轮，在这种情况下，我选择<a class="ae ly" href="https://mochajs.org/" rel="noopener ugc nofollow" target="_blank">摩卡</a>，但您可以使用任何其他:</p><pre class="kk kl km kn gt mn mo mp mq aw mr bi"><span id="430e" class="ms kw in mo b gy mt mu l mv mw">npm install mocha --save-dev</span><span id="2201" class="ms kw in mo b gy nc mu l mv mw">detox init -r mocha</span></pre><p id="01d3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">默认情况下，init 不仅会创建所有需要的文件，还会在 e2e 文件夹下创建一个测试文件:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/75d006c9fddd7bc12f31e1b88ea274c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/1*lNXrnVa6RVQEUfoOmO-i7Q.png"/></div><figcaption class="my mz gj gh gi na nb bd b be z dk translated"><a class="ae ly" href="https://github.com/TamaraTorres/DetoxDemo/tree/master/e2e" rel="noopener ugc nofollow" target="_blank">排毒开始后</a></figcaption></figure><p id="774b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">下一步将是利用 Detox 进行构建，为此，我们需要定义将要使用的配置</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi ne"><img src="../Images/419086fec2bba1497d9d6d097efc8fae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uwrjfXtguDaPHNCzUZMQBQ.png"/></div></div><figcaption class="my mz gj gh gi na nb bd b be z dk translated"><a class="ae ly" href="https://github.com/TamaraTorres/DetoxDemo/blob/master/.detoxrc.json" rel="noopener ugc nofollow" target="_blank"> detoxrc.json </a></figcaption></figure><p id="7f5a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你可以在这里看到 2 个配置:*1 个用于 android，1 个用于 ios，都处于调试模式。这里重要的事情:</p><ul class=""><li id="c721" class="lz ma in jm b jn jo jr js jv mb jz mc kd md kh me mf mg mh bi translated">替换<em class="ki"> avdName </em>为<strong class="jm io">你的安卓模拟器</strong></li><li id="9250" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">将<em class="ki">设备</em>类型替换为<strong class="jm io">你的 ios 模拟器</strong></li><li id="ed2a" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">将<em class="ki"> DetoxDemo </em>替换为<strong class="jm io">您的应用名称</strong></li></ul><p id="f3ac" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在我们可以建造</p><pre class="kk kl km kn gt mn mo mp mq aw mr bi"><span id="1263" class="ms kw in mo b gy mt mu l mv mw">detox build -c ios.debug<br/>or <br/>detox build -c android.debug</span></pre><p id="95b8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">停！</strong>在考虑运行测试之前，请检查以下内容:</p><ul class=""><li id="3b5b" class="lz ma in jm b jn jo jr js jv mb jz mc kd md kh me mf mg mh bi translated">您的仿真器/模拟器<strong class="jm io">已经启动并运行</strong>，并且与 detoxrc.json 上的配置相匹配</li><li id="6bbf" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">你已经跑了:</li></ul><pre class="kk kl km kn gt mn mo mp mq aw mr bi"><span id="13b1" class="ms kw in mo b gy mt mu l mv mw">yarn start</span></pre><p id="fa13" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">好了，现在您可以执行测试了:</p><pre class="kk kl km kn gt mn mo mp mq aw mr bi"><span id="df3b" class="ms kw in mo b gy mt mu l mv mw">detox test -c ios.debug<br/>or <br/>detox test -c android.debug</span></pre><p id="f076" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你可以在我的 GitHub 上找到代码并运行它！</p><div class="nf ng gp gr nh ni"><a href="https://github.com/TamaraTorres/DetoxDemo" rel="noopener  ugc nofollow" target="_blank"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd io gy z fp nn fr fs no fu fw im bi translated">TamaraTorres/解毒演示</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">这是一个 hello world react native 应用程序，使用 react-native cli 生成，您可以跟随 HelloWorld…</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">github.com</p></div></div><div class="nr l"><div class="ns l nt nu nv nr nw kt ni"/></div></div></a></div><p id="036d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果您想更深入地了解如何在您的应用中实施排毒，这里有一些有用的链接供您参考:</p><ul class=""><li id="5c5f" class="lz ma in jm b jn jo jr js jv mb jz mc kd md kh me mf mg mh bi translated"><a class="ae ly" href="https://github.com/wix/Detox" rel="noopener ugc nofollow" target="_blank">https://github.com/wix/Detox</a></li><li id="2964" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><a class="ae ly" href="https://github.com/google/EarlGrey" rel="noopener ugc nofollow" target="_blank">https://github.com/google/EarlGrey</a></li><li id="337c" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">https://developer.android.com/training/testing/espresso<a class="ae ly" href="https://developer.android.com/training/testing/espresso" rel="noopener ugc nofollow" target="_blank"/></li><li id="7093" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated">【https://github.com/wix/Detox/blob/master/docs/Introduction. T4】GettingStarted.md </li><li id="d274" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><a class="ae ly" href="https://www.youtube.com/watch?v=4rU0IGEt6OQ" rel="noopener ugc nofollow" target="_blank">排毒:解决移动自动化的剥落——Viktorija sujetait</a></li><li id="358c" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><a class="ae ly" href="https://www.youtube.com/watch?v=qiRJT5Eig3g" rel="noopener ugc nofollow" target="_blank"> Detox:用于移动应用的 Graybox 端到端测试和自动化库——Rotem Mizrachi-梅丹</a></li><li id="eb93" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><a class="ae ly" href="https://hackernoon.com/detox-gray-box-end-to-end-testing-framework-for-mobile-apps-196ccd9564ce" rel="noopener ugc nofollow" target="_blank"> Detox:用于移动应用的灰盒端到端测试框架</a></li><li id="aaf9" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><a class="ae ly" href="https://medium.com/@bogomolnyelad/how-to-test-your-react-native-app-like-a-real-user-ecfc72e9b6bc" rel="noopener">如何像真实用户一样测试你的 React 原生应用</a></li></ul><p id="afbe" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我希望这是有用的，下次再见！</p><p id="e7be" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">欢迎任何反馈！</p></div></div>    
</body>
</html>