<html>
<head>
<title>Browser Automation with Python and Selenium — 7: Keyboard and Action Chains</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 和 Selenium 实现浏览器自动化— 7:键盘和动作链</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/browser-automation-with-python-and-selenium-7-keyboard-and-action-chains-44152348a02c?source=collection_archive---------1-----------------------#2021-01-18">https://blog.devgenius.io/browser-automation-with-python-and-selenium-7-keyboard-and-action-chains-44152348a02c?source=collection_archive---------1-----------------------#2021-01-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9ce0" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">控制键盘</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/6f7b189c1ac7e5ee4abc26e7024f1aad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jipiAt2vcMtGpPMA"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@jay_zhang?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">张杰</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="fd3f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<a class="ae kv" href="http://link_to_post_6" rel="noopener ugc nofollow" target="_blank">之前的文章</a>中，我们研究了不同的导航策略。我们将在这篇文章中看到如何控制键盘动作。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="838d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Selenium 允许我们模仿键盘上的动作，比如按键，或者清除书写的内容。此外，我们可以使用 CTRL 或 SHIFT 这样的修饰键，在<code class="fe lz ma mb mc b"><a class="ae kv" href="https://github.com/SeleniumHQ/selenium/blob/0e0194b0e52a34e7df4b841f1ed74506beea5c3e/py/selenium/webdriver/common/action_chains.py#L30" rel="noopener ugc nofollow" target="_blank">ActionChains</a></code>类的帮助下执行一些复合/组合按键。</p><h1 id="ba3b" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">动作链</h1><p id="8019" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">动作链允许诸如鼠标移动、鼠标按钮动作、按键和拖放之类的交互。当您为<code class="fe lz ma mb mc b">ActionChains</code>对象上的动作调用方法时，这些动作存储在<code class="fe lz ma mb mc b">ActionChains</code>对象的队列中。当您调用<code class="fe lz ma mb mc b">perform</code>时，事件按照它们排队的顺序被触发。<code class="fe lz ma mb mc b">ActionChains</code>可采用连锁模式或逐个排队，然后执行。</p><p id="3199" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于以下情况</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><ol class=""><li id="adda" class="nc nd iq ky b kz la lc ld lf ne lj nf ln ng lr nh ni nj nk bi translated">通过传递 WebDriver 实例来创建一个<code class="fe lz ma mb mc b">ActionChains</code>实例。</li><li id="ea98" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated">一个动作(move_to_element)被添加到菜单元素的动作队列中。</li><li id="f1f3" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated">另一个动作(单击)被添加到 hidden_submenu 元素的动作队列中。</li><li id="ceba" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated">当<code class="fe lz ma mb mc b">perform</code>被调用时，添加到队列中的第一个动作被执行以移动到主菜单。</li><li id="69f0" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated">然后执行添加的第二个动作，单击子菜单元素。</li></ol></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="eab5" class="md me iq bd mf mg nq mi mj mk nr mm mn jw ns jx mp jz nt ka mr kc nu kd mt mu bi translated">键盘</h1><h2 id="f9c3" class="nv me iq bd mf nw nx dn mj ny nz dp mn lf oa ob mp lj oc od mr ln oe of mt og bi translated">发送键</h2><p id="35d6" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated"><code class="fe lz ma mb mc b">send_keys</code>方法在元素中键入一个键序列。修饰键可从<code class="fe lz ma mb mc b"><a class="ae kv" href="https://github.com/SeleniumHQ/selenium/blob/trunk/py/selenium/webdriver/common/keys.py" rel="noopener ugc nofollow" target="_blank">Keys</a></code>类获得。它可以将来自<code class="fe lz ma mb mc b">Keys</code>类的一个字符串或一个键作为参数。</p><p id="1f44" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面的<a class="ae kv" href="https://github.com/coskundeniz/selenium-examples/blob/main/keyboard/sending_keys.py" rel="noopener ugc nofollow" target="_blank">示例</a>用“example@somedomain.com”值填充邮件输入字段。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><h2 id="6088" class="nv me iq bd mf nw nx dn mj ny nz dp mn lf oa ob mp lj oc od mr ln oe of mt og bi translated">向下键</h2><p id="0f58" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated"><code class="fe lz ma mb mc b">key_down</code>用于模拟按下修饰键(Ctrl、Alt、Shift)而不释放。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="eaf0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该示例将以下代码写入文本区域，并使用<code class="fe lz ma mb mc b">CTRL+A</code>组合选择它。</p><pre class="kg kh ki kj gt oh mc oi oj aw ok bi"><span id="002a" class="nv me iq mc b gy ol om l on oo">def foo():<br/>    pass</span></pre><h2 id="8858" class="nv me iq bd mf nw nx dn mj ny nz dp mn lf oa ob mp lj oc od mr ln oe of mt og bi translated">向上键</h2><p id="5ab5" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated"><code class="fe lz ma mb mc b">key_up</code>用于模拟用<code class="fe lz ma mb mc b">key_down</code>方法按下的修饰键的上键或松键动作。</p><p id="8cfb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下示例在 Google 上搜索“SELENIUM webdriver”。它使用 SHIFT 键将 selenium 写成大写。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi op"><img src="../Images/378996a2f8cf28e2e225b0aef5dfa6be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*AkeGDLuc_XaPe5OCTJ1CDg.gif"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">执行 keydown_keyup_chain.py</figcaption></figure><h2 id="2891" class="nv me iq bd mf nw nx dn mj ny nz dp mn lf oa ob mp lj oc od mr ln oe of mt og bi translated">清楚的</h2><p id="0fa9" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">此方法清除可编辑元素的内容。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi op"><img src="../Images/fb2f005a871872a142513b94dd7419f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*WGYP9te36APLruzc1Fwtkg.gif"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">执行 clear_content.py</figcaption></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="8ad3" class="nv me iq bd mf nw nx dn mj ny nz dp mn lf oa ob mp lj oc od mr ln oe of mt og bi translated">要记住的事情</h2><ul class=""><li id="d250" class="nc nd iq ky b kz mv lc mw lf oq lj or ln os lr ot ni nj nk bi translated">Selenium 允许我们模拟键盘动作，比如按键、使用 CTRL、SHIFT 等修饰键或者清除所写的内容。</li><li id="e386" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr ot ni nj nk bi translated">修饰键可以在<code class="fe lz ma mb mc b">ActionChains</code>类的帮助下使用。</li><li id="aa20" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr ot ni nj nk bi translated">您可以通过调用<code class="fe lz ma mb mc b">ActionChains</code>对象上的<code class="fe lz ma mb mc b">perform</code>方法来组合多个动作并按顺序运行它们。</li><li id="c50b" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr ot ni nj nk bi translated">Selenium Python api 为键盘动作提供了<code class="fe lz ma mb mc b">send_keys</code>、<code class="fe lz ma mb mc b">key_down</code>、<code class="fe lz ma mb mc b">key_up</code>和<code class="fe lz ma mb mc b">clear</code>方法。</li></ul><p id="9547" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在下一篇文章中，我将讲述浏览器的功能和将选项传递给 webdriver。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="ff59" class="nv me iq bd mf nw nx dn mj ny nz dp mn lf oa ob mp lj oc od mr ln oe of mt og bi translated">参考</h2><ol class=""><li id="4d3f" class="nc nd iq ky b kz mv lc mw lf oq lj or ln os lr nh ni nj nk bi translated"><a class="ae kv" href="https://www.selenium.dev/documentation/en/webdriver/keyboard/" rel="noopener ugc nofollow" target="_blank">https://www . selenium . dev/documentation/en/web driver/keyboard/</a></li><li id="809f" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated"><a class="ae kv" href="https://github.com/SeleniumHQ/selenium/blob/trunk/py/selenium/webdriver/common/action_chains.py" rel="noopener ugc nofollow" target="_blank">https://github . com/selenium HQ/selenium/blob/trunk/py/selenium/web driver/common/action _ chains . py</a></li><li id="a254" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated"><a class="ae kv" href="https://www.softwaretestingmaterial.com/mouse-and-keyboard-interactions-in-selenium-python/" rel="noopener ugc nofollow" target="_blank">https://www . software testing material . com/mouse-and-keyboard-interactions-in-selenium-python/</a></li><li id="d95f" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated"><a class="ae kv" href="https://www.geeksforgeeks.org/action-chains-in-selenium-python/" rel="noopener ugc nofollow" target="_blank">https://www . geeks forgeeks . org/action-chains-in-selenium-python/</a></li></ol><p id="db94" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">谢谢你的时间。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><div class="kg kh ki kj gt ou"><a href="https://medium.com/dev-genius/browser-automation-with-python-and-selenium-5-waits-4b9e4636548c" rel="noopener follow" target="_blank"><div class="ov ab fo"><div class="ow ab ox cl cj oy"><h2 class="bd ir gy z fp oz fr fs pa fu fw ip bi translated">使用 Python 和 Selenium 实现浏览器自动化— 5:等待</h2><div class="pb l"><h3 class="bd b gy z fp oz fr fs pa fu fw dk translated">确保它在那里</h3></div><div class="pc l"><p class="bd b dl z fp oz fr fs pa fu fw dk translated">medium.com</p></div></div><div class="pd l"><div class="pe l pf pg ph pd pi kp ou"/></div></div></a></div><div class="pj pk gp gr pl ou"><a href="https://medium.com/dev-genius/browser-automation-with-python-and-selenium-3-architecture-fa01f7d0763a" rel="noopener follow" target="_blank"><div class="ov ab fo"><div class="ow ab ox cl cj oy"><h2 class="bd ir gy z fp oz fr fs pa fu fw ip bi translated">使用 Python 和 Selenium 实现浏览器自动化— 3:架构</h2><div class="pb l"><h3 class="bd b gy z fp oz fr fs pa fu fw dk translated">硒应用的鸟瞰图</h3></div><div class="pc l"><p class="bd b dl z fp oz fr fs pa fu fw dk translated">medium.com</p></div></div><div class="pd l"><div class="pm l pf pg ph pd pi kp ou"/></div></div></a></div><div class="pj pk gp gr pl ou"><a href="https://codenineeight.medium.com/browser-automation-with-python-and-selenium-1-installation-1596d079d4d" rel="noopener follow" target="_blank"><div class="ov ab fo"><div class="ow ab ox cl cj oy"><h2 class="bd ir gy z fp oz fr fs pa fu fw ip bi translated">使用 Python 和 Selenium 实现浏览器自动化— 1:安装</h2><div class="pb l"><h3 class="bd b gy z fp oz fr fs pa fu fw dk translated">即将开始…</h3></div><div class="pc l"><p class="bd b dl z fp oz fr fs pa fu fw dk translated">codenineeight.medium.com</p></div></div><div class="pd l"><div class="pn l pf pg ph pd pi kp ou"/></div></div></a></div></div></div>    
</body>
</html>