<html>
<head>
<title/>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1/>
<blockquote>原文：<a href="https://blog.devgenius.io/javascript-floating-point-im-precision-235045f6acf2?source=collection_archive---------12-----------------------#2020-05-29">https://blog.devgenius.io/javascript-floating-point-im-precision-235045f6acf2?source=collection_archive---------12-----------------------#2020-05-29</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><figure class="im in gp gr io ip gh gi paragraph-image"><div class="gh gi il"><img src="../Images/6b7c7be8fd7ac5d7c99d93faee0c3d54.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*n2TJlp_-jQXk-aNUGT7kUg.png"/></div><figcaption class="is it gj gh gi iu iv bd b be z dk translated"><strong class="bd iw">JavaScript中为什么会出现这种情况</strong></figcaption></figure><p id="1e2a" class="pw-post-body-paragraph ix iy iz ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv ig bi translated">让我们来看看JavaScript的一个有趣的事实。就像我们都使用JavaScript代码进行计算，但有时我们会得到奇怪的结果。</p></div><div class="ab cl jw jx hr jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="ig ih ii ij ik"><blockquote class="kd ke kf"><p id="2d53" class="ix iy kg ja b jb jc jd je jf jg jh ji kh jk jl jm ki jo jp jq kj js jt ju jv ig bi translated">浮点精度</p></blockquote><p id="f7ec" class="pw-post-body-paragraph ix iy iz ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv ig bi translated">我说的是JavaScript中的二进制和十进制系统。有时我们从一个极其简单的计算中得到奇怪的输出。</p><figure class="kl km kn ko gt ip gh gi paragraph-image"><div class="gh gi kk"><img src="../Images/d163bd1998479a713660cb6e6ab61d43.png" data-original-src="https://miro.medium.com/v2/resize:fit:616/format:webp/1*VBThZCHTrdEXMTkKJmnaKQ.png"/></div></figure><p id="b76f" class="pw-post-body-paragraph ix iy iz ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv ig bi translated">当我们使用计算器时，它大约等于0.6。但是如果我们比较两个<strong class="ja kp"> 0.2 + 0.4到0.6 </strong>，结果我们得到<strong class="ja kp">假</strong>。</p><figure class="kl km kn ko gt ip gh gi paragraph-image"><div class="gh gi kq"><img src="../Images/febee9204700e140cfb16a38f3c0b704.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*EHvz0uIlJNvg8r3WPA1d1A.png"/></div></figure><ul class=""><li id="2e2d" class="kr ks iz ja b jb jc jf jg jj kt jn ku jr kv jv kw kx ky kz bi translated"><strong class="ja kp"><em class="kg">JavaScript中为什么0.2 + 0.4不等于0.6？</em>T9】</strong></li></ul><p id="63c3" class="pw-post-body-paragraph ix iy iz ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv ig bi translated">根据数学概念，它失败了。那为什么不用JavaScript呢</p><p id="a9ec" class="pw-post-body-paragraph ix iy iz ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv ig bi translated">所以带着这个问题，一切都归结到<strong class="ja kp"> <em class="kg">二进制</em> </strong>哪些<strong class="ja kp"> <em class="kg"> JavaScript </em> </strong>等编程语言在幕后使用以及<strong class="ja kp"> <em class="kg">十进制</em> </strong>我们程序员工作。当我们说0.2和0.4时，我们当然是在以10为基数的<strong class="ja kp"> <em class="kg">十进制系统</em> </strong>中工作。</p><p id="7745" class="pw-post-body-paragraph ix iy iz ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv ig bi translated">而我们知道的<strong class="ja kp"> JS </strong>工作在以2为基数的<strong class="ja kp"> <em class="kg">二进制</em> </strong>上。</p><p id="7d3c" class="pw-post-body-paragraph ix iy iz ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv ig bi translated">因此，JavaScript将这些“不”转换成二进制“不”来进行计算，然后再将它们转换回来，给出我们可以理解的输出。</p><p id="1e44" class="pw-post-body-paragraph ix iy iz ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv ig bi translated">因此，重要的是要理解像0.2或0.4这样的数字是用整数的分数来表示的。</p><p id="5904" class="pw-post-body-paragraph ix iy iz ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv ig bi translated">按照<strong class="ja kp"> <em class="kg">十进制</em> </strong>，<strong class="ja kp"> 0.2 ≡ 1/5 </strong>，<strong class="ja kp"> 0.4 ≡ 2/5。</strong></p><p id="defb" class="pw-post-body-paragraph ix iy iz ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv ig bi translated">但是在<strong class="ja kp"> <em class="kg">二进制</em> </strong>中，就不一样了。为了完全理解这一点，让我们举一个例子，即使是十进制系统<strong class="ja kp"><em class="kg"/></strong>也没有完美的结果，例如</p><figure class="kl km kn ko gt ip gh gi paragraph-image"><div class="gh gi kq"><img src="../Images/63a567863168866a59116bc1cde25907.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*hZvPExVTzJLmm2S3YnFR8w.png"/></div></figure><p id="52ac" class="pw-post-body-paragraph ix iy iz ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv ig bi translated">与上述情况类似，<strong class="ja kp"> <em class="kg">二进制</em> </strong>也不具有完美的结果，不仅对于情况<strong class="ja kp"> 1/3 </strong>而是更多的情况。</p><blockquote class="kd ke kf"><p id="bdce" class="ix iy kg ja b jb jc jd je jf jg jh ji kh jk jl jm ki jo jp jq kj js jt ju jv ig bi translated">二进制中的“不”是如何表示的？</p></blockquote><figure class="kl km kn ko gt ip gh gi paragraph-image"><div class="gh gi la"><img src="../Images/60c34b9ffcdcf522e474009f9ec29475.png" data-original-src="https://miro.medium.com/v2/resize:fit:586/format:webp/1*7EKFOxZBUPsIifg_aqidFg.png"/></div></figure><p id="13b7" class="pw-post-body-paragraph ix iy iz ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv ig bi translated">本例中，<strong class="ja kp">整数1 </strong>转换为<strong class="ja kp"> <em class="kg">二进制中的<strong class="ja kp"> "1" </strong>。</em> </strong>因为<strong class="ja kp"> <em class="kg">二进制</em> </strong>把数字理解为0和1所以这里的1也是<strong class="ja kp"> <em class="kg">二进制</em> </strong>中的1。</p><p id="485d" class="pw-post-body-paragraph ix iy iz ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv ig bi translated"><strong class="ja kp">注意:</strong>当我们将整数1放入括号中，并使用参数为2的JavaScript的toString()方法时，该方法将告知将其转换为base 2格式。</p><p id="8420" class="pw-post-body-paragraph ix iy iz ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv ig bi translated">现在，我们将十进制<strong class="ja kp"><em class="kg"/></strong>中的<strong class="ja kp"> 1/5 </strong>相除，得到的结果为<strong class="ja kp"> 0.2、</strong>和<strong class="ja kp"> 2/5 </strong>，得到的结果为<strong class="ja kp"> 0.4 </strong></p><p id="df6d" class="pw-post-body-paragraph ix iy iz ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv ig bi translated">所以我们先把这个转换成<strong class="ja kp"> <em class="kg">二进制</em> </strong>。</p><figure class="kl km kn ko gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lb"><img src="../Images/4df17844e13f3e14761aede281229486.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vc1rr1H9FjNWyownU7XeXg.png"/></div></div></figure><figure class="kl km kn ko gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lg"><img src="../Images/1e99f2ff05a7b4454c9f6273debc5c4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*on9sO8zgOmZ30SKDIqd6vg.png"/></div></div></figure><p id="bff9" class="pw-post-body-paragraph ix iy iz ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv ig bi translated">因此，我们可以看到，该模式在这两个版本中分别重复为00110011…和01100110…就像在3333中一样…</p><p id="09f7" class="pw-post-body-paragraph ix iy iz ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv ig bi translated">现在计算取<strong class="ja kp"> <em class="kg"> </em> </strong>处<strong class="ja kp"> <em class="kg"> </em> </strong>为。</p><pre class="kl km kn ko gt lh li lj lk aw ll bi"><span id="215b" class="lm ln iz li b gy lo lp l lq lr"><strong class="li kp">&gt; parseFloat((2/5).toString(10)) + parseFloat((1/5).toString(10))</strong></span><span id="e2a7" class="lm ln iz li b gy ls lp l lq lr"><strong class="li kp">&lt; 0.6000000000000001</strong></span></pre><p id="7c70" class="pw-post-body-paragraph ix iy iz ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv ig bi translated">当我们加上两个不完美的不，我们得到一个不完美的数字<strong class="ja kp"><em class="kg">(0.6000000000000001)</em></strong>。</p></div><div class="ab cl jw jx hr jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="ig ih ii ij ik"><blockquote class="kd ke kf"><p id="a2ee" class="ix iy kg ja b jb jc jd je jf jg jh ji kh jk jl jm ki jo jp jq kj js jt ju jv ig bi translated">这有问题吗？</p></blockquote><p id="d5ba" class="pw-post-body-paragraph ix iy iz ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv ig bi translated">不，对于大多数计算来说，这不是问题，因为自动舍入在JavaScript中工作得很好。</p><p id="67b1" class="pw-post-body-paragraph ix iy iz ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv ig bi translated">为了避免不必要的额外印象，我们可以使用JavaScript的另一种方法，即:<strong class="ja kp"> <em class="kg"> toFixed() </em> </strong>。</p><p id="69e7" class="pw-post-body-paragraph ix iy iz ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv ig bi translated"><strong class="ja kp">注意:</strong>通过使用<strong class="ja kp"> <em class="kg"> toFixed() </em> </strong>方法，您可以强制JavaScript显示您需要的小数位数。</p><figure class="kl km kn ko gt ip gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/ee47add767b4262051f16f03080e2eee.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/1*xBNsnpb59vIXkKonCNCNYA.png"/></div></figure><p id="1a64" class="pw-post-body-paragraph ix iy iz ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv ig bi translated">在这里，JavaScript只显示2个小数位，最终会得到一个完美的数字(我们可以指定任意数量的小数位)。JavaScript将其四舍五入，避免了不精确。因此，为了将结果(输出)提供给最终用户，toFixed()是解决这个问题的一个很好的方法。</p></div></div>    
</body>
</html>