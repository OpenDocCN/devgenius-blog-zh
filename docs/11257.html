<html>
<head>
<title>Postgres for time series data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">æ—¶é—´åºåˆ—æ•°æ®çš„ Postgres</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://blog.devgenius.io/postgres-for-time-series-data-8ec3a849a14?source=collection_archive---------5-----------------------#2022-12-28">https://blog.devgenius.io/postgres-for-time-series-data-8ec3a849a14?source=collection_archive---------5-----------------------#2022-12-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="fd05" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">å¦‚ä½•ç”¨ Docker å»ºç«‹æ—¶é—´åˆ»åº¦æ•°æ®åº“ï¼Ÿ</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/4c4d409a8e8cdced1ab65524008fa15f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*R9ysyN9iCG_IE7hK"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">ç”±<a class="ae kv" href="https://unsplash.com/@urielsc26?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">ä¹Œåˆ—å°” SC </a>åœ¨<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„çš„ç…§ç‰‡</figcaption></figure><p id="0a12" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> TimescaleDB </strong>æ˜¯ä¸€ä¸ªå¼€æºçš„æ—¶åºæ•°æ®å…³ç³»æ•°æ®åº“ã€‚å®ƒä½¿ç”¨å®Œæ•´çš„ SQLï¼Œä½†æ˜¯ä»¥ä»¥å‰ä¸º NoSQL æ•°æ®åº“ä¿ç•™çš„æ–¹å¼æ‰©å±•ã€‚</p><p id="509e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»æ—¶é—´åˆ»åº¦æ•°æ®åº“ã€‚æˆ‘ä»¬è¿˜å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•ä½¿ç”¨ Docker è½»æ¾å»ºç«‹æ—¶é—´åˆ»åº¦æ•°æ®åº“ã€‚è¿™äº›æ­¥éª¤å¦‚ä¸‹:</p><ol class=""><li id="0dfe" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated"><strong class="ky ir">æ—¶æ ‡åŸºç¡€çŸ¥è¯†</strong></li><li id="7485" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ir">æŠ€æœ¯è¦æ±‚</strong></li><li id="94f1" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ir">å¸¦ Docker çš„æ—¶æ ‡ db</strong></li><li id="6c95" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ir">ä¾‹å­</strong> <strong class="ky ir">ç”¨ Python </strong></li><li id="f2f4" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ir">ç»“è®º</strong></li><li id="8d00" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ir">æœ‰ç”¨é“¾æ¥</strong></li></ol><h1 id="caeb" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">ğŸ¤”æ—¶æ ‡ b åŸºç¡€</h1><p id="8048" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">TimescaleDB ä½¿ç”¨ PostgreSQL å’Œæœ€å¤§çš„å¼€å‘äººå‘˜å’Œç®¡ç†å·¥å…·ç”Ÿæ€ç³»ç»Ÿã€‚æ­¤å¤–ï¼ŒTimescaleDB çš„æŸ¥è¯¢é€Ÿåº¦æ¯” PostgreSQLã€InfluxDB å’Œ MongoDB å¿« 10-100 å€ã€‚æ‚¨å¯ä»¥æ¯ç§’å†™å…¥æ•°ç™¾ä¸‡ä¸ªæ•°æ®ç‚¹ï¼Œåœ¨å•ä¸ªèŠ‚ç‚¹ä¸Šå­˜å‚¨æ•°ç™¾ TBï¼Œåœ¨å¤šä¸ªèŠ‚ç‚¹ä¸Šå­˜å‚¨æ•° Pbã€‚</p><h2 id="c482" class="nd mh iq bd mi ne nf dn mm ng nh dp mq lf ni nj ms lj nk nl mu ln nm nn mw no bi translated">ä»€ä¹ˆæ˜¯æ—¶é—´åºåˆ—æ•°æ®ï¼Ÿ</h2><p id="ff37" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">æ—¶é—´åºåˆ—æ•°æ®æ˜¯æ€»ç»“ç³»ç»Ÿã€è¿‡ç¨‹æˆ–è¡Œä¸ºå¦‚ä½•éšæ—¶é—´å˜åŒ–çš„æ•°æ®ã€‚è¿™äº›æ•°æ®å…·æœ‰ä»¥ä¸‹ç‰¹å¾:</p><ul class=""><li id="e8b9" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr np ly lz ma bi translated">ä»¥æ—¶é—´ä¸ºä¸­å¿ƒçš„:æ•°æ®è®°å½•æ€»æ˜¯æœ‰ä¸€ä¸ªæ—¶é—´æˆ³</li><li id="5ef2" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr np ly lz ma bi translated"><strong class="ky ir">ä»…è¿½åŠ </strong>:æ•°æ®å‡ ä¹å®Œå…¨æ˜¯ä»…è¿½åŠ çš„</li><li id="2fa0" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr np ly lz ma bi translated"><strong class="ky ir">æœ€è¿‘çš„</strong>:æ–°æ•°æ®é€šå¸¸æ˜¯å…³äºæœ€è¿‘çš„æ—¶é—´é—´éš”</li></ul><p id="387a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸æ ‡å‡†å…³ç³»æ•°æ®ç­‰å…¶ä»–æ•°æ®ç›¸æ¯”ï¼Œæ—¶é—´åºåˆ—æ•°æ®çš„ä¸€ä¸ªå…³é”®åŒºåˆ«åœ¨äºï¼Œå¯¹æ•°æ®çš„æ›´æ”¹æ˜¯æ’å…¥ï¼Œè€Œä¸æ˜¯è¦†ç›–ã€‚</p><p id="213b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä½ ä¼šåœ¨ä¸åŒçš„é¢†åŸŸå‘ç°æ—¶é—´åºåˆ—ï¼Œä¾‹å¦‚åœ¨è®¡ç®—æœºç³»ç»Ÿç›‘æ§ã€é‡‘èäº¤æ˜“ç³»ç»Ÿã€ç‰©è”ç½‘å’Œå•†ä¸šæ™ºèƒ½ç¯å¢ƒä¸­ã€‚</p><h2 id="a50a" class="nd mh iq bd mi ne nf dn mm ng nh dp mq lf ni nj ms lj nk nl mu ln nm nn mw no bi translated">æ—¶æ ‡çš„ä¸»è¦æ¦‚å¿µ b</h2><p id="6213" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated"><strong class="ky ir">è¶…è¡¨</strong>æ˜¯ PostgreSQL è¡¨ï¼Œå…·æœ‰å¤„ç†æ—¶é—´åºåˆ—æ•°æ®çš„ç‰¹æ®ŠåŠŸèƒ½ã€‚æ‚¨å¯ä»¥åœ¨åŒä¸€ä¸ªæ•°æ®åº“ä¸­ä½¿ç”¨ hypertables å’Œå¸¸è§„ PostgreSQL è¡¨ã€‚ä¸ºæ—¶é—´åºåˆ—é€‰æ‹©è¶…è¡¨ï¼Œä¸ºå…³ç³»æ•°æ®é€‰æ‹©å¸¸è§„ PostgreSQL è¡¨ã€‚</p><p id="9d7c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸ºäº†æ›´å¥½åœ°è¯´æ˜è¿™ä¸€ç‚¹ï¼Œä¸¾ä¸ªä¾‹å­:è¦è®°å½•ä¸€æ®µæ—¶é—´å†…çš„è‚¡ä»·ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªè¶…è¡¨å’Œä¸€ä¸ªå¸¸è§„è¡¨æ¥è®°å½•æ¯åªè‚¡ç¥¨çš„è‚¡ç¥¨ä»£ç å’Œåç§°ã€‚</p><p id="49a4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¦‚æœå¯¹æŠ€æœ¯å®ç°æ„Ÿå…´è¶£ï¼Œå¯ä»¥åœ¨<a class="ae kv" href="https://docs.timescale.com/timescaledb/latest/overview/core-concepts/hypertables-and-chunks/hypertable-architecture/" rel="noopener ugc nofollow" target="_blank"> Hypertable å’Œ chunk architecture </a>ä¸‹æ·±å…¥ç ”ç©¶ã€‚</p><h1 id="88eb" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">âœ…æŠ€æœ¯è¦æ±‚</h1><p id="3b51" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">æ‚¨å°†éœ€è¦ä»¥ä¸‹å…ˆå†³æ¡ä»¶:</p><ul class=""><li id="c54c" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr np ly lz ma bi translated">æ‚¨çš„æœºå™¨ä¸Šå¿…é¡»å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ Dockerã€‚å¦‚æœæ‚¨å°šæœªå®‰è£…ï¼Œè¯·æŒ‰ç…§<a class="ae kv" href="https://docs.docker.com/get-docker/" rel="noopener ugc nofollow" target="_blank">è¯´æ˜</a>è¿›è¡Œæ“ä½œã€‚</li><li id="163c" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr np ly lz ma bi translated">æ‚¨çš„è®¡ç®—æœºä¸Šå¿…é¡»å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ Docker Composeã€‚è¯·éµå¾ª<a class="ae kv" href="https://docs.docker.com/compose/install/" rel="noopener ugc nofollow" target="_blank">çš„æŒ‡ç¤º</a>ã€‚</li><li id="4086" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr np ly lz ma bi translated">è®¿é—® bash (macOSã€Linux æˆ– Windows)ã€‚</li><li id="076a" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr np ly lz ma bi translated">ä¸€ä¸ªä½ é€‰æ‹©çš„ Python åŒ…ç®¡ç†å™¨ï¼Œåƒ<a class="ae kv" href="https://docs.conda.io/en/latest/miniconda.html" rel="noopener ugc nofollow" target="_blank">åº·è¾¾</a></li></ul><h1 id="6d0b" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">å¸¦ Docker çš„ğŸ–¥æ—¶æ ‡ b</h1><p id="5ab4" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">é¦–å…ˆï¼Œæ‚¨åº”è¯¥æ£€æŸ¥æ˜¯å¦æ­£ç¡®å®‰è£…äº† Docker å’Œ Docker Composeã€‚æ‰“å¼€æ‚¨é€‰æ‹©çš„ç»ˆç«¯å¹¶è¾“å…¥ä»¥ä¸‹å‘½ä»¤:</p><pre class="kg kh ki kj gt nq nr ns bn nt nu bi"><span id="cee9" class="nv mh iq nr b be nw nx l ny nz">$ docker --version<br/># Example output: $ Docker version 20.10.21</span></pre><p id="7389" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¦‚æœå®‰è£…æ­£ç¡®ï¼Œåˆ™è¾“å‡º Docker ç‰ˆæœ¬ã€‚æ‚¨å¯ä»¥ä¸ºæ‚¨çš„ Docker Compose å®‰è£…æ£€æŸ¥ç›¸åŒçš„å†…å®¹ã€‚</p><pre class="kg kh ki kj gt nq nr ns bn nt nu bi"><span id="f819" class="nv mh iq nr b be nw nx l ny nz">$ docker-compose --version<br/># Example output: $ Docker Compose version v2.12.2</span></pre><p id="c035" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ˜¯å•Šã€‚ä¸€åˆ‡æ­£å¸¸ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä» Docker ç»„åˆæ ˆå¼€å§‹ã€‚</p><h2 id="f4ab" class="nd mh iq bd mi ne nf dn mm ng nh dp mq lf ni nj ms lj nk nl mu ln nm nn mw no bi translated">ä½¿ç”¨ Docker ç¼–å†™è¿›è¡Œè®¾ç½®</h2><p id="2634" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">æœ‰å‡ ç§<a class="ae kv" href="https://docs.timescale.com/install/latest/" rel="noopener ugc nofollow" target="_blank">æ–¹æ³•</a>æ¥è®¾ç½®æ—¶é—´åˆ»åº¦ DBã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†é‡ç‚¹å…³æ³¨åŸºäºå®¹å™¨çš„é€‰é¡¹ã€‚å †æ ˆåŒ…å«ä¸¤ä¸ªæœåŠ¡ï¼Œ<a class="ae kv" href="https://hub.docker.com/r/timescale/timescaledb" rel="noopener ugc nofollow" target="_blank"> TimescaleDB </a>å’Œ<a class="ae kv" href="https://hub.docker.com/_/adminer/" rel="noopener ugc nofollow" target="_blank"> Adminer </a>ã€‚Adminer æ˜¯ä¸€ä¸ªå…¨åŠŸèƒ½çš„æ•°æ®åº“ç®¡ç†å·¥å…·ã€‚</p><p id="9a39" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> Docker åˆæˆå †æ ˆ(docker-compose.yml æ–‡ä»¶):</strong></p><pre class="kg kh ki kj gt nq nr ns bn nt nu bi"><span id="c3f5" class="nv mh iq nr b be nw nx l ny nz">version: "3.8"<br/><br/>services:<br/>  timescaledb:<br/>    image: timescale/timescaledb:latest-pg14<br/>    container_name: timescale<br/>    hostname: timescaledb<br/>    restart: always<br/>    ports:<br/>      - ${TIMESCALEDB_PORT}:5432<br/>    volumes:<br/>      - ./${TIMESCALEDB_DATA_STORE}:/var/lib/postgresql/data<br/>    environment:<br/>      POSTGRES_PASSWORD: ${TIMESCALEDB_PASSWORD}<br/>      POSTGRES_USER: ${TIMESCALEDB_USER}<br/>      POSTGRES_DB: ${TIMESCALEDB_DB}<br/>  adminer:<br/>    image: adminer:4.8.1<br/>    container_name: adminer<br/>    restart: always<br/>    ports:<br/>      - ${ADMINER_PORT}:8080</span></pre><p id="868b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å»ºè®®å°†å˜é‡åˆ†æˆä¸€ä¸ªã€‚ç¯å¢ƒæ–‡ä»¶ã€‚å®ƒå¯¼è‡´ä¸€ä¸ªæ›´å¥½çš„æ¦‚è¿°ã€‚</p><p id="930f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">ã€‚ç¯å¢ƒæ–‡ä»¶:</strong></p><pre class="kg kh ki kj gt nq nr ns bn nt nu bi"><span id="899b" class="nv mh iq nr b be nw nx l ny nz"># timescaledb<br/>TIMESCALEDB_PORT=5432<br/>TIMESCALEDB_DATA_STORE=timescaledb/<br/>TIMESCALEDB_PASSWORD=timescaledb<br/>TIMESCALEDB_USER=timescale<br/>TIMESCALEDB_DB=timescale_database<br/><br/># adminer<br/>ADMINER_PORT=8087</span></pre><p id="644e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ‰“å¼€æ‚¨é€‰æ‹©çš„ç»ˆç«¯ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ docker-compose å †æ ˆ:</p><pre class="kg kh ki kj gt nq nr ns bn nt nu bi"><span id="f01b" class="nv mh iq nr b be nw nx l ny nz">$ docker compose up -d</span></pre><p id="9741" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ ‡å¿—-d æ„å‘³ç€å®¹å™¨ä½œä¸ºå®ˆæŠ¤è¿›ç¨‹è¿è¡Œã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œç»ˆç«¯ä¸è¾“å‡ºä»»ä½•æ—¥å¿—ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹ç‰¹å®šå®¹å™¨çš„æ—¥å¿—:</p><pre class="kg kh ki kj gt nq nr ns bn nt nu bi"><span id="dd4d" class="nv mh iq nr b be nw nx l ny nz">$ docker compose logs --follow &lt;container_name&gt;</span></pre><p id="4371" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ—¥å¿—æ˜¾ç¤ºå®¹å™¨çš„çŠ¶æ€ã€‚å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥å°† TimescaleDB ä¸ Adminer ä¸€èµ·ä½¿ç”¨ã€‚</p><p id="e8b0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ‚¨å¯ä»¥é€šè¿‡ä½äº localhost:8087 çš„ Adminer UI ç™»å½•ã€‚æ‚¨å¯ä»¥åœ¨ã€‚env æ–‡ä»¶(è§ä¸Šæ–‡)ã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/7f829b115f2dcceb4ded3e9f5c87c41d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j00Mk1IV19_IW6qDTiq9yA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">ç®¡ç†å‘˜â€”ç™»å½•èœå•</figcaption></figure><h1 id="ba2d" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">ğŸ¤“<strong class="ak">ä¾‹å­</strong> <strong class="ak">ç”¨ Python </strong></h1><p id="2d56" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">ä»¥ä¸‹è§£é‡ŠåŸºäºæ¥è‡ª TimescaleDB çš„<a class="ae kv" href="https://docs.timescale.com/timescaledb/latest/quick-start/python/" rel="noopener ugc nofollow" target="_blank">å¿«é€Ÿå…¥é—¨ Python ç¤ºä¾‹</a>ã€‚</p><h2 id="569d" class="nd mh iq bd mi ne nf dn mm ng nh dp mq lf ni nj ms lj nk nl mu ln nm nn mw no bi translated">è¿æ¥åˆ°æ•°æ®åº“</h2><p id="84b9" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">ä»¥ä¸‹ Python ä»£ç å»ºç«‹äº†ä¸æ•°æ®åº“çš„è¿æ¥ã€‚</p><pre class="kg kh ki kj gt nq nr ns bn nt nu bi"><span id="4b18" class="nv mh iq nr b be nw nx l ny nz">import psycopg2<br/><br/># Structure of the connection string: <br/># "postgres://username:password@host:port/dbname"<br/>CONNECTION = "postgres://timescale:timescaledb@localhost:5432/timescale_database"<br/>conn = psycopg2.connect(CONNECTION)</span></pre><h2 id="f046" class="nd mh iq bd mi ne nf dn mm ng nh dp mq lf ni nj ms lj nk nl mu ln nm nn mw no bi translated">åˆ›å»ºè¡¨æ ¼</h2><p id="fb85" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåä¸º<strong class="ky ir">ä¼ æ„Ÿå™¨</strong>å’Œåˆ—<em class="ob"> id </em>ã€<em class="ob">ç±»å‹</em>å’Œ<em class="ob">ä½ç½®</em>çš„å…³ç³»è¡¨ã€‚</p><pre class="kg kh ki kj gt nq nr ns bn nt nu bi"><span id="be76" class="nv mh iq nr b be nw nx l ny nz"># create relational table<br/>query_create_sensors_table = "CREATE TABLE sensors (id SERIAL PRIMARY KEY, type VARCHAR(50), location VARCHAR(50));"<br/><br/>cursor = conn.cursor()<br/>cursor.execute(query_create_sensors_table)<br/>conn.commit()<br/>cursor.close()</span></pre><p id="2a54" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘ä»¬è¿˜åˆ›å»ºäº†ä¸€ä¸ªåä¸º<strong class="ky ir"> sensor_data </strong>çš„è¶…è¡¨ã€‚è¯·æ³¨æ„ï¼Œè¶…è¡¨åŒ…å«å¼ºåˆ¶æ—¶é—´åˆ—ã€‚æ¥ä¸‹æ¥ï¼Œç”¨ SELECT è¯­å¥å°†è¡¨<strong class="ky ir"> sensor_data </strong>è½¬æ¢æˆè¶…è¡¨ã€‚æ³¨æ„ï¼Œæ‚¨éœ€è¦å°†è¶…è¡¨çš„è¡¨åå’Œæ—¶é—´åˆ—çš„åç§°æŒ‡å®šä¸ºä¸¤ä¸ªå‚æ•°ã€‚æœ€åï¼Œæ‚¨å¿…é¡»æäº¤æ‚¨çš„æ›´æ”¹å¹¶å…³é—­å…‰æ ‡ã€‚</p><pre class="kg kh ki kj gt nq nr ns bn nt nu bi"><span id="6330" class="nv mh iq nr b be nw nx l ny nz"># create sensor data hypertable<br/>query_create_sensordata_table = """CREATE TABLE sensor_data (<br/>                                        time TIMESTAMPTZ NOT NULL,<br/>                                        sensor_id INTEGER,<br/>                                        temperature DOUBLE PRECISION,<br/>                                        cpu DOUBLE PRECISION,<br/>                                        FOREIGN KEY (sensor_id) REFERENCES sensors (id)<br/>                                        );"""<br/><br/>query_create_sensordata_hypertable = "SELECT create_hypertable('sensor_data', 'time');"<br/><br/>cursor = conn.cursor()<br/>cursor.execute(query_create_sensordata_table)<br/>cursor.execute(query_create_sensordata_hypertable)<br/>conn.commit() # commit changes to the database to make changes persistent<br/>cursor.close()</span></pre><h2 id="ada2" class="nd mh iq bd mi ne nf dn mm ng nh dp mq lf ni nj ms lj nk nl mu ln nm nn mw no bi translated">æ’å…¥æ•°æ®</h2><p id="8bc0" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†åä¸º<strong class="ky ir"> <em class="ob">ä¼ æ„Ÿå™¨</em> </strong>çš„å…ƒç»„åˆ—è¡¨æ’å…¥åˆ°åä¸º<strong class="ky ir">ä¼ æ„Ÿå™¨</strong>çš„å…³ç³»è¡¨ä¸­ã€‚</p><pre class="kg kh ki kj gt nq nr ns bn nt nu bi"><span id="8ccb" class="nv mh iq nr b be nw nx l ny nz"> # insert rows into TimescaleDB<br/>SQL = "INSERT INTO sensors (type, location) VALUES (%s, %s);"<br/>sensors = [('a', 'floor'), ('a', 'ceiling'), ('b', 'floor'), ('b', 'ceiling')]<br/>cursor = conn.cursor()<br/>for sensor in sensors:<br/>    try:<br/>        data = (sensor[0], sensor[1])<br/>        cursor.execute(SQL, data)<br/>    except (Exception, psycopg2.Error) as error:<br/>        print(error.pgerror)<br/>conn.commit()</span></pre><p id="71a0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä½¿ç”¨ psycopg2 å°±è¶³ä»¥å°†è¡Œæ’å…¥åˆ°è¶…è¡¨ä¸­ã€‚ç„¶è€Œï¼Œä¸ºäº†æ›´å¿«çš„æ€§èƒ½ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†<em class="ob"> pgcopy </em>ã€‚ä¸ºæ­¤ï¼Œå®‰è£…å¸¦æœ‰ pip çš„ pgcopyï¼Œå¹¶å°†å…¶ä½œä¸ºå¯¼å…¥æŒ‡ä»¤æ·»åŠ ã€‚</p><pre class="kg kh ki kj gt nq nr ns bn nt nu bi"><span id="d95f" class="nv mh iq nr b be nw nx l ny nz"># install pgcopy<br/>pip install pgcopy</span></pre><p id="9d91" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å°†æ—¶é—´åºåˆ—æ•°æ®æ’å…¥åˆ°è¶…è¡¨ä¸­ã€‚</p><pre class="kg kh ki kj gt nq nr ns bn nt nu bi"><span id="f549" class="nv mh iq nr b be nw nx l ny nz"><br/>from pgcopy import CopyManager<br/><br/>cursor = conn.cursor()<br/><br/># for sensors with ids 1-4<br/>for id in range(1, 4, 1):<br/>    data = (id,)<br/>    # create random data<br/>    simulate_query = """SELECT generate_series(now() - interval '24 hour', now(), interval '5 minute') AS time,<br/>                       %s as sensor_id,<br/>                       random()*100 AS temperature,<br/>                       random() AS cpu<br/>                    """<br/>    cursor.execute(simulate_query, data)<br/>    values = cursor.fetchall()<br/><br/>    # column names of the table you're inserting into<br/>    cols = ['time', 'sensor_id', 'temperature', 'cpu']<br/><br/>    # create copy manager with the target table and insert<br/>    mgr = CopyManager(conn, 'sensor_data', cols)<br/>    mgr.copy(values)<br/><br/># commit after all sensor data is inserted<br/># could also commit after each sensor insert is done<br/>conn.commit()</span></pre><p id="b1dd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æœ€åï¼Œæˆ‘ä»¬æ£€æŸ¥ç®¡ç†å‘˜æ˜¯å¦ä¸€åˆ‡æ­£å¸¸ã€‚åœ¨ç¬¬ä¸€ä¸ªæˆªå›¾ä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°æ·»åŠ äº†æ•°æ®çš„<strong class="ky ir">ä¼ æ„Ÿå™¨</strong>è¡¨ã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/2ee4c66aa110bca4d0d226d201253898.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ATd-3DgoSidY90YEYfooOA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">ç®¡ç†å‘˜-ä¼ æ„Ÿå™¨è¡¨</figcaption></figure><p id="ae1d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç¬¬äºŒä¸ªæˆªå›¾æ˜¾ç¤ºäº†æ·»åŠ äº†æ—¶é—´åºåˆ—æ•°æ®çš„<strong class="ky ir"> sensor_data </strong> hypertableã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/af6e03a85dd046cbec44a54ac30b5bd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LxWu4VOL7nT5_UgBSzjUMQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">ç®¡ç†å‘˜â€”ä¼ æ„Ÿå™¨æ•°æ®è¶…è¡¨</figcaption></figure><h1 id="454b" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">ğŸ¬ç»“è®º</h1><p id="df58" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†å¦‚ä½•ç”¨ TimescaleDB å’Œ Adminer è®¾ç½® Docker å †æ ˆã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•è¿æ¥åˆ°æ—¶é—´åºåˆ—æ•°æ®åº“ä»¥åŠå¦‚ä½•æ’å…¥æ—¶é—´åºåˆ—æ•°æ®ã€‚TimescaleDB çš„ä¼˜ç‚¹æ˜¯å¯ä»¥ä¸ºå…³ç³»æ•°æ®å’Œæ—¶é—´åºåˆ—æ•°æ®åˆ›å»ºè¡¨ã€‚</p></div><div class="ab cl oe of hu og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="ij ik il im in"><p id="6bce" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« å—ï¼Ÿæˆä¸º<a class="ae kv" href="https://tinztwins.medium.com/membership" rel="noopener">ä¸­ç­‰ä¼šå‘˜</a>ç»§ç»­æ— é™å­¦ä¹ ã€‚å½“æ‚¨ä½¿ç”¨è¯¥é“¾æ¥æ—¶ï¼Œæˆ‘ä»¬å°†æ”¶å–ä¸€å°éƒ¨åˆ†ä¼šå‘˜è´¹ã€‚æ‚¨æ— éœ€æ”¯ä»˜é¢å¤–è´¹ç”¨ã€‚</p><p id="2972" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">ä¸è¦é”™è¿‡æˆ‘ä»¬æ¥ä¸‹æ¥çš„æ•…äº‹:</strong></p><div class="ol om gp gr on oo"><a href="https://tinztwins.medium.com/subscribe" rel="noopener follow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd ir gy z fp ot fr fs ou fu fw ip bi translated">æ¯å½“ Tinz Twins å‘å¸ƒæ—¶æ”¶åˆ°ä¸€å°ç”µå­é‚®ä»¶ã€‚</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">æ¯å½“ Tinz Twins å‘å¸ƒæ—¶æ”¶åˆ°ä¸€å°ç”µå­é‚®ä»¶ã€‚æ³¨å†Œåï¼Œå¦‚æœæ‚¨è¿˜æ²¡æœ‰ï¼Œæ‚¨å°†åˆ›å»ºä¸€ä¸ªä¸­å‹å¸æˆ·â€¦</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">tinztwins.medium.com</p></div></div><div class="ox l"><div class="oy l oz pa pb ox pc kp oo"/></div></div></a></div><p id="cf8f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">éå¸¸æ„Ÿè°¢ä½ çš„é˜…è¯»ã€‚å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·éšæ„åˆ†äº«ã€‚å…³æ³¨æˆ‘ä»¬äº†è§£æ›´å¤šå†…å®¹ã€‚ç¥ä½ ä»Šå¤©è¿‡å¾—æ„‰å¿«ï¼</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pd"><img src="../Images/1924008e75e30f4baed4775b04724600.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mlzonw5462Puvm28fvAnfg.png"/></div></div></figure><h1 id="96b9" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">ğŸ”æœ‰ç”¨çš„é“¾æ¥</h1><ul class=""><li id="e442" class="ls lt iq ky b kz my lc mz lf pe lj pf ln pg lr np ly lz ma bi translated"><a class="ae kv" href="https://docs.timescale.com/timescaledb/latest/overview/" rel="noopener ugc nofollow" target="_blank">æ–‡æ¡£æ—¶é—´è¡¨ B </a></li><li id="9445" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr np ly lz ma bi translated"><a class="ae kv" href="https://docs.timescale.com/timescaledb/latest/quick-start/python/" rel="noopener ugc nofollow" target="_blank">å¿«é€Ÿå…¥é—¨:Python å’Œ TimescaleDB </a></li><li id="758d" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr np ly lz ma bi translated">ç®¡ç†å‘˜</li></ul></div></div>    
</body>
</html>