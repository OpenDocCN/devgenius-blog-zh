<html>
<head>
<title>Effective Java! Use Varargs Judiously</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">有效的Java！谨慎使用变量</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/effective-java-use-varargs-judiously-d1bd824aa650?source=collection_archive---------4-----------------------#2021-06-18">https://blog.devgenius.io/effective-java-use-varargs-judiously-d1bd824aa650?source=collection_archive---------4-----------------------#2021-06-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="b22d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">varargs参数是Java的一个语法糖特性，它允许您定义一个参数，该参数允许调用者提供零个或多个已定义类型的参数。在接收函数中，这些值作为指定类型的数组提供。</p><p id="5267" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们看一个简单的例子:</p><pre class="kl km kn ko gt kp kq kr ks aw kt bi"><span id="da91" class="ku kv iq kq b gy kw kx l ky kz">static int sum(int... args) {<br/>  int sum = 0;<br/>  for (int arg : args) {<br/>    sum += arg;<br/>  }<br/>  return sum;<br/>}</span></pre><p id="8241" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种方法可以叫做像<code class="fe la lb lc kq b">sum(1,2)</code>当然会产生<code class="fe la lb lc kq b">3</code>或者<code class="fe la lb lc kq b">sum(1,2,3)</code>当然会产生<code class="fe la lb lc kq b">6</code>甚至<code class="fe la lb lc kq b">sum()</code>会产生<code class="fe la lb lc kq b">0</code>。</p><p id="37b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种能力非常有用，但是在使用varags时会出现一些问题。让我们考虑其中的一些，以及我们如何克服挑战。</p><p id="dc12" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有时，您可能希望接受最少数量的参数。如上所述，varags本身允许传入0到n个参数。我们可以考虑在运行时检查数组的大小。虽然这样做可行，但它的缺点是错误是在运行时而不是编译时被发现的。这种解决方案也可能是丑陋的，并且妨碍了真正的逻辑。尽管有更好的方法。考虑一下我们是否想最少用一个论点。解决这个问题的方法是给我们的方法两个参数。一个只是类型，第二个是vararg参数。这将迫使调用者在编译时至少提供一个参数。看起来可能是这样的:</p><pre class="kl km kn ko gt kp kq kr ks aw kt bi"><span id="fe45" class="ku kv iq kq b gy kw kx l ky kz">static int min(int firstValue, int... restOfValues) {<br/>  int currentMin = firstValue;<br/>  for (int value : restOfValues) {<br/>    if ( value &lt; currentMin) {<br/>      currentMin = value;<br/>    }</span><span id="e39c" class="ku kv iq kq b gy ld kx l ky kz">  }<br/>  return currentMin;<br/>}</span></pre><p id="f308" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用vararg参数的另一个潜在缺陷是在性能关键的应用程序中。这是因为每个方法调用都需要创建一个数组。如果这发生在循环中，这可能会产生可避免的内存压力，从而损害应用程序的性能。一种可能的缓解策略是，例如，如果95%的函数调用方包含3个或更少的参数，您可以创建三个函数，分别使用1、2和3个参数类型的参数来处理95%的调用方，第四个函数使用三个参数和一个vararg参数来处理剩下的5%的调用方。这就是<code class="fe la lb lc kq b">EnumSet</code>对象帮助它保持良好性能的原因。很多时候这种优化是不合适的，但是在这种情况下，它可以是救命稻草。</p><p id="302b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">总之，作为Java语言的一部分，varargs参数是一个有用的特性。和所有的特性一样，这个特性也有一些粗糙的地方，我们应该注意。然而，当我们牢记这些事情时，我们可以对代码做一些很大的改进。</p></div></div>    
</body>
</html>