<html>
<head>
<title>Microservices Design - API Gateway Pattern</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">微服务设计- API 网关模式</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/microservices-design-api-gateway-pattern-980e8d02bdd5?source=collection_archive---------0-----------------------#2020-07-04">https://blog.devgenius.io/microservices-design-api-gateway-pattern-980e8d02bdd5?source=collection_archive---------0-----------------------#2020-07-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/dd1b74fed09ba6b13bbb85afdb894b9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IlIZ5M7-ij-FcVtax0eVlQ.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">通往尼泊尔 Ghorepani Poonhill 的门户(来源:<a class="ae kc" href="https://www.wikipedia.org/" rel="noopener ugc nofollow" target="_blank">维基百科</a></figcaption></figure><p id="d942" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">根据 Gartner 的定义:<strong class="kf ir"> <em class="lb">“微服务是一个紧密作用域、强封装、松耦合、可独立部署、可独立扩展的应用组件</em> </strong> <em class="lb">。”</em></p><p id="e237" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">微服务的目标是将应用程序充分分解/解耦为松散耦合的微服务/模块，这与模块高度耦合并作为单个大块部署的整体应用程序形成对比。由于以下原因，这将是有帮助的:</p><ul class=""><li id="6c9e" class="lc ld iq kf b kg kh kk kl ko le ks lf kw lg la lh li lj lk bi translated">每个微服务都可以独立于应用程序中的兄弟服务进行部署、升级、扩展、维护和重启。</li><li id="4fe0" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated">敏捷开发&amp;由自治的跨职能团队进行敏捷部署。</li><li id="de54" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated">使用技术的灵活性和可扩展性。</li></ul><p id="45cc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">不同的松散耦合服务基于它们自己的特定需求进行部署，其中每个服务都有其细粒度的 API 模型来服务不同的客户端(Web、移动和第三方 API)。</p><h2 id="ca17" class="lq lr iq bd ls lt lu dn lv lw lx dp ly ko lz ma mb ks mc md me kw mf mg mh mi bi translated">客户端到微服务的连接</h2><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mj"><img src="../Images/26a1e1c708fab0e3e35b0c7fe469976e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qjKOOT85ESeznHyZCd_UWA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">图微服务中的通信</figcaption></figure><p id="55df" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在考虑客户端<strong class="kf ir">直接与每个部署的微服务</strong>通信时，应考虑以下挑战:</p><ol class=""><li id="44d4" class="lc ld iq kf b kg kh kk kl ko le ks lf kw lg la mo li lj lk bi translated">在微服务向客户端公开细粒度 API 的情况下，客户端应该向每个微服务发出请求。在典型的单个页面中，可能需要<strong class="kf ir">多个服务器往返</strong>才能完成请求。这对于诸如移动设备的低网络操作设备来说可能更糟。</li><li id="77ae" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la mo li lj lk bi translated"><strong class="kf ir">微服务中存在的多种通信协议(</strong>如 gRpc、thrift、REST、AMQP e.t.c <strong class="kf ir"> ) </strong>使得客户端采用所有这些协议具有挑战性且庞大。</li><li id="e3f4" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la mo li lj lk bi translated"><strong class="kf ir">公共网关功能</strong>(如认证、授权、登录)必须在每个微服务中实现。</li><li id="b158" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la mo li lj lk bi translated">在不中断客户端连接的情况下，很难对微服务做出改变。例如，在合并或划分微服务时，可能需要重新编码客户端部分。</li></ol><h1 id="f4a2" class="mp lr iq bd ls mq mr ms lv mt mu mv ly mw mx my mb mz na nb me nc nd ne mh nf bi translated">API 网关</h1><p id="c623" class="pw-post-body-paragraph kd ke iq kf b kg ng ki kj kk nh km kn ko ni kq kr ks nj ku kv kw nk ky kz la ij bi translated">为了应对上述挑战，在客户端和服务器之间引入了一个附加层，作为从客户端到服务器的反向代理路由请求。类似于面向对象设计的外观模式，它提供了封装底层系统架构的 API 的单一入口点，称为 API Gateway。</p><p id="928b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">简而言之，它的行为与 API 管理完全一样，但重要的是不要将<a class="ae kc" href="https://www.getambassador.io/docs/latest/topics/concepts/microservices-api-gateways/" rel="noopener ugc nofollow" target="_blank"> API 管理与 API 网关</a>混淆。</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/dc17e2b238eeb4c59b1fd701673507dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0vZX_beYLJJt7TQ4jYoDEg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">图微服务 API 网关</figcaption></figure><h1 id="e2c1" class="mp lr iq bd ls mq mr ms lv mt mu mv ly mw mx my mb mz na nb me nc nd ne mh nf bi translated">API 网关的功能:</h1><h2 id="2cdc" class="lq lr iq bd ls lt lu dn lv lw lx dp ly ko lz ma mb ks mc md me kw mf mg mh mi bi translated">按指定路线发送</h2><p id="7bf4" class="pw-post-body-paragraph kd ke iq kf b kg ng ki kj kk nh km kn ko ni kq kr ks nj ku kv kw nk ky kz la ij bi translated">该网关封装了底层系统并与客户端分离，为客户端提供了与微服务系统通信的单一入口点。</p><h2 id="b8df" class="lq lr iq bd ls lt lu dn lv lw lx dp ly ko lz ma mb ks mc md me kw mf mg mh mi bi translated">卸下</h2><p id="7c30" class="pw-post-body-paragraph kd ke iq kf b kg ng ki kj kk nh km kn ko ni kq kr ks nj ku kv kw nk ky kz la ij bi translated">API gateway 整合了边缘功能，而不是让每个微服务都实现它们。一些功能包括:</p><ul class=""><li id="3fac" class="lc ld iq kf b kg kh kk kl ko le ks lf kw lg la lh li lj lk bi translated">认证和授权</li><li id="f1cb" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated">服务发现集成</li><li id="617a" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated">响应缓存</li><li id="5d71" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated">重试策略、断路器和 QoS</li><li id="63fb" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated">速率限制和节流</li><li id="d14f" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated">负载平衡</li><li id="815e" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated">日志记录、跟踪、关联</li><li id="3cc0" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated">标题、查询字符串和声明转换</li><li id="fd77" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated">IP 白名单</li><li id="2559" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated">InternationalAssociationofMachinists 国际机械师协会</li><li id="6fa1" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated">集中式日志记录(跨服务器的事务 ID、错误日志记录)</li><li id="5f49" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated">身份提供者、认证和授权</li></ul><h1 id="ecff" class="mp lr iq bd ls mq mr ms lv mt mu mv ly mw mx my mb mz na nb me nc nd ne mh nf bi translated">后端对前端(BFF)模式</h1><p id="7b81" class="pw-post-body-paragraph kd ke iq kf b kg ng ki kj kk nh km kn ko ni kq kr ks nj ku kv kw nk ky kz la ij bi translated">它是 API 网关模式的<strong class="kf ir">变体。它不是客户端的单一入口点，而是基于客户端提供多个网关。目的是根据客户的需求提供定制的 API，消除为所有客户制作通用 API 造成的大量臃肿。</strong></p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/288adfce823834e181f3ce81d52efed8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JTjhbxRxevEfnt4eExWTVw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">图前端(BFF)模式的后端</figcaption></figure><h2 id="0f54" class="lq lr iq bd ls lt lu dn lv lw lx dp ly ko lz ma mb ks mc md me kw mf mg mh mi bi translated">你需要多少个闺蜜？</h2><p id="79ba" class="pw-post-body-paragraph kd ke iq kf b kg ng ki kj kk nh km kn ko ni kq kr ks nj ku kv kw nk ky kz la ij bi translated">BFF 的基本概念是为每个用户体验开发合适的后端。菲尔·卡尔卡多的指导方针是“<strong class="kf ir">一次经历，一个最好的朋友</strong>”。如果客户端(IOS 客户端、android 客户端、web 浏览器等)的需求差异很大，并且单个代理或 API 的上市时间出现问题，BFF 是一个很好的解决方案。还应注意，更复杂的设计需要复杂的设置。</p><h1 id="9ecf" class="mp lr iq bd ls mq mr ms lv mt mu mv ly mw mx my mb mz na nb me nc nd ne mh nf bi translated">GraphQL 和 BFF</h1><p id="0860" class="pw-post-body-paragraph kd ke iq kf b kg ng ki kj kk nh km kn ko ni kq kr ks nj ku kv kw nk ky kz la ij bi translated">GraphQL 是一种用于 API 的查询语言。<a class="ae kc" href="https://philcalcado.com/" rel="noopener ugc nofollow" target="_blank">Phil calado</a>在这篇<a class="ae kc" href="https://philcalcado.com/2019/07/12/some_thoughts_graphql_bff.html" rel="noopener ugc nofollow" target="_blank">文章</a>中提出，BFF 和 GraphQL 是相关但不互斥的概念。他补充说，BFF 不是关于端点的形状，而是关于给你的客户端应用程序自主权，在这种情况下，你可以构建尽可能多的 BFF 或 OSFA(一种尺寸适合所有人)API。</p><h1 id="cc96" class="mp lr iq bd ls mq mr ms lv mt mu mv ly mw mx my mb mz na nb me nc nd ne mh nf bi translated">著名的 API 网关</h1><h2 id="47bf" class="lq lr iq bd ls lt lu dn lv lw lx dp ly ko lz ma mb ks mc md me kw mf mg mh mi bi translated">网飞 API 网关:<a class="ae kc" href="https://github.com/Netflix/zuul" rel="noopener ugc nofollow" target="_blank"> Zuul </a></h2><p id="a310" class="pw-post-body-paragraph kd ke iq kf b kg ng ki kj kk nh km kn ko ni kq kr ks nj ku kv kw nk ky kz la ij bi translated">在超过 1000 种不同设备类型(电视、机顶盒、智能手机、游戏系统、平板电脑等)上可用的<a class="ae kc" href="https://netflixtechblog.com/embracing-the-differences-inside-the-netflix-api-redesign-15fd8b3dc49d" rel="noopener ugc nofollow" target="_blank">网飞</a>流媒体服务在高峰时段每秒处理 50，000 个请求，发现 OSFA(一刀切)REST API 方法的实质性限制，并使用了为每个设备量身定制的 API 网关。</p><p id="5f23" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">网飞的 Zuul 2 是所有请求进入网飞云基础设施的大门。Zuul 2 显著改进了架构和功能，使我们的网关能够处理、路由和保护网飞的云系统，并帮助我们的 1.25 亿会员提供最佳体验。</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/258dee40a2f7f4a3d296871e1510b983.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9IBt7heCiWdHl5o78VeFVA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">图 https://netflixtechblog.com 云架构中的 Zuul(图片来源:<a class="ae kc" href="https://netflixtechblog.com/" rel="noopener ugc nofollow" target="_blank"/>)</figcaption></figure><h2 id="9a96" class="lq lr iq bd ls lt lu dn lv lw lx dp ly ko lz ma mb ks mc md me kw mf mg mh mi bi translated">亚马逊 API 网关</h2><p id="f084" class="pw-post-body-paragraph kd ke iq kf b kg ng ki kj kk nh km kn ko ni kq kr ks nj ku kv kw nk ky kz la ij bi translated">AWS 为创建、发布、维护、监控和保护 REST、HTTP 和 WebSocket 提供完全托管的服务，开发人员可以在其中创建访问 AWS 或其他 web 服务的 API，以及存储在<a class="ae kc" href="https://aws.amazon.com/what-is-cloud-computing/" rel="noopener ugc nofollow" target="_blank"> AWS Cloud </a>中的数据。</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/5bbc5467251c4b04e4ede781e3e8bc84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ANufset6xld70D1W"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">图 AWS API 网关</figcaption></figure><h2 id="ae03" class="lq lr iq bd ls lt lu dn lv lw lx dp ly ko lz ma mb ks mc md me kw mf mg mh mi bi translated">Kong API 网关</h2><p id="0fed" class="pw-post-body-paragraph kd ke iq kf b kg ng ki kj kk nh km kn ko ni kq kr ks nj ku kv kw nk ky kz la ij bi translated">Kong Gateway 是一款针对微服务优化的开源轻量级 API 网关，提供无与伦比的延迟性能和可扩展性。如果你只是想要基本的，这个选项将为你工作。通过添加更多节点，它可以轻松地进行水平扩展。它以极低的延迟支持大量的可变工作负载。</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi no"><img src="../Images/b676824deadb2c22463008bd875c4b8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZPmJJWsxTsrP3-Yf"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">图 1 .香港应用编程接口网关</figcaption></figure><h2 id="fa42" class="lq lr iq bd ls lt lu dn lv lw lx dp ly ko lz ma mb ks mc md me kw mf mg mh mi bi translated">其他 API 网关</h2><ul class=""><li id="dd9f" class="lc ld iq kf b kg ng kk nh ko np ks nq kw nr la lh li lj lk bi translated"><a class="ae kc" href="https://apigee.com/api-management/" rel="noopener ugc nofollow" target="_blank">API 网关</a></li><li id="ecb3" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated"><a class="ae kc" href="https://www.mulesoft.com/platform/api-management" rel="noopener ugc nofollow" target="_blank"> MuleSoft </a></li><li id="29e3" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated"><a class="ae kc" href="https://github.com/TykTechnologies/tyk" rel="noopener ugc nofollow" target="_blank"> Tyk.io </a></li><li id="1b1c" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated"><a class="ae kc" href="https://www.akana.com/products/api-platform/api-gateway" rel="noopener ugc nofollow" target="_blank">阿卡纳</a></li><li id="3afe" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated"><a class="ae kc" href="https://swagger.io/tools/swaggerhub/" rel="noopener ugc nofollow" target="_blank"> SwaggerHub </a></li><li id="a1a5" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated"><a class="ae kc" href="https://azure.microsoft.com/en-us/services/api-management/" rel="noopener ugc nofollow" target="_blank"> Azure API 网关</a></li><li id="cf98" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated"><a class="ae kc" href="https://www.express-gateway.io/" rel="noopener ugc nofollow" target="_blank"> Express API 网关</a></li><li id="7816" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated"><a class="ae kc" href="https://www.krakend.io/" rel="noopener ugc nofollow" target="_blank">卡肯维</a></li></ul><h2 id="c2a6" class="lq lr iq bd ls lt lu dn lv lw lx dp ly ko lz ma mb ks mc md me kw mf mg mh mi bi translated">选择正确的 API 网关</h2><p id="0630" class="pw-post-body-paragraph kd ke iq kf b kg ng ki kj kk nh km kn ko ni kq kr ks nj ku kv kw nk ky kz la ij bi translated">评估标准的一些常见基线包括简单性、开源与专有、可扩展性和灵活性、安全性、功能、社区、管理(支持、监控和部署)、环境供应(安装、配置、托管服务)、定价和文档。</p><h1 id="bc64" class="mp lr iq bd ls mq mr ms lv mt mu mv ly mw mx my mb mz na nb me nc nd ne mh nf bi translated">API 组合/聚合</h1><p id="660b" class="pw-post-body-paragraph kd ke iq kf b kg ng ki kj kk nh km kn ko ni kq kr ks nj ku kv kw nk ky kz la ij bi translated">API Gateway 中的一些 API 请求直接映射到单个服务 API，可以通过将请求路由到相应的微服务来提供服务。然而，在需要来自几个微服务的结果的复杂 API 操作的情况下，可以由<strong class="kf ir"> API 组合/聚合</strong>(一种<strong class="kf ir"> </strong>分散-聚集机制)来服务。在需要同步通信的情况下，如果一个服务依赖另一个服务，则必须遵循链式组合模式。组合层必须支持 ESB/集成功能的重要部分，例如转换、编排、弹性和稳定性模式。</p><p id="64a9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">根容器部署有特殊的分发器和聚合器功能(或微服务)。分配器负责分解成粒度任务，并将这些任务分配给微服务实例。聚合器负责聚合业务工作流从组合的微服务中获得的结果。</p><h2 id="80c1" class="lq lr iq bd ls lt lu dn lv lw lx dp ly ko lz ma mb ks mc md me kw mf mg mh mi bi translated">API 网关和聚合</h2><p id="de84" class="pw-post-body-paragraph kd ke iq kf b kg ng ki kj kk nh km kn ko ni kq kr ks nj ku kv kw nk ky kz la ij bi translated">具有附加特性的 API 网关导致了过于雄心勃勃的网关，这鼓励了继续难以测试和部署的设计。强烈建议避免在 API 网关中进行聚合和数据转换。领域智能更适合在遵循定义的软件开发实践的应用程序代码中完成。网飞 API Gateway，<a class="ae kc" href="https://github.com/netflix/zuul/" rel="noopener ugc nofollow" target="_blank"> Zuul 2 </a>从他们在 Zuul 的 Gateway 到 origin 系统中移除了很多业务逻辑。更多详情，请参考<a class="ae kc" href="https://www.infoq.com/news/2016/10/netflix-zuul-asynch-nonblocking/" rel="noopener ugc nofollow" target="_blank">此处</a>。</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ns"><img src="../Images/5e543075d04175dc4313d20d92e0bf5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9ktQNGUHWX6XaiVM3kHDyA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">图:分层微服务中的复合/集成服务</figcaption></figure><h1 id="ae78" class="mp lr iq bd ls mq mr ms lv mt mu mv ly mw mx my mb mz na nb me nc nd ne mh nf bi translated">服务网格和 API 网关</h1><p id="8b4a" class="pw-post-body-paragraph kd ke iq kf b kg ng ki kj kk nh km kn ko ni kq kr ks nj ku kv kw nk ky kz la ij bi translated">微服务中的服务网格是处理进程间通信的可配置网络基础设施层。这类似于通常所说的边车代理或边车网关。它提供了许多功能，例如:</p><ul class=""><li id="9646" class="lc ld iq kf b kg kh kk kl ko le ks lf kw lg la lh li lj lk bi translated">负载平衡</li><li id="085e" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated">服务发现</li><li id="d93e" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated">健康检查</li><li id="b237" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated">安全性</li></ul><p id="2648" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从表面上看，似乎 API 网关和服务网格解决了相同的问题，因此是多余的。它们确实解决了相同的问题，但在不同的背景下。 API gateway 部署为业务解决方案的一部分，可被处理南北向流量的外部客户端发现(面向外部客户端)，但是，服务网格处理东西向流量(在不同的微服务之间)。</p><p id="dbb0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">实现服务网格避免了弹性通信模式，如断路器、发现、健康检查、您自己代码中的服务可观察性。对于少量的微服务，应该考虑故障管理的替代策略，因为服务网格集成可能会弄巧成拙。对于数量更多的微服务来说，将是有益的。</p><p id="4e46" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">结合这两种技术是确保应用程序正常运行时间和弹性的强大方法，同时确保您的应用程序易于使用。将两者视为同时代可能不是一个好主意，在涉及微服务和 API 的部署中，最好将两者视为互补。</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ns"><img src="../Images/5047d364f241283373ef794a8d5ffee9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t1_sflyFisbrDYsbzSJq_g.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">图带有服务网格的分层微服务</figcaption></figure><h2 id="1783" class="lq lr iq bd ls lt lu dn lv lw lx dp ly ko lz ma mb ks mc md me kw mf mg mh mi bi translated">API 网关实现的注意事项:</h2><ul class=""><li id="b4a7" class="lc ld iq kf b kg ng kk nh ko np ks nq kw nr la lh li lj lk bi translated">可能的单点故障或瓶颈。</li><li id="61df" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la lh li lj lk bi translated">由于通过 API 网关的额外网络跳跃和复杂性风险，响应时间增加。</li></ul><h2 id="9ef8" class="lq lr iq bd ls lt lu dn lv lw lx dp ly ko lz ma mb ks mc md me kw mf mg mh mi bi translated">参考资料:</h2><ol class=""><li id="b976" class="lc ld iq kf b kg ng kk nh ko np ks nq kw nr la mo li lj lk bi translated"><a class="ae kc" href="https://microservices.io/index.html" rel="noopener ugc nofollow" target="_blank">https://microservices.io/index.html</a></li><li id="5ebf" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la mo li lj lk bi translated">https://docs.microsoft.com/en-us/azure/architecture/<a class="ae kc" href="https://docs.microsoft.com/en-us/azure/architecture/" rel="noopener ugc nofollow" target="_blank"/></li><li id="8d73" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la mo li lj lk bi translated"><a class="ae kc" href="https://github.com/wso2/reference-architecture/blob/master/api-driven-microservice-architecture.md" rel="noopener ugc nofollow" target="_blank">https://github . com/wso2/reference-architecture/blob/master/API-driven-microservice-architecture . MD</a></li><li id="71da" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la mo li lj lk bi translated"><a class="ae kc" href="https://tsh.io/blog/design-patterns-in-microservices-api-gateway-bff-and-more/" rel="noopener ugc nofollow" target="_blank">https://TSH . io/blog/design-patterns-in-micro services-API-gateway-BFF-and-more/</a></li><li id="118c" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la mo li lj lk bi translated"><a class="ae kc" href="https://www.infoq.com/articles/service-mesh-ultimate-guide/" rel="noopener ugc nofollow" target="_blank">https://www.infoq.com/articles/service-mesh-ultimate-guide/</a></li><li id="5af0" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la mo li lj lk bi translated"><a class="ae kc" href="https://samnewman.io/patterns/architectural/bff/" rel="noopener ugc nofollow" target="_blank">https://samnewman.io/patterns/architectural/bff/</a></li><li id="5c7b" class="lc ld iq kf b kg ll kk lm ko ln ks lo kw lp la mo li lj lk bi translated"><a class="ae kc" href="https://netflixtechblog.com/" rel="noopener ugc nofollow" target="_blank">https://netflixtechblog.com/</a></li></ol></div></div>    
</body>
</html>