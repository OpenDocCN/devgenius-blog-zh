<html>
<head>
<title>How to run NextJS application on Azure</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在 Azure 上运行 NextJS 应用程序</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-run-nextjs-application-on-azure-3e2716d3b831?source=collection_archive---------1-----------------------#2021-03-18">https://blog.devgenius.io/how-to-run-nextjs-application-on-azure-3e2716d3b831?source=collection_archive---------1-----------------------#2021-03-18</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="12ee" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">上个月，我面临了在 Azure web 应用上运行 NextJS 的挑战。</p><p id="76be" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">正如我在之前的一篇博客中提到的，Azure 是一款优秀的“软件”，但是当你在安装你的“不”的路上时，你可能会经历大量的错误。NET 应用程序。</p><p id="f215" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">希望下面的教程能帮助你避免我的一些错误。</p><p id="cf53" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">开始之前，有两件事需要考虑:</p><p id="9b0e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">1)<strong class="jm io">Vercel</strong>(NextJS 的创造者)强烈推荐使用自己的主机。这是可以理解的，因为为 NextJS 提供主机服务可能是他们的主要盈利模式。但这也意味着他们的文档没有关注其他云提供商。</p><p id="cdbc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">2)第二个问题是缺乏关于<strong class="jm io"> Azure </strong>的文档。微软没有关于在 Azure 上安装 NextJs 的真正伟大的教程——我可以想象为什么。这实际上不是他们的责任。他们只是提供托管和更复杂的服务。到目前为止，支持 NextJS(和其他 Javascript 框架)还不是他们的主要目标。</p><p id="aebf" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">嗯，我需要全力以赴才能成功。我没有找到任何工作或最新的教程。所以，我想出了以下计划:</p><p id="5728" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">1)使用 Linux Web 应用程序</p><p id="f157" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">2)利用目录“site”在启动时保持与 docker 容器连接的事实。这很重要，因为这意味着您只需手动安装一次 NextJS 服务器包。</p><p id="06d6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">3)然后，我们被允许部署一个构建的应用程序(路径中的所有东西。接下来除了文件夹"<em class="ki">缓存</em>"。</p><p id="9ffe" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">主要的好处是您将<strong class="jm io">加速</strong>部署并获得一个简化的持续集成管道。您不必每次都应付“<em class="ki"> npm 安装/纱线</em>”。</p><p id="a32e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们看看如何设置它。我假设您已经在 Azure 中创建了一个新的 Linux Web 应用程序。</p><ol class=""><li id="154e" class="kj kk in jm b jn jo jr js jv kl jz km kd kn kh ko kp kq kr bi translated">在 Azure portal 中，创建 FTP 凭据</li></ol><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ks"><img src="../Images/ae2edee29393f07c27f8b71b92416776.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HLivfQi3KKhTMe-F5sEnUQ.png"/></div></div></figure><p id="052e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">2.连接到 FTP 服务器，用 NextJS 应用程序上传一个文件“package.json”。</p><p id="322d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">3.然后打开 SSH</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi le"><img src="../Images/d61f12c616447cdfa23f62a785c3ed3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Oj7g6V2q2mA5WGu_j3essw.png"/></div></div></figure><p id="b50c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">4.在那里，运行 npm install in site 或您喜欢的任何软件包管理器。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi lf"><img src="../Images/c7b7302c8d47b954a01273e087729b81.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*5E_CUF15NU5y1J26KQVVog.png"/></div></figure><p id="23cf" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="ki">注意</em>:令人惊讶的是，我不得不重复这个步骤几次，因为 SSH 偶尔会在没有任何警告的情况下断开连接。正如你所想象的，真的很令人沮丧。</p><p id="fdb1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">5.之后，上传您构建的应用程序(通常只有“.下一个“文件夹”)</p><p id="c043" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">6.将“网站端口”设置为运行应用程序的端口。在较旧的教程中，您可能会看到一个名为“PORT”的设置，它的工作原理是一样的，但该设置已被弃用，并且它不被授予在未来将会工作的权限。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi lg"><img src="../Images/b87251d7deb2a1e9634dbeed020ce4de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tRKwm4B_NAfoZF1lBJCE-g.png"/></div></div></figure><p id="8405" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">x)持续集成(CI)</p><p id="b981" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">CI 是罪魁祸首。我决定推迟在下一篇文章中阐述这个话题。这是一个可怕的经历，这就是为什么它绝对值得自己的职位:)。</p><p id="d250" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">附加说明或建议:</strong></p><ul class=""><li id="f708" class="kj kk in jm b jn jo jr js jv kl jz km kd kn kh lh kp kq kr bi translated">耐心点。有时重启应用程序似乎不起作用。</li><li id="e7a5" class="kj kk in jm b jn li jr lj jv lk jz ll kd lm kh lh kp kq kr bi translated">到 SSH 终端的连接经常丢失。我不得不在它结束之前运行几次纱线。</li><li id="9d36" class="kj kk in jm b jn li jr lj jv lk jz ll kd lm kh lh kp kq kr bi translated">日志流——我真的不明白为什么日志消息有时会随机排序，而不是按照它们创建的时间来显示。所以不要被创建日期迷惑。</li><li id="6f94" class="kj kk in jm b jn li jr lj jv lk jz ll kd lm kh lh kp kq kr bi translated">此外，您可能会遇到错误:<br/><em class="ki">“yarn-metadata . JSON:JSON 输入意外结束”<br/> </em>要修复它，只需运行:“纱线缓存干净”</li><li id="0862" class="kj kk in jm b jn li jr lj jv lk jz ll kd lm kh lh kp kq kr bi translated">来自 yarn 的一条臭名昭著的消息:<br/> <em class="ki">“你的网络连接似乎有问题。正在重试…" <br/> </em>您可以延长 yarn 的超时时间，因此要消除该消息，请像这样调用 yarn install:<br/><em class="ki">yarn install—network-time out 1000000</em></li><li id="4bb6" class="kj kk in jm b jn li jr lj jv lk jz ll kd lm kh lh kp kq kr bi translated">最后，当您尝试打开 SSH 时，有时会看到以下消息:</li></ul><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ln"><img src="../Images/5614127678fbbe4d36bed57deea8fb21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cxKKwn2z5c1_jKZT-sH3IA.png"/></div></div></figure><p id="c4bd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这很容易，只要按下 F5 键，它通常会自动消失。</p><p id="15fe" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">最后</strong>，稳住自己！留出足够的时间来完成整个过程。不幸的是，正如我现在看到的，你一定会遇到令人惊讶的 Azure 怪异之处或错误。</p></div></div>    
</body>
</html>