<html>
<head>
<title>Let’s Get Swifty! Self-Sizing UITableViewCell in iOS/Swift using UITextView &amp; UIImage ⌜Beginner⌟</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让我们快点！使用 UITextView 和 UIImage ⌜Beginner⌟在 iOS/Swift 中自行调整 UITableViewCell 的大小</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/lets-get-swifty-self-sizing-uitableviewcell-in-ios-swift-using-uitextview-uiimage-beginner-b9123c873d7b?source=collection_archive---------9-----------------------#2020-06-27">https://blog.devgenius.io/lets-get-swifty-self-sizing-uitableviewcell-in-ios-swift-using-uitextview-uiimage-beginner-b9123c873d7b?source=collection_archive---------9-----------------------#2020-06-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/39f99961cbe6f0e6ef27a66e511f58b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-k-m1wVdpOE0gdEuZANTRA.png"/></div></div></figure><p id="f0b4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当你创建一个 UITableViewCell 时，你很少使用固定高度的 tableview。您希望将 tableview 单元格与动态单元格一起使用，以便内容能够紧密地容纳在您的单元格中！</p><p id="2b53" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="kw">我们在这里做什么？</em> </strong> <br/> ✅自动调整 UITableViewCell 的高度<br/> ✅通过 NSLayoutConstraints 使用程序化自动布局<br/> ✅大约 20 分钟</p><p id="ee4c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是一个简单的方法来学习如何 UITableViewCells 将能够有动态的高度。你可以利用这一点来帮助你构建自己的应用程序，甚至是 iOS Swift 面试。</p><p id="932f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">从我的 github 链接下载我的<a class="ae kx" href="https://github.com/noctisilva/medium_1/tree/Starter" rel="noopener ugc nofollow" target="_blank"> starter 项目。你可以在下面找到最终的链接项目。</a></p></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><p id="c941" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先在 ViewController 中创建 UITableView。您可以将它放在 bookCellId 变量下。</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="13bb" class="lo lp iq lk b gy lq lr l ls lt">var mainTableView: UITableView = {<br/>   let tableView = UITableView()<br/>   tableView.translatesAutoresizingMaskIntoConstraints = false<br/>   return tableView<br/>}()</span></pre><p id="da1e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们将委托&amp; dataSource 引用到 self，并将 NSLayoutConstriaints 设置为 tableview。将此添加到 ViewController 的设置功能中。</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="164d" class="lo lp iq lk b gy lq lr l ls lt">mainTableView.delegate = self<br/>mainTableView.dataSource = self<br/>mainTableView.register(BookCellId.self, forCellReuseIdentifier: bookCellId)</span><span id="3b51" class="lo lp iq lk b gy lu lr l ls lt">NSLayoutConstraint.activate([<br/>   mainTableView.widthAnchor.constraint(equalTo: self.view.widthAnchor),<br/>   mainTableView.heightAnchor.constraint(equalTo: self.view.heightAnchor),<br/>   mainTableView.centerXAnchor.constraint(equalTo: self.view.centerXAnchor),<br/>   mainTableView.centerYAnchor.constraint(equalTo: self.view.centerYAnchor),<br/>])</span></pre><p id="d81b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">是时候创建我们的自定义 UITableViewCell 了。将以下内容添加到 BookCellId 文件的 cellMargins 变量下。</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="399b" class="lo lp iq lk b gy lq lr l ls lt">var bookImage: UIImageView = {<br/>   let imageView = UIImageView()<br/>   imageView.translatesAutoresizingMaskIntoConstraints = false<br/>   imageView.contentMode = .scaleAspectFill<br/>   imageView.clipsToBounds = true<br/>   imageView.layer.masksToBounds = true<br/>   return imageView<br/>}()</span><span id="f6ef" class="lo lp iq lk b gy lu lr l ls lt">var bookDescription: UITextView = {<br/>   let textView = UITextView()<br/>   textView.translatesAutoresizingMaskIntoConstraints = false<br/>   textView.setContentCompressionResistancePriority(.required, for: .vertical)<br/>   textView.isEditable = false<br/>   textView.isScrollEnabled = false<br/>   textView.textContainerInset = .zero<br/>   return textView<br/>}()</span></pre><p id="e645" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所有项目都应该在单元格的 contentView 中。让我们在 contentView 中创建一个布局边距，作为对图像和文本进行约束的指南。</p><p id="77ff" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将以下内容放入设置功能中。</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="4798" class="lo lp iq lk b gy lq lr l ls lt">contentView.addSubview(bookImage)<br/>let margins = contentView.layoutMarginsGuide</span></pre><p id="fd60" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们添加子视图并设置约束。将以下内容放在前面的代码下:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="c238" class="lo lp iq lk b gy lq lr l ls lt">NSLayoutConstraint.activate([<br/>   bookImage.widthAnchor.constraint(equalToConstant: imageSize.width),<br/>   bookImage.heightAnchor.constraint(equalToConstant: imageSize.height),<br/>   bookImage.leadingAnchor.constraint(equalTo: margins.leadingAnchor),<br/>   bookImage.topAnchor.constraint(equalTo: margins.topAnchor),<br/>   bookImage.bottomAnchor.constraint(lessThanOrEqualTo: margins.bottomAnchor)<br/>])<br/>contentView.addSubview(bookDescription)<br/>NSLayoutConstraint.activate([<br/>   bookDescription.leadingAnchor.constraint(equalTo: bookImage.trailingAnchor, constant: spaceBetweenImageAndText),<br/>   bookDescription.trailingAnchor.constraint(equalTo: margins.trailingAnchor),<br/>   bookDescription.topAnchor.constraint(equalTo: margins.topAnchor),<br/>   bookDescription.bottomAnchor.constraint(equalTo:  margins.bottomAnchor)<br/>])</span></pre><p id="143f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们把事情做完。回到我们的 ViewController，寻找 ViewController 的扩展。您应该会看到 UITableViewDelegate 和 UITableViewDataSource 的两个扩展。这样我们就可以将 tableview 及其数据源插入到 ViewController 中。</p><p id="8da0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将 numberOfRowsInSection 返回变量替换为 bookText.count</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="427e" class="lo lp iq lk b gy lq lr l ls lt">let cell = tableView.dequeueReusableCell(withIdentifier: bookCellId) as! BookCellId<br/>cell.bookImage.image = UIImage(named: imageNames[indexPath.row])<br/>cell.bookDescription.text = bookText[indexPath.row]<br/>return cell</span></pre><p id="f27a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后，我们必须为 RowAt 函数设置 height。转到 heightForRowAt 函数并添加:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="59bb" class="lo lp iq lk b gy lq lr l ls lt">return UITableView.automaticDimension</span></pre><p id="f932" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">运行该函数，您应该能够看到一个成功编译的应用程序。</p><p id="2c6c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，有很多方法可以做到这一点。我的方法只是创建可调整大小视图的一个特殊版本。</p><p id="e3d5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你有任何问题，欢迎评论或发邮件给我:contact@taehongmin.com</p><p id="a08d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">期末项目在<a class="ae kx" href="https://github.com/noctisilva/medium_1/tree/COMPLETED" rel="noopener ugc nofollow" target="_blank">这个环节</a>。</p><p id="0362" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">感谢您的阅读！</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lv"><img src="../Images/b0393e2938101187165b23facbb62c69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LgrI6a9EX403-xjtNm3MUw.png"/></div></div></figure></div></div>    
</body>
</html>