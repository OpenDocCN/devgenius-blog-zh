<html>
<head>
<title>Getting started with Helm – Part II</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Helm入门–第二部分</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/getting-started-with-helm-part-ii-35534a291baa?source=collection_archive---------3-----------------------#2021-11-14">https://blog.devgenius.io/getting-started-with-helm-part-ii-35534a291baa?source=collection_archive---------3-----------------------#2021-11-14</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><blockquote class="jk jl jm"><p id="6f54" class="jn jo jp jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ig bi translated">这是HELM系列两篇文章中的第二篇。如果你是赫尔姆的新手，我会推荐你阅读这个系列的第一部分 的<a class="ae km" href="https://vidhitakher.medium.com/getting-started-with-helm-part-i-91a5f7c79ad6" rel="noopener"> <strong class="jq io">，然后开始阅读这篇博文。这篇文章深入探讨了helm的架构，试图强调其在kubernetes生态系统中的地位，以及部署应用程序Helm图表并维持其在集群中的发布周期的实用命令列表。</strong></a></p></blockquote><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi kn"><img src="../Images/aadf5b552e340a0b15eca9d3c69a8573.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sc6NUJTIrLG6_0JXrWmu8A.jpeg"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">照片由<a class="ae km" href="https://unsplash.com/@syhussaini?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Syed Hussaini </a>在<a class="ae km" href="https://unsplash.com/s/photos/helm?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="1308" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy ld ka kb kc le ke kf kg lf ki kj kk kl ig bi translated">在这两篇系列文章的第一部分中，我谈到了什么是helm chart以及为什么我们在kubernetes生态系统中需要它，然后解释了Helm的关键组件以及应用程序中Helm chart的结构。在这篇文章中，我将继续深入helm的架构，以及使用helm图表在kubernetes集群中安装和运行应用程序生命周期所需的重要命令列表。</p><h1 id="cd57" class="lg lh in bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">舵的建筑</h1><p id="8aae" class="pw-post-body-paragraph jn jo in jq b jr me jt ju jv mf jx jy ld mg kb kc le mh kf kg lf mi kj kk kl ig bi translated">说到Helm 3的架构，它有一个客户端专用的架构，客户端叫<code class="fe mj mk ml mm b">helm</code>。客户端是一个CLI，用户可以与之交互来执行不同的操作，如安装、升级和删除。该客户端与图表存储库交互，如下图所示，并从repo本地安装图表，还打包和升级现有图表</p><p id="2f73" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy ld ka kb kc le ke kf kg lf ki kj kk kl ig bi translated">头盔2中的服务器端组件<code class="fe mj mk ml mm b">Tiller</code>现在已经从头盔3中移除了。</p><p id="62dd" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy ld ka kb kc le ke kf kg lf ki kj kk kl ig bi translated">移除Tiller的主要好处是安全性现在被委托给Kubernetes用户集群安全性。使用Helm 3访问集群类似于<code class="fe mj mk ml mm b">kubectl</code>，例如kubeconfig文件。</p><p id="5ec9" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy ld ka kb kc le ke kf kg lf ki kj kk kl ig bi translated">如下图所示，Helm客户端通过删除tiller直接与Kubernetes API服务器交互，并将HELM模板文件呈现到Kubernetes清单文件中，它通过Kubernetes API在Kubernetes集群上使用这些文件进行操作。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi mn"><img src="../Images/46ca4b708f232d862d450a237223c51a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3BOgpQ9HwzansoZPkwrdRg.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">头盔3的架构</figcaption></figure><h1 id="7387" class="lg lh in bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">舵命令</h1><p id="4fc7" class="pw-post-body-paragraph jn jo in jq b jr me jt ju jv mf jx jy ld mg kb kc le mh kf kg lf mi kj kk kl ig bi translated">到目前为止，必须了解Helm使用图表管理kubernetes集群中应用程序的生命周期。为了与终端用户进行交互，它提供了一个CLI，该CLI可以与一组命令一起使用，以便在群集内部署和维护应用程序时安装、卸载甚至升级应用程序。它还管理应用程序的发布生命周期。一个<strong class="jq io">版本</strong>是一个部署在Kubernetes集群中的图表的单个实例。</p><p id="e6f1" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy ld ka kb kc le ke kf kg lf ki kj kk kl ig bi translated">下面是一些按顺序排列的舵命令，这些命令对于部署舵图表非常重要。</p><p id="7550" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy ld ka kb kc le ke kf kg lf ki kj kk kl ig bi translated"><strong class="jq io"> <em class="jp"> helm repo add </em> </strong>用于将图表库添加到您的本地</p><pre class="ko kp kq kr gt mo mm mp mq aw mr bi"><span id="faf5" class="ms lh in mm b gy mt mu l mv mw">helm repo add [repository-name] [url]<br/>eg -&gt; helm repo add <strong class="mm io">repo1</strong> <strong class="mm io">artifactory.jfrog.com</strong></span></pre><p id="9279" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy ld ka kb kc le ke kf kg lf ki kj kk kl ig bi translated"><strong class="jq io"> <em class="jp"> helm repo list </em> </strong>用于列出所有添加到本地的海图资源库。此命令可用于验证从第一个命令开始添加的repo是否正确</p><pre class="ko kp kq kr gt mo mm mp mq aw mr bi"><span id="9a2b" class="ms lh in mm b gy mt mu l mv mw">helm repo list<br/>eg -&gt; helm repo list when run will show names of repo added</span></pre><p id="9fd8" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy ld ka kb kc le ke kf kg lf ki kj kk kl ig bi translated"><strong class="jq io"> <em class="jp"> helm install </em> </strong>命令用于<strong class="jq io"> <em class="jp"> </em> </strong>在一个特定的命名空间中安装一个带有— namespace标志的app:</p><pre class="ko kp kq kr gt mo mm mp mq aw mr bi"><span id="e28f" class="ms lh in mm b gy mt mu l mv mw">helm install [app-name] [chart] --namespace [namespace]<br/>eg -&gt; helm install <strong class="mm io">webapp</strong> <strong class="mm io">webapp-chart</strong> --namespace <strong class="mm io">dev</strong></span></pre><p id="ad29" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy ld ka kb kc le ke kf kg lf ki kj kk kl ig bi translated"><strong class="jq io"> <em class="jp"> helm list </em> </strong>命令用于<strong class="jq io"> <em class="jp"> </em> </strong>列出当前命名空间中所有可用的版本，是检查您的应用程序是否在上一步安装的好方法。</p><pre class="ko kp kq kr gt mo mm mp mq aw mr bi"><span id="fd52" class="ms lh in mm b gy mt mu l mv mw">helm list (will list in the current namespace)</span><span id="09fb" class="ms lh in mm b gy mx mu l mv mw">helm list --all-namespaces ( will list across all namespaces)</span><span id="c7bf" class="ms lh in mm b gy mx mu l mv mw">helm list --namespace [namespace]<br/>eg -&gt; helm list --namespace <strong class="mm io">dev<br/>      -- webapp</strong></span></pre><p id="6776" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy ld ka kb kc le ke kf kg lf ki kj kk kl ig bi translated"><strong class="jq io"> <em class="jp">舵升级</em> </strong>命令用于<strong class="jq io"> <em class="jp">升级现有app，或者安装一个新的</em> </strong>(如果没有该名称的话)。如果使用<strong class="jq io">原子标志</strong>，升级失败时会自动回滚。</p><pre class="ko kp kq kr gt mo mm mp mq aw mr bi"><span id="e455" class="ms lh in mm b gy mt mu l mv mw">helm upgrade [release] [chart] --atomic --install --version [version-number]<br/>eg -&gt; helm <!-- -->upgrade webapp webapp-chart --atomic --install --version 1.0</span></pre><p id="73d1" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy ld ka kb kc le ke kf kg lf ki kj kk kl ig bi translated"><strong class="jq io"><em class="jp"/></strong>命令用来通过在本地指定路径<strong class="jq io"> <em class="jp"> </em> </strong>将一个图表打包成一个图表存档</p><pre class="ko kp kq kr gt mo mm mp mq aw mr bi"><span id="3db8" class="ms lh in mm b gy mt mu l mv mw">helm package [chart-path]<br/>eg -&gt; helm <!-- -->package ./webapp-chart<br/> -- will add an archive of this chart <strong class="mm io">webapp-chart.tgz in current location</strong></span></pre><p id="dcdc" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy ld ka kb kc le ke kf kg lf ki kj kk kl ig bi translated"><strong class="jq io"><em class="jp">helm uninstall</em></strong>命令用于<strong class="jq io"> <em class="jp">从当前<strong class="jq io"> <em class="jp"> </em> </strong>命名空间中删除一个已有的app </em> </strong>或者可以用命名空间标志指定命名空间。<strong class="jq io"> <em class="jp">舵删除</em> </strong>命令也可以用来产生同样的输出。</p><pre class="ko kp kq kr gt mo mm mp mq aw mr bi"><span id="ebd2" class="ms lh in mm b gy mt mu l mv mw">helm uninstall [release]<br/>eg -&gt; helm <!-- -->uninstall webapp <br/></span></pre><p id="07ad" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy ld ka kb kc le ke kf kg lf ki kj kk kl ig bi translated">这些是使用helm charts在kubernetes集群中运行和管理应用生命周期所需的一些关键命令。还有一些更广泛的命令非常有用，比如<strong class="jq io">头盔搜索</strong>、<strong class="jq io">头盔绒毛</strong>、<strong class="jq io">头盔拉力、头盔状态</strong>等，这些命令可以通过更多地使用头盔来掌握。</p></div><div class="ab cl my mz hr na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="ig ih ii ij ik"><p id="23f5" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy ld ka kb kc le ke kf kg lf ki kj kk kl ig bi translated"><strong class="jq io">结论:</strong>总的来说，我认为Helm通过提供一种集中的方式来管理k8s系统中的应用程序，是一种不断发展的思想，通过库图表和helm3版本，它正朝着正确的方向前进。甚至CNCF基金会最近也在2021年9月开始的<a class="ae km" href="https://github.com/cncf/curriculum/blob/master/CKAD_Curriculum_v1.22.pdf" rel="noopener ugc nofollow" target="_blank"> CKAD认证</a>考试中增加了关于赫尔姆的话题，并在这次实际操作认证考试中提出了与赫尔姆海图相关的问题。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi nf"><img src="../Images/fd0481a2a18e9b40398a58d33d37302e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pv30tz_7bCQMQDtfTZPhiQ.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">CKAD课程2021年9月与头盔相关的变化</figcaption></figure></div><div class="ab cl my mz hr na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="ig ih ii ij ik"><p id="3603" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy ld ka kb kc le ke kf kg lf ki kj kk kl ig bi translated">请和我分享你对这两篇关于Helm的文章的看法，以及你在这些文章中发现了什么有用的东西。谢谢你一直读到最后。</p></div></div>    
</body>
</html>