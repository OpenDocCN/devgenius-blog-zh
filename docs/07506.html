<html>
<head>
<title>Creating a Rainbow Weighted Average trading bot with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Python 创建彩虹加权平均交易机器人</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/creating-a-rainbow-weighted-average-trading-bot-with-python-99f13642a2c9?source=collection_archive---------6-----------------------#2022-03-31">https://blog.devgenius.io/creating-a-rainbow-weighted-average-trading-bot-with-python-99f13642a2c9?source=collection_archive---------6-----------------------#2022-03-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/></div><div class="ab cl jn jo hu jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ij ik il im in"><figure class="jv jw jx jy gt jz gh gi paragraph-image"><div class="gh gi ju"><img src="../Images/04d0c8e40a2c42579160a396766362c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*jC78vgbBd2wyQKBeg6EgOg.png"/></div></figure><p id="f9ca" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">你们中的一些人可能已经看过我上一篇关于彩虹加权平均(RWA)以及它如何比简单的比特币美元成本平均更有利可图的文章。关于这方面的更多细节，你可以在下面找到一个详细描述这个工作的帖子。</p><div class="la lb gp gr lc ld"><a href="https://medium.com/coinmonks/using-python-to-analyze-rainbow-weighted-averaging-a-more-profitable-frequency-investment-12009a8c3617" rel="noopener follow" target="_blank"><div class="le ab fo"><div class="lf ab lg cl cj lh"><h2 class="bd ir gy z fp li fr fs lj fu fw ip bi translated">使用 Python 分析彩虹加权平均——一种更有利可图的频率投资…</h2><div class="lk l"><h3 class="bd b gy z fp li fr fs lj fu fw dk translated">介绍</h3></div><div class="ll l"><p class="bd b dl z fp li fr fs lj fu fw dk translated">medium.com</p></div></div><div class="lm l"><div class="ln l lo lp lq lm lr ka ld"/></div></div></a></div><p id="32a3" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在这篇文章中，我将创建一个 Python 机器人，它将根据我们在比特币对数回归带中的位置进行加权交易。</p></div><div class="ab cl jn jo hu jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ij ik il im in"><h1 id="80fa" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">什么是 RWA？</h1><p id="00f0" class="pw-post-body-paragraph kc kd iq ke b kf mq kh ki kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz ij bi translated">对于那些没有读过我上一篇文章的人来说，快速提醒一下，彩虹加权平均(RWA)是一种投资方法，当应用于历史 BTC 价格数据时，它在 96.8%的情况下优于 DCA，平均高出 35.3%的回报。</p><p id="75bd" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">策略很简单，用比特币彩虹图。这让我们大致了解了我们在比特币周期中的位置，以及我们在特定时间点的过热或欠热程度。该图表简单地显示了以对数刻度为 y 轴的 BTC 价格历史，以及 x 轴的时间(注意:这不在对数刻度内)。彩虹是通过简单地在比特币图表上上下移动 BTC 回归带创造出来的。颜色对应于我们将 RWA 投资额乘以多少，这些颜色可以在下图中看到。</p><figure class="jv jw jx jy gt jz gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/3d2820349c248dd826d501aa452631cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:574/format:webp/0*fs6rZq82E4fsy0Xg.png"/></div><figcaption class="mw mx gj gh gi my mz bd b be z dk translated">波段倍增</figcaption></figure><h2 id="f3eb" class="na lt iq bd lu nb nc dn ly nd ne dp mc kn nf ng mg kr nh ni mk kv nj nk mo nl bi translated">您将需要什么:</h2><ul class=""><li id="3edf" class="nm nn iq ke b kf mq kj mr kn no kr np kv nq kz nr ns nt nu bi translated">一些编程知识。</li><li id="d1c3" class="nm nn iq ke b kf nv kj nw kn nx kr ny kv nz kz nr ns nt nu bi translated">Python 3。</li><li id="61f9" class="nm nn iq ke b kf nv kj nw kn nx kr ny kv nz kz nr ns nt nu bi translated"><a class="ae oa" href="https://python-binance.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">巨蟒-币安</a>。</li><li id="23ac" class="nm nn iq ke b kf nv kj nw kn nx kr ny kv nz kz nr ns nt nu bi translated"><a class="ae oa" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">熊猫</a>和<a class="ae oa" href="https://numpy.org/" rel="noopener ugc nofollow" target="_blank">熊猫</a></li><li id="f462" class="nm nn iq ke b kf nv kj nw kn nx kr ny kv nz kz nr ns nt nu bi translated">Scipy 适用于一些非常非常低级的机器学习(称之为 scipy 有点夸张，但听起来很花哨)</li><li id="e495" class="nm nn iq ke b kf nv kj nw kn nx kr ny kv nz kz nr ns nt nu bi translated"><a class="ae oa" href="https://pypi.org/project/Nasdaq-Data-Link/" rel="noopener ugc nofollow" target="_blank">纳斯达克链接</a>获取历史比特币数据</li><li id="20b3" class="nm nn iq ke b kf nv kj nw kn nx kr ny kv nz kz nr ns nt nu bi translated">一个<a class="ae oa" href="https://testnet.binance.vision/" rel="noopener ugc nofollow" target="_blank">币安</a>模拟账户来做一些测试(<strong class="ke ir">注意:</strong>你需要一个 Github 账户来做这个)。</li></ul><h2 id="59af" class="na lt iq bd lu nb nc dn ly nd ne dp mc kn nf ng mg kr nh ni mk kv nj nk mo nl bi translated">限制</h2><ul class=""><li id="2ebb" class="nm nn iq ke b kf mq kj mr kn no kr np kv nq kz nr ns nt nu bi translated">它不会从您的银行账户向币安汇款，您必须自己设置。</li><li id="ce8d" class="nm nn iq ke b kf nv kj nw kn nx kr ny kv nz kz nr ns nt nu bi translated">“买入金额”必须大于最低买入金额，对于欧元，这是€10。</li><li id="0f55" class="nm nn iq ke b kf nv kj nw kn nx kr ny kv nz kz nr ns nt nu bi translated">这个机器人不是为服务器优化的，所以我计划让它在我的覆盆子馅饼上运行。</li></ul></div><div class="ab cl jn jo hu jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ij ik il im in"><h1 id="4349" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">创建 RWA Bot</h1><p id="a814" class="pw-post-body-paragraph kc kd iq ke b kf mq kh ki kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz ij bi translated">在这里，我将详细介绍创建 RWA bot 所需的步骤，如果你读过我以前的 Python bot 帖子，那么其中一些会很熟悉，但是我觉得更多的人会从从头到尾看到这个过程中受益。</p><figure class="jv jw jx jy gt jz gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/cbfbd04d067238426613f1dd726ff935.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*U19BKSsSIQ28TXPO.png"/></div><figcaption class="mw mx gj gh gi my mz bd b be z dk translated">比特币彩虹聊天工具</figcaption></figure><h2 id="ca41" class="na lt iq bd lu nb nc dn ly nd ne dp mc kn nf ng mg kr nh ni mk kv nj nk mo nl bi translated">设置</h2><p id="bcb8" class="pw-post-body-paragraph kc kd iq ke b kf mq kh ki kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz ij bi translated">设置是相当容易的，我把我的 API 密匙保存在我的操作系统环境中，但是你可以随意复制粘贴你的。</p><h2 id="031b" class="na lt iq bd lu nb nc dn ly nd ne dp mc kn nf ng mg kr nh ni mk kv nj nk mo nl bi translated">助手功能</h2><p id="c8a5" class="pw-post-body-paragraph kc kd iq ke b kf mq kh ki kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz ij bi translated">首先，我们需要创建一些币安 API 助手函数，我们将使用这些函数从币安交易所获得一些有用的数据。我将在下面列出这个机器人将要使用的函数，如果你查看 Github，你会发现更多用于测试的帮助函数，你可能会想在你的测试中使用它们。</p><h2 id="b3f7" class="na lt iq bd lu nb nc dn ly nd ne dp mc kn nf ng mg kr nh ni mk kv nj nk mo nl bi translated">获得平衡</h2><p id="6c97" class="pw-post-body-paragraph kc kd iq ke b kf mq kh ki kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz ij bi translated">向币安 API 请求你交易的账户余额，在我的例子中是欧元，注意测试 API 没有欧元，所以要换成 USDT 或者其他稳定的货币。</p><pre class="jv jw jx jy gt oc od oe of aw og bi"><span id="c32a" class="na lt iq od b gy oh oi l oj ok"><em class="ol">def </em>getBalances():<br/>    #client.API_URL = 'https://testnet.binance.vision/api'<br/>    balance = client.get_asset_balance(asset='EUR') # or asset = 'USDT' for test<br/>    <em class="ol">return </em>balance</span></pre><h2 id="fa02" class="na lt iq bd lu nb nc dn ly nd ne dp mc kn nf ng mg kr nh ni mk kv nj nk mo nl bi translated">获取市场价格</h2><p id="c241" class="pw-post-body-paragraph kc kd iq ke b kf mq kh ki kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz ij bi translated">这将得到你选择的交易对的当前价格。</p><pre class="jv jw jx jy gt oc od oe of aw og bi"><span id="a560" class="na lt iq od b gy oh oi l oj ok"><em class="ol">def </em>getMarketPrice(<em class="ol">tradingPair</em>):<br/>    #client.API_URL = 'https://testnet.binance.vision/api'<br/>    price = client.get_symbol_ticker(symbol=<em class="ol">tradingPair</em>)    <em class="ol">return price</em></span></pre><h2 id="e82c" class="na lt iq bd lu nb nc dn ly nd ne dp mc kn nf ng mg kr nh ni mk kv nj nk mo nl bi translated">推特机器人</h2><p id="01d8" class="pw-post-body-paragraph kc kd iq ke b kf mq kh ki kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz ij bi translated">这是一个推特机器人，它会在推特上发布你购买密码的价格，以及交易时出现的任何错误。</p><pre class="jv jw jx jy gt oc od oe of aw og bi"><span id="c58a" class="na lt iq od b gy oh oi l oj ok"><em class="ol">def </em>tweet(<em class="ol">Order</em>):<br/> # Authenticate to Twitter<br/>auth = tweepy.OAuthHandler("CONSUMER_KEY", "CONSUMER_SECRET")<br/>auth.set_access_token("ACCESS_TOKEN", "ACCESS_TOKEN_SECRET")api = tweepy.API(auth)api.update_status(order)</span></pre><h2 id="29a6" class="na lt iq bd lu nb nc dn ly nd ne dp mc kn nf ng mg kr nh ni mk kv nj nk mo nl bi translated">下购买订单</h2><p id="4a44" class="pw-post-body-paragraph kc kd iq ke b kf mq kh ki kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz ij bi translated">这个函数下一个市场买入订单，然后它会使用 tweet 发送该商品和交易对，如果买入订单没有通过，则发送一个错误消息。</p><pre class="jv jw jx jy gt oc od oe of aw og bi"><span id="ff7c" class="na lt iq od b gy oh oi l oj ok"><em class="ol">def </em>placeBuyOrder(<em class="ol">quantity</em>, <em class="ol">tradingPair</em>):<br/>    #client.API_URL = 'https://testnet.binance.vision/api'<br/>    <em class="ol">try</em>:<br/>        order = client.create_order(symbol=<em class="ol">tradingPair</em>, side='BUY', type='MARKET', quantity=<em class="ol">quantity</em>)<br/>        #order = client.create_test_order(symbol=tradingPair, side='BUY', type='MARKET', quantity=quantity)<br/>        toTweet = "Bought " + order["symbol"] +  " at "+  order["fills"][0]['price']<br/>        tweet(toTweet)<br/>    <em class="ol">except </em>BinanceAPIException <em class="ol">as </em>e:<br/>        tweet(e)<br/>        print(e)<br/>    <em class="ol">except </em>BinanceOrderException <em class="ol">as </em>e:<br/>        tweet(e)<br/>        print(e)<br/>    <em class="ol">return</em></span></pre><h2 id="153c" class="na lt iq bd lu nb nc dn ly nd ne dp mc kn nf ng mg kr nh ni mk kv nj nk mo nl bi translated">购买功能</h2><p id="beb0" class="pw-post-body-paragraph kc kd iq ke b kf mq kh ki kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz ij bi translated">这是主函数，您将在其中使用前面讨论的其他函数。</p><p id="e439" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">首先，它得到你选择的交易对手的当前价格，然后它得到我们账户中的余额，无论我们的法定价值是多少，对我来说是欧元，但无论你想要什么。然后你需要得到步长，它基本上给了你在当前价格买入时应该去的小数位数。(<strong class="ke ir">注意</strong>你可能不需要这个，但是没有它我无法让它工作)。</p><p id="0987" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">之后，检查你的余额，并确保你有足够的钱实际购买一些密码(最低消费为欧元€10)。如果余额大于最小购买量，那么将计算一个购买订单，并使用“placeBuyOrder”函数执行该购买。</p><p id="19df" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果账户中没有足够的资产，那么我们假设长期订单没有通过，我们等待一个小时，看看钱是否已经存入。</p><p id="083f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果由于某种原因，这其中有任何错误，机器人将在推特上发布错误，这样我就知道有事发生了。</p><figure class="jv jw jx jy gt jz"><div class="bz fp l di"><div class="om on l"/></div></figure></div><div class="ab cl jn jo hu jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ij ik il im in"><h1 id="2357" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">RWA 计算</h1><p id="ce9b" class="pw-post-body-paragraph kc kd iq ke b kf mq kh ki kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz ij bi translated">这是奇迹真正发生的地方。在此函数中，我们采用历史比特币价格，并使用 Scipy 中的曲线拟合函数来获得比特币的对数回归带，并在图表中上下移动该带以获得彩虹带。然后，我们采用比特币的当前价格，并使用一系列的<em class="ol"> if </em>和<em class="ol"> elif </em>语句来找出它位于哪个加权区间。这给出了我们的加权投资金额，然后我们调用前面小节中讨论的购买函数来购买我们认为适合当前市场条件的比特币数量。</p><figure class="jv jw jx jy gt jz"><div class="bz fp l di"><div class="om on l"/></div></figure><p id="bbe8" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">您可以在下面的 GitHub 资源库中找到完整的代码</p><div class="la lb gp gr lc ld"><a href="https://github.com/Totesthegoats/rca_bot" rel="noopener  ugc nofollow" target="_blank"><div class="le ab fo"><div class="lf ab lg cl cj lh"><h2 class="bd ir gy z fp li fr fs lj fu fw ip bi translated">GitHub - Totesthegoats/rca_bot</h2><div class="lk l"><h3 class="bd b gy z fp li fr fs lj fu fw dk translated">储存库可用于创建一个 Python 机器人，它将根据我们在比特币中的地位进行加权交易…</h3></div><div class="ll l"><p class="bd b dl z fp li fr fs lj fu fw dk translated">github.com</p></div></div><div class="lm l"><div class="oo l lo lp lq lm lr ka ld"/></div></div></a></div></div><div class="ab cl jn jo hu jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ij ik il im in"><h1 id="d20c" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">结论</h1><p id="cb6b" class="pw-post-body-paragraph kc kd iq ke b kf mq kh ki kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz ij bi translated">差不多就是这样，正如我以前说过的，这个机器人比使用普通的 DCA 机器人更有利可图，我建议你阅读我以前的帖子，了解 RWA 与 DCA 相比如何工作的细节。</p><p id="e080" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">有几个改进可以用来增加这个机器人的可用性，主要是 Twitter API 的集成，它允许您创建一个 Twitter 机器人，以便您可以轻松地监控您的机器人的进度以及购买价格。我不会在这里深入讨论这些细节，但是你可以在下面的帖子中找到如何做到这一点的细节。</p><div class="la lb gp gr lc ld"><a href="https://totesthegoats92.medium.com/improving-the-dca-bot-python-51b82f6b4779" rel="noopener follow" target="_blank"><div class="le ab fo"><div class="lf ab lg cl cj lh"><h2 class="bd ir gy z fp li fr fs lj fu fw ip bi translated">改进 DCA bot (Python)</h2><div class="lk l"><h3 class="bd b gy z fp li fr fs lj fu fw dk translated">在之前的一篇文章中，我描述了如何使用 Python 以及 Twitter 和币安 API 来创建 DCA Bot。我…</h3></div><div class="ll l"><p class="bd b dl z fp li fr fs lj fu fw dk translated">totesthegoats92.medium.com</p></div></div><div class="lm l"><div class="op l lo lp lq lm lr ka ld"/></div></div></a></div><p id="2b58" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果你需要任何帮助设置这个机器人不要害怕伸出手来，并取得联系。</p><h2 id="fd97" class="na lt iq bd lu nb nc dn ly nd ne dp mc kn nf ng mg kr nh ni mk kv nj nk mo nl bi translated">注意</h2><p id="0a02" class="pw-post-body-paragraph kc kd iq ke b kf mq kh ki kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz ij bi translated">使用此机器人的现场版本，风险自担。</p><h1 id="8720" class="ls lt iq bd lu lv oq lx ly lz or mb mc md os mf mg mh ot mj mk ml ou mn mo mp bi translated">支持我</h1><p id="7225" class="pw-post-body-paragraph kc kd iq ke b kf mq kh ki kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz ij bi translated">如果你觉得这很有趣或者你真的很好，你可以发给我一些 sat。</p><p id="fc35" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">BTC 钱包:BC 1 q 6 UE 97 Lyn 296 eeh 6 fzmqttvafgtm 2 q WPU 87 DDA 4</p><p id="c271" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">ETH 钱包:0 xfa 4c 099 ed 0 c 6 da 25d 2347 c 481 CFD 12 b 7 bcda 1329</p></div></div>    
</body>
</html>