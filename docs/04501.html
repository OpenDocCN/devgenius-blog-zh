<html>
<head>
<title>Making a dashboard for Star Wars dialogue with Streamlit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Streamlit制作星球大战对话的仪表板</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/making-a-dashboard-for-star-wars-dialogue-with-streamlit-7c50d0937dbd?source=collection_archive---------3-----------------------#2021-03-25">https://blog.devgenius.io/making-a-dashboard-for-star-wars-dialogue-with-streamlit-7c50d0937dbd?source=collection_archive---------3-----------------------#2021-03-25</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="54f5" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">我如何使用Python快速构建了一个交互式的、时尚的仪表板来分析《星球大战》三部曲中谁说了什么</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/f4b78476ca925d4d452263c0d473e1d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SRmciVipG3TAmsgYaDICxg.png"/></div></div></figure><p id="a09d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">Streamlit是一个python库，用于快速构建web交互式仪表盘。Streamlit网站上的仪表盘图库显示它们正被用于科学交流、数据分析和显示正在运行的机器学习模型。我选择了一个不太严肃的话题来自学如何使用图书馆。我找到了一个数据集，里面有《星球大战》电影三部曲中的所有对话，并决定建立一个仪表盘，探索谁说了什么以及如何说的。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ll lm l"/></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">第四集的对话组织在一个简单的文件中</figcaption></figure><p id="7cc7" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果你想跳到前面，看看完成后的仪表板是什么样子<a class="ae lk" href="https://share.streamlit.io/joerackham/starwarsdashboard/main/app.py" rel="noopener ugc nofollow" target="_blank">，点击这里</a>。否则，按照这个指南，看看我是如何建立它的。你也可以在这里查看我的代码<a class="ae lk" href="https://github.com/joerackham/StarWarsDashboard" rel="noopener ugc nofollow" target="_blank"/>。</p><h2 id="b2ad" class="lr ls in bd lt lu lv dn lw lx ly dp lz kx ma mb mc lb md me mf lf mg mh mi mj bi translated">安装</h2><p id="857a" class="pw-post-body-paragraph ko kp in kq b kr mk jo kt ku ml jr kw kx mm kz la lb mn ld le lf mo lh li lj ig bi translated">第一步是设置仪表板。我导入了Streamlit和其他一些有用的库。Numpy和Pandas帮助处理数据，plotly用于构建图表。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="7fa5" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">Streamlit仪表盘分为主区域和侧边栏。在侧边栏对象上调用函数会将组件添加到侧边栏，否则，它们会被添加到主区域。组件的添加顺序与脚本中相应函数调用的顺序相同。我给它们都加了一个标题，然后在边栏上加了一个副标题，里面有一些关于我的信息。您可以将任何markdown字符串传递给markdown()，它将被正确解析和呈现。</p><h2 id="6ed0" class="lr ls in bd lt lu lv dn lw lx ly dp lz kx ma mb mc lb md me mf lf mg mh mi mj bi translated">加载和选择对话</h2><p id="f8e1" class="pw-post-body-paragraph ko kp in kq b kr mk jo kt ku ml jr kw kx mm kz la lb mn ld le lf mo lh li lj ig bi translated">在设置好简单的仪表板后，我编写了一个函数来加载其中一部电影的数据。当仪表板上的选项更改时，它将重新加载；cache()注释意味着数据不会被不必要地重新加载。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="531c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">然后，我在侧边栏上添加了一个多选框，这样用户就可以选择他们想要探索的电影对白。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ll lm l"/></div></figure><h2 id="9bec" class="lr ls in bd lt lu lv dn lw lx ly dp lz kx ma mb mc lb md me mf lf mg mh mi mj bi translated">多少行？</h2><p id="8102" class="pw-post-body-paragraph ko kp in kq b kr mk jo kt ku ml jr kw kx mm kz la lb mn ld le lf mo lh li lj ig bi translated">加载完数据后，我想绘制的第一件事是每个字符有多少行。看着这些数据，我发现有些人只说了一两件事。我决定排除那些说少于10行的人，以保持图表整洁。然后我添加了一个滑块，这样用户可以选择排除更多的配角。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="4c7c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">使用NumPy和pandas，我创建了一个数据框架，显示每部电影中每个角色说了多少句台词。然后，我删除了所有不太会说话的字符，并用plotly将其显示为一个条形图。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="9bd8" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我可以改变侧边栏上的多选框，或者调整最小行数，这样图表就会很快用相关数据重新绘制出来。我设置了色域，以便按胶片划分数据。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mp"><img src="../Images/dc722423e978cec87b929880ccc0c43c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*266mcRlAHhsAfmf8W1tg7g.png"/></div></div></figure><h2 id="076f" class="lr ls in bd lt lu lv dn lw lx ly dp lz kx ma mb mc lb md me mf lf mg mh mi mj bi translated">心不在焉</h2><p id="a8e9" class="pw-post-body-paragraph ko kp in kq b kr mk jo kt ku ml jr kw kx mm kz la lb mn ld le lf mo lh li lj ig bi translated">然后我决定我想添加世界云来形象化所说的话。这需要一些额外的进口。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="0e67" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我知道我想添加多个世界云，所以我写了一个函数，从一长串单词中画出一个。这里使用了停用词导入。这只是一个常用词的列表，如“a”、“the”、“or”等词云应该忽略的词。我本可以自己写或者决定添加一些特定领域的词汇，比如“绝地”和“反叛”，但是为什么要重新发明轮子呢？</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="76a2" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">一个词云将使用每个角色的对话来构建，但另一个词云将专注于一个角色。我在侧边栏上添加了一个下拉菜单，这样用户可以选择关注谁。我确保从使用的数据中建立角色列表，这样用户就不会选择一个什么都没说的角色(例如《帝国反击战》中的小屋贾巴)。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="9668" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">然后，我遍历数据，将所有的线收集到两个长字符串中。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="6197" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这是维德在三部电影中的用词“云”:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mq"><img src="../Images/216b585b8da2f515761d5bb3b2ffd752.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b4rUgojfFLVZV_G9IRbVOQ.png"/></div></div></figure><h2 id="56fb" class="lr ls in bd lt lu lv dn lw lx ly dp lz kx ma mb mc lb md me mf lf mg mh mi mj bi translated">积极思考</h2><p id="7953" class="pw-post-body-paragraph ko kp in kq b kr mk jo kt ku ml jr kw kx mm kz la lb mn ld le lf mo lh li lj ig bi translated">然后我决定我想分析每个角色所说的情绪，以确定谁更积极。这也是从一些进口开始的。巧合的是，我最终使用的情绪分析模块叫做“维达”。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="0851" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">使用分析器，我计算了所有台词中每个角色的平均情感分数。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="b2e3" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">下面是这种情况下会产生的一个例子:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mp"><img src="../Images/227a08d510aff5c51e976de46fd89c56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qo2G6GTsO3NNrZgph-_YZw.png"/></div></div></figure><h2 id="cdcc" class="lr ls in bd lt lu lv dn lw lx ly dp lz kx ma mb mc lb md me mf lf mg mh mi mj bi translated">后续步骤</h2><p id="e8e0" class="pw-post-body-paragraph ko kp in kq b kr mk jo kt ku ml jr kw kx mm kz la lb mn ld le lf mo lh li lj ig bi translated">我想给我的图表添加一些新的、有趣的情节，并为其他6部主要电影添加数据。我还没有找到以如此好的格式预处理过的前传或续集的对话，但写一个剧本来贯穿整个剧本并提取对话应该不会太难。</p><p id="5d91" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">构建这个仪表板是对Streamlit的一个很好的介绍，我期待在更严肃的项目中使用它。希望本文对您有所帮助，感谢阅读。</p><p id="cb7b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">乔·拉克姆</p></div></div>    
</body>
</html>