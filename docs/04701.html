<html>
<head>
<title>Developing Vue Apps with Class-Based Components — Type Annotations</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用基于类的组件开发 Vue 应用——类型注释</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/developing-vue-apps-with-class-based-components-type-annotations-dd6c28491385?source=collection_archive---------3-----------------------#2021-04-22">https://blog.devgenius.io/developing-vue-apps-with-class-based-components-type-annotations-dd6c28491385?source=collection_archive---------3-----------------------#2021-04-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/7ddd5b0d190be12395ecd92dd0af0428.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GpllbZr588G4N_R4"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@emilianatmbg?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">艾米莉亚纳·霍尔</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="eed1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们更喜欢使用类，我们可以使用 Vue 自带的基于类的组件 API。</p><p id="2767" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看如何用基于类的组件开发 Vue 应用。</p><h1 id="e730" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">外部挂钩的类型脚本自动完成</h1><p id="edc9" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以在用 TypeScript 编写的基于类的组件中为外部挂钩添加自动完成功能。</p><p id="ba90" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><p id="3aa2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">vue-router-hook-types.ts</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="6c31" class="mq lc iq mh b gy mr ms l mt mu">import Vue from "vue";<br/>import { Route, RawLocation } from "vue-router";</span><span id="3072" class="mq lc iq mh b gy mv ms l mt mu">declare module "vue/types/vue" {<br/>  interface Vue {<br/>    beforeRouteEnter?(<br/>      to: Route,<br/>      from: Route,<br/>      next: (to?: RawLocation | false | ((vm: Vue) =&gt; void)) =&gt; void<br/>    ): void;</span><span id="4f63" class="mq lc iq mh b gy mv ms l mt mu">    beforeRouteLeave?(<br/>      to: Route,<br/>      from: Route,<br/>      next: (to?: RawLocation | false | ((vm: Vue) =&gt; void)) =&gt; void<br/>    ): void;</span><span id="fefa" class="mq lc iq mh b gy mv ms l mt mu">    beforeRouteUpdate?(<br/>      to: Route,<br/>      from: Route,<br/>      next: (to?: RawLocation | false | ((vm: Vue) =&gt; void)) =&gt; void<br/>    ): void;<br/>  }<br/>}</span></pre><p id="9fed" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">main.ts</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="db11" class="mq lc iq mh b gy mr ms l mt mu">import Vue from "vue";<br/>import App from "./App.vue";<br/>import Foo from "./views/Foo.vue";<br/>import Bar from "./views/Bar.vue";<br/>import VueRouter from "vue-router";<br/>import "./vue-router-hook-types";<br/>Vue.config.productionTip = false;<br/>const routes = [<br/>  { path: "/foo", component: Foo },<br/>  { path: "/bar", component: Bar }<br/>];<br/>const router = new VueRouter({<br/>  routes<br/>});<br/>Vue.use(VueRouter);<br/>new Vue({<br/>  router,<br/>  render: (h) =&gt; h(App)<br/>}).$mount("#app");</span></pre><p id="34e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">App.vue</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="f5ec" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div id="app"&gt;<br/>    &lt;router-link to="/foo"&gt;Foo&lt;/router-link&gt;<br/>    &lt;router-link to="/bar"&gt;Bar&lt;/router-link&gt;<br/>    &lt;router-view&gt;&lt;/router-view&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;<br/>&lt;script&gt;<br/>export default {<br/>  name: "App",<br/>};<br/>&lt;/script&gt;</span></pre><p id="85fc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">views/Bar.vue</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="d4fb" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div&gt;bar&lt;/div&gt;<br/>&lt;/template&gt;<br/>&lt;script&gt;<br/>import Vue from "vue";<br/>import Component from "vue-class-component";<br/>Component.registerHooks([<br/>  "beforeRouteEnter",<br/>  "beforeRouteLeave",<br/>  "beforeRouteUpdate",<br/>]);<br/>@Component<br/>export default class Foo extends Vue {<br/>  beforeRouteEnter(to, from, next) {<br/>    console.log("beforeRouteEnter");<br/>    next();<br/>  }<br/>  beforeRouteUpdate(to, from, next) {<br/>    console.log("beforeRouteUpdate");<br/>    next();<br/>  }<br/>  beforeRouteLeave(to, from, next) {<br/>    console.log("beforeRouteLeave");<br/>    next();<br/>  }<br/>}<br/>&lt;/script&gt;</span></pre><p id="7ac7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">views/Foo.vue</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="1d0d" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div&gt;foo&lt;/div&gt;<br/>&lt;/template&gt;<br/>&lt;script&gt;<br/>import Vue from "vue";<br/>import Component from "vue-class-component";<br/>import "vue-class-component/hooks";</span><span id="2fc5" class="mq lc iq mh b gy mv ms l mt mu">Component.registerHooks([<br/>  "beforeRouteEnter",<br/>  "beforeRouteLeave",<br/>  "beforeRouteUpdate",<br/>]);<br/>@Component<br/>export default class Foo extends Vue {<br/>  beforeRouteEnter(to, from, next) {<br/>    console.log("beforeRouteEnter");<br/>    next();<br/>  }<br/>  beforeRouteUpdate(to, from, next) {<br/>    console.log("beforeRouteUpdate");<br/>    next();<br/>  }<br/>  beforeRouteLeave(to, from, next) {<br/>    console.log("beforeRouteLeave");<br/>    next();<br/>  }<br/>}<br/>&lt;/script&gt;</span></pre><p id="8d2b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有带 Vue 路由器钩子类型定义的<code class="fe me mf mg mh b">vue-router-hook-types.ts</code>。</p><p id="e8b3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe me mf mg mh b">main.ts</code>中，我们有:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="ab4c" class="mq lc iq mh b gy mr ms l mt mu">import "./vue-router-hook-types";</span></pre><p id="c776" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">导入类型定义。</p><p id="d318" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在<code class="fe me mf mg mh b">Foo.vue</code>和<code class="fe me mf mg mh b">Bar.vue</code>组件中，我们可以在自动完成菜单中看到<code class="fe me mf mg mh b">beforeRouteEnter</code>、<code class="fe me mf mg mh b">beforeRouteUpdate</code>和<code class="fe me mf mg mh b">beforeRouteLeave</code>钩子，当我们将它们键入组件类代码时。</p><p id="695b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还可以在代码中标注方法的类型。</p><p id="8a55" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="4ebe" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div&gt;<br/>    &lt;button @click="increment"&gt;increment&lt;/button&gt;<br/>    &lt;p&gt;{{ count }}&lt;/p&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="a574" class="mq lc iq mh b gy mv ms l mt mu">&lt;script lang="ts"&gt;<br/>import Vue from "vue";<br/>import Component from "vue-class-component";</span><span id="70e0" class="mq lc iq mh b gy mv ms l mt mu">@Component(({<br/>  watch: {<br/>    count(val: number) {<br/>      this.log(val) <br/>    }<br/>  }<br/>})<br/>export default class HelloWorld extends Vue {<br/>  count: number = 0</span><span id="0f19" class="mq lc iq mh b gy mv ms l mt mu">  log(val: number): void {<br/>    console.log(val)<br/>  }</span><span id="9e4e" class="mq lc iq mh b gy mv ms l mt mu">  increment(){<br/>    this.count++<br/>  }<br/>}<br/>&lt;/script&gt;</span></pre><p id="ce3d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有返回<code class="fe me mf mg mh b">void</code>并接受类型为<code class="fe me mf mg mh b">number</code>的<code class="fe me mf mg mh b">val</code>参数的<code class="fe me mf mg mh b">log</code>方法，</p><p id="1088" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在传递给<code class="fe me mf mg mh b">Component</code>的参数中定义的<code class="fe me mf mg mh b">count</code>观察器中使用它。</p><p id="2ecb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样，我们就不必担心用我们不期望的数据类型传递参数。</p><p id="0b19" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这同样适用于方法的返回类型。</p><h1 id="3234" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="73dc" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用 TypeScript 轻松地注释数据类型，以避免在基于 Vue 类的组件中出错。</p></div></div>    
</body>
</html>