<html>
<head>
<title>Image Manipulation with CamanJS and React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 CamanJS 和 React 进行图像处理</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/image-manipulation-with-camanjs-and-react-af813c615387?source=collection_archive---------4-----------------------#2021-01-04">https://blog.devgenius.io/image-manipulation-with-camanjs-and-react-af813c615387?source=collection_archive---------4-----------------------#2021-01-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/041fbca7a2d4c8bca79239b0386ba84d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*i3-k7w6sRxaqxTmV"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">由<a class="ae kc" href="https://unsplash.com/@hermez777?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Hermes Rivera </a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="54c0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">CamanJS 库允许我们在客户端进行图像处理。</p><p id="02b4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以在 React 这样的框架中使用它。</p><p id="9cbd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解如何使用 CamanJS 和 React 来操作图像。</p><h1 id="9fcd" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">入门指南</h1><p id="a4ca" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们通过使用 Create React App 创建一个 React 项目来使用 CamanJS 和 React。</p><p id="8105" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们运行:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="4c9d" class="mn lc iq mj b gy mo mp l mq mr">npx create-react-app my-project</span></pre><p id="7ae0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中<code class="fe ms mt mu mj b">my-project</code>是项目名称。</p><p id="fd2e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在<code class="fe ms mt mu mj b">public/index.html</code>文件中，我们将 CamanJS 的脚本标签添加到 React 项目的<code class="fe ms mt mu mj b">head</code>标签中:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="a681" class="mn lc iq mj b gy mo mp l mq mr">&lt;script<br/>    src="https://cdnjs.cloudflare.com/ajax/libs/camanjs/4.1.2/caman.full.min.js"<br/>    integrity="sha512-JjFeUD2H//RHt+DjVf1BTuy1X5ZPtMl0svQ3RopX641DWoSilJ89LsFGq4Sw/6BSBfULqUW/CfnVopV5CfvRXA=="<br/>    crossorigin="anonymous"&gt;&lt;/script&gt;</span></pre><p id="bc6b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以将我们想要操作的图像添加到<code class="fe ms mt mu mj b">src</code>文件夹中。</p><p id="c658" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一旦我们做到了这一点，我们可以添加以下内容到<code class="fe ms mt mu mj b">App.js</code>:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="fd0f" class="mn lc iq mj b gy mo mp l mq mr">import React, { useEffect } from "react";<br/>import kittenPic from './kitten.jpg'</span><span id="52f2" class="mn lc iq mj b gy mv mp l mq mr">export default function App() {<br/>  const kitten = React.useRef(null);</span><span id="bca2" class="mn lc iq mj b gy mv mp l mq mr">  useEffect(() =&gt; {<br/>    window.Caman(`#${kitten.current.id}`, function () {<br/>      this.brightness(10);<br/>      this.contrast(30);<br/>      this.sepia(60);<br/>      this.saturation(-30);<br/>      this.render();<br/>    });<br/>  }, [kitten.current]);</span><span id="edb8" class="mn lc iq mj b gy mv mp l mq mr">  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;img<br/>        src={kittenPic}<br/>        alt=""<br/>        style={{ width: 200, height: 200 }}<br/>      /&gt;<br/>      &lt;img<br/>        id="kitten"<br/>        ref={kitten}<br/>        src={kittenPic}<br/>        alt=""<br/>        style={{ width: 200, height: 200 }}<br/>      /&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="881c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们导入图像并将其添加为<code class="fe ms mt mu mj b">img</code>标签的<code class="fe ms mt mu mj b">src</code>。</p><p id="0b18" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">CamanJS 只处理存储在本地项目中的图像。</p><p id="7b57" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在<code class="fe ms mt mu mj b">useEffect</code>钩子中，我们进行图像操作。</p><p id="3606" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">是我们正在操作的图像对象。</p><p id="f349" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们通过 ID 获取图像。ID 是<code class="fe ms mt mu mj b">Caman</code>函数的第一个参数。</p><p id="5a8f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">this.brightness</code>让我们改变亮度。</p><p id="5c96" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">this.contrast</code>让我们改变对比度。</p><p id="7c96" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">this.sepia</code>让我们更改棕褐色调。</p><p id="12b6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">this.saturation</code>让我们改变饱和度。</p><p id="aed0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">this.render</code>渲染新图像。</p><p id="1186" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们应该看到左边是原图，右边是 CamanJS 编辑的图。</p><h1 id="45cb" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">层</h1><p id="0732" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">CamanJS 带有一个分层系统，给了我们更多的编辑能力。</p><p id="5917" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="f2e4" class="mn lc iq mj b gy mo mp l mq mr">import React, { useEffect } from "react";<br/>import kittenPic from './kitten.jpg'</span><span id="8416" class="mn lc iq mj b gy mv mp l mq mr">export default function App() {<br/>  const kitten = React.useRef(null);</span><span id="7cd4" class="mn lc iq mj b gy mv mp l mq mr">  useEffect(() =&gt; {<br/>    window.Caman(`#${kitten.current.id}`, function () {<br/>      this.exposure(-10);<br/>      this.newLayer(function () {<br/>        this.setBlendingMode("multiply");<br/>        this.opacity(80);<br/>        this.fillColor('#6899ba');<br/>        this.copyParent();<br/>        this.filter.brightness(10);<br/>        this.filter.contrast(20);<br/>      });<br/>      this.clip(10);<br/>      this.render();<br/>    });<br/>  }, [kitten.current]);</span><span id="14cb" class="mn lc iq mj b gy mv mp l mq mr">  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;img<br/>        src={kittenPic}<br/>        alt=""<br/>        style={{ width: 200, height: 200 }}<br/>      /&gt;<br/>      &lt;img<br/>        id="kitten"<br/>        ref={kitten}<br/>        src={kittenPic}<br/>        alt=""<br/>        style={{ width: 200, height: 200 }}<br/>      /&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="3912" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在图层之前用<code class="fe ms mt mu mj b">exposure</code>方法改变曝光。</p><p id="b917" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们用<code class="fe ms mt mu mj b">newLayer</code>方法创建图层。</p><p id="67f8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在回调中，我们调用<code class="fe ms mt mu mj b">setBlendingMode</code>来设置混合模式。</p><p id="89e1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">opacity</code>改变不透明度。</p><p id="fc86" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">fillColor</code>改变层的填充颜色。</p><p id="0378" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">copyParent</code>将父层的内容复制到当前层。</p><p id="2f3c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一旦我们调用了<code class="fe ms mt mu mj b">copyParent</code>，我们就可以调用<code class="fe ms mt mu mj b">filter</code>方法来改变图层，使它看起来像我们想要的。</p><h1 id="f73a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="f45d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用 CamanJS 和 React 来操作 React 应用程序中的图像。</p></div></div>    
</body>
</html>