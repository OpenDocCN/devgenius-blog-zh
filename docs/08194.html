<html>
<head>
<title>Adding Advanced TomTom Mapping Features to a Modern Vue + Quasar App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">向现代 Vue + Quasar 应用程序添加高级 TomTom 地图功能</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/adding-advanced-tomtom-mapping-features-to-a-modern-vue-quasar-app-97268f3f49c2?source=collection_archive---------10-----------------------#2022-05-24">https://blog.devgenius.io/adding-advanced-tomtom-mapping-features-to-a-modern-vue-quasar-app-97268f3f49c2?source=collection_archive---------10-----------------------#2022-05-24</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="72b2" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">了解如何添加搜索功能，然后使用计算路线来计算和显示地图路线</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/dc7c5ccf3df60809ce217f7ef0922f67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DJvh8Nuo-Y2BjBFVMthtlA.jpeg"/></div></div></figure><p id="ffee" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">基于地理位置的应用程序帮助用户找到位置，跟踪地点，并在地图上显示这些位置。TomTom Maps API 和 SDK 使开发人员能够更容易地构建这些 web 应用程序，并在不同的设备上提供各种地图服务。</p><p id="7987" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在本教程中，我们将构建一个 Quasar 应用程序来帮助用户搜索和跟踪到特定位置的路线。我们将使用 TomTom 的搜索 API、路由 API 和矩阵路由服务。</p><p id="683e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">你应该熟悉 JavaScript 和 Vue，但你不需要 Quasar 的经验来遵循这个教程。请随意查看我们的另一篇文章，<a class="ae lk" href="https://developer.tomtom.com/blog/build-different/adding-tomtom-maps-vue-quasar-app" rel="noopener ugc nofollow" target="_blank">将 TomTom 地图添加到 Vue + Quasar 应用程序。</a></p><h1 id="d578" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">先决条件</h1><p id="a42b" class="pw-post-body-paragraph ko kp in kq b kr md jo kt ku me jr kw kx mf kz la lb mg ld le lf mh lh li lj ig bi translated">首先，确保节点在本地开发机器上。通过在终端中运行以下命令来检查您是否拥有它:</p><pre class="kd ke kf kg gt mi mj mk ml aw mm bi"><span id="4bb1" class="mn lm in mj b gy mo mp l mq mr">node –v</span></pre><p id="9378" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果你没有节点，<a class="ae lk" href="https://nodejs.org/en/download/" rel="noopener ugc nofollow" target="_blank">下载它</a>。另外，<a class="ae lk" href="https://quasar.dev/start/quasar-cli" rel="noopener ugc nofollow" target="_blank">如果你还没有安装 Quasar CLI </a>。</p><p id="2838" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">你还需要一个 TomTom 开发者账户。你每天都会收到成千上万的免费请求，甚至是商业应用。随着您的成长而付费！</p><h1 id="3172" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">设置项目</h1><p id="d18a" class="pw-post-body-paragraph ko kp in kq b kr md jo kt ku me jr kw kx mf kz la lb mg ld le lf mh lh li lj ig bi translated">我们将设置类星体应用程序。首先，使用 Quasar CLI 创建一个新的 Vue 项目:</p><pre class="kd ke kf kg gt mi mj mk ml aw mm bi"><span id="ffad" class="mn lm in mj b gy mo mp l mq mr">quasar create route-tracker</span></pre><p id="ff94" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">该命令创建一个提示，让您添加关于项目和合适的开发环境的详细信息。成功创建应用程序后，Quasar CLI 会显示命令，以切换到新创建的目录。运行以下命令启动您的应用程序:</p><pre class="kd ke kf kg gt mi mj mk ml aw mm bi"><span id="dba2" class="mn lm in mj b gy mo mp l mq mr">quasar dev</span></pre><p id="df19" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">结果应该是这样的:</p><p id="e7d0" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">接下来，我们通过安装所需的 Map SDKs 和 API 在应用程序中设置 TomTom。因此，我们将安装 TomTom 的服务:</p><pre class="kd ke kf kg gt mi mj mk ml aw mm bi"><span id="b4d0" class="mn lm in mj b gy mo mp l mq mr">npm install @tomtom-international/web-sdk-maps @tomtom-international/web-sdk-services</span></pre><p id="c2b9" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">然后，安装地图 SDK:</p><pre class="kd ke kf kg gt mi mj mk ml aw mm bi"><span id="7834" class="mn lm in mj b gy mo mp l mq mr">npm i @tomtom-international/web-sdk-maps</span></pre><p id="be8b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">您将需要在这个项目中使用您的 TomTom API 密钥。<a class="ae lk" href="https://developer.tomtom.com/how-to-get-tomtom-api-key" rel="noopener ugc nofollow" target="_blank">这里有一个简单的免费创建指南——不需要信用卡。</a></p><h1 id="e10b" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">创建布局</h1><p id="db70" class="pw-post-body-paragraph ko kp in kq b kr md jo kt ku me jr kw kx mf kz la lb mg ld le lf mh lh li lj ig bi translated">应用程序布局包括用于搜索地点的搜索栏、用于显示地图的地图容器以及分别显示计算距离和时间的结果。此图像演示了用户界面布局:</p><p id="72bb" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">将此代码添加到 MainLayout 文件的 template 部分:</p><pre class="kd ke kf kg gt mi mj mk ml aw mm bi"><span id="38a3" class="mn lm in mj b gy mo mp l mq mr">&lt;q-layout view="lHh Lpr lFf"&gt;<br/>    &lt;q-header elevated&gt;<br/>      &lt;q-toolbar class="bg-deep-purple-8  text-white"&gt;<br/>        &lt;q-toolbar-title &gt;<br/>          Route Tracker<br/>        &lt;/q-toolbar-title&gt;<br/>      &lt;/q-toolbar&gt;<br/>    &lt;/q-header&gt;<br/>     &lt;q-page-container&gt;<br/>     &lt;!-- To handle the search for location --&gt;<br/>      &lt;div class="q-pa-md" &gt;<br/>    &lt;q-form  class="q-gutter-md" &gt;<br/>      &lt;q-input filled v-model="locationQuery" label="Search for an address/location"/&gt;<br/>      &lt;div&gt;<br/>        &lt;q-btn label="Search" type="submit" color="deep-purple-8"/&gt;<br/>      &lt;/div&gt;<br/>    &lt;/q-form&gt;<br/>    &lt;div&gt;<br/>    &lt;!-- To display the result--&gt;<br/>      &lt;p&gt;Destination -  {{routeAddress}} &lt;/p&gt;<br/>      &lt;p&gt; Estimated Route Distance(KM) - {{destinationDistance}}<br/>        &lt;br&gt;<br/>           Estimated Time(MINS) -  {{timeToDestination}}<br/>      &lt;/p&gt;<br/>      &lt;p&gt;<br/>        {{errorMessage}}<br/>      &lt;/p&gt;<br/>    &lt;/div&gt;<br/>    &lt;/div&gt;<br/>    &lt;/q-page-container&gt;<br/>  &lt;/q-layout&gt;</span></pre><p id="e22e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这段代码创建了应用程序的用户界面(UI)布局。</p><h1 id="496c" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">显示地图</h1><p id="9909" class="pw-post-body-paragraph ko kp in kq b kr md jo kt ku me jr kw kx mf kz la lb mg ld le lf mh lh li lj ig bi translated">TomTom Maps APIs 使我们能够在应用程序中显示地图。我们也可以根据自己的喜好设计地图。</p><p id="8bc6" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">Index.template.html，包含 CSS 样式表来处理映射:</p><pre class="kd ke kf kg gt mi mj mk ml aw mm bi"><span id="e1f9" class="mn lm in mj b gy mo mp l mq mr">&lt;link rel='stylesheet' type='text/css' href='https://api.tomtom.com/maps-sdk-for-web/cdn/6.x/6.13.0/maps/maps.css'&gt;</span></pre><p id="563b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">同样，在类星体应用程序中导入 index.template.html TT 物体。这个对象代表了访问与 TomTom 地图和服务相关的所有内容的对象库。</p><pre class="kd ke kf kg gt mi mj mk ml aw mm bi"><span id="c1f1" class="mn lm in mj b gy mo mp l mq mr">import tt from '@tomtom-international/web-sdk-maps'</span></pre><p id="e3f9" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们在 components 文件夹中创建一个 mapDisplay.vue 文件来处理这个部分。该组件将在我们的应用程序中显示地图。然后，我们将地图容器布局添加到 mapDisplay.vue 文件:</p><pre class="kd ke kf kg gt mi mj mk ml aw mm bi"><span id="c694" class="mn lm in mj b gy mo mp l mq mr">&lt;template&gt;<br/>        &lt;div id='map' class='window-height'&gt;&lt;/div&gt;<br/>&lt;/template&gt;</span></pre><p id="68e1" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">接下来，我们创建一个函数来显示地图，并将其添加到 mapDisplay.vue 文件中:</p><pre class="kd ke kf kg gt mi mj mk ml aw mm bi"><span id="4a24" class="mn lm in mj b gy mo mp l mq mr">displayMap(){<br/>            const map = tt.map({  <br/>            key: "8h504Wc4AXL6OPndqhrtKf70AovVBL3V",  <br/>            container:'map', // Container ID <br/>            style: 'tomtom://vector/1/basic-main',  //the specified map style <br/>        });  <br/>        map.addControl(new tt.FullscreenControl());  <br/>        map.addControl(new tt.NavigationControl()); <br/>        const location = [this.longitude,this.latitude];<br/>        const popupOffset = 25; <br/>        const marker = new tt.Marker().setLngLat(location).addTo(map); <br/>        const popup = new tt.Popup({ offset: popupOffset }).setHTML("Your Destination"); <br/>        marker.setPopup(popup).togglePopup();       <br/>       }</span></pre><p id="fbdb" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">然后，我们调用函数，使用 mounted()生命周期方法在 mapDisplay.vue 文件中显示地图:</p><pre class="kd ke kf kg gt mi mj mk ml aw mm bi"><span id="faef" class="mn lm in mj b gy mo mp l mq mr">mounted() {  <br/>        this.displayMap()<br/>     }</span></pre><h1 id="fe42" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">集成搜索 API</h1><p id="4fe4" class="pw-post-body-paragraph ko kp in kq b kr md jo kt ku me jr kw kx mf kz la lb mg ld le lf mh lh li lj ig bi translated">TomTom 的搜索 API 执行各种功能，如模糊搜索、自动完成、地理编码和反向地理编码。</p><h1 id="b478" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">模糊搜索</h1><p id="bcc7" class="pw-post-body-paragraph ko kp in kq b kr md jo kt ku me jr kw kx mf kz la lb mg ld le lf mh lh li lj ig bi translated">我们将主要关注模糊搜索，它搜索医院、酒吧和餐馆等地址和地点。我们还可以将搜索限制在特定的区域或几何图形。</p><p id="bd89" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">查询结果给出了与特定查询文本部分匹配的位置的详细描述。</p><p id="1f5b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">要实现模糊搜索，首先从 MainLayout.vue 中的 SDK 导入 tt 对象:</p><pre class="kd ke kf kg gt mi mj mk ml aw mm bi"><span id="815a" class="mn lm in mj b gy mo mp l mq mr">import tt from "@tomtom-international/web-sdk-services";</span></pre><p id="d63f" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">然后，在 MainLayout.vue 中，创建表单来处理搜索:</p><pre class="kd ke kf kg gt mi mj mk ml aw mm bi"><span id="c970" class="mn lm in mj b gy mo mp l mq mr">&lt;div class="q-pa-md" &gt;<br/>    &lt;q-form @submit="SearchAndCalculateRoute()" class="q-gutter-md" &gt;<br/>      &lt;q-input filled v-model="locationQuery" label="Search for an address/location"/&gt;<br/>      &lt;div&gt;<br/>        &lt;q-btn label="Search" type="submit" color="deep-purple-8"/&gt;<br/>      &lt;/div&gt;<br/>    &lt;/q-form&gt;</span></pre><p id="feed" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">接下来，创建一个函数来处理搜索:</p><pre class="kd ke kf kg gt mi mj mk ml aw mm bi"><span id="1444" class="mn lm in mj b gy mo mp l mq mr">const _this = this<br/>      // Using the fuzzySearch service<br/>    await tt.services.fuzzySearch({<br/>      key: 'INSERT API KEY HERE',<br/>      query: this.locationQuery //The input gotten from the search<br/>    }).then(function (response) {<br/>      _this.routeAddress = response.results[0].address.freeformAddress<br/>      _this.routeLatitude =  response.results[0].position.lat<br/>      _this.routeLongitude = response.results[0].position.lng<br/>    })</span></pre><p id="e564" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这段代码执行搜索功能并显示地址的第一个结果，同时存储纬度和经度以供其他服务使用。</p><p id="51d7" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们还可以添加边界框参数来优化搜索。边界框是搜索结果中的一个有限区域，没有它，搜索将考虑整个世界。该参数接受要搜索的地点的经度和纬度值。</p><pre class="kd ke kf kg gt mi mj mk ml aw mm bi"><span id="d7c0" class="mn lm in mj b gy mo mp l mq mr">&lt;!-- Display the result of the search --&gt;<br/>&lt;p&gt; Destination -  {{routeAddress}} &lt;/p&gt;</span></pre><h1 id="a144" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">兴趣点搜索</h1><p id="148e" class="pw-post-body-paragraph ko kp in kq b kr md jo kt ku me jr kw kx mf kz la lb mg ld le lf mh lh li lj ig bi translated">我们将添加到地图中的另一个功能是能够在所搜索的位置周围找到特定的地方。我们使用兴趣点搜索来做到这一点，这是 TomTom 提供的一种服务，使我们能够找到特定类型的地方，如餐馆、艺术中心，甚至是中转站。</p><p id="19ce" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们将在 mapDisplay.vue 文件中实现这一点，以在地图上显示地点。例如，我们将搜索附近的加油站。要实现模糊搜索，首先从 MainLayout.vue 中的 SDK 导入 tt 对象。tts 对象导入到 mapDisplay.vue 中:</p><pre class="kd ke kf kg gt mi mj mk ml aw mm bi"><span id="9c64" class="mn lm in mj b gy mo mp l mq mr">import tts from "@tomtom-international/web-sdk-services";</span></pre><p id="f707" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">然后，创建一个函数，以便在页面上呈现地图时调用服务:</p><pre class="kd ke kf kg gt mi mj mk ml aw mm bi"><span id="78d8" class="mn lm in mj b gy mo mp l mq mr">tts.services.poiSearch({<br/>            key: 'INSERT API KEY HERE'<br/>            query: Gas Stations,<br/>            center: [ _this.latitude, _this.longitude ]<br/>            })<br/>            .then(function(data) {<br/>              _this.stations = data.results})<br/>              .catch((err) =&gt; {<br/>                console.log(err)<br/>            });</span></pre></div></div>    
</body>
</html>