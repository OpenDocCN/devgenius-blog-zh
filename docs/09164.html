<html>
<head>
<title>Prometheus pod crashes — OOMKilled</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">普罗米修斯舱坠毁——被杀死</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/prometheus-pod-crashes-oomkilled-8ccb68c20909?source=collection_archive---------4-----------------------#2022-08-03">https://blog.devgenius.io/prometheus-pod-crashes-oomkilled-8ccb68c20909?source=collection_archive---------4-----------------------#2022-08-03</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><h1 id="9b4d" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">症状</h1><p id="42db" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">普罗米修斯号仍处于坠毁状态。当您发出以下命令来获取 pod 细节时，Prometheus 容器终止，原因是，<code class="fe lg lh li lj b">OOMKilled</code></p><blockquote class="lk ll lm"><p id="0cdd" class="ki kj ln kk b kl lo kn ko kp lp kr ks lq lr kv kw ls lt kz la lu lv ld le lf ig bi translated">库贝克特尔描述吊舱普罗米修斯-k8s-0 -n 监控</p></blockquote><h1 id="fe5f" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">原因</h1><p id="9b9d" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">问题是，普罗米修斯正在经历高工作量。大量的度量数据需要比 Prometheus 容器上当前可用的内存更多的内存。</p><h1 id="e834" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">解决问题</h1><p id="0ecf" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">以下选项可以解决这个问题。</p><ul class=""><li id="10a0" class="lw lx in kk b kl lo kp lp kt ly kx lz lb ma lf mb mc md me bi translated">可以减少现有的普罗米修斯工作量。通过减小刮擦间隔值来降低<a class="ae mf" href="https://prometheus.io/docs/prometheus/latest/getting_started/#configuring-prometheus-to-monitor-itself" rel="noopener ugc nofollow" target="_blank">刮擦</a>频率</li><li id="bab1" class="lw lx in kk b kl mg kp mh kt mi kx mj lb mk lf mb mc md me bi translated">你可以增加普罗米修斯容器上的内存限制。</li><li id="789d" class="lw lx in kk b kl mg kp mh kt mi kx mj lb mk lf mb mc md me bi translated">您的 Prometheus 容器继续崩溃，并且日志中没有出现错误消息。这种情况可能表明您的 Prometheus 容器内的<code class="fe lg lh li lj b">/prometheus/wal path</code>中剩余了太多数据。要解决此问题，请从容器中删除<code class="fe lg lh li lj b">/wal</code>文件夹和数据段。</li></ul><blockquote class="lk ll lm"><p id="b43b" class="ki kj ln kk b kl lo kn ko kp lp kr ks lq lr kv kw ls lt kz la lu lv ld le lf ig bi translated">k exec-it Prometheus-k8s-0-c Prometheus-RM-RF wal/</p><p id="f64c" class="ki kj ln kk b kl lo kn ko kp lp kr ks lq lr kv kw ls lt kz la lu lv ld le lf ig bi translated">k exec-it Prometheus-k8s-0-c Prometheus-RM-RF *</p></blockquote><p id="931a" class="pw-post-body-paragraph ki kj in kk b kl lo kn ko kp lp kr ks kt lr kv kw kx lt kz la lb lv ld le lf ig bi translated"><strong class="kk io">注</strong>:删除<code class="fe lg lh li lj b">/wal folder can lead to data loss.</code></p></div></div>    
</body>
</html>