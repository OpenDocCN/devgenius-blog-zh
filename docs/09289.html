<html>
<head>
<title>Part 5 — HOW TO: Work with PDF files with Apache PDFBox</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">第 5 部分—如何:使用 Apache PDFBox 处理 PDF 文件</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/part-5-how-to-work-with-pdf-files-with-apache-pdfbox-19bab285f5b6?source=collection_archive---------6-----------------------#2022-08-12">https://blog.devgenius.io/part-5-how-to-work-with-pdf-files-with-apache-pdfbox-19bab285f5b6?source=collection_archive---------6-----------------------#2022-08-12</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="9079" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">谁不喜欢应用经过深思熟虑的解决方案呢？我们中的任何一个人都想写出令自己骄傲的漂亮代码。然而，企业的基本和常见任务并不总是有完美的答案。任何处理过 PDF 文件的人肯定都会同意我的观点。</p><p id="faa4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">幸运的是，Apache PDFBox，一个不错的 Apache 库，在这种情况下可以对我们有所帮助。在今天的教程中，我将演示如何使用这个库在 Java 中创建和读取 PDF 文件，这样您就可以决定这种兴奋是否公平。</p><p id="54f3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">到<strong class="jm io"> <em class="ki">源代码库</em> </strong>的链接将在本教程的末尾添加。</p><h2 id="2420" class="kj kk in bd kl km kn dn ko kp kq dp kr jv ks kt ku jz kv kw kx kd ky kz la lb bi translated">设置项目</h2><p id="fb2b" class="pw-post-body-paragraph jk jl in jm b jn lc jp jq jr ld jt ju jv le jx jy jz lf kb kc kd lg kf kg kh ig bi translated">在您喜欢的 IDE 中创建一个基本的 Java 项目来开始。对于本教程，我将管理我与 Maven 的依赖关系，但 Gradle 也是一个选项。</p><figure class="li lj lk ll gt lm gh gi paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gh gi lh"><img src="../Images/0bdc0c61480a5f6c45fc2a691fb6bfb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E8uNtNR4w6hbKLR-4dreqw.png"/></div></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">设置 Maven 项目</figcaption></figure><p id="15ed" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">并将<code class="fe lx ly lz ma b"><strong class="jm io">Apache PDFBox</strong></code>依赖项添加到<code class="fe lx ly lz ma b"><strong class="jm io">pom.xml</strong></code>文件中:</p><pre class="li lj lk ll gt mb ma mc md aw me bi"><span id="d763" class="kj kk in ma b gy mf mg l mh mi">&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br/>&lt;project <br/>         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"<br/>         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;<br/>    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;<br/><br/>    &lt;groupId&gt;org.example&lt;/groupId&gt;<br/>    &lt;artifactId&gt;apache-pdfbox-demo&lt;/artifactId&gt;<br/>    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;<br/><br/>    &lt;properties&gt;<br/>        &lt;maven.compiler.source&gt;17&lt;/maven.compiler.source&gt;<br/>        &lt;maven.compiler.target&gt;17&lt;/maven.compiler.target&gt;<br/>    &lt;/properties&gt;<br/><br/>    &lt;dependencies&gt;<br/><strong class="ma io">        &lt;dependency&gt;<br/>            &lt;groupId&gt;org.apache.pdfbox&lt;/groupId&gt;<br/>            &lt;artifactId&gt;pdfbox&lt;/artifactId&gt;<br/>            &lt;version&gt;2.0.26&lt;/version&gt;<br/>        &lt;/dependency&gt;</strong><br/>    &lt;/dependencies&gt;<br/><br/>&lt;/project&gt;</span></pre><h2 id="d598" class="kj kk in bd kl km kn dn ko kp kq dp kr jv ks kt ku jz kv kw kx kd ky kz la lb bi translated">文本到 PDF 的写作示例</h2><p id="a410" class="pw-post-body-paragraph jk jl in jm b jn lc jp jq jr ld jt ju jv le jx jy jz lf kb kc kd lg kf kg kh ig bi translated">我将首先演示如何制作一个 PDF 文件，并向其中添加一些文本。从这一点开始，import 语句是隐含的，但不包含在代码片段中。</p><p id="d98b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">应该先创建一个新的<code class="fe lx ly lz ma b"><strong class="jm io">PDDocument</strong></code>，然后在文档中添加一个新页面。<code class="fe lx ly lz ma b"><strong class="jm io">PDPageContentStream</strong></code>可以将文本写入 PDF 页面。在<code class="fe lx ly lz ma b"><strong class="jm io">beginText()</strong></code>和<code class="fe lx ly lz ma b"><strong class="jm io">endText()</strong></code>方法之间，每一行文本都将被写入页面。</p><pre class="li lj lk ll gt mb ma mc md aw me bi"><span id="ba0f" class="kj kk in ma b gy mf mg l mh mi">public class WriteText {<br/><br/>    public static void main(String[] args) {<br/>        try (PDDocument doc = new PDDocument()) {<br/>            PDPage pdPage = new PDPage();<br/>            doc.addPage(pdPage);<br/><br/>            try (PDPageContentStream contentStream = new PDPageContentStream(doc, pdPage)) {<br/>                contentStream.beginText();<br/><br/>                contentStream.setFont(PDType1Font.<strong class="ma io"><em class="ki">TIMES_ROMAN</em></strong>, 12);<br/>                contentStream.setLeading(14.5f);<br/>                contentStream.newLineAtOffset(25, 500);<br/><br/>                for (String line : getPdfContentLines()) {<br/>                    contentStream.showText(line);<br/>                    contentStream.newLine();<br/>                }<br/><br/>                contentStream.endText();<br/>            }<br/><br/>            doc.save("src/main/resources/lorem-ipsum.pdf");<br/>        } catch (IOException ioException) {<br/>            System.<strong class="ma io"><em class="ki">out</em></strong>.println("Handling IOException...");<br/>        }<br/>    }<br/><br/>    static List&lt;String&gt; getPdfContentLines() {<br/>        return Arrays.asList(<br/>                "Lorem ipsum dolor sit amet, consectetur adipiscing elit",<br/>                "sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.",<br/>                "Ut enim ad minim veniam, quis nostrud exercitation ullamco",<br/>                "laboris nisi ut aliquip ex ea commodo consequat.",<br/>                "Duis aute irure dolor in reprehenderit in voluptate velit esse",<br/>                "cillum dolore eu fugiat nulla pariatur.",<br/>                "Excepteur sint occaecat cupidatat non proident",<br/>                "sunt in culpa qui officia deserunt mollit anim id est laborum."<br/>        );<br/>    }<br/><br/>}</span></pre><p id="4dcd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">当您运行这个简单的程序时，它创建的 PDF 将立即出现在 resources 文件夹中:</p><figure class="li lj lk ll gt lm gh gi paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gh gi mj"><img src="../Images/64a9214b92e3c3397e23d2a5bd021742.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bO3XK04T5XUTVyIIp876yg.png"/></div></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">编写程序执行结果文本</figcaption></figure><h2 id="bb80" class="kj kk in bd kl km kn dn ko kp kq dp kr jv ks kt ku jz kv kw kx kd ky kz la lb bi translated">PDF 转文本阅读示例</h2><p id="4de3" class="pw-post-body-paragraph jk jl in jm b jn lc jp jq jr ld jt ju jv le jx jy jz lf kb kc kd lg kf kg kh ig bi translated">除了创建 PDF 文件，我们还可以根据自己的需要进行读取和处理。</p><pre class="li lj lk ll gt mb ma mc md aw me bi"><span id="70dd" class="kj kk in ma b gy mf mg l mh mi">public class ReadText {<br/><br/>    public static void main(String[] args) {<br/>        File loremIpsumFile = new File("src/main/resources/lorem-ipsum.pdf");<br/>        <br/>        try (PDDocument doc = PDDocument.load(loremIpsumFile)) {<br/>            PDFTextStripper pdfTextStripper = new PDFTextStripper();<br/>            String text = pdfTextStripper.getText(doc);<br/><br/>            System.<strong class="ma io"><em class="ki">out</em></strong>.println("Text size: " + text.length() + " characters.\n");<br/>            System.<strong class="ma io"><em class="ki">out</em></strong>.println(text);<br/>        } catch (IOException ioException) {<br/>            System.<strong class="ma io"><em class="ki">out</em></strong>.println("Handling IOException...");<br/>        }<br/>    }<br/>    <br/>}</span></pre><p id="8dad" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这里，我们加载了在第一部分创建的 PDF 文档，记录了文本的大小，并通过<code class="fe lx ly lz ma b"><strong class="jm io">PDFTextStripper</strong></code>提取了它的内容。</p><p id="66fc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">程序执行后显示以下结果:</p><figure class="li lj lk ll gt lm gh gi paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gh gi mk"><img src="../Images/e091953e28064a445ef380c9154fb1ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5jg_ZlbWK6MaCrJmfgftvw.png"/></div></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">ReadText 程序执行结果</figcaption></figure><h2 id="fcec" class="kj kk in bd kl km kn dn ko kp kq dp kr jv ks kt ku jz kv kw kx kd ky kz la lb bi translated">图像转 PDF 示例</h2><p id="3788" class="pw-post-body-paragraph jk jl in jm b jn lc jp jq jr ld jt ju jv le jx jy jz lf kb kc kd lg kf kg kh ig bi translated">现在，我们将尝试在 PDF 文档中创建一个图像:</p><pre class="li lj lk ll gt mb ma mc md aw me bi"><span id="c261" class="kj kk in ma b gy mf mg l mh mi">public class CreateImage {<br/><br/>    public static void main(String[] args) {<br/>        try (PDDocument doc = new PDDocument()) {<br/>            PDPage pdPage = new PDPage();<br/>            doc.addPage(pdPage);<br/><br/>            String imgFileName = "src/main/resources/deep_field.jpg";<br/>            PDImageXObject pdImage = PDImageXObject.createFromFile(imgFileName, doc);<br/><br/>            int iw = pdImage.getWidth();<br/>            int ih = pdImage.getHeight();<br/>            float offset = 20f;<br/><br/>            try (PDPageContentStream contentStream = new PDPageContentStream(doc, pdPage)){<br/>                contentStream.drawImage(pdImage, offset, offset, iw, ih);<br/>            }<br/><br/>            doc.save("src/main/resources/deep_field.pdf");<br/>        } catch (IOException ioException) {<br/>            System.<strong class="ma io"><em class="ki">out</em></strong>.println("Handling IOException...");<br/>        }<br/>    }<br/><br/>}</span></pre><p id="7abb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在本例中，我们从一个目录中加载了一个图像，创建了一个新的 PDF 文档，并将该图像添加到页面中。然后我们得到图像的宽度和高度，用<code class="fe lx ly lz ma b"><strong class="jm io">PDPageContentStream</strong></code>的<code class="fe lx ly lz ma b"><strong class="jm io">drawImage()</strong></code>绘制到页面中。</p><p id="f4e6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">成功执行该程序将会得到类似的结果:</p><figure class="li lj lk ll gt lm gh gi paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gh gi ml"><img src="../Images/23f341046d99b319a336c4d71037df45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vro_oF5M6uYvWRQUP3QfXw.png"/></div></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">创建图像程序执行结果</figcaption></figure><h2 id="c71b" class="kj kk in bd kl km kn dn ko kp kq dp kr jv ks kt ku jz kv kw kx kd ky kz la lb bi translated">检索文档信息</h2><p id="7f45" class="pw-post-body-paragraph jk jl in jm b jn lc jp jq jr ld jt ju jv le jx jy jz lf kb kc kd lg kf kg kh ig bi translated">文档的作者和创建日期只是 PDF 文档可能提供的信息的两个例子。使用<code class="fe lx ly lz ma b"><strong class="jm io">PDDocumentInformation</strong></code>对象，可以设置和检索数据:</p><pre class="li lj lk ll gt mb ma mc md aw me bi"><span id="f44b" class="kj kk in ma b gy mf mg l mh mi">public class DocumentInformation {<br/><br/>    public static void main(String[] args) {<br/>        try (PDDocument doc = new PDDocument()) {<br/>            PDPage pdPage = new PDPage();<br/>            doc.addPage(pdPage);<br/><br/>            PDDocumentInformation pdi = doc.getDocumentInformation();<br/><br/>            pdi.setAuthor("Ani Talakhadze");<br/>            pdi.setTitle("Apache PDFBox Practice");<br/>            pdi.setCreator("Java Code");<br/><br/>            Calendar date = Calendar.getInstance();<br/>            pdi.setCreationDate(date);<br/>            pdi.setModificationDate(date);<br/><br/>            pdi.setKeywords("Apache, PDF");<br/><br/>            doc.save("src/main/resources/doc_inf.pdf");<br/>        } catch (IOException ioException) {<br/>            System.<strong class="ma io"><em class="ki">out</em></strong>.println("Handling IOException...");<br/>        }<br/>    }<br/><br/>}</span></pre><p id="ea63" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">该示例创建了一些文档信息元数据。可以在 PDF 查看器的 PDF 文档属性中看到这些信息。</p><figure class="li lj lk ll gt lm gh gi paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gh gi mm"><img src="../Images/26707d9ed969bdf7a1ade14b5c02788c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qUgdCGv6iuBUNj82pchvtQ.png"/></div></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">文档属性</figcaption></figure></div><div class="ab cl mn mo hr mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="ig ih ii ij ik"><p id="18a1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这个简短的教程中，我们演示了 Apache PDFBox 库使用的简单案例。如果有兴趣，你可以访问<a class="ae mu" href="https://pdfbox.apache.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> <em class="ki">官方文档</em> </strong> </a>并探索其功能。</p><p id="6a15" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你错过了什么，所有代码都可以在我的<a class="ae mu" href="https://github.com/anitalakhadze/apache-pdfbox-demo" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> <em class="ki"> GitHub 资源库</em> </strong> </a>上找到。</p><p id="e0b3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果您对本系列即将推出的博客有任何问题、评论或建议，请告诉我。</p><p id="cb01" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">敬请关注，不要错过以下教程！</strong></p></div></div>    
</body>
</html>