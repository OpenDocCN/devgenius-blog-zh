<html>
<head>
<title>React and FastAPI Login System</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React 和 FastAPI 登录系统</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/react-and-fastapi-login-system-370ca4e8ddc?source=collection_archive---------1-----------------------#2021-12-13">https://blog.devgenius.io/react-and-fastapi-login-system-370ca4e8ddc?source=collection_archive---------1-----------------------#2021-12-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/737866ffd0c1287515c4f667fcd43298.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*t1mr2JRSE-L3nwlmgp-Tpg.jpeg"/></div></figure><h1 id="6a0e" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">React FastAPI 登录游戏攻略</h1><p id="987e" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在本教程中，我们将使用 React 和 FastAPI Python 创建一个登录系统。</p><p id="365b" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">FastAPI 是一个 Python 框架。这是一个高性能的框架，可以用来快速设置后端应用程序。</p><p id="5804" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">另一方面，React 是由脸书开发的 JavaScript 框架。</p><p id="f765" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">还有，如果你是那种看视频学得比较好的类型，试试这个<a class="ae lv" href="https://www.youtube.com/watch?v=5y5HX3EJZMg" rel="noopener ugc nofollow" target="_blank"> <strong class="ku ir"> React 和 FastAPI 登录</strong> </a></p><p id="56a6" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">现在，让我们开始吧。</p><h1 id="3c57" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">React 和 FastAPI Python 构建 React 应用程序(前端)</h1><p id="ca9a" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">让我们设置一个 React 的新应用程序。在本教程中，我将使用 JavaScript。如果你愿意，你可以选择不要打字稿。</p><p id="9b99" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">打开命令提示符并运行以下命令。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="a25a" class="mf jv iq mb b gy mg mh l mi mj">npx create-react-app my-rasyue-app<br/>// once the script runs sucessfully, run below.<br/>cd my-rasyue-app<br/>npm start</span></pre><p id="68cd" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">现在，打开您喜欢的 IDE 并打开<code class="fe mk ml mm mb b">my-rasyue-app</code>文件夹。</p><h1 id="00b4" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">配置我们的 React 应用程序(前端)</h1><p id="63dc" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">概括地说，我们的 React 应用程序应该:</p><ol class=""><li id="61fd" class="mn mo iq ku b kv lq kz lr ld mp lh mq ll mr lp ms mt mu mv bi translated">有一个登录页面和一个个人资料页面(受保护的网页，只有登录后才能访问)</li><li id="a632" class="mn mo iq ku b kv mw kz mx ld my lh mz ll na lp ms mt mu mv bi translated">有一个注销按钮，它将清除存储在<code class="fe mk ml mm mb b">localStorage</code>中的 JWT</li><li id="a75e" class="mn mo iq ku b kv mw kz mx ld my lh mz ll na lp ms mt mu mv bi translated">登录页面将有一个登录表单，有用户名和电子邮件两个输入。</li><li id="8892" class="mn mo iq ku b kv mw kz mx ld my lh mz ll na lp ms mt mu mv bi translated">在登录表单提交时，我们将使用 axios 向后端发送 POST 请求(FastAPI Python)</li></ol><p id="5379" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">好了，让我们开始吧！</p><h1 id="b8f0" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">创建登录页面</h1><p id="e548" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">运行以下命令安装<code class="fe mk ml mm mb b">react-router-dom</code>和<code class="fe mk ml mm mb b">axios</code></p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="72d7" class="mf jv iq mb b gy mg mh l mi mj">npm install react-router-dom@6<br/>npm install axios</span></pre><p id="0319" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">打开你的<code class="fe mk ml mm mb b">index.js</code>，粘贴以下内容。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="de69" class="mf jv iq mb b gy mg mh l mi mj">import React from 'react';<br/>import ReactDOM from 'react-dom';<br/>import './index.css';<br/>import App from './App';<br/>import reportWebVitals from './reportWebVitals';<br/>import { BrowserRouter } from "react-router-dom";<br/>import 'bootstrap/dist/css/bootstrap.min.css';</span><span id="8f4c" class="mf jv iq mb b gy nb mh l mi mj">ReactDOM.render(<br/>  &lt;BrowserRouter&gt;<br/>    &lt;App /&gt;<br/>  &lt;/BrowserRouter&gt;,<br/>  document.getElementById('root')<br/>);</span><span id="f8f1" class="mf jv iq mb b gy nb mh l mi mj">// If you want to start measuring performance in your app, pass a function<br/>// to log results (for example: reportWebVitals(console.log))<br/>// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals<br/>reportWebVitals();</span></pre><p id="a38e" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">我们用&lt; <code class="fe mk ml mm mb b">BrowserRouter</code> &gt;包装<code class="fe mk ml mm mb b">App</code>，以允许在应用程序中使用<code class="fe mk ml mm mb b">Routes</code>。</p><p id="bc84" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">现在，打开你的<code class="fe mk ml mm mb b">App.js</code>，粘贴以下内容。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="fed9" class="mf jv iq mb b gy mg mh l mi mj">import './App.css';<br/>import {<br/>  Route,<br/>  Routes,<br/>} from "react-router-dom";</span><span id="349c" class="mf jv iq mb b gy nb mh l mi mj">import Login from './Login.js'<br/>import Profile from './Profile.js'<br/></span><span id="94d8" class="mf jv iq mb b gy nb mh l mi mj">function App() {</span><span id="b282" class="mf jv iq mb b gy nb mh l mi mj">  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;Routes&gt;<br/>        &lt;Route path="/" element={&lt;Login /&gt;} /&gt;<br/>        &lt;Route<br/>          path="/profile"<br/>          element={&lt;Profile /&gt;}<br/>        /&gt;<br/>      &lt;/Routes&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}<br/></span><span id="26fe" class="mf jv iq mb b gy nb mh l mi mj">export default App;</span></pre><p id="ceca" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">我们现在必须创建两个新文件<code class="fe mk ml mm mb b">Login.js</code>和<code class="fe mk ml mm mb b">Profile.js</code></p><p id="76af" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">继续创建这两个文件。</p><p id="4ce1" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">在<code class="fe mk ml mm mb b">Login.js</code>内部，粘贴以下内容。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="0fa5" class="mf jv iq mb b gy mg mh l mi mj">export default function Login(){</span><span id="ca2e" class="mf jv iq mb b gy nb mh l mi mj">    return(<br/>        &lt;&gt;<br/>        <br/>            &lt;div style = {{minHeight: 800, marginTop: 20 }}&gt;<br/>                &lt;h1&gt;Login Page&lt;/h1&gt;<br/>            &lt;/div&gt;<br/>        <br/>        &lt;/&gt;<br/>    )<br/>}</span></pre><p id="a5db" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">在<code class="fe mk ml mm mb b">Profile.js</code>内部，粘贴以下内容。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="cacb" class="mf jv iq mb b gy mg mh l mi mj">export default function Profile(){</span><span id="36b5" class="mf jv iq mb b gy nb mh l mi mj">    return(<br/>        &lt;&gt;<br/>        <br/>            &lt;div style = {{minHeight: 800, marginTop: 20 }}&gt;<br/>                &lt;h1&gt;Profile Page&lt;/h1&gt;<br/>            &lt;/div&gt;<br/>            <br/>        &lt;/&gt;<br/>    )<br/>}</span></pre><p id="3dab" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">打开浏览器并打开<code class="fe mk ml mm mb b">localhost:3000</code></p><p id="78e5" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">你应该有这样的东西。</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nc"><img src="../Images/ccd5daed087cfcb140c8221dc4921876.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*aXXSmqVyszyeeDCy.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk translated">React 登录页面</figcaption></figure><p id="ab54" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">到目前为止，我们已经创建了 2 个新页面，<code class="fe mk ml mm mb b">Profile</code>和<code class="fe mk ml mm mb b">Login</code>。我们还在<code class="fe mk ml mm mb b">App.js</code>文件中定义了<code class="fe mk ml mm mb b">Routes</code>。</p><p id="1c59" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">不要太花哨。</p><h1 id="2d98" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">设置身份验证并制作受保护的页面</h1><p id="8ac4" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">是时候为 React 设置我们的身份验证了。</p><p id="bdca" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">创建一个新文件<code class="fe mk ml mm mb b">Auth.js</code>并粘贴以下内容</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="80ae" class="mf jv iq mb b gy mg mh l mi mj">import {<br/>    Navigate ,<br/>    useLocation<br/>  } from "react-router-dom";</span><span id="8671" class="mf jv iq mb b gy nb mh l mi mj">export const setToken = (token) =&gt;{</span><span id="c5f4" class="mf jv iq mb b gy nb mh l mi mj">    // set token in localStorage<br/>    localStorage.setItem('rasyueToken', token)</span><span id="a185" class="mf jv iq mb b gy nb mh l mi mj">}</span><span id="6dbc" class="mf jv iq mb b gy nb mh l mi mj">export const fetchToken = (token) =&gt;{</span><span id="71ce" class="mf jv iq mb b gy nb mh l mi mj">    // fetch the token<br/>    return localStorage.getItem('rasyueToken')</span><span id="a705" class="mf jv iq mb b gy nb mh l mi mj">}<br/></span><span id="03ac" class="mf jv iq mb b gy nb mh l mi mj">export function RequireToken({children}) {</span><span id="f71a" class="mf jv iq mb b gy nb mh l mi mj">    <br/>    let auth = fetchToken()<br/>    let location = useLocation();<br/>  <br/>    if (!auth) {<br/>      <br/>      return &lt;Navigate to="/" state={{ from: location }} /&gt;;<br/>    }<br/>  <br/>    return children;<br/>}</span></pre><p id="c541" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">打开<code class="fe mk ml mm mb b">App.js</code>并用以下内容替换。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="4855" class="mf jv iq mb b gy mg mh l mi mj">import './App.css';<br/>import {<br/>  Route,<br/>  Routes,<br/>} from "react-router-dom";</span><span id="a234" class="mf jv iq mb b gy nb mh l mi mj">import Login from './Login.js'<br/>import Profile from './Profile.js'</span><span id="bb4a" class="mf jv iq mb b gy nb mh l mi mj">import {RequireToken} from './Auth.js'</span><span id="6d18" class="mf jv iq mb b gy nb mh l mi mj">function App() {</span><span id="598a" class="mf jv iq mb b gy nb mh l mi mj">  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;Routes&gt;<br/>        &lt;Route path="/" element={&lt;Login /&gt;} /&gt;<br/>        &lt;Route<br/>          path="/profile"<br/>          element={<br/>            &lt;RequireToken&gt;<br/>              &lt;Profile /&gt;<br/>            &lt;/RequireToken&gt;<br/>          }<br/>        /&gt;<br/>      &lt;/Routes&gt;<br/>    <br/>    &lt;/div&gt;<br/>  );<br/>}<br/></span><span id="e026" class="mf jv iq mb b gy nb mh l mi mj">export default App;</span></pre><p id="3ff0" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">为了解释我们所做的，我们首先创建了一个新文件<code class="fe mk ml mm mb b">Auth.js</code>，并在其中定义了 3 个函数，即<code class="fe mk ml mm mb b">setToken</code>、<code class="fe mk ml mm mb b">fetchToken</code>和<code class="fe mk ml mm mb b">RequireToken</code></p><p id="2e18" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated"><code class="fe mk ml mm mb b">setToken</code>和<code class="fe mk ml mm mb b">fetchToken</code>用于设置和获取我们存储在<code class="fe mk ml mm mb b">localStorage</code>中的项目。</p><p id="881b" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">如果你不熟悉 localStorage，我建议你在这里 阅读它们<a class="ae lv" href="https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage" rel="noopener ugc nofollow" target="_blank"> <strong class="ku ir"/></a></p><p id="eca4" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated"><code class="fe mk ml mm mb b">RequireToken</code>用于<code class="fe mk ml mm mb b">App.js</code>中的<code class="fe mk ml mm mb b">Route</code>。该函数将接收子路径，并确定是否允许用户访问该路径。</p><p id="4550" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">这是使页面受到保护的步骤，在本例中，我们使<code class="fe mk ml mm mb b">Profile</code>页面受到保护。</p><p id="0579" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">如果令牌不可用，用户将无法访问令牌。</p><p id="2245" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">让我们完成 React 应用程序登录的最后一部分。</p><h1 id="ec93" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">React FastAPI —完成登录表单</h1><p id="8508" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">打开你的<code class="fe mk ml mm mb b">Login.js</code>并粘贴以下内容。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="012a" class="mf jv iq mb b gy mg mh l mi mj">import {useState} from 'react'<br/>import {setToken, fetchToken} from './Auth.js'<br/>import {useNavigate} from "react-router-dom";<br/>const axios = require('axios');</span><span id="c3e2" class="mf jv iq mb b gy nb mh l mi mj">export default function Login(){</span><span id="7180" class="mf jv iq mb b gy nb mh l mi mj">    const navigate = useNavigate();<br/>    const [username, setUsername] = useState('');<br/>    const [password, setPassword] = useState('');</span><span id="b308" class="mf jv iq mb b gy nb mh l mi mj">    const login = () =&gt;{</span><span id="4525" class="mf jv iq mb b gy nb mh l mi mj">        if(username === '' &amp;&amp; password === ''){</span><span id="04d3" class="mf jv iq mb b gy nb mh l mi mj">            return</span><span id="9971" class="mf jv iq mb b gy nb mh l mi mj">        }else{</span><span id="abf5" class="mf jv iq mb b gy nb mh l mi mj">            console.log('axios')<br/>            axios.post('http://localhost:8000/login', {<br/>                username: username,<br/>                password: password<br/>            })<br/>            .then(function (response) {</span><span id="3282" class="mf jv iq mb b gy nb mh l mi mj">                if(response.data.token){<br/>                    <br/>                    setToken(response.data.token)<br/>                    navigate("/profile");<br/>                }<br/>            })<br/>            .catch(function (error) {</span><span id="d600" class="mf jv iq mb b gy nb mh l mi mj">                console.log(error, 'error');</span><span id="0c2d" class="mf jv iq mb b gy nb mh l mi mj">            });</span><span id="d5d4" class="mf jv iq mb b gy nb mh l mi mj">        }<br/>       <br/>    }</span><span id="fd9b" class="mf jv iq mb b gy nb mh l mi mj">    return(<br/>        &lt;&gt;<br/>           <br/>            &lt;div style = {{minHeight: 800, marginTop: 20 }}&gt;<br/>                &lt;h1&gt;Home Page&lt;/h1&gt;</span><span id="b58a" class="mf jv iq mb b gy nb mh l mi mj">                &lt;div style = {{marginTop: 50 }} &gt;<br/>                    {<br/>                        fetchToken() <br/>                        ? (<br/>                            &lt;p&gt;You are logged in!&lt;/p&gt;<br/>                        ) <br/>                        : (<br/>                            &lt;form&gt;<br/>                            &lt;label style = {{marginRight: 10 }}&gt;Input Username: &lt;/label&gt;<br/>                            &lt;input type = 'text'  onChange={ (e)=&gt; setUsername(e.target.value)} /&gt;<br/>                            &lt;label style = {{marginRight: 10 }}&gt;Input Password: &lt;/label&gt;<br/>                            &lt;input type = 'text'  onChange={ (e)=&gt; setPassword(e.target.value)} /&gt;<br/>                            &lt;button type = 'button' onClick = {login}&gt;Login&lt;/button&gt;<br/>                        &lt;/form&gt;<br/>                        )<br/>                    }<br/>                   </span><span id="f640" class="mf jv iq mb b gy nb mh l mi mj">                &lt;/div&gt;</span><span id="1069" class="mf jv iq mb b gy nb mh l mi mj">            &lt;/div&gt;<br/>            <br/>        &lt;/&gt;<br/>    )<br/>}</span></pre><p id="23b3" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">刷新后，您的页面看起来会像这样。</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nc"><img src="../Images/19d54a2bb22b627122a65858ff7a557f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6CtaRwXvs12ddhco.png"/></div></div></figure><p id="d1a1" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">最后，打开你的<code class="fe mk ml mm mb b">Profile.js</code>,换成下面的。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="6d6d" class="mf jv iq mb b gy mg mh l mi mj">import {useNavigate} from "react-router-dom";</span><span id="bdbe" class="mf jv iq mb b gy nb mh l mi mj">export default function Profile(){</span><span id="20fc" class="mf jv iq mb b gy nb mh l mi mj">    const navigate = useNavigate();</span><span id="7f57" class="mf jv iq mb b gy nb mh l mi mj">    const signOut = () =&gt; {</span><span id="56af" class="mf jv iq mb b gy nb mh l mi mj">        localStorage.removeItem('rasyueToken')<br/>        navigate("/");<br/>    }<br/></span><span id="389e" class="mf jv iq mb b gy nb mh l mi mj">    return(<br/>        &lt;&gt;<br/>        <br/>            &lt;div style = {{minHeight: 800, marginTop: 20 }}&gt;<br/>                &lt;h1&gt;Profile Page&lt;/h1&gt;</span><span id="1330" class="mf jv iq mb b gy nb mh l mi mj">                &lt;p&gt;Hi, this is your profile&lt;/p&gt;</span><span id="f12d" class="mf jv iq mb b gy nb mh l mi mj">                &lt;div&gt;<br/>                    &lt;button type = 'button' onClick= {signOut}&gt;Sign Out&lt;/button&gt;<br/>                &lt;/div&gt;<br/>            &lt;/div&gt;<br/>            <br/>        &lt;/&gt;<br/>    )<br/>}</span></pre><p id="656b" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">如果你现在测试你的登录系统，那么它还不能工作，我们仍然需要创建我们的后端。</p><p id="72e4" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">让我们构建我们的 FastAPI 后端应用程序。</p><h1 id="b741" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">React 和 FastAPI Python 构建 FastAPI 应用程序(后端)</h1><p id="0d3b" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">让我们来设置我们的 FastAPI 应用程序。</p><p id="528c" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">首先，确保你的电脑上安装了<a class="ae lv" href="https://www.python.org/" rel="noopener ugc nofollow" target="_blank"> Python </a>。</p><p id="525b" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">在本教程中，我将使用<a class="ae lv" href="https://www.anaconda.com/products/individual#Downloads" rel="noopener ugc nofollow" target="_blank"> Anaconda </a>和<a class="ae lv" href="https://www.jetbrains.com/pycharm/" rel="noopener ugc nofollow" target="_blank"> Pycharm </a>，因为它对 Python 模块提供了更多的控制，但你不必同时下载 Anaconda 和 Pycharm。</p><p id="e92f" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">只是安装 Python 和使用任何其他 IDE 应该还是可以的。</p><p id="990a" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">创建一个新文件夹，命名为任何你喜欢的名字，在里面创建一个新名字<code class="fe mk ml mm mb b">main.py</code></p><p id="06ef" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">在我们使用<strong class="ku ir"> FastAPI </strong>之前，我们需要先通过<code class="fe mk ml mm mb b">pip</code>安装它。运行以下命令来安装它。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="d007" class="mf jv iq mb b gy mg mh l mi mj">pip install fastapi<br/>pip install "uvicorn[standard]"<br/>pip install pyjwt</span></pre><h1 id="dd5d" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">React FastAPI 登录—构建第一个 Hello World 页面</h1><p id="7689" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">现在，在你的<code class="fe mk ml mm mb b">main.py</code>中，粘贴以下内容。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="052e" class="mf jv iq mb b gy mg mh l mi mj">from fastapi import FastAPI<br/></span><span id="59a1" class="mf jv iq mb b gy nb mh l mi mj">app = FastAPI()<br/></span><span id="8388" class="mf jv iq mb b gy nb mh l mi mj">@app.get("/")<br/>def read_root():<br/>    return {"Hello": "World"}</span></pre><p id="f3ad" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">使用<code class="fe mk ml mm mb b">uvicorn main:app --reload</code>运行您的 FastAPI 应用程序</p><p id="8abc" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">你应该有这样的东西。</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nc"><img src="../Images/4b3b69075d33fcf926f54c2c2cea4374.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*D_N9rtQ-eucv4Nua.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk translated">FastAPI Hello World</figcaption></figure><p id="f5fa" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">下一步是定义一个端点，该端点将处理来自前端应用程序 React 的登录请求。</p><p id="6047" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">端点还应该生成一个 JWT 令牌，并与 MongoDB 数据库通信。</p><h1 id="fcc8" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">React FastAPI 登录—创建登录端点</h1><p id="b1aa" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">打开你的<code class="fe mk ml mm mb b">main.py</code>，粘贴以下内容。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="1be7" class="mf jv iq mb b gy mg mh l mi mj">from fastapi import FastAPI<br/>from typing import Optional<br/>from pydantic import BaseModel</span><span id="347f" class="mf jv iq mb b gy nb mh l mi mj">app = FastAPI()<br/></span><span id="6e31" class="mf jv iq mb b gy nb mh l mi mj">class LoginItem(BaseModel):<br/>    email: str<br/>    password: str<br/></span><span id="f581" class="mf jv iq mb b gy nb mh l mi mj">@app.get("/")<br/>def read_root():<br/>    return {"Hello": "World"}<br/></span><span id="3bba" class="mf jv iq mb b gy nb mh l mi mj">@app.post("/login")<br/>async def login_user(login_item: LoginItem):<br/>    return login_item</span></pre><p id="e06b" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">正如您在上面看到的，我们添加了另一个端点<code class="fe mk ml mm mb b">/login</code>，它只接受带有对象输入<code class="fe mk ml mm mb b">login_item</code>的 post 请求。</p><p id="e521" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">定义类型<code class="fe mk ml mm mb b">LoginItem</code>是为了确保 post 请求输入仅由<code class="fe mk ml mm mb b">email</code>和<code class="fe mk ml mm mb b">password</code>组成。</p><p id="a95d" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">如果我们使用 Postman 测试端点，我们将得到类似这样的结果。</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nl"><img src="../Images/e357966b549f85d4fff8dd97f6904080.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MzwxH3YJoylUn83R.png"/></div></div></figure><h1 id="c762" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">React FastAPI 登录—修改登录端点以生成 JWT</h1><p id="8b8e" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">现在我们已经有了工作的<code class="fe mk ml mm mb b">login</code>端点，下一步是实现生成 JWT 的函数。</p><p id="5f05" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">打开你的<code class="fe mk ml mm mb b">main.py</code>，换成以下。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="b5a7" class="mf jv iq mb b gy mg mh l mi mj">from fastapi import FastAPI</span><span id="b452" class="mf jv iq mb b gy nb mh l mi mj">import jwt<br/>from pydantic import BaseModel<br/>from fastapi.encoders import jsonable_encoder<br/></span><span id="aa97" class="mf jv iq mb b gy nb mh l mi mj">SECRET_KEY = "my_secret_key"<br/>ALGORITHM = "HS256"<br/>ACCESS_TOKEN_EXPIRE_MINUTES = 800</span><span id="9e54" class="mf jv iq mb b gy nb mh l mi mj">dummy_user = {<br/>    "username": "rasyue",<br/>    "password": "rasyuepassword",<br/>}</span><span id="605a" class="mf jv iq mb b gy nb mh l mi mj">app = FastAPI()<br/></span><span id="98a1" class="mf jv iq mb b gy nb mh l mi mj">class LoginItem(BaseModel):<br/>    username: str<br/>    password: str<br/></span><span id="d33e" class="mf jv iq mb b gy nb mh l mi mj">@app.get("/")<br/>def read_root():<br/>    return {"Hello": "World"}<br/></span><span id="28eb" class="mf jv iq mb b gy nb mh l mi mj">@app.post("/login")<br/>async def login_user(login_item: LoginItem):</span><span id="aaeb" class="mf jv iq mb b gy nb mh l mi mj">    data = jsonable_encoder(login_item)<br/>    if dummy_user['username'] == data['username'] and dummy_user['username'] == data['username']:<br/>        encoded_jwt = jwt.encode(data, SECRET_KEY, algorithm=ALGORITHM)<br/>        return {'token': encoded_jwt }<br/>    else:<br/>        return {'message': 'Login failed'}</span></pre><p id="21e1" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">为了解释以上内容，首先，我们在混音中添加了 JWT 模块和<code class="fe mk ml mm mb b"> jsonable_encoder</code>。</p><p id="4fb1" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">接下来，我们定义了<code class="fe mk ml mm mb b">SECRET_KEY</code>、<code class="fe mk ml mm mb b">ALGORITHM</code>和<code class="fe mk ml mm mb b">ACCESS_TOKEN_EXPIRE_MINUTES</code>，稍后我们将使用它们来生成我们的令牌。</p><p id="cd27" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">然后我们定义<code class="fe mk ml mm mb b">dummy_user</code>，它是一个存储我们凭证的对象。请注意，我已经将<code class="fe mk ml mm mb b">LoginItem</code>类中的<code class="fe mk ml mm mb b">email</code>更改为<code class="fe mk ml mm mb b">username</code></p><p id="1f66" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">在实际的应用程序中，当用户登录时，我们应该使用来自数据库的数据，但是为了简单起见，使用硬编码的凭证也可以。</p><p id="6a9b" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">继续使用 Postman 测试您的端点。</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nc"><img src="../Images/d879cff5ff7bcfebd9f96954f917420a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*o_4vO6ylivhR8l5G.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk translated">登录失败的邮递员</figcaption></figure><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nc"><img src="../Images/87271c2d5a674f4513a6f0d0459e0058.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*puj8q9-u2Uf7qKj8.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk translated">邮递员送来的代币</figcaption></figure><p id="f40e" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">这就是我们的后端。</p><h1 id="a1b9" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">测试我们的登录表单</h1><p id="11e7" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">最后，一切都设置好了，让我们测试一下我们的登录系统。</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nc"><img src="../Images/1d87f4c28357ac6029d29159537c5e3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qDuZdzkfuqAa5STr.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk translated">React 主页</figcaption></figure><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nc"><img src="../Images/a08cd31d6779d078d9b16366b958728d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*52Uus_ZdpZ6V2trN.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk translated">React 个人资料页面</figcaption></figure><p id="eabb" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated"><code class="fe mk ml mm mb b">Profile</code>页面受保护，没有令牌，您将无法访问。尝试注销，看看令牌会发生什么变化。</p><h1 id="23f0" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">结束了</h1><p id="75d5" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">本教程到此为止。</p><p id="cf25" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">如果你有兴趣了解更多类似的教程，请查看我写的这个你可以很容易跟随的教程，<a class="ae lv" href="https://rasyue.com/programming/creating-login-system-in-angular-and-fastapi/" rel="noopener ugc nofollow" target="_blank"> <strong class="ku ir">在 Angular 和 FastAPI 中创建登录系统</strong> </a></p></div><div class="ab cl nm nn hu no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="ij ik il im in"><p id="49ef" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated"><em class="nt">更多内容请看</em><a class="ae lv" href="http://blog.devgenius.io" rel="noopener ugc nofollow" target="_blank"><em class="nt">blog . dev genius . io</em></a><em class="nt">。</em></p></div></div>    
</body>
</html>