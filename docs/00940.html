<html>
<head>
<title>Continuous Deployment for MkDocs with GitHub Actions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用GitHub动作持续部署MkDocs</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/continuous-deployment-for-mkdocs-with-github-actions-7dceec87f0ea?source=collection_archive---------9-----------------------#2020-06-20">https://blog.devgenius.io/continuous-deployment-for-mkdocs-with-github-actions-7dceec87f0ea?source=collection_archive---------9-----------------------#2020-06-20</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/ef20df4fb526e752911ae93156e23c9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tesxgC19Ip2mXAVf"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">照片由<a class="ae jz" href="https://unsplash.com/@richygreat?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">rich Great</a>在<a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="8a13" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">MkDocs是一个很棒的文档工具，但是每次你做更新的时候，都需要一个部署过程来将你的更新发布到GitHub页面上。为了解决这个问题，我决定学习如何使用GitHub actions在更新被推送到或合并到主分支时自动更新发布的站点。如果你是MkDocs的新手，我当然推荐我以前的博客<a class="ae jz" href="https://parkererickson.github.io/portfolio/blog/gettingStartedWithMkdocs/" rel="noopener ugc nofollow" target="_blank">MkDocs入门</a></p><h1 id="c8c1" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">什么是GitHub动作？</h1><p id="8292" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">GitHub Actions是一个CI/CD工具，直接绑定到GitHub的生态系统中。这使您可以设置工作流，这些工作流可以通过存储库中可能发生的许多不同事件来触发，例如合并或推送到特定分支。在这种情况下，我们将在每次推送和合并到主分支时通过MkDocs触发文档的生成和部署。这里也有很多预置动作可用<a class="ae jz" href="https://github.com/marketplace?type=actions" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="2b3b" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">行动</h1><p id="5e74" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">所有GitHub动作都是用YAML定义的。有两个主要部分需要定义，包括操作应该何时运行，以及当操作被触发时应该发生什么。首先，让我们在存储库的最外层目录中创建一个<code class="fe mb mc md me b">.github</code>目录，然后在<code class="fe mb mc md me b">.github</code>目录中创建一个<code class="fe mb mc md me b">workflows</code>目录。然后创建一个<code class="fe mb mc md me b">main.yml</code>文件，这是定义动作的地方。</p><h1 id="412d" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">何时运行操作</h1><p id="9560" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">我用这个动作来更新我的个人作品集网站以及其他一些只保存文档和GitHub页面内容的存储库。因此，我希望这个操作用主分支中的任何push或pull请求进行更新。我们对此的定义如下:</p><pre class="mf mg mh mi gt mj me mk ml aw mm bi"><span id="a50b" class="mn kz in me b gy mo mp l mq mr">on: <br/>  push: <br/>    branches: [master] <br/>  pull_request:<br/>    branches: [master]</span></pre><h1 id="6e5e" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">定义作业和步骤</h1><p id="86cd" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">在我们决定何时让GitHub运行动作之后，下一步是定义作业和每个作业中需要发生的步骤。为此，我们将只有一项工作，称为构建。这些任务如下:</p><ol class=""><li id="a2bb" class="ms mt in kc b kd ke kh ki kl mu kp mv kt mw kx mx my mz na bi translated">签出主分支——这使用了一个内置的动作，所有GitHub动作都可以使用这个动作将存储库克隆到新启动的容器中。</li><li id="874f" class="ms mt in kc b kd nb kh nc kl nd kp ne kt nf kx mx my mz na bi translated">setup Python 3.7——这也使用了一个内置动作，可用于所有GitHub动作。</li><li id="ef5c" class="ms mt in kc b kd nb kh nc kl nd kp ne kt nf kx mx my mz na bi translated">安装pip和mkdocs-material-<code class="fe mb mc md me b">run</code>关键字用于您希望使用的终端命令。<code class="fe mb mc md me b">pip install mkdocs-material</code>还会自动安装mkdocs和任何其他需要的包依赖项。</li><li id="9c78" class="ms mt in kc b kd nb kh nc kl nd kp ne kt nf kx mx my mz na bi translated">运行<code class="fe mb mc md me b">mkdocs gh-deploy</code>——这将构建文件并将它们部署到GitHub页面。</li></ol><p id="6e14" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">完整的结果如下所示:</p><pre class="mf mg mh mi gt mj me mk ml aw mm bi"><span id="e7e8" class="mn kz in me b gy mo mp l mq mr">name: Build Documentation using MkDocs <br/># Controls when the action will run. Triggers the workflow on push or pull request <br/># events but only for the master branch <br/>on: <br/>  push: <br/>    branches: [master] <br/>  pull_request: <br/>    branches: [master] <br/>jobs: <br/>  build: <br/>    name: Build and Deploy Documentation <br/>    runs-on: ubuntu-latest <br/>    steps: <br/>      - name: Checkout Master <br/>        uses: actions/checkout@v2 </span><span id="eb9f" class="mn kz in me b gy ng mp l mq mr">      - name: Set up Python 3.7 <br/>        uses: actions/setup-python@v2 <br/>        with: <br/>          python-version: '3.x' </span><span id="b9d7" class="mn kz in me b gy ng mp l mq mr">      - name: Install dependencies <br/>        run: | <br/>          python -m pip install --upgrade pip <br/>          pip install mkdocs-material <br/>      - name: Deploy <br/>        run: | <br/>          git pull mkdocs gh-deploy</span></pre><h1 id="4831" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">结论</h1><p id="4752" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">在<code class="fe mb mc md me b">.github/workflows</code>目录下创建了上面的文件之后，应该就可以了！只需在本地提交您的更改并推送到GitHub存储库。您可以在存储库的GitHub页面的<strong class="kc io">动作</strong>选项卡上查看构建的状态。</p></div><div class="ab cl nh ni hr nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="ig ih ii ij ik"><p id="c3ba" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="no">最初发布于</em><a class="ae jz" href="https://parkererickson.github.io/portfolio/blog/MkDocsCD/" rel="noopener ugc nofollow" target="_blank"><em class="no">https://Parker Erickson . github . io</em></a><em class="no">。</em></p></div></div>    
</body>
</html>