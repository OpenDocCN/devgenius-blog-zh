<html>
<head>
<title>Python Pytest Behaviour Driven Framework — pytest-bdd</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python Pytest 行为驱动框架— pytest-bdd</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/python-pytest-behaviour-driven-framework-pytest-bdd-77b3211538dc?source=collection_archive---------3-----------------------#2022-01-18">https://blog.devgenius.io/python-pytest-behaviour-driven-framework-pytest-bdd-77b3211538dc?source=collection_archive---------3-----------------------#2022-01-18</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/6902c0b73a9ad8f68382c635659a92bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LLbINVACnQ8aq-LJcL6hNg.png"/></div></div></figure><p id="b893" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">Pytest 是目前自动化领域广泛使用的框架，具有很大的灵活性和易用性。为了将代码可读性扩展到业务涉众，我们可以使用 pytest-bdd 作为支持库来创建新的或升级现有的框架。</p><p id="4a73" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="kt">行为 vs pytest-bdd : </em></p><p id="6a97" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为什么不表现是任何人在开始使用 python 进行自动化时都会想到的事情。我做了研究，发现作为测试开发人员，任何人都希望测试结果越早越好。到目前为止，Behave 不支持测试的并行执行(根据我的研究)，而 pytest profile 工具可以实现同样的功能，这可能是选择 pytest 而不是 behave 的主要原因。此外，pytest 夹具还有一个额外的优势。</p><p id="9108" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="kt">入门:</em></p><p id="60e6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">安装 pytest-bdd</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="8a74" class="ld le in kz b gy lf lg l lh li">pip install pytest<br/>pip install pytest-bdd<br/>pip install pytest-html</span></pre><p id="543d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="kt">文件夹结构:</em></p><p id="8e62" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">您可以在方便时遵循任何文件夹结构，但要确保所有文件夹都有 __init__。py 文件可用于跨文件夹访问文件。并将 conftest.py、requirement.txt 和 pytest.ini 文件保存在根文件夹中。您的文件夹结构可能如下所示:</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="fcd2" class="ld le in kz b gy lf lg l lh li">project <br/>  features<br/>       feature1.feature<br/>       feature2.feature<br/>  step_defs<br/>       test_testname1.py<br/>       test_testname2.py <br/>  conftest.py   <br/>  pytest.ini   <br/>  requirements.txt<br/>  README.md</span></pre><p id="59aa" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="kt">特征文件:</em></p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="a00b" class="ld le in kz b gy lf lg l lh li">#login.feature</span><span id="e1eb" class="ld le in kz b gy lj lg l lh li">Scenario:  Login to Application<br/>  Given User is on login page<br/>  When User fills valid username and password<br/>  And clicks on submit button<br/>  Then User is able to login and view landing page</span></pre><p id="159e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="kt">生成实现函数:</em></p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="ea8d" class="ld le in kz b gy lf lg l lh li">pytest --generate-missing --feature feature</span></pre><p id="b6d4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">生成的代码将如下所示</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="8bd5" class="ld le in kz b gy lf lg l lh li"><a class="ae lk" href="http://twitter.com/given" rel="noopener ugc nofollow" target="_blank">@given</a>('User is on login page')<br/>def user_is_on_login_page():<br/>    """User is on login page."""<br/>    raise NotImplementedError</span><span id="65d3" class="ld le in kz b gy lj lg l lh li"><a class="ae lk" href="http://twitter.com/when" rel="noopener ugc nofollow" target="_blank">@when</a>('User fills valid username and password')<br/>def user_fills_valid_username_and_password():<br/>    """User fills valid username and password."""<br/>    raise NotImplementedError</span><span id="4460" class="ld le in kz b gy lj lg l lh li"><a class="ae lk" href="http://twitter.com/when" rel="noopener ugc nofollow" target="_blank">@when</a>('clicks on submit button')<br/>def clicks_on_submit_button():<br/>    """clicks on submit button."""<br/>    raise NotImplementedError</span><span id="a0bf" class="ld le in kz b gy lj lg l lh li"><a class="ae lk" href="http://twitter.com/then" rel="noopener ugc nofollow" target="_blank">@then</a>('User is able to login and view landing page')<br/>def user_is_able_to_login_and_view_landing_page():<br/>    """User is able to login and view landing page."""<br/>    raise NotImplementedError</span></pre><p id="8dee" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">实现各自的函数，并将其添加到您的测试 python 文件中。此外，您必须给出各个场景文件的路径，如下所示:</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="eb8b" class="ld le in kz b gy lf lg l lh li">from pytest_bdd import scenarios, given, then</span><span id="1051" class="ld le in kz b gy lj lg l lh li">scenarios('/path/to/feature/file/login.feature') </span><span id="4131" class="ld le in kz b gy lj lg l lh li"><a class="ae lk" href="http://twitter.com/given" rel="noopener ugc nofollow" target="_blank">@given</a>('User is on login page')<br/>def user_is_on_login_page():<br/>    """User is on login page."""<br/>    pass</span><span id="8fc4" class="ld le in kz b gy lj lg l lh li"><a class="ae lk" href="http://twitter.com/when" rel="noopener ugc nofollow" target="_blank">@when</a>('User fills valid username and password')<br/>def user_fills_valid_username_and_password():<br/>    """User fills valid username and password."""<br/>    pass</span><span id="73e8" class="ld le in kz b gy lj lg l lh li"><a class="ae lk" href="http://twitter.com/when" rel="noopener ugc nofollow" target="_blank">@when</a>('clicks on submit button')<br/>def clicks_on_submit_button():<br/>    """clicks on submit button."""<br/>    pass</span><span id="e01c" class="ld le in kz b gy lj lg l lh li"><a class="ae lk" href="http://twitter.com/then" rel="noopener ugc nofollow" target="_blank">@then</a>('User is able to login and view landing page')<br/>def user_is_able_to_login_and_view_landing_page():<br/>    """User is able to login and view landing page."""<br/>    pass</span></pre><p id="c34b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在你可以走了。</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="85ab" class="ld le in kz b gy lf lg l lh li"># To start execution run below command from project root<br/>python -m venv venv <br/>source venv/bin/activate<br/>pip install -r requirements.txt<br/>python -m pytest --html=report.html</span></pre><p id="2cd1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">pytest bdd 提供的其他广泛使用的特性包括单独场景执行、并行执行、参数化等。</p><p id="0d0d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">参考:</p><div class="ll lm gp gr ln lo"><a href="https://pytest-html.readthedocs.io/en/latest/user_guide.html" rel="noopener  ugc nofollow" target="_blank"><div class="lp ab fo"><div class="lq ab lr cl cj ls"><h2 class="bd io gy z fp lt fr fs lu fu fw im bi translated">pytest-html</h2><div class="lv l"><h3 class="bd b gy z fp lt fr fs lu fu fw dk translated">注意，ANSI 代码支持依赖于 ansi2html 包。由于使用了不太宽松的许可证，这个包…</h3></div><div class="lw l"><p class="bd b dl z fp lt fr fs lu fu fw dk translated">pytest-html.readthedocs.io</p></div></div></div></a></div><div class="ll lm gp gr ln lo"><a href="https://pypi.org/project/pytest-bdd/" rel="noopener  ugc nofollow" target="_blank"><div class="lp ab fo"><div class="lq ab lr cl cj ls"><h2 class="bd io gy z fp lt fr fs lu fu fw im bi translated">pytest-bdd</h2><div class="lv l"><h3 class="bd b gy z fp lt fr fs lu fu fw dk translated">pytest-bdd 实现了 Gherkin 语言的一个子集，使项目需求测试自动化，并且…</h3></div><div class="lw l"><p class="bd b dl z fp lt fr fs lu fu fw dk translated">pypi.org</p></div></div><div class="lx l"><div class="ly l lz ma mb lx mc jt lo"/></div></div></a></div><div class="ll lm gp gr ln lo"><a href="https://docs.pytest.org/en/6.2.x/" rel="noopener  ugc nofollow" target="_blank"><div class="lp ab fo"><div class="lq ab lr cl cj ls"><h2 class="bd io gy z fp lt fr fs lu fu fw im bi translated">帮助你编写更好的程序</h2><div class="lv l"><h3 class="bd b gy z fp lt fr fs lu fu fw dk translated">pytest 和数以千计的其他软件包的维护者正在与 Tidelift 合作，以提供商业支持和…</h3></div><div class="lw l"><p class="bd b dl z fp lt fr fs lu fu fw dk translated">docs.pytest.org</p></div></div><div class="lx l"><div class="md l lz ma mb lx mc jt lo"/></div></div></a></div></div></div>    
</body>
</html>