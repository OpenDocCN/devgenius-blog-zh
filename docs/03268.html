<html>
<head>
<title>Top React Hooks — Observables and Scrolling</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">顶部反应挂钩—可观察和滚动</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/top-react-hooks-observables-and-hooks-46ce344d863e?source=collection_archive---------3-----------------------#2020-10-18">https://blog.devgenius.io/top-react-hooks-observables-and-hooks-46ce344d863e?source=collection_archive---------3-----------------------#2020-10-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/0ba78c45f35f1f78b24090c9a7dec1c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VQKFlGy5rEZx1aov"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://unsplash.com/@junfungchin?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">钱杰夫</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="1f58" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Hooks包含了React应用程序中的逻辑代码。</p><p id="4586" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以创建自己的钩子，使用别人提供的钩子。</p><p id="c5df" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看一些有用的React挂钩。</p><h1 id="c937" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">RxJS的反应挂钩</h1><p id="bfe7" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">Rxjs库的React挂钩让我们可以在React组件中使用RxJS可观察对象。</p><p id="621a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要安装它，我们可以运行:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="77b7" class="mn lc iq mj b gy mo mp l mq mr">npm i --save rxjs-hooks</span></pre><p id="ddf5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">或者:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="49c0" class="mn lc iq mj b gy mo mp l mq mr">yarn add rxjs-hooks</span></pre><p id="efa1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以通过书写来使用它:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="1787" class="mn lc iq mj b gy mo mp l mq mr">import React from "react";<br/>import { useObservable } from "rxjs-hooks";<br/>import { interval } from "rxjs";<br/>import { map } from "rxjs/operators";</span><span id="2036" class="mn lc iq mj b gy ms mp l mq mr">export default function App() {<br/>  const value = useObservable(() =&gt; interval(2000).pipe(map(val =&gt; val * 2)));</span><span id="2787" class="mn lc iq mj b gy ms mp l mq mr">  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;h1&gt;{value}&lt;/h1&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="7cbf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe mt mu mv mj b">useObservable</code>钩子来观察<code class="fe mt mu mv mj b">interval</code>。</p><p id="7189" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它返回可观察值。</p><p id="9549" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">pipe</code>操作符让我们修改从<code class="fe mt mu mv mj b">interval</code>可观察值生成的值。</p><p id="4ef9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它还带有<code class="fe mt mu mv mj b">useEventCallback</code>钩子，让我们观察事件对象的变化。</p><p id="639d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="7d25" class="mn lc iq mj b gy mo mp l mq mr">import React from "react";<br/>import { useEventCallback } from "rxjs-hooks";<br/>import { map } from "rxjs/operators";</span><span id="7c20" class="mn lc iq mj b gy ms mp l mq mr">export default function App() {<br/>  const [clickCallback, [description, x, y]] = useEventCallback(<br/>    event$ =&gt;<br/>      event$.pipe(<br/>        map(event =&gt; [event.target.innerHTML, event.clientX, event.clientY])<br/>      ),<br/>    ["nothing", 0, 0]<br/>  );</span><span id="9aba" class="mn lc iq mj b gy ms mp l mq mr">  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;p&gt;<br/>        click position: {x}, {y}<br/>      &lt;/p&gt;<br/>      &lt;p&gt;{description} was clicked.&lt;/p&gt;<br/>      &lt;button onClick={clickCallback}&gt;click foo&lt;/button&gt;<br/>      &lt;button onClick={clickCallback}&gt;click bar&lt;/button&gt;<br/>      &lt;button onClick={clickCallback}&gt;click baz&lt;/button&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="5032" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用一个回调函数调用了<code class="fe mt mu mv mj b">useEventCallback</code>钩子，这个回调函数可以观察到th <code class="fe mt mu mv mj b">event$</code>。</p><p id="1abc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它返回从<code class="fe mt mu mv mj b">pipe</code>操作符返回的管道结果。</p><p id="dd36" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">map</code>让我们返回一个对象，我们可以从中获取点击事件对象属性。</p><p id="0d6f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">钩子返回一个带有<code class="fe mt mu mv mj b">clickCallback</code>的数组，我们可以将它用作点击处理程序。</p><p id="189c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第二个条目是click事件对象。</p><p id="1e20" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第三个参数是一个数组，包含click事件对象中属性的初始值。</p><h1 id="eab0" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">滚动数据挂钩</h1><p id="056a" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">滚动数据钩子库让我们返回关于滚动速度、距离、方向等信息。</p><p id="dcf0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要使用它，我们可以通过运行以下命令来安装它:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="2326" class="mn lc iq mj b gy mo mp l mq mr">yarn add scroll-data-hook</span></pre><p id="36da" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以通过写来使用它:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="62a0" class="mn lc iq mj b gy mo mp l mq mr">import React from "react";<br/>import { useScrollData } from "scroll-data-hook";</span><span id="98ff" class="mn lc iq mj b gy ms mp l mq mr">export default function App() {<br/>  const {<br/>    scrolling,<br/>    time,<br/>    speed,<br/>    direction,<br/>    position,<br/>    relativeDistance,<br/>    totalDistance<br/>  } = useScrollData({<br/>    onScrollStart: () =&gt; {<br/>      console.log("Started scrolling");<br/>    },<br/>    onScrollEnd: () =&gt; {<br/>      console.log("Finished scrolling");<br/>    }<br/>  });</span><span id="839e" class="mn lc iq mj b gy ms mp l mq mr">  return (<br/>    &lt;div&gt;<br/>      &lt;div style={{ position: "fixed" }}&gt;<br/>        &lt;p&gt;{scrolling ? "Scrolling" : "Not scrolling"}&lt;/p&gt;<br/>        &lt;p&gt;Scrolling time: {time} milliseconds&lt;/p&gt;<br/>        &lt;p&gt;Horizontal speed: {speed.x} pixels per second&lt;/p&gt;<br/>        &lt;p&gt;Vertical speed: {speed.y} pixels per second&lt;/p&gt;<br/>        &lt;p&gt;<br/>          Position: {position.x} {position.y}<br/>        &lt;/p&gt;<br/>        &lt;p&gt;<br/>          Direction: {direction.x} {direction.y}<br/>        &lt;/p&gt;<br/>        &lt;p&gt;<br/>          Relative distance: {relativeDistance.x}/{relativeDistance.y}<br/>        &lt;/p&gt;<br/>        &lt;p&gt;<br/>          Total distance: {totalDistance.x}/{totalDistance.y}<br/>        &lt;/p&gt;<br/>      &lt;/div&gt;<br/>      &lt;div&gt;<br/>        {Array(1000)<br/>          .fill()<br/>          .map((_, i) =&gt; (<br/>            &lt;p key={i}&gt;{i}&lt;/p&gt;<br/>          ))}<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="b8d2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用对象调用<code class="fe mt mu mv mj b">useScrollData</code>钩子，该对象有一个在我们滚动时运行的回调函数。</p><p id="27f8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">onScrollStart</code>开始滚动时运行。</p><p id="b30a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">onScrollEnd</code>停止滚动时运行。</p><p id="48bb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">钩子返回一个具有各种属性的对象。</p><p id="82da" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">scrolling</code>是一个布尔值，表示我们是否在滚动。</p><p id="4a55" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">time</code>是我们滚动的时间。</p><p id="7345" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">speed</code>是滚动速度。</p><p id="f355" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">direction</code>是滚动方向。</p><p id="21ac" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">position</code>是滚动位置。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/2943f0b5350e0c0fe5cb001dc9ea700d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*iFqeHaZ67PS5819t"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">安德斯·维德斯科特在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="18b8" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="2232" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">React Hooks for RxJS允许我们在React应用程序中使用Rxjs observables。</p><p id="16df" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">滚动数据钩让我们在应用程序中观察不同类型的滚动数据。</p></div></div>    
</body>
</html>