<html>
<head>
<title>How does AJAX work actually?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AJAX 实际上是如何工作的？</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-does-ajax-actually-work-2f57cf4ddc55?source=collection_archive---------8-----------------------#2022-11-10">https://blog.devgenius.io/how-does-ajax-actually-work-2f57cf4ddc55?source=collection_archive---------8-----------------------#2022-11-10</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="769d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">XHR、jQUERY、AXIOS 和 FETCH 代码示例</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5d237bc0392ba1b2ce7b8965b010e673.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UpG3i_E5UUoOQLiR"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae ky" href="https://unsplash.com/@kirstell7?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Kirstell Pauldoss </a>拍摄的照片</figcaption></figure><p id="b4c5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">AJAX(异步 JavaScript 和 XML)依赖于一个被称为 XMLHttpRequest (XHR)对象的核心组件，该组件由 Mozilla 从微软创建的名为 XMLHTTP 的 ActiveX 对象开发而来(参见<a class="ae ky" href="https://www.xul.fr/en-xml-ajax.html" rel="noopener ugc nofollow" target="_blank"> XUL AJAX </a>)。多年来，已经开发了一些包装器库和框架，如代码中包含 XHR 对象的<a class="ae ky" href="https://jquery.com/" rel="noopener ugc nofollow" target="_blank"> jQuery </a>、<a class="ae ky" href="https://axios-http.com/docs/intro" rel="noopener ugc nofollow" target="_blank"> Axios </a>和<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/developing-ajax-web-pages-e270eb59fc92"> NATURAL AJAX </a>。在某种程度上，不熟悉 AJAX 的开发人员在完全不了解实际的 XHR 对象的情况下就接触了这些库和框架。</p><p id="0a09" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">下图简要说明了 AJAX 或 XHR 对象的工作原理:<br/> (1)客户端(即运行在客户端的 JavaScript)定义 XHR 对象。<br/>(2)XHR 对象向服务器发送对象请求。<br/>(3)XHR 对象(等待并)接收传入的响应。<br/>(4)XHR 对象采取行动。<br/>当 XHR 对象等待响应时，客户端将继续执行其余的代码。这就是所谓的异步过程。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi kz"><img src="../Images/e2aa02eaa8097e86e427deeade6df8b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*xamt28jUXqYgigCykhXMBg.jpeg"/></div></figure><p id="c98b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">W3Schools 的以下示例(参考<a class="ae ky" href="https://www.w3schools.com/xml/tryit.asp?filename=tryajax_xmlhttp" rel="noopener ugc nofollow" target="_blank"> W3Schools AJAX </a>)展示了 AJAX 在实践中是如何工作的。</p><pre class="kj kk kl km gt la lb lc ld aw le bi"><span id="9fd2" class="lf lg in lb b gy lh li l lj lk">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>&lt;body&gt;</span><span id="c1ca" class="lf lg in lb b gy ll li l lj lk">&lt;h1&gt;The XMLHttpRequest Object&lt;/h1&gt;</span><span id="0bf6" class="lf lg in lb b gy ll li l lj lk">&lt;p id="demo"&gt;Let AJAX change this text.&lt;/p&gt;</span><span id="9f10" class="lf lg in lb b gy ll li l lj lk">&lt;button type="button" onclick="loadDoc()"&gt;Change Content&lt;/button&gt;</span><span id="2a7a" class="lf lg in lb b gy ll li l lj lk">&lt;script&gt;</span><span id="bc34" class="lf lg in lb b gy ll li l lj lk"><strong class="lb io">/*(1) DEFINE XMLHTTPREQUEST OBJECT */</strong><br/>function loadDoc() {<br/>  var xhttp = new XMLHttpRequest();<br/>  <strong class="lb io">/*(3) RECEIVE RESPONSE */</strong><br/>  xhttp.onreadystatechange = function() {<br/>    <strong class="lb io">/*(4) TAKE ACTIONS */</strong><br/>    if (this.readyState == 4 &amp;&amp; this.status == 200) {<br/>      document.getElementById("demo").innerHTML = this.responseText;<br/>    }<br/>  };<br/>  xhttp.open("GET", "ajax_info.txt", true);<br/>  <strong class="lb io">/*(2) SEND REQUEST */</strong><br/>  xhttp.send();<br/>}<br/>&lt;/script&gt;</span><span id="e767" class="lf lg in lb b gy ll li l lj lk">&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="8415" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">W3Schools 演示页面允许不熟悉 AJAX 的开发人员通过单击“更改内容”按钮来体验这种效果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lm"><img src="../Images/3515c719449775a65406a3ef8aecab3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YNe67FCZtXHJ-FKSJaarLw.png"/></div></div></figure><p id="6422" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">当点击按钮时，一些新的文本将被插入到页面中，并替换现有的文本。页面根本不需要刷新。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lm"><img src="../Images/4dc03ee0dd66832f4204efd03738338b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lhviM4tkoCpxtKjxC1plbA.png"/></div></div></figure><p id="fade" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">jQuery 和 Axios 旨在通过引入更简单的编码方法来简化 XHR 码的排列。以下是发送 HTTP 请求的三个版本，即(1)普通 XHR，(2) jQuery，和(3) Axios(参考<a class="ae ky" href="https://learning.postman.com/docs/sending-requests/generate-code-snippets/" rel="noopener ugc nofollow" target="_blank">邮递员代码片段</a>)。</p><pre class="kj kk kl km gt la lb lc ld aw le bi"><span id="0c99" class="lf lg in lb b gy lh li l lj lk">/* POSTMAN Snippet:Plain XHR */<br/>// WARNING: For POST requests, body is set to null by browsers.</span><span id="ac58" class="lf lg in lb b gy ll li l lj lk">var xhr = new XMLHttpRequest();<br/>xhr.withCredentials = true;</span><span id="2ac1" class="lf lg in lb b gy ll li l lj lk">xhr.addEventListener("readystatechange", function() {<br/>  if(this.readyState === 4) {<br/>    console.log(this.responseText);<br/>  }<br/>});</span><span id="0881" class="lf lg in lb b gy ll li l lj lk">xhr.open("POST", "<a class="ae ky" href="http://localhost:8190/login" rel="noopener ugc nofollow" target="_blank">http://localhost:8190/login</a>");<br/>xhr.setRequestHeader("Authorization", "Basic YWRtaW46bWFuYWdl");</span><span id="45db" class="lf lg in lb b gy ll li l lj lk">xhr.send();</span></pre><p id="5eff" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">jQuery 简化了请求设置和响应处理代码。</p><pre class="kj kk kl km gt la lb lc ld aw le bi"><span id="f63c" class="lf lg in lb b gy lh li l lj lk">/* POSTMAN Snippet:jQuery */<br/>var settings = {<br/>  "url": "<a class="ae ky" href="http://localhost:8190/login" rel="noopener ugc nofollow" target="_blank">http://localhost:8190/login</a>",<br/>  "method": "POST",<br/>  "timeout": 0,<br/>  "headers": {<br/>    "Authorization": "Basic YWRtaW46bWFuYWdl"<br/>  },<br/>};</span><span id="1569" class="lf lg in lb b gy ll li l lj lk">$.ajax(settings).done(function (response) {<br/>  console.log(response);<br/>});</span></pre><p id="3c06" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Axios 支持客户端和服务器端 JavaScript。这里显示的例子是针对服务器端 JavaScript 的，即 NodeJS。</p><pre class="kj kk kl km gt la lb lc ld aw le bi"><span id="cbd6" class="lf lg in lb b gy lh li l lj lk">/* POSTMAN Snippet:Axios */<br/>var axios = require('axios');</span><span id="39e7" class="lf lg in lb b gy ll li l lj lk">var config = {<br/>  method: 'post',<br/>  url: '<a class="ae ky" href="http://localhost:8190/login'" rel="noopener ugc nofollow" target="_blank">http://localhost:8190/login'</a>,<br/>  headers: { <br/>    'Authorization': 'Basic YWRtaW46bWFuYWdl'<br/>  }<br/>};</span><span id="2015" class="lf lg in lb b gy ll li l lj lk">axios(config)<br/>.then(function (response) {<br/>  console.log(JSON.stringify(response.data));<br/>})<br/>.catch(function (error) {<br/>  console.log(error);<br/>});</span></pre><p id="1d18" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">最近 Mozilla 推出了一个新的 API，他们声称比 AJAX 更强大，称为 Fetch(参见<a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API" rel="noopener ugc nofollow" target="_blank"> Mozilla Fetch API </a>)。下面的代码演示了 Fetch 的用法(参考<a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch" rel="noopener ugc nofollow" target="_blank"> Mozilla 使用 Fetch API </a>)。然而，fetch()是 ECMAScript6 (ES6)的一项功能(参见<a class="ae ky" href="https://www.w3schools.com/jsref/api_fetch.asp" rel="noopener ugc nofollow" target="_blank"> W3School Fetch API </a>)，因此不适用于 ECMAScript/JavaScript 的旧版本(即 2015 年之前)。</p><pre class="kj kk kl km gt la lb lc ld aw le bi"><span id="008e" class="lf lg in lb b gy lh li l lj lk">/* Fetch API */<br/>fetch('<a class="ae ky" href="http://example.com/movies.json'" rel="noopener ugc nofollow" target="_blank">http://example.com/movies.json'</a>)<br/>  .then((response) =&gt; response.json())<br/>  .then((data) =&gt; console.log(data));</span></pre><p id="2d28" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">AJAX 使得 RESTful web 应用程序非常有效。</p><p id="20e1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">未完待续<a class="ae ky" href="https://medium.com/@mohamad.razzi.my/sending-ajax-request-with-jwt-token-to-access-adabas-rest-web-services-28baa254e9ae" rel="noopener">下一部分</a>。</p></div><div class="ab cl ln lo hr lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="ig ih ii ij ik"><p id="0cd1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">本帖是“Adabas &amp; Natural 入门”系列的一部分，包括:<br/>本帖是“Adabas 入门&amp; Natural”系列的一部分，包括:<br/> (1) <a class="ae ky" href="https://medium.com/@mohamad.razzi.my/getting-started-with-adabas-natural-part-1-6597688406ad" rel="noopener">设置 Adabas &amp; Natural 社区版(Docker 版)</a>。<br/> (2) <a class="ae ky" href="https://medium.com/@mohamad.razzi.my/getting-started-with-adabas-natural-part-2-34621e576fa4" rel="noopener">通过 Adabas REST Web app 访问 Adabas 数据库</a>。<br/> (3) <a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/getting-started-with-adabas-natural-part-3-a334822db12"> Adabas“周期组”和“多值”以 JSON 数据格式表示</a>。<br/> (4) <a class="ae ky" href="https://medium.com/@mohamad.razzi.my/getting-started-with-adabas-natural-part-4-728e6977ad4f" rel="noopener">使用 Adabas TCP-IP 节点包访问 Adabas 数据库</a>。<br/> (5) <a class="ae ky" href="https://medium.com/@mohamad.razzi.my/getting-started-with-adabas-natural-part-5-1665a0be42ab" rel="noopener">使用 NaturalONE IDE 的大型机编程(Natural)介绍</a>。<br/> (6) <a class="ae ky" href="https://medium.com/@mohamad.razzi.my/getting-started-with-adabas-natural-part-6-48b4b2fd3e6d" rel="noopener">使用自然编程和自然 IDE 访问 Adabas 数据库</a>。<br/> (7) <a class="ae ky" href="https://medium.com/@mohamad.razzi.my/mainframe-database-programming-fundamentals-b34fd88acf6e" rel="noopener">大型机数据库编程基础</a>。<br/> (8) <a class="ae ky" href="https://medium.com/@mohamad.razzi.my/mainframe-database-programming-27803b92a3a3" rel="noopener">大型机数据库编程中级</a>。<br/> (9) <a class="ae ky" href="https://medium.com/@mohamad.razzi.my/developing-ajax-web-pages-e270eb59fc92" rel="noopener">使用自然 AJAX 框架开发 AJAX 网页</a>。<br/>(10)<a class="ae ky" href="https://medium.com/@mohamad.razzi.my/how-does-ajax-actually-work-2f57cf4ddc55" rel="noopener">AJAX 实际上是如何工作的</a>？<br/> (11) <a class="ae ky" href="https://medium.com/dev-genius/how-does-ajax-actually-work-2f57cf4ddc55" rel="noopener">向 ADABAS REST Web app 发送带有 JWT 令牌的 AJAX 请求</a>。<br/> (12)通过 Java Servlets 和 Java Web Services (SOAP)向 ADABAS REST 服务发送 HTTP 请求。</p></div></div>    
</body>
</html>