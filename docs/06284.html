<html>
<head>
<title>Everything You Need To Know About Dockerfiles</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于Dockerfiles你需要知道的一切</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/everything-you-need-to-know-about-dockerfiles-36a5edcf38f6?source=collection_archive---------12-----------------------#2021-12-27">https://blog.devgenius.io/everything-you-need-to-know-about-dockerfiles-36a5edcf38f6?source=collection_archive---------12-----------------------#2021-12-27</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="604b" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">简单地说，学习如何使用Docker文件创建Docker图像。</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/547872ce76315e1435489b25ae6255a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_gTP-gTBJ3--SHy2zPo8rw.jpeg"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk translated">照片由<a class="ae kw" href="https://unsplash.com/@ourselp?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">菲利普·欧塞尔</a>在<a class="ae kw" href="https://unsplash.com/s/photos/docker?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="6efe" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在过去，我已经写了大量关于Docker的重要性的文章，尤其是现在当我们在云或者混合环境中部署大多数应用程序的时候。然而，世界上仍有许多组织尚未采用Docker。因此，许多公司严重依赖Docker工具来实现高网络可用性、服务连续性和具有高可扩展性的服务提供。</p><p id="eeca" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">Docker映像包含一组指令，这些指令在执行时会创建一个Docker容器。我通常将Docker映像称为应用程序快照或构建应用程序所需的任何东西。Docker图像只能使用docker文件创建。</p><h1 id="0f4f" class="lt lu ir bd lv lw lx ly lz ma mb mc md jx me jy mf ka mg kb mh kd mi ke mj mk bi translated">码头文件</h1><p id="fcfa" class="pw-post-body-paragraph kx ky ir kz b la ml js lc ld mm jv lf lg mn li lj lk mo lm ln lo mp lq lr ls ik bi translated">Docker文件是一个文件，它只包含一系列指令，以及创建Docker映像所需的参数。</p><p id="4857" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">所有Dockerfiles文件必须以<code class="fe mq mr ms mt b"><strong class="kz is">FORM</strong></code>指令开始。<br/> <code class="fe mq mr ms mt b"><strong class="kz is">RUN</strong></code>指令将安装依赖项或更新包。<br/> <code class="fe mq mr ms mt b"><strong class="kz is">COPY</strong></code>指令将源代码从本地复制到Docker镜像上。<br/> <code class="fe mq mr ms mt b"><strong class="kz is">ENTRYPOINT</strong></code>指令允许指定当图像作为容器运行时将运行的命令。</p><p id="b07c" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">这是构建Docker映像时最常用的四个主要指令。<a class="ae kw" rel="noopener ugc nofollow" target="_blank" href="/docker-the-most-loved-platform-every-developer-must-learn-6e5bb702c97b">还有其他命令和指令，可以在这里找到</a>。</p><p id="3027" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">简单的Dockerfile文件通常包含带参数的指令。</p><pre class="kh ki kj kk gu mu mt mv mw aw mx bi"><span id="6cd2" class="my lu ir mt b gz mz na l nb nc"><strong class="mt is">FROM python:3.6</strong></span><span id="7815" class="my lu ir mt b gz nd na l nb nc"><strong class="mt is">RUN pip install flask </strong></span><span id="aab5" class="my lu ir mt b gz nd na l nb nc"><strong class="mt is">COPY . /opt/ </strong></span><span id="c14e" class="my lu ir mt b gz nd na l nb nc"><strong class="mt is">EXPOSE 8080 </strong></span><span id="9b1e" class="my lu ir mt b gz nd na l nb nc"><strong class="mt is">WORKDIR /opt </strong></span><span id="76dc" class="my lu ir mt b gz nd na l nb nc"><strong class="mt is">ENTRYPOINT ["python", "app.py"]</strong></span></pre><h1 id="f708" class="lt lu ir bd lv lw lx ly lz ma mb mc md jx me jy mf ka mg kb mh kd mi ke mj mk bi translated">分层架构</h1><p id="3354" class="pw-post-body-paragraph kx ky ir kz b la ml js lc ld mm jv lf lg mn li lj lk mo lm ln lo mp lq lr ls ik bi translated">当Docker创建一个图像时，它是在一个分层的架构中完成的。指令的每一行都会在Docker映像中产生一个新层，该层仅包含前一层的更改。由于每个层仅保存前一层的更改，因此它也反映在大小中。</p><p id="6486" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">假设Docker文件中的任何层出现故障，当您修复该指令并尝试重建映像时，Docker将重用缓存中以前的层，并继续构建剩余的层。例如，在上面的Dockerfile示例中，有六条指令。这些指令中的每一条都会创建一个层。如果图像构建在<code class="fe mq mr ms mt b"><strong class="kz is">COPY</strong></code>指令中失败，重建图像不会花费时间，因为先前的层将从缓存中取出。因此，重建映像会更快。</p><h1 id="b0d7" class="lt lu ir bd lv lw lx ly lz ma mb mc md jx me jy mf ka mg kb mh kd mi ke mj mk bi translated">常见的Docker相关命令</h1><p id="b94f" class="pw-post-body-paragraph kx ky ir kz b la ml js lc ld mm jv lf lg mn li lj lk mo lm ln lo mp lq lr ls ik bi translated"><strong class="kz is">构建Docker镜像:</strong> <br/> <code class="fe mq mr ms mt b"><strong class="kz is">docker build -t viveknaskar/my-app .</strong></code></p><p id="7d73" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">Dockerfile文件应该在当前的工作目录中。<br/> <code class="fe mq mr ms mt b"><strong class="kz is">-t</strong></code>用于标记码头工人图像。<br/> <code class="fe mq mr ms mt b"><strong class="kz is">viveknaskar/my-app</strong></code>是图像的名称。</p><p id="ec25" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><strong class="kz is">查看建筑各层的历史记录图片:<br/> </strong> <code class="fe mq mr ms mt b"><strong class="kz is">docker history viveknaskar/my-app</strong></code></p><p id="0d5e" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><strong class="kz is">查看操作系统所使用的基本镜像:</strong> <br/> <code class="fe mq mr ms mt b"><strong class="kz is">docker run python:3.6 cat /etc/*release*</strong></code></p><p id="45c2" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">这里，python:3.6是基础映像。</p><p id="6d6b" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><strong class="kz is">从创建的图像创建容器:<br/> </strong> <code class="fe mq mr ms mt b"><strong class="kz is">docker run -p 8888:8080 viveknaskar/my-app</strong></code></p></div><div class="ab cl ne nf hv ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ik il im in io"><p id="8d35" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">Docker就是这么一个重要的学习平台。事实上，<a class="ae kw" href="https://insights.stackoverflow.com/survey/2020#most-loved-dreaded-and-wanted" rel="noopener ugc nofollow" target="_blank"> <em class="nl">根据2020年栈溢出调查，Docker是第二大最受开发者喜爱的平台</em> </a>。我希望你对Dockerfiles有一个简单的了解，知道如何建立Docker files，以及它们在建立Docker形象中的重要性。</p><p id="b120" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">了解Dockerfiles最佳实践的最佳地方是它们的官方文档。 </p></div><div class="ab cl ne nf hv ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ik il im in io"><p id="981c" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">如果你喜欢读这篇文章，你可能也会发现下面的文章值得你花时间去读。</p><div class="nm nn gq gs no np"><a rel="noopener  ugc nofollow" target="_blank" href="/docker-the-most-loved-platform-every-developer-must-learn-6e5bb702c97b"><div class="nq ab fp"><div class="nr ab ns cl cj nt"><h2 class="bd is gz z fq nu fs ft nv fv fx iq bi translated">docker——每个开发人员必须学习的最受欢迎的平台</h2><div class="nw l"><h3 class="bd b gz z fq nu fs ft nv fv fx dk translated">实际上，根据Stackoverflow调查，它是第二大最受开发者喜爱的平台。</h3></div><div class="nx l"><p class="bd b dl z fq nu fs ft nv fv fx dk translated">blog.devgenius.io</p></div></div><div class="ny l"><div class="nz l oa ob oc ny od kq np"/></div></div></a></div><div class="nm nn gq gs no np"><a href="https://javascript.plainenglish.io/7-youtube-channels-that-every-javascript-developer-should-follow-4dcffc9fc0c0" rel="noopener  ugc nofollow" target="_blank"><div class="nq ab fp"><div class="nr ab ns cl cj nt"><h2 class="bd is gz z fq nu fs ft nv fv fx iq bi translated">每个JavaScript开发者都应该关注的7个YouTube频道</h2><div class="nw l"><h3 class="bd b gz z fq nu fs ft nv fv fx dk translated">如果你是一个有抱负的或者经验丰富的开发者，强烈推荐这些YouTube频道。</h3></div><div class="nx l"><p class="bd b dl z fq nu fs ft nv fv fx dk translated">javascript.plainenglish.io</p></div></div><div class="ny l"><div class="oe l oa ob oc ny od kq np"/></div></div></a></div></div><div class="ab cl ne nf hv ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ik il im in io"><p id="4404" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">如果你喜欢阅读有助于你更好地学习、生活和工作的故事，可以考虑 <a class="ae kw" href="https://viveknaskar.medium.com/subscribe" rel="noopener"> <em class="nl">成为</em> </a> <em class="nl">的订阅者。成为会员后，你可以无限制地阅读10000篇故事、文章和作家。每月只要5美元。</em> <a class="ae kw" href="https://viveknaskar.medium.com/membership" rel="noopener"> <em class="nl">如果你使用我的链接</em> </a> <em class="nl">注册，我将获得一点佣金，帮助我写更多的文章。</em></p></div></div>    
</body>
</html>