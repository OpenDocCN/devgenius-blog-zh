<html>
<head>
<title>Creating Highly Available 3-Tier Architecture in AWS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 AWS 中创建高度可用的 3 层架构</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/creating-highly-available-3-tier-architecture-in-aws-ba429dbffcda?source=collection_archive---------3-----------------------#2022-12-13">https://blog.devgenius.io/creating-highly-available-3-tier-architecture-in-aws-ba429dbffcda?source=collection_archive---------3-----------------------#2022-12-13</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/315b9b7dea5a87bffd6a94a53393a846.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C_GvfoFe486wT_D7UixhOw.png"/></div></div></figure><h2 id="f4ef" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">什么是三层架构？</h2><p id="3031" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">它是一种客户机-服务器体系结构，将体系结构分为三层:数据层、应用层和表示层。</p><ol class=""><li id="baa2" class="lm ln in kt b ku lo ky lp ke lq ki lr km ls ll lt lu lv lw bi translated"><strong class="kt io">表示层</strong> —这一层向浏览器发送 HTML、JS 和 CSS。它可能使用 React、Angular、Ember、Aurora 等框架。</li><li id="499c" class="lm ln in kt b ku lx ky ly ke lz ki ma km mb ll lt lu lv lw bi translated"><strong class="kt io">应用</strong> —为应用处理业务逻辑。它可能是用 C#、Java、C++、Python、Ruby 等语言编写的。</li><li id="1785" class="lm ln in kt b ku lx ky ly ke lz ki ma km mb ll lt lu lv lw bi translated"><strong class="kt io">数据库</strong> —这一层通过数据库管理系统提供对应用数据的访问。这可能是 MSSQL、MySQL 或 PostgreSQL 等。</li></ol><p id="6b94" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">假设您正试图使用一个 web 应用程序来查找您所在地区的电影时间，作为三层架构的一个示例。在表示层，您会看到一个包含输入信息字段的网页。例如，你的邮政编码和你想看电影的日期。然后将信息传递给应用层，应用层格式化查询并将其发送给数据库。</p><p id="0e4a" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">数据库系统运行查询并将结果(您所在地理区域内的可用电影列表)返回给应用层，应用层将结果格式化为网页。之后，页面被发送回浏览器，浏览器使用表示层在笔记本电脑或其他设备上显示页面。</p><h2 id="4abc" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">利益</h2><ul class=""><li id="1b7f" class="lm ln in kt b ku kv ky kz ke mf ki mg km mh ll mi lu lv lw bi translated">您可以更新应用程序技术堆栈的一个层，而不会影响其他方面。</li><li id="c6aa" class="lm ln in kt b ku lx ky ly ke lz ki ma km mb ll mi lu lv lw bi translated">不同的开发团队可以专注于不同的专业领域。今天的开发人员更有可能在一个领域拥有深厚的能力，比如前端编码，而不是在整个堆栈上工作。</li><li id="626c" class="lm ln in kt b ku lx ky ly ke lz ki ma km mb ll mi lu lv lw bi translated">可伸缩的应用程序允许您部署到多个数据库并添加额外的 web 服务器，而不是局限于一种特定的技术。例如，单独的后端层允许您部署到多个数据库。</li><li id="c086" class="lm ln in kt b ku lx ky ly ke lz ki ma km mb ll mi lu lv lw bi translated">通过分离表示代码和业务逻辑，它简化了代码库的维护，例如，对业务逻辑的更改不会影响表示代码。</li></ul><h2 id="7667" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">目标</h2><ul class=""><li id="fb28" class="lm ln in kt b ku kv ky kz ke mf ki mg km mh ll mi lu lv lw bi translated">创造一个 VPC</li><li id="b460" class="lm ln in kt b ku lx ky ly ke lz ki ma km mb ll mi lu lv lw bi translated">创建 Web 层</li><li id="64e2" class="lm ln in kt b ku lx ky ly ke lz ki ma km mb ll mi lu lv lw bi translated">创建应用层</li><li id="a96e" class="lm ln in kt b ku lx ky ly ke lz ki ma km mb ll mi lu lv lw bi translated">创建数据库层</li></ul><h1 id="a016" class="mj jw in bd jx mk ml mm ka mn mo mp kd mq mr ms kh mt mu mv kl mw mx my kp mz bi translated">步骤 1:创建 VPC</h1><p id="13ab" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">在此步骤中，我们将为 VPC 总共创建 6 个子网。两个公共子网用于面向 Web 的服务器，四个私有子网。应用层和数据库层各两个。这将跨两个可用性区域进行配置，以确保高可用性。</p><p id="e66e" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">我们的 VPC 将包括一个 NAT 网关，用于私有子网中的主机，以确保它们能够连接到互联网进行更新等。将配置公共和私有路由表。</p><p id="5d15" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">导航到控制台中的<strong class="kt io"> <em class="na"> VPC 仪表盘</em> </strong>，点击<strong class="kt io"> <em class="na">创建 VPC </em> </strong>。</p><p id="8695" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">我们将利用 AWS 的<strong class="kt io"> <em class="na"> VPC 体验</em> </strong>向导来自动创建我们的 VPC 资源。这将为我们创建 internet 网关、子网、NAT 网关和路由表。</p><p id="d040" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">输入您的项目名称并选中自动生成框。选择 2 个公共子网和 4 个私有子网。到目前为止，您的设置应该是这样的。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/2120b8c4886d1e291cf335b0049fad59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*FbbavADscXgvqmcmx_JlTA.png"/></div></figure><p id="0945" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">选择选项以选择在 1 AZ 中创建 NAT 网关。将 VPC 端点选项改为<strong class="kt io"> <em class="na">【无】</em> </strong>。点击<strong class="kt io"> <em class="na">创建 VPC </em> </strong>。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/4fded310c3a243eb6fb8a39ecc352f9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*PR_UFiYLqoFlq00-gW49fQ.png"/></div></figure><p id="80ba" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">现在我们的网络 VPC 图应该是这样的。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nh"><img src="../Images/857c4c011ba87eff96fa4ce924da6114.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vN3seqkwJxODJ9iCWdDzRg.png"/></div></div></figure><p id="81cb" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">向导将为每个专用子网创建一个路由表。在我们的情况下，这是不需要的，我们可以修改其中一个私有路由表，使其包含我们所有的私有子网，以便于管理。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ni"><img src="../Images/b0098d93277e30daba14c06c7f077b07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dmO_ofwKqH1BsCj5HNKaAQ.png"/></div></div></figure><p id="2038" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">让我们修改其中一个路由表，使其包含所有私有子网。我将导航到 VPC &gt;路由表，并将其中一个私有路由表的名称更改为“<strong class="kt io"><em class="na">tier 3 project-rt b-private</em></strong>”。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nj"><img src="../Images/5e3317fadabab1b27cf09e0ba6256291.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jgpXWe7aDZ9FXSxURX-tug.png"/></div></div><figcaption class="nk nl gj gh gi nm nn bd b be z dk translated">显示路由表</figcaption></figure><p id="c2f0" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">点击<strong class="kt io"> <em class="na">路由表</em> </strong> &gt; <strong class="kt io"> <em class="na">子网关联</em> </strong>选项卡然后点击<strong class="kt io"> <em class="na">编辑关联</em> </strong>内<strong class="kt io"> <em class="na">显式子网关联</em> </strong></p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi no"><img src="../Images/9846ff40d14db652620c600f0e2c3d64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EaSTZTVELSpgJCTngxNrGg.png"/></div></div></figure><p id="5ca1" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">选中所有私有子网的复选框，然后单击<strong class="kt io"> <em class="na">保存关联</em> </strong>。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi np"><img src="../Images/e8282d38c02e5bcd822a9e41ddf3552d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4EhpHQH13F_5O949nFY3qA.png"/></div></div></figure><p id="f32c" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">现在我们可以删除其它私有路由表了。勾选子网的复选框，然后从<strong class="kt io"> <em class="na">动作</em> </strong>下拉菜单中点击<strong class="kt io"> <em class="na">删除路由表</em> </strong>。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nq"><img src="../Images/4be6345f7f0d46bf604f6d28564375ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i2_mhijMl6CEuUGZe6swvQ.png"/></div></div></figure><p id="2fea" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">确认删除，我们已经创建了我们的 VPC。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nr"><img src="../Images/7307a2e82dd10095aaf015417fdae88e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vQK2Mk2EAKIjXCWylHCOaA.png"/></div></div></figure><h1 id="eea2" class="mj jw in bd jx mk ml mm ka mn mo mp kd mq mr ms kh mt mu mv kl mw mx my kp mz bi translated">步骤 2:创建 Web 层</h1><p id="edec" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">让我们用应用程序负载平衡器为我们的 web 层创建一个自动扩展组。</p><p id="e234" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">导航到自动缩放组并点击<strong class="kt io"> <em class="na">创建</em> </strong>。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ns"><img src="../Images/00e5f0b7a1517b56644cdf0bcd5fce47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XB3Cugx78FaFvd6e6SPbXw.png"/></div></div></figure><p id="54ae" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">我将我的名字命名为<strong class="kt io"> <em class="na"> WebTier-ASG </em> </strong>，然后点击创建一个<strong class="kt io"> <em class="na">启动模板</em> </strong>。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/8cefb6784923a006a5c2369b15113d2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1q6Olc5_nxK84HDSRjAPkw.png"/></div></div></figure><p id="daf3" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">在新窗口中，配置模板的名称，并选择一个带有 t2.micro 实例类型的自由层 Amazon AMI，然后关联一个密钥对。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nu"><img src="../Images/76a905abae9a3ab946d8c670a19201df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AvxoJiTx1M2X71HyHdT-VA.png"/></div></div></figure><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nv"><img src="../Images/19ce781cee4739f60e073ae88fcc1727.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NlEg1WUzefjW_w9JpDfh4Q.png"/></div></div></figure><p id="1539" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">创建一个新的安全组，给定一个名称，并允许来自任何来源的 HTTP 流量。添加一个规则，理想情况下只允许从您的 IP 使用 SSH。出于演示目的，我将允许它来自任何地方。选择我们创建的 VPC。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nw"><img src="../Images/16de010d92f5cff159502fec7ff676d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FT3UUyehWItqEtWITU3b5Q.png"/></div></div></figure><p id="8d38" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">在<strong class="kt io"> <em class="na">高级网络配置下</em> </strong>添加网络接口<strong class="kt io"> <em class="na">启用</em> </strong>自动分配公网 IP。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nx"><img src="../Images/a8cbc0e0ab4e8a38d8f98668de387184.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gJLgQ4dgQWM_vDRFWPejpQ.png"/></div></div></figure><p id="b873" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">现在将引导映像来安装和运行 apache。展开<strong class="kt io"> <em class="na">高级详情</em> </strong>，在<strong class="kt io"> <em class="na">用户数据</em> </strong>字段输入以下代码。</p><pre class="nc nd ne nf gt ny nz oa bn ob oc bi"><span id="c169" class="od jw in nz b be oe of l og oh">#!/bin/bash<br/>yum update -y<br/>yum install -y httpd<br/>systemctl start httpd<br/>systemctl enable httpd<br/>echo "&lt;html&gt;&lt;body&gt;&lt;h1&gt;My Custom Tier 3 Application!&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;" &gt; /var/www/html/index.html</span></pre><p id="2c57" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">点击<strong class="kt io"> <em class="na">创建启动模板</em> </strong>完成。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oi"><img src="../Images/76a12e46aed7ac9882d3be55e26f8473.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6SZc4p97yw-K-v8wtmG3VA.png"/></div></div></figure><p id="cd1e" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">现在回到自动缩放组向导，从下拉菜单中选择我们刚刚创建的模板，然后点击<strong class="kt io"> <em class="na">下一个</em> </strong>。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oj"><img src="../Images/7bda81dd13e3604fc88ce01dcd151a59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ikExYt8UbdOQrcs1_jLeFA.png"/></div></div></figure><p id="d093" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">选择我们的 VPC，并从下拉列表中选择我们的两个专用子网，然后单击下一步。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ok"><img src="../Images/53dac8c036d98f2d6487283b457bb239.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hQ4kSrBFKsgY5vI6HZK46w.png"/></div></div></figure><p id="fe5f" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">选择<strong class="kt io"> <em class="na">连接新的负载平衡器</em> </strong>和<strong class="kt io"> <em class="na">面向互联网。</em> </strong>选择<strong class="kt io"> <em class="na">创建目标组 t </em> </strong>然后保留所有默认值。点击<strong class="kt io">下一步<em class="na">。</em> </strong></p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ol"><img src="../Images/3aa5cf9023ebb39ea989717b7fd4c1c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t1OWV8fbjqL44PhrlPn3rg.png"/></div></div></figure><p id="b121" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">我们希望任何时候都至少有两台机器处于运行状态。将设置更改为以下内容。然后点击<strong class="kt io"> <em class="na">跳过查看。</em> </strong></p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi om"><img src="../Images/12cc0eedbe676c9e59c554514cba36f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vFT9HgRU-RdnhX8UWcfVWg.png"/></div></div></figure><p id="4cef" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">点击<strong class="kt io"> <em class="na">创建自动缩放组。</em> </strong></p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi on"><img src="../Images/45493234d8cee756168f1f866cdeb997.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mnbbUNMbdKkO_COCr2GoTw.png"/></div></div></figure><p id="4e74" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">现在我们已经创建了 ASG，我们需要更改应用程序负载平衡器的安全组，以允许 internet 流量通过。导航到<strong class="kt io"> <em class="na"> EC2 &gt;负载平衡器</em> </strong>并选择我们的<strong class="kt io"><em class="na">WebTier-ASG-1</em></strong>负载平衡器。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oo"><img src="../Images/c064658484a74f067a977f128cad42fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_UiK-b0TP6q9pJO0WPsTHQ.png"/></div></div></figure><p id="9471" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">转到<strong class="kt io"> <em class="na">操作</em> </strong> &gt;编辑<strong class="kt io"> <em class="na">安全组</em> </strong>然后点击<strong class="kt io"> <em class="na">创建新的安全组</em> </strong>。</p><p id="da73" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">给它一个名字，并选择我们的 VPC。允许来自任何来源的 HTTP 流量。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi op"><img src="../Images/6c4c711f9e7df02ced9359e123c17c96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*raLiZL62-pEPFOIO7ShXWA.png"/></div></div></figure><p id="e9fe" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">现在将安全组与负载平衡器关联起来。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oq"><img src="../Images/4ed0b44c6013d3619b01d8a39afcdaaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*277UEqODGdiFQ8MskDNaGA.png"/></div></div></figure><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi or"><img src="../Images/5d7b4d07a85b82e8bac4b165a4be0b73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wg-dfDvw9QWxsqeBePbTkQ.png"/></div></div></figure><p id="98dd" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">现在，让我们通过将负载平衡器的 DNS 名称复制到 web 浏览器中来进行测试。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi os"><img src="../Images/b2587647bb49f5df0b4b2fa97d61ec96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lUOybmvqL3qqMmUhjUqDNg.png"/></div></div><figcaption class="nk nl gj gh gi nm nn bd b be z dk translated">显示默认网页</figcaption></figure><p id="c439" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">太好了！第一层已经完成，我们可以查看我们的前端服务器。</p><h1 id="0ce1" class="mj jw in bd jx mk ml mm ka mn mo mp kd mq mr ms kh mt mu mv kl mw mx my kp mz bi translated">步骤 3:创建应用层</h1><p id="483b" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">现在我们将创建应用层。这将非常类似于我们的 web 层。我们将把我们的自动伸缩组放在两个私有子网中来托管我们的 EC2 实例。</p><p id="aa60" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">像之前一样创建另一个 ASG 这次把它叫做<strong class="kt io"> <em class="na"> AppTier-ASG </em> </strong>并选择<strong class="kt io"> <em class="na">创建</em> </strong> <strong class="kt io"> <em class="na">启动模板。选择与 web 层相同的 AMI 和实例类型。</em></strong></p><p id="aba5" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">创建新的安全组。这次将 NSG 配置为只允许来自我们的<strong class="kt io"> <em class="na"> WebTier-NSG </em> </strong>的流量。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ot"><img src="../Images/51e60a30a47b2690aee46ee65c1caaa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F8YjQzFgKfMMZvl_swpZjA.png"/></div></div></figure><p id="392a" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">不需要启用公共 IP 分配，因为这些实例将保留在我们的专用子网中。我们不会向用户数据字段添加任何代码。</p><p id="74bd" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">现在回到我们的 ASG 向导，选择我们刚刚创建的启动模板，然后单击<strong class="kt io"> <em class="na">下一步</em> </strong>。选择适当的 VPC 和两个私有子网。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ou"><img src="../Images/76ba1d5ac81979bfe04f2b01ccc2f0d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fCdwMWwoT9Gtv799dVDGAw.png"/></div></div></figure><p id="c10c" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">添加一个新的 ALB，这次选择<strong class="kt io"> <em class="na">内部</em> </strong>为负载均衡方案。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ov"><img src="../Images/08cfcdb147ef69510be329de16322f3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a0KtNV0xRXfGyRjoE1kaJw.png"/></div></div></figure><p id="2608" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">使用我们对 web 层所做的配置来完成向导。我们现在有两个 ASG 和两个 EC2 实例。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ow"><img src="../Images/c30257a9d45a8b7c918699b451d8efff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1VgAPy2Qwb2PSleuATW6fw.png"/></div></div><figcaption class="nk nl gj gh gi nm nn bd b be z dk translated">展示 ASG</figcaption></figure><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ox"><img src="../Images/e6e35f9a1e26e0ff42410f9322643693.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CD_JprYguMMSITShSH_ERg.png"/></div></div><figcaption class="nk nl gj gh gi nm nn bd b be z dk translated">显示 EC2 实例</figcaption></figure><p id="635f" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">现在让我们验证一下，我们可以从 Web 层访问位于我们私有子网中的第 2 层 EC2 实例。连接到一个 web 层实例，并通过私有 IP ping 我们的第 2 层子网中的一个 EC2 实例。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oy"><img src="../Images/07712dc55deb55d09c2490e2bc4e4cb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j6oNWnLK3e3i7AXgYM2kUA.png"/></div></div><figcaption class="nk nl gj gh gi nm nn bd b be z dk translated">显示成功回复</figcaption></figure><p id="7d60" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">我们的 ping 操作成功，并且我们已经正确配置了 NSG。第二层完成了。</p><h1 id="c176" class="mj jw in bd jx mk ml mm ka mn mo mp kd mq mr ms kh mt mu mv kl mw mx my kp mz bi translated">步骤 4:添加数据库层</h1><p id="363c" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">现在我们将添加我们的数据库。我们将利用免费层选项，并在我们的一个 az 中创建一个 MySQL 数据库。</p><p id="1069" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">创建新的安全组。选择我们的 VPC 并创建一个入站规则，只允许来自我们的<strong class="kt io"> <em class="na"> AppTier-NSG </em> </strong>的<strong class="kt io"> <em class="na"> TCP 端口 3306 </em> </strong>的流量。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oz"><img src="../Images/081fac1548ad5c0dd4a79dd34eda6ef2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rJv30KoelgRboWero4B1-g.png"/></div></div><figcaption class="nk nl gj gh gi nm nn bd b be z dk translated">展示 NSG</figcaption></figure><p id="6024" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">在控制台内导航到<strong class="kt io"> <em class="na"> RDS &gt;数据库</em> </strong>和<strong class="kt io"> <em class="na"> </em> </strong>选择<strong class="kt io"> <em class="na">创建数据库</em> </strong></p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi pa"><img src="../Images/f0911b20533b965a0745e3d2da831f0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SsHCyr7DUClB5iF_74u3pA.png"/></div></div></figure><p id="8213" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">选择<strong class="kt io"> <em class="na">标准创建</em> </strong>和<strong class="kt io"> <em class="na"> MySQL </em> </strong>。选择<strong class="kt io"> <em class="na">自由层</em> </strong>并保留默认值。填写密码字段。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi pb"><img src="../Images/5d2b1daf72da66fd45e7faff83c4d23c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*40ejQYmiETFObMZFOnOOlw.png"/></div></div></figure><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi pc"><img src="../Images/cdbbffa762daff4b2daa5616f38209ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WhLcuV9S0DIPu3S92EMYNA.png"/></div></div></figure><p id="d5f0" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">在<strong class="kt io"> <em class="na">连接</em> </strong>部分选择我们的 VPC 和我们的 NSG 为<strong class="kt io"> <em class="na"> VPC 安全组</em> </strong>。选择<strong class="kt io"> <em class="na"> us-west-2a </em> </strong>作为可用区域。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi pd"><img src="../Images/86b237f91f33cdadd47e123a91bb5b42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xGslDe2EckwB0abR2xtBlg.png"/></div></div></figure><p id="93b3" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">点击<strong class="kt io"> <em class="na">创建数据库</em> </strong></p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi pe"><img src="../Images/369533a084648c4ba22565d0a3e06d81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dhqLPfYIpImndxCuCKDSCA.png"/></div></div></figure><p id="9067" class="pw-post-body-paragraph kr ks in kt b ku lo kw kx ky lp la lb ke mc ld le ki md lg lh km me lj lk ll ig bi translated">数据库已经创建，我们完成了本教程。保重！</p></div></div>    
</body>
</html>