<html>
<head>
<title>Let’s Create a Snake game using Flutter and Flame!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让我们用旋舞和火焰创造一个蛇的游戏！</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/lets-create-a-snake-game-using-flutter-and-flame-38482d3cf0ff?source=collection_archive---------2-----------------------#2022-02-23">https://blog.devgenius.io/lets-create-a-snake-game-using-flutter-and-flame-38482d3cf0ff?source=collection_archive---------2-----------------------#2022-02-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="072f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Snake 就是这样一个经典的流派——为数不多的让人会心一笑的记忆之一。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/dd660452f2efebfbace895358c8c94a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*29QqA8fedndq8AQx72BrMA.png"/></div></div></figure><p id="40d0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在本教程中，我们将学习<strong class="kt ir">火焰游戏引擎</strong>的基础知识，并创建一个可玩的<strong class="kt ir">蛇</strong>游戏。这将是<strong class="kt ir">第一次</strong>迭代。我打算实现精灵，动画，音频，人工智能，电源，货币化，和其他各种次要的概念。密切关注最新动态。</p><h1 id="cdac" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated"><strong class="ak">我们开始吧！</strong></h1><p id="1db5" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">如果您只是为了<strong class="kt ir">代码</strong>而来，您可以直接跳到存储库。请留下反馈，给一颗星，或贡献力量！</p><div class="mk ml gp gr mm mn"><a href="https://github.com/erdiizgi/flutter_flame_snake" rel="noopener  ugc nofollow" target="_blank"><div class="mo ab fo"><div class="mp ab mq cl cj mr"><h2 class="bd ir gy z fp ms fr fs mt fu fw ip bi translated">GitHub-erdi izgi/flute _ flame _ snake:一个使用火焰引擎编写的带有颤振的蛇游戏</h2><div class="mu l"><h3 class="bd b gy z fp ms fr fs mt fu fw dk translated">一个用火焰引擎编写的蛇游戏。这个项目是一个应用程序的起点。一些…</h3></div><div class="mv l"><p class="bd b dl z fp ms fr fs mt fu fw dk translated">github.com</p></div></div><div class="mw l"><div class="mx l my mz na mw nb kp mn"/></div></div></a></div><p id="435a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我总是从勾画出我想要实现的目标开始。正如你在下图中看到的，这是一幅非常简单的画。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/0e05e04dfb62a10b0182ef4a5a21cbca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PcXGmAbJz8n-cRnib3NNHQ.jpeg"/></div></div></figure><p id="88bd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">对于这个迭代，我有三个任务。</p><ul class=""><li id="7128" class="nd ne iq kt b ku kv kx ky la nf le ng li nh lm ni nj nk nl bi translated"><strong class="kt ir">基于网格的背景:</strong>虽然可以帮助蛇指引方向，但并不总是必要的。</li><li id="e850" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated"><strong class="kt ir">一条正在生长的蛇:</strong>一群相连的方块在网格上爬行。当蛇吃掉食物时，它会扩大一个正方形。</li><li id="9db9" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated"><strong class="kt ir">食物:</strong>网格上随机出现一个红圈。</li></ul><p id="446a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">不会有花哨的图形，我们将只看到一个组件是如何工作的。</p><h2 id="6c60" class="nr lo iq bd lp ns nt dn lt nu nv dp lx la nw nx lz le ny nz mb li oa ob md oc bi translated">绘制背景</h2><p id="9b4f" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated"><strong class="kt ir">背景</strong>是一项相当基本的任务。</p><ul class=""><li id="d10d" class="nd ne iq kt b ku kv kx ky la nf le ng li nh lm ni nj nk nl bi translated"><strong class="kt ir">画一些</strong>柔和的蓝线形成网格。</li><li id="7939" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">该网格应位于屏幕的<strong class="kt ir">中心</strong>。</li></ul><p id="8248" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">就这样。首先，我们定义<strong class="kt ir">某些参数</strong>来帮助我们计算这个网格的大小。</p><blockquote class="od oe of"><p id="411a" class="kr ks og kt b ku kv jr kw kx ky ju kz oh lb lc ld oi lf lg lh oj lj lk ll lm ij bi translated">小技巧 1:永远使用一个<strong class="kt ir">独立的配置类</strong>，你可以在不影响其他类的情况下微调你的游戏。对游戏的样式和所有文本使用相同的方法。</p></blockquote><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="b973" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这些参数足以进行计算，但我们仍然需要<strong class="kt ir">画布大小</strong>来集中网格。幸运的是，每个<em class="og">火焰游戏</em>实例都可以访问<em class="og">详细说明</em>。因此，我们可以利用它来计算网格偏移。</p><blockquote class="od oe of"><p id="611a" class="kr ks og kt b ku kv jr kw kx ky ju kz oh lb lc ld oi lf lg lh oj lj lk ll lm ij bi translated">提示 2: <strong class="kt ir">火焰游戏</strong>是你游戏的<strong class="kt ir">基础类</strong>。它可以访问有用的设置，如<strong class="kt ir">相机、画布和组件树</strong>。您可以在这里<strong class="kt ir">为您的游戏添加</strong>和<strong class="kt ir">管理</strong>组件。<strong class="kt ir"> onLoad 方法</strong>是初始化游戏的好地方。</p></blockquote><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="6c83" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="og"> SnakeGame </em>和<em class="og"> OffSets </em>就是上面显示的两个类。<em class="og"> SnakeGame </em>访问<em class="og">canvasize</em>并使用它来构造<em class="og"> OffSets </em>对象。这个便利类返回<strong class="kt ir">网格的开始和结束坐标</strong>。最后可以画出我们的背景。</p><blockquote class="od oe of"><p id="b18f" class="kr ks og kt b ku kv jr kw kx ky ju kz oh lb lc ld oi lf lg lh oj lj lk ll lm ij bi translated">提示 3:火焰有一个<strong class="kt ir">组件系统</strong>。有许多不同种类的组件，但最常见的是<strong class="kt ir">位置组件</strong>，它允许您指定实体的位置。这里有三个主要的可重写方法:<strong class="kt ir"> onLoad、render 和 update </strong>。o <strong class="kt ir"> nLoad </strong>()是你初始化组件的地方，<strong class="kt ir"> render </strong>()是你在画布上画东西的地方，<strong class="kt ir"> update </strong>()在每一帧被调用。</p></blockquote><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="d25e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们在<strong class="kt ir">渲染</strong>的第一行绘制一个白色矩形。这将是网格的背景。然后根据<strong class="kt ir">起点和终点坐标点</strong>绘制<strong class="kt ir">垂直线</strong>和<strong class="kt ir">水平线</strong>。读完代码后，您会发现这是多么简单。</p><blockquote class="od oe of"><p id="382e" class="kr ks og kt b ku kv jr kw kx ky ju kz oh lb lc ld oi lf lg lh oj lj lk ll lm ij bi translated">提示 4:火焰有一个<strong class="kt ir"> HasGameRef </strong> Mixin。这包括对<em class="iq">火焰游戏</em>的引用。有了<strong class="kt ir"> gameRef </strong>字段，你可以获得你游戏类的所有公开信息。</p></blockquote><p id="4189" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">最后，我们必须将这个<strong class="kt ir"> <em class="og">背景</em> </strong>组件包含在<strong class="kt ir"> <em class="og">蛇游戏</em> </strong>中，以便在程序启动时渲染。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="1f25" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你可以在下面看到结果。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/bb719d108dfe176b6c69d291d79cc085.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ITYsnRAvWtPIGbqtSrGORQ.png"/></div></div></figure><blockquote class="od oe of"><p id="94c6" class="kr ks og kt b ku kv jr kw kx ky ju kz oh lb lc ld oi lf lg lh oj lj lk ll lm ij bi translated">提示 5:你的游戏类(它扩展了<strong class="kt ir"> FlameGame </strong>)必须用<strong class="kt ir"> GameWidget </strong>包装，才能在任何地方作为 Flutter <strong class="kt ir"> widget </strong>使用。</p></blockquote><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><h2 id="df6d" class="nr lo iq bd lp ns nt dn lt nu nv dp lx la nw nx lz le ny nz mb li oa ob md oc bi translated">蛇形实体</h2><p id="1d09" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">渲染一条蛇就是<strong class="kt ir">渲染网格的单元格</strong>。所以我们先定义一个网格。它不需要成为一个<strong class="kt ir">组件</strong>，因为它只是一个数据结构——<strong class="kt ir">一个 2d 数组。</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="1dff" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我还包含了一个方便的方法<em class="og"> findCell </em>，如果没有找到单元格，它会返回一个边框。每个单元格都将有一个<strong class="kt ir">状态</strong>，我们将根据状态来渲染单元格。此刻，<strong class="kt ir">单元格</strong>组件就会这样出现。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="f15d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这里发生了两件事:</p><ul class=""><li id="545b" class="nd ne iq kt b ku kv kx ky la nf le ng li nh lm ni nj nk nl bi translated">onLoad 方法计算<strong class="kt ir">单元格</strong>的位置。</li><li id="233d" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">render 方法检查<em class="og">单元格类型</em>并决定绘制什么。</li></ul><blockquote class="od oe of"><p id="95b9" class="kr ks og kt b ku kv jr kw kx ky ju kz oh lb lc ld oi lf lg lh oj lj lk ll lm ij bi translated">技巧 6:避免使用大的渲染方法。如果可能，应该使用不同的实用程序类来呈现每个组件。如果你以后需要更新一些东西，这将使它变得更容易。</p></blockquote><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="7fe2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">蛇的身体部位只是一堆<strong class="kt ir">黑色的长方形</strong>。上面的这个实用程序类在将<strong class="kt ir">开始和结束偏移量</strong>绘制到<em class="og">画布</em>之前计算它们。</p><p id="e390" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，一些类需要保持 snake 实体的<strong class="kt ir">状态。出于这个原因，我们设计了一个<em class="og"> Snake </em>类，它只是一个<em class="og"> LinkedList </em>包装器。</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="23be" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我还包含了像 addFirst 和 removeLast 这样的方法，这些方法在蛇移动时会很有用。</p><p id="506d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们现在有了一个<em class="og">网格</em>和一个<em class="og">蛇</em>，但是我们需要一个<strong class="kt ir">容器</strong>类来封装游戏逻辑。这将是<strong class="kt ir"> <em class="og">世界</em> </strong>阶层。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="bfbf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> <em class="og">蛇</em> </strong>对象由<strong class="kt ir"> <em class="og">世界</em> </strong>组件初始化。它也可以用来初始化网格，但我认为这种方法更直观。我们现在有更多的组件必须被添加到游戏中来渲染。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="73d6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">一旦所有的东西都渲染好了，场景就会变成这样。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/4c7fc8fea3fd36066cc8625242f3eb5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3BSrPcVRkmkhM5J6NKc6DA.png"/></div></div></figure><h2 id="95e1" class="nr lo iq bd lp ns nt dn lt nu nv dp lx la nw nx lz le ny nz mb li oa ob md oc bi translated">食物</h2><p id="28b0" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">到目前为止，我们有一个背景和一个静态的蛇。先从食物逻辑说起，再动蛇。网格应该负责为食物随机生成一个单元格，因为它知道哪些单元格是空的。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="6072" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">前面的函数首先<strong class="kt ir">根据<strong class="kt ir">是否为空</strong>过滤</strong>所有单元，然后<strong class="kt ir">生成随机索引</strong>。最后，将<strong class="kt ir"> <em class="og"> cellType </em> </strong>改为<em class="og"> food </em>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="c598" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">上面的这个实用程序类首先计算单元格的中点和半径，然后绘制一个红色的圆。最终结果将如下所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/c38b6c29c236d1cb95de711470055e91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zy2AlTg-rA10482vubX2Xw.png"/></div></div></figure><h2 id="5b1e" class="nr lo iq bd lp ns nt dn lt nu nv dp lx la nw nx lz le ny nz mb li oa ob md oc bi translated">移动蛇</h2><p id="abd7" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">我们需要知道<strong class="kt ir">蛇的方向</strong>才能移动它。第一个方向将'<strong class="kt ir"> <em class="og">向右</em> </strong>. '我们可以使用方向来计算下一个单元格。一旦我们知道了下一个单元格，逻辑就很简单了。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="4503" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们从蛇的身体上取下最后一个细胞，让下一个细胞成为新的头部。这个简单的技巧会给人一种蛇在动的感觉。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi on"><img src="../Images/5fbf791f9d6e05b0a9740c8b88a1c124.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YWibjG01b6zHwz3_sYNr_Q.png"/></div></div></figure><h2 id="085d" class="nr lo iq bd lp ns nt dn lt nu nv dp lx la nw nx lz le ny nz mb li oa ob md oc bi translated">动态 FPS</h2><p id="fca4" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">移动逻辑的问题是，当引擎设置为<strong class="kt ir">每秒 60 帧</strong>时，蛇移动太快。因为这相当于每秒 60 次<strong class="kt ir">移动调用</strong>。因为蛇的速度是游戏难度因素之一，我们应该能够动态调整它<strong class="kt ir"/>。我设计了一个<strong class="kt ir">自定义火焰组件</strong>，它将根据提供的 fps 配置调用更新功能。</p><blockquote class="od oe of"><p id="0a74" class="kr ks og kt b ku kv jr kw kx ky ju kz oh lb lc ld oi lf lg lh oj lj lk ll lm ij bi translated">提示 7: Flame 组件包含一个<strong class="kt ir">更新</strong>方法，该方法采用一个名为<strong class="kt ir"> delta time </strong>的参数。该值代表<strong class="kt ir"><strong class="kt ir"/><strong class="kt ir">前一</strong>帧和<strong class="kt ir">当前</strong>帧之间经过的时间</strong>。</p></blockquote><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="34dc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">它只需<strong class="kt ir">累计δ时间</strong>，然后在达到预定值时运行<strong class="kt ir"><em class="og">updateDynamic</em></strong>功能。如果你回忆一下，我们在上面定义了<strong class="kt ir"> <em class="og">世界</em> </strong>组件；基本上<strong class="kt ir"> <em class="og">世界</em> </strong>组件会<strong class="kt ir">扩展</strong>这个<strong class="kt ir">动态 fps 组件</strong>以可玩的方式运行游戏逻辑。</p><h2 id="133c" class="nr lo iq bd lp ns nt dn lt nu nv dp lx la nw nx lz le ny nz mb li oa ob md oc bi translated">输入处理问题</h2><p id="d5d1" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">我们已经修复了<strong class="kt ir"> FPS 问题</strong>，但是这个解决方案引入了一个新的问题:<strong class="kt ir">输入管理。</strong>通常，在游戏中，你会看到，如果输入是鼠标右键单击，就这样做，等等。然而，因为我们运行在一个<strong class="kt ir">低帧速率</strong>，用户可以在帧之间输入几个输入。我们不想错过他们的意见！</p><p id="f667" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">当这种情况出现时，最常见的解决方案是使用一个<strong class="kt ir">队列</strong>。它只是将输入添加到一个队列中，当帧被渲染时，我们从队列中执行<strong class="kt ir">第一个命令。为了避免有太多的输入等待，我应该限制队列的大小。</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="82f2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在我们的游戏中，输入就是触摸。我想让蛇跟着水龙头的方向走。因此，队列保持屏幕上的<strong class="kt ir">触摸点。</strong></p><p id="403b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我还创建了 evaluateNextInput(snake)方法。这个方法做三件事:</p><ul class=""><li id="96d8" class="nd ne iq kt b ku kv kx ky la nf le ng li nh lm ni nj nk nl bi translated">获取第一个接触点并将其从队列中移除。</li><li id="331f" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">它计算从蛇的头部到触摸位置的位移向量。</li><li id="3b97" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">它根据计算出的向量的方向来决定和设置蛇的方向。</li></ul><blockquote class="od oe of"><p id="2985" class="kr ks og kt b ku kv jr kw kx ky ju kz oh lb lc ld oi lf lg lh oj lj lk ll lm ij bi translated">提示 8: Flame 有一个名为<strong class="kt ir"> TapDetector </strong>的 mixin，它有一个关于 TapUp 的方法(TapUpInfo)。<strong class="kt ir"> TapUpInfo </strong>包含触摸点，因此使用 Flame engine 进行输入处理相当容易。</p></blockquote><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="40e4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在这里，我将<strong class="kt ir"> <em class="og"> TapUpInfo </em> </strong>委托给世界组件，并在那里进行评估。有意义是因为逻辑发生在这个类中。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="ab2f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，我们保持输入处理简单，它不会成为游戏难度的一个因素。</p><h2 id="b369" class="nr lo iq bd lp ns nt dn lt nu nv dp lx la nw nx lz le ny nz mb li oa ob md oc bi translated">养蛇</h2><p id="85ed" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">现在我们的蛇动了，需要喂养，需要成长。<strong class="kt ir">的成长逻辑</strong>也很简单易懂。这和移动逻辑是一样的，但是我们没有移除蛇的最后一部分。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><h2 id="9348" class="nr lo iq bd lp ns nt dn lt nu nv dp lx la nw nx lz le ny nz mb li oa ob md oc bi translated">游戏逻辑</h2><p id="0abd" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">正如您可能理解的那样，将所有代码放在这里是不可能的。请检查仓库的详细资料。但是，我们可以在这里检查主要的游戏逻辑。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><ul class=""><li id="3e16" class="nd ne iq kt b ku kv kx ky la nf le ng li nh lm ni nj nk nl bi translated">我们首先<strong class="kt ir">检查游戏是否结束</strong>，如果没有，我们<strong class="kt ir">评估队列中的下一个输入</strong>。这将设置蛇的方向。</li><li id="88ea" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">基于新的方向，我们<strong class="kt ir">计算下一个单元格</strong>。</li><li id="43b3" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">如果下一个单元格不是边界，我们<strong class="kt ir">检查蛇是否已经崩溃</strong>到它自己。</li><li id="ad24" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">然后我们检查下一个单元的单元类型。如果是<strong class="kt ir">食物</strong>，<strong class="kt ir">蛇生长</strong>并在网格上生成新的食物。<strong class="kt ir">如果没有</strong>，<strong class="kt ir">蛇就移动</strong>。</li></ul><p id="370c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我认为这很清楚。</p><h2 id="acfb" class="nr lo iq bd lp ns nt dn lt nu nv dp lx la nw nx lz le ny nz mb li oa ob md oc bi translated"><a class="ae oo" href="https://erdiizgi.github.io/flutter_flame_snake/" rel="noopener ugc nofollow" target="_blank">网络演示</a></h2><p id="7b96" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">你可以在这里玩<strong class="kt ir"> </strong> <a class="ae oo" href="https://erdiizgi.github.io/flutter_flame_snake/" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir">网页试玩</strong> </a> <strong class="kt ir"> </strong>看看游戏目前的状态。请随时提供反馈，并且<a class="ae oo" href="https://github.com/erdiizgi/flutter_flame_snake" rel="noopener ugc nofollow" target="_blank">为<strong class="kt ir">库做出贡献。</strong> </a></p><h2 id="63bc" class="nr lo iq bd lp ns nt dn lt nu nv dp lx la nw nx lz le ny nz mb li oa ob md oc bi translated">下一次迭代的任务</h2><ul class=""><li id="81cc" class="nd ne iq kt b ku mf kx mg la op le oq li or lm ni nj nk nl bi translated">添加菜单和评分</li><li id="4bbd" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">为蛇使用精灵和动画</li><li id="8306" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">水平设计</li><li id="a883" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">创建一个比屏幕尺寸更大的世界(使用摄影机和视口)</li></ul><p id="d338" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">请为这个游戏提供一些新鲜的想法。你可以跟我来了解项目的最新进展。</p><p id="1942" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">感谢您花时间阅读本文。</p></div><div class="ab cl os ot hu ou" role="separator"><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox"/></div><div class="ij ik il im in"><h1 id="ca56" class="ln lo iq bd lp lq oz ls lt lu pa lw lx jw pb jx lz jz pc ka mb kc pd kd md me bi translated">资源</h1><ul class=""><li id="5c5d" class="nd ne iq kt b ku mf kx mg la op le oq li or lm ni nj nk nl bi translated"><a class="ae oo" href="https://pub.dev/packages/flame" rel="noopener ugc nofollow" target="_blank">安装火焰</a></li><li id="f1be" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated"><a class="ae oo" href="https://github.com/flame-engine/flame" rel="noopener ugc nofollow" target="_blank">火焰储存库</a></li><li id="a34e" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated"><a class="ae oo" href="https://flame-engine.org/" rel="noopener ugc nofollow" target="_blank">火焰网站</a></li><li id="8299" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated"><a class="ae oo" href="https://docs.flame-engine.org/1.0.0/" rel="noopener ugc nofollow" target="_blank">文档</a></li></ul></div></div>    
</body>
</html>