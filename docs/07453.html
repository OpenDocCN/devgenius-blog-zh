<html>
<head>
<title>Where Machine Learning Meets Game Theory</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习和博弈论相遇的地方</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/where-machine-learning-meets-game-theory-f44ff176fe70?source=collection_archive---------6-----------------------#2022-03-26">https://blog.devgenius.io/where-machine-learning-meets-game-theory-f44ff176fe70?source=collection_archive---------6-----------------------#2022-03-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jn jo jp jq gh gi paragraph-image"><div class="ab gu cl jr"><img src="../Images/807bfb2d77fd958cae3f6aa1047e9fbc.png" data-original-src="https://miro.medium.com/v2/format:webp/0*0TJLK09G8PbGfKAR.jpg"/></div></figure><h1 id="af19" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">介绍</h1><p id="7497" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">如果您对刚刚训练的 ML-model 有更多的了解，您就可以知道如何改进它的性能。幸运的是，有一个强大的工具来解释你的模型的行为，叫做<strong class="ku ir"> Shapley 值</strong>。</p><p id="3b60" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">考虑一个二元分类问题。在数据集中，有<em class="lv"> m </em>个特征，<em class="lv"> n </em>个观测值，<em class="lv"> 2 </em>个标签。但从博弈论的观点来看，二分分类是<em class="lv"> m </em>个玩家，<em class="lv"> n </em>个玩轮之间的合作博弈，两种可能的结果(每轮)。</p><p id="8b25" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">每一轮都有助于我们更好地理解玩家的互动如何影响整个游戏的结果。在游戏结束时，我们还可以观察每个玩家在每一轮中对模型输出的影响。</p><h1 id="82a2" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">进口</h1><p id="d5fe" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们将要使用的<a class="ae lw" href="https://github.com/Vice10/datasets/blob/main/churn.csv" rel="noopener ugc nofollow" target="_blank">数据集</a>包含了一家电信公司的客户信息，这些客户要么停止(<strong class="ku ir">流失</strong>、<strong class="ku ir"> 1 </strong>)要么继续(<strong class="ku ir">无流失</strong>、<strong class="ku ir"> 0 </strong>)使用其服务。</p><figure class="lx ly lz ma gt jq"><div class="bz fp l di"><div class="mb mc l"/></div></figure><figure class="lx ly lz ma gt jq gh gi paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="gh gi md"><img src="../Images/8224ba288726c1dc87750393a135db80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qe3oNZpLKw_x7YrZowNXPw.png"/></div></div></figure><h1 id="9318" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">准备好数据集</h1><p id="f981" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">让我们快速浏览一下数据类型为“object”的列。</p><figure class="lx ly lz ma gt jq"><div class="bz fp l di"><div class="mb mc l"/></div></figure><figure class="lx ly lz ma gt jq gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/1638fb0fce089f91318cb09717fa8b68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*P3HSUdcwcc5_Pam976Riyg.png"/></div></figure><p id="28c1" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">显然，有很多分类变量。让我们通过用“否”替换多余的值来简化其中的一些，例如，“没有互联网服务”。我猜这几乎没有打破任何商业逻辑。</p><p id="91bb" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">之后，为了简洁起见，用 1 和 0 替换“是”和“否”值。</p><figure class="lx ly lz ma gt jq"><div class="bz fp l di"><div class="mb mc l"/></div></figure><figure class="lx ly lz ma gt jq gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/a3d2cbceb132c56540779298b1132ec8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/1*B_4_dTPfUvMsRNfrftCuRw.png"/></div></figure><p id="565f" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">一些特征被认为是特殊的。对虚拟变量进行编码，并检查数据集结构。</p><figure class="lx ly lz ma gt jq"><div class="bz fp l di"><div class="mb mc l"/></div></figure><figure class="lx ly lz ma gt jq gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/7bafa47e6d26a99db38d9d0bcedf598d.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*X18jheL0mXtpaAF0jB412w.png"/></div></figure><p id="a515" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">其他三个数字特征应该被缩放，因为它们代表以不同方式测量的值。</p><figure class="lx ly lz ma gt jq"><div class="bz fp l di"><div class="mb mc l"/></div></figure><h1 id="1c3a" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">电子设计自动化(Electronic Design Automation)</h1><p id="1a93" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">让我们更好地了解我们的数字数据。</p><figure class="lx ly lz ma gt jq"><div class="bz fp l di"><div class="mb mc l"/></div></figure><figure class="lx ly lz ma gt jq gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/af625609609374b8f2e6edf0aa88cabc.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/format:webp/1*Clpt4Z7Im4c4iR5bsOeaCw.png"/></div></figure><p id="f8b7" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">条形图有助于更好地理解分类数据。</p><figure class="lx ly lz ma gt jq"><div class="bz fp l di"><div class="mb mc l"/></div></figure><div class="lx ly lz ma gt ab cb"><figure class="mm jq mn mo mp mq mr paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><img src="../Images/9f55863e5530022cb947ae7eacdd3bc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:678/format:webp/1*J5YLuhD1IpZkKTlo4yGAgQ.png"/></div></figure><figure class="mm jq ms mo mp mq mr paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><img src="../Images/deec0d3935b32db24ade89f3d84ce941.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/format:webp/1*x8sHsdrFHCKoxMYrlzZlOw.png"/></div></figure><figure class="mm jq mt mo mp mq mr paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><img src="../Images/53b9ca3cb4373161225de9f357b75a44.png" data-original-src="https://miro.medium.com/v2/resize:fit:602/format:webp/1*QKTqlK1Q-zpiHG1bQtjiAg.png"/></div></figure></div><h1 id="c7d0" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">平衡、分割、训练、测试</h1><p id="7e56" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">下面是 BSST 的套路。</p><p id="de2b" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">平衡是为了保证两个标签的公平训练。</p><figure class="lx ly lz ma gt jq"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="d4db" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">我们将用<strong class="ku ir"> 2000 </strong>估算器训练一个<strong class="ku ir"> XGBClassifier </strong>。</p><figure class="lx ly lz ma gt jq"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="f1b6" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">模型的准确率达到了<strong class="ku ir"> 83.98% </strong>。</p><h1 id="e321" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">评估模型性能</h1><p id="59c1" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">测试曲线稳定，这意味着<strong class="ku ir">没有过拟合</strong>。</p><figure class="lx ly lz ma gt jq"><div class="bz fp l di"><div class="mb mc l"/></div></figure><figure class="lx ly lz ma gt jq gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/1c5135abff21704130632d9d51d7b52b.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*tLDtSpESdXblIiagxYWAdQ.png"/></div></figure><p id="0c34" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">给定卡方统计的所有可能阈值，ROC 曲线绘制了真阳性率对假阳性率，用于测量观察结果和预期结果之间的差异。</p><figure class="lx ly lz ma gt jq"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="ef0d" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">ROC AUC 评分为<strong class="ku ir"> 0.918 </strong>。</p><figure class="lx ly lz ma gt jq gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/5442510901fe73e7cd82aa746ac34b14.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*j6LcdPAenwZvcucETDzrww.png"/></div></figure><p id="f8a0" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">这是混淆矩阵。在我们的例子中，假阳性率是我们想要尽可能最小化的。这是因为我们要识别尽可能多的翻炒者，否则我们会赔钱。</p><figure class="lx ly lz ma gt jq"><div class="bz fp l di"><div class="mb mc l"/></div></figure><figure class="lx ly lz ma gt jq gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/707897f150b07194366ecc84a0b73da3.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/1*8MnPTMapeGWQ7dAofQ_-XA.png"/></div></figure><p id="331b" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">无聊的东西在后面。时间到了。</p><h1 id="c994" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">确定关键人物</h1><p id="1a03" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">使用 xgboost 包中的 plot_importance 绘制每个要素的重要性。</p><figure class="lx ly lz ma gt jq"><div class="bz fp l di"><div class="mb mc l"/></div></figure><figure class="lx ly lz ma gt jq gh gi paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="gh gi mx"><img src="../Images/c5689ee29c02a3b39b25f1cd8fe35d45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nSdmwZe1bdwzLnfSPoPKUw.png"/></div></div></figure><p id="376e" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">沙普利价值观是时候解释是什么影响了比赛的结果了。</p><figure class="lx ly lz ma gt jq"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="1129" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">水平条代表每个特征的平均模数 Shapley 值。月费是最重要的，任期次之。</p><p id="777b" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">有趣的是，其他 17 个没有包括在剧情中的特征，和列表中的前 5 个一样重要。这意味着，如果我们必须降低数据集的维数，我们不能简单地把它们扔掉。</p><figure class="lx ly lz ma gt jq gh gi paragraph-image"><div class="gh gi my"><img src="../Images/63f9dbb55e148dfd4287836981abe6c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*MtZdyAp7JBnUO4MH25kBFg.png"/></div></figure><p id="232e" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">看下一张图。如果计算这些值之间的肯德尔等级相关系数,“保有权”与其 Shapley 值几乎完全相关。因此，这一特性显然会影响每一轮的结果(不会弄乱关于观察的信息)。</p><p id="762f" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">在右边的图片中，你还可以发现每个特性的价值，也就是说，它是将整个游戏的输出拉向<strong class="ku ir"> 0 </strong>(负值)还是拉向<strong class="ku ir"> 1 </strong>(正值)。越接近无穷大(即离零越远)，影响越大。</p><figure class="lx ly lz ma gt jq"><div class="bz fp l di"><div class="mb mc l"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk">,</figcaption></figure><div class="lx ly lz ma gt ab cb"><figure class="mm jq nd mo mp mq mr paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><img src="../Images/6f4aa61e1e7233f892bb5180a63f8ecd.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*rnSG4i-hAHTYRp6UYLV20w.png"/></div></figure><figure class="mm jq ne mo mp mq mr paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><img src="../Images/13fe0ef9b2a990e82424f67dd1367e09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*ouhYbtdwxC8qER4Ee0z37Q.png"/></div></figure></div><p id="2604" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">下图是一个类固醇相关矩阵(也称为相互作用图),显示了所有可能的特征组合是如何相互作用的。</p><p id="7dc9" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated">如果您决定从数据集中移除某个要素，请三思，因为您可能会将一名重要的团队成员踢出游戏。</p><figure class="lx ly lz ma gt jq"><div class="bz fp l di"><div class="mb mc l"/></div></figure><figure class="lx ly lz ma gt jq gh gi paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="gh gi nf"><img src="../Images/bf222436c1994efe442bfdffcce58d3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6aGgOtb0nbPEx70g4zLrPg.png"/></div></div></figure><h1 id="a13f" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">结论</h1><p id="bde9" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">本文描述了一个名为 Shapley 值的博弈论概念如何帮助评估每个特征对模型预测的影响。</p><p id="54d2" class="pw-post-body-paragraph ks kt iq ku b kv lq kx ky kz lr lb lc ld ls lf lg lh lt lj lk ll lu ln lo lp ij bi translated"><em class="lv">此处</em><a class="ae lw" href="https://github.com/Vice10/ds_notebooks/blob/main/customer_churn.ipynb" rel="noopener ugc nofollow" target="_blank"><em class="lv"/></a><em class="lv">有本文代码的笔记本可用。</em></p></div></div>    
</body>
</html>