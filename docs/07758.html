<html>
<head>
<title>NodeJS with ExpressJS and TypeScript part 1.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带有 ExpressJS 和 TypeScript 的 NodeJS 第 1 部分。</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/nodejs-with-expressjs-and-typescript-part-1-22871e2aae00?source=collection_archive---------5-----------------------#2022-04-21">https://blog.devgenius.io/nodejs-with-expressjs-and-typescript-part-1-22871e2aae00?source=collection_archive---------5-----------------------#2022-04-21</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="2677" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这篇文章中，我们将看到如何用 expressJS 和 typescript 从头开始创建一个服务器，这篇文章将被分成几个部分，以使其易于理解，并彻底解释每一件事。</p><h2 id="6f9c" class="ki kj in bd kk kl km dn kn ko kp dp kq jv kr ks kt jz ku kv kw kd kx ky kz la bi translated">您可以从<a class="ae lb" href="https://github.com/jordanrjdev/express-typescript" rel="noopener ugc nofollow" target="_blank">库</a>中访问代码</h2><h1 id="27ab" class="lc kj in bd kk ld le lf kn lg lh li kq lj lk ll kt lm ln lo kw lp lq lr kz ls bi translated">入门指南</h1><p id="a48f" class="pw-post-body-paragraph jk jl in jm b jn lt jp jq jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ig bi translated">在 nodeJS 中启动项目的第一步是使用以下命令:</p><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="45e9" class="ki kj in md b gy mh mi l mj mk">npm init -y</span></pre><p id="75ec" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这个命令将通过创建文件<strong class="jm io"> package.json </strong>来启动我们的项目。</p><p id="d31d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在我们必须安装依赖项，在这种情况下，我将使用 express with typescript，让我们看看我们要安装哪些依赖项:</p><p id="52d2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">依赖关系:</p><ul class=""><li id="f940" class="ml mm in jm b jn jo jr js jv mn jz mo kd mp kh mq mr ms mt bi translated">表达</li></ul><p id="9a22" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">开发依赖项:</p><ul class=""><li id="3494" class="ml mm in jm b jn jo jr js jv mn jz mo kd mp kh mq mr ms mt bi translated">以打字打的文件</li><li id="632a" class="ml mm in jm b jn mu jr mv jv mw jz mx kd my kh mq mr ms mt bi translated">ts 节点</li><li id="2858" class="ml mm in jm b jn mu jr mv jv mw jz mx kd my kh mq mr ms mt bi translated">@类型/节点</li><li id="81a8" class="ml mm in jm b jn mu jr mv jv mw jz mx kd my kh mq mr ms mt bi translated">@类型/快速</li></ul><p id="b78f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为什么我们把所有和 Typescript 相关的东西都安装成 devDependencies？好吧，让我们记住，即使我们将使用 Typescript 编写代码，代码也会被重新编译成标准的 JavaScript。因此，运行应用程序本身并不需要 Typescript，我们只在开发时需要它，这就是为什么它被保存为开发依赖项。</p><p id="991a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因此，让我们运行以下命令:</p><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="9e9e" class="ki kj in md b gy mh mi l mj mk">npm install express</span></pre><p id="c82a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">并且:</p><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="1a55" class="ki kj in md b gy mh mi l mj mk">npm install -D typescript ts-node @types/node @types/express</span></pre><p id="a813" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一旦我们成功安装了所有的依赖项，我们的 package.json 应该看起来像这样:</p><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="158c" class="ki kj in md b gy mh mi l mj mk">{<br/>   "name": "nodejs",<br/>   "version": "1.0.0",<br/>   "description": "",<br/>   "main": "index.js",<br/>   "scripts": {<br/>     "test": "echo \"Error: no test specified\" &amp;&amp; exit 1"<br/>   },<br/>   "keywords": [],<br/>   "author": "",<br/>   "license": "ISC",<br/>   "dependencies": {<br/>     "express": "^4.17.3"<br/>   },<br/>   "devDependencies": {<br/>     "@types/express": "^4.17.13",<br/>     "@types/node": "^17.0.25",<br/>     "ts-node": "^10.7.0",<br/>     "typescript": "^4.6.3"<br/>   }<br/>}</span></pre><blockquote class="mz na nb"><p id="4ab1" class="jk jl nc jm b jn jo jp jq jr js jt ju nd jw jx jy ne ka kb kc nf ke kf kg kh ig bi translated"><em class="in">请记住，版本会根据你阅读这篇文章的时间而变化。</em></p></blockquote><h1 id="09e7" class="lc kj in bd kk ld le lf kn lg lh li kq lj lk ll kt lm ln lo kw lp lq lr kz ls bi translated">配置 TypeScript</h1><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="8dab" class="ki kj in md b gy mh mi l mj mk">npx tsc --init</span></pre><p id="d17f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们使用前面的命令创建的 tsconfig.json 文件包含大量代码，这些代码中的大部分都被注释掉了，以便您可以根据自己的喜好进行试验和配置。但是，有几个设置我想解释一下:</p><ul class=""><li id="d697" class="ml mm in jm b jn jo jr js jv mn jz mo kd mp kh mq mr ms mt bi translated"><strong class="jm io">模块</strong>:使用这个选项，您可以指定在生成的 JavaScript 代码中使用哪个模块管理器。如:' none '，' commonjs '，' amd '，' system '，' umd '，' es2015 '，' es2020 '或' ESNext '。最常见和默认的模块管理器是 commonjs。</li><li id="3aae" class="ml mm in jm b jn mu jr mv jv mw jz mx kd my kh mq mr ms mt bi translated"><strong class="jm io"> target </strong>:使用这个选项，我们可以指定在您的项目中使用哪个版本的 ECMAScript。可用版本有“ES3”(默认)、“ES5”、“ES2015”、“ES2016”、“ES2017”、“ES2018”、“ES2019”、“ES2020”或“ESNEXT”。</li><li id="dc7b" class="ml mm in jm b jn mu jr mv jv mw jz mx kd my kh mq mr ms mt bi translated"><strong class="jm io"> outDir </strong>:使用这个选项，我们可以指定 Javascript 代码将在哪个路径中生成。</li><li id="dec9" class="ml mm in jm b jn mu jr mv jv mw jz mx kd my kh mq mr ms mt bi translated">rootDir :这个选项是我们指定 TypeScript 文件的位置。</li><li id="7175" class="ml mm in jm b jn mu jr mv jv mw jz mx kd my kh mq mr ms mt bi translated"><strong class="jm io"> strict </strong>:该选项默认启用，启用严格类型检查选项。</li></ul><p id="bd03" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">您可以在 tsconfig.json 文件本身或官方的 typescript 文档中了解有关此配置的更多信息。</p><p id="65b7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在我的例子中，我将在 tsconfig.json 中使用以下配置:</p><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="0696" class="ki kj in md b gy mh mi l mj mk">{<br/>  "compilerOptions": {<br/>    "module": "commonjs",<br/>    "esModuleInterop": true,<br/>    "target": "es6",<br/>    "rootDir": "src/",<br/>    "outDir": "./build",<br/>    "strict": true<br/>  }<br/>}</span></pre><h1 id="a05f" class="lc kj in bd kk ld le lf kn lg lh li kq lj lk ll kt lm ln lo kw lp lq lr kz ls bi translated">我们的第一台带有 expressJS 的服务器</h1><p id="1af9" class="pw-post-body-paragraph jk jl in jm b jn lt jp jq jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ig bi translated">设置好 typescript 之后，是时候用 expressJS 创建我们的第一个 web 服务器了。让我们创建一个名为 index.ts 的文件。</p><p id="d90b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这个文件中，我们将有以下代码:</p><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="5756" class="ki kj in md b gy mh mi l mj mk">import express, { Request, Response } from 'express';<br/>const app = express();</span><span id="22b5" class="ki kj in md b gy ng mi l mj mk">app.get('/', (req: Request, res: Response) =&gt; {<br/>  res.send('Hello World');<br/>});</span><span id="b39a" class="ki kj in md b gy ng mi l mj mk">app.listen(8000, () =&gt; {<br/>  console.log('The application is listening on port 8000!');<br/>});</span></pre><p id="fdb0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">首先，我们从 express 导入 express 以及请求和响应类型。</p><p id="f9ba" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一旦完成，我们必须初始化我们的应用程序</p><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="e6b0" class="ki kj in md b gy mh mi l mj mk">const app = express();</span></pre><p id="de49" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，我们将添加一个 get 类型的端点，其中将返回一条消息，因此我们必须执行以下操作:</p><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="3b8c" class="ki kj in md b gy mh mi l mj mk">app.get("/");</span></pre><p id="c5cc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了以简单的方式开始，我们将有我们的应用程序，然后我们将放置我们的端点的方法，在这种情况下<strong class="jm io"> get </strong>这是一个接收 2 个参数的函数，然后我们可以向它添加中间件，但目前有 2 个，第一个是一个带有路由的字符串，因为我们希望它是我们的初始路由，我们只需放置一个/并表示理解这将是我们的主路由。</p><p id="f3f9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在我们必须添加第二个参数，这是一个回调，这个回调接收两个参数，即请求和响应:</p><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="6522" class="ki kj in md b gy mh mi l mj mk">app.get('/', (req: Request, res: Response) =&gt; {<br/>});</span></pre><p id="4b33" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如您所见，我已经添加了类型。请记住，您为这两个参数命名，但是按照惯例，您会发现最常见的是 req 和 res。</p><p id="8a79" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这个回调函数中，我们的代码将在我们访问路由时执行，现在我们将只响应文本:</p><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="6258" class="ki kj in md b gy mh mi l mj mk">app.get('/', (req: Request, res: Response) =&gt; {<br/>  res.send('Hello World');<br/>});</span></pre><p id="b56c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">与<strong class="jm io">RES . send(‘Hello World’)；</strong>我们所做的是告诉它用短信回复我们的呼叫。</p><p id="2254" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在让我们在浏览器中看看这个。但在这样做之前，我们需要一件事，那就是告诉我们的 express server (app)继续监听某个端口。</p><p id="62e4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">所以我们会写:</p><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="9ca6" class="ki kj in md b gy mh mi l mj mk">app.listen(8000, () =&gt; {<br/>  console.log('The application is listening on port 8000!');<br/>});</span></pre><p id="bbd7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">它接收两个参数，第一个是我们的服务器将监听的端口，第二个是当服务器准备好的时候执行的回调，现在我们只放一个 console.log。</p><p id="e047" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">考虑到这一点，我们将执行我们的服务器。</p><p id="1a66" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">请记住，因为我们使用的是 typescript，所以我们必须编译成 js，以便 node 可以读取它，我们执行命令:</p><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="cd1b" class="ki kj in md b gy mh mi l mj mk">npx tsc --project ./</span></pre><p id="3dad" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">将生成一个构建文件夹。里面有我们的代码。我们可能不明白，但已经编译好了。</p><p id="33cb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了加速代码的编译，我们可以在 package.json 的脚本部分创建一个脚本:</p><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="1340" class="ki kj in md b gy mh mi l mj mk">"scripts": {<br/>     "build": "npx tsc --project ./",<br/>     "test": "echo \"Error: no test specified\" &amp;&amp; exit 1"<br/>   },</span></pre><p id="554a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我称它为“立即编译”,我们只需执行:</p><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="ddcf" class="ki kj in md b gy mh mi l mj mk">npm run build</span></pre><p id="df5f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">每当我们创建一个脚本，我们必须执行它:</p><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="e4df" class="ki kj in md b gy mh mi l mj mk">npm + run + script name</span></pre><p id="7cef" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">此时，我们可以编写命令:</p><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="a77a" class="ki kj in md b gy mh mi l mj mk">node ./build/index.js</span></pre><p id="5668" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将看到以下输出:</p><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="514f" class="ki kj in md b gy mh mi l mj mk">❯ node ./build/index.js<br/>The application is listening on port 8000!</span></pre><p id="c464" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们看看我们的网络浏览器:</p><figure class="ly lz ma mb gt ni gh gi paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="gh gi nh"><img src="../Images/b734af6064f409c27b069f5ae4172b05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yn0VhKXnLCJJ2AJZ.png"/></div></div></figure><p id="0c3a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如我们所见，我们得到了来自端点的响应。</p><p id="7407" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">正如您在本文中看到的，我们已经用 expressJS 和 typescript 创建了我们的第一个服务器。</p><p id="aab1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在下一部分中，我们将看到如何使用 nodemon 加速开发，我们还将看到如何响应不同类型的格式。带有其他 http 动词等的请求。</p><p id="67b6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你对这个帖子有任何疑问，可以在评论里留下。或者，如果你有任何建议，你可以离开它。</p></div></div>    
</body>
</html>