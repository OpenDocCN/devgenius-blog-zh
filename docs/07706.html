<html>
<head>
<title>Introduction to Docker — Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Docker 简介—第 2 部分</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/introduction-to-docker-part-2-73b36d0722e0?source=collection_archive---------7-----------------------#2022-04-17">https://blog.devgenius.io/introduction-to-docker-part-2-73b36d0722e0?source=collection_archive---------7-----------------------#2022-04-17</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="3e31" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">如果你曾经面临“它在我的机器上工作的问题”, Docker 可能是解决方案。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/7bcf88973d259a1d1d2ba59f55190c28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZKMNF1wmE-A1TivqWe8NdQ.png"/></div></div></figure><p id="e6c6" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">欢迎回到我介绍 Docker 的第二部分。本系列的第一部分介绍了什么是容器，以及容器和虚拟机之间的区别。如果您尚未阅读，请点击此处查看:</p><div class="lk ll gp gr lm ln"><a href="https://medium.com/@eklatzerToGo/introduction-to-docker-part-1-7646c995282c" rel="noopener follow" target="_blank"><div class="lo ab fo"><div class="lp ab lq cl cj lr"><h2 class="bd io gy z fp ls fr fs lt fu fw im bi translated">Docker 简介—第 1 部分</h2><div class="lu l"><h3 class="bd b gy z fp ls fr fs lt fu fw dk translated">如果你曾经面临“它在我的机器上工作的问题”，Docker 可能是一个简单的解决方案</h3></div><div class="lv l"><p class="bd b dl z fp ls fr fs lt fu fw dk translated">medium.com</p></div></div><div class="lw l"><div class="lx l ly lz ma lw mb km ln"/></div></div></a></div><p id="fbbb" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如第 1 部分所述，用于 Docker 的容器引擎是<strong class="kq io"> Docker 引擎</strong>。为了与它通信，使用了<strong class="kq io"> Docker CLI </strong>。本系列的这一部分将讲述 Docker CLI 提供的最重要的特性。</p><h1 id="d726" class="mc md in bd me mf mg mh mi mj mk ml mm jt mn ju mo jw mp jx mq jz mr ka ms mt bi translated">图像管理</h1><p id="03cc" class="pw-post-body-paragraph ko kp in kq b kr mu jo kt ku mv jr kw kx mw kz la lb mx ld le lf my lh li lj ig bi translated">提醒一下，图像被用作容器的蓝图。图像可以存储在本地设备或注册表中。使用命令<code class="fe mz na nb nc b">docker images</code>列出所有本地图像。在这种情况下，出现了两个图像<code class="fe mz na nb nc b">mysql</code>和<code class="fe mz na nb nc b">nginx</code>。除了图像名称之外，还显示了关于图像的一些其他细节。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="7dce" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">要仅获取单个图像的信息，该命令可扩展至<code class="fe mz na nb nc b">docker images &lt;Imagename&gt;</code>。在这种情况下，仅列出单个图像的标签。但是这些标签是什么呢？您可以将标签视为图像的一个版本。标签<code class="fe mz na nb nc b">latest</code>是一个特殊的标签，指的是已经发布的没有特定标签的图像的最新版本。多个标签可以是同一个图像，例如对于 nginx 图像，标签<code class="fe mz na nb nc b">1.21.6</code>、<code class="fe mz na nb nc b">mainline</code>、<code class="fe mz na nb nc b">1</code>、<code class="fe mz na nb nc b">1.21</code>和<code class="fe mz na nb nc b">latest</code>此时是相同的。以下输出显示图像<code class="fe mz na nb nc b">nginx</code>的标签<code class="fe mz na nb nc b">1.20</code>和<code class="fe mz na nb nc b">latest</code>存在:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="5cd5" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">要获取发布在<a class="ae nf" href="https://hub.docker.com/" rel="noopener ugc nofollow" target="_blank"> Dockerhub </a>上的众多图像之一，可以使用命令<code class="fe mz na nb nc b">docker pull &lt;Image&gt;:&lt;Tag&gt;</code>。例如，要拉出<a class="ae nf" href="https://hub.docker.com/_/hello-world`" rel="noopener ugc nofollow" target="_blank"> Hello-World </a>图像，可以使用命令<code class="fe mz na nb nc b">docker pull hello-world</code>。要获取标签列表，可以打开 Dockerhub 上的标签选项卡:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ng"><img src="../Images/5b062f70aaef688873a6c41e0fc8e2ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_lm8VZgDbx-cbGb0p-4iUw.png"/></div></div></figure><p id="2cf5" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果没有定义其他内容，Dockerhub 将用作默认注册表。要从不同的注册表中提取，必须指定注册表:</p><pre class="kd ke kf kg gt nh nc ni nj aw nk bi"><span id="b649" class="nl md in nc b gy nm nn l no np">docker pull registry.klatzer.at/foo</span></pre><p id="03ef" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这将从注册表<code class="fe mz na nb nc b">registry.klatzer.at</code>中提取图像<code class="fe mz na nb nc b">foo</code>。(注意:<code class="fe mz na nb nc b">registry.klatzer.at</code>不是一个真正的注册表，你将无法从那里拉一个图像)</p><p id="2aab" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果您想在私有注册中心拉一个图像，在拉图像之前可能需要命令<code class="fe mz na nb nc b">docker login</code>。</p><p id="6569" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">要删除不再需要的图像，可以使用命令<code class="fe mz na nb nc b">docker rmi &lt;Image&gt;:&lt;Tag&gt;</code>。如果图像仍在使用，必须使用参数<code class="fe mz na nb nc b">-f</code>强制删除。如下例所示，其中图像<code class="fe mz na nb nc b">nginx:1.20</code>仍在使用中。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nd ne l"/></div></figure><h1 id="9101" class="mc md in bd me mf mg mh mi mj mk ml mm jt mn ju mo jw mp jx mq jz mr ka ms mt bi translated">集装箱管理</h1><p id="7a19" class="pw-post-body-paragraph ko kp in kq b kr mu jo kt ku mv jr kw kx mw kz la lb mx ld le lf my lh li lj ig bi translated">Docker CLI 的第二个重要部分是容器的管理。使用命令<code class="fe mz na nb nc b">docker ps</code>列出所有正在运行的容器的一些细节。这表明两个容器正在运行，一个带有 nginx-server，另一个带有 MySQL 数据库。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="9775" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">为了包括没有运行的集装箱，必须使用标志<code class="fe mz na nb nc b">-a</code>。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nd ne l"/></div></figure><h2 id="c47a" class="nl md in bd me nq nr dn mi ns nt dp mm kx nu nv mo lb nw nx mq lf ny nz ms oa bi translated">启动</h2><p id="23dc" class="pw-post-body-paragraph ko kp in kq b kr mu jo kt ku mv jr kw kx mw kz la lb mx ld le lf my lh li lj ig bi translated">如果您没有启动任何容器，前面命令的输出当然会是空的。使用命令<code class="fe mz na nb nc b">docker start</code>启动一个新的容器。您可以尝试的第一件事是用命令<code class="fe mz na nb nc b">docker start hello-world</code>启动映像<code class="fe mz na nb nc b">hello-world</code>。</p><blockquote class="ob oc od"><p id="a245" class="ko kp oe kq b kr ks jo kt ku kv jr kw of ky kz la og lc ld le oh lg lh li lj ig bi translated">提示:如果在本地没有找到图像，则自动提取，因此不需要<code class="fe mz na nb nc b">docker pull</code></p></blockquote><p id="a4db" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe mz na nb nc b">hello-world</code>图像验证您的本地 Docker 安装。输出应该包含以下几行:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="4b74" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe mz na nb nc b">docker start</code>提供了几个标志来调整你的容器的行为。将通过一个示例介绍一些重要的标志。因此将使用图像<code class="fe mz na nb nc b">mysql</code>。</p><p id="268a" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">使用命令<code class="fe mz na nb nc b">docker run mysql</code>启动 MySQL 数据库。当尝试这样做时，会打印一个错误，并且容器不会启动。会引发以下错误:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="f3ea" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">大多数情况下，当启动一个容器时，必须设置配置字段。在这种情况下，必须设置<code class="fe mz na nb nc b">MYSQL_ROOT_PASSWORD</code>、<code class="fe mz na nb nc b">MYSQL_ALLOW_EMPTY_PASSWORD</code>或<code class="fe mz na nb nc b">MYSQL_RANDOM_ROOT_PASSWORD</code>。它们都是用于处理数据库用户<code class="fe mz na nb nc b">root</code>密码的变量。要用密码<code class="fe mz na nb nc b">root</code>启动数据库，必须用标志<code class="fe mz na nb nc b">-e</code>设置环境变量<code class="fe mz na nb nc b">MYSQL_ROOT_PASSWORD</code>。当尝试这样做时，您会注意到您无法用<code class="fe mz na nb nc b">root/root</code>连接到数据库。为了能够连接到数据库，必须发布容器的端口。这可以通过设置<code class="fe mz na nb nc b">-p &lt;Host-Port&gt;:&lt;Container-Port&gt;</code>来完成。例如，利用配置<code class="fe mz na nb nc b">-p 80:8080</code>，容器的端口<code class="fe mz na nb nc b">8080</code>被绑定到主机的端口<code class="fe mz na nb nc b">80</code>。对于我们的 MySQL 数据库，需要端口<code class="fe mz na nb nc b">3306</code>。</p><p id="983a" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">当容器消失时，容器中的数据也消失了。为了持久保存数据，可以将主机的目录装入带有<code class="fe mz na nb nc b">-v</code>标志的容器的目录中。我们将展示一个 MySQL 数据库的例子。关于在 Docker 中保存数据的细节可以在找到</p><p id="31df" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">带有上述所有标志的 MySQL 数据库所需的最后一个命令如下。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="460b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">使用此命令时，容器将在前台启动。要在后台启动，必须将标志<code class="fe mz na nb nc b">-d</code>添加到启动命令中。运行该命令后，将打印容器的 id。要获取容器的日志，必须使用<code class="fe mz na nb nc b">docker logs &lt;Container-ID&gt;</code>。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="ee09" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">除了启动容器之外，还提供了用于容器管理的其他命令:</p><ul class=""><li id="fb05" class="oi oj in kq b kr ks ku kv kx ok lb ol lf om lj on oo op oq bi translated">启动一个容器:<code class="fe mz na nb nc b">docker start &lt;Container-ID&gt;</code></li><li id="d6fd" class="oi oj in kq b kr or ku os kx ot lb ou lf ov lj on oo op oq bi translated">停止容器:<code class="fe mz na nb nc b">docker stop &lt;Container-ID&gt;</code></li><li id="d6a5" class="oi oj in kq b kr or ku os kx ot lb ou lf ov lj on oo op oq bi translated">重启容器:<code class="fe mz na nb nc b">docker restart &lt;Container-ID&gt;</code></li></ul><p id="1151" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">使用命令<code class="fe mz na nb nc b">docker ps -a</code>可以找到容器的 id。</p><h1 id="2e5b" class="mc md in bd me mf mg mh mi mj mk ml mm jt mn ju mo jw mp jx mq jz mr ka ms mt bi translated">结论</h1><p id="e4a2" class="pw-post-body-paragraph ko kp in kq b kr mu jo kt ku mv jr kw kx mw kz la lb mx ld le lf my lh li lj ig bi translated">本系列的这一部分已经展示了 Docker CLI 的一些命令和<code class="fe mz na nb nc b">docker run</code>最重要的标志。关于 Docker CLI 的更多信息可以在<a class="ae nf" href="https://docs.docker.com/engine/reference/commandline/cli/" rel="noopener ugc nofollow" target="_blank">官方文档</a>中找到。</p><p id="0b0d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">请留下您对本系列的看法以及您对 Docker 系列即将到来的部分的希望，并查看我的其他文章。</p><p id="9683" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">查看该系列的下一部分:</p><div class="lk ll gp gr lm ln"><a rel="noopener  ugc nofollow" target="_blank" href="/introduction-to-docker-part-3-9034ba335250"><div class="lo ab fo"><div class="lp ab lq cl cj lr"><h2 class="bd io gy z fp ls fr fs lt fu fw im bi translated">Docker 简介—第 3 部分</h2><div class="lu l"><h3 class="bd b gy z fp ls fr fs lt fu fw dk translated">如果你曾经面临“它在我的机器上工作”的问题，Docker 可能是一个简单的解决方案</h3></div><div class="lv l"><p class="bd b dl z fp ls fr fs lt fu fw dk translated">blog.devgenius.io</p></div></div><div class="lw l"><div class="ow l ly lz ma lw mb km ln"/></div></div></a></div></div></div>    
</body>
</html>