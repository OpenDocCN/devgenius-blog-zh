<html>
<head>
<title>OData for ASP.NET Core 6.0 on Mac via command line</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过命令行在Mac上运行ASP.NET核心6.0的OData</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/odata-for-asp-net-core-6-0-on-mac-via-command-line-92c45da4fafa?source=collection_archive---------5-----------------------#2022-01-15">https://blog.devgenius.io/odata-for-asp-net-core-6-0-on-mac-via-command-line-92c45da4fafa?source=collection_archive---------5-----------------------#2022-01-15</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="31e0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">。NET 6.0包含了<code class="fe ki kj kk kl b">Program.cs</code>的新结构。我想记录我是如何通过命令行添加OData支持的。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/38b190896af5ff1ff3f8da0719d80dbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*235r0RxnhqrUFzf2MnBoaA.jpeg"/></div></div></figure><p id="7bf2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">以下是我遵循的步骤:</p><h2 id="a431" class="ky kz in bd la lb lc dn ld le lf dp lg jv lh li lj jz lk ll lm kd ln lo lp lq bi translated">1.创建ASP.NET核心Web API 6.0应用程序</h2><pre class="kn ko kp kq gt lr kl ls lt aw lu bi"><span id="f25a" class="ky kz in kl b gy lv lw l lx ly">&gt;&gt; dotnet new webapi -o odata</span><span id="f98c" class="ky kz in kl b gy lz lw l lx ly">&gt;&gt; cd odata</span></pre><h2 id="5d94" class="ky kz in bd la lb lc dn ld le lf dp lg jv lh li lj jz lk ll lm kd ln lo lp lq bi translated">2.添加<code class="fe ki kj kk kl b">Entity Framework Core</code>和<code class="fe ki kj kk kl b">OData </code>包参考</h2><p id="18ce" class="pw-post-body-paragraph jk jl in jm b jn ma jp jq jr mb jt ju jv mc jx jy jz md kb kc kd me kf kg kh ig bi translated">为了简单起见，我使用了EF Core内存数据库提供程序。</p><pre class="kn ko kp kq gt lr kl ls lt aw lu bi"><span id="0e61" class="ky kz in kl b gy lv lw l lx ly">&gt;&gt; dotnet add package Microsoft.EntityFrameworkCore.InMemory</span><span id="e5eb" class="ky kz in kl b gy lz lw l lx ly">&gt;&gt; dotnet add package Microsoft.AspNetCore.Odata</span></pre><h2 id="2606" class="ky kz in bd la lb lc dn ld le lf dp lg jv lh li lj jz lk ll lm kd ln lo lp lq bi translated">3.更新<code class="fe ki kj kk kl b">Program.cs</code></h2><p id="c725" class="pw-post-body-paragraph jk jl in jm b jn ma jp jq jr mb jt ju jv mc jx jy jz md kb kc kd me kf kg kh ig bi translated">需要添加以下内容作为<em class="mf"> Program.cs的一部分:</em></p><ul class=""><li id="0838" class="mg mh in jm b jn jo jr js jv mi jz mj kd mk kh ml mm mn mo bi translated">OData约定模型</li><li id="2d4c" class="mg mh in jm b jn mp jr mq jv mr jz ms kd mt kh ml mm mn mo bi translated">OData控制器</li><li id="55f9" class="mg mh in jm b jn mp jr mq jv mr jz ms kd mt kh ml mm mn mo bi translated">实体框架上下文</li></ul><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mu mv l"/></div></figure><h2 id="399a" class="ky kz in bd la lb lc dn ld le lf dp lg jv lh li lj jz lk ll lm kd ln lo lp lq bi translated">4.添加对GET请求的支持</h2><p id="dbd1" class="pw-post-body-paragraph jk jl in jm b jn ma jp jq jr mb jt ju jv mc jx jy jz md kb kc kd me kf kg kh ig bi translated">我使用了<code class="fe ki kj kk kl b">EnableQuery</code>注释来启用<code class="fe ki kj kk kl b">CarsController.cs</code>中的GET请求。静态类<code class="fe ki kj kk kl b">DataSource</code>提供测试数据。<code class="fe ki kj kk kl b">DataSource.GetCars()</code>的代码可以在<a class="ae mw" href="https://github.com/alkondrashov/odata" rel="noopener ugc nofollow" target="_blank">这里</a>找到</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mu mv l"/></div></figure><h2 id="c1fd" class="ky kz in bd la lb lc dn ld le lf dp lg jv lh li lj jz lk ll lm kd ln lo lp lq bi translated">5.运行应用程序并检查结果</h2><p id="5b29" class="pw-post-body-paragraph jk jl in jm b jn ma jp jq jr mb jt ju jv mc jx jy jz md kb kc kd me kf kg kh ig bi translated">证明OData有效的好方法是查询所有价格小于或等于50的汽车。只有一辆车满足这个条件。</p><pre class="kn ko kp kq gt lr kl ls lt aw lu bi"><span id="8590" class="ky kz in kl b gy lv lw l lx ly">&gt;&gt; dotnet run</span><span id="9bc8" class="ky kz in kl b gy lz lw l lx ly">&gt;&gt; curl -X 'GET' '<a class="ae mw" href="https://localhost:7005/odata/Cars?$filter=Price" rel="noopener ugc nofollow" target="_blank">https://localhost:7005/odata/Cars?$filter=Price</a> le 50' -H 'accept: text/plain' -k</span></pre><p id="2955" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">响应应该如下所示:</p><pre class="kn ko kp kq gt lr kl ls lt aw lu bi"><span id="eecc" class="ky kz in kl b gy lv lw l lx ly">{<br/>    "<a class="ae mw" href="http://twitter.com/odata" rel="noopener ugc nofollow" target="_blank">@odata</a>.context": "<a class="ae mw" href="https://localhost:7005/odata/$metadata#Cars" rel="noopener ugc nofollow" target="_blank">https://localhost:7005/odata/$metadata#Cars</a>",<br/>    "value": [<br/>        {<br/>            "Id": 2,<br/>            "Brand": "BMW",<br/>            "Price": 49.99,<br/>            "Model": "3 Series"<br/>        }<br/>    ]<br/>}</span></pre><h1 id="5c57" class="mx kz in bd la my mz na ld nb nc nd lg ne nf ng lj nh ni nj lm nk nl nm lp nn bi translated">摘要</h1><p id="7b94" class="pw-post-body-paragraph jk jl in jm b jn ma jp jq jr mb jt ju jv mc jx jy jz md kb kc kd me kf kg kh ig bi translated">在这个例子中，我们看到了向ASP.NET核心Web API应用程序添加对OData的支持，并执行了一个简单的查询来证明OData请求正在通过。希望这有助于你运行你的项目。</p><h1 id="e147" class="mx kz in bd la my mz na ld nb nc nd lg ne nf ng lj nh ni nj lm nk nl nm lp nn bi translated">链接</h1><ol class=""><li id="c793" class="mg mh in jm b jn ma jr mb jv no jz np kd nq kh nr mm mn mo bi translated"><a class="ae mw" href="https://github.com/alkondrashov/odata" rel="noopener ugc nofollow" target="_blank">本例中的代码</a></li><li id="41f7" class="mg mh in jm b jn mp jr mq jv mr jz ms kd mt kh nr mm mn mo bi translated"><a class="ae mw" href="https://docs.microsoft.com/en-us/aspnet/web-api/overview/odata-support-in-aspnet-web-api/odata-v4/create-an-odata-v4-endpoint" rel="noopener ugc nofollow" target="_blank">经典ASP.NET网络应用的OData支持示例</a></li><li id="5569" class="mg mh in jm b jn mp jr mq jv mr jz ms kd mt kh nr mm mn mo bi translated"><a class="ae mw" href="https://devblogs.microsoft.com/odata/asp-net-core-odata-now-available/" rel="noopener ugc nofollow" target="_blank">ASP.NET核心2.0网络应用的OData支持示例</a></li><li id="ec49" class="mg mh in jm b jn mp jr mq jv mr jz ms kd mt kh nr mm mn mo bi translated"><a class="ae mw" href="https://devblogs.microsoft.com/odata/asp-net-odata-8-0-preview-for-net-5/" rel="noopener ugc nofollow" target="_blank">ASP.NET核心5.0网络应用的OData支持示例</a></li><li id="42d6" class="mg mh in jm b jn mp jr mq jv mr jz ms kd mt kh nr mm mn mo bi translated"><a class="ae mw" href="https://referbruv.com/blog/posts/working-with-odata-integrating-an-existing-aspnet-core-3x-api" rel="noopener ugc nofollow" target="_blank">ASP.NET 5.0网络应用支持OData的另一个例子</a></li></ol></div></div>    
</body>
</html>