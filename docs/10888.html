<html>
<head>
<title>Query Bitcoin Blockchain for Active Addresses in BigQuery</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 BigQuery 中查询比特币区块链的活跃地址</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/query-bitcoin-blockchain-for-active-addresses-in-bigquery-be440f362dd9?source=collection_archive---------19-----------------------#2022-12-05">https://blog.devgenius.io/query-bitcoin-blockchain-for-active-addresses-in-bigquery-be440f362dd9?source=collection_archive---------19-----------------------#2022-12-05</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="415e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在本文中，我们将展示如何通过在 Google BigQuery 中运行以下查询来查找比特币区块链上的活跃地址数。活动地址是指在指定时间段内至少发送或接收了一个交易的唯一地址的数量。只有在成功事务中处于活动状态的地址才会被计算在内。</p><p id="6d01" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">活跃地址通常被用来衡量比特币网络的采用和使用水平。当活跃地址的数量增加时，这可能表明比特币生态系统内的兴趣和活动日益增加。值得注意的是，一个用户可以有多个地址，并且不是所有活动的地址都可以代表单个用户。</p><p id="fa48" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在我们开始之前，您可能会在<a class="ae ki" href="https://medium.com/dev-genius/getting-started-with-google-bigquery-5e076e77d43c" rel="noopener">big query</a>入门中了解如何设置项目，以及如何在<a class="ae ki" href="https://medium.com/@vivbellavita/explore-cryptocurrency-public-datasets-with-bigquery-1d9562691580" rel="noopener">使用 BigQuery </a>探索加密货币公共数据集中对比特币公共数据集运行简单查询。如果您不想运行查询，您可以在 Trigo Labs 的<a class="ae ki" href="https://trigolabs.io/bitcoin/" rel="noopener ugc nofollow" target="_blank">比特币仪表盘</a>上查看结果。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/a705f1bb5604e7a24a7b45ac2c709e5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L1fqMS1aIZHeAYzDzR9Muw.jpeg"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk translated">比特币活跃地址</figcaption></figure><h1 id="03cb" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">第一步</h1><p id="84c4" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">转到 BigQuery 上的<strong class="jm io">编辑器</strong>字段。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi mc"><img src="../Images/dcf9eaa58784e84a1b826a2b68985847.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pwLp27oFC4HKAJ0Q1obUtQ.png"/></div></div></figure><h1 id="19de" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">第二步</h1><p id="1f9d" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">在<strong class="jm io">编辑器</strong>字段中，复制下面的查询。</p><p id="b256" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">该查询通过从两个表(即<code class="fe md me mf mg b">bigquery-public-data.crypto_bitcoin.inputs</code>和<code class="fe md me mf mg b">bigquery-public-data.crypto_bitcoin.outputs</code>)中提取日期和地址来创建一个公共表表达式(CTE) <code class="fe md me mf mg b">active_addresses</code>。</p><p id="61e6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">使用<code class="fe md me mf mg b">UNION ALL</code>子句将两个结果集合并成一个结果集。这将创建事务中使用的所有唯一地址的列表，而不管该地址是用作输入还是输出。</p><pre class="kk kl km kn gt mh mg mi bn mj mk bi"><span id="b7d4" class="ml la in mg b be mm mn l mo mp">WITH active_addresses AS (<br/>   -- input addresses<br/>   SELECT DATE(block_timestamp) AS date,<br/>    array_to_string(inputs.addresses, ",") as address FROM `bigquery-public-data.crypto_bitcoin.inputs` as inputs<br/>   UNION ALL<br/>   -- output addresses<br/>   SELECT DATE(block_timestamp) AS date,<br/>    array_to_string(outputs.addresses, ",") as address FROM `bigquery-public-data.crypto_bitcoin.outputs` as outputs<br/>),</span></pre><p id="8daf" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">接下来，CTE <code class="fe md me mf mg b">active_addresses_group_by_date</code>从表<code class="fe md me mf mg b">active_addresses</code>中选择数据，并计算每天活跃的唯一地址的数量。结果按日期分组。</p><pre class="kk kl km kn gt mh mg mi bn mj mk bi"><span id="471b" class="ml la in mg b be mm mn l mo mp">active_addresses_group_by_date as (<br/>  SELECT date, COUNT(DISTINCT address) as active_addresses_count<br/>  FROM active_addresses<br/>  WHERE date &gt; "2009-01-01" AND date &lt;= DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY) <br/>  GROUP BY date<br/>)</span></pre><p id="8748" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">最后，我们使用<code class="fe md me mf mg b">SELECT</code>语句获取日期和活动地址计数，并在运行查询时显示它们。</p><pre class="kk kl km kn gt mh mg mi bn mj mk bi"><span id="08f1" class="ml la in mg b be mm mn l mo mp">SELECT date, active_addresses_count FROM active_addresses_group_by_date<br/>ORDER BY date</span></pre><p id="26a3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">完整的查询如下所示。</p><pre class="kk kl km kn gt mh mg mi bn mj mk bi"><span id="6e82" class="ml la in mg b be mm mn l mo mp">WITH active_addresses AS (<br/>   -- input addresses<br/>   SELECT DATE(block_timestamp) AS date,<br/>    array_to_string(inputs.addresses, ",") as address FROM `bigquery-public-data.crypto_bitcoin.inputs` as inputs<br/>   UNION ALL<br/>   -- output addresses<br/>   SELECT DATE(block_timestamp) AS date,<br/>    array_to_string(outputs.addresses, ",") as address FROM `bigquery-public-data.crypto_bitcoin.outputs` as outputs<br/>),<br/><br/>active_addresses_group_by_date as (<br/>  SELECT date, COUNT(DISTINCT address) as active_addresses_count<br/>  FROM active_addresses<br/>  WHERE date &gt; "2009-01-01" AND date &lt;= DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY) <br/>  GROUP BY date<br/>)<br/><br/>SELECT date, active_addresses_count FROM active_addresses_group_by_date<br/>ORDER BY date</span></pre><h1 id="8e62" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">第三步</h1><p id="a48b" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">点击<strong class="jm io">运行</strong>。</p><p id="3df3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">该查询使用 154.54 GB 在 BigQuery 中运行。结果显示在<strong class="jm io">查询结果</strong>部分。表格标题行包含“日期”和“活动地址计数”。结果显示每天唯一活动地址的数量。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi mq"><img src="../Images/d30877e3d8913e41c016d10d7eed5cba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-G-9HpNFcWp1M7wEhfwVhw.png"/></div></div></figure><h1 id="8e51" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">第四步</h1><p id="55e7" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">您可以通过点击<strong class="jm io">保存结果</strong>来导出结果，并在下拉菜单中选择导出到 CSV、JSON 或 Google Sheets 的选项。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi mr"><img src="../Images/60c3ff79bb71bc10642a115c0d2e7a17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Re7HLxIWSKty8siXMaQ0vQ.png"/></div></div></figure><p id="b563" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">有兴趣了解更多关于链上指标的信息吗？查看下面的文章。</p><p id="d94c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">亦读:</strong></p><ul class=""><li id="5b2e" class="ms mt in jm b jn jo jr js jv mu jz mv kd mw kh mx my mz na bi translated"><a class="ae ki" href="https://medium.com/dev-genius/getting-started-with-google-bigquery-5e076e77d43c" rel="noopener">谷歌大查询入门</a></li><li id="de79" class="ms mt in jm b jn nb jr nc jv nd jz ne kd nf kh mx my mz na bi translated"><a class="ae ki" href="https://medium.com/@vivbellavita/explore-cryptocurrency-public-datasets-with-bigquery-1d9562691580" rel="noopener">使用 BigQuery 探索加密货币公共数据集</a></li><li id="9950" class="ms mt in jm b jn nb jr nc jv nd jz ne kd nf kh mx my mz na bi translated"><a class="ae ki" href="https://medium.com/@vivbellavita/bitcoin-how-to-query-for-sending-and-receiving-addresses-in-bigquery-3d930cb64dc3" rel="noopener">比特币:如何在 BigQuery 中查询收发地址</a></li></ul></div><div class="ab cl ng nh hr ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ig ih ii ij ik"><p id="82ad" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> <em class="nn">感谢阅读！</em>T15】</strong></p><p id="13d0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果您喜欢这篇文章并想了解更多，请考虑关注我。我定期发布与链上分析、机器学习和 BigQuery 相关的主题。我尽量让我的文章简单而精确，尽可能提供代码、例子和模拟。</p></div></div>    
</body>
</html>