<html>
<head>
<title>DIY: Read More</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">DIY:多读书</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/diy-read-more-f3e2e916472?source=collection_archive---------2-----------------------#2021-06-08">https://blog.devgenius.io/diy-read-more-f3e2e916472?source=collection_archive---------2-----------------------#2021-06-08</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="cee4" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">用 React，情感和-webkit-line-clamp</h2></div><p id="69e2" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我经常发现，如果没有某种形式的实际应用，软件开发的理论方面对我来说将会迷失。在我职业生涯的早期，我会通过尝试自己建造东西的形式来寻求对事物如何运作的更好理解。这种“自己动手”的态度帮助我培养了充分利用现有库编写代码的能力。我坚信，我们不仅应该努力<code class="fe ky kz la lb b">know the documentation</code>和<code class="fe ky kz la lb b">use the tools</code>，还应该能够构建我们希望在项目中使用的东西。</p><p id="9a1b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">考虑到这一点，我想我应该开始一个 DIY 系列，采用一些我们在野外很容易找到的功能，并提供一个易于实现的版本。</p><p id="2a61" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">本文将重点关注阅读更多组件。</p></div><div class="ab cl lc ld hr le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ig ih ii ij ik"><h1 id="2a14" class="lj lk in bd ll lm ln lo lp lq lr ls lt jt lu ju lv jw lw jx lx jz ly ka lz ma bi translated">什么是阅读更多组件？</h1><p id="6184" class="pw-post-body-paragraph kc kd in ke b kf mb jo kh ki mc jr kk kl md kn ko kp me kr ks kt mf kv kw kx ig bi translated">Read More 组件用于对用户隐藏文本以节省屏幕空间。其核心是，它要么控制组件的高度以显示文本的<code class="fe ky kz la lb b">n</code>行，要么截断显示的字符数，后跟一个指示符，指示还有更多文本要读。这个指示器可以简单到文本末尾的省略号(<code class="fe ky kz la lb b">…</code>)和一个写着<code class="fe ky kz la lb b">Read More.</code>的链接/按钮</p><h1 id="5651" class="lj lk in bd ll lm mg lo lp lq mh ls lt jt mi ju lv jw mj jx lx jz mk ka lz ma bi translated">创建您自己的 Read More 组件</h1><p id="b5be" class="pw-post-body-paragraph kc kd in ke b kf mb jo kh ki mc jr kk kl md kn ko kp me kr ks kt mf kv kw kx ig bi translated">我们今天创建的 Read More 组件将使用 React 组件、Emotion styled 组件和 CSS <code class="fe ky kz la lb b">-webkit-line-clamp</code>属性。我们的 React 组件将处理更新状态值，如组件是否打开、<code class="fe ky kz la lb b">Read More</code>按钮文本的值，并传递要在我们的样式化组件中与 CSS 一起使用的行数。CSS 属性将允许我们把组件的文本限制在给定的行数。</p><h2 id="e3d8" class="ml lk in bd ll mm mn dn lp mo mp dp lt kl mq mr lv kp ms mt lx kt mu mv lz mw bi translated">反应</h2><figure class="mx my mz na gt nb"><div class="bz fp l di"><div class="nc nd l"/></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">阅读更多反应组件</figcaption></figure><p id="0bd2" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="ke io">道具</strong></p><p id="f8a7" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><code class="fe ky kz la lb b">ReadMoreBasic</code>组件接受 2 个道具:</p><ul class=""><li id="3abc" class="ni nj in ke b kf kg ki kj kl nk kp nl kt nm kx nn no np nq bi translated"><code class="fe ky kz la lb b">lines</code> —组件为<code class="fe ky kz la lb b">closed</code>时显示的行数</li><li id="c87c" class="ni nj in ke b kf nr ki ns kl nt kp nu kt nv kx nn no np nq bi translated"><code class="fe ky kz la lb b">children</code> —组件将呈现的内容。</li></ul><p id="d0a3" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="ke io">状态</strong></p><p id="a0cf" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在<code class="fe ky kz la lb b">lines 13-15</code>中，我们用<code class="fe ky kz la lb b">useState</code> React 钩子设置我们的状态值。</p><ul class=""><li id="cafb" class="ni nj in ke b kf kg ki kj kl nk kp nl kt nm kx nn no np nq bi translated"><code class="fe ky kz la lb b">isOpen</code>是一个布尔值，将控制组件是打开还是关闭。</li><li id="fa81" class="ni nj in ke b kf nr ki ns kl nt kp nu kt nv kx nn no np nq bi translated">每当<code class="fe ky kz la lb b">isOpen</code>值改变时，<code class="fe ky kz la lb b">readMoreText</code>将用于更新<code class="fe ky kz la lb b">ReadMoreButton</code>样式组件的文本。</li><li id="bad8" class="ni nj in ke b kf nr ki ns kl nt kp nu kt nv kx nn no np nq bi translated"><code class="fe ky kz la lb b">className</code>将被传递到<code class="fe ky kz la lb b">Body</code>样式的组件中。这将允许我们根据组件的打开/关闭状态来切换 css。</li></ul><p id="3e3f" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">功能</p><p id="959d" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在<code class="fe ky kz la lb b">line 17</code>上，我们有一个<code class="fe ky kz la lb b">handleClick</code>函数，它非常简单明了——它处理点击！基本上，它所做的就是切换<code class="fe ky kz la lb b">isOpen</code>状态值，并使用基于此的逻辑来导出其他状态值。我们将这个函数传递给<code class="fe ky kz la lb b">ReadMoreButton</code>样式的组件，作为它的<code class="fe ky kz la lb b">onClick</code>事件处理程序。</p><h2 id="eeb9" class="ml lk in bd ll mm mn dn lp mo mp dp lt kl mq mr lv kp ms mt lx kt mu mv lz mw bi translated">半铸钢ˌ钢性铸铁(Cast Semi-Steel)</h2><figure class="mx my mz na gt nb"><div class="bz fp l di"><div class="nc nd l"/></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">处理酷阅读更多样式的样式组件</figcaption></figure><p id="38e4" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">虽然我们使用了一些其他样式的组件，但是我们只关心<code class="fe ky kz la lb b">Body</code>组件，因为它承担了所有繁重的工作(至少在视觉上是这样的！).</p><p id="0542" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在<code class="fe ky kz la lb b">lines 2-3</code>中，我们使用<code class="fe ky kz la lb b">display: -webkit-box;</code>和<code class="fe ky kz la lb b">-web-kit-orient: vertical;</code>来启用<code class="fe ky kz la lb b">-webkit-line-clamp</code>的使用。</p><p id="3f46" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在<code class="fe ky kz la lb b">lines 4-5</code>中，我们设置组件关闭时的高度，作为<code class="fe ky kz la lb b">16px * # of lines * line-height</code>的计算，确保<code class="fe ky kz la lb b">Body</code>组件刚好足够大，可以容纳我们通过的任何文本行。</p><p id="c725" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在<code class="fe ky kz la lb b">line 6</code>上，我们使用<code class="fe ky kz la lb b">overflow: hidden;</code>来确保任何超出<code class="fe ky kz la lb b">Body</code>组件高度的文本内容对用户隐藏。</p><p id="b071" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><code class="fe ky kz la lb b">.open</code>类将高度设置为 auto，显示我们所有的文本。</p><p id="23e3" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><code class="fe ky kz la lb b">.closed</code>类设置了与<code class="fe ky kz la lb b">-webkit-line-clamp</code>一起使用的行数，并设置了<code class="fe ky kz la lb b">text-overflow: ellipsis</code> CSS 属性，以便在被箝位的文本内容的末尾给我们一个漂亮的尾随省略号(<code class="fe ky kz la lb b">…</code>)。</p><h2 id="2339" class="ml lk in bd ll mm mn dn lp mo mp dp lt kl mq mr lv kp ms mt lx kt mu mv lz mw bi translated">用法和结果</h2><p id="2dac" class="pw-post-body-paragraph kc kd in ke b kf mb jo kh ki mc jr kk kl md kn ko kp me kr ks kt mf kv kw kx ig bi translated">在你设置好你的组件后，你应该能够像这样使用它…</p><figure class="mx my mz na gt nb"><div class="bz fp l di"><div class="nc nd l"/></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">阅读更多组件用法</figcaption></figure><p id="15d9" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">…并得到这样的结果:</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi nw"><img src="../Images/96fce4fcb56e0d236684ab221430ff83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*AjuQeK4queo1aJWQNVeGkQ.gif"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">阅读更多示例</figcaption></figure><p id="5fd5" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">正如您所看到的，我们的组件中有一些文本，关闭时被夹到 2 行，后面有一个省略号，打开时可以看到完整的文本。<code class="fe ky kz la lb b">Read More</code>按钮的文本也被切换，以向用户显示组件所处的状态。</p><p id="e273" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">很酷，对吧？！？！</p><h1 id="83f8" class="lj lk in bd ll lm mg lo lp lq mh ls lt jt mi ju lv jw mj jx lx jz mk ka lz ma bi translated">挑战…</h1><p id="3b7f" class="pw-post-body-paragraph kc kd in ke b kf mb jo kh ki mc jr kk kl md kn ko kp me kr ks kt mf kv kw kx ig bi translated">组件本身很酷，但还可以更酷。我们可以在打开和关闭时转换组件的高度…但是要做到这一点，我们需要知道组件在打开状态下的高度，对吗？那么当窗口大小改变时呢？？那我们就得重新测量成分了！那么其他传入更多 HTML 的方式呢，比如标题标签、列表等等，它们有不同的字体高度和边距。？？？？那么可访问性呢天哪！</p><p id="089a" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">嗯，再加一点点努力(也可能很多——我不知道你在职业生涯的哪个阶段！)我们可以解决所有这些问题！</p><p id="f3be" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为什么？因为我们是超级棒的开发人员，喜欢解决问题！</p><p id="d1a5" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我不会详细讲述我是如何解决其中一些问题的，但是我会把代码沙箱留在这里，供您随意使用。</p><figure class="mx my mz na gt nb"><div class="bz fp l di"><div class="od nd l"/></div></figure></div><div class="ab cl lc ld hr le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ig ih ii ij ik"><p id="39e9" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">好了，这就是我们要说的。希望我已经帮助你获得了一些知识，你也明白了自己动手做东西的重要性。我个人认为，对于处于各个阶段的开发人员来说，这是一个很好的练习，有助于培养您实现外部库使用的能力，而不仅仅是了解文档告诉您的内容。</p><p id="e8b4" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">感谢你的阅读，我希望你在下一个项目中好运连连！</p></div></div>    
</body>
</html>