<html>
<head>
<title>Mirror mirror on the wall, who’s the greatest (or smallest or equal) of them all? (Part one)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">墙上的魔镜魔镜，谁是最伟大的(或最小的或相等的)？(第一部分)</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/mirror-mirror-on-the-wall-whos-the-greatest-or-smallest-or-equal-of-them-all-part-one-ec9416a56aad?source=collection_archive---------19-----------------------#2022-10-31">https://blog.devgenius.io/mirror-mirror-on-the-wall-whos-the-greatest-or-smallest-or-equal-of-them-all-part-one-ec9416a56aad?source=collection_archive---------19-----------------------#2022-10-31</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="1e65" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">你知道那个直到 10 岁才开口说话的男孩的故事吗？C++20 标准中出现的新的三向比较运算符&lt; = &gt;有点像这个小男孩——如果这个介绍没有任何意义，那么对于许多 C++开发人员来说，新的&lt; = &gt;运算符也没有意义。在这两个系列的文章中，我将解开并解释您需要了解的关于新的&lt; = &gt;操作符(又名飞船操作符)的一切，这样您就可以轻松地进行比较了。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi kc"><img src="../Images/2af9f48ef6c049188f05a8c12e63b8d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/1*bgMjlHlZshNexzX6TlzB2g.gif"/></div></figure><p id="09ad" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">你知道那个直到 10 岁才开口说话的男孩的故事吗？他的父母带他去看了最好的专家:语言治疗师、儿童发展专家、医生和心理学家——都没有用。这个男孩一句话也没说，没有人，甚至是最好的专家，能解释为什么。直到有一天，男孩的妈妈给他端上了一些热巧克力。“太热了！”男孩说。“我的好主人！你会说话！”，母亲哭了，擦着喜悦的眼泪，“你怎么到现在才说？”，她问男孩。“到目前为止一切都很好”，男孩回答…</p><p id="2a6f" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">就像这个小男孩的故事一样，C++比较运算符一切都很好，它们是从 C 继承来的。比较运算符和方法多年来一直保持不变，它们的角色很清楚，并有一套简单明了的使用规则。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lg"><img src="../Images/17d74a2ccafbc12111c27cdc450a0427.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*USWj2M2VRSVzJKOCQu0aEg.png"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">图 1 在 C++中使用了很多年的比较运算符，它们继承自 C。</figcaption></figure><p id="2c09" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">直到有一天，事情不再顺利，需要一种新的方法来支持对象之间的三向比较。这就是三向比较运算符<strong class="km io"> &lt; = &gt; </strong>(也称为飞船运算符)作为新 C++20 标准的一部分的由来。</p><p id="c955" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">但是缺少了什么呢？我们真的需要另一种方法来比较物体吗？到底什么是三方比较？如果多年来一切都很好，为什么会突然改变？</p><p id="dc42" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">为了回答所有这些问题，我们首先需要看看到目前为止 C++中的事情是如何完成的。</p><h1 id="7e8f" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">最好是你认识的魔鬼？</h1><p id="0ab1" class="pw-post-body-paragraph kk kl in km b kn mh jo kp kq mi jr ks kt mj kv kw kx mk kz la lb ml ld le lf ig bi translated">在编程中，当我们需要比较两个元素时，我们通常需要一个布尔值(是/否):</p><p id="bc1a" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">一个比另一个大/小/相等/不可比。</p><p id="2f76" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">因此，流程将是:is <strong class="km io"> A &lt; B </strong>，并且基于结果，check 是<strong class="km io"> A &gt; B </strong>。如果这些选项都不为真，我们可以说<strong class="km io"> A == B </strong>，但这超出了我们的查询范围，因为我们的查询只返回“真”或“假”。结论是我们需要<em class="mm">两个</em>查询来检查<em class="mm">三个</em>可能的结果。图 2 展示了在 C++20 之前两个操作数比较的流程。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/c4e7f5c8388a4155fc708b0a9ff77db1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/1*XA4LAJBNvHwwYiXReLrweg.png"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">图 2 比较运算符在两个操作数之间执行比较，并根据真或假的结果做出决定。在这种情况下，如果 A <b is="" false="" and="" if="" a=""> B 为假，那么 A=B。</b></figcaption></figure><p id="dc86" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">全新的三方比较<strong class="km io"> &lt; = &gt; </strong>，由于其类似宇宙飞船的形状，也被称为<em class="mm">宇宙飞船操作符</em>，是在新的 C++20 标准中引入的。这个操作符可以返回重载到它的三个比较的结果:小于操作符<strong class="km io"> ' </strong> &lt; <strong class="km io"> ' </strong>、等于操作符<strong class="km io"> ' </strong> = '和大于操作符“&gt;”，它们组合在一起构成了这个:<strong class="km io"> &lt; = &gt; </strong>。</p><p id="809c" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">如果你已经对 C++有所了解，你可能知道在引入 spaceship 操作符之前，程序员有时会使用继承自 C 时代的<strong class="km io"> memcmp() </strong>和<strong class="km io"> strcmp() </strong>函数。作为现代 C++一部分的基本<strong class="km io"> string::compare() </strong>过去是(现在仍然是)也是一个比较选项。当比较两个字符串时，这些函数能够提供三种结果之一，并且它们将返回一个整数来指示正值或负值。虽然，这些方法有点混乱和复杂，直到三向比较操作符，它们实际上是进行这种类型比较的唯一方法——这就是<strong class="km io"> &lt; = &gt; </strong>操作符诞生的原因。</p><h1 id="8d81" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">宇宙飞船操作员——这不是火箭科学</h1><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/2020e5d16bdadfa2581a3971d54718be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*0gdp85wVOiZmSStYDpT0Yg.gif"/></div></figure><p id="3c5e" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">对于许多 C++开发人员，尤其是 C++新手来说，三向比较运算符乍一看有些令人困惑。许多开发人员很难理解这艘宇宙飞船是从哪里“着陆”的，为什么一开始就需要它，特别是因为，直到现在，就像小男孩的故事一样，一切似乎都很好。在这一节中，我们将解释到底是什么让飞船操作员变得更好，以及为什么需要它。但是，请注意，本节中的解释是不全面的，仅涉及什么是三向比较及其基本逻辑。在这一节中，我们不教如何在您的代码中实际使用这个操作符。</p><blockquote class="mp mq mr"><p id="793c" class="kk kl mm km b kn ko jo kp kq kr jr ks ms ku kv kw mt ky kz la mu lc ld le lf ig bi translated">在我们的书<a class="ae mv" href="https://www.manning.com/books/learning-c-plus-plus" rel="noopener ugc nofollow" target="_blank"> <em class="in"> Learning C++ </em> </a>的第 3 章和第 6 章中，作者是 Michael Haephrati 和 Ruth Haephrati，由<a class="ae mv" href="https://www.manning.com/" rel="noopener ugc nofollow" target="_blank"> Manning Publications </a>出版，我们深入探讨了这个概念的实际属性，以及如何在您的代码中秘密地使用它。</p></blockquote><p id="d006" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">那么比较运算符是什么呢？让我们再看一下图 2:您可以看到，使用常规操作符，我们在问一个问题。比如<em class="mm">是 A &lt;比 B </em>？虽然我们有三种可能的结果，但我们只能从这三种结果中得到两种。这意味着我们需要进行另一个查询。让我们看看在这种情况下我们需要问什么:</p><p id="7e01" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated"><strong class="km io"> <em class="mm">问题 1:</em></strong>A 大于 B？</p><p id="1aef" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">然后根据答案，你问第二个问题:</p><p id="1ae1" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated"><strong class="km io"> <em class="mm">问题二:</em></strong>A 等于 B 吗？</p><p id="a0a7" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">新的 spaceship 操作符允许我们用一个<em class="mm">查询进行同样的压缩。每当使用&lt;、&gt;、&lt; =、&gt; =比较值时，我们都可以使用它。这就像去相亲，然后问:“<strong class="km io">告诉我我需要知道的关于你的一切..</strong>。”</em></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/d1f1de7f90b06f00d90c10cb60c6bb0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*ZmGl2rwZEBkoAjUQCw5_LA.gif"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">&lt;=&gt;就像“<strong class="bd lr">告诉我我需要知道的关于你的一切</strong> …”</figcaption></figure><p id="e5b0" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">三向比较允许你得到关于这个问题的答案:“你能告诉我关于 A 和 b 之间的关系吗？”</p><p id="5e76" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">使用三向压缩，您只需问一个问题，就会得到三种结果之一:</p><p id="38b5" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated"><strong class="km io"> A &gt; B </strong></p><p id="a580" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated"><strong class="km io"> B &gt; A </strong></p><p id="cbea" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated"><strong class="km io">甲=乙</strong></p><p id="7a59" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">图 3 展示了三向比较背后非常基本的逻辑。如你所见，在 A <b the="" three-way="" comparison="" function="" will="" return="" a="" number="" smaller="" than="" in="" case="" equal="" to="" and=""> B 的情况下，该函数将返回一个大于 0 的数字。</b></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/63589794ec4c1b6a0d56a6d790783fdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*RPGEKCR038WC7rjVLtIrnw.png"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk translated">图 3 图 3.10 三向比较返回 3 个可能的结果，而旧时间比较只会从 3 个结果中返回 2 个可能的结果。</figcaption></figure><p id="d1e2" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">除了这个非常酷的昵称之外，这个新操作符的巨大价值在于，通过使用它，我们将全部三个条件合并到一个简单的查询中。三分法又称<em class="mm">三分法</em>——分为三类。我们并不总是需要在代码中使用三分法，但当我们这样做时，飞船操作符非常方便，可以大大简化我们的代码。由于代码比文字更强大，让我们看看下面的两个代码片段。</p><p id="e69f" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated"><strong class="km io">样本 1:<br/></strong>A&lt;= B&amp;&amp;B&lt;= A</p><p id="2304" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">在这个样本中，我们问:A 小于等于 B 吗，B 小于等于 A 吗？</p><p id="2c92" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated"><strong class="km io">样品 2: <br/> </strong>！(A&lt;B&amp;&amp;！(B &lt; A)</p><p id="0024" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">在这个例子中，我们问:A 不小于 B，B 不小于 A 吗？</p><p id="c105" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">现在，我们可以将所有这些混乱合并成一个简洁的语句:</p><p id="3aa4" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated"><strong class="km io"> A &lt; = &gt; B </strong></p><p id="ca6a" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">多酷啊！</p><h1 id="9044" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">三向比较法的实际应用</h1><p id="3d56" class="pw-post-body-paragraph kk kl in km b kn mh jo kp kq mi jr ks kt mj kv kw kx mk kz la lb ml ld le lf ig bi translated">虽然在本文中，我们使用简单的例子来简化对复杂概念的解释，但是您可能会猜到在实际代码中，我们不会使用&lt;=&gt;来比较简单的对象或整数。在 C++20 中添加三向比较操作符的逻辑是为了简化复杂类型之间的比较，比如字符串、列表、序列和容器——我们将在本文的第二部分讨论这个问题。</p><p id="d59e" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">在下一篇文章中，我们将更深入地研究 spaceship 操作符，并学习如何在我们的代码中使用它，使用一种可以替换 memcmp()、strcmp()和 compare()的方法。</p><blockquote class="mp mq mr"><p id="8691" class="kk kl mm km b kn ko jo kp kq kr jr ks ms ku kv kw mt ky kz la mu lc ld le lf ig bi translated">C <em class="in"> ++是一种重要软件的严肃编程语言，30 年来一直是顶级编程语言之一——而且它的速度并没有减慢。到处都是 C++的指纹。学习它永远不会是一个糟糕的时间，我的新书</em><a class="ae mv" href="https://www.manning.com/books/learning-c-plus-plus" rel="noopener ugc nofollow" target="_blank"><em class="in"/></a><em class="in">，与</em> <a class="ae mv" href="https://www.linkedin.com/in/michaelhaephrati/" rel="noopener ugc nofollow" target="_blank"> <em class="in">迈克尔·海弗拉蒂</em> </a> <em class="in">合著并由曼宁出版社出版，将帮助你做到这一点——即使你没有任何编程或计算机科学经验。</em></p></blockquote></div></div>    
</body>
</html>