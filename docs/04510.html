<html>
<head>
<title>Create Graphics with Zoom and Pan with the Visx Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Visx库的缩放和平移功能创建图形</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/create-graphics-with-zoom-and-pan-with-the-visx-library-9cb6403a8ebe?source=collection_archive---------3-----------------------#2021-03-26">https://blog.devgenius.io/create-graphics-with-zoom-and-pan-with-the-visx-library-9cb6403a8ebe?source=collection_archive---------3-----------------------#2021-03-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/4a48a4a3e9dd5b54c3f62459ea59b574.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vf9M8wtnIvjSxl_7"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">micha Parzuchowski在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="1c71" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Visx是一个库，让我们可以轻松地将图形添加到React应用程序中。</p><p id="5429" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解如何在React应用程序中使用它来创建带有缩放和平移功能的图形。</p><h1 id="3ecb" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">安装所需的软件包</h1><p id="2968" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们必须安装一些模块。</p><p id="61e8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们运行:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="89df" class="mn lc iq mj b gy mo mp l mq mr">npm i @visx/clip-path @visx/event @visx/mock-data @visx/responsive @visx/scale @visx/zoom d3-scale-chromatic</span></pre><p id="8e2b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">安装软件包。</p><h1 id="4761" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">创建图形</h1><p id="04ad" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过添加模块提供的项目来创建图表。</p><p id="7bc9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们使用来自<code class="fe ms mt mu mj b">@visx/mock-data</code>模块的数据。</p><p id="7fee" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了创建和弦图，我们写下:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="9bc1" class="mn lc iq mj b gy mo mp l mq mr">import React, { useState } from "react";<br/>import { interpolateRainbow } from "d3-scale-chromatic";<br/>import { Zoom } from "@visx/zoom";<br/>import { localPoint } from "@visx/event";<br/>import { RectClipPath } from "@visx/clip-path";<br/>import genPhyllotaxis from "@visx/mock-data/lib/generators/genPhyllotaxis";<br/>import { scaleLinear } from "@visx/scale";</span><span id="8d53" class="mn lc iq mj b gy mv mp l mq mr">const bg = "#0a0a0a";<br/>const points = [...new Array(1000)];</span><span id="9a27" class="mn lc iq mj b gy mv mp l mq mr">const colorScale = scaleLinear({ range: [0, 1], domain: [0, 1000] });<br/>const sizeScale = scaleLinear({ domain: [0, 600], range: [0.5, 8] });</span><span id="1d67" class="mn lc iq mj b gy mv mp l mq mr">const initialTransform = {<br/>  scaleX: 1.27,<br/>  scaleY: 1.27,<br/>  translateX: -211.62,<br/>  translateY: 162.59,<br/>  skewX: 0,<br/>  skewY: 0<br/>};</span><span id="f301" class="mn lc iq mj b gy mv mp l mq mr">function Example({ width, height }) {<br/>  const [showMiniMap, setShowMiniMap] = useState(true);</span><span id="4325" class="mn lc iq mj b gy mv mp l mq mr">  const genenerator = genPhyllotaxis({<br/>    radius: 5,<br/>    width,<br/>    height<br/>  });<br/>  const phyllotaxis = points.map((d, i) =&gt; genenerator(i));</span><span id="4527" class="mn lc iq mj b gy mv mp l mq mr">return (<br/>    &lt;&gt;<br/>      &lt;Zoom<br/>        width={width}<br/>        height={height}<br/>        scaleXMin={1 / 2}<br/>        scaleXMax={4}<br/>        scaleYMin={1 / 2}<br/>        scaleYMax={4}<br/>        transformMatrix={initialTransform}<br/>      &gt;<br/>        {(zoom) =&gt; (<br/>          &lt;div className="relative"&gt;<br/>            &lt;svg<br/>              width={width}<br/>              height={height}<br/>              style={{ cursor: zoom.isDragging ? "grabbing" : "grab" }}<br/>            &gt;<br/>              &lt;RectClipPath id="zoom-clip" width={width} height={height} /&gt;<br/>              &lt;rect width={width} height={height} rx={14} fill={bg} /&gt;<br/>              &lt;g transform={zoom.toString()}&gt;<br/>                {phyllotaxis.map(({ x, y }, i) =&gt; (<br/>                  &lt;React.Fragment key={`dot-${i}`}&gt;<br/>                    &lt;circle<br/>                      cx={x}<br/>                      cy={y}<br/>                      r={i &gt; 500 ? sizeScale(1000 - i) : sizeScale(i)}<br/>                      fill={interpolateRainbow(colorScale(i) ?? 0)}<br/>                    /&gt;<br/>                  &lt;/React.Fragment&gt;<br/>                ))}<br/>              &lt;/g&gt;<br/>              &lt;rect<br/>                width={width}<br/>                height={height}<br/>                rx={14}<br/>                fill="transparent"<br/>                onTouchStart={zoom.dragStart}<br/>                onTouchMove={zoom.dragMove}<br/>                onTouchEnd={zoom.dragEnd}<br/>                onMouseDown={zoom.dragStart}<br/>                onMouseMove={zoom.dragMove}<br/>                onMouseUp={zoom.dragEnd}<br/>                onMouseLeave={() =&gt; {<br/>                  if (zoom.isDragging) zoom.dragEnd();<br/>                }}<br/>                onDoubleClick={(event) =&gt; {<br/>                  const point = localPoint(event) || { x: 0, y: 0 };<br/>                  zoom.scale({ scaleX: 1.1, scaleY: 1.1, point });<br/>                }}<br/>              /&gt;<br/>              {showMiniMap &amp;&amp; (<br/>                &lt;g<br/>                  clipPath="url(#zoom-clip)"<br/>                  transform={`<br/>                    scale(0.25)<br/>                    translate(${width * 4 - width - 60}, ${<br/>                    height * 4 - height - 60<br/>                  })<br/>                  `}<br/>                &gt;<br/>                  &lt;rect width={width} height={height} fill="#1a1a1a" /&gt;<br/>                  {phyllotaxis.map(({ x, y }, i) =&gt; (<br/>                    &lt;React.Fragment key={`dot-sm-${i}`}&gt;<br/>                      &lt;circle<br/>                        cx={x}<br/>                        cy={y}<br/>                        r={i &gt; 500 ? sizeScale(1000 - i) : sizeScale(i)}<br/>                        fill={interpolateRainbow(colorScale(i) ?? 0)}<br/>                      /&gt;<br/>                    &lt;/React.Fragment&gt;<br/>                  ))}<br/>                  &lt;rect<br/>                    width={width}<br/>                    height={height}<br/>                    fill="white"<br/>                    fillOpacity={0.2}<br/>                    stroke="white"<br/>                    strokeWidth={4}<br/>                    transform={zoom.toStringInvert()}<br/>                  /&gt;<br/>                &lt;/g&gt;<br/>              )}<br/>            &lt;/svg&gt;<br/>            &lt;div className="controls"&gt;<br/>              &lt;button<br/>                type="button"<br/>                className="btn btn-zoom"<br/>                onClick={() =&gt; zoom.scale({ scaleX: 1.2, scaleY: 1.2 })}<br/>              &gt;<br/>                +<br/>              &lt;/button&gt;<br/>              &lt;button<br/>                type="button"<br/>                className="btn btn-zoom btn-bottom"<br/>                onClick={() =&gt; zoom.scale({ scaleX: 0.8, scaleY: 0.8 })}<br/>              &gt;<br/>                -<br/>              &lt;/button&gt;<br/>              &lt;button<br/>                type="button"<br/>                className="btn btn-lg"<br/>                onClick={zoom.center}<br/>              &gt;<br/>                Center<br/>              &lt;/button&gt;<br/>              &lt;button type="button" className="btn btn-lg" onClick={zoom.reset}&gt;<br/>                Reset<br/>              &lt;/button&gt;<br/>              &lt;button type="button" className="btn btn-lg" onClick={zoom.clear}&gt;<br/>                Clear<br/>              &lt;/button&gt;<br/>            &lt;/div&gt;<br/>            &lt;div className="mini-map"&gt;<br/>              &lt;button<br/>                type="button"<br/>                className="btn btn-lg"<br/>                onClick={() =&gt; setShowMiniMap(!showMiniMap)}<br/>              &gt;<br/>                {showMiniMap ? "Hide" : "Show"} Mini Map<br/>              &lt;/button&gt;<br/>            &lt;/div&gt;<br/>          &lt;/div&gt;<br/>        )}<br/>      &lt;/Zoom&gt;<br/>      &lt;style jsx&gt;{`<br/>        .btn {<br/>          margin: 0;<br/>          text-align: center;<br/>          border: none;<br/>          background: #2f2f2f;<br/>          color: #888;<br/>          padding: 0 4px;<br/>          border-top: 1px solid #0a0a0a;<br/>        }<br/>        .btn-lg {<br/>          font-size: 12px;<br/>          line-height: 1;<br/>          padding: 4px;<br/>        }<br/>        .btn-zoom {<br/>          width: 26px;<br/>          font-size: 22px;<br/>        }<br/>        .btn-bottom {<br/>          margin-bottom: 1rem;<br/>        }<br/>        .description {<br/>          font-size: 12px;<br/>          margin-right: 0.25rem;<br/>        }<br/>        .controls {<br/>          position: absolute;<br/>          top: 15px;<br/>          right: 15px;<br/>          display: flex;<br/>          flex-direction: column;<br/>          align-items: flex-end;<br/>        }<br/>        .mini-map {<br/>          position: absolute;<br/>          bottom: 25px;<br/>          right: 15px;<br/>          display: flex;<br/>          flex-direction: column;<br/>          align-items: flex-end;<br/>        }<br/>        .relative {<br/>          position: relative;<br/>        }<br/>      `}&lt;/style&gt;<br/>    &lt;/&gt;<br/>  );<br/>}<br/>export default function App() {<br/>  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;Example width={500} height={300} /&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="50ed" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe ms mt mu mj b">bg</code>变量添加背景色。</p><p id="028f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">points</code>有一个数组，将与叶序螺旋图形的点填充，我们可以缩放和平移。</p><p id="88d6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">initialTransform</code>具有初始缩放和平移值。</p><p id="a50d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe ms mt mu mj b">Example</code>组件中，我们有<code class="fe ms mt mu mj b">showMiniMap</code>状态来切换小地图。</p><p id="a116" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">小地图让我们看到我们在图形中的位置。</p><p id="aa72" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了生成图形，我们调用<code class="fe ms mt mu mj b">genPhyllotaxis</code>来生成叶序螺旋图形。</p><p id="5727" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们创建<code class="fe ms mt mu mj b">phyllotaxis</code>变量来生成环的点。</p><p id="737e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们返回<code class="fe ms mt mu mj b">Zoom</code>组件，让我们放大和缩小图形。</p><p id="be7e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们设置比例和初始变换来显示初始图形。</p><p id="61f2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后为了创建叶序图形，我们调用<code class="fe ms mt mu mj b">phylloTaxis.map</code>来渲染螺旋的圆形。</p><p id="02e2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe ms mt mu mj b">interpolateRainbow</code>方法为叶序创建填充颜色。</p><p id="6ffa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这将创建一个彩虹颜色的效果。</p><p id="c56e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面，我们用<code class="fe ms mt mu mj b">g</code>元素创建小地图。</p><p id="4264" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在里面，我们用小地图上显示的叶序的迷你版本创建了一个片段。</p><p id="c6d6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面的<code class="fe ms mt mu mj b">rect</code>元素在小地图中显示的区域周围绘制了一个矩形。</p><p id="511f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在此之下，我们创建按钮，让我们放大和缩小，中心的图形，并重置图形到它的初始位置。</p><p id="df88" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们添加了一些样式来定位带有<code class="fe ms mt mu mj b">style</code>元素的图形显示。</p><h1 id="8c9c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="1846" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用Visx提供的库模块在React应用程序中创建图形并缩放和平移。</p></div></div>    
</body>
</html>