<html>
<head>
<title>Addendum: a few thoughts on neural networks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">附录:关于神经网络的一些想法</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/addendum-a-few-thoughts-on-neural-networks-4541b5fe5700?source=collection_archive---------8-----------------------#2022-08-06">https://blog.devgenius.io/addendum-a-few-thoughts-on-neural-networks-4541b5fe5700?source=collection_archive---------8-----------------------#2022-08-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/303886792b044b6a92589b18cefd9586.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JxLrjC7o3TS9KdnR"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Robina Weermeijer 在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="c6c0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">人工智能系列文章以上一篇文章结束，在那篇文章中，我们讨论了如何着手建立一个神经元的<a class="ae kc" rel="noopener ugc nofollow" target="_blank" href="/modelling-the-brain-neural-networks-6b1149fef1cc">网络</a>并赋予它们学习的能力。但是如果我就此结束整个讨论是不公平的。编写一层又一层的神经元是乏味的，并且涉及大量的尝试和错误。一个问题可能需要五个神经元的三个隐藏层，但下一个问题可能只需要两个隐藏层，如果添加更多，解决方案将无法达到最佳值。</p><p id="48cf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">幸运的是，有数学定理和统计结果可以帮助我们找到这些数字。幸运的是，有些库已经实现了所有的知识，自动平衡你的神经网络，使其包含适量的层和每层神经元。在本文中，我们将讨论这样一个库，它可以方便地在 javascript 中获得，但首先让我们探索神经网络的其他问题。</p><p id="7cd7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，架构是一个问题，但还有另一个问题:优化策略。我们已经提到了一些，如误差反向传播和使用粒子群优化算法，通过另一种形式的人工智能为我们找到权重，但还有更多。就像神经网络架构一样，优化算法可以在今天或下个月找到解决方案。为了让你知道到底有多少优化技术，我只想说，寻找关于神经网络的论文，我可以很容易地找到几百篇的论文，它们都解释了为什么他们的方法是最好的。我们应该如何选择最好的方法，更不用说实施它了？</p><p id="eca0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当然，这还不是全部。除了架构和优化方法之外，还有一种新型的神经网络，这种神经网络最近几年一直在兴起，现在被称为深度神经网络。这些网络就像其他任何网络一样，但它们使用数百层，每层有数百个神经元。甚至上千。“深度”一词简单地表示神经网络有多庞大。对于这种类型的网络，您无法手动编写它。如果你坐在那里摆弄通过每个神经元计算其权重的回路，你只是在浪费时间。我在这里说的是，实用和现代的神经网络只是不能手工编写。</p><h2 id="7c39" class="lc ld iq bd le lf lg dn lh li lj dp lk ko ll lm ln ks lo lp lq kw lr ls lt lu bi translated">优化神经网络训练</h2><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lv"><img src="../Images/da0af6be530ae84136d114e8d5e3b54d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LCSgJiS9EaHC-yCF"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">约翰·巴克利普在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="ee42" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我之前暗示过，有一些数学解决方案可以帮助我们编写和训练一个问题的最佳神经网络，我还说过我们甚至不需要知道它们:我们可以简单地使用库。最突出的一个当然是 TensorFlow，但我不怎么用它:它太复杂，做得太多，我很少需要这个主题的全部数学知识。尤其是在处理传统的业务问题时，如文档分类、猜测用户偏好和未来选择、查找交付时间表等等。这些世俗的问题很容易用一个简单的神经网络来解决。所以我一般最后都会用<code class="fe ma mb mc md b">brain.js</code>。</p><p id="a632" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在展示<code class="fe ma mb mc md b">brain.js</code>如何工作之前，我想再补充一点。当处理神经网络时，需要大量的计算来通过网络运行数据，收集错误并将它们传播回去以找到新的权重，并一次又一次地做所有事情来优化整个事情，直到你得到一个合理的解决方案:所有这些都需要在常规 CPU 上花费大量时间。这些操作可以并行化，并使用特殊指令一次运行大块数据，但 CPU 不知道如何做到这一点。</p><p id="9b66" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是有一个处理器知道:GPU。在使用神经网络库时，你会看到在 GPU 上运行优化步骤的选项。这一点非常重要，因为 CPU 根本无法以高效的方式执行优化算法所需的操作。幸运的是，<code class="fe ma mb mc md b">brain.js</code>知道如何将所有这些任务交给 GPU。当然，你也可以使用其他的库，如果你觉得勇敢，你可以直接使用 TensorFlow，我刚刚为我的经典业务选择了一个简单的流行库。</p><h2 id="374d" class="lc ld iq bd le lf lg dn lh li lj dp lk ko ll lm ln ks lo lp lq kw lr ls lt lu bi translated">brain.js 是如何工作的？</h2><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/5875e5c317ebd688787218e6c4460a7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*w-6teg6bojNvYC-Y"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/es/@mikehindle?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">迈克·辛德尔</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="0317" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你被上一篇文章的数学和算法吓到了，你会很高兴地得知<code class="fe ma mb mc md b">brain.js</code>能够优化并找到解决你问题的最佳神经网络，只需三个步骤:</p><pre class="lw lx ly lz gt me md mf mg aw mh bi"><span id="fe9b" class="lc ld iq md b gy mi mj l mk ml">const neuralNetwork = new brain.NeuralNetwork();</span><span id="fd4a" class="lc ld iq md b gy mm mj l mk ml">neuralNetwork.train([<br/>  { input: [0.0, 0.0], output: [0.0] },<br/>  { input: [0.2, 0.2], output: [0.4] },<br/>  { input: [0.2, 0.3], output: [0.6] },<br/>  { input: [0.3, 0.4], output: [1.2] }<br/>]);</span><span id="5151" class="lc ld iq md b gy mm mj l mk ml">neuralNetwork.run([0.2, 0.6]); </span></pre><p id="357e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们实例化一个<code class="fe ma mb mc md b">NeuralNetwork</code>类，使用我们的训练数据训练它，这是我在 Github 上为我的前一篇文章准备的，我们完成了:准备使用<code class="fe ma mb mc md b">run</code>函数测试我们的输入，它不是训练数据的一部分。如果我们希望给出一些关于如何构建网络的指示，我们还可以添加一个设置步骤:</p><pre class="lw lx ly lz gt me md mf mg aw mh bi"><span id="65cb" class="lc ld iq md b gy mi mj l mk ml">const setup = {<br/>  binaryThresh: 0.3, <br/>  hiddenLayers: [3, 3, 4, 2], <br/>  activation: 'sigmoid'<br/>};<br/>const neuralNetwork = new brain.NeuralNetwork(setup); </span></pre><p id="1b09" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的配置中，我们创建了一个具有四个隐藏层的神经网络，每个隐藏层都具有指定数量的神经元:第一个 13，第二个 13，第四个 14，最后一个 12。我们可以选择激活函数，即每个神经元在将信号进一步发送到网络之前应用于信号的函数。如果我们想忽略强度较低的信号，我们还可以选择激活阈值。所有这些都是使用<code class="fe ma mb mc md b">setup</code>对象简单而干净地完成的。看到了吗？没有公式，没有手动编写代码来定义网络，什么都没有。都是图书馆做的。</p><h2 id="f816" class="lc ld iq bd le lf lg dn lh li lj dp lk ko ll lm ln ks lo lp lq kw lr ls lt lu bi translated">分类示例</h2><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mn"><img src="../Images/b3718388c82c1e8d6752b2934b77e78a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YN6Hh5PBwT49YCqz"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@drew_beamer?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">德鲁·比默</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="48d9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上面的例子和上一篇文章中的例子不是很有用，也不是很聪明。假设我们有一个在线测试的答案列表，我们想将用户分为在家工作更有效率的用户和在办公室工作更好的用户。为了举例，我们不会详细讨论测验问题。我们刚刚有了结果:</p><pre class="lw lx ly lz gt me md mf mg aw mh bi"><span id="891e" class="lc ld iq md b gy mi mj l mk ml">const data = [<br/>  { input: [0, 1, 1, 0, 0, 0, 1], output: [0] },<br/>  { input: [0, 0, 0, 0, 1, 1, 0], output: [0] },<br/>  { input: [0, 1, 1, 0, 0, 1, 1], output: [1] },<br/>  { input: [1, 1, 1, 0, 0, 1, 0], output: [1] }];</span></pre><p id="7928" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们的测验有四个结果。这些问题全是对或错，因此结果中有 1 和 0。两个用户喜欢在家工作，输出为 0；两个用户喜欢在办公室工作，输出为 1。我们可以用这些数据做什么？我们可以先训练一个神经网络。neural network()；</p><pre class="lw lx ly lz gt me md mf mg aw mh bi"><span id="c3b2" class="lc ld iq md b gy mi mj l mk ml">const neuralNetwork = new brain.NeuralNetwork();<br/>neuralNetwork.train(data);</span></pre><p id="4581" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们可以运行一个新的数据点，一个不存在于训练数据中的数据点，来猜测该响应会产生什么:在家或在办公室工作:</p><pre class="lw lx ly lz gt me md mf mg aw mh bi"><span id="3466" class="lc ld iq md b gy mi mj l mk ml">neuralNetwork.run([0, 1, 0, 1, 0, 1, 0]); </span></pre><p id="9dbf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">结果会给我们一个 1 或 0(或接近于 0，因为计算是用小数进行的)，让我们知道虚拟用户是否喜欢在家或办公室工作。这被称为分类问题，在任何业务中都有成百上千的案例:用户偏好、工作空间分配、检测文档是否包含敏感信息等等。</p></div><div class="ab cl mo mp hu mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="ij ik il im in"><p id="eb37" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个简短的附录就说到这里。我只是觉得我需要补充这一点，不要让围绕神经网络的整个讨论陷入这样一个境地，人们会完全放弃这个主题，觉得数学太复杂了。实际上这并不复杂:所有编程语言都有数百个可用的库。</p><p id="ec8c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我刚刚选择了<code class="fe ma mb mc md b">brain.js</code>来用 Javascript 展示一个快速原型，这样我们都可以对神经网络感觉更好，并在我们的项目中给它们一个机会。我希望这是一篇有用的文章，再次感谢您的阅读，下次再见！</p></div></div>    
</body>
</html>