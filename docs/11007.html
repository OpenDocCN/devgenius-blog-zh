<html>
<head>
<title>JMS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">（同 JavaMessageService）Java 消息服务</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/jms-676935cd2510?source=collection_archive---------25-----------------------#2022-12-12">https://blog.devgenius.io/jms-676935cd2510?source=collection_archive---------25-----------------------#2022-12-12</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/60ea12d68e5123777bd3645357679ebc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6uXsaijsyEroaSWR"/></div></div></figure><h1 id="ecaa" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated"><strong class="ak">什么是 JMS？</strong></h1><p id="4320" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">Java 消息服务(JMS)是一个应用程序接口(API ),它允许 Java 程序使用消息传递提供者的消息传递服务，如 IBM 的 MQSeries 或 Java 2 Platform，Enterprise Edition (J2EE)中包含的 JMS 提供者。JMS 允许应用程序组件以松耦合、可靠和异步的方式创建、发送、接收和读取消息。这使它们能够相互通信，而不需要知道底层消息传递系统或它们与之通信的其他组件的细节。JMS 是 Java Enterprise Edition (Java EE)平台的一部分，它经常用于企业应用程序开发。</p><h1 id="9ee9" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">为什么使用消息传递？</h1><p id="576c" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">消息传递在 JMS 和 Java EE 应用程序的上下文中有用有几个原因。一些主要的好处包括:</p><ul class=""><li id="7c9c" class="lr ls in kv b kw lt la lu le lv li lw lm lx lq ly lz ma mb bi translated"><strong class="kv io">解耦</strong>:消息传递允许不同的应用程序组件相互通信，而不需要知道其他组件或底层消息传递系统的细节。这将组件解耦，使整个系统更加灵活和可伸缩。</li><li id="069a" class="lr ls in kv b kw mc la md le me li mf lm mg lq ly lz ma mb bi translated"><strong class="kv io">可靠性</strong>:消息传递提供了一种可靠的方式来传递消息，即使在消息发送时组件不可用。例如，一条消息可以被传递到一个目标队列，它将一直保留在那里，直到消费者准备好接收它。这消除了发送者重试发送消息或消费者轮询新消息的需要。</li><li id="4b87" class="lr ls in kv b kw mc la md le me li mf lm mg lq ly lz ma mb bi translated"><strong class="kv io">异步</strong>:消息传递允许组件之间的通信是异步的，这意味着发送方和接收方不需要同时处于活动状态。这可以提高系统的性能和可伸缩性，因为它允许组件在消息准备就绪时处理消息，而不必等待其他组件的响应。</li><li id="6ae7" class="lr ls in kv b kw mc la md le me li mf lm mg lq ly lz ma mb bi translated"><strong class="kv io">负载平衡</strong>:在分布式系统中，消息传递可用于在多个消费者进程或机器之间分配工作负载，从而提高系统的整体性能和可伸缩性。</li><li id="470d" class="lr ls in kv b kw mc la md le me li mf lm mg lq ly lz ma mb bi translated"><strong class="kv io">事务支持</strong> : JMS 支持事务，允许多个消息作为一个原子单元发送或接收。这可以确保事务中的所有消息都成功传递，或者都不传递。这对于确保分布式系统中数据的完整性非常有用。</li></ul><h1 id="9fa4" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">混乱模型</h1><p id="727b" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">JMS 中有两种主要的消息传递模型:点对点(PTP)和发布/订阅(发布/订阅)。</p><figure class="mi mj mk ml gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mh"><img src="../Images/348801ae34a63ac2811d431c57146784.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6GagmsTxXxvaz4SnPuI8ig.png"/></div></div></figure><ul class=""><li id="6287" class="lr ls in kv b kw lt la lu le lv li lw lm lx lq ly lz ma mb bi translated"><strong class="kv io">点对点(PTP) </strong>:在 PTP 模型中，每条消息只有一个消费者。这类似于向特定收件人发送电子邮件，只有该收件人可以阅读邮件。发送者将消息发送到目标队列，使用者从该队列接收消息。当发送者和消费者彼此不认识时，或者当消息只需要传递给一个消费者时，通常使用 PTP 模型。</li><li id="82f7" class="lr ls in kv b kw mc la md le me li mf lm mg lq ly lz ma mb bi translated"><strong class="kv io">发布/订阅(pub/sub) </strong>:在发布/订阅模型中，每条消息可以有多个消费者。这类似于向邮件列表发送电子邮件，其中多个收件人可以阅读邮件。发送者将消息发送到目的地主题，消费者从该主题接收消息。当多个消费者对同一类型的信息感兴趣时，或者当发送者和消费者彼此不认识时，通常使用发布/订阅模型。</li></ul><p id="2510" class="pw-post-body-paragraph kt ku in kv b kw lt ky kz la lu lc ld le mm lg lh li mn lk ll lm mo lo lp lq ig bi translated">PTP 模型和发布/订阅模型都有各自的优点和缺点，使用哪种模型取决于应用程序的需求。</p><h1 id="72ca" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">JMS 消息</h1><figure class="mi mj mk ml gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mp"><img src="../Images/2b7cd8f55b396ac36d4eb6736d4e8e7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H0o_fo6qj46t1b1WyBYOZw.png"/></div></div></figure><p id="273d" class="pw-post-body-paragraph kt ku in kv b kw lt ky kz la lu lc ld le mm lg lh li mn lk ll lm mo lo lp lq ig bi translated">在 JMS 中，消息是包含从发送方发送到接收方的数据的对象。它由标题、属性和主体组成。</p><ul class=""><li id="c5bd" class="lr ls in kv b kw lt la lu le lv li lw lm lx lq ly lz ma mb bi translated"><strong class="kv io">消息头包含关于消息的元数据，比如消息 ID、目的地和传递模式。</strong></li><li id="1edf" class="lr ls in kv b kw mc la md le me li mf lm mg lq ly lz ma mb bi translated"><strong class="kv io">属性是可选的名称-值对，可用于提供关于消息的附加信息。</strong></li><li id="31fe" class="lr ls in kv b kw mc la md le me li mf lm mg lq ly lz ma mb bi translated"><strong class="kv io">正文包含消息中发送的实际数据。主体可以是文本、二进制流或序列化的 Java 对象。</strong></li></ul><p id="da78" class="pw-post-body-paragraph kt ku in kv b kw lt ky kz la lu lc ld le mm lg lh li mn lk ll lm mo lo lp lq ig bi translated">JMS 定义了几种不同的消息类型，可以根据应用程序的需求来使用。一些最常见的消息类型包括:</p><ul class=""><li id="3b1e" class="lr ls in kv b kw lt la lu le lv li lw lm lx lq ly lz ma mb bi translated"><strong class="kv io">文本消息</strong>:该消息类型用于发送基于文本的消息。消息体可以是字符串、字符流或字节流。</li><li id="6d8e" class="lr ls in kv b kw mc la md le me li mf lm mg lq ly lz ma mb bi translated"><strong class="kv io"> MapMessage </strong>:该消息类型用于发送包含一组名称-值对的消息。名称和值可以是任何 Java 原语类型。</li><li id="ca93" class="lr ls in kv b kw mc la md le me li mf lm mg lq ly lz ma mb bi translated"><strong class="kv io"> ObjectMessage </strong>:该消息类型用于发送序列化的 Java 对象。该对象必须是可序列化的，以便在消息中发送。</li><li id="c37f" class="lr ls in kv b kw mc la md le me li mf lm mg lq ly lz ma mb bi translated"><strong class="kv io"> StreamMessage </strong>:该消息类型用于发送包含原始值流的消息。流可以按照写入的顺序读取。</li><li id="1ba9" class="lr ls in kv b kw mc la md le me li mf lm mg lq ly lz ma mb bi translated"><strong class="kv io">字节消息</strong>:该消息类型用于发送包含未解释字节流的消息。可以按照写入的顺序读取字节。</li></ul><p id="6744" class="pw-post-body-paragraph kt ku in kv b kw lt ky kz la lu lc ld le mm lg lh li mn lk ll lm mo lo lp lq ig bi translated">每种消息类型都有自己的优点和缺点，使用哪种消息类型取决于应用程序的需求。</p><h1 id="35ef" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">MOM 服务提供商</h1><ul class=""><li id="4e4d" class="lr ls in kv b kw kx la lb le mq li mr lm ms lq ly lz ma mb bi translated">IBM MQSeries  : IBM MQSeries 是一个消息传递平台，为应用程序提供高性能和可伸缩的消息传递基础设施。它支持 JMS 和 WebSphere MQ APIs，并且可以在各种环境中使用，包括内部环境、云环境和混合环境。</li><li id="093e" class="lr ls in kv b kw mc la md le me li mf lm mg lq ly lz ma mb bi translated"><strong class="kv io">Apache ActiveMQ</strong>:Apache ActiveMQ 是一个开源的消息传递平台，支持多种协议，包括 JMS、AMQP 和 MQTT。它设计为快速、可扩展和可靠，可用于各种环境，包括内部、云和混合环境。</li><li id="44b7" class="lr ls in kv b kw mc la md le me li mf lm mg lq ly lz ma mb bi translated"><strong class="kv io"> Solace </strong> : Solace 是一个消息平台，为应用程序提供高性能和可伸缩的消息基础设施。它支持多种协议，包括 JMS、AMQP 和 MQTT，并且可以在多种环境中使用，包括内部环境、云环境和混合环境。</li><li id="6694" class="lr ls in kv b kw mc la md le me li mf lm mg lq ly lz ma mb bi translated">RabbitMQ  : RabbitMQ 是一个开源消息平台，支持多种协议，包括 JMS、AMQP 和 MQTT。它设计为易于使用和可扩展，可用于各种环境，包括内部、云和混合环境。</li></ul><p id="01d6" class="pw-post-body-paragraph kt ku in kv b kw lt ky kz la lu lc ld le mm lg lh li mn lk ll lm mo lo lp lq ig bi translated">还有许多其他可用的 MOM 服务提供者，使用哪个提供者取决于应用程序的需求。</p><h1 id="f9d2" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">JMS 组件</h1><figure class="mi mj mk ml gt jo gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/2bc329c55c3c4ba89e9cb93853c98497.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/0*m7Pi4rG7OnwTyWmD.gif"/></div></figure><p id="62f0" class="pw-post-body-paragraph kt ku in kv b kw lt ky kz la lu lc ld le mm lg lh li mn lk ll lm mo lo lp lq ig bi translated">JMS 有几个用于创建和使用消息的关键组件。一些最重要的组件包括:</p><ul class=""><li id="e628" class="lr ls in kv b kw lt la lu le lv li lw lm lx lq ly lz ma mb bi translated"><strong class="kv io"> ConnectionFactory </strong>:这是一个用于创建 JMS 连接的工厂对象。连接表示到 JMS 提供者的物理连接，它用于创建会话、生产者和消费者。</li></ul><figure class="mi mj mk ml gt jo gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/2db6f01993093ec96c75351969bf785b.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/1*oeBPnXbjWrqKQ686gxpWCA.png"/></div></figure><ul class=""><li id="fed2" class="lr ls in kv b kw lt la lu le lv li lw lm lx lq ly lz ma mb bi translated"><strong class="kv io">目的地</strong>:表示消息的目的地，比如队列或者主题。目的地由 JMS 提供者创建，生产者使用它来指定消息应该发送到哪里。消费者使用目的地来指定它希望从哪里接收消息。</li><li id="317a" class="lr ls in kv b kw mc la md le me li mf lm mg lq ly lz ma mb bi translated"><strong class="kv io">连接</strong>:这表示到 JMS 提供者的物理连接。连接由连接工厂创建，用于创建会话、生产者和消费者。连接可以是事务性的，也可以是非事务性的，这取决于它的配置方式。</li></ul><figure class="mi mj mk ml gt jo gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/ea3a1dfece5b83a507ddb9aa3ef05878.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*dN3tF-we03ZNHIA3ruZcww.png"/></div></figure><ul class=""><li id="b81f" class="lr ls in kv b kw lt la lu le lv li lw lm lx lq ly lz ma mb bi translated"><strong class="kv io"> Session </strong>:这代表一个单线程上下文，用于发送和接收消息。会话由连接创建，您可以使用会话来创建以下内容:消息生产者、消息消费者、消息、队列浏览器、临时队列和主题。</li></ul><figure class="mi mj mk ml gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mw"><img src="../Images/e3304e6d48cff25570d7c31c98724ae7.png" data-original-src="https://miro.medium.com/v2/resize:fit:870/format:webp/1*JoIh8t59dpdwO1yHts11aA.png"/></div></div></figure><figure class="mi mj mk ml gt jo gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/e327fcb312f101a93095a4f969609606.png" data-original-src="https://miro.medium.com/v2/resize:fit:1186/format:webp/1*Aw48cmE8S4NarYLICn_Nhw.png"/></div></figure><figure class="mi mj mk ml gt jo gh gi paragraph-image"><div class="gh gi my"><img src="../Images/fa913a0a5790ea6b6e501340c30bc934.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/1*AQcSum17TRR10tU_ut_GwA.png"/></div></figure><ul class=""><li id="2d79" class="lr ls in kv b kw lt la lu le lv li lw lm lx lq ly lz ma mb bi translated"><strong class="kv io"> MessageProducer </strong>:用于向目的地发送消息。生产者由会话创建，用于指定消息应该发送到的目的地，以及消息的传递模式、优先级和生存时间。</li></ul><figure class="mi mj mk ml gt jo gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/dd7d759337f07fe38d6d2c54faade26f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*HAtJk-FP9QNL4iDthdukgg.png"/></div></figure><ul class=""><li id="7714" class="lr ls in kv b kw lt la lu le lv li lw lm lx lq ly lz ma mb bi translated"><strong class="kv io"> MessageConsumer </strong>:用于接收来自目的地的消息。使用者由会话创建，用于指定接收消息的目的地。使用者可以是同步的，也可以是异步的，这取决于它的配置方式。</li></ul><figure class="mi mj mk ml gt jo gh gi paragraph-image"><div class="gh gi na"><img src="../Images/ea2c59c5f8bbf47de86b7ff8e23589e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/1*a89dEq9JKnl4pkHcL6LpcQ.png"/></div></figure><ul class=""><li id="1ce5" class="lr ls in kv b kw lt la lu le lv li lw lm lx lq ly lz ma mb bi translated"><strong class="kv io">消息</strong>:这是包含正在发送或接收的数据的对象。消息有头、属性和正文。使用的消息类型取决于应用程序的要求。</li></ul><figure class="mi mj mk ml gt jo gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/ea3356fa92dbb5776a04e1bf57e7d135.png" data-original-src="https://miro.medium.com/v2/resize:fit:348/0*Uy_-vtMKNvRcqO2U.gif"/></div></figure><figure class="mi mj mk ml gt jo gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/4bbaf0a95ceabf8d26db27faf481a334.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*s10VgBLHfeQ69bMtJbZHmg.png"/></div></figure><h2 id="c718" class="nd jw in bd jx ne nf dn kb ng nh dp kf le ni nj kj li nk nl kn lm nm nn kr no bi translated">JMS 消息优先级</h2><p id="8b26" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">在 JMS 中，消息优先级用于指示消息的重要性或紧迫性。较高优先级的消息在较低优先级的消息之前被传递，允许应用程序优先传递它们的消息。</p><p id="26eb" class="pw-post-body-paragraph kt ku in kv b kw lt ky kz la lu lc ld le mm lg lh li mn lk ll lm mo lo lp lq ig bi translated">JMS 定义了十个级别的消息优先级，其中 0 是最低优先级，9 是最高优先级。默认情况下，消息的优先级为 4，除非应用程序指定了不同的优先级。消息优先级的确切行为可能会因 JMS 提供者而异，但通常情况下，优先级较高的消息会在优先级较低的消息之前交付。</p><p id="4cc7" class="pw-post-body-paragraph kt ku in kv b kw lt ky kz la lu lc ld le mm lg lh li mn lk ll lm mo lo lp lq ig bi translated">当使用 MessageProducer 接口的 setPriority()方法发送消息时，应用程序可以指定消息的优先级。例如:</p><figure class="mi mj mk ml gt jo gh gi paragraph-image"><div class="gh gi np"><img src="../Images/f60e8de2acd8772c7e67d61c7b3972db.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*D2cZ0PY_5jwY2eKH48skdA.png"/></div></figure><p id="a6b5" class="pw-post-body-paragraph kt ku in kv b kw lt ky kz la lu lc ld le mm lg lh li mn lk ll lm mo lo lp lq ig bi translated">应用程序还可以使用 MessageProducer 接口的 setPriority()方法指定生产者发送的消息应该使用的默认优先级。例如:</p><figure class="mi mj mk ml gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nq"><img src="../Images/c3116473a47a2ab75ab04f6abb6b888c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*53AQCyMOAaK6TPnZNUk9ag.png"/></div></div></figure><p id="701a" class="pw-post-body-paragraph kt ku in kv b kw lt ky kz la lu lc ld le mm lg lh li mn lk ll lm mo lo lp lq ig bi translated"><em class="nr">在某些情况下，使用消息优先级会很有用，比如当一个应用程序需要优先传递某些消息时。但是，需要注意的是，不能保证所有 JMS 提供者都遵守消息优先级，关键的应用程序功能也不应该依赖消息优先级。</em></p><figure class="mi mj mk ml gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ns"><img src="../Images/b3f8e46b2270bb79471c09fbe6c47650.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*um77kQ6j_Kd42fbeukMJ8w.png"/></div></div></figure><p id="cc4b" class="pw-post-body-paragraph kt ku in kv b kw lt ky kz la lu lc ld le mm lg lh li mn lk ll lm mo lo lp lq ig bi translated">接下来:<strong class="kv io">为生产设计 JMS 解决方案</strong></p></div></div>    
</body>
</html>