<html>
<head>
<title>complete email/password authentication with firebase-9 and next.js.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 firebase-9 和 next.js 完成电子邮件/密码认证</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/complete-email-password-authentication-with-firebase-9-and-nextjs-518392a3a530?source=collection_archive---------2-----------------------#2022-02-08">https://blog.devgenius.io/complete-email-password-authentication-with-firebase-9-and-nextjs-518392a3a530?source=collection_archive---------2-----------------------#2022-02-08</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/edd746fa6461991f10c3551413e16862.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9S8N9_51ABeEL3s7MK5Dfg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">在本文结束时，让我们看看我们将会构建什么。</figcaption></figure><p id="ba6c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">在我们继续之前，请确保您对以下内容有足够的了解。</strong></p><ol class=""><li id="d05e" class="ky kz in kc b kd ke kh ki kl la kp lb kt lc kx ld le lf lg bi translated">Next.js (react knowledge 就行)。如果没有，请点击这里的<a class="ae lh" href="https://nextjs.org/docs/getting-started" rel="noopener ugc nofollow" target="_blank">开始阅读文档。</a></li><li id="0951" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx ld le lf lg bi translated">Firebase(第 9 版)但如果你知道后续版本，你会轻松通过第 9 版。如果没有，也在处检查文档<a class="ae lh" href="https://firebase.google.com/docs/web/setup" rel="noopener ugc nofollow" target="_blank"/></li><li id="d293" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx ld le lf lg bi translated">确保在您的计算机中安装了最少的节点。下载节点<a class="ae lh" href="https://nodejs.org/en/download/" rel="noopener ugc nofollow" target="_blank">这里</a></li><li id="44ef" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx ld le lf lg bi translated">顺风 CSS。但是你可以选择使用你选择的任何其他 UI 库。点击查看文档<a class="ae lh" href="https://tailwindcss.com/docs/guides/nextjs" rel="noopener ugc nofollow" target="_blank"/></li></ol><p id="b66b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">你可以在这里克隆回购<a class="ae lh" href="https://github.com/SADIQQ005/firebase-9-auth" rel="noopener ugc nofollow" target="_blank">。或者你完全可以开始一个新的项目，这是你的选择。闲聊够了，现在让我们进入正题。</a></p><p id="32df" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">第一步是创建一个 next.js 项目。通过命令行使用命令 npx create-next-app <your app="" name="">。在我的例子中，npx create-next-app auth-9。这是为那些选择不克隆我的应用程序。</your></p><figure class="lo lp lq lr gt jo gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/43ad66d7c9175e2e3741215aee19d132.png" data-original-src="https://miro.medium.com/v2/resize:fit:918/format:webp/1*Qlk-8eUhxFLfwUI4kFn9jA.png"/></div></figure><p id="c35e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">等待它完成安装，安装完成后可能需要一些时间。通过运行 cd <your app="" name="">进入项目目录，在我的例子中是 cd auth-9。然后用你最喜欢的文本编辑器打开它。如果你像我一样喜欢 Vs 代码，你可以简单地运行代码。直接从终端用 Vs 代码打开项目。没那么容易。</your></p><figure class="lo lp lq lr gt jo gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/b156546c28c9a41ec4a8c9be88bd8d0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:632/format:webp/1*JtJjcP4-0SeF6inHqi6k3Q.png"/></div></figure><p id="5ede" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果你在你的文本编辑器上看到这个，你就在轨道上，不要介意你看到的 netlify 文件夹。否则，你一定跳过了一些东西，如果是这样，不用担心，原路返回。我相信你会回到正轨的。既然我们的第一步已经完成。</p><p id="4e1d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">第二步是安装 firebase 并在我们的项目中使用它。</p><ol class=""><li id="9cd3" class="ky kz in kc b kd ke kh ki kl la kp lb kt lc kx ld le lf lg bi translated">通过运行 npm install firebase 安装 firebase，等待它完成，或者不要等待，转到<a class="ae lh" href="https://console.firebase.google.com/" rel="noopener ugc nofollow" target="_blank"> firebase 控制台</a>并设置您的应用程序。让你有一个电子邮件，如果你以前没有使用过 firebase，否则只需点击控制台上的添加项目按钮。</li><li id="36bd" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx ld le lf lg bi translated">选择您的项目名称，然后点按“继续”。</li><li id="9aae" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx ld le lf lg bi translated">一旦你的项目准备好了，你会看到一个仪表板。点击网络图标。</li><li id="0479" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx ld le lf lg bi translated">注册您的应用程序。然后点击继续。</li><li id="9f3e" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx ld le lf lg bi translated">复制 sdk 并关闭页面，我们到此为止。</li><li id="ea86" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx ld le lf lg bi translated">现在，单击菜单栏上的“身份验证”,然后单击“开始”。点击电子邮件/密码按钮启用它，并点击保存。我们现在已经完成了 firebase 控制台。我们可以回到 Vs 代码或者你最喜欢的编辑器，记住我们的 firebase 安装已经完成。</li></ol><figure class="lo lp lq lr gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lt"><img src="../Images/a0c871d78bb26ee36e5bde44875bc7ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Oxsywpwi9osnIkSkzS0kOQ.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">消防基地控制台</figcaption></figure><figure class="lo lp lq lr gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lu"><img src="../Images/86d13279f444436ece559c3175b520f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FPpAWzs1yPofkCJIwGuO7Q.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">Firebase sdk</figcaption></figure><figure class="lo lp lq lr gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lv"><img src="../Images/bcf0dc9549edc23db41be2485be281cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nX5BoV68YMbykd6LLp_9PA.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">电子邮件/密码验证已启用</figcaption></figure><p id="69a9" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在 firebase 已经安装在我们的项目中。我们需要将应用程序连接到 firebase sdk。这很容易做到。</p><ol class=""><li id="8254" class="ky kz in kc b kd ke kh ki kl la kp lb kt lc kx ld le lf lg bi translated">在项目的根目录下创建一个 firebase 文件。</li><li id="7f19" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx ld le lf lg bi translated">记住我们从 firebase 复制的 sdk，现在粘贴到这里。有了新版本的 firebase(版本 9)。他们引入了他们所谓的树摇动方法，该方法允许每个 firebase 方法作为一个函数单独导入。我认为这很酷。下面你会注意到我从 firebase/auth 导入了 getAuth，并将其导出为 const。有了它，你可以把它导入到任何你想使用它的文件中，而不是在我们想使用它的每个组件中一次又一次地导入它。</li><li id="d760" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx ld le lf lg bi translated">现在 firebase 已经在我们的项目中设置好了，所以我们可以开始动手了。</li></ol><figure class="lo lp lq lr gt jo gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/aa185171405ee0f47c061dc67a670605.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*pLb2zwMHXBg_U_Kn0l4JPw.jpeg"/></div></figure><p id="8e12" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们从安装顺风开始。</p><figure class="lo lp lq lr gt jo gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/fce06347958ecc5fe659dac9c5b5c57e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*xqO5aiee8hnWcN3FOLa8og.png"/></div></figure><ol class=""><li id="f157" class="ky kz in kc b kd ke kh ki kl la kp lb kt lc kx ld le lf lg bi translated">运行上面的以下命令</li><li id="c1a1" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx ld le lf lg bi translated">打开刚刚创建的 tailwind.config.js 文件，用下面的代码编辑内容。</li><li id="22c0" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx ld le lf lg bi translated">打开 styles 文件夹中的 globals.css 文件，删除所有内容，然后粘贴下面的代码。</li><li id="bb17" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx ld le lf lg bi translated">运行 npm run dev 以在<a class="ae lh" href="http://localhost:3000/" rel="noopener ugc nofollow" target="_blank"> localhost:3000 </a>启动您的开发服务器。</li></ol><figure class="lo lp lq lr gt jo gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/a3698d946f2252ea61e101af57b8dbad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*OVXGYujJZ_CGIPBRY2W_gQ.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">tailwind.config.js</figcaption></figure><figure class="lo lp lq lr gt jo gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/dad65b6e6775f53a88fd33fb0e2dd7e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*dZ461XqevABlIPNuBU6P0g.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">全局变量. css</figcaption></figure><figure class="lo lp lq lr gt jo gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/646034df3e2d9e3ca7645d44dd2ca241.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*wXrvWpuWrOx1NsNFOPL_0Q.png"/></div></figure><p id="e1e0" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">打开 index.js，用下面的代码编辑它。</p><figure class="lo lp lq lr gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mb"><img src="../Images/cce7be115a925ca6cdd692e3678cdf94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1WzzHwLEIdXFqnIWbcxqmg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">索引. js</figcaption></figure><ol class=""><li id="b49e" class="ky kz in kc b kd ke kh ki kl la kp lb kt lc kx ld le lf lg bi translated">现在让我们复制输入 div 来获得我们的密码字段。如果你这样做，你只需要编辑标签说密码，也改变类型为密码。您也可以将占位符改为密码而不是电子邮件。</li><li id="b98f" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx ld le lf lg bi translated">将一个 on Change 处理程序附加到输入，并使用 react hook 来处理更改，如下所示。不要忘记把它也添加到密码输入中。</li><li id="c377" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx ld le lf lg bi translated">在表单标签上添加一个提交处理程序，这样当提交按钮被点击时，它可以执行登录用户的功能。</li><li id="091c" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx ld le lf lg bi translated">但是您需要在密码字段之后创建一个 submit 类型的输入字段。</li></ol><figure class="lo lp lq lr gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mc"><img src="../Images/8d602cf2ec620e3656a4624f5f675c00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*4nLBc5ftQdhIoj1_Jkpvig.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">index.js 使用 react 使用状态来绑定输入</figcaption></figure><figure class="lo lp lq lr gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi md"><img src="../Images/2a3d8d409454aafa89a1c7c279ab169e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cEVfy1SrVeRlyXH-HfiLgQ.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">index.js/login</figcaption></figure><p id="711f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在创建一个为您处理登录(handleLogin)的函数，它将接受一个事件。如下图所示。</p><figure class="lo lp lq lr gt jo gh gi paragraph-image"><div class="gh gi me"><img src="../Images/c8376124773496748150ee7d8ac2cad4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*90c7qbAi9dcj4WfTS6WF8w.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">index.js/login</figcaption></figure><p id="778a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">记住树摇动，你将必须像这样从 firebase/auth 导入 signInWithEmailAndPassword。我们还在 firebase.js 中将 auth 导出为一个 const，将它导入以便作为一个参数传递给 signInWithEmailAndPassword 方法，否则它将不起作用。</p><figure class="lo lp lq lr gt jo gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/c1a3f6ea20bf563da4a16beea892472d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/format:webp/1*aUt4sg6aYT5l2Y8yG2k1KA.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">index.js/login</figcaption></figure><p id="5625" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果你还没有运行 npm run dev 或 yarn dev，现在就运行它，并在 localhost:3000 上检查你的应用程序。它应该看起来像下面的图像。如果你追随我愚蠢的风格。键入电子邮件和密码，然后点击登录，它应该会抛出一个用户没有发现的错误😫如果你检查你的控制台。这是正确的，因为我们试图登录时，我们从来没有创建一个用户🤔。要解决这个问题，请返回 firebase 控制台，单击 authentication 选项卡并添加一个用户。输入凭证并添加。如果这样做了，回到你的应用程序，并尝试使用相同的凭证登录，它应该工作。</p><figure class="lo lp lq lr gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mg"><img src="../Images/97372f1e793a0f0d36f9403f617967f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cFyQ-Sys1s0t2-OCmlbLLA.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">索引/登录页面</figcaption></figure><figure class="lo lp lq lr gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mh"><img src="../Images/bba9cb03f4fe5ea13588a142406ad327.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FljoMVh9l4v8l_m0qM1JXg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">注册. js</figcaption></figure><p id="20d3" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在 login.js 已经完成，创建一个名为 signup.js 的新文件。复制 login.js 并粘贴到那里，您只需要更改一些内容。</p><ol class=""><li id="fa89" class="ky kz in kc b kd ke kh ki kl la kp lb kt lc kx ld le lf lg bi translated">就像文本所说的登录页面，把它改成注册页面。</li><li id="e125" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx ld le lf lg bi translated">让输入保持原样，您只需要将函数名改为 handleSignup，而不是 handleLogin，并且不要忘记在提交处理程序中进行更改。</li><li id="4e18" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx ld le lf lg bi translated">还要将方法 signUpWithEmailAndPassword 更改为 createUserWithEmailAndPassword。不要忘记导入它，就像我们导入 signInWithEmailAndPassword 一样。将 auth const 从 firebase.js 导入到。</li><li id="a668" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx ld le lf lg bi translated">你可以尝试在你的应用程序上注册，看看是否有效。</li></ol><p id="4cdc" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们的应用程序的工作显而易见。让我们创建一个仪表板页面，它不会做太多，但至少我们会知道用户何时登录。用户也可以注销。</p><figure class="lo lp lq lr gt jo gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/4f22a9fe500cdeafd35994e7412cbd7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*db3KdKQYGibjkd8cVYGAXg.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">dashboard.js</figcaption></figure><figure class="lo lp lq lr gt jo gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/853536cb18927eef72bb4e03c9c498ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*KhMPOfyF8ZFfc3bSb7q8JQ.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">dashboard.js</figcaption></figure><p id="2299" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">对于像我这样经常忘记密码的人来说😬。不要担心 firebase 让我们覆盖了密码重置，您可以随时重置您的密码时，试图登录。</p><p id="7bb5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在让我们创建一个 passwordReset.js 文件，您可以选择对登录页面使用相同的样式。如果是这样，只需将您的 login.js 复制到 resetPassword，并将上面的登录文本更改为 reset password，同时将函数名更改为 handleReset。不要忘记将其传递给提交处理程序，删除密码字段，因为我们不会使用它。如果这样做了，改变方法 signInWithEmailAndPassword 为 sendPasswordResetEmail，不要传递密码的方法，我们只需要在这里的电子邮件。还要从 firebase.js 导入 auth const，以便将其传递给 sendPasswordResetEmail。</p><figure class="lo lp lq lr gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mk"><img src="../Images/b772e11c39ccab33a7500b0f8dbc4142.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T13oiHQ5rohzleJOXzX5eQ.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">resetPassword.js</figcaption></figure><figure class="lo lp lq lr gt jo gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/25726130122f509f0fe387cc61e682f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/format:webp/1*gf4btVb0TX7U4n3pCLsF7w.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">resetPassword.js</figcaption></figure><p id="b26f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在，您可以测试您的应用程序，看看它是否正常工作。注册，注销，再次登录，注销，并尝试重置您的密码。将向电子邮件发送一个链接以重置密码，之后您可以使用新密码登录。</p><p id="a557" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">本教程是为了解 next.js 和 firebase 的人量身定制的。我省略了一些部分来缩短文章，但最终这并不妨碍教程的主要目的。您可以在自己的产品中添加更多功能。比如错误处理等等。</p><p id="387a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">请跟我来，感谢阅读。</p></div></div>    
</body>
</html>