<html>
<head>
<title>Cancel an API request in JavaScript. AbortController in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 JavaScript 中取消 API 请求。JavaScript 中的 AbortController</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/optimize-your-api-by-canceling-it-abortcontroller-in-javascript-d9a5428988b8?source=collection_archive---------14-----------------------#2022-08-25">https://blog.devgenius.io/optimize-your-api-by-canceling-it-abortcontroller-in-javascript-d9a5428988b8?source=collection_archive---------14-----------------------#2022-08-25</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/7a1c5bf4cdaacb7590196eaabcf62313.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qIQz-ogB770Y7ol1ys-t0w.png"/></div></div></figure><p id="e11e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在这篇博客中，我们将学习 JavaScript 中的 AbortController，看看如何优化我们的 API 调用。我们将看到<strong class="jx io">什么是 AbortController？</strong>和<strong class="jx io">如何优化 API 请求</strong>。所以，我们马上开始吧。</p><p id="d60e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">假设您的网站导航栏列出了不同类别的产品，用户单击某个产品，从而调用 API 来获取该产品的详细信息，但与此同时，用户改变了主意，想要查看另一个产品并单击它。现在，网站正在对服务器进行另一个 API 调用。这里，我们想取消用户发出的第一个 API 调用，因为现在我们不再需要第一个产品细节。</p><h2 id="4894" class="kt ku in bd kv kw kx dn ky kz la dp lb kg lc ld le kk lf lg lh ko li lj lk ll bi translated">如何取消 API 请求？</h2><p id="76b8" class="pw-post-body-paragraph jv jw in jx b jy lm ka kb kc ln ke kf kg lo ki kj kk lp km kn ko lq kq kr ks ig bi translated">在 JavaScript 中，我们可以使用 AbortController 取消一个 API 请求</p><h2 id="153f" class="kt ku in bd kv kw kx dn ky kz la dp lb kg lc ld le kk lf lg lh ko li lj lk ll bi translated"><strong class="ak">什么是堕胎控制器？</strong></h2><p id="92d1" class="pw-post-body-paragraph jv jw in jx b jy lm ka kb kc ln ke kf kg lo ki kj kk lp km kn ko lq kq kr ks ig bi translated">AbortController 是一个构造函数，它在初始化时给你一个控制器对象，使用控制器对象，你可以在需要时取消/中止一个或多个 API 调用。</p><pre class="lr ls lt lu gt lv lw lx bn ly lz bi"><span id="ea9a" class="ma ku in lw b be mb mc l md me">let controller = new AbortController();</span></pre><h2 id="74a6" class="kt ku in bd kv kw kx dn ky kz la dp lb kg lc ld le kk lf lg lh ko li lj lk ll bi translated">将控制器信号插入提取请求</h2><p id="cf74" class="pw-post-body-paragraph jv jw in jx b jy lm ka kb kc ln ke kf kg lo ki kj kk lp km kn ko lq kq kr ks ig bi translated">就像我们将头和内容类型传递给 API 请求一样。我们还需要向我们发出的 API 请求添加一个控制器信号。</p><pre class="lr ls lt lu gt lv lw lx bn ly lz bi"><span id="9854" class="ma ku in lw b be mb mc l md me">let controller;<br/>const getData = async function() {<br/>  controller = new AbortController();<br/>  const response = await fetch("https://jsonplaceholder.typicode.com/posts", <br/>  {<br/>     signal: controller.signal<br/>  });<br/>  const result = await response.json();<br/>}</span></pre><h2 id="4dd9" class="kt ku in bd kv kw kx dn ky kz la dp lb kg lc ld le kk lf lg lh ko li lj lk ll bi translated">中止 API 请求</h2><p id="8e12" class="pw-post-body-paragraph jv jw in jx b jy lm ka kb kc ln ke kf kg lo ki kj kk lp km kn ko lq kq kr ks ig bi translated">现在，基于我们选择的场景，我们可以使用<strong class="jx io"> controller.abort() </strong>取消 API 调用</p><p id="1977" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">假设我们想在用户点击 cancel 按钮时取消我们的请求。现在，我们可以监听用户发出的点击事件，并基于它取消我们发出的请求。</p><pre class="lr ls lt lu gt lv lw lx bn ly lz bi"><span id="b4bd" class="ma ku in lw b be mb mc l md me">&lt;div&gt;<br/>  &lt;button class="cancel"&gt;Cancel&lt;/button&gt;<br/>&lt;/div&gt;</span></pre><pre class="mf lv lw lx bn ly lz bi"><span id="e304" class="ma ku in lw b be mb mc l md me">const cancelBtn = document.querySelector(".cancel"); <br/>cancelBtn.addEventListener("click", () =&gt; { <br/>  controller.abort(); <br/>});</span></pre><p id="260b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">感谢您阅读至此。我希望现在您已经理解了如何取消 API 请求。</strong></p><h2 id="a33a" class="kt ku in bd kv kw kx dn ky kz la dp lb kg lc ld le kk lf lg lh ko li lj lk ll bi translated">如果你想要更多这样的内容，请在<a class="ae mg" href="https://rajeshi.medium.com" rel="noopener">媒体</a>上关注我，并订阅我的<a class="ae mg" href="https://www.youtube.com/channel/UCgfW-cxlW7NlpbOscKJYkfA" rel="noopener ugc nofollow" target="_blank"> YouTube </a>频道</h2><h1 id="9b0c" class="mh ku in bd kv mi mj mk ky ml mm mn lb mo mp mq le mr ms mt lh mu mv mw lk mx bi translated">你也可以在推特上找到我</h1></div></div>    
</body>
</html>