<html>
<head>
<title>Disaster Recovery on AWS Cloud — Building Blocks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS 云上的灾难恢复—构造块</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/disaster-recovery-on-aws-cloud-building-blocks-e013bffd6244?source=collection_archive---------8-----------------------#2022-02-28">https://blog.devgenius.io/disaster-recovery-on-aws-cloud-building-blocks-e013bffd6244?source=collection_archive---------8-----------------------#2022-02-28</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="2f72" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这篇博客是我们从零开始讨论<strong class="jm io">云</strong>概念的系列文章的一部分，面向的是入门知识有限的读者。本文属于<em class="ki">中级</em>系列，因为它涉及在 AWS 云上构建<strong class="jm io">高可用性和灾难恢复</strong>构建块。</p><p id="81e6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">云系列中的一些早期博客如下。</p><p id="74ea" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae kj" rel="noopener ugc nofollow" target="_blank" href="/gcp-big-query-writing-my-first-python-connector-1140b022b88a"> <strong class="jm io"> GCP 大查询第一 Python 连接器</strong></a><strong class="jm io"><br/></strong><a class="ae kj" rel="noopener ugc nofollow" target="_blank" href="/navigating-azure-storage-authentication-options-using-a-java-client-d8ab31e12308"><strong class="jm io">Azure 存储认证</strong></a><strong class="jm io"><br/></strong><a class="ae kj" rel="noopener ugc nofollow" target="_blank" href="/azure-cosmos-db-rbac-authentication-using-a-java-client-720b20c637fe"><strong class="jm io">Azure Cosmos RBAC 认证</strong> </a></p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi kk"><img src="../Images/e48fa86bc849b7f3831f4a10ee23fa8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iFID-4jNj6Zoi5u5Uq2qXQ.png"/></div></div></figure><h1 id="7118" class="kw kx in bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">高可用性和灾难恢复。</h1><p id="7497" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv lw jx jy jz lx kb kc kd ly kf kg kh ig bi translated">构建具有正确正常运行时间 SLA 的分布式系统的关键原则之一是拥有一个健壮的高可用性和灾难恢复计划。</p><p id="58dd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">高可用性</strong>通过在称为<a class="ae kj" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-regions-availability-zones.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io">可用性区域的冗余区域内部署块中托管基础架构组件的多个副本来消除单点故障。</strong> </a></p><p id="8bda" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">灾难恢复通过在两个区域复制整个部署拓扑来消除完全区域性故障的停机时间，以确保满足正确的 SLA<strong class="jm io">RPO(恢复点目标)</strong>和<strong class="jm io"> RTO(恢复时间目标)</strong>。基于上述部署，拓扑可分为以下几类</p><ul class=""><li id="eed5" class="lz ma in jm b jn jo jr js jv mb jz mc kd md kh me mf mg mh bi translated"><strong class="jm io">主动部署— </strong>零停机时间但有数据丢失风险的系统。<strong class="jm io"> <em class="ki"> Ex 电子商务门户网站。</em>T41】</strong></li><li id="aac3" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><strong class="jm io">主动被动部署— </strong>系统不会丢失数据，但在发生区域性灾难时会影响可用性。<strong class="jm io"> <em class="ki"> Ex 银行系统。</em>T47】</strong></li></ul><h1 id="ff3a" class="kw kx in bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">三层应用程序</h1><p id="ebe9" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv lw jx jy jz lx kb kc kd ly kf kg kh ig bi translated">出于本博客的目的，我们将总体技术讨论限制在三层主动-被动系统</p><ul class=""><li id="a26e" class="lz ma in jm b jn jo jr js jv mb jz mc kd md kh me mf mg mh bi translated"><strong class="jm io">前端层— </strong>具有 UI 资产(<strong class="jm io"> <em class="ki">静态和非静态</em> </strong>)，该层服务于客户交互所需的业务流程页面</li><li id="0657" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><strong class="jm io">后端层— </strong>无状态微服务受到关注点分离的阻碍<em class="ki"> ( </em> <strong class="jm io"> <em class="ki">)读取与写入功能</em> </strong> <em class="ki"> ) </em>，这一层充当业务流背后核心逻辑的主干。</li><li id="17a3" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><strong class="jm io">数据库层— </strong>该层充当所有静态数据(关系型与非关系型)的主干，由后端层通过<strong class="jm io"> <em class="ki">模型和视图进行访问。</em>T15】</strong></li></ul><h1 id="125d" class="kw kx in bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">多区域部署拓扑</h1><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi mn"><img src="../Images/f83dbd2e2f0ad72f4a9f93766c9e1023.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zpmD8100Dw_uz7RiJKV3kA.png"/></div></div></figure><p id="1f5a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">详细查看—</strong><a class="ae kj" href="https://github.com/amit894/diagrams/blob/main/AWS%20Deployment%20Topology/3%20Tier.png" rel="noopener ugc nofollow" target="_blank">https://github . com/Amit 894/diagrams/blob/main/AWS % 20 deployment % 20 topology/3% 20 tier . png</a></p><h1 id="2a26" class="kw kx in bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">AWS 服务</h1><ul class=""><li id="45b5" class="lz ma in jm b jn lu jr lv jv mo jz mp kd mq kh me mf mg mh bi translated"><a class="ae kj" href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/introduction.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io">应用负载均衡器</strong></a><strong class="jm io">—</strong>L7 负载均衡器，可用于配置 HTTP 规则，如<strong class="jm io"> <em class="ki"> url 重定向、请求头修改等</em> </strong></li><li id="510d" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><a class="ae kj" href="https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/introduction.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io">经典负载均衡器</strong></a><strong class="jm io">—</strong>L4 负载均衡器，工作在 TCP 层，用于设置端口转发和其他基本网络规则。</li><li id="5812" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><a class="ae kj" href="https://aws.amazon.com/ec2/" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> EC2 实例</strong> </a> <strong class="jm io"> — </strong>计算实例，用于在 UI 和后端微服务层部署。</li><li id="7e20" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><a class="ae kj" href="https://docs.aws.amazon.com/documentdb/latest/developerguide/what-is.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io">亚马逊文档 DB (Mongo) </strong> </a> <strong class="jm io"> — </strong>一个 NoSQL 数据库，用于以键值对的方式存储非关系数据。</li><li id="372e" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><a class="ae kj" href="https://aws.amazon.com/rds/postgresql/" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io">【亚马逊 RDS(postgres)</strong></a><strong class="jm io">—</strong>一个 SQL 数据库，用于存储关系数据，可以通过视图和表进行查询</li><li id="d347" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><a class="ae kj" href="https://aws.amazon.com/cloudwatch/" rel="noopener ugc nofollow" target="_blank"><strong class="jm io">AWS cloud watch</strong></a><strong class="jm io">—</strong>一种事件驱动的 AWS 服务，用于监控在整个 AWS 帐户中运行的所有 AWS 组件的健康状况。</li><li id="7a8e" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><a class="ae kj" href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-user-guide.html" rel="noopener ugc nofollow" target="_blank"><strong class="jm io">AWS cloud Trail</strong></a><strong class="jm io">—</strong>AWS 帐户中所有审计和运营事件的跟踪，用于构建生产可见性所需的警报。</li><li id="81d2" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><a class="ae kj" href="https://docs.aws.amazon.com/vpc/latest/userguide/what-is-amazon-vpc.html" rel="noopener ugc nofollow" target="_blank"><strong class="jm io">AWS VPC</strong></a><strong class="jm io">—</strong>公有云中的私有地址空间，使用可配置的<a class="ae kj" href="https://en.wikipedia.org/wiki/IP_address" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> IP 空间托管所有 AWS 服务。</strong> </a></li></ul><h1 id="1317" class="kw kx in bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">VPC 设置</h1><p id="fd50" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv lw jx jy jz lx kb kc kd ly kf kg kh ig bi translated">3 个可用性区域中的 9 个子网</p><h2 id="88fa" class="mr kx in bd ky ms mt dn lc mu mv dp lg jv mw mx lk jz my mz lo kd na nb ls nc bi translated">公共子网</h2><ul class=""><li id="2680" class="lz ma in jm b jn lu jr lv jv mo jz mp kd mq kh me mf mg mh bi translated"><code class="fe nd ne nf ng b">Components</code>:应用负载均衡器和 NAT 网关</li><li id="218c" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><code class="fe nd ne nf ng b">Routing</code>:VPC 内部通过路由表和互联网网关进行公共流量传输</li></ul><h2 id="bd48" class="mr kx in bd ky ms mt dn lc mu mv dp lg jv mw mx lk jz my mz lo kd na nb ls nc bi translated">应用子网</h2><ul class=""><li id="a193" class="lz ma in jm b jn lu jr lv jv mo jz mp kd mq kh me mf mg mh bi translated"><code class="fe nd ne nf ng b">Components</code>:经典负载平衡器和虚拟机。</li><li id="3e17" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><code class="fe nd ne nf ng b">Routing</code>:VPC 内部直通路由表。</li></ul><h2 id="1726" class="mr kx in bd ky ms mt dn lc mu mv dp lg jv mw mx lk jz my mz lo kd na nb ls nc bi translated">数据库子网</h2><ul class=""><li id="cff7" class="lz ma in jm b jn lu jr lv jv mo jz mp kd mq kh me mf mg mh bi translated"><code class="fe nd ne nf ng b">Components</code>:自动气象站文件数据库和自动气象站 RDS。</li><li id="a571" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><code class="fe nd ne nf ng b">Routing</code>:VPC 内部直通路由表。</li></ul><h1 id="5ceb" class="kw kx in bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">网络设置</h1><h2 id="4354" class="mr kx in bd ky ms mt dn lc mu mv dp lg jv mw mx lk jz my mz lo kd na nb ls nc bi translated">应用程序负载平衡器(L7)</h2><ul class=""><li id="4d3e" class="lz ma in jm b jn lu jr lv jv mo jz mp kd mq kh me mf mg mh bi translated"><code class="fe nd ne nf ng b">Security Group</code>:允许来自互联网的流量通过端口 443。</li><li id="0556" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><code class="fe nd ne nf ng b">Communication Protocol</code> : HTTPS</li><li id="3ba6" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><code class="fe nd ne nf ng b">SSL</code>:强制</li></ul><h2 id="c25c" class="mr kx in bd ky ms mt dn lc mu mv dp lg jv mw mx lk jz my mz lo kd na nb ls nc bi translated">前端虚拟机</h2><ul class=""><li id="a10f" class="lz ma in jm b jn lu jr lv jv mo jz mp kd mq kh me mf mg mh bi translated"><code class="fe nd ne nf ng b">Security Groups:</code>允许来自<strong class="jm io">端口 443 上的应用负载平衡器的流量。</strong></li><li id="9428" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><code class="fe nd ne nf ng b">Communication Protocol</code> : HTTPS</li><li id="e224" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><code class="fe nd ne nf ng b">SSL</code>:强制</li></ul><h2 id="32e7" class="mr kx in bd ky ms mt dn lc mu mv dp lg jv mw mx lk jz my mz lo kd na nb ls nc bi translated">内部负载平衡器(L4)</h2><ul class=""><li id="2cd7" class="lz ma in jm b jn lu jr lv jv mo jz mp kd mq kh me mf mg mh bi translated"><code class="fe nd ne nf ng b">Security Groups:</code>允许来自前端虚拟机的流量通过<strong class="jm io">端口 443。</strong></li><li id="a89f" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><code class="fe nd ne nf ng b">Communication Protocol</code> : HTTPS</li><li id="44d8" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><code class="fe nd ne nf ng b">SSL</code>:强制</li></ul><h2 id="65b1" class="mr kx in bd ky ms mt dn lc mu mv dp lg jv mw mx lk jz my mz lo kd na nb ls nc bi translated">后端虚拟机</h2><ul class=""><li id="8f67" class="lz ma in jm b jn lu jr lv jv mo jz mp kd mq kh me mf mg mh bi translated"><code class="fe nd ne nf ng b">Security Groups:</code>允许来自<strong class="jm io">端口 80 上的内部负载平衡器的流量。</strong></li><li id="2d3d" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><code class="fe nd ne nf ng b">Communication Protocol</code> : HTTPS</li><li id="b269" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><code class="fe nd ne nf ng b">SSL</code>:强制</li></ul><h2 id="93d5" class="mr kx in bd ky ms mt dn lc mu mv dp lg jv mw mx lk jz my mz lo kd na nb ls nc bi translated">亚马逊文档数据库(MangoDB)</h2><ul class=""><li id="9e38" class="lz ma in jm b jn lu jr lv jv mo jz mp kd mq kh me mf mg mh bi translated"><code class="fe nd ne nf ng b">Security Groups:</code>允许来自后端虚拟机的流量通过<strong class="jm io">端口 27017。</strong></li><li id="4b45" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><code class="fe nd ne nf ng b">Communication Protocol</code> : TCP</li><li id="f1f4" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><code class="fe nd ne nf ng b">SSL</code>:首选</li></ul><h2 id="9930" class="mr kx in bd ky ms mt dn lc mu mv dp lg jv mw mx lk jz my mz lo kd na nb ls nc bi translated">亚马逊 RDS(邮政)</h2><ul class=""><li id="4e25" class="lz ma in jm b jn lu jr lv jv mo jz mp kd mq kh me mf mg mh bi translated"><code class="fe nd ne nf ng b">Security Groups:</code>允许来自后端虚拟机的流量通过<strong class="jm io">端口 5432。</strong></li><li id="77e7" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><code class="fe nd ne nf ng b">Communication Protocol</code> : TCP</li><li id="0b22" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><code class="fe nd ne nf ng b">SSL</code>:首选</li></ul><h1 id="1db7" class="kw kx in bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">结论</h1><p id="ed6f" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv lw jx jy jz lx kb kc kd ly kf kg kh ig bi translated">给定的文档仅概述了在 AWS 云中的两个区域实现全功能主动-被动部署。为了进一步理解其中的复杂性，我们将进一步深入探讨未来的博客主题。</p><p id="512c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="ki">如需反馈，请留言至</em><strong class="jm io"><em class="ki">Amit[dot]894[at]Gmail[dot]com</em></strong><em class="ki">或联系</em><a class="ae kj" href="https://about.me/amit_raj" rel="noopener ugc nofollow" target="_blank"><em class="ki">https://about.me/amit_raj</em></a><em class="ki">的任何链接。</em></p></div></div>    
</body>
</html>