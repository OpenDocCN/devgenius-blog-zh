<html>
<head>
<title>Session-Based Authentication in a Nutshell</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">简而言之，基于会话的认证</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/user-authentication-in-a-nutshell-ecf0d9dee2b3?source=collection_archive---------5-----------------------#2022-06-19">https://blog.devgenius.io/user-authentication-in-a-nutshell-ecf0d9dee2b3?source=collection_archive---------5-----------------------#2022-06-19</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="c34f" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">查看我在<a class="ae kc" href="https://yumingchang1991.medium.com/technical-article-structure-on-medium-954850e1ef4d" rel="noopener">我的技术文章</a>中的所有其他帖子</h2></div><p id="9288" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">对于初学者来说，认证可能是最难攻克的话题之一。写这篇文章是为了让你对用户认证有一个更全面的了解，这样你，作为一个初学者，就不会像我一样感到迷茫。</p><p id="27fe" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">下面提到的基于会话的认证是跨不同语言通用的。</p></div><div class="ab cl kz la hr lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="ig ih ii ij ik"><h1 id="de1f" class="lg lh in bd li lj lk ll lm ln lo lp lq jt lr ju ls jw lt jx lu jz lv ka lw lx bi translated">涵盖的主题</h1><ol class=""><li id="b52a" class="ly lz in kf b kg ma kj mb km mc kq md ku me ky mf mg mh mi bi translated">为什么用户认证对初学者来说势不可挡</li><li id="97d8" class="ly lz in kf b kg mj kj mk km ml kq mm ku mn ky mf mg mh mi bi translated">在处理身份认证之前，有哪些先决条件</li><li id="cf0b" class="ly lz in kf b kg mj kj mk km ml kq mm ku mn ky mf mg mh mi bi translated">认证简介</li><li id="9079" class="ly lz in kf b kg mj kj mk km ml kq mm ku mn ky mf mg mh mi bi translated">不同类型的认证</li><li id="9865" class="ly lz in kf b kg mj kj mk km ml kq mm ku mn ky mf mg mh mi bi translated">基于会话的认证过程</li><li id="164d" class="ly lz in kf b kg mj kj mk km ml kq mm ku mn ky mf mg mh mi bi translated">结束前注意</li><li id="a575" class="ly lz in kf b kg mj kj mk km ml kq mm ku mn ky mf mg mh mi bi translated">参考</li></ol></div><div class="ab cl kz la hr lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="ig ih ii ij ik"><h1 id="5d8a" class="lg lh in bd li lj lk ll lm ln lo lp lq jt lr ju ls jw lt jx lu jz lv ka lw lx bi translated">为什么用户认证势不可挡</h1><p id="3f9e" class="pw-post-body-paragraph kd ke in kf b kg ma jo ki kj mb jr kl km mo ko kp kq mp ks kt ku mq kw kx ky ig bi translated">几周前，我在自由代码营学习认证时感到不知所措。我按照他们的指示输入了很多我不知道的代码。</p><p id="7b27" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">出现了许多新术语，例如，会话、会话存储、快速会话、通行证、策略、序列化和反序列化等。</p><p id="8c39" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">然后学习材料继续重构代码，这使得情况更加模糊。我对代码已经没有任何线索，现在它被抽象了。</p><p id="89cc" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">我感到力不从心，因为我对身份验证没有一个整体的看法，相反，我被太多的实现细节塞满了。</p><p id="fbb1" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">我需要夺回控制权。我错过了什么？</p><h1 id="668f" class="lg lh in bd li lj mr ll lm ln ms lp lq jt mt ju ls jw mu jx lu jz mv ka lw lx bi translated">先决条件</h1><p id="459d" class="pw-post-body-paragraph kd ke in kf b kg ma jo ki kj mb jr kl km mo ko kp kq mp ks kt ku mq kw kx ky ig bi translated">原来基本面还挺多的。一口气看完它们是不可能的，至少对我来说是不可能的。我花了一个月的时间才最终掌握了认证流程。</p><p id="3222" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">这些先决条件相当多，所以我不会在这篇文章中详细讨论它们。相反，我会列出在着手下一个概念之前你应该掌握的概念，并提供一些参考。</p><ol class=""><li id="36b1" class="ly lz in kf b kg kh kj kk km mw kq mx ku my ky mf mg mh mi bi translated"><strong class="kf io">什么是 Express 框架中的中间件？它做什么，如何实现？</strong> <br/>这里是我的帖子<a class="ae kc" href="https://yumingchang1991.medium.com/express-middleware-explained-in-one-minute-671af8d5a3b9" rel="noopener"> <em class="mz">一分钟讲解中间件</em> </a>。它会给你一个清晰的感觉。之后，你就可以在<a class="ae kc" href="http://expressjs.com/en/guide/writing-middleware.html" rel="noopener ugc nofollow" target="_blank"> <em class="mz">编写中间件</em> </a>，使用中间件<a class="ae kc" href="http://expressjs.com/en/guide/using-middleware.html" rel="noopener ugc nofollow" target="_blank"><em class="mz">阅读快递公文了。</em></a></li><li id="d75f" class="ly lz in kf b kg mj kj mk km ml kq mm ku mn ky mf mg mh mi bi translated">什么是会话、快速会话和会话存储？ <br/>我发现扎克和自由代码营的这个<a class="ae kc" href="https://youtu.be/F-sFp_AvHc8?t=3905" rel="noopener ugc nofollow" target="_blank"> <em class="mz"> YouTube 视频</em> </a>极有帮助。观看他介绍快速会话的部分。让我给你一个提示。Session、express-session 和 session store:其中之一不是一个概念，而只是一个实现这个概念的库。</li><li id="af59" class="ly lz in kf b kg mj kj mk km ml kq mm ku mn ky mf mg mh mi bi translated"><strong class="kf io">什么是 cookie？cookie 和 session 是什么关系？</strong> <br/>这里是我的帖子地址<a class="ae kc" rel="noopener ugc nofollow" target="_blank" href="/cache-cookies-and-web-storage-in-a-nutshell-11f9dc02bacc"> <em class="mz">缓存，cookie 和 Web 存储</em> </a>在客户端。你可以只看介绍饼干的部分，跳过其余部分。之后，做一些谷歌搜索，找出 cookie 和会话之间的关系。</li><li id="f476" class="ly lz in kf b kg mj kj mk km ml kq mm ku mn ky mf mg mh mi bi translated">(可选，但大多数时候你会用到)<strong class="kf io">如何使用 Mongoose 操作 MongoDB 或 MongoDB Atlas？</strong> <br/>这里是我的帖子<a class="ae kc" rel="noopener ugc nofollow" target="_blank" href="/mongodb-mongoose-all-you-need-to-know-as-a-beginner-3eb3bf6979f2"> <em class="mz">介绍 MongoDB 图集和 mongose</em></a>。</li></ol><p id="70d4" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">在继续阅读之前，请确保您确实理解了上述先决条件。</p></div><div class="ab cl kz la hr lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="ig ih ii ij ik"><h1 id="1c29" class="lg lh in bd li lj lk ll lm ln lo lp lq jt lr ju ls jw lt jx lu jz lv ka lw lx bi translated">认证简介</h1><p id="6958" class="pw-post-body-paragraph kd ke in kf b kg ma jo ki kj mb jr kl km mo ko kp kq mp ks kt ku mq kw kx ky ig bi translated">认证是确定某人是否是他们所声明的那个人的过程。事实上，这在我们的生活中很常见。</p><p id="468d" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">例如，当我们去另一个国家旅行时，我们需要向当地海关官员提供我们的护照。护照是我身份的证明。换句话说，我用护照告诉海关官员我是来自台湾的张玉明。</p><p id="6cd7" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">当涉及到互联网时，客户端设备发送带有证书的 HTTP 请求以证明他们是谁。该证书不是由客户端本身提供，而是由服务器提供。这就像我们不打印自己的护照，而是从外交部申请。</p><p id="1bf9" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">大多数情况下，客户端设备向服务器提供登录凭证，以交换在接下来的 24 小时内有效的证书。证书的有效期由服务提供商或美国开发商决定。</p><h1 id="2731" class="lg lh in bd li lj mr ll lm ln ms lp lq jt mt ju ls jw mu jx lu jz mv ka lw lx bi translated">不同类型的认证</h1><p id="760d" class="pw-post-body-paragraph kd ke in kf b kg ma jo ki kj mb jr kl km mo ko kp kq mp ks kt ku mq kw kx ky ig bi translated">虽然我们可以用护照来证明我们是谁，但我们只在旅行时才使用护照。在其他情况下，passport 可能一点用都没有。</p><p id="c60d" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">例如，我们可能需要拿出我们的贵宾卡，这样酒店的服务员，或者 Arc'teryx 的销售助理就知道我们是谁了。然而，在这种情况下，护照不会为我们提供任何特别的优惠。</p><p id="8ea4" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">正如我们可以使用护照或贵宾卡来证明我们是谁，在不同的情况下，也有不同的方法来实现网络认证:</p><ul class=""><li id="ab36" class="ly lz in kf b kg kh kj kk km mw kq mx ku my ky na mg mh mi bi translated"><strong class="kf io">基于会话的认证</strong>常用于客户端与服务器之间的通信</li><li id="faf5" class="ly lz in kf b kg mj kj mk km ml kq mm ku mn ky na mg mh mi bi translated">而<strong class="kf io">基于令牌的认证</strong>通常用于服务器到服务器的通信</li></ul><p id="95cb" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">让我们更深入地研究一下基于会话的身份验证。</p></div><div class="ab cl kz la hr lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="ig ih ii ij ik"><h1 id="5066" class="lg lh in bd li lj lk ll lm ln lo lp lq jt lr ju ls jw lt jx lu jz lv ka lw lx bi translated">基于会话的认证过程</h1><figure class="nc nd ne nf gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nb"><img src="../Images/a0f40aa5d46adc6e3d0a394075d7afa1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qUpUgyeC2j1PpCkadEpQDg.jpeg"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">此流程图描述了一个简单的基于会话的身份验证过程</figcaption></figure><p id="d91a" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">上面流程图描述了认证的一般过程。你可能想<a class="ae kc" href="https://drive.google.com/file/d/1ZRnk1eNVCZkHELfC_oGph7e8PNP-qjpU/view?usp=sharing" rel="noopener ugc nofollow" target="_blank">使用这个链接</a>在 Google drive 上查看更好的分辨率。</p><h2 id="0b9d" class="nr lh in bd li ns nt dn lm nu nv dp lq km nw nx ls kq ny nz lu ku oa ob lw oc bi translated">当客户端没有证书时</h2><ul class=""><li id="d6d0" class="ly lz in kf b kg ma kj mb km mc kq md ku me ky na mg mh mi bi translated">用户输入登录凭证并提交</li><li id="8d51" class="ly lz in kf b kg mj kj mk km ml kq mm ku mn ky na mg mh mi bi translated">客户端发送带有登录凭据的请求</li><li id="9f84" class="ly lz in kf b kg mj kj mk km ml kq mm ku mn ky na mg mh mi bi translated">服务器接收请求并检查登录凭证是否有效</li><li id="1b7e" class="ly lz in kf b kg mj kj mk km ml kq mm ku mn ky na mg mh mi bi translated">如果有效，服务器创建一个会话并将该会话 id 附加到响应(会话 ID 是证书)</li><li id="3bea" class="ly lz in kf b kg mj kj mk km ml kq mm ku mn ky na mg mh mi bi translated">客户端接收服务器响应并将会话 ID 存储为 cookies</li></ul><h2 id="9f16" class="nr lh in bd li ns nt dn lm nu nv dp lq km nw nx ls kq ny nz lu ku oa ob lw oc bi translated">一旦客户端收到证书</h2><ul class=""><li id="1791" class="ly lz in kf b kg ma kj mb km mc kq md ku me ky na mg mh mi bi translated">由于客户端将证书存储为 cookie，并且 cookie 总是随请求一起发送，因此来自该客户端的所有后续请求都将携带此证书</li><li id="f0e0" class="ly lz in kf b kg mj kj mk km ml kq mm ku mn ky na mg mh mi bi translated">当服务器收到带有证书的请求时，它通过查询会话数据来检查该证书是否有效</li><li id="3a08" class="ly lz in kf b kg mj kj mk km ml kq mm ku mn ky na mg mh mi bi translated">如果证书有效，那么服务器返回请求所要求的内容</li></ul><h2 id="e9da" class="nr lh in bd li ns nt dn lm nu nv dp lq km nw nx ls kq ny nz lu ku oa ob lw oc bi translated">客户端还可以通过注销在证书到期前主动删除证书</h2><ul class=""><li id="7709" class="ly lz in kf b kg ma kj mb km mc kq md ku me ky na mg mh mi bi translated">当服务器收到注销证书的请求时，它只是查找相关的会话数据并删除它</li></ul></div><div class="ab cl kz la hr lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="ig ih ii ij ik"><h1 id="0c65" class="lg lh in bd li lj lk ll lm ln lo lp lq jt lr ju ls jw lt jx lu jz lv ka lw lx bi translated">结束前注意</h1><p id="4c9d" class="pw-post-body-paragraph kd ke in kf b kg ma jo ki kj mb jr kl km mo ko kp kq mp ks kt ku mq kw kx ky ig bi translated">当我理解认证过程的整体观点时，使用 Passport.js 的逻辑对我来说很有意义。</p><p id="48e4" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">如果这篇文章有助于您实现基于会话的身份验证，请鼓掌与我分享您的激动之情！</p></div><div class="ab cl kz la hr lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="ig ih ii ij ik"><h1 id="0196" class="lg lh in bd li lj lk ll lm ln lo lp lq jt lr ju ls jw lt jx lu jz lv ka lw lx bi translated">参考</h1><ul class=""><li id="7583" class="ly lz in kf b kg ma kj mb km mc kq md ku me ky na mg mh mi bi translated"><strong class="kf io">文章</strong> : <a class="ae kc" href="https://www.geeksforgeeks.org/session-vs-token-based-authentication/" rel="noopener ugc nofollow" target="_blank"> <em class="mz">会话 vs 基于令牌的认证</em> </a>由极客为极客</li></ul></div></div>    
</body>
</html>