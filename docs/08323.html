<html>
<head>
<title>Feature Toggle using Unleash</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用释放功能切换</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/feature-toggle-using-unleash-d19d17d0366d?source=collection_archive---------10-----------------------#2022-06-05">https://blog.devgenius.io/feature-toggle-using-unleash-d19d17d0366d?source=collection_archive---------10-----------------------#2022-06-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/27a8e6112498f6f1481570572765f1fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*GDQnf0CgffQPJ1y60J3WYA.gif"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">功能切换</figcaption></figure><blockquote class="jy jz ka"><p id="6d71" class="kb kc kd ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在本帖中，我们将介绍一个简单的功能切换用例，以及 Unleash 如何使用客户端和由 Unleash 提供的 Java SDK 来帮助实现这一功能。</p></blockquote><p id="f0dd" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">让我们从什么是特性切换以及它将如何有所帮助这个基本问题开始。</p></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><p id="aa07" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated"><strong class="ke ir">什么是功能切换？</strong></p><p id="35ae" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">特性切换只是一种简单的开关机制，无需部署即可打开或关闭一段代码。实际上，切换逻辑由 IF ELSE 条件语句包装</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="cb67" class="lt lu iq lp b gy lv lw l lx ly">// Toggle here is the service which is providing feature toggle server implementation  </span><span id="cd27" class="lt lu iq lp b gy lz lw l lx ly">if(toggle.isEnabled()){  <br/>// Perform normal Logic <br/>}<br/>else<br/>{  <br/>// Perform special logic <br/>}</span></pre></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><p id="a66c" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated"><strong class="ke ir">如何切换会有帮助？</strong></p><p id="3ddd" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">正如您可能想象的那样，出于多种原因，在许多过程中，切换都是有用的。他们中很少有人是</p><ul class=""><li id="031b" class="ma mb iq ke b kf kg kj kk la mc lb md lc me kz mf mg mh mi bi translated">展示功能—帮助向特定用户组和特定应用程序灵活发布功能，以降低相关风险(错误代码)</li><li id="3f53" class="ma mb iq ke b kf mj kj mk la ml lb mm lc mn kz mf mg mh mi bi translated">canary Release——这是向相对较小的用户群发布功能的方法之一，用于测试软件是否满足期望的标准，而不会影响整个用户群。</li><li id="0e21" class="ma mb iq ke b kf mj kj mk la ml lb mm lc mn kz mf mg mh mi bi translated">基于主干的开发——这是一种开发策略，它有助于频繁合并小的变更，并确保保持功能分支是短暂的，功能切换可以在这里结合，以减少变更被合并到主分支的风险</li></ul><p id="6a32" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">如果在测试过程中发现任何问题，可以通过关闭开关(可能通过 UI)来简单地关闭新特性逻辑，而不需要部署。</p></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><p id="f538" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated"><strong class="ke ir">什么是松绑？</strong></p><p id="2e55" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated"><a class="ae mo" href="https://www.getunleash.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ke ir"> Unleash </strong> </a>是一个开源的特性切换管理解决方案，提供了多种创建和管理切换的方法，可以通过 Unleash UI 进行管理。Unleash 为许多关键语言(Java、Go、NodeJS、Python 等)提供服务器端 SDK，以及需要通过<a class="ae mo" href="https://docs.getunleash.io/sdks/unleash-proxy" rel="noopener ugc nofollow" target="_blank"> Unleash Proxy </a>进行交互的前端 SDK(Android、IOS、Javascript、React)</p><p id="4cec" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">Unleash 有免费和付费两个版本(专业版和企业版)，免费版本的 Unleash 对于大多数用例来说已经足够全面，<a class="ae mo" href="https://www.getunleash.io/plans#compare" rel="noopener ugc nofollow" target="_blank">这里</a>是来自 Unleash docs 关于不同版本的详细对比。</p></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><p id="d972" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated"><strong class="ke ir">释放中的策略是什么？</strong></p><p id="ab94" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">策略是一种条件，通过评估来决定切换是打开还是关闭。“释放”提供了一个内置激活策略列表，可用于决定触发条件。下面是现成可用的策略选项列表</p><ul class=""><li id="8ce1" class="ma mb iq ke b kf kg kj kk la mc lb md lc me kz mf mg mh mi bi translated">标准—默认策略，意味着要么全部打开，要么全部关闭</li><li id="44e8" class="ma mb iq ke b kf mj kj mk la ml lb mm lc mn kz mf mg mh mi bi translated">用户标识——我们可以在 Unleash UI 中定义一个用户标识列表，只有那些已定义的用户，切换才会处于打开状态，而其他用户则处于关闭状态</li><li id="6822" class="ma mb iq ke b kf mj kj mk la ml lb mm lc mn kz mf mg mh mi bi translated">IP——我们可以在 Unleash UI 中定义一个 IP 地址列表，只有那些已定义的 IP 地址的切换才会处于打开状态，而其他 IP 地址的切换会处于关闭状态</li><li id="bf85" class="ma mb iq ke b kf mj kj mk la ml lb mm lc mn kz mf mg mh mi bi translated">主机名—我们可以在 Unleash UI 中定义一个主机名列表，只有那些已定义的主机名，切换才会处于打开状态，而对于其他主机名，切换会处于关闭状态</li><li id="4f0e" class="ma mb iq ke b kf mj kj mk la ml lb mm lc mn kz mf mg mh mi bi translated">逐步推广—该策略将所有逐步推广策略合并为一个策略。我们可以在这个策略中定义粘性和展示百分比</li></ul><p id="5b16" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">由于上述策略是现成的，为了在我们的 SDK 中使用它们，我们不需要任何更改，因为 SDK 包含它们的实现。除了上述策略，我们还可以在 UI 中定义自己的定制策略，并定义其服务器端实现(我们将在另一篇博客中看到)。多个策略可以与一个功能切换相关联。我们可以定义一个策略，并在多个切换中重用相同的策略</p><p id="cd44" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">更多关于策略的信息可以在<a class="ae mo" href="https://docs.getunleash.io/user_guide/activation_strategy#gradual-rollout" rel="noopener ugc nofollow" target="_blank">这里</a>找到</p></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><p id="4de1" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated"><strong class="ke ir">如何开始使用“释放”?</strong></p><p id="1d4c" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">为了开始使用 unlease，我们需要一个 unlease 实例(您将在其中创建和维护与 toggles 相关的信息)和一个 SDK，我们可以使用它连接到该实例。</p><p id="477e" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated"><strong class="ke ir">释放实例:</strong></p><p id="6ff8" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">为了快速访问和玩，释放提供了一个演示实例，可以在<a class="ae mo" href="https://app.unleash-hosted.com/demo/" rel="noopener ugc nofollow" target="_blank">https://app.unleash-hosted.com/demo/</a>访问。您可以使用有效的电子邮件地址登录并访问此实例。</p><p id="c3df" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">或者，按照他们的官方 GitHub<a class="ae mo" href="https://github.com/Unleash/unleash-docker," rel="noopener ugc nofollow" target="_blank">https://github.com/Unleash/unleash-docker,</a>中的说明，在您当地的几秒钟内就可以完成设置。我们将需要安装以下开始使用释放实例在本地</p><ol class=""><li id="53cc" class="ma mb iq ke b kf kg kj kk la mc lb md lc me kz mp mg mh mi bi translated">创建一个 docker 网络供释放实例使用</li></ol><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="9786" class="lt lu iq lp b gy lv lw l lx ly">docker network create unleash</span></pre><p id="3f49" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">2.创建 Postgres 实例</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="a101" class="lt lu iq lp b gy lv lw l lx ly">docker run -e POSTGRES_PASSWORD=some_password \<br/>  -e POSTGRES_USER=unleash_user -e POSTGRES_DB=unleash \<br/>  --network unleash --name postgres postgres</span></pre><p id="6e9b" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">3.开始从 docker 映像释放实例</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="364f" class="lt lu iq lp b gy lv lw l lx ly">docker run -p 4242:4242 \<br/>  -e DATABASE_HOST=postgres -e DATABASE_NAME=unleash \<br/>  -e DATABASE_USERNAME=unleash_user -e DATABASE_PASSWORD=some_password \<br/>  -e DATABASE_SSL=false \<br/>  --network unleash unleashorg/unleash-server</span></pre><p id="c8e0" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">一旦 docker 实例启动并运行，可以在<a class="ae mo" href="http://localhost:4242" rel="noopener ugc nofollow" target="_blank"> http://localhost:4242 </a>访问 unleash UI</p><p id="7558" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">使用以下凭据登录</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="a583" class="lt lu iq lp b gy lv lw l lx ly"><strong class="lp ir">userName: admin</strong></span><span id="e8f4" class="lt lu iq lp b gy lz lw l lx ly"><strong class="lp ir">password: unleash4all</strong></span></pre><p id="1003" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">主页应该如下所示</p><p id="f5c1" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">导航到高级&gt; API 访问</p><figure class="lk ll lm ln gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi mq"><img src="../Images/c66b86df0fa080abaafbc097d34ee94d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SVz_ZE-cT-hZf_xg.png"/></div></div></figure><p id="7094" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">单击添加新的 API 密钥，下面的弹出窗口应该会出现。用户名将是我们将尝试从服务器连接的应用程序名称，类型为客户端(您应该为管理目的创建单独的 API 令牌),然后单击“创建新密钥”</p><figure class="lk ll lm ln gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi mv"><img src="../Images/3cfcf8976b70a03a8f9188394cb3e41d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UJKLrlRgQQbpgiyu.png"/></div></div></figure><p id="5fa3" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">一旦您创建了 API 令牌，您将看到下面的屏幕</p><figure class="lk ll lm ln gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi mw"><img src="../Images/871673e84cee8e4b91eed01c09ed87cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NEEyNfrGZOAXdfOm.png"/></div></div></figure><p id="1379" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">请记下以下值</p><p id="80aa" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated"><code class="fe mx my mz lp b">API URL: <a class="ae mo" href="http://localhost:4242/api/" rel="noopener ugc nofollow" target="_blank">http://localhost:4242/api/</a></code></p><p id="0f24" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">用户名:测试</p><p id="b63b" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">秘密:XXXX(点击上面屏幕上的揭露秘密图标)</p><p id="dda8" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">如果您使用的是由 Unleash 提供的演示 URL，您可以检索(通过导航到 Configure &gt; API access)任何现有的令牌用于测试目的。</p><p id="f3ce" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">为了测试该解决方案，我们需要创建一个测试开关，导航到屏幕顶部的功能开关。点击下面屏幕上的创建特征开关</p><figure class="lk ll lm ln gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi na"><img src="../Images/ac50283ef26df28eef1e6036b06cba95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BzRWc7fVSu2CFspi.png"/></div></div></figure><p id="9d02" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">填写切换名称和描述。请注意，您可以从可用列表中选择特征类型(它主要用于按类型分类和查看不同的切换)</p><p id="2676" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">关于功能切换类型的更多信息，请参见<code class="fe mx my mz lp b"><a class="ae mo" href="https://docs.getunleash.io/advanced/feature_toggle_types" rel="noopener ugc nofollow" target="_blank">here</a></code></p><figure class="lk ll lm ln gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi nb"><img src="../Images/72bf54923544b710a81e9dfe792e149c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WKC3D_wwgUsNjC85.png"/></div></div></figure><p id="28a5" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">点击添加策略并选择一个合适的策略，然后点击创建</p><figure class="lk ll lm ln gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi nc"><img src="../Images/1459d0458d238e2c38e754073f28668a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QKrFvlZT78MlPlAv.png"/></div></div></figure><p id="c4a5" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">成功创建切换后，可以在功能切换屏幕中查看，我们可以在其中切换切换</p><figure class="lk ll lm ln gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi nd"><img src="../Images/9e6619d8ed104d23afb57720ace56543.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Lm3b_eIqjzmYedYM.png"/></div></div></figure><p id="cbbc" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated"><strong class="ke ir">服务器端 SDK </strong></p><p id="a02e" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">Unleash 提供了许多用于服务器连接的 SDK，我们将以 Java 为例</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="669a" class="lt lu iq lp b gy lv lw l lx ly">&lt;dependency&gt;     <br/>&lt;groupId&gt;io.getunleash&lt;/groupId&gt;     <br/>&lt;artifactId&gt;unleash-client-java&lt;/artifactId&gt;     <br/>&lt;version&gt;Latest version here&lt;/version&gt; <br/>&lt;/dependency&gt;</span></pre><p id="4a58" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">为了访问释放实例，我们需要初始化一个释放配置，如下所示</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="bf94" class="lt lu iq lp b gy lv lw l lx ly">/**<br/>appName - Test in this instance<br/>instanceId -  This can be hostname<br/>endpoint - <a class="ae mo" href="http://localhost:4242/api/" rel="noopener ugc nofollow" target="_blank">http://localhost:4242/api/</a> in case if you are running Unleash in local or if you are using demo, it would be <a class="ae mo" href="https://app.unleash-hosted.com/demo/api/" rel="noopener ugc nofollow" target="_blank">https://app.unleash-hosted.com/demo/api/</a><br/>fetchTogglesInterval - Fetch interval in seconds<br/>sendMetricsInterval - Send metrics interval in seconds<br/>clientSecret - secret obtained from Unleash UI</span><span id="a114" class="lt lu iq lp b gy lz lw l lx ly">Above details can be provided in the configuration file and can be read accordingly</span><span id="22c9" class="lt lu iq lp b gy lz lw l lx ly">**/</span><span id="a6da" class="lt lu iq lp b gy lz lw l lx ly"><a class="ae mo" href="http://twitter.com/Bean" rel="noopener ugc nofollow" target="_blank">@Bean</a><br/>public UnleashConfig unleashConfig() {<br/>        return UnleashConfig.builder()<br/>                            .appName(appName)<br/>                            .instanceId(instanceId) <br/>                            .unleashAPI(endpoint)                            .fetchTogglesInterval(fetchTogglesInterval)<br/>                           .sendMetricsInterval(sendMetricsInterval)<br/>                        .customHttpHeader("Authorization",clientSecret) <br/>                            .build();<br/>    }</span></pre><p id="0c01" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">就是这样！释放实例和切换可以通过 SDK 的现有接口“no.finn.unleash”来访问和验证</p><p id="cf21" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">我们可以将这种依赖性添加到我们感兴趣的任何服务中，并使用它来决定特性切换是打开还是关闭</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="2055" class="lt lu iq lp b gy lv lw l lx ly">import no.finn.unleash;</span><span id="b19b" class="lt lu iq lp b gy lz lw l lx ly">public class MyService {</span><span id="4b9d" class="lt lu iq lp b gy lz lw l lx ly">private final Unleash unleash;</span><span id="be63" class="lt lu iq lp b gy lz lw l lx ly">public MyService(Unleash unleash){<br/>     this.unleash=unleash;<br/>   }</span><span id="f0cc" class="lt lu iq lp b gy lz lw l lx ly">public void customLogic(){<br/>     if(unleash.isEnabled("TOGGLE_NAME")){<br/>      // New Logic<br/>     }else{<br/>      // Existing Logic<br/>     }<br/>   }</span><span id="5f94" class="lt lu iq lp b gy lz lw l lx ly">}</span></pre><p id="f020" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">在大多数情况下，切换是短暂的，需要维护。作为一般规则，如果添加切换的目的是用有限的受众/用户来测试新功能，那么假设新功能/逻辑已经满足期望，则在几周的监控之后，可以完全移除切换代码。</p><p id="deae" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">此外，如果切换被关闭，拥有现有的逻辑将是明智的，这样，如果切换在其中一个环境中不可用，对 isEnabled 方法的默认调用将返回 false，现有的逻辑将不会受到干扰。</p><p id="1f7b" class="pw-post-body-paragraph kb kc iq ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">这篇文章总结了一个功能切换的简单用例，我们可以在另一篇文章中看到高级用例(自定义策略)。</p></div></div>    
</body>
</html>