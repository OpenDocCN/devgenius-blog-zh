# å¦‚ä½•åœ¨ Magento 2 ä¸­è®¾ç½®å¤šå•†åº—

> åŸæ–‡ï¼š<https://blog.devgenius.io/how-to-setup-a-multistore-in-magento-2-1393a6fcae88?source=collection_archive---------4----------------------->

![](img/795525eed5989a621013656c7ccef6ba.png)

*ç…§ç‰‡ç”±* [*æ™¨æ²*](https://unsplash.com/@morningbrew?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) *ä¸Š* [*ä¸‹*](https://unsplash.com/s/photos/storefronts?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)

åœ¨ Magento ä¸­å¯ä»¥é…ç½®å¤šä¸ªå®ä¾‹ã€‚

æ¯ä¸ªå®ä¾‹å¯ä»¥åŒ…å«ä¸åŒçš„å±æ€§ï¼ŒåŒ…æ‹¬è¯­è¨€ã€åŸŸåã€ç±»åˆ«ã€äº§å“ã€è´§å¸ç­‰ç­‰ã€‚

Magento å®‰è£…å¯ä»¥æœ‰å¤šä¸ªç½‘ç«™ï¼Œè¿™äº›ç½‘ç«™æœ‰å¤šä¸ªå•†åº—æˆ–å•†åº—è§†å›¾ã€‚

# Magento 2 å¤šå•†åº—å±‚çº§

**å…¨å±€:**åœ¨å±‚æ¬¡ç»“æ„çš„é¡¶ç«¯ã€‚è¿™æ˜¯ä½ å®‰è£… Magento åå¾—åˆ°çš„ç»“æœã€‚è¿™åŒ…æ‹¬æ‰€æœ‰é»˜è®¤é…ç½®ã€‚

**ç½‘ç«™:** Magento å®‰è£…ä»ä¸€ä¸ªç½‘ç«™å¼€å§‹ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ªç½‘ç«™ç§°ä¸ºä¸»ç½‘ç«™ã€‚æ‚¨ä¹Ÿå¯ä»¥ä¸ºä¸€æ¬¡å®‰è£…è®¾ç½®å¤šä¸ªç½‘ç«™ï¼Œæ¯ä¸ªç½‘ç«™éƒ½æœ‰è‡ªå·±çš„ IP åœ°å€å’ŒåŸŸã€‚

**å•†åº—:**ä¸€ä¸ªç½‘ç«™å¯ä»¥æœ‰å¤šä¸ªå•†åº—ï¼Œæ¯ä¸ªå•†åº—éƒ½æœ‰è‡ªå·±çš„ä¸»èœå•ã€‚å•†åº—å…±äº«ç›¸åŒçš„äº§å“ç›®å½•ï¼Œä½†å¯ä»¥é€‰æ‹©ä¸åŒçš„äº§å“å’Œè®¾è®¡ã€‚åŒä¸€ç½‘ç«™ä¸‹çš„æ‰€æœ‰å•†åº—å…±äº«ç›¸åŒçš„ç®¡ç†å’Œç»“å¸ã€‚

**å•†åº—è§†å›¾:**æ¯ä¸ªå¯ä¾›é¡¾å®¢ä½¿ç”¨çš„å•†åº—éƒ½æ˜¯æ ¹æ®ç‰¹å®šçš„è§†å›¾å‘ˆç°çš„ã€‚æœ€åˆï¼Œå•†åº—åªæœ‰ä¸€ä¸ªé»˜è®¤è§†å›¾ã€‚å¯ä»¥æ·»åŠ é¢å¤–çš„å•†åº—è§†å›¾æ¥æ”¯æŒä¸åŒçš„è¯­è¨€ï¼Œæˆ–è€…ç”¨äºå…¶ä»–ç›®çš„ã€‚å®¢æˆ·å¯ä»¥ä½¿ç”¨æ ‡é¢˜ä¸­çš„è¯­è¨€é€‰æ‹©å™¨æ¥æ›´æ”¹å•†åº—è§†å›¾

![](img/17eaea6abb9f4266b97c0cd4f8d2442c.png)

Magento 2 å¤šå•†åº—å›¾

# æ­¥éª¤ 1:å¦‚ä½•åˆ›å»ºå¤šå•†åº—

åœ¨æˆ‘ä»¬å»ºç«‹äº† Magento å•†åº—ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ä»¥ç®¡ç†å‘˜çš„èº«ä»½ç™»å½•æˆ‘ä»¬çš„å•†åº—ã€‚å¦‚æœæ‚¨è¿˜æ²¡æœ‰ç®¡ç†å‘˜å¸æˆ·ï¼Œæ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ªï¼Œå¦‚ä¸‹æ‰€ç¤º:

```
bin/magento admin:user:create
```

ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå–è¿åŠ¨é¥®æ–™çš„ç½‘ç«™ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚

è¿›å…¥å•†åº—->è®¾ç½®->æ‰€æœ‰å•†åº—ã€‚

## åˆ›å»ºæ–°ç½‘ç«™

ç‚¹å‡»åˆ›å»ºç½‘ç«™å¹¶è¾“å…¥ä»¥ä¸‹å†…å®¹:

1.  æ‚¨ç½‘ç«™çš„åç§°
2.  æ‚¨å•†åº—çš„å”¯ä¸€ä»£ç 
3.  æ’åºæ˜¯å¯é€‰çš„ï¼Œé»˜è®¤ä¸º 0ï¼Œç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹å®ƒæ˜¯æ€æ ·çš„ã€‚

![](img/bb7fca39ec38ae747d632af232da0a07.png)

## åˆ›å»ºæ–°å•†åº—

å•å‡»â€œåˆ›å»ºå•†åº—â€å¹¶è¾“å…¥ä»¥ä¸‹ä¿¡æ¯:

1.  é€‰æ‹©ç½‘ç«™
2.  ä½ çš„å•†åº—åç§°
3.  æ‚¨å•†åº—çš„å”¯ä¸€ä»£ç 
4.  æ ¹ç±»åˆ«ï¼Œé»˜è®¤ä¸ºé»˜è®¤

![](img/3c715a3523d19593f2e72126c095a320.png)

## åˆ›å»ºæ–°çš„å•†åº—è§†å›¾

å•å‡»â€œåˆ›å»ºå•†åº—â€å¹¶è¾“å…¥ä»¥ä¸‹ä¿¡æ¯:

1.  é€‰æ‹©å•†åº—
2.  æ‚¨çš„å•†åº—è§†å›¾çš„åç§°
3.  æ‚¨å•†åº—çš„å”¯ä¸€ä»£ç 
4.  çŠ¶æ€å·²å¯ç”¨(ä¸è¨€è‡ªæ˜)
5.  æ’åºæ˜¯å¯é€‰çš„ï¼Œé»˜è®¤ä¸º 0ï¼Œç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹å®ƒæ˜¯æ€æ ·çš„ã€‚

![](img/4e2bad32a064065556d21f80c3b3f4ac.png)

è¿™æ˜¯æˆ‘ä»¬çš„ç»“æœ

![](img/71aa506252f9e761fa764ff2e3226a9e.png)

# æ–¹æ³• 1:ä»ç®¡ç†å‘˜é…ç½®åŸºæœ¬ URL

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å•†åº—>è®¾ç½®>é…ç½®>å¸¸è§„>ç½‘ç»œä¸­è®¾ç½®æˆ‘ä»¬çš„åŸºæœ¬ urlã€‚

1.  åœ¨é¡µé¢é¡¶éƒ¨é€‰æ‹©è¦è®¾ç½®åŸºæœ¬ url çš„å•†åº—è§†å›¾ã€‚
2.  å®Œæˆä»¥ä¸‹å­—æ®µ
3.  åŸºæœ¬ url:å•†åº—è§†å›¾çš„åŸºæœ¬ URLã€‚
4.  åŸºæœ¬é“¾æ¥ url:é“¾æ¥ url çš„åŸºæœ¬ URLï¼Œé€šå¸¸ä¸ base url ç›¸åŒã€‚
5.  é™æ€è§†å›¾æ–‡ä»¶çš„åŸºæœ¬ URL(é»˜è®¤å€¼):è®©æˆ‘ä»¬é»˜è®¤
6.  ç”¨æˆ·åª’ä½“æ–‡ä»¶çš„åŸºæœ¬ URL(é»˜è®¤å€¼):è¾“å…¥åª’ä½“æ–‡ä»¶çš„ URLã€‚è¿™é€šå¸¸æ˜¯åé¢å¸¦æœ‰/ media /çš„ baseurlã€‚å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ CDNï¼Œurl æŒ‡å‘æ‚¨çš„ CDNã€‚

![](img/6568406ac2f545f8db66b746a98f8d3e.png)

# æ–¹æ³• 2:ä½¿ç”¨ SSH é…ç½®åŸºæœ¬ URL

```
bin/magento config:set web/unsecure/base_url "http://app.sportnutrition.test/" **\
**    --scope=website **\
**    --scope-code=sportnutrition **\
**    -le

bin/magento config:set web/secure/base_url "https://app.sportdrinks-nl.test/" **\
**    --scope=store **\
**    --scope-code=sportdrinks_nl **\
**    -le
```

# é…ç½®æœåŠ¡å™¨ä»¥åŠ è½½åº—é¢

ç°åœ¨æˆ‘ä»¬å·²ç»ä¸º Magento åˆ›å»ºäº†ä¸€ä¸ªæ–°ç½‘ç«™ï¼Œæˆ‘ä»¬éœ€è¦å°†å®ƒæ·»åŠ åˆ°æˆ‘ä»¬çš„é¡¹ç›®ä¸­ã€‚ç¡®ä¿æ‚¨å¤„äºå¼€å‘äººå‘˜æ¨¡å¼ã€‚

```
bin/magento deploy:mode:set developer
```

æœ‰å‡ ç§æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚

*   å°†å•†åº—ä»£ç æ·»åŠ åˆ°æ‚¨çš„åŸºæœ¬ URLï¼Œæ‚¨ä¸éœ€è¦ä¸ºæ­¤è®¿é—®æ‚¨çš„æœåŠ¡å™¨ã€‚
*   ç”¨. htaccess å’Œ index.php åˆ›å»ºä¸€ä¸ªå­æ–‡ä»¶å¤¹ã€‚
*   ä½¿ç”¨ç¬¦å·é“¾æ¥

# æ–¹æ³• 1:å°†å•†åº—ä»£ç æ·»åŠ åˆ°åŸºæœ¬ URL ä¸­ã€‚

è½¬åˆ°ç³»ç»Ÿ->è®¾ç½®->é…ç½®->å¸¸è§„-> Web

1.  æ‰“å¼€ URL é€‰é¡¹éƒ¨åˆ†:
2.  æ ¹æ®éœ€è¦ï¼Œåœ¨æ·»åŠ å•†åº—ä»£ç ä¸­é€‰æ‹©æ˜¯ã€‚

å¸¦å•†åº—ä»£ç çš„ URL:

[https://example.com/store-view/index.php/](https://example.com/store-view/index.php/)

æ²¡æœ‰å•†åº—ä»£ç çš„ URL:

https://example.com/index.php/

# æ–¹æ³• 2:ä½¿ç”¨å­æ–‡ä»¶å¤¹åˆ›å»ºå¤šå•†åº—

åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹ï¼Œå¹¶å¤åˆ¶ç²˜è´´ã€‚htaccess åˆ°æ‚¨çš„æ–°æ–‡ä»¶å¤¹ã€‚

```
mkdir -p <new_site> && cp .htaccess <new_site>
```

ç„¶ååˆ›å»ºä¸€ä¸ª index.php:

```
<?php

**require** realpath(**__DIR__**) . '/../app/bootstrap.php';
$params = $_SERVER;$params[\Magento\Store\Model\StoreManager::PARAM_RUN_CODE] = '<code>';
$params[\Magento\Store\Model\StoreManager::PARAM_RUN_TYPE] = '<type>';
$bootstrap = \Magento\Framework\App\Bootstrap::create(BP, $params);$app = $bootstrap->createApplication('Magento\Framework\App\Http');
$bootstrap->run($app);
```

# æ–¹æ³• 3:åˆ›å»ºå¸¦ç¬¦å·é“¾æ¥çš„å¤šå•†åº—

ä½¿ç”¨*ln-s<target _ dir>åˆ›å»ºä¸€ä¸ªç¬¦å·é“¾æ¥ã€‚*

```
ln -s <path_to_projet_root>/app/ <your_new_site>app
ln -s <path_to_projet_root>/lib/ <your_new_site>lib
ln -s <path_to_projet_root>/pub/ <your_new_site>pub
ln -s <path_to_projet_root>/var/ <your_new_site>var
```

è¿™äº›æ˜¯åœ¨ Magento 2 ä¸­è®¾ç½®å¤šå•†åº—çš„æ­¥éª¤ï¼Œåœ¨æˆ‘çš„ä¸‹ä¸€ç¯‡åšå®¢ä¸­ï¼Œæˆ‘å°†è§£é‡Šå¦‚ä½•ç”¨ Docker å’Œ Warden åœ¨æœ¬åœ°é…ç½®å¤šå•†åº—ã€‚

# è§‰å¾—è¿™ä¸ªå¸–å­æœ‰ç”¨å—ï¼Ÿè¯·ç‚¹å‡»ğŸ‘ä¸‹é¢çš„æŒ‰é’®ï¼:)

æ¥æº:

*   [ç½‘ç«™ã€å•†åº—å’Œè§†å›¾](https://docs.magento.com/user-guide/stores/websites-stores-views.html)
*   [å¦‚ä½•åœ¨ Magento 2 ä¸­é…ç½®å•†åº—ç½‘å€](https://www.mageplaza.com/kb/how-to-configure-store-urls-magento-2.html)
*   [å…·æœ‰å¤šåŸŸå’Œå­ç›®å½•è®¾ç½®çš„å¤šå•†åº—â€”ç¬¦å·é“¾æ¥](https://magento.stackexchange.com/questions/107450/multi-store-with-multi-domain-and-sub-directory-setup-symlinks)