<html>
<head>
<title>Pandas Pipe functionâ€” Chainable functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç†ŠçŒ«ç®¡é“å‡½æ•°â€”å¯é“¾æ¥çš„å‡½æ•°</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://blog.devgenius.io/pandas-pipe-function-chainable-functions-633f427b0451?source=collection_archive---------11-----------------------#2022-12-11">https://blog.devgenius.io/pandas-pipe-function-chainable-functions-633f427b0451?source=collection_archive---------11-----------------------#2022-12-11</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/4d5adcf28a8a794ec7b21021d3dce21e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zQAXcsRkpzKIrPn30MYR3g.jpeg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">å›¾ç‰‡æ¥è‡ª Pixabay çš„ Manfred Richter</figcaption></figure><p id="1e01" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">åœ¨æ•°æ®å¤„ç†è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬åº”ç”¨äº†å¤šç§åŠŸèƒ½ï¼Œå¦‚æ·»åŠ é¢å¤–çš„åˆ—ã€æ›´æ”¹ç°æœ‰åˆ—çš„è¯¦ç»†ä¿¡æ¯ã€ç»Ÿè®¡è®¡ç®—ã€æ‹†åˆ†æˆ–æ›¿æ¢æ•°æ®å¸§ä¸Šçš„å€¼ï¼Œä»¥è·å¾—æ‰€éœ€çš„ç»“æœã€‚</p><p id="45d4" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ¥è‡ª<strong class="kb io">ç†ŠçŒ«çš„<strong class="kb io"> pipe() </strong>æ–¹æ³•ã€‚</strong></p><p id="ef99" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">ç†ŠçŒ«ä» 0.16.2 ç‰ˆæœ¬å¼€å§‹å¼•å…¥<code class="fe kx ky kz la b">pipe()</code>ã€‚<code class="fe kx ky kz la b">pipe()</code>åœ¨æ–¹æ³•é“¾ä¸­å¯ç”¨ç”¨æˆ·å®šä¹‰çš„æ–¹æ³•ã€‚</p><p id="8a6e" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">ç°åœ¨å¼€å‘äººå‘˜å¯ä»¥ç¼–å†™å¯é“¾æ¥çš„ä»£ç ï¼Œå¯è¯»æ€§æ›´å¥½ã€‚</p><blockquote class="lb lc ld"><p id="1e0d" class="jz ka le kb b kc kd ke kf kg kh ki kj lf kl km kn lg kp kq kr lh kt ku kv kw ig bi translated">è¯­æ³•:<strong class="kb io"> DataFrame.pipe(funcï¼Œ*argsï¼Œ**kwargs) </strong></p></blockquote><p id="4467" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">å…¬æ–‡é“¾æ¥â€” <a class="ae li" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.pipe.html" rel="noopener ugc nofollow" target="_blank"> pipe() </a></p><p id="388a" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">åˆ›å»º 3 ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨è¿™äº›å‡½æ•°ä½œä¸ºç®¡é“ä¸­çš„å¯é“¾æ¥å‡½æ•°ã€‚</p><pre class="lj lk ll lm gt ln la lo bn lp lq bi"><span id="f62d" class="lr ls in la b be lt lu l lv lw"># Adding Age column to Dataframe<br/>def add_age_column(df):<br/>    df["age"] = [23,24,22,22,21,22,23,24,24]<br/>    return df<br/><br/># Adding date column and passing list of values<br/>def add_date_column(df, date: list):<br/>    df["date"] = date<br/>    return df<br/><br/># adding multiple columns with values using dict<br/>def add_multi_columns(df, data: dict):<br/>    for key, value in data.items():<br/>        df[key] = value<br/>        <br/>    return df</span></pre><p id="0dc5" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç†ŠçŒ«æ•°æ®æ¡†æ¶å¹¶åº”ç”¨è¿™äº›å¯é“¾æ¥çš„å‡½æ•°</p><pre class="lj lk ll lm gt ln la lo bn lp lq bi"><span id="08c1" class="lr ls in la b be lt lu l lv lw">import pandas as pd<br/>import numpy as np<br/><br/>data = {'name': ['Ted'] * 3 + ['Lisa'] * 3 + ['Sam'] * 3,<br/>        'subject': ['math', 'physics', 'history'] * 3,<br/>        'score': np.random.randint(60, 100, 9)}<br/><br/>df = pd.DataFrame(data)<br/><br/># o/p<br/><br/>#    name  subject  score  <br/># 0   Ted     math     60   <br/># 1   Ted  physics     67   <br/># 2   Ted  history     97   <br/># 3  Lisa     math     65   <br/># 4  Lisa  physics     66</span></pre><p id="5ea3" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬å°†ä½¿ç”¨<strong class="kb io"> add_age_column </strong>ï¼Œå®ƒä¼šå°†ä»£ç ä¸­å®šä¹‰çš„å¸¸é‡åˆ—è¡¨å€¼æ·»åŠ åˆ° dataframe çš„<strong class="kb io"> age </strong>åˆ—ä¸­ã€‚</p><pre class="lj lk ll lm gt ln la lo bn lp lq bi"><span id="5ad6" class="lr ls in la b be lt lu l lv lw">df.pipe(add_constant_column)<br/><br/># o/p<br/><br/>#    name  subject  score  age<br/># 0   Ted     math     60   23<br/># 1   Ted  physics     67   24<br/># 2   Ted  history     97   22<br/># 3  Lisa     math     65   22<br/># 4  Lisa  physics     66   21</span></pre><p id="1758" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">åŒæ ·ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å…¶ä½™ä¸¤ä¸ªå‡½æ•°<strong class="kb io"> add_date_column </strong>å’Œ<strong class="kb io"> add_multi_columnsã€‚</strong></p><p id="6b2d" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">åœ¨<strong class="kb io"> add_date_column </strong>å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬ç»™å‡ºåˆ—è¡¨å‚æ•°ï¼Œåœ¨<strong class="kb io"> add_multi_columns </strong>å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬ç»™å‡ºå­—å…¸å‚æ•°ã€‚</p><pre class="lj lk ll lm gt ln la lo bn lp lq bi"><span id="79ae" class="lr ls in la b be lt lu l lv lw">df.pipe(add_date_column, ["10/12/23", "1/4/22", "11/1/20"]*3)<br/><br/># o/p<br/><br/>#    name  subject  score  age      date<br/># 0   Ted     math     60   23  10/12/23<br/># 1   Ted  physics     67   24    1/4/22<br/># 2   Ted  history     97   22   11/1/20<br/># 3  Lisa     math     65   22  10/12/23<br/># 4  Lisa  physics     66   21    1/4/22<br/><br/>df.pipe(add_multi_columns, {'status': ['Fail', 'Pass', 'Pass'] * 3,<br/>        'intelligent_score': np.random.randint(60, 100, 9)})<br/><br/># o/p<br/><br/>#    name  subject  score  age      date status  intelligent_score<br/># 0   Ted     math     60   23  10/12/23   Fail                 72<br/># 1   Ted  physics     67   24    1/4/22   Pass                 81<br/># 2   Ted  history     97   22   11/1/20   Pass                 85<br/># 3  Lisa     math     65   22  10/12/23   Fail                 96<br/># 4  Lisa  physics     66   21    1/4/22   Pass                 60</span></pre><p id="6372" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ä¸€ä¸ªé“¾ä¸­ä½¿ç”¨æ‰€æœ‰çš„å‡½æ•°ã€‚</p><pre class="lj lk ll lm gt ln la lo bn lp lq bi"><span id="d408" class="lr ls in la b be lt lu l lv lw"><br/>(df.pipe(add_age_column)<br/>  .pipe(add_date_column, ["10/12/23", "1/4/22", "11/1/20"]*3)<br/>  .pipe(add_multi_columns, {'status': ['Fail', 'Pass', 'Pass'] * 3,<br/>        'intelligent_score': np.random.randint(60, 100, 9)}))<br/><br/># o/p<br/><br/>#    name  subject  score  age      date status  intelligent_score<br/># 0   Ted     math     60   23  10/12/23   Fail                 72<br/># 1   Ted  physics     67   24    1/4/22   Pass                 81<br/># 2   Ted  history     97   22   11/1/20   Pass                 85<br/># 3  Lisa     math     65   22  10/12/23   Fail                 96<br/># 4  Lisa  physics     66   21    1/4/22   Pass                 60</span></pre><p id="fe4f" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">å®Œæ•´ä»£ç ã€‚</p><pre class="lj lk ll lm gt ln la lo bn lp lq bi"><span id="e018" class="lr ls in la b be lt lu l lv lw"># Pandas pipe <br/><br/>import pandas as pd<br/>import numpy as np<br/><br/><br/>data = {'name': ['Ted'] * 3 + ['Lisa'] * 3 + ['Sam'] * 3,<br/>        'subject': ['math', 'physics', 'history'] * 3,<br/>        'score': np.random.randint(60, 100, 9)}<br/><br/># Adding Age column to Dataframe<br/>def add_age_column(df):<br/>    df["age"] = [23,24,22,22,21,22,23,24,24]<br/>    return df<br/><br/># Adding date column and passing list of values<br/>def add_date_column(df, date: list):<br/>    df["date"] = date<br/>    return df<br/><br/># adding multiple columns with values using dict<br/>def add_multi_columns(df, data: dict):<br/>    for key, value in data.items():<br/>        df[key] = value<br/>        <br/>    return df<br/><br/><br/># Dataframe<br/>df = pd.DataFrame(data)<br/><br/><br/># Pipe<br/>df.pipe(add_age_column)<br/><br/># o/p<br/><br/>#    name  subject  score  age<br/># 0   Ted     math     60   23<br/># 1   Ted  physics     67   24<br/># 2   Ted  history     97   22<br/># 3  Lisa     math     65   22<br/># 4  Lisa  physics     66   21<br/><br/><br/>df.pipe(add_date_column, ["10/12/23", "1/4/22", "11/1/20"]*3)<br/><br/># o/p<br/><br/>#    name  subject  score  age      date<br/># 0   Ted     math     60   23  10/12/23<br/># 1   Ted  physics     67   24    1/4/22<br/># 2   Ted  history     97   22   11/1/20<br/># 3  Lisa     math     65   22  10/12/23<br/># 4  Lisa  physics     66   21    1/4/22<br/><br/><br/>df.pipe(add_multi_columns, {'status': ['Fail', 'Pass', 'Pass'] * 3,<br/>        'intelligent_score': np.random.randint(60, 100, 9)})<br/><br/># o/p<br/><br/>#    name  subject  score  age      date status  intelligent_score<br/># 0   Ted     math     60   23  10/12/23   Fail                 72<br/># 1   Ted  physics     67   24    1/4/22   Pass                 81<br/># 2   Ted  history     97   22   11/1/20   Pass                 85<br/># 3  Lisa     math     65   22  10/12/23   Fail                 96<br/># 4  Lisa  physics     66   21    1/4/22   Pass                 60<br/><br/><br/># complete pipeline in single flow<br/><br/>(df.pipe(add_age_column)<br/>  .pipe(add_date_column, ["10/12/23", "1/4/22", "11/1/20"]*3)<br/>  .pipe(add_multi_columns, {'status': ['Fail', 'Pass', 'Pass'] * 3,<br/>        'intelligent_score': np.random.randint(60, 100, 9)}))<br/><br/># o/p<br/><br/>#    name  subject  score  age      date status  intelligent_score<br/># 0   Ted     math     60   23  10/12/23   Fail                 72<br/># 1   Ted  physics     67   24    1/4/22   Pass                 81<br/># 2   Ted  history     97   22   11/1/20   Pass                 85<br/># 3  Lisa     math     65   22  10/12/23   Fail                 96<br/># 4  Lisa  physics     66   21    1/4/22   Pass                 60<br/><br/></span></pre><p id="0571" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">ä¸‹ä¸€ç¯‡æ–‡ç« å†è§ğŸ˜Šï¼</p><p id="2ec0" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">ç¼–ç å¿«ä¹ï¼ï¼ï¼</p></div></div>    
</body>
</html>