<html>
<head>
<title>Pandas Pipe function— Chainable functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫管道函数—可链接的函数</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/pandas-pipe-function-chainable-functions-633f427b0451?source=collection_archive---------11-----------------------#2022-12-11">https://blog.devgenius.io/pandas-pipe-function-chainable-functions-633f427b0451?source=collection_archive---------11-----------------------#2022-12-11</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/4d5adcf28a8a794ec7b21021d3dce21e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zQAXcsRkpzKIrPn30MYR3g.jpeg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">图片来自 Pixabay 的 Manfred Richter</figcaption></figure><p id="1e01" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在数据处理过程中，我们应用了多种功能，如添加额外的列、更改现有列的详细信息、统计计算、拆分或替换数据帧上的值，以获得所需的结果。</p><p id="45d4" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">为了简单起见，我们将使用来自<strong class="kb io">熊猫的<strong class="kb io"> pipe() </strong>方法。</strong></p><p id="ef99" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">熊猫从 0.16.2 版本开始引入<code class="fe kx ky kz la b">pipe()</code>。<code class="fe kx ky kz la b">pipe()</code>在方法链中启用用户定义的方法。</p><p id="8a6e" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">现在开发人员可以编写可链接的代码，可读性更好。</p><blockquote class="lb lc ld"><p id="1e0d" class="jz ka le kb b kc kd ke kf kg kh ki kj lf kl km kn lg kp kq kr lh kt ku kv kw ig bi translated">语法:<strong class="kb io"> DataFrame.pipe(func，*args，**kwargs) </strong></p></blockquote><p id="4467" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">公文链接— <a class="ae li" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.pipe.html" rel="noopener ugc nofollow" target="_blank"> pipe() </a></p><p id="388a" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">创建 3 个函数，我们将使用这些函数作为管道中的可链接函数。</p><pre class="lj lk ll lm gt ln la lo bn lp lq bi"><span id="f62d" class="lr ls in la b be lt lu l lv lw"># Adding Age column to Dataframe<br/>def add_age_column(df):<br/>    df["age"] = [23,24,22,22,21,22,23,24,24]<br/>    return df<br/><br/># Adding date column and passing list of values<br/>def add_date_column(df, date: list):<br/>    df["date"] = date<br/>    return df<br/><br/># adding multiple columns with values using dict<br/>def add_multi_columns(df, data: dict):<br/>    for key, value in data.items():<br/>        df[key] = value<br/>        <br/>    return df</span></pre><p id="0dc5" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">让我们创建一个熊猫数据框架并应用这些可链接的函数</p><pre class="lj lk ll lm gt ln la lo bn lp lq bi"><span id="08c1" class="lr ls in la b be lt lu l lv lw">import pandas as pd<br/>import numpy as np<br/><br/>data = {'name': ['Ted'] * 3 + ['Lisa'] * 3 + ['Sam'] * 3,<br/>        'subject': ['math', 'physics', 'history'] * 3,<br/>        'score': np.random.randint(60, 100, 9)}<br/><br/>df = pd.DataFrame(data)<br/><br/># o/p<br/><br/>#    name  subject  score  <br/># 0   Ted     math     60   <br/># 1   Ted  physics     67   <br/># 2   Ted  history     97   <br/># 3  Lisa     math     65   <br/># 4  Lisa  physics     66</span></pre><p id="5ea3" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">首先，我们将使用<strong class="kb io"> add_age_column </strong>，它会将代码中定义的常量列表值添加到 dataframe 的<strong class="kb io"> age </strong>列中。</p><pre class="lj lk ll lm gt ln la lo bn lp lq bi"><span id="5ad6" class="lr ls in la b be lt lu l lv lw">df.pipe(add_constant_column)<br/><br/># o/p<br/><br/>#    name  subject  score  age<br/># 0   Ted     math     60   23<br/># 1   Ted  physics     67   24<br/># 2   Ted  history     97   22<br/># 3  Lisa     math     65   22<br/># 4  Lisa  physics     66   21</span></pre><p id="1758" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">同样，我们将使用其余两个函数<strong class="kb io"> add_date_column </strong>和<strong class="kb io"> add_multi_columns。</strong></p><p id="6b2d" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在<strong class="kb io"> add_date_column </strong>函数中，我们给出列表参数，在<strong class="kb io"> add_multi_columns </strong>函数中，我们给出字典参数。</p><pre class="lj lk ll lm gt ln la lo bn lp lq bi"><span id="79ae" class="lr ls in la b be lt lu l lv lw">df.pipe(add_date_column, ["10/12/23", "1/4/22", "11/1/20"]*3)<br/><br/># o/p<br/><br/>#    name  subject  score  age      date<br/># 0   Ted     math     60   23  10/12/23<br/># 1   Ted  physics     67   24    1/4/22<br/># 2   Ted  history     97   22   11/1/20<br/># 3  Lisa     math     65   22  10/12/23<br/># 4  Lisa  physics     66   21    1/4/22<br/><br/>df.pipe(add_multi_columns, {'status': ['Fail', 'Pass', 'Pass'] * 3,<br/>        'intelligent_score': np.random.randint(60, 100, 9)})<br/><br/># o/p<br/><br/>#    name  subject  score  age      date status  intelligent_score<br/># 0   Ted     math     60   23  10/12/23   Fail                 72<br/># 1   Ted  physics     67   24    1/4/22   Pass                 81<br/># 2   Ted  history     97   22   11/1/20   Pass                 85<br/># 3  Lisa     math     65   22  10/12/23   Fail                 96<br/># 4  Lisa  physics     66   21    1/4/22   Pass                 60</span></pre><p id="6372" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我们也可以在一个链中使用所有的函数。</p><pre class="lj lk ll lm gt ln la lo bn lp lq bi"><span id="d408" class="lr ls in la b be lt lu l lv lw"><br/>(df.pipe(add_age_column)<br/>  .pipe(add_date_column, ["10/12/23", "1/4/22", "11/1/20"]*3)<br/>  .pipe(add_multi_columns, {'status': ['Fail', 'Pass', 'Pass'] * 3,<br/>        'intelligent_score': np.random.randint(60, 100, 9)}))<br/><br/># o/p<br/><br/>#    name  subject  score  age      date status  intelligent_score<br/># 0   Ted     math     60   23  10/12/23   Fail                 72<br/># 1   Ted  physics     67   24    1/4/22   Pass                 81<br/># 2   Ted  history     97   22   11/1/20   Pass                 85<br/># 3  Lisa     math     65   22  10/12/23   Fail                 96<br/># 4  Lisa  physics     66   21    1/4/22   Pass                 60</span></pre><p id="fe4f" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">完整代码。</p><pre class="lj lk ll lm gt ln la lo bn lp lq bi"><span id="e018" class="lr ls in la b be lt lu l lv lw"># Pandas pipe <br/><br/>import pandas as pd<br/>import numpy as np<br/><br/><br/>data = {'name': ['Ted'] * 3 + ['Lisa'] * 3 + ['Sam'] * 3,<br/>        'subject': ['math', 'physics', 'history'] * 3,<br/>        'score': np.random.randint(60, 100, 9)}<br/><br/># Adding Age column to Dataframe<br/>def add_age_column(df):<br/>    df["age"] = [23,24,22,22,21,22,23,24,24]<br/>    return df<br/><br/># Adding date column and passing list of values<br/>def add_date_column(df, date: list):<br/>    df["date"] = date<br/>    return df<br/><br/># adding multiple columns with values using dict<br/>def add_multi_columns(df, data: dict):<br/>    for key, value in data.items():<br/>        df[key] = value<br/>        <br/>    return df<br/><br/><br/># Dataframe<br/>df = pd.DataFrame(data)<br/><br/><br/># Pipe<br/>df.pipe(add_age_column)<br/><br/># o/p<br/><br/>#    name  subject  score  age<br/># 0   Ted     math     60   23<br/># 1   Ted  physics     67   24<br/># 2   Ted  history     97   22<br/># 3  Lisa     math     65   22<br/># 4  Lisa  physics     66   21<br/><br/><br/>df.pipe(add_date_column, ["10/12/23", "1/4/22", "11/1/20"]*3)<br/><br/># o/p<br/><br/>#    name  subject  score  age      date<br/># 0   Ted     math     60   23  10/12/23<br/># 1   Ted  physics     67   24    1/4/22<br/># 2   Ted  history     97   22   11/1/20<br/># 3  Lisa     math     65   22  10/12/23<br/># 4  Lisa  physics     66   21    1/4/22<br/><br/><br/>df.pipe(add_multi_columns, {'status': ['Fail', 'Pass', 'Pass'] * 3,<br/>        'intelligent_score': np.random.randint(60, 100, 9)})<br/><br/># o/p<br/><br/>#    name  subject  score  age      date status  intelligent_score<br/># 0   Ted     math     60   23  10/12/23   Fail                 72<br/># 1   Ted  physics     67   24    1/4/22   Pass                 81<br/># 2   Ted  history     97   22   11/1/20   Pass                 85<br/># 3  Lisa     math     65   22  10/12/23   Fail                 96<br/># 4  Lisa  physics     66   21    1/4/22   Pass                 60<br/><br/><br/># complete pipeline in single flow<br/><br/>(df.pipe(add_age_column)<br/>  .pipe(add_date_column, ["10/12/23", "1/4/22", "11/1/20"]*3)<br/>  .pipe(add_multi_columns, {'status': ['Fail', 'Pass', 'Pass'] * 3,<br/>        'intelligent_score': np.random.randint(60, 100, 9)}))<br/><br/># o/p<br/><br/>#    name  subject  score  age      date status  intelligent_score<br/># 0   Ted     math     60   23  10/12/23   Fail                 72<br/># 1   Ted  physics     67   24    1/4/22   Pass                 81<br/># 2   Ted  history     97   22   11/1/20   Pass                 85<br/># 3  Lisa     math     65   22  10/12/23   Fail                 96<br/># 4  Lisa  physics     66   21    1/4/22   Pass                 60<br/><br/></span></pre><p id="0571" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">下一篇文章再见😊！</p><p id="2ec0" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">编码快乐！！！</p></div></div>    
</body>
</html>