<html>
<head>
<title>React — Passing Asynchronous Data To A Child Component</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">react——将异步数据传递给子组件</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/react-passing-asynchronous-data-to-a-child-component-9fce801dd717?source=collection_archive---------1-----------------------#2021-12-31">https://blog.devgenius.io/react-passing-asynchronous-data-to-a-child-component-9fce801dd717?source=collection_archive---------1-----------------------#2021-12-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/60b235ff82d0ad1ca63732fe5d455303.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Aj2w_L1K3sVewC9D.jpg"/></div></div></figure><p id="9934" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我记得当我还在学习 React 的基础知识时，我花了大量的时间来弄清楚如何将异步数据(例如，我们从调用 API 获得的数据)传递给子组件。因此，本文旨在尽可能直观地解释这一点，并作为我希望在过去学习这一点时拥有的文档。</p><h1 id="4add" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">我们的异步数据源</h1><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="af95" class="md kx iq lz b gy me mf l mg mh">https://api.npoint.io/df2c42f9149aa832ea14</span></pre><p id="410e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了简单起见，我使用<em class="mi"> npoint.io </em>创建了一个虚拟端点——这个端点简单地返回:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="6530" class="md kx iq lz b gy me mf l mg mh">{"message": "hello world from npoint!!"}</span></pre><h1 id="49fb" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">我们的任务</h1><ol class=""><li id="b703" class="mj mk iq ka b kb ml kf mm kj mn kn mo kr mp kv mq mr ms mt bi translated">在<code class="fe mu mv mw lz b">Parent</code>组件中向该端点发出 GET 请求。</li><li id="06cb" class="mj mk iq ka b kb mx kf my kj mz kn na kr nb kv mq mr ms mt bi translated">在<code class="fe mu mv mw lz b">ChildComponent</code>组件中显示信息<code class="fe mu mv mw lz b">"hello world from npoint!!"</code>(还有<code class="fe mu mv mw lz b">Parent</code>用于比较)</li></ol><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/a3c22ef3b496bc3e7a512c87102430ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h4Z6pwjv9-XiycBBdwdxTg.png"/></div></div><figcaption class="nd ne gj gh gi nf ng bd b be z dk translated">我们的应用应该是什么样子</figcaption></figure><h1 id="a8ec" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">完整的代码</h1><figure class="lu lv lw lx gt jr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h1 id="6147" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">代码中发生了什么</h1><h2 id="0656" class="md kx iq bd ky nj nk dn lc nl nm dp lg kj nn no lk kn np nq lo kr nr ns ls nt bi translated">1.进口材料</h2><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="e746" class="md kx iq lz b gy me mf l mg mh">import React from "react"<br/>import axios from "axios"</span></pre><h2 id="2eb6" class="md kx iq bd ky nj nk dn lc nl nm dp lg kj nn no lk kn np nq lo kr nr ns ls nt bi translated">2.在父组件中发出 GET 请求</h2><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="97e6" class="md kx iq lz b gy me mf l mg mh">class Parent extends React.Component {<br/>    <br/>    state = {message: "default message"}</span><span id="7554" class="md kx iq lz b gy nu mf l mg mh">    componentDidMount() {<br/>        const url = "<a class="ae nv" href="https://api.npoint.io/df2c42f9149aa832ea14" rel="noopener ugc nofollow" target="_blank">https://api.npoint.io/df2c42f9149aa832ea14</a>"<br/>        axios.get(url)<br/>            .then((response) =&gt; {<br/>                this.setState({<br/>                    message: response.data.message<br/>                })<br/>            })<br/>        }</span><span id="179a" class="md kx iq lz b gy nu mf l mg mh">    // other stuff<br/>}</span></pre><p id="2afd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这里，我们首先定义我们的<code class="fe mu mv mw lz b">state</code>。然后，我们使用<code class="fe mu mv mw lz b">axios</code>库向我们的端点发出一个 HTTP GET 请求。请注意，我们接收的数据是异步的。</p><p id="24d9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一旦我们收到响应，我们将<code class="fe mu mv mw lz b">state.message</code>设置为<code class="fe mu mv mw lz b">response.data.message</code>，也就是<code class="fe mu mv mw lz b">"hello world from npoint!!"</code>。至此，<code class="fe mu mv mw lz b">state</code>将为<code class="fe mu mv mw lz b">{message: "hello world from npoint!!"}</code>。</p><h2 id="df7f" class="md kx iq bd ky nj nk dn lc nl nm dp lg kj nn no lk kn np nq lo kr nr ns ls nt bi translated">3.使用 render()函数显示消息</h2><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="e375" class="md kx iq lz b gy me mf l mg mh">class Parent extends React.Component {</span><span id="0c63" class="md kx iq lz b gy nu mf l mg mh">    // stuff</span><span id="86b3" class="md kx iq lz b gy nu mf l mg mh">    render () {<br/>        return &lt;div&gt;<br/>            &lt;h1&gt;From Parent Component: {this.state.message} &lt;/h1&gt;<br/>            &lt;br/&gt;<br/>            &lt;ChildComponent message={this.state.message} /&gt;<br/>        &lt;/div&gt;<br/>    }<br/>}</span></pre><p id="42d4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">再一次，<code class="fe mu mv mw lz b">render</code>函数是我们显示我们想要显示的东西的地方。在这里的<code class="fe mu mv mw lz b">h1</code>元素中，我们显示我们的<code class="fe mu mv mw lz b">state.message</code>。在下一行，我们将<code class="fe mu mv mw lz b">state.message</code>作为道具传递给之后的<code class="fe mu mv mw lz b">Child</code>组件，以便<code class="fe mu mv mw lz b">ChildComponent</code>显示它。</p><h2 id="8773" class="md kx iq bd ky nj nk dn lc nl nm dp lg kj nn no lk kn np nq lo kr nr ns ls nt bi translated">4.创建我们的子组件</h2><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="a02b" class="md kx iq lz b gy me mf l mg mh">class ChildComponent extends React.Component {<br/>    render() {<br/>        return &lt;h1&gt;<br/>            From Child Component: {this.props.message}<br/>        &lt;/h1&gt;<br/>    }<br/>}</span></pre><p id="4cb2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在上一步中，我们将<code class="fe mu mv mw lz b">message=this.state.message</code>作为道具传递给了<code class="fe mu mv mw lz b">ChildComponent</code>。我们可以使用<code class="fe mu mv mw lz b">this.prop.message</code>语法访问属性<code class="fe mu mv mw lz b">message</code>(从<code class="fe mu mv mw lz b">Parent</code>组件)。</p><p id="ac8c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">注意:<code class="fe mu mv mw lz b">message={this.state.message}</code>中的<code class="fe mu mv mw lz b">message</code>在父级中，component 可以是任何其他变量，不一定是<code class="fe mu mv mw lz b">message</code>。我可以做<code class="fe mu mv mw lz b">words={this.state.message}</code>，只要我记得在子组件中使用<code class="fe mu mv mw lz b">words</code>。</p><h2 id="9905" class="md kx iq bd ky nj nk dn lc nl nm dp lg kj nn no lk kn np nq lo kr nr ns ls nt bi translated">5.记得导出</h2><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="f770" class="md kx iq lz b gy me mf l mg mh">export default Parent</span></pre><p id="22b1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此时，如果我们使用<code class="fe mu mv mw lz b">npm start</code>运行我们的应用程序，我们应该会看到:</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/a3c22ef3b496bc3e7a512c87102430ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h4Z6pwjv9-XiycBBdwdxTg.png"/></div></div><figcaption class="nd ne gj gh gi nf ng bd b be z dk translated">我们的应用</figcaption></figure><h1 id="0072" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">Github 知识库以供参考</h1><div class="nw nx gp gr ny nz"><a href="https://github.com/zlliu246/react_examples/tree/pass-async-data-to-child" rel="noopener  ugc nofollow" target="_blank"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd ir gy z fp oe fr fs of fu fw ip bi translated">GitHub-zlliu 246/react _ pass-async-data-to-child 示例</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">这个项目是用 Create React App 引导的。在项目目录中，您可以运行:在…中运行应用程序</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">github.com</p></div></div><div class="oi l"><div class="oj l ok ol om oi on jw nz"/></div></div></a></div><h1 id="d8fc" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">将异步数据从父传递到子，然后从子传递到孙</h1><p id="c421" class="pw-post-body-paragraph jy jz iq ka b kb ml kd ke kf mm kh ki kj oo kl km kn op kp kq kr oq kt ku kv ij bi translated">万一你们都需要这个例子——我们之前代码的一个简短扩展，但是有一个稍微不同的变量名</p><figure class="lu lv lw lx gt jr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="1ce8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们运行<code class="fe mu mv mw lz b">npm start</code>，我们应该会看到这样的内容:</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi or"><img src="../Images/d70336b70b28bad06ed3fd21e8b0fe4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*foYTPDc8S2X5D1yZS-cxOQ.png"/></div></div></figure><h1 id="cdf7" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">一些最后的话</h1><p id="444c" class="pw-post-body-paragraph jy jz iq ka b kb ml kd ke kf mm kh ki kj oo kl km kn op kp kq kr oq kt ku kv ij bi translated">如果符合以下条件，本条将达到其目的:</p><ol class=""><li id="f2ba" class="mj mk iq ka b kb kc kf kg kj os kn ot kr ou kv mq mr ms mt bi translated">您想知道如何将异步数据从父组件传递到子组件</li><li id="68c5" class="mj mk iq ka b kb mx kf my kj mz kn na kr nb kv mq mr ms mt bi translated">你正在与当前的网上例子作斗争(我发誓，做同样的事情有这么多奇怪的不同方法)</li><li id="c2fe" class="mj mk iq ka b kb mx kf my kj mz kn na kr nb kv mq mr ms mt bi translated">你偶然发现了这篇文章，并设法解决了它</li></ol><p id="934b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">希望这是有用的！</p><h1 id="58f7" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">结论</h1><p id="1660" class="pw-post-body-paragraph jy jz iq ka b kb ml kd ke kf mm kh ki kj oo kl km kn op kp kq kr oq kt ku kv ij bi translated"><em class="mi">如果这篇文章有价值，并且你希望支持我成为一名作家，请考虑注册一个 Medium 会员——每月 5 美元，你可以无限制地阅读 Medium 上的故事。如果你注册使用我的链接，我会赚一小笔佣金。</em></p><p id="a2d5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae nv" href="https://zl-liu.medium.com/membership" rel="noopener"> <strong class="ka ir"> <em class="mi">点击此处无限制访问媒体</em> </strong> </a></p><p id="b4bd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你希望在我发布时得到通知，请考虑加入我的电子邮件列表。</p><div class="nw nx gp gr ny nz"><a href="https://zl-liu.medium.com/subscribe" rel="noopener follow" target="_blank"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd ir gy z fp oe fr fs of fu fw ip bi translated">每当 Zlliu 发布时收到一封电子邮件。</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">每当 Zlliu 发布时收到一封电子邮件。注册后，如果您还没有中型帐户，您将创建一个…</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">zl-liu.medium.com</p></div></div><div class="oi l"><div class="ov l ok ol om oi on jw nz"/></div></div></a></div></div></div>    
</body>
</html>