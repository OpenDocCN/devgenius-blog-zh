<html>
<head>
<title>Are JavaScript Object Properties Ordered?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript 对象属性是有序的吗？</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/are-javascript-object-properties-ordered-c30597754e5c?source=collection_archive---------4-----------------------#2022-06-10">https://blog.devgenius.io/are-javascript-object-properties-ordered-c30597754e5c?source=collection_archive---------4-----------------------#2022-06-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a5ad" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">它与地图对象有何不同？</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/eacf34f05b0b2191bad6ed64df030eb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0l14sisg596zNhpn"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com/@markusspiske?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Markus Spiske </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="f580" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最近有人问我，JavaScript 对象属性一定是无序的、不可预测的吗？</p><p id="b963" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">早期接触 JavaScript 的开发人员可能会回答说<code class="fe ls lt lu lv b">Object.keys()</code>或<code class="fe ls lt lu lv b">for...in</code>会返回不可预测的对象属性顺序。</p><p id="5ec8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但现在还是这样吗？</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><p id="db7a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如你所料，现在有规则可循了。</p><p id="e807" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从 ECMAScript 2020 开始，<code class="fe ls lt lu lv b">Object.keys</code>、<code class="fe ls lt lu lv b">for...in</code>、<code class="fe ls lt lu lv b">Object.getOwnPropertyNames</code>和<code class="fe ls lt lu lv b">Reflect.ownKeys</code>都遵循相同的规范顺序。它们是:</p><h1 id="da3b" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">1.自己的属性是数组索引，按数字索引升序排列</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mv"><img src="../Images/677714f96eeec111a9a33ccf24e32985.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kwQgeZv6ElR2LAaL6A-Akw.png"/></div></div></figure><pre class="kg kh ki kj gt mw lv mx my aw mz bi"><span id="aa03" class="na me iq lv b gy nb nc l nd ne">const obj = {<br/>  100: 100,<br/>  '2': 2,<br/>  12: 12,<br/>  '0': 0,<br/>};</span><span id="581e" class="na me iq lv b gy nf nc l nd ne">// The following results are all `[ '0', '2', '12', '100' ]`<br/>console.log(Object.keys(obj));<br/>console.log(Object.getOwnPropertyNames(obj));<br/>console.log(Reflect.ownKeys(obj));<br/>for (const key in obj) {<br/>  console.log('key: ', key);<br/>}</span></pre><p id="680c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">数组索引是一个字符串值属性键，它是一个规范的数字字符串。一个<a class="ae kv" href="http://www.ecma-international.org/ecma-262/10.0/#sec-canonicalnumericindexstring" rel="noopener ugc nofollow" target="_blank">规范的数字串</a>是一个由<code class="fe ls lt lu lv b">ToString</code>产生的数字的字符串表示，或者说是字符串“-0”。例如，“012”是<em class="ng">而不是</em>一个规范的数字字符串，但是“12”是。</p><h1 id="bbc6" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">2.其他自己的字符串属性，按属性创建的时间升序排列</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nh"><img src="../Images/b15b2093666655125de92b514e3cb23c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kk4x5ssqJFqxX1h6lmD3Og.png"/></div></div></figure><pre class="kg kh ki kj gt mw lv mx my aw mz bi"><span id="7545" class="na me iq lv b gy nb nc l nd ne">const obj = {<br/>  a: 'a',<br/>};</span><span id="8fa5" class="na me iq lv b gy nf nc l nd ne">obj.b = 'b';</span><span id="5f88" class="na me iq lv b gy nf nc l nd ne">setTimeout(() =&gt; {<br/>  obj.c = 'c';<br/>});</span><span id="6f3b" class="na me iq lv b gy nf nc l nd ne">obj.d = 'd';</span><span id="e1ec" class="na me iq lv b gy nf nc l nd ne">// The following results are all `[ 'a', 'b', 'd' ]`<br/>console.log(Object.keys(obj));<br/>console.log(Object.getOwnPropertyNames(obj));<br/>console.log(Reflect.ownKeys(obj));<br/>for (const key in obj) {<br/>  console.log('key: ', key);<br/>}</span></pre><p id="8e36" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上面的代码增加了事件循环的知识点。因为<code class="fe ls lt lu lv b">setTimeout</code>是一个异步宏任务，所以在输出<code class="fe ls lt lu lv b">console.log</code>时<code class="fe ls lt lu lv b">c</code>属性还没有添加到<code class="fe ls lt lu lv b">obj</code>中。</p><h1 id="3b5e" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">3.拥有符号属性，按属性创建的时间升序排列</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/edbb252bbf7d28e5e12bdfeb36cb4193.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bYWJEAO9N4apSYPwVkvL_Q.png"/></div></div></figure><pre class="kg kh ki kj gt mw lv mx my aw mz bi"><span id="0eeb" class="na me iq lv b gy nb nc l nd ne">const obj = {<br/>  [Symbol('a')]: 'a',<br/>  [Symbol.for('b')]: 'b',<br/>};</span><span id="2386" class="na me iq lv b gy nf nc l nd ne">obj[Symbol('c')] = 'c';</span><span id="7d16" class="na me iq lv b gy nf nc l nd ne">console.log(Object.keys(obj)); // []<br/>console.log(Object.getOwnPropertyNames(obj)); // []<br/>console.log(Reflect.ownKeys(obj)); // [ Symbol(a), Symbol(b), Symbol(c) ]<br/>for (const key in obj) {<br/>  console.log('key: ', key); // No output<br/>}<br/>// [ Symbol(a), Symbol(b), Symbol(c) ]<br/>console.log(Object.getOwnPropertySymbols(obj));</span></pre><p id="71f0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Symbol 属性与 String 属性相同，按属性创建的时间升序排列。但是<code class="fe ls lt lu lv b">Object.keys</code>、<code class="fe ls lt lu lv b">for...in</code>、<code class="fe ls lt lu lv b">Object.getOwnPropertyNames</code>方法不能获取对象的符号属性，<code class="fe ls lt lu lv b">Reflect.ownKeys</code>和<code class="fe ls lt lu lv b">Object.getOwnPropertySymbols</code>可以。</p><h1 id="75fc" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">结论</h1><p id="b006" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">当对象的属性键是上述类型的组合时，对象的非负整数键(可枚举和不可枚举)首先按升序添加到数组中，然后按插入顺序添加字符串键。最后，按插入顺序添加符号键。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/b269aee4dac3b1c93205861f783ac423.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_7cP22dpC-LcrG_JLx0xkA.png"/></div></div></figure><pre class="kg kh ki kj gt mw lv mx my aw mz bi"><span id="d3c8" class="na me iq lv b gy nb nc l nd ne">const obj = {<br/>  100: 100,<br/>  0: 0,<br/>  a: 'a',<br/>  [Symbol('a')]: 'a',<br/>};</span><span id="8641" class="na me iq lv b gy nf nc l nd ne">obj[Symbol.for('b')] = 'b';<br/>obj.b = 'b';</span><span id="62ed" class="na me iq lv b gy nf nc l nd ne">console.log(Object.keys(obj)); // [ '0', '100', 'a', 'b' ]<br/>console.log(Object.getOwnPropertyNames(obj)); // [ '0', '100', 'a', 'b' ]<br/>console.log(Reflect.ownKeys(obj)); // [ '0', '100', 'a', 'b', Symbol(a), Symbol(b) ]<br/>for (const key in obj) {<br/>  console.log('key: ', key); // '0' '100' 'a' 'b'<br/>}<br/>// [ Symbol(a), Symbol(b) ]<br/>console.log(Object.getOwnPropertySymbols(obj));</span></pre><p id="16b7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是如果您强烈依赖于插入顺序，那么<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map" rel="noopener ugc nofollow" target="_blank"> Map </a>会为您保证这一点。</p><h1 id="89e7" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">参考</h1><p id="4074" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">[1]https://v8.dev/blog/fast-properties<a class="ae kv" href="https://v8.dev/blog/fast-properties" rel="noopener ugc nofollow" target="_blank"/></p><p id="aed7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">[2]<a class="ae kv" href="https://262.ecma-international.org/10.0/#sec-ordinaryownpropertykeys" rel="noopener ugc nofollow" target="_blank">https://262 . ECMA-international . org/10.0/# sec-ordinaryownpropertykeys</a></p><p id="fa81" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">[3]<a class="ae kv" href="https://262.ecma-international.org/7.0/#sec-object.keys" rel="noopener ugc nofollow" target="_blank">https://262.ecma-international.org/7.0/#sec-object.keys</a></p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><p id="a38b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ng">感谢阅读。如果你喜欢这样的故事，想支持我，请考虑成为</em> <a class="ae kv" href="https://medium.com/@islizeqiang/membership" rel="noopener"> <em class="ng">中会员</em> </a> <em class="ng">。每月 5 美元，你可以无限制地访问媒体内容。如果你通过</em> <a class="ae kv" href="https://medium.com/@islizeqiang/membership" rel="noopener"> <em class="ng">我的链接</em> </a> <em class="ng">报名，我会得到一点佣金。</em></p><p id="6197" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你的支持对我来说非常重要——谢谢。</p></div></div>    
</body>
</html>