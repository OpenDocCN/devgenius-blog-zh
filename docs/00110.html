<html>
<head>
<title>Dissecting the DTO pattern</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">剖析DTO模式</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/dissecting-the-dto-pattern-ac3e54d0e4c8?source=collection_archive---------0-----------------------#2020-01-30">https://blog.devgenius.io/dissecting-the-dto-pattern-ac3e54d0e4c8?source=collection_archive---------0-----------------------#2020-01-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/0a29aa27c8efe040b5c23571257cbe45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*X1aRXgGtGihd3SvH.png"/></div></div></figure><p id="ba9b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">DTO模式是数据传输对象模式。这是一个非常古老的模式，我相信它起源于J2EE(现在的Java EE)。</p><p id="94d1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我不认为人们像他们那样完全理解这种模式。我也不知道。我这样说的原因是因为我看到其他人在许多不同的地方使用它，我也是！</p><p id="a977" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以我在想，使用这种模式的正确方法或地方是什么？到底有没有正确的方法？</p><p id="14ac" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对我来说，我喜欢从字面上理解这个模式的含义。</p><p id="bd4e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它被称为DTO——是数据传输对象的首字母缩写。所以我把它理解为一个可以用来传输数据的物体。即其中包含可以在各处传递的数据的对象。</p><p id="9516" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">听起来很简单，对吗？</p><p id="f514" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">嗯……我不认为它像看起来那么简单。</p><p id="ec9c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">从历史上看，J2EE指定它的方式是使用这个“DTO”来捕获使用DAO(数据访问对象—是的，另一种模式)从数据库表中检索的数据。DAO将通过JDBC调用数据库，并将它获得的数据存储在一个对象(DTO)中，然后将该对象发送回所谓的“业务层”/“服务层”——不管它是什么术语——以供使用。</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/ac7472547edb4940fe6a34e38c161c11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vwUfsXkMq-xaYZt3L1LQPw.png"/></div></div></figure><p id="3380" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用这种方法的人通常认为这是唯一应该使用DTO的地方。</p><p id="89c2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然而，除此之外，我还见过许多其他用例。</p><p id="02a4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">DTO的另一个常见用途是将其用作Rest资源模型对象或“请求”对象。在一个典型的Java Spring Boot web应用程序中，您定义了“Rest控制器”,也定义了代表您所请求的请求的“Rest模型对象”。</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi la"><img src="../Images/e555b73bb216286fc0eabfa2808576b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nagnIdMPZGZWOmZIDgEn5Q.png"/></div></div></figure><p id="1a1b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Rest资源将DTO传递给下面的服务层中的服务对象，以便以它希望的任何方式使用DTO(通常，从它那里提取数据来进行所需的某些计算)。</p><p id="1e40" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">就我个人而言，我不喜欢在Rest资源对象中使用“DTO”——或者更具体地说，在Rest资源对象中使用“DTO”的命名。从心理上来说，我喜欢对我们在某些层面上交互的对象有一个清晰的定义。因此，在这种情况下，我宁愿将REST资源使用的这些对象命名为“资源对象”，或者更明确地根据它们在Rest交互中的使用位置命名为“请求对象”或“响应对象”。我见过很多项目使用这些命名约定。也许他们毕竟是dto，这纯粹是一个命名的问题。</p><p id="fc1f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一切都不是问题。问题就这样开始出现了，有些开发人员争论说d to只属于DAO(特别是那些来自非常强大的传统J2EE背景的开发人员),而其他开发人员每次需要开发新的API端点方法时，他们都会大喊“哦，我们需要一个DTO来建模‘请求/响应’等等”</p><p id="9a21" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在涉及到MOM(面向消息的中间件)的地方，比如RabbitMQ、Kafka、ActiveMQ或任何其他消息系统，人们也利用dto在不同的应用程序/系统之间共享。</p><p id="31a7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这种模式下，dto将被打包到一个称为“共享库”的独立项目中。每个应用程序项目都会将共享库作为依赖项导入到它们的项目中。</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lb"><img src="../Images/beef9c0b054f3776137794ad4f26a457.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*me-pimwgwtE7ahFZ7xofSQ.png"/></div></div></figure><p id="ee7b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，这是有道理的，也是符合逻辑的。</p><p id="a158" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然而，稍微偏离一下，dto在理想情况下应该是不可变的。特别是如果你从字面上理解DTO的意思，那么你不会希望你的传输对象在传输过程中被篡改。在JavaBeans风格的对象建模中，你有getter/setter，我们知道我们可以用setter做什么！</p><p id="41f9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但这导致了另一个问题。实现不变性的一个方法是去掉setters以避免私有内部数据字段被设置。然而，当您使用Jackson进行JSON对象编组/解编组时(因为您希望您的用户请求使用JSON，并且您以JSON格式提供您的数据),您不能真正摆脱您的setters。Jackson研究JavaBeans约定。</p><p id="ccd0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在回到我在的地方…</p><p id="834b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你看到我的难题了吗？</p><p id="e266" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我认为最初这种模式的发明者对它应该用在哪里有自己的想法，但是随着软件开发的发展，它已经有了多种有效的用法。</p><p id="0859" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我的总体观点是，只要它用于将数据从一个地方传输到另一个地方，那么不管它在哪里使用，它都是完全可以接受的用例。</p></div></div>    
</body>
</html>