<html>
<head>
<title>Spring Boot Security Configuration, practically explained â€” Part5: From WebSecurityConfigurerAdapter to SecurityFilterChain</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Spring Boot å®‰å…¨é…ç½®å®ç”¨è®²è§£ç¬¬äº”éƒ¨åˆ†:ä» WebSecurityConfigurerAdapter åˆ° SecurityFilterChain</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://blog.devgenius.io/spring-boot-security-configuration-practically-explained-part5-from-bfb87adc1a58?source=collection_archive---------0-----------------------#2022-12-19">https://blog.devgenius.io/spring-boot-security-configuration-practically-explained-part5-from-bfb87adc1a58?source=collection_archive---------0-----------------------#2022-12-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="4e80" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä»¥ä¸€ç§ç®€å•æ˜“æ‡‚çš„æ–¹å¼ï¼Œä»è¿‡æ—¶çš„ WebSecurityConfigurerAdapter ä¼ é€’åˆ°æ–°çš„åŸºäºç»„ä»¶(åŸºäº bean)çš„å®‰å…¨é…ç½®ã€‚</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/9e8465a34b81bb43452995a5bd952f6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FQuuhA2lK7UWXG4HfRYKBw.png"/></div></div></figure><p id="e2f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™æ˜¯æˆ‘å…³äºæ˜¥å­£å®‰å…¨ç³»åˆ—æ–‡ç« çš„ç¬¬äº”ç¯‡ã€‚æ‰€æœ‰ä»¥å‰çš„å¸–å­éƒ½è®¨è®ºäº†åŸºäºæ‰©å±• WebSecurityConfigurerAdapter çš„è‡ªå®šä¹‰ç±»å®ç°çš„ç¤ºä¾‹è‡ªå®šä¹‰ã€‚ç„¶è€Œï¼Œè‡ªä» Spring Security 5 . 7 . 0-M2 ä¹‹åï¼Œå¹¿æ³›ä½¿ç”¨çš„ WebSecurityConfigurerAdapter å°±ä¸å†æ˜¯è¿™æ ·äº†ï¼Œå®ƒå·²ç»è¢«å¼ƒç”¨äº†ã€‚</p><p id="a0a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å› æ­¤ï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°å¦‚ä½•åœ¨ä¸ä½¿ç”¨ WebSecurityConfigurerAdapter çš„æƒ…å†µä¸‹è¿›è¡Œè¿™æ ·çš„å®‰å…¨å®šåˆ¶ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†é€šè¿‡ä¸€ä¸ª<strong class="jp ir"> SecurityFilterChain </strong> bean æ¥è®¨è®º<strong class="jp ir">å®šåˆ¶å®‰å…¨é…ç½®</strong>ï¼Œä»¥åŠè¿›ä¸€æ­¥çš„å®šåˆ¶ï¼Œä¾‹å¦‚æ·»åŠ ä¸€ä¸ª<strong class="jp ir">è¿‡æ»¤å™¨</strong>å’Œä½¿ç”¨ä¸€ä¸ª<strong class="jp ir">åŸºäº DSL çš„é…ç½®å™¨</strong>ã€‚</p><blockquote class="kx ky kz"><p id="ec85" class="jn jo la jp b jq jr js jt ju jv jw jx lb jz ka kb lc kd ke kf ld kh ki kj kk ij bi translated">æ³¨æ„:ç”±äº WebSecurityConfigurerAdapter è¢«å¹¿æ³›ä½¿ç”¨ï¼Œå³ä½¿æ²¡æœ‰æ¼äººçš„è­¦å‘Š(é»„è‰²ä¸‹åˆ’çº¿),ä»ç„¶æœ‰äººå¯ä»¥ä¾èµ–å®ƒã€‚é˜…è¯»ä¸‹é¢å…³äºå¦‚ä½•åº”å¯¹çš„å¸–å­ã€‚</p></blockquote><div class="le lf gp gr lg lh"><a href="https://medium.com/@zzpzaf.se/spring-boot-security-the-websecurityconfigureradapter-is-not-the-case-anymore-e8af5cceef7e" rel="noopener follow" target="_blank"><div class="li ab fo"><div class="lj ab lk cl cj ll"><h2 class="bd ir gy z fp lm fr fs ln fu fw ip bi translated">Spring Boot å®‰å…¨:WebSecurityConfigurerAdapter ä¸å†æ˜¯è¿™æ ·äº†</h2><div class="lo l"><h3 class="bd b gy z fp lm fr fs ln fu fw dk translated">å½“æ‚¨æƒ³è¦ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„ Spring Boot è‡ªå®šä¹‰æ‚¨çš„å®‰å…¨é…ç½®æ—¶ï¼Œè¯·åŠ¡å¿…å°å¿ƒã€‚</h3></div><div class="lp l"><p class="bd b dl z fp lm fr fs ln fu fw dk translated">medium.com</p></div></div><div class="lq l"><div class="lr l ls lt lu lq lv kv lh"/></div></div></a></div><h1 id="c2ae" class="lw lx iq bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">ä» WebSecurityConfigurerAdapter åˆ° SecurityFilterChain</h1><p id="0261" class="pw-post-body-paragraph jn jo iq jp b jq mu js jt ju mv jw jx jy mw ka kb kc mx ke kf kg my ki kj kk ij bi translated">å›åˆ°åŸºäº<strong class="jp ir">WebSecurityConfigurerAdapter çš„æŠ½è±¡ç±»çš„å®ç°ï¼Œ</strong>å›æƒ³ä¸€ä¸‹ï¼Œå¿…é¡»åˆ›å»ºä¸€ä¸ªæ‰©å±•å®ƒçš„è‡ªå®šä¹‰ç±»ï¼Œå› æ­¤ä»–/å¥¹å¿…é¡»é€šè¿‡è¦†ç›–å®ƒçš„ä¸¤ä¸ªé‡è¦å¥‘çº¦æ–¹æ³•æ¥å·¥ä½œ:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mz"><img src="../Images/ecbbcb9bac646e8e646a0b71f85e19bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pgZtjwX4g2rpGfcs.png"/></div></div></figure><p id="349d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™ä¸¤ç§æ–¹æ³•åªä¸è¿‡æ˜¯å…è®¸æˆ‘ä»¬å®šåˆ¶é€‚åˆæˆ‘ä»¬é¡¹ç›®éœ€æ±‚çš„ Spring Boot å®‰å…¨æ€§çš„â€œ<strong class="jp ir">é…ç½®å™¨â€ã€‚</strong></p><p id="d2fa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸‹é¢æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„å®šåˆ¶ç¤ºä¾‹ï¼Œç”¨äºåœ¨ HTTP åŸºæœ¬èº«ä»½éªŒè¯çš„åŸºç¡€ä¸Šä¿æŠ¤ REST APIï¼Œå¹¶ä¸”åªä½¿ç”¨å†…å­˜ä¸­çš„èº«ä»½éªŒè¯æä¾›ç¨‹åºã€‚</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="2a40" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">WebSecurityConfigurerAdapter çš„ä¸¤ä¸ªè¢«è¦†ç›–çš„æ–¹æ³•éƒ½ç”¨äºåœ¨ Spring å®‰å…¨ä¸Šä¸‹æ–‡ä¸­å½¢æˆå¿…è¦çš„<strong class="jp ir">bean</strong>ã€‚</p><p id="a7a4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç°åœ¨ï¼Œæ³¨æ„å½“æˆ‘ä»¬ä½¿ç”¨ WebSecurityConfigurerAdapter æ—¶ï¼Œåªæœ‰ HttpSecurity é…ç½®å™¨å¿…é¡»è¢«è¦†ç›–ã€‚å¦ä¸€ä¸ªæ˜¯ AuthenticationManager çš„é…ç½®å™¨(å®ƒå®é™…ä¸Šç”¨äºé…ç½® AuthenticationManagerBuilder ä»¥æ„å»ºå’Œè¿”å› AuthenticationManager)ï¼Œå¯ä»¥ä½œä¸º bean (é€šè¿‡@Bean æ³¨é‡Šçš„æ–¹æ³•)å®ç°<strong class="jp ir">ï¼Œå³ä½¿æˆ‘ä»¬ä½¿ç”¨ WebSecurityConfigurerAdapterã€‚ç»“æœç»å¯¹æ˜¯ä¸€æ ·çš„ã€‚å› æ­¤ï¼Œåœ¨å‰é¢ä»£ç ç¤ºä¾‹çš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åš:</strong></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="0546" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">HttpSecurity é…ç½®å™¨è´Ÿè´£ä¿æŠ¤æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºçš„ URL è·¯å¾„å’Œç«¯ç‚¹ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¿æŠ¤â€œapi/itemsâ€ç«¯ç‚¹ï¼Œæˆ‘ä»¬è¿™æ ·åšçš„æ–¹å¼æ˜¯ä½¿ç”¨ HTTP åŸºæœ¬è®¤è¯æ ‡å‡†(é€šè¿‡ä¸€å¯¹ç”¨æˆ·åå’Œå¯†ç )ã€‚</p><p id="7404" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¯·æ³¨æ„ï¼Œä»¥@Bean çš„å½¢å¼æä¾› AuthenticationManagerï¼Œä½¿å…¶å¯¹æ•´ä¸ªåº”ç”¨ç¨‹åºå’Œä»»ä½•é€šè¿‡ http å®‰å…¨æ€§ä¿æŠ¤çš„ç«¯ç‚¹éƒ½æ˜¯å…¨å±€å¯ç”¨çš„ã€‚æ‰€ä»¥ï¼Œä¸Šé¢ä¾‹å­ä¸­çš„è®¤è¯ç®¡ç†å™¨æ˜¯ä¸€ä¸ª<strong class="jp ir">å…¨å±€</strong>è®¤è¯ç®¡ç†å™¨ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å¯ä»¥ä½¿å®ƒç‰¹å®šäºæˆ‘ä»¬çš„å—ä¿æŠ¤ç«¯ç‚¹ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒè¢«è®¤ä¸ºæ˜¯ä¸€ä¸ª<strong class="jp ir">æœ¬åœ°</strong>èº«ä»½éªŒè¯ç®¡ç†å™¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªéœ€â€œé€šçŸ¥â€HttpSecurity é…ç½®å™¨ä½¿ç”¨ bean æ–¹æ³•ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å–æ¶ˆä¸Šé¢ä¾‹å­ä¸­æ³¨é‡Šè¡Œçš„æ³¨é‡Šã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ä» authManager()æ–¹æ³•ä¸­æ³¨é‡Šæ‰@Bean æ³¨é‡Šã€‚</p><h2 id="c74b" class="nc lx iq bd ly nd ne dn mc nf ng dp mg jy nh ni mk kc nj nk mo kg nl nm ms nn bi translated">è¿‡æ»¤å™¨é“¾</h2><p id="c2cd" class="pw-post-body-paragraph jn jo iq jp b jq mu js jt ju mv jw jx jy mw ka kb kc mx ke kf kg my ki kj kk ij bi translated">Spring å®é™…å¤„ç† HttpSecurity çš„æ–¹å¼æ˜¯é€šè¿‡è®¸å¤šå®‰å…¨è¿‡æ»¤å™¨ã€‚å®é™…ä¸Šï¼Œå®ƒåˆ›å»ºäº†ä¸€ä¸ªå®‰å…¨è¿‡æ»¤å™¨é“¾ã€‚è¿è¡Œåº”ç”¨ç¨‹åºæ—¶ï¼Œä»”ç»†æŸ¥çœ‹è°ƒè¯•æ§åˆ¶å°ä¸­çš„è¾“å‡º:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mz"><img src="../Images/8ed1fff7294babd2692a21a23048c55d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*nZiqN9BA9Pud1r4i.png"/></div></div></figure><p id="a4cc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼ŒSpring æ¡†æ¶æ¥å—äº†æˆ‘ä»¬å®šåˆ¶çš„å®‰å…¨é…ç½®ä¸­çš„è®¾ç½®ï¼Œå¹¶å°†å®ƒä»¬æ”¾å…¥è®¸å¤šé¢„å®šä¹‰çš„(é»˜è®¤)å®‰å…¨è¿‡æ»¤å™¨ä¸­ã€‚è¿™äº›è¿‡æ»¤å™¨çš„åˆ—è¡¨å®é™…ä¸Šæ˜¯ç”± Spring ç®¡ç†çš„è¿‡æ»¤å™¨çš„æœ‰åºåˆ—è¡¨ï¼Œæ‰€æœ‰è¿™äº›è¿‡æ»¤å™¨ç»„æˆäº†ä¸€ä¸ª<a class="ae no" href="https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/web/DefaultSecurityFilterChain.html" rel="noopener ugc nofollow" target="_blank">DefaultSecurityFilterChain</a>ã€‚(ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°é»˜è®¤çš„è¿‡æ»¤é¡ºåº<a class="ae no" href="https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/config/annotation/web/builders/HttpSecurity.html#addFilter(jakarta.servlet.Filter)" rel="noopener ugc nofollow" target="_blank">)ã€‚</a></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mz"><img src="../Images/2f6579c0c42d14ed31ccc60079cdbd47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jCk432eI6H_sSS64.png"/></div></div></figure><p id="2b87" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å› æ­¤ï¼ŒSpring æ”¯æŒçš„â€œæ–°â€å®‰å…¨æ–¹å¼æ˜¯ä½¿ç”¨æˆ‘ä»¬çš„è‡ªå®šä¹‰ http å®‰å…¨è¿‡æ»¤å™¨(åœ¨å®‰å…¨è¿‡æ»¤å™¨é“¾ä¸­)ï¼Œè€Œä¸æ˜¯é€šè¿‡å¿…é¡»æ‰©å±• WebSecurityConfigurerAdapter çš„ç±»æ¥é…ç½®å®ƒä»¬ã€‚æœ¬è´¨ä¸Šï¼ŒSpring å…è®¸æˆ‘ä»¬ä½¿ç”¨ bean æ–¹æ³•é…ç½®æˆ‘ä»¬çš„ HttpSecurityï¼Œè¯¥æ–¹æ³•æ„å»ºå¹¶è¿”å›æˆ‘ä»¬è‡ªå®šä¹‰çš„<a class="ae no" href="https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/web/SecurityFilterChain.html" rel="noopener ugc nofollow" target="_blank"> SecurityFilterChain </a>æ¥å£çš„å®ç°ã€‚</p><p id="ae74" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å®é™…ä¸Šï¼Œä½¿ç”¨ SecurityFilterChain bean å¹¶ä¸æ˜¯ä¸€ç§æ–°æ–¹æ³•ã€‚å®ƒä» Spring Security çš„ 3.1 ç‰ˆæœ¬å¼€å§‹å°±å­˜åœ¨äº†ï¼Œå¹¶è¢«ç”¨æ¥é…ç½®ä¸€ä¸ª<a class="ae no" href="https://docs.spring.io/spring-security/reference/servlet/architecture.html#servlet-filterchainproxy" rel="noopener ugc nofollow" target="_blank"> FilterChainProxy </a> beanã€‚(å¯ä»¥æ›´æ·±å…¥çš„<a class="ae no" href="https://www.javadevjournal.com/spring-security/spring-security-filters/" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>å’Œ<a class="ae no" href="https://docs.spring.io/spring-security/reference/servlet/architecture.html" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>)ã€‚å› æ­¤ï¼Œäººä»¬ç”šè‡³å¯ä»¥åœ¨ WebSecurityConfigurerAdapter è¢«å¼ƒç”¨ä¹‹å‰å®ç°å®ƒã€‚ç„¶è€Œï¼Œç°åœ¨ä¼¼ä¹ä½¿ç”¨ SecurityFilterChain bean æˆä¸ºå®˜æ–¹æ¨èå’Œæ”¯æŒçš„å”¯ä¸€æ–¹æ³•ã€‚</p><p id="c635" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">[æ³¨æ„:ç”±äºæˆ‘ä»¬å°†ä¸å†ä½¿ç”¨åºŸå¼ƒçš„ WebSecurityConfigurerAdapterï¼Œæ‚¨å¯ä»¥åˆ é™¤æˆ‘ä»¬é¡¹ç›®çš„ pom.xml æ–‡ä»¶ä¸­ä»»ä½•ä»¥å‰ç‰ˆæœ¬çš„â€œspring-boot-starter-securityâ€ä¾èµ–é¡¹ã€‚è€Œä¸”æˆ‘ä»¬å¯ä»¥æŠŠâ€œspring-boot-starter-parentâ€å‡çº§åˆ° 2.7.6 ç‰ˆæœ¬(ä¸æ˜¯ 3.0.0ã€‚è¿˜æ²¡)]ã€‚</p><p id="d33b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‚¨å¯ä»¥åœ¨å®˜æ–¹æ–‡æ¡£<a class="ae no" href="https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/config/annotation/web/builders/HttpSecurity.html#authenticationManager%25org.springframework.security.authentication.AuthenticationManager%29" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>ä¸­æ‰¾åˆ°å®ç°è¿™ç§å®‰å…¨è¿‡æ»¤é“¾ bean çš„ç®€å•ç¤ºä¾‹ã€‚è¯¥ç¤ºä¾‹ä»…åŒ…å«ä¸¤ä¸ªå¿…éœ€çš„ beansï¼Œä¸€ä¸ªç”¨äº SecurityFilterChainï¼Œå¦ä¸€ä¸ªæä¾›å†…å­˜ä¸­çš„ InMemoryUserDetailsManager/UserDetailsServiceã€‚</p><p id="d599" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½†æ˜¯ï¼Œæ ¹æ®ä¸Šé¢çš„æœ€åä¸€ä¸ªç¤ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªç±»ä¼¼äºä¸‹é¢çš„ CustomeSecurityConfiguration ç±»ï¼Œè¿™ä¸æˆ‘ä»¬ä¹‹å‰æ‰€åšçš„æ²¡æœ‰å¤ªå¤§åŒºåˆ«:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="d778" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¯·æ³¨æ„ï¼Œé™¤äº†ä½¿ç”¨å•ç‹¬çš„ AuthenticationManager æ–¹æ³•ä½œä¸º@Bean ä½¿å…¶å…¨å±€å¯ç”¨ä¹‹å¤–ï¼Œå®ƒè¿˜å…è®¸æˆ‘ä»¬åœ¨å°†æ¥æ·»åŠ æ›´å¤šçš„èº«ä»½éªŒè¯æä¾›è€…ã€‚</p><h1 id="7436" class="lw lx iq bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">å°† AuthenticationProvider ä¸ UserDetailsService å’Œ PasswordEncoder ä¸€èµ·ä½¿ç”¨ã€‚</h1><p id="f71f" class="pw-post-body-paragraph jn jo iq jp b jq mu js jt ju mv jw jx jy mw ka kb kc mx ke kf kg my ki kj kk ij bi translated">æ­£å¦‚æ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°çš„ï¼Œæˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨<a class="ae no" href="https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/in-memory.html" rel="noopener ugc nofollow" target="_blank"> inMemoryAuthentication </a>()ç»™å‡ºä»»ä½•ç”¨æˆ·è¯¦ç»†ä¿¡æ¯ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬è¿˜å¿…é¡»ä½¿ç”¨ UserDetailsServiceã€‚è¿™é¿å…äº†æˆ‘ä»¬é‡åˆ°ä»»ä½•ç”± Spring Boot é»˜è®¤è®¾ç½®å¼•èµ·çš„é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒSpring Security(æ²¡æœ‰ä»»ä½•å®‰å…¨å®šåˆ¶)åˆ›å»ºä¸€ä¸ª UserDetailsService beanï¼Œç”¨æˆ·åä¸ºâ€œuser â€,éšæœºç”Ÿæˆçš„å¯†ç è®°å½•åˆ°æ§åˆ¶å°ã€‚å› æ­¤ï¼Œæœ€å°å®šåˆ¶åº”è¯¥åŒ…æ‹¬ä¸€ä¸ªå®šåˆ¶çš„ UserDetailsServiceã€‚</p><p id="23c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å› æ­¤ï¼Œæ›´å¥½çš„æ–¹æ³•æ˜¯è®¾ç½®ä¸€ä¸ª<a class="ae no" href="https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/core/userdetails/UserDetailsService.html" rel="noopener ugc nofollow" target="_blank">ç”¨æˆ·è¯¦ç»†ä¿¡æ¯æœåŠ¡</a>ï¼Œä»¥åŠä¸€ä¸ª<a class="ae no" href="https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/crypto/password/PasswordEncoder.html" rel="noopener ugc nofollow" target="_blank">å¯†ç ç¼–ç </a>ã€‚ä¸‹é¢ï¼Œä½ å¯ä»¥æ‰¾åˆ°è¿™æ ·ä¸€ä¸ªä¾‹å­ï¼Œå®ƒä½¿ç”¨äº†ä¸€ä¸ªéå¸¸ç®€å•çš„<strong class="jp ir">å†…å­˜</strong> UserDetailsServiceã€‚</p><p id="5353" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬è¿˜ä½¿ç”¨ä¸€ä¸ªä¸<a class="ae no" href="https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/crypto/password/DelegatingPasswordEncoder.html" rel="noopener ugc nofollow" target="_blank">DelegatingPasswordEncoder</a>ä¸€èµ·å·¥ä½œçš„ PasswordEncoderã€‚</p><p id="6373" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†å·²å¼ƒç”¨çš„<a class="ae no" href="https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/crypto/password/NoOpPasswordEncoder.html" rel="noopener ugc nofollow" target="_blank"> NoOpPasswordEncoder </a>ï¼Œåªæ˜¯ä¸ºäº†<strong class="jp ir">æ¼”ç¤º</strong>çš„ç›®çš„ï¼Œæ‰€ä»¥æ‚¨å¯ä»¥ä½¿ç”¨æ³¨é‡Š@SuppressWarnings("deprecated ")æ¥å–æ¶ˆè­¦å‘Šã€‚</p><p id="ed13" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ­¤å¤–ï¼Œè™½ç„¶å¯ä»¥ä½¿ç”¨ä»»ä½•<a class="ae no" href="https://docs.spring.io/spring-security/site/docs/6.0.0/api/org/springframework/security/authentication/AuthenticationProvider.html" rel="noopener ugc nofollow" target="_blank"> AuthenticationProvider </a>ï¼Œä½†ä¸‹é¢çš„ç¤ºä¾‹ä½¿ç”¨äº†å¹¿æ³›ä½¿ç”¨çš„<a class="ae no" href="https://docs.spring.io/spring-security/site/docs/6.0.0/api/org/springframework/security/authentication/dao/DaoAuthenticationProvider.html" rel="noopener ugc nofollow" target="_blank">DaoAuthenticationProvider</a>ï¼Œå®ƒæ¥å—å¹¶å¯ç”¨äº UserdetailsService å’Œä»»ä½• PasswordEncoder çš„ä»»ä½•å®ç°ã€‚ç»¼ä¸Šæ‰€è¿°ï¼Œä¸‹é¢æ˜¯æ•´ä¸ªä¾‹å­:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="54d6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç”±äºæœ€è¿‘çš„ Spring å®‰å…¨ç‰ˆæœ¬æå€¡å¼€å‘äººå‘˜ä½¿ç”¨ lambdas(å®é™…ä¸Šæ˜¯<a class="ae no" href="https://spring.io/blog/2019/11/21/spring-security-lambda-dsl" rel="noopener ugc nofollow" target="_blank"> DSL lambdas </a>)ï¼Œä¸‹é¢çš„ç¤ºä¾‹æ˜¾ç¤ºäº†å¦‚ä½•ä½¿ç”¨ lambdas é‡å†™ä¸Šè¿° SecurityFilterChain bean çš„ http æˆæƒè¯·æ±‚:</p><pre class="km kn ko kp gt np nq nr bn ns nt bi"><span id="e2bb" class="nu lx iq nq b be nv nw l nx ny">. . .<br/>        @Bean<br/>        public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {<br/>                http.authorizeRequests((athReqs) -&gt; athReqs.antMatchers("/api/items").hasRole("USER"))<br/>             .httpBasic()<br/>             //.and().authenticationManager(authManager(http))<br/>             ;    <br/>             return http.build();<br/>        }<br/>. . .</span></pre><p id="a580" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä¸€åˆ‡é¡ºåˆ©ã€‚æˆ‘å¸Œæœ›æ‚¨å·²ç»ç†è§£äº†å¦‚ä½•ä»¥â€œæ–°çš„æ–¹å¼â€å¼€å§‹å®ç° Spring Securityã€‚<br/>åœ¨æ­¤æ‰¾åˆ°æœ€ç»ˆå›è´­<a class="ae no" href="https://github.com/zzpzaf/restapidemo_in-memory_security_FilterChain_bean" rel="noopener ugc nofollow" target="_blank">ã€‚</a></p><h2 id="6da0" class="nc lx iq bd ly nd ne dn mc nf ng dp mg jy nh ni mk kc nj nk mo kg nl nm ms nn bi translated">æœ¬åœ°èº«ä»½éªŒè¯ç®¡ç†å™¨ç‰ˆæœ¬</h2><p id="9a59" class="pw-post-body-paragraph jn jo iq jp b jq mu js jt ju mv jw jx jy mw ka kb kc mx ke kf kg my ki kj kk ij bi translated">ä¹‹å‰ï¼Œæˆ‘ä»¬å·²ç»è®¨è®ºäº†å…¨å±€å’Œæœ¬åœ°èº«ä»½éªŒè¯æä¾›è€…ã€‚å› æ­¤ï¼Œå¦‚æœæœ‰äººæƒ³è¦å®ç°ä¸€ä¸ª<strong class="jp ir">æœ¬åœ°</strong>èº«ä»½éªŒè¯ç®¡ç†å™¨ï¼Œä¸‹é¢çš„ä»£ç æ˜¾ç¤ºäº†å…ˆå‰çš„â€œCustomSecurityConfigurationâ€ç±»çš„æ›´æ–°ç‰ˆæœ¬ï¼Œå…¶ä¸­æˆ‘ä»¬å°†èº«ä»½éªŒè¯ç®¡ç†å™¨ç”¨ä½œæœ¬åœ°èº«ä»½éªŒè¯ç®¡ç†å™¨:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="na nb l"/></div></figure><h2 id="c50d" class="nc lx iq bd ly nd ne dn mc nf ng dp mg jy nh ni mk kc nj nk mo kg nl nm ms nn bi translated">é™„åŠ ä»£ç :ä½¿ç”¨ CustomAuthebticationProvider çš„å®‰å…¨é…ç½®â€œæ–°æ–¹å¼â€</h2><p id="37f5" class="pw-post-body-paragraph jn jo iq jp b jq mu js jt ju mv jw jx jy mw ka kb kc mx ke kf kg my ki kj kk ij bi translated">åœ¨æˆ‘ä¸‹é¢çš„å‰ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† CustomSecurityConfiguration ç±»æ¥æ‰©å±• WebSecurityConfigurerAdapterã€‚</p><div class="le lf gp gr lg lh"><a rel="noopener  ugc nofollow" target="_blank" href="/spring-boot-security-configuration-practically-explained-part4-custom-authentication-provider-7666bea0e13e"><div class="li ab fo"><div class="lj ab lk cl cj ll"><h2 class="bd ir gy z fp lm fr fs ln fu fw ip bi translated">Spring Boot å®‰å…¨é…ç½®ï¼Œå®ç”¨è®²è§£â€”ç¬¬ 4 éƒ¨åˆ†:è‡ªå®šä¹‰èº«ä»½éªŒè¯æä¾›è€…â€¦</h2><div class="lo l"><h3 class="bd b gy z fp lm fr fs ln fu fw dk translated">æ‘˜è¦</h3></div><div class="lp l"><p class="bd b dl z fp lm fr fs ln fu fw dk translated">blog.devgenius.io</p></div></div><div class="lq l"><div class="nz l ls lt lu lq lv kv lh"/></div></div></a></div><p id="9073" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å› æ­¤ï¼Œè¿™é‡Œçš„â€œé¢å¤–ä»£ç â€æ˜¯ CustomSecurityConfiguration ç±»çš„æ›´æ–°ç‰ˆæœ¬ï¼Œå®ƒéµå¾ª SecurityFilterChain å’Œ been-only æ–¹æ³•ï¼Œå¹¶ä¸”ä¹Ÿä½¿ç”¨ä»…å¸¦æœ‰ lambdas çš„å‡½æ•°æ ·å¼ã€‚åœ¨ä¸‹é¢æ‰¾åˆ°å®ƒ:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="na nb l"/></div></figure><h1 id="c04b" class="lw lx iq bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">ä½¿ç”¨åŸºäº DSL çš„å®šåˆ¶</h1><p id="673d" class="pw-post-body-paragraph jn jo iq jp b jq mu js jt ju mv jw jx jy mw ka kb kc mx ke kf kg my ki kj kk ij bi translated">åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæœ€åä½†åŒæ ·é‡è¦çš„ä¸€ç‚¹æ˜¯å…³äº<a class="ae no" href="https://en.wikipedia.org/wiki/Domain-specific_language" rel="noopener ugc nofollow" target="_blank"> DSL </a>(ç‰¹å®šé¢†åŸŸè¯­è¨€)ä»¥åŠæˆ‘ä»¬å¦‚ä½•ä½¿ç”¨åŸºäº DSL çš„é…ç½®å™¨ã€‚</p><h2 id="2f21" class="nc lx iq bd ly nd ne dn mc nf ng dp mg jy nh ni mk kc nj nk mo kg nl nm ms nn bi translated">DSLâ€”â€”å¸¦ Java çš„ç‰¹å®šé¢†åŸŸè¯­è¨€</h2><p id="0ec5" class="pw-post-body-paragraph jn jo iq jp b jq mu js jt ju mv jw jx jy mw ka kb kc mx ke kf kg my ki kj kk ij bi translated">å¾ˆå¯èƒ½ï¼Œä¸€ä¸ªä¸»è¦å¯ä»¥å¤„ç† DSL å’Œ Java çš„é¢†åŸŸæ˜¯<a class="ae no" href="https://docs.spring.io/spring-integration/docs/current/reference/html/index.html" rel="noopener ugc nofollow" target="_blank"> Spring Integration </a>(ä¾‹å¦‚æ¶ˆæ¯ä¼ é€’)ã€‚å°½ç®¡å¦‚æ­¤ï¼ŒåŸºäº DSL çš„å®šåˆ¶ä¼¼ä¹ä¹Ÿè·å¾—äº† Spring Security çš„ä¸€äº›æ¨å¹¿ã€‚</p><p id="5afd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸€èˆ¬æ¥è¯´ï¼Œæ‚¨åº”è¯¥çŸ¥é“ï¼Œåˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬åœ¨å®‰å…¨æ€§å®šåˆ¶ä¸­é‡åˆ°çš„ HTTPSecurity é…ç½®å™¨å’Œæ„å»ºå™¨éƒ½æ˜¯åŸºäºéµå¾ª DSL åŸåˆ™çš„å®ç°ç±»çš„ã€‚è¿™ç§åŸºäº DSL çš„ç±»é€šå¸¸ä½¿ç”¨å‡½æ•°å¼ç¼–ç¨‹é£æ ¼æ¥è°ƒç”¨ï¼Œä½¿å¾—é…ç½®è¿‡ç¨‹æ›´åŠ ç”¨æˆ·å‹å¥½ï¼Œå¹¶ä¸”æ›´æ¥è¿‘äººç±»è¯­è¨€ã€‚æ­¤å¤–ï¼ŒåŸºäº DSL çš„ç±»/é…ç½®å™¨å…è®¸æˆ‘ä»¬æ‰§è¡Œçš„æ¯ä¸ªå®šåˆ¶ï¼Œé€šå¸¸ä¼šå¯¼è‡´è¯¥é…ç½®å™¨çš„æ›´æ–°å®ä¾‹ï¼Œä»è€Œå…è®¸è¿›ä¸€æ­¥çš„å®šåˆ¶ã€‚</p><p id="4cb6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ·±å…¥ DSL æ¦‚å¿µè¶…å‡ºäº†æœ¬æ–‡çš„ç›®æ ‡ã€‚ä»»ä½•äººéƒ½å¯ä»¥åœ¨ç½‘ä¸Šæœç´¢ï¼Œæ‰¾åˆ°å‡ åä¸ªç›¸å…³çš„å¸–å­ã€‚åªæ˜¯ï¼Œä¸ºäº†æ‚¨çš„æ–¹ä¾¿ï¼Œæˆ‘é€‰æ‹©äº†ä¸€äº›ä¸é”™çš„æ–‡ç« ï¼Œæä¾›å®é™…çš„ä¾‹å­æ¥å¼€å§‹è¿™ä¸ªä¸»é¢˜ã€‚è¿™äº›æ˜¯é“¾æ¥:</p><ul class=""><li id="6846" class="oa ob iq jp b jq jr ju jv jy oc kc od kg oe kk of og oh oi bi translated"><a class="ae no" href="https://medium.zenika.com/builder-pattern-a-first-step-to-dsl-1f5645d3ec84" rel="noopener ugc nofollow" target="_blank">https://medium . zenika . com/builder-pattern-a-first-step-to-DSL-1f 5645 d3c 84</a></li><li id="fd7b" class="oa ob iq jp b jq oj ju ok jy ol kc om kg on kk of og oh oi bi translated"><a class="ae no" href="https://medium.com/the-kotlin-primer/domain-specific-languages-867f2790a700" rel="noopener">https://medium . com/the-kot Lin-primer/domain-specific-languages-867 f 2790 a700</a></li><li id="a79a" class="oa ob iq jp b jq oj ju ok jy ol kc om kg on kk of og oh oi bi translated"><a class="ae no" href="https://www.infoworld.com/article/2077891/scripting-jvm-languages-creating-dsls-in-java-part-3-internal-and-external-dsls.html" rel="noopener ugc nofollow" target="_blank">https://www . infoworld . com/article/2077891/scripting-JVM-languages-creating-dsls-in-Java-part-3-internal-and-external-dsls . html</a></li><li id="aaff" class="oa ob iq jp b jq oj ju ok jy ol kc om kg on kk of og oh oi bi translated"><a class="ae no" href="https://www.javacodegeeks.com/2013/06/creating-internal-dsls-in-java-java-8-adopting-martin-fowlers-approach.html" rel="noopener ugc nofollow" target="_blank">https://www . javacodegeeks . com/2013/06/creating-internal-DSL-in-Java-Java-8-adopting-Martin-fowlers-approach . html</a></li></ul><p id="7b61" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åœ¨åŒä¸€ä¸»é¢˜ä¸Šï¼Œæˆ‘è¿˜æƒ³æåˆ°ä¸€æœ¬éå¸¸æœ‰è¶£çš„ä¹¦â€œ<a class="ae no" href="https://www.manning.com/books/modern-java-in-action" rel="noopener ugc nofollow" target="_blank"> Modern Java in Action Lambdasï¼Œstreamsï¼Œfunctional and reactive programming</a>2018 å¹´ç¬¬äºŒç‰ˆï¼Œ<a class="ae no" href="https://www.manning.com/" rel="noopener ugc nofollow" target="_blank"> Manning </a> publicationsâ€ï¼Œç‰¹åˆ«æ˜¯ç¬¬åç« :â€œä½¿ç”¨ Lambdas çš„ç‰¹å®šé¢†åŸŸè¯­è¨€â€ã€‚</p><p id="8ce6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½†æ˜¯ï¼Œæˆ‘è®¤ä¸ºåœ¨ä¸‹é¢æä¾›ä¸€äº›ç¤ºä¾‹ä»£ç æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚</p><h2 id="0e55" class="nc lx iq bd ly nd ne dn mc nf ng dp mg jy nh ni mk kc nj nk mo kg nl nm ms nn bi translated">æˆ‘ä»¬è¦åšä»€ä¹ˆ</h2><p id="d860" class="pw-post-body-paragraph jn jo iq jp b jq mu js jt ju mv jw jx jy mw ka kb kc mx ke kf kg my ki kj kk ij bi translated">åŸºæœ¬ä¸Šï¼ŒæŒ‰ç…§å®˜æ–¹ç¤ºä¾‹<a class="ae no" href="https://docs.spring.io/spring-security/reference/servlet/configuration/java.html#jc-custom-dsls" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>æˆ–<a class="ae no" href="https://spring.io/blog/2022/02/21/spring-security-without-the-websecurityconfigureradapter" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>ï¼Œæˆ‘ä»¬å°†æŠŠæˆ‘ä»¬çš„è‡ªå®šä¹‰é…ç½®å™¨(=æˆ‘ä»¬çš„è‡ªå®šä¹‰ DSL ç±»)åº”ç”¨åˆ° SecurityFilterChain çš„ HttpSecurityã€‚ä½œä¸ºä¸€ä¸ªåŸºç¡€ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨æˆ‘å‰é¢æåˆ°çš„å¸–å­çš„æ›´æ–°å›è´­ï¼ŒåŸºäºä»¥å‰çš„â€œå¥–é‡‘ä»£ç â€ã€‚åœ¨è¿™é‡Œæ‰¾åˆ°å›è´­<a class="ae no" href="https://github.com/zzpzaf/restapidemo_mysql_jdbc-CustomAuthenticationProvider_FilterChain_demo_mysql_start" rel="noopener ugc nofollow" target="_blank">ã€‚</a></p><p id="6657" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åœ¨ç»§ç»­å®šåˆ¶ DSL ç±»ä¹‹å‰ï¼Œè®©æˆ‘ä»¬é¦–å…ˆåˆ¶ä½œä¸€ä¸ªå®šåˆ¶çš„å¤´è¿‡æ»¤å™¨ã€‚</p><h2 id="a83c" class="nc lx iq bd ly nd ne dn mc nf ng dp mg jy nh ni mk kc nj nk mo kg nl nm ms nn bi translated">è‡ªå®šä¹‰æ ‡é¢˜è¿‡æ»¤å™¨</h2><p id="bfc1" class="pw-post-body-paragraph jn jo iq jp b jq mu js jt ju mv jw jx jy mw ka kb kc mx ke kf kg my ki kj kk ij bi translated">æ­£å¦‚æˆ‘ä»¬å·²ç»è¯´è¿‡çš„ï¼ŒSpring å®é™…ä¸Šå¤„ç† HttpSecurity çš„æ–¹å¼æ˜¯é€šè¿‡è®¸å¤šå®‰å…¨è¿‡æ»¤å™¨ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬ä¹Ÿå¯ä»¥æ·»åŠ è‡ªå·±çš„è¿‡æ»¤å™¨ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªå®šåˆ¶çš„è¿‡æ»¤å™¨ï¼Œå®ƒå°†ä¸€ä¸ªå®šåˆ¶çš„å¤´æ·»åŠ åˆ°è¯·æ±‚çš„è¿”å›å“åº”ä¸­ï¼Œå…è®¸æˆ‘ä»¬é€šè¿‡è¿”å›çš„å¤´æä¾›æ›´å¤šçš„ä¿¡æ¯ã€‚</p><p id="ede4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿è¡Œä¸€ä¸ªåƒæˆ‘ä»¬å¼€å§‹çš„ repo è¿™æ ·çš„é¡¹ç›®ï¼Œæ‚¨å¯ä»¥åœ¨ç»ˆç«¯æˆ–è°ƒè¯•æ§åˆ¶å°ä¸­çœ‹åˆ° DefaultSecurityFilterChain ä¸­åº”ç”¨çš„æ‰€æœ‰è¿‡æ»¤å™¨ï¼Œå¹¶ä¸”æ‚¨å¯èƒ½ä¼šæ³¨æ„åˆ° BasicAuthenticationFilterã€‚</p><pre class="km kn ko kp gt np nq nr bn ns nt bi"><span id="6a2f" class="nu lx iq nq b be nv nw l oo ny">o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with [ <br/>org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@501760bd, <br/>org.springframework.security.web.context.SecurityContextPersistenceFilter@55a1effd, <br/>org.springframework.security.web.header.HeaderWriterFilter@468057f5, <br/>org.springframework.security.web.csrf.CsrfFilter@2b1cf627, <br/>org.springframework.security.web.authentication.logout.LogoutFilter@330be2b0, <br/>org.springframework.security.web.authentication.www.BasicAuthenticationFilter@2af908d9, &lt;---<br/>org.springframework.security.web.savedrequest.RequestCacheAwareFilter@3050b83d, <br/>org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@74ab6e3d, <br/>org.springframework.security.web.authentication.AnonymousAuthenticationFilter@5c1a251d, <br/>org.springframework.security.web.session.SessionManagementFilter@19c08f2c, <br/>org.springframework.security.web.access.ExceptionTranslationFilter@2819b1ad, <br/>org.springframework.security.web.access.intercept.FilterSecurityInterceptor@5504d510]</span></pre><p id="97cb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ­¤å¤–ï¼Œä½¿ç”¨ Postmanï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹å¸¦æœ‰å“åº”çš„é‚®ä»¶å¤´ã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°å¤´çš„æ•°é‡æ˜¯ 11:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mz"><img src="../Images/d9f715ccd15ab2b12e7fc20f4b659320.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JmGvZYgpVQswoxNJ.png"/></div></div></figure><p id="734f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åŸºæœ¬ä¸Šï¼Œå¯ä»¥é€šè¿‡å®ç°åŸºæœ¬çš„<a class="ae no" href="https://jakarta.ee/specifications/platform/9/apidocs/jakarta/servlet/filter" rel="noopener ugc nofollow" target="_blank"> Filter </a>æ¥å£æˆ–è€…æ‰©å±• Spring æä¾›çš„ä¸€ä¸ªâ€œç°æˆçš„â€å®ç°ç±»æ¥å®šåˆ¶è¿‡æ»¤å™¨ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†æ‰©å±•<a class="ae no" href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/filter/GenericFilterBean.html" rel="noopener ugc nofollow" target="_blank"> GenericFilterBean </a>ç±»(å®ƒå½“ç„¶å®ç°äº†è¿‡æ»¤å™¨æ¥å£)ã€‚</p><p id="74d7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸»è¦å·¥ä½œæ˜¯é€šè¿‡<strong class="jp ir">è¦†ç›–</strong>çš„<a class="ae no" href="https://jakarta.ee/specifications/platform/9/apidocs/jakarta/servlet/filter#doFilter(jakarta.servlet.ServletRequest,jakarta.servlet.ServletResponse,jakarta.servlet.FilterChain)" rel="noopener ugc nofollow" target="_blank"> doFilter() </a>æ–¹æ³•æ¥å®Œæˆçš„ï¼Œåœ¨è¯¥æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®<a class="ae no" href="https://jakarta.ee/specifications/platform/9/apidocs/jakarta/servlet/servletrequest" rel="noopener ugc nofollow" target="_blank">è¯·æ±‚</a>å’Œ<a class="ae no" href="https://jakarta.ee/specifications/platform/9/apidocs/jakarta/servlet/servletresponse" rel="noopener ugc nofollow" target="_blank">å“åº”</a> servlet å¯¹è±¡ï¼Œä»¥åŠ<a class="ae no" href="https://jakarta.ee/specifications/platform/9/apidocs/jakarta/servlet/filterchain" rel="noopener ugc nofollow" target="_blank">è¿‡æ»¤å™¨é“¾</a>å¯¹è±¡ã€‚å› æ­¤ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯è®¾ç½®è‡ªå®šä¹‰æ ‡é¢˜çš„åˆé€‚ä½ç½®ã€‚è®©æˆ‘ä»¬å°†è‡ªå®šä¹‰è¿‡æ»¤å™¨çš„ç±»å‘½åä¸ºâ€œCustomResponseHeaderFilterâ€ã€‚ä¸‹é¢ç»™å‡ºäº†ç¤ºä¾‹ä»£ç :</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="54ba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸‹ä¸€æ­¥æ˜¯åœ¨æˆ‘ä»¬çš„â€œCustomSecurityConfigurationâ€ç±»çš„ SecurityFilterChain bean ä¸­æ·»åŠ /åº”ç”¨å®ƒã€‚æˆ‘ä»¬å¯ä»¥å°†å®ƒæ·»åŠ åˆ°ä¸ BasicAuthenticationFilter ç›¸åŒçš„æ’åºä½ç½®ã€‚å› æ­¤ï¼Œbean çš„ä»£ç å˜æˆäº†:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="6e59" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿è¡Œé¡¹ç›®åï¼Œæ‚¨å¯ä»¥åœ¨ç»ˆç«¯æˆ–è°ƒè¯•æ§åˆ¶å°ä¸­æ£€æŸ¥è¾“å‡º:</p><pre class="km kn ko kp gt np nq nr bn ns nt bi"><span id="3f28" class="nu lx iq nq b be nv nw l oo ny"> o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with [<br/>org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@38524eae, <br/>org.springframework.security.web.context.SecurityContextPersistenceFilter@53eb7394, <br/>org.springframework.security.web.header.HeaderWriterFilter@31adeeb1, <br/>org.springframework.security.web.csrf.CsrfFilter@13708c79, <br/>org.springframework.security.web.authentication.logout.LogoutFilter@12941fd0, <br/>com.zzpzaf.restapidemo.Configuration.CustomResponseHeaderFilter@62729f4c, &lt;--------<br/>org.springframework.security.web.authentication.www.BasicAuthenticationFilter@7759829b, &lt;---<br/>org.springframework.security.web.savedrequest.RequestCacheAwareFilter@795e0fe5, <br/>org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@2758be19, <br/>org.springframework.security.web.authentication.AnonymousAuthenticationFilter@4d6b8bf4, <br/>org.springframework.security.web.session.SessionManagementFilter@446f2c24, <br/>org.springframework.security.web.access.ExceptionTranslationFilter@c94d175, <br/>org.springframework.security.web.access.intercept.FilterSecurityInterceptor@cc46e58]</span></pre><p id="f378" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åŒæ ·ï¼Œä½¿ç”¨ Postmanï¼Œæ‚¨è¿˜å¯ä»¥æ£€æŸ¥æˆ‘ä»¬çš„è‡ªå®šä¹‰æ ‡å¤´ç°åœ¨æ˜¯å¦å·²ç»æ·»åŠ åˆ°è¿”å›çš„æ ‡å¤´ä¸­(ç°åœ¨æ•°é‡æ˜¯ 12):</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mz"><img src="../Images/b34fe461fbf776951237904ccc466445.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*aEGBn9pmH0Hga4yR.png"/></div></div></figure><p id="345b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¥½çš„ã€‚æˆ‘ä»¬åšåˆ°äº†ã€‚ç°åœ¨è®©æˆ‘ä»¬æ›´è¿›ä¸€æ­¥ï¼Œçœ‹çœ‹æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨ä¸€ä¸ªå®šåˆ¶çš„ DSL ç±»æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚</p><p id="3442" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬å¯ä»¥å°†è‡ªå®šä¹‰ DSL ç±»å‘½åä¸ºâ€œcuctomdslslhttpsecurityconfigurationâ€ã€‚è¿™å°†æ˜¯æˆ‘ä»¬è‡ªå·±çš„å®šåˆ¶<strong class="jp ir">é…ç½®å™¨</strong>ï¼Œå®ƒåº”è¯¥åº”ç”¨äº SecurityFilterChain bean ä¸­çš„ HttpSecurity é…ç½®ï¼Œå› æ­¤å®ƒåº”è¯¥æ‰©å±•<a class="ae no" href="https://docs.spring.io/spring-security/site/docs/4.2.x/apidocs/org/springframework/security/config/annotation/web/configurers/AbstractHttpConfigurer.html" rel="noopener ugc nofollow" target="_blank"> AbstractHttpConfigurer </a>ã€‚</p><p id="718e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æŒ‰ç…§å®˜æ–¹ç¤ºä¾‹<a class="ae no" href="https://docs.spring.io/spring-security/reference/servlet/configuration/java.html#jc-custom-dsls" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œçš„</a>ï¼Œæˆ‘ä»¬çš„å®šåˆ¶ DSL ç¤ºä¾‹ä»£ç å¯ä»¥ç±»ä¼¼äºä¸‹é¢çš„ä»£ç :</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="2cb7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸»è¦å·¥ä½œæ˜¯åœ¨ configure()æ–¹æ³•ä¸­å®Œæˆçš„ï¼Œæˆ‘ä»¬åœ¨å…¶ä¸­è®¾ç½®å¹¶æ·»åŠ äº†ä¸€ä¸ªè¿‡æ»¤å™¨ï¼Œå³ CustomResponseHeaderFilter ç±»ã€‚å¦å¤–ï¼Œè¯·æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ª setter æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å…è®¸æˆ‘ä»¬å‘ä¸‹ä¼ é€’åˆ° CustomResponseHeader å¹¶è®¾ç½®å¤´åç§°å’Œå¤´å€¼ã€‚æ­¤å¤–ï¼Œæ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†å¦ä¸€ä¸ª httpSecurity é…ç½®ï¼Œåœ¨ init()æ–¹æ³•ä¸­ä½¿ HTTP ä¼šè¯æ— çŠ¶æ€ã€‚å› æ­¤ï¼Œæ²¡æœ‰å¿…è¦åœ¨ SecurityFilterChain bean çš„é…ç½®ä¸­è¿™æ ·åš(å°±åƒæˆ‘ä»¬ä¹‹å‰æ‰€åšçš„é‚£æ ·)ã€‚</p><p id="eaa7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å‡†å¤‡å°† cuctomdslslhttpsecurityconfigure ç±»åº”ç”¨äº SecurityFilterChain beanã€‚æˆ‘ä»¬é€šè¿‡ç®€å•åœ°â€œåº”ç”¨â€å®ƒæ¥åšåˆ°è¿™ä¸€ç‚¹:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="c92f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æš‚æ—¶å°±è¿™æ ·å§ï¼<br/>ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°æœ€ç»ˆå›è´­<a class="ae no" href="https://github.com/zzpzaf/restapidemo_mysql_jdbc-CustomAuthenticationProvider_FilterChain_demo_mysql_final" rel="noopener ugc nofollow" target="_blank">ã€‚</a></p><p id="25f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘å¸Œæœ›æˆ‘èƒ½å¤Ÿè®©æ‚¨å¯¹ä» WebSecurityConfigurerAdapter è¿ç§»åˆ° SecurityFilterChain æœ‰æ‰€äº†è§£ï¼Œå¹¶ä½“éªŒå¦‚ä½•ä½¿ç”¨è‡ªå®šä¹‰è¿‡æ»¤å™¨å’ŒåŸºäº DSL çš„è‡ªå®šä¹‰é…ç½®å™¨ã€‚</p><p id="3d08" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ„Ÿè°¢é˜…è¯»ğŸ‘ï¼æ•¬è¯·å…³æ³¨ï¼</p></div></div>    
</body>
</html>