<html>
<head>
<title>Automated Documents — Google Docs API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自动化文档——Google Docs API</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/automated-documents-google-docs-api-97df5602660e?source=collection_archive---------1-----------------------#2020-03-24">https://blog.devgenius.io/automated-documents-google-docs-api-97df5602660e?source=collection_archive---------1-----------------------#2020-03-24</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/89aa99fb4b46c369f26b1ab927ebafd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_ev7ql-BZCBkmLPC_jD5iQ.png"/></div></div></figure><p id="a867" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">您是否为您的业务创建了大量的发票/账单/报表？您需要将物联网传感器数据捕获到电子表格中吗？您想自动化数据捕获并与团队协作吗？你想删除文档中的维基百科或类似的网页内容吗？等等…</p><p id="ba75" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果这些想法出现在你的脑海中，与你的项目或业务有关？是时候自动化并专注于你的业务核心竞争力了。查看<a class="ae kt" href="https://developers.google.com/gsuite/products" rel="noopener ugc nofollow" target="_blank">谷歌 G 套件开发者 API</a>。Google 有各种产品的开发者 API，但是本文主要关注<strong class="jx io">Google Docs API</strong>。</p><p id="104e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这非常简单，特别是使用<strong class="jx io"> Python </strong>时，本文试图带您更进一步。</p><p id="64ab" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">Google 文档保存在 Google Drive 中，因此在这个练习中，您需要访问“Google-Drive”和“Google-Docs”的服务。这也意味着，无论你在 Google Drive 和 Document UI 上做什么，你都可以用 API 做同样的事情。</p><h1 id="ee64" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">要求:</h1><ol class=""><li id="20cc" class="ls lt in jx b jy lu kc lv kg lw kk lx ko ly ks lz ma mb mc bi translated">支持在继续，世界也在前进。)和<code class="fe md me mf mg b">pip</code>一起安装 python 包。</li><li id="26b3" class="ls lt in jx b jy mh kc mi kg mj kk mk ko ml ks lz ma mb mc bi translated">一个谷歌账户。</li><li id="9028" class="ls lt in jx b jy mh kc mi kg mj kk mk ko ml ks lz ma mb mc bi translated">请浏览文档结构。这款<a class="ae kt" href="https://developers.google.com/docs/api/concepts/structure#start_and_end_index" rel="noopener ugc nofollow" target="_blank">传呼机</a>非常优秀。</li></ol><h1 id="cdcd" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">安装:</h1><p id="2e13" class="pw-post-body-paragraph jv jw in jx b jy lu ka kb kc lv ke kf kg mm ki kj kk mn km kn ko mo kq kr ks ig bi translated">非常详细的步骤可以在<a class="ae kt" href="https://developers.google.com/docs/api/quickstart/python" rel="noopener ugc nofollow" target="_blank">这里</a>找到。请启用 API，以便您可以开始使用云服务。</p><h2 id="371f" class="mp kv in bd kw mq mr dn la ms mt dp le kg mu mv li kk mw mx lm ko my mz lq na bi translated">第一步:</h2><p id="c7cc" class="pw-post-body-paragraph jv jw in jx b jy lu ka kb kc lv ke kf kg mm ki kj kk mn km kn ko mo kq kr ks ig bi translated">按照上面的链接进入<strong class="jx io">启用对谷歌文档 API 的访问</strong>。将<code class="fe md me mf mg b">credentials.json</code>下载到您的工作区，在那里您将创建您的 google 客户端项目。</p><h2 id="f41c" class="mp kv in bd kw mq mr dn la ms mt dp le kg mu mv li kk mw mx lm ko my mz lq na bi translated">第二步:</h2><p id="763e" class="pw-post-body-paragraph jv jw in jx b jy lu ka kb kc lv ke kf kg mm ki kj kk mn km kn ko mo kq kr ks ig bi translated">安装谷歌的用于云 API 的 python 客户端。</p><pre class="nb nc nd ne gt nf mg ng nh aw ni bi"><span id="d423" class="mp kv in mg b gy nj nk l nl nm">pip3 install --upgrade google-api-python-client google-auth-httplib2 google-auth-oauthlib</span></pre><h2 id="809b" class="mp kv in bd kw mq mr dn la ms mt dp le kg mu mv li kk mw mx lm ko my mz lq na bi translated">第三步:(可选)</h2><p id="839b" class="pw-post-body-paragraph jv jw in jx b jy lu ka kb kc lv ke kf kg mm ki kj kk mn km kn ko mo kq kr ks ig bi translated">我们正在废弃维基百科的内容，因此我们需要这个 python 包，否则它是可选的。</p><pre class="nb nc nd ne gt nf mg ng nh aw ni bi"><span id="5cba" class="mp kv in mg b gy nj nk l nl nm">pip3 install wikipedia-api</span></pre><h1 id="3a29" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">代码遍历</h1><p id="d0fb" class="pw-post-body-paragraph jv jw in jx b jy lu ka kb kc lv ke kf kg mm ki kj kk mn km kn ko mo kq kr ks ig bi translated">正如我们之前讨论的，文档保存在驱动器中，因此<strong class="jx io">认证和访问</strong>控制需要通过驱动器 API 来控制。在用户认证期间，我们还需要授予访问权限，这在以下链接'<a class="ae kt" href="https://developers.google.com/drive/api/v2/about-auth" rel="noopener ugc nofollow" target="_blank">范围</a>中定义:</p><p id="cbc2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">对于这个例子，我给出了以下两个范围:</p><pre class="nb nc nd ne gt nf mg ng nh aw ni bi"><span id="4856" class="mp kv in mg b gy nj nk l nl nm"><a class="ae kt" href="https://www.googleapis.com/auth/drive'" rel="noopener ugc nofollow" target="_blank">https://www.googleapis.com/auth/drive</a>, <a class="ae kt" href="https://www.googleapis.com/auth/documents" rel="noopener ugc nofollow" target="_blank">https://www.googleapis.com/auth/documents</a></span></pre><p id="713e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这些作用域提供了对应用程序的驱动器和文件的完全访问，但是当您启用这种访问时请非常小心，并且<strong class="jx io">不要共享以下两个文件</strong>。</p><pre class="nb nc nd ne gt nf mg ng nh aw ni bi"><span id="79c4" class="mp kv in mg b gy nj nk l nl nm">1. credentials.json<br/>2. <!-- -->token.pickle</span></pre><p id="1c67" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如你所见，我也没有在项目中共享这两个文件，你需要为你的项目创建<code class="fe md me mf mg b">credentials.json</code>。<code class="fe md me mf mg b">token.pickle</code>在第一次运行后生成，以避免任何后续应用程序运行的身份验证。</p><p id="28df" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我在这个例子中使用的模板可以在<a class="ae kt" href="https://docs.google.com/document/d/1a0C3AQ290uc0yFcVhLD36sj12mQdmv_VnSjh4WhnNvQ/edit#" rel="noopener ugc nofollow" target="_blank">这里</a>找到。您可以添加自己的模板，请确保代码与模板同步。在当前代码中，我只考虑了一个模板。</p><p id="01fa" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在代码中，选择模板后，复制并编辑它。我们将执行以下操作:</p><ol class=""><li id="ab14" class="ls lt in jx b jy jz kc kd kg nn kk no ko np ks lz ma mb mc bi translated">用值替换文档标签中的标签。</li><li id="e7dc" class="ls lt in jx b jy mh kc mi kg mj kk mk ko ml ks lz ma mb mc bi translated">搜索文本并获取其开始和结束索引。</li><li id="dc6e" class="ls lt in jx b jy mh kc mi kg mj kk mk ko ml ks lz ma mb mc bi translated">在特定位置插入文本。</li><li id="ddeb" class="ls lt in jx b jy mh kc mi kg mj kk mk ko ml ks lz ma mb mc bi translated">在文档中插入图像。</li><li id="8b01" class="ls lt in jx b jy mh kc mi kg mj kk mk ko ml ks lz ma mb mc bi translated">在文档中插入超链接。</li><li id="eaee" class="ls lt in jx b jy mh kc mi kg mj kk mk ko ml ks lz ma mb mc bi translated">在特定位置格式化文本。</li></ol><p id="d3ad" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">完整的代码可以在我的 github 资源库中找到。</p><div class="nq nr gp gr ns nt"><a href="https://github.com/milinddeore/google-docs-example/blob/master/google-docs-example.py" rel="noopener  ugc nofollow" target="_blank"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd io gy z fp ny fr fs nz fu fw im bi translated">milinddeore/Google-docs-示例</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">使用 google docs APIs，填充维基百科内容。-milinddeore/Google-docs-示例</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">github.com</p></div></div><div class="oc l"><div class="od l oe of og oc oh jt nt"/></div></div></a></div><p id="ca85" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">下面的命令生成文件，生成的文件看起来像下面的<a class="ae kt" href="https://docs.google.com/document/d/1FiBzajfevDYyRVIbyDZnu_tCQh2T3bWMy6ayupKuLBs/edit" rel="noopener ugc nofollow" target="_blank">这个</a>。</p><pre class="nb nc nd ne gt nf mg ng nh aw ni bi"><span id="abe9" class="mp kv in mg b gy nj nk l nl nm">python google-docs-example.py</span></pre><p id="37d6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">希望这有助于开始使用 docs API。下一步是用电子表格构建应用程序，并将它们集成在一起。</p><p id="0c46" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">你可以在|</strong><a class="ae kt" href="https://www.linkedin.com/in/mdeore/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io">LinkedIn</strong></a><strong class="jx io">|</strong><a class="ae kt" href="https://tomdeore.wixsite.com/epoch" rel="noopener ugc nofollow" target="_blank"><strong class="jx io">网站</strong></a><strong class="jx io">|</strong><a class="ae kt" href="https://github.com/milinddeore" rel="noopener ugc nofollow" target="_blank"><strong class="jx io">Github</strong></a><strong class="jx io">|</strong></p></div></div>    
</body>
</html>