<html>
<head>
<title>Returning multiple properties in a C# method with ValueTuple</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用ValueTuple在C#方法中返回多个属性</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/returning-multiple-properties-in-a-c-method-with-valuetuple-3493b441ede7?source=collection_archive---------3-----------------------#2020-08-14">https://blog.devgenius.io/returning-multiple-properties-in-a-c-method-with-valuetuple-3493b441ede7?source=collection_archive---------3-----------------------#2020-08-14</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/9d8d57e0ab7f02dadd7a6fc4675971ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Icy8VaRP_GJdwO-JPfCFkA.jpeg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">来自<a class="ae jz" href="https://www.pexels.com/photo/working-woman-person-technology-7375/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>的<a class="ae jz" href="https://www.pexels.com/@startup-stock-photos?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">创业股票照片</a></figcaption></figure><p id="a187" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">元组在C#世界中很少被实现，这让他们很讨厌，部分原因是因为在某些编程语言(如C#)中“元组”的晦涩，还因为传统C#元组中的对象是作为“Item1”、“Item2”等来访问的。</p><p id="456a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">说到如何从一个方法返回多个属性，下面是我的层次结构:</p><ol class=""><li id="9b4c" class="ky kz in kc b kd ke kh ki kl la kp lb kt lc kx ld le lf lg bi translated">返回一个元组(值元组)</li><li id="85c2" class="ky kz in kc b kd lh kh li kl lj kp lk kt ll kx ld le lf lg bi translated">将方法分解成更小的方法，每个方法只返回一个对象</li><li id="dbae" class="ky kz in kc b kd lh kh li kl lj kp lk kt ll kx ld le lf lg bi translated">最后:创建并使用POCO (plain ol' C# object)来保存对象</li></ol><p id="1099" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">对我来说，仅仅为了存储方法的返回值而创建一个POCO是最坏的也是最后的选择，然而这可能是大多数C#开发人员在这种情况下的首选。使用定制的POCO为我们提供了智能感知，并允许我们通过属性名来访问方法的结果。有什么不喜欢的？</p><p id="c6aa" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">不喜欢的是，我们最终得到的POCOs在应用程序代码之外没有任何意义或价值。我们把这个POCO放在哪里？这不是模型。它肯定不是视图模型或DB实体。我们把它放在一个叫“内部”的文件夹里吗？也许是它被使用的班级？</p><p id="16aa" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">还要考虑到，当一个人阅读代码时，他们必须导航到这个POCO的定义，以便理解这个方法到底返回什么。</p><p id="5859" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这是我拒绝添加到应用程序中的额外负担，尤其是当我们有ValueTuple时。</p><h2 id="6920" class="lm ln in bd lo lp lq dn lr ls lt dp lu kl lv lw lx kp ly lz ma kt mb mc md me bi translated">值元组</h2><p id="ad74" class="pw-post-body-paragraph ka kb in kc b kd mf kf kg kh mg kj kk kl mh kn ko kp mi kr ks kt mj kv kw kx ig bi translated">在C# 7.0中，微软给了我们ValueTuple。ValueTuple应该能够解决开发人员对C# Tuple的所有疑虑。那么Tuple和ValueTuple之间有什么变化呢？简而言之，ValueTuple是一种值类型，因此存储在堆栈中而不是堆中。这在理论上给了我们一个性能增益，因为在堆中少了一件垃圾收集要处理的事情，但更重要的是，它允许我们用元组得到<em class="mk">花式</em>。</p><p id="5387" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">怎么想象？我们得到了一个干净的语法糖，并且能够以命名POCO属性的相同方式来命名元组的成员。</p><p id="af8c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">考虑下面的例子，其中ValueTuple(由<strong class="kc io"> &lt; (…) &gt; </strong>定义)被用于有效且清楚地返回API令牌及其到期日期:</p><figure class="ml mm mn mo gt jo"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="b596" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">当然，可以显式定义值元组，例如<code class="fe mr ms mt mu b">return new ValueTuple&lt;string, DateTime&gt;(token, expirationDate);</code>，但是这样做会删除定义成员名称的能力(“token”和“expirationDate”)。</p><h2 id="702d" class="lm ln in bd lo lp lq dn lr ls lt dp lu kl lv lw lx kp ly lz ma kt mb mc md me bi translated">摘要</h2><p id="6a1c" class="pw-post-body-paragraph ka kb in kc b kd mf kf kg kh mg kj kk kl mh kn ko kp mi kr ks kt mj kv kw kx ig bi translated">使用ValueTuple，我们避免了POCO的额外干扰，同时通过value tuple成员的命名保持了清晰性。更重要的是，我们可以通过查看方法签名来判断<code class="fe mr ms mt mu b">GetToken()</code>是否返回了一个令牌及其到期日期。太美了。</p></div><div class="ab cl mv mw hr mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ig ih ii ij ik"><p id="4a49" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><a class="ae jz" href="https://stackoverflow.com/questions/41084411/whats-the-difference-between-system-valuetuple-and-system-tuple" rel="noopener ugc nofollow" target="_blank">关于元组和值元组之间差异的更多信息</a></p></div></div>    
</body>
</html>