<html>
<head>
<title>Unnecessary Fears of Strict Types in PHP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">对 PHP 中严格类型的不必要的恐惧</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/dangerous-and-unnecessary-fears-of-strict-types-in-php-c24e5a3d240e?source=collection_archive---------2-----------------------#2022-10-17">https://blog.devgenius.io/dangerous-and-unnecessary-fears-of-strict-types-in-php-c24e5a3d240e?source=collection_archive---------2-----------------------#2022-10-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2bad" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">让我来说服你为什么你应该在 PHP 中拥抱严格类型，而不是害怕它！</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/a248204e7e2c4e04ee1dd1ebd421411e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RZ-58mceQe3WkKayVmaBcQ.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">图片由 Andrea Piacquadio 拍摄</figcaption></figure><p id="7b3f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因为您正在阅读这篇文章，所以您可能没有在 PHP 中使用“<em class="ls">严格类型</em>”声明。</p><p id="0cab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你试过吗？也许你做了，但是错误的数量太多了。不用担心；没关系。但是我建议你尽快开始尝试<strong class="ky ir"/>。</p><p id="af9b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在 Medium.com 上，我们可以找到很多 PHP 代码片段。然而，我很少在头文件中看到有意识地使用类型或“严格类型”声明。这是为什么呢？</p><p id="7055" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对我来说，这些程序员没有意识到他们正在剥夺自己的优点！几年前我们曾经这样编程；<strong class="ky ir">现在是 PHP8.1，是时候继续前进了</strong>！</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="5ee2" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">关于 PHP 的几句话</h1><p id="3c69" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">你知道 PHP 最强大的优势是什么，同时也是它最大的缺点是什么吗？是<strong class="ky ir">动力型</strong>系统<strong class="ky ir">。</strong></p><p id="1071" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，在 PHP 中，这样的比较不成问题:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="5217" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">曾经在我看来是这种语言的好处，现在我认为它是纯粹的邪恶。这被称为“类型强制”或“类型杂耍”:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="ff68" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">救援的有意识程序</h1><p id="f893" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">如何在 PHP 中启用“严格类型化”？没什么难的，只是过了<?php tag put “declare(strict_types=1).” Will you take my word for it that this one line will change your approach to this language forever?</root?></p><p id="b30f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">The beginnings might be tough. It’s because even the tiniest error in the types of variables will result in a TYPE_ERROR exception and application failure.</p><p id="b867" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Forget running the snippet below. Code that used to run smoothly, won’t execute this time:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="1d55" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Types in PHP are something you might have ignored so far. From now on, you will need to know everything about the type of data that the variable stores; on each line. Int, string, boolean? Does the variable accept null values?</p><p id="df79" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Variable types are dynamic in PHP. In the example below, the “foo” function cannot know in advance what data type it will be operating on.</p><p id="deee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">The function will accept most of the data we pass on and perform the conversion gracefully:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="996f" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">Advantages of strict types in PHP</h1><p id="01ca" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">The biggest bonus of using strict types in PHP will be <strong class="ky ir">就少了</strong>的 bug！</p><p id="0f39" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在开发过程中，您将很快发现代码没有正常运行的地方。</p><p id="dc92" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在像 C ++或 Java 这样的编译语言中，程序员可以避免基本的代码错误，因为编译器负责验证代码。变量类型之间的错误会导致编译错误。</p><p id="0e64" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">PHP 是一种可解释的语言。我们在运行时了解解释错误，可能是在生产服务器上。第一个发现问题的人将是我们的客户(当然。)</p><p id="3d34" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我宁愿避开它，你呢？我希望我的代码是最高质量的，没有错误，没有漏洞。我是一名专业人士，我希望我的客户能够依赖我。</p><blockquote class="mz"><p id="55eb" class="na nb iq bd nc nd ne nf ng nh ni lr dk translated">我们客户的成功就是我们的成功。</p></blockquote></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="830a" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">样本迁移</h1><p id="cd5c" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">当前代码的迁移必须一个文件一个文件地开始。途中大概会有很多空隙。考虑一个示例控制器:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="f828" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们能说这个代码在任何情况下都会工作吗？我们几乎知道它在这一点上是可行的。毕竟，我们测试了这段代码，并且“它对我有效。”</p><p id="553f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一周后，我们突然接到一个电话。我们系统的销售转换率下降到几乎为零。</p><p id="55cc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">经过一个小时的调试，原来是前端开发人员在表单中犯了一个小错误，停止发送“用户名”字段。</p><p id="257f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该应用程序有一个附加的错误监控系统。错误数量的增加会生成一个警告，并向管理员发送一封警告电子邮件。在这种情况下，没有发生类似的事情，也没有发出警报。</p><p id="2a15" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为什么？LoginService 的“authenticate”方法接受字符串。由于作者没有声明“严格类型”，PHP 引擎很高兴地假定传递的“null”值是一个空字符串。</p><p id="896c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">导致客户无法登录个人账户！</p><div class="kg kh ki kj gt ab cb"><figure class="nj kk nk nl nm nn no paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/19682fd8cc5330734b8345cee06e66ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*5Ultc1SnTR7P9bynBsA-CA.jpeg"/></div></figure><figure class="nj kk np nl nm nn no paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/c9634627a18bbb03db553b58962710be.png" data-original-src="https://miro.medium.com/v2/resize:fit:842/format:webp/1*71jNShjSH6Z8M7xUg7NEDQ.jpeg"/></div></figure></div><p id="bab7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">同一个开发人员昨天正在阅读一本关于 Medium 的出版物，并决定有意识地开始<strong class="ky ir">编程</strong>。</p><p id="b131" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">他检查了控制器中使用的每个方法和类，验证了所有的输出和输入，记录了它们，并进行了修正。</p><p id="0f62" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">重构后的方法如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="179b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">程序员“浪费”了一些时间记录代码，但是得到了一个在任何情况下都无法破解的代码<strong class="ky ir">。</strong></p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><p id="7a07" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">PHP 中的严格类型初看起来可能有问题。对于程序员新手来说，这似乎完全没有必要。</p><p id="181b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它需要花更多的时间阅读文档。</p><p id="d203" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">必须验证函数和方法的输入和输出，并对变量进行注释。</p><p id="bb33" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，这样的<strong class="ky ir">防御性编程</strong>很快就会成为<strong class="ky ir">一种你会很快喜欢上的习惯</strong>。相信我！记住这是一项有回报的投资。</p><p id="ec71" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我敢肯定，你不会想要一栋由粗心的建筑商建造的房子，或者驾驶一辆由易腐材料设计的汽车。</p><p id="6b28" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们毕竟是软件工程师，我们构建代码。让我们确保它是高质量的。让我们有意识地开始<strong class="ky ir">编程</strong>。</p></div></div>    
</body>
</html>