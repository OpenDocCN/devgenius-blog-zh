<html>
<head>
<title>Automatically and Quickly Calculate the Expected Return of your Stocks and Portfolio (CAPM) Using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 自动快速计算股票和投资组合的预期回报(CAPM)</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/automatically-and-quickly-calculate-the-expected-return-of-your-stocks-and-portfolio-capm-using-f9f189657584?source=collection_archive---------7-----------------------#2022-09-27">https://blog.devgenius.io/automatically-and-quickly-calculate-the-expected-return-of-your-stocks-and-portfolio-capm-using-f9f189657584?source=collection_archive---------7-----------------------#2022-09-27</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="d027" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">使用 CAPM，你期望从你的股票和投资组合中获得多少回报</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/09bd00158b40d2e5a3305b45e1ceed1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*USfoEXczggdrghpnRFkY1w.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">在<a class="ae ks" href="https://unsplash.com/s/photos/capital-assets?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae ks" href="https://unsplash.com/@austindistel?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Austin Distel </a>拍摄的照片</figcaption></figure><p id="c152" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在过去的几年里，股票市场非常不稳定。波动性可以被视为投资者的一种风险。“资本资产定价模型(CAPM)描述了系统风险或投资的一般风险与资产(尤其是股票)的预期回报之间的关系。CAPM 是作为一种度量系统风险的方法发展而来的。它在金融中被广泛用于给有风险的证券定价，并根据其风险和资本成本产生预期的资产回报”(<a class="ae ks" href="https://www.investopedia.com/terms/c/capm.asp" rel="noopener ugc nofollow" target="_blank"> Investopedia </a>)</p><p id="fa12" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">以下是自动快速计算你的股票和投资组合的预期回报(CAPM)的步骤:</p><ol class=""><li id="a4bd" class="lp lq in kv b kw kx kz la lc lr lg ls lk lt lo lu lv lw lx bi translated">检查公式</li><li id="59ad" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">导入包</li><li id="bfc4" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">导入投资组合</li><li id="3d1e" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">计算投资组合的预期收益</li><li id="62b9" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">计算每只股票的预期收益</li></ol></div><div class="ab cl md me hr mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ig ih ii ij ik"><ol class=""><li id="7757" class="lp lq in kv b kw kx kz la lc lr lg ls lk lt lo lu lv lw lx bi translated"><strong class="kv io">公式:</strong></li></ol><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mk"><img src="../Images/fee98abff3709cb3f1f2f631fac462ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YzqzrbWhDK-t4m3gvJ1Hfg.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">来自 Investopedia 的 CAPM 公式</figcaption></figure><p id="3aa5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">无风险利率:我们将使用 10 年期国库券。</p><p id="f53b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">市场回报率:我们将使用 10%的 S&amp;P500 平均回报率。</p><p id="70ef" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">贝塔系数表明股票价格相对于整个股票市场的波动程度。我们将从 yfiannce api 中提取它。</p><p id="d376" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">2.<strong class="kv io">导入包:</strong></p><pre class="kd ke kf kg gt ml mm mn mo aw mp bi"><span id="f46a" class="mq mr in mm b gy ms mt l mu mv"># Import Libraries and packages<br/>import yfinance as yf<br/>import pandas as pd<br/>import numpy as np</span></pre><p id="9a48" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">3.<strong class="kv io">导入投资组合:</strong></p><p id="d07f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">您可以在本文末尾的 github 链接中找到 excel 文件的链接，以便您添加自己的作品集:</p><pre class="kd ke kf kg gt ml mm mn mo aw mp bi"><span id="771a" class="mq mr in mm b gy ms mt l mu mv"># Import stock portfolio from excel<br/>df = pd.read_excel("Stock_Portfolio.xlsx")<br/>df</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/c98d9a5517fe0251ffe621fb1c55757e.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*kTrC1i1rkO0_iPE5KZbeAg.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">输出</figcaption></figure><p id="4905" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">4.<strong class="kv io">计算投资组合的预期收益:</strong></p><p id="a9cd" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们需要计算投资组合中每只股票的权重</p><pre class="kd ke kf kg gt ml mm mn mo aw mp bi"><span id="d169" class="mq mr in mm b gy ms mt l mu mv"># Calculate stock weight<br/>df["stock_weight"]= round((df['Purchase_Cost']/df["Purchase_Cost"].sum())*100,2)<br/>df</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/5fde3d24b667188e803e03be55b6e693.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*2SLU79Wn60jJOLTUhNEfnw.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">输出</figcaption></figure><p id="46e0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">计算每只股票的贝塔系数:</p><pre class="kd ke kf kg gt ml mm mn mo aw mp bi"><span id="3d28" class="mq mr in mm b gy ms mt l mu mv"># Calculate beta for each individual stock<br/>for i in range(len(df)):<br/>    x = df.loc[i, "Stock"]<br/>    ticker = yf.Ticker(x)<br/>    stock_beta = ticker.info["beta"]<br/>    df.at[i, "Beta"]= round(stock_beta,2)<br/>df</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi my"><img src="../Images/092ce3b5d2ec915fa000db933829b39f.png" data-original-src="https://miro.medium.com/v2/resize:fit:930/format:webp/1*BsEexzBuX88wWQ7zuqgSWA.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">输出</figcaption></figure><p id="3592" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">找出无风险利率:</p><p id="0ad8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们将使用 10 年期国库券。</p><pre class="kd ke kf kg gt ml mm mn mo aw mp bi"><span id="d012" class="mq mr in mm b gy ms mt l mu mv"># find the risk free rate (10 year treasury bill)<br/>treasury_yield10 = yf.Ticker("^TNX") <br/>risk_free_rate_prem = round(treasury_yield10.info['regularMarketPrice']/100,2)<br/>risk_free_rate_prem</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/103361f4d6b4058c0f67591b8741cdba.png" data-original-src="https://miro.medium.com/v2/resize:fit:288/format:webp/1*pbUkYyoO6iLYjnPHjOeqcw.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">输出</figcaption></figure><p id="b3d8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">对于市场回报，我们将使用 10%的 S&amp;P500 平均值</p><pre class="kd ke kf kg gt ml mm mn mo aw mp bi"><span id="09cc" class="mq mr in mm b gy ms mt l mu mv"># assume 10 percent return on the return of market ( average return of the S&amp;P 500)<br/>sp500_teturn = 0.10</span></pre><p id="4e43" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在我们用每只股票的贝塔系数乘以它的权重来计算投资组合的贝塔系数。</p><pre class="kd ke kf kg gt ml mm mn mo aw mp bi"><span id="bc5c" class="mq mr in mm b gy ms mt l mu mv"># Caclulate the portfolio beta<br/>portfolio_beta = round(sum(df["Beta"]* df["stock_weight"]/100),2)<br/>portfolio_beta</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi na"><img src="../Images/bf0f29f445ea58a6a5fe1322c037eb2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:356/format:webp/1*b5IzHXUJq9MgwbgMQ14s8g.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">输出</figcaption></figure><p id="fdbd" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在我们计算投资组合的预期收益。</p><pre class="kd ke kf kg gt ml mm mn mo aw mp bi"><span id="f836" class="mq mr in mm b gy ms mt l mu mv"># Calculate the expected return of the portfolio<br/>portfolio_exp_return = round(risk_free_rate_prem + portfolio_beta *(sp500_teturn - risk_free_rate_prem),2)<br/>portfolio_exp_return</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/3bdf9b3a2c22139a86f13d71d25c9c1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:272/format:webp/1*_Zz_Ybb2lCMpeyPWJzYJyQ.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">输出</figcaption></figure><p id="a2bf" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们应该期望这个投资组合每年有 9%的平均回报率。</p><p id="e3f8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">5.计算每只股票的预期收益:</p><p id="56ab" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在，让我们找出每只股票的预期收益。</p><pre class="kd ke kf kg gt ml mm mn mo aw mp bi"><span id="7659" class="mq mr in mm b gy ms mt l mu mv"># calulate the expected return for each individual stock using CAPM forumla<br/>df["exp_return"]= round(risk_free_rate_prem + df["Beta"]*(sp500_teturn - risk_free_rate_prem),2)<br/>df</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/b356b15e3e553666533f8ff189e24798.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*OjPqIaWuYCNOG03kRitVZg.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">输出</figcaption></figure><p id="99ef" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">最后，所有的金融模型都有假设和问题。对于进一步的阅读，我建议阅读<a class="ae ks" href="https://www.investopedia.com/terms/c/capm.asp" rel="noopener ugc nofollow" target="_blank">Investopedia 的文章</a>。</p></div><div class="ab cl md me hr mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ig ih ii ij ik"><p id="0a9d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">完整的代码和 excel 文件，点击<a class="ae ks" href="https://github.com/RedaAldahan/Fiancne_Models/tree/3fdfc17b8b9e40dfde4fc5f9ea629b2e5fdaf42b/CAPM" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io">这里</strong> </a> <strong class="kv io">。</strong></p></div><div class="ab cl md me hr mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ig ih ii ij ik"><p id="6312" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">免责声明</strong>:</p><p id="0ce1" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">投资证券是有风险的。投资股票、债券、交易所交易基金、共同基金和货币市场基金有亏损的风险。本金损失是可能的。证券或公司过去的投资表现并不能保证或预测未来的投资表现。</p></div></div>    
</body>
</html>