<html>
<head>
<title>How To Share Content From Your App With UIActivityViewController in Swift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Swift中使用UIActivityViewController共享应用程序中的内容</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-share-content-from-your-app-with-uiactivityviewcontroller-in-swift-27e46438f11c?source=collection_archive---------0-----------------------#2019-11-06">https://blog.devgenius.io/how-to-share-content-from-your-app-with-uiactivityviewcontroller-in-swift-27e46438f11c?source=collection_archive---------0-----------------------#2019-11-06</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="4acb" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">让我们看看UIActivityViewController如何处理文本共享、URL、图像等等</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/9e3d46e00106366df007beaeaf0f324f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aXj8D_jwUh3cmS_Q"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk translated"><a class="ae kw" href="https://unsplash.com/@mr_fresh?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Yura Fresh </a>在<a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="9e0d" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">如果你想在你的应用中分享内容，苹果在iOS 6中引入了类<code class="fe lt lu lv lw b">UIActivityViewController</code> <strong class="kz is">。这个类处理URL、文本、图像、视频共享，更简单，只需要几行代码。</strong></p><p id="3bf7" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">今天，在这篇文章中，我们将讨论如何在我们的应用程序中实现<code class="fe lt lu lv lw b">UIActivityViewController</code>,以及如何分享我们的内容。</p></div><div class="ab cl lx ly hv lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ik il im in io"><h1 id="e71e" class="me mf ir bd mg mh mi mj mk ml mm mn mo jx mp jy mq ka mr kb ms kd mt ke mu mv bi translated">入门指南</h1><p id="2a35" class="pw-post-body-paragraph kx ky ir kz b la mw js lc ld mx jv lf lg my li lj lk mz lm ln lo na lq lr ls ik bi translated">首先，打开<a class="ae kw" href="https://developer.apple.com/xcode/" rel="noopener ugc nofollow" target="_blank"> Xcode，</a>，新建一个项目。选择<em class="nb">单视图App </em>。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nc"><img src="../Images/0f9f9806e3df5e826383ee185bb1e114.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_SQrOhyRHNXyxKaswOh6Yw.png"/></div></div></figure><p id="ac42" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">现在，在屏幕顶部创建一个名为<code class="fe lt lu lv lw b">messageTextView</code>的<code class="fe lt lu lv lw b">UITextView</code>，它将包含我们的消息，在屏幕底部创建一个按钮，当点击它时，将显示我们的共享菜单。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nd"><img src="../Images/749f91a0a1808d4a1224894fada192aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N_d_qfZf1QYMZrJdrPth_A.png"/></div></div></figure></div><div class="ab cl lx ly hv lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ik il im in io"><h1 id="bd76" class="me mf ir bd mg mh mi mj mk ml mm mn mo jx mp jy mq ka mr kb ms kd mt ke mu mv bi translated">文本共享实现</h1><p id="b8c5" class="pw-post-body-paragraph kx ky ir kz b la mw js lc ld mx jv lf lg my li lj lk mz lm ln lo na lq lr ls ik bi translated">进入按钮<code class="fe lt lu lv lw b">IBAction</code>功能，添加以下代码:</p><pre class="kh ki kj kk gu ne lw nf ng aw nh bi"><span id="cdd8" class="ni mf ir lw b gz nj nk l nl nm">let items = [messageTextView.text]<br/>let ac = UIActivityViewController(activityItems: items, applicationActivities: nil)<br/>present(ac, animated: true)</span></pre><p id="89b0" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">这简单的三行将用我们的<code class="fe lt lu lv lw b">UITextView</code>文本创建一个数组，创建一个<code class="fe lt lu lv lw b">UIActivityViewController</code>对象，然后向用户显示share菜单。</p><p id="6cb4" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在这里我们可以找到许多支持文本共享的应用程序，例如，Messages、Mail、Whatsapp、Telegram等。如果我们尝试点击消息图标，我们会看到应用程序将被打开，我们的文本出现在文本框中。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nn"><img src="../Images/152d41e42770de395bb627670b29ff1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QDixRoDsyEdbKIOIe5qOSA.png"/></div></div></figure><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nn"><img src="../Images/4d937c57f7ab37fba975d5c04aee94e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*naTsjSaSBgHxiI5e7mlXpQ.png"/></div></div></figure></div><div class="ab cl lx ly hv lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ik il im in io"><h1 id="4dac" class="me mf ir bd mg mh mi mj mk ml mm mn mo jx mp jy mq ka mr kb ms kd mt ke mu mv bi translated">图像共享实现</h1><p id="c148" class="pw-post-body-paragraph kx ky ir kz b la mw js lc ld mx jv lf lg my li lj lk mz lm ln lo na lq lr ls ik bi translated">如果我们想分享一张图片，我们需要对应用程序界面做一点小小的改动，并在<code class="fe lt lu lv lw b">UITextView</code>控件下添加一个名为<code class="fe lt lu lv lw b">profileImageView</code>的<code class="fe lt lu lv lw b">UIImageView</code>。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nd"><img src="../Images/f550c46b71d6f313cec7c99bbed0e9b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xbaMecLEXU_4uqPeeNmcwA.png"/></div></div></figure><p id="d625" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">现在用以下代码更改按钮<code class="fe lt lu lv lw b">IBAction</code>功能:</p><pre class="kh ki kj kk gu ne lw nf ng aw nh bi"><span id="3d19" class="ni mf ir lw b gz nj nk l nl nm">let items = [profileImageView.image]<br/>let ac = UIActivityViewController(activityItems: items, applicationActivities: nil)<br/>present(ac, animated: true)</span></pre><p id="b967" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">当您从应用程序中共享图像时，用户可以将其保存在图库中，但写入照片库是一项受限制的操作。因此，如果用户点击该操作，应用程序将会崩溃。</p><p id="ad89" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">为了避免这个问题，您需要像这样请求用户的许可:</p><ul class=""><li id="f885" class="no np ir kz b la lb ld le lg nq lk nr lo ns ls nt nu nv nw bi translated">打开项目的<code class="fe lt lu lv lw b">Info.plist</code>文件。</li><li id="e016" class="no np ir kz b la nx ld ny lg nz lk oa lo ob ls nt nu nv nw bi translated">点击<code class="fe lt lu lv lw b">+</code>图标。</li><li id="e528" class="no np ir kz b la nx ld ny lg nz lk oa lo ob ls nt nu nv nw bi translated">选择<em class="nb">隐私-照片库附加使用说明</em>键。</li><li id="7555" class="no np ir kz b la nx ld ny lg nz lk oa lo ob ls nt nu nv nw bi translated">设置值<em class="nb">我们需要在您的图库中写入照片</em>。</li></ul><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nn"><img src="../Images/94d24612a4ee6525123ecbb49f9c52b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dod9KrcBU3Dh8JtQm8Twig.jpeg"/></div></div></figure><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nn"><img src="../Images/87271062e97171b7a2bef289a8f2822f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zHfEVUwS1JAxrWKr58Lirw.png"/></div></div></figure></div><div class="ab cl lx ly hv lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ik il im in io"><figure class="kh ki kj kk gu kl gi gj paragraph-image"><a href="https://www.buymeacoffee.com/nicolidomenico"><div class="gi gj oc"><img src="../Images/2a5f4681ef2bdba5652dc9b023b668a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D-JJemrcn63kKj3lPBwZ5w.png"/></div></a></figure><h1 id="83ac" class="me mf ir bd mg mh od mj mk ml oe mn mo jx of jy mq ka og kb ms kd oh ke mu mv bi translated">完整代码</h1><p id="555a" class="pw-post-body-paragraph kx ky ir kz b la mw js lc ld mx jv lf lg my li lj lk mz lm ln lo na lq lr ls ik bi translated">你可以在<a class="ae kw" href="https://github.com/domeniconicoli/UIActivityViewControllerExample/tree/master" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到完整代码。</p><p id="9f97" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">感谢您的阅读。如果你有任何问题或建议，请在评论中告诉我。</p></div></div>    
</body>
</html>