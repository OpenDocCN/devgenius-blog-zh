<html>
<head>
<title>Creating a 3D snake game in C#</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 C#创建 3D 贪吃蛇游戏</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/creating-a-3d-snake-game-in-c-3953740e18c1?source=collection_archive---------8-----------------------#2022-08-21">https://blog.devgenius.io/creating-a-3d-snake-game-in-c-3953740e18c1?source=collection_archive---------8-----------------------#2022-08-21</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="4ca3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我提醒你，这篇文章是针对完全初学者的。</p><p id="ef2a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在创建蛇的过程中，我们需要图形，为此我们将从资产商店中获取免费的 LowPoly 包。</p><p id="b2ec" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将从关卡的构建开始。<br/>为此，点击层次窗口并选择 3D 对象- &gt;平面。这样做之后，你会得到一个扁平的物体，它会起到地面的作用。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/3ba3c6175e1bcb6ec7441a9732a56447.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gEiQkjHTLa8r9ldFvorGYw.jpeg"/></div></div></figure><p id="4f79" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">但是对于地面来说，它很小，为了解决这个问题，我们需要注意窗口检查器，并在组件变换中设置 X 和 Y 值为 40。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/485aa0bbcefe93c82379ec7c87e520d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XfSuWLGfbRHBNtMwH0ZsJg.jpeg"/></div></div></figure><p id="bcc6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在那之后，地球变成了正确的大小，但是它的外观还有很多需要改进的地方，你需要给它一个绿色的颜色。要做到这一点，在项目窗口中，我们在资产中创建一个材质文件夹，点击右键并选择 Create -&gt; Material，然后一个新的材质出现，我们称之为 Ground。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/5776cd028603f479e6b7e562dcb1e2e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KsqkfOHPIMSGhsFoptwSQA.jpeg"/></div></div></figure><p id="49a9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">创建材质后，应该对其进行配置，为此，在材质上单击鼠标左键，然后将反照率字段中的颜色编辑为所需的颜色。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/f96a915472d08fcf6e6ed138738dd262.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fBhqELFueCWHSTWb8G0Lbg.jpeg"/></div></div></figure><p id="66ae" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">接下来，你只需要把材料拖到飞机上，之后它就会变成绿色。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/9fa1b8406cb64cbd55c6cfe969ae1b54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9SSPPv6uZzJ6DIgEGRzCsQ.jpeg"/></div></div></figure><p id="e4b3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在是做环境的时候了，为了不弄乱编辑器，让我们创建一个空对象，我们称之为“环境”，它将存储周围的对象。</p><p id="27f8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">首先，让我们为我们的蛇做一个围栏。为此，在“环境”中创建一个立方体对象，并将其坐标设置为 0，如果不是的话。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/98de9bd4615dcfcbf8e095461b994152.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ljzCZcG8Z6Ugg4cJrYjEEA.jpeg"/></div></div></figure><p id="df0d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">然后单击标记部分的立方体，切换到正交模式，以便于编辑。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/f829556cbd936c17d700eb8aeca8ef3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8pmcpDMgznEnjGdWbD_YTw.jpeg"/></div></div></figure><p id="d67d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在我们在轴之间切换，将场景切换到以下视图:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/8aef7d36667062c4cad59b0a6815c0f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NqbJorQWWgjoTL2u8hko5g.jpeg"/></div></div></figure><p id="99ab" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">接下来，缩小相机，将立方体的比例 X 设置为 40 <br/>重要:检查立方体是否在零坐标。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/785dcf2cc43e7a45bdab1688feb1e9bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R9TzZDEyYJr07alLCkfYHg.jpeg"/></div></div></figure><p id="76fc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在选中墙的情况下，按 CTRL+D(创建对象的副本)并按住 CTRL 键，将新墙沿 Z 轴向上移动 40 个单位(或者您可以只在检查器中设置值)。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/00cbe9d7085cc34ea954d215cc262ce1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nlG2o9kDzDp_zJV-zTt0LQ.jpeg"/></div></div></figure><p id="b256" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">两堵墙准备好了，还有两堵。<br/>同时选择两面墙，再次按 CTRL+D，然后选择旋转工具，设置中心编辑模式，相对于中心旋转我们的墙。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/0147a05ff91bfe7f96c4a313cf2fb120.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NXgn-GAwAnmziIPO9qRSVg.jpeg"/></div></div></figure><p id="ccd5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">按 Ctrl，这将允许我们旋转我们的墙壁到一个严格指定的角度。现在我们准备好了一个盒子。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/e8b6eafba2ac26afbb1e3e14e30845a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CAnxXpDVfTyF99IbJdXfBA.jpeg"/></div></div></figure><p id="3e04" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">之后，切换回透视投影(通过点击场景右角的立方体)，移动相机，使预览中的画面符合你的喜好。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/b0a25054c5da13804d44e751cff22155.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ovq5ZmEbl9Cy6kaBnWOvcg.jpeg"/></div></div></figure><p id="be4a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">装饰它仍然是一件小事。在文章的开头有一个到一个图形包的链接，从这个包中取出我们喜欢的环境，并在场景中进行排列，最重要的是，不要忘记所有这些对象都必须是环境对象的子对象。</p><p id="5fd3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我得到了下面的图片:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/26431eddf6235a2a1c3aed1a6c8cc770.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bsO_pRm1qbKHJoACdu8ZOw.jpeg"/></div></div></figure><p id="4f8e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">看起来我们可以在这里完成环境的设置，但是没有。现在我们在场景中有大量的物体，很难渲染，让我们看看统计数据。</p><p id="1065" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">用窗口-&gt;分析-&gt;框架调试器打开框架调试器，启动游戏。我们看到了什么？我们看到我们花了 606 个抽签调用来抽签。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/4b1dca40d907d35820ceb0f90641e7be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EA7zTzSh6l_w3iTUh558rw.jpeg"/></div></div></figure><p id="c4a7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">什么是听牌？这是对图形卡的调用。当所有的顶点信息都收集好并发送到显卡进行渲染。我们在优化过程中一直关注这个参数。对于这样的游戏来说，606 是一个疯狂的数字。那么我们如何解决这个问题呢？</p><p id="f47c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这里，我们可以使用静态批处理技术，这是 Unity 试图将所有对象拼凑在一起，并以较少的访问次数呈现它们的时候。我们的构建会消耗更多的内存，因为我们必须将所有的网格存储在某个地方，但是我们会在渲染调用的数量上获得很多。</p><p id="9e98" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">正如我们所记得的，我们将所有这些对象组装成一个空的环境对象。现在我们选择它并检查 static，然后同意将所有子对象也设为 Static。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/6af0b0b7b4fcc45594d32f190b77a2e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OmooaofwRCr-IqwEshE2fg.jpeg"/></div></div></figure><p id="a510" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">之后，我们再次运行游戏，看到只有 40 个听牌要求，这要少得多。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/5ac4abc4bdd5fbf49868fd3c5f291e77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PzDEbWd84reLAhAy2DCCoQ.jpeg"/></div></div></figure><p id="62db" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">创造一条蛇</strong></p><p id="5089" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">创建一个简单的 3D 立方体对象，它将扮演一条蛇的角色。<br/>如果你愿意，你可以为蛇创建一个新的材质并分配给它。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/406e04622d87ed8ae6c25dde62751a52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NFtEZL-_npQQJDaQ6Mlr3w.jpeg"/></div></div></figure><p id="18e7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一条蛇是如何建造的，它是如何移动的？</p><p id="25cb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">蛇基本上由头部和尾部组成。它的移动是它的移动的历史，即，随着每一次移动，块向前移动到它的上级链接的位置。</p><p id="a7d3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为脚本创建一个文件夹，并在其中放置脚本 Snake。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/a307a3069492276f3ec0c2541fc7adae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YIuVbPmatPCwZH89LV3_LQ.jpeg"/></div></div></figure><p id="3bd6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们弄清楚我们的脚本是如何工作的。在 Update 中，我们调用旋转和移动的方法，所以我们从旋转开始。</p><p id="3477" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Rotate 方法获取旋转速度，然后读取是否按下了 A 或 D 键，旋转是旋转的特征(如果您更改了轴设置，也可以是箭头或其他键)，乘以速度和自上一帧以来经过的时间。</p><p id="2d89" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为什么这是乘法？每个玩家都有不同的帧数，有些有 100 帧，有些有 200 帧，有些有 30 帧，这意味着每秒将进行 30 次更新，还有 200 次，蛇将移动不同的距离，将以不同的速度移动(这可以在《半衰期》中看到，当 speedrunners 改变 FPS 时)。</p><p id="d866" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">乘以时间。deltaTime 我们对所有的速度进行标准化，因为这是自上次调用更新以来经过的时间。</p><p id="38d3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">头部运动并不复杂，我们只是将头部向前移动，兼顾速度。</p><p id="b3b7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">但是尾巴的运动很有趣，值得更详细地剖析。</p><p id="3204" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">注意第 32 行中的检查。如果当前骨骼和下一个骨骼之间的距离大于骨骼之间的距离，那么我们将尾部拉近。原来我们在不断的改变他们的位置，让他们越来越近。如果没有到达该距离，那么我们也没有到达其他骨骼，我们可以中断处理。</p><p id="481d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们也需要食物。对于 food，我将要求您创建一个脚本，并从其中删除 Start 和 Update 方法，以便它显示为空。食物不做任何事情，我们只需要脚本，以便我们可以确定它是我们遇到的食物。</p><p id="e39e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们创建一个食物，在舞台上创建一个立方体，添加红色材料，我们创建的食物组件。在我们的食物立方体上还有一个组件箱碰撞器，它有一个触发字段，在那里打勾，然后将食物放置在整个地图上。</p><p id="b748" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了让我们能够与食物碰撞，我们需要将头部升级一点。头上已经有一个碰撞器，但为了让我们与食物触发器互动，我们需要在头上有刚体组件。添加刚体后，取消选中“使用重力”并选中“运动学”。</p><p id="2fce" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">接下来，我们返回到脚本并添加吃的代码。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/9c6a02112dea6bfdfba82a97467845eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K3gM0hF4sRkBAYSUBQHB7Q.jpeg"/></div></div></figure><p id="abf1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们检查对象是否有食物成分，如果有，我们从预置中创建一个新的尾巴，并将其添加到尾巴列表中。</p><p id="d2e4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">总的来说，我们设法创造了最简单的蛇，它可以爬行，收集食物和生长。</p></div></div>    
</body>
</html>