<html>
<head>
<title>Exploring (COVID-19) Data Using SQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 SQL 浏览(新冠肺炎)数据</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/exploring-covid-19-data-using-sql-90e1c83d66d1?source=collection_archive---------3-----------------------#2022-11-25">https://blog.devgenius.io/exploring-covid-19-data-using-sql-90e1c83d66d1?source=collection_archive---------3-----------------------#2022-11-25</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="5e8b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这个项目中，我使用 SQL 查询来深入了解数据集，在这里我将详细解释我采用的方法和整个过程。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ce1c86c95e52c1276dc2a133c4198038.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ccH8qY6-YgiLNwU9ruiR_Q.jpeg"/></div></div></figure></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h1 id="af52" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">介绍</h1><p id="3c97" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">在这个个人项目中，我使用了来自<em class="me">ourworldindata.org</em>的<strong class="jm io">新冠肺炎</strong>数据集，并尝试使用<strong class="jm io"> SQL </strong>来分析和洞察数据，并为可视化做准备。</p><p id="e27e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这个项目中，我使用了<strong class="jm io"> BigQuery </strong>，因为我在将数据加载到<strong class="jm io"> MySQL </strong>时遇到了麻烦，还因为我开始在 BigQuery 上学习 SQL，我发现将数据加载到 BigQuery 数据库非常简单和容易。</p><p id="57f3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">关于数据</strong>:我在这个项目中使用的数据在<strong class="jm io">新冠肺炎</strong>上。当我不久前做这个项目时，数据可能不是最新的。要获取更新的数据，请访问<strong class="jm io"/><a class="ae mf" href="http://www.ourworldindata.org" rel="noopener ugc nofollow" target="_blank"><strong class="jm io">www.ourworldindata.org</strong></a>，这是一个获取公共数据集的免费资源。下载完数据后，我<strong class="jm io">用<strong class="jm io"> MS Excel </strong>和<strong class="jm io">将</strong>数据集分成<strong class="jm io">两个</strong>部分，即<strong class="jm io"> CovidDeaths </strong>和<strong class="jm io">covidnevacciness</strong>。我这样做是因为这将有助于简化 SQL 查询，并有助于以后使用<strong class="jm io">连接</strong>。在将数据集保存到两个不同的文件中之后，现在就可以上传到 BigQuery 了。</strong></p><p id="c679" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你想按顺序查看我在这篇博客中讨论过的所有 SQL 查询，请点击这个<a class="ae mf" href="https://github.com/bishaldutta98/SQL_code_for_data_exploration/blob/main/SQL_code_1" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io">链接</strong> </a>。</p></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h1 id="5e96" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">目标</h1><ul class=""><li id="9217" class="mg mh in jm b jn lz jr ma jv mi jz mj kd mk kh ml mm mn mo bi translated">花时间处理数据并熟悉它。</li><li id="fee3" class="mg mh in jm b jn mp jr mq jv mr jz ms kd mt kh ml mm mn mo bi translated">找出当地和全球的死亡率。</li><li id="b14c" class="mg mh in jm b jn mp jr mq jv mr jz ms kd mt kh ml mm mn mo bi translated">找出本地和全球感染人口的百分比。</li><li id="96d9" class="mg mh in jm b jn mp jr mq jv mr jz ms kd mt kh ml mm mn mo bi translated">找出感染率最高的国家。</li><li id="fe68" class="mg mh in jm b jn mp jr mq jv mr jz ms kd mt kh ml mm mn mo bi translated">找出死亡人数最多的国家和大陆。</li><li id="f278" class="mg mh in jm b jn mp jr mq jv mr jz ms kd mt kh ml mm mn mo bi translated">使用联接来组合 covid_deaths 和 covid_vaccine 表。</li><li id="c620" class="mg mh in jm b jn mp jr mq jv mr jz ms kd mt kh ml mm mn mo bi translated">找出人口和接种疫苗的人数。</li><li id="e680" class="mg mh in jm b jn mp jr mq jv mr jz ms kd mt kh ml mm mn mo bi translated">了解接种人群和新增接种人群。</li></ul></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h1 id="201c" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">程序</h1><p id="0c9b" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">在对数据做了一些小的调整并将其分成两个不同的表之后，现在是时候将数据上传到 BigQuery 了。为此，打开<strong class="jm io"> BigQuery </strong>上的<strong class="jm io"> SQL 工作区</strong>，它是<strong class="jm io"> Google Cloud </strong>平台的一部分。在这里，如果您还没有创建项目，那么创建一个新项目。然后，在界面左侧的<strong class="jm io">资源管理器</strong>窗格下，单击与您已创建的项目相邻的<strong class="jm io">三个点</strong>，并单击<strong class="jm io">创建数据集</strong>选项。这将打开<strong class="jm io">创建数据集</strong>窗口。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/a7b20829014a3bf3d61c5fca5fb23815.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Qfmz_W-XwDc4o4bAB_RtQ.png"/></div></div></figure><p id="2444" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这里，在<strong class="jm io">数据集 ID </strong>部分，给数据集起一个合适的名字，然后<strong class="jm io">点击创建数据集</strong>。我将数据集命名为<strong class="jm io"> Covid19 </strong>。更新选项卡后，可以在项目下拉列表中找到这个新数据集。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/6d84f0ee7c2696413294ebe4b103041d.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*zjWqEUzKqd9_24bL9Cmxtw.png"/></div></figure><p id="0a73" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">既然已经创建了数据集，就必须将表插入到数据集中，该数据集中将包含以后要查询的数据。为此，<strong class="jm io">点击与<strong class="jm io"> Covid19 </strong>数据集相邻的<strong class="jm io">三个点</strong>上的</strong>，并<strong class="jm io">点击<strong class="jm io">上的</strong>创建表格</strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/bbce2ba9de1ee5190c80416d11e5e079.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*0wwP9eAGJcfiFuE4rugHIA.png"/></div></figure><p id="f1b3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这将打开<strong class="jm io">创建表</strong>窗口。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/faa022f3e08d0f5e4aa3fc2607f1929b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HIjGURLXIg9BngW5fbfEBA.png"/></div></div></figure><p id="9e37" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这里，从下拉列表中的<strong class="jm io">创建表格，选择<strong class="jm io">上传</strong>选项。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi my"><img src="../Images/e383961568b7a1e312a873f11e837589.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6UFSm_l0MfLaqU8Ra9dehw.png"/></div></div></figure><p id="1f1e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，从<strong class="jm io">选择文件</strong>选项，点击<strong class="jm io">浏览</strong>，然后选择您想要的文件。然后给表格起一个合适的名字，然后在<strong class="jm io">模式</strong>选项下，检查<strong class="jm io">自动检测</strong>选项。现在，点击<strong class="jm io">创建表格</strong>，表格将被添加。在我的例子中，我将表命名为<strong class="jm io"> covid_deaths </strong>和<strong class="jm io"> covid_vaccine </strong>。选项卡更新后，表格将在 Covid19 数据集下可见。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/761b39b1200c648e1b656fcc266176f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*gcYXXC4_K5oDzwW8Vlai1Q.png"/></div></figure><p id="5baf" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在已经插入了表，您可以继续进行数据探索过程。</p><h2 id="cecd" class="na lc in bd ld nb nc dn lh nd ne dp ll jv nf ng lp jz nh ni lt kd nj nk lx nl bi translated">花时间处理数据并熟悉它</h2><p id="cdbb" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">为了查看数据，我编写了以下查询:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/1f21f2aa616a65e2ea03caac4d207233.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*io2ZxwlyAZYM25NGSCd8Aw.png"/></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">查询 1</figcaption></figure><p id="3d91" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上面的查询中，我只是编写了<strong class="jm io"> SELECT </strong>、<strong class="jm io"> FROM </strong>和<strong class="jm io"> WHERE </strong>语句，后来又添加了<strong class="jm io"> ORDER BY </strong>语句来组织数据。我使用了<strong class="jm io"> WHERE </strong>语句从数据中过滤掉<strong class="jm io"> NULL </strong>值。这是拉出<strong class="jm io"> covid_deaths </strong>表的查询。上述查询的结果如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/9dd9e382870da41c493904e4a6eaacb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VfddUVGpdBMsUTVhh-RWQg.png"/></div></div></figure><p id="9c79" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我熟悉了表格的内容和表格中的所有列。</p><p id="4654" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">然后，我编写了相同的查询，但是针对的是<strong class="jm io"> covid_vaccine </strong>表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/799dc59f7501e0b9fa243248740f789b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*mtFfpk27yj1u8BCgTJ3-ow.png"/></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">查询 2</figcaption></figure><p id="957f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">上述查询的结果如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/e372217bd096d34a3f7c0e4216a37cfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TElFaFWgOByi2xGHDJowvw.png"/></div></div></figure><p id="b4eb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">从这两个表中，您可以看到像<strong class="jm io">位置</strong>和<strong class="jm io">日期</strong>这样的列在<strong class="jm io"> covid_deaths </strong>和<strong class="jm io"> covid_vaccine </strong>表中都很常见。这是非常有价值的信息，因为它将有助于以后连接两个表。</p><p id="c4bf" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">您还会注意到，有许多不必要的列此时并不需要，它们只是占用了表中的空间。为此，我将有选择地只选择每个查询需要的那些列。例如:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/3c06aa56394580a875a828c9ad6b7aa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*F0eE9y0PvGg-aQpIstoqXA.png"/></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">查询 3</figcaption></figure><p id="92ae" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">该查询的结果如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/d3262787b3a651f5fcfa6efa041aa9e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j1H3_264zmVtsm5i-56YRw.png"/></div></div></figure><p id="09fc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如您所见，现在的表格更加精确，易于阅读。</p></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h2 id="34f4" class="na lc in bd ld nb nc dn lh nd ne dp ll jv nf ng lp jz nh ni lt kd nj nk lx nl bi translated">找出当地和全球的死亡率</h2><p id="d15e" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated"><strong class="jm io">为了找到本地的死亡率</strong>(在我的例子中，对于<strong class="jm io">印度</strong>)，我编写了以下查询:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/c88ab6146fbde39b88f43a83541b7bf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vWPH6L33hhOUV8jh4xDcrQ.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">查询 4</figcaption></figure><p id="d39a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上面的查询中，我通过<strong class="jm io">将</strong>的<strong class="jm io">总死亡数</strong>除以<strong class="jm io">总病例数</strong>，然后<strong class="jm io">将</strong>乘以<strong class="jm io"> 100 </strong>将其转换成一个<strong class="jm io">百分比</strong>，找到了死亡率。我还给它起了一个别名<strong class="jm io">作为<strong class="jm io"> death_percent </strong>，这样列名就在结果表中指定了。我使用了<strong class="jm io"> WHERE </strong>语句来提取那些位置<strong class="jm io">位置</strong>为<strong class="jm io">印度</strong>并且<strong class="jm io">大陆</strong>不为<strong class="jm io"> NULL 的数据。</strong>上述查询的结果如下:</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/c0af4c510e252bae68cb630e6d278e54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6scdurUJ15h8eWDRYu9tOA.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">印度的死亡率</figcaption></figure><p id="ec2c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">最初，当病例非常少时，没有死亡，死亡在一段时间后开始，因此<strong class="jm io">死亡百分比</strong>的值在开始时为<strong class="jm io"> NULL </strong>。它开始于 2020 年 3 月 10 日<strong class="jm io">之后</strong>在印度，当你向下滚动表格时可以看到。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/6f9e1fd819258ba828cd0193e71d6117.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lzISXRO1lojkXTY55-u6RA.png"/></div></div></figure><p id="ff82" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">为了找到全球的死亡率，</strong>我编写了以下查询:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/4b1054d90451fe85b070c2ae0501a363.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fEPMqBcSUCy22BudXHk6uQ.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">查询 5</figcaption></figure><p id="da13" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这个查询中，我只是在<strong class="jm io"> WHERE </strong>子句中<strong class="jm io">没有</strong> <strong class="jm io">设置</strong><strong class="jm io">位置</strong>。查询的其余部分是相同的。上述查询的结果如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/766dfb7da993797df8999ec940ef759a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WyyDbmpYI3oHIQPkDnr3VQ.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">全球死亡率</figcaption></figure><p id="a61c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这张表中，与印度的情况相似，死亡并没有立即开始，如表中所示。它在一段时间后开始。</p><p id="f200" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">根据新增病例和新增死亡病例统计的全球死亡率</strong></p><p id="9781" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了找到这一点，我编写了以下查询:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/d92091c2132872411f9d5871bb56a87a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2AxTcL0jQv_IQgeUp7Y9Cw.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">查询 6</figcaption></figure><p id="d66d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上面的查询中，我选择了<strong class="jm io">日期</strong>、<strong class="jm io">新增 _ 病例</strong>的<strong class="jm io">总和</strong>、<strong class="jm io">别名</strong>为<strong class="jm io">合计 _ 新增 _ 病例</strong>、<strong class="jm io">新增 _ 死亡</strong>的<strong class="jm io">总和</strong>和<strong class="jm io">别名</strong>为<strong class="jm io">合计 _ 新增 _ 死亡</strong>，然后将<strong class="jm io">新增 _ 死亡的</strong>总和<strong class="jm io">除以我使用了<strong class="jm io"> CAST </strong>函数将<strong class="jm io"> new_deaths </strong>的<strong class="jm io">数据类型</strong>更改为<strong class="jm io"> integer </strong>，在我使用该列的任何地方。I <strong class="jm io">按<strong class="jm io">日期</strong>对</strong>进行分组，<strong class="jm io">按<strong class="jm io">日期</strong>和<strong class="jm io">对</strong>进行排序。上述查询的结果如下:</strong></strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/ac57f3c6e981606ee1754509d1c3d3ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AvFs-jnS8hKsJmm37gA51w.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">根据新病例和新死亡病例计算的全球死亡率</figcaption></figure><p id="7c54" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">全球总死亡率</strong></p><p id="8c25" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了找到这一点，我只是从<strong class="jm io">查询 6 </strong>中删除了<strong class="jm io">日期</strong>，它显示了全球的总体死亡率。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/3e138225d3a5675ce63a54c15da02d88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q6M9Lsx28YCjt4P6UkMT9g.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">查询 7</figcaption></figure><p id="b101" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">结果如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/78309cc9188e704dbc94d9af2380d6d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*wVkUpihAXqbj0zYPFcxi_w.png"/></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">全球总死亡率</figcaption></figure></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h2 id="b4ea" class="na lc in bd ld nb nc dn lh nd ne dp ll jv nf ng lp jz nh ni lt kd nj nk lx nl bi translated">找出本地和全球受感染人口的百分比</h2><p id="7532" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated"><strong class="jm io">为了找到当地(印度)感染人口的百分比</strong>，我编写了以下查询:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/9bdc90a2761039a0bd8724c788d2ec97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FkpPXuLVeLiuIAn-H5akAA.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">查询 8</figcaption></figure><p id="a0e3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上面的查询中，我保持其他内容不变，只是用<strong class="jm io">人口</strong>替换了<strong class="jm io">总死亡数</strong>(在之前的查询中)<strong class="jm io"> </strong>，并且为了找出<strong class="jm io">感染人口比率</strong>，我用<strong class="jm io">人口</strong>除以总病例数<strong class="jm io">，并通过</strong>将其转换为<strong class="jm io">百分比</strong>我还给它起了一个别名<strong class="jm io">作为<strong class="jm io">infected _ population _ percent</strong>，这样就创建了列标题以使表格易于理解。我还在<strong class="jm io"> WHERE </strong>语句中将<strong class="jm io">位置</strong>设置为<strong class="jm io"> India </strong>，以便<strong class="jm io">只过滤掉位置为 India 的那些数据。我是按地点和日期订的。上述查询的结果如下:</strong></strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/317144b2027ef79700134580cc811bd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lv0CbPcUUZnCHi1YJrZSLw.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">印度受感染人口百分比</figcaption></figure><p id="c469" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">找出全球感染人口的百分比</strong></p><p id="f956" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">提取全球感染人口百分比的查询几乎类似于<strong class="jm io">查询 6 </strong>，只是<strong class="jm io">位置</strong>没有设置在<strong class="jm io"> WHERE </strong>语句下。内容如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/0a5788a275bc0c93682dd32dbaf807a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ucmza5QOZZakpvpINNOXcA.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">查询 9</figcaption></figure><p id="6a97" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">上述查询的结果如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/7e4d2de0f798e1c1d0706bdcff997e1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZN4lXXf5WIG_CUZIccMvkQ.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">全球感染人口百分比</figcaption></figure></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h2 id="f79f" class="na lc in bd ld nb nc dn lh nd ne dp ll jv nf ng lp jz nh ni lt kd nj nk lx nl bi translated">找出感染率最高的国家</h2><p id="c808" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">为了找出感染率最高的国家，我编写了以下查询:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/51b8c60de9e87421c871f304cd06c960.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9aIofA2pjz4vtgNsHWWNhQ.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">查询 10</figcaption></figure><p id="e11f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上面的查询中，我使用<strong class="jm io"> MAX </strong>函数选择了<strong class="jm io">位置</strong>、<strong class="jm io">人口</strong>、<strong class="jm io">总病例数</strong>中的<strong class="jm io">最大值</strong>，并为其赋予了一个<strong class="jm io">别名</strong>作为<strong class="jm io">最大感染数</strong>，以及与上一个查询中相同的<strong class="jm io">感染人口百分比</strong>的最大值，并为其赋予了一个<strong class="jm io">别名</strong>我<strong class="jm io">注释掉</strong>过滤器将位置设置为印度，然后<strong class="jm io">将</strong>按<strong class="jm io">位置</strong>和<strong class="jm io">人口</strong>分组<strong class="jm io">并按<strong class="jm io">max _ infected _ population _ percent</strong>按<strong class="jm io">降序</strong>排序</strong>以便感染率最高的国家停留在表格的<strong class="jm io">顶端</strong>。</p><p id="8f4d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">上述查询的结果如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/3d90ef82acf1b73e35ccba114db2e0ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LYMdYL3pGY4InlJx2AqpBg.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">人均感染率最高的国家</figcaption></figure></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h2 id="cb92" class="na lc in bd ld nb nc dn lh nd ne dp ll jv nf ng lp jz nh ni lt kd nj nk lx nl bi translated">找出死亡人数最多的国家和大陆</h2><p id="7a2b" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated"><strong class="jm io">死亡人数最多的国家:</strong></p><p id="a566" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了找出死亡人数最多的国家，我编写了以下查询:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/d2641a551c5ed74808767fe1ef6c35ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*fT-JgGsSmGMhn6FF3O8cng.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">查询 11</figcaption></figure><p id="e2ee" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上面的查询中，我选择了<strong class="jm io">位置</strong>列和<strong class="jm io">总死亡数</strong>的<strong class="jm io">最大值</strong>和<strong class="jm io">别名</strong>为<strong class="jm io">最大死亡数</strong>。我使用了<strong class="jm io"> CAST </strong>函数，以便将<strong class="jm io"> total_deaths </strong>的<strong class="jm io">数据类型</strong>更改为一个<strong class="jm io">整数</strong>，因为它会导致其他问题(可能数据类型之前是一个字符串，所以查询无法读取 MAX 函数)。然后我用<strong class="jm io"> WHERE </strong>函数过滤掉<strong class="jm io"> NULL </strong>值，并用<strong class="jm io">按<strong class="jm io">位置</strong>对</strong>进行分组，用<strong class="jm io"> max_death_count </strong>按<strong class="jm io">降序</strong>的顺序对<strong class="jm io">进行排序</strong>，这样死亡人数最多的国家就位于表格的顶部。上述查询的结果如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/bd791de1938dd84c2dd4e2e180825e0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HE5agTV8q_r8VrrxIcNeBA.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">死亡人数最多的国家</figcaption></figure><p id="9caf" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">从上表可以清楚地看出，美国的死亡人数最高，印度也是死亡人数最高的五个国家之一。</p><p id="8efb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">死亡人数最多的大洲:</strong></p><p id="2e00" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了找出死亡人数最多的大陆，我编写了以下查询:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/1452f14b7e4abe334907c46f4e1fefec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*0EPLLwdMktas-d1vrh8TwQ.png"/></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">查询 12</figcaption></figure><p id="50cf" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上面的查询中，所有其他部分与<strong class="jm io">查询 9 </strong>相同，我只是通过语句将<strong class="jm io">选择</strong>和<strong class="jm io">组上的<strong class="jm io">位置</strong>改为<strong class="jm io">大陆</strong>。结果如下:</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/88dd0f222d2d27d5bf88f4cb597784bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B0keqG9ys6cHO1GOGL6Z4g.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">死亡人数最多的大陆</figcaption></figure><p id="3896" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">注意:</strong>我忽略了所有出现在<strong class="jm io">大陆</strong>列中的<strong class="jm io">空值</strong>。</p></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h2 id="aa86" class="na lc in bd ld nb nc dn lh nd ne dp ll jv nf ng lp jz nh ni lt kd nj nk lx nl bi translated">使用联接来组合 covid_deaths 和 covid_vaccine 表</h2><p id="7512" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">两个表，即<strong class="jm io"> covid_deaths </strong>和<strong class="jm io"> covid_vaccine </strong>可以结合起来，通过组合两个表中的数据来发现细节。为此，我使用<strong class="jm io">连接</strong>或<strong class="jm io">内部连接</strong>编写了以下查询。</p><p id="4023" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">注意</strong>:内部连接(join 或 Inner join)返回两个表中有匹配值的记录。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/c126476848e0b6e072fa2228b3424a6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1166/format:webp/1*pU4tBGNvEhO0PGpIJY0Hog.png"/></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">查询 13</figcaption></figure><p id="b6ed" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上面的查询中，我使用两个表共有的<strong class="jm io">位置</strong>和<strong class="jm io">日期</strong>列连接了两个表。在<strong class="jm io"> JOIN </strong>语句中，我将<strong class="jm io"> covid_deaths </strong>表命名为<strong class="jm io"> dea </strong>，将<strong class="jm io">covid _ vac</strong>表命名为<strong class="jm io"> vac </strong>。运行查询后的结果如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/4a3ce25b36ef35c2f6fe85945ddbe97b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2ip6NK34jByxG4jYk9jy_g.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/603a7b0f83dc10bc11c945e920ef86fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jOzqd7fKuia12m2xCtoX4Q.png"/></div></div></figure><p id="9fc5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上面的图片中，您可以看到两个表中的数据都存在，所以连接工作得很好。</p></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h2 id="bf37" class="na lc in bd ld nb nc dn lh nd ne dp ll jv nf ng lp jz nh ni lt kd nj nk lx nl bi translated">找出人口与接种疫苗的人数</h2><p id="4443" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">为了找到一个地方的人口和已经接种疫苗的人数，我编写了以下查询:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/9eb3712419d46506c1aecca08d6e715c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HQnpLNLiJJ1-hA4WF4zP5A.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">查询 14</figcaption></figure><p id="7fb6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上面的查询中，我使用了<strong class="jm io"> JOIN </strong>或<strong class="jm io"> INNER JOIN </strong>语句来连接两个表，连接方式与我在上一部分中解释的方式相同。如果您正在使用<strong class="jm io"> JOIN </strong>语句，您必须通过您在<strong class="jm io"> JOIN </strong>语句中为它们各自的表指定的名称来寻址列。在我的例子中，我将<strong class="jm io"> covid_deaths </strong>表命名为 dea，将<strong class="jm io"> covid_vaccine </strong>表命名为 vac，因此当我想从<strong class="jm io"> covid_death </strong>表中选择列 continent 时，我编写了<strong class="jm io">DEA . continental</strong>，以此类推。</p><p id="0219" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我选择了<strong class="jm io">DEA . continental</strong>，<strong class="jm io"> dea.location </strong>，<strong class="jm io"> dea.date </strong>，<strong class="jm io"> dea.population </strong>，以及<strong class="jm io">vac . new _ nevaccines</strong>。现在已经很熟悉了，我只从<strong class="jm io"> covid_vaccine </strong>表中选择了一列，其余的从<strong class="jm io"> covid_deaths </strong>表中选择。然后我使用<strong class="jm io"> WHERE </strong>语句应用了一个过滤器，以便从<strong class="jm io"> covid_death </strong>表的<strong class="jm io">大陆</strong>列中选择<strong class="jm io"> no NULL </strong>值。最后，我按<strong class="jm io">地点</strong>和<strong class="jm io">日期</strong>订购。</p><p id="12d9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">注意:在<strong class="jm io">订单日期</strong>语句中，我没有写<strong class="jm io"> dea </strong>或<strong class="jm io"> vac </strong>，因为它们是两个表中的公共字段，我使用这些字段来连接这两个表。</p><p id="a75d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">结果如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/248738719b525cbb6def8cd47ae4eda9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xDM8YTBLh0vO6O_6Ev48WA.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">人口与接种疫苗的人数</figcaption></figure><p id="1291" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上表中，您可以看到新的疫苗接种开始于<strong class="jm io">2021 年 3 月</strong>，一些国家很晚接种，一些国家更早接种。</p><p id="8d82" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">但是这个表格有一个缺点，那就是<strong class="jm io">没有计算<strong class="jm io">一个地方的人口接受的全部疫苗接种</strong>。为了解决这个问题，您可以使用<strong class="jm io"> new_vaccinations </strong>列上的<strong class="jm io">滚动计数</strong>。</strong></p><p id="700a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">使用滚动计数查找新接种的疫苗:</strong></p><p id="1c18" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">滚动计数</strong>不断将新值加到第一个值上，直到位置保持不变，当位置改变时重新开始。为此，我编写了以下查询:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/90b87f87eb5ea9eae9cb42da3e03dc3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZiJGl5LSwbCtXRFm5ZDbwA.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">查询 15</figcaption></figure><p id="9bce" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上面的查询中，我使用了<strong class="jm io"> JOIN </strong>来组合这两个表，就像我前面解释的那样，但是这里我使用了<strong class="jm io"> PARTITION BY </strong>来将数据划分为数据子集，并分别对这些子集执行计算。</p><p id="84d1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因此，我首先编写了一个查询，使用<strong class="jm io"> PARTITION BY </strong>子句对<strong class="jm io"> dea.location </strong>进行分区，并通过<strong class="jm io"> dea.location </strong>和<strong class="jm io"> dea.date </strong>对进行排序，然后我通过语句将<strong class="jm io">vac . new _ nevaccinations</strong>的<strong class="jm io"> SUM </strong>置于和<strong class="jm io">分区之上，并赋予它一个<strong class="jm io">这个查询所做的是:它首先<strong class="jm io">分隔</strong>所有的<strong class="jm io">位置</strong>，当<strong class="jm io">求和</strong>函数开始时，它继续<strong class="jm io">将</strong>加到<strong class="jm io">的第一个</strong>值上，直到<strong class="jm io">位置</strong>保持与<strong class="jm io">相同，</strong>，然后它再次开始。</strong></strong></p><p id="41bc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">同样，我将<strong class="jm io"> WHERE </strong>子句中的<strong class="jm io">筛选出<strong class="jm io">洲</strong>列中有<strong class="jm io"> NULL </strong>值的行，并按照<strong class="jm io">位置</strong>和<strong class="jm io">日期</strong>对<strong class="jm io">表进行排序。最终结果如下:</strong></strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/20b194bc81d4e17c004628a607085aab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wVSb5YsaiX-_ajj_rQtuBQ.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">新疫苗的滚动计数</figcaption></figure><p id="d15d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">从上表可以清楚地看出，预期的<strong class="jm io">滚动计数</strong>工作正常。</p><p id="2499" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">查找接受新疫苗接种的人口百分比:</strong></p><p id="e462" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这将类似于滚动计数，只是随着新疫苗接种的滚动计数，接受新疫苗接种的人口百分比也将被添加到一列中。</p><p id="f5be" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为此，我编写了以下查询:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/4de111acff9f86cd8786cd25c1c522da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WQwy4Lju4jpElBV0OJJyPg.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">查询 16</figcaption></figure><p id="9c3e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上面的查询中，一切都与<strong class="jm io">查询 15 </strong>相同，只是我在<strong class="jm io"> rolling_count_vac </strong>之后的<strong class="jm io"> SELECT </strong>语句中添加了另一部分，其中我取了<strong class="jm io"> rolling count </strong>段的<strong class="jm io">整体</strong>部分<strong class="jm io"> </strong>，并且<strong class="jm io">将</strong>除以<strong class="jm io">人口</strong>并将<strong class="jm io">乘以</strong>100<strong class="jm io">它的作用是:取滚动计数的值(如前一节所述)除以总人数，然后将比率乘以 100，得到新接种疫苗的总人数百分比。结果如下:</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/597fe6dadc4414dfb797434c6917980f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*riz8Ps__6J60gysp1VBCBA.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">接受新疫苗接种的人口百分比</figcaption></figure><p id="c07b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">从上表中可以看出，随着接种疫苗人数的增加，接种疫苗的总比例也在增加。</p><p id="789d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">注:</strong></p><ul class=""><li id="124e" class="mg mh in jm b jn jo jr js jv on jz oo kd op kh ml mm mn mo bi translated">如果您在<strong class="jm io"> Microsoft SQL Server </strong>上做这个项目，那么您可以创建一个<strong class="jm io"> CTE </strong>(公共表表达式)，然后用<strong class="jm io"> CTE </strong>除<strong class="jm io">人口</strong>，以获得相同的结果，使查询看起来更令人愉快，同时也简化了工作。可以按如下方式完成:</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/674b43f582afb7b9fe2c7685826173af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TknGVCdvmSv0LIW46uRTLQ.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">查询 17</figcaption></figure><ul class=""><li id="7ac5" class="mg mh in jm b jn jo jr js jv on jz oo kd op kh ml mm mn mo bi translated">如果您正在使用其他 SQL 工作空间，如 MySQL 或 SQL Lite 等。然后，您可以创建一个<strong class="jm io">临时表</strong>或<strong class="jm io">临时表</strong>，然后使用它来代替查询的<strong class="jm io">滚动计数</strong>部分，并将其除以总体。这也会产生同样的结果。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/31ab773d46fd03a5117fe1f46e84fb72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*te8VF3g2KHmVipHDSuRyAg.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">查询 18</figcaption></figure><ul class=""><li id="f203" class="mg mh in jm b jn jo jr js jv on jz oo kd op kh ml mm mn mo bi translated"><strong class="jm io">我起初无法创建临时表</strong>，因为我使用的是免费版的 BigQuery，它不允许我对表进行更改。因此，我单独编写了 temp 表中的查询，将该表保存在我的桌面上并重新加载文件，然后再次对其进行查询。虽然这是一个漫长的过程，但我想尝试新的方法来解决这个问题。</li></ul><p id="1340" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我首先编写并运行了以下查询:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/32a2eaec399e0265e0ed5327e8ce6572.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zq8V9DQ9MWKUBrcncBMDJQ.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">查询 19</figcaption></figure><p id="0437" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">运行查询后，结果如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/3e84003756b3b1d1646a00b360356344.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sb-DDnILv7kOLhNdBOtA2A.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">工作单元表</figcaption></figure><p id="15c8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，我将该表保存到我的桌面，并将其作为<strong class="jm io">percent _ population _ vaccined</strong>重新加载到<strong class="jm io"> Covid19 </strong>数据集中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/a67b773e9c0e76c4a0000ee85d6ed99f.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*OaJw8zJTDoQln4ZWNhjHMA.png"/></div></figure><p id="2970" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">然后，我运行以下查询，并再次运行它:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/88cdcac713d4ef71ef6e4a092f2eead1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4UCQmbHEiwj1zaQiZ2sGVA.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">查询 20</figcaption></figure><p id="2e8c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">运行上述查询后，我得到了下面的表，该表与之前的表相同:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/597fe6dadc4414dfb797434c6917980f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*riz8Ps__6J60gysp1VBCBA.png"/></div></div></figure></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><p id="17d0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这里，我总结了我在这个数据集上进行的所有数据探索。</p><h2 id="298f" class="na lc in bd ld nb nc dn lh nd ne dp ll jv nf ng lp jz nh ni lt kd nj nk lx nl bi translated">未来范围</h2><p id="3bd2" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">使用这个数据集可以做更多的事情，因为还有许多列我没有使用，例如患有<strong class="jm io">糖尿病</strong>和<strong class="jm io">心脏病</strong>的患者，以及它如何影响当地和全球的<strong class="jm io">感染</strong>和<strong class="jm io">死亡率</strong>，以及许多这样的见解。</p><p id="f206" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">可视化</strong>可以使用我在这个项目中提取的数据，这些数据可以进一步用于创建<strong class="jm io">仪表板</strong>。这是我下一步打算做的项目。</p></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h2 id="8ca1" class="na lc in bd ld nb nc dn lh nd ne dp ll jv nf ng lp jz nh ni lt kd nj nk lx nl bi translated">感谢您的阅读！</h2></div></div>    
</body>
</html>