<html>
<head>
<title>Fantastic PostgreSQL and how to make it work on MacOS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">神奇的PostgreSQL和如何让它在MacOS上工作</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/fantastic-postgresql-and-how-to-make-it-work-on-macos-ef839ff0aeb4?source=collection_archive---------10-----------------------#2020-08-03">https://blog.devgenius.io/fantastic-postgresql-and-how-to-make-it-work-on-macos-ef839ff0aeb4?source=collection_archive---------10-----------------------#2020-08-03</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/f019b4b3adb4f47a3c333c1e4b1b3b26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jz50ZqdYc4RKfnxJToV-RA.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">PostgresSQL徽标</figcaption></figure><p id="8d83" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">正如官方网站所说，PostgreSQL是一个强大的开源对象关系数据库系统。使用PostgreSQL的主要好处是显而易见的:如果你想通过<a class="ae kx" href="https://www.heroku.com/" rel="noopener ugc nofollow" target="_blank"> Heroku </a>将你的惊人项目部署到网络上，你最好使用它。</p><p id="5389" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">然而，让PostgreSQL工作起来可能真的很有挑战性。我已经尝试了几种安装PostgreSQL的方法(通过直接下载，gems等)，但是当我试图初始化我的数据库时，总是出现这个错误。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="21a7" class="lh li in ld b gy lj lk l ll lm">FATAL:  password authentication failed for user "username"<br/>Couldn't create 'new_app' database. Please check your configuration.<br/>rails aborted!</span></pre><p id="74e3" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我搜索了堆栈溢出，但我尝试的每一个建议都不适合我。终于碰到<a class="ae kx" href="https://www.robinwieruch.de/postgres-sql-macos-setup" rel="noopener ugc nofollow" target="_blank">这个教程</a>真的很有帮助。让我给你演示一下，并展示我得到的其他错误。</p><p id="c0d0" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">第0步</strong>:卸载现有的PostgreSQL</p><p id="93ab" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">如果你试图安装PostgreSQL但没有成功，你要做的第一件事就是从你的本地机器上删除它并卸载gem。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="07f6" class="lh li in ld b gy lj lk l ll lm">$ gem uninstall pg<br/>$ brew uninstall postgresql</span></pre><p id="4893" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">有时候这一小步可以解决你遇到的所有问题！</p><p id="09d3" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">第一步:</strong>安装PostgreSQL并检查你的版本</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="e023" class="lh li in ld b gy lj lk l ll lm">brew update<br/>brew install postgresql</span></pre><p id="0f9d" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">之后，确保您使用的是PostgreSQL的最新版本，以避免进一步的错误。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="bab4" class="lh li in ld b gy lj lk l ll lm">postgres --version</span></pre><p id="bbcf" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><em class="ln">边注:</em> <a class="ae kx" href="https://brew.sh/" rel="noopener ugc nofollow" target="_blank">强烈推荐使用家酿</a>包在MacOS上安装和管理应用。下面是一个安装命令。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="7ee5" class="lh li in ld b gy lj lk l ll lm">/bin/bash -c "$(curl -fsSL <a class="ae kx" href="https://raw.githubusercontent.com/Homebrew/install/master/install.sh" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/Homebrew/install/master/install.sh</a>)"</span></pre><p id="0b33" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">第二步:在你的硬盘上创建一个数据库</p><p id="0236" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">通常，硬盘上的数据库是自动创建的，但为了确保安全，请运行以下命令:</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="a7ef" class="lh li in ld b gy lj lk l ll lm">initdb /usr/local/var/postgres</span></pre><p id="dbe7" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">如果创建了数据库，您将看到以下错误消息:“initdb:directory”/usr/local/var/postgres”存在，但不为空</p><p id="9c50" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">步骤3: </strong>启动您的PostgreSQL数据库</p><p id="1b42" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">您可以使用以下命令手动启动数据库服务器:</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="253a" class="lh li in ld b gy lj lk l ll lm">pg_ctl -D /usr/local/var/postgres start</span></pre><p id="2396" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">终端应该向您发送一个响应——“服务器已启动”。</p><p id="5a72" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">这里我又得到了一个错误！</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lo"><img src="../Images/fbe9f69e470bd360e1997aaee27b1c9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EEbYKaxbtZiiSs0mw0nd9Q.png"/></div></div></figure><p id="c696" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">似乎另一个数据库正在我想使用的端口上运行。我试图停止数据库，然后重新启动，但它没有帮助。顺便说一下，要停止数据库，您可以使用这个命令。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="85de" class="lh li in ld b gy lj lk l ll lm">pg_ctl -D /usr/local/var/postgres stop</span></pre><p id="d6e1" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">所以，剩下的唯一办法就是杀死这只野兽。我是说，港口。</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/1a0b43f38bb2ef56dc1479e91a0ae490.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/1*n0u3blTmKNjS3dGpCKAqig.gif"/></div></figure><p id="f274" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我用过</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="8ca5" class="lh li in ld b gy lj lk l ll lm">sudo pkill -u postgres</span></pre><p id="325e" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">—实际上并不建议这样做，因为您看不到您要终止的是哪个端口。正如我后来发现的，更好的做法是使用<code class="fe lq lr ls ld b">lsof -wni tcp:5432.</code>最后四位数字是您要终止的端口的编号。</p><p id="6aa7" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">无论如何，它工作得非常完美！如下图所示，我的数据库终于启动了。耶！</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lt"><img src="../Images/6713a5c408ae9c196844031c94456829.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-8Tus3sgopMqIprOwP5A-w.png"/></div></div></figure><p id="7ae9" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">步骤4: </strong>为您的应用程序建立一个数据库</p><p id="ea5c" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">现在，当您的数据库打开时，您可以继续运行经典的:</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="e5cd" class="lh li in ld b gy lj lk l ll lm">rails new &lt;my-project&gt; --api -T --database=postgresql<br/>rails db:create<br/>rails db:migrate<br/>rails db:seed</span></pre><p id="6c96" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">第五步:</strong>随时检查你的迁移！</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lt"><img src="../Images/ef353392d8d64812c3e8514624e05a8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UnjQVY22XzTtHmkGuE8mBw.png"/></div></div></figure><p id="03c4" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">哦，如果你有时间，请看看我的项目！现在已经播出了，只需<a class="ae kx" href="https://pagan-sanctuary.netlify.app/" rel="noopener ugc nofollow" target="_blank"> <strong class="kb io">点击链接</strong> </a>。</p><p id="2084" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">来源:</strong></p><ol class=""><li id="0ec2" class="lu lv in kb b kc kd kg kh kk lw ko lx ks ly kw lz ma mb mc bi translated">【PostreSQL官方网站</li><li id="1d31" class="lu lv in kb b kc md kg me kk mf ko mg ks mh kw lz ma mb mc bi translated"><a class="ae kx" href="https://www.robinwieruch.de/postgres-sql-macos-setup" rel="noopener ugc nofollow" target="_blank">在MacOS上安装PostgreSQL的最佳教程</a></li><li id="b98f" class="lu lv in kb b kc md kg me kk mf ko mg ks mh kw lz ma mb mc bi translated"><a class="ae kx" href="https://github.com/PostgresApp/PostgresApp/issues/206" rel="noopener ugc nofollow" target="_blank">无法打开端口5432 </a></li><li id="843c" class="lu lv in kb b kc md kg me kk mf ko mg ks mh kw lz ma mb mc bi translated"><a class="ae kx" href="https://medium.com/@yutafujii_59175/pg-connectionbad-could-not-connect-to-server-no-such-file-or-directory-9a2eada16f9" rel="noopener">当Postgresql不工作时</a></li><li id="2760" class="lu lv in kb b kc md kg me kk mf ko mg ks mh kw lz ma mb mc bi translated"><a class="ae kx" href="https://pagan-sanctuary.netlify.app/" rel="noopener ugc nofollow" target="_blank">我的MOD 4熨斗项目</a></li></ol></div></div>    
</body>
</html>