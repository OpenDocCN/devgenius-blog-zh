<html>
<head>
<title>Memory management in swift (Part -02)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">swift ä¸­çš„å†…å­˜ç®¡ç†(ç¬¬äºŒéƒ¨åˆ†)</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://blog.devgenius.io/memory-management-in-swift-part-02-b5b5f9fbb12b?source=collection_archive---------3-----------------------#2021-04-14">https://blog.devgenius.io/memory-management-in-swift-part-02-b5b5f9fbb12b?source=collection_archive---------3-----------------------#2021-04-14</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="9c6b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æè¿°å¦‚ä½•åœ¨ Swift ä¸­ä½¿ç”¨è‡ªåŠ¨å¼•ç”¨è®¡æ•°æ¥ç®¡ç†åº”ç”¨ç¨‹åºå†…å­˜ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7b835364e10cb3e8e807555b3f197d07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V_DcKab9hOQSyXNrIgdRkQ.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">ä¹”çº³æ–¯Â·æ–¯ç»´å¾·æ‹‰æ–¯é€šè¿‡<a class="ae ky" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>æ‹æ‘„çš„ç…§ç‰‡</figcaption></figure><h1 id="a0c8" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">æ¦‚è§‚</h1><p id="05f7" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">åœ¨ iOS å¼€å‘ä¸­ï¼ŒARC(è‡ªåŠ¨å¼•ç”¨è®¡æ•°)ç”¨æ¥ç®¡ç† app å†…å­˜ã€‚å®ƒè·Ÿè¸ªåˆå§‹åŒ–çš„å¼•ç”¨ã€ä»£ç ä¹‹é—´çš„å…³ç³»ï¼Œå¹¶åœ¨ä¸å†éœ€è¦å®ä¾‹æ—¶è‡ªåŠ¨é‡Šæ”¾å®ƒä»¬ã€‚ä½†æœ‰æ—¶æ¸…ç†è¿‡ç¨‹ä¼šå› æŸäº›åŸå› è€Œä¸­æ–­ã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†äº†è§£åœ¨å§”æ‰˜å’Œé—­åŒ…çš„æƒ…å†µä¸‹ï¼ŒARC ä½•æ—¶æ— æ³•é‡Šæ”¾å†…å­˜ä»¥åŠå¦‚ä½•è§£å†³å®ƒã€‚å¦‚æœä½ æƒ³å­¦ä¹ å†…å­˜ç®¡ç†çš„åŸºç¡€çŸ¥è¯†ï¼Œå¯ä»¥çœ‹çœ‹æˆ‘çš„å†…å­˜ç®¡ç†æ•™ç¨‹çš„ç¬¬ä¸€éƒ¨åˆ†<a class="ae ky" href="https://levelup.gitconnected.com/arc-memory-management-in-swift-165fd0329f16" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>ã€‚</p><blockquote class="mc md me"><p id="52ef" class="jk jl mf jm b jn jo jp jq jr js jt ju mg jw jx jy mh ka kb kc mi ke kf kg kh ig bi translated"><em class="in">æœ¬æ•™ç¨‹ä½¿ç”¨</em> <strong class="jm io"> <em class="in"> Swift 5ï¼ŒXcode 12.4 ç¼–å†™ã€‚</em>T11ã€‘</strong></p></blockquote><h1 id="0b62" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">å§”æ‰˜ä¿ç•™å‘¨æœŸ</h1><p id="0680" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">æˆ‘ä»¬ç»å¸¸ä½¿ç”¨å§”æ‰˜åœ¨è§†å›¾ä¹‹é—´å‘é€æ•°æ®ã€‚å‡è®¾æˆ‘ä»¬ä½¿ç”¨å§”æ‰˜åœ¨<strong class="jm io"> FirstVC </strong>å’Œ<strong class="jm io"> SecondVC </strong>ä¹‹é—´ä¼ é€’æ•°æ®ã€‚</p><p id="9876" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å£°æ˜ä¸€ä¸ªåä¸º<strong class="jm io"> SendDataDelegate </strong>çš„åè®®ï¼Œå¹¶é€šè¿‡å®ƒè¿æ¥<strong class="jm io"> FirstVC </strong>å’Œ<strong class="jm io"> SecondVC </strong>ã€‚</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="5dbd" class="mo la in mk b gy mp mq l mr ms">protocol SendDataDelegate {}</span><span id="e953" class="mo la in mk b gy mt mq l mr ms">class FirstVC{<br/>    var delegate: SendDataDelegate?</span><span id="0f28" class="mo la in mk b gy mt mq l mr ms">    deinit{<br/>        print("Delegate ref removed from FirstVC")<br/>    }<br/>}</span><span id="a4c5" class="mo la in mk b gy mt mq l mr ms">class SecondVC: SendDataDelegate {<br/>    let vc = FirstVC()    <br/>    <br/>    init() { <br/>        vc.delegate = self<br/>    }</span><span id="a0a2" class="mo la in mk b gy mt mq l mr ms">    deinit{<br/>        print("Delegate ref removed from SecondVC")<br/>    }<br/>}</span><span id="1903" class="mo la in mk b gy mt mq l mr ms">var secondVC: SecondVC? = SecondVC()</span></pre><p id="d07d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æˆ‘ä»¬é€šè¿‡åˆ›å»º<strong class="jm io"> SecondVC </strong>çš„å¼•ç”¨æ¥è§¦å‘ VC ä¹‹é—´çš„è¿æ¥ã€‚æˆ‘ä»¬åœ¨æ¯ä¸ªç±»ä¸­éƒ½ç¼–å†™äº† deinit æ–¹æ³•æ¥æŒ‡ç¤º ARC ä½•æ—¶é‡Šæ”¾å†…å­˜ã€‚</p><p id="938d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">åœ¨è¿™ä¸ªé˜¶æ®µï¼Œ<strong class="jm io"> FirstVC </strong>å’Œ<strong class="jm io"> SecondVC </strong>ç›¸äº’ä¹‹é—´æœ‰å¾ˆå¼ºçš„å¼•ç”¨å…³ç³»ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/622988aa9d393bbf87768567fd2586dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*Tjd6oLfzcTNGbaHXfjySsw.png"/></div></figure><p id="d1d7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æˆ‘ä»¬æœŸæœ›å¦‚æœæˆ‘ä»¬è®¾ç½®<strong class="jm io">å˜é‡ secondVC: SecondVCï¼Ÿéšç€<strong class="jm io"> nil </strong>çš„å‡ºç°ï¼ŒARC æœ‰æœ›é€šè¿‡ç§»é™¤æœªä½¿ç”¨çš„å¼•ç”¨æ¥å®Œæˆæ¸…ç†è¿‡ç¨‹ã€‚ä½†æ˜¯ç­‰ç­‰ï¼Œä¸æ˜¯çš„ã€‚åœ¨æ‚¨çš„ä»£ç ä¸­å°è¯•ä¸€ä¸‹ï¼Œå¹¶æ£€æŸ¥æ§åˆ¶å°è¾“å‡ºï¼Œå®é™…ä¸Šæ²¡æœ‰è°ƒç”¨ deinit æ–¹æ³•ã€‚</strong></p><p id="48f5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">å°±åƒæˆ‘ä¹‹å‰è¯´çš„ï¼Œå°†å¯¹è±¡å€¼è®¾ç½®ä¸º nil åªæ˜¯ç§»é™¤äº†å¼•ç”¨ï¼Œè€Œæ²¡æœ‰é”€æ¯å¯¹è±¡ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/2327b59b41d4ed1cc34485ad49110a72.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*ngz3YCHXZ8c4Yu1mZ_u9FA.png"/></div></figure><p id="db54" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ä½ æ‰€è¦åšçš„å°±æ˜¯è®©å§”æ‰˜å¼•ç”¨å˜å¼±ã€‚å®ƒå°†åˆ›å»ºä»<strong class="jm io"> FirstVC </strong>åˆ°<strong class="jm io"> SecondVC </strong>çš„å¼±å¼•ç”¨ï¼Œä»è€Œè§£å†³äº†å†…å­˜ä¿ç•™å‘¨æœŸé—®é¢˜ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/b85eb1c431acc1f3258a2837395493f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/format:webp/1*NsEnfJt296BnLaY5Zj8Z2g.png"/></div></figure><p id="5192" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">è¿›è¡Œæ›´æ”¹ï¼Œè¿è¡Œæ‚¨çš„ä»£ç å¹¶æ£€æŸ¥æ‚¨çš„æ§åˆ¶å°ã€‚ARC èƒ½å¤Ÿå¦‚ä½ æ‰€æ„¿æ¸…ç†ä½ çš„è®°å¿†ã€‚</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="c68f" class="mo la in mk b gy mp mq l mr ms">protocol SendDataDelegate: class {}</span><span id="4ef6" class="mo la in mk b gy mt mq l mr ms">class FirstVC{<br/>    weak var delegate: SendDataDelegate?</span><span id="194f" class="mo la in mk b gy mt mq l mr ms">    deinit{<br/>        print("Delegate ref removed from FirstVC")<br/>    }<br/>}</span><span id="aa56" class="mo la in mk b gy mt mq l mr ms">class SecondVC: SendDataDelegate {<br/>    let vc = FirstVC()    <br/>    <br/>    init() { <br/>        vc.delegate = self<br/>    }</span><span id="a37b" class="mo la in mk b gy mt mq l mr ms">    deinit{<br/>        print("Delegate ref removed from SecondVC")<br/>    }<br/>}</span><span id="850d" class="mo la in mk b gy mt mq l mr ms">var secondVC: SecondVC? = SecondVC()<br/>secondVC = nil</span><span id="7977" class="mo la in mk b gy mt mq l mr ms"><strong class="mk io">Console Output: </strong></span><span id="0b64" class="mo la in mk b gy mt mq l mr ms">Delegate ref removed from SecondVC<br/>Delegate ref removed from FirstVC</span></pre><h1 id="05bd" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">é—­åˆä¿æŒå‘¨æœŸ</h1><p id="5cfd" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º<strong class="jm io"> Student </strong>çš„ swift ç±»ï¼Œå®ƒæœ‰ä¸¤ä¸ªå±æ€§<strong class="jm io"> studentClosure </strong>å’Œ<strong class="jm io"> name </strong>ã€‚<strong class="jm io">å­¦ç”Ÿ</strong>ç±»æœ‰ä¸€ä¸ª<strong class="jm io">å­¦ç”Ÿé—­åŒ…</strong>çš„å¼•ç”¨ï¼Œå› ä¸ºå®ƒæ˜¯è¯¥ç±»çš„ä¸€ä¸ªå±æ€§ã€‚</p><p id="deef" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">é€šè¿‡åˆ›å»ºä¸€ä¸ª<strong class="jm io">å­¦ç”Ÿ</strong>çš„å¯¹è±¡ï¼Œæˆ‘ä»¬ä¹Ÿåˆ›å»ºäº†ä¸€ä¸ªä»é—­åŒ…åˆ°<strong class="jm io">å­¦ç”Ÿ</strong>ç±»çš„å¼•ç”¨ã€‚</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="a139" class="mo la in mk b gy mp mq l mr ms">class Student {<br/>var studentClosure: (() -&gt; ())?<br/>var name: String = "Amit"</span><span id="dbce" class="mo la in mk b gy mt mq l mr ms">    init() {<br/>        studentClosure = {<br/>        print("\(self.name) is a student")<br/>    }<br/>  }</span><span id="bf12" class="mo la in mk b gy mt mq l mr ms">    deinit{<br/>        print("Student gone")<br/>    }<br/>}</span><span id="9e1e" class="mo la in mk b gy mt mq l mr ms">var studentObj: Student? = Student()<br/>studentObj?.studentClosure!()</span></pre><p id="37e3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œ<strong class="jm io"> Student </strong> class å’Œ<strong class="jm io"> studentClosure </strong>å½¼æ­¤éƒ½æœ‰ä¸€ä¸ªåè¿‡æ¥çš„å¼ºå…³ç³»ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/e4cbd3a87cd61cad1649768dc11d78ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*tPfKQcGhTv1Mcn7htGzdFA.png"/></div></figure><p id="a742" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬å°† studentObj çš„å€¼è®¾ç½®ä¸º 0ï¼Œæˆ‘ä»¬å¸Œæœ› ARC é€šè¿‡ä¸­æ–­æ‰€æœ‰å…³ç³»æ¥ä¸ºæˆ‘ä»¬é‡Šæ”¾å†…å­˜ã€‚ä½†ä¸å¹¸çš„æ˜¯ï¼Œè®¾ç½® nil ä¸èƒ½æ‰“ç ´<strong class="jm io">å­¦ç”Ÿ</strong>ç±»å’Œé—­åŒ…ä¹‹é—´çš„ä¿æŒå¾ªç¯ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/399326bb9569e1585466b6fe84120906.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*SJWanwUMgI9lL00FJVlL-w.png"/></div></figure><p id="e30f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨å¦‚ä¸‹çš„<strong class="jm io">å¼±</strong>å…³é”®å­—æ¥è§£å†³å†…å­˜æ³„æ¼ã€‚</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="da91" class="mo la in mk b gy mp mq l mr ms">init() {<br/>    studentClosure = { [weak self] in<br/>        guard let obj = self else {<br/>        return<br/>    }</span><span id="a032" class="mo la in mk b gy mt mq l mr ms">    print("\(obj.name) the Developer")<br/>  }<br/>}</span></pre><p id="f4c0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æ•è·<strong class="jm io">å¼±</strong>å†…é—­åˆæˆä¸ºå¯é€‰ç±»å‹ã€‚<strong class="jm io">å¼±</strong>å¼•ç”¨å¯ä»¥å…è®¸å°†å¼•ç”¨å¯¹è±¡è®¾ç½®ä¸º nilã€‚ç°åœ¨ ARC å¯ä»¥åƒæˆ‘ä»¬é¢„æœŸçš„é‚£æ ·é‡Šæ”¾æˆ‘ä»¬çš„å†…å­˜ï¼Œå¹¶å°†è°ƒç”¨ deinit()æ–¹æ³•ã€‚</p><p id="c893" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">å°†<strong class="jm io"> studentObj </strong>çš„å€¼è®¾ç½®ä¸º<strong class="jm io">é›¶</strong>å¹¶æ£€æŸ¥æ‚¨çš„æ§åˆ¶å°ã€‚</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="c7ee" class="mo la in mk b gy mp mq l mr ms">import UIKit<br/>class Student {<br/>    var studentClosure: (() -&gt; ())?<br/>    var name: String = "Amit"<br/>    <br/>    init() {<br/>        studentClosure = { [weak self] in<br/>            guard let obj = self else {<br/>                return<br/>            }<br/>            <br/>            print("\(obj.name) the Developer")<br/>        }<br/>    }<br/>    <br/>    deinit{<br/>        print("Student gone")<br/>    }<br/>}</span><span id="6802" class="mo la in mk b gy mt mq l mr ms">var studentObj: Student? = Student()<br/>studentObj?.studentClosure!()<br/>studentObj = nil</span><span id="6c0e" class="mo la in mk b gy mt mq l mr ms"><strong class="mk io">Console Output:</strong></span><span id="19b0" class="mo la in mk b gy mt mq l mr ms">Amit the Developer<br/>Student gone</span></pre><p id="eb6e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ä½ ä¹Ÿå¯ä»¥åœ¨é—­åŒ…å†…æ•è·è‡ªå·±ä½œä¸º<strong class="jm io">æ— ä¸»</strong>ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨å®ƒä¹‹å‰è¦ç¡®ä¿ä½ çŸ¥é“ã€‚</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="e801" class="mo la in mk b gy mp mq l mr ms">init() {<br/>    bobClosure = { [unowned self] in<br/>      print("\(self.name) the Developer")<br/>    }<br/>  }</span></pre><p id="5334" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æˆ‘æƒ³ç°åœ¨æ‚¨å·²ç»å¯¹ä½¿ç”¨ Swift ç¼–ç¨‹è¯­è¨€è¿›è¡Œå†…å­˜ç®¡ç†æœ‰äº†ä¸€äº›äº†è§£ã€‚æ‚¨å¯ä»¥åœ¨ Swift çš„å®˜æ–¹æ–‡æ¡£ä¸­æ‰¾åˆ°å¯¹å®ƒä»¬çš„ç®€çŸ­è®¨è®ºã€‚</p><p id="8a42" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰ç”¨ï¼Œè¯·åˆ†äº«å¹¶é¼“æŒğŸ‘ğŸ‘ğŸ‘<br/>åœ¨<a class="ae ky" href="https://medium.com/@arifulislam14" rel="noopener">åª’ä½“</a>ä¸ŠæŸ¥çœ‹æˆ‘çš„å…¶ä»–æ–‡ç« ï¼Œåœ¨<a class="ae ky" href="https://www.linkedin.com/in/arifparvez14/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>ä¸Šç»™æˆ‘è¿çº¿ã€‚</p><p id="0a50" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æ„Ÿè°¢æ‚¨é˜…è¯»&amp;å¿«ä¹ç¼–ç ğŸ™‚</p></div></div>    
</body>
</html>