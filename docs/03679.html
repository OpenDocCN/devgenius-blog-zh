<html>
<head>
<title>Vuetify — Calendar Categories and Drag and Drop</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">虚拟化—日历类别和拖放</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/vuetify-calendar-categories-and-drag-and-drop-dbbfdac84bff?source=collection_archive---------2-----------------------#2020-12-02">https://blog.devgenius.io/vuetify-calendar-categories-and-drag-and-drop-dbbfdac84bff?source=collection_archive---------2-----------------------#2020-12-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/4c210491227338508e14936f7a1fc54e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6LYdQNS4ZLYU3NXd"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://unsplash.com/@mockaroon?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">莫卡龙</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><p id="2fe9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vuetify 是一个流行的 Vue 应用程序 UI 框架。</p><p id="4633" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解如何使用 Vuetify 框架。</p><h1 id="f673" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">日历类别</h1><p id="f71e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用各种类别对日历事件进行分类。</p><p id="79b1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="b7fd" class="mn lc iq mj b gy mo mp l mq mr">&lt;template&gt;<br/>  &lt;v-container&gt;<br/>    &lt;v-row class="text-center"&gt;<br/>      &lt;v-col col="12"&gt;<br/>        &lt;v-sheet height="64"&gt;<br/>          &lt;v-toolbar flat color="white"&gt;<br/>            &lt;v-btn outlined class="mr-4" color="grey darken-2" @click="setToday"&gt;Today&lt;/v-btn&gt;<br/>            &lt;v-btn fab text small color="grey darken-2" @click="prev"&gt;<br/>              &lt;v-icon small&gt;mdi-chevron-left&lt;/v-icon&gt;<br/>            &lt;/v-btn&gt;<br/>            &lt;v-btn fab text small color="grey darken-2" @click="next"&gt;<br/>              &lt;v-icon small&gt;mdi-chevron-right&lt;/v-icon&gt;<br/>            &lt;/v-btn&gt;<br/>            &lt;v-toolbar-title v-if="$refs.calendar"&gt;{{ $refs.calendar.title }}&lt;/v-toolbar-title&gt;<br/>            &lt;v-spacer&gt;&lt;/v-spacer&gt;<br/>          &lt;/v-toolbar&gt;<br/>        &lt;/v-sheet&gt;<br/>        &lt;v-sheet height="600"&gt;<br/>          &lt;v-calendar<br/>            ref="calendar"<br/>            v-model="focus"<br/>            color="primary"<br/>            type="category"<br/>            category-show-all<br/>            :categories="categories"<br/>            :events="events"<br/>            :event-color="getEventColor"<br/>            <a class="ae kc" href="http://twitter.com/change" rel="noopener ugc nofollow" target="_blank">@change</a>="fetchEvents"<br/>          &gt;&lt;/v-calendar&gt;<br/>        &lt;/v-sheet&gt;<br/>      &lt;/v-col&gt;<br/>    &lt;/v-row&gt;<br/>  &lt;/v-container&gt;<br/>&lt;/template&gt;</span><span id="17c5" class="mn lc iq mj b gy ms mp l mq mr">&lt;script&gt;<br/>export default {<br/>  name: "HelloWorld",<br/>  data: () =&gt; ({<br/>    focus: "",<br/>    events: [],<br/>    colors: [<br/>      "blue",<br/>      "indigo",<br/>      "deep-purple"<br/>    ],<br/>    names: [<br/>      "Meeting",<br/>      "Holiday",<br/>      "Leave"<br/>    ],<br/>    categories: ["John Smith", "Mary Walker"],<br/>  }),<br/>  mounted() {<br/>    this.$refs.calendar.checkChange();<br/>  },<br/>  methods: {<br/>    getEventColor(event) {<br/>      return event.color;<br/>    },<br/>    setToday() {<br/>      this.focus = "";<br/>    },<br/>    prev() {<br/>      this.$refs.calendar.prev();<br/>    },<br/>    next() {<br/>      this.$refs.calendar.next();<br/>    },<br/>    fetchEvents({ start, end }) {<br/>      const events = [];</span><span id="eed3" class="mn lc iq mj b gy ms mp l mq mr">      const min = new Date(`${start.date}T00:00:00`);<br/>      const max = new Date(`${end.date}T23:59:59`);<br/>      const days = (max.getTime() - min.getTime()) / 86400000;<br/>      const eventCount = this.rnd(days, days + 20);</span><span id="5dc6" class="mn lc iq mj b gy ms mp l mq mr">      for (let i = 0; i &lt; eventCount; i++) {<br/>        const allDay = this.rnd(0, 3) === 0;<br/>        const firstTimestamp = this.rnd(min.getTime(), max.getTime());<br/>        const first = new Date(firstTimestamp - (firstTimestamp % 900000));<br/>        const secondTimestamp = this.rnd(2, allDay ? 288 : 8) * 900000;<br/>        const second = new Date(first.getTime() + secondTimestamp);</span><span id="0326" class="mn lc iq mj b gy ms mp l mq mr">        events.push({<br/>          name: this.names[this.rnd(0, this.names.length - 1)],<br/>          start: first,<br/>          end: second,<br/>          color: this.colors[this.rnd(0, this.colors.length - 1)],<br/>          timed: !allDay,<br/>          category: this.categories[this.rnd(0, this.categories.length - 1)],<br/>        });<br/>      }</span><span id="078e" class="mn lc iq mj b gy ms mp l mq mr">      this.events = events;<br/>    },<br/>    rnd(a, b) {<br/>      return Math.floor((b - a + 1) * Math.random()) + a;<br/>    },<br/>  },<br/>};<br/>&lt;/script&gt;</span></pre><p id="b975" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将<code class="fe mt mu mv mj b">categories</code>设置为我们想要显示的类别。</p><p id="a898" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">category-show-all</code>显示所有类别。</p><p id="031c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们将<code class="fe mt mu mv mj b">type</code>属性设置为<code class="fe mt mu mv mj b">category</code>，以便显示事件类别。</p><h1 id="3d4e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">拖放</h1><p id="d929" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以在日历中拖放事件。</p><p id="0190" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="6874" class="mn lc iq mj b gy mo mp l mq mr">&lt;template&gt;<br/>  &lt;v-container&gt;<br/>    &lt;v-row class="text-center"&gt;<br/>      &lt;v-col col="12"&gt;<br/>        &lt;v-sheet height="600"&gt;<br/>          &lt;v-calendar<br/>            ref="calendar"<br/>            v-model="value"<br/>            color="primary"<br/>            type="4day"<br/>            :events="events"<br/>            :event-color="getEventColor"<br/>            :event-ripple="false"<br/>            @change="getEvents"<br/>            @mousedown:event="startDrag"<br/>            @mousedown:time="startTime"<br/>            @mousemove:time="mouseMove"<br/>            @mouseup:time="endDrag"<br/>            @mouseleave.native="cancelDrag"<br/>          &gt;<br/>            &lt;template #event="{ event, timed, eventSummary }"&gt;<br/>              &lt;div class="v-event-draggable" v-html="eventSummary()"&gt;&lt;/div&gt;<br/>              &lt;div v-if="timed" class="v-event-drag-bottom" @mousedown.stop="extendBottom(event)"&gt;&lt;/div&gt;<br/>            &lt;/template&gt;<br/>          &lt;/v-calendar&gt;<br/>        &lt;/v-sheet&gt;<br/>      &lt;/v-col&gt;<br/>    &lt;/v-row&gt;<br/>  &lt;/v-container&gt;<br/>&lt;/template&gt;</span><span id="fbe9" class="mn lc iq mj b gy ms mp l mq mr">&lt;script&gt;<br/>export default {<br/>  name: "HelloWorld",<br/>  data: () =&gt; ({<br/>    value: "",<br/>    events: [],<br/>    colors: [<br/>      "red",<br/>      "green",<br/>      "blue",<br/>    ],<br/>    names: [<br/>      "Birthday",<br/>      "Conference",<br/>      "Party",<br/>    ],<br/>    dragEvent: null,<br/>    dragStart: null,<br/>    createEvent: null,<br/>    createStart: null,<br/>    extendOriginal: null,<br/>  }),<br/>  methods: {<br/>    startDrag({ event, timed }) {<br/>      if (event &amp;&amp; timed) {<br/>        this.dragEvent = event;<br/>        this.dragTime = null;<br/>        this.extendOriginal = null;<br/>      }<br/>    },<br/>    startTime(tms) {<br/>      const mouse = this.toTime(tms);</span><span id="f1e1" class="mn lc iq mj b gy ms mp l mq mr">      if (this.dragEvent &amp;&amp; this.dragTime === null) {<br/>        const start = this.dragEvent.start;</span><span id="d583" class="mn lc iq mj b gy ms mp l mq mr">        this.dragTime = mouse - start;<br/>      } else {<br/>        this.createStart = this.roundTime(mouse);<br/>        this.createEvent = {<br/>          name: `Event #${this.events.length}`,<br/>          color: this.rndElement(this.colors),<br/>          start: this.createStart,<br/>          end: this.createStart,<br/>          timed: true,<br/>        };</span><span id="4d9b" class="mn lc iq mj b gy ms mp l mq mr">        this.events.push(this.createEvent);<br/>      }<br/>    },<br/>    extendBottom(event) {<br/>      this.createEvent = event;<br/>      this.createStart = event.start;<br/>      this.extendOriginal = event.end;<br/>    },<br/>    mouseMove(tms) {<br/>      const mouse = this.toTime(tms);</span><span id="69aa" class="mn lc iq mj b gy ms mp l mq mr">      if (this.dragEvent &amp;&amp; this.dragTime !== null) {<br/>        const start = this.dragEvent.start;<br/>        const end = this.dragEvent.end;<br/>        const duration = end - start;<br/>        const newStartTime = mouse - this.dragTime;<br/>        const newStart = this.roundTime(newStartTime);<br/>        const newEnd = newStart + duration;</span><span id="21b3" class="mn lc iq mj b gy ms mp l mq mr">        this.dragEvent.start = newStart;<br/>        this.dragEvent.end = newEnd;<br/>      } else if (this.createEvent &amp;&amp; this.createStart !== null) {<br/>        const mouseRounded = this.roundTime(mouse, false);<br/>        const min = Math.min(mouseRounded, this.createStart);<br/>        const max = Math.max(mouseRounded, this.createStart);</span><span id="6541" class="mn lc iq mj b gy ms mp l mq mr">        this.createEvent.start = min;<br/>        this.createEvent.end = max;<br/>      }<br/>    },<br/>    endDrag() {<br/>      this.dragTime = null;<br/>      this.dragEvent = null;<br/>      this.createEvent = null;<br/>      this.createStart = null;<br/>      this.extendOriginal = null;<br/>    },<br/>    cancelDrag() {<br/>      if (this.createEvent) {<br/>        if (this.extendOriginal) {<br/>          this.createEvent.end = this.extendOriginal;<br/>        } else {<br/>          const i = this.events.indexOf(this.createEvent);<br/>          if (i !== -1) {<br/>            this.events.splice(i, 1);<br/>          }<br/>        }<br/>      }</span><span id="312d" class="mn lc iq mj b gy ms mp l mq mr">      this.createEvent = null;<br/>      this.createStart = null;<br/>      this.dragTime = null;<br/>      this.dragEvent = null;<br/>    },<br/>    roundTime(time, down = true) {<br/>      const roundTo = 15;<br/>      const roundDownTime = roundTo * 60 * 1000;</span><span id="77e2" class="mn lc iq mj b gy ms mp l mq mr">      return down<br/>        ? time - (time % roundDownTime)<br/>        : time + (roundDownTime - (time % roundDownTime));<br/>    },<br/>    toTime(tms) {<br/>      return new Date(<br/>        tms.year,<br/>        tms.month - 1,<br/>        tms.day,<br/>        tms.hour,<br/>        tms.minute<br/>      ).getTime();<br/>    },<br/>    getEventColor(event) {<br/>      const rgb = parseInt(event.color.substring(1), 16);<br/>      const r = (rgb &gt;&gt; 16) &amp; 0xff;<br/>      const g = (rgb &gt;&gt; 8) &amp; 0xff;<br/>      const b = (rgb &gt;&gt; 0) &amp; 0xff;</span><span id="6114" class="mn lc iq mj b gy ms mp l mq mr">      return event === this.dragEvent<br/>        ? `rgba(${r}, ${g}, ${b}, 0.7)`<br/>        : event === this.createEvent<br/>        ? `rgba(${r}, ${g}, ${b}, 0.7)`<br/>        : event.color;<br/>    },<br/>    getEvents({ start, end }) {<br/>      const events = [];</span><span id="3872" class="mn lc iq mj b gy ms mp l mq mr">      const min = new Date(`${start.date}T00:00:00`).getTime();<br/>      const max = new Date(`${end.date}T23:59:59`).getTime();<br/>      const days = (max - min) / 86400000;<br/>      const eventCount = this.rnd(days, days + 20);</span><span id="ac76" class="mn lc iq mj b gy ms mp l mq mr">      for (let i = 0; i &lt; eventCount; i++) {<br/>        const timed = this.rnd(0, 3) !== 0;<br/>        const firstTimestamp = this.rnd(min, max);<br/>        const secondTimestamp = this.rnd(2, timed ? 8 : 288) * 900000;<br/>        const start = firstTimestamp - (firstTimestamp % 900000);<br/>        const end = start + secondTimestamp;</span><span id="e55c" class="mn lc iq mj b gy ms mp l mq mr">        events.push({<br/>          name: this.rndElement(this.names),<br/>          color: this.rndElement(this.colors),<br/>          start,<br/>          end,<br/>          timed,<br/>        });<br/>      }</span><span id="e49a" class="mn lc iq mj b gy ms mp l mq mr">      this.events = events;<br/>    },<br/>    rnd(a, b) {<br/>      return Math.floor((b - a + 1) * Math.random()) + a;<br/>    },<br/>    rndElement(arr) {<br/>      return arr[this.rnd(0, arr.length - 1)];<br/>    },<br/>  },<br/>};<br/>&lt;/script&gt;</span></pre><p id="b808" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有<code class="fe mt mu mv mj b">mousedown</code>和<code class="fe mt mu mv mj b">mouseup</code>事件让我们处理事件的拖放。</p><p id="1529" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">移动事件时事件的开始和结束时间。</p><p id="303e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我们移动日历项目时,<code class="fe mt mu mv mj b">startTime</code>事件设置<code class="fe mt mu mv mj b">this.createEvent</code>。</p><p id="d7ec" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在<code class="fe mt mu mv mj b">mouseMove</code>方法中，我们设置开始和结束日期。</p><p id="8e3d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，当我们拖放它时，我们将看到事件更新。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/8ed7f0f1787f08f69f6cb0cf368d4d59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fbsJKsavHwW-QuYp"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@maddibazzocco?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Maddi Bazzocco </a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h1 id="9cd5" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="ad53" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以创建移动事件和设置类别的日历。</p></div></div>    
</body>
</html>