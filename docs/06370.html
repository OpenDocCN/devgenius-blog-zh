<html>
<head>
<title>Docker Disk Space Management — Tips for Managing Resources</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Docker磁盘空间管理—管理资源的提示</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/docker-disk-space-management-tips-for-managing-resources-ca96999a6d47?source=collection_archive---------11-----------------------#2022-01-03">https://blog.devgenius.io/docker-disk-space-management-tips-for-managing-resources-ca96999a6d47?source=collection_archive---------11-----------------------#2022-01-03</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="df88" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">许多Docker用户面临的一个常见挑战是找到有效管理磁盘空间的方法。这篇博文将讨论解决这个问题的各种方法，并帮助您保持系统平稳运行！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7d6f990f7b75340351dba40f15fc4c01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cv-2Zffapx7kUQw2"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@isaacmsmith?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">艾萨克·史密斯</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><h1 id="640a" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">磁盘空间消耗</h1><p id="797e" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">创建映像和运行容器会消耗磁盘空间，稍后您可能想要回收这些空间。以下是不知不觉中消耗磁盘空间的一些方式:</p><ul class=""><li id="104a" class="mc md in jm b jn jo jr js jv me jz mf kd mg kh mh mi mj mk bi translated">停止后，未通过使用<em class="mp"> docker run </em>命令上的<code class="fe ml mm mn mo b">--rm</code>开关或使用<em class="mp"> docker rm </em>命令移除的停止容器。</li><li id="49b5" class="mc md in jm b jn mq jr mr jv ms jz mt kd mu kh mh mi mj mk bi translated">未使用的图像:未被其他图像或容器引用的图像。</li><li id="4361" class="mc md in jm b jn mq jr mr jv ms jz mt kd mu kh mh mi mj mk bi translated">悬空图像:没有名字的图像。当你<em class="mp"> docker构建</em>一个标签和以前一样的图像，新的标签替换了旧的标签，旧的标签变得悬空时，就会发生这种情况。</li><li id="1eb3" class="mc md in jm b jn mq jr mr jv ms jz mt kd mu kh mh mi mj mk bi translated">未使用的卷。</li></ul><p id="ed88" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Slimmer、UnionFS和Init-containers等工具可以通过将多个图像合并到一个层中来帮助您减小图像大小。像docker-gc这样的工具会删除使用Docker API而被孤立的停止的容器</p><p id="3d10" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">手动一个接一个地删除它们可能很繁琐，但是有垃圾收集命令可以帮助您做到这一点。</p><h1 id="2a8c" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">回收磁盘空间</h1><p id="cd2d" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">大多数命令要求交互式确认，但是如果您想在无人值守的情况下运行它们，您可以添加-f开关。</p><p id="5a73" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">您可以运行以下命令来删除不需要的项目:</p><pre class="kj kk kl km gt mv mo mw mx aw my bi"><span id="bc9a" class="mz la in mo b gy na nb l nc nd">docker container prune -f<br/>docker volume prune -f<br/>docker image prune -ff</span></pre><p id="f515" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">回收磁盘空间的另一种方法是删除未使用的卷。您可以使用<code class="fe ml mm mn mo b">docker volume ls </code>命令列出您的所有卷，并查看哪些卷没有被使用:</p><p id="e340" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要删除未使用的卷，可以运行以下命令:</p><pre class="kj kk kl km gt mv mo mw mx aw my bi"><span id="2fa5" class="mz la in mo b gy na nb l nc nd">docker volume rm &lt;VOLUME_NAME&gt;</span></pre><p id="abfd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这将删除容器、卷和图像。请注意，这不会删除您的数据或这些项目中的任何内容；它只是从Docker中删除它们的关联</p><p id="7120" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">请注意，只有悬挂的图像会被删除。保留未使用的图像，这在网络连接稀缺或不可用的情况下很好，因为这意味着您保留了基本图像，这些图像在以后可能会有用。如果您想删除所有未使用的图像，只需使用以下命令:</p><pre class="kj kk kl km gt mv mo mw mx aw my bi"><span id="89cb" class="mz la in mo b gy na nb l nc nd">docker image prune  — all</span></pre><p id="fccb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">默认情况下，如果当前没有使用卷的容器，则不会删除卷以防止重要数据被删除。运行命令时使用<code class="fe ml mm mn mo b">--volumes</code>标志来清理卷。</p><pre class="kj kk kl km gt mv mo mw mx aw my bi"><span id="d4aa" class="mz la in mo b gy na nb l nc nd">docker system prune -a --volumes</span></pre></div><div class="ab cl ne nf hr ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ig ih ii ij ik"><p id="b856" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Docker是一个开源项目，它通过提供额外的抽象和自动化层来自动化软件容器内的应用程序部署。在任何应用程序中，磁盘空间管理问题都是一个值得关注的问题，所以在使用docker时，知道如何正确管理您的资源是很重要的，希望这篇文章对您有所帮助，下次再见！</p></div></div>    
</body>
</html>