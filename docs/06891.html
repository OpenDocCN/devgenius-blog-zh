<html>
<head>
<title>Behind the curtain of the internet: Sockets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">互联网的幕后:套接字</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/behind-the-curtain-of-the-internet-sockets-811a88cfe29?source=collection_archive---------14-----------------------#2022-02-09">https://blog.devgenius.io/behind-the-curtain-of-the-internet-sockets-811a88cfe29?source=collection_archive---------14-----------------------#2022-02-09</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="fdd2" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">客户端套接字服务器体系结构介绍</h2></div><h1 id="070a" class="kc kd in bd ke kf kg kh ki kj kk kl km jt kn ju ko jw kp jx kq jz kr ka ks kt bi translated">什么是插座？</h1><p id="cdd9" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">套接字是网络上运行的两个程序之间的双向通信流中的端点。在客户机-服务器体系结构中，一个套接字是客户机，一个套接字是服务器。也有对等网络，需要较少的基础设施来建立，但通常有较差的性能(这里有一个链接来了解更多关于<a class="ae lq" href="https://pediaa.com/difference-between-peer-to-peer-and-client-server-network/" rel="noopener ugc nofollow" target="_blank">具体差异</a>)。</p><p id="7ee8" class="pw-post-body-paragraph ku kv in kw b kx lr jo kz la ls jr lc ld lt lf lg lh lu lj lk ll lv ln lo lp ig bi translated">在本教程中，我将重点介绍客户端-服务器设计。</p><h1 id="2376" class="kc kd in bd ke kf kg kh ki kj kk kl km jt kn ju ko jw kp jx kq jz kr ka ks kt bi translated">什么是客户机-服务器体系结构？</h1><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/cba8a345b4024b12459b370401f90209.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/format:webp/1*qaevMfJ2aX0X6a4m98TLqA.png"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">照片由<a class="ae lq" href="https://www.omnisci.com/technical-glossary/client-server" rel="noopener ugc nofollow" target="_blank"> omnisci </a>拍摄</figcaption></figure><p id="bbca" class="pw-post-body-paragraph ku kv in kw b kx lr jo kz la ls jr lc ld lt lf lg lh lu lj lk ll lv ln lo lp ig bi translated">在这个模型中，我们有中央资源存储(服务器)，客户端连接到它并请求资源(数据、计算能力等)。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/3c8acfd44e0d7e244f91d386314b5408.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yc2C6XmVuF5_w9aIZcbbHA.png"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">照片由<a class="ae lq" href="https://www.javatpoint.com/socket-programming" rel="noopener ugc nofollow" target="_blank"> javapoint </a>拍摄</figcaption></figure><p id="f683" class="pw-post-body-paragraph ku kv in kw b kx lr jo kz la ls jr lc ld lt lf lg lh lu lj lk ll lv ln lo lp ig bi translated">在图中，我们可以看到服务器和客户端之间的工作流</p><ol class=""><li id="5fd5" class="mj mk in kw b kx lr la ls ld ml lh mm ll mn lp mo mp mq mr bi translated">服务器监听请求(通常总是发生，否则就会出现臭名昭著的 404 异常)</li><li id="bf27" class="mj mk in kw b kx ms la mt ld mu lh mv ll mw lp mo mp mq mr bi translated">客户端连接到服务器</li><li id="5411" class="mj mk in kw b kx ms la mt ld mu lh mv ll mw lp mo mp mq mr bi translated">客户端向服务器请求一些东西</li><li id="4b2c" class="mj mk in kw b kx ms la mt ld mu lh mv ll mw lp mo mp mq mr bi translated">服务器用请求的资源响应客户端</li><li id="dda1" class="mj mk in kw b kx ms la mt ld mu lh mv ll mw lp mo mp mq mr bi translated">连接关闭</li></ol><p id="9518" class="pw-post-body-paragraph ku kv in kw b kx lr jo kz la ls jr lc ld lt lf lg lh lu lj lk ll lv ln lo lp ig bi translated">现在我们已经了解了设计和工作流，让我们创建自己的例子。</p><h1 id="e266" class="kc kd in bd ke kf kg kh ki kj kk kl km jt kn ju ko jw kp jx kq jz kr ka ks kt bi translated">案例研究:多线程客户机服务器</h1><p id="b843" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">在我们的示例中，我们将创建一个使用线程的服务器，这样它就可以同时连接到多个客户端。然后，我们将两个客户端连接到服务器，并发送一些消息。</p><h2 id="4c0c" class="mx kd in bd ke my mz dn ki na nb dp km ld nc nd ko lh ne nf kq ll ng nh ks ni bi translated">服务器类别</h2><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="ae62" class="pw-post-body-paragraph ku kv in kw b kx lr jo kz la ls jr lc ld lt lf lg lh lu lj lk ll lv ln lo lp ig bi translated">我们的服务器是一个可执行的方法。我们在端口 8000 创建一个套接字，然后我们不断接受客户端请求，并使用 ServerClientThread 实例化连接。</p><h2 id="343b" class="mx kd in bd ke my mz dn ki na nb dp km ld nc nd ko lh ne nf kq ll ng nh ks ni bi translated">服务器客户端线程</h2><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="a20b" class="pw-post-body-paragraph ku kv in kw b kx lr jo kz la ls jr lc ld lt lf lg lh lu lj lk ll lv ln lo lp ig bi translated">这里，我们接收一个客户端套接字引用，并在服务器上的一个线程和客户端套接字之间开始一个会话。互动包括…</p><ol class=""><li id="6bcc" class="mj mk in kw b kx lr la ls ld ml lh mm ll mn lp mo mp mq mr bi translated">从客户端套接字输入流中读取消息</li><li id="b106" class="mj mk in kw b kx ms la mt ld mu lh mv ll mw lp mo mp mq mr bi translated">在服务器控制台上打印出“来自客户端-{id}:消息为:{clientMessage}”</li><li id="60d1" class="mj mk in kw b kx ms la mt ld mu lh mv ll mw lp mo mp mq mr bi translated">然后向客户端发回消息，表示“从服务器到客户端-{id}:已接收消息{clientMessage}”</li></ol><p id="2b89" class="pw-post-body-paragraph ku kv in kw b kx lr jo kz la ls jr lc ld lt lf lg lh lu lj lk ll lv ln lo lp ig bi translated">当用户发送消息“关闭”时，我们将关闭连接。</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="d279" class="pw-post-body-paragraph ku kv in kw b kx lr jo kz la ls jr lc ld lt lf lg lh lu lj lk ll lv ln lo lp ig bi translated">这里我们创建了两个客户端一个和两个。我们创建了一个缓冲读取器来从标准 in 中读取用户输入。我们要求用户输入 1 或 2 来确定哪个客户端将向服务器发送消息。根据用户给出的数字，我们使用客户机 1 或 2 的 outputstream 向服务器发送消息。最后，我们从客户机的输入流中读取由服务器发送的消息。</p><h1 id="9907" class="kc kd in bd ke kf kg kh ki kj kk kl km jt kn ju ko jw kp jx kq jz kr ka ks kt bi translated">使用服务器</h1><p id="9805" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">要运行这个示例，首先要运行 MyServer 应用程序，它包含我们的多线程服务器。然后，运行客户端模拟器。</p><p id="0a21" class="pw-post-body-paragraph ku kv in kw b kx lr jo kz la ls jr lc ld lt lf lg lh lu lj lk ll lv ln lo lp ig bi translated">如果您回答如下提示</p><pre class="lx ly lz ma gt nl nm nn no aw np bi"><span id="4479" class="mx kd in nm b gy nq nr l ns nt">Enter 1 or 2: <br/>1<br/>Enter Message :<br/>hello<br/>From Server to Client-1 received message hello<br/>Enter 1 or 2: <br/>2<br/>Enter Message :<br/>hi<br/>From Server to Client-2 received message hi</span></pre><p id="c843" class="pw-post-body-paragraph ku kv in kw b kx lr jo kz la ls jr lc ld lt lf lg lh lu lj lk ll lv ln lo lp ig bi translated">您应该会在服务器的控制台中看到以下输出</p><pre class="lx ly lz ma gt nl nm nn no aw np bi"><span id="65a7" class="mx kd in nm b gy nq nr l ns nt">listening on port 8000<br/>Client:1 started!<br/>Client:2 started!<br/>From Client-1: Message is :hello<br/>From Client-2: Message is :hi</span></pre><p id="aef0" class="pw-post-body-paragraph ku kv in kw b kx lr jo kz la ls jr lc ld lt lf lg lh lu lj lk ll lv ln lo lp ig bi translated">既然您已经理解了客户机-服务器体系结构，那么您可以实现自己的服务器，并更好地理解您日常使用的应用程序的内部工作原理。</p></div></div>    
</body>
</html>