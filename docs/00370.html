<html>
<head>
<title>Philosophy of Code Review</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">代码审查的哲学</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/philosophy-of-code-review-4bc7120fa5d2?source=collection_archive---------14-----------------------#2020-06-04">https://blog.devgenius.io/philosophy-of-code-review-4bc7120fa5d2?source=collection_archive---------14-----------------------#2020-06-04</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/d84985fe7127b35a1334e406ecc724d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yO6RJsZB6OMWVrJR"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">查尔斯·德鲁维奥在<a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="0d90" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">简介:</h1><p id="b542" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">代码审查不仅在早期防止潜在的(未来的)错误，它还是在团队内部交流变更和分享经验的有效方式。没有比代码评审更能吸引工程师的方式了。</p><p id="7b0b" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">一个好的代码审查过程应该导致开放的开发环境，知识共享和团队极客指数的增加，以及更少的错误和回归。</p><h1 id="34ab" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak">概述:</strong></h1><p id="96f7" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">有效的代码审查将涵盖好代码的所有主要方面，即:</p><ol class=""><li id="48b7" class="mb mc in la b lb lw lf lx lj md ln me lr mf lv mg mh mi mj bi translated">一般(低级)—CS概念、卫生、语言结构及其生态系统的有效使用</li><li id="a62f" class="mb mc in la b lb mk lf ml lj mm ln mn lr mo lv mg mh mi mj bi translated">设计——坚持设计原则和模式(特别是。当开发新模块时)和对现有设计的坚持(在增量开发的情况下)</li><li id="de89" class="mb mc in la b lb mk lf ml lj mm ln mn lr mo lv mg mh mi mj bi translated">功能性——支持它的业务用例及测试用例的覆盖范围</li></ol><h1 id="de6f" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak">评论的味道:</strong></h1><ul class=""><li id="7a9c" class="mb mc in la b lb lc lf lg lj mp ln mq lr mr lv ms mh mi mj bi translated">一般评论</li><li id="5781" class="mb mc in la b lb mk lf ml lj mm ln mn lr mo lv ms mh mi mj bi translated">代码设计审查</li><li id="0c3f" class="mb mc in la b lb mk lf ml lj mm ln mn lr mo lv ms mh mi mj bi translated">功能审查</li></ul><h2 id="5085" class="mt kb in bd kc mu mv dn kg mw mx dp kk lj my mz ko ln na nb ks lr nc nd kw ne bi translated"><em class="nf">总评:</em></h2><p id="a65f" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">团队中的任何人都可以进行常规检查。我鼓励更多的成员审查主要版本。</p><p id="1734" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">在这一级别，期望仅从实现技术的角度审查代码:</p><ul class=""><li id="dd53" class="mb mc in la b lb lw lf lx lj md ln me lr mf lv ms mh mi mj bi translated">有效使用各种CS概念，如DS/Algo、并发性、锁定等。审查算法并确保有足够的文档。寻找优化的机会。确保对应用程序的可能和不可能状态都有单元测试。</li><li id="95c3" class="mb mc in la b lb mk lf ml lj mm ln mn lr mo lv ms mh mi mj bi translated">有效使用语言结构和最佳实践。大多数最佳实践都在一些流行书籍中进行了总结，如<em class="ng">有效的Java、代码完整、实用程序员、实践中的Java并发性</em> <em class="ng">等</em>。</li><li id="3110" class="mb mc in la b lb mk lf ml lj mm ln mn lr mo lv ms mh mi mj bi translated">有效使用语言生态系统，如标准库(数据结构等)，单元测试框架等。我们应该鼓励尽可能多地重用经过实战检验的代码。</li><li id="31f8" class="mb mc in la b lb mk lf ml lj mm ln mn lr mo lv ms mh mi mj bi translated">卫生，如风格指南、文档、类型安全、资源管理、对象构造、DI、验证等。</li></ul><h2 id="9319" class="mt kb in bd kc mu mv dn kg mw mx dp kk lj my mz ko ln na nb ks lr nc nd kw ne bi translated">代码设计审查:</h2><p id="dc3a" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">在这个阶段，评审者需要熟悉领域来证明设计选择的合理性。根据变更的性质，评审可以有不同的期望:</p><ul class=""><li id="ec3e" class="mb mc in la b lb lw lf lx lj md ln me lr mf lv ms mh mi mj bi translated">发布新产品时:确保代码符合实施前起草的设计文档(如果没有，鼓励被评审者提交一份)。在设计文档没有被评审或者没有设计文档的任何意外情况下，评审者需要评审合同以确保它们正确地对域建模。</li><li id="548a" class="mb mc in la b lb mk lf ml lj mm ln mn lr mo lv ms mh mi mj bi translated">当现有产品发生变更时:评审者必须确保变更符合产品的既定设计。并且变更遵守产品的约束或者统一地影响所有约束(而不是有条件地)</li></ul><p id="47d0" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">总的来说，审查必须确保:</p><ul class=""><li id="0a39" class="mb mc in la b lb lw lf lx lj md ln me lr mf lv ms mh mi mj bi translated">干燥——不要重复自己——评审者需要确保逻辑和抽象的干燥，而不仅仅是代码。</li><li id="6add" class="mb mc in la b lb mk lf ml lj mm ln mn lr mo lv ms mh mi mj bi translated">单一责任原则(SRP)——功能是模块化的、简洁的，并且只处理一个问题</li><li id="23a3" class="mb mc in la b lb mk lf ml lj mm ln mn lr mo lv ms mh mi mj bi translated">接口传达了明确的意图，没有无用的方法<br/>这里需要回顾一下关注点的分离。</li><li id="999a" class="mb mc in la b lb mk lf ml lj mm ln mn lr mo lv ms mh mi mj bi translated">专为并发环境设计—对象声明线程安全契约</li><li id="a17e" class="mb mc in la b lb mk lf ml lj mm ln mn lr mo lv ms mh mi mj bi translated">OOPs原则——状态的标识及其封装、对象的责任以及对象之间的通信协议</li><li id="801a" class="mb mc in la b lb mk lf ml lj mm ln mn lr mo lv ms mh mi mj bi translated">设计是可扩展的；一种流行方法是，如果有机会，确保使用正确的设计模式(例如:算法应该可以通过策略模式等插入)</li><li id="60f7" class="mb mc in la b lb mk lf ml lj mm ln mn lr mo lv ms mh mi mj bi translated">可测试性——功能必须是单元可测试的。</li></ul><p id="b51e" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">请注意，这是一个指示性的清单，而不是详尽的清单。请随意根据您的经验从更多方面进行评估。可以参考书籍(在一般复习部分提到)</p><h2 id="9ca4" class="mt kb in bd kc mu mv dn kg mw mx dp kk lj my mz ko ln na nb ks lr nc nd kw ne bi translated"><strong class="ak">职能审查:</strong></h2><p id="6755" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">这是复习最重要的一步。评审者必须熟悉产品，并对产品有所贡献，理解产品的特性和限制。除了专用回归套件之外，评审人员的熟悉程度为发现不可预见的情况提供了独特的机会。在这里，评审者需要确保没有因为变更而出现倒退。此外，审查者应该审查单元测试和集成测试，并确保它们在应用程序的所有可能状态(可能和不可能状态)下测试功能的行为</p><p id="6eae" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">形式上，评审者需要确保</p><ol class=""><li id="d543" class="mb mc in la b lb lw lf lx lj md ln me lr mf lv mg mh mi mj bi translated">领域建模是正确的(如果LLD - CD/ERD等没有被彻底审查)</li><li id="09c4" class="mb mc in la b lb mk lf ml lj mm ln mn lr mo lv mg mh mi mj bi translated">代码得到了充分的检测(业务和系统检测)</li><li id="0f34" class="mb mc in la b lb mk lf ml lj mm ln mn lr mo lv mg mh mi mj bi translated">抽象和类之间的关系已经清楚地展示出来了(并且很容易从代码中推导出来)</li><li id="02f9" class="mb mc in la b lb mk lf ml lj mm ln mn lr mo lv mg mh mi mj bi translated">安全方面，如<br/> &gt;输入和输出验证<br/> &gt;防御已知漏洞<br/> &gt;边界检查(如数组OOB)可能导致溢出以及DoS <br/> &gt;平台和库漏洞(应对已知问题进行基本审计)</li></ol><h1 id="6df8" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">总结:</h1><p id="cccb" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">在结尾注释中，超过500行的代码审查被搁置了(因为缺少足够的时间，在文件之间移动时丢失了上下文等等)。最好是被评审者和评审者同步进行代码演练，并一起评审代码。根据经验，这种情况应该尽可能少发生。</p><p id="4e9f" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">代码审查不是吹毛求疵。根据我的经验，评审者和被评审者在代码评审后都会受益。通过阅读别人的代码，我学到了很多。</p><p id="276c" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">代码审查不仅限于开发人员。QAs做代码审查也有帮助。</p><p id="834c" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">自动化我们代码的大部分基本健全性(代码覆盖、静态代码分析、风格检查)的工具应该越来越多地集成到CI和检入管道中，以减少代码审查的不必要负担。</p><h1 id="c53d" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">参考资料:</h1><ol class=""><li id="1b25" class="mb mc in la b lb lc lf lg lj mp ln mq lr mr lv mg mh mi mj bi translated">总结:<a class="ae jz" href="http://blog.d3in.org/post/111338685456/maslows-pyramid-of-code-review" rel="noopener ugc nofollow" target="_blank">http://blog . d3in . org/post/111338685456/maslows-pyramid-of-code-review</a></li></ol></div></div>    
</body>
</html>