<html>
<head>
<title>How to Set the Cursor Position on contentEditable Div with JavaScript?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用JavaScript设置contentEditable Div上的光标位置？</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-set-the-cursor-position-on-contenteditable-div-with-javascript-1bfe86d5fae4?source=collection_archive---------0-----------------------#2021-08-25">https://blog.devgenius.io/how-to-set-the-cursor-position-on-contenteditable-div-with-javascript-1bfe86d5fae4?source=collection_archive---------0-----------------------#2021-08-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/ae5496c2945b61c06972696d7a40b0c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rwNpR5enWLB1Km-D"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">安妮·尼加德在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="f0b7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有时，我们想用JavaScript在一个<code class="fe lb lc ld le b">contenteditable</code> div上设置光标位置。</p><p id="f06d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看如何用JavaScript在一个<code class="fe lb lc ld le b">contenteditable</code> div上设置光标位置。</p><h1 id="c2ba" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">使用document.creatRange方法</h1><p id="6085" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">我们可以使用<code class="fe lb lc ld le b">document.createRange</code>方法来创建选择范围。</p><p id="afce" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以在返回的选择对象上调用<code class="fe lb lc ld le b">addRange</code>来选择内容。</p><p id="0e34" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，如果我们有下面的HTML:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="c2a9" class="mq lg iq le b gy mr ms l mt mu">&lt;div id="selectable" contenteditable&gt;http://example.com/page.htm&lt;/div&gt;</span></pre><p id="a23e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以在上面写下:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="3ef5" class="mq lg iq le b gy mr ms l mt mu">const el = document.getElementById('selectable');<br/>const selection = window.getSelection();<br/>const range = document.createRange();<br/>selection.removeAllRanges();<br/>range.selectNodeContents(el);<br/>range.collapse(false);<br/>selection.addRange(range);<br/>el.focus();</span></pre><p id="25ce" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe lb lc ld le b">getElementById</code>得到div。</p><p id="2ced" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们调用<code class="fe lb lc ld le b">window.getSelection</code>来创建一个选择。</p><p id="9402" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们调用<code class="fe lb lc ld le b">document.createRange</code>来创建选择范围。</p><p id="ffe7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们调用<code class="fe lb lc ld le b">removeAllRanges</code>来删除任何现有的选择。</p><p id="1eb1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们用<code class="fe lb lc ld le b">el</code>调用<code class="fe lb lc ld le b">selectNodeContents</code>将选择应用到div。</p><p id="31c0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们调用<code class="fe lb lc ld le b">addRange</code>来选择内容。</p><p id="9c43" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们调用<code class="fe lb lc ld le b">el.focus()</code>来关注添加光标的元素。</p><p id="4863" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们应该看到光标在文本的末尾。</p><h1 id="db33" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">结论</h1><p id="be8b" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">我们可以用JavaScript browser <code class="fe lb lc ld le b">document.createRange</code>方法在<code class="fe lb lc ld le b">contenteditable</code> div上设置光标位置。</p></div></div>    
</body>
</html>