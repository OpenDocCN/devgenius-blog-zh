<html>
<head>
<title>Get Started With PySpark And Google Colab Notebook In 4 Minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">4 分钟内开始使用 PySpark 和 Google Colab 笔记本</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/get-started-with-pyspark-and-google-colab-notebook-in-4-minutes-94b4e2cecad7?source=collection_archive---------7-----------------------#2022-12-29">https://blog.devgenius.io/get-started-with-pyspark-and-google-colab-notebook-in-4-minutes-94b4e2cecad7?source=collection_archive---------7-----------------------#2022-12-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/1e5c1831b39e20d6c84b2d5c428e2780.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*MsAWgACuYKgrpSE6s2Z4IQ.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">PySpark 与 CoLab</figcaption></figure><p id="cfc4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> Apache Spark 一定是为大数据爱好者准备的。</strong>它是一个开源的处理引擎，在单节点机器或集群上处理数据。<strong class="ka ir"> </strong>在本文中，您将在 Spark 上运行您的第一个 Python 程序。了解更多关于 Spark SQL &amp; DataFrame 基础知识。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><blockquote class="ld le lf"><p id="6330" class="jy jz lg ka b kb kc kd ke kf kg kh ki lh kk kl km li ko kp kq lj ks kt ku kv ij bi translated">"告诉我，我会忘记；教我，我会记住；让我参与，我会学习."<br/>――本杰明·富兰克林</p></blockquote><p id="2f38" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我喜欢这句话，所以我邀请你参与进来，试着和我一起一步一步地编写你的代码。</p><p id="0264" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">阿帕奇 Spark 和 PySpark 有什么区别？</strong></p><p id="03e7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Apache Spark 是用 Scala 编程语言编写的，PySpark 是 Spark 的 python API。</p><p id="f591" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">PySpark SQL 是一个 PySpark 库，用于对结构化或半结构化数据进行类似 SQL 的分析。我们也可以通过 PySparkSQL 使用 SQL 查询。</p><p id="6581" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本文中，我们将学习更多关于 PySpark 和 PySpark SQL 的知识</p><h2 id="4fb2" class="lk ll iq bd lm ln lo dn lp lq lr dp ls kj lt lu lv kn lw lx ly kr lz ma mb mc bi translated">先决条件:</h2><ul class=""><li id="4df7" class="md me iq ka b kb mf kf mg kj mh kn mi kr mj kv mk ml mm mn bi translated">从<a class="ae mo" href="https://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank">这里</a>使用 google Colab 来运行你的代码。</li><li id="87b0" class="md me iq ka b kb mp kf mq kj mr kn ms kr mt kv mk ml mm mn bi translated">从<a class="ae mo" href="https://www.kaggle.com/competitions/titanic/data?select=train.csv" rel="noopener ugc nofollow" target="_blank">这里</a>下载本教程使用的“trian.csv”数据，上传到 Colab 笔记本。</li></ul><p id="e4bb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">如何加载 CSV 文件:</strong></p><p id="0569" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用“spark.read”函数非常简单。这个函数的输出将是一个数据帧。</p><ul class=""><li id="47e4" class="md me iq ka b kb kc kf kg kj mu kn mv kr mw kv mk ml mm mn bi translated">第一个参数:文件路径</li><li id="b11c" class="md me iq ka b kb mp kf mq kj mr kn ms kr mt kv mk ml mm mn bi translated">第二个参数:如果你的文件中有一个头文件，那么头文件的值为“True ”,而“False”。</li><li id="57df" class="md me iq ka b kb mp kf mq kj mr kn ms kr mt kv mk ml mm mn bi translated">如果"<strong class="ka ir"> inferSchema = False" </strong>所有数据都将以字符串数据类型加载，要知道编写"<strong class="ka ir"> inferSchema = True "的好处是什么。</strong>尝试用 False 打印出数据类型，再用 True 打印一次，并比较结果。</li></ul><pre class="mx my mz na gt nb nc nd bn ne nf bi"><span id="b43b" class="ng ll iq nc b be nh ni l nj nk">titanic_df=spark.read.csv("/content/train.csv",header=True,inferSchema=True)</span></pre><p id="91b9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">显示数据框以确保数据以正确的方式加载。</p><pre class="mx my mz na gt nb nc nd bn ne nf bi"><span id="ac00" class="ng ll iq nc b be nh ni l nj nk">titanic_df #to display dataframe</span></pre><figure class="mx my mz na gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi nl"><img src="../Images/bdcf2b3540ea778eb7ee36e836fd82c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*G-7vEjaXR1EqYHXc.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">泰坦尼克号数据框</figcaption></figure><p id="a821" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用 Limit 函数限制显示的记录数。</p><pre class="mx my mz na gt nb nc nd bn ne nf bi"><span id="d702" class="ng ll iq nc b be nh ni l nj nk">titanic_df.limit(5) #this will display the first 5 records</span></pre><figure class="mx my mz na gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi nl"><img src="../Images/4c7ee70750e56dba03ea95968a436121.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-c5Y0gPonjay12Qv.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">仅显示 5 条记录</figcaption></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h2 id="c995" class="lk ll iq bd lm ln lo dn lp lq lr dp ls kj lt lu lv kn lw lx ly kr lz ma mb mc bi translated">PySpark SQL:</h2><p id="8073" class="pw-post-body-paragraph jy jz iq ka b kb mf kd ke kf mg kh ki kj nq kl km kn nr kp kq kr ns kt ku kv ij bi translated">SQL 函数内置于 PySpark 中，因此有另一种方法通过使用 select SQL 函数将数据显示为表格。</p><p id="c7e5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">选择" * "意味着我们要显示所有列</p><pre class="mx my mz na gt nb nc nd bn ne nf bi"><span id="02cd" class="ng ll iq nc b be nh ni l nj nk">titanic_df.select("*")</span></pre><figure class="mx my mz na gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi nt"><img src="../Images/6489936c5fe283ec2afe74cc6596024f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pj7z45PaT5CqDGR5.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">使用选择功能显示数据</figcaption></figure><p id="49a8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要显示特定的列，请在 select 函数中传递列名，如下所示。</p><pre class="mx my mz na gt nb nc nd bn ne nf bi"><span id="84e9" class="ng ll iq nc b be nh ni l nj nk">titanic_df.select("PassengerId","Survived").limit(5)</span></pre><figure class="mx my mz na gt jr gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/7d2a7ae899824ee0435b28745b4aef1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/0*V6RUP_4J6VRBlE1N.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">选择 PassengerId 和幸存列</figcaption></figure><p id="c7bb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">如何过滤掉一些数据:</strong></p><p id="b87b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们需要分析数据，并从中得出一些见解。比如有多少人的年龄大于 25，女性，在这种情况下，我们需要学会如何过滤掉。这对于分析非常重要。</p><p id="f962" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将像在 SQL 中一样使用 where</p><pre class="mx my mz na gt nb nc nd bn ne nf bi"><span id="cdef" class="ng ll iq nc b be nh ni l nj nk">titanic_df.where((titanic_df.Age &gt; 25)&amp; (titanic_df.Sex=="female")).limit(5)</span></pre><figure class="mx my mz na gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi nl"><img src="../Images/6ee8e0b71bc41ba2fc66c0df052133f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5hTpoWq_NW52JPpl.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">如何过滤掉</figcaption></figure><p id="734a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">如何汇总数据:</strong></p><p id="7380" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们想通过特定的列进行聚合和分组，比如 Pclass。</p><p id="92ae" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里我们得到了按等级分组的平均票价</p><pre class="mx my mz na gt nb nc nd bn ne nf bi"><span id="8918" class="ng ll iq nc b be nh ni l nj nk">titanic_df.groupBy("Pclass").agg({"Fare":"avg"})</span></pre><figure class="mx my mz na gt jr gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/4c8f97720940a793fc790df442088c46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/0*Q3Hg4De6EgdNc6rm.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">使用聚集和分组依据</figcaption></figure><p id="78db" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">如何创建新的临时视图:</strong></p><p id="0953" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们想要创建一个新的临时视图并在其上加载数据框</p><pre class="mx my mz na gt nb nc nd bn ne nf bi"><span id="3177" class="ng ll iq nc b be nh ni l nj nk">titanic_df.createOrReplaceTempView("Titanic")</span></pre><p id="b763" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Spark 的一个很好的特性是，我们可以通过使用 Spark.sql 来使用 SQL 语法</p><pre class="mx my mz na gt nb nc nd bn ne nf bi"><span id="32d6" class="ng ll iq nc b be nh ni l nj nk">spark.sql("select * from titanic")</span></pre><figure class="mx my mz na gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi nl"><img src="../Images/643c88a07aa49ef8288984ae2c80b4c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3wtm2tAjMkjt2BiR.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">使用 spark.sql 选择语句</figcaption></figure><p id="ef81" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我希望你喜欢阅读这篇文章，并发现它内容丰富，随时添加你的评论、想法或反馈，不要忘记在<a class="ae mo" href="https://www.linkedin.com/in/ansam-yousry-34b32b116/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上取得联系或关注我的媒体账户以保持更新。</p><p id="96f8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">你喜欢这篇文章吗？别忘了点击“关注”按钮，你可能也会喜欢:</strong></p><div class="nw nx gp gr ny nz"><a rel="noopener  ugc nofollow" target="_blank" href="/nano-degree-program-for-data-engineering-does-it-worth-getting-f7efd6c678f7"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd ir gy z fp oe fr fs of fu fw ip bi translated">数据工程纳米学位项目——值得获得吗？</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">我注册了数据工程的纳米学位，在这篇文章中，我将与你分享我的观点和更多…</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">blog.devgenius.io</p></div></div><div class="oi l"><div class="oj l ok ol om oi on js nz"/></div></div></a></div><div class="nw nx gp gr ny nz"><a rel="noopener  ugc nofollow" target="_blank" href="/airflow-from-zero-and-how-to-install-airflow-in-docker-fb5c4a0f992b"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd ir gy z fp oe fr fs of fu fw ip bi translated">气流从零开始以及如何在 Docker 中安装气流</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">气流教程以及如何在 Docker 中安装气流</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">blog.devgenius.io</p></div></div><div class="oi l"><div class="oo l ok ol om oi on js nz"/></div></div></a></div><p id="39d0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="lg">还不是中等会员？</em> <a class="ae mo" href="https://medium.com/@ansam.yousry/membership" rel="noopener"> <em class="lg">现在注册</em> </a> <em class="lg">只需 5 美元，就可以无限制地访问中观世界！</em></p></div></div>    
</body>
</html>