# Rust ä¸­çš„å†…å­˜ç®¡ç†â€”ç¬¬ 1 éƒ¨åˆ†:æ‰€æœ‰æƒå’Œç§»åŠ¨

> åŸæ–‡ï¼š<https://blog.devgenius.io/ownership-and-moves-in-rust-4a9c6f02108d?source=collection_archive---------3----------------------->

## Rust ä¸­çš„å†…å­˜ç®¡ç†ä»‹ç»

![](img/e5fa1da1144d29ee23746d1b160c2961.png)

ä¸è¦æ‹…å¿ƒï¼›æˆ‘å¹¶ä¸æ˜¯æƒ³å‘ä½ æ¨é”€æœ€æ–°çš„ Titok èˆæˆ–è€…æ‹¥æœ‰ä¸€æ ‹æˆ¿å­çš„å¥½å¤„æˆ–ä¸ä¾¿ä¹‹å¤„ç­‰ç­‰ã€‚æˆ‘ä»¬å°†å›é¡¾ç¼–ç¨‹è¯­è¨€ Rust ä¸­çš„æ¦‚å¿µ**æ‰€æœ‰æƒ**å’Œ**ç§»åŠ¨**ã€‚

åœ¨æˆ‘ 2022 å¹´çš„ç¬¬ä¸€ç¯‡æ–‡ç« ä¹‹ä¸€ï¼Œ [*ä½ ä¸ºä»€ä¹ˆå­¦é”ˆï¼*](https://anismousse.medium.com/why-you-should-learn-rust-fa52d0139b85) æˆ‘æåˆ°è¿‡ Rust æœ€å¸å¼•äººçš„ä¸€ä¸ªç‰¹ç‚¹å°±æ˜¯å®ƒçš„**å®‰å…¨æ€§**ã€‚æˆ‘ä»¬å°†æ·±å…¥æˆ‘ä»¬æœ€å–œæ¬¢çš„ç¼–ç¨‹è¯­è¨€çš„å®‰å…¨æ–¹é¢ï¼Œå¹¶è¯•å›¾ç†è§£å†…å­˜æ˜¯å¦‚ä½•ç®¡ç†çš„ã€‚

# å†…å­˜ç®¡ç†

ç¼–ç¨‹è¯­è¨€é€šå¸¸ç”±å®ƒä»¬å¦‚ä½•å¤„ç†å†…å­˜ç®¡ç†æ¥å®šä¹‰ã€‚

***åœ¨å®Œç¾çš„ä¸–ç•Œé‡Œï¼Œä¸€ä¸ªç¼–ç¨‹è¯­è¨€åº”è¯¥èƒ½å¤Ÿéšæ„åˆ†é…å†…å­˜ï¼ŒåŒæ—¶ä¿è¯æŒ‡å‘ä¸€ä¸ªå·²ç»è¢«é‡Šæ”¾çš„å¯¹è±¡çš„æŒ‡é’ˆ(æ‚¬ç©ºæŒ‡é’ˆ)ä¸èƒ½è¢«ä½¿ç”¨ã€‚***

ä½†æ˜¯æˆ‘ä»¬å¹¶ä¸æ˜¯ç”Ÿæ´»åœ¨ä¸€ä¸ªå®Œç¾çš„ä¸–ç•Œä¸­ï¼Œæ‰€ä»¥ä¸€äº›ç¼–ç¨‹è¯­è¨€å¦‚ Python æˆ– Java é€‰æ‹©å°†ç§»é™¤æ‚¬ç©ºæŒ‡é’ˆçš„è´£ä»»å§”æ‰˜ç»™ä¸€ä¸ª**åƒåœ¾æ”¶é›†å™¨ï¼›**è¿˜æœ‰ï¼Œå…¶ä»–çš„ï¼Œæ¯”å¦‚ C æˆ– C++ï¼Œç®€å•æ¥è¯´(ğŸ¤£)**è®©ä½ è´Ÿè´£é‡Šæ”¾å†…å­˜**ã€‚

Rust é€šè¿‡**é™åˆ¶**å¦‚ä½•åœ¨ç¨‹åºä¸­ä½¿ç”¨æŒ‡é’ˆé‡‡å–äº†ä¸åŒçš„æ–¹æ³•ã€‚**æ‰€æœ‰æƒ**å’Œ**ç§»åŠ¨**çš„æ¦‚å¿µå®šä¹‰äº†é‚£äº›é™åˆ¶ã€‚

# æ‰€æœ‰æƒ

æ‰€æœ‰æƒçš„æ¦‚å¿µæ˜¯ç”±ç¼–è¯‘æ—¶æ£€æŸ¥(Cargo)å¼ºåˆ¶å®æ–½çš„ Rust çš„æ ¸å¿ƒæ¦‚å¿µï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„å†…å®¹æ¥æè¿°: ***æ¯ä¸ªå€¼éƒ½æœ‰ä¸€ä¸ªç¡®å®šå…¶ç”Ÿå­˜æœŸçš„å”¯ä¸€æ‰€æœ‰è€…*** ã€‚ ***å½“æ‹¥æœ‰è€…è¢«é‡Šæ”¾æ—¶ï¼Œæ‹¥æœ‰çš„ä»·å€¼ä¹Ÿè¢«é‡Šæ”¾ã€‚***

ç®€å•æ¥è¯´ï¼Œå˜é‡æ‹¥æœ‰å®ƒçš„å€¼ï¼Œå˜é‡è¢«ä¸¢å¼ƒï¼Œå€¼ä¹Ÿéšä¹‹è¢«ä¸¢å¼ƒã€‚

å¯å˜æ‰€æœ‰æƒç¤ºä¾‹

ä¸ºäº†è·Ÿè¸ªæ‰€æœ‰æƒå…³ç³»ï¼ŒRust ä¿ç•™äº†ä¸€äº› ***æ ‘*** ï¼Œå…¶ä¸­æ‰€æœ‰è€…æ˜¯çˆ¶ä»£ï¼Œæ‹¥æœ‰çš„å€¼æ˜¯å­ä»£ï¼Œæ¯æ£µæ ‘çš„æœ€ç»ˆçˆ¶ä»£æ˜¯ä¸€ä¸ªå˜é‡ã€‚

å½“ä¸€ä¸ªå˜é‡è¢«åˆ é™¤æ—¶(ä¾‹å¦‚ï¼Œè¶…å‡ºèŒƒå›´)ï¼ŒRust ä¼šå°†å®ƒä»æ‰€æœ‰æƒæ ‘ä¸­åˆ é™¤ï¼Œç¡®ä¿è¯¥å˜é‡åŠå…¶æ‰€æœ‰æ‹¥æœ‰çš„å€¼éƒ½è¢«æœ‰æ•ˆåœ°åˆ é™¤ã€‚

ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ï¼Œå®ƒç›´è§‚åœ°å±•ç¤ºäº†ç›¸å…³çš„ Rust æ ‘:

å¯å˜æ‰€æœ‰æƒçš„å¦ä¸€ä¸ªä¾‹å­

![](img/12503b59a95e17b353ca120354a5f5b7.png)

Rust çš„æ ‘å¯è§†åŒ–è¡¨ç¤º

å› æ­¤ï¼Œå¯¹äºè¿™ä¸ªä¾‹å­ï¼Œå½“`missy_foods_items`è¶…å‡ºèŒƒå›´æ—¶ï¼ŒRust å°†ä¸¢å¼ƒå…¶æ ‘ä¸­çš„æ‰€æœ‰å…ƒç´ ã€‚

è¿™ä¸ªæ¦‚å¿µç›¸å¯¹ç®€å•ï¼Œä½†ä¹Ÿå¾ˆæœ‰é™åˆ¶æ€§ã€‚ä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬ä»ç°æœ‰çš„ä»·å€¼ä¸­åˆ›é€ æ–°çš„ä»·å€¼æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ

ä¸‹é¢å°±æ¥æ‹¯æ•‘ä¸€ä¸‹ ***æ‹›å¼*** ã€‚

# ç§»åŠ¨

Rust ä¸­çš„**ç§»åŠ¨**æ¦‚å¿µä¸ºæ‰€æœ‰æƒè§’è‰²æä¾›äº†çµæ´»æ€§ã€‚

å¯¹äºå¤§å¤šæ•°ç±»å‹ï¼Œèµ‹å€¼ã€ä¼ é€’æˆ–è¿”å›å€¼ä¸ä¼šå¤åˆ¶å®ƒï¼Œè€Œæ˜¯ç”±**ç§»åŠ¨**å®ƒã€‚

***åˆå§‹æºå°†å…¶å€¼æ‰€æœ‰æƒè®©ç»™ç›®æ ‡ï¼Œä»è€Œå˜å¾—æœªåˆå§‹åŒ–ã€‚ç›®æ ‡æºç°åœ¨å®Œå…¨æ‹¥æœ‰è¯¥ä»·å€¼å¹¶å†³å®šå…¶å¯¿å‘½ã€‚***

æ˜¯çš„ï¼ŒRust ä¸­çš„**èµ‹å€¼**æ¦‚å¿µå¯èƒ½æœ‰ç‚¹æ··ä¹±ã€‚

Rust ä¸­çš„èµ‹å€¼æ“ä½œæ˜¯å»‰ä»·çš„ï¼Œå› ä¸ºæˆ‘ä»¬å°†å€¼ç§»åŠ¨åˆ°ä¸€ä¸ªæ–°çš„æ‰€æœ‰è€…ä¹‹ä¸‹ï¼Œå¹¶ä¸”æœªåˆå§‹åŒ–å‰ä¸€ä¸ªæ‰€æœ‰è€…(ç±»ä¼¼äº python shallow copyï¼Œæ³¨æ„ï¼Œç”±äºæœ‰äº† **one owner** è§„åˆ™ï¼Œæˆ‘ä»¬ä¸éœ€è¦è®°å½•æ‰€æœ‰å¼•ç”¨)ã€‚

Rust ä¸­çš„å¤±è´¥èµ‹å€¼

ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ç”Ÿæˆä»¥ä¸‹ç¼–è¯‘é”™è¯¯:

![](img/500f4ae068c30e9d68995a9f28d21150.png)

åˆ†é…å¤±è´¥åçš„è´§ç‰©è¾“å‡º

è®©æˆ‘ä»¬è¯¦ç»†çœ‹çœ‹ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¼šæœ‰è¿™ä¸ªé”™è¯¯ã€‚

é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªåŒ…å« Missy æœ€å–œæ¬¢çš„é£Ÿç‰©é¡¹ç›®çš„å‘é‡ï¼Œå¹¶å½’å®`vec!`æ‰€æœ‰ã€‚ç„¶åï¼Œè¿™ä¸ªå®å°†æ”¾å¼ƒå®ƒå¯¹å‘é‡çš„æ‰€æœ‰æƒï¼Œè½¬è€Œæ”¯æŒå˜é‡`food`ï¼Œå¹¶ä¸”ä¸åˆå§‹åŒ–å®ƒè‡ªå·±ã€‚

æŒ‰ç…§ç±»ä¼¼çš„èµ‹å€¼é€»è¾‘ï¼Œåœ¨ç¤ºä¾‹ä»£ç çš„ç¬¬ 3 è¡Œï¼Œå˜é‡`food`ä¹Ÿå°†æ”¾å¼ƒå…¶å¯¹ vector çš„æ‰€æœ‰æƒï¼Œè½¬è€Œæ”¯æŒå˜é‡`maybe_real_food`å¹¶å–æ¶ˆå…¶è‡ªèº«çš„åˆå§‹åŒ–ã€‚

æœ€åï¼Œåœ¨ç¬¬ 4 è¡Œï¼Œå½“æˆ‘ä»¬è¯•å›¾ç»™å˜é‡`real_food`èµ‹å€¼`food`æ—¶ï¼Œcargo è¡¨è¾¾äº†å®ƒçš„ä¸æ»¡ï¼Œå› ä¸ºåœ¨è¿™ä¸ªé˜¶æ®µ`food`æ˜¯æœªå®šä¹‰çš„(å®ƒçš„å€¼å·²ç»è¢«ç§»åˆ°å˜é‡`maybe_real_food`)ã€‚

åœ¨ Rust ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ˜ç¡®æˆ‘ä»¬çš„æ„å›¾ã€‚å¦‚æœæˆ‘ä»¬çš„ç›®æ ‡æ˜¯åœ¨ C++ä¸­æœ‰ä¸€ä¸ªç±»ä¼¼çš„èµ‹å€¼æ“ä½œ(æ·±åº¦æ‹·è´çš„æ‰§è¡Œå–å†³äºæ‰€æ¶‰åŠçš„å€¼)ï¼Œæˆ‘ä»¬å¿…é¡»æ›´åŠ ç²¾ç¡®:

æ·±å±‚æ‹·è´èµ‹å€¼

æ­£å¦‚æˆ‘ä»¬å‰é¢æåˆ°çš„ï¼Œä¸€ä¸ª ***move*** ä¿æŒå…¶æºæœªåˆå§‹åŒ–ï¼Œè¿™å¯¹äºä¸€ä¸ªç‰¹å®šç±»å‹çš„å¼•ç”¨å¯èƒ½æ˜¯æœ‰é—®é¢˜çš„ï¼Œæ¯”å¦‚ä¸€ä¸ª vectorã€‚

å‘é‡å…ƒç´ æå–å¤±è´¥

ä½†æ˜¯ï¼ŒRust ä¸ºè¿™ä¸ªé—®é¢˜æä¾›äº†ä¸åŒçš„è§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬æ–¹æ³•`std::mm::replace`å…è®¸æ‚¨ä»å‘é‡ä¸­æå–ä¸€ä¸ªå€¼å¹¶ç”¨ä¸åŒçš„å€¼æ›¿æ¢å®ƒã€‚

æˆåŠŸæå–å‘é‡å…ƒç´ 

# æ›´å¤šçš„çµæ´»æ€§:å¤åˆ¶ç±»å‹å’Œ Rc å’Œ Arc æŒ‡é’ˆ

å¦‚æœæ‚¨ä¹‹å‰æ²¡æœ‰æ³¨æ„åˆ°ï¼Œåœ¨æˆ‘çš„æ‰€æœ‰ä¾‹å­ä¸­ï¼Œåœ¨æ„å»ºæˆ‘çš„ vector æ—¶ï¼Œæˆ‘ä»¬è°ƒç”¨æ–¹æ³•`to_string`æ¥è·å¾—ä¸€ä¸ªç”±`String`å¯¹è±¡ç»„æˆçš„ vectorï¼Œè¿™äº›å¯¹è±¡æ˜¯åˆ†é…åœ¨å†…å­˜å †éƒ¨åˆ†çš„å¤æ‚ç»“æ„ã€‚

è¿™å¾ˆé‡è¦ï¼Œå› ä¸ºé™¤äº† ***å¤åˆ¶ç±»å‹*** ä¹‹å¤–ï¼Œå¤§å¤šæ•°ç±»å‹éƒ½å¯ä»¥ç§»åŠ¨ï¼Œå¤åˆ¶ç±»å‹åŒ…æ‹¬æ•´å‹ã€æµ®ç‚¹å‹ã€å­—ç¬¦å‹å’Œå¸ƒå°”å‹ã€‚èµ‹å€¼æ“ä½œç»§ç»­å¤åˆ¶å€¼ï¼Œè€Œä¸æ˜¯ç§»åŠ¨å®ƒã€‚

æœ€åï¼ŒRust è¿˜å¼•å…¥äº† **Rc** å’Œ **Arc** æŒ‡é’ˆï¼Œå¼•ç”¨è®¡æ•°å™¨æŒ‡é’ˆæä¾›äº†æ”¯æŒå¤šé‡æ‰€æœ‰æƒçš„çµæ´»æ€§(æ›´å¤šå…³äº [Arc](https://doc.rust-lang.org/std/sync/struct.Arc.html) å’Œ [Rc](https://doc.rust-lang.org/stable/std/rc/struct.Rc.html) )ï¼Œç±»ä¼¼äº pythonã€‚

# æœ€å

ç†è§£æ‰€æœ‰æƒå’Œç§»åŠ¨æ¦‚å¿µæ˜¯ç†è§£ Rust æœ¬èº«çš„åŸºç¡€ï¼Œå› ä¸ºå®ƒä»¬å®šä¹‰äº†å®ƒçš„æ ¸å¿ƒåŸåˆ™ã€‚

å¯ä»¥æƒ³è±¡ï¼ŒRust æ˜¯ä¸€ç§ä¸¥æ ¼æŒ‰å€¼ä¼ é€’çš„ç¼–ç¨‹è¯­è¨€ã€‚

å®ƒå¾ˆå®¹æ˜“è·Ÿè¸ªå˜é‡å’Œå€¼ä¹‹é—´çš„å…³ç³»(**æ‰€æœ‰æƒ**)ï¼ŒåŒæ—¶é€šè¿‡**ç§»åŠ¨ã€å¤åˆ¶ç±»å‹ã€Rc/Arc æŒ‡é’ˆå’Œå¼•ç”¨å€Ÿç”¨**(æˆ‘ä¸‹ä¸€ç¯‡æ–‡ç« çš„ä¸»é¢˜)çš„æ¦‚å¿µæä¾›çµæ´»æ€§ï¼Œä»¥åœ¨ä¿è¯å®‰å…¨çš„åŒæ—¶äº§ç”Ÿè¶³å¤Ÿçš„è§£å†³æ–¹æ¡ˆã€‚

> â€œå®‰å…¨çš„ä»£ç å…è®¸ä½ å†’æ›´å¤§çš„é£é™©â€(è‰¾ç±³ä¸½Â·é‚“çº³å§†)

é“é”ˆæ˜æ˜¾çš„åšç¡¬æ˜¯å®ƒå¦‚æ­¤å¼ºå¤§çš„åŸå› ã€‚

![](img/3e75f075254e078bcd0effe4f18476a4.png)

åœ¨å¯¹æˆ‘è¡¨æ¼”äº†ä¸€ä¸ª Rust çš„åŠ¨ä½œåï¼ŒMissy å£°ç§°æ‹¥æœ‰æˆ‘åœ¨æ²™å‘ä¸Šçš„ä½ç½®ã€‚

ä¸€å¦‚æ—¢å¾€ï¼Œæ¬¢è¿ä¸€åˆ‡åé¦ˆï¼›ğŸ‘‹,ğŸ‘æ¬¢è¿å…‰ä¸´ï¼ï¼

å¦å¤–ï¼Œå¦‚æœä½ åƒæˆ‘ä¸€æ ·å–œæ¬¢ Rustï¼Œå¹¶ä¸”æœ‰å…´è¶£å»ºç«‹ä¸€ä¸ª meetup ç¾¤ç»„ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼ï¼ä¸‹é¢æ˜¯æˆ‘çš„[æ¨ç‰¹](https://twitter.com/home?lang=en):

## å…¶ä»–èµ„æº:

*ç”Ÿé”ˆ*:https://www.rust-lang.org/learO'Â·é›·åˆ©*è¿˜å¥½*:[https://doc.rust-lang.org/book/](https://doc.rust-lang.org/book/)

*ä¸å¥¥è±åˆ©çš„ Rust é€Ÿæˆç­*:[https://learning . oreilly . com/videos/ultimate-Rust-crash/9781800563902/](https://learning.oreilly.com/videos/ultimate-rust-crash/9781800563902/)

*Rust çš„æ¸©æŸ”ä»‹ç»:*[https://Steve Donovan . github . io/Rust-gentle-intro/readme . html](https://stevedonovan.github.io/rust-gentle-intro/readme.html)