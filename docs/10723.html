<html>
<head>
<title>Connecting Google Colaboratory (Colab) Python To PostgreSQL, MySQL, MS SQL and SQLITE Databases</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将 Google 协同实验室(Colab) Python 连接到 PostgreSQL、MySQL、MS SQL 和 SQLITE 数据库</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/connecting-python-to-databases-via-google-colaboratory-colab-5e07fb98a64b?source=collection_archive---------1-----------------------#2022-11-25">https://blog.devgenius.io/connecting-python-to-databases-via-google-colaboratory-colab-5e07fb98a64b?source=collection_archive---------1-----------------------#2022-11-25</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="7d64" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">使用光标对象和熊猫数据框架</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a594d2b772e1cba7a367ec5265a6413f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gxGLFtyxzEr3tOBO"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">鲁拜图·阿扎德在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="66e8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Colaboratory，简称“Colab”，是谷歌研究院的产品，允许开发者通过浏览器编写和执行任意 Python 代码，特别适合机器学习、数据分析和教育(参考<a class="ae ky" href="https://research.google.com/colaboratory/faq.html" rel="noopener ugc nofollow" target="_blank">谷歌 Colaboratory FAQ) </a>。Colab 可以通过数据库特定的驱动程序/连接器连接到 POSTGRESQL、MYSQL/MARIADB、MSSQL 和 SQLITE 等数据库。这篇文章提供了连接到这些数据库并使用游标对象和 Pandas DataFrame 与它们交互的代码示例。</p><h1 id="908f" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">(1) POSTGRESQL</h1><p id="a77f" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">安装 psycopg2 适配器。Psycopg 是 Python 编程语言最流行的 PostgreSQL 数据库适配器(参考<a class="ae ky" href="https://pypi.org/project/psycopg2/" rel="noopener ugc nofollow" target="_blank"> Pypi Psycopg </a>)。</p><pre class="kj kk kl km gt mc md me bn mf mg bi"><span id="dc5a" class="mh la in md b be mi mj l mk ml">!pip install psycopg2</span></pre><p id="2eb9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">定义连接参数。以下是 elephantsql.com 服务器的连接参数示例。</p><pre class="kj kk kl km gt mc md me bn mf mg bi"><span id="6ce8" class="mh la in md b be mi mj l mk ml">import psycopg2<br/>psconn = psycopg2.connect(host="mouse.db.elephantsql.com", port = 5432, database="abcdefgh", user="abcdefgh", password="your-password")</span></pre><p id="6a25" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">亚马逊红移基于 PostgreSQL ( <a class="ae ky" href="https://docs.aws.amazon.com/redshift/latest/dg/c_redshift-and-postgres-sql.html" rel="noopener ugc nofollow" target="_blank">亚马逊—红移和 Postgres </a>)。因此，上面的连接语句应该也适用于 Amazon Redshift。</p><h1 id="0585" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">(2) MYSQL/MARIADB</h1><p id="931d" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">为 Python 安装 MySQL 连接器。它是 Python 平台和开发的标准化数据库驱动程序(参考<a class="ae ky" href="https://dev.mysql.com/downloads/connector/python/" rel="noopener ugc nofollow" target="_blank"> MySQL 社区下载</a>)。</p><pre class="kj kk kl km gt mc md me bn mf mg bi"><span id="2652" class="mh la in md b be mi mj l mk ml">!pip install mysql-connector-python</span></pre><p id="ddd6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">定义连接参数。以下是通过 IP 地址连接到服务器的连接参数示例。</p><pre class="kj kk kl km gt mc md me bn mf mg bi"><span id="9914" class="mh la in md b be mi mj l mk ml">import mysql.connector as mysql<br/>myconn = mysql.connect(host='82.180.175.153',database='abcdefghij_klm', user='uabcdefghi_jkl', password='your-password')</span></pre><h1 id="7c4d" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">(3)微软 SQL</h1><p id="ae8d" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">为 Python 安装 MS ODBC 驱动程序。ODBC 是应用程序使用 SQL Server 的主要本地数据访问 API(参见<a class="ae ky" href="https://learn.microsoft.com/en-us/sql/connect/odbc/microsoft-odbc-driver-for-sql-serve" rel="noopener ugc nofollow" target="_blank">Microsoft ODBC Driver For SQL Server</a>)。</p><pre class="kj kk kl km gt mc md me bn mf mg bi"><span id="463a" class="mh la in md b be mi mj l mk ml">%%sh<br/><br/>curl https://packages.microsoft.com/keys/microsoft.asc | apt-key add -<br/><br/>curl https://packages.microsoft.com/config/ubuntu/16.04/prod.list &gt; /etc/apt/sources.list.d/mssql-release.list<br/><br/>sudo apt-get update<br/><br/>sudo ACCEPT_EULA=Y apt-get -q -y install msodbcsql17</span></pre><p id="916c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">安装 PyODBC 接头。它是由微软贡献给 pyODBC 开源社区的社区支持软件(参考<a class="ae ky" href="https://learn.microsoft.com/en-us/sql/connect/python/pyodbc/python-sql-driver-pyodbc" rel="noopener ugc nofollow" target="_blank">微软 Python SQL 驱动</a>)。</p><pre class="kj kk kl km gt mc md me bn mf mg bi"><span id="bd42" class="mh la in md b be mi mj l mk ml">!pip install pyodbc</span></pre><p id="f777" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">定义连接参数。以下是 somee.com 服务器的连接参数示例。</p><pre class="kj kk kl km gt mc md me bn mf mg bi"><span id="7753" class="mh la in md b be mi mj l mk ml">import pyodbc <br/>msconn = pyodbc.connect(driver="ODBC Driver 17 for SQL Server",server="abcdefghijklmn.mssql.somee.com",database="abcdefghijklmn",UID="abcdefghijklmn_SQLLogin_1",PWD="your-password",)</span></pre><h1 id="c966" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">(4) SQLITE</h1><p id="528b" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">Colab 已经预装了 SQLITE，因此不需要额外安装。</p><p id="a8e2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">以下是一个连接到位于内容文件夹中的 sqlite 文件的示例。该文件可从<a class="ae ky" href="https://www.dataquest.io/blog/python-pandas-databases/" rel="noopener ugc nofollow" target="_blank"> DataQuest.io </a>获得。</p><pre class="kj kk kl km gt mc md me bn mf mg bi"><span id="c140" class="mh la in md b be mi mj l mk ml">import sqlite3<br/>ltconn = sqlite3.connect("/content/flights.db")</span></pre><p id="4f53" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Colab 只在活动会话期间保存文件。要永久保存文件，请将文件上传到 Google Drive，并使用上面连接参数中的 Google Drive 文件路径。在此之前，运行下面的代码将 Colab 连接到 Google Drive。</p><pre class="kj kk kl km gt mc md me bn mf mg bi"><span id="aabf" class="mh la in md b be mi mj l mk ml">from google.colab import drive<br/>drive.mount('/content/drive')</span></pre><p id="6c4d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因此，连接参数如下所示:</p><pre class="kj kk kl km gt mc md me bn mf mg bi"><span id="d97e" class="mh la in md b be mi mj l mk ml">ltconn = sqlite3.connect("/content/drive/MyDrive/Colab Notebooks/db-connect/flights.db")</span></pre><h1 id="5ed1" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">(5)光标对象</h1><p id="745a" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">一旦定义了一个连接对象，就可以从中创建一个游标对象，这样 Python 代码就能够在数据库会话中执行 SQL 命令(参见<a class="ae ky" href="https://www.psycopg.org/docs/cursor.html" rel="noopener ugc nofollow" target="_blank"> Psycopg 游标类</a>)。例如，下面的代码演示了如何创建游标对象来执行 SQL SELECT 查询。使用循环打印查询结果。</p><pre class="kj kk kl km gt mc md me bn mf mg bi"><span id="6f61" class="mh la in md b be mi mj l mk ml">import sqlite3<br/>ltconn = sqlite3.connect("/content/flights.db")<br/>ltcursor = ltconn.cursor()<br/>ltcursor.execute("select * from airlines limit 5;")<br/>for row in ltcursor:<br/>  print(row)<br/>ltcursor.close()<br/>ltconn.close()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mm"><img src="../Images/52e17d4ed2b4f2c858d8725e174e3507.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iAvSz5qJnTlp6OVTknZ_0g.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">使用循环打印光标对象结果</figcaption></figure><p id="c5c2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">光标对象带有许多方法(参考<a class="ae ky" href="https://www.tutorialspoint.com/python_data_access/python_mysql_cursor_object.htm" rel="noopener ugc nofollow" target="_blank">教程点 Python 光标对象</a>)，如 fetchAll()，如下所示。FetchAll()将光标对象转换为可迭代对象。</p><pre class="kj kk kl km gt mc md me bn mf mg bi"><span id="db89" class="mh la in md b be mi mj l mk ml">import sqlite3<br/>ltconn = sqlite3.connect("/content/flights.db")<br/>ltcursor = ltconn.cursor()<br/>ltcursor.execute("select * from airlines limit 5;")<br/>ltrows = ltcursor.fetchall()<br/>print(ltrows[0])<br/>ltcursor.close()<br/>ltconn.close()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl mn"><img src="../Images/f55523b965e7c48beb4812b2224c4f02.png" data-original-src="https://miro.medium.com/v2/format:webp/1*gED_S6MMUTJU8FZ89bCxag.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">使用 fetchall 方法创建可迭代对象</figcaption></figure><h1 id="e467" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">(6)熊猫数据框</h1><p id="af72" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">对于使用 Python 作为主要编程语言的数据科学家来说，Pandas 包是必备的数据分析工具(参见<a class="ae ky" href="https://www.analyticsvidhya.com/blog/2021/08/must-know-pandas-functions-for-machine-learning-journey/" rel="noopener ugc nofollow" target="_blank"> AnalyticsVidhya Pandas 简介</a>)。Pandas 数据框将数据组织成二维表格数据。它还可能包含行和列的标记轴(参见<a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html" rel="noopener ugc nofollow" target="_blank"> Pandas DataFrame </a>)。</p><p id="9e92" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">下面是一个接收查询结果的 Pandas 数据帧的例子。</p><pre class="kj kk kl km gt mc md me bn mf mg bi"><span id="7532" class="mh la in md b be mi mj l mk ml">import sqlite3<br/>ltconn = sqlite3.connect("/content/flights.db")<br/>ltquery = pd.read_sql_query('''select * from airlines limit 5;''', ltconn)<br/>ltdataframe = pd.DataFrame(ltquery)<br/>print(ltdataframe)<br/>ltconn.close()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mo"><img src="../Images/40c8561f8a00d41ada88a8af199c455c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*erQk_nL8Fc1H1ngH0x2vyg.png"/></div></div></figure><p id="e4c3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">看这里的 Colab 笔记本:<br/><a class="ae ky" href="https://colab.research.google.com/drive/1WW4HfT82xqSUpvn7Ksc4TkuPnCeFqcx0?usp=sharing" rel="noopener ugc nofollow" target="_blank">https://Colab . research . Google . com/drive/1 ww 4 hft 82 xqsupvn 7 KSC 4 tkupncefqcx 0？usp =共享</a></p></div><div class="ab cl mp mq hr mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ig ih ii ij ik"><h1 id="b8ef" class="kz la in bd lb lc mw le lf lg mx li lj lk my lm ln lo mz lq lr ls na lu lv lw bi translated">相关数据库文章:</h1><ol class=""><li id="fa62" class="nb nc in jm b jn lx jr ly jv nd jz ne kd nf kh ng nh ni nj bi translated"><a class="ae ky" href="https://medium.com/@mohamad.razzi.my/learn-practice-sql-database-without-installing-anything-aaf6d05250f8" rel="noopener">学习&amp;不安装任何东西练习 SQL 数据库</a></li><li id="260f" class="nb nc in jm b jn nk jr nl jv nm jz nn kd no kh ng nh ni nj bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/troubleshooting-postgresql-installation-on-windows-6b36f6addb4f">排除 Windows 上 PostgreSQL 安装问题的故障</a></li><li id="aeeb" class="nb nc in jm b jn nk jr nl jv nm jz nn kd no kh ng nh ni nj bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/connecting-azure-data-studio-to-ms-sql-server-docker-version-8f9ce8786314">将 Azure Data Studio 连接到 MS SQL Server Docker 版本</a></li><li id="52cd" class="nb nc in jm b jn nk jr nl jv nm jz nn kd no kh ng nh ni nj bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/connecting-python-to-databases-via-google-colaboratory-colab-5e07fb98a64b">将谷歌协作实验室(Colab) Python 连接到 PostgreSQL、MySQL、MS SQL 和 SQLITE 数据库</a></li><li id="7c58" class="nb nc in jm b jn nk jr nl jv nm jz nn kd no kh ng nh ni nj bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/connecting-android-app-to-ms-sql-server-2d50e999396b">将 Android 应用程序连接到 MS SQL Server </a></li><li id="00f7" class="nb nc in jm b jn nk jr nl jv nm jz nn kd no kh ng nh ni nj bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/connecting-nodejs-to-ms-sql-server-database-8518bf54598">使用繁琐的包将 NODEJS 连接到 MS SQL Server 数据库</a></li><li id="cf2e" class="nb nc in jm b jn nk jr nl jv nm jz nn kd no kh ng nh ni nj bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/an-easy-way-to-understand-inner-left-join-and-right-join-query-a5b2de32c04c">理解内部、左连接和右连接查询的简单方法</a></li></ol></div></div>    
</body>
</html>