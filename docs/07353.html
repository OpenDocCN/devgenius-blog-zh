<html>
<head>
<title>How to Benchmark ML Implementations on Rails</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在 Rails 上测试 ML 实现</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-benchmark-ml-implementations-on-rails-51cff8213058?source=collection_archive---------9-----------------------#2022-03-17">https://blog.devgenius.io/how-to-benchmark-ml-implementations-on-rails-51cff8213058?source=collection_archive---------9-----------------------#2022-03-17</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div class="gh gi jk"><img src="../Images/3f8fa46f318aa1e46e84e4ef5eca488e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*o5pHBvQQXuiDfxJy.jpg"/></div></figure><h1 id="35a6" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">介绍</h1><p id="89ca" class="pw-post-body-paragraph kp kq in kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ig bi translated">这是与人工智能实现相关的系列博文的一部分。如果你对故事的背景或情节感兴趣:</p><p id="3c14" class="pw-post-body-paragraph kp kq in kr b ks ln ku kv kw lo ky kz la lp lc ld le lq lg lh li lr lk ll lm ig bi translated"><a class="ae ls" href="https://serpapi.com/blog/how-to-scrape-google-local-results-with-artificial-intelligence/" rel="noopener ugc nofollow" target="_blank"> #1)如何用人工智能刮出 Google 本地结果？</a><br/><a class="ae ls" href="https://serpapi.com/blog/real-world-example-of-machine-learning-on-rails/" rel="noopener ugc nofollow" target="_blank">【2】Rails 上机器学习的真实世界示例</a><br/><a class="ae ls" href="https://serpapi.com/blog/better-training-tips-and-comparisons/" rel="noopener ugc nofollow" target="_blank">【3】AI 训练技巧和比较</a><br/><a class="ae ls" href="https://serpapi.com/blog/machine-learning-in-scraping-with-rails/" rel="noopener ugc nofollow" target="_blank">【4)Rails 上抓取中的机器学习</a><br/><a class="ae ls" href="https://serpapi.com/blog/implementing-onnx-models-to-rails/" rel="noopener ugc nofollow" target="_blank">【5)在 Rails 上实现 ONNX 模型</a><br/><a class="ae ls" href="https://serpapi.com/blog/how-ml-hybrid-parser-beats-tradition/" rel="noopener ugc nofollow" target="_blank">【6)ML 混合解析器如何击败传统解析器</a><br/><a class="ae ls" href="https://serpapi.com/blog/ml-hybrid-benchmarks/" rel="noopener ugc nofollow" target="_blank">【7)如何在 Rails 上对 ML 实现进行基准测试</a></p><p id="b9b9" class="pw-post-body-paragraph kp kq in kr b ks ln ku kv kw lo ky kz la lp lc ld le lq lg lh li lr lk ll lm ig bi translated">本周，我们将展示如何对我们为 SerpApi 的 Google Local Pack Scraper API 在 Rails 上开发的 ML 实现进行基准测试。</p><h1 id="5ff4" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">I —整体解析过程的低精度基准(100 次)</h1><p id="ce2d" class="pw-post-body-paragraph kp kq in kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ig bi translated">我们将使用在上周的博客文章中使用的相同查询来创建一个以毫秒为单位报告的基准。但是，这里要提到的一点是，100 次同样的过程所用的平均时间会有误差。我将对一个单一结果进行另一个测试，以测量更真实的数字。这个过程将反映它将如何影响进行搜索的用户的代码。不管误差范围如何，都应该反映具有奇怪行为的情况。</p><p id="b979" class="pw-post-body-paragraph kp kq in kr b ks ln ku kv kw lo ky kz la lp lc ld le lq lg lh li lr lk ll lm ig bi translated">以下是 Rails 的基准代码:</p><pre class="lt lu lv lw gt lx ly lz ma aw mb bi"><span id="9a75" class="mc js in ly b gy md me l mf mg">traditional_benchmarks = []<br/>ml_benchmarks = []</span><span id="dd85" class="mc js in ly b gy mh me l mf mg">100.times do<br/>  traditional_benchmarks &lt;&lt; Benchmark.ms { search.parse! false }<br/>  ml_benchmarks &lt;&lt; Benchmark.ms { search.parse! true }<br/>end</span><span id="2570" class="mc js in ly b gy mh me l mf mg">traditional_average = traditional_benchmarks.sum / traditional_benchmarks.size<br/>ml_average = ml_benchmarks.sum / ml_benchmarks.size<br/>average_difference = ml_average - traditional_average </span><span id="f7b7" class="mc js in ly b gy mh me l mf mg">if traditional_average &lt; ml_average<br/>  ratio_change = ml_average / traditional_average<br/>  change = "slower"<br/>else<br/>  ratio_change = traditional_average / ml_average<br/>  change = "faster"<br/>end</span><span id="3312" class="mc js in ly b gy mh me l mf mg">puts "Traditional Parser Benchmark Average: #{traditional_average} ms"<br/>puts "ML Hybrid Parser Benchmark Average: #{ml_average} ms"<br/>puts "Average Difference: #{average_difference} ms"<br/>puts "ML Hybrid Parser is #{ratio_change} times #{change} than Traditional Parser"</span></pre><h1 id="b603" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">牙科医生</h1><figure class="lt lu lv lw gt jo gh gi paragraph-image"><div class="gh gi jk"><img src="../Images/0eb8c8e5303773e425c90a4cc4c37529.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jCkEpj4zke-fMD3L.png"/></div></figure><pre class="lt lu lv lw gt lx ly lz ma aw mb bi"><span id="8972" class="mc js in ly b gy md me l mf mg">"local_results": {<br/>    "places": [<br/>      {<br/>        "position": 1,<br/>        "title": "Austin Cosmetic Dentistry by Tejas Patel, DDS",<br/>        "address": "221 W 6th St #940",<br/>        "rating": 4.9,<br/>        "reviews": 275,<br/>        "hours": "Closes soon ⋅ 4PM",<br/>        "phone": "(512) 476-2336",<br/>        "lsig": "AB86z5V7-Co76bptvuPt00IjA1ut",<br/>        "place_id_search": "https://serpapi.com/search.json?device=desktop&amp;engine=google&amp;gl=us&amp;google_domain=google.com&amp;hl=en&amp;location=Austin%2C+Texas%2C+United+States&amp;lsig=AB86z5V7-Co76bptvuPt00IjA1ut&amp;ludocid=17726167689886688143&amp;q=Dentist&amp;tbm=lcl",<br/>        "gps_coordinates": {<br/>          "latitude": 30.26795,<br/>          "longitude": -97.74515<br/>        }<br/>      },<br/>      {<br/>        "position": 2,<br/>        "title": "East Austin Dental",<br/>        "address": "1000 E 5th St STE 110 · In Corazon Apartments",<br/>        "rating": 4.8,<br/>        "hours": "Closes soon ⋅ 4PM",<br/>        "phone": "(512) 499-0067",<br/>        "lsig": "AB86z5WbLP6dZDWYnq91fO356Est",<br/>        "place_id_search": "https://serpapi.com/search.json?device=desktop&amp;engine=google&amp;gl=us&amp;google_domain=google.com&amp;hl=en&amp;location=Austin%2C+Texas%2C+United+States&amp;lsig=AB86z5WbLP6dZDWYnq91fO356Est&amp;ludocid=16796499427254916480&amp;q=Dentist&amp;tbm=lcl",<br/>        "gps_coordinates": {<br/>          "latitude": 30.264153,<br/>          "longitude": -97.73239<br/>        }<br/>      },<br/>      {<br/>        "position": 3,<br/>        "title": "Austin Comestic Dentistry",<br/>        "phone": "(512) 551-1880",<br/>        "lsig": "AB86z5Wcc9TbOpkoDmgKyi1TUoUY",<br/>        "place_id_search": "https://serpapi.com/search.json?device=desktop&amp;engine=google&amp;gl=us&amp;google_domain=google.com&amp;hl=en&amp;location=Austin%2C+Texas%2C+United+States&amp;lsig=AB86z5Wcc9TbOpkoDmgKyi1TUoUY&amp;ludocid=1429802282623203746&amp;q=Dentist&amp;tbm=lcl",<br/>        "gps_coordinates": {<br/>          "latitude": 30.272924,<br/>          "longitude": -97.7444<br/>        }<br/>      }<br/>    ]<br/>  },</span></pre><p id="3aef" class="pw-post-body-paragraph kp kq in kr b ks ln ku kv kw lo ky kz la lp lc ld le lq lg lh li lr lk ll lm ig bi translated"><strong class="kr io">-查询</strong> : <code class="fe mi mj mk ly b">Dentist</code> <br/> <strong class="kr io">传统解析器基准平均</strong> : <code class="fe mi mj mk ly b">344.3701663099887 ms</code> <br/> <strong class="kr io"> ML 混合解析器基准平均</strong> : <code class="fe mi mj mk ly b">349.1813165999997 ms</code> <br/> <strong class="kr io">平均差异</strong> : <code class="fe mi mj mk ly b">+4.811150290011028 ms</code> <br/> ML 混合解析器比传统解析器更<code class="fe mi mj mk ly b">1.0139708684453235 times slower</code></p><h1 id="4b78" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">书店</h1><figure class="lt lu lv lw gt jo gh gi paragraph-image"><div class="gh gi jk"><img src="../Images/1f586b32ef7142904a50faa11b0d07df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cDGgN_-5N7Purtuz.png"/></div></figure><pre class="lt lu lv lw gt lx ly lz ma aw mb bi"><span id="c450" class="mc js in ly b gy md me l mf mg">"local_results": {<br/>    "places": [<br/>      {<br/>        "position": 1,<br/>        "title": "BookPeople",<br/>        "type": "Book store",<br/>        "address": "603 N Lamar Blvd",<br/>        "rating": 4.7,<br/>        "delivery": "In-store shopping·Curbside pickup·Delivery",<br/>        "hours": "Open ⋅ Closes 7PM",<br/>        "phone": "(512) 472-5050",<br/>        "lsig": "AB86z5VOIjaQM_OHJDDP78c75lF9",<br/>        "place_id_search": "https://serpapi.com/search.json?device=desktop&amp;engine=google&amp;gl=us&amp;google_domain=google.com&amp;hl=en&amp;location=Austin%2C+Texas%2C+United+States&amp;lsig=AB86z5VOIjaQM_OHJDDP78c75lF9&amp;ludocid=15954964542614962629&amp;q=Bookstore&amp;tbm=lcl",<br/>        "gps_coordinates": {<br/>          "latitude": 30.271843,<br/>          "longitude": -97.752945<br/>        }<br/>      },<br/>      {<br/>        "position": 2,<br/>        "title": "South Congress Books",<br/>        "type": "Book store",<br/>        "address": "1608 S Congress Ave",<br/>        "rating": 4.5,<br/>        "reviews": 203,<br/>        "delivery": "In-store shopping·Curbside pickup",<br/>        "hours": "Open ⋅ Closes 6PM",<br/>        "phone": "(512) 916-8882",<br/>        "lsig": "AB86z5WuflRhwRxW1_l4kcQe8HiA",<br/>        "place_id_search": "https://serpapi.com/search.json?device=desktop&amp;engine=google&amp;gl=us&amp;google_domain=google.com&amp;hl=en&amp;location=Austin%2C+Texas%2C+United+States&amp;lsig=AB86z5WuflRhwRxW1_l4kcQe8HiA&amp;ludocid=4735403951136453416&amp;q=Bookstore&amp;tbm=lcl",<br/>        "gps_coordinates": {<br/>          "latitude": 30.247662,<br/>          "longitude": -97.750626<br/>        }<br/>      },<br/>      {<br/>        "position": 3,<br/>        "title": "12th Street Books",<br/>        "type": "Used book store",<br/>        "address": "827 W 12th St",<br/>        "rating": 4.3,<br/>        "reviews": 13,<br/>        "hours": "Temporarily closed",<br/>        "phone": "(512) 499-8828",<br/>        "lsig": "AB86z5WZ7ooDkCDty0PCVl-RnDqT",<br/>        "place_id_search": "https://serpapi.com/search.json?device=desktop&amp;engine=google&amp;gl=us&amp;google_domain=google.com&amp;hl=en&amp;location=Austin%2C+Texas%2C+United+States&amp;lsig=AB86z5WZ7ooDkCDty0PCVl-RnDqT&amp;ludocid=16276231750099540045&amp;q=Bookstore&amp;tbm=lcl",<br/>        "gps_coordinates": {<br/>          "latitude": 30.276222,<br/>          "longitude": -97.74959<br/>        }<br/>      }<br/>    ]<br/>  },</span></pre><p id="9674" class="pw-post-body-paragraph kp kq in kr b ks ln ku kv kw lo ky kz la lp lc ld le lq lg lh li lr lk ll lm ig bi translated"><strong class="kr io">查询</strong> : <code class="fe mi mj mk ly b">Bookstore</code> <br/> <strong class="kr io">传统解析器基准平均</strong> : <code class="fe mi mj mk ly b">282.3834452000028 ms</code> <br/> <strong class="kr io"> ML 混合解析器基准平均</strong> : <code class="fe mi mj mk ly b">276.60691514000746 ms</code> <br/> <strong class="kr io">平均差</strong> : <code class="fe mi mj mk ly b">-5.776530059995366 ms</code> <br/> ML 混合解析器比传统解析器更<code class="fe mi mj mk ly b">1.0208835345171017 times faster</code></p><h1 id="af57" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">墨西哥餐厅</h1><figure class="lt lu lv lw gt jo gh gi paragraph-image"><div class="gh gi jk"><img src="../Images/de4a6d2d3b8caca7231c3f3f4d76c632.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*egRxSkrqM95tiTTE.png"/></div></figure><pre class="lt lu lv lw gt lx ly lz ma aw mb bi"><span id="0642" class="mc js in ly b gy md me l mf mg">"local_results": {<br/>    "places": [<br/>      {<br/>        "position": 1,<br/>        "title": "Tres Potrillos",<br/>        "type": "Mexican",<br/>        "delivery": "Dine-in·Takeout·No delivery",<br/>        "lsig": "AB86z5UnM7a_iraiJwHbX4RTV74b",<br/>        "place_id_search": "https://serpapi.com/search.json?device=desktop&amp;engine=google&amp;gl=us&amp;google_domain=google.com&amp;hl=en&amp;location=Austin%2C+Texas%2C+United+States&amp;lsig=AB86z5UnM7a_iraiJwHbX4RTV74b&amp;ludocid=4949025990990656275&amp;q=Mexican+Restaurant&amp;tbm=lcl",<br/>        "gps_coordinates": {<br/>          "latitude": 30.267153,<br/>          "longitude": -97.74306<br/>        }<br/>      },<br/>      {<br/>        "position": 2,<br/>        "title": "Comedor",<br/>        "type": "\"Their interpretation of mexican cuisine is exceptional.\"",<br/>        "address": "501 Colorado St",<br/>        "rating": 4.4,<br/>        "reviews": 491,<br/>        "hours": "Closed ⋅ Opens 5PM",<br/>        "lsig": "AB86z5XVNkH5NYsRCN5t2FCdM89-",<br/>        "place_id_search": "https://serpapi.com/search.json?device=desktop&amp;engine=google&amp;gl=us&amp;google_domain=google.com&amp;hl=en&amp;location=Austin%2C+Texas%2C+United+States&amp;lsig=AB86z5XVNkH5NYsRCN5t2FCdM89-&amp;ludocid=6958240678106455106&amp;q=Mexican+Restaurant&amp;tbm=lcl",<br/>        "gps_coordinates": {<br/>          "latitude": 30.2676,<br/>          "longitude": -97.74416<br/>        }<br/>      },<br/>      {<br/>        "position": 3,<br/>        "title": "Iron Cactus Mexican Restaurant and Margarita Bar",<br/>        "type": "Mexican",<br/>        "price": "$$",<br/>        "address": "606 Trinity St",<br/>        "rating": 4.1,<br/>        "delivery": "Dine-in·Takeout·No delivery",<br/>        "lsig": "AB86z5X7Qq4vf--TBLEsXDYRUbVd",<br/>        "place_id_search": "https://serpapi.com/search.json?device=desktop&amp;engine=google&amp;gl=us&amp;google_domain=google.com&amp;hl=en&amp;location=Austin%2C+Texas%2C+United+States&amp;lsig=AB86z5X7Qq4vf--TBLEsXDYRUbVd&amp;ludocid=2855033105612448970&amp;q=Mexican+Restaurant&amp;tbm=lcl",<br/>        "gps_coordinates": {<br/>          "latitude": 30.2674,<br/>          "longitude": -97.73945<br/>        }<br/>      }<br/>    ]<br/>  },</span></pre><p id="6262" class="pw-post-body-paragraph kp kq in kr b ks ln ku kv kw lo ky kz la lp lc ld le lq lg lh li lr lk ll lm ig bi translated"><strong class="kr io">查询</strong> : <code class="fe mi mj mk ly b">Mexican Restaurant</code> <br/> <strong class="kr io">传统解析器基准平均</strong> : <code class="fe mi mj mk ly b">225.45420559999457 ms</code> <br/> <strong class="kr io"> ML 混合解析器基准平均</strong> : <code class="fe mi mj mk ly b">223.7522506300229 ms</code> <br/> <strong class="kr io">平均差异</strong> : <code class="fe mi mj mk ly b">-1.7019549699716663 ms</code> <br/> ML 混合解析器比传统解析器<code class="fe mi mj mk ly b">1.007606426148472 times faster</code></p><h1 id="e5f7" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">保险代理公司</h1><figure class="lt lu lv lw gt jo gh gi paragraph-image"><div class="gh gi jk"><img src="../Images/a892a34ca61b8ba205d176bdd90f2f99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BDW0ONuMNN2iD6nQ.png"/></div></figure><pre class="lt lu lv lw gt lx ly lz ma aw mb bi"><span id="55ce" class="mc js in ly b gy md me l mf mg">"local_results": {<br/>    "places": [<br/>      {<br/>        "position": 1,<br/>        "title": "Amco Insurance Austin",<br/>        "type": "Insurance agency",<br/>        "address": "RdB, 12603 Market Street",<br/>        "rating": 1,<br/>        "reviews": 1,<br/>        "phone": "(713) 450-4949",<br/>        "lsig": "AB86z5XbiSodHxmtytu2NF12jBla",<br/>        "place_id_search": "https://serpapi.com/search.json?device=desktop&amp;engine=google&amp;gl=us&amp;google_domain=google.com&amp;hl=en&amp;location=Austin%2C+Texas%2C+United+States&amp;lsig=AB86z5XbiSodHxmtytu2NF12jBla&amp;ludocid=3762069798187571614&amp;q=Insurance+Agency&amp;tbm=lcl",<br/>        "gps_coordinates": {<br/>          "latitude": 30.267153,<br/>          "longitude": -97.74306<br/>        }<br/>      },<br/>      {<br/>        "position": 2,<br/>        "title": "Michaels Insurance Group",<br/>        "type": "Insurance agency",<br/>        "address": "501 Congress Ave Suite 150A",<br/>        "hours": "Open ⋅ Closes 6PM",<br/>        "phone": "(512) 593-1171",<br/>        "lsig": "AB86z5UOT_Ai1eBIwgwkGAIAMAF8",<br/>        "place_id_search": "https://serpapi.com/search.json?device=desktop&amp;engine=google&amp;gl=us&amp;google_domain=google.com&amp;hl=en&amp;location=Austin%2C+Texas%2C+United+States&amp;lsig=AB86z5UOT_Ai1eBIwgwkGAIAMAF8&amp;ludocid=16496161963606301439&amp;q=Insurance+Agency&amp;tbm=lcl",<br/>        "gps_coordinates": {<br/>          "latitude": 30.267204,<br/>          "longitude": -97.74261<br/>        }<br/>      },<br/>      {<br/>        "position": 3,<br/>        "title": "Jones Derek",<br/>        "type": "Insurance agency",<br/>        "address": "401 Congress Ave # 1900 · In Frost Bank Tower",<br/>        "phone": "(512) 469-3430",<br/>        "years_in_business": "10+ years in business",<br/>        "lsig": "AB86z5VtQJgNsgG5T_iWQdrzIjPr",<br/>        "place_id_search": "https://serpapi.com/search.json?device=desktop&amp;engine=google&amp;gl=us&amp;google_domain=google.com&amp;hl=en&amp;location=Austin%2C+Texas%2C+United+States&amp;lsig=AB86z5VtQJgNsgG5T_iWQdrzIjPr&amp;ludocid=1165792112025048434&amp;q=Insurance+Agency&amp;tbm=lcl",<br/>        "gps_coordinates": {<br/>          "latitude": 30.266655,<br/>          "longitude": -97.74313<br/>        }<br/>      }<br/>    ]<br/>  },</span></pre><p id="a4f8" class="pw-post-body-paragraph kp kq in kr b ks ln ku kv kw lo ky kz la lp lc ld le lq lg lh li lr lk ll lm ig bi translated"><strong class="kr io">查询</strong> : <code class="fe mi mj mk ly b">Insurance Agency</code> <br/> <strong class="kr io">传统解析器基准平均</strong> : <code class="fe mi mj mk ly b">243.73682075000943 ms</code> <br/> <strong class="kr io"> ML 混合解析器基准平均</strong> : <code class="fe mi mj mk ly b">242.52781047999179 ms</code> <br/> <strong class="kr io">平均差</strong> : <code class="fe mi mj mk ly b">-1.209010270017643 ms</code> <br/> ML 混合解析器比传统解析器要<code class="fe mi mj mk ly b">1.0049850376648553 times faster</code></p><h1 id="7bc9" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">咖啡</h1><figure class="lt lu lv lw gt jo gh gi paragraph-image"><div class="gh gi jk"><img src="../Images/f11ef134742e5690c7427ea41c36088c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*nIpot4k0c8luy8d9.png"/></div></figure><pre class="lt lu lv lw gt lx ly lz ma aw mb bi"><span id="5b53" class="mc js in ly b gy md me l mf mg">"local_results": {<br/>    "places": [<br/>      {<br/>        "position": 1,<br/>        "title": "Houndstooth Coffee",<br/>        "type": "Coffee shop",<br/>        "price": "$$",<br/>        "address": "401 Congress Ave #100c · In Frost Bank Tower",<br/>        "rating": 4.6,<br/>        "delivery": "Dine-in·Takeout·No delivery",<br/>        "lsig": "AB86z5Vdw6C2pJpM0xQ6JUx2KONU",<br/>        "place_id_search": "https://serpapi.com/search.json?device=desktop&amp;engine=google&amp;gl=us&amp;google_domain=google.com&amp;hl=en&amp;location=Austin%2C+Texas%2C+United+States&amp;lsig=AB86z5Vdw6C2pJpM0xQ6JUx2KONU&amp;ludocid=11265938073076301333&amp;q=Coffee&amp;tbm=lcl",<br/>        "gps_coordinates": {<br/>          "latitude": 30.2664,<br/>          "longitude": -97.74278<br/>        }<br/>      },<br/>      {<br/>        "position": 2,<br/>        "title": "Starbucks",<br/>        "type": "Coffee shop",<br/>        "price": "$$",<br/>        "address": "600 Congress Ave",<br/>        "rating": 4.1,<br/>        "reviews": 513,<br/>        "delivery": "Dine-in·Drive-through·Delivery",<br/>        "lsig": "AB86z5XTJ_Io_anVBu2fU6Zaqu3b",<br/>        "place_id_search": "https://serpapi.com/search.json?device=desktop&amp;engine=google&amp;gl=us&amp;google_domain=google.com&amp;hl=en&amp;location=Austin%2C+Texas%2C+United+States&amp;lsig=AB86z5XTJ_Io_anVBu2fU6Zaqu3b&amp;ludocid=10605736027611436825&amp;q=Coffee&amp;tbm=lcl",<br/>        "gps_coordinates": {<br/>          "latitude": 30.26826,<br/>          "longitude": -97.74296<br/>        }<br/>      },<br/>      {<br/>        "position": 3,<br/>        "title": "The Hideout Coffee House",<br/>        "type": "Coffee shop",<br/>        "price": "$",<br/>        "address": "617 Congress Ave",<br/>        "rating": 4.4,<br/>        "delivery": "Dine-in·Takeout·No-contact delivery",<br/>        "hours": "Closed ⋅ Opens 7AM Thu",<br/>        "lsig": "AB86z5WSxdnDKVF_iLXNN6Lg0UQ5",<br/>        "place_id_search": "https://serpapi.com/search.json?device=desktop&amp;engine=google&amp;gl=us&amp;google_domain=google.com&amp;hl=en&amp;location=Austin%2C+Texas%2C+United+States&amp;lsig=AB86z5WSxdnDKVF_iLXNN6Lg0UQ5&amp;ludocid=15498522356495312950&amp;q=Coffee&amp;tbm=lcl",<br/>        "gps_coordinates": {<br/>          "latitude": 30.268572,<br/>          "longitude": -97.742165<br/>        }<br/>      }<br/>    ]<br/>  },</span></pre><p id="963a" class="pw-post-body-paragraph kp kq in kr b ks ln ku kv kw lo ky kz la lp lc ld le lq lg lh li lr lk ll lm ig bi translated"><strong class="kr io">查询</strong> : <code class="fe mi mj mk ly b">Coffee</code> <br/> <strong class="kr io">传统解析器基准平均</strong> : <code class="fe mi mj mk ly b">381.3813184999935 ms</code> <br/> <strong class="kr io"> ML 混合解析器基准平均</strong> : <code class="fe mi mj mk ly b">374.56337533000345 ms</code> <br/> <strong class="kr io">平均差异</strong> : <code class="fe mi mj mk ly b">-6.817943169990031 ms</code> <br/> ML 混合解析器比传统解析器要<code class="fe mi mj mk ly b">1.0182023754030494 times faster</code></p><h1 id="429a" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">II —整个解析过程的精确基准</h1><p id="fcd7" class="pw-post-body-paragraph kp kq in kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ig bi translated">上述基准测试显示了短期内实现的表现，并且没有显示出异常情况的迹象。然而，让我们对一个更精确的单一结果进行同样的测试。我们将运行这两个解析过程 60 秒，并比较运行次数:</p><pre class="lt lu lv lw gt lx ly lz ma aw mb bi"><span id="1a41" class="mc js in ly b gy md me l mf mg">require "benchmark/ips"</span><span id="3fd5" class="mc js in ly b gy mh me l mf mg">Benchmark.ips do |x|<br/>  x.config(:time =&gt; 60, :warmup =&gt; 2)<br/>  x.report("Traditional Parser") { search.parse! false }<br/>  x.report("ML Hybrid Parser") { search.parse! true }<br/>  x.compare!<br/>end</span></pre><p id="2efc" class="pw-post-body-paragraph kp kq in kr b ks ln ku kv kw lo ky kz la lp lc ld le lq lg lh li lr lk ll lm ig bi translated">结果如下:</p><figure class="lt lu lv lw gt jo gh gi paragraph-image"><div class="gh gi jk"><img src="../Images/9a3fcc115e47ba20fd5281555c10bbc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_hjFG5LD_hE16juR.png"/></div></figure><pre class="lt lu lv lw gt lx ly lz ma aw mb bi"><span id="049d" class="mc js in ly b gy md me l mf mg">"local_results": {<br/>    "places": [<br/>      {<br/>        "position": 1,<br/>        "title": "Austin MacWorks",<br/>        "type": "Computer store",<br/>        "address": "450 W 2nd St · In 2nd Street District",<br/>        "rating": 3.6,<br/>        "reviews": 35,<br/>        "delivery": "In-store shopping·In-store pickup",<br/>        "hours": "Closes soon ⋅ 6PM",<br/>        "phone": "(512) 476-7000",<br/>        "lsig": "AB86z5UwIX4i7B78tBctQlVN-S5I",<br/>        "place_id_search": "https://serpapi.com/search.json?device=desktop&amp;engine=google&amp;gl=us&amp;google_domain=google.com&amp;hl=en&amp;location=Austin%2C+Texas%2C+United+States&amp;lsig=AB86z5UwIX4i7B78tBctQlVN-S5I&amp;ludocid=7461317996150463296&amp;q=Computer+Store&amp;tbm=lcl",<br/>        "gps_coordinates": {<br/>          "latitude": 30.265661,<br/>          "longitude": -97.74838<br/>        }<br/>      },<br/>      {<br/>        "position": 2,<br/>        "title": "Mactell Corporation",<br/>        "type": "Computer store",<br/>        "phone": "(512) 457-1133",<br/>        "lsig": "AB86z5UVY5r6ZpGnUqP-wixtE-Nu",<br/>        "place_id_search": "https://serpapi.com/search.json?device=desktop&amp;engine=google&amp;gl=us&amp;google_domain=google.com&amp;hl=en&amp;location=Austin%2C+Texas%2C+United+States&amp;lsig=AB86z5UVY5r6ZpGnUqP-wixtE-Nu&amp;ludocid=1747786920379540476&amp;q=Computer+Store&amp;tbm=lcl",<br/>        "gps_coordinates": {<br/>          "latitude": 30.272924,<br/>          "longitude": -97.7444<br/>        }<br/>      },<br/>      {<br/>        "position": 3,<br/>        "title": "Campus Computer Store",<br/>        "type": "Computer store",<br/>        "address": "2304 Whitis Avenue, (FAC) 109 · In the University of Texas at Austin",<br/>        "rating": 3.8,<br/>        "reviews": 53,<br/>        "delivery": "In-store shopping·Curbside pickup·Delivery",<br/>        "hours": "Closes soon ⋅ 6PM",<br/>        "phone": "(512) 475-6550",<br/>        "lsig": "AB86z5XQ-nWlsJPMAzOoIwJ_Pjll",<br/>        "place_id_search": "https://serpapi.com/search.json?device=desktop&amp;engine=google&amp;gl=us&amp;google_domain=google.com&amp;hl=en&amp;location=Austin%2C+Texas%2C+United+States&amp;lsig=AB86z5XQ-nWlsJPMAzOoIwJ_Pjll&amp;ludocid=15624962612924024738&amp;q=Computer+Store&amp;tbm=lcl",<br/>        "gps_coordinates": {<br/>          "latitude": 30.286259,<br/>          "longitude": -97.74032<br/>        }<br/>      }<br/>    ]<br/>  },Calculating -------------------------------------<br/>  Traditional Parser      5.741  (± 0.0%) i/s -    343.000  in  60.020695s<br/>    ML Hybrid Parser      4.807  (± 0.0%) i/s -    288.000  in  60.158318s</span><span id="7abf" class="mc js in ly b gy mh me l mf mg">Comparison:<br/>  Traditional Parser:        5.7 i/s<br/>    ML Hybrid Parser:        4.8 i/s - 1.19x  (± 0.00) slower</span></pre><h1 id="2be3" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">III —本地解析过程的基准</h1><p id="6077" class="pw-post-body-paragraph kp kq in kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ig bi translated">让我们也为本地解析过程定义一个本地基准。这是两种方法之间的直接比较。下面是对它的测试:</p><pre class="lt lu lv lw gt lx ly lz ma aw mb bi"><span id="2473" class="mc js in ly b gy md me l mf mg">require "benchmark/ips"</span><span id="2eac" class="mc js in ly b gy mh me l mf mg">Benchmark.ips do |x|<br/>  x.config(:time =&gt; 60, :warmup =&gt; 2)<br/>  x.report("ML Hybrid Parser") { get_local_results_desktop_ml local_results_top }<br/>  x.report("Traditional Parser") { get_local_results_desktop }<br/>  x.compare!<br/>end</span></pre><p id="bf47" class="pw-post-body-paragraph kp kq in kr b ks ln ku kv kw lo ky kz la lp lc ld le lq lg lh li lr lk ll lm ig bi translated">输出:</p><pre class="lt lu lv lw gt lx ly lz ma aw mb bi"><span id="0a04" class="mc js in ly b gy md me l mf mg">Calculating -------------------------------------<br/>  Traditional Parser     38.829  (± 2.6%) i/s -      2.328k in  60.015623s<br/>    ML Hybrid Parser     23.121  (± 4.3%) i/s -      1.384k in  60.003592s</span><span id="d20f" class="mc js in ly b gy mh me l mf mg">Comparison:<br/>  Traditional Parser:       38.8 i/s<br/>    ML Hybrid Parser:       23.1 i/s - 1.68x  (± 0.00) slower</span></pre><h1 id="fde0" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">四、结论</h1><p id="4645" class="pw-post-body-paragraph kp kq in kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ig bi translated">如果我们考虑到准确的结果，1.68 倍的本地变化速度和 1.19 倍的整个解析过程速度(搜索查询固有的，并且仅在具有本地部分的结果中)，就毫秒而言仍然是一个不错的转换。考虑到传统的解析器给出了太多的错误结果，这种实现在不导致加载时间意外延迟的情况下非常重要。我见过它在其他搜索中表现更好。在整个解析过程中，我能得到的最低精确结果是慢 1.07 倍。我遇到的最大情况就是这个结果，因此我分享它作为一个诚实表现的例子。在任何情况下，它对用户来说都是微不足道的。我要感谢读者的关注，感谢才华横溢的 SerpApi 人的支持。下周，我们将讨论 ML 的一般测试目的。</p></div></div>    
</body>
</html>