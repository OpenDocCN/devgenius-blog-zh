<html>
<head>
<title>Elasticsearch : Ingest Pipelines</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¼¹æ€§æœç´¢:æ‘„å–ç®¡é“</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://blog.devgenius.io/elasticsearch-ingest-pipelines-6335d349a0a?source=collection_archive---------3-----------------------#2022-08-30">https://blog.devgenius.io/elasticsearch-ingest-pipelines-6335d349a0a?source=collection_archive---------3-----------------------#2022-08-30</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/89705072cd0531af4cf52367fd402b79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dwAzdScwyFi0RCm5J1vcew.jpeg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">ç…§ç‰‡ç”±<a class="ae jz" href="https://unsplash.com/@jjying?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> JJ è‹±</a>åœ¨<a class="ae jz" href="https://unsplash.com/s/photos/pipelines?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></figcaption></figure><p id="bb9d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">ä»€ä¹ˆæ˜¯å¥½äººï¼Ÿå¾ˆé«˜å…´åœ¨è¿™ä¸ªç³»åˆ—ä¸­å†æ¬¡è§åˆ°ä½ ğŸ˜ï¼ä»Šå¤©æˆ‘ä»¬æ¥çœ‹çœ‹<strong class="kc io">æ‘„å–ç®¡é“ã€‚</strong></p><p id="0653" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">æ‘„å–ç®¡é“å…è®¸æˆ‘ä»¬åº”ç”¨è½¬æ¢ï¼Œä¾‹å¦‚<em class="ky">åˆ é™¤å­—æ®µ</em>ã€<em class="ky">æå–ä¿¡æ¯</em>ï¼Œç”šè‡³<em class="ky">åœ¨ç´¢å¼•æ–‡æ¡£ä¹‹å‰ä¸°å¯Œæˆ‘ä»¬çš„æ•°æ®</em>ã€‚</p><figure class="la lb lc ld gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi kz"><img src="../Images/059ad292991ba367aa7e95b7fbba776b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U-XK3k_0RnQgGxlNIOqTQA.png"/></div></div></figure><p id="edff" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªæ–‡æ¡£ï¼Œå¹¶ä¸”æˆ‘ä»¬æƒ³è¦æå–æœ‰æ„ä¹‰çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬é€šè¿‡æ‘„å–ç®¡é“è¿è¡Œè¯¥æ–‡æ¡£ï¼Œå¹¶ä¸”åº”ç”¨ä¸åŒçš„å¤„ç†å™¨ï¼Œä¾‹å¦‚<em class="ky">å‰–æå¤„ç†å™¨</em>æ¥æå–æ—¶é—´æˆ³ï¼Œæˆ–è€…<em class="ky">ç§»é™¤å¤„ç†å™¨</em>æ¥åˆ é™¤å­—æ®µï¼Œç­‰ç­‰ã€‚</p><p id="4d89" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">è½¬æ¢å®Œæˆåï¼Œç”Ÿæˆçš„æ–‡æ¡£å°†è¢«ç´¢å¼•ã€‚ä¸€ä¸ªæµæ°´çº¿ç”±å‡ ä¸ªå¯é…ç½®çš„ä»»åŠ¡ç»„æˆï¼Œè¿™äº›ä»»åŠ¡è¢«ç§°ä¸º<a class="ae jz" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/processors.html" rel="noopener ugc nofollow" target="_blank">å¤„ç†å™¨</a>ã€‚éšç€æ¯ä¸ªå¤„ç†å™¨ç›¸ç»§è¿è¡Œï¼Œä¼ å…¥çš„æ–‡æ¡£ä¼šè¿›è¡ŒæŸäº›ä¿®æ”¹ã€‚Elasticsearch åŒ…æ‹¬å‡ ä¸ªå¯é…ç½®çš„å¤„ç†å™¨ã€‚<br/>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨èŠ‚ç‚¹ä¿¡æ¯ API æ¥è·å–å¯ç”¨å¤„ç†å™¨çš„åˆ—è¡¨ã€‚</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="7bb0" class="lj lk in lf b gy ll lm l ln lo">GET _nodes/ingest?filter_path=nodes.*.ingest.processors</span></pre><p id="15a2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">ä½¿ç”¨æ‘„å– API æˆ– Kibana çš„æ‘„å–ç®¡é“åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºå’Œç®¡ç†æ‘„å–ç®¡é“ã€‚ç®¡é“ç”± Elasticsearch å­˜å‚¨åœ¨<a class="ae jz" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-state.html" rel="noopener ugc nofollow" target="_blank">é›†ç¾¤çŠ¶æ€</a>ä¸­ï¼Œè¿™æ˜¯ä¸€ç§å†…éƒ¨æ•°æ®ç»“æ„ï¼Œè®°å½•äº†æ¯ä¸ªèŠ‚ç‚¹æ‰€éœ€çš„å„ç§æ•°æ®ã€‚</p><p id="570e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">è®©æˆ‘ä»¬ä½¿ç”¨<a class="ae jz" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/ingest-apis.html" rel="noopener ugc nofollow" target="_blank">æ‘„å– API</a>æ¥åˆ›å»ºæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªç®¡é“ã€‚</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="b316" class="lj lk in lf b gy ll lm l ln lo">PUT _ingest/pipeline/my-first-pipeline<br/>{<br/>  "version": 1,<br/>  "description": "My very first pipeline",<br/>  "processors": [<br/>    {<br/>      "set": {<br/>        "description": "Set default value of balance",<br/>        "field": "balance",<br/>        "value": 0<br/>      }<br/>    },<br/>    {<br/>      "set": {<br/>        "description": "Set default value of status field",<br/>        "field": "status",<br/>        "value": true<br/>      }<br/>    },<br/>    {<br/>      "lowercase": {<br/>        "field": "name"<br/>      }<br/>    },<br/>    {<br/>      "remove": {<br/>        "field": "unnecessary field"<br/>      }<br/>    }<br/>  ]<br/>}</span></pre><p id="7e4d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">æˆ‘ä»¬çŸ¥é“ï¼Œå½“æˆ‘ä»¬åœ¨<em class="ky">çœŸ</em>æ—¶å¾—åˆ°<em class="ky">ç¡®è®¤</em>æ—¶ï¼Œæˆ‘ä»¬çš„ç®¡é“å°±åˆ›å»ºå¥½äº†ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬é€šè¿‡ä½¿ç”¨<a class="ae jz" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/simulate-pipeline-api.html" rel="noopener ugc nofollow" target="_blank">æ¨¡æ‹Ÿç®¡é“ API </a>æ¥æµ‹è¯•æˆ‘ä»¬çš„ç®¡é“ã€‚</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="1fd2" class="lj lk in lf b gy ll lm l ln lo">POST _ingest/pipeline/my-first-pipeline/_simulate<br/>{<br/>  "docs": [<br/>    {<br/>      "_source": {<br/>        "name": "Abdoul-Bagui",<br/>        "unnecessary field": "Field to remove"<br/>      }<br/>    }<br/>  ]<br/>}</span></pre><p id="8eea" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">å¯åŠ¨æ—¶ï¼Œæˆ‘ä»¬å¾—åˆ°ä»¥ä¸‹è¾“å‡º:</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="482d" class="lj lk in lf b gy ll lm l ln lo">{<br/>  "docs": [<br/>    {<br/>      "doc": {<br/>        "_index": "_index",<br/>        "_id": "_id",<br/>        "_version": "-3",<br/>        "_source": {<br/>          "name": "abdoul-bagui",<br/>          "balance": 0,<br/>          "status": true<br/>        },<br/>        "_ingest": {<br/>          "timestamp": "2022-08-30T21:11:25.3094683Z"<br/>        }<br/>      }<br/>    }<br/>  ]<br/>}</span></pre><p id="eedd" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">å¦‚æ‚¨æ‰€è§ï¼Œæˆ‘ä»¬çš„æ–‡æ¡£å·²ç»è¿‡è½¬æ¢ã€‚<em class="ky">åç§°</em>å­—æ®µå…¨éƒ¨æ”¹ä¸ºå°å†™ï¼Œæ·»åŠ äº†ä¸¤ä¸ªå­—æ®µ(<em class="ky">çŠ¶æ€</em>å’Œ<em class="ky">ä½™é¢</em>)ä¸ºé»˜è®¤å€¼ï¼Œåˆ é™¤çš„å­—æ®µ(<em class="ky">ä¸éœ€è¦çš„å­—æ®µ</em>)ä¸å†ä¿ç•™ã€‚</p><p id="24f2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">æˆ‘ä»¬çš„ç®¡é“å·²åˆ›å»ºå¹¶æ­£å¸¸å·¥ä½œï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰§è¡Œä»¥ä¸‹æ“ä½œå°†å…¶æ·»åŠ åˆ°ç´¢å¼•è¯·æ±‚ä¸­:</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="51f8" class="lj lk in lf b gy ll lm l ln lo">POST users/_doc?pipeline=my-first-pipeline<br/>{<br/>  "name": "Trevor Noah",<br/>  "unnecessary field": "to remove"<br/>}</span></pre><p id="3b08" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">å¦‚æœæ‚¨å·²ç»æœ‰äº†ä¸€ä¸ªç´¢å¼•ï¼Œå¹¶ä¸”æƒ³è¦ç»™å®ƒé™„åŠ ä¸€ä¸ªç®¡é“ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥ä½¿ç”¨<a class="ae jz" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-reindex.html" rel="noopener ugc nofollow" target="_blank"> reindex </a>ã€‚ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¡«å……äº†<em class="ky">ç”¨æˆ·</em>çš„<em class="ky">è´¦æˆ·</em>ç´¢å¼•:</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="0c29" class="lj lk in lf b gy ll lm l ln lo">PUT accounts/_bulk<br/>{ "create":{ } }<br/>{"name": "Bill Gates"}<br/>{ "create":{ } }<br/>{"name": "Elon Musk"}<br/>{ "create":{ } }<br/>{"name": "Tony Stark"}</span></pre><p id="e242" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">ç°åœ¨è®©æˆ‘ä»¬åœ¨ç´¢å¼•ä¸Šä½¿ç”¨<em class="ky"> reindex </em>å¹¶æŒ‡å®šä¸Šé¢åˆ›å»ºçš„ç®¡é“ã€‚</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="4c04" class="lj lk in lf b gy ll lm l ln lo">POST _reindex<br/>{<br/>  "source": {<br/>    "index": "accounts"<br/>  },<br/>  "dest": {<br/>    "index": "new_accounts",<br/>    "op_type": "create",<br/>    "pipeline": "my-first-pipeline"<br/>  }<br/>}</span></pre><p id="e01c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="ky"> new_accounts </em>ç´¢å¼•æ˜¯ç”¨æˆ‘ä»¬è½¬æ¢åçš„å€¼åˆ›å»ºçš„ã€‚æ‚¨å¯ä»¥é€šè¿‡è¿è¡Œ<em class="ky"> GET new_accounts/_search æ¥æ£€æŸ¥å®ƒã€‚</em></p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="e545" class="lj lk in lf b gy ll lm l ln lo">{<br/> ...<br/> "hits": [<br/>      {<br/>        "_index": "new_accounts",<br/>        "_id": "eVqp8IIBqJSo_EdApqQO",<br/>        "_score": 1,<br/>        "_source": {<br/>          "name": "bill gates",<br/>          "balance": 0,<br/>          "status": true<br/>        }<br/>      },<br/>      {<br/>        "_index": "new_accounts",<br/>        "_id": "elqp8IIBqJSo_EdApqQO",<br/>        "_score": 1,<br/>        "_source": {<br/>          "name": "elon musk",<br/>          "balance": 0,<br/>          "status": true<br/>        }<br/>      },<br/>      {<br/>        "_index": "new_accounts",<br/>        "_id": "e1qp8IIBqJSo_EdApqQO",<br/>        "_score": 1,<br/>        "_source": {<br/>          "name": "tony stark",<br/>          "balance": 0,<br/>          "status": true<br/>        }<br/>      }<br/>    ]<br/> ...<br/>}</span></pre><p id="7828" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">åœ¨æˆ‘æ¨èæ‚¨é˜…è¯»çš„<a class="ae jz" href="https://medium.com/@mhdabdel151/metricbeat-with-local-elasticsearch-and-kibana-c330c902e473" rel="noopener">ä¸Šä¸€ç¯‡æ–‡ç« </a>ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†å¦‚ä½•é…ç½® Metricbeatï¼Œæˆ‘ä»¬åªéœ€åœ¨ Metricbeat é…ç½®æ–‡ä»¶(<em class="ky"> metricbeat.yml) </em>ä¸­æåˆ°ç®¡é“ï¼Œå°±å¯ä»¥å°†ç®¡é“æ·»åŠ åˆ°è¿™ä¸ª beatï¼Œå› æ­¤çœ‹èµ·æ¥åƒè¿™æ ·:</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="76aa" class="lj lk in lf b gy ll lm l ln lo">output.elasticsearch:<br/>  hosts: ["localhost:9200"]<br/>  protocol: "https"<br/>  username: "elastic"<br/>  password: "your-password"<br/>  pipeline: my-first-pipeline<br/>  ssl:<br/>    enabled: true<br/>    ca_trusted_fingerprint: "your_fingerprint"</span></pre><p id="1bf4" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">ç®¡é“æœ‰æ›´å¤šçš„ç”¨é€”ï¼Œæ‚¨å¯ä»¥æœ‰æ¡ä»¶åœ°åº”ç”¨ç®¡é“ï¼Œå¤„ç†ç®¡é“æ•…éšœï¼Œç”šè‡³è·å¾—ç®¡é“ä½¿ç”¨ç»Ÿè®¡ä¿¡æ¯ã€‚è¯·éšæ„æŸ¥çœ‹å…³äºè¯¥ä¸»é¢˜çš„å®˜æ–¹æ–‡æ¡£<a class="ae jz" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/ingest.html#ingest" rel="noopener ugc nofollow" target="_blank">ä»¥è·å–æ›´å¤šä¿¡æ¯ã€‚</a></p><p id="85a9" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">ä»Šå¤©åˆ°æ­¤ä¸ºæ­¢ã€‚æ„Ÿè°¢æ‚¨çš„é˜…è¯»ï¼Œå¦‚æœæ‚¨å¯¹æœ¬æ–‡æœ‰ä»»ä½•é—®é¢˜æˆ–è¯„è®ºï¼Œè¯·åœ¨ä¸‹é¢ç•™ä¸‹æ‚¨çš„è¯„è®ºã€‚</p><p id="099f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">æˆ‘ä»¬ä¸‹æ¬¡å†è§ï¼Œçœ‹æ›´å¤šçš„å¸–å­ğŸš€ã€‚</p><p id="8168" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">é˜¿åœæœå°”-å·´å‰</p></div></div>    
</body>
</html>