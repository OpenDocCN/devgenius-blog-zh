<html>
<head>
<title>Multiple Linear Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">多元线性回归</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/multiple-linear-regression-9448ef1ce721?source=collection_archive---------6-----------------------#2022-11-11">https://blog.devgenius.io/multiple-linear-regression-9448ef1ce721?source=collection_archive---------6-----------------------#2022-11-11</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="160d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">执行多元线性回归的完整演练</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/69b5468b573bbf155206922459cc8911.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cmb_3XFqlXEQuIp88u_Cpw.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Stephan Margo 在<a class="ae ky" href="https://unsplash.com/photos/yt8mmYgLLLA" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的图片</figcaption></figure><p id="f5c6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在我们之前的故事中，我们了解了为什么使用回归以及什么是简单线性回归。</p><p id="bbb5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你想了解更多关于简单线性回归<a class="ae ky" href="https://medium.com/dev-genius/an-introduction-to-simple-linear-regression-7ad6c5287225" rel="noopener">这里</a>，我建议你浏览一下之前的故事。</p><p id="3ff3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这篇文章中，我试图用一些补充来总结我从 ISLR 回归书中学到的东西。在这里，我们将借助广告数据讨论多元线性回归的基础知识，并学习验证模型假设。</p><p id="ee28" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">多元线性回归是一种利用多个预测因子预测响应变量 Y 的方法，假设响应变量与其他预测因子呈线性关系。</p><p id="4bf2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">数学上，我们可以将等式写成</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi kz"><img src="../Images/07b937468b193e691beb287bf176e567.png" data-original-src="https://miro.medium.com/v2/resize:fit:604/format:webp/1*SzBWCaG3yGjXaw02u0pfZw.png"/></div></figure><p id="57fc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">其中，βₚ是 Xₚ增加一个单位对 y 的平均影响，保持所有其他预测因子不变，p 是预测因子的数量。</p><p id="a061" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">当使用回归处理问题陈述时，我们可以回答以下问题</p><ol class=""><li id="29e8" class="la lb in jm b jn jo jr js jv lc jz ld kd le kh lf lg lh li bi translated">反应变量和预测因子之间有关系吗？</li><li id="4da5" class="la lb in jm b jn lj jr lk jv ll jz lm kd ln kh lf lg lh li bi translated">哪些预测因子可用于预测反应变量？</li><li id="fad2" class="la lb in jm b jn lj jr lk jv ll jz lm kd ln kh lf lg lh li bi translated">我们能多准确地预测响应变量？</li><li id="50b5" class="la lb in jm b jn lj jr lk jv ll jz lm kd ln kh lf lg lh li bi translated">给定一组预测值，响应值应该是多少？</li></ol><p id="e05f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">随着文章的深入，我们将讨论所有这些问题。</p><p id="11d7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们首先在这里加载 Kaggle <a class="ae ky" href="https://www.kaggle.com/datasets/ashydv/advertising-dataset" rel="noopener ugc nofollow" target="_blank">上的广告数据。</a></p><pre class="kj kk kl km gt lo lp lq lr aw ls bi"><span id="9580" class="lt lu in lp b gy lv lw l lx ly">#View the dataset</span><span id="f513" class="lt lu in lp b gy lz lw l lx ly">head(Advertising)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ma"><img src="../Images/06cc73560680f8e9959ad4e6c2bbc73a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ITsswBISyuhPJXO4MEF6XQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自作者</figcaption></figure><p id="2274" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这里，我们有电视、广播和报纸的广告支出，以美元为单位，销售额以单位表示。</p><p id="50b6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们在整个数据集上拟合模型，看看我们会得到什么结果</p><pre class="kj kk kl km gt lo lp lq lr aw ls bi"><span id="cfb4" class="lt lu in lp b gy lv lw l lx ly">lm_sales &lt;- lm(data = Advertising, Sales ~ .) <br/># . in R means all #variables<br/>summary(lm_sales)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/d790e83b1089c613e375f0de4bac5e03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*lZ5xGc8Ui51Y-0GiBgT3_g.png"/></div></figure><p id="2496" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> 1。让我们试着理解我们的反应变量和预测变量之间是否存在关系？</strong></p><p id="131c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要回答统计学中的任何问题，最好的方法是创建一个假设。</p><p id="d89d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这里，我们创建我们的假设，使我们假设零假设没有任何影响反应的预测；和备选假设，因为至少一个预测值非零。</p><p id="bc82" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">H₀ : β₁ = β₂ = = βₚ = 0 <br/> Hₐ:至少有一个βₚ不为零。</p><p id="019f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了评估这一点，我们在模型结果中使用 F 统计量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/06965474ff76cd05150db6658ec2d6e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:430/format:webp/1*ODkQFZLlKgN5mnPNW_z3qQ.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">乳胶制成的图像</figcaption></figure><p id="a40c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">当我们的零假设为真时，我们的 F 统计值更接近 1。在我们的例子中，我们观察到我们的 F 值是 570.3，这在统计上也是显著的(观察 F 统计右侧的 p 值)，因此我们成功地拒绝了零假设，并得出结论，在反应变量和预测因子之间存在关系</p><p id="e65a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="md">注意:在 p 大于 n 的情况下，这种解释不起作用</em></p><p id="4ff0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> 2。哪些预测因子有助于我们预测反应变量？</strong></p><p id="f770" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了回答这个问题，我们将看看所有变量的 p 值，看看它是否显著。对于电视和广播支出，我们看到 p 值为&lt; 0.05, hence these predictors have a significant effect on the response variable.</p><p id="2f15" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Here, I will rerun the model excluding Newspaper</p><pre class="kj kk kl km gt lo lp lq lr aw ls bi"><span id="1f6d" class="lt lu in lp b gy lv lw l lx ly"># Consider all predictors except Newspaper<br/>lm_sales &lt;- lm(data = Advertising, Sales ~ . — Newspaper) # - is #used to remove the variable<br/>summary(lm_sales)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi me"><img src="../Images/d1513537789de01f2eeff3e7fc90647e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/1*DIp-M6Hy-9ScoY3Q9U6zoA.png"/></div></figure><p id="bc47" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="md">。当预测值较小时，这种查看 p 值的方法通常很有帮助。但是，当我们有大量预测值时，我们可能希望应用更复杂的方法，如向前、向后或逐步选择(我们不会在教程中介绍这些方法，以使其专注于模型)</em></p><p id="cb63" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> 3。我们能多准确地预测响应变量？</strong></p><p id="3d8f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将使用调整后的 R 平方来评估 89%的数据拟合度。也就是说，我们的模型可以解释 89%的销售变化</p><p id="a163" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="md">移除报纸后观察，我们的模型拟合度略有提高</em></p><p id="8e4c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">4 <strong class="jm io">。给定一组预测值，响应值应该是多少？</strong></p><p id="0881" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">从模型中获得系数估计值后，我们可以简单地将方程写成</p><p id="75cb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">销售额= 2.921+ 0.045 *电视+ 0.187 *收音机</p><p id="8b3e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因此，如果我们已经花费了所有销售渠道的价值，我们可以很容易地使用上述模型方程预测销售额。</p></div><div class="ab cl mf mg hr mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ig ih ii ij ik"><p id="3090" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">包含回归中的交互作用:</strong></p><p id="e2c0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们之前讨论的方法也称为加法方法，因为我们直接将所有变量的影响相加，并假设系数值独立于其他变量，但这并不总是正确的。营销中的一个重要概念是协同效应，即如果我们在两个渠道上花钱，促销的有效性可以增加销售额，远远超过我们在电视上或广播上花钱的线性模型的预期，同时保持 Betas 不变。让我们扩展我们的模型，通过在线性模型中添加一个相互作用项，看看这个概念在我们的例子中是否真实</p><p id="d164" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">销量= β₀ + β₁ ×电视+ β₂ ×广播+ β₃ ×(广播×电视)+ ϵ</p><p id="8b4c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">= β₀ + (β₁ + β₃ ×电台)×电视+ β₂ ×电台+ ϵ</p><p id="41b9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="md">观察现在电视和广播是如何变得相互依赖的</em></p><p id="bb51" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们试着发现增加一个交互项是否会帮助我们提高拟合度。</p><pre class="kj kk kl km gt lo lp lq lr aw ls bi"><span id="9a68" class="lt lu in lp b gy lv lw l lx ly">lm_sales &lt;- lm(data = Advertising, formula = Sales ~ TV + Newspaper + Radio + TV:Radio)</span><span id="db24" class="lt lu in lp b gy lz lw l lx ly">summary(lm_sales)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/c9e3abbd2456ee837b0c6c0fae306b8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*P1Sz8HgV9uIffud832ylVA.png"/></div></figure><p id="4efa" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们观察到相互作用项确实是重要的，因此将它包含在我们的模型中对我们是有好处的。我们还观察到，模型的拟合度从 89%提高到了 96%，这是一个很大的进步。</p><p id="3393" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="md">注意:如果我们包括基于交互项，那么我们应该总是包括那些我们已经交互的变量，不管它们的 p 值如何</em></p><p id="1957" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">构建我们的第一个模型很好，但是在我们最终确定我们的解释之前，让我们看看我们的模型是否符合线性回归的假设。</p><p id="043b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">线性回归模型的假设:</strong></p><ol class=""><li id="04f3" class="la lb in jm b jn jo jr js jv lc jz ld kd le kh lf lg lh li bi translated"><strong class="jm io">反应-预测值关系的线性</strong></li></ol><p id="96c9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">线性模型假设预测值和响应之间的关系是线性的。这可以通过绘制残差图来检验。残差不应该有模式，应该是随机的。如果我们在残差中看到模式(如增加或减少或漏斗形)，那么关系不是线性的。</p><p id="db08" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">对于我们的模型，让我们使用 R 中的绘图函数来绘制残差</p><pre class="kj kk kl km gt lo lp mn bn mo mp bi"><span id="06aa" class="mq lu in lp b be mr ms l mt ly">lm_sales &lt;- lm(data = Advertising, formula = Sales ~ TV + Newspaper + Radio + TV:Radio)<br/>summary(lm_sales)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/8ef11f11c940d0ddf0009c972c0f3feb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DYApM2kL6jOf3-_a4pCP7Q.png"/></div></div></figure><p id="28b7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们可以在残差中轻微的模式，R 也突出显示了具有高残差值的点。我们可以看到，索引值(行号)为 156 和 131 点似乎与其他点稍微有些隔离。</p><p id="9abb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> 2。错误术语无关联:</strong></p><p id="c686" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这意味着，如果我们知道ϵi，我们应该没有关于ϵi+1.迹象的信息这种相关性可能出现在时间序列数据中，或者如果我们的预测因子彼此相关，例如，在一项研究中，如果我们使用体重来预测身高，如果一些人是同一家庭的成员并分享相同的饮食，则假设可能会被违反。这里，如果我们在残差图中观察，很难预测下一个误差，因为模式看起来是随机的。</p><p id="56cc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> 3。无异常值:</strong></p><p id="c622" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">异常值是其 yᵢ值与其他数据非常不同的值。例如，具有非常大误差项的值可以被分类为异常值。由于仅通过残差有时难以对异常值进行分类，我们使用学生化残差图来验证这一点。</p><p id="1f87" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">学生化残差是残差除以其标准误差，通常大于|3|的值被视为异常值。</p><p id="1ae0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">学生化残差在这个<a class="ae ky" href="https://online.stat.psu.edu/stat462/node/247/" rel="noopener ugc nofollow" target="_blank">环节</a>已经解释得很清楚了</p><p id="25f3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们看到所有的点都在-3 到 2 的范围内，但是 2 点看起来远远超过绝对值 3</p><pre class="kj kk kl km gt lo lp lq lr aw ls bi"><span id="f304" class="lt lu in lp b gy lv lw l lx ly">library(MASS)<br/>stud_resids_s &lt;- studres(lm_sales)<br/>plot(stud_resids_s)<br/></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/fb62d074431cf6910b302428ec853ad6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kX9nPSzb_9pE-BU5Z_ibnw.png"/></div></div></figure><p id="4e71" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这些术语在 156 和 131 中的索引值(我们在残差图中也获得了相同索引点的一些线索)</p><p id="2a92" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> 4。没有高杠杆点:</strong></p><p id="fc13" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">高杠杆点是由于不寻常的 xᵢ值而对斜率具有高影响的点。</p><p id="11c9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="md">杠杆涉及一些矩阵代数，因此我们不会在这里讨论杠杆理论。更多详情可以在</em> <a class="ae ky" href="https://online.stat.psu.edu/stat462/node/171/" rel="noopener ugc nofollow" target="_blank"> <em class="md">这里</em> </a>的链接中找到</p><pre class="kj kk kl km gt lo lp lq lr aw ls bi"><span id="3905" class="lt lu in lp b gy lv lw l lx ly">leverage_s &lt;- hatvalues(lm_sales)</span><span id="8de1" class="lt lu in lp b gy lz lw l lx ly">plot(leverage_s)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/cb3c6fb2cd098c15679e86ddb3c57564.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DAVxex-mDXxtLtjCPrhLlA.png"/></div></div></figure><p id="573e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这里，我们没有看到非常孤立的点，因此我们应该很好地利用这一点。</p><p id="9ff8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">通常为了验证，也可以使用利用库克距离计算的杠杆和异常值的组合，其利用 xᵢ和 Yᵢ变量说明高影响点</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/c8b8879e4dcd3046a201767189806268.png" data-original-src="https://miro.medium.com/v2/resize:fit:500/format:webp/1*tqekYmEpHfil4_aJB0yuyw.png"/></div></figure><p id="c0a6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这里 hᵢᵢ是杠杆，k 是除截距之外的贝塔数</p><p id="efe9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">如果我们绘制厨师距离，我们会观察到 2 个点，这 2 个点似乎与其他数据不同</strong></p><pre class="kj kk kl km gt lo lp lq lr aw ls bi"><span id="0f00" class="lt lu in lp b gy lv lw l lx ly">plot(cooks.distance(lm_sales))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi my"><img src="../Images/ef294b5266d234a02399ab21ec84a303.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gC23AoEMkx9uyRcKRfLMLQ.png"/></div></div></figure><p id="7e63" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在检查这些点的指数时，我们发现它又是 156 和 131。</p><p id="30a3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> 5。无共线性:</strong></p><p id="c9c2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">最后，我们检查共线性。在多元线性回归中，建议使用 VIF 检查共线性，因为它也可以解释多重共线性。</p><pre class="kj kk kl km gt lo lp lq lr aw ls bi"><span id="23ee" class="lt lu in lp b gy lv lw l lx ly">library(car)<br/>vif(lm_sales,type = "predictor")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/f3de17aa4208d17918dfbd093c2c4973.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*XRhOXDpDIQbYn7Z9ak70sw.png"/></div></figure><p id="f541" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这里，由于我们有一个相互作用项，我们修改我们的标准 VIF 并计算 VIF_new = GVIG ^ (1/(2*DF))(大于 10 的阈值可用于检查高 VIF_new)</p><p id="3a68" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们看到 GVIG ^ (1/(2*DF))值为 1，因此我们没有看到任何多重共线性</p><p id="5a6f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在检查了所有这些假设之后，我们发现的 2 个点似乎可以被删除，我们可以重新运行我们的模型来获得新的估计。</p><p id="c268" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我附上残差图和模型结果，以显示去除这些值后模型的改进。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/1a056cb968af420fadb83657ccb96e48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*19lONiaMBaQe0srPvVbEbQ.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/6dc7343009d214a33f5fb8e7d1bdce91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e0bpCm2M7EBpkOHD-DpWEg.png"/></div></div></figure><p id="0b08" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">看起来残差仍然有一个较小的模式，但它比我们之前的图更好，也更随机，因此使用它作为我们的最终模型。</p></div><div class="ab cl mf mg hr mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ig ih ii ij ik"><p id="34c4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">最后，希望你喜欢这篇文章。</p><p id="9af7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">欢迎分享您的反馈或意见，或者通过 Linkedinf 联系我。</p><p id="20ef" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">参考资料:</p><ol class=""><li id="2ed9" class="la lb in jm b jn jo jr js jv lc jz ld kd le kh lf lg lh li bi translated">【statlearning.com T2】统计学习导论</li><li id="96ad" class="la lb in jm b jn lj jr lk jv ll jz lm kd ln kh lf lg lh li bi translated">【第十课:回归陷阱| STAT 462(psu.edu)</li></ol></div></div>    
</body>
</html>