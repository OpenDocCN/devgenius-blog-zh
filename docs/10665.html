<html>
<head>
<title>Using Airbyte with Rest API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过 Rest API 使用 Airbyte</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/using-airbyte-with-rest-api-2e65c180ee80?source=collection_archive---------6-----------------------#2022-11-20">https://blog.devgenius.io/using-airbyte-with-rest-api-2e65c180ee80?source=collection_archive---------6-----------------------#2022-11-20</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="469c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">仅供参考。而不是构建一个 Rest API 自定义连接器！！！</p><p id="9923" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你在这里，你一定已经知道如何在你的本地或 AWS 或 Azure 上设置 Airbyte。</p><p id="0e61" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我想谈谈通过 Rest API 启动 Airbyte。如果有 UI，为什么我需要使用 REST？出于某种原因，我们不必通过 UI 暴露密码来启动 UI 上的源或目的地连接。</p><p id="fe59" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因此，我在 Airbyte 页面上使用了一些有良好文档记录的 REST API，尝试创建源、目的地和连接器。</p><p id="405b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">好戏开始了。假设您的 Airbyte 安装在本地主机上，端口为 7000</p><p id="5ecd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">工作空间:-一旦你设置了 Airbyte，它就有了一个工作空间 ID。找出你的工作空间，这里就是终点。当然，您知道如何获得工作区 ID，它已经在 Airbyte webapp URL 上定义了。</p><pre class="ki kj kk kl gt km kn ko bn kp kq bi"><span id="0ca2" class="kr ks in kn b be kt ku l kv kw">http://localhost:7000/api/v1/workspaces/list</span></pre><p id="e6c1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">列出 Airbyte 中所有可用的资源:</p><pre class="ki kj kk kl gt km kn ko bn kp kq bi"><span id="89c3" class="kr ks in kn b be kt ku l kv kw">http://localhost:7000/api/v1/source_definitions/list</span></pre><p id="9dd8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">假设您已经在 UI 上尝试了一些源代码，现在，让我们通过 Rest API 在您的工作空间中获取这些源代码。</p><pre class="ki kj kk kl gt km kn ko bn kp kq bi"><span id="1b08" class="kr ks in kn b be kt ku l kv kw">http://localhost:7000/api/v1/sources/list</span></pre><pre class="kx km kn ko bn kp kq bi"><span id="a268" class="kr ks in kn b be kt ku l kv kw">{<br/>  "workspace_id": "The output from the first endpoint(/api/v1/workspaces/list)"<br/>}</span></pre><p id="3b8f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">输出如下所示。</p><pre class="ki kj kk kl gt km kn ko bn kp kq bi"><span id="8a8c" class="kr ks in kn b be kt ku l kv kw">{<br/>    "sourceDefinitionId": "hfdd-dffd-sdsds",<br/>    "sourceId": "fdfds-fdfd",<br/>    "workspaceId": "esdffdfdg-ffff",<br/>}</span></pre><p id="8037" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">通过 Rest API 创建源代码:-从上面的示例输出中，我尝试创建一个与下面的端点和主体的 MSSQL server 连接。</p><pre class="ki kj kk kl gt km kn ko bn kp kq bi"><span id="85e9" class="kr ks in kn b be kt ku l kv kw">http://localhost:7000/api/v1/sources/create<br/><br/>{<br/>    "sourceDefinitionId": "MSSQL Source Definition ID (This you can get from the list of sources)",<br/>    "workspaceId": "Your Workspace Id",<br/>"connectionConfiguration": {<br/>        "host": "MSSQL Host",<br/>        "port": 1111,<br/>        "schemas": [<br/>            "dbo"<br/>        ],<br/>       "database": "databaseName",<br/>        "password": "Password. (When building a wrapper for this, try to read the secret from AWS Secret Manager or Azure Vault))",<br/>        "username": "admin",<br/>        "ssl_method": {<br/>            "ssl_method": "encrypted_trust_server_certificate"<br/>        },<br/>        "tunnel_method": {<br/>            "tunnel_method": "NO_TUNNEL"<br/>        },<br/>        "jdbc_url_params": "integratedSecurity=false&amp;encrypt=true",<br/>        "replication_method": {<br/>            "method": "STANDARD"<br/>        }<br/>    },<br/>    "name": "MSSQL Rest API"<br/>}</span></pre><p id="4fa4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果要在源上启用 CDC，请将复制方法更改为如下所示。上面的复制方法是“标准的”。仅供参考。</p><pre class="ki kj kk kl gt km kn ko bn kp kq bi"><span id="739f" class="kr ks in kn b be kt ku l kv kw">"replication_method": {<br/>            "method": "CDC",<br/>            "data_to_sync": "Existing and New",<br/>            "snapshot_isolation": "Snapshot"<br/>        }</span></pre><p id="7877" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你不喜欢你的来源，用下面的端点删除它。</p><pre class="ki kj kk kl gt km kn ko bn kp kq bi"><span id="5488" class="kr ks in kn b be kt ku l kv kw">http://localhost:7000/api/v1/sources/delete<br/><br/>{<br/>    "sourceId": "The source id is the output from the above create endpoint."<br/>}</span></pre><p id="1955" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，我们已经完成了对源的研究，让我们深入研究目的地。</p><p id="d8ab" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">列出 Airbyte 中所有可用的定义:</p><pre class="ki kj kk kl gt km kn ko bn kp kq bi"><span id="5e39" class="kr ks in kn b be kt ku l kv kw">http://localhost:7000/api/v1/destination_definitions/list_latestList the destinations in your workspace</span></pre><p id="b35e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">列出工作区中的所有定义</p><pre class="ki kj kk kl gt km kn ko bn kp kq bi"><span id="ec12" class="kr ks in kn b be kt ku l kv kw">http://localhost:7000/api/v1/destinations/list<br/><br/>{<br/>    "workspaceId": "Your workspace ID"<br/>}</span></pre><p id="d30d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">通过定义 ID 获取目的地:</p><pre class="ki kj kk kl gt km kn ko bn kp kq bi"><span id="bd3a" class="kr ks in kn b be kt ku l kv kw">http://localhost:7000/api/v1/destinations/get<br/><br/>{<br/>    "destinationId": "A destination ID from your current destinations in workspace"<br/>}</span></pre><p id="43d9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">创建一个 S3 目的地。我已经创建了一个 ARM 角色，它允许部署 airbyte 的 EC2 实例能够为 S3 存储桶做出贡献，否则，您知道如何处理其余的细节。至少，我不必在这里为此提供密码。乌夫！</p><pre class="ki kj kk kl gt km kn ko bn kp kq bi"><span id="1408" class="kr ks in kn b be kt ku l kv kw">http://localhost:7000/api/v1/destinations/create<br/><br/>{<br/>    "destinationDefinitionId": "S3 Definition ID from List Destinations",<br/>    "workspaceId": "Your workspace ID",<br/>    "connectionConfiguration": {<br/>        "format": {<br/>            "format_type": "Parquet",<br/>            "page_size_kb": 1024,<br/>            "block_size_mb": 128,<br/>            "compression_codec": "SNAPPY",<br/>            "dictionary_encoding": true,<br/>            "max_padding_size_mb": 8,<br/>            "dictionary_page_size_kb": 1024<br/>        },<br/>        "s3_endpoint": "",<br/>        "s3_bucket_name": "Your Bucket Name",<br/>        "s3_bucket_path": "Your Bucket Path",<br/>        "s3_bucket_region": "Your Bucket Region"<br/>    },<br/>    "name": "S3 Rest API"<br/>}</span></pre><p id="441b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">不喜欢你创建目的地后看到的东西。删了它！！！！</p><pre class="ki kj kk kl gt km kn ko bn kp kq bi"><span id="3bc6" class="kr ks in kn b be kt ku l kv kw">http://localhost:7000/api//v1/destination_definitions/delete<br/><br/>{<br/>    "destinationId": "The destination Id from the prev endpoint."<br/>}</span></pre><p id="73fc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，您创建了源和目的地，现在，让我们开始创建一个连接器。我们很接近了！！！</p><p id="cc77" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">列出工作区中的连接器</p><pre class="ki kj kk kl gt km kn ko bn kp kq bi"><span id="9554" class="kr ks in kn b be kt ku l kv kw">http://localhost:7000/api/v1/connections/list<br/><br/>{<br/>    "workspaceId": "Your Workspace Id"<br/>}</span></pre><p id="b4aa" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">通过 Rest API 获取连接细节，如果您已经在 UI 中尝试过的话。</p><pre class="ki kj kk kl gt km kn ko bn kp kq bi"><span id="d712" class="kr ks in kn b be kt ku l kv kw">http://localhost:7000/api/v1/connections/get<br/><br/>{<br/>    "connectionId": "35f7ccf6-8780-4ee3-85aa-9fa01cac118f"<br/>}</span></pre><p id="9ee5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，让我们创建一个新的连接，源为 MSSQL，目的地为 S3。是的。我们差不多完成了。</p><pre class="ki kj kk kl gt km kn ko bn kp kq bi"><span id="36eb" class="kr ks in kn b be kt ku l kv kw">http://localhost:7000/api/v1/connections/create<br/><br/>{<br/>    "name": "MSSQL Rest API &lt;&gt; S3 Rest API",<br/>    "namespaceDefinition": "source",<br/>    "namespaceFormat": "${SOURCE_NAMESPACE}",<br/>    "prefix": "",<br/>    "sourceId": "Source ID which you got after creating the source",<br/>    "destinationId": "Destination ID which you got after creating it.",<br/>    "operationIds": [],<br/>    "syncCatalog": {<br/>        "streams": [<br/>            {<br/>                "stream": {<br/>                    "name": "The table from your source system if you want it via REST",<br/>                    "jsonSchema": {<br/>                        "type": "object",<br/>                        "properties": {<br/>                            "column1": {<br/>                                "type": "number",<br/>                                "airbyte_type": "integer"<br/>                            },<br/>                            "column2": {<br/>                                "type": "string"<br/>                            },<br/>                            "column3": {<br/>                                "type": "string"<br/>                            },<br/>                            "_ab_cdc_lsn": {<br/>                                "type": "string"<br/>                            },<br/>                            "_ab_cdc_deleted_at": {<br/>                                "type": "string"<br/>                            },<br/>                            "_ab_cdc_updated_at": {<br/>                                "type": "string"<br/>                            }<br/>                        }<br/>                    },<br/>                    "supportedSyncModes": [<br/>                        "full_refresh",<br/>                        "incremental"<br/>                    ],<br/>                    "sourceDefinedCursor": true,<br/>                    "defaultCursorField": [],<br/>                    "sourceDefinedPrimaryKey": [<br/>                        [<br/>                            "column1"<br/>                        ]<br/>                    ],<br/>                    "namespace": "dbo"<br/>                },<br/>                "config": {<br/>                    "syncMode": "incremental",<br/>                    "cursorField": [],<br/>                    "destinationSyncMode": "append",<br/>                    "primaryKey": [<br/>                        [<br/>                            "column1"<br/>                        ]<br/>                    ],<br/>                    "aliasName": "tablealias",<br/>                    "selected": true<br/>                }<br/>            }<br/>        ]<br/>    },<br/>    "scheduleType": "manual",<br/>    "status": "active",<br/>    "geography": "auto"<br/>}</span></pre><p id="35cf" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">从上面可以看出，您还可以将您的计划类型更改为不同的选项，一旦设置了连接器，您将看到您的数据流动。</p><p id="7280" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">最后。删除连接器:</p><pre class="ki kj kk kl gt km kn ko bn kp kq bi"><span id="cf23" class="kr ks in kn b be kt ku l kv kw">http://localhost:7000/api/v1/connections/delete<br/><br/>{<br/>    "connectionId": "Your connection id from the prev output"<br/>}</span></pre><p id="4dad" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我已经通过 Postman 测试了所有这些，现在你也可以了。这是我的邮差图书馆。</p><figure class="ki kj kk kl gt kz gh gi paragraph-image"><div class="gh gi ky"><img src="../Images/2e43cb29fb7b800ceece09c713df1bdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*qLW5SIeNo-JABeNGTQmpCg.png"/></div></figure><p id="e55d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">有一个我没有测试过的更新端点，您可以在那里编辑您的源、目的地和连接。我想现在，你已经明白这背后的要点了。和 Airbyte 玩得开心！！！一个免费的低代码/无代码解决方案，有一些很酷的连接器，源，目的地每天都在建立！</p><p id="91b6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我仍然致力于建立一个自定义连接器，这是，咳咳！还是一个痛(免责声明:只对我。)我想很多人都做过，我还没有完全了解。如果我到了那里，期待另一篇文章。虽然，Airbyte 有一些关于如何做事情的很好的文档，但是，我还是想把它简化并发布出来。</p><figure class="ki kj kk kl gt kz gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/86e0681e6418b68af2281dbf1ccb86a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:144/format:webp/1*kRFG3pUfhIKbP5eE_joVbQ.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">向这个懒散的小家伙寻求帮助！他们真的很及时(有时候，大多数时候。)</figcaption></figure></div></div>    
</body>
</html>