<html>
<head>
<title>Spring Boot with MongoDB integration guide with multiple data sources.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Spring Boot 与 MongoDB 多数据源集成指南。</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/spring-boot-with-mongodb-integration-guide-with-multiple-data-sources-e07ad1b3af77?source=collection_archive---------3-----------------------#2022-06-04">https://blog.devgenius.io/spring-boot-with-mongodb-integration-guide-with-multiple-data-sources-e07ad1b3af77?source=collection_archive---------3-----------------------#2022-06-04</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div class="gh gi jk"><img src="../Images/a19190e52910c3d75f1d79bafcd06f0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/format:webp/0*arJ82E5eU-0jnT4J.jpg"/></div></figure><p id="5a4b" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">MongoDB 是一个无模式的 NoSQL 数据库。它是专门为存储大量数据而设计的，并且允许您非常高效地处理这些数据。</p><p id="7607" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated"><strong class="jt io">MongoDB 的一些特殊特性是:</strong></p><p id="5f32" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated"><strong class="jt io"> 1)无模式数据库:</strong>一个集合可以保存多个文档，这些文档可以由不同数量的字段、内容和大小组成。在关系数据库的情况下，不要求一个文档与另一个文档相似。</p><p id="9830" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated"><strong class="jt io"> 2)面向文档:</strong>数据存储在键值对中，而不是行和列中，这使得数据更加灵活。</p><p id="eee3" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated"><strong class="jt io"> 3)索引:</strong>它使用主索引和次索引对文档中的每个字段进行索引，这使得从数据池中获取或搜索数据更加容易，花费的时间也更少。</p><p id="6138" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated"><strong class="jt io"> 4)可伸缩性:</strong>它提供了水平可伸缩性。我们可以向正在运行的数据库添加新的机器。它使用分片在多台机器上存储数据。分片指的是在多个服务器上分发数据的过程，这里使用分片键将大量数据划分成数据块，这些数据块平均分布在驻留在许多物理服务器上的分片上</p><p id="c1c8" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated"><strong class="jt io"> 5)高性能:</strong>由于其可伸缩性、索引、复制等特性。与任何其他数据库相比，MongoDB 的性能和数据持久性变得非常高。</p><p id="21bb" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated"><strong class="jt io">这里我们将讨论 MongoDB 的多个数据源与 spring boot 的集成。</strong></p><p id="d1c9" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">我们可以通过两种方法连接到 MongoDB 数据库——</p><p id="f7cd" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">MongoRepository</p><p id="38d0" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">MongoTemplate。</p><p id="f17f" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">这里我们将使用 MongoTemplate，因为它提供了高级用途和复杂的查询执行。MongoTemplate 让我们能够更好地控制向 MongoDB 请求什么。它提供了一个比 MongoRepository 更简单的步骤来编写复杂的查询。甚至一些业内人士也发现 MongoTemplate 是轻松编写复杂查询的好选择。</p><p id="c19e" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">让我们从 spring boot 项目开始集成。</p><p id="e862" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated"><strong class="jt io">第一步:在 pom.xml 中添加 maven 依赖关系</strong></p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="1b87" class="ky kz in ku b gy la lb l lc ld">&lt;dependency&gt;<br/>&lt;groupId&gt;org.springframework.data&lt;/groupId&gt;<br/>&lt;artifactId&gt;spring-data-mongodb&lt;/artifactId&gt;<br/>&lt;/dependency&gt;</span></pre><p id="2eb9" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated"><strong class="jt io">第二步:在 application.properties 中添加连接属性</strong></p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="359c" class="ky kz in ku b gy la lb l lc ld">spring.data.mongo.firstdb.uri=mongodb://&lt;username&gt;:&lt;password&gt;@&lt;Host&gt;/&lt;DB Name&gt;</span></pre><p id="6939" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated"><strong class="jt io">步骤 3:创建 DataSource 类来管理数据库连接。</strong></p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="962c" class="ky kz in ku b gy la lb l lc ld">@Configuration<br/>public class MongoConfig {</span><span id="f403" class="ky kz in ku b gy le lb l lc ld">@Autowired<br/>private Environment env;</span><span id="15ea" class="ky kz in ku b gy le lb l lc ld">@Bean<br/>public MongoDbFactory mongoFirstDbFactory() {<br/>return new SimpleMongoDbFactory(new MongoClientURI(env.getProperty("spring.data.mongo.firstdb.uri")));<br/>}</span><span id="a57f" class="ky kz in ku b gy le lb l lc ld">@Bean<br/>public MongoTemplate mongoFirstDbTemplate() {<br/>MongoTemplate mongoFirstDbTemplate = new MongoTemplate(mongoFirstDbFactory());<br/>return mongoFirstDbTemplate;<br/>}</span><span id="13e9" class="ky kz in ku b gy le lb l lc ld">}</span></pre><p id="6cb5" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">步骤 4:创建实体类</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="03a4" class="ky kz in ku b gy la lb l lc ld">@Document(collection="user_mongo")<br/>public class UserMongo {</span><span id="5857" class="ky kz in ku b gy le lb l lc ld">@Id<br/>private String userId;<br/>private String name;<br/>private Date creationDate = new Date();</span><span id="272f" class="ky kz in ku b gy le lb l lc ld">public String getUserId() {<br/>return userId;<br/>}</span><span id="f685" class="ky kz in ku b gy le lb l lc ld">public void setUserId(String userId) {<br/>this.userId = userId;<br/>}</span><span id="f02f" class="ky kz in ku b gy le lb l lc ld">public String getName() {<br/>return name;<br/>}</span><span id="c179" class="ky kz in ku b gy le lb l lc ld">public void setName(String name) {<br/>this.name = name;<br/>}</span><span id="c896" class="ky kz in ku b gy le lb l lc ld">public Date getCreationDate() {<br/>return creationDate;<br/>}</span><span id="5658" class="ky kz in ku b gy le lb l lc ld">public void setCreationDate(Date creationDate) {<br/>this.creationDate = creationDate;<br/>}</span><span id="c124" class="ky kz in ku b gy le lb l lc ld">}</span></pre><p id="fd2e" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated"><strong class="jt io">步骤 5:创建存储库类</strong></p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="2242" class="ky kz in ku b gy la lb l lc ld">@Repository<br/>public class UserMongoRepository {<br/>@Autowired<br/>@Qualifier("mongoFirstDbTemplate")<br/>private MongoTemplate mongoTemplate;</span><span id="40fb" class="ky kz in ku b gy le lb l lc ld">public void saveUsers() {<br/>UserMongo user = new UserMongo();<br/>user.setName("medium");<br/>mongoTemplate.save(user);<br/>}</span><span id="f8d5" class="ky kz in ku b gy le lb l lc ld">}</span></pre><p id="c1fe" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">仅此而已！</p><p id="2ad0" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">数据保存在 user_mongo 集合中。如果您有任何问题，我们可以在下面发布。</p></div></div>    
</body>
</html>