<html>
<head>
<title>R dplyr vs Python pandas: A Showdown of Data Manipulation Powerhouses</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">R dplyr vs Python pandas:数据操作巨头的摊牌</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/r-dplyr-vs-python-pandas-a-showdown-of-data-manipulation-powerhouses-2c92d63f6fa0?source=collection_archive---------7-----------------------#2022-12-11">https://blog.devgenius.io/r-dplyr-vs-python-pandas-a-showdown-of-data-manipulation-powerhouses-2c92d63f6fa0?source=collection_archive---------7-----------------------#2022-12-11</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/1d93a2b39b960871890d130cc4424412.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tCXB9KWObzlSwcTyVx0nig.png"/></div></div></figure><p id="ab6a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">数据操作和分析在许多领域都是至关重要的任务，能够快速方便地操作和分析大型数据集非常重要。两个流行的数据操作和分析工具是 Python pandas 和 dplyr。</p><p id="8d7e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">虽然这两个工具有一些相似之处，但它们的设计和使用是不同的。在本文中，我们将比较 pandas 和 dplyr，突出它们的主要区别，并展示如何使用它们来解决常见的数据操作问题，使用常见的和高级的功能，如过滤、排列、分组、选择、连接和窗口功能。</p><p id="3743" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们将使用虚构的住房数据来展示每种工具的能力。</p><p id="54fa" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">滤镜</strong></p><p id="e7c1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">一个常见的数据操作任务是根据特定标准过滤数据。pandas 和 dplyr 都提供了过滤数据的工具。</p><p id="a4ba" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">以下是如何使用 pandas 过滤住房数据的示例:</p><pre class="kt ku kv kw gt kx ky kz bn la lb bi"><span id="270d" class="lc ld in ky b be le lf l lg lh">import pandas as pd<br/><br/># load the data from a CSV file<br/>df = pd.read_csv('housing_data.csv')<br/><br/># filter the data frame to only include houses with a price greater than $500,000, at least 3 bedrooms, and a square footage greater than 1,500<br/>df = df[(df['price'] &gt; 500000) &amp; (df['bedrooms'] &gt;= 3) &amp; (df['sq_ft'] &gt; 1500)]<br/><br/># view the first few rows of the filtered data<br/>df.head()<br/>#   house_id     date     price  bedrooms  sq_ft  bathrooms  zipcode<br/>#        3   1/3/2020  1020000         3   1600          2    90210<br/>#        4   1/4/2020  1030000         3   1700          2    90210<br/>#        5   1/5/2020  1040000         3   1800          2    90210<br/>#        6   1/6/2020  1050000         3   1900          2    90210</span></pre><p id="0c19" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">以下是如何使用 dplyr 过滤住房数据的示例:</p><pre class="kt ku kv kw gt kx ky kz bn la lb bi"><span id="6b98" class="lc ld in ky b be le lf l lg lh"># install and load the dplyr package<br/>install.packages("dplyr")<br/>library(dplyr)<br/><br/># load the data from a CSV file<br/>df &lt;- read.csv('housing_data.csv')<br/><br/># filter the data frame to only include houses with a price greater than $500,000, at least 3 bedrooms, and a square footage greater than 1,500<br/>df &lt;- df %&gt;%<br/>  filter(price &gt; 500000, bedrooms &gt;= 3, sq_ft &gt; 1500)<br/><br/># view the first few rows of the filtered data<br/>head(df)<br/>#   house_id     date     price  bedrooms  sq_ft  bathrooms  zipcode<br/>#        3   1/3/2020  1020000         3   1600          2    90210<br/>#        4   1/4/2020  1030000         3   1700          2    90210<br/>#        5   1/5/2020  1040000         3   1800          2    90210<br/>#        6   1/6/2020  1050000         3   1900          2    90210</span></pre><p id="7039" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">安排</strong></p><p id="89ad" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">另一个常见的数据操作任务是根据某些标准对数据进行排序。pandas 和 dplyr 都提供了对数据进行排序的工具。</p><p id="c1ed" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">以下是如何使用 pandas 对住房数据进行排序的示例:</p><pre class="kt ku kv kw gt kx ky kz bn la lb bi"><span id="35d7" class="lc ld in ky b be le lf l lg lh"># sort the data frame by the 'price' column in descending order, and then by the 'bedrooms' column in ascending order<br/>df = df.sort_values(['price', 'bedrooms'], ascending=[False, True])<br/><br/># view the first few rows of the sorted data frame<br/>df.head()<br/>#   house_id     date     price  bedrooms  sq_ft  bathrooms  zipcode<br/>#        6   1/6/2020  1050000         3   1900          2    90210<br/>#        5   1/5/2020  1040000         3   1800          2    90210<br/>#        4   1/4/2020  1030000         3   1700          2    90210<br/>#        3   1/3/2020  1020000         3   1600          2    90210</span></pre><p id="3e27" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">以下是如何使用 dplyr 对住房数据进行排序的示例:</p><pre class="kt ku kv kw gt kx ky kz bn la lb bi"><span id="c989" class="lc ld in ky b be le lf l lg lh"># sort the data frame by the 'price' column in descending order, and then by the 'bedrooms' column in ascending order<br/>df &lt;- df %&gt;%<br/>  arrange(desc(price), bedrooms)<br/><br/># view the first few rows of the sorted data frame<br/>head(df)<br/>#   house_id     date     price  bedrooms  sq_ft  bathrooms  zipcode<br/>#        6   1/6/2020  1050000         3   1900          2    90210<br/>#        5   1/5/2020  1040000         3   1800          2    90210<br/>#        4   1/4/2020  1030000         3   1700          2    90210<br/>#        3   1/3/2020  1020000         3   1600          2    90210<br/></span></pre><p id="a017" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">分组依据</strong></p><p id="82b4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">另一个常见的数据操作任务是根据特定标准对数据进行分组，然后对这些组执行操作。pandas 和 dplyr 都提供了数据分组工具。</p><p id="8fa1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">以下是如何使用 pandas 对住房数据进行分组的示例:</p><pre class="kt ku kv kw gt kx ky kz bn la lb bi"><span id="58df" class="lc ld in ky b be le lf l lg lh"># group the data frame by the 'zipcode' column and calculate the mean price for each group<br/>df = df.groupby('zipcode')['price'].mean()<br/><br/># view the resulting data frame<br/>df<br/># zipcode<br/># 90210    1040000<br/># 90211    1050000<br/># 90212    1020000</span></pre><p id="72bd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">以下是如何使用 dplyr 对住房数据进行分组的示例:</p><pre class="kt ku kv kw gt kx ky kz bn la lb bi"><span id="3d4e" class="lc ld in ky b be le lf l lg lh"># group the data frame by the 'zipcode' column and calculate the mean price for each group<br/>df &lt;- df %&gt;%<br/>  group_by(zipcode) %&gt;%<br/>  summarise(mean_price = mean(price))<br/><br/># view the resulting data frame<br/>df<br/># zipcode  mean_price<br/># 90210    1040000<br/># 90211    1050000<br/># 90212    1020000</span></pre><p id="5b78" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">选择</strong></p><p id="fa73" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">另一个常见的数据操作任务是从数据框中选择特定的列或行。pandas 和 dplyr 都提供了选择数据的工具。</p><p id="08bd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">以下是如何使用 pandas 从住房数据框中选择列的示例:</p><pre class="kt ku kv kw gt kx ky kz bn la lb bi"><span id="d886" class="lc ld in ky b be le lf l lg lh"># select the 'date', 'price', and 'zipcode' columns from the data frame<br/>df = df[['date', 'price', 'zipcode']]<br/><br/># view the first few rows of the resulting data frame<br/>df.head()<br/>#      date   price    zipcode<br/>#   1/3/2020  1020000    90210<br/>#   1/4/2020  1030000    90210<br/>#   1/5/2020  1040000    90210<br/>#   1/6/2020  1050000    90210</span></pre><p id="df2c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">以下是如何使用 dplyr 从住房数据框中选择列的示例:</p><pre class="kt ku kv kw gt kx ky kz bn la lb bi"><span id="bfe0" class="lc ld in ky b be le lf l lg lh"># select the 'date', 'price', and 'zipcode' columns from the data frame<br/>df &lt;- df %&gt;%<br/>  select(date, price, zipcode)<br/><br/># view the first few rows of the resulting data frame<br/>head(df)<br/>#    date    price    zipcode<br/>#  1/3/2020  1020000    90210<br/>#  1/4/2020  1030000    90210<br/>#  1/5/2020  1040000    90210<br/>#  1/6/2020  1050000    90210</span></pre><p id="cd74" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">加入</strong></p><p id="99b5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">另一个常见的数据操作任务是连接来自多个来源的数据。pandas 和 dplyr 都提供了连接数据的工具。</p><p id="e100" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">以下是如何使用 pandas 连接<code class="fe li lj lk ky b">house_id</code>列上的两个住房数据框的示例:</p><pre class="kt ku kv kw gt kx ky kz bn la lb bi"><span id="0bd7" class="lc ld in ky b be le lf l lg lh"># load the second data frame from a CSV file<br/>df2 = pd.read_csv('housing_data_2.csv')<br/><br/># join the two data frames on the 'house_id' column, using an inner join to only include rows with matching values in both data frames<br/>df = df.join(df2, on='house_id', how='inner')<br/><br/># view the first few rows of the resulting data frame<br/>df.head()<br/>#   house_id     date     price  zipcode       city     state  year_built<br/>#        3   1/3/2020  1020000    90210  Beverly Hills    CA        1950<br/>#        4   1/4/2020  1030000    90210  Beverly Hills    CA        1960<br/>#        5   1/5/2020  1040000    90210  Beverly Hills    CA        1970<br/>#        6   1/6/2020  1050000    90210  Beverly Hills    CA        1980</span></pre><p id="2149" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">以下是如何使用 dplyr 连接<code class="fe li lj lk ky b">house_id</code>列上的两个房屋数据框的示例:</p><pre class="kt ku kv kw gt kx ky kz bn la lb bi"><span id="a57d" class="lc ld in ky b be le lf l lg lh"># load the second data frame from a CSV file<br/>df2 &lt;- read.csv('housing_data_2.csv')<br/><br/># join the two data frames on the 'house_id' column, using an inner join to only include rows with matching values in both data frames<br/>df &lt;- df %&gt;%<br/>  inner_join(df2, by='house_id')<br/><br/># view the first few rows of the resulting data frame<br/>head(df)<br/>#   house_id     date     price  zipcode       city     state  year_built<br/>#        3   1/3/2020  1020000    90210  Beverly Hills    CA        1950<br/>#        4   1/4/2020  1030000    90210  Beverly Hills    CA        1960<br/>#        5   1/5/2020  1040000    90210  Beverly Hills    CA        1970<br/>#        6   1/6/2020  1050000    90210  Beverly Hills    CA        1980</span></pre><p id="21b6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们可以使用 dplyr 和 pandas 处理更多的连接操作，例如 left_join、right_join 和 full_join。</p><p id="681a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">窗口功能</strong></p><p id="1742" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">另一个高级数据操作功能是使用窗口函数，它允许您跨与当前行相关的一组行执行计算。pandas 和 dplyr 都提供了使用窗口函数的工具。</p><p id="73a1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">下面是一个如何使用 pandas 计算当前行<code class="fe li lj lk ky b">price</code>和前一行<code class="fe li lj lk ky b">price</code>之间的差异的例子:</p><pre class="kt ku kv kw gt kx ky kz bn la lb bi"><span id="abf9" class="lc ld in ky b be le lf l lg lh"># define the window function that calculates the difference between the current rows 'price' and the previous rows 'price'<br/>def price_diff(df):<br/>  return df['price'] - df['price'].shift(1)<br/><br/># apply the window function to the data frame, grouping by the 'zipcode' column<br/>df = df.groupby('zipcode').apply(price_diff)<br/><br/># view the first few rows of the resulting data frame<br/>df.head()<br/>#   house_id     date  price  zipcode       city        state  year_built price_diff<br/>#        3  1/3/2020  1020000    90210  Beverly Hills    CA        1950       NaN<br/>#        4  1/4/2020  1030000    90210  Beverly Hills    CA        1960     10000<br/>#        5  1/5/2020  1040000    90210  Beverly Hills    CA        1970     10000<br/>#        6  1/6/2020  1050000    90210  Beverly Hills    CA        1980     10000</span></pre><p id="40dc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">下面是一个如何使用 pandas 来计算当前行<code class="fe li lj lk ky b">price</code>和前一行<code class="fe li lj lk ky b">price</code>之间的差异的例子:</p><pre class="kt ku kv kw gt kx ky kz bn la lb bi"><span id="ca85" class="lc ld in ky b be le lf l lg lh"># define the window function that calculates the difference between the current rows 'price' and the previous rows 'price'<br/>price_diff &lt;- function(df) {<br/>  df %&gt;%<br/>    mutate(price_diff = price - lag(price))<br/>}<br/><br/># apply the window function to the data frame, grouping by the 'zipcode' column<br/>df &lt;- df %&gt;%<br/>  group_by(zipcode) %&gt;%<br/>  price_diff()<br/><br/># view the first few rows of the resulting data frame<br/>head(df)<br/>#   house_id     date     price  zipcode       city     state  year_built price_diff<br/>#        3   1/3/2020  1020000    90210  Beverly Hills    CA        1950        NA<br/>#        4   1/4/2020  1030000    90210  Beverly Hills    CA        1960     10000<br/>#        5   1/5/2020  1040000    90210  Beverly Hills    CA        1970     10000<br/>#        6   1/6/2020  1050000    90210  Beverly Hills    CA        1980     10000</span></pre><p id="f249" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">除了在窗口函数中使用 lag 之外，还有更常用的函数，如 row_number、rank 和 dense_rank。lag 的用法只是为了展示我们如何使用 pandas 和 dplyr 来处理窗口函数。</p><p id="d609" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">结论</strong></p><p id="5973" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">总之，pandas 和 dplyr 都是数据操作和分析的强大工具。虽然它们有一些相似之处，但它们的设计和使用方式不同，而且各有优缺点。通过了解 pandas 和 dplyr 之间的主要区别，您可以为您的数据操作和分析任务选择正确的工具。</p></div></div>    
</body>
</html>