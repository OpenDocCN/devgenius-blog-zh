<html>
<head>
<title>Bun Pros and Cons and Main Usage Scenarios</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Bun 的优缺点和主要使用场景</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/bun-pros-and-cons-and-main-usage-scenarios-2e8402a91e5f?source=collection_archive---------7-----------------------#2022-08-18">https://blog.devgenius.io/bun-pros-and-cons-and-main-usage-scenarios-2e8402a91e5f?source=collection_archive---------7-----------------------#2022-08-18</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><h1 id="bf5e" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">什么是 Bun，为什么它很快</h1><p id="700f" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">Bun 是一个年轻而雄心勃勃的项目，假装要取代传统的 Node.js。它不仅想取代执行环境，还想取代主要工具:包管理器、bundler 和 transpiler。当你听到这个的时候，你可能会想到 Deno。嗯，这是真的，但是 Bun 有一些致命的特性值得研究:比 Node.js 有巨大的性能优势，特别是在启动时，核心模块实现底层的低级系统调用，以及工具。</p><figure class="li lj lk ll gt lm gh gi paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gh gi lh"><img src="../Images/740fa88bd674c857da714c30b539deb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-_Lv2SBbaiPkUJXLdTdArg.jpeg"/></div></div></figure><p id="af55" class="pw-post-body-paragraph ki kj in kk b kl lt kn ko kp lu kr ks kt lv kv kw kx lw kz la lb lx ld le lf ig bi translated">Bun 作者用:1)使用<a class="ae lg" href="https://en.wikipedia.org/wiki/WebKit#JavaScriptCore" rel="noopener ugc nofollow" target="_blank"> JavaScriptCore </a>引擎 2)执行环境程序和所有用高性能 Zig 语言编写的主要工具(是的，我以前也没听说过)3)所有从零开始编写的核心 Node.js 模块和 API。</p><p id="5381" class="pw-post-body-paragraph ki kj in kk b kl lt kn ko kp lu kr ks kt lv kv kw kx lw kz la lb lx ld le lf ig bi translated">为了减少故事的篇幅，我不会在这里提供任何关于 Bun 或其内部的一般性描述。如果你想知道更多关于面包特性的细节，请参考它的<a class="ae lg" href="https://github.com/oven-sh/bun" rel="noopener ugc nofollow" target="_blank">自述</a>，或者发布的<a class="ae lg" href="https://betterprogramming.pub/bun-new-kid-in-the-javascript-town-a0c6d77c7bb8" rel="noopener ugc nofollow" target="_blank">这个</a>和<a class="ae lg" href="https://levelup.gitconnected.com/is-bun-js-the-node-js-killer-ffeb0f89196a" rel="noopener ugc nofollow" target="_blank">。这个故事侧重于分析它的优缺点(截至 2022 年 8 月)，并试图想象 Bun killer 功能的几个主要用例特别方便。</a></p><h1 id="f6d2" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">利弊</h1><p id="992f" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">我在谷歌上搜索了所有关于 Bun 的试验、分析和研究文章和出版物。在这里，我简要总结了这些发现，并结合了我自己对面包优缺点的看法。请参阅参考资料部分的学分和链接。</p><h2 id="0c84" class="ly jl in bd jm lz ma dn jq mb mc dp ju kt md me jy kx mf mg kc lb mh mi kg mj bi translated">+巨大的前景</h2><p id="0f5b" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">这不仅仅是我的观点，而是几乎每篇与面包相关的文章都表达的观点。人们肯定很兴奋，认为它是整个服务器端 JS 开发的下一个大步骤的一个很好的候选。Bun 可能还有助于减少 Node.js 与其更快的竞争对手(主要是 Go)相比的性能差异。</p><h2 id="5708" class="ly jl in bd jm lz ma dn jq mb mc dp ju kt md me jy kx mf mg kc lb mh mi kg mj bi translated">+ TypeScript 开箱即用</h2><p id="e1b7" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">你只要运行“bun my-cool-file.ts”就可以了。不需要 transpiling 或任何其他中间步骤，就像我们用 Deno 一样。Bun 还对 TS(类似于 C/C++)提供了宏支持，这对于大型项目和 mono-repos 可能非常方便。</p><h2 id="a9a3" class="ly jl in bd jm lz ma dn jq mb mc dp ju kt md me jy kx mf mg kc lb mh mi kg mj bi translated">+不仅是运行时，还有 Node.js 工具替换</h2><p id="99f9" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">Bun 附带内置的 bundler、transpiler 和 package manager。它们是用 Zig 写的，运行速度非常快。如果您对标准 webpack 或 npm 的性能不满意，无需安装 yarn 或 esbuild。</p><p id="0dbf" class="pw-post-body-paragraph ki kj in kk b kl lt kn ko kp lu kr ks kt lv kv kw kx lw kz la lb lx ld le lf ig bi translated">Bun 包管理器似乎产生与 NPM 相同的文件夹结构，并遵循相同的 package.json 文件格式(尽管不同的锁文件)。如果你成功地用 Bun 为一个大型 Node.js 项目安装的 node_modules 文件夹替换了 NPM 创建的 node _ modules 文件夹，请写下评论，并测试是否有任何问题。</p><p id="0ead" class="pw-post-body-paragraph ki kj in kk b kl lt kn ko kp lu kr ks kt lv kv kw kx lw kz la lb lx ld le lf ig bi translated">顺便说一下，伟大的工具首先为开发 Bun 作为构建和打包工具开辟了一个空间，而生产代码继续在 good old Node.js 上运行。这种方法可能有助于加快 Bun 在 web 开发人员社区中的采用。</p><h2 id="70f2" class="ly jl in bd jm lz ma dn jq mb mc dp ju kt md me jy kx mf mg kc lb mh mi kg mj bi translated">+巨大的性能提升</h2><p id="b26f" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">我不确定 JavaScriptCore 在一般场景和用例中是否明显快于 V8，但 Bun 启动时间确实很长。这在服务频繁启动/停止的环境中特别有用。例如像 AWS Lambdas 或 Azure Function 这样的无服务器代码执行器，或者严重偏向于基于事件的架构的云系统(像连接到 SNS 作为服务总线的 Lambda 事件处理器)。</p><p id="a8d8" class="pw-post-body-paragraph ki kj in kk b kl lt kn ko kp lu kr ks kt lv kv kw kx lw kz la lb lx ld le lf ig bi translated">Bun 速度的另一个亮点是系统调用和 I/O 操作。Bun 作者说，所有底层 Node.js APIs 都是从零开始编写的，并把性能放在第一位。我相信快速 Zig 语言也是有帮助的。</p><p id="7350" class="pw-post-body-paragraph ki kj in kk b kl lt kn ko kp lu kr ks kt lv kv kw kx lw kz la lb lx ld le lf ig bi translated">只是好奇:Bun 利用 Linux <a class="ae lg" href="https://en.wikipedia.org/wiki/Zero-copy" rel="noopener ugc nofollow" target="_blank">零拷贝</a>套接字系统调用来使网络 I/O 更快吗？<a class="ae lg" href="https://developpaper.com/what-is-the-so-called-zero-copy-technology-in-kafka/" rel="noopener ugc nofollow" target="_blank">零拷贝</a>是一个很棒的性能特点，也是卡夫卡这么快的原因之一。Go 已经有了一个<a class="ae lg" href="https://github.com/newtools/zsocket" rel="noopener ugc nofollow" target="_blank">定制包</a>来支持它，所以我认为它在 JS 世界里也可能有用。然而，我不是内部系统调用的专家，所以在这里不能确定。如果你知道任何细节，请在评论中告诉我。</p><h2 id="ed5f" class="ly jl in bd jm lz ma dn jq mb mc dp ju kt md me jy kx mf mg kc lb mh mi kg mj bi translated">-未准备好生产</h2><p id="8264" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">Bun 正在积极开发中，肯定还远远没有准备好投入生产。它仍然有大量的本机 Node.js 模块和 API 需要支持。Express 和 React.js 的主要场景工作正常，但是 MongoDB 客户端或<a class="ae lg" href="https://github.com/oven-sh/bun/issues/313" rel="noopener ugc nofollow" target="_blank"> Fastify 立即失败</a>，因为 http、tty 和 tts 等核心模块出现了一些问题。其他重要的工作人员，如缩小工具和 TS 泛型仍然在 Bun 的待办事项列表中。</p><h2 id="1979" class="ly jl in bd jm lz ma dn jq mb mc dp ju kt md me jy kx mf mg kc lb mh mi kg mj bi translated">-项目范围非常大</h2><p id="465f" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">这意味着 Bun 开发者面临更严峻的挑战，需要付出更多的努力来解决这些问题。因此，目前还不清楚将 Bun 提高到生产水平需要多少时间。此外，虽然是开源的，但项目代码库的绝大部分是由<a class="ae lg" href="https://github.com/Jarred-Sumner" rel="noopener ugc nofollow" target="_blank">一个作者</a>编写的，所以我们总是有在完成项目之前失去兴趣的危险。</p><h2 id="dbaa" class="ly jl in bd jm lz ma dn jq mb mc dp ju kt md me jy kx mf mg kc lb mh mi kg mj bi translated">-缺乏信息</h2><p id="d3a4" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">Github Readme 页面是目前唯一全面的文档来源。如果要搜索任何高级信息，需要加入 Discord chat。像马丁·福勒的 Thoughtworks <a class="ae lg" href="https://www.thoughtworks.com/radar" rel="noopener ugc nofollow" target="_blank">技术雷达</a>这样的权威数据来源还没有提到 Bun。</p><h1 id="56ca" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">Bun 最有前途的用例</h1><p id="75fd" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">任何新工具首先被应用于其杀手级特性最突出的场景。根据我目前的理解，我认为 Bun 的 3 个主要应用特别方便:</p><ol class=""><li id="8892" class="ml mm in kk b kl lt kp lu kt mn kx mo lb mp lf mq mr ms mt bi translated"><strong class="kk io">为兰姆达斯省钱。</strong>所有主要平台的云功能均按执行时间计费。Bun 的高速度使它们跑得更快，因此降低了成本。此外，它的闪电启动时间另外 1)减少了冷启动的执行时间 2)可能有助于减少 Lambdas <a class="ae lg" href="https://docs.aws.amazon.com/lambda/latest/dg/provisioned-concurrency.html" rel="noopener ugc nofollow" target="_blank">供应并发</a>计数，从而进一步削减我们的云托管费用。</li><li id="02a2" class="ml mm in kk b kl mu kp mv kt mw kx mx lb my lf mq mr ms mt bi translated"><strong class="kk io">加速云中基于事件的架构。想象一个系统，它主要基于由 AWS 托管的组件引发的事件，通过 SNS 交付并在 Lambdas 中处理。在事件类型数量巨大的情况下，它们中的大多数通常很少运行，因此遭受冷启动问题。快速的处理程序启动时间可以显著提高整体系统的响应能力，并减少系统中请求花费的总时间。</strong></li><li id="b811" class="ml mm in kk b kl mu kp mv kt mw kx mx lb my lf mq mr ms mt bi translated"><strong class="kk io"> Devops 和 CI/CD 管道</strong>经常涉及频繁的包操作、源代码传输、文件捆绑等。本质上他们做了 Bun 内置工具特别擅长的所有操作。因此，我们可以大大加快 CI/CD 的速度。如果我们将集成测试作为单独的 Node.js (bun)流程运行，我们还可以节省一些执行时间。然而，考虑到集成测试相当长的运行时间，这几乎没有什么意义。</li></ol><h1 id="743a" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">需要进一步检查的东西</h1><p id="88b9" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">我在 Bun 上的下一个努力将是在真实世界的使用场景中对它的 Lambdas 运行时速度改进进行性能测试。人工合成测试适用于技术圣战文章，但不适用于真实生产项目的框架评估。所以我计划用一些现实的 REST API 测试用例、DB 调用和 Lambdas 冷启动和预配置并发场景来衡量它。肯定会写一个中等的故事:)</p><p id="58e1" class="pw-post-body-paragraph ki kj in kk b kl lt kn ko kp lu kr ks kt lv kv kw kx lw kz la lb lx ld le lf ig bi translated">另一个值得做的有趣测试是比较 yarn 和 Bun 包管理器对于有很多依赖项的大型项目的速度。</p><p id="c73b" class="pw-post-body-paragraph ki kj in kk b kl lt kn ko kp lu kr ks kt lv kv kw kx lw kz la lb lx ld le lf ig bi translated"><em class="mk">感谢阅读！真的很想在评论里听听大家的发髻心得和看法。</em></p><h1 id="7293" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">参考文献和致谢</h1><ol class=""><li id="0b90" class="ml mm in kk b kl km kp kq kt mz kx na lb nb lf mq mr ms mt bi translated"><a class="ae lg" href="https://betterprogramming.pub/bun-new-kid-in-the-javascript-town-a0c6d77c7bb8" rel="noopener ugc nofollow" target="_blank">快速发髻介绍</a>，虽然有点恭维，浅见。</li><li id="1f97" class="ml mm in kk b kl mu kp mv kt mw kx mx lb my lf mq mr ms mt bi translated"><a class="ae lg" href="https://www.lunasec.io/docs/blog/bun-first-look/" rel="noopener ugc nofollow" target="_blank">很棒的文章</a>，里面有很多关于 Node.js 及其生态系统历史的有趣想法，以及关于 Bun 在其中潜在地位的合理想法。强烈推荐阅读。</li><li id="b0a2" class="ml mm in kk b kl mu kp mv kt mw kx mx lb my lf mq mr ms mt bi translated">通过 Node.js 对 Bun 进行彻底的<a class="ae lg" href="https://medium.com/gitconnected/is-bun-js-the-node-js-killer-ffeb0f89196a" rel="noopener">性能测试</a>，并与 Bun 官网的结果进行对比。</li><li id="fdb9" class="ml mm in kk b kl mu kp mv kt mw kx mx lb my lf mq mr ms mt bi translated">另一篇<a class="ae lg" href="https://betterprogramming.pub/bun-new-kid-in-the-javascript-town-a0c6d77c7bb8" rel="noopener ugc nofollow" target="_blank">好文章</a>关于小圆面包的想法和一些玩法。</li><li id="d519" class="ml mm in kk b kl mu kp mv kt mw kx mx lb my lf mq mr ms mt bi translated"><a class="ae lg" href="https://github.com/oven-sh/bun/issues/798" rel="noopener ugc nofollow" target="_blank">当前 Bun 发展的重点</a>及其作者对开源社区援助的询问。</li></ol></div></div>    
</body>
</html>