<html>
<head>
<title>Adding a Google Map to your Android project using Kotlin</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Kotlin 将 Google 地图添加到您的 Android 项目</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/adding-a-google-map-to-your-android-project-using-kotlin-62bf44e629b4?source=collection_archive---------3-----------------------#2022-12-20">https://blog.devgenius.io/adding-a-google-map-to-your-android-project-using-kotlin-62bf44e629b4?source=collection_archive---------3-----------------------#2022-12-20</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/9d29390f45cbcfbe998474f5c4f727f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A3tTYTV1E5oaEI84anoj5g.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">来源:谷歌</figcaption></figure><ol class=""><li id="87e1" class="jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">注册一个谷歌地图 API 密钥。此密钥用于验证您的应用程序并跟踪 Google Maps API 的使用情况。您可以按照以下链接中的说明获取 Google Maps API 密钥:</li></ol><div class="kr ks gp gr kt ku"><a href="https://developers.google.com/maps/documentation/android-sdk/signup" rel="noopener  ugc nofollow" target="_blank"><div class="kv ab fo"><div class="kw ab kx cl cj ky"><h2 class="bd io gy z fp kz fr fs la fu fw im bi translated">使用 API 键 Android 地图| Google 开发者</h2><div class="lb l"><h3 class="bd b gy z fp kz fr fs la fu fw dk translated">本主题介绍如何为 Android 版地图 SDK 创建 API 密钥，将其添加到您的应用程序，并通过以下方式保护应用程序</h3></div><div class="lc l"><p class="bd b dl z fp kz fr fs la fu fw dk translated">developers.google.com</p></div></div><div class="ld l"><div class="le l lf lg lh ld li jt ku"/></div></div></a></div><p id="0a7f" class="pw-post-body-paragraph lj lk in kb b kc kd ll lm ke kf ln lo kg lp lq lr ki ls lt lu kk lv lw lx km ig bi translated">2.安装 Google Play 服务 SDK。Google Play 服务 SDK 包括 Google Maps Android API，您需要使用它才能在应用程序中使用地图。您可以使用 Android Studio 中的 SDK 管理器安装 Google Play 服务 SDK。</p><p id="5d8a" class="pw-post-body-paragraph lj lk in kb b kc kd ll lm ke kf ln lo kg lp lq lr ki ls lt lu kk lv lw lx km ig bi translated">3.将谷歌地图 Android API 添加到您的项目中。为此，在 Android Studio 中打开“项目”面板，然后点击“添加模块”按钮。在出现的窗口中，选择“谷歌地图 Android API”选项，然后单击“安装”。</p><p id="8d55" class="pw-post-body-paragraph lj lk in kb b kc kd ll lm ke kf ln lo kg lp lq lr ki ls lt lu kk lv lw lx km ig bi translated">4.将 Google Maps Android API 密钥添加到您的项目中。一旦您获得了 Google Maps API 密钥，您需要将它添加到您的项目中。为此，在 Android Studio 中打开“项目”面板，然后点击“Gradle”按钮。在“项目”窗格中，展开“Gradle Scripts”文件夹，然后打开“build.gradle (Module: app)”文件。在此文件中，将以下行添加到 defaultConfig 部分:</p><pre class="ly lz ma mb gt mc md me bn mf mg bi"><span id="506a" class="mh mi in md b be mj mk l ml mm">defaultConfig {<br/>    ...<br/>    manifestPlaceholders = [google_maps_api_key: "YOUR_API_KEY_HERE"]<br/>}</span></pre><p id="9160" class="pw-post-body-paragraph lj lk in kb b kc kd ll lm ke kf ln lo kg lp lq lr ki ls lt lu kk lv lw lx km ig bi translated">5.添加 Google Maps Android API 作为依赖项。要在您的项目中使用 Google Maps Android API，您需要将其添加为一个依赖项。为此，在 Android Studio 中打开“项目”面板，然后点击“Gradle”按钮。在“项目”窗格中，展开“Gradle Scripts”文件夹，然后打开“build.gradle (Module: app)”文件。在该文件中，将下面一行添加到 dependencies 部分:</p><pre class="ly lz ma mb gt mc md me bn mf mg bi"><span id="8073" class="mh mi in md b be mj mk l ml mm">dependencies {<br/>    ...<br/>    implementation 'com.google.android.gms:play-services-maps:17.0.0'<br/>}</span></pre><p id="a11a" class="pw-post-body-paragraph lj lk in kb b kc kd ll lm ke kf ln lo kg lp lq lr ki ls lt lu kk lv lw lx km ig bi translated">6.将 MapView 添加到布局中。要在应用程序中显示 Google 地图，您需要在布局中添加一个 MapView。为此，打开要显示地图的活动或片段的布局文件，然后添加以下元素:</p><pre class="ly lz ma mb gt mc md me bn mf mg bi"><span id="cc02" class="mh mi in md b be mj mk l ml mm">&lt;com.google.android.gms.maps.MapView<br/>    android:id="@+id/map_view"<br/>    android:layout_width="match_parent"<br/>    android:layout_height="match_parent" /&gt;</span></pre><p id="839b" class="pw-post-body-paragraph lj lk in kb b kc kd ll lm ke kf ln lo kg lp lq lr ki ls lt lu kk lv lw lx km ig bi translated">7.初始化 MapView 并显示地图。在您想要显示地图的活动或片段中，您需要初始化 MapView 并显示地图。为此，您需要执行以下操作:</p><ul class=""><li id="0568" class="jz ka in kb b kc kd ke kf kg kh ki kj kk kl km mn ko kp kq bi translated">通过调用<code class="fe mo mp mq md b">findViewById</code>获得对 MapView 的引用。</li><li id="9e42" class="jz ka in kb b kc mr ke ms kg mt ki mu kk mv km mn ko kp kq bi translated">在 MapView 上调用<code class="fe mo mp mq md b">getMapAsync</code>方法，传递一个回调函数，当地图准备好可以使用时，这个回调函数将被调用。</li><li id="854c" class="jz ka in kb b kc mr ke ms kg mt ki mu kk mv km mn ko kp kq bi translated">在回调中，获取对<code class="fe mo mp mq md b">GoogleMap</code>对象的引用，并使用它来配置和显示地图。</li></ul><p id="610a" class="pw-post-body-paragraph lj lk in kb b kc kd ll lm ke kf ln lo kg lp lq lr ki ls lt lu kk lv lw lx km ig bi translated">下面是如何在片段中实现这一点的示例:</p><pre class="ly lz ma mb gt mc md me bn mf mg bi"><span id="481f" class="mh mi in md b be mj mk l ml mm">class MapFragment : Fragment {<br/><br/>    private lateinit var mapView: MapView<br/>    private lateinit var googleMap: GoogleMap<br/><br/>    override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?): View? {<br/>        // Inflate the layout for this fragment<br/>        val view = inflater.inflate(R.layout.fragment_map, container, false)<br/><br/>        // Get a reference to the MapView<br/>        mapView = view.findViewById(R.id.map_view)<br/><br/>        // Initialize the MapView and display the map<br/>        mapView.onCreate(savedInstanceState)<br/>        mapView.getMapAsync { googleMap -&gt;<br/>            // Save a reference to the GoogleMap<br/>            this.googleMap = googleMap<br/><br/>            // Configure and display the map<br/>            val latLng = LatLng(37.4219999, -122.0862462)<br/>            val cameraUpdate = CameraUpdateFactory.newLatLngZoom(latLng, 10f)<br/>            googleMap.moveCamera(cameraUpdate)<br/>        }<br/><br/>        return view<br/>    }<br/><br/>    override fun onResume() {<br/>        super.onResume()<br/>        mapView.onResume()<br/>    }<br/><br/>    override fun onPause() {<br/>        super.onPause()<br/>        mapView.onPause()<br/>    }<br/><br/>    override fun onDestroy() {<br/>        super.onDestroy()<br/>        mapView.onDestroy()<br/>    }<br/><br/>    override fun onLowMemory() {<br/>        super.onLowMemory()<br/>        mapView.onLowMemory()<br/>    }<br/>}</span></pre><p id="177b" class="pw-post-body-paragraph lj lk in kb b kc kd ll lm ke kf ln lo kg lp lq lr ki ls lt lu kk lv lw lx km ig bi translated">此代码创建了一个显示 MapView 的片段，初始化 MapView 并在地图准备就绪时显示地图，并处理 MapView 必要的生命周期事件。</p><p id="94b5" class="pw-post-body-paragraph lj lk in kb b kc kd ll lm ke kf ln lo kg lp lq lr ki ls lt lu kk lv lw lx km ig bi translated">然后，您可以使用<code class="fe mo mp mq md b">GoogleMap</code>对象定制地图并与之交互，比如添加标记、绘制形状和处理用户手势。您可以在 Google Maps Android API 文档中找到有关可用选项的更多信息:</p><div class="kr ks gp gr kt ku"><a href="https://developers.google.com/maps/documentation/android-sdk/intro" rel="noopener  ugc nofollow" target="_blank"><div class="kv ab fo"><div class="kw ab kx cl cj ky"><h2 class="bd io gy z fp kz fr fs la fu fw im bi translated">Android 版地图 SDK 概述|谷歌开发者</h2><div class="lb l"><h3 class="bd b gy z fp kz fr fs la fu fw dk translated">使用 Android 版地图 SDK，使用谷歌地图数据、地图等将地图添加到您的 Android 应用程序，包括 Wear OS 应用程序</h3></div><div class="lc l"><p class="bd b dl z fp kz fr fs la fu fw dk translated">developers.google.com</p></div></div><div class="ld l"><div class="mw l lf lg lh ld li jt ku"/></div></div></a></div></div><div class="ab cl mx my hr mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ig ih ii ij ik"><p id="ad84" class="pw-post-body-paragraph lj lk in kb b kc kd ll lm ke kf ln lo kg lp lq lr ki ls lt lu kk lv lw lx km ig bi translated">地图标记是放置在地图上特定位置的图标。它们用于识别和标记兴趣点，如地标、企业或其他位置。</p><figure class="ly lz ma mb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ne"><img src="../Images/80c3d15a65533e240a810851c4bb6705.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EB3JO-qnVXR86B1Bis0VcQ.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">来源:谷歌</figcaption></figure><p id="e192" class="pw-post-body-paragraph lj lk in kb b kc kd ll lm ke kf ln lo kg lp lq lr ki ls lt lu kk lv lw lx km ig bi translated">在 Google Maps Android API 中，地图标记由<code class="fe mo mp mq md b">Marker</code>类表示。您可以通过在一个<code class="fe mo mp mq md b">GoogleMap</code>对象上调用<code class="fe mo mp mq md b">addMarker</code>方法并传入一个指定标记位置、外观和其他选项的<code class="fe mo mp mq md b">MarkerOptions</code>对象来创建一个标记。</p><p id="b2d6" class="pw-post-body-paragraph lj lk in kb b kc kd ll lm ke kf ln lo kg lp lq lr ki ls lt lu kk lv lw lx km ig bi translated">以下是如何在 Kotlin 中向地图添加标记的示例:</p><pre class="ly lz ma mb gt mc md me bn mf mg bi"><span id="50e0" class="mh mi in md b be mj mk l ml mm">val latLng = LatLng(37.4219999, -122.0862462)<br/>val markerOptions = MarkerOptions()<br/>    .position(latLng)<br/>    .title("My Marker")<br/>    .snippet("This is my marker")<br/>val marker = googleMap.addMarker(markerOptions)</span></pre><p id="dc9d" class="pw-post-body-paragraph lj lk in kb b kc kd ll lm ke kf ln lo kg lp lq lr ki ls lt lu kk lv lw lx km ig bi translated">这段代码在指定位置创建一个标记，当单击该标记时，将显示该标记的标题和代码片段。</p><p id="3ff0" class="pw-post-body-paragraph lj lk in kb b kc kd ll lm ke kf ln lo kg lp lq lr ki ls lt lu kk lv lw lx km ig bi translated">您也可以通过设置标记图标、颜色和锚点等选项来自定义标记的外观。您可以在<code class="fe mo mp mq md b">MarkerOptions</code>类文档中找到关于可用选项的更多信息:</p><div class="kr ks gp gr kt ku"><a href="https://developers.google.com/android/reference/com/google/android/gms/maps/model/MarkerOptions" rel="noopener  ugc nofollow" target="_blank"><div class="kv ab fo"><div class="kw ab kx cl cj ky"><h2 class="bd io gy z fp kz fr fs la fu fw im bi translated">MarkerOptions | Google Play 服务| Google 开发者</h2><div class="lb l"><h3 class="bd b gy z fp kz fr fs la fu fw dk translated">编辑描述</h3></div><div class="lc l"><p class="bd b dl z fp kz fr fs la fu fw dk translated">developers.google.com</p></div></div><div class="ld l"><div class="nf l lf lg lh ld li jt ku"/></div></div></a></div></div><div class="ab cl mx my hr mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ig ih ii ij ik"><p id="caed" class="pw-post-body-paragraph lj lk in kb b kc kd ll lm ke kf ln lo kg lp lq lr ki ls lt lu kk lv lw lx km ig bi translated">要在 Google Maps Android API 中处理地图上的用户手势，可以使用<code class="fe mo mp mq md b">GoogleMap</code>对象的<code class="fe mo mp mq md b">setOnMapClickListener</code>、<code class="fe mo mp mq md b">setOnMapLongClickListener</code>和<code class="fe mo mp mq md b">setOnMarkerClickListener</code>方法。</p><p id="4f3f" class="pw-post-body-paragraph lj lk in kb b kc kd ll lm ke kf ln lo kg lp lq lr ki ls lt lu kk lv lw lx km ig bi translated">以下是在 Kotlin 中如何使用这些方法处理地图单击和标记单击的示例:</p><pre class="ly lz ma mb gt mc md me bn mf mg bi"><span id="8c93" class="mh mi in md b be mj mk l ml mm">googleMap.setOnMapClickListener { latLng -&gt;<br/>    // Handle map click<br/>}<br/><br/>googleMap.setOnMapLongClickListener { latLng -&gt;<br/>    // Handle map long click<br/>}<br/><br/>googleMap.setOnMarkerClickListener { marker -&gt;<br/>    // Handle marker click<br/>    true<br/>}</span></pre><p id="7dae" class="pw-post-body-paragraph lj lk in kb b kc kd ll lm ke kf ln lo kg lp lq lr ki ls lt lu kk lv lw lx km ig bi translated"><code class="fe mo mp mq md b">setOnMapClickListener</code>和<code class="fe mo mp mq md b">setOnMapLongClickListener</code>方法接受一个 lambda 函数，当用户在地图上单击或长时间单击时调用该函数。lambda 函数被传递一个代表点击位置的<code class="fe mo mp mq md b">LatLng</code>对象。</p><p id="45f6" class="pw-post-body-paragraph lj lk in kb b kc kd ll lm ke kf ln lo kg lp lq lr ki ls lt lu kk lv lw lx km ig bi translated"><code class="fe mo mp mq md b">setOnMarkerClickListener</code>方法接受一个 lambda 函数，当用户点击一个标记时调用这个函数。lambda 函数被传递一个代表被点击的标记的<code class="fe mo mp mq md b">Marker</code>对象。该函数应返回一个布尔值，指示是否应抑制默认的标记单击行为。</p><p id="5136" class="pw-post-body-paragraph lj lk in kb b kc kd ll lm ke kf ln lo kg lp lq lr ki ls lt lu kk lv lw lx km ig bi translated">您可以在 Google Maps Android API 文档中找到有关这些方法和其他手势的更多信息:</p><div class="kr ks gp gr kt ku"><a href="https://developers.google.com/maps/documentation/android-sdk/events" rel="noopener  ugc nofollow" target="_blank"><div class="kv ab fo"><div class="kw ab kx cl cj ky"><h2 class="bd io gy z fp kz fr fs la fu fw im bi translated">活动 Android 地图| Google 开发者</h2><div class="lb l"><h3 class="bd b gy z fp kz fr fs la fu fw dk translated">使用 Android 版的 Maps SDK，你可以收听地图上的事件。GitHub 上的 ApiDemos 库包含示例…</h3></div><div class="lc l"><p class="bd b dl z fp kz fr fs la fu fw dk translated">developers.google.com</p></div></div><div class="ld l"><div class="ng l lf lg lh ld li jt ku"/></div></div></a></div><p id="7496" class="pw-post-body-paragraph lj lk in kb b kc kd ll lm ke kf ln lo kg lp lq lr ki ls lt lu kk lv lw lx km ig bi translated">谢谢大家！</p></div></div>    
</body>
</html>