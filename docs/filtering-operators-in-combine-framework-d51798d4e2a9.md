# 组合框架中的过滤运算符

> 原文：<https://blog.devgenius.io/filtering-operators-in-combine-framework-d51798d4e2a9?source=collection_archive---------8----------------------->

在本文中，我们将讨论 iOS 中 Combine 框架的过滤操作符，这些操作符提供了像集合操作符一样转换数据的方法，但是它们处理的是一系列数据。

**用例:**过滤数据集是一项常见的编程任务，同样适用于数据序列。Combine 框架提供了多种方法来映射、过滤和简化数据序列，这些操作被链接在一起，并且在每个元素通过操作符时对其进行转换，而不是对数据集进行操作。
我想在本文中介绍一些运算符，并邀请您探索更多由 Combine 提供的功能。

**先决条件:**

*   Xcode 11 及以上支持`Combine framework`
*   出版商、订户和主题的基本知识。

让我们开始吧:

# **滤镜:**

联合收割机中的过滤器与 swift 中的过滤器工作方式相同。这里唯一的区别是，我们甚至可以在接收值之前应用过滤器。
过滤器有两种变体，如下面的代码片段所示:

组合框架中的过滤过滤算子。

在上面的代码片段中，我们在第 1 行有一个公共的发布者，用于订阅和过滤两种类型过滤器的条件。

> -对于过滤器，我们可以直接在闭包中添加条件并接收结果。
> -对于 tryFilter，我们抛出最后一个数字异常只是为了学习，如果您观察到 sink，我们有接收完成和接收值块。这是必需的，因为我们的过滤器也可以抛出异常。

# **紧凑地图:**

压缩映射是一种过滤运算符，用于根据操作映射数据。我们在 combine 中也有一个 map，但是它是 Transforming 操作符的一部分。Compact map 从数据中删除 nil 元素，并在订阅时发布非零元素。
我们还有各种名为 **tryCompactMap** 的压缩映射，可以在需要时抛出错误。你可以在[苹果文档](https://developer.apple.com/documentation/combine/publisher/trycompactmap(_:))中读到更多关于这个变化的内容。

联合框架中的紧致映射过滤算子。

在上面的例子中，我们打算将数组中的所有字符串都设为 int，然后打印出来。我们可以轻松地进行压缩，而无需创建额外的变量，然后订阅它以打印结果。
正如我们所看到的，您将不会在输出中找到“**None”**的结果，因为它将为零，并且压缩映射将跳过该流。

# **忽略输出:**

忽略输出是一种非常特殊的操作符，它忽略所有上游数据，但传递发布者的完成状态。这对于静默 API 调用、通知或后台数据库同步工作很有帮助，因为我们只需要完成状态。

忽略组合框架中的输出过滤运算符。

在上面的例子中，我们在第 2 行创建了一个发布者，我们忽略了第 4 行的输出。这不会在接收值块中打印任何内容，但最后会在接收完成块中打印完成。

# **第一个和最后一个:**

第一个和最后一个也与 Swift 第一个和最后一个运算符相同。唯一的区别是，与 Combine 相比，我们会发现 swift 中 first 和 last 有更多的变体。

组合框架中的第一个和最后一个过滤运算符。

在上面的例子中，我们在订户上使用了第一个和最后一个运算符，它们将分别给出结果“1”和“100”。第一个和最后一个的变化叫做**【凡】**。它将返回满足“ **where** 条件的第一个/最后一个元素。

# **先下降，再下降，直到从**输出

combine 中的 Drop 运算符忽略上游的元素，直到满足闭合结果。它不会像我们在“删除”中看到的那样从内存中删除元素。
drop 运算符有三种变体:

1.  Drop First:
    Drop First 从头开始跳过元素，直到满足表达式。每当我们想跳过初始数据时，都可以使用这个操作符。

在组合框架中删除第一个筛选运算符。

在上面的例子中，我们可以看到最简单的我们可以使用 drop first 操作符，它将跳过前两个元素，并在发布时打印剩余的元素。

2.丢弃时间:

Drop While 可用于跳过带有表达式的元素。这可用于显示数据集，如奇数、偶数、倍数、除法、小于、大于等。

在组合框架中筛选运算符时删除。

在上面的例子中，我们在第 6 行使用了带有小于条件的 drop while 操作符，当 subscribe 它时，输出将是满足条件的跳过元素的结果。

3.放下直到从:

无论我们在哪里使用它，Until From 都是一个有趣的操作符，它需要两个订阅者，一个用于订阅，一个用于跟踪订阅。

从组合框架中的筛选运算符中删除。

在上面的例子中，我们使用了 2 个订户，主要订户是用于订阅的删除订户。停止订阅者在第 9 行被传递，将其定义为可以停止订阅的订阅者。我们将根据条件停止第 15 行的订阅。

# **前缀:**

Prefix 可用于限制发布服务器所需的数据数量。在分页或我们只需要一定量数据的情况下，会很有帮助。
一个前缀有很多变体，比如 **while** 、 **maxLength** 、 **untilOutputFrom** 、 **tryPrefix** 你可以在 [**Apple 文档**](https://developer.apple.com/documentation/combine/fail/prefix(_:)) **中轻松找到。**

组合框架中的前缀过滤算子。

在上面的例子中，我们只使用了一个前缀的正常变体，它将给出前 7 个元素作为输出。

注意:还有一个名为“**删除重复**”的过滤操作符。不过，我以后会写的。

这就是 Combine 中所有使用序列操作符的人。我将在下一篇博客中讨论不同的合并操作符。

# 何去何从:

当我们使用订阅者从数据库或服务器获取数据时，我们可以尝试这个操作符，这将帮助我们获得过滤的数据，并避免开始时不需要的数据。您可以在我的 [**GitHub**](https://github.com/NilaakashSingh/CombineConcepts) 资源库中找到不同的合并操作符及其用法。

**更多内容:** **联合收割机中的序列操作符:**[https://nilaakash . medium . com/Sequence-operators-in-Combine-framework-c 942182150 a](https://nilaakash.medium.com/sequence-operators-in-combine-framework-c942182150a)

**学习 RxSwift 和 rx cocoa**:[https://medium . com/@ iAkashlal/Learning-rx swift-and-rx cocoa-basics-with-snippets-e 282530 d10e 7](https://medium.com/@iAkashlal/learning-rxswift-and-rxcocoa-basics-with-snippets-e282530d10e7)

**分享本博客传播知识| Do-Follow，喜欢就鼓掌！快乐编码:)**

**在**[**Linkedin**](https://www.linkedin.com/in/nilaakash-singh-79a386b2/)**和**[**Twitter**](https://twitter.com/NilaakashSingh)**上加我。**