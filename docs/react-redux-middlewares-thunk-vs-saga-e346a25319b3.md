# React Redux 中间件:Thunk vs Saga

> 原文：<https://blog.devgenius.io/react-redux-middlewares-thunk-vs-saga-e346a25319b3?source=collection_archive---------0----------------------->

今天我们将讨论用于异步任务的 Redux 中间件。但是在经历它之前，我们应该首先明白我们为什么需要它们？

如您所知，Redux 是一个用于全局状态管理的库。假设在应用程序的一部分(我们称之为组件)中有一个计数器，而在另一部分中，您也想显示计数器的结果。你可能会说，好吧，我们为什么需要 Redux？

# 可挑选的两种方法

我们可以简单地使用`context` API 来共享数据。答案是正确的。事实上，这是你的电话。但是 Redux 为您提供了一种更结构化、更高级的状态管理方式。

你可能会问，好吧，让我们使用 Redux。但是为什么我们需要 Redux 中间件来完成异步任务呢？你可以只建议`react-query`，这仍然是一个有效的回答。对我来说，用`react-query`处理异步任务有时是最好的选择。也许我可以给 Redux 查询的响应。这完全没问题。实际上，我更喜欢使用`react-query`，因为它给了你很多特性，比如缓存、重试等等。

# Redux 中间件

但是有时你在一个项目中工作，他们使用 Redux 中间件。那你应该知道怎么和他们共事。问题又来了:*什么是 Redux 中间件？下面是答案:*

在分派动作和动作到达缩减器之间提供第三方扩展点。(用于日志记录、崩溃报告、异步任务等。)

让我们看看 Redux 在没有中间件的情况下是如何工作的。(我假设您已经对 Redux 有了很好的理解，并在您的项目中使用了它)

这里，您只需分派一个带有一些有效负载的动作。但是如果你想做一个异步任务(比如调用一个 HTTP 请求)呢？再读一遍中间件的定义。

# **Redux Thunk**

下面是 Redux Thunk 中的一个例子。很好理解。不是返回一个简单的对象作为动作，而是返回一个处理异步任务的函数。

这在大规模的项目中可能很难维持。此外，测试和编写一些单元测试也会更加困难。但它确实起作用了。让我们看看 Redux Saga 如何完成自己的工作。

# Redux 传奇

在 thunk 中，action creator 不返回对象，它返回一个函数，在 saga 中，它允许您正常发送动作。但是它有一个观察者。每当一个特定的动作被分派时，观察者就会捕捉到它。它不让它去减速器。然后，当它捕捉到它时，它运行异步任务。然后，它调度另一个将到达缩减器的动作。(这不是同一个动作)所以，假设我们有一个 AGE_UP 动作，那么我们将调度 AGE_UP_ASYNC(如果我们使用 AGE_UP，它将处于无限循环中)。所以在 reducer 中，我们应该使用 AGE_UP_ASYNC，因为在这个中间件中，我们捕获 AGE_UP 并分派 AGE_UP_ASYNC。

我不打算详细讨论发生器函数的概念，所以这取决于你。我只是想对它们的工作原理有一个大致的了解。首先，我们的 watchAgeUp 函数捕获调度。然后运行异步任务。你可能会问`takeEvery`是做什么的？在第 5 行中，您可以看到异步任务仅仅等待了 4 秒钟。所以在这 4 秒内，如果你调度同一个动作 10 次，就会影响。但是如果用`takeLatest`就不会影响了。

这是对 Redux 的重要中间件的总结。我希望它是清楚的。如果你有任何问题，请让我知道。