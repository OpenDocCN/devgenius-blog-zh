<html>
<head>
<title>How to predict flight prices with Python (XGBoost, Linear Regression…)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用 Python 预测航班价格(XGBoost，线性回归…)</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-predict-flight-prices-with-python-xgboost-linear-regression-be2ea731595e?source=collection_archive---------6-----------------------#2022-04-05">https://blog.devgenius.io/how-to-predict-flight-prices-with-python-xgboost-linear-regression-be2ea731595e?source=collection_archive---------6-----------------------#2022-04-05</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="b5cb" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">逐步建立你自己的机器学习算法来预测航班价格。数据探索、可视化、数据预处理以及最终建模(训练和预测)。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/2b24aa8562d70777f9c738af4d926080.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*29Ss4Z9ZahnFuPZmE39mUg.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">图片来自<a class="ae ks" href="https://www.pexels.com/search/airbus/" rel="noopener ugc nofollow" target="_blank">pexels.com</a></figcaption></figure><p id="4920" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我在 Kaggle(眨眼脸)上看到了这个<a class="ae ks" href="https://www.kaggle.com/datasets/shubhambathwal/flight-price-prediction" rel="noopener ugc nofollow" target="_blank">数据集</a>，我对自己说，为什么不用它来构建一些东西，以增加我的机器学习知识，所以我开始了，下面是它是如何进行的。</p><h1 id="0f71" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">数据探索</h1><p id="c928" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">为了处理数据集，你需要加载并理解它，这就是 python <a class="ae ks" href="https://pandas.pydata.org/docs/index.html" rel="noopener ugc nofollow" target="_blank"> Pandas </a>包的用武之地。用熊猫读取 python 中的 CSV 数据集就像<em class="mm">data = PD . read _ CSV(' filename . CSV ')一样简单。当数据集被读取时，它看起来像这样</em></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mn"><img src="../Images/b14ee1b177166e98e6d00678a4540f99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XM8aV9na71CeraPRrVtLvg.png"/></div></div></figure><p id="418e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我在这个项目中使用的其他一些 pandas 数据探索函数包括<strong class="kv io"> info() </strong>，<strong class="kv io"> describe() </strong>，<strong class="kv io"> isnull()。</strong>对我来说幸运的是，数据集是干净的，所以我不必做任何丢失数据处理和其他相当容易的事情，所以不要害怕。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mo"><img src="../Images/b7fe5328c7b44c2c30455602d51d0124.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hLgjPqIh4i0Wtw3tjmLoEA.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">运行中的函数 info()，参见<a class="ae ks" href="https://github.com/munas-git/flight-price-prediction/blob/main/flight-price-prediction.ipynb" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上的其余代码。</figcaption></figure><p id="2ca4" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">上面，您可以看到 info()函数在工作，它向我们显示了数据表列、非空值的数量以及它们的数据类型。了解您正在处理的数据类型很重要，以防将来对您的模型进行数据操作。完成上一步后，我对各种属性进行了分组，如出发时间、航空公司、出发前剩余天数和其他一些属性，然后将它们可视化，以了解这些属性中的每一个如何影响机票的平均成本。</p><h1 id="4afe" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">数据可视化</h1><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/fcbb4f515cae90a73c5ceeadcf6fada9.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*PhrUjr-mgEJ0VrY7kdO0CQ.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">表示价格变化与出发前剩余天数关系的条形图，参见<a class="ae ks" href="https://github.com/munas-git/flight-price-prediction/blob/main/flight-price-prediction.ipynb" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上的其余代码。</figcaption></figure><p id="4a70" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">从上面可以看出，离出发的天数越多，机票价格就越便宜。这一点很重要，因为现在我们知道这是我们将要构建的回归模型的一个关键独立变量。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mq"><img src="../Images/c0449fc8879c961d97b135a235d30faa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*skMi8HwUbbddpXqrQ1mZtA.png"/></div></div></figure><p id="efa2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">上图中，你可以看到经济舱机票的平均价格比商务舱机票便宜很多。注意这一点也很重要，因为现在我们知道类对成本有着巨大的影响，我们知道对于我们将要构建的回归模型来说，它也是一个需要注意的关键独立变量，这一过程对其他属性重复进行。你可以在 GitHub 上看到其余的可视化效果。</p><h1 id="f3a0" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">数据预处理</h1><p id="bdb7" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">数据预处理是机器学习中的一个关键步骤，因为数据可能以模型无法接受的格式出现。该数据集包含分类数据，大多数模型不接受分类数据，因此我将在这里通过将分类数据转换为 pandas 虚拟数据(ML 模型可以轻松处理的整数格式的数据)来处理，然后在最终将模型拟合到数据之前，将数据拆分为训练集和测试集。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mr"><img src="../Images/b432f1488cab514b63c1421a3825e125.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jmA2iVCrGvdTgvl-ke21Ug.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">已处理数据表</figcaption></figure><p id="8e78" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">上图中，你可以看到预处理数据的最终产品，这些数据将被分为模型的<em class="mm">训练</em>和<em class="mm">测试</em>组。注意到表格的变化了吗？列已展开，以前类别列中的每个唯一字符串现在已被拆分为单独的列，1 表示是/真，而 0 表示否/假。要了解这是如何做到的，请访问<a class="ae ks" href="https://github.com/munas-git/flight-price-prediction/blob/main/flight-price-prediction.ipynb" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>，而要了解什么熊猫虚拟数据更好，请访问<a class="ae ks" href="https://pandas.pydata.org/docs/reference/api/pandas.get_dummies.html" rel="noopener ugc nofollow" target="_blank"><em class="mm">PD . get _ dummies()</em></a><em class="mm">。</em></p><h2 id="444b" class="ms lq in bd lr mt mu dn lv mv mw dp lz lc mx my mb lg mz na md lk nb nc mf nd bi translated">模型(训练和预测)</h2><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ne"><img src="../Images/d1bb14b593f8a864d6cbbf4f4757ffce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kfDB1cPgpJPbe7PD5gaXAQ.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">训练线性回归模型</figcaption></figure><p id="a5cd" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">上面是用于训练线性回归模型的代码片段，您可以在图像的底部看到，模型对训练和测试数据的预测分数分别为 91.1%和 91.2%，这是很好的分数，并且相差不远，因此我们可以说我们的模型没有过度拟合，但我肯定可以得到更好的分数，所以我继续将数据拟合到 XGBoost 模型。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nf"><img src="../Images/29368e7cad21d53e1d49baccebfda1e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I4CxukLdqN1o8dsVWw6Bvg.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">训练 XGBoos 回归模型</figcaption></figure><p id="943b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">上面是用于训练 XGBoost 回归器模型的代码片段，您可以在图像的底部看到，模型对训练和测试数据的预测分数分别为 97.54%和 97.45%，这是很好的分数，并且相差不远，因此我们可以说我们的模型没有过度拟合。</p><p id="f25f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">和往常一样，请随意查看其余的<a class="ae ks" href="https://github.com/munas-git/flight-price-prediction/blob/main/flight-price-prediction.ipynb" rel="noopener ugc nofollow" target="_blank">源代码</a>，以便更深入地理解这项工作。如果您喜欢阅读，请关注更多数据科学文章，留下评论和赞。</p><p id="ae6b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">谢谢，下次再见。</p></div></div>    
</body>
</html>