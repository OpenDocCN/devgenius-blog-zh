<html>
<head>
<title>Rails Routes, from beginner to PRO!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">铁路路线，从初学者到专业！</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/rails-routes-from-beginner-to-pro-1381e5567a27?source=collection_archive---------19-----------------------#2020-06-06">https://blog.devgenius.io/rails-routes-from-beginner-to-pro-1381e5567a27?source=collection_archive---------19-----------------------#2020-06-06</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/ee26d763e9e01010e1834e93e381d78b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c0cw8X495xSY1VpoKVr7uw.jpeg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">也许你知道，但你知道为什么会成功吗？</figcaption></figure><p id="66a4" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">本文的目标不是提供关于配置的详细信息。在这里，我假装让您对 Rails 路由器的可能性有一个更好的了解，这样您就可以开始练习并在您的应用程序中使用不同的方法。</p><p id="86a8" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">所以你开始使用 Ruby on Rails 创建一些基本的项目，数据被保存，数据被呈现，用户只需点击一个按钮就可以进入正确的页面，而且你不必为此硬编码任何 HTML 页面…但是，这一切怎么可能呢？</p><p id="f39f" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">通过这篇文章，我希望回答以下问题，这将有助于您更好地了解使用 Rails 时的可能性。</p><p id="3729" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在用户请求后，如何让 web 应用程序呈现正确的内容？</p><ul class=""><li id="b05c" class="kx ky in kb b kc kd kg kh kk kz ko la ks lb kw lc ld le lf bi translated">你能用 Rails 创建一个 API 吗？</li><li id="d0f7" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated">你如何获得用户发送的数据？</li><li id="d9f2" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated">你如何定制一个用户访问你的网站的 URL？</li></ul><p id="0ec0" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在使用 Rails 构建的最初几个项目中，您可能只是跟着教程走，或者阅读文档并做出可以让您的项目工作的最简单的实现。</p><p id="97b4" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在本文中，我想展示 Rails 路由器是如何为您的应用程序工作的，以及您如何定制它的行为以使您的网站感觉更专业、更易于导航，甚至可伸缩。</p><p id="819f" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">首先，让我们定义几个概念来帮助您快速了解。</p><p id="3381" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">轨道路由器</strong></p><p id="bd76" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">这是本文的核心。路由器负责数据发送的方式和位置，或者数据请求的来源。</p><p id="3550" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">当用户向您的页面发出请求(即“加载我的好友列表”)时，该请求会通过 HTTP(s)发送到您的服务器，使用<a class="ae ll" href="https://www.restapitutorial.com/lessons/httpmethods.html" rel="noopener ugc nofollow" target="_blank"> HTTP 方法</a>，可以是/GET(读取)、/POST(创建)、PUT(更新/替换)或 DELETE。</p><p id="4be2" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在 Rails 中，根据接收请求的 URL 和使用的方法，调用控制器动作，它们是索引、新建、创建、显示、编辑、更新和销毁。<a class="ae ll" href="https://guides.rubyonrails.org/routing.html#crud-verbs-and-actions" rel="noopener ugc nofollow" target="_blank">访问导轨</a>了解更多详情。</p><p id="64b8" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">轨道控制器</strong></p><p id="e5cf" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">当控制器动作被调用时，它们可以提供一个 HTML 响应(呈现您创建的视图)或一个 JSON 响应(阅读下面的内容了解更多)。</p><p id="b6e5" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">什么是 API？</strong></p><p id="2061" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">应用程序编程接口，很明显…</p><p id="3904" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">你可能知道这个，你甚至可能在过去调用过一个，也许是为了获得一些天气数据，或者使用 Google Maps API 创建一个个性化的地图。但是，我们的 Rails 项目与此有什么关系呢？</p><p id="b20c" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">嗯，一个队友曾经告诉我，“互联网上的一切都是 API”，我所能想到的是，我没有使用任何人的 API 来让我的网站工作，那么他为什么对我说这些呢？</p><p id="e257" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">答案是，互联网上几乎所有的东西都是 API。为什么？如果你想完全替换掉你的前端，而不必担心你的数据如何被你的应用程序的后端处理，那么使用 API 会给你很大的灵活性。</p><p id="c954" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">最有可能的是，您已经完成或从教程中看到的 Rails 项目包括创建模型和 DB 迁移、设置路由(我们将在一分钟内完成)、在控制器中创建方法以处理基于 HTTP 请求(REST)的操作，然后创建当调用控制器操作之一时呈现的视图。</p><p id="763a" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">您可以创建一个内部 API(您的 Rails 服务器)来处理相同的 HTTP 请求，但不是让您的控制器呈现某些内容，而是让它们返回一个 JSON 对象，该对象可以由您的前端使用，您可以随意创建，根本不用担心 ERB，并且可以向组合中添加更多的 API，从而使它成为一种非常灵活的构建网站的方式，因为您可以轻松扩展并以去耦的方式添加更多的服务。</p><p id="f2ed" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">最后，航线</strong></p><p id="2795" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">现在很清楚，您有一个路由器将请求传递给控制器，我们知道控制器的动作，我们知道拥有一个 API(使用控制器动作返回 JSON 响应)比在 Rails 上构建整个应用程序有更大的优势。<a class="ae ll" href="https://guides.rubyonrails.org/api_app.html" rel="noopener ugc nofollow" target="_blank">导轨</a>为这种方法提供了很好的理由。</p><p id="765e" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">您如何使用路由器来构建上述任何一种方法？</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="7c61" class="lv lw in lr b gy lx ly l lz ma">Rails.application.routes.draw do<br/>  resources :brands<br/>end</span></pre><p id="d11e" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">以上是告诉 Rails 路由器创建我们前面提到的控制器动作所需的所有路由的一种非常基本的方式。在幕后，它创建单独的规则，看起来像:</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="9ae9" class="lv lw in lr b gy lx ly l lz ma">get ‘/patients/:id’, to: ‘patients#show’</span></pre><p id="e361" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">这允许您使用从 URL (:id)传入的 id 来获取患者。无论这是返回一个 HTML 响应并加载您的视图，还是返回一个 JSON 响应，现在都取决于您，因为您知道自己的可能性。</p><p id="01e5" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">如果您的联系页面没有连接到您的数据库，它只是向您发送一封带有联系表单文本的电子邮件，该怎么办？你如何将用户发送到那个页面？</p><p id="e85b" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">任何不在 RESTful 请求范围内且不被任何现有控制器处理的页面都需要一个自定义路由。我们来看一个:</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="c132" class="lv lw in lr b gy lx ly l lz ma">get ‘/contact, to: ‘…where?’</span></pre><p id="f05e" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">确切地说，去哪里？现在，用户可以通过访问“http://yourwebsite.com/contact”向我们发送获取联系人页面的请求，但是由于 http 请求被路由到一个控制器操作，我们需要创建一个控制器来处理对该页面的调用，然后加载相应的视图，假设您将其称为“pages ”,并且您创建了一个方法“contact ”,该方法仅呈现联系人视图，则路由如下所示:</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="8732" class="lv lw in lr b gy lx ly l lz ma">get ‘/contact, to: ‘pages#contact’</span></pre><p id="310b" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">现在，如果你有一个静态主页呢？然后，您可以使用刚刚创建的控制器，但不要使用 contact，而是使用“homepage”方法，并将您的根目录作为主页:</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="3af2" class="lv lw in lr b gy lx ly l lz ma">root ‘pages#homepage’</span></pre><h2 id="36af" class="lv lw in bd mb mc md dn me mf mg dp mh kk mi mj mk ko ml mm mn ks mo mp mq mr bi translated">嵌套路由</h2><p id="b726" class="pw-post-body-paragraph jz ka in kb b kc ms ke kf kg mt ki kj kk mu km kn ko mv kq kr ks mw ku kv kw ig bi translated">假设我们的用户在我们的博客中有许多文章，并且您希望有一个专门的页面来显示该用户的文章，而不仅仅是在用户的个人资料中呈现它们(大多数教程都是这样做的)。</p><p id="a2bf" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">实现这一目标的途径如下:</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="1f75" class="lv lw in lr b gy lx ly l lz ma">get ‘/user/:id/articles, to: ‘articles#index’</span></pre><p id="d875" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">您还会得到一个名为 path 的助手:</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="98a7" class="lv lw in lr b gy lx ly l lz ma">user_articles_path</span></pre><p id="0a49" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">以上只是一些例子，同样，如果你想详细回顾它是如何工作的，我鼓励你访问 Rails 指南，它们可能是容易理解的指南。问题是，有时我们只是找到了让项目继续下去所需的东西，甚至没有注意到我们有哪些选择。</p><h1 id="c926" class="mx lw in bd mb my mz na me nb nc nd mh ne nf ng mk nh ni nj mn nk nl nm mq nn bi translated">结论</h1><p id="e17c" class="pw-post-body-paragraph jz ka in kb b kc ms ke kf kg mt ki kj kk mu km kn ko mv kq kr ks mw ku kv kw ig bi translated">有了我在这里提供的信息，您现在可以根据您的应用程序需求开始探索使用 Rails 路由器的不同方式。不需要拘泥于基础；您可以充分利用所提供的定制选项。</p><p id="fe55" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我们谈到了 API，但是为什么呢？尽管本文主要关注的是路线本身，但是请考虑这样一个事实，即 Rails 路线和控制器帮助您定义了一个 API。您可以很容易地设置一个，并利用您的知识了解发送到 API 的每个 HTTP 请求是如何被路由的。</p><p id="3198" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我希望这篇文章为探索更多关于 Rails 的知识打开了一扇门，这样你就知道可以从哪里继续探索了，下面是一些有用的指南:</p><ul class=""><li id="3023" class="kx ky in kb b kc kd kg kh kk kz ko la ks lb kw lc ld le lf bi translated"><a class="ae ll" href="https://guides.rubyonrails.org/api_app.html" rel="noopener ugc nofollow" target="_blank">Rails API</a></li><li id="4074" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated"><a class="ae ll" href="https://guides.rubyonrails.org/routing.html#non-resourceful-routes" rel="noopener ugc nofollow" target="_blank">使用非资源路线</a></li><li id="e8c2" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated"><a class="ae ll" href="https://guides.rubyonrails.org/action_controller_overview.html#parameters" rel="noopener ugc nofollow" target="_blank">控制器参数(从 HTTP 请求中获得的参数)</a></li></ul><p id="a9c0" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">干杯，编码快乐！</p></div></div>    
</body>
</html>