<html>
<head>
<title>JavaScript Tips — Semicolons, Download Files, Escaping Strings, and More</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript技巧—分号、下载文件、转义字符串等等</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/javascript-tips-semicolons-download-files-escaping-strings-and-more-637b83f62dfe?source=collection_archive---------45-----------------------#2020-07-08">https://blog.devgenius.io/javascript-tips-semicolons-download-files-escaping-strings-and-more-637b83f62dfe?source=collection_archive---------45-----------------------#2020-07-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c18cb1ba2aeb286145fe5d583ce60ff0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kLb9RCqiAk9CkPIH"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@ataheri?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Autri Taheri </a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="8572" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">像任何类型的应用程序一样，当我们编写JavaScript应用程序时，有一些困难的问题需要解决。</p><p id="96a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究一些常见JavaScript问题的解决方案。</p><h1 id="1dfc" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">JavaScript的自动分号插入(ASI)规则</h1><p id="8c16" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">如果没有分号，JavaScript会自动插入分号。</p><p id="c08a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它遵循一些插入项目的规则。</p><p id="d239" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它被添加到以下代码段之后:</p><ul class=""><li id="2fc3" class="me mf iq kf b kg kh kk kl ko mg ks mh kw mi la mj mk ml mm bi translated">空白语句</li><li id="d37f" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la mj mk ml mm bi translated"><code class="fe ms mt mu mv b">var</code>声明</li><li id="4ae9" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la mj mk ml mm bi translated">做一会儿</li><li id="06bb" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la mj mk ml mm bi translated"><code class="fe ms mt mu mv b">continue</code></li><li id="f298" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la mj mk ml mm bi translated"><code class="fe ms mt mu mv b">break</code></li><li id="1206" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la mj mk ml mm bi translated"><code class="fe ms mt mu mv b">return</code></li><li id="09b5" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la mj mk ml mm bi translated"><code class="fe ms mt mu mv b">throw</code></li></ul><p id="e718" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们应该确保我们添加了它们或者JavaScript为我们做了这些。</p><p id="3d15" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">地点可能出乎意料。</p><h1 id="307e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">打破嵌套循环的最佳方式</h1><p id="5f89" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用<code class="fe ms mt mu mv b">break</code>语句来打破嵌套循环。</p><p id="4cd3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="a563" class="ne lc iq mv b gy nf ng l nh ni">for (const i of a) {<br/>  for (const j of b) {<br/>    breakCheck = true;<br/>    break;<br/>  }<br/>  if (breakCheck) {<br/>    break<br/>  };<br/>}</span></pre><p id="2687" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在内部循环中设置了<code class="fe ms mt mu mv b">breakCheck</code>标志。</p><p id="7e84" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们使用<code class="fe ms mt mu mv b">break</code>来打破内部循环。</p><p id="1197" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们检查<code class="fe ms mt mu mv b">breakCheck</code>标志并结束外部循环。</p><h1 id="7f6a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">打印选定的元素</h1><p id="73d2" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过使用一些CSS使一个元素可打印。</p><p id="a549" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们有:</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="4b22" class="ne lc iq mv b gy nf ng l nh ni">&lt;div id=“printarea”&gt;<br/>  hello world<br/>&lt;/div&gt;</span></pre><p id="a680" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们可以使用下面的CSS使div可打印:</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="b9e1" class="ne lc iq mv b gy nf ng l nh ni">@media print {<br/>  body * {<br/>    visibility: hidden;<br/>  }<br/>  #printarea, #printarea * {<br/>    visibility: visible;<br/>  }<br/>  #printarea {<br/>    position: absolute;<br/>    left: 0;<br/>    top: 0;<br/>  }<br/>}</span></pre><p id="d9b2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们使用<code class="fe ms mt mu mv b">print</code>媒体查询在打印时隐藏主体，只显示ID为<code class="fe ms mt mu mv b">printarea</code>的div。</p><h1 id="e3f7" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">随机颜色发生器</h1><p id="6941" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过创建一个包含6个字符的十六进制字符串来创建一个颜色代码，从而生成一个随机颜色。</p><p id="10d5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="b9e3" class="ne lc iq mv b gy nf ng l nh ni">const getRandomColor = () =&gt; {<br/>  const letters = '0123456789ABCDEF';<br/>  const color = '#';<br/>  for (let i = 0; i &lt; 6; i++) {<br/>    color += letters[Math.floor(Math.random() * 16)];<br/>  }<br/>  return color;<br/>}</span></pre><p id="5b31" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe ms mt mu mv b">Math.floor(Math.random() * 16)</code>得到一个随机索引。</p><p id="914f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用它从<code class="fe ms mt mu mv b">letters</code>数组中获得一个随机字符。</p><p id="6690" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们返回颜色代码串。</p><h1 id="4095" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用Node.js下载文件，不使用第三方库</h1><p id="83a5" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过创建写流来下载文件。</p><p id="a310" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以将写流传递给<code class="fe ms mt mu mv b">http.get</code>方法。</p><p id="038f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，响应数据通过管道进入写入流。</p><p id="836e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="945a" class="ne lc iq mv b gy nf ng l nh ni">const http = require('http');<br/>const fs = require('fs');<br/><br/>const file = fs.createWriteStream("img.jpg");<br/>const request = http.get("<!-- -->https://placeimg.com/640/480/any<!-- -->", (response) =&gt; {<br/>  response.pipe(file);<br/>});</span></pre><p id="34d2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们使用<code class="fe ms mt mu mv b">http</code>模块的<code class="fe ms mt mu mv b">get</code>方法进行下载。</p><p id="4f59" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用写流调用<code class="fe ms mt mu mv b">pipe</code>来保存文件。</p><h1 id="c973" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">自动重新加载Node.js中的文件</h1><p id="949d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">为了在代码文件改变时自动重启应用程序，我们可以使用Nodemon。</p><p id="3d47" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要使用它，我们只需运行:</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="9140" class="ne lc iq mv b gy nf ng l nh ni">npm install nodemon -g</span></pre><p id="51b8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">安装软件包。</p><p id="43a9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们运行:</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="fb4f" class="ne lc iq mv b gy nf ng l nh ni">nodemon app.js</span></pre><p id="4fcb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用<code class="fe ms mt mu mv b">app.js</code>运行程序，其中<code class="fe ms mt mu mv b">app.js</code>是我们应用程序的入口点。</p><h1 id="07c1" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">JavaScript ES6类中的私有属性</h1><p id="e229" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">私有类成员来JavaScript类。</p><p id="f3cd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它们由<code class="fe ms mt mu mv b">#</code>字符表示。</p><p id="35b7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="2df1" class="ne lc iq mv b gy nf ng l nh ni">class Foo {<br/>  #property;<br/><br/>  constructor(){<br/>    this.#property = "test";<br/>  }<br/><br/>  #privateMethod() {<br/>    return 'hello world';<br/>  }<br/><br/>  getPrivateMessage() {<br/>    return this.#privateMethod();<br/>  }<br/>}</span></pre><p id="efd8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">任何前缀为<code class="fe ms mt mu mv b">#</code>的都是私有成员。</p><p id="263d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它可以与巴别塔7一起使用，并预设第三阶段。</p><h1 id="54e5" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">转义字符串</h1><p id="2757" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用反斜杠来替换所有我们想转义的字符串。</p><p id="c4d0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="3b35" class="ne lc iq mv b gy nf ng l nh ni">const escapeRegex = (string) =&gt; {<br/>  return string.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&amp;');<br/>}</span></pre><p id="795c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用一个正则表达式调用<code class="fe ms mt mu mv b">replace</code>,这个正则表达式匹配我们想要转义的所有字符。</p><p id="b495" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们通过在这些字符前加一个反斜杠来代替它们。</p><p id="5d40" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以如果我们称之为:</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="69ae" class="ne lc iq mv b gy nf ng l nh ni">const escaped = escapeRegex('//');</span></pre><p id="7add" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么<code class="fe ms mt mu mv b">escaped</code>就是<code class="fe ms mt mu mv b">“\/\/”</code>。</p><p id="c950" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也可以使用Lodash <code class="fe ms mt mu mv b">escapeRegExp</code>方法来做同样的事情。</p><p id="7234" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们写:</p><pre class="mw mx my mz gt na mv nb nc aw nd bi"><span id="62f2" class="ne lc iq mv b gy nf ng l nh ni">const escaped = _.<!-- -->escapeRegExp<!-- -->('//');</span></pre><figure class="mw mx my mz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/0b5def134a5065a9388dd898d09ea0a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4JKGWSnDuK9Uyeqy"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Andrew Leu 在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="a6dc" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="b13d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">自动插入分号是由JavaScript解释器完成的。</p><p id="dacc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Nodemon允许我们观察代码文件的变化，并自动重新加载我们的应用程序。</p><p id="703f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用标志来中断嵌套循环，以结束外部循环。</p><p id="7696" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以创建一个写流来传输我们的响应。</p></div></div>    
</body>
</html>