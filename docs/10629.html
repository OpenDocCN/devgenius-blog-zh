<html>
<head>
<title>How to use a real-time data pipeline to monitor GitHub Actions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用实时数据管道监控 GitHub 动作</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-use-a-real-time-data-pipeline-to-monitor-github-actions-502ee3c9e0e3?source=collection_archive---------4-----------------------#2022-11-17">https://blog.devgenius.io/how-to-use-a-real-time-data-pipeline-to-monitor-github-actions-502ee3c9e0e3?source=collection_archive---------4-----------------------#2022-11-17</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/f3a33feb072dfbd7c9455c7bcb4e5b0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pd84RNSMLtPn1HIRwRNEHw.jpeg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">照片由<a class="ae jz" href="https://unsplash.com/@angelacompagnone?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">安吉拉·孔波妮</a>在<a class="ae jz" href="https://unsplash.com/s/photos/skyline-crane?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h1 id="5163" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">为什么要监控 CI 构建的 GitHub 操作？</h1><p id="9cb6" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">如果你从事过大型的软件项目，你可能对 GitHub 动作很熟悉。对于外行来说，<a class="ae jz" href="https://docs.github.com/en/actions/learn-github-actions/understanding-github-actions" rel="noopener ugc nofollow" target="_blank"> GitHub Actions </a>是一个内置在 GitHub 中的持续集成/持续交付(CI/CD)平台。它允许开发团队自动化<strong class="la io">工作流:</strong>系列的<strong class="la io">工作</strong>，这些工作基于某些事件测试、构建和/或部署代码。</p><p id="9329" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">例如，您可能有一个 CI 工作流，它构建并测试每个对存储库的新提交。</p><p id="1448" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">理想情况下，我们不希望工作流运行时间超过几分钟。但现实中，CI 慢是普遍存在的问题。如果不检查的话，长 CI 构建会使开发团队陷入困境。</p><p id="b328" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">这就是为什么关注 CI 构建时间非常重要，以便我们能够随着时间的推移努力改进它们。我们需要回答这样的问题:</p><ul class=""><li id="f770" class="mb mc in la b lb lw lf lx lj md ln me lr mf lv mg mh mi mj bi translated">随着时间的推移，平均 CI 构建时间如何变化？</li><li id="4a0e" class="mb mc in la b lb mk lf ml lj mm ln mn lr mo lv mg mh mi mj bi translated">在平均构建时间更长的日子里还会发生什么？</li></ul><p id="f7bc" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">当然，你可以购买一个 dashboarding 解决方案来监控类似 GitHub 的动作，但是你也可以很容易地创建自己的解决方案，并保留更多的自主权。</p><p id="2d43" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated"><strong class="la io">在本教程中，我们将创建自己的图表来监控平均 GitHub CI 构建时间。</strong></p><p id="11c1" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">我们将使用以下方法:</p><ul class=""><li id="ac3d" class="mb mc in la b lb lw lf lx lj md ln me lr mf lv mg mh mi mj bi translated">GitHub API<strong class="la io">。它让我们可以访问<a class="ae jz" href="https://docs.github.com/en/rest/actions/workflow-runs#list-workflow-runs-for-a-repository" rel="noopener ugc nofollow" target="_blank">工作流运行</a>(如果我们想进一步构建我们的仪表板，还可以利用许多其他有用的数据)。</strong></li><li id="334f" class="mb mc in la b lb mk lf ml lj mm ln mn lr mo lv mg mh mi mj bi translated"><a class="ae jz" href="https://docs.estuary.dev/" rel="noopener ugc nofollow" target="_blank"><strong class="la io"/></a><strong class="la io">河口流。</strong>这是一款实时数据管道工具，免责声明！—是我的公司制造的。流程<a class="ae jz" href="https://docs.estuary.dev/reference/Connectors/capture-connectors/github/" rel="noopener ugc nofollow" target="_blank">可以与 GitHub API </a>集成。</li><li id="08da" class="mb mc in la b lb mk lf ml lj mm ln mn lr mo lv mg mh mi mj bi translated"><a class="ae jz" href="https://workers.cloudflare.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="la io">云炎工人。</strong> </a> <strong class="la io"> </strong>这为我们的数据转换提供了无服务器的执行环境</li><li id="3a75" class="mb mc in la b lb mk lf ml lj mm ln mn lr mo lv mg mh mi mj bi translated"><strong class="la io">谷歌工作表</strong>。听着！我从没说过这会很迷人。但它将是免费的，可访问的，实时更新的。另外，数据透视表比我们通常意识到的更强大。</li></ul><p id="700f" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">我们最终会得到这样的结果:</p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/2423df39660d59ac785daeea090e2792.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZNHsyDKaQa8e2b-r.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">作者图片</figcaption></figure><h1 id="c4b2" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak">基本步骤</strong></h1><p id="429d" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated"><a class="ae jz" href="https://github.com/estuary/flow-cf-workers-example#readme" rel="noopener ugc nofollow" target="_blank"> <strong class="la io">完整教程在 GitHub 这里。你可能想查看一下更详细的步骤。但是从高层次来说，你应该这样做。</strong></a></p><h2 id="4ad0" class="mt kb in bd kc mu mv dn kg mw mx dp kk lj my mz ko ln na nb ks lr nc nd kw ne bi translated">先决条件:</h2><p id="d05f" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">开始之前，您需要:</p><ul class=""><li id="39e1" class="mb mc in la b lb lw lf lx lj md ln me lr mf lv mg mh mi mj bi translated">可以访问使用 GitHub 操作的回购的 GitHub 帐户</li><li id="4df0" class="mb mc in la b lb mk lf ml lj mm ln mn lr mo lv mg mh mi mj bi translated">一个<a class="ae jz" href="http://dashboard.estuary.dev" rel="noopener ugc nofollow" target="_blank">河口流</a>自由试验和<a class="ae jz" href="https://docs.estuary.dev/getting-started/installation/#get-started-with-the-flow-cli" rel="noopener ugc nofollow" target="_blank">流控制 CLI </a></li><li id="fa9e" class="mb mc in la b lb mk lf ml lj mm ln mn lr mo lv mg mh mi mj bi translated">NodeJS 16.13.0 或更高版本</li><li id="7f74" class="mb mc in la b lb mk lf ml lj mm ln mn lr mo lv mg mh mi mj bi translated">一个<a class="ae jz" href="https://dash.cloudflare.com/sign-up" rel="noopener ugc nofollow" target="_blank">云闪账户</a></li></ul><h2 id="b5c0" class="mt kb in bd kc mu mv dn kg mw mx dp kk lj my mz ko ln na nb ks lr nc nd kw ne bi translated">步骤 1:从 GitHub 捕获数据到实时管道中</h2><p id="d909" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">要启动数据管道，您需要使用 Flow web 应用程序从 GitHub 获取数据。选择名为<code class="fe nf ng nh ni b">workflow_runs</code>的数据流，去掉其余的。</p><h2 id="5dc8" class="mt kb in bd kc mu mv dn kg mw mx dp kk lj my mz ko ln na nb ks lr nc nd kw ne bi translated">步骤 2:使用河口流和 Cloudflare 工作人员转换数据</h2><p id="a06b" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">这就是事情变得有趣的地方。Flow 通过 TypeScript 代码生成和静态类型检查提供实时数据转换。Cloudflare 提供了一个运行函数的便利环境。</p><p id="45d5" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated"><a class="ae jz" href="https://dash.cloudflare.com/sign-up" rel="noopener ugc nofollow" target="_blank">在本节</a>中，我们一起使用河口的<code class="fe nf ng nh ni b">flowctl</code>和云辉的<code class="fe nf ng nh ni b">wrangler</code> CLIs 来转换数据。在这个过程中，有很多关于管理数据管道中的模式和在远程 HTTP 端点托管转换的有用的学习时刻。</p><p id="a8a5" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">最终，我们将实现<strong class="la io">转换数据的目标，为回购、分支、工作流、结果和日期的每个唯一组合生成一个电子表格行。</strong></p><h2 id="cde3" class="mt kb in bd kc mu mv dn kg mw mx dp kk lj my mz ko ln na nb ks lr nc nd kw ne bi translated">步骤 3:将转换后的数据物化到 Google Sheets 中</h2><p id="5fd4" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">回到 Flow web 应用程序，我们将转换后的数据具体化(或加载)到 Google Sheets 中，并在那里不断更新。</p><h2 id="5190" class="mt kb in bd kc mu mv dn kg mw mx dp kk lj my mz ko ln na nb ks lr nc nd kw ne bi translated">步骤 4:创建一个数据透视表和最终图形</h2><p id="f145" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">最后，我们使用 Google Sheets 中的数据透视表来过滤数据，并将工作流时间从几秒钟转换到几分钟。</p><p id="d822" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">从那里，我们可以很容易地制作一个线图，只要我们保持管道部署，它就会不断更新。</p><h1 id="b6b1" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">监控你关心的事情</h1><p id="bd5c" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">此工作流程可无限定制。我知道你可能在想:“是的，很明显，”但我还是想提出来。</p><p id="d2e8" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">不使用 GitHub 动作？使用实时数据管道来跟踪一段时间内的贡献。或者从另一个数据源重新形成数据集。在 Google Sheets 中制作几十个图表，或者完全避开 Google Sheets。没关系，数据是你的。</p><p id="5517" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated"><a class="ae jz" href="https://github.com/estuary/flow-cf-workers-example" rel="noopener ugc nofollow" target="_blank"> <strong class="la io">点击这里查看完整的演示和教程。</strong> </a></p></div></div>    
</body>
</html>