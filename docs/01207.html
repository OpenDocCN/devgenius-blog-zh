<html>
<head>
<title>How I created an API that can work out your shipping emissions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何创建一个API来计算你的运输排放量</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-i-created-an-api-that-can-work-out-your-shipping-emissions-9754442f73be?source=collection_archive---------32-----------------------#2020-06-26">https://blog.devgenius.io/how-i-created-an-api-that-can-work-out-your-shipping-emissions-9754442f73be?source=collection_archive---------32-----------------------#2020-06-26</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/8488e6f3333022464ba91f78b4c420ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XG5ccgzjZFeJ-JZz"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">诺贝特·昆德拉在<a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="a3f0" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">最初发表于我的<a class="ae jz" href="https://www.tobiolabode.com/blog/2020/6/25/python-api-for-carbon-emmissions" rel="noopener ugc nofollow" target="_blank">网站</a></p><h2 id="48a7" class="ky kz in bd la lb lc dn ld le lf dp lg kl lh li lj kp lk ll lm kt ln lo lp lq bi translated">灵感</h2><p id="ddb8" class="pw-post-body-paragraph ka kb in kc b kd lr kf kg kh ls kj kk kl lt kn ko kp lu kr ks kt lv kv kw kx ig bi translated">我正在用python开发一个API，它将计算在世界各地运输产品时产生的排放量。我从一个叫做<a class="ae jz" href="https://www.usepatch.com/" rel="noopener ugc nofollow" target="_blank">补丁</a>的网站上得到这个想法。该公司通过计算运输产品时产生的排放量来抵消碳排放。</p><h1 id="b73f" class="lw kz in bd la lx ly lz ld ma mb mc lg md me mf lj mg mh mi lm mj mk ml lp mm bi translated">计算</h1><p id="08c6" class="pw-post-body-paragraph ka kb in kc b kd lr kf kg kh ls kj kk kl lt kn ko kp lu kr ks kt lv kv kw kx ig bi translated">为了计算碳排放量，我需要收集行驶的距离。项目的质量。和使用的运输类型。需要距离和质量来计算出吨/英里或吨/公里的单位。这是一个简单的测量，显示一公斤或一短吨如何移动一英里或一公里。</p><p id="c8da" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为了计算一辆卡车的运输量，我使用了美国非营利组织环境保护基金会的公式。</p><blockquote class="mn mo mp"><p id="0599" class="ka kb mq kc b kd ke kf kg kh ki kj kk mr km kn ko ms kq kr ks mt ku kv kw kx ig bi translated">第一步:确定吨英里的总量。将1，000英里乘以20吨，我们总共可以得到20，000吨英里。</p><p id="a518" class="ka kb mq kc b kd ke kf kg kh ki kj kk mr km kn ko ms kq kr ks mt ku kv kw kx ig bi translated">第2步:获取货运卡车基于重量的卡车排放系数。美国货运卡车平均每吨英里排放161.8克二氧化碳。</p><p id="592e" class="ka kb mq kc b kd ke kf kg kh ki kj kk mr km kn ko ms kq kr ks mt ku kv kw kx ig bi translated">第三步:将这一排放系数乘以总吨英里数{161.8 X 20，000 }，得出二氧化碳的总量为3，236，000克。</p><p id="e4de" class="ka kb mq kc b kd ke kf kg kh ki kj kk mr km kn ko ms kq kr ks mt ku kv kw kx ig bi translated">步骤4:将总克数转换成公吨。公吨是公司温室气体排放的标准计量单位。一公吨等于一百万克。为了转换第三步的答案，我们将其除以1，000，000。这一次移动会产生3.24公吨的二氧化碳。</p></blockquote><p id="a4e3" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">API的下一部分。我计算了一次海上货运旅程。我使用了欧洲化学运输协会的一个公式。</p><figure class="mv mw mx my gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mu"><img src="../Images/5e347212e06a0c6c18eb682b08359519.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8PLJ5mdO-mTVEb3JnhpXmQ.png"/></div></div></figure><p id="c766" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">下面是一个模板，展示了如何将该公式用于不同的运输方式。</p><figure class="mv mw mx my gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mz"><img src="../Images/86cc5197a6a8074fb6945701f51077ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BWlJIAE4AOTqC2TDfWxk1w.png"/></div></div></figure><p id="ca38" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我将用深海集装箱的例子来说明碳因素。因为这与海运非常相似。</p><h1 id="7420" class="lw kz in bd la lx ly lz ld ma mb mc lg md me mf lj mg mh mi lm mj mk ml lp mm bi translated">烧瓶宁静</h1><p id="0925" class="pw-post-body-paragraph ka kb in kc b kd lr kf kg kh ls kj kk kl lt kn ko kp lu kr ks kt lv kv kw kx ig bi translated">为了开发API，我将使用<a class="ae jz" href="https://flask-restful.readthedocs.io/en/latest/index.html" rel="noopener ugc nofollow" target="_blank"> Flask-RESTful </a>。Flask-RESTful是一个Flask扩展，它有助于抽象出一些构建API的工作。</p><p id="d155" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">首先，您需要一个定义API应用程序的类。Flask-RESTful使用一个名为resource的对象来访问多个HTTP方法，您可以使用这些方法来开发您的API。我将部分解释他们在其网站上展示的示例代码:</p><figure class="mv mw mx my gt jo"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="d808" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">该代码高度基于普通烧瓶。我将跳到它是TodoSimple(Resource)的定义类的部分。TodoSimple是类的名称，因此也是API的名称。该类使用上面提到的资源对象。接下来，这个例子定义了我们想要使用的HTTP方法。</p><pre class="mv mw mx my gt nc nd ne nf aw ng bi"><span id="c653" class="ky kz in nd b gy nh ni l nj nk">def get(self, todo_id):</span><span id="4314" class="ky kz in nd b gy nl ni l nj nk">   return {todo_id: todos[todo_id]}</span></pre><p id="4e88" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这定义了get方法。它从API获取数据。方法用self调用实例。和待办事项id。class方法返回一个以todo_id为键的字典。和使用todo_id访问todos目录的内容。让内容以dictionary的形式返回意味着以后可以以JSON文件的形式访问它。</p><pre class="mv mw mx my gt nc nd ne nf aw ng bi"><span id="e671" class="ky kz in nd b gy nh ni l nj nk">def put(self, todo_id):</span><span id="43c8" class="ky kz in nd b gy nl ni l nj nk">  todos[todo_id] = request.form['data']</span><span id="28fe" class="ky kz in nd b gy nl ni l nj nk">  return {todo_id: todos[todo_id]}</span></pre><p id="b74c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这个方法与上面的get方法非常相似。唯一增加的是允许用户向API发送数据。</p><p id="26aa" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><code class="fe nm nn no nd b">todos[todo_id] = request.form['data'] </code>使用申请表添加待办事项。</p><p id="fe76" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><code class="fe nm nn no nd b">api.add_resource(TodoSimple, ‘/&lt;string:todo_id&gt;’)</code></p><p id="7594" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为开发的类设置路由。<code class="fe nm nn no nd b"> /&lt;string:todo_id&gt; </code>表示访问该类时需要输入一个todo ID。字符串:设置一个接受文本的变量。</p><p id="d36f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">来访问API。使用您选择的允许您发送和接收请求的HTTP服务。</p><p id="7694" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这是网站上的一个例子:</p><figure class="mv mw mx my gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi np"><img src="../Images/72a7dbd6e4aeef18f9927a072997923e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*an9yT399nvZ2oT-pI2vSrg.png"/></div></div></figure><h1 id="78dd" class="lw kz in bd la lx ly lz ld ma mb mc lg md me mf lj mg mh mi lm mj mk ml lp mm bi translated">道路货物运输代码</h1><figure class="mv mw mx my gt jo"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="c887" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我在示例中没有解释的一段代码叫做reqparse。该函数允许您设置验证请求。通过设置参数。</p><pre class="mv mw mx my gt nc nd ne nf aw ng bi"><span id="73a7" class="ky kz in nd b gy nh ni l nj nk">parser = reqparse.RequestParser()</span><span id="f56a" class="ky kz in nd b gy nl ni l nj nk">parser.add_argument('miles')</span><span id="55c9" class="ky kz in nd b gy nl ni l nj nk">parser.add_argument('tons')</span><span id="c10e" class="ky kz in nd b gy nl ni l nj nk">parser.add_argument('ton_miles', type=float)</span><span id="943c" class="ky kz in nd b gy nl ni l nj nk">args = parser.parse_args()</span></pre><p id="718b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">解析器是通过在变量中保存<code class="fe nm nn no nd b">reqparse.RequestParser()</code>来设置的。之后，您可以使用它来添加新的参数。我用<code class="fe nm nn no nd b"> parser.add_argument</code>表示英里数和音调。所以，用户可以输入英里数和吨数。<code class="fe nm nn no nd b">parser.add_argument(‘ton_miles’, type=float)</code>将类型设置为float以允许十进制数字。</p><p id="e005" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><code class="fe nm nn no nd b">args = parser.parse_args()</code>将所有这些参数合并到一个变量中。现在可以用一个键来访问这个参数。参数的名称是关键。例:<code class="fe nm nn no nd b">args[‘tons’], args[miles]</code>。</p><p id="4bfc" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这是我在代码中使用args变量的方式:</p><pre class="mv mw mx my gt nc nd ne nf aw ng bi"><span id="c4a5" class="ky kz in nd b gy nh ni l nj nk">if args['miles'] or args['tons'] is None:</span><span id="f0c5" class="ky kz in nd b gy nl ni l nj nk">    ton_miles = args['ton_miles']</span></pre><p id="7299" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">该代码设置了一个if语句，用于检查miles和tons参数是否为空。然后将ton_miles参数存储到一个变量中。如果用户使用既不需要吨也不需要英里的ton_miles参数，就会这样做。以吨/英里计算的距离乘以质量。</p><pre class="mv mw mx my gt nc nd ne nf aw ng bi"><span id="19e3" class="ky kz in nd b gy nh ni l nj nk">if args['ton_miles'] is None:</span><span id="95c1" class="ky kz in nd b gy nl ni l nj nk">   miles = float(args['miles'])</span><span id="0935" class="ky kz in nd b gy nl ni l nj nk">   tons = float(args['tons'])</span><span id="cd15" class="ky kz in nd b gy nl ni l nj nk">   ton_miles = miles * tons</span></pre><p id="c42c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">if语句检查ton_miles是否为空。然后继续讨论英里和吨。并通过使用用户提供的数字来计算吨/英里。</p><pre class="mv mw mx my gt nc nd ne nf aw ng bi"><span id="5a5d" class="ky kz in nd b gy nh ni l nj nk">grams_of_CO2 = 161.8 * ton_miles</span><span id="92ed" class="ky kz in nd b gy nl ni l nj nk">metric_tons = grams_of_CO2 / 1000000</span><span id="2684" class="ky kz in nd b gy nl ni l nj nk">Emmisons = round(metric_tons, 2)</span></pre><p id="cbc4" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在我们开始计算碳足迹。通过使用博文中提到的环境保护基金的公式。<code class="fe nm nn no nd b">grams_of_CO2 = 161.8 * ton_miles </code>计算产生的二氧化碳克数。这是通过将吨/英里乘以碳系数来实现的。二氧化碳的克数然后被转换成公吨。这是通过将二氧化碳的克数除以1，000，000得出的。</p><p id="15e8" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><code class="fe nm nn no nd b">Emmisons = round(metric_tons, 2)</code>公吨四舍五入到小数点后两位。以避免尾随小数点。</p><pre class="mv mw mx my gt nc nd ne nf aw ng bi"><span id="eb1b" class="ky kz in nd b gy nh ni l nj nk">calculations = {‘Emmisons’: str(Emmisons) + ‘ metric tons CO2’}</span><span id="f4b1" class="ky kz in nd b gy nl ni l nj nk">return calculations, 201</span></pre><p id="8d70" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">排放显示在字典中。排放变量被更改为字符串。所以“公吨二氧化碳”这个词被附加在排放量的后面。</p><p id="983e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在，保存排放信息的计算变量被返回。状态代码为201。<a class="ae jz" href="https://httpstatuses.com/201" rel="noopener ugc nofollow" target="_blank">状态代码201 </a>表示请求已成功创建。</p><h1 id="ff1b" class="lw kz in bd la lx ly lz ld ma mb mc lg md me mf lj mg mh mi lm mj mk ml lp mm bi translated">使用邮递员</h1><p id="6207" class="pw-post-body-paragraph ka kb in kc b kd lr kf kg kh ls kj kk kl lt kn ko kp lu kr ks kt lv kv kw kx ig bi translated">为了测试API，我们将使用一个名为postman的程序。Postman是一个允许你使用各种HTTP方法测试API的程序。Postman有更多的功能，比如制作文档、自动化测试、设计API等等。但是我坚持使用put方法，这样我就可以向API发送输入。</p><p id="8ad0" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我将使用环境保护基金例子中提供的数字。这辆卡车已经行驶了1000英里，载重20短吨。按照网站和博客文章前面的所有步骤。它应该给出3.24公吨CO2的最终结果。</p><p id="67a1" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">使用Postman，我们向API的地址发送一个put方法。请求是JSON文件格式的原始主体数据。包含英里和吨。</p><figure class="mv mw mx my gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nq"><img src="../Images/2e021a83f6131a4361e3e8e76e8ebfb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*An8vLMPUBQX4WywwABAToQ.png"/></div></div></figure><p id="40cd" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在我们发出了请求:</p><figure class="mv mw mx my gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nr"><img src="../Images/ff6d5f206ad3ed807ea82f855df61870.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OX7lN7LHPtsxMw-Lv-zOFA.png"/></div></div></figure><p id="2150" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们得到正确的数字。我们还生成了一个201状态代码。</p><h1 id="7b10" class="lw kz in bd la lx ly lz ld ma mb mc lg md me mf lj mg mh mi lm mj mk ml lp mm bi translated">船舶货运旅程代码</h1><p id="263e" class="pw-post-body-paragraph ka kb in kc b kd lr kf kg kh ls kj kk kl lt kn ko kp lu kr ks kt lv kv kw kx ig bi translated">船只货运的法规允许更多的争论。这是因为在我开始掌握Flask-RESTful之后，我开始从公路货运类扩展。因此，船运费的代码允许更多的功能。新功能是允许用户在英制和公制中进行测量。</p><p id="e99a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这也是因为我用来计算的公式是欧式的。我在博文的开头提到过。</p><pre class="mv mw mx my gt nc nd ne nf aw ng bi"><span id="73a3" class="ky kz in nd b gy nh ni l nj nk">parser = reqparse.RequestParser()</span><span id="efe2" class="ky kz in nd b gy nl ni l nj nk">  parser.add_argument('miles', type=float)</span><span id="3edf" class="ky kz in nd b gy nl ni l nj nk">  parser.add_argument('km', type=float)</span><span id="cf03" class="ky kz in nd b gy nl ni l nj nk">  parser.add_argument('tonnes', type=float)</span><span id="b4ef" class="ky kz in nd b gy nl ni l nj nk">  parser.add_argument('km/tonnes', type=float)</span><span id="f613" class="ky kz in nd b gy nl ni l nj nk">  parser.add_argument('miles/tonnes', type=float)</span><span id="d96c" class="ky kz in nd b gy nl ni l nj nk">  args = parser.parse_args()</span></pre><p id="2990" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">其类型设置为float的参数。这样做是为了我不需要使用float函数将参数转换成十进制数。</p><pre class="mv mw mx my gt nc nd ne nf aw ng bi"><span id="c6ff" class="ky kz in nd b gy nh ni l nj nk">if args['miles'] is not None:</span><span id="f09b" class="ky kz in nd b gy nl ni l nj nk">  args['km'] = args['miles'] / 0.621371</span><span id="3b8a" class="ky kz in nd b gy nl ni l nj nk">  args['km/tonnes'] = args['km'] * args['tonnes']</span></pre><p id="458a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">该if语句检查miles参数是否有数据。然后将英里转换成公里。然后计算吨公里单位。将质量和距离相乘。</p><pre class="mv mw mx my gt nc nd ne nf aw ng bi"><span id="7c59" class="ky kz in nd b gy nh ni l nj nk">if args['miles/tonnes'] is not None:</span><span id="4ef4" class="ky kz in nd b gy nl ni l nj nk">  args['km/tonnes'] = args['miles/tonnes'] * 1.459972</span></pre><p id="9795" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">第二个if语句检查miles/tons是否不为空。然后将英里/吨转换成吨-公里。</p><pre class="mv mw mx my gt nc nd ne nf aw ng bi"><span id="4109" class="ky kz in nd b gy nh ni l nj nk">if args['km/tonnes'] is None:</span><span id="f26f" class="ky kz in nd b gy nl ni l nj nk">  args['km/tonnes'] = args['km'] * args['tonnes']</span></pre><p id="f20e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">下一个if语句检查km/Tony是否为空。如果是这样的话，公里/吨是用公里和吨来计算的。</p><pre class="mv mw mx my gt nc nd ne nf aw ng bi"><span id="e0bd" class="ky kz in nd b gy nh ni l nj nk">g_CO2_tonne_km = args['km/tonnes'] * 8</span><span id="a9b1" class="ky kz in nd b gy nl ni l nj nk">metric_tons = g_CO2_tonne_km / 1000000</span><span id="c387" class="ky kz in nd b gy nl ni l nj nk">Emmisons = round(metric_tons, 2)</span></pre><p id="e647" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">比如计算之前公路货运的碳足迹。使用碳系数8计算二氧化碳克数。由ECTA提供。(见本文开头)。然后将二氧化碳的克数除以一百万，转换成公吨。</p><p id="1b78" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">然后将排放量四舍五入到两位小数。</p><pre class="mv mw mx my gt nc nd ne nf aw ng bi"><span id="28b5" class="ky kz in nd b gy nh ni l nj nk">calculations = {'Emmisons': str(Emmisons) + ' tonnes of CO2'}</span><span id="627a" class="ky kz in nd b gy nl ni l nj nk">   return calculations, 201</span></pre><p id="7c6d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">该类返回计算结果。也是一个201状态代码。</p><p id="573a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">使用Postman，我们可以测试API。以ECTA模板中的深海集装箱为例。我们希望API返回4000吨二氧化碳。</p><p id="4363" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">将距离和重量输入邮递员，如下所示:</p><pre class="mv mw mx my gt nc nd ne nf aw ng bi"><span id="28f7" class="ky kz in nd b gy nh ni l nj nk">{</span><span id="ba38" class="ky kz in nd b gy nl ni l nj nk">  "km": 5000,</span><span id="9662" class="ky kz in nd b gy nl ni l nj nk">  "tonnes": 100000</span><span id="60f8" class="ky kz in nd b gy nl ni l nj nk">}</span></pre><p id="78d3" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们得到了这个结果:</p><figure class="mv mw mx my gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ns"><img src="../Images/0f1a6bb5b823d074b9c82eb546847e15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2u4nwJJRx9UxMoLRH6PNFQ.png"/></div></div></figure><p id="77aa" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">API给出了正确的数字。</p><h1 id="8d11" class="lw kz in bd la lx ly lz ld ma mb mc lg md me mf lj mg mh mi lm mj mk ml lp mm bi translated">使用python请求访问API</h1><p id="0d26" class="pw-post-body-paragraph ka kb in kc b kd lr kf kg kh ls kj kk kl lt kn ko kp lu kr ks kt lv kv kw kx ig bi translated">我将展示一个用户如何使用API的更实际的例子。通过使用python请求向API发送put方法。向API发送数据并获取它们的排放量。</p><pre class="mv mw mx my gt nc nd ne nf aw ng bi"><span id="55a7" class="ky kz in nd b gy nh ni l nj nk">import requests</span><span id="54ff" class="ky kz in nd b gy nl ni l nj nk">r = requests.put('http://127.0.0.1:5000/boat_freight', data={'km': 5000, 'tonnes': 100000})</span><span id="ff4a" class="ky kz in nd b gy nl ni l nj nk">print(r.status_code)</span><span id="ee66" class="ky kz in nd b gy nl ni l nj nk">print(r.json())</span></pre><p id="0907" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">运行代码会得到以下结果:</p><pre class="mv mw mx my gt nc nd ne nf aw ng bi"><span id="22a3" class="ky kz in nd b gy nh ni l nj nk">201</span><span id="6614" class="ky kz in nd b gy nl ni l nj nk">{'Emmisons': '4000.0 tonnes of CO2'}</span></pre><p id="9f23" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这很好。因此，用户可以简单地使用请求库并获得他们的碳足迹。只需几行代码。</p><h1 id="9aed" class="lw kz in bd la lx ly lz ld ma mb mc lg md me mf lj mg mh mi lm mj mk ml lp mm bi translated">丰富</h1><p id="db2f" class="pw-post-body-paragraph ka kb in kc b kd lr kf kg kh ls kj kk kl lt kn ko kp lu kr ks kt lv kv kw kx ig bi translated">这个API是一个非常基础的。所以，我想增加一些新功能，解决一些问题。其中一个主要问题是road fright功能没有公制系统支持。这在当时是有意义的，因为这是我制作的API的第一部分。但我认为支持公制和帝国将是一个好主意。</p><p id="54fa" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">第二个问题是，如果要为基本的运输实现一些东西。那么质量的测量将需要改变。例如，如果你从网上商店买几本书，它只有几公斤重。不是很多吨。这是API中实现的比例。因此，这是近期要考虑的事情。</p><h1 id="ae03" class="lw kz in bd la lx ly lz ld ma mb mc lg md me mf lj mg mh mi lm mj mk ml lp mm bi translated">结论</h1><p id="10ca" class="pw-post-body-paragraph ka kb in kc b kd lr kf kg kh ls kj kk kl lt kn ko kp lu kr ks kt lv kv kw kx ig bi translated">尽管在整个项目中，我一直使用我的本地主机作为API的服务器。如果你有兴趣在某种类型的产品中使用API，那么你可以亲自使用API。给我发了一条信息，所以我可以衡量一下对这项服务的兴趣。你可以在<a class="ae jz" href="https://github.com/tobiolabode/Flask_Carbon_API" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上查看该项目的代码。如果你觉得你可以添加功能的API，请随时发送拉我的方式请求。</p></div><div class="ab cl nt nu hr nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="ig ih ii ij ik"><div class="mv mw mx my gt oa"><a href="https://upbeat-teacher-3421.ck.page/875d4eafc9" rel="noopener  ugc nofollow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd io gy z fp of fr fs og fu fw im bi translated">喜欢你阅读的内容吗？</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">注册我的时事通讯。更多有用和有趣的内容</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">转换工具</p></div></div></div></a></div></div></div>    
</body>
</html>