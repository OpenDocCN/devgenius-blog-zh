<html>
<head>
<title>Gentle ContainerD on Windows Guide For You</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Windows 上的温柔集装箱指南</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/gentle-containerd-on-windows-guide-for-you-50d4a46daccf?source=collection_archive---------0-----------------------#2021-10-07">https://blog.devgenius.io/gentle-containerd-on-windows-guide-for-you-50d4a46daccf?source=collection_archive---------0-----------------------#2021-10-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/0417e722e59b53039be303107f4a2ce1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*r-WNCk642c1HEZp1"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">哈马·哈基在<a class="ae kc" href="https://unsplash.com/s/photos/container-window?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="7d8c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi lb translated"><span class="l lc ld le bm lf lg lh li lj di"> H </span>你有没有想过 Windows containerd 可以作为一个独立的服务来使用？最近发现 Windows Server 2022 发布了，ContainerD 也在今年达到了 Windows 上普遍可用的状态。</p><p id="2d79" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这篇文章将展示在没有 Docker Enterprise 的独立 Windows 服务器上安装和启动你自己的 Windows 容器的详细步骤。然后，您可以根据本指南来配置和理解具有多个 Windows worker 节点的混合 Kubernetes 集群。</p><h1 id="7d46" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">背景</h1><p id="5a99" class="pw-post-body-paragraph kd ke iq kf b kg mi ki kj kk mj km kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">如你所知，米兰蒂斯收购了 Docker Enterprise 部门，他们将 Docker Enterprise 更新为米兰蒂斯容器运行时。与此同时，Kubernetes 社区决定使用 Dockershim，所以他们不会支持 Dockershim 作为集群中的主要容器运行时。最终，这些变化影响了现有的 Windows 容器生态系统。</p><p id="93f7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果愿意，您可以将现有的 Docker 企业配置迁移到 Mirantis 容器运行时。但是在大多数情况下，人们会更喜欢基于 Kubernetes 的工作负载，而不是其他类型的容器编排平台。这种情况使得 ContainerD 取代了 Windows Server 容器主机中的 Docker Enterprise。</p><h1 id="a5b2" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">先决条件</h1><p id="3bcc" class="pw-post-body-paragraph kd ke iq kf b kg mi ki kj kk mj km kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">请确保在测试本文之前准备好以下项目。</p><ul class=""><li id="af90" class="mn mo iq kf b kg kh kk kl ko mp ks mq kw mr la ms mt mu mv bi translated">您应该使用 Windows Server 2022 LTSC。</li><li id="bd30" class="mn mo iq kf b kg mw kk mx ko my ks mz kw na la ms mt mu mv bi translated">至少需要 4gb 或更多系统内存。</li><li id="7061" class="mn mo iq kf b kg mw kk mx ko my ks mz kw na la ms mt mu mv bi translated">至少需要 16GiB 或更多的磁盘。</li><li id="9b2d" class="mn mo iq kf b kg mw kk mx ko my ks mz kw na la ms mt mu mv bi translated">您已经登录到本地管理员组。</li></ul><h1 id="64cc" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">配置容器 d</h1><p id="122a" class="pw-post-body-paragraph kd ke iq kf b kg mi ki kj kk mj km kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">首先，让我们激活与容器相关的特性。在此步骤中，您的服务器可能会重新启动，因此请保存您的数据并关闭您的应用。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="58c8" class="nk ll iq ng b gy nl nm l nn no">$RestartRequired = (Add-WindowsFeature -Name Containers)</span><span id="5019" class="nk ll iq ng b gy np nm l nn no">if ($RestartRequired.RestartNeeded) { Restart-Computer -Force }</span></pre><p id="cbf1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，下载最新版本的 ContainerD。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="168f" class="nk ll iq ng b gy nl nm l nn no">$ContainerDVersion = '1.5.5'<br/>curl.exe -LO "<a class="ae kc" href="https://github.com/containerd/containerd/releases/download/v${ContainerDVersion}/cri-containerd-cni-${ContainerDVersion}-windows-amd64.tar.gz" rel="noopener ugc nofollow" target="_blank">https://github.com/containerd/containerd/releases/download/v${ContainerDVersion}/cri-containerd-cni-${ContainerDVersion}-windows-amd64.tar.gz</a>"<br/>tar.exe xvzf ".\cri-containerd-cni-${ContainerDVersion}-windows-amd64.tar.gz"<br/>del ".\cri-containerd-cni-${ContainerDVersion}-windows-amd64.tar.gz"</span></pre><p id="f30c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将存档文件解压到程序文件目录中，制作 CNI 插件目录布局，并使其适合 ContainerD。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="37e2" class="nk ll iq ng b gy nl nm l nn no">mkdir -force "$env:ProgramFiles\containerd"<br/>mv .\*.exe "$env:ProgramFiles\containerd"<br/>mv .\cni "$env:ProgramFiles\containerd"<br/>mkdir "$env:ProgramFiles\containerd\cni\bin" -force<br/>mv "$env:ProgramFiles\containerd\cni\*.exe" "$env:ProgramFiles\containerd\cni\bin"</span></pre><p id="5be9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">制作容器的默认配置文件。幸运的是，ContainerD 二进制文件可以用默认值生成它自己描述的整个配置文件，所以我们可以只呈现和放置它。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="a37b" class="nk ll iq ng b gy nl nm l nn no">&amp; "$env:ProgramFiles\containerd\containerd.exe" config default | Out-File "$env:ProgramFiles\containerd\config.toml" -Encoding ascii</span></pre><p id="780c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，用记事本或您喜欢的文本编辑器打开配置文件。我们需要更新配置文件来纠正暂停图像引用。由于 Windows 主机的不兼容暂停映像，低于 3.5 版将导致 pod 初始化失败。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="5d38" class="nk ll iq ng b gy nl nm l nn no">...<br/>[plugins]</span><span id="9863" class="nk ll iq ng b gy np nm l nn no">[plugins."io.containerd.gc.v1.scheduler"]<br/>    deletion_threshold = 0<br/>    mutation_threshold = 100<br/>    pause_threshold = 0.02<br/>    schedule_delay = "0s"<br/>    startup_delay = "100ms"</span><span id="998c" class="nk ll iq ng b gy np nm l nn no">[plugins."io.containerd.grpc.v1.cri"]<br/>    disable_apparmor = false<br/>    disable_cgroup = false<br/>    disable_hugetlb_controller = false<br/>    disable_proc_mount = false<br/>    disable_tcp_service = true<br/>    enable_selinux = false<br/>    enable_tls_streaming = false<br/>    ignore_image_defined_volumes = false<br/>    max_concurrent_downloads = 3<br/>    max_container_log_line_size = 16384<br/>    netns_mounts_under_state_dir = false<br/>    restrict_oom_score_adj = false<br/>    sandbox_image = "k8s.gcr.io/pause:3.6" # &lt;- Change the tag version from 3.5 to higher version (I recommend 3.6)<br/>...</span></pre><p id="7161" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们为 Windows Defender 添加一个例外。Windows 容器依赖于内核的 API，就像 Linux 一样，Windows Defender 通过挂接设备驱动程序的调用来扫描所有文件内容。这使得容器的 I/O 性能非常糟糕，所以我们需要进行平滑的配置。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="b05f" class="nk ll iq ng b gy nl nm l nn no">Add-MpPreference -ExclusionProcess "$env:ProgramFiles\containerd\containerd.exe"</span></pre><p id="14a0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们可以注册 ContainerD 服务并启动它。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="ef37" class="nk ll iq ng b gy nl nm l nn no">&amp; "$env:ProgramFiles\containerd\containerd.exe" --register-service</span><span id="0e6e" class="nk ll iq ng b gy np nm l nn no">Start-Service containerd</span></pre><h1 id="c003" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">配置 HNS NAT 网络</h1><p id="eeee" class="pw-post-body-paragraph kd ke iq kf b kg mi ki kj kk mj km kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">众所周知，Windows 提供了自己的容器网络基础设施，称为 HNS(主机网络服务)。ContainerD 与网络特性解耦，这些特性被归入不同的插件类型，称为 CNI。</p><p id="c47b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本指南将选择内置的 NAT CNI 插件，并使 NAT CNI 插件正确工作。</p><p id="c0a8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Windows 服务器中没有内置的 HNS 控制命令。所以我们需要下载 HNS PowerShell 模块并导入。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="a1da" class="nk ll iq ng b gy nl nm l nn no">curl.exe -LO '<a class="ae kc" href="https://raw.githubusercontent.com/microsoft/SDN/master/Kubernetes/windows/hns.psm1'" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/microsoft/SDN/master/Kubernetes/windows/hns.psm1'</a><br/>Import-Module .\hns.psm1</span></pre><p id="1d41" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，让我们定义一个虚拟网络子网并注册它。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="ebd6" class="nk ll iq ng b gy nl nm l nn no">$subnet='10.0.0.0/16'<br/>$gateway='10.0.0.1'<br/>New-HnsNetwork -Type NAT -AddressPrefix $subnet -Gateway $gateway -Name "nat"</span></pre><p id="e331" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，在创建新的 pod 之前，重写 NAT 插件配置文件。CNI 是一个独立的插件，与 ContainerD 的运行状态无关，所以我们只需放入配置文件，无需重启 ContainerD 服务。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="bbed" class="nk ll iq ng b gy nl nm l nn no">@"<br/>{<br/>    "cniVersion": "0.2.0",<br/>    "name": "nat",<br/>    "type": "nat",<br/>    "master": "Ethernet",<br/>    "ipam": {<br/>        "subnet": "$subnet",<br/>        "routes": [<br/>            {<br/>                "gateway": "$gateway"<br/>            }<br/>        ]<br/>    },<br/>    "capabilities": {<br/>        "portMappings": true,<br/>        "dns": true<br/>    }<br/>}<br/>"@ | Set-Content "$env:ProgramFiles\containerd\cni\conf\0-containerd-nat.conf" -Force</span></pre><h1 id="0cda" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">配置 CRICTL 客户端工具</h1><p id="20f9" class="pw-post-body-paragraph kd ke iq kf b kg mi ki kj kk mj km kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">要访问 ContainerD 并将其与 CRI(容器运行时接口)合并，我们需要 CRICTL 客户端工具。CTR 工具也是可用的，但是这个工具不使用 CRI，所以用 CTR 创建的容器可能没有附加网络接口。</p><p id="914d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，从 GitHub 下载 CRICTL 工具。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="d621" class="nk ll iq ng b gy nl nm l nn no">$CriCtlVersion = '1.22.0'<br/>curl.exe -LO "<a class="ae kc" href="https://github.com/kubernetes-sigs/cri-tools/releases/download/v${CriCtlVersion}/crictl-v${CriCtlVersion}-windows-amd64.tar.gz" rel="noopener ugc nofollow" target="_blank">https://github.com/kubernetes-sigs/cri-tools/releases/download/v${CriCtlVersion}/crictl-v${CriCtlVersion}-windows-amd64.tar.gz</a>"<br/>tar.exe xvzf ".\crictl-v${CriCtlVersion}-windows-amd64.tar.gz"<br/>del ".\crictl-v${CriCtlVersion}-windows-amd64.tar.gz"</span></pre><p id="e4bc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，在您的用户配置文件目录中创建一个 CRICTL 配置文件。在 Windows 中，ContainerD 将通过命名管道而不是套接字打开控制通道。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="b47d" class="nk ll iq ng b gy nl nm l nn no">mkdir -Force "$home\.crictl"</span><span id="816e" class="nk ll iq ng b gy np nm l nn no">@"<br/>runtime-endpoint: npipe://./pipe/containerd-containerd<br/>image-endpoint: npipe://./pipe/containerd-containerd<br/>timeout: 10<br/>"@ | Set-Content "$home\.crictl\crictl.yaml" -Force</span></pre><p id="2527" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您可以使用下面的命令测试配置文件。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="64ac" class="nk ll iq ng b gy nl nm l nn no">.\crictl.exe info</span></pre><h1 id="9bb6" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">最后一步:创建并运行 IIS 容器</h1><p id="a5b5" class="pw-post-body-paragraph kd ke iq kf b kg mi ki kj kk mj km kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">漫长的旅程到此结束！如果您遵循了之前的所有步骤，现在您可以创建并运行 IIS 容器了。</p><p id="7d0f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">开始之前，我们需要准备一些工件来创建一个 pod 和一个容器。</p><p id="cdca" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，创建一个保存日志的目录。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="b09c" class="nk ll iq ng b gy nl nm l nn no">mkdir -Force \logs</span></pre><p id="49bd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，定义一个 pod 配置文件。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="c80c" class="nk ll iq ng b gy nl nm l nn no">@"<br/>metadata:<br/>  attempt: 1<br/>  name: sample-sandbox<br/>  namespace: default<br/>  uid: $((New-Guid).ToString("N").Substring(0, 25)).log<br/>log_directory: /logs<br/>windows:<br/>  namespaces:<br/>    options: {}<br/>"@ | Set-Content "pod-config.yaml" -Force</span></pre><p id="fcb1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将创建的 pod 配置文件传递给 CRICTL。该工具将通过 CRI 与 ContainerD 通信，并返回创建的 pod id。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="33ff" class="nk ll iq ng b gy nl nm l nn no">$PodId = (.\crictl.exe runp --runtime runhcs-wcow-process .\pod-config.yaml)<br/>.\crictl.exe pods $PodId</span></pre><p id="0ff1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">提取 IIS 映像。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="3d6e" class="nk ll iq ng b gy nl nm l nn no">.\crictl.exe pull mcr.microsoft.com/windows/servercore/iis:windowsservercore-ltsc2022</span></pre><p id="2da1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，创建一个容器配置文件。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="46c8" class="nk ll iq ng b gy nl nm l nn no">@"<br/>metadata:<br/>  name: simple-server<br/>image:<br/>  image: mcr.microsoft.com/windows/servercore/iis:windowsservercore-ltsc2022<br/>log_path: $((New-Guid).ToString("N").Substring(0, 8)).log<br/>ports:<br/>  containerPort: 80<br/>"@ | Set-Content "simple-server.yaml" -Force</span></pre><p id="d73b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，将创建的容器配置文件传递给 CRICTL 工具，并获取容器 ID。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="4984" class="nk ll iq ng b gy nl nm l nn no">$ContainerId = (.\crictl.exe create $PodId .\simple-server.yaml .\pod-config.yaml)<br/>.\crictl.exe start $ContainerId</span></pre><p id="c99e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要检查 IP 地址，请运行以下命令。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="49b3" class="nk ll iq ng b gy nl nm l nn no">.\crictl.exe exec -i $ContainerId ipconfig<br/>curl.exe '&lt;IPAddressOfContainer&gt;'</span></pre><p id="0cf1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，您可能会发现 IIS 容器返回其欢迎页面代码。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="12bb" class="nk ll iq ng b gy nl nm l nn no">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "<a class="ae kc" href="http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd" rel="noopener ugc nofollow" target="_blank">http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd</a>"&gt;<br/>&lt;html ae kc" href="http://www.w3.org/1999/xhtml" rel="noopener ugc nofollow" target="_blank"&gt;http://www.w3.org/1999/xhtml"&gt;<br/>&lt;head&gt;<br/>&lt;meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /&gt;<br/>&lt;title&gt;IIS Windows Server&lt;/title&gt;<br/>&lt;style type="text/css"&gt;<br/>&lt;!--<br/>body {<br/>        color:#000000;<br/>        background-color:#0072C6;<br/>        margin:0;<br/>}</span><span id="1558" class="nk ll iq ng b gy np nm l nn no">#container {<br/>        margin-left:auto;<br/>        margin-right:auto;<br/>        text-align:center;<br/>        }</span><span id="85a3" class="nk ll iq ng b gy np nm l nn no">a img {<br/>        border:none;<br/>}</span><span id="0b96" class="nk ll iq ng b gy np nm l nn no">--&gt;<br/>&lt;/style&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>&lt;div id="container"&gt;<br/>&lt;a href="<a class="ae kc" href="http://go.microsoft.com/fwlink/?linkid=66138&amp;amp;clcid=0x409" rel="noopener ugc nofollow" target="_blank">http://go.microsoft.com/fwlink/?linkid=66138&amp;amp;clcid=0x409</a>"&gt;&lt;img src="iisstart.png" alt="IIS" width="960" height="600" /&gt;&lt;/a&gt;<br/>&lt;/div&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><h1 id="6b94" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">一些警告</h1><p id="d454" class="pw-post-body-paragraph kd ke iq kf b kg mi ki kj kk mj km kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">可悲的是，大多数与 ContainerD 相关的项目严重依赖 buildkit(尤其是 buildkitd)。然而，buildkitd 不是为 Windows 容器生态系统开发的。因此，您现在无法在这种配置下构建自己的 Windows 容器映像。</p><h1 id="2e47" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">结论</h1><p id="be09" class="pw-post-body-paragraph kd ke iq kf b kg mi ki kj kk mj km kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">ContainerD 迟早会广泛地出现在 Windows 容器生态系统中。与 Linux 相比，Windows ContainerD 使用最新的 HCS v2 API 来支持更多等效的容器功能。(例如，在 HCS v2 中，您可以挂载单个文件，而不是一个目录。)</p><p id="3cfd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，微软决定他们不会发布半年一次的渠道发布，而只保留几年的长期服务渠道。这一决定将为 DevOps 工程师和现有的 Windows 应用程序开发人员提供一个更加稳定、直观和简单的容器平台。</p><p id="9c5c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我认为有必要研究一下这个新的 Windows 容器平台，使您的传统 Windows 服务器应用程序现代化。</p><h1 id="bbbf" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">参考</h1><ul class=""><li id="a7d2" class="mn mo iq kf b kg mi kk mj ko nq ks nr kw ns la ms mt mu mv bi translated"><a class="ae kc" href="https://www.jamessturtevant.com/posts/Windows-Containers-on-Windows-10-without-Docker-using-Containerd/" rel="noopener ugc nofollow" target="_blank">https://www . jamesturtevant . com/posts/Windows-Containers-on-Windows-10-without-Docker-using-container d/</a></li><li id="9391" class="mn mo iq kf b kg mw kk mx ko my ks mz kw na la ms mt mu mv bi translated"><a class="ae kc" href="https://kubernetes.io/docs/tasks/debug-application-cluster/crictl/" rel="noopener ugc nofollow" target="_blank">https://kubernetes . io/docs/tasks/debug-application-cluster/crictl/</a></li><li id="88e5" class="mn mo iq kf b kg mw kk mx ko my ks mz kw na la ms mt mu mv bi translated"><a class="ae kc" href="https://jayunit100.blogspot.com/2020/12/debugging-containerd-on-windows.html?view=mosaic" rel="noopener ugc nofollow" target="_blank">https://Jay unit 100 . blogspot . com/2020/12/debugging-container d-on-windows . html？视图=马赛克</a></li><li id="7962" class="mn mo iq kf b kg mw kk mx ko my ks mz kw na la ms mt mu mv bi translated"><a class="ae kc" href="https://kubernetes.io/ko/docs/setup/production-environment/windows/user-guide-windows-containers/" rel="noopener ugc nofollow" target="_blank">https://kubernetes . io/ko/docs/setup/production-environment/windows/user-guide-windows-containers/</a></li></ul></div></div>    
</body>
</html>