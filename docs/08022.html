<html>
<head>
<title>Handling Bad Records Using “Parsing Modes” in Databricks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用数据块中的“解析模式”处理不良记录</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/handling-bad-records-using-parsing-modes-in-databricks-ce3946f3191e?source=collection_archive---------7-----------------------#2022-05-11">https://blog.devgenius.io/handling-bad-records-using-parsing-modes-in-databricks-ce3946f3191e?source=collection_archive---------7-----------------------#2022-05-11</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><h1 id="49ab" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">数据的正确性</h1><p id="2565" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">当<strong class="kk io"> <em class="lg">从基于<strong class="kk io"> <em class="lg">文件的数据源</em> </strong>中读取数据</em> </strong>并指定<strong class="kk io"> <em class="lg">模式</em> </strong>时，有可能<strong class="kk io"><em class="lg"/></strong><strong class="kk io"><em class="lg">数据</em></strong><strong class="kk io"><em class="lg">文件</em></strong><strong class="kk io"><em class="lg">与</em></strong><strong class="kk io"><em class="lg">模式</em></strong>不匹配例如，一个<strong class="kk io"> <em class="lg">字段</em></strong><strong class="kk io"><em class="lg">年龄</em></strong><strong class="kk io"><em class="lg">包含整数</em> </strong>，将<strong class="kk io"> <em class="lg">不解析</em> </strong>为<strong class="kk io"> <em class="lg">字符串</em> </strong>。</p><figure class="li lj lk ll gt lm gh gi paragraph-image"><div class="gh gi lh"><img src="../Images/4d32c4dd0f69b0792619329c300aea77.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*-BtH3o9gauaNOK-DXQgbjw.png"/></div></figure><p id="c17f" class="pw-post-body-paragraph ki kj in kk b kl lp kn ko kp lq kr ks kt lr kv kw kx ls kz la lb lt ld le lf ig bi translated">后果取决于<strong class="kk io"> <em class="lg">解析器</em> </strong>运行的<strong class="kk io"> <em class="lg">模式</em> </strong>。到<strong class="kk io"> <em class="lg">设置</em></strong><strong class="kk io"><em class="lg">模式</em> </strong>，<strong class="kk io"> <em class="lg">模式</em></strong><strong class="kk io"><em class="lg">选项</em> </strong>是<strong class="kk io"> <em class="lg">使用的</em> </strong> -</p><p id="3036" class="pw-post-body-paragraph ki kj in kk b kl lp kn ko kp lq kr ks kt lr kv kw kx ls kz la lb lt ld le lf ig bi translated"><strong class="kk io"> <em class="lg"> A)许可(默认):</em></strong><strong class="kk io"><em class="lg"/></strong><strong class="kk io"><em class="lg">模式</em> </strong>，<strong class="kk io"> <em class="lg">空值</em></strong><strong class="kk io"><em class="lg">插入</em> </strong>为<strong class="kk io"> <em class="lg">字段</em> </strong>表示可能<strong class="kk io"> <em class="lg">不<em class="lg"/></em></strong></p><figure class="li lj lk ll gt lm gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi lu"><img src="../Images/9f9160ed0bd95edf84a7d38ada934d79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wvVa5aG_RwRfHkJs2Y4rBg.png"/></div></div></figure><p id="853e" class="pw-post-body-paragraph ki kj in kk b kl lp kn ko kp lq kr ks kt lr kv kw kx ls kz la lb lt ld le lf ig bi translated">输出-</p><figure class="li lj lk ll gt lm gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/51bf91ec2e79be3ca295916aed94e6c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*JPRaov-Mslrzrj2R_gTLeQ.png"/></div></figure><p id="50ba" class="pw-post-body-paragraph ki kj in kk b kl lp kn ko kp lq kr ks kt lr kv kw kx ls kz la lb lt ld le lf ig bi translated">在<strong class="kk io"><em class="lg"/></strong><strong class="kk io"><em class="lg">模式</em> </strong>中，有<strong class="kk io"> <em class="lg">可能的</em> </strong>到<strong class="kk io"> <em class="lg">检查</em></strong><strong class="kk io"><em class="lg">行的</em> </strong>可能的<strong class="kk io"> <em class="lg">不是</em> </strong>是为此，可以将<strong class="kk io"><em class="lg">_ corrupt _ record</em></strong><strong class="kk io"><em class="lg">列</em></strong><strong class="kk io"><em class="lg">中的</em> </strong>添加到<strong class="kk io"><em class="lg"/></strong>模式中。</p><p id="aa1a" class="pw-post-body-paragraph ki kj in kk b kl lp kn ko kp lq kr ks kt lr kv kw kx ls kz la lb lt ld le lf ig bi translated">在下面的 CSV 文件中，字段<strong class="kk io"><em class="lg"/></strong><strong class="kk io"><em class="lg">姓</em></strong><strong class="kk io"><em class="lg">包含字符串</em> </strong>，将<strong class="kk io"> <em class="lg">不解析</em> </strong>为<strong class="kk io"> <em class="lg">整数</em> </strong>。同理，<strong class="kk io"> <em class="lg">字段</em></strong><strong class="kk io"><em class="lg">年龄</em></strong><strong class="kk io"><em class="lg">包含整数</em> </strong>，将<strong class="kk io"> <em class="lg">不解析</em> </strong>为<strong class="kk io"> <em class="lg">字符串</em> </strong>。</p><figure class="li lj lk ll gt lm gh gi paragraph-image"><div class="gh gi lh"><img src="../Images/478115d45aaf80ea1e2f55effaaa8492.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*Cz1XcVO7RiUc26gbHQgbKA.png"/></div></figure><p id="87ac" class="pw-post-body-paragraph ki kj in kk b kl lp kn ko kp lq kr ks kt lr kv kw kx ls kz la lb lt ld le lf ig bi translated">将<strong class="kk io"><em class="lg"/></strong>、将<strong class="kk io"> <em class="lg">读取为</em></strong><strong class="kk io"><em class="lg">CSV 文件</em> </strong>使用<strong class="kk io"><em class="lg"/></strong><strong class="kk io"><em class="lg">模式</em> </strong>与<strong class="kk io"> <em class="lg">不正确解析的数据</em> </strong>作为另一个<strong class="kk io"> <em class="lg">列</em> </strong></p><figure class="li lj lk ll gt lm gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi lu"><img src="../Images/22c7caefd52cb247b2b78ebc2c73427d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3ovIIaTWoQP5viGaMXj0ag.png"/></div></div></figure><p id="6129" class="pw-post-body-paragraph ki kj in kk b kl lp kn ko kp lq kr ks kt lr kv kw kx ls kz la lb lt ld le lf ig bi translated">输出-</p><figure class="li lj lk ll gt lm gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi ma"><img src="../Images/d538eeb2fd2968678cddf24a9cddb0ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e1XnAo6XutIe4ezG1FkVKQ.png"/></div></div></figure><p id="384c" class="pw-post-body-paragraph ki kj in kk b kl lp kn ko kp lq kr ks kt lr kv kw kx ls kz la lb lt ld le lf ig bi translated">“<strong class="kk io"><em class="lg">_ corrupt _ record</em></strong>”<strong class="kk io"><em class="lg">列包含空</em> </strong>为<strong class="kk io"> <em class="lg">行</em> </strong>，<strong class="kk io"> <em class="lg">没有格式错误的数据</em> </strong>。</p><p id="619c" class="pw-post-body-paragraph ki kj in kk b kl lp kn ko kp lq kr ks kt lr kv kw kx ls kz la lb lt ld le lf ig bi translated">另一方面，<strong class="kk io"><em class="lg">_ corrupt _ record</em></strong><strong class="kk io"><em class="lg">列包含了</em> </strong> <strong class="kk io"> <em class="lg">所有</em></strong><strong class="kk io"><em class="lg">格式错误的数据</em></strong><strong class="kk io"><em class="lg"/></strong>(<strong class="kk io"><em class="lg">)；</em> </strong>)为<strong class="kk io"> <em class="lg">行</em> </strong>、<strong class="kk io"><em class="lg"/></strong>。</p><p id="91bf" class="pw-post-body-paragraph ki kj in kk b kl lp kn ko kp lq kr ks kt lr kv kw kx ls kz la lb lt ld le lf ig bi translated"><strong class="kk io"><em class="lg">B)drop deformable:<strong class="kk io"><em class="lg">中的</em></strong>drop deformable</em></strong><strong class="kk io"><em class="lg">模式</em> </strong>，包含<strong class="kk io"> <em class="lg">字段</em> </strong>的行，可能会被<strong class="kk io"><em class="lg"/></strong><strong class="kk io"><em class="lg">正确解析</em></strong></p><figure class="li lj lk ll gt lm gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi lu"><img src="../Images/775a1ad59ece5d8efb7a2edf535ff0d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CfpLay0qckadIoTC0DOcRA.png"/></div></div></figure><p id="f6a7" class="pw-post-body-paragraph ki kj in kk b kl lp kn ko kp lq kr ks kt lr kv kw kx ls kz la lb lt ld le lf ig bi translated">输出-</p><figure class="li lj lk ll gt lm gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/e62b721bc4979be36e1e97f4a996cd78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*tK4lGrNBCoq3Nddfc6UQjA.png"/></div></figure><p id="8834" class="pw-post-body-paragraph ki kj in kk b kl lp kn ko kp lq kr ks kt lr kv kw kx ls kz la lb lt ld le lf ig bi translated"><strong class="kk io"><em class="lg">C)fail fast:</em></strong><strong class="kk io"><em class="lg">fail fast</em></strong><strong class="kk io"><em class="lg">模式</em></strong><strong class="kk io"><em class="lg">Apache Spark 中止</em></strong><strong class="kk io"><em class="lg">读取</em></strong><strong class="kk io"><em class="lg">异常</em></strong><strong class="kk io"><em class="lg">如果</em> </strong>任何<strong class="kk io"> <em class="lg">畸形数据</em></strong></p><figure class="li lj lk ll gt lm gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi lu"><img src="../Images/69b02a3433d0de3fe9e86af2a8858a21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mHgQGDmZ0Tn6j5RfU8tPJA.png"/></div></div></figure><p id="26ed" class="pw-post-body-paragraph ki kj in kk b kl lp kn ko kp lq kr ks kt lr kv kw kx ls kz la lb lt ld le lf ig bi translated">输出-</p><figure class="li lj lk ll gt lm gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi lu"><img src="../Images/ba99c548a2340a43a72089fd9d304fe2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KI33bG5585aEf34ozFOB6A.png"/></div></div></figure></div></div>    
</body>
</html>