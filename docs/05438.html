<html>
<head>
<title>Google Sheet API Integration with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Google Sheet API 与 Python 的集成</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/google-sheet-api-integration-with-python-1793795a9bc4?source=collection_archive---------1-----------------------#2021-08-11">https://blog.devgenius.io/google-sheet-api-integration-with-python-1793795a9bc4?source=collection_archive---------1-----------------------#2021-08-11</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="012e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">大家好！我希望一切都很好，今天我们将了解 google sheets 与 Python 编程语言的集成，并进行基本的 CRUD 操作。好的，我们开始吧！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/4f7d23c48dc7d8ec97c4da0d6c692ac9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*y8OyNrHVKPr1BfAUhm6PUg.png"/></div></figure><p id="a202" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">谷歌工作表</strong></p><p id="b0b2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">谷歌工作表是基于云的电子表格，是谷歌的产品之一。我们可以用它来进行数据分析、迷你数据存储等。在这里，我们将把这个 Google sheet 与 python 集成在一起，并从 Google cloud console 使用 Google sheet 和 Google Drive API 来执行一些基本操作。</p><p id="2428" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">谷歌云控制台中的流程</strong></p><p id="0a0b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">第一步:使用这个链接【https://console.cloud.google.com/ T4】进入谷歌控制台并登录</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi kr"><img src="../Images/6ddfac989059305da770b5d44f860971.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KrrHeYNyHE6mD1qF8QBeeA.png"/></div></div></figure><p id="892e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">第二步:登录后，开始<strong class="jm io">创建新项目</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi kr"><img src="../Images/d53af591f7589c4587a831cbbbe1a570.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n3kS5R_L9u_WTGFf2uf-0w.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi kr"><img src="../Images/6e7025f6dd42c1cbf5272b935061ab72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_zTb_-_bRiPP_oh3Yysmmw.png"/></div></div></figure><p id="b6c1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">步骤 3:转到<strong class="jm io"> API 和服务</strong></p><p id="8a36" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">第 4 步:去图书馆选择<strong class="jm io"> google sheets API </strong>并启用它</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi kr"><img src="../Images/9329f0cea248f3afac2abee75a1d172a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8WpFtutICwrbT-EE22JsXg.png"/></div></div></figure><p id="afb2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">第五步:去图书馆选择<strong class="jm io"> Google Drive API </strong>并启用它</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi kr"><img src="../Images/9d0b88fd71db2e881b3112bb42ea8220.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U2Wvki3yIS_ir9dHNZeymw.png"/></div></div></figure><p id="d041" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">第 6 步:返回 API 服务，点击凭证并选择<strong class="jm io">服务帐户创建</strong>栏</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi kr"><img src="../Images/62231f2b425019374878ea11dfa3d89b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wDnVeie96NS_53q6_CHLcQ.png"/></div></div></figure><p id="d382" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">步骤 6.1:填写所有服务帐户详细信息</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi kr"><img src="../Images/296e5a9c9f4977de17204a89fd74374a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u0QqrJ8dVssSYG-KKu9Qqw.png"/></div></div></figure><p id="f372" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">第 6.2 步:在<strong class="jm io">授予该服务帐户访问</strong>项目的权限中，选择角色为<strong class="jm io">“项目”</strong>，选择<strong class="jm io">“编辑或所有者”</strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi kr"><img src="../Images/3e7860ab9284dbd46685275828e97d4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wBDAeMo8O4EtNa_3GEHGpw.png"/></div></div></figure><blockquote class="kw kx ky"><p id="ad9c" class="jk jl kz jm b jn jo jp jq jr js jt ju la jw jx jy lb ka kb kc lc ke kf kg kh ig bi translated"><strong class="jm io">编辑器</strong>:编辑文件的权限</p><p id="41c4" class="jk jl kz jm b jn jo jp jq jr js jt ju la jw jx jy lb ka kb kc lc ke kf kg kh ig bi translated"><strong class="jm io">所有者</strong>:创建、删除和编辑文件的权限</p></blockquote><p id="78d3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">第 7 步:点击您可以在<strong class="jm io">服务账户空间</strong>看到的电子邮件</p><blockquote class="kw kx ky"><p id="b77f" class="jk jl kz jm b jn jo jp jq jr js jt ju la jw jx jy lb ka kb kc lc ke kf kg kh ig bi translated">邮件是这样存在的<strong class="jm io">xyz@true-winter-322614.iam.gserviceaccount.com</strong></p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi kr"><img src="../Images/d56dee4dc5a265f234412dacd441e8b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BHnTh-zON4L3Ae_jJEwtIw.png"/></div></div></figure><p id="0358" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">第八步:点击<strong class="jm io">键</strong>，从<strong class="jm io">“添加键”</strong>下拉菜单中选择<strong class="jm io">“创建新键”</strong>选项。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi kr"><img src="../Images/7998f161d314d6f5c689dff8e01e5d9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LXou9RA5NVC6p6GAvFKknQ.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi kr"><img src="../Images/b7610535fd147f7745a56256cb3448a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_DBa7flClzIOy9wxnl7-0g.png"/></div></div></figure><blockquote class="kw kx ky"><p id="a647" class="jk jl kz jm b jn jo jp jq jr js jt ju la jw jx jy lb ka kb kc lc ke kf kg kh ig bi translated">它会自动在我们的操作系统中下载 JSON 文件</p></blockquote><p id="7c74" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">第九步:然后关闭它，回到上一页，复制邮件并粘贴到你的剪贴板或记事本中，以备将来使用</p><p id="2b93" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">谷歌表单中的流程</strong></p><p id="a6b6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在 Google Cloud Console 中完成上述流程后，下面是 google sheet 中的下一个流程。</p><p id="baa6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">步骤 1:使用这个链接创建一个 Google 工作表</p><blockquote class="kw kx ky"><p id="aa97" class="jk jl kz jm b jn jo jp jq jr js jt ju la jw jx jy lb ka kb kc lc ke kf kg kh ig bi translated"><a class="ae kq" href="https://docs.google.com/spreadsheets/u/0/" rel="noopener ugc nofollow" target="_blank">https://docs.google.com/spreadsheets/</a></p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi kr"><img src="../Images/db160b6cca20d208ac84999fef5f9a17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8RmC7mPJYLjrH3q0jDFCDw.png"/></div></div></figure><p id="1edb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">第二步:在你的表格字段中写一些你想要的东西，如 ID，姓名，电子邮件等。</p><p id="2bb1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">第三步:点击右上角的分享按钮<strong class="jm io">将复制的邮箱地址</strong>粘贴到那里。然后单击完成。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi kr"><img src="../Images/ad8581a3cfea4b4130f61027bd292f3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jcS8pDuaGCzYTm10k7WZEA.png"/></div></div></figure><blockquote class="kw kx ky"><p id="93fd" class="jk jl kz jm b jn jo jp jq jr js jt ju la jw jx jy lb ka kb kc lc ke kf kg kh ig bi translated">如有疑问，请参考流程 1 的第 9 步</p></blockquote><p id="aac4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">代码编辑器中的过程</strong></p><p id="4c93" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">到目前为止，我们已经完成了 API 创建和工作表创建，现在我们将编写一个 python 程序来完成 Google sheet 中的一些基本操作。</p><p id="a12c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">转到您最喜欢的代码编辑器</p><p id="dd57" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">步骤 1:安装一个名为<strong class="jm io"> gspread </strong>的 python 包</p><p id="2d66" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">第二步:安装一个名为<strong class="jm io"> oauth2client </strong>的 python 包</p><p id="9d4a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">第三步:之后写代码</p><p id="add8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">第四步:将下载的 JSON 文件保存到你的工作目录中，例如<strong class="jm io"> Creds.json </strong></p><p id="0743" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">文件名-Main.py </strong></p><pre class="kj kk kl km gt ld le lf lg aw lh bi"><span id="9ad2" class="li lj in le b gy lk ll l lm ln">import gspread</span><span id="75b4" class="li lj in le b gy lo ll l lm ln">from oauth2client.service_account import ServiceAccountCredentials</span><span id="af57" class="li lj in le b gy lo ll l lm ln">def integrate(idno,name,email,phone,created_on,updated_on):<br/>     scope=   ["https://spreadsheets.google.com/feeds",'https://www.googleapis.com/auth/spreadsheets',"https://www.googleapis.com/auth/drive.file","https://www.googleapis.com/auth/drive"]</span><span id="7a8a" class="li lj in le b gy lo ll l lm ln">credentials=ServiceAccountCredentials.from_json_keyfile_name('creds.json',scope)</span><span id="1522" class="li lj in le b gy lo ll l lm ln">      gc=gspread.authorize(credentials)</span><span id="9fb0" class="li lj in le b gy lo ll l lm ln">      wks=gc.open('Google Sheet Name').sheet1</span><span id="8187" class="li lj in le b gy lo ll l lm ln">      try:</span><span id="195f" class="li lj in le b gy lo ll l lm ln">       wks.append_row([idno,name,email,phone,created_on,updated_on])</span><span id="17e1" class="li lj in le b gy lo ll l lm ln">   #[idno,name,email,phone,created_on,updated_on] google sheet field    #names.</span><span id="2e92" class="li lj in le b gy lo ll l lm ln">        print("Inserted Successfully !")</span><span id="3a40" class="li lj in le b gy lo ll l lm ln">      except:<br/>          print("Error Occurred")</span><span id="4c43" class="li lj in le b gy lo ll l lm ln">   return</span><span id="49f7" class="li lj in le b gy lo ll l lm ln">#Getting Input from user</span><span id="e55e" class="li lj in le b gy lo ll l lm ln">idno=int(input("Enter the id:"))</span><span id="2d42" class="li lj in le b gy lo ll l lm ln">name=input("Enter the Name:")</span><span id="9b03" class="li lj in le b gy lo ll l lm ln">email=input("Enter the Email:")</span><span id="34c0" class="li lj in le b gy lo ll l lm ln">phone=int(input("Enter the phone number:"))</span><span id="2200" class="li lj in le b gy lo ll l lm ln">created_on=str(input("Created on:"))</span><span id="49f3" class="li lj in le b gy lo ll l lm ln">updated_on=str(input("Updated on:"))</span><span id="928a" class="li lj in le b gy lo ll l lm ln">#Function Call<br/>integrate(idno,name,email,phone,created_on,updated_on) </span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi kr"><img src="../Images/db160b6cca20d208ac84999fef5f9a17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8RmC7mPJYLjrH3q0jDFCDw.png"/></div></div></figure><p id="6ba8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">最后，用户可以看到输入的值存储在我们的工作表行中。</p><p id="96e8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们成功地完成了，</p><p id="4b5b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">谢谢大家！❤</p></div></div>    
</body>
</html>