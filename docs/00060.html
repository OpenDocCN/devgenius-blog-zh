<html>
<head>
<title>How Does Android ID changer or similar apps work?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Android ID changer或类似的应用程序是如何工作的？</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-android-id-changer-or-similar-apps-work-9b3766899ef3?source=collection_archive---------0-----------------------#2019-08-28">https://blog.devgenius.io/how-android-id-changer-or-similar-apps-work-9b3766899ef3?source=collection_archive---------0-----------------------#2019-08-28</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/554c3da8e1b03e6a0ca86bd5791ee6fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SaOXBbVXhFcuoUrqv90T-g.jpeg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">米克·豪普特在<a class="ae jz" href="https://unsplash.com/collections/2416700/how-many?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="0392" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">最近我在探索找出一个唯一的设备标识符来跟踪唯一用户的数量。在我的研究中，我发现其中一个合格的候选人是Android id，它以前(在Android Oreo之前)被称为设备ID。有趣的是，谷歌不仅将其重命名为Android_ID，还改变了它的行为。</p><blockquote class="ky kz la"><p id="37f0" class="ka kb lb kc b kd ke kf kg kh ki kj kk lc km kn ko ld kq kr ks le ku kv kw kx ig bi translated">虽然在本文中讨论这种差异没有太大关系，但只是为了让您了解这个主题的本质，当第三方应用程序请求Android_ID时，它不再是每个设备唯一的，而是每个应用程序、每个用户唯一的。假设由两个不同的应用程序开发人员A和B开发的两个应用程序请求它，将返回两个不同的Android _ IDs。更令人困惑的是，如果任何预安装或系统应用程序或系统组件请求它，它就是唯一的。</p></blockquote><p id="b3d0" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">好吧…回到主题，在我的探索过程中，我也发现有几十个名为Android ID changer，Device ID等的应用程序…嗯…我的好奇心越来越强，我一直在唠叨我自己如何才能在不成为Android系统的一部分的情况下修改这些细节。我进一步安装了几个应用程序，并验证了行为，令我惊讶的是，没有一个应用程序工作，我可以看到类似<strong class="kc io"> <em class="lb"> Root访问权限未被授予的错误消息。这意味着所有这些应用程序只有在用户已经给他们的手机加了根的情况下才能工作。</em> </strong></p><p id="6dc9" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我更进一步，看看这是如何工作的，如果手机是根。这一次……砰……ID变了，应用程序运行得很完美。那么现在这里发生了什么，事情是如何工作的，只是根权限，所有这些应用程序仍然不是系统的一部分。这是我的发现。</p><p id="3a5d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在深入研究这些发现之前，先简单了解一下Android ID在系统内部是如何存储的。</p><p id="6116" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Android ID存储在<strong class="kc io"> <em class="lb">设置提供者</em> </strong>包下的<strong class="kc io"> <em class="lb">安全</em> </strong>表中。一个人应该有<strong class="kc io"><em class="lb">WRITE _ SECURE _ SETTINGS</em></strong>权限来修改这个表，但是任何应用程序都可以从中获取数据。除此之外，正如我前面提到的，每个应用程序在获取Android_ID时都会有一个不同的Android _ ID。为了支持这种行为，设置提供程序还维护了一个不同的SSAID表，其中包含应用程序列表及其Android_ID详细信息。每当从playstore安装或卸载新应用程序时，都会更新SSAID表。在内部，所有这些数据都存储在单独的xml文件中。</p><p id="31ac" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">回到我的发现，有两种方法可以改变ID</p><blockquote class="lf"><p id="f4cb" class="lg lh in bd li lj lk ll lm ln lo kx dk translated">修改存储在安全表中的Android_ID。</p><p id="e43c" class="lg lh in bd li lj lk ll lm ln lo kx dk translated">分别为每个应用程序修改存储在SSAID表中的Android_ID。</p></blockquote><p id="583d" class="pw-post-body-paragraph ka kb in kc b kd lp kf kg kh lq kj kk kl lr kn ko kp ls kr ks kt lt kv kw kx ig bi translated">所以所有这些应用程序做的第一步是使用下面的adb shell命令静默获取WRITE_SECURE_SETTINGS权限。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="0204" class="md me in lz b gy mf mg l mh mi">adb shell pm grant com.somecomp.someapp android.permission.WRITE_SECURE_SETTINGS</span></pre><blockquote class="ky kz la"><p id="ef9d" class="ka kb lb kc b kd ke kf kg kh ki kj kk lc km kn ko ld kq kr ks le ku kv kw kx ig bi translated">上面的命令不要求用户授予权限，但默默地批准了这个请求，因为这样的命令只能由系统运行。希望你能感觉到这里的危险和root访问的影响。</p></blockquote><p id="be40" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">一旦获得该权限，就可以使用下面的代码更新该表</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="c421" class="md me in lz b gy mf mg l mh mi">Settings.Secure.<em class="lb">putString</em>(getContentResolver(),Settings.Secure.<strong class="lz io"><em class="lb">ANDROID_ID</em></strong>,&lt;Any_Value&gt;);</span></pre><p id="1566" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">另一种方法是直接修改底层xml文件。这些xml文件存储在<strong class="kc io"><em class="lb">/data/system/users/0/</em></strong>下，这里相关的文件有<strong class="kc io"><em class="lb">settings _ secure . XML</em></strong>和<strong class="kc io"><em class="lb">settings _ ssaid . XML</em></strong></p><p id="7bed" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi mj translated">最后的想法</p><p id="f41f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我可以弄清楚这些东西是如何在引擎盖下工作的，但我还没有弄清楚谷歌在Android Oreo上改变Android_ID行为的动机。希望有一天我会明白。如果你已经知道这个变化，请在这里留言。</p></div></div>    
</body>
</html>