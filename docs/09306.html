<html>
<head>
<title>DA Portfolio Project- ETL/Database Design/ MySQL (Part III)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">DA 组合项目-ETL/数据库设计/ MySQL(第三部分)</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/da-portfolio-project-etl-database-design-mysql-part-iii-129766e1f586?source=collection_archive---------11-----------------------#2022-08-13">https://blog.devgenius.io/da-portfolio-project-etl-database-design-mysql-part-iii-129766e1f586?source=collection_archive---------11-----------------------#2022-08-13</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/87ee8f858d5c40896c4f1ba4a8200b28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cIjwD1ZvMeWq-OhG.jpeg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated"><a class="ae jz" href="https://www.mysql.com/" rel="noopener ugc nofollow" target="_blank">https://www.mysql.com/</a></figcaption></figure><p id="eaf0" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">欢迎大家回来！如果你是新来的，在开始这一部分之前，先检查一下另外两部分。<strong class="kc io"> </strong> <a class="ae jz" href="https://medium.com/@Armonia1999/da-portfolio-project-etl-database-design-mysql-part-i-473b340806ca" rel="noopener"> <strong class="kc io">第一部分</strong></a><a class="ae jz" href="https://medium.com/@Armonia1999/da-portfolio-project-etl-database-design-mysql-part-ii-2e5aac3fc827" rel="noopener"><strong class="kc io">第二部分</strong> </a>。</p><p id="4ad8" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在最后一部分中，我们经历了数据的提取和转换步骤。今天是 ETL 过程的最后一步:<strong class="kc io">加载</strong>。</p><p id="fd2c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们仍将使用 python，为了能够将我们在 python 中所做的一切应用到我们的 MySQL Workbench，我们将使用 mysql-python 连接器。正如我在第一部分中展示的，我们应该将它安装到我们的 anaconda 环境中，如下所示:</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="ae14" class="lh li in ld b gy lj lk l ll lm">conda install -c anaconda mysql-connector-python</span></pre><p id="50a0" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们应该准备好了。让我们来设置一下:</p><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="5742" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">正如您在上面的代码中看到的，我们通过提供名称和密码创建了到 RDBMS 的连接。你应该根据你的改变它们。之后，我们创建了一个名为“Wanhui”的数据库，它将保存我们稍后将创建的所有表。然后在最后一行中，我们修改了数据库连接，这样它将使用我们刚刚创建的数据库。</p><p id="f8d2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们开始构建我们的表，从最简单的开始:Alliance 表。</p><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="86cd" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">所以我们创建了一个名为 alliances 的表，它只有两列:ID 和 alliance_name。你可能已经注意到了，我们这样做是为了让 ID 自动递增，这非常方便。然后，我们将所有联盟名称加入元组中，用逗号分隔它们，这样就可以在一行中插入表中的所有值，而不是一个接一个地插入。如果我们去我们的工作台，它将看起来像这样:</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/33b01ade04ede025bd132cd9dc63ea1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:552/format:webp/1*CzajwdcxEqtIPfJaKA6-RQ.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">啊，是的，浮夸的名字..</figcaption></figure><p id="84e3" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">好了，现在我们知道一切进展顺利，让我们继续下一张表:教派。</p><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="ln lo l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">嗯，看起来我们不能从左向右移动，我将在最后链接我的 GitHub，所以检查那里的 python 文件。</figcaption></figure><p id="fbb4" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">好了，这次我们创建了教派表。它只有 3 列:ID，教派名称和联盟 ID，告诉我们这个教派属于哪个联盟。我们通过创建一个包含元组的列表来插入这些值，元组中存储了教派名称和一个 1 到 14 之间的随机数(因为这是我们拥有的联盟数)，因为这是一个列表，所以我们使用“executemany”来完成它。然后，我们使用 db.commit()将更改提交给数据库</p><p id="d2d4" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">请记住，我们仍然需要向这个表中添加一些列，例如:教派首领，但是因为我们还没有公民表，所以我们还不能这样做。因此，当我们转移到工作台而不是 python 时，我们将进行这些更改，这样会更有趣。</p><p id="7662" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">好，下一张表:库存。</p><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="ln lo l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">这一次我把线分成多条线，这样你就可以看到❤了</figcaption></figure><p id="ba5d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">库存表有以下几列:ID，sect_id，这样我们可以在以后查看特定教派的库存，以及每个教派拥有的剑、箭、毒药、匕首、船只和 SS 等级武器的数量。为了选择每个教派有多少武器，我们使用了随机库。随意调整对你有意义的数字哈哈。</p><p id="5232" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在是我亲爱的最后一桌:公民们。</p><p id="63bd" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">首先让我们构建表格:</p><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="3075" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">所以我们有一个 ID，全名，年龄，性别，可以是我们指定的任何一个，修炼能力，等级，是否是胭脂，最后是他们所属教派的教派 ID。运行它，我们会准备好桌子。现在让我们填充它:</p><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="03fc" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们慢慢回顾一下我们所做的事情。首先，我们有一个空的 val 列表，我们将向其中添加我们想要加载到表中的数据。然后是权重，值分别为 0.99 和 0.01。这是什么意思？以前，当我们使用随机库生成特定范围内的随机数据时，每个数字都有均等的机会被选中。但是这一次，我们不能给每个公民同等的机会被涂脂抹粉或者不涂脂抹粉，因为这意味着几乎 50%的公民会被涂脂抹粉！所以我将使用 numpy 的随机选择函数，它也将权重作为参数。所以我们会用权数来衡量胭脂，然后用权数来衡量公民的权力等级。</p><p id="0304" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">你可能也注意到了一件事。当生成代表教派 ID 的数字时，我们选择了 1 到 30 的范围。为什么？我们确实有大约 100 个教派，但我选择不使用所有的教派，以便每个教派有更多的公民。我们有大约 9000 名公民，甚至更多，通过选择 30 个教派，我们应该得到每个教派大约 300 人。如果我们选择更多，教派的人会少很多，那就不好玩了。</p><p id="493b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我做的最后一件事是创建一个 citizens_CH 表来保存我的 43k 个有中文名字的公民，但我们不会在这里这样做，因为这是额外的，只是为了我个人的选择。</p><p id="a72e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在去你的工作台，一切都应该做好了。这是我的一个片段:</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/bcdd41def47f48cfcddd1dd6ab973ff3.png" data-original-src="https://miro.medium.com/v2/resize:fit:506/format:webp/1*DyxrvYLrXYqnMj1Ver8Nlg.png"/></div></figure><p id="bb15" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">今天就到这里吧，我亲爱的附庸们，明天我会看到你们使用 SQL ❤开始我们的 EDA，这将是我认为最有趣的部分！</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/93c40a6ff60ee511ca60988f3606f383.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*Au3HVfRJHBW0n5Up.gif"/></div></figure></div></div>    
</body>
</html>