<html>
<head>
<title>How to build a headless WordPress website with ReactJS &amp; Frontity — Pt. 3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用 ReactJS &amp; Frontity — Pt 建立一个无头 WordPress 网站？3</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-build-a-headless-wordpress-website-with-frontity-reactjs-pt-3-ff98d654ac75?source=collection_archive---------9-----------------------#2022-08-18">https://blog.devgenius.io/how-to-build-a-headless-wordpress-website-with-frontity-reactjs-pt-3-ff98d654ac75?source=collection_archive---------9-----------------------#2022-08-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/6c65d139220baffaa2686406b3af2055.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TYCBjZcb0nMfJdD9c0Z9Yw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">尝试 Frontity 的理由</figcaption></figure><p id="759e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">向 Frontity 项目添加内容非常简单。事实上，火星主题包括了所有能为你挑起重担的组件。让我们从您期望的地方开始:<code class="fe la lb lc ld b">src/components/index.js</code>。该组件看起来如下所示:</p><pre class="le lf lg lh gt li ld lj lk aw ll bi"><span id="70cf" class="lm ln iq ld b gy lo lp l lq lr">import { Global, css, connect, styled, Head } from "frontity";<br/>import Switch from "<a class="ae ls" href="http://twitter.com/frontity/components" rel="noopener ugc nofollow" target="_blank">@frontity/components</a>/switch";<br/>import Header from "./header";<br/>import List from "./list";<br/>import Post from "./post";<br/>import Loading from "./loading";<br/>import Title from "./title";<br/>import PageError from "./page-error";</span><span id="e724" class="lm ln iq ld b gy lt lp l lq lr">/**<br/> * Theme is the root React component of our theme. The one we will export<br/> * in roots.<br/> *<br/> * <a class="ae ls" href="http://twitter.com/param" rel="noopener ugc nofollow" target="_blank">@param</a> props - The props injected by Frontity's {<a class="ae ls" href="http://twitter.com/link" rel="noopener ugc nofollow" target="_blank">@link</a> connect} HOC.<br/> *<br/> * <a class="ae ls" href="http://twitter.com/returns" rel="noopener ugc nofollow" target="_blank">@returns</a> The top-level react component representing the theme.<br/> */<br/>const Theme = ({ state }) =&gt; {<br/>  // Get information about the current URL.<br/>  const data = state.source.get(state.router.link);</span><span id="cd69" class="lm ln iq ld b gy lt lp l lq lr">return (<br/>    &lt;&gt;<br/>      {/* Add some metatags to the &lt;head&gt; of the HTML. */}<br/>      &lt;Title /&gt;<br/>      &lt;Head&gt;<br/>        &lt;meta name="description" content={state.frontity.description} /&gt;<br/>        &lt;html lang="en" /&gt;<br/>      &lt;/Head&gt;</span><span id="fb10" class="lm ln iq ld b gy lt lp l lq lr">{/* Add some global styles for the whole site, like body or a's. <br/>      Not classes here because we use CSS-in-JS. Only global HTML tags. */}<br/>      &lt;Global styles={globalStyles} /&gt;</span><span id="35b5" class="lm ln iq ld b gy lt lp l lq lr">{/* Add the header of the site. */}<br/>      &lt;HeadContainer&gt;<br/>        &lt;Header /&gt;<br/>      &lt;/HeadContainer&gt;</span><span id="aaed" class="lm ln iq ld b gy lt lp l lq lr"><strong class="ld ir">{/* Add the main section. It renders a different component depending<br/>      on the type of URL we are in. */}<br/>      &lt;Main&gt;<br/>        &lt;Switch&gt;<br/>          &lt;Loading when={data.isFetching} /&gt;<br/>          &lt;List when={data.isArchive} /&gt;<br/>          &lt;Post when={data.isPostType} /&gt;<br/>          &lt;PageError when={data.isError} /&gt;<br/>        &lt;/Switch&gt;<br/>      &lt;/Main&gt;</strong><br/>    &lt;/&gt;<br/>  );<br/>};</span></pre><p id="c0ff" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">上面，我用粗体突出显示了将加载内容的组件部分。就像在其他 React 框架中一样，Frontity 使用一个<code class="fe la lb lc ld b">&lt;Switch&gt;</code>组件进行页面路由，它包含一个<code class="fe la lb lc ld b">post.js</code>组件，WordPress 数据实际上就是从这个组件中获取的。</p><p id="fb19" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><code class="fe la lb lc ld b">post.js</code>组件将如下所示:</p><pre class="le lf lg lh gt li ld lj lk aw ll bi"><span id="01a7" class="lm ln iq ld b gy lo lp l lq lr">import { useEffect } from "react";<br/>import { connect, styled } from "frontity";<br/>import Link from "./link";<br/>import List from "./list";<br/>import FeaturedMedia from "./featured-media";</span><span id="d62a" class="lm ln iq ld b gy lt lp l lq lr">/**<br/> * The Post component that Mars uses to render any kind of "post type", like<br/> * posts, pages, attachments, etc.<br/> *<br/> * It doesn't receive any prop but the Frontity store, which it receives from<br/> * {<a class="ae ls" href="http://twitter.com/link" rel="noopener ugc nofollow" target="_blank">@link</a> connect}. The current Frontity state is used to know which post type<br/> * should be rendered.<br/> *<br/> * <a class="ae ls" href="http://twitter.com/param" rel="noopener ugc nofollow" target="_blank">@param</a> props - The Frontity store (state, actions, and libraries).<br/> *<br/> * <a class="ae ls" href="http://twitter.com/example" rel="noopener ugc nofollow" target="_blank">@example</a><br/> * ```js<br/> * &lt;Switch&gt;<br/> *   &lt;Post when={data.isPostType} /&gt;<br/> * &lt;/Switch&gt;<br/> * ```<br/> *<br/> * <a class="ae ls" href="http://twitter.com/returns" rel="noopener ugc nofollow" target="_blank">@returns</a> The {<a class="ae ls" href="http://twitter.com/link" rel="noopener ugc nofollow" target="_blank">@link</a> Post} element rendered.<br/> */<br/>const Post = ({ state, actions, libraries }) =&gt; {<br/>  // Get information about the current URL.<br/>  const data = state.source.get(state.router.link);<br/>  // Get the data of the post.<br/>  const post = state.source[data.type][data.id];<br/>  // Get the data of the author.<br/>  const author = state.source.author[post.author];<br/>  // Get a human readable date.<br/>  const date = new Date(post.date);</span><span id="c954" class="lm ln iq ld b gy lt lp l lq lr"><strong class="ld ir">// Get the html2react component.<br/>  const Html2React = libraries.html2react.Component;</strong></span><span id="332c" class="lm ln iq ld b gy lt lp l lq lr">/**<br/>   * Once the post has loaded in the DOM, prefetch both the<br/>   * home posts and the list component so if the user visits<br/>   * the home page, everything is ready and it loads instantly.<br/>   */<br/>  useEffect(() =&gt; {<br/>    actions.source.fetch("/");<br/>    List.preload();<br/>  }, [actions.source]);</span><span id="8083" class="lm ln iq ld b gy lt lp l lq lr">// Load the post, but only if the data is ready.<br/>  return data.isReady ? (<br/>    &lt;Container&gt;<br/>      &lt;div&gt;<br/>        <strong class="ld ir">&lt;Title dangerouslySetInnerHTML={{ __html: post.title.rendered }} /&gt;</strong></span><span id="b268" class="lm ln iq ld b gy lt lp l lq lr">{/* Hide author and date on pages */}<br/>        <strong class="ld ir">{!data.isPage &amp;&amp; (<br/>          &lt;div&gt;<br/>            {author &amp;&amp; (<br/>              &lt;StyledLink link={author.link}&gt;<br/>                &lt;Author&gt;<br/>                  By &lt;b&gt;{author.name}&lt;/b&gt;<br/>                &lt;/Author&gt;<br/>              &lt;/StyledLink&gt;<br/>            )}<br/>            &lt;DateWrapper&gt;<br/>              {" "}<br/>              on &lt;b&gt;{date.toDateString()}&lt;/b&gt;<br/>            &lt;/DateWrapper&gt;<br/>          &lt;/div&gt;<br/>        )}</strong><br/>      &lt;/div&gt;</span><span id="e60d" class="lm ln iq ld b gy lt lp l lq lr">{/* Look at the settings to see if we should include the featured image */}<br/>      {state.theme.featured.showOnPost &amp;&amp; (<br/>        &lt;FeaturedMedia id={post.featured_media} /&gt;<br/>      )}</span><span id="b7cd" class="lm ln iq ld b gy lt lp l lq lr">{data.isAttachment ? (<br/>        // If the post is an attachment, just render the description property,<br/>        // which already contains the thumbnail.<br/>        <strong class="ld ir">&lt;div dangerouslySetInnerHTML={{ __html: post.description.rendered }} /&gt;</strong><br/>      ) : (<br/>        // Render the content using the Html2React component so the HTML is<br/>        // processed by the processors we included in the<br/>        // libraries.html2react.processors array.<br/>        &lt;Content&gt;<br/>          <strong class="ld ir">&lt;Html2React html={post.content.rendered} /&gt;</strong><br/>        &lt;/Content&gt;<br/>      )}<br/>    &lt;/Container&gt;<br/>  ) : null;<br/>};</span></pre><p id="e87a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我突出显示了将自动获取内容数据并根据它是页面还是文章来显示的区域。该组件从<strong class="ke ir"> Frontity 状态</strong>获取数据，然后有条件地呈现页面或帖子所需的页面部分。<code class="fe la lb lc ld b">dangerouslySetInnerHTML</code>用于设置“标题”和“描述”等元数据，但主页面内容数据是使用 Frontity 内置的一个名为<code class="fe la lb lc ld b">html2react</code>的库显示的。Frontity 将<strong class="ke ir">库</strong>定义为<strong class="ke ir">“一组可重用的工具。但是，它的目的不是改变状态，而是改变应用程序的其他部分，并且可供许多软件包使用。—</strong><a class="ae ls" href="https://docs.frontity.org/learning-frontity" rel="noopener ugc nofollow" target="_blank">https://docs.frontity.org/learning-frontity</a>—核心概念</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><p id="cea4" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">到现在为止，你的 Frontity 项目将会显示 WordPress 网站的内容和动态菜单。如果您在浏览器检查器中检查内容，您可以看到我之前推荐添加到 WordPress 块编辑器中的 div 和 sections 的类名(基于您自己的设计)。剩下您要做的就是在组件中构建您的设计，就像您对任何 React 应用程序从 Frontity 的 API 获取各种数据一样。JS 中的 CSS 用于设计你的应用程序，意味着你的 CSS 可以包含在每个组件中。但是为什么在 JS 中使用 CSS 呢？</p><p id="c1db" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">因为:</p><ul class=""><li id="d5f2" class="mb mc iq ke b kf kg kj kk kn md kr me kv mf kz mg mh mi mj bi translated"><strong class="ke ir">它只加载每个页面所需的 CSS</strong>，从而提高了性能</li><li id="842c" class="mb mc iq ke b kf mk kj ml kn mm kr mn kv mo kz mg mh mi mj bi translated">你不必担心类和它的重复、错别字等问题</li><li id="46a3" class="mb mc iq ke b kf mk kj ml kn mm kr mn kv mo kz mg mh mi mj bi translated">你不必担心厂商前缀，这样你就可以基于当前标准编写你的 CSS，Frontity 会为你处理剩下的事情</li><li id="3fd1" class="mb mc iq ke b kf mk kj ml kn mm kr mn kv mo kz mg mh mi mj bi translated">您可以使用 JavaScript 的所有<strong class="ke ir">功能来设计您的组件，并用更少的代码创建动态样式。</strong></li></ul><p id="2693" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir"> <em class="mp">现在你有了它，你的第一个 WordPress 和 Frontity 应用开始运行了。具有 Frontity 和 ReactJS 的解耦 WordPress。尽情享受吧！</em> </strong></p><p id="0e03" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">回到… <br/> <strong class="ke ir"> + </strong> <a class="ae ls" href="https://medium.com/@mckenna.niall/how-to-build-a-headless-wordpress-website-with-frontity-reactjs-pt-1-9cc49f63981e" rel="noopener"> <strong class="ke ir">如何用 Frontity/react js-Pt 搭建一个无头 WordPress 网站？1 </strong> </a></p><ul class=""><li id="62e7" class="mb mc iq ke b kf kg kj kk kn md kr me kv mf kz mg mh mi mj bi translated"><a class="ae ls" href="https://medium.com/@mckenna.niall/how-to-build-a-headless-wordpress-website-with-frontity-reactjs-pt-2-3933990bab54" rel="noopener"> <strong class="ke ir">如何用 Frontity / ReactJS 构建一个无头 WordPress 网站— Pt。2 </strong> </a></li></ul></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><p id="b0d9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这个故事也可以@<a class="ae ls" href="https://www.nmk.dev/post/how-to-build-a-headless-wordpress-website-with-frontity-reactjs-pt-3-ff98d654ac75" rel="noopener ugc nofollow" target="_blank">https://www . nmk . dev/post/how-to-build-a-headless-WordPress-website-with-frontity-react js-pt-3-ff 98d 654 AC 75</a></p></div></div>    
</body>
</html>