<html>
<head>
<title>How to add push notification in a Next/React JS App?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在 Next/React JS App 中添加推送通知？</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-add-push-notification-in-a-next-react-js-app-d8878e5e9c29?source=collection_archive---------3-----------------------#2022-02-28">https://blog.devgenius.io/how-to-add-push-notification-in-a-next-react-js-app-d8878e5e9c29?source=collection_archive---------3-----------------------#2022-02-28</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="dd31" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">朋友们好，今天在这篇文章中，我们将看到如何用 React/NextJS 应用程序设置一个信号推送通知。网络推送通知是提高用户参与度、产品发布、优惠和销售等的最佳渠道。与电子邮件等传统渠道不同，网络推送通知可以快速通知用户，并为您的网站带来流量。因此，我将展示我如何在我的网站 codewithmarish.com 集成一个信号推送通知，这是建立在下一个 JS 上的，可选地，我还会提到 React JS 应用程序的步骤，因为这些步骤非常相似。让我们开始吧。</p><h1 id="017a" class="ki kj in bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">步骤 1 —单信号设置</h1><p id="b9d3" class="pw-post-body-paragraph jk jl in jm b jn lg jp jq jr lh jt ju jv li jx jy jz lj kb kc kd lk kf kg kh ig bi translated">首次注册 OneSignal 账户</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi ll"><img src="../Images/467a91957e70a9afe496790cfc4412dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5qmyKeRk9C6DG13XZon2Bg.jpeg"/></div></div></figure><p id="aeb5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">指定应用程序名称并选择应用程序类型，我将选择“Web”</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi ll"><img src="../Images/7040b2d0bb60cbf6cdd1a46f586d636b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S7tpmwOHrQ0t4nVoG1X6OQ.jpeg"/></div></div></figure><p id="11bd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">选择 Integration 作为“典型站点”,在 site setup 下指定您的“站点标题”和“站点 Url ”,现在指定 localhost 进行测试。打开本地测试</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi ll"><img src="../Images/8e4b6fc8d9fabad4591b6a8b3dcf9dd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jCKjhS5-HvkyNRnBajFIjw.jpeg"/></div></div></figure><p id="d356" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在设置您的权限提示设置，您可以编辑或添加新的权限提示。配置权限提示。</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi ll"><img src="../Images/349ecd0efbf469710d08370465955bf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YlZ8O8vZRyQN4MsxFqa_xg.jpeg"/></div></div></figure><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi ll"><img src="../Images/3f03206e3a9a04080f8bd1ce535f9139.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GNpUx3h69nMNoobwNTX50A.jpeg"/></div></div></figure><p id="9b3f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">点击保存，将打开下一步</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi ll"><img src="../Images/545131dc1eb27e0ef33f3cef7681033c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ehzih0ebOlXamESvSn9SQw.jpeg"/></div></div></figure><p id="8701" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在下载 OneSignal SDK 文件，它将是一个 zip 文件，并将其解压缩到您的根文件夹中。在 React/Next JS 中，将这个下载的文件放在 public 文件夹中。</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi ll"><img src="../Images/57844a869694d0f9dc6bff64b17f0453.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NKsjYds-51bhYeBDaYnOGg.jpeg"/></div></div></figure><p id="e529" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">复制此应用 id，它将在项目设置中使用。</p><h1 id="1ad0" class="ki kj in bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">步骤 2 —下一个 JS 设置</h1><p id="57c9" class="pw-post-body-paragraph jk jl in jm b jn lg jp jq jr lh jt ju jv li jx jy jz lj kb kc kd lk kf kg kh ig bi translated">打开 pages 文件夹下的 _app.js 并添加以下代码。此代码将有助于初始化一个信号。如果你遇到类似“窗口未定义”的错误，那么确保你有这个条件。所以它会在页面完全加载后初始化一个信号。</p><pre class="lm ln lo lp gt lx ly lz ma aw mb bi"><span id="f2ec" class="mc kj in ly b gy md me l mf mg">useEffect(() =&gt; {<br/>    if (typeof window !== undefined) {<br/>      window.OneSignal = window.OneSignal || [];<br/>      OneSignal.push(function () {<br/>        OneSignal.init({<br/>          appId: "YOUR_ONE_SIGNAL_ID",<br/>          notifyButton: {<br/>            enable: true,<br/>          },<br/>        });<br/>      });<br/>    }</span><span id="49f2" class="mc kj in ly b gy mh me l mf mg">    return () =&gt; {<br/>      window.OneSignal = undefined;<br/>    };<br/>  }, []);</span></pre><p id="4dcc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在 pages 目录下创建一个名为 _document.js 的新文件，用下面的代码加载 OneSignalSdk.js。当你想要定制  &amp; 的时候使用 This _document.js，更多细节你可以参考下一个 js 文档。</p><p id="a3ad" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">【https://nextjs.org/docs/advanced-features/custom-document T4】</p><pre class="lm ln lo lp gt lx ly lz ma aw mb bi"><span id="ddcc" class="mc kj in ly b gy md me l mf mg">import { Html, Head, Main, NextScript } from "next/document";<br/>export default function Document() {<br/>  return (<br/>    &lt;Html lang="en"&gt;<br/>      &lt;Head&gt;<br/>        &lt;script<br/>          async<br/>          src="https://cdn.onesignal.com/sdks/OneSignalSDK.js"<br/>        &gt;&lt;/script&gt;<br/>      &lt;/Head&gt;<br/>      &lt;body&gt;<br/>        &lt;Main /&gt;<br/>        &lt;NextScript /&gt;<br/>      &lt;/body&gt;<br/>    &lt;/Html&gt;<br/>  );<br/>}</span></pre><p id="a100" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在命令行中使用 npm run dev 在浏览器中运行应用程序。如果一切都设置正确，那么你应该收到如下滑块要求订阅。确保您订阅了测试。</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi ll"><img src="../Images/44b0e9eb17170d4755d71335192deb94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mh1ye2rhFp8SfpdDBaiNzg.jpeg"/></div></div></figure><p id="6e34" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在我们将寻找 React JS 项目的步骤</p><h1 id="85f3" class="ki kj in bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">步骤 2 —反应 JS 设置</h1><p id="919e" class="pw-post-body-paragraph jk jl in jm b jn lg jp jq jr lh jt ju jv li jx jy jz lj kb kc kd lk kf kg kh ig bi translated">打开公共文件夹下的 index.html，在 head 标签中添加以下代码</p><pre class="lm ln lo lp gt lx ly lz ma aw mb bi"><span id="8f1b" class="mc kj in ly b gy md me l mf mg">&lt;script async src="https://cdn.onesignal.com/sdks/OneSignalSDK.js"<br/>&gt;&lt;/script&gt;</span></pre><p id="1ce4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">使用以下命令安装 react-onesignal 包</p><p id="e8bf" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe mj mk ml ly b">npm i react-onesignal</code></p><p id="2598" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在打开 App.js，从 react-onesignal 导入 OneSignal，并放置下面的代码来初始化 onesignal。</p><pre class="lm ln lo lp gt lx ly lz ma aw mb bi"><span id="f1f4" class="mc kj in ly b gy md me l mf mg">import OneSignal from 'react-onesignal';<br/>.....<br/>...<br/>..<br/>useEffect(() =&gt; {</span><span id="674c" class="mc kj in ly b gy mh me l mf mg">   OneSignal.init({<br/>     appId: "YOUR-APP-ID-HERE"<br/>   });<br/>}, []);</span></pre><p id="fd96" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">并使用 npm start 启动您的项目</p><h1 id="fa88" class="ki kj in bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">步骤 3 —测试</h1><p id="bfae" class="pw-post-body-paragraph jk jl in jm b jn lg jp jq jr lh jt ju jv li jx jy jz lj kb kc kd lk kf kg kh ig bi translated">要立即测试，请转到您的 onesignal 帐户的“消息”选项卡，创建一条新的推送消息。填写我们的消息名称、标题、消息等。</p><p id="ee30" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">(注意:确保您已经订阅了通知)。此外，您可以检查“受众标签”中的订户列表，只需确认订户是否大于零。</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi ll"><img src="../Images/8b9a281d956a451c198dfc245ee0e21a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GmTe_WMol3lvv7MwOlg4bA.jpeg"/></div></div></figure><p id="c755" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">完成后，点击审查并发送。</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi ll"><img src="../Images/bdfcea098efc119ede2d4879747d88aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zuMkm2RrbQujsgdMuL6Opw.jpeg"/></div></div></figure><p id="4b75" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，如果您点击发送消息，您将会收到来自浏览器的推送通知。</p><p id="42cb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">朋友们，这篇文章到此为止，如果你觉得这篇文章有帮助，请最大限度地分享，感谢阅读😊敬请关注。</p><p id="5600" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">另外，不要忘记订阅我们的 youtube 频道 codewithmarish，了解所有与网络开发相关的挑战</p><p id="a42b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae mi" href="https://www.youtube.com/channel/UCkPYmdVz8aGRH6qCdKMRYpA" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/channel/UCkPYmdVz8aGRH6qCdKMRYpA</a></p><p id="4ee6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你在任何一个步骤中遇到困难，你也可以参考信号文档</p><p id="2c10" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">https://documentation.onesignal.com/docs<a class="ae mi" href="https://documentation.onesignal.com/docs" rel="noopener ugc nofollow" target="_blank"/></p></div></div>    
</body>
</html>