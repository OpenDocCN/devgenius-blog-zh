<html>
<head>
<title>Red Wine Quality Prediction using Classification and Regression Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于分类回归模型的红酒质量预测</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/red-wine-quality-prediction-using-classification-and-regression-model-f19337821b71?source=collection_archive---------3-----------------------#2020-07-09">https://blog.devgenius.io/red-wine-quality-prediction-using-classification-and-regression-model-f19337821b71?source=collection_archive---------3-----------------------#2020-07-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3b71" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我的上一篇文章中，我提到了<a class="ae kl" href="https://medium.com/p/statistics-for-data-science-ddbc284d4016?source=email-bc3371cfd6fb--writer.postDistributed&amp;sk=0b4bc16f16ee956ffff901f3709f68ce" rel="noopener">统计学对于数据科学</a>的重要性。这是因为统计学是一个重要的概念，机器学习是建立在这个概念之上的。在这个使用 Kaggle 数据集预测红酒质量的逐步过程中，您将看到统计学在转换、解释、分析和可视化数据方面的重要性。</p><p id="1b57" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">值得注意的是，拥有问题集的领域知识非常重要。</strong></p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi kt"><img src="../Images/13dd1e90cfda0dbc990231cb63eafd8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eW3TaPlR9FYmIKOgB9Q_ZA.jpeg"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">图片来源:Unsplash</figcaption></figure><p id="36e7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，简要概述一下红酒质量数据集。</p><p id="e1a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">红酒质量数据集的主要目的是预测哪种理化特性可以酿造出好酒。给定 11 个变量和 1 个输出变量(质量),让我们检查每个特征的作用:</p><ol class=""><li id="4956" class="lj lk iq jp b jq jr ju jv jy ll kc lm kg ln kk lo lp lq lr bi translated"><strong class="jp ir"> <em class="ls">固定酸度</em> </strong>:不挥发酸，不容易挥发</li><li id="60aa" class="lj lk iq jp b jq lt ju lu jy lv kc lw kg lx kk lo lp lq lr bi translated"><strong class="jp ir"><em class="ls"/></strong>:葡萄酒中的乙酸含量高，会产生令人不快的醋味</li><li id="316b" class="lj lk iq jp b jq lt ju lu jy lv kc lw kg lx kk lo lp lq lr bi translated"><strong class="jp ir"> <em class="ls">柠檬酸</em> </strong>:作为防腐剂，增加酸度。少量时，增加葡萄酒的新鲜度和风味</li><li id="4467" class="lj lk iq jp b jq lt ju lu jy lv kc lw kg lx kk lo lp lq lr bi translated"><strong class="jp ir"> <em class="ls">残糖:</em> </strong>是发酵停止后剩余的糖量。关键是要在甜味和酸味之间有一个完美的平衡。需要注意的是，45 克/升的葡萄酒是甜的</li><li id="a9c5" class="lj lk iq jp b jq lt ju lu jy lv kc lw kg lx kk lo lp lq lr bi translated"><strong class="jp ir"> <em class="ls">氯化物</em> </strong>:酒里的盐量</li><li id="f30e" class="lj lk iq jp b jq lt ju lu jy lv kc lw kg lx kk lo lp lq lr bi translated"><strong class="jp ir"> <em class="ls">游离二氧化硫:</em> </strong>它阻止微生物的生长和葡萄酒的氧化</li><li id="899d" class="lj lk iq jp b jq lt ju lu jy lv kc lw kg lx kk lo lp lq lr bi translated"><strong class="jp ir"><em class="ls"/></strong>二氧化硫总量:为游离态+结合态 SO2 的量</li><li id="f387" class="lj lk iq jp b jq lt ju lu jy lv kc lw kg lx kk lo lp lq lr bi translated"><strong class="jp ir"> <em class="ls">密度</em> </strong>:越甜的葡萄酒密度越大</li><li id="da74" class="lj lk iq jp b jq lt ju lu jy lv kc lw kg lx kk lo lp lq lr bi translated"><strong class="jp ir"> <em class="ls"> pH </em> </strong>:描述酸度等级，范围为 0-14。大多数葡萄酒的 pH 值总是在 3-4 之间</li><li id="1b14" class="lj lk iq jp b jq lt ju lu jy lv kc lw kg lx kk lo lp lq lr bi translated"><strong class="jp ir"> <em class="ls">酒精</em> </strong>:少量存在于葡萄酒中使饮酒者易于交际</li><li id="33f8" class="lj lk iq jp b jq lt ju lu jy lv kc lw kg lx kk lo lp lq lr bi translated"><strong class="jp ir"/></li><li id="ee40" class="lj lk iq jp b jq lt ju lu jy lv kc lw kg lx kk lo lp lq lr bi translated"><strong class="jp ir"> <em class="ls">质量</em> </strong>:哪个是输出变量/预测值</li></ol><p id="71ac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们对影响好酒质量的各种因素有了基本的了解，我们是不是该为那杯酒干杯？T55】</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="ly lz l"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">让我们为此干杯，干杯。</figcaption></figure></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><p id="daed" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在决定使用哪种机器学习算法时，需要 6 个步骤:</p><ol class=""><li id="cd6a" class="lj lk iq jp b jq jr ju jv jy ll kc lm kg ln kk lo lp lq lr bi translated"><strong class="jp ir">定义问题:</strong></li></ol><p id="b9c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">a.在你的模型中展示每个因素对葡萄酒质量的贡献</p><p id="c8d4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">b.说明哪些特征对决定葡萄酒质量更重要</p><p id="9a95" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">c.说明哪些特征在决定葡萄酒质量方面不太重要</p><p id="1ad2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.<strong class="jp ir">数据收集:</strong>归功于 Kaggle 数据集</p><p id="60b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3 <strong class="jp ir">。数据清理:</strong>检查重复、空值、缺失值等。</p><p id="a1d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.<strong class="jp ir">数据探索和可视化:</strong>这有助于有效地解释葡萄酒数据中的每个特征</p><p id="9322" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">5.<strong class="jp ir">训练算法</strong>:使用多变量回归和随机森林分类来识别目标和特征之间的模式和关系</p><p id="8615" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">6.<strong class="jp ir">使用一些指标评估您的模型(回归和分类)</strong>:</p><p id="685b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">a.偏斜:接近零的正态分布是完美的分布</p><p id="3ed0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">b.MSE(均方误差):是拟合的绝对度量。注意，MSE 为 0 表示完全符合)</p><p id="640d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">c.RMSE(均方根误差):是模型预测目标的准确程度的一个很好的度量</p><p id="8ba7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">d.R-Squared:是拟合的相对度量</p><p id="a99b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">e.混淆矩阵(准确度、精确度、召回率)</p><p id="350a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，使用 BIC(贝叶斯信息标准)的模型选择在测量复杂性；其中具有较低 BIC 值的模型是优选的。</p><p id="9a99" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们把手弄脏，好吗？T15】</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="ma lz l"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">所需的软件包/模块</figcaption></figure><p id="c4fe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第二步:数据收集</strong></p><p id="2de5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">多亏了 Kaggle，数据集以 CSV 文件的形式下载到了我的个人电脑上</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="ma lz l"/></div></figure><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi mb"><img src="../Images/85525e9b4f17724d2e270a051c29b756.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vy-M-LiEG4HTuMuIPKgLqg.jpeg"/></div></div></figure><p id="7aa3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">重命名列</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="ma lz l"/></div></figure><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi mc"><img src="../Images/d9217155c482310994fa381adb77cb17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M8rQWuXzKSBTGIu2FGXvKA.jpeg"/></div></div></figure><p id="21f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">步骤 3:使用 Pandas 进行数据清理和探索</strong></p><p id="f502" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">值得注意的是，该数据有 240 个重复的行，所以我们可以删除这些值，但我们不会这样做，因为我们希望相信这项调查是由不同的独特的葡萄酒品尝者进行的。可以使用 Pandas Profiling 检查这些重复项</p><p id="2f4e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们探索数据中的一些特征</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="ma lz l"/></div></figure><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="ma lz l"/></div></figure><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi md"><img src="../Images/cd2f22a625088e107f5e533f87970dd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*hN2yL5rpNDswD5ipxyO_Ww.jpeg"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">红酒数据的 pH 输出</figcaption></figure><p id="5545" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">值得注意的是，大多数葡萄酒的 pH 值在 3.0 — 4.0 之间</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="ma lz l"/></div></figure><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi me"><img src="../Images/9d6cd6b42ed3709ee02b29b7b0c6d16c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9AYhI0huGXkac1uoLLyIiA.jpeg"/></div></div></figure><p id="a493" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">检查空值(如果有)</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="ma lz l"/></div></figure><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi mf"><img src="../Images/744393632423940f3ac7a47281c1e6e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CZEah9BY2ikB-IzfJMHPdQ.jpeg"/></div></div></figure><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="ma lz l"/></div></figure><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi mg"><img src="../Images/f5a84f026f8635dd1cbdfa94b33a1ecd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_Nhlj3q4YxsSpiB4WLVaPQ.jpeg"/></div></div></figure><p id="bd9f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在总结数据时，我们可以看到残余糖与最大值 15.5 有很大的异常值，这与平均值 2.5(中位数(50%)为 2.2)相差甚远。这些差异也可以在游离二氧化硫、总二氧化硫、硫酸盐、酒精</p><p id="43c4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">相互关系</p><p id="7f08" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ls"> P{XY} = corr(X，Y) </em></p><ul class=""><li id="1839" class="lj lk iq jp b jq jr ju jv jy ll kc lm kg ln kk mh lp lq lr bi translated"><em class="ls"> 1.0 ≤P (XY) ≤+1.0 </em></li></ul><p id="c6d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">哪里；0:没有关系</p><p id="cd7d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">(+/-)0.6:中度关系</p><p id="022e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">(+/-)0.8:相当强的关系</p><p id="74d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">(+/-)1:完美关系</p><p id="bc2b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在检查所有特征与目标(质量)之间的关系</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="ma lz l"/></div></figure><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi mi"><img src="../Images/9fef70545b36664afc91783101637225.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pma0KLUqg4GhhIVqiBEcCQ.jpeg"/></div></div></figure><p id="fd5b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">步骤 4:训练和测试数据分割</strong></p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="ma lz l"/></div></figure><p id="22b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">模型选择—多变量线性回归</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="ma lz l"/></div></figure><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi mj"><img src="../Images/76e86932e0c736354dd203fd7f30df39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6g_3icnFFcYWvg4gUR5Ccg.jpeg"/></div></div></figure><p id="6fe9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请注意，R 平方高于测试数据集，因为算法没有看到</p><p id="faf0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="ls">数据转换</em> </strong></p><p id="ed11" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">偏斜值为 0.2178，接近于 0，这意味着它是一个正态分布，没有向左或向右偏斜的极端异常值。因此，我们不需要转换数据。</p><p id="224a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="ls">现在让我们使用 StatsModel 来运行我们的回归</em> </strong></p><p id="07e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> P 值和评估系数</strong></p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="ma lz l"/></div></figure><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi me"><img src="../Images/ed325363fb5c32cc20e3c7aa3a4c8466.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CfLhqBuq6O5tiatNNJPuEQ.jpeg"/></div></div></figure><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="ma lz l"/></div></figure><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi mk"><img src="../Images/794efddf7696904dcf7a9c10e412ad45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9PlnicjW6WZsXBqUuyXAzw.jpeg"/></div></div></figure><p id="ffdb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意，使用 scikit-learn 包和 statsmodel 给出了相同的系数值和截距。</p><p id="8c70" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="ls">方程/预测值</em> </strong></p><p id="408a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ls">质量= 11.1+0.27 酒精-1.76 氯化物-0.27 柠檬酸-6.77 密度+0.02 固定酸度+0.0029 游离二氧化硫-0.37 ph+0.001 残糖+0.83 硫酸盐-0.003 总二氧化硫-1.24 挥发酸度</em></p><p id="b2d0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从上面的等式中，我们可以看到酒精、固定酸度和硫酸盐的增加会提高红酒的质量，而其他属性如氯化物、二氧化硫、挥发性酸度、pH 值的大量增加会降低红酒的质量。</p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><p id="8f6c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">步骤 6:部署和评估模型</strong></p><p id="b9ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="ls">多重共线性测试</em> </strong></p><p id="3247" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当回归中的两个或多个预测变量高度相关时，就会出现多重共线性。也就是说，它们不为模型提供唯一的信息。多重共线性可以使用方差膨胀因子(V.I.F)进行测试</p><p id="6d54" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="ls">使用方差膨胀因子</em></strong>；</p><p id="10d6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">VIF(FA)= 1/(1-R^2)</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="ma lz l"/></div></figure><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi ml"><img src="../Images/20dd875af1cc00c876aa3fb2a0e188a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8-nvnyAajbqV29-Eg2r1hQ.jpeg"/></div></div></figure><p id="c9a7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">方差膨胀因子是一种统计指标，用于评估回归模型中的多重共线性。注意 V.I.F &gt; 10 是有问题的。一个国际货币基金组织</p><p id="d57e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">= 1:不相关</p><p id="6b32" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1–5:中度相关</p><p id="83a8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">&gt; 5:高度相关</p><p id="6a19" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">&gt; 10:值得关注</p><p id="98fb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="ls">利用模型简化和贝叶斯信息准则</em> </strong></p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="ma lz l"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">所有要素的 BIC 和 R 平方值</figcaption></figure><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi mk"><img src="../Images/bebec1c5aa9c8664f7fd83ec685a1f6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7tl_RPE5AAHVeNo4y6ic8g.jpeg"/></div></div></figure><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="ma lz l"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">丢弃某些要素后的 BIC 和 R 平方值</figcaption></figure><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi mm"><img src="../Images/08efedcce0ee607c2122875264a68d7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wfEHiSD68aN29-WuoqF0pw.jpeg"/></div></div></figure><p id="a1a0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">正态分布——检查正态性</strong></p><p id="6570" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ls">记住正态分布有偏斜且均值为 0 </em></p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="ma lz l"/></div></figure><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi mn"><img src="../Images/59f5eb713d49a795d1390a34dbb423c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zomudIKJ2UPAcUcTe8IIRA.jpeg"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">使用回归模型的度量</figcaption></figure><p id="c4f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在进行多元回归分析后，我们的结论是</p><ol class=""><li id="6e0e" class="lj lk iq jp b jq jr ju jv jy ll kc lm kg ln kk lo lp lq lr bi translated">我们拒绝零假设，因为它的 p 值。并非所有的列都是重要变量。</li><li id="412a" class="lj lk iq jp b jq lt ju lu jy lv kc lw kg lx kk lo lp lq lr bi translated">尽管 r 平方不是一个很好的拟合度，但它的表现很差。尽管 r 平方在显示数据之间的关系方面没有统计学意义，但可以看出，该值很弱且非常低，r 平方为 0.35，不适合该模型。它表明，回归模型解释了均值数据中约 35%的方差。即数据点远离拟合的回归线。即使我们在整体上执行 V.I.F .后删除了一些要素，该值也没有提高，这表明使用回归模型对于这种类型的数据集来说不是一个好的模型。</li></ol></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><p id="6662" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">用多类分类模型评估</strong></p><p id="4745" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">可以看出，相对于其他特征的目标输出(质量)不会绘制完美的拟合线，因此我们应该<strong class="jp ir">考虑使用分类算法(随机森林)</strong>。输出显示，我们可以根据它的唯一评级 3、4、5、6、7、8 对它进行分类。其中:</p><p id="35f6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3–4:餐酒-&gt; 0</p><p id="58f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">5–6:高级葡萄酒-&gt; 1</p><p id="963f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">7–8:美酒-&gt; 2</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="ma lz l"/></div></figure><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi mo"><img src="../Images/6793aa05f001a351b5ff7e5c84786ca9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ELATQpXIp3o0h8qJTRK9_Q.jpeg"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">带标签列的葡萄酒数据</figcaption></figure><p id="73ab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">训练和分割数据用于随机森林分类</strong></p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="ma lz l"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">执行随机森林分类器</figcaption></figure><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi mp"><img src="../Images/b46d744ba793d9509bafcae680dabe50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tWdVWsu_mQHn0VDnhGOAww.jpeg"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">输出</figcaption></figure><p id="df89" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以看到更好的准确度、精确度，f1 分数约为 86 %。计算精度和其他指标有一个简单的数学基础。虽然由于分类不平衡，精度不是多类分类的好指标，但最好的指标是精度、召回率，尤其是 f 值。</p><p id="752b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们看看测试数据的输出和它的预测值</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="ma lz l"/></div></figure><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi mq"><img src="../Images/a9dfaf2fcb753930582536f2da0f9cb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OIBHfzcrYIRUezj2-eQ6pg.jpeg"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">预测结果</figcaption></figure><p id="ae3d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">在 Scikit 中寻找重要特性-学习</strong>。在这里，您可以在红酒数据集中查找重要的要素或选择要素。在 scikit-learn 中，您可以通过以下步骤执行该任务:</p><p id="2d71" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="ls">首先</em> </strong>，你需要创建一个随机森林模型。<strong class="jp ir"> <em class="ls">第二个</em> </strong>，使用特征重要性变量查看特征重要性分数。<strong class="jp ir"> <em class="ls">第三个</em> </strong>，使用 seaborn 库可视化这些分数。</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="ma lz l"/></div></figure><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi mr"><img src="../Images/89f03ac996584e4d3308baff18a8073b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wGYTa3SJZ2N5cidV7ussew.jpeg"/></div></div></figure><p id="a728" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">形象化特征的重要性我们可以看到最重要的特征是酒精、挥发性酸度、硫酸盐、密度、总二氧化硫，它们会提高葡萄酒的质量。</p><p id="4a85" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当决定使用什么模型时，识别我们的输出(预测)变量的数据类型；无论是定量(连续)还是定性(离散或成组)都是一个重要因素。如果是定量的，所用的模型应该是回归分类。分析这两个模型(回归和分类),我们可以推断:</p><ol class=""><li id="1309" class="lj lk iq jp b jq jr ju jv jy ll kc lm kg ln kk lo lp lq lr bi translated">预测离散变量时，回归效果不佳，而分类对离散变量效果良好</li><li id="1905" class="lj lk iq jp b jq lt ju lu jy lv kc lw kg lx kk lo lp lq lr bi translated">当可视化输出及其特征时，回归拟合直线，而分类拟合 s 曲线</li><li id="ac6b" class="lj lk iq jp b jq lt ju lu jy lv kc lw kg lx kk lo lp lq lr bi translated">用于评估分类模型的度量包括精确度、召回率、f 分数和相对准确度，而对于回归，度量包括 rmse、mse 和相对 r 平方。</li></ol><p id="a28c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">资源</strong>:</p><div class="ms mt gp gr mu mv"><a href="https://github.com/MzSusann/Red-Wine-Quality-Prediction/blob/master/Red%20Wine%20Quality%20Prediction.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd ir gy z fp na fr fs nb fu fw ip bi translated">MzSusann 红酒质量预测</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">permalink dissolve GitHub 是超过 5000 万开发人员的家园，他们一起工作来托管和审查代码，管理…</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">github.com</p></div></div><div class="ne l"><div class="nf l ng nh ni ne nj ld mv"/></div></div></a></div><p id="119a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">【https://realpython.com/linear-regression-in-python/】T2 和</p><p id="5cf9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://medium.com/@sydneychen222/a-statistical-analysis-for-beginner-red-wine-quality-c5933aa1970c" rel="noopener">https://medium . com/@ sydneychen 222/a-初级红酒质量统计分析-c5933aa1970c </a></p><p id="c670" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://statisticsbyjim.com/regression/multicollinearity-in-regression-analysis/" rel="noopener ugc nofollow" target="_blank">https://statisticsbyjim . com/regression/多重共线性-回归-分析/ </a></p><p id="87ea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://machinelearningmastery.com/precision-recall-and-f-measure-for-imbalanced-classification/" rel="noopener ugc nofollow" target="_blank">https://machine learning mastery . com/precision-recall-and-f-measure-for-balanced-class ification/</a></p></div></div>    
</body>
</html>