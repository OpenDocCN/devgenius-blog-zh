# React 本机开发指南

> 原文：<https://blog.devgenius.io/react-native-development-guidelines-eadb3268e0c7?source=collection_archive---------0----------------------->

标准化对任何业务都有积极的影响。在软件行业也是如此，成功的软件开发需要特定的编码标准。对于大多数组织来说，软件程序的无缝运行对他们的成长至关重要。

创建高质量的软件、架构和代码并不容易。它需要软件开发团队的一致努力来满足可伸缩的代码质量目标，并遵循团队编程最佳实践来成功协作。这对于软件项目来说是非常重要的。当开发人员被要求在短时间内完成任务时，他们经常会回避质量标准。

任何新项目的首要任务是设计和构建一个可伸缩的架构，该架构可以轻松处理项目需求(中型到大型),而无需对项目的当前状态进行太多的更改。

让我们一步一步地开始，在进一步进入其他步骤之前，先谈一谈 React Native

# 反应自然

React Native 基本上使用单一代码库(即 JavaScript)为 android 和 IOS 平台构建应用程序。

*   帮助您创建真实而令人兴奋的移动应用的开源框架
*   由脸书于 2015 年开发
*   使用 JavaScript 构建跨平台应用

只需学习一次，编码一次，然后 React 原生 apps 和 Android 平台都有。

## **何时选择 React Native**

*   当您的应用程序需要依赖于特定平台的本机外观和感觉时。
*   更加可扩展和复杂的应用程序。
*   大量的社区支持包可用于更快的开发。

## **在不选择的时候做出反应的土著**

*   涉及大量计算和动画的大型项目。
*   具有复杂用户界面的应用程序
*   专为单一操作系统设计的应用
*   需要原生 API 的游戏和应用

# **项目设置架构**

对于大型项目，我们应该创建两个不同的存储库

*   包含可重用组件的组件库(可在应用中使用的所有通用可重用组件的 UI 库)
*   主应用程序 Repo 将使用上述 UI 库来构建可扩展和一致的屏幕。
*   理想情况下，我们应该确保屏幕和组件的封装。
*   每个根级文件夹都有一个 index.js 文件，帮助我们缩短导入时间。
*   文件夹中的所有内容都从相应目录的索引文件中导出。
*   文件名是用连字符连接的，就像这样
*   对于较短的导入，必须在每个目录中使用 index.js 文件
*   如果一个文件/关注点跨越多个文件，为它创建一个单独的目录

# **设置主题指南:**

没有一致的风格，很难得到最好的效果。设计系统是一组规则和原则，它们为应用程序的外观和感觉奠定了基础。使用设计系统时，你需要记住三件事。

*   **间距**:在使用跨平台应用程序时，屏幕上的不同组件之间的屏幕尺寸可能会有所不同，但要确保它们之间的间距一致，以获得一致的外观。
*   **颜色**:选择正确的颜色不仅是最重要的，你如何使用它们也很重要。一个很好的解决方案是使用调色板，您可以根据首选的命名约定来命名颜色，这增加了您的整体工作流程。
*   **排版**:我们经常忘记字体是如何改变应用程序在结果中的外观的。最好坚持使用有限的字体系列、字体粗细和字体大小，以获得令人愉悦的一致外观。

# **带 JS 的动态造型**

[***Styled-components***](https://www.npmjs.com/package/styled-components)是一个 CSS-in-JS 样式框架，它使用 JavaScript 中的标记模板文字和 CSS 的强大功能来提供一个平台，允许您编写实际的 CSS 来样式化 React 组件。

样式化组件是用样式化组件库编写的易于制作的 React 组件，在样式化组件库中，您可以用 JavaScript 代码中的普通 CSS 来样式化组件

# **响应式属性**

定义一些可扩展的函数，帮助处理不同设备维度上的 UI。参考[***react-native-normalize***](https://www.npmjs.com/package/react-native-normalize)进行参考

# **反应本地最佳编码实践**

*   组织导入，使所有库导入在文件顶部组合在一起，其余的导入随后进行
*   React 本机应用程序中的异常处理，对所有 API 块代码使用 try/catch 块。
*   对所有对象属性进行排序。
*   总是用分号结束属性。
*   尽可能多地使用无状态组件。
*   避免默认导出，使用命名导出以获得更好的 IDE 支持。
*   没有隐性回报
*   空状态应该隐式实现。
*   要使用任何包，应该优先考虑 react-native 社区。
*   在代码中添加注释以消除歧义
*   要放在 storybook/stories 文件夹下的故事。
*   使用特定于平台的样式
*   始终为每个元素分配唯一的键
*   删除不推荐的和不必要的注释代码。
*   拆下控制台。
*   不应该在 JSX 传递内联函数。
*   道具和样式应该在一个单独的文件中
*   避免内嵌样式
*   应该去掉重复的代码，遵循干的原则。
*   如果文件/组件太大，那么应该将它分成多个文件/组件。
*   应该遵循样式文件的样式指南..
*   代码有适当的单元测试，应该达到 80%以上的覆盖率。
*   测试是精心设计的
*   锁定依赖关系

# **代码质量**

## **在代码库中配置绝对相对路径**

使用绝对导入来更好地组织 React 项目是一个很好的方法。相对导入在重构过程中很难遵循和打破。随着项目的增长，绝对导入更容易管理您的项目。

绝对进口有一些优势。

*   没有../../../../见鬼。因此更容易打出进口。
*   轻松地将导入的代码复制粘贴到项目的另一个文件中，而不必修改导入路径。
*   它又短又甜

## **林挺**

使用 linter 使你的代码更容易被审查。遵循严格的林挺规则。这反过来有助于您编写干净、一致的代码。

规则推荐: [ESlint 社区规则](https://www.npmjs.com/package/@react-native-community/eslint-config)

# **一些推荐使用的库:**

*   **Redux** (如果性能是一个问题，提高性能的最好方法是跳过不必要的重新渲染，这样组件只在它们的数据实际改变时才重新渲染。React Redux 在内部实现了许多性能优化，以便您自己的组件只在实际需要时才重新呈现。)
*   **样式化组件**(样式化组件是使用样式化组件库编写的易于制作的 React 组件，在样式化组件库中，您可以在 JavaScript 代码中使用普通 CSS 来样式化组件)
*   **React Navigation** (这是现场使用最广泛、开发最活跃的库之一。也是 React 原生团队推荐的解决方案之一。这是脸书推动最多的社区解决方案。)
*   **Reanimated** (这是一个库，取代了 RN 的动画 API，提供了基于 JS 的动画 API，易于使用并在本机线程上运行(这需要开箱即用的性能)
*   **社区挂钩**(React Native API 变成了 React 挂钩，允许您直接在功能组件中访问异步 API，并提供了许多方便的挂钩供您使用)
*   Formik (它是 React 和 React Native 中用于构建表单的一小组 React 组件和挂钩。它有助于处理三个最烦人的部分:在表单状态中获取值和从表单状态中获取值。验证和错误消息。)
*   **React 原生快速镜像**(以极快的速度加载镜像，真的是一个很酷的库。来自 react-native-fast-image 的 FastImage 组件是对 SDWebImage (iOS)和 Glide (Android)的包装，它们是本地开发中非常强大的图像加载器
*   **Axios** (Axios 在一个小软件包中提供了一个简单易用的库，具有非常可扩展的接口)
*   **React Native Firebase crash lytics**(Firebase crash lytics 跟踪、区分优先级，&修复影响应用质量的稳定性问题。通过强大的实时崩溃报告，快速查明崩溃的根本原因)

# **性能优化**

*   **避免使用 ScrollView 渲染庞大的列表:**为了处理列表格式的大量数据，React Native 提供了 FlatList。FlatList 中的项目是延迟加载的。因此，应用程序确实使用了过多或不一致的内存量-
*   **避免将内联函数作为道具传递**:不推荐这样做，因为每当父类重新呈现一个新的引用时，该函数都会被再次创建。这意味着即使道具根本没有改变，子组件也会重新渲染。解决方案是将函数声明为类方法或函数组件中的函数，这样引用就消除了任何交叉呈现的可能性。
*   **利用 Hermes** : Hermes 是一个开源的 JavaScript 引擎，专门针对移动应用进行了优化。适用于 React 原生版本 0.60.4 及以上的 Android 平台。也适用于 0.64-RC.0 及以上版本的 iOS。Hermes 有助于减少 APK 的下载大小、内存占用和消耗，以及应用程序变得可交互所需的时间(TTI-交互时间)。
*   **memo ization using memo:**memo ization 是 React 中的一个优化特性，如果用在正确的地方，可以提高程序的性能。React 为我们提供了 PureComponent 和 memo 来实现 memo 化。PureComponent 与类组件一起使用，memo 与函数组件一起使用。内存化通过在传递相同属性时存储函数的结果来提高性能，从而减少重新渲染的次数。但是，在没有性能问题的地方过度使用内存化会导致性能下降。

# **安全**

开发移动应用程序时的一个主要问题是数据安全性。

尤其是涉及到非常敏感的数据时，任何安全漏洞都可能导致不可挽回的损失。几乎所有的应用程序都包含用户的关键信息，因此应用程序安全性是最佳元素，尤其是在处理密码、touch ids、帐户名、信用卡信息等时

*   **存储敏感信息**:使用加密存储只是为了确保我们的应用安全。异步存储很棒，但它缺乏安全性。这在存储敏感数据(如访问令牌、支付信息等)时不太理想。
*   [Encrypted Storage Package](https://github.com/emeraldsanto/react-native-encrypted-storage) 旨在解决这个问题，它提供了一个包装 Android 的 EncryptedSharedPreferences 和 iOS 的 Keychain 的包装器，以加密的格式保存您的信息，这样就不会被攻击者读取。
*   [安全方面要考虑的](https://medium.com/simform-engineering/security-aspects-to-consider-for-a-react-native-application-95556f0e4244)

# **测试**

## **单元&快照测试(Jest)**

根据 React-native 文档，React 组件负责渲染你的 app，用户会直接与其输出进行交互。即使你的应用程序的业务逻辑有很高的测试覆盖率并且是正确的，如果没有组件测试，你仍然可能向你的用户交付一个不完整的 UI。

为了测试 React 组件，您可能需要测试两件事情:

*   **交互**:确保组件在与用户交互时(如用户按下按钮时)行为正确
*   **渲染**:确保 React 使用的组件渲染输出是正确的(例如，按钮在 UI 中的外观和位置)

例如，如果您有一个带有 onPress 侦听器的按钮，您希望测试该按钮是否正确显示，以及组件是否正确处理点击按钮。

对于交互，我们正在执行组件测试以验证行为，比如按下事件和按下特定组件中的图标。对于渲染，我们正在编写一个快照测试来验证组件 UI 的外观和位置。

## **E2E 检测(排毒/Appium)**

端到端测试是一种从头到尾测试整个软件产品的技术，以确保应用程序流按预期运行。它定义了产品的系统依赖关系，并确保所有集成部分按预期协同工作。

端到端(E2E)测试的主要目的是通过模拟真实的用户场景，验证被测系统及其组件的集成和数据完整性，从最终用户的体验出发进行测试。

我们建议使用 [Detox](https://github.com/wix/Detox) 进行端到端测试。手机自动化测试最困难的部分是测试金字塔的顶端——e2e。E2E 测试的核心问题是剥落——测试通常是不确定的。通过从黑盒测试转向灰盒测试，Detox 正面解决了片状剥落问题。