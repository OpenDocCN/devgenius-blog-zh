<html>
<head>
<title>Blur effect in SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SwiftUI 中的模糊效果</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/blur-effect-with-vibrancy-in-swiftui-bada837fdf50?source=collection_archive---------6-----------------------#2020-06-17">https://blog.devgenius.io/blur-effect-with-vibrancy-in-swiftui-bada837fdf50?source=collection_archive---------6-----------------------#2020-06-17</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="b674" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你接触智能手机的时间够长，你可能还记得 iOS 7。这是对 iPhone 的一次巨大更新，不仅带来了新的特性和功能，还带来了全新的设计。iOS 的这次更新不亚于对操作系统的外观和感觉的一次全面革新。</p><p id="76cc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">更有趣的变化之一是半透明工具栏和背景的出现，如控制中心。那种“模糊”的“毛玻璃”背景效果，这种背景足够透明，可以分辨出背后有什么东西。看起来真好😍</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/23e27698365342eb22a0b8edb2df3f8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:952/format:webp/1*Viyk93h8r2XhlBhuFM9Ebw.jpeg"/></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk translated">iOS 7 上的控制中心</figcaption></figure><p id="e52c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在有一种非常简单的方法通过<code class="fe ku kv kw kx b">UIVisualEffectView</code>来实现模糊效果。</p><p id="e839" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">您可以马上看出这来自于<code class="fe ku kv kw kx b">UIKit</code>,这意味着可能需要一些调整才能在 SwiftUI 中使用它。</p><p id="7c32" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们开始吧！</p><h1 id="8bcd" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">创建模糊视图</h1><p id="2822" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">当我们需要 SwiftUI 中的<code class="fe ku kv kw kx b">UIKit</code>组件时，我们通常求助于<code class="fe ku kv kw kx b">UIViewRepresentable</code>协议。这个协议的目的是让我们将 SwiftUI 状态和生命周期事件翻译成<code class="fe ku kv kw kx b">UIKit</code>。例如，在 SwiftUI 视图中，当它们的状态改变时，它们经常被销毁和重新创建，而在<code class="fe ku kv kw kx b">UIKit</code>中，UIView 通常被保存和更新。</p><p id="525a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们从创建一个实现<code class="fe ku kv kw kx b">UIViewRepresentable</code>协议的<code class="fe ku kv kw kx b">BlurView</code>开始。</p><h2 id="9953" class="mb kz in bd la mc md dn le me mf dp li jv mg mh lm jz mi mj lq kd mk ml lu mm bi translated">设置<code class="fe ku kv kw kx b">UIViewRepresentable</code></h2><p id="c59b" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">这里的两个重要方法是<code class="fe ku kv kw kx b">makeUIView</code>和<code class="fe ku kv kw kx b">updateUIView</code>，前者在视图需要初始化时被调用，后者在 SwiftUI 检测到变化并要求<code class="fe ku kv kw kx b">BlurView</code>更新其布局、位置等时被调用。</p><p id="90d7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这里，我们还将指定我们将要使用的<code class="fe ku kv kw kx b">UIKit</code>视图的类型，即<code class="fe ku kv kw kx b">UIVisualEffectView</code></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mn mo l"/></div></figure><h2 id="8aab" class="mb kz in bd la mc md dn le me mf dp li jv mg mh lm jz mi mj lq kd mk ml lu mm bi translated">创建 UIVisualEffectView</h2><p id="2d05" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated"><code class="fe ku kv kw kx b">UIVisualEffectView</code>是一个帮助我们创造视觉效果的物体。在我们的例子中，我们的目标是创建一个模糊效果，由<code class="fe ku kv kw kx b">UIBlurEffect</code>表示:</p><pre class="kj kk kl km gt mp kx mq mr aw ms bi"><span id="bece" class="mb kz in kx b gy mt mu l mv mw">UIVisualEffectView(effect: UIBlurEffect(style: .systemMaterial))</span></pre><p id="e4d3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">模糊效果有几种风格，如<code class="fe ku kv kw kx b">UIBlurEffect.Style</code>枚举所描述的。在上面的截图中，我使用<code class="fe ku kv kw kx b">systemMaterial</code>作为默认值。</p><p id="718e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在<code class="fe ku kv kw kx b">BlurView</code>看起来是这样的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="007a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你可能会问为什么我们需要在视图更新时重新应用模糊效果？答案就在 UIKit 内部，模糊效果考虑了整个视图层次。例如，由于模糊效果创造了透明感，每当我们的模糊视图下的内容改变时，就需要重新应用模糊。</p><p id="9ef2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">截至目前，模糊风格被硬编码为<code class="fe ku kv kw kx b">.systemMaterial</code>。如果我们可以在布局中使用<code class="fe ku kv kw kx b">BlurView</code>时选择模糊效果样式，那就太好了。</p><p id="c7a9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为此，我将创建一个初始化器，它接收要用作参数的特定样式:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mn mo l"/></div></figure><h1 id="9e28" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">来测试一下吧！</h1><p id="20ee" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">这是一大段代码，但是让我们看看它是什么样子的。</p><p id="3a13" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们创建的<code class="fe ku kv kw kx b">BlurView</code>现在可以用作不同组件的背景视图。大概是这样的:</p><pre class="kj kk kl km gt mp kx mq mr aw ms bi"><span id="d66c" class="mb kz in kx b gy mt mu l mv mw">VStack(spacing: 6) {<br/>  Text("BlurViews are awesome")<br/>}<br/>.background(BlurView())</span></pre><p id="ebcf" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">普通白色背景上的模糊效果不会很有趣，所以我打算用纯色填充下面的视图，这样我们就可以看到这种效果了。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mn mo l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi mx"><img src="../Images/7b130c5437a919e8af94cff0819dca1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rcvq_CgdTqXCgNEEIxa-DQ.png"/></div></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk translated">内容视图预览。swift</figcaption></figure><ul class=""><li id="ea20" class="nc nd in jm b jn jo jr js jv ne jz nf kd ng kh nh ni nj nk bi translated">我使用 ZStack 来排序视图的内容——背景颜色，然后在它上面使用包含一些文本的 VStack。</li><li id="881f" class="nc nd in jm b jn nl jr nm jv nn jz no kd np kh nh ni nj nk bi translated">BlurView 作为 VStack 的背景应用。</li></ul><p id="1659" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果我们使用图片作为背景而不是纯色，效果会更好:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi nq"><img src="../Images/5db8af36d1f8a8c8114bf6c5e4d260ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sDz0XiQhwflDcf6Ip6gVJA.png"/></div></div></figure></div></div>    
</body>
</html>