<html>
<head>
<title>Swift custom operator — Forward Pipe or Pipe Forward</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Swift 自定义操作符—转发管道或管道转发</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/forward-pipe-or-pipe-forward-in-swift-3a6da6f9c000?source=collection_archive---------8-----------------------#2020-06-29">https://blog.devgenius.io/forward-pipe-or-pipe-forward-in-swift-3a6da6f9c000?source=collection_archive---------8-----------------------#2020-06-29</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="53f5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">有时在 swift 中使用自定义操作符是可以的，如果它易于理解并简化了您的代码😉</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/569c059ad880e1e7dcaf866fbd27f653.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*leM2HKWLQPWpIkX0"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">塞缪尔·西亚尼帕尔在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="2bfa" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们先了解一下为什么、做什么以及如何使用这个前向管道操作符</p></div><div class="ab cl kz la hr lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="ig ih ii ij ik"><p id="0174" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">【为什么】我们需要它</strong> 🧐 <strong class="jm io"> : </strong>在 swift 中编写您的应用程序时，您可能会遇到接受输入参数并返回某些内容的函数，这些返回值被其他函数使用，等等。</p><p id="a3be" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在下面的函数调用中，乘法函数调用出现在 add <strong class="jm io"> </strong>函数调用之前，但实际上 add 函数首先执行，因为<strong class="jm io">组合函数由内向外执行</strong>。在这种情况下，前向管道操作符就很方便了，它将提高代码的可读性。</p><pre class="kj kk kl km gt lg lh li lj aw lk bi"><span id="416a" class="ll lm in lh b gy ln lo l lp lq">multiply(val: add(val: 2))</span></pre><p id="330b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">“什么”是前进管</strong>🤷<strong class="jm io"> : </strong>前向管道运算符是一个<strong class="jm io">中缀运算符</strong>大多出现在函数式编程语言中，如<strong class="jm io"> F# </strong>和<strong class="jm io"> Elixir </strong>。用<code class="fe lr ls lt lh b">|&gt;</code>符号表示。该运算符从左到右工作，即该运算符从左侧获取值，并将其作为输入传递给右侧的函数，如下所示。</p><pre class="kj kk kl km gt lg lh li lj aw lk bi"><span id="e2ca" class="ll lm in lh b gy ln lo l lp lq">2 |&gt; add |&gt; multiply</span></pre><p id="8165" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">“如何”实现快速转发管道</strong>👨‍💻<strong class="jm io"> : </strong>要在 swift 中创建新操作员，您必须首先定义如下所示的<code class="fe lr ls lt lh b">precedancegroup</code>。</p><pre class="kj kk kl km gt lg lh li lj aw lk bi"><span id="9a2c" class="ll lm in lh b gy ln lo l lp lq"><strong class="lh io">precedencegroup</strong> ForwardPipe {<br/>    <strong class="lh io">associativity</strong>: <strong class="lh io">left</strong><br/>}</span></pre><p id="397c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">结合性定义了属于同一优先组的运算符如何组合在一起，即从左还是从右。换句话说，我们希望操作符在处理<strong class="jm io">前向管道</strong>时，隐式地对其左侧<strong class="jm io">的值进行分组。您也可以使用<code class="fe lr ls lt lh b">higherThan</code>或<code class="fe lr ls lt lh b">lowerThan</code>属性指定一个操作员相对于其他操作员的优先级。</strong></p><blockquote class="lu lv lw"><p id="5c90" class="jk jl lx jm b jn jo jp jq jr js jt ju ly jw jx jy lz ka kb kc ma ke kf kg kh ig bi translated"><strong class="jm io">注意:</strong>如果你创建一个没有任何优先组的操作符，那么它属于没有结合性的<code class="fe lr ls lt lh b">DefaultPrecedance</code>优先组类别。</p></blockquote><p id="480f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要了解更多关于优先级和结合性的信息，你可以参考苹果的官方文件<a class="ae ky" href="https://developer.apple.com/documentation/swift/swift_standard_library/operator_declarations" rel="noopener ugc nofollow" target="_blank">这个</a>和<a class="ae ky" href="https://docs.swift.org/swift-book/LanguageGuide/AdvancedOperators.html#//apple_ref/doc/uid/TP40014097-CH27-ID41" rel="noopener ugc nofollow" target="_blank">这个</a></p><p id="b01c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">那很酷，但是你的接线员在哪里？🤔🤔 🤔</p><p id="c16e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">好吧。好吧，我们还没有声明一个。让我们继续创建我们的自定义<strong class="jm io">中缀</strong>操作符，它将由符号<code class="fe lr ls lt lh b">|&gt;</code>表示。</p><pre class="kj kk kl km gt lg lh li lj aw lk bi"><span id="6227" class="ll lm in lh b gy ln lo l lp lq"><strong class="lh io">infix</strong> <strong class="lh io">operator</strong> |&gt; : ForwardPipe</span></pre><p id="2265" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这样操作符声明就完成了。是的，你没听错😁</p><p id="52d2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">但是 wait✋.我们现在必须创建一个函数来实现我们的操作符的功能。</p><pre class="kj kk kl km gt lg lh li lj aw lk bi"><span id="1402" class="ll lm in lh b gy ln lo l lp lq"><strong class="lh io">func</strong> |&gt; &lt;T, U&gt;(value: T, function: ((T) -&gt; U)) -&gt; U {<br/>    <strong class="lh io">return</strong> function(value)<br/>}</span></pre><p id="afe6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">上面的函数名为<code class="fe lr ls lt lh b">|&gt;</code>，带有两个通用类型参数<code class="fe lr ls lt lh b">T</code>和<code class="fe lr ls lt lh b">U</code>以及两个参数。<code class="fe lr ls lt lh b">T</code>是输入值，该值进一步馈入<code class="fe lr ls lt lh b">function</code>，T5 接受<code class="fe lr ls lt lh b">T</code>并返回<code class="fe lr ls lt lh b">U</code>。整个函数返回值<code class="fe lr ls lt lh b">U</code>，因为这是<code class="fe lr ls lt lh b">function</code>返回的值。</p><p id="24c8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">下面是完整的代码片段和示例。🤩🤩🤩🤩</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="48ec" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这就是斯威夫特的前进管道。🥳</p><h1 id="5ccd" class="md lm in bd me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz bi translated">结论:</h1><p id="65da" class="pw-post-body-paragraph jk jl in jm b jn na jp jq jr nb jt ju jv nc jx jy jz nd kb kc kd ne kf kg kh ig bi translated">在本文中，我们了解了如何在 swift 中创建自定义操作员。我们创建了正向管道操作符，并了解了如何使用它。</p><p id="9788" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">享受…..还有快乐编码…🙂</p></div><div class="ab cl kz la hr lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="ig ih ii ij ik"><h1 id="531e" class="md lm in bd me mf nf mh mi mj ng ml mm mn nh mp mq mr ni mt mu mv nj mx my mz bi translated"><em class="nk">延伸阅读:</em></h1><div class="nl nm gp gr nn no"><a href="http://undefinedvalue.com/fs-pipe-forward-operator-swift.html" rel="noopener  ugc nofollow" target="_blank"><div class="np ab fo"><div class="nq ab nr cl cj ns"><h2 class="bd io gy z fp nt fr fs nu fu fw im bi translated">未定义的值</h2><div class="nv l"><h3 class="bd b gy z fp nt fr fs nu fu fw dk translated">注意:在 2015 年 WWDC 大会上，Apple 发布了 Swift 2，其中包括一些变化和一个名为“协议扩展”的新功能，该功能…</h3></div><div class="nw l"><p class="bd b dl z fp nt fr fs nu fu fw dk translated">undefinedvalue.com</p></div></div><div class="nx l"><div class="ny l nz oa ob nx oc ks no"/></div></div></a></div></div></div>    
</body>
</html>