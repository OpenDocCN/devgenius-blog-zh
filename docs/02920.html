<html>
<head>
<title>Top React Hooks — States and Requests</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Top React 挂钩—状态和请求</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/top-react-hooks-states-and-requests-e5ea438c9dee?source=collection_archive---------6-----------------------#2020-09-11">https://blog.devgenius.io/top-react-hooks-states-and-requests-e5ea438c9dee?source=collection_archive---------6-----------------------#2020-09-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/1e85fbb06032ddf8cba906d2ba0c44c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9iAqvZVhDvgrAXxg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@vidarnm?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">维达尔·诺德里-马西森</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="54f1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Hooks 包含了 React 应用程序中的逻辑代码。</p><p id="4586" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以创建自己的钩子，使用别人提供的钩子。</p><p id="c5df" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看一些有用的 React 挂钩。</p><h1 id="49f7" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">钩子状态</h1><p id="5e7a" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用 Hookstate 钩子来改变应用程序中的全局和局部状态。</p><p id="9742" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了使用它，我们运行:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="a55e" class="mn lc iq mj b gy mo mp l mq mr">npm install --save @hookstate/core</span></pre><p id="3341" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">或者:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="1f1d" class="mn lc iq mj b gy mo mp l mq mr">yarn add @hookstate/core</span></pre><p id="6f35" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">来安装它。</p><p id="1df2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们可以通过编写以下内容来管理全局状态:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="05f6" class="mn lc iq mj b gy mo mp l mq mr">import React from "react";<br/>import { createState, useState } from "@hookstate/core";<br/>const globalState = createState(0);</span><span id="7cc1" class="mn lc iq mj b gy ms mp l mq mr">export default function App() {<br/>  const state = useState(globalState);<br/>  return (<br/>    &lt;&gt;<br/>      &lt;p&gt;Counter value: {state.get()}&lt;/p&gt;<br/>      &lt;button onClick={() =&gt; state.set(p =&gt; p + 1)}&gt;Increment&lt;/button&gt;<br/>    &lt;/&gt;<br/>  );<br/>}</span></pre><p id="fa1d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe mt mu mv mj b">createState</code>函数创建一个全局状态对象，然后将它传递给 Hookstate 的<code class="fe mt mu mv mj b">useState</code>钩子。</p><p id="eddf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以用<code class="fe mt mu mv mj b">get</code>和<code class="fe mt mu mv mj b">set</code>分别获取和设置状态。</p><p id="14ae" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要改变本地状态，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="62b1" class="mn lc iq mj b gy mo mp l mq mr">import React from "react";<br/>import { useState } from "@hookstate/core";</span><span id="5ad4" class="mn lc iq mj b gy ms mp l mq mr">export default function App() {<br/>  const state = useState(0);<br/>  return (<br/>    &lt;&gt;<br/>      &lt;p&gt;Counter value: {state.get()}&lt;/p&gt;<br/>      &lt;button onClick={() =&gt; state.set(p =&gt; p + 1)}&gt;Increment&lt;/button&gt;<br/>    &lt;/&gt;<br/>  );<br/>}</span></pre><p id="34c9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">唯一的区别是我们将状态值直接传递给了<code class="fe mt mu mv mj b">useState</code>钩子。</p><p id="0100" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">状态可以嵌套。</p><p id="8e3e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="1c99" class="mn lc iq mj b gy mo mp l mq mr">import React from "react";<br/>import { useState, self } from "@hookstate/core";</span><span id="8725" class="mn lc iq mj b gy ms mp l mq mr">export default function App() {<br/>  const state = useState([{ name: "Untitled" }]);</span><span id="806f" class="mn lc iq mj b gy ms mp l mq mr">console.log(state);<br/>  return (<br/>    &lt;&gt;<br/>      {state.map((task, index) =&gt; (<br/>        &lt;p&gt;<br/>          {task.name.get()} {index}<br/>        &lt;/p&gt;<br/>      ))}<br/>      &lt;button onClick={() =&gt; state[self].merge([{ name: "Untitled" }])}&gt;<br/>        add task<br/>      &lt;/button&gt;<br/>    &lt;/&gt;<br/>  );<br/>}</span></pre><p id="ee2c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们对数组使用了<code class="fe mt mu mv mj b">useState</code>钩子。</p><p id="e77c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了向数组中添加新值，我们使用<code class="fe mt mu mv mj b">state[self]</code>对象的<code class="fe mt mu mv mj b">merge</code>方法向数组中添加一个条目。</p><p id="b28d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们可以像在<code class="fe mt mu mv mj b">map</code>回调中一样，通过使用属性的<code class="fe mt mu mv mj b">get</code>方法来获取条目。</p><p id="4e49" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还可以添加作用域、异步和递归状态。</p><p id="25c7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以使用@jzone/react-request-hook 来帮助我们简化请求。</p><p id="f2fa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以通过运行以下命令来安装它:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="fb25" class="mn lc iq mj b gy mo mp l mq mr">npm install @jzone/react-request-hook</span></pre><p id="abc2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">或者:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="77b8" class="mn lc iq mj b gy mo mp l mq mr">yarn add @jzone/react-request-hook</span></pre><p id="e7bf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以通过写来使用它:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="d25f" class="mn lc iq mj b gy mo mp l mq mr">import React from "react";<br/>import useFetchData from "@jzone/react-request-hook";<br/>import axios from "axios";</span><span id="0ea4" class="mn lc iq mj b gy ms mp l mq mr">export default function App() {<br/>  const [{ data, isLoading, error }, fetchData] = useFetchData(data =&gt;<br/>    axios.get("https://api.agify.io/?name=michael", { params: data })<br/>  );</span><span id="3a89" class="mn lc iq mj b gy ms mp l mq mr">  React.useEffect(() =&gt; {<br/>    fetchData();<br/>  }, [fetchData]);</span><span id="0539" class="mn lc iq mj b gy ms mp l mq mr">  if (!data) {<br/>    return !error ? &lt;div&gt;loading...&lt;/div&gt; : &lt;div&gt;error&lt;/div&gt;;<br/>  }</span><span id="f9e2" class="mn lc iq mj b gy ms mp l mq mr">  return (<br/>    &lt;div&gt;<br/>      &lt;p&gt;{JSON.stringify(data)}&lt;/p&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="6f1e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们导入了<code class="fe mt mu mv mj b">useFetchData</code>钩子来导入钩子。</p><p id="b65c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们安装了 Axios 来将其用作 HTTP 客户端。</p><p id="e6e1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们使用钩子返回的<code class="fe mt mu mv mj b">fetchData</code>函数来获取数据。</p><p id="6a77" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">data</code>有响应数据。</p><p id="226d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们可以随心所欲地渲染。</p><p id="4a80" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它还返回<code class="fe mt mu mv mj b">isLoading</code>状态以指示加载。</p><p id="92ee" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">error</code>有错误。</p><p id="af1f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以根据其他要求定制。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/670ea066b18617613751dd4240db02cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*246Oe2mmDFKa48R9"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">内特·切尼在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="275e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="9912" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">Hookstate 是管理状态的一个有用的钩子。</p><p id="507e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">@jzone/react-request-hook 是一个让我们更容易获取数据的钩子。</p></div></div>    
</body>
</html>