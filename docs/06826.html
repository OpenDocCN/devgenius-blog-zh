<html>
<head>
<title>Use Qryptic API with Python and requests library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 和请求库的加密 API</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/use-qryptic-api-with-python-and-requests-library-3a20eba79a48?source=collection_archive---------20-----------------------#2022-02-05">https://blog.devgenius.io/use-qryptic-api-with-python-and-requests-library-3a20eba79a48?source=collection_archive---------20-----------------------#2022-02-05</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/8c7c7c3f78bb8723f5c5093e8612c1a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wRSBD3cpppQ8K2URPbMU-A.png"/></div></div></figure><p id="8a73" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在本指南中，我将向您展示如何开始使用 Qryptic API 并使用 Python 获取加密交换的数据。</p><p id="c832" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">你需要做的第一件事是加入加密不和谐服务器<a class="ae kt" href="https://discord.gg/xrtwNfqshz" rel="noopener ugc nofollow" target="_blank">https://discord.gg/xrtwNfqshz</a>当你进入时，你需要通过进入#qryptic-api 频道申请一个账户，管理员/mod 会给你发送认证信息。由于前端还没有到位，目前你自己没有办法做到这一点。</p><p id="15cc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">因此，当获得所有认证信息时，我们应该创建一个新的 Python 文件，并导入我们将使用的必要库:</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="95e6" class="ld le in kz b gy lf lg l lh li">import requests<br/>from requests.exceptions import ConnectionError, Timeout, TooManyRedirects</span></pre><p id="f01e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">然后，我们需要添加一些常量来保存关于 API URL、令牌生成 URL、客户端 id、客户端密码、用户名、密码和我们将使用的授权类型的信息:</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="ebb9" class="ld le in kz b gy lf lg l lh li">API_URL = 'https://api.qryptic.net/v1'<br/>API_TOKEN_URL = 'https://qryptic.net/auth/realms/QrypticAPIKeycloak/protocol/openid-connect/token'<br/>API_CLIENT_ID = 'login-app'<br/>API_CLIENT_SECRET = '&lt;get a client secret from discord admin&gt;'<br/>API_USERNAME = '&lt;your username&gt;'<br/>API_PASSWORD = '&lt;your password&gt;'<br/>API_GRANT_TYPE = 'password'</span></pre><p id="90a5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">然后，我们将定义一个变量，在获取访问令牌时保存它:</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="a4ae" class="ld le in kz b gy lf lg l lh li">access_token = ''</span></pre><p id="b622" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">下面我们定义一个函数，通过发送带有认证信息的主体信息来生成访问令牌。我们还将变量 access_token 定义为全局变量，这样我们就可以在另一个函数中访问它:</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="19a1" class="ld le in kz b gy lf lg l lh li">def post_get_access_token():<br/>    # Doing a POST request and obtaining the access token<br/><br/>    request_body = {<br/>        "client_id": API_CLIENT_ID,<br/>        "client_secret": API_CLIENT_SECRET,<br/>        "username": API_USERNAME,<br/>        "password": API_PASSWORD,<br/>        "grant_type": API_GRANT_TYPE<br/>    }<br/>    try:<br/>        headers = {'Content-Type': 'application/x-www-form-urlencoded'}<br/>        response = requests.post(API_TOKEN_URL, data=request_body, headers=headers)<br/>        <br/>        global access_token<br/>        access_token = response.json()['access_token']<br/>    except (ConnectionError, Timeout, TooManyRedirects):<br/>        print('Could not communicate to Qryptic API...')</span></pre><p id="d397" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">然后，在本例中，存在于 API 上的交换我们在头中使用获得的访问令牌，因为我们需要告诉 API 我们已经对我们进行了身份验证:</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="5e72" class="ld le in kz b gy lf lg l lh li">def get_exchanges():<br/>    # Getting all the exchanges using the access token<br/><br/>    headers = {<br/>        'Authorization': 'Bearer ' + access_token,<br/>        'Content-type': 'application/json',<br/>    }<br/>    try:<br/>        r = requests.get(API_URL + '/exchanges', headers=headers)<br/>        print(r.text)<br/>    except (ConnectionError, Timeout, TooManyRedirects):<br/>        print('Could not communicate to Qryptic API...')</span></pre><p id="7819" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这里我们将调用我们之前定义的函数:</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="bd0a" class="ld le in kz b gy lf lg l lh li">def main():<br/>    post_get_access_token()<br/>    get_exchanges()<br/><br/><br/>if __name__ == '__main__':<br/>  main()</span></pre><p id="7d7f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">差不多就是这样。它对加密货币和钱包等同样有效。完整的例子在我的 GitHub 上:https://github.com/mjovanc/qryptic-api-python<a class="ae kt" href="https://github.com/mjovanc/qryptic-api-python" rel="noopener ugc nofollow" target="_blank"/></p></div></div>    
</body>
</html>