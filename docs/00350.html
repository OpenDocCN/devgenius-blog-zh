<html>
<head>
<title>Getting started in Natural Language Processing with spaCy: Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">spaCy 自然语言处理入门:第 1 部分</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/getting-started-in-natural-language-processing-with-spacy-part-1-5026748cadc2?source=collection_archive---------10-----------------------#2020-06-03">https://blog.devgenius.io/getting-started-in-natural-language-processing-with-spacy-part-1-5026748cadc2?source=collection_archive---------10-----------------------#2020-06-03</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="ad57" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">spaCy(<a class="ae ki" href="https://spacy.io/" rel="noopener ugc nofollow" target="_blank">https://spacy.io/</a>)是一个开源的 Python 库，可以解析和“理解”大量文本。针对特定语言(英语、法语、德语等)提供不同的型号。).</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/a3ee50418fc6cd06fea40cfd88b930b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HTtQseukwrBiREJf8MSVcA.jpeg"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk translated">图片来自<a class="ae ki" href="https://spacy.io/" rel="noopener ugc nofollow" target="_blank">https://spacy.io/</a></figcaption></figure><h2 id="3499" class="kz la in bd lb lc ld dn le lf lg dp lh jv li lj lk jz ll lm ln kd lo lp lq lr bi translated">安装和设置</h2><p id="ebb5" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">安装过程分为两步。首先，使用 conda 或 pip 安装 spaCy。接下来，根据语言下载您想要的特定型号。<br/>欲了解更多信息，请访问<a class="ae ki" href="https://spacy.io/usage/" rel="noopener ugc nofollow" target="_blank">https://spacy.io/usage/</a></p><p id="4b01" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">从命令行或终端:<br/> <code class="fe lx ly lz ma b"><em class="mb">conda install -c conda-forge spacy</em></code> <em class="mb"> <br/> </em>或<em class="mb"> <br/> </em> <code class="fe lx ly lz ma b"><em class="mb">pip install -U spacy<br/></em></code> <em class="mb">或者你可以创建一个虚拟环境:<br/> </em> <code class="fe lx ly lz ma b"><em class="mb">conda create -n spacyenv python=3 spacy=2</em></code></p><p id="4ee6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">2.接下来，同样从命令行(您必须以 admin 身份运行或使用 sudo): <br/> <code class="fe lx ly lz ma b"><em class="mb">python -m spacy download en<br/></em></code> <em class="mb">如果成功，您应该会看到如下消息:<br/></em><code class="fe lx ly lz ma b"><strong class="jm io"><em class="mb">Linking successful</em></strong></code><em class="mb"><br/></em><code class="fe lx ly lz ma b"><em class="mb">C:\Anaconda3\envs\spacyenv\lib\site-packages\en_core_web_sm --&gt;</em></code><em class="mb"><br/></em><code class="fe lx ly lz ma b"><em class="mb">C:\Anaconda3\envs\spacyenv\lib\site-packages\spacy\data\en</em></code></p><p id="51af" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe lx ly lz ma b"><em class="mb">You can now load the model via spacy.load('en')</em></code></p><h2 id="31e3" class="kz la in bd lb lc ld dn le lf lg dp lh jv li lj lk jz ll lm ln kd lo lp lq lr bi translated">在 Python 中使用空间</h2><p id="f233" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">这是导入和使用 spaCy 的一组典型说明。如果这需要一段时间，不要惊讶——spaCy 有一个相当大的库要加载:</p><pre class="kk kl km kn gt mc ma md me aw mf bi"><span id="941c" class="kz la in ma b gy mg mh l mi mj"><em class="mb"># Import spaCy and load the language library<br/></em><strong class="ma io">import</strong> spacy<br/>nlp <strong class="ma io">=</strong> spacy.load('en_core_web_sm')<br/><em class="mb"># Create a Doc object<br/></em>doc <strong class="ma io">=</strong> nlp(u'Microsoft is looking at buying a U.S. startup for $6 million')<br/><em class="mb"># Print each token separately<br/></em><strong class="ma io">for</strong> token <strong class="ma io">in</strong> doc:<br/>   print(token.text, token.pos_, token.dep_)</span><span id="bbee" class="kz la in ma b gy mk mh l mi mj">Microsoft PROPN nsubj<br/>is AUX aux<br/>looking VERB ROOT<br/>at ADP prep<br/>buying VERB pcomp<br/>a DET det<br/>U.S. PROPN compound<br/>startup NOUN dobj<br/>for ADP prep<br/>$ SYM quantmod<br/>6 NUM compound<br/>million NUM pobj</span></pre><p id="85ea" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这看起来不太用户友好，但是我们马上看到一些有趣的事情发生:<br/>微软被认为是一个专有名词，而不仅仅是句子开头的一个单词。<br/>美国是作为一个实体保持在一起的(我们称之为‘代币’)</p><p id="0266" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">随着我们对空间的深入探究，我们将会看到这些缩写的意思以及它们是如何衍生出来的。我们还将看到 spaCy 如何将最后三个令牌组合<code class="fe lx ly lz ma b">$6 million</code>解释为引用<strong class="jm io"> <em class="mb">金钱</em> </strong>。</p><h2 id="a761" class="kz la in bd lb lc ld dn le lf lg dp lh jv li lj lk jz ll lm ln kd lo lp lq lr bi translated">空间对象</h2><p id="1b09" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">在上面的单元格中导入 spacy 模块后，我们加载了一个<strong class="jm io">模型</strong>，并将其命名为<code class="fe lx ly lz ma b">nlp</code>。<br/>接下来，我们通过将模型应用到我们的文本来创建一个<strong class="jm io"> Doc </strong>对象，并将其命名为<code class="fe lx ly lz ma b">doc</code>。<br/> spaCy 还构建了一个配套的<strong class="jm io"> Vocab </strong>对象，我们将在后面的章节中介绍。<br/>保存已处理文本的<strong class="jm io"> Doc </strong>对象是我们这里的重点。</p><h2 id="825e" class="kz la in bd lb lc ld dn le lf lg dp lh jv li lj lk jz ll lm ln kd lo lp lq lr bi translated">管道</h2><p id="7d28" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">当我们运行<code class="fe lx ly lz ma b">nlp</code>时，我们的文本进入<em class="mb">处理管道</em>，它首先分解文本，然后执行一系列操作来标记、解析和描述数据。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi ml"><img src="../Images/330fcb4f4bf178e5e8a3ff950c894d51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w4qkY84JfG5h2ChhR8SKnA.png"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk translated">来自<a class="ae ki" href="https://spacy.io/usage/spacy-101#pipelines" rel="noopener ugc nofollow" target="_blank">空间</a>的管道图像</figcaption></figure><p id="5f32" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们可以查看管道中当前存在哪些组件。在后面的章节中，我们将学习如何禁用组件并根据需要添加新组件。</p><pre class="kk kl km kn gt mc ma md me aw mf bi"><span id="bb40" class="kz la in ma b gy mg mh l mi mj">In [1]:nlp.pipeline<br/>Out[2]:<br/>[('tagger', &lt;spacy.pipeline.Tagger at 0x237cb1e8f98&gt;),<br/> ('parser', &lt;spacy.pipeline.DependencyParser at 0x237cb2852b0&gt;),<br/> ('ner', &lt;spacy.pipeline.EntityRecognizer at 0x237cb285360&gt;)]<br/>In [3]:nlp.pipe_names<br/>Out[3]:['tagger', 'parser', 'ner']</span></pre><h2 id="8409" class="kz la in bd lb lc ld dn le lf lg dp lh jv li lj lk jz ll lm ln kd lo lp lq lr bi translated">标记化</h2><p id="4f68" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">处理文本的第一步是将所有的组成部分(单词和标点)分解成“记号”。这些标记在 Doc 对象内部进行了注释，以包含描述性信息。在接下来的故事中，我们将更详细地讨论标记化。现在，让我们看另一个例子:</p><pre class="kk kl km kn gt mc ma md me aw mf bi"><span id="7b56" class="kz la in ma b gy mg mh l mi mj">In [4]:<br/>doc2 <strong class="ma io">=</strong> nlp(u"Microsoft isn't   looking into startups anymore.")<br/><strong class="ma io">for</strong> token <strong class="ma io">in</strong> doc2:<br/>   print(token.text, token.pos_, token.dep_)</span><span id="6cc0" class="kz la in ma b gy mk mh l mi mj">Microsoft PROPN nsubj<br/>is VERB aux<br/>n't ADV neg<br/>   SPACE <br/>looking VERB ROOT<br/>into ADP prep<br/>startups NOUN pobj<br/>anymore ADV advmod<br/>. PUNCT punct</span></pre><p id="db8f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">注意<code class="fe lx ly lz ma b">isn't</code>是如何被分成两个令牌的。spaCy 既能识别词根动词<code class="fe lx ly lz ma b">is</code>也能识别它所附带的否定形式。还要注意，扩展空格和句尾的句号都被赋予了自己的记号。</p><p id="7c4a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">值得注意的是，尽管<code class="fe lx ly lz ma b">doc2</code>包含关于每个令牌的已处理信息，但它也保留了原始文本:</p><pre class="kk kl km kn gt mc ma md me aw mf bi"><span id="7582" class="kz la in ma b gy mg mh l mi mj">In [5]:doc2<br/>Out[5]:Microsoft isn't   looking into startups anymore.<br/>In [6]:doc2[0]<br/>Out[6]:Microsoft<br/>In [7]:type(doc2)<br/>Out[7]:spacy.tokens.doc.Doc</span></pre><h2 id="fcc9" class="kz la in bd lb lc ld dn le lf lg dp lh jv li lj lk jz ll lm ln kd lo lp lq lr bi translated">词性标注</h2><p id="3484" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">将文本分割成标记后的下一步是分配词性。在上面的例子中，<code class="fe lx ly lz ma b">Microsoft</code>被识别为一个<strong class="jm io"> <em class="mb">专有名词</em> </strong>。这里需要一些统计建模。例如,“the”后面的单词通常是名词。</p><p id="52f5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如需 POS 标签的完整列表，请访问</p><p id="13e2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae ki" href="https://spacy.io/api/annotation#pos-tagging" rel="noopener ugc nofollow" target="_blank">https://spacy.io/api/annotation#pos-tagging</a></p><pre class="kk kl km kn gt mc ma md me aw mf bi"><span id="47ec" class="kz la in ma b gy mg mh l mi mj">In [8]:doc2[0].pos_<br/>Out[8]:'PROPN'</span></pre><h2 id="c28b" class="kz la in bd lb lc ld dn le lf lg dp lh jv li lj lk jz ll lm ln kd lo lp lq lr bi translated">属国</h2><p id="05af" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">我们还查看了分配给每个标记的语法依赖。<code class="fe lx ly lz ma b">Microsoft</code>被确定为<code class="fe lx ly lz ma b">nsubj</code>或<strong class="jm io"> <em class="mb">句子的名词性主语</em> </strong>。</p><p id="3972" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要获得完整的语法依赖列表，请访问</p><p id="9e4f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae ki" href="https://spacy.io/api/annotation#dependency-parsing" rel="noopener ugc nofollow" target="_blank">https://spacy.io/api/annotation#dependency-parsing</a></p><p id="eb4e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">关于类型依赖的一个很好的解释可以在<a class="ae ki" href="https://nlp.stanford.edu/software/dependencies_manual.pdf" rel="noopener ugc nofollow" target="_blank">这里</a>找到</p><pre class="kk kl km kn gt mc ma md me aw mf bi"><span id="2ce6" class="kz la in ma b gy mg mh l mi mj">In [9]:doc2[0].dep_<br/>Out[9]:'nsubj'</span></pre><p id="9b11" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要查看标签的全名，请使用<code class="fe lx ly lz ma b">spacy.explain(tag)</code></p><pre class="kk kl km kn gt mc ma md me aw mf bi"><span id="a422" class="kz la in ma b gy mg mh l mi mj">In [10]:spacy.explain('PROPN')<br/>Out[10]:'proper noun'<br/>In [11]:spacy.explain('nsubj')<br/>Out[11]:'nominal subject'</span></pre><h2 id="bd21" class="kz la in bd lb lc ld dn le lf lg dp lh jv li lj lk jz ll lm ln kd lo lp lq lr bi translated">其他令牌属性</h2><p id="5687" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">我们将在接下来的故事中再次看到这些。现在，我们只想说明 spaCy 分配给令牌的一些其他信息:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi mm"><img src="../Images/d6a3c9c68abfb771e472fb600468db39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uXwjvPXtANA1z_Ivw4JQeA.jpeg"/></div></div></figure><pre class="kk kl km kn gt mc ma md me aw mf bi"><span id="5b43" class="kz la in ma b gy mg mh l mi mj">In [12]:<em class="mb"># Lemmas (the base form of the word):<br/></em>print(doc2[4].text)<br/>print(doc2[4].lemma_)<br/>Out [12]: looking<br/>          look<br/>In [13]:<br/><em class="mb"># Simple Parts-of-Speech &amp; Detailed Tags:<br/></em>print(doc2[4].pos_)<br/>print(doc2[4].tag_ <strong class="ma io">+</strong> ' / ' <strong class="ma io">+</strong> spacy.explain(doc2[4].tag_))<br/>VERB<br/>VBG / verb, gerund or present participle<br/>In [14]:<br/><em class="mb"># Word Shapes:<br/></em>print(doc2[0].text<strong class="ma io">+</strong>': '<strong class="ma io">+</strong>doc2[0].shape_)<br/>print(doc[5].text<strong class="ma io">+</strong>' : '<strong class="ma io">+</strong>doc[5].shape_)<br/>Microsoft: Xxxxx<br/>U.S. : X.X.<br/>In [15]:<br/><em class="mb"># Boolean Values:<br/></em>print(doc2[0].is_alpha)<br/>print(doc2[0].is_stop)<br/>True<br/>False</span></pre><h2 id="19e0" class="kz la in bd lb lc ld dn le lf lg dp lh jv li lj lk jz ll lm ln kd lo lp lq lr bi translated">跨度</h2><p id="f0dd" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">大型 Doc 对象有时很难处理。一个<strong class="jm io"> span </strong>是一片<code class="fe lx ly lz ma b">Doc[start:stop]</code>形式的 Doc 对象。</p><pre class="kk kl km kn gt mc ma md me aw mf bi"><span id="6640" class="kz la in ma b gy mg mh l mi mj">In [16]:doc3 <strong class="ma io">=</strong> nlp(u'Although commmonly attributed to John Lennon from his song "Beautiful Boy", \<br/>the phrase "Life is what happens to us while we are making other plans" was written by \<br/>cartoonist Allen Saunders and published in Reader\'s Digest in 1957, when Lennon was 17.')<br/>In [17]:<br/>life_quote <strong class="ma io">=</strong> doc3[16:30]<br/>print(life_quote)<br/>"Life is what happens to us while we are making other plans"<br/>In [18]:type(life_quote)<br/>Out[18]:spacy.tokens.span.Span</span></pre><p id="e686" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在接下来的故事中，我们将看到如何使用<code class="fe lx ly lz ma b">Span()</code>创建跨度对象。这将允许我们向跨度分配附加信息。</p><h2 id="85e8" class="kz la in bd lb lc ld dn le lf lg dp lh jv li lj lk jz ll lm ln kd lo lp lq lr bi translated">句子</h2><p id="affa" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">Doc 对象内的某些标记也可以接收“句子开始”标签。虽然这不会立即构建一个句子列表，但是这些标签可以通过<code class="fe lx ly lz ma b">Doc.sents</code>生成句子片段。稍后我们将编写自己的分段规则。</p><pre class="kk kl km kn gt mc ma md me aw mf bi"><span id="c368" class="kz la in ma b gy mg mh l mi mj">In [19]:<br/>doc4 <strong class="ma io">=</strong> nlp(u'This is the first sentence. This is another sentence. This is the last sentence.')<br/>In [20]:<br/><strong class="ma io">for</strong> sent <strong class="ma io">in</strong> doc4.sents:<br/>   print(sent)</span><span id="7f95" class="kz la in ma b gy mk mh l mi mj">This is the first sentence.<br/>This is another sentence.<br/>This is the last sentence.<br/>In [21]:<br/>doc4[6].is_sent_start<br/>Out[21]:True</span></pre><div class="mn mo gp gr mp mq"><a href="https://medium.com/@santanudutta85/getting-started-in-natural-language-processing-with-spacy-part-2-73ecb4eac11d" rel="noopener follow" target="_blank"><div class="mr ab fo"><div class="ms ab mt cl cj mu"><h2 class="bd io gy z fp mv fr fs mw fu fw im bi translated">spaCy 自然语言处理入门:第 2 部分</h2><div class="mx l"><h3 class="bd b gy z fp mv fr fs mw fu fw dk translated">如果您错过了第 1 部分。如果您正在寻找基本安装、基本命令、令牌化，请查看它</h3></div><div class="my l"><p class="bd b dl z fp mv fr fs mw fu fw dk translated">medium.com</p></div></div><div class="mz l"><div class="na l nb nc nd mz ne kt mq"/></div></div></a></div></div></div>    
</body>
</html>