<html>
<head>
<title>Game Programming Pattern: Singleton</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">游戏编程模式:Singleton</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/game-programming-pattern-singleton-4a0070ca489b?source=collection_archive---------4-----------------------#2021-06-04">https://blog.devgenius.io/game-programming-pattern-singleton-4a0070ca489b?source=collection_archive---------4-----------------------#2021-06-04</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="0078" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">它是什么，为什么使用它以及如何在Unity中使用它</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi kc"><img src="../Images/ea03b9b61996d0a161bfc2e300dd92bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*xZ39sinMJi1mHpKxtV9fhA.png"/></div></figure><h1 id="b1d9" class="kk kl in bd km kn ko kp kq kr ks kt ku jt kv ju kw jw kx jx ky jz kz ka la lb bi translated">什么是单例模式</h1><p id="e66e" class="pw-post-body-paragraph lc ld in le b lf lg jo lh li lj jr lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">一个游戏设计模式，只有一个实例，并且可以全局访问，这对Unity中的经理们来说非常有用。</p><h1 id="7043" class="kk kl in bd km kn ko kp kq kr ks kt ku jt kv ju kw jw kx jx ky jz kz ka la lb bi translated">为什么要使用单例模式</h1><p id="8a25" class="pw-post-body-paragraph lc ld in le b lf lg jo lh li lj jr lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">无论你站在单例辩论的哪一边，Unity中的单例都比只使用静态类或静态变量有更好的用途，因为你可以将它分配给场景中的游戏对象并访问它的值。您不能在检查器中访问静态变量的值。</p><h1 id="0b12" class="kk kl in bd km kn ko kp kq kr ks kt ku jt kv ju kw jw kx jx ky jz kz ka la lb bi translated">如何使用单例模式</h1><p id="1015" class="pw-post-body-paragraph lc ld in le b lf lg jo lh li lj jr lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">为了让Unity中的管理器行为使用单例模式，我需要为这个行为创建一个静态实例。确保在Awake方法中设置实例。我创建了一个公共属性，可以用来访问游戏管理器的实例。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi ly"><img src="../Images/7064e8d180d12f8daaeed3bd42d7a4e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*SHHDDCsgsQNIx-4BeDaZHw.gif"/></div></div></figure><p id="b82f" class="pw-post-body-paragraph lc ld in le b lf md jo lh li me jr lk ll mf ln lo lp mg lr ls lt mh lv lw lx ig bi translated">因为我希望游戏管理器总是存在于游戏中，所以我需要一种方法来确保当我得到游戏管理器时，我让开发者知道它需要在场景中。我在Get方法中添加了一个检查，如果实例为空，它将记录一个错误。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/905fd9b3e422fa9177404735b58bd083.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/1*p80q5rAKfR55IzEyzeSlOw.gif"/></div></figure><p id="cdaa" class="pw-post-body-paragraph lc ld in le b lf md jo lh li me jr lk ll mf ln lo lp mg lr ls lt mh lv lw lx ig bi translated">接下来，我为正在播放的过场动画创建了一个bool属性。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi mj"><img src="../Images/e907b71bd9c5b3bbe6a0a59798a376a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*5TFsAs17ByTRnzBv2K4SOQ.gif"/></div></div></figure><p id="dd5b" class="pw-post-body-paragraph lc ld in le b lf md jo lh li me jr lk ll mf ln lo lp mg lr ls lt mh lv lw lx ig bi translated">使用单例模式的强大之处在于，我现在不需要为了访问属性而获取对游戏管理器的引用。</p><p id="1b38" class="pw-post-body-paragraph lc ld in le b lf md jo lh li me jr lk ll mf ln lo lp mg lr ls lt mh lv lw lx ig bi translated">通常来说，要访问游戏管理器，我必须获得一个对游戏管理器的引用，然后访问我想要更改的属性。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi mk"><img src="../Images/9af7ace7ad0f99f6e9fafe14330ea069.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*1245z7HxgiRvh4cSe1Hwhg.gif"/></div></div></figure><p id="7267" class="pw-post-body-paragraph lc ld in le b lf md jo lh li me jr lk ll mf ln lo lp mg lr ls lt mh lv lw lx ig bi translated">现在我可以访问游戏管理器的实例，而不必担心获取对它的引用。这节省了存储器资源。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/ff514016ea4b3f3042e0f3e3a00a4cd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/1*sCkUHjk5CWOKYe2I1WPUaA.gif"/></div></figure><p id="b389" class="pw-post-body-paragraph lc ld in le b lf md jo lh li me jr lk ll mf ln lo lp mg lr ls lt mh lv lw lx ig bi translated">现在在游戏管理器中，我将使用它来添加跳过过场动画的功能，如果它正在播放的话。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi mm"><img src="../Images/f0d8a2d7bee6b7895fac64237c001f61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*MvbOtj_nhbNoIZtzK-s3Pg.gif"/></div></div></figure><p id="88e9" class="pw-post-body-paragraph lc ld in le b lf md jo lh li me jr lk ll mf ln lo lp mg lr ls lt mh lv lw lx ig bi translated">我需要一个协程来跳过当前播放的过场动画。在过场动画游戏事件监听器行为中，我添加了一个要跳过的协程。我把经理正在玩的游戏设置为假。我检查以确保我有一个过场动画和一个可玩的导演。然后，我将可播放导演的时间设置为过场动画的持续时间减去0.3f。我等待0.3秒。然后我告诉音频管理器开始默认的背景音乐。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi mn"><img src="../Images/a87d46d78a61ab87205565e4c71b2209.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*G38USMLACDMeE5WiDPHX6Q.gif"/></div></div></figure><p id="3c13" class="pw-post-body-paragraph lc ld in le b lf md jo lh li me jr lk ll mf ln lo lp mg lr ls lt mh lv lw lx ig bi translated">我给游戏管理器添加了一个当前的过场动画，这样它就会知道哪个过场动画停止了。在当前过场动画中，当游戏过场动画将游戏管理器设置为正在运行时，我也将游戏管理器的当前过场动画设置为正在运行。当设置游戏管理器为假时，我也将当前场景设置为空。回到游戏管理器，如果有一个场景正在播放并且按下了S键，我就启动跳过场景修正程序。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi mo"><img src="../Images/a7cc0884f2ad57a7f91c2b1a5ff88c66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*mXvAjI_OtI4xPYDDQeDfwA.gif"/></div></div></figure><p id="040a" class="pw-post-body-paragraph lc ld in le b lf md jo lh li me jr lk ll mf ln lo lp mg lr ls lt mh lv lw lx ig bi translated">我把过场动画的停止放入它自己的方法中。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi mp"><img src="../Images/ce6f40ff5fea22b19ca7189c4025214b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*qnk0MWyx9zOGG2aRywGBOg.gif"/></div></div></figure><p id="5847" class="pw-post-body-paragraph lc ld in le b lf md jo lh li me jr lk ll mf ln lo lp mg lr ls lt mh lv lw lx ig bi translated">为了解决当过场动画的回绕模式为暂停或循环时被禁用的问题，我添加了检查来查看回绕模式是否没有设置为无。如果不是，那么我退出stop方法。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/d679a0728496378341288a2ff1bd596a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/1*qYzbvrkKEdGGDIM0WP17QA.gif"/></div></figure></div></div>    
</body>
</html>