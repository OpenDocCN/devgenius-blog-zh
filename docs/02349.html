<html>
<head>
<title>Understanding YAML Files in Kubernetes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解 Kubernetes 中的 YAML 文件</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/understanding-yaml-files-in-kubernetes-f0121b40abbc?source=collection_archive---------2-----------------------#2020-07-30">https://blog.devgenius.io/understanding-yaml-files-in-kubernetes-f0121b40abbc?source=collection_archive---------2-----------------------#2020-07-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/351855f2586afefc9a5da578a1d3b630.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-MlCfN7xMLr8eTyDceHfOQ.jpeg"/></div></div></figure><p id="00b2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">读完这篇文章后，你将理解使用 YAML 定义文件创建 kubernetes 对象的基础。您还将了解如何使用 YAML 文件创建 POD。</p><p id="f416" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们开始吧。</p><p id="567e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Kubernetes 使用 YAML 文件作为创建对象的输入，例如:</p><p id="3f33" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">-pod<br/>-副本集<br/> -部署<br/> -服务</p><p id="7bee" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">所有这些都遵循相似的结构。</strong></p><p id="72fe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通常，Kubernetes YAML 定义文件包含四个顶级字段:</p><p id="bf54" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">1.apiVersion <br/> 2。种类<br/> 3。元数据<br/> 4。投机</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="la lb l"/></div></figure><p id="7b2c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这些是顶级或根级属性。</p><p id="2425" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它们也是必填字段，因此您必须在配置文件中包含它们。</p><h2 id="d0fb" class="lc ld iq bd le lf lg dn lh li lj dp lk kj ll lm ln kn lo lp lq kr lr ls lt lu bi translated">让我们来看看他们每一个人。</h2></div><div class="ab cl lv lw hu lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="ij ik il im in"><h1 id="3c8b" class="mc ld iq bd le md me mf lh mg mh mi lk mj mk ml ln mm mn mo lq mp mq mr lt ms bi translated">ApiVersion</h1><p id="2163" class="pw-post-body-paragraph jy jz iq ka b kb mt kd ke kf mu kh ki kj mv kl km kn mw kp kq kr mx kt ku kv ij bi translated">这是您用来创建对象的 kubernetes API 的版本。根据您想要创建的内容，您必须使用正确的 API 版本。</p><p id="f6fe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这种情况下，因为我们正在与豆荚。我们将 apiVersion 设置为 v1。</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="la lb l"/></div></figure><p id="9d05" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此字段的其他一些可能值包括:</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="la lb l"/></div></figure><h1 id="c6ac" class="mc ld iq bd le md my mf lh mg mz mi lk mj na ml ln mm nb mo lq mp nc mr lt ms bi translated">种类</h1><p id="0eb3" class="pw-post-body-paragraph jy jz iq ka b kb mt kd ke kf mu kh ki kj mv kl km kn mw kp kq kr mx kt ku kv ij bi translated">种类是指我们试图创建的对象的类型，在本例中是一个 POD。</p><p id="caee" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以我们将它设置为一个 Pod:</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="la lb l"/></div></figure><p id="db84" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">其他一些可能的值有:</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="la lb l"/></div></figure><h1 id="87ec" class="mc ld iq bd le md my mf lh mg mz mi lk mj na ml ln mm nb mo lq mp nc mr lt ms bi translated">[计]元数据</h1><p id="cb0a" class="pw-post-body-paragraph jy jz iq ka b kb mt kd ke kf mu kh ki kj mv kl km kn mw kp kq kr mx kt ku kv ij bi translated">元数据字段包含关于对象的信息，如名称、标签等。</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="la lb l"/></div></figure><p id="dac7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如您所看到的，不像前两个，您已经指定了一个字符串值。元数据字段采用字典的形式。</p><p id="9b92" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">元数据下的所有内容都向右缩进，因此名称和标签是元数据的“孩子”。</p><p id="2304" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">提示:name 和 labels 这两个属性前面的空格数无关紧要，但是它们应该相同，因为它们是兄弟。</p><p id="1665" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">示例:</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="la lb l"/></div></figure><p id="c0c9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在前面的代码片段中，labels 左边的空格比 name 多，所以它现在是 name 属性的子属性，而不是兄弟属性。这是不正确的！</p><p id="bbf3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在元数据下，名称是一个字符串值，因此您可以将 POD 命名为:myapp-pod。</p><p id="5082" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Labels 是元数据字典中的一个字典，它可以有任意的键和值对:</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="la lb l"/></div></figure><p id="23e5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您可以添加您认为合适的其他标签，这将有助于您在稍后的时间点识别这些对象。</p><p id="4bb1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">例如，有数百个 pod 运行前端应用程序，数百个 pod 运行后端应用程序或数据库。</p><p id="3126" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一旦部署完毕，您将很难对这些吊舱进行分组。</p><p id="4f07" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您将 kubernetes POD 标记为“前端”、“后端”或“数据库”，您将能够在以后的某个时间点根据此标签过滤 POD。</p><p id="326f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">需要注意的是，在元数据下，你只能指定名称或标签，或者 kubernetes 期望在元数据下的任何东西。</p><p id="4f1c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你不能在此基础上随意添加任何其他财产。</p><p id="0c41" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然而，根据您的需要，在标签下您可以有任何种类的键或值对。</p><h1 id="c0a6" class="mc ld iq bd le md my mf lh mg mz mi lk mj na ml ln mm nb mo lq mp nc mr lt ms bi translated">投机</h1><p id="737b" class="pw-post-body-paragraph jy jz iq ka b kb mt kd ke kf mu kh ki kj mv kl km kn mw kp kq kr mx kt ku kv ij bi translated">配置文件中的最后一部分是规范部分，写为“spec”。</p><p id="c5ff" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这里，我们将向 kubernetes 提供与该对象相关的附加信息，这些信息将根据我们想要创建的对象而有所不同。</p><p id="7ed7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">提示:参考文档部分以获得每个 kubernetes 对象的正确格式。</p><p id="9fdc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因为我们只创建一个包含单个容器的 pod，spec 是一个字典，所以在它下面添加一个名为 containers 的属性。</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="la lb l"/></div></figure><p id="5fa9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">容器是一个列表或数组。该属性是一个列表的原因是因为窗格中可以有多个容器。</p><p id="f3ec" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这种情况下，我们将只在列表中添加一个项目，因为我们计划在 pod 中只添加一个容器。</p><p id="83bf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">名称前的破折号表示这是列表中的第一个项目。</p><p id="7c13" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">清单上的项目是一本字典。所以添加一个名称和图像属性，图像的值在“nginx”中，这是 docker 存储库中 Docker 图像的名称。</p><p id="e139" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">创建文件后，运行以下命令，根据文件名创建一个 kubernetes 对象:</p><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="ffec" class="lc ld iq ne b gy ni nj l nk nl">kubectl create -f pod-definition.yaml</span></pre></div><div class="ab cl lv lw hu lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="ij ik il im in"><h1 id="f749" class="mc ld iq bd le md me mf lh mg mh mi lk mj mk ml ln mm mn mo lq mp mq mr lt ms bi translated">摘要</h1><p id="1489" class="pw-post-body-paragraph jy jz iq ka b kb mt kd ke kf mu kh ki kj mv kl km kn mw kp kq kr mx kt ku kv ij bi translated">回想一下四个顶级属性:</p><p id="e395" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">- apiVersion <br/> -种类<br/> -元数据<br/> -规格</p><p id="7472" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">命令查看可用窗格的列表。</p><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="f0ca" class="lc ld iq ne b gy ni nj l nk nl">kubectl get pods</span></pre><p id="1f1d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">查看 POD 的详细信息。</p><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="6723" class="lc ld iq ne b gy ni nj l nk nl">kubectl describe pod myapp-pod</span></pre><p id="1c30" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这将告诉您关于 pod 的信息，它是何时创建的，分配给它什么标签，以及作为它的一部分的 docker 容器和与该 POD 相关联的事件。</p></div><div class="ab cl lv lw hu lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="ij ik il im in"><p id="a8cf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你想了解更多关于 kubernetes 的信息，我推荐你阅读<a class="ae nm" href="https://medium.com/dev-genius/the-kubernetes-cluster-architecture-simplified-3c4a5fb41449" rel="noopener">Kubernetes 集群架构简化版</a>。</p><p id="fb63" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="nn">原载于</em> <a class="ae nm" href="https://luispreciado.blog/posts/kubernetes/core-concepts/pod-yaml" rel="noopener ugc nofollow" target="_blank"> <em class="nn">我的博客</em> </a></p></div></div>    
</body>
</html>