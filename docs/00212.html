<html>
<head>
<title>Half-Circle Progress Indicator on Swift. How to draw a half-circle with UIBezierPath.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Swift 上的半圆进度指示器。如何用 UIBezierPath 画半圆？</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/half-circle-progress-indicator-on-swift-how-to-draw-a-half-circle-with-uibezierpath-88bdf3665fb9?source=collection_archive---------1-----------------------#2020-05-14">https://blog.devgenius.io/half-circle-progress-indicator-on-swift-how-to-draw-a-half-circle-with-uibezierpath-88bdf3665fb9?source=collection_archive---------1-----------------------#2020-05-14</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="de8c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我想分享我在自定义进度指示器创建方面的经验。我将展示如何用 UIBezierPath 创建一个自定义进度指示器，如下图所示(完整项目在此处<a class="ae ki" href="https://github.com/alexnikol/halfCircleIndicator" rel="noopener ugc nofollow" target="_blank"> Github 库</a>):</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi kj"><img src="../Images/490342622e292dc6f6534939603181d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*69wBcVxLBnkw3BZluyc6hg.gif"/></div></figure><p id="3f87" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们从这个想法开始。我们需要为第一个指示器创建 3 层(<strong class="jm io"> CALayer </strong>)，为第二个指示器创建 2 层。主要技巧是 3 个半圆互相夹住，如下图所示:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi kr"><img src="../Images/d6f492d30802eb728c943620faf254ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TA8JH1I36r2nDPrydHZN2w.png"/></div></div></figure><p id="5fe1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这是一个完整的指示器类。它有两种模式——有内圈和没有内圈，就像在第一张 gif 上一样。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="kw kx l"/></div></figure><p id="12e9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在我将解释它是如何工作的。</p><p id="3a67" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们来讨论一下<code class="fe ky kz la lb b"><strong class="jm io">getOutherGrayCircle</strong></code>函数。在这段代码中，每个半圆有 3 个函数。因为它们都是半圆，那么我们需要理解如何只画第一个半圆，另外两个半圆也会画得一样。</p><pre class="kk kl km kn gt lc lb ld le aw lf bi"><span id="c1a2" class="lg lh in lb b gy li lj l lk ll">func getOutherGrayCircle() -&gt; CAShapeLayer {<br/>        let center = CGPoint(x: fullSize.width / 2, y: fullSize.height)<br/>        let beizerPath = UIBezierPath()<br/>        beizerPath.move(to: center)<br/>        beizerPath.addArc(withCenter: center,<br/>                    radius: grayCircleSize.width / 2,<br/>                    startAngle: .pi,<br/>                    endAngle: 2 * .pi,<br/>                    clockwise: true)<br/>        beizerPath.close()<br/>        let innerGrayCircle = CAShapeLayer()<br/>        innerGrayCircle.path = beizerPath.cgPath<br/>        innerGrayCircle.fillColor = UIColor.gray.cgColor<br/>        return innerGrayCircle<br/>    }</span></pre><p id="1a94" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">UIBezierPath 的中心点是视图上 X 轴和最大 Y 轴的中心点(下图中坐标系的中心)。<code class="fe ky kz la lb b"><strong class="jm io">startAngle</strong></code>永远是。我们需要计算圆周率和<code class="fe ky kz la lb b"><strong class="jm io">endAngle</strong></code>(这取决于指标应该显示多少百分比)。<code class="fe ky kz la lb b"><strong class="jm io">endAngle</strong></code>有 2 *的限制。圆周率</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi lm"><img src="../Images/018d647e42a25b458ac60c0c225e1441.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A0KPSi8V0fz67t5WIdZxfg.png"/></div></div></figure><p id="90e3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">所以现在我们可以创建一个半圆。两个灰色半圆将是静态的，这就是为什么<strong class="jm io">getouthergraycound</strong>和<strong class="jm io">getinnergraycound</strong>中的<code class="fe ky kz la lb b"><strong class="jm io">startAngle</strong></code>和<code class="fe ky kz la lb b"><strong class="jm io">endAngle</strong></code>等于。圆周率和 2 *。</p><p id="367e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们只有一个动态半圆— <strong class="jm io"> getGreenCircle </strong>。这里我们需要设置<code class="fe ky kz la lb b"><strong class="jm io">endAngle</strong></code>来决定指示器应该显示多少百分比。例如:如果我们需要 60%的指标，那么<strong class="jm io"> : </strong></p><blockquote class="ln lo lp"><p id="d6e0" class="jk jl lq jm b jn jo jp jq jr js jt ju lr jw jx jy ls ka kb kc lt ke kf kg kh ig bi translated">endAngle = <em class="in">。pi +。圆周率* 0.6 </em></p></blockquote></div><div class="ab cl lu lv hr lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ig ih ii ij ik"><p id="c327" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，我们可以创建所有 3 个圆，并将它们添加到父层:</p><pre class="kk kl km kn gt lc lb ld le aw lf bi"><span id="d2e6" class="lg lh in lb b gy li lj l lk ll">func drawShape(bounds: CGRect) {<br/>        fullSize = bounds.size<br/>        grayCircleSize = fullSize<br/>        greenCircleSize = CGSize(width: bounds.width - 6.0, height: bounds.width - 6.0)<br/>        innerGrayCircleSize = CGSize(width: greenCircleSize.width - 44.0,<br/>                                     height: greenCircleSize.width - 44.0)<br/>        let outerCicrcle = getOutherGrayCircle()<br/>        let greenCircle = getGreenCircle()<br/>        progressLayer = greenCircle<br/>        self.layer.addSublayer(outerCicrcle)<br/>        self.layer.addSublayer(greenCircle)<br/>        if isInnerCircleExist {<br/>            let innerGrayCircle = getInnerGrayCircle()<br/>            self.layer.addSublayer(innerGrayCircle)<br/>        }<br/>        <br/>        self.layer.masksToBounds = true<br/>    }</span></pre><p id="4799" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">对于没有内部灰色半圆的指标，我们就不需要画这一层了。仅此而已。</p><h1 id="83d7" class="mb lh in bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">资源:</h1><p id="e35c" class="pw-post-body-paragraph jk jl in jm b jn my jp jq jr mz jt ju jv na jx jy jz nb kb kc kd nc kf kg kh ig bi translated"><a class="ae ki" href="https://github.com/alexnikol/halfCircleIndicator" rel="noopener ugc nofollow" target="_blank"> Github 资源库</a></p><div class="nd ne gp gr nf ng"><a href="https://medium.com/macoclock/quick-start-with-calayer-and-cabasicanimation-e3ff17ea6f11" rel="noopener follow" target="_blank"><div class="nh ab fo"><div class="ni ab nj cl cj nk"><h2 class="bd io gy z fp nl fr fs nm fu fw im bi translated">CALayer 和 CABasicAnimation 快速入门</h2><div class="nn l"><h3 class="bd b gy z fp nl fr fs nm fu fw dk translated">张贴关于 CALayer 和层动画的基本理解</h3></div><div class="no l"><p class="bd b dl z fp nl fr fs nm fu fw dk translated">medium.com</p></div></div><div class="np l"><div class="nq l nr ns nt np nu kp ng"/></div></div></a></div><div class="nd ne gp gr nf ng"><a href="https://medium.com/macoclock/how-to-solve-the-maskstobounds-problem-with-the-shadow-of-uiview-47acc469b8ea" rel="noopener follow" target="_blank"><div class="nh ab fo"><div class="ni ab nj cl cj nk"><h2 class="bd io gy z fp nl fr fs nm fu fw im bi translated">如何用 UIView 的影子解决 masksToBounds 问题？</h2><div class="nn l"><h3 class="bd b gy z fp nl fr fs nm fu fw dk translated">简单的技巧，只需几个盘子</h3></div><div class="no l"><p class="bd b dl z fp nl fr fs nm fu fw dk translated">medium.com</p></div></div><div class="np l"><div class="nv l nr ns nt np nu kp ng"/></div></div></a></div></div></div>    
</body>
</html>