<html>
<head>
<title>Don’t do this mistake in the Laravel collection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不要在 Laravel 系列中犯这个错误</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/dont-do-this-mistake-in-the-laravel-collection-8abdd519f01b?source=collection_archive---------1-----------------------#2022-11-13">https://blog.devgenius.io/dont-do-this-mistake-in-the-laravel-collection-8abdd519f01b?source=collection_archive---------1-----------------------#2022-11-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b0cf" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">避免在 Laravel 集合中使用 empty 函数</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/b073bd171e59c0335241e928fcdbc395.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wilZ-WMSixqlsUxT"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">马克·弗莱彻·布朗在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="2856" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Laravel 集合是一个 PHP 数组的包装器。在 Laravel 世界中，它是一种基于数组创建的新数据类型。<code class="fe ls lt lu lv b">Illuminate\Support\Collection</code>类提供了 Laravel 集合。此外，Laravel 雄辩的方法将返回集合实例。</p><blockquote class="lw lx ly"><p id="a308" class="kw kx lz ky b kz la jr lb lc ld ju le ma lg lh li mb lk ll lm mc lo lp lq lr ij bi translated"><a class="ae kv" href="https://laravel.com/docs/9.x/eloquent" rel="noopener ugc nofollow" target="_blank">雄辩的</a>查询的结果总是作为<code class="fe ls lt lu lv b">Collection</code>实例返回。</p></blockquote><p id="0441" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">与数组相比，收集方法让您的生活更轻松。<a class="ae kv" href="https://laravel.com/docs/9.x/collections#available-methods" rel="noopener ugc nofollow" target="_blank">点击此处</a>查看 Laravel 单据上可用的收款方式。</p><p id="dace" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ls lt lu lv b">collect</code>助手用于根据给定的数组创建集合。</p><pre class="kg kh ki kj gt md lv me bn mf mg bi"><span id="4a7c" class="mh mi iq lv b be mj mk l ml mm">$collection = collect([1, 2, 3]);<br/><br/>dd($collection);</span></pre><p id="c7e6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当您打印集合时，将会得到以下结果。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/51dc816eda60889aecd260132f2bb3bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*qWV39oqTU14pTpHjO3lrqA.png"/></div></figure><p id="e069" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在检查空函数问题之前，我将澄清 Laravel 集合中的一些常见问题。</p><h2 id="1930" class="mo mi iq bd mp mq mr dn ms mt mu dp mv lf mw mx my lj mz na nb ln nc nd ne nf bi translated">我们可以使用<code class="fe ls lt lu lv b">foreach</code>迭代器吗？</h2><p id="7b51" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">是的，我们可以用<code class="fe ls lt lu lv b">foreach</code>代替<a class="ae kv" href="https://laravel.com/docs/9.x/collections#method-each" rel="noopener ugc nofollow" target="_blank">的每一个</a>方法进行采集。</p><pre class="kg kh ki kj gt md lv me bn mf mg bi"><span id="4c98" class="mh mi iq lv b be mj mk l ml mm">$collection = collect([1, 2, 3]);<br/><br/>foreach ($collection as $data) {<br/>    echo $data;<br/>}<br/><br/>$collection-&gt;each(function ($item) {<br/>    echo $item;<br/>});</span></pre></div><div class="ab cl nl nm hu nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ij ik il im in"><div class="kg kh ki kj gt ns"><a href="https://balajidharma.medium.com/the-syntax-highlighting-highlight-js-is-now-available-on-medium-58f672595691" rel="noopener follow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd ir gy z fp nx fr fs ny fu fw ip bi translated">用语法荧光笔尝试代码块的中等新功能</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">介质上的语法高亮显示</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">balajidharma.medium.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og kp ns"/></div></div></a></div></div><div class="ab cl nl nm hu nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ij ik il im in"><h2 id="f203" class="mo mi iq bd mp mq mr dn ms mt mu dp mv lf mw mx my lj mz na nb ln nc nd ne nf bi translated">如何将 PHP 集合转换成数组？</h2><p id="1251" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated"><code class="fe ls lt lu lv b">toArray()</code>函数将集合转换成普通的 PHP <code class="fe ls lt lu lv b">array</code>。</p><pre class="kg kh ki kj gt md lv me bn mf mg bi"><span id="2e9e" class="mh mi iq lv b be mj mk l ml mm">$collection = collect([1, 2, 3]);<br/>$array_colection = $collection-&gt;toArray();<br/>dd($array_colection);</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/48ec5e2688ed74eb3592cbd111f1c57e.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*gxIHgy8ddgme0537gKrwaA.png"/></div></figure></div><div class="ab cl nl nm hu nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ij ik il im in"><p id="0290" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们知道数组方法<code class="fe ls lt lu lv b">foreach</code>可以很好地处理集合。但是我们不能对集合使用的所有数组方法。</p><h2 id="a291" class="mo mi iq bd mp mq mr dn ms mt mu dp mv lf mw mx my lj mz na nb ln nc nd ne nf bi translated">不要用空的</h2><p id="e385" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">最常见的错误是使用<code class="fe ls lt lu lv b">empty</code>方法检查集合是否为空。在下面的示例中，创建了一个空集合，并添加了一个 if 语句来检查集合是否为空。</p><pre class="kg kh ki kj gt md lv me bn mf mg bi"><span id="98fc" class="mh mi iq lv b be mj mk l ml mm">$collection = collect([]);<br/><br/>if(empty($collection)) {<br/>    dd('collection is empty');<br/>}</span></pre><p id="6071" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">还有，不要用空洞来换取雄辩的结果</p><pre class="kg kh ki kj gt md lv me bn mf mg bi"><span id="6de6" class="mh mi iq lv b be mj mk l ml mm">$users = User::where('active', 1)-&gt;get();<br/><br/>if(empty($users)) {<br/>    dd('collection is empty');<br/>}</span></pre><p id="2b37" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">集合为空，但它没有传递条件语句。因为集合不是空的，因为它有空的 items 数组。让我们打印空集合。</p><pre class="kg kh ki kj gt md lv me bn mf mg bi"><span id="2acf" class="mh mi iq lv b be mj mk l ml mm">$collection = collect([]);<br/>dd($collection);</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/281700bf4d2c4d501382c571fe9be379.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/format:webp/1*aPT0D7U2sUTPszWQeCNiUw.png"/></div></figure><p id="e925" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以使用<code class="fe ls lt lu lv b"><a class="ae kv" href="https://laravel.com/docs/9.x/collections#method-isempty" rel="noopener ugc nofollow" target="_blank">isEmpt</a>y()</code>或<code class="fe ls lt lu lv b"><a class="ae kv" href="https://laravel.com/docs/9.x/collections#method-isnotempty" rel="noopener ugc nofollow" target="_blank">isNotEmpty</a>()</code>集合方法来检查集合。</p><pre class="kg kh ki kj gt md lv me bn mf mg bi"><span id="78d0" class="mh mi iq lv b be mj mk l ml mm">$collection = collect([]);<br/><br/>if($collection-&gt;isEmpty()) {<br/>    dd('collection is empty');<br/>}<br/><br/>if($collection-&gt;isNotEmpty()) {<br/>    dd('collection is empty');<br/>}</span></pre></div><div class="ab cl nl nm hu nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ij ik il im in"><h2 id="7c54" class="mo mi iq bd mp mq mr dn ms mt mu dp mv lf mw mx my lj mz na nb ln nc nd ne nf bi translated">可以用 count 和 isset 吗？</h2><p id="85ac" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">我遇到了一个空函数的问题。所以我决定用<code class="fe ls lt lu lv b">count</code>和<code class="fe ls lt lu lv b">isset</code>功能来测试。</p><pre class="kg kh ki kj gt md lv me bn mf mg bi"><span id="ea21" class="mh mi iq lv b be mj mk l ml mm">$collection = collect(['name' =&gt; 'Balaji']);<br/><br/>if(isset($collection['name'])) {<br/>    dd($collection);<br/>}</span></pre><p id="8a89" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ls lt lu lv b">isset()</code>功能工作正常。</p><pre class="kg kh ki kj gt md lv me bn mf mg bi"><span id="d47d" class="mh mi iq lv b be mj mk l ml mm">$collection = collect([1, 2, 3]);<br/><br/>if(count($collection) &gt; 2) {<br/>    dd(count($collection));<br/>}</span></pre><p id="8d8d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">是的，数组计数方法也工作得很好。但是最好使用集合<code class="fe ls lt lu lv b"><a class="ae kv" href="https://laravel.com/docs/9.x/collections#method-count" rel="noopener ugc nofollow" target="_blank">count()</a></code>来获得计数。</p><pre class="kg kh ki kj gt md lv me bn mf mg bi"><span id="1d83" class="mh mi iq lv b be mj mk l ml mm">$collection = collect([1, 2, 3]);<br/><br/>if($collection-&gt;count() &gt; 2) {<br/>    dd($collection-&gt;count());<br/>}</span></pre></div><div class="ab cl nl nm hu nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ij ik il im in"><h2 id="7904" class="mo mi iq bd mp mq mr dn ms mt mu dp mv lf mw mx my lj mz na nb ln nc nd ne nf bi translated">结论</h2><p id="f94b" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">我们知道集合是数组的包装。此外，该集合有很多功能，它使搜索，过滤，循环，查找等变得容易。,</p><p id="f7b8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以我的建议是不要用集合试<code class="fe ls lt lu lv b">empty</code>、<code class="fe ls lt lu lv b">count</code>、<code class="fe ls lt lu lv b">isset</code>。使用类似<code class="fe ls lt lu lv b">$collection-&gt;isEmpty()</code> <code class="fe ls lt lu lv b">$collection-&gt;count()</code>的相应采集功能</p><h2 id="a18a" class="mo mi iq bd mp mq mr dn ms mt mu dp mv lf mw mx my lj mz na nb ln nc nd ne nf bi translated">集合函数是如何工作的？</h2><p id="1b06" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">你认为收藏功能<code class="fe ls lt lu lv b">$collection-&gt;isEmpty()</code> <code class="fe ls lt lu lv b">$collection-&gt;count()</code>是如何工作的？答案是 collection 也使用数组函数，但是他们对集合项使用数组函数。</p><p id="945d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下收集功能在<code class="fe ls lt lu lv b">Illuminate\Support\Collection</code>上声明</p><pre class="kg kh ki kj gt md lv me bn mf mg bi"><span id="8f52" class="mh mi iq lv b be mj mk l ml mm">   /**<br/>     * Determine if the collection is empty or not.<br/>     *<br/>     * @return bool<br/>     */<br/>    public function isEmpty()<br/>    {<br/>        return empty($this-&gt;items);<br/>    }<br/><br/><br/>    /**<br/>     * Count the number of items in the collection.<br/>     *<br/>     * @return int<br/>     */<br/>    public function count(): int<br/>    {<br/>        return count($this-&gt;items);<br/>    }</span></pre><p id="6aa5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">参考文件:<a class="ae kv" href="https://github.com/laravel/framework/blob/master/src/Illuminate/Collections/Collection.php" rel="noopener ugc nofollow" target="_blank">https://github . com/laravel/framework/blob/master/src/Illuminate/Collections/collection . PHP</a></p></div><div class="ab cl nl nm hu nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ij ik il im in"><p id="b792" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢您的阅读。</p><p id="4905" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">敬请关注更多内容！</p><p id="71e1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="lz">跟我来</em><a class="ae kv" href="https://balajidharma.medium.com/" rel="noopener"><strong class="ky ir"><em class="lz">balajidharma.medium.com</em></strong></a>。</p></div></div>    
</body>
</html>