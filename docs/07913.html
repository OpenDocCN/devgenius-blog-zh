<html>
<head>
<title>Node JS : Unit Testing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">节点 JS:单元测试</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/node-js-unit-testing-758b5ed3f323?source=collection_archive---------2-----------------------#2022-05-03">https://blog.devgenius.io/node-js-unit-testing-758b5ed3f323?source=collection_archive---------2-----------------------#2022-05-03</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><h1 id="7afd" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">什么是自动化测试？</h1><p id="350a" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">它是人工测试的替代品吗？编写代码来测试我们的代码，然后以自动化的方式运行这些测试的实践。自动化测试我们的源代码由应用程序代码组成，也称为生产代码和测试代码。自动化测试是编写代码来测试我们的代码的实践。自动化测试帮助我们交付错误更少、质量更好的软件。它们还帮助我们自信地重构代码。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi lg"><img src="../Images/dbcb0107b9b55ce5c1782f74c38b3ba9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w0Jm0QfKO5qg4903FuWowQ.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">自动化测试</figcaption></figure><p id="f87a" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated"><strong class="kk io">自动化测试的好处</strong></p><ul class=""><li id="f795" class="mb mc in kk b kl lw kp lx kt md kx me lb mf lf mg mh mi mj bi translated">用更少的时间频繁测试您的代码</li><li id="4900" class="mb mc in kk b kl mk kp ml kt mm kx mn lb mo lf mg mh mi mj bi translated">在部署之前捕获 bug</li><li id="5959" class="mb mc in kk b kl mk kp ml kt mm kx mn lb mo lf mg mh mi mj bi translated">放心部署</li><li id="6b9e" class="mb mc in kk b kl mk kp ml kt mm kx mn lb mo lf mg mh mi mj bi translated">自信地重构:重构意味着在改变代码的行为之前改变代码的结构</li><li id="4d6c" class="mb mc in kk b kl mk kp ml kt mm kx mn lb mo lf mg mh mi mj bi translated">更加注重质量</li></ul><p id="0c46" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated"><strong class="kk io">测试类型</strong></p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi lg"><img src="../Images/572ea509540cb614c1a97dfcb1363f49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3m-4SxgGHHDQDaLvUNbUGQ.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">测试类型</figcaption></figure><ul class=""><li id="1bf1" class="mb mc in kk b kl lw kp lx kt md kx me lb mf lf mg mh mi mj bi translated">单元测试:在没有外部依赖的应用程序上测试一个单元，这种单元测试写起来很便宜，执行起来很快，不会给人太多信心。</li><li id="c2ac" class="mb mc in kk b kl mk kp ml kt mm kx mn lb mo lf mg mh mi mj bi translated">集成测试:对应用程序及其外部依赖项的测试需要更长的时间来执行，但是更有信心。</li></ul><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi lg"><img src="../Images/c339f3960318949427c295542b53fe73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HgWDY-ie33CadcOyAzHWaw.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">单元测试与集成测试</figcaption></figure><ul class=""><li id="e9d0" class="mb mc in kk b kl lw kp lx kt md kx me lb mf lf mg mh mi mj bi translated">端到端测试:通过 UI 驱动应用程序。在这个测试中给你最大的信心，但它非常慢，非常脆弱</li></ul><p id="34c4" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated"><strong class="kk io">测试金字塔</strong></p><p id="28b2" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">测试金字塔是一种思考如何使用不同种类的自动化测试来创建平衡的投资组合的方式。它的要点是，通过 GUI 运行的低级单元测试应该比高级单元测试<a class="ae mp" href="https://martinfowler.com/bliki/BroadStackTest.html" rel="noopener ugc nofollow" target="_blank">多得多。这个测试金字塔给你 3 个建议:</a></p><ol class=""><li id="a46a" class="mb mc in kk b kl lw kp lx kt md kx me lb mf lf mq mh mi mj bi translated">偏爱单元测试胜过 e2e 测试</li><li id="ecf9" class="mb mc in kk b kl mk kp ml kt mm kx mn lb mo lf mq mh mi mj bi translated">用集成测试覆盖单元测试缺口</li><li id="5327" class="mb mc in kk b kl mk kp ml kt mm kx mn lb mo lf mq mh mi mj bi translated">谨慎使用端到端测试</li></ol><p id="0422" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated"><strong class="kk io">工装</strong></p><p id="1411" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">为了编写测试，我们使用框架测试。正确的测试我们需要一个测试框架一个测试为我们提供了一个库，其中包含了一系列实用函数函数来编写测试，它还为我们提供了一种测试方式，这基本上是一个程序，我们可以从命令行测试运行程序运行它，并为我们提供一个报告，告诉我们找到了多少个测试。这里面有几个框架最受欢迎，比如:</p><ul class=""><li id="ae56" class="mb mc in kk b kl lw kp lx kt md kx me lb mf lf mg mh mi mj bi translated">Jasmine :Jasmine 是一个行为驱动的开发框架，用于测试 JavaScript 代码。它不依赖于任何其他 JavaScript 框架。它不需要 DOM。它有一个清晰、明显的语法，所以你可以很容易地编写测试。</li><li id="e90a" class="mb mc in kk b kl mk kp ml kt mm kx mn lb mo lf mg mh mi mj bi translated">Mocha (chai，sinon) : Mocha 是一个运行在 Node.js 和浏览器中的 JavaScript 测试框架。它是 Node.js 社区中最流行的测试框架之一，非常容易学习和理解。Chai 是一个断言库，它有助于扩展测试框架，如 Mocha，使编写某些类型的测试更容易。像 Mocha 这样的大多数测试框架也有自己的断言函数，但是我们选择展示 Chai，因为它使编写更复杂的测试变得更容易。</li><li id="698b" class="mb mc in kk b kl mk kp ml kt mm kx mn lb mo lf mg mh mi mj bi translated">Jest :Jest 是一个令人愉快的 JavaScript 测试框架，专注于简单性。它与项目一起使用:<a class="ae mp" href="https://babeljs.io/" rel="noopener ugc nofollow" target="_blank"/>，<a class="ae mp" href="https://www.typescriptlang.org/" rel="noopener ugc nofollow" target="_blank">类型脚本</a>，<a class="ae mp" href="https://nodejs.org/" rel="noopener ugc nofollow" target="_blank">节点</a>，<a class="ae mp" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank">反应</a>，<a class="ae mp" href="https://angular.io/" rel="noopener ugc nofollow" target="_blank">角度</a>，<a class="ae mp" href="https://vuejs.org/" rel="noopener ugc nofollow" target="_blank"> Vue </a>等等！。Jest 是脸书推荐的流行测试框架。它提供了编写自动化测试所需的一切。</li></ul><p id="78c3" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated"><strong class="kk io">编写第一个单元测试</strong></p><p id="0207" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">在这里，我们将使用 Jest 进行测试。</p><ul class=""><li id="30bb" class="mb mc in kk b kl lw kp lx kt md kx me lb mf lf mg mh mi mj bi translated"><code class="fe mr ms mt mu b">npm i jest --save-dev</code></li><li id="3d52" class="mb mc in kk b kl mk kp ml kt mm kx mn lb mo lf mg mh mi mj bi translated">在 package.json 中修改<code class="fe mr ms mt mu b">"scripts":{"test":"jest"}</code></li><li id="2f40" class="mb mc in kk b kl mk kp ml kt mm kx mn lb mo lf mg mh mi mj bi translated">mkdir 测试然后添加新文件 lib.test.js</li></ul><pre class="lh li lj lk gt mv mu mw mx aw my bi"><span id="07cb" class="mz jl in mu b gy na nb l nc nd">test('our fisrt test', ()=&gt;{</span><span id="577a" class="mz jl in mu b gy ne nb l nc nd">})</span></pre><ul class=""><li id="5356" class="mb mc in kk b kl lw kp lx kt md kx me lb mf lf mg mh mi mj bi translated">那就跑</li></ul><pre class="lh li lj lk gt mv mu mw mx aw my bi"><span id="0f90" class="mz jl in mu b gy na nb l nc nd">npm test</span></pre><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi nf"><img src="../Images/a9b1d9799e1bbbe7d02ab1bd9c9888f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*smNhtoSkMHmjBUzzOvxu5A.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">第一个单元测试通过</figcaption></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi ng"><img src="../Images/80672c928e58e625a8cfcc7a9b27adfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TqA6SxRNtAI6GmjkHoKIMQ.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">单元测试失败</figcaption></figure><p id="4ec6" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated"><strong class="kk io">测试号</strong></p><p id="8e19" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">文件 lib.js</p><pre class="lh li lj lk gt mv mu mw mx aw my bi"><span id="9478" class="mz jl in mu b gy na nb l nc nd">//Testing Numbers</span><span id="c473" class="mz jl in mu b gy ne nb l nc nd">module.exports.absolute = function(number) {</span><span id="0f3f" class="mz jl in mu b gy ne nb l nc nd">if (number &gt; 0) return number;</span><span id="33ba" class="mz jl in mu b gy ne nb l nc nd">if (number &lt; 0) return -number;</span><span id="aee0" class="mz jl in mu b gy ne nb l nc nd">return 0;</span><span id="9b27" class="mz jl in mu b gy ne nb l nc nd">};</span></pre><p id="6f60" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">你可以像这样重构 lib.js</p><pre class="lh li lj lk gt mv mu mw mx aw my bi"><span id="9628" class="mz jl in mu b gy na nb l nc nd">//Testing Numbers</span><span id="7b19" class="mz jl in mu b gy ne nb l nc nd">module.exports.absolute = function(number) {</span><span id="0e48" class="mz jl in mu b gy ne nb l nc nd">return number &gt;= 0 ? number : -number;</span><span id="42ec" class="mz jl in mu b gy ne nb l nc nd">};</span></pre><p id="e887" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">库测试</p><pre class="lh li lj lk gt mv mu mw mx aw my bi"><span id="f176" class="mz jl in mu b gy na nb l nc nd">test("absolute - should return a positive number if input is positive", () =&gt; {</span><span id="176f" class="mz jl in mu b gy ne nb l nc nd">const result = lib.absolute(1);</span><span id="283c" class="mz jl in mu b gy ne nb l nc nd">expect(result).toBe(1);</span><span id="2057" class="mz jl in mu b gy ne nb l nc nd">});</span><span id="a561" class="mz jl in mu b gy ne nb l nc nd">test("absolute - should return a positive number if input is negative", () =&gt; {</span><span id="12ac" class="mz jl in mu b gy ne nb l nc nd">const result = lib.absolute(-1);</span><span id="ba25" class="mz jl in mu b gy ne nb l nc nd">expect(result).toBe(1);</span><span id="32bd" class="mz jl in mu b gy ne nb l nc nd">});</span><span id="b177" class="mz jl in mu b gy ne nb l nc nd">test("absolute - should return a 0 if input is positive", () =&gt; {</span><span id="03e5" class="mz jl in mu b gy ne nb l nc nd">const result = lib.absolute(0);</span><span id="6466" class="mz jl in mu b gy ne nb l nc nd">expect(result).toBe(0);</span><span id="1510" class="mz jl in mu b gy ne nb l nc nd">});</span></pre><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi nf"><img src="../Images/4316ee1570007b2351f7280e5a757e25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UNM8dv6nsWte5W0gifM6ag.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">结果测试</figcaption></figure><p id="7727" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated"><strong class="kk io">分组测试</strong></p><p id="bb2a" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">测试是源代码中的一等公民。</p><p id="aed4" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">下面是分组测试的例子。</p><pre class="lh li lj lk gt mv mu mw mx aw my bi"><span id="4c2c" class="mz jl in mu b gy na nb l nc nd"><strong class="mu io">describe("absolute", () =&gt; {</strong></span><span id="478e" class="mz jl in mu b gy ne nb l nc nd">it("should return a positive number if input is positive", () =&gt; {</span><span id="4702" class="mz jl in mu b gy ne nb l nc nd">const result = lib.absolute(1);</span><span id="c38d" class="mz jl in mu b gy ne nb l nc nd">expect(result).toBe(1);</span><span id="250d" class="mz jl in mu b gy ne nb l nc nd">});</span><span id="9945" class="mz jl in mu b gy ne nb l nc nd">it("should return a positive number if input is negative", () =&gt; {</span><span id="2c68" class="mz jl in mu b gy ne nb l nc nd">const result = lib.absolute(-1);</span><span id="464c" class="mz jl in mu b gy ne nb l nc nd">expect(result).toBe(1);</span><span id="a9f2" class="mz jl in mu b gy ne nb l nc nd">});</span><span id="62cf" class="mz jl in mu b gy ne nb l nc nd">it("should return a 0 if input is positive", () =&gt; {</span><span id="d7dd" class="mz jl in mu b gy ne nb l nc nd">const result = lib.absolute(0);</span><span id="ae1c" class="mz jl in mu b gy ne nb l nc nd">expect(result).toBe(0);</span><span id="7296" class="mz jl in mu b gy ne nb l nc nd">});</span><span id="b2fd" class="mz jl in mu b gy ne nb l nc nd"><strong class="mu io">});</strong></span></pre><p id="f3cc" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated"><strong class="kk io">测试管柱</strong></p><p id="5b9d" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">文件 lib.js</p><pre class="lh li lj lk gt mv mu mw mx aw my bi"><span id="1247" class="mz jl in mu b gy na nb l nc nd">//Testing String</span><span id="5dab" class="mz jl in mu b gy ne nb l nc nd">module.exports.greet = function(name) {</span><span id="d6b7" class="mz jl in mu b gy ne nb l nc nd">return "welcome " + name;</span><span id="52ae" class="mz jl in mu b gy ne nb l nc nd">};</span></pre><p id="e541" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">文件 lib.test.js</p><pre class="lh li lj lk gt mv mu mw mx aw my bi"><span id="e41f" class="mz jl in mu b gy na nb l nc nd">describe("greet", () =&gt; {</span><span id="53ed" class="mz jl in mu b gy ne nb l nc nd">it("should return the greeting message", () =&gt; {</span><span id="7a6b" class="mz jl in mu b gy ne nb l nc nd">const result = lib.greet("Ika");</span><span id="e997" class="mz jl in mu b gy ne nb l nc nd">expect(result).toMatch(/Ika/);</span><span id="1b0b" class="mz jl in mu b gy ne nb l nc nd">expect(result).toContain("Ika");</span><span id="3cd8" class="mz jl in mu b gy ne nb l nc nd">});</span><span id="1086" class="mz jl in mu b gy ne nb l nc nd">});</span></pre><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi ng"><img src="../Images/5b81e62490b5bc3e98f8d69b2ec70b84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g-Lw5JXA-7DPfzq7qC0lQQ.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">结果</figcaption></figure><p id="040a" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated"><strong class="kk io">测试阵列</strong></p><p id="dc36" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">文件 lib.js</p><pre class="lh li lj lk gt mv mu mw mx aw my bi"><span id="d72e" class="mz jl in mu b gy na nb l nc nd">//Testing  Array</span><span id="3b26" class="mz jl in mu b gy ne nb l nc nd">module.exports.getCurrencies = function() {</span><span id="d4c6" class="mz jl in mu b gy ne nb l nc nd">return ["USD", "AUD", "EUR"];</span><span id="77ed" class="mz jl in mu b gy ne nb l nc nd">};</span></pre><p id="3345" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">文件 lib.test.js</p><p id="930d" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">测试不应该太笼统也不应该太具体。如果它们太笼统，就不能给你足够的信心让你相信你的代码是可行的。如果它们太具体，它们会变得脆弱，很容易破碎。当您编写代码时，您必须花费额外的不必要的时间来修复这些损坏的测试。</p><pre class="lh li lj lk gt mv mu mw mx aw my bi"><span id="00f9" class="mz jl in mu b gy na nb l nc nd">//Testing Array</span><span id="87d3" class="mz jl in mu b gy ne nb l nc nd">describe("getCurrencies", () =&gt; {</span><span id="ead6" class="mz jl in mu b gy ne nb l nc nd">it("should return support currencies", () =&gt; {</span><span id="5ea5" class="mz jl in mu b gy ne nb l nc nd">const result = lib.getCurrencies();</span><span id="64a8" class="mz jl in mu b gy ne nb l nc nd">//Too general</span><span id="0229" class="mz jl in mu b gy ne nb l nc nd">expect(result).toBeDefined();</span><span id="0325" class="mz jl in mu b gy ne nb l nc nd">expect(result).not.toBeNull();</span><span id="a7f8" class="mz jl in mu b gy ne nb l nc nd">//To specific</span><span id="34e6" class="mz jl in mu b gy ne nb l nc nd">expect(result[0]).toBe("USD");</span><span id="e04e" class="mz jl in mu b gy ne nb l nc nd">expect(result[1]).toBe("AUD");</span><span id="ce7a" class="mz jl in mu b gy ne nb l nc nd">expect(result[2]).toBe("EUR");</span><span id="281c" class="mz jl in mu b gy ne nb l nc nd">expect(result.length).toBe(3);</span><span id="21a9" class="mz jl in mu b gy ne nb l nc nd">/Proper way</span><span id="82d0" class="mz jl in mu b gy ne nb l nc nd">expect(result).toContain("USD");</span><span id="bfc4" class="mz jl in mu b gy ne nb l nc nd">expect(result).toContain("AUD");</span><span id="4767" class="mz jl in mu b gy ne nb l nc nd">expect(result).toContain("EUR");</span><span id="616c" class="mz jl in mu b gy ne nb l nc nd">//Ideal way</span><span id="b4f5" class="mz jl in mu b gy ne nb l nc nd">expect(result).toEqual(expect.arrayContaining(["EUR","USD","AUD"]));</span><span id="b60a" class="mz jl in mu b gy ne nb l nc nd">});</span><span id="0e35" class="mz jl in mu b gy ne nb l nc nd">});</span></pre><p id="2154" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated"><strong class="kk io">测试对象</strong></p><p id="4d3f" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">文件 lib.js</p><pre class="lh li lj lk gt mv mu mw mx aw my bi"><span id="0999" class="mz jl in mu b gy na nb l nc nd">//Testing Object</span><span id="8fbe" class="mz jl in mu b gy ne nb l nc nd">module.exports.getProduct = function(productId) {</span><span id="61c4" class="mz jl in mu b gy ne nb l nc nd">return { id: productId, price: 10 };</span><span id="7d8b" class="mz jl in mu b gy ne nb l nc nd">};</span></pre><p id="2d49" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">文件 lib.test.js</p><p id="f882" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated"><code class="fe mr ms mt mu b">.toBe</code>比较原始值或检查对象实例的引用身份。另一方面，<code class="fe mr ms mt mu b">toEqual</code>寻找深度平衡。</p><pre class="lh li lj lk gt mv mu mw mx aw my bi"><span id="af59" class="mz jl in mu b gy na nb l nc nd">//Testing Object</span><span id="19d9" class="mz jl in mu b gy ne nb l nc nd">describe("getProduct", () =&gt; {</span><span id="eaf6" class="mz jl in mu b gy ne nb l nc nd">it("should return the product with the given id", () =&gt; {</span><span id="91d1" class="mz jl in mu b gy ne nb l nc nd">const result = lib.getProduct(1);</span><span id="7fa2" class="mz jl in mu b gy ne nb l nc nd">expect(result).toEqual({ id: 1, price: 10 });</span><span id="7200" class="mz jl in mu b gy ne nb l nc nd">expect(result).toMatchObject({ id: 1, price: 10 });</span><span id="c36d" class="mz jl in mu b gy ne nb l nc nd">expect(result).toHaveProperty("id");</span><span id="4d39" class="mz jl in mu b gy ne nb l nc nd">});</span><span id="bdbc" class="mz jl in mu b gy ne nb l nc nd">});</span></pre><p id="6c22" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated"><strong class="kk io">测试异常</strong></p><p id="9c9e" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">文件 lib.js</p><pre class="lh li lj lk gt mv mu mw mx aw my bi"><span id="6ac7" class="mz jl in mu b gy na nb l nc nd">//Testing Exceptions</span><span id="6f45" class="mz jl in mu b gy ne nb l nc nd">module.exports.registerUser = function(username) {</span><span id="31a3" class="mz jl in mu b gy ne nb l nc nd">if (!username) throw new Error("Username is required");</span><span id="6fff" class="mz jl in mu b gy ne nb l nc nd">return { id: new Date().getTime(), username: username };</span><span id="fd70" class="mz jl in mu b gy ne nb l nc nd">};</span></pre><p id="f104" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">文件 lib.test.js</p><pre class="lh li lj lk gt mv mu mw mx aw my bi"><span id="9a96" class="mz jl in mu b gy na nb l nc nd">//Testing Exceptions</span><span id="311f" class="mz jl in mu b gy ne nb l nc nd">describe("getUser", () =&gt; {</span><span id="14fa" class="mz jl in mu b gy ne nb l nc nd">it("should throw if username is falsy", () =&gt; {</span><span id="6600" class="mz jl in mu b gy ne nb l nc nd">const args = [null, undefined, NaN, "", 0, false];</span><span id="a5c9" class="mz jl in mu b gy ne nb l nc nd">args.forEach((a) =&gt; {</span><span id="a50f" class="mz jl in mu b gy ne nb l nc nd">expect(() =&gt; { lib.registerUser(a)}).toThrow();</span><span id="3bff" class="mz jl in mu b gy ne nb l nc nd">});</span><span id="bda5" class="mz jl in mu b gy ne nb l nc nd">});</span><span id="30f9" class="mz jl in mu b gy ne nb l nc nd">it("should return user object is valid username is passed", () =&gt; {</span><span id="fdf1" class="mz jl in mu b gy ne nb l nc nd">const result = lib.registerUser("ika");</span><span id="ccf5" class="mz jl in mu b gy ne nb l nc nd">expect(result).toMatchObject({ username: "ika" });</span><span id="f82c" class="mz jl in mu b gy ne nb l nc nd">expect(result.id).toBeGreaterThan(0);</span><span id="aa37" class="mz jl in mu b gy ne nb l nc nd">});</span><span id="dd16" class="mz jl in mu b gy ne nb l nc nd">});</span></pre><p id="9340" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated"><strong class="kk io">连续运行测试</strong></p><p id="d640" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">每次我们对测试代码进行更改时，您都必须返回终端并再次运行 npm 测试这是大型复杂应用程序，或者在您的测试中会自动运行您的测试，您可以更改 package.json 文件中的脚本</p><pre class="lh li lj lk gt mv mu mw mx aw my bi"><span id="c1f5" class="mz jl in mu b gy na nb l nc nd">"scripts": {</span><span id="9e29" class="mz jl in mu b gy ne nb l nc nd">"test": "jest --watchAll"</span><span id="0227" class="mz jl in mu b gy ne nb l nc nd">}</span></pre><p id="17ff" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">模仿是用一个假的或模仿的函数替换一个函数的真实实现。它允许我们将应用程序代码与其外部资源隔离开来。</p><p id="5701" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">流行的笑话匹配器功能:</p><p id="14b1" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">//相等</p><p id="f783" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">期待(…)。toBe()；</p><p id="e64d" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">期待(…)。to equal()；</p><p id="39ff" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">//真实度</p><p id="e0a4" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">期待(…)。tobe defined()；</p><p id="382e" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">期待(…)。tobe null()；</p><p id="42a4" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">期待(…)。tobe truthy()；</p><p id="1f00" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">期待(…)。toBeFalsy()；</p><p id="457e" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">//数字</p><p id="570d" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">期待(…)。toBeGreaterThan()；</p><p id="a0b1" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">期待(…)。toBeGreaterThanOrEqual()；</p><p id="83ab" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">期待(…)。tobelesthan()；</p><p id="843d" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">期待(…)。toblessthanorequal()；</p><p id="5c08" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">//字符串</p><p id="ab1e" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">期待(…)。to match(/regular exp/)；</p><p id="ce68" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">//数组</p><p id="3ade" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">期待(…)。to contain()；</p><p id="85f4" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">//对象</p><p id="d979" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">期待(…)。toBe()；</p><p id="2289" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">//检查对象引用是否相等</p><p id="4bed" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">期待(…)。to equal()；</p><p id="3cc9" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">//检查属性是否相等</p><p id="ac57" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">期待(…)。toMatchObject()；</p><p id="ec4a" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">//异常</p><p id="52e2" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated">expect(() =&gt; { someCode })。to throw()；</p><p id="8a1f" class="pw-post-body-paragraph ki kj in kk b kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf ig bi translated"><em class="nh"> reff: codeWithMosh </em></p></div></div>    
</body>
</html>