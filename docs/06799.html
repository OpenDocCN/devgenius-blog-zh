<html>
<head>
<title>What are environment variables and how to manage them in Python?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是环境变量，如何在 Python 中管理它们？</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/what-are-environment-variables-and-how-to-manage-them-in-python-bab4f283381d?source=collection_archive---------8-----------------------#2022-02-04">https://blog.devgenius.io/what-are-environment-variables-and-how-to-manage-them-in-python-bab4f283381d?source=collection_archive---------8-----------------------#2022-02-04</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><h1 id="477f" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">作为软件开发初学者，我们经常会遇到“环境变量”这个术语。在这篇博文中，我将尝试解释什么是环境变量，以及如何在 Python 项目开发环境中管理它们。让我们开始吧。<br/>注意:这个博客遵循 Ubuntu 的工作流程，可以很容易地在 MacOS/Windows 中复制，稍有变化。</h1><h1 id="a2ac" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">什么是环境变量？</h1><p id="1993" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">快速的谷歌搜索会让你找到维基百科对环境变量的定义，</p><blockquote class="lg lh li"><p id="ac67" class="ki kj lj kk b kl lk kn ko kp ll kr ks lm ln kv kw lo lp kz la lq lr ld le lf ig bi translated"><em class="in">环境变量是一个动态命名的值，它可以影响计算机上正在运行的进程的行为方式。它们是流程运行环境的一部分。</em></p></blockquote><p id="7fb8" class="pw-post-body-paragraph ki kj in kk b kl lk kn ko kp ll kr ks kt ln kv kw kx lp kz la lb lr ld le lf ig bi translated">将环境变量视为系统范围的变量，它可以存储系统所拥有的资源的位置或值。环境变量可以是系统定义的，也可以是用户定义的。</p><p id="58fd" class="pw-post-body-paragraph ki kj in kk b kl lk kn ko kp ll kr ks kt ln kv kw kx lp kz la lb lr ld le lf ig bi translated">如果您使用的是 MacOS/Linux，请打开您的终端并运行命令，</p><pre class="ls lt lu lv gt lw lx ly lz aw ma bi"><span id="571c" class="mb jl in lx b gy mc md l me mf">$ printenv</span></pre><p id="387f" class="pw-post-body-paragraph ki kj in kk b kl lk kn ko kp ll kr ks kt ln kv kw kx lp kz la lb lr ld le lf ig bi translated">这将快速显示您系统中存在的所有环境变量。这些是系统上运行的程序使用的一些资源值。</p><h1 id="0775" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">环境变量有什么用？</h1><p id="0327" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">在开发我们的项目时，我们的项目可能包含各种不能公开的机密信息，以防止违反我们应用程序的完整性。例如，如果您使用过 Django，您可能知道它用于签署会话 cookies 的密钥，这是应用程序安全性的基础。在处理 web 授权范例中的 JWT 令牌时使用秘密密钥/签名，这应该是保密的。<br/>这些值不应存储在代码库或程序文件中，因为它们可能最终被检查/提交到版本控制系统中，从而对系统完整性构成威胁。<br/>在生产环境中，这些变量在运行应用实例的系统/服务器上设置。我们可以在本地开发系统中将这些变量设置为环境变量，但这是一个不必要的麻烦，可以避免。</p><h1 id="27a3" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">绕过它的方法是什么？</h1><p id="ddec" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">在本地开发环境中，有多种方法来管理环境变量。在这里，我将展示其中一个方法。</p><ul class=""><li id="9a10" class="mg mh in kk b kl lk kp ll kt mi kx mj lb mk lf ml mm mn mo bi translated">创建一个. env 文件，并将您的秘密存储在其中。</li><li id="10d7" class="mg mh in kk b kl mp kp mq kt mr kx ms lb mt lf ml mm mn mo bi translated">包括。env 在你的。gitignore 来防止它被签入到您的版本控制系统中。</li><li id="b79e" class="mg mh in kk b kl mp kp mq kt mr kx ms lb mt lf ml mm mn mo bi translated">一个例子。env 文件可能如下所示:</li></ul><pre class="ls lt lu lv gt lw lx ly lz aw ma bi"><span id="d5be" class="mb jl in lx b gy mc md l me mf">ALGORITHM=HS256<br/>SECRET_KEY=fajhfkaheufahfjbavaeua26472647yhf93h84go84g7fefaefavaegaebartttb<br/>ACCESS_TOKEN_EXPIRE_MINUTES=30</span></pre><ul class=""><li id="5490" class="mg mh in kk b kl lk kp ll kt mi kx mj lb mk lf ml mm mn mo bi translated">现在我们需要一种方法来访问 Python 程序文件中的这些值。这里，我们将使用一个名为<a class="ae mu" href="https://pydantic-docs.helpmanual.io/" rel="noopener ugc nofollow" target="_blank"> Pydantic </a>的 Python 库来管理我们的环境变量。</li><li id="c305" class="mg mh in kk b kl mp kp mq kt mr kx ms lb mt lf ml mm mn mo bi translated">继续执行命令<code class="fe mv mw mx lx b">pip install pydantic</code>，安装“Pydantic”库。</li><li id="7847" class="mg mh in kk b kl mp kp mq kt mr kx ms lb mt lf ml mm mn mo bi translated">创建一个名为<code class="fe mv mw mx lx b">config.py</code>的文件。</li><li id="6761" class="mg mh in kk b kl mp kp mq kt mr kx ms lb mt lf ml mm mn mo bi translated">在<code class="fe mv mw mx lx b">config.py</code>内部，从 pydantic 库导入 BaseSettings，并创建一个继承自<code class="fe mv mw mx lx b">BaseSettings</code>的类<code class="fe mv mw mx lx b">Settings</code>。</li><li id="3421" class="mg mh in kk b kl mp kp mq kt mr kx ms lb mt lf ml mm mn mo bi translated">在这个类中，键入环境变量名和它们的数据类型，中间用:隔开。</li><li id="5f4b" class="mg mh in kk b kl mp kp mq kt mr kx ms lb mt lf ml mm mn mo bi translated">在类设置中创建一个名为<code class="fe mv mw mx lx b">Config</code>的类，并定义一个名为<code class="fe mv mw mx lx b">env_file = ".env"</code>的变量，该变量存储包含我们之前创建的秘密值的文件名。-<code class="fe mv mw mx lx b">config.py</code>文件示例如下所示:</li></ul><pre class="ls lt lu lv gt lw lx ly lz aw ma bi"><span id="e1f0" class="mb jl in lx b gy mc md l me mf">from pydantic import BaseSettings</span><span id="5334" class="mb jl in lx b gy my md l me mf">class Settings(BaseSettings):<br/>    secret_key: str<br/>    algorithm: str<br/>    access_token_expire_minutes: int</span><span id="ff2c" class="mb jl in lx b gy my md l me mf">    class Config:<br/>        env_file = ".env"<br/></span><span id="aa50" class="mb jl in lx b gy my md l me mf">settings = Settings()</span></pre><ul class=""><li id="4f0e" class="mg mh in kk b kl lk kp ll kt mi kx mj lb mk lf ml mm mn mo bi translated">您也可以为这些参数定义默认值。示例:<code class="fe mv mw mx lx b">access_token_expire_minutes: int = 30</code></li><li id="f22c" class="mg mh in kk b kl mp kp mq kt mr kx ms lb mt lf ml mm mn mo bi translated">如上例所示实例化类设置。</li><li id="0b0c" class="mg mh in kk b kl mp kp mq kt mr kx ms lb mt lf ml mm mn mo bi translated">现在打开包含需要这些秘密值的文件，并通过键入<code class="fe mv mw mx lx b">from .config import settings</code>将这个<code class="fe mv mw mx lx b">settings</code>对象导入该文件。</li><li id="db97" class="mg mh in kk b kl mp kp mq kt mr kx ms lb mt lf ml mm mn mo bi translated">现在，我们可以将变量赋值为:</li></ul><pre class="ls lt lu lv gt lw lx ly lz aw ma bi"><span id="c1aa" class="mb jl in lx b gy mc md l me mf">ALGORITHM = settings.algorithm</span></pre><ul class=""><li id="f6cb" class="mg mh in kk b kl lk kp ll kt mi kx mj lb mk lf ml mm mn mo bi translated">类似地，对项目中的所有其他变量也这样做。</li><li id="3652" class="mg mh in kk b kl mp kp mq kt mr kx ms lb mt lf ml mm mn mo bi translated">你完了！瞧啊。</li></ul><p id="ce75" class="pw-post-body-paragraph ki kj in kk b kl lk kn ko kp ll kr ks kt ln kv kw kx lp kz la lb lr ld le lf ig bi translated">您已经成功地避免了将您的项目秘密推给版本控制系统，并且在不影响 OS 安装的情况下建立了您的本地开发环境。</p><p id="7fd7" class="pw-post-body-paragraph ki kj in kk b kl lk kn ko kp ll kr ks kt ln kv kw kx lp kz la lb lr ld le lf ig bi translated">如果这有帮助，请竖起大拇指。随时欢迎建议！感谢阅读。</p></div></div>    
</body>
</html>