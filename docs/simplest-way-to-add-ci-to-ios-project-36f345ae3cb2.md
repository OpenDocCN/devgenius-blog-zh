# å‘ iOS é¡¹ç›®æ·»åŠ é…ç½®é¡¹çš„æœ€ç®€å•æ–¹æ³•

> åŸæ–‡ï¼š<https://blog.devgenius.io/simplest-way-to-add-ci-to-ios-project-36f345ae3cb2?source=collection_archive---------3----------------------->

## é€šè¿‡åˆ©ç”¨ Github åŠ¨ä½œçš„åŠ›é‡

![](img/309c64ae091211f53b358629cb3df161.png)

ç…§ç‰‡ç”±[å±±å§†Â·é‡Œæ©](https://www.pexels.com/@sam-lion?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels)ä»[ä½©å…‹æ–¯](https://www.pexels.com/photo/glad-woman-with-cat-writing-in-planner-while-using-laptop-6002000/?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels)æ‹æ‘„

æˆ‘ä»¬éƒ½å¬è¯´è¿‡ CI/CD åœ¨ iOS å¼€å‘ä¸­çš„é‡è¦æ€§ã€‚å¤§å¤šæ•°å¤§å…¬å¸éƒ½å¸Œæœ›ä½ äº†è§£è¿™ä¸€ç‚¹ï¼Œè¿™ä¸æ˜¯å¶ç„¶çš„ã€‚

è€å®è¯´ï¼Œå½“æˆ‘ç¬¬ä¸€æ¬¡äº†è§£å®ƒçš„æ—¶å€™ï¼Œæˆ‘è®¤ä¸ºå®ƒæ˜¯éå¸¸å¤æ‚çš„äº‹æƒ…ï¼Œæˆ‘ç”šè‡³ä¸çŸ¥é“ä»å“ªé‡Œå¼€å§‹ã€‚æˆ‘å¸Œæœ›æœ‰è¿™æ ·ä¸€ç¯‡ç®€å•çš„æ–‡ç« ã€‚

æˆ‘ä»¬å°†ä¸€èµ·çœ‹çœ‹å¦‚ä½•é€šè¿‡ä½¿ç”¨ **Github Actions** æ¥è½»æ¾åœ°ä¸ºæ‚¨çš„é¡¹ç›®è®¾ç½®æ‚¨è‡ªå·±çš„ CIã€‚æ˜¯çš„ï¼Œé›¶æˆæœ¬ï¼

> å®ƒä¸ä¼šèŠ±ä½ ä¸€åˆ†é’±ï¼Œå› ä¸ºå®ƒå¯¹ Github å…¬å…±é¡¹ç›®æ˜¯å…è´¹çš„ã€‚ğŸ”¥

## ğŸ¤“è¦æ±‚:

*   Github å¸æˆ·
*   è‡³å°‘æœ‰ä¸€ä¸ªå•å…ƒæµ‹è¯•
*   æ¨é€ iOS é¡¹ç›®çš„å…¬å…±å­˜å‚¨åº“

## ğŸ™ˆCI æ˜¯ä»€ä¹ˆï¼Ÿ

æ¯æ¬¡æ–°ä»£ç è¢«æ”¾å…¥å­˜å‚¨åº“æ—¶ï¼Œéƒ½åº”è¯¥æœ‰ä¸€ä¸ª**è¿ç»­çš„**æ–¹æ³•æ¥ç¡®ä¿ä¸€åˆ‡æ­£å¸¸ï¼Œæ²¡æœ‰ä»»ä½•åŠŸèƒ½ä¸­æ–­ã€‚è¿™æ˜¯é€šè¿‡è¿è¡Œæ‰€æœ‰å•å…ƒæµ‹è¯•å¹¶æœŸæœ›å®ƒä»¬æˆåŠŸæ¥å®ç°çš„ã€‚

> CI ä»£è¡¨æŒç»­é›†æˆï¼Œæ˜¯å°†æ‰€æœ‰å¼€å‘äººå‘˜çš„å·¥ä½œå®‰å…¨å¯é åœ°åˆå¹¶åˆ°ä¸€ä¸ªåˆ†æ”¯*(åˆåå¼€å‘æˆ–ä¸»åˆ†æ”¯)*ä¸­çš„å®è·µ

å› æ­¤ï¼Œå½“æœ‰äººå°†æ–°ä»£ç æ”¾å…¥å­˜å‚¨åº“æ—¶ï¼Œæ‹¥æœ‰ CI çš„è®¡ç®—æœºå°±ä¼šè¢«è§¦å‘ï¼Œç„¶åå¼€å§‹æµ‹è¯•ä¸€åˆ‡ã€‚

## ğŸ’ªä¸ºä»€ä¹ˆè¦ç”¨ CIï¼Ÿ

æˆ‘ä»¬ç”Ÿæ´»åœ¨ä¸€ä¸ªå˜åŒ–æ— å¸¸çš„ä¸–ç•Œé‡Œï¼Œä¸€åˆ‡éƒ½å˜åŒ–å¾—å¦‚æ­¤ä¹‹å¿«ã€‚
æˆ‘ä»¬çš„å­˜å‚¨åº“å˜åŒ–ä¹Ÿå¾ˆå¿«ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æ–¹æ³•æ¥ç¡®ä¿æ¯æ¬¡æäº¤éƒ½é€šè¿‡æ‰€æœ‰æµ‹è¯•ï¼Œå¹¶ä¸”å®Œå…¨æ­£å¸¸ã€‚

æ²¡æœ‰ CIï¼Œç‰ˆæœ¬æ§åˆ¶çš„æƒ³æ³•å°±å¤±å»äº†å®ƒçš„ä»·å€¼ï¼Œå› ä¸ºæˆ‘ä»¬ä¸çŸ¥é“å“ªäº›æäº¤æ˜¯å¥å£®çš„å’ŒåŠŸèƒ½æ€§çš„(é€šè¿‡æ‰€æœ‰æµ‹è¯•)ã€‚CI è¢«è¯æ˜å¯ä»¥æé«˜å¼€å‘äººå‘˜çš„ä½“éªŒå’Œç”Ÿäº§åŠ›ã€‚

ä½†æœ€é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬å‘å®¢æˆ·æä¾›é«˜è´¨é‡çš„ä¸€æµäº§å“ğŸ‰

## ğŸš€è®©æˆ‘ä»¬çš„ iOS é¡¹ç›®æœ‰ CI

åœ¨å¼€å§‹ä¹‹å‰ï¼Œè®©æˆ‘ä»¬ç‰¹åˆ«æ„Ÿè°¢ GitHub å›¢é˜Ÿç»™äº†æˆ‘ä»¬æå‡â¤ï¸å¼€å‘è€…ä½“éªŒçš„å·¥å…·

**ç¬¬ 1 æ­¥â€”åˆ›å»ºæ–‡ä»¶:**
é¦–å…ˆåœ¨`[.github](https://github.com/Nikoloutsos/fancyGradient/tree/master/.github)/workflows/` åˆ›å»ºå¹¶æ¨é€ä¸€ä¸ªæ–°çš„ ci.yml æ–‡ä»¶ï¼Œå¦‚æœæ‚¨çš„ github ä¸­æ²¡æœ‰è¿™äº›æ–‡ä»¶å¤¹ï¼Œè¯·åˆ›å»ºå®ƒä»¬

> ğŸ“’ä½ çŸ¥é“å—ï¼Ÿyml æ–‡ä»¶ä»£è¡¨å¦ä¸€ç§æ ‡è®°è¯­è¨€ï¼Ÿ

**ç¬¬äºŒæ­¥â€”é…ç½®æ–‡ä»¶:**
åˆ›å»ºåï¼Œéœ€è¦è¿›è¡Œé…ç½®ã€‚(è¿™å°†è®© GitHub Action çŸ¥é“ä½•æ—¶è¿è¡Œä»€ä¹ˆ)

*   è¿™æ˜¯æ‚¨å·¥ä½œæµç¨‹çš„åç§°ï¼Œå°†æ˜¾ç¤ºåœ¨æ­¤å¤„

> ğŸ“’å¦‚æœçœç•¥`name`ï¼ŒGitHub ä¼šå°†å…¶è®¾ç½®ä¸ºç›¸å¯¹äºå­˜å‚¨åº“æ ¹ç›®å½•çš„å·¥ä½œæµæ–‡ä»¶è·¯å¾„ã€‚

![](img/c4049546c1ced51e423bc19cec00be19.png)

*   `on â†’ push â†’ branches` åªåœ¨éœ€è¦çš„åˆ†æ”¯ä¸Šè¿è¡Œ CIã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸»åˆ†æ”¯æˆ–å¼€å‘åˆ†æ”¯ä¸Šçš„æ–°æäº¤å°†è§¦å‘ CIã€‚
*   `on â†’ pull_request â†’ branches` ä»…å¯¹é‚£äº›å°†è¢«åˆå¹¶åˆ° master æˆ– develop çš„ pr è¿è¡Œ CIã€‚
    ç°åœ¨ä½ çš„å…¬å…³å°†ä¼šæœ‰é‚£äº›ç»¿è‰²çš„å‹¾å·âœ….

![](img/9bc93b822f27a198fe78d48aa42863b4.png)

*   `jobs â†’ build â†’ runs-on`
    ä½ å¸Œæœ›ä½ çš„é¡¹ç›®è¿è¡Œçš„ MAC-OS ç‰ˆæœ¬ã€‚
*   `jobs â†’ build â†’ name`
    è¿™æ˜¯æ‚¨ä¸ºè¯¥æ­¥éª¤æŒ‡å®šçš„åç§°ï¼Œå®ƒæ˜¾ç¤ºåœ¨è¿™é‡Œã€‚

![](img/39b5297f464da75b025b98dc70193394.png)

ç°åœ¨æœ€é‡è¦çš„æ˜¯ã€‚CI å¦‚ä½•çŸ¥é“å¦‚ä½•è¿è¡Œæˆ‘ä»¬é¡¹ç›®çš„æµ‹è¯•ï¼Ÿè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•æŒ‡å¯¼æˆ‘ä»¬çš„ CI åšåˆ°è¿™ä¸€ç‚¹ã€‚ğŸ‘€ğŸ‘‡ğŸ‘‡

*   `jobs â†’ build â†’ steps â†’ run` è¿™é‡Œæˆ‘ä»¬è¯´**è¿è¡Œâš¡ï¸çš„ç»ˆç«¯å‘½ä»¤**åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ iphone 12 mini ä¸Šè¿è¡Œæ‰€æœ‰æµ‹è¯•ã€‚
    **XCode å‘½ä»¤è¡Œå·¥å…·**ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€äº›æœ‰ç”¨çš„ç»ˆç«¯å‘½ä»¤ï¼Œç”¨äºä¸æˆ‘ä»¬çš„é¡¹ç›®è¿›è¡Œäº¤äº’ã€‚é‚£å°±æ˜¯æ„å»ºã€æµ‹è¯•ç­‰ç­‰ğŸ”¥ï¼

```
xcodebuild -scheme {{Your_SchemeName}} test -destination "platform=iOS Simulator,name=iPhone 12 mini"
```

ä¸Šè¿°å‘½ä»¤é€šè¿‡è¿è¡Œåä¸º{{Your_SchemeName}}çš„æ–¹æ¡ˆçš„æ‰€æœ‰å•å…ƒæµ‹è¯•æ¥æµ‹è¯•è¯¥æ–¹æ¡ˆã€‚

```
xcodebuild build-**for**-testing 
[-workspace <your_workspace_name>]
[-project <your_project_name>]
-scheme <your_scheme_name>
-destination <destination-specifier>
```

è¿™é‡Œæœ‰ä¸€ä¸ªå…³äºè¿™ä¸ªå‘½ä»¤è¯­æ³•çš„ç®€çŸ­æŒ‡å—ã€‚`-workspace` å’Œ`-project`æ˜¯å¯é€‰çš„ã€‚å¦‚æœä½ æƒ³äº†è§£æ›´å¤šè¿™æ–¹é¢çš„çŸ¥è¯†ï¼Œè¯·æŸ¥çœ‹

[](https://www.appsdeveloperblog.com/run-xcode-unit-tests-from-the-command-line/) [## ä»å‘½ä»¤è¡Œè¿è¡Œ Xcode å•å…ƒæµ‹è¯•â€”â€”åº”ç”¨å¼€å‘è€…åšå®¢

### åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæ‚¨å°†å­¦ä¹ å¦‚ä½•ä»å‘½ä»¤è¡Œæ„å»ºå’Œè¿è¡Œ Xcode å•å…ƒæµ‹è¯•ã€‚å‘½ä»¤è¡Œå·¥å…·â€¦

www.appsdeveloperblog.com](https://www.appsdeveloperblog.com/run-xcode-unit-tests-from-the-command-line/) 

æƒ³è±¡ä¸€ä¸‹æˆ‘ä»¬åœ¨ç»ˆç«¯ä¸Šè¿è¡Œè¿™ä¸ªå‘½ä»¤ã€‚é™¤äº†åœ¨ Github è¿™è¾¹çš„ä¸åŒæœºå™¨ä¸Šè¿è¡Œä¹‹å¤–ï¼Œéƒ½æ˜¯ä¸€æ ·çš„ã€‚

> ä¸è¦ä½¿ç”¨ XCode å‘½ä»¤è¡Œå·¥å…·ï¼Œä½ å¯ä»¥ä½¿ç”¨å¤§å¤šæ•°å…¬å¸å¤§é‡ä½¿ç”¨çš„ **fastlane** ã€‚å®ƒåŸºæœ¬ä¸Šæä¾›äº†ä¸€ä¸ªæ›´ç®€å•çš„ç•Œé¢å’Œæ›´æ€§æ„Ÿçš„è¾“å‡ºã€‚ä½¿ç”¨ fastlaneï¼Œä½ å¯ä»¥ç”¨æ›´å°‘çš„å†™ä½œè·å¾—æ›´å¤šã€‚
> [https://fast lane . tools](https://fastlane.tools)

**ç¬¬ä¸‰æ­¥â€”â€”æ¨åŠ¨ä½ çš„æ”¹å˜**

å°±è¿™æ ·ç¥è´ºä½ ğŸ‰ï¼Œæ‚¨æ­£å¼ä¸ºæ‚¨çš„ iOS é¡¹ç›®è®¾ç½®äº†ç¬¬ä¸€ä¸ª CIã€‚

## â¤ï¸é¢å¤–æç¤º(åœ¨ github ä¸Šè·å¾—çŠ¶æ€å¾½ç« )

è¿™çœŸçš„å¾ˆç®€å•ï¼Œä½ æ‰€è¦åšçš„å°±æ˜¯ä¿®æ”¹ä½ çš„ README.md æ–‡ä»¶ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹å†…å®¹

```
[![ci]([https://github.com/](https://github.com/Nikoloutsos/fancy-gradient/actions/workflows/ci.yml/badge.svg)<OWNER>[/](https://github.com/Nikoloutsos/fancy-gradient/actions/workflows/ci.yml/badge.svg)<REPOSITORY>[/actions/workflows/ci.yml/badge.svg](https://github.com/Nikoloutsos/fancy-gradient/actions/workflows/ci.yml/badge.svg))]
```

![](img/952693e7d842977f9c4d2db2b8e9ffc7.png)

å¦‚æœæ‚¨å¸Œæœ›æ¯ä¸ªåˆ†æ”¯æœ‰ä¸åŒçš„çŠ¶æ€ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤:

```
![example branch parameter](https://github.com/github/docs/actions/workflows/ci.yml/badge.svg?branch=feature-1)
```

[https://docs . github . com/en/actions/monitoring-and-trouble shooting-workflows/adding-a-workflow-status-badge](https://docs.github.com/en/actions/monitoring-and-troubleshooting-workflows/adding-a-workflow-status-badge)

## â“ç°åœ¨è¯¥æ€ä¹ˆåŠï¼Ÿï¼š

æˆ‘å¸Œæœ›ä½ è§‰å¾—è¿™å¾ˆæœ‰è¶£ã€‚å•å…ƒæµ‹è¯•å’Œ CI æ˜¯ç»™å…¬å¸å¸¦æ¥å¾ˆå¤šä»·å€¼çš„äº‹æƒ…ä¹‹ä¸€ï¼Œå› ä¸ºå®ƒä»¬å‡å°‘äº†æ‰‹åŠ¨æµ‹è¯•å¹¶æœ‰åŠ©äºæ„å»ºé«˜è´¨é‡çš„äº§å“ã€‚

å¤§å¤šæ•°é«˜è–ªå·¥ä½œéƒ½éœ€è¦è¿™ç§æŠ€èƒ½ï¼Œè¿™ä¸æ˜¯å¶ç„¶çš„ã€‚å¾ˆé«˜å…´åœ¨è¿™é‡Œçœ‹åˆ°ä½ ï¼Œè¿™æ„å‘³ç€ä½ å…³å¿ƒæˆä¸ºä¸€ä¸ªæ›´å¥½çš„è‡ªå·±ï¼Œæ¯«æ— ç–‘é—®ï¼Œä½ å¾ˆå¿«å°±ä¼šå¾—åˆ°å›æŠ¥ğŸ¤©ï¼

å¦‚æœä½ å–œæ¬¢è¯»è¿™ç¯‡æ–‡ç« ï¼Œåˆ«å¿˜äº†ç•™ä¸‹ğŸ‘