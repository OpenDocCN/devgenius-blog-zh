<html>
<head>
<title>Snowflake Security: Key-Pair Authentication &amp; Rotation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">雪花安全:密钥对认证和轮换</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/snowflake-security-key-pair-authentication-rotation-a2bf81fda6f5?source=collection_archive---------4-----------------------#2022-12-15">https://blog.devgenius.io/snowflake-security-key-pair-authentication-rotation-a2bf81fda6f5?source=collection_archive---------4-----------------------#2022-12-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/44cecd4fdef73a58bf7fb6069d6bcb22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rsFjCOy-9B5TbZSp"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">马科斯·费雷拉在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="0015" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇博客中，我们将了解如何增强认证安全性，作为基本认证(即用户名和密码)的替代方案。有多种方法可以连接或保护通往雪花的道路。如果你看到下图，所有可能的方法都列在下面。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/4fb287c390a60943b253f65a63e75390.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*lRYvEuBQs-US3DzE1vh3CQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">雪花认证</figcaption></figure><p id="a7b7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇博客中，我们将重点关注密钥对认证和密钥对轮换(手动)。</p></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><h1 id="8f98" class="ln lo iq bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">密钥对认证的用例是什么？</h1><p id="a23d" class="pw-post-body-paragraph kd ke iq kf b kg ml ki kj kk mm km kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">如果您不想对您的服务帐户使用基本(用户名和密码)身份验证，您的集成应用程序将使用 snowsql CLI 或支持的驱动程序或连接器使用该帐户连接到雪花。</p><p id="20d3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您希望为您的客户端应用程序提供更加增强和安全的身份验证方式。</p></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><h1 id="f63f" class="ln lo iq bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">什么是密钥对认证？谁能用这个？</h1><p id="990b" class="pw-post-body-paragraph kd ke iq kf b kg ml ki kj kk mm km kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">密钥对身份验证是增强的身份验证安全性或从支持的客户端连接到雪花的替代方式。在密钥对身份验证中，用户使用私有-公共密钥对进行身份验证，而公共密钥驻留在具有各自用户设置的雪花内部，而私有密钥安全地存储在他们想要连接到雪花的客户端。</p><p id="f76c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这种认证方法至少需要一个<strong class="kf ir"> 2048 位 RSA 密钥对</strong>。您可以使用 OpenSSL 生成<strong class="kf ir">隐私增强邮件(即 PEM)私有-公共密钥对。</strong></p><p id="85b8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这种身份验证方式不适用于 Web UI 连接。这仅适用于使用连接器或驱动程序或 Snowsql CLI 连接到雪花客户端。</p><p id="71b0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这种连接方式更加安全，因为我们不必使用密码进行连接，而从任何支持的客户端进行连接时，密码可能容易受到攻击。</p></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><h1 id="eee7" class="ln lo iq bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">密钥对身份验证支持哪些客户端？</h1><p id="0a2e" class="pw-post-body-paragraph kd ke iq kf b kg ml ki kj kk mm km kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">雪花支持加密和未加密的私钥来连接大多数客户端，除了<strong class="kf ir"> Go 驱动程序</strong>只支持加密的私钥。更多详情见下图:</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mq"><img src="../Images/ddecc679d47836fe8e88768dcf0715c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*he-DAZAsHUp2E0aLLJeh2A.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">来源:雪花</figcaption></figure></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><h1 id="a69e" class="ln lo iq bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">我们如何在雪花中为我们的客户设置密钥对？</h1><p id="7622" class="pw-post-body-paragraph kd ke iq kf b kg ml ki kj kk mm km kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">以下是在雪花中进行这种设置的高级步骤。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/11304bc8dd0a3cf835c9f24cc24b2697.png" data-original-src="https://miro.medium.com/v2/resize:fit:282/format:webp/1*j6yOFuTq75gUz_4eMxykMA.png"/></div></figure></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><h1 id="4f2d" class="ln lo iq bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">来个快速演示怎么样？</h1><h2 id="ba4e" class="ms lo iq bd lp mt mu dn lt mv mw dp lx ko mx my mb ks mz na mf kw nb nc mj nd bi translated">步骤 1:我们将首先提供环境和用户，以开始我们的演示。将计算赋予公共角色，让我们的生活变得轻松。</h2><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ne"><img src="../Images/17b608a9b340a58450a1d41b667e358d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kj1wLBxn-O2HOcv-_CxK1A.png"/></div></div></figure><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/73b30756696015da25ceb034daebf88a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*YH38AMTSwiXGXJAeJrjWCA.png"/></div></figure><h2 id="c039" class="ms lo iq bd lp mt mu dn lt mv mw dp lx ko mx my mb ks mz na mf kw nb nc mj nd bi translated">第二步:下载 OpenSSL，并将解压后的文件夹保存在任何你有读写权限的驱动器中</h2><h2 id="f17c" class="ms lo iq bd lp mt mu dn lt mv mw dp lx ko mx my mb ks mz na mf kw nb nc mj nd bi translated">步骤 3:设置以下两个环境变量</h2><p id="41a3" class="pw-post-body-paragraph kd ke iq kf b kg ml ki kj kk mm km kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">我是在我的 Win 10 笔记本电脑上做的，所以我在那里设置了环境变量。</p><p id="8825" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">OPENSSL _ CONF</strong>=&lt;OPENSSL 路径&gt;\ bin \ OPENSSL . CNF<br/><strong class="kf ir">RANDFILE</strong>=&lt;OPENSSL 路径&gt; \bin\。rnd</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ng"><img src="../Images/544c318d9c82fb5475f6f2611aace48a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6gbIZ4UZUon41gpNac9A4A.jpeg"/></div></div></figure><h2 id="219a" class="ms lo iq bd lp mt mu dn lt mv mw dp lx ko mx my mb ks mz na mf kw nb nc mj nd bi translated">步骤 4:打开命令提示符并生成私钥的加密版本。请选择严格的短语</h2><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nh"><img src="../Images/a99f6bdadc78ef73d3da4aaee209caf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-SUctma7do4abT7N5Impyg.jpeg"/></div></div></figure><p id="56f4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">可以看到<strong class="kf ir"> rsa_key.p8 </strong>私钥是在指定的输出文件夹中生成的。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/20e89457949a72c485dd876f778b47d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Et0R2IG-o29f_Okp4AZqyA.png"/></div></div></figure><h2 id="b365" class="ms lo iq bd lp mt mu dn lt mv mw dp lx ko mx my mb ks mz na mf kw nb nc mj nd bi translated">步骤 5:生成一个公钥&amp;验证它看起来像什么</h2><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/d04d5e56d02e89a4a78f762ecc649f3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oRp1m7SfT5RC9pAAjq6BhA.png"/></div></div></figure><p id="92ea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">可以看到<strong class="kf ir"> rsa_key.pub </strong>公钥是在指定的输出文件夹中生成的。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/3823be419b950ec9e9dd06d53382ee62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4a-WB99oocjIAReFIbJt5Q.png"/></div></div></figure><p id="d941" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是打开时公钥文件的样子。pub 文件。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/461cc6fe8eaf7b1a344924e5c97c616d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8_580Il3BJrl9CdWpNKbrQ.png"/></div></div></figure><h2 id="b4e6" class="ms lo iq bd lp mt mu dn lt mv mw dp lx ko mx my mb ks mz na mf kw nb nc mj nd bi translated">步骤 6:将公钥分配给雪花密钥对测试用户</h2><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/9cb520a04ab4b7495c48949cc66314c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J5poE-gPu5xBTVUsA3pcUg.png"/></div></div></figure><h2 id="1ffc" class="ms lo iq bd lp mt mu dn lt mv mw dp lx ko mx my mb ks mz na mf kw nb nc mj nd bi translated">步骤 7:验证用户 RSA 设置是否正确，以及用户的公钥指纹</h2><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/99699cf967d5d7609fd9b5cab024d4d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xw5RsB5Sd2Z45lSNdfBY1A.png"/></div></div></figure><h2 id="6530" class="ms lo iq bd lp mt mu dn lt mv mw dp lx ko mx my mb ks mz na mf kw nb nc mj nd bi translated">步骤 8:使用密钥对认证通过 Snowsql 连接</h2><p id="31e0" class="pw-post-body-paragraph kd ke iq kf b kg ml ki kj kk mm km kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">在从 CLI 连接时，您必须确保包含— private-key-path 参数，并键入您在生成私钥时使用的正确私钥密码。宾果，然后你登录没有密码。您也可以将密码留空，但建议您保留一个复杂的密码，并使用文件权限保护您的私钥文件。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi no"><img src="../Images/03fead92fc3fe9a28c500fabe010d4d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tw3sLc6zEUW3qYuPTqyVxg.png"/></div></div></figure></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><h2 id="48e8" class="ms lo iq bd lp mt mu dn lt mv mw dp lx ko mx my mb ks mz na mf kw nb nc mj nd bi translated">如何旋转密钥对值？</h2><p id="5ae6" class="pw-post-body-paragraph kd ke iq kf b kg ml ki kj kk mm km kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">重复上面演示中的<strong class="kf ir">步骤 4、5，重新生成私有&amp;公钥。</strong></p><h2 id="edd8" class="ms lo iq bd lp mt mu dn lt mv mw dp lx ko mx my mb ks mz na mf kw nb nc mj nd bi translated"><strong class="ak">步骤 1: </strong>改变用户<strong class="ak"> rsa_public_key_2 </strong>字段，而不是上面演示的<strong class="ak"> rsa_public_key 字段</strong>。这将有助于在下一步中通过从<strong class="ak"> rsa_public_key </strong>字段中移除旧密钥来轮换密钥</h2><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi np"><img src="../Images/3507050c4b29cc9bffbcc85d75c8f0a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MfZUJ4iQ3T1Wh-wgj4UvfA.png"/></div></div></figure><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nq"><img src="../Images/8c10b5e1cd518d5391f8bed664e6fd5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_p_yHiS3VVTMb4FfhcQCKQ.png"/></div></div></figure><h2 id="c098" class="ms lo iq bd lp mt mu dn lt mv mw dp lx ko mx my mb ks mz na mf kw nb nc mj nd bi translated"><strong class="ak">步骤 2: </strong>验证哪个 RSA 密钥已设置给用户。</h2><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nr"><img src="../Images/470247ec0b5c474146caaedb375d9ba0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gzWpbjqaCvFN2aybAOLroA.png"/></div></div></figure><h2 id="5ac9" class="ms lo iq bd lp mt mu dn lt mv mw dp lx ko mx my mb ks mz na mf kw nb nc mj nd bi translated">步骤 3:使用密钥对认证通过 Snowsql 连接</h2><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi no"><img src="../Images/5f5ebaee5fd811c020c2f158d8bf2560.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h2KFypWHJTNhtAGBtRpKpQ.png"/></div></div></figure></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><p id="1a57" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">希望这篇博客能帮助你深入了解即将到来的<strong class="kf ir">密钥对认证和轮换特性工程</strong>。如果你对此有任何疑问，欢迎在评论区提问。如果你喜欢这个博客，请鼓掌。保持联系，看到更多这样的酷东西。谢谢你的支持。</p><p id="97d9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">你可以找我:</strong></p><p id="70e2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">订阅我的 YouTube 频道:</strong><a class="ae kc" href="https://www.youtube.com/c/RajivGuptaEverydayLearning" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/c/RajivGuptaEverydayLearning</a></p><p id="3c62" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">跟我上媒:</strong><a class="ae kc" href="https://rajivgupta780184.medium.com/" rel="noopener">https://rajivgupta780184.medium.com/</a></p><p id="0fca" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">在推特上关注我:</strong><a class="ae kc" href="https://twitter.com/RAJIVGUPTA780" rel="noopener ugc nofollow" target="_blank">https://twitter.com/RAJIVGUPTA780</a></p><p id="fa63" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">在 LinkedIn 跟我连线:</strong><a class="ae kc" href="https://www.linkedin.com/in/rajiv-gupta-618b0228/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/rajiv-gupta-618b0228/</a></p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/dd14cae8274e3961fff79ab28558fed4.png" data-original-src="https://miro.medium.com/v2/resize:fit:946/format:webp/0*aMKwtVXqSea39Fac.png"/></div></figure><p id="9523" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">#继续学习#继续分享# RajivGupta everyday learning # SnowflakeDataSuperhero # RajivGupta</strong></p></div></div>    
</body>
</html>