<html>
<head>
<title>Data Viz with D3 in Google Colab</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据即在谷歌 Colab 的 D3</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/data-viz-with-d3-in-google-colab-342660d5849b?source=collection_archive---------7-----------------------#2022-01-26">https://blog.devgenius.io/data-viz-with-d3-in-google-colab-342660d5849b?source=collection_archive---------7-----------------------#2022-01-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3d0d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在 Google Colab 笔记本上开始使用 D3</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/8892ef065a23cc8aa31aac00c5c5f79e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7iM__hI-OnqT0wKsfTX0xw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">由 D3.js 生成的可视化示例，由 d3js.org(<a class="ae lb" href="https://github.com/d3/d3.github.com/tree/master/ex" rel="noopener ugc nofollow" target="_blank">https://github.com/d3/d3.github.com/tree/master/ex</a>)提供</figcaption></figure><p id="ff9c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这并不意味着对<a class="ae lb" href="https://d3js.org" rel="noopener ugc nofollow" target="_blank"> D3.js </a>本身的详细介绍，而是作为在<a class="ae lb" href="https://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank"> Google Colab 的</a>托管 Jupyter 笔记本上使用 D3 的一个快速(但干净)的开始。</p><p id="c82d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于 D3 本身的介绍，包括基础的 web 标准(HTML、SVG、CSS 和 JavaScript)，我推荐下面的文章、教科书和教程:</p><h2 id="61d7" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">文章</h2><ul class=""><li id="5a6d" class="lv lw iq jp b jq lx ju ly jy lz kc ma kg mb kk mc md me mf bi translated"><a class="ae lb" href="https://medium.com/@enjalot/the-hitchhikers-guide-to-d3-js-a8552174733a" rel="noopener">D3 . js 的搭便车指南</a></li><li id="aec6" class="lv lw iq jp b jq mg ju mh jy mi kc mj kg mk kk mc md me mf bi translated"><a class="ae lb" href="https://towardsdatascience.com/interactive-data-visualization-with-d3-js-43fc3428a27e" rel="noopener" target="_blank">用 D3.js 进行交互式数据可视化</a></li></ul><h2 id="9268" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">书</h2><ul class=""><li id="d76b" class="lv lw iq jp b jq lx ju ly jy lz kc ma kg mb kk mc md me mf bi translated"><a class="ae lb" href="http://shop.oreilly.com/product/0636920026938.do" rel="noopener ugc nofollow" target="_blank">由<a class="ae lb" href="https://twitter.com/alignedleft" rel="noopener ugc nofollow" target="_blank">斯考特·玛瑞</a>开发的用于 Web </a>的交互式数据可视化</li><li id="a372" class="lv lw iq jp b jq mg ju mh jy mi kc mj kg mk kk mc md me mf bi translated"><a class="ae lb" href="https://www.manning.com/books/d3-js-in-action" rel="noopener ugc nofollow" target="_blank"> D3.js 在行动</a>由<a class="ae lb" href="https://twitter.com/Elijah_Meeks" rel="noopener ugc nofollow" target="_blank"> Elijah Meeks </a></li></ul><h2 id="e9e8" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">教程</h2><ul class=""><li id="9bfd" class="lv lw iq jp b jq lx ju ly jy lz kc ma kg mb kk mc md me mf bi translated"><a class="ae lb" href="https://github.com/d3/d3/wiki/Tutorials" rel="noopener ugc nofollow" target="_blank">官方 D3 教程</a></li><li id="1ae4" class="lv lw iq jp b jq mg ju mh jy mi kc mj kg mk kk mc md me mf bi translated"><a class="ae lb" href="https://www.freecodecamp.org/news/d3js-tutorial-data-visualization-for-beginners/" rel="noopener ugc nofollow" target="_blank"> D3.js 教程—初学者数据可视化</a></li><li id="02d1" class="lv lw iq jp b jq mg ju mh jy mi kc mj kg mk kk mc md me mf bi translated"><a class="ae lb" href="https://www.freecodecamp.org/news/d3-and-canvas-in-3-steps-8505c8b27444" rel="noopener ugc nofollow" target="_blank"> D3 和画布分三步</a></li></ul><h1 id="3bde" class="ml ld iq bd le mm mn mo lh mp mq mr lk ms mt mu ln mv mw mx lq my mz na lt nb bi translated">这篇文章是关于什么的？</h1><p id="4391" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy nc ka kb kc nd ke kf kg ne ki kj kk ij bi translated">重申一下，这只是对在 Google Colab 中编写和运行 D3 的一些有用特性的简单介绍。这些例子几乎一对一地适用于您使用 Jupyter 笔记本在几乎任何环境中所能做的事情。</p><h1 id="5592" class="ml ld iq bd le mm mn mo lh mp mq mr lk ms mt mu ln mv mw mx lq my mz na lt nb bi translated">入门指南</h1><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/6f16487e93afe3007c3b6f3e37dad593.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*6SgGzdUZzFXQNwTy.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated"><a class="ae lb" href="https://imgs.xkcd.com/comics/90s_flowchart.png" rel="noopener ugc nofollow" target="_blank">《入门》，XKCD 的 90 年代流程图</a></figcaption></figure><p id="2d6d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你还不熟悉<a class="ae lb" href="https://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌 Colab </a>，或者只是想复习一下 Jupyter 笔记本，我建议从<a class="ae lb" href="https://colab.research.google.com/notebooks/basic_features_overview.ipynb" rel="noopener ugc nofollow" target="_blank"> Colab 的文档</a>开始。</p><p id="2b6f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以<a class="ae lb" href="https://colab.research.google.com/drive/1Xbo9wU7kLKqxNgSCfmpVNSGrHdgZVZC6?usp=sharing" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">把这个 Colab 笔记本</strong> </a>连同下面的例子一起复制到下面。</p><h1 id="abec" class="ml ld iq bd le mm mn mo lh mp mq mr lk ms mt mu ln mv mw mx lq my mz na lt nb bi translated">在显示输出中呈现 HTML</h1><p id="c1d2" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy nc ka kb kc nd ke kf kg ne ki kj kk ij bi translated">你首先应该熟悉的是在笔记本中呈现 HTML 的两种最简单的方法。第一个是用“魔术”<code class="fe ng nh ni nj b">%%html</code>，它允许你把整个单元格块渲染成 html。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nk"><img src="../Images/8ec4d6c178b89545edbf71c5e71dad8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qlrcRrXNR143U4EMSX2xuA.png"/></div></div></figure><p id="3eda" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第二种是<code class="fe ng nh ni nj b">IPython.core.display.HTML</code>，这是一种更 pythonic 式’的编写和呈现 HTML 的方式，不需要把块变成专门的 HTML 块。</p><p id="d612" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在下面的例子中，我们将主要使用这种方法，但是在其他情况下，简单地使用单元格魔术更好，因为它使用起来稍微简单一些，特别是当您需要的只是一个 HTML 块时。</p><p id="a7f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">使用</strong> <code class="fe ng nh ni nj b">IPython.core.display.HTML</code>:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nl nm l"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nn"><img src="../Images/f13a4c4f7cddd1477de2788fb75a00a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CGq1lPgtPwWBTHzelXhLow.png"/></div></div></figure><h1 id="fe63" class="ml ld iq bd le mm mn mo lh mp mq mr lk ms mt mu ln mv mw mx lq my mz na lt nb bi translated">D3.js 简介</h1><p id="224c" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy nc ka kb kc nd ke kf kg ne ki kj kk ij bi translated">既然我们有了一个快速(和干净)的方法来介绍 HTML(以及 CSS、Javascript 和 SVG ),让我们从一个相对简单的 D3 例子开始，在这里我们将利用 D3 的一些元素来创建一个风格化的数字块。</p><p id="a12b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意:提醒一下，我们不会在本文中涉及 D3 的细节。我们假设您已经熟悉了其中的许多概念，但只是想要一些带有更多“主体”和“颜色”的模板，以补充您在 Jupyter 笔记本环境中学习库的初级阶段。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nl nm l"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi no"><img src="../Images/93c2e51adf1fa9352736cc94a7942991.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/1*fdy5FZQuc5bvVyNK4usiZA.png"/></div></figure><h1 id="f386" class="ml ld iq bd le mm mn mo lh mp mq mr lk ms mt mu ln mv mw mx lq my mz na lt nb bi translated">从“字符串”使用 python 的模板类</h1><p id="d67b" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy nc ka kb kc nd ke kf kg ne ki kj kk ij bi translated">既然我们已经有了一些很可能被复制或以其他方式塞满我们工作空间的代码，我想介绍一下 python 流行且无处不在的<a class="ae lb" href="https://docs.python.org/3/library/string.html" rel="noopener ugc nofollow" target="_blank">模板</a>类。</p><p id="3ed4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">模板的<a class="ae lb" href="https://docs.python.org/3/library/string.html" rel="noopener ugc nofollow" target="_blank">文档</a>开始如下:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi np"><img src="../Images/5f188e240f04bad236732c6d567cbfef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z5H5ASTuS36Cbw-qusjJCA.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated"><a class="ae lb" href="https://docs.python.org/3/library/string.html" rel="noopener ugc nofollow" target="_blank"> 3.10.2 文档 Python 标准库文本处理服务字符串</a></figcaption></figure><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="5e69" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我们可以将两者结合起来，将我们的<code class="fe ng nh ni nj b">d3_script</code>代入我们的模板，如下所示。</p><pre class="km kn ko kp gt nq nj nr ns aw nt bi"><span id="1056" class="lc ld iq nj b gy nu nv l nw nx">HTML(first_template.substitute({'d3_script' : d3_script}))</span></pre><p id="b96b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">再次查看我们在 Google Colab 中的输出。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ny"><img src="../Images/9f9ac61605df87b08a3337a0268d7601.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CsVtZHKJ0_nrWkXQCXwTRA.png"/></div></div></figure><h1 id="22e2" class="ml ld iq bd le mm mn mo lh mp mq mr lk ms mt mu ln mv mw mx lq my mz na lt nb bi translated">在单元运行前执行代码？</h1><p id="af29" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy nc ka kb kc nd ke kf kg ne ki kj kk ij bi translated">现在，您可能会提前考虑每个单元格如何至少包含<code class="fe ng nh ni nj b">&lt;script&gt; src=’https://d3js.org/d3.v7.min.js'&gt;&lt;/script&gt;</code>。考虑到你可能会写一个非常详细的包含大量 3d 可视化的一步一步的笔记本，你可能不希望在你的艺术作品中尽可能地加入重复的文本。</p><p id="f3de" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是函数<code class="fe ng nh ni nj b">get_ipython().events.register(...)</code>特别方便的地方。我们可以在每个单元正式执行之前为用户“注册”一点(或许多)要运行的代码。</p><p id="896c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们通过调用<code class="fe ng nh ni nj b">get_ipython().events.register(‘pre_run_cell’, my_super_awesome_script_gets_referenced_here)</code>来实现。</p><p id="010b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将首先定义一个名为<code class="fe ng nh ni nj b">load_d3_in_cell_output</code>的函数，它将为每个单元格加载 D3.js。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nl nm l"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nz"><img src="../Images/d37b3c3b71111b2f71b21e02909122e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bqg7nZTPcqbOmf2FbPMpVw.png"/></div></div></figure><p id="a4c8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在演示我们的新功能时，我还会偷偷放入一个我们上面提到的替代渲染工具的例子，常用的 Python“magic”，<code class="fe ng nh ni nj b">%%html</code>。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nl nm l"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/8a91e1a613b8546120012d021b2909ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*wGUOeawP1VOd1xvaOn8bUw.png"/></div></figure><h1 id="bfbc" class="ml ld iq bd le mm mn mo lh mp mq mr lk ms mt mu ln mv mw mx lq my mz na lt nb bi translated">D3 可视化</h1><h2 id="e3dd" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">简单条形图</h2><p id="bcbb" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy nc ka kb kc nd ke kf kg ne ki kj kk ij bi translated">借鉴我们之前关于 Python 的<a class="ae lb" href="https://docs.python.org/3/library/string.html" rel="noopener ugc nofollow" target="_blank">字符串的经验。模板</a>类，我们将从一个<code class="fe ng nh ni nj b">&lt;head/&gt; and included &lt;style/&gt;</code>元素开始下一个例子，定义一些我们不想在后续渲染中重复的 css 属性。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="0deb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们将把上述内容包含在一个模板中，我们再次用<code class="fe ng nh ni nj b">Html(...)</code>渲染，我们也可以用<code class="fe ng nh ni nj b">%%html</code>调用它。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nl nm l"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ob"><img src="../Images/57b2bfd88f68911e6267da1872208652.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c3UN-NdQ4S4ftZRVLNOF3A.png"/></div></div></figure><p id="db30" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的下一个例子有点偏离我们上面的综合努力，而是更能说明我们可以用 D3.js 创建的一些相对简单的<code class="fe ng nh ni nj b">&lt;svg/&gt;</code>元素。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nl nm l"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oc"><img src="../Images/42e423de070bb6ff9b2c24b35c453d58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*yprNfT97ckTpCddawcoq_Q.png"/></div></div></figure><h1 id="7a2d" class="ml ld iq bd le mm mn mo lh mp mq mr lk ms mt mu ln mv mw mx lq my mz na lt nb bi translated">暂时就这样吧！</h1><p id="6852" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy nc ka kb kc nd ke kf kg ne ki kj kk ij bi translated">显然，D3 有更多的功能，甚至你可以做更多的事情来利用 Google Colab 制作你的可视化。在随后的文章中，我们将更深入地探讨“交互式可视化”等主题，并利用 Google Colab 的免费(或非常便宜)资源，使用相当大的数据集渲染更复杂的视觉效果。</p><p id="05f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">与此同时，我很期待看到你的成果。如果你有任何关于 D3 和 Colab (Jupyter)的建议，欢迎直接给我发消息，或者在下面评论这篇文章。</p><p id="157b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你自己写了一些文章或构建了有趣的例子，我也很乐意在这里引用你的作品。</p><p id="459d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一如既往，别忘了<a class="ae lb" href="https://austinkleon.com/show-your-work/" rel="noopener ugc nofollow" target="_blank">秀出你的作品</a>！！真的很有帮助。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><a href="https://medium.com/@gmsharpe/membership"><div class="gh gi od"><img src="../Images/ed7f6b526ad2d92044d084cbccbcb794.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bWl-ptM7fzZf_h2SGFrZtg.png"/></div></a><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">请考虑用上面的会员推荐链接注册一个中等会员——谢谢！</figcaption></figure></div><div class="ab cl oe of hu og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="ij ik il im in"><h1 id="3ed6" class="ml ld iq bd le mm ol mo lh mp om mr lk ms on mu ln mv oo mx lq my op na lt nb bi translated">信用</h1><p id="6872" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy nc ka kb kc nd ke kf kg ne ki kj kk ij bi translated">感谢<a class="ae lb" href="https://twitter.com/alignedleft" rel="noopener ugc nofollow" target="_blank">斯考特·玛瑞</a>和他在<a class="ae lb" href="http://shop.oreilly.com/product/0636920026938.do" rel="noopener ugc nofollow" target="_blank">为网络进行的交互式数据可视化</a>的工作，为本文中的许多例子提供了基础</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><a href="https://learning.oreilly.com/library/view/interactive-data-visualization/9781491921296/"><div class="gh gi nf"><img src="../Images/58fd5f4e5a3bec897e4dd1cc5a94728d.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/0*8Z05nDiXi-YAJIxO"/></div></a></figure></div></div>    
</body>
</html>