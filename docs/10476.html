<html>
<head>
<title>PHP — P88: MySQL Select</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PHP — P88: MySQL 选择</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/php-p88-mysql-select-d7a633e736b?source=collection_archive---------6-----------------------#2022-11-04">https://blog.devgenius.io/php-p88-mysql-select-d7a633e736b?source=collection_archive---------6-----------------------#2022-11-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/28ac2b41e9702494e4203ff4869847e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qAdRfUnKSuQY2s_wL-Zq0A.jpeg"/></div></div></figure><p id="2d0c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们已经完成了插入过程，在我们的<code class="fe kw kx ky kz b">authors</code>表中插入了一些记录。现在怎么办？一个常见的任务是检索这些条目并在屏幕上显示它们。这就是<code class="fe kw kx ky kz b">SELECT</code>语句的由来。</p><div class="la lb gp gr lc ld"><a href="https://dinocajic.medium.com/php-p87-mysql-insert-multiple-records-with-prepared-statements-c5c7bcfb42a3" rel="noopener follow" target="_blank"><div class="le ab fo"><div class="lf ab lg cl cj lh"><h2 class="bd ir gy z fp li fr fs lj fu fw ip bi translated">PHP — P87: MySQL 用准备好的语句插入多条记录</h2><div class="lk l"><h3 class="bd b gy z fp li fr fs lj fu fw dk translated">你可能会注意到文章之间有一些小的堆砌，这是有意的。没有理由压倒或淡化这个话题。在…</h3></div><div class="ll l"><p class="bd b dl z fp li fr fs lj fu fw dk translated">dinocajic.medium.com</p></div></div><div class="lm l"><div class="ln l lo lp lq lm lr jw ld"/></div></div></a></div><h1 id="8e4d" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">一个简单的 Select 语句</h1><p id="c9d9" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">为了让选择发挥作用，我们需要:</p><ul class=""><li id="c457" class="mv mw iq ka b kb kc kf kg kj mx kn my kr mz kv na nb nc nd bi translated">连接到数据库</li><li id="eddd" class="mv mw iq ka b kb ne kf nf kj ng kn nh kr ni kv na nb nc nd bi translated">传递我们的选择查询</li><li id="d831" class="mv mw iq ka b kb ne kf nf kj ng kn nh kr ni kv na nb nc nd bi translated">检索结果，这只是数据行。</li><li id="18dd" class="mv mw iq ka b kb ne kf nf kj ng kn nh kr ni kv na nb nc nd bi translated">循环遍历每个结果，并提取返回的每一行的数据。</li><li id="8398" class="mv mw iq ka b kb ne kf nf kj ng kn nh kr ni kv na nb nc nd bi translated">关闭连接</li></ul><p id="2aa3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">直截了当。让我们首先隔离选择过程。它从 select 语句开始。</p><pre class="nj nk nl nm gt nn kz no np aw nq bi"><span id="b707" class="nr lt iq kz b gy ns nt l nu nv">$sql = "SELECT * FROM authors";<br/><br/>$results = $mysqli-&gt;query( $sql );</span></pre><p id="137c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将传递我们的<code class="fe kw kx ky kz b">SELECT * FROM authors</code>，它只是意味着“从 authors 表中选择所有列”这将返回我们所有的字段:<code class="fe kw kx ky kz b">id</code>、<code class="fe kw kx ky kz b">first_name</code>、<code class="fe kw kx ky kz b">last_name</code>、<code class="fe kw kx ky kz b">updated_at</code>和<code class="fe kw kx ky kz b">created_at</code>字段。</p><p id="741c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe kw kx ky kz b">SQL</code>语句被传递给<code class="fe kw kx ky kz b">mysqli</code>对象中的<code class="fe kw kx ky kz b">query</code>方法，它返回包含所有这些字段的表中的所有行。它们存储在<code class="fe kw kx ky kz b">$results</code>变量中。</p><p id="aeb7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">接下来，我们需要遍历每一行并从中提取数据。</p><pre class="nj nk nl nm gt nn kz no np aw nq bi"><span id="7dbd" class="nr lt iq kz b gy ns nt l nu nv">while( $row = $results-&gt;fetch_assoc() ) <br/>{<br/>    var_dump($row);<br/>}</span></pre><p id="dde8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe kw kx ky kz b">$row = $results-&gt;fetch_assoc()</code>从<code class="fe kw kx ky kz b">$results</code>获取数据行，并将其存储在<code class="fe kw kx ky kz b">$row</code>变量中。我们只是去查看数据，看看它给了我们什么。</p><pre class="nj nk nl nm gt nn kz no np aw nq bi"><span id="e0ef" class="nr lt iq kz b gy ns nt l nu nv"><strong class="kz ir">array</strong> <em class="nw">(size=6)</em><br/>  'id' =&gt; string '1' <em class="nw">(length=1)</em><br/>  'first_name' =&gt; string 'Dino' <em class="nw">(length=4)</em><br/>  'last_name' =&gt; string 'Cajic' <em class="nw">(length=5)</em><br/>  'email' =&gt; string 'dino@example.com' <em class="nw">(length=16)</em><br/>  'updated_at' =&gt; string '2022-11-03 21:56:16' <em class="nw">(length=19)</em><br/>  'created_at' =&gt; string '2022-11-03 21:56:16' <em class="nw">(length=19)</em></span></pre><p id="b0db" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它返回给我们一个关联数组。这意味着我们可以使用这些键中的每一个来回显特定的数据。</p><pre class="nj nk nl nm gt nn kz no np aw nq bi"><span id="12df" class="nr lt iq kz b gy ns nt l nu nv">while( $row = $results-&gt;fetch_assoc() ) <br/>{<br/>    echo $row['first_name'];<br/>}</span></pre><p id="48a8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们现在要做的就是添加一个检查来确保我们确实收到了一些数据。</p><pre class="nj nk nl nm gt nn kz no np aw nq bi"><span id="cee1" class="nr lt iq kz b gy ns nt l nu nv">if ( $results-&gt;num_rows &gt; 0 ) <br/>{<br/>    while( $row = $results-&gt;fetch_assoc() ) {<br/>        var_dump($row);<br/>    }<br/>}</span></pre><p id="9a84" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe kw kx ky kz b">$results-&gt;num_rows</code>返回查询从表中提取的行数。我们检查行数是否大于 0。如果是，遍历每个关联数组并对数据做一些事情。</p><figure class="nj nk nl nm gt jr"><div class="bz fp l di"><div class="nx ny l"/></div></figure><h1 id="83af" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">WHERE 子句</h1><p id="43cc" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">我们不必每次都返回完整的列表。我们可以返回一个特定的作者，因为每个作者都有一个特定的用户<code class="fe kw kx ky kz b">id</code>。只要我们知道作者的 id，我们就可以检索它。</p><pre class="nj nk nl nm gt nn kz no np aw nq bi"><span id="8504" class="nr lt iq kz b gy ns nt l nu nv">SELECT * FROM authors WHERE id = '1';</span></pre><p id="d25b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们仍然想要检索作者的所有字段，比如<code class="fe kw kx ky kz b">first_name</code>和<code class="fe kw kx ky kz b">last_name</code>，但是我们只想要一个作者。在这个例子中，作者的<code class="fe kw kx ky kz b">id</code>是 1。</p><p id="9d07" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">还有什么需要改变的吗？不，即使你可以。可以保留<code class="fe kw kx ky kz b">while</code>循环，也可以只调用<code class="fe kw kx ky kz b">while</code>循环外的<code class="fe kw kx ky kz b">$row = $results-&gt;fetch_assoc()</code>。</p><pre class="nj nk nl nm gt nn kz no np aw nq bi"><span id="b874" class="nr lt iq kz b gy ns nt l nu nv">$sql = "SELECT * FROM authors WHERE id = 1";<br/>$results = $mysqli-&gt;query( $sql );<br/><br/>if ( $results-&gt;num_rows &gt; 0 ) <br/>{<br/>    $row = $results-&gt;fetch_assoc();<br/>    var_dump($row);<br/>} </span></pre><h1 id="8fdc" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">对作者类的修改</h1><p id="c7f2" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">我们有一门<code class="fe kw kx ky kz b">Author</code>课。让我们考虑一下我们可能需要的选择方法。基于一个<code class="fe kw kx ky kz b">id</code>返回一个特定的作者，并返回所有作者。</p><h2 id="855c" class="nr lt iq bd lu nz oa dn ly ob oc dp mc kj od oe mg kn of og mk kr oh oi mo oj bi translated">全选</h2><p id="dd2a" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">有几种方法可以做到这一点。我们可以选择所有的项目，将它们存储在一个数组中，然后返回该数组。</p><figure class="nj nk nl nm gt jr"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="847c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当然，有一种更简单的方法可以做到这一点。毕竟，将结果作为数组返回是很常见的做法。我们可以用<code class="fe kw kx ky kz b">fetch_all</code>方法做到这一点。</p><pre class="nj nk nl nm gt nn kz no np aw nq bi"><span id="6d85" class="nr lt iq kz b gy ns nt l nu nv">$results-&gt;fetch_all(<em class="nw">MYSQLI_ASSOC</em>);</span></pre><p id="a726" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">可以传递一个参数，比如<code class="fe kw kx ky kz b">MYSQLI_ASSOC</code>，也可以不传递。不同的是，如果你不这样做，你将得不到任何钥匙。</p><pre class="nj nk nl nm gt nn kz no np aw nq bi"><span id="f572" class="nr lt iq kz b gy ns nt l nu nv"><strong class="kz ir">$results-&gt;fetch_all(<em class="nw">MYSQLI_ASSOC</em>);</strong></span><span id="fd78" class="nr lt iq kz b gy ok nt l nu nv"><strong class="kz ir">array</strong> <em class="nw">(size=7)</em><br/>  0 =&gt; <br/>    <strong class="kz ir">array</strong> <em class="nw">(size=6)</em><br/>      'id' =&gt; string '1' <em class="nw">(length=1)</em><br/>      'first_name' =&gt; string 'Dino' <em class="nw">(length=4)</em><br/>      'last_name' =&gt; string 'Cajic' <em class="nw">(length=5)</em><br/>      'email' =&gt; string 'dino@example.com' <em class="nw">(length=16)</em><br/>      'updated_at' =&gt; string '2022-11-03 21:56:16' <em class="nw">(length=19)</em><br/>      'created_at' =&gt; string '2022-11-03 21:56:16' <em class="nw">(length=19)</em><br/>  1 =&gt;...</span><span id="6ad7" class="nr lt iq kz b gy ok nt l nu nv"><strong class="kz ir"><br/>$results-&gt;fetch_all();</strong></span><span id="1bad" class="nr lt iq kz b gy ok nt l nu nv"><strong class="kz ir">array</strong> <em class="nw">(size=7)</em><br/>  0 =&gt; <br/>    <strong class="kz ir">array</strong> <em class="nw">(size=6)</em><br/>      0 =&gt; string '1' <em class="nw">(length=1)</em><br/>      1 =&gt; string 'Dino' <em class="nw">(length=4)</em><br/>      2 =&gt; string 'Cajic' <em class="nw">(length=5)</em><br/>      3 =&gt; string 'dino@example.com' <em class="nw">(length=16)</em><br/>      4 =&gt; string '2022-11-03 21:56:16' <em class="nw">(length=19)</em><br/>      5 =&gt; string '2022-11-03 21:56:16' <em class="nw">(length=19)</em><br/>  1 =&gt;</span></pre><figure class="nj nk nl nm gt jr"><div class="bz fp l di"><div class="nx ny l"/></div></figure><h2 id="08c7" class="nr lt iq bd lu nz oa dn ly ob oc dp mc kj od oe mg kn of og mk kr oh oi mo oj bi translated">选择作者</h2><p id="f230" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">我们将把<code class="fe kw kx ky kz b">id</code>传递给我们的<code class="fe kw kx ky kz b">select</code>语句并返回结果。我们可以保持它与<code class="fe kw kx ky kz b">select_all</code>完全相同，并返回<code class="fe kw kx ky kz b">$results-&gt;fetch_all</code>关联数组，但这没有意义。我们只需要一行，所以我们将返回一行数据。</p><figure class="nj nk nl nm gt jr"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="737e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果没有数据，将返回<code class="fe kw kx ky kz b">null</code>。</p><h1 id="0e5d" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">完整代码</h1><p id="53fd" class="pw-post-body-paragraph jy jz iq ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">就是这样。让我们看看现在我们的代码是什么样的。</p><figure class="nj nk nl nm gt jr"><div class="bz fp l di"><div class="nx ny l"/></div></figure><figure class="nj nk nl nm gt jr"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="50e9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe kw kx ky kz b">DB</code>没有变化。</p><figure class="nj nk nl nm gt jr"><div class="bz fp l di"><div class="nx ny l"/></div></figure><div class="la lb gp gr lc ld"><a href="https://github.com/dinocajic/php-youtube-tutorials" rel="noopener  ugc nofollow" target="_blank"><div class="le ab fo"><div class="lf ab lg cl cj lh"><h2 class="bd ir gy z fp li fr fs lj fu fw ip bi translated">GitHub-dinocajic/PHP-YouTube-tutorials:PHP YouTube 教程的代码</h2><div class="lk l"><h3 class="bd b gy z fp li fr fs lj fu fw dk translated">PHP YouTube 教程的代码确保你已经安装了 Docker。克隆回购。运行以下命令…</h3></div><div class="ll l"><p class="bd b dl z fp li fr fs lj fu fw dk translated">github.com</p></div></div><div class="lm l"><div class="ol l lo lp lq lm lr jw ld"/></div></div></a></div></div><div class="ab cl om on hu oo" role="separator"><span class="op bw bk oq or os"/><span class="op bw bk oq or os"/><span class="op bw bk oq or"/></div><div class="ij ik il im in"><figure class="nj nk nl nm gt jr gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/a25979c19219b2d8673c967efa53efa1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*whpp373eitOT1ZGC.jpeg"/></div></figure><p id="0b31" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Dino Cajic 目前是<a class="ae ou" href="http://absolutebiotech.com/" rel="noopener ugc nofollow" target="_blank"> Absolute Biotech </a>的 IT 负责人，该公司是<a class="ae ou" href="https://www.lsbio.com/" rel="noopener ugc nofollow" target="_blank"> LSBio(寿命生物科学公司)</a>、<a class="ae ou" href="https://absoluteantibody.com/" rel="noopener ugc nofollow" target="_blank"> Absolute 抗体</a>、<a class="ae ou" href="https://www.kerafast.com/" rel="noopener ugc nofollow" target="_blank"> Kerafast </a>、<a class="ae ou" href="https://everestbiotech.com/" rel="noopener ugc nofollow" target="_blank"> Everest BioTech </a>、<a class="ae ou" href="https://www.nordicmubio.com/" rel="noopener ugc nofollow" target="_blank"> Nordic MUbio </a>和<a class="ae ou" href="https://www.exalpha.com/" rel="noopener ugc nofollow" target="_blank"> Exalpha </a>的母公司。他还担任我的自动系统的首席执行官。他拥有计算机科学学士学位，辅修生物学，并拥有十多年的软件工程经验。他的背景包括创建企业级电子商务应用程序、执行基于研究的软件开发，以及通过写作促进知识的传播。</p><p id="bead" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以在<a class="ae ou" href="https://www.linkedin.com/in/dinocajic/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上联系他，在<a class="ae ou" href="https://instagram.com/think.dino" rel="noopener ugc nofollow" target="_blank"> Instagram </a>上关注他，或者<a class="ae ou" href="https://dinocajic.medium.com/subscribe" rel="noopener">订阅他的媒体出版物</a>。</p><p id="ba35" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">阅读 Dino Cajic(以及 Medium 上成千上万的其他作家)的每一个故事。你的会员费直接支持迪诺·卡吉克和你阅读的其他作家。你也可以在媒体上看到所有的故事。T25】</p></div></div>    
</body>
</html>