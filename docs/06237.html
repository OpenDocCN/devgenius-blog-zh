<html>
<head>
<title>Redis : Holy Trinity</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">神圣的三位一体</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/redis-holy-trinity-2fa86b78a86e?source=collection_archive---------9-----------------------#2021-12-23">https://blog.devgenius.io/redis-holy-trinity-2fa86b78a86e?source=collection_archive---------9-----------------------#2021-12-23</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="7676" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Redis初级读本，介绍如何将其用作缓存、数据库和消息代理。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/30d03ff42c574d358085a4649f0f1d02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yMbEc3Jxyd9Ui2fM"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@ldandersen" rel="noopener ugc nofollow" target="_blank">巴斯·安德森</a>在<a class="ae ky" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="6200" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Redis已经成为数据密集型处理的默认<a class="ae ky" href="https://faun.pub/cache-15f81a6ed111" rel="noopener ugc nofollow" target="_blank">分布式缓存</a>框架。它的核心，本质上是一个非SQL数据库，具体来说是它的键值存储。</p><blockquote class="kz la lb"><p id="a397" class="jk jl lc jm b jn jo jp jq jr js jt ju ld jw jx jy le ka kb kc lf ke kf kg kh ig bi translated">键值存储在内存中，这是其超低延迟背后的秘密。内存中的数据可以持久化(为了弹性)。</p></blockquote><p id="bee7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Redis一些鲜为人知的功能列举如下。这些功能现在越来越受欢迎</p><ul class=""><li id="9a36" class="lg lh in jm b jn jo jr js jv li jz lj kd lk kh ll lm ln lo bi translated">可以像<a class="ae ky" href="https://towardsdev.com/kafka-fundamentals-a268db22b8af" rel="noopener ugc nofollow" target="_blank"> <em class="lc"> Kafka </em> </a>或者MQ一样作为消息代理。</li><li id="a820" class="lg lh in jm b jn lp jr lq jv lr jz ls kd lt kh ll lm ln lo bi translated">对于维护者全局计数器来说，这是微服务架构中一个关键且具有挑战性的特性。</li><li id="87be" class="lg lh in jm b jn lp jr lq jv lr jz ls kd lt kh ll lm ln lo bi translated">全局锁定(确保只有一个线程访问存储的数据)。</li></ul><p id="d06f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Redis定义为与其同名的公司<a class="ae ky" href="https://redis.io/topics/introduction" rel="noopener ugc nofollow" target="_blank"> <em class="lc"> Redis </em> </a> Ltd</p><blockquote class="kz la lb"><p id="6b99" class="jk jl lc jm b jn jo jp jq jr js jt ju ld jw jx jy le ka kb kc lf ke kf kg kh ig bi translated">Redis是一个开源的(BSD许可的)、内存中的数据结构存储，用作数据库、缓存和消息代理。Redis提供数据结构，如字符串、散列、列表、集合、带有范围查询的排序集合、位图、超级日志、地理空间索引和流。Redis具有内置的复制、Lua脚本、LRU驱逐、事务和不同级别的磁盘持久性，并通过Redis Sentinel和Redis Cluster的自动分区提供高可用性。</p></blockquote><p id="a0c8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将讨论Redis的每个特性。</p><h1 id="2c9b" class="lu lv in bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated"><strong class="ak"> REDIS作为缓存</strong></h1><p id="ad3f" class="pw-post-body-paragraph jk jl in jm b jn ms jp jq jr mt jt ju jv mu jx jy jz mv kb kc kd mw kf kg kh ig bi translated">Redis的主要受欢迎程度是由于它的快速缓存特性。Redis是分布式缓存，以键和值的形式存储所有数据。</p><blockquote class="kz la lb"><p id="9bf2" class="jk jl lc jm b jn jo jp jq jr js jt ju ld jw jx jy le ka kb kc lf ke kf kg kh ig bi translated">Redis键总是字符串，而值可以是字符串、列表、集合、散列、排序集合。下面是这些集合可以具有的数据类型的详细信息。<strong class="jm io">请记住，您可以序列化任何对象，并将其作为字符串持久化</strong>。</p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/754626bfd54225f5d6190b1f0b87cd88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SAUHRijJVd4E8e0CThc3Aw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">资料来源:Redis在行动</figcaption></figure><p id="b7fc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">存储在Redis中的键值数据可以有一个预定义的时间，在此之前它应该保留在内存中。经过一段时间后，密钥将从缓存中清除。</p><p id="bfb2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在设置键和值时，我们添加了额外的参数EX (Expire)。在下面的例子中，键值设置为10秒到期。</p><p id="fd4e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">当我们试图在10秒内得到这个值时，它返回这个值。10秒钟后，它返回空值。当然，用户可以使用DEL命令删除密钥。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi my"><img src="../Images/2d1bc8356c3bcaa0da50c1d6767cf5d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*yCh2CskqoBMDj_lDHAQC3A.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">通过REDIS命令行界面(CLI)的REDIS命令</figcaption></figure><p id="5d77" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">用于连接和使用Redis的一些流行的客户端库是</p><ul class=""><li id="47ce" class="lg lh in jm b jn jo jr js jv li jz lj kd lk kh ll lm ln lo bi translated"><strong class="jm io"> <em class="lc">爪哇</em> </strong> : <a class="ae ky" href="https://www.baeldung.com/jedis-java-redis-client-library" rel="noopener ugc nofollow" target="_blank"> <em class="lc">杰迪斯</em></a><a class="ae ky" href="http://redis.paluch.biz/" rel="noopener ugc nofollow" target="_blank">莴苣</a>和<a class="ae ky" href="https://github.com/mrniko/redisson/" rel="noopener ugc nofollow" target="_blank">雷迪森</a>。</li><li id="9da1" class="lg lh in jm b jn lp jr lq jv lr jz ls kd lt kh ll lm ln lo bi translated"><strong class="jm io"><em class="lc">Python</em></strong>:redis-py和walrus。</li></ul><p id="685a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Redis网站<a class="ae ky" href="https://redis.io/clients" rel="noopener ugc nofollow" target="_blank"><em class="lc"/></a>上列出了推荐和支持的客户端库的详细列表。</p><h1 id="2f5a" class="lu lv in bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">REDIS作为数据库</h1><p id="4ea5" class="pw-post-body-paragraph jk jl in jm b jn ms jp jq jr mt jt ju jv mu jx jy jz mv kb kc kd mw kf kg kh ig bi translated">Redis通常是一个补充数据库，与其他持久性存储一起使用。</p><blockquote class="kz la lb"><p id="5a1c" class="jk jl lc jm b jn jo jp jq jr js jt ju ld jw jx jy le ka kb kc lf ke kf kg kh ig bi translated">Redis不提供强大的持久性(ACI <strong class="jm io"> D </strong>保证，它取决于REDIS设置的配置。</p></blockquote><p id="884e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">REDIS中的磁盘持久性有两种方式:</p><ol class=""><li id="9761" class="lg lh in jm b jn jo jr js jv li jz lj kd lk kh mz lm ln lo bi translated"><strong class="jm io"> RDB </strong> (Redis数据库):在这种情况下，会在某个预定义的时间和/或事件之后拍摄Redis内存中数据的快照。加入25种元素后，每15分钟或每5分钟一次。另一方面是，如果服务器停机，那么前一个快照中的增量数据就会丢失。</li><li id="aea5" class="lg lh in jm b jn lp jr lq jv lr jz ls kd lt kh mz lm ln lo bi translated"><strong class="jm io"> AOF </strong>(仅附加文件):REDIS服务器上的所有操作，如添加关键字或更新值等。被添加到日志文件中。该日志文件按时间顺序存储操作(即操作被调用的顺序)。这个相同的日志文件可以提供给一个普通的Redis实例——在使用该文件后，它将与原始实例相同。</li></ol><p id="ef1e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">除了以上两种，我们还可以运行REDIS，选项为</p><ul class=""><li id="11c5" class="lg lh in jm b jn jo jr js jv li jz lj kd lk kh ll lm ln lo bi translated"><strong class="jm io">无持久性</strong>(仅作为缓存使用)</li><li id="8c70" class="lg lh in jm b jn lp jr lq jv lr jz ls kd lt kh ll lm ln lo bi translated"><strong class="jm io"> RDB + AOF </strong></li></ul><p id="d587" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae ky" href="http://kohler.co.in" rel="noopener ugc nofollow" target="_blank">这个</a>是理解REDIS为DB的一个很棒的链接。RDB<a class="ae ky" href="https://redis.io/topics/persistence#snapshotting" rel="noopener ugc nofollow" target="_blank"><em class="lc">和AOF </em> </a>的选择取决于业务需求。</p><blockquote class="kz la lb"><p id="3fdf" class="jk jl lc jm b jn jo jp jq jr js jt ju ld jw jx jy le ka kb kc lf ke kf kg kh ig bi translated">需要指出的一点是，对于相同的数据大小，RDB文件要紧凑得多。这是灾难恢复的有用功能。</p></blockquote><h1 id="02e5" class="lu lv in bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">REDIS作为消息代理</h1><p id="63d4" class="pw-post-body-paragraph jk jl in jm b jn ms jp jq jr mt jt ju jv mu jx jy jz mv kb kc kd mw kf kg kh ig bi translated">随着我们从整体架构转向微服务，多个服务需要相互通信。</p><blockquote class="kz la lb"><p id="7e42" class="jk jl lc jm b jn jo jp jq jr js jt ju ld jw jx jy le ka kb kc lf ke kf kg kh ig bi translated">通常我们想从REST这样的同步通道转移到Kafka或MQ等异步媒介。REDIS的一个鲜为人知的特性是它可以充当健壮的消息代理。</p></blockquote><p id="b4aa" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">REDIS支持以下消息传递范例</p><h2 id="1bcf" class="na lv in bd lw nb nc dn ma nd ne dp me jv nf ng mi jz nh ni mm kd nj nk mq nl bi translated">发布/订阅:</h2><p id="b1d0" class="pw-post-body-paragraph jk jl in jm b jn ms jp jq jr mt jt ju jv mu jx jy jz mv kb kc kd mw kf kg kh ig bi translated">在发布/订阅中，发布者以预定义的格式向通道发送消息。订户读取该频道的消息。订阅者和发布者互不了解。</p><p id="e7f9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae ky" href="https://redis.io/commands/subscribe" rel="noopener ugc nofollow" target="_blank">订阅</a>、<a class="ae ky" href="https://redis.io/commands/unsubscribe" rel="noopener ugc nofollow" target="_blank">退订</a>、<a class="ae ky" href="https://redis.io/commands/publish" rel="noopener ugc nofollow" target="_blank">发布</a>在REDIS中实现。应用程序可以使用PUBLISH将消息放到主题上。</p><p id="12b7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">下面是发布订阅的Java客户端代码示例。类似的客户端也有其他语言版本。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/b6f033ff11c440161b52db8f52ea45c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7SVuML6m9Vsk5WlcXeMahg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">出版者</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/ab285e4fc5d0088c3619db603c9a9e75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wVs5HtpTB5sH-xr7GzJ2SQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">订户</figcaption></figure><p id="c339" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">对于那些寻找Pub Sub内部的人，请点击下面的链接</p><div class="no np gp gr nq nr"><a href="https://making.pusher.com/redis-pubsub-under-the-hood/" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd io gy z fp nw fr fs nx fu fw im bi translated">引擎盖下的Redis Pub/Sub</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">要不要编个聊天app？在这里，你将看到如何做它的艰苦方式。我详细展示了Redis发布/订阅是如何工作的…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">making.pusher.com</p></div></div></div></a></div><h2 id="033f" class="na lv in bd lw nb nc dn ma nd ne dp me jv nf ng mi jz nh ni mm kd nj nk mq nl bi translated">基于流的异步通信</h2><p id="587b" class="pw-post-body-paragraph jk jl in jm b jn ms jp jq jr mt jt ju jv mu jx jy jz mv kb kc kd mw kf kg kh ig bi translated">这种信息范式与卡夫卡非常相似。它本质上使用不可变的仅追加日志，是Redis 5.0以后增加的。</p><p id="de17" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如Redis所述，<a class="ae ky" href="https://redis.com/blog/what-to-choose-for-your-synchronous-and-asynchronous-communication-needs-redis-streams-redis-pub-sub-kafka-etc-best-approaches-synchronous-asynchronous-communication/" rel="noopener ugc nofollow" target="_blank">流</a>是</p><blockquote class="kz la lb"><p id="4ae7" class="jk jl lc jm b jn jo jp jq jr js jt ju ld jw jx jy le ka kb kc lf ke kf kg kh ig bi translated">流是一系列不可变的、只附加的时间导向条目，许多类型的数据自然适合这种格式。例如，传感器读数或日志包含的值本质上是按创建时间索引的，并且是仅附加的(不能改变过去)。它们也有相当规则的结构。</p></blockquote><p id="f7c6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因此，producer将数据发布到stream，并将其添加到这个只附加日志中。消费者可以从日志中读取事件。每个订户都需要记住它处理的最后一个条目。在重启、崩溃或网络问题的情况下，它可以很容易地从上次处理的地方恢复。</p><p id="f9dd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">除了作为数据库、缓存和消息代理，REDIS还有一些非常酷的特性。下面列出了其中的一些。</p><ol class=""><li id="749d" class="lg lh in jm b jn jo jr js jv li jz lj kd lk kh mz lm ln lo bi translated">存储全局计数器:REDIS提供了原子计数器，没有更新丢失的问题。</li><li id="8803" class="lg lh in jm b jn lp jr lq jv lr jz ls kd lt kh mz lm ln lo bi translated">分布式锁定:这种锁定分布在客户机上，即分布在机器上。</li><li id="1997" class="lg lh in jm b jn lp jr lq jv lr jz ls kd lt kh mz lm ln lo bi translated">Hyperloglog:它提供了项目的大概数量。这和bloom filter很像。</li></ol><p id="11cc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">有关REDIS的更多信息，请访问以下链接:</p><div class="no np gp gr nq nr"><a href="https://redis.io/documentation" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd io gy z fp nw fr fs nx fu fw im bi translated">雷迪斯</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">注意:Redis文档也可以在redis-doc github存储库中以raw(计算机友好)格式获得…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">redis.io</p></div></div><div class="oa l"><div class="ob l oc od oe oa of ks nr"/></div></div></a></div><div class="no np gp gr nq nr"><a href="https://www.oreilly.com/library/view/redis-in-action/9781617290855/" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd io gy z fp nw fr fs nx fu fw im bi translated">Redis在行动</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">摘要Redis in Action介绍了Redis，并通过示例向您展示了如何有效地使用它…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">www.oreilly.com</p></div></div><div class="oa l"><div class="og l oc od oe oa of ks nr"/></div></div></a></div><p id="164b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">对于设计博客，请关注medium上的<a class="ae ky" href="https://smverma.medium.com/" rel="noopener"> Anantech.ai </a>。</p></div></div>    
</body>
</html>