<html>
<head>
<title>Kotlin Multiplatform library with Kotest and Gradle Version Catalog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">具有 Kotest 和 Gradle 版本目录的 Kotlin 多平台库</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/kotlin-multiplatform-library-with-kotest-and-gradle-version-catalog-23861a6f1bb1?source=collection_archive---------6-----------------------#2022-01-23">https://blog.devgenius.io/kotlin-multiplatform-library-with-kotest-and-gradle-version-catalog-23861a6f1bb1?source=collection_archive---------6-----------------------#2022-01-23</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="98a9" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">增加默认 Kotlin 多平台项目的趣味🌶</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/f401971e8c5466545b264534e1f1d45c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2ANzcAioIwSfyNep.png"/></div></div></figure><p id="e283" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">最近，我开始了一个兼职项目，在<strong class="kq io">科特林</strong>建造一座图书馆。然后我想，为什么不用<strong class="kq io"> Kotlin 多平台</strong>？</p><p id="588b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">所以我开始研究这个问题，作为一个非常负责任的开发人员，我想把<strong class="kq io"> Kotest </strong>作为我的测试框架。</p><p id="1fa9" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在，你可能会奇怪:<em class="lk">“嘿，卢西恩，为什么要费力地替换默认的测试框架，</em> <strong class="kq io"> <em class="lk"> Kotlin 测试</em> </strong> <em class="lk">，用</em><strong class="kq io"><em class="lk">Kotest</em></strong><em class="lk">？</em>🤔</p><p id="413c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">嗯，这只是个人喜好，我更喜欢由<strong class="kq io"> Kotest </strong>提供的受 Scala 启发的<a class="ae ll" href="https://kotest.io/docs/framework/testing-styles.html#fun-spec" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="lk">FunSpec</em></strong></a>而不是由<strong class="kq io"> Kotlin Test 提供的默认的基于注释的方法🤷‍♂️ </strong></p><p id="dcc4" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">事实证明，配置项目并不像预期的那样简单，我遇到了一些问题，所以让我用这篇文章为您节省一些时间。</p><h2 id="2686" class="lm ln in bd lo lp lq dn lr ls lt dp lu kx lv lw lx lb ly lz ma lf mb mc md me bi translated">我们将在本文中讨论的内容</h2><p id="a11d" class="pw-post-body-paragraph ko kp in kq b kr mf jo kt ku mg jr kw kx mh kz la lb mi ld le lf mj lh li lj ig bi translated">我们将主要讨论三件事:</p><ol class=""><li id="13a3" class="mk ml in kq b kr ks ku kv kx mm lb mn lf mo lj mp mq mr ms bi translated">设置与<strong class="kq io">分级版本目录</strong>的依赖关系，以保持🧼的整洁</li><li id="1bbd" class="mk ml in kq b kr mt ku mu kx mv lb mw lf mx lj mp mq mr ms bi translated">添加<strong class="kq io"> Kotest </strong>作为默认测试框架</li><li id="1aef" class="mk ml in kq b kr mt ku mu kx mv lb mw lf mx lj mp mq mr ms bi translated">编写一个简单的测试来确保一切正常</li></ol><h2 id="8c84" class="lm ln in bd lo lp lq dn lr ls lt dp lu kx lv lw lx lb ly lz ma lf mb mc md me bi translated">开始之前</h2><p id="fc30" class="pw-post-body-paragraph ko kp in kq b kr mf jo kt ku mg jr kw kx mh kz la lb mi ld le lf mj lh li lj ig bi translated">🍎请注意，我使用的是基于英特尔芯片的 macOS。这就是我的原生平台。如果您也在使用 mac，<strong class="kq io">请确保安装了 XCode】</strong></p><h1 id="6b1d" class="my ln in bd lo mz na nb lr nc nd ne lu jt nf ju lx jw ng jx ma jz nh ka md ni bi translated">创建默认项目</h1><p id="eb92" class="pw-post-body-paragraph ko kp in kq b kr mf jo kt ku mg jr kw kx mh kz la lb mi ld le lf mj lh li lj ig bi translated">首先，让我们用<strong class="kq io"> IntelliJ </strong>创建默认项目</p><p id="4495" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">确保选择<code class="fe nj nk nl nm b">Gradle Kotlin</code>，因为我们将使用它作为我们的构建工具。默认情况下，应该选中它。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nn"><img src="../Images/71cd330a2fd4a2249c00f9b538faaf27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MD_VqEf-jYCKtsQHsciTEQ.png"/></div></div></figure><p id="f644" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">接下来，确保<strong class="kq io">取消选择"</strong> <em class="lk">使用 kotlin . test "</em><strong class="kq io"><em class="lk"/></strong>作为我们的目标，以便使用<strong class="kq io"> Kotest！</strong></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi no"><img src="../Images/43372bedb117edefd697600dd8b60560.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jMyoUcztbKsrxSq-OdzSMQ.png"/></div></div></figure><p id="e0b1" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">应该就是这样，最后，你的项目应该是这样的:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi np"><img src="../Images/0c5dba507a8abb69cfff6ba31834b0bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DS0eOHu5q7B8r1Fx9iJ-Nw.png"/></div></div></figure><h1 id="a80b" class="my ln in bd lo mz na nb lr nc nd ne lu jt nf ju lx jw ng jx ma jz nh ka md ni bi translated">使用分级版本目录管理依赖关系</h1><p id="cf09" class="pw-post-body-paragraph ko kp in kq b kr mf jo kt ku mg jr kw kx mh kz la lb mi ld le lf mj lh li lj ig bi translated">您可能会，<em class="lk">“嘿，这是什么，我为什么要关心这个”，</em>可能我需要一篇单独的文章来讨论这个问题，但长话短说，这是一种集中的、改进的管理依赖关系的方法。看到它的好处的最好方法是开始使用它:</p><h2 id="2f82" class="lm ln in bd lo lp lq dn lr ls lt dp lu kx lv lw lx lb ly lz ma lf mb mc md me bi translated">启用 settings.gradle.kts 中的版本目录</h2><p id="2c09" class="pw-post-body-paragraph ko kp in kq b kr mf jo kt ku mg jr kw kx mh kz la lb mi ld le lf mj lh li lj ig bi translated">这可以通过简单地在<code class="fe nj nk nl nm b">settings.gradle.kts</code>中添加以下行来实现</p><pre class="kd ke kf kg gt nq nm nr ns aw nt bi"><span id="4add" class="lm ln in nm b gy nu nv l nw nx">enableFeaturePreview("VERSION_CATALOGS")</span></pre><h2 id="6fed" class="lm ln in bd lo lp lq dn lr ls lt dp lu kx lv lw lx lb ly lz ma lf mb mc md me bi translated">创建我们的版本目录</h2><p id="93a2" class="pw-post-body-paragraph ko kp in kq b kr mf jo kt ku mg jr kw kx mh kz la lb mi ld le lf mj lh li lj ig bi translated">我们将通过在<code class="fe nj nk nl nm b">gradle</code>目录中创建一个<code class="fe nj nk nl nm b">libs.versions.toml</code>来做到这一点:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ny"><img src="../Images/b7a58967d083788ace305f8799e59c4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ifhBTFk_LuRhSq62vIcikg.png"/></div></div></figure><p id="d7a3" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">创建<code class="fe nj nk nl nm b">.toml</code>文件后，IntelliJ 可能会提示您安装一个插件，在 IDE 中添加<strong class="kq io"> TOML </strong>语言支持，如果没有，您可以手动下载以下插件:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nz"><img src="../Images/462a27855b0b083ba61da8e0e25b2885.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T4YTCYy-7shgJmaSKm7_yw.png"/></div></div></figure><h2 id="063c" class="lm ln in bd lo lp lq dn lr ls lt dp lu kx lv lw lx lb ly lz ma lf mb mc md me bi translated">在目录中添加依赖项</h2><p id="1bf9" class="pw-post-body-paragraph ko kp in kq b kr mf jo kt ku mg jr kw kx mh kz la lb mi ld le lf mj lh li lj ig bi translated">现在让我们添加依赖项，我们只需要声明<strong class="kq io"> Kotlin </strong>和<strong class="kq io"> Kotest: </strong>的依赖项</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="cf72" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">⚠️注意，要在 TOML 文件中使用<strong class="kq io">【插件】</strong>，你可能还需要更新<code class="fe nj nk nl nm b">gradle-wrapper.properties</code>中的 Gradle 分布:</p><pre class="kd ke kf kg gt nq nm nr ns aw nt bi"><span id="8025" class="lm ln in nm b gy nu nv l nw nx">distributionUrl=https\://services.gradle.org/distributions/gradle-7.3.2-all.zip</span></pre><p id="c43c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">就这样，我们有了包含所有版本和依赖项的集中目录。接下来，我们将了解如何使用目录。</p><h1 id="d6cf" class="my ln in bd lo mz na nb lr nc nd ne lu jt nf ju lx jw ng jx ma jz nh ka md ni bi translated">使用 build.gradle.kts 中的目录</h1><p id="0f7c" class="pw-post-body-paragraph ko kp in kq b kr mf jo kt ku mg jr kw kx mh kz la lb mi ld le lf mj lh li lj ig bi translated">因此，让我们添加这些依赖项。</p><h2 id="4b13" class="lm ln in bd lo lp lq dn lr ls lt dp lu kx lv lw lx lb ly lz ma lf mb mc md me bi translated">首先是插件</h2><pre class="kd ke kf kg gt nq nm nr ns aw nt bi"><span id="65c3" class="lm ln in nm b gy nu nv l nw nx">@Suppress("DSL_SCOPE_VIOLATION")<br/>plugins <strong class="nm io">{<br/>    </strong>alias(<em class="lk">libs</em>.<em class="lk">plugins</em>.<em class="lk">multiplatform</em>)<br/>    alias(<em class="lk">libs</em>.<em class="lk">plugins</em>.<em class="lk">kotest</em>)<br/><strong class="nm io">}</strong></span></pre><p id="1d38" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">一些注意事项:</p><ol class=""><li id="54bf" class="mk ml in kq b kr ks ku kv kx mm lb mn lf mo lj mp mq mr ms bi translated">为了避免已知的误报，需要使用<code class="fe nj nk nl nm b">@Supress("DSL_SCOPE_VIOLATION")</code></li><li id="1e85" class="mk ml in kq b kr mt ku mu kx mv lb mw lf mx lj mp mq mr ms bi translated"><code class="fe nj nk nl nm b">libs.plugins.*</code>是 Gradle 基于我们的<code class="fe nj nk nl nm b">.toml</code>文件生成的<em class="lk">类型安全访问器</em>的一部分，如果你找不到它们，试着做一个<em class="lk">干净的&amp;构建。</em>如果问题仍然存在，也尝试通过 IntelliJ<em class="lk">使缓存&amp;无效并重启</em></li></ol><h2 id="43b1" class="lm ln in bd lo lp lq dn lr ls lt dp lu kx lv lw lx lb ly lz ma lf mb mc md me bi translated">接下来是特定于项目的依赖项</h2><p id="533a" class="pw-post-body-paragraph ko kp in kq b kr mf jo kt ku mg jr kw kx mh kz la lb mi ld le lf mj lh li lj ig bi translated">我们只需要为<strong class="kq io">common test</strong>&amp;<strong class="kq io">JVM test:</strong>添加依赖项</p><pre class="kd ke kf kg gt nq nm nr ns aw nt bi"><span id="c788" class="lm ln in nm b gy nu nv l nw nx"><em class="lk">sourceSets </em><strong class="nm io">{<br/>    </strong>val commonMain by <em class="lk">getting<br/>    </em>val commonTest by <em class="lk">getting </em><strong class="nm io">{<br/>        </strong>dependencies <strong class="nm io">{<br/>            </strong>implementation(<em class="lk">libs</em>.<em class="lk">kotest</em>.<em class="lk">framework</em>.<em class="lk">engine</em>)<br/>            implementation(<em class="lk">libs</em>.<em class="lk">kotest</em>.<em class="lk">framework</em>.<em class="lk">datatest</em>)<br/>            implementation(<em class="lk">libs</em>.<em class="lk">kotest</em>.<em class="lk">assertions</em>.<em class="lk">core</em>)<br/>        <strong class="nm io">}<br/>    }<br/>    </strong>val jvmMain by <em class="lk">getting<br/>    </em>val jvmTest by <em class="lk">getting </em><strong class="nm io">{<br/>        </strong>dependencies <strong class="nm io">{<br/>            </strong>implementation(<em class="lk">libs</em>.<em class="lk">kotest</em>.<em class="lk">runner</em>.<em class="lk">junit5</em>.<em class="lk">jvm</em>)<br/>        <strong class="nm io">}<br/>    }<br/>    </strong>val jsMain by <em class="lk">getting<br/>    </em>val jsTest by <em class="lk">getting<br/>    </em>val nativeMain by <em class="lk">getting<br/>    </em>val nativeTest by <em class="lk">getting<br/></em><strong class="nm io">}</strong></span></pre><p id="edc9" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">另外，注意在定义<code class="fe nj nk nl nm b">js</code>目标时，Kotest 只支持<strong class="kq io"> IR 编译器</strong>:</p><pre class="kd ke kf kg gt nq nm nr ns aw nt bi"><span id="0080" class="lm ln in nm b gy nu nv l nw nx">js(IR) <strong class="nm io">{ // BOTH and LEGACY are not supported by KOTEST<br/>    </strong>browser <strong class="nm io">{<br/>        </strong>commonWebpackConfig <strong class="nm io">{<br/>            </strong>cssSupport.enabled = true<br/>        <strong class="nm io">}<br/>    }<br/>}</strong></span></pre><p id="28bb" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">最终的<code class="fe nj nk nl nm b">build.gradle.kts</code>应该是这样的:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="1697" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">就是这样！不，让我们试着为一些非常基本的东西写一个样本测试，以确保一切工作正常，✍️</p><h1 id="d110" class="my ln in bd lo mz na nb lr nc nd ne lu jt nf ju lx jw ng jx ma jz nh ka md ni bi translated">编写样本测试</h1><h2 id="a737" class="lm ln in bd lo lp lq dn lr ls lt dp lu kx lv lw lx lb ly lz ma lf mb mc md me bi translated">要测试的代码</h2><p id="4acf" class="pw-post-body-paragraph ko kp in kq b kr mf jo kt ku mg jr kw kx mh kz la lb mi ld le lf mj lh li lj ig bi translated">让我们在<strong class="kq io"> commonMain </strong>中定义一个简单的<code class="fe nj nk nl nm b">expect</code>，它期望一个字符串作为返回类型:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oa ob l"/></div><figcaption class="oc od gj gh gi oe of bd b be z dk translated"><strong class="ak">普通</strong></figcaption></figure><p id="985a" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">然后让我们定义每个平台中的<code class="fe nj nk nl nm b">actual</code>实现:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oa ob l"/></div><figcaption class="oc od gj gh gi oe of bd b be z dk translated"><strong class="ak"> jsMain </strong></figcaption></figure><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oa ob l"/></div><figcaption class="oc od gj gh gi oe of bd b be z dk translated">jvmMain </figcaption></figure><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oa ob l"/></div><figcaption class="oc od gj gh gi oe of bd b be z dk translated"><strong class="ak">原生主</strong></figcaption></figure><p id="9211" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">注意<strong class="kq io"> Kotest </strong>支持<a class="ae ll" href="https://kotest.io/docs/framework/testing-styles.html" rel="noopener ugc nofollow" target="_blank">多种测试方式</a>。</p><p id="494c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我将使用一个☝️</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oa ob l"/></div><figcaption class="oc od gj gh gi oe of bd b be z dk translated"><strong class="ak">通用测试</strong></figcaption></figure><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oa ob l"/></div><figcaption class="oc od gj gh gi oe of bd b be z dk translated"><strong class="ak"> jsTest </strong></figcaption></figure><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oa ob l"/></div><figcaption class="oc od gj gh gi oe of bd b be z dk translated"><strong class="ak"> jvmTest </strong></figcaption></figure><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oa ob l"/></div><figcaption class="oc od gj gh gi oe of bd b be z dk translated"><strong class="ak">天生测试</strong></figcaption></figure><p id="ee49" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们已经完成了测试！</p><h1 id="8638" class="my ln in bd lo mz na nb lr nc nd ne lu jt nf ju lx jw ng jx ma jz nh ka md ni bi translated">运行测试</h1><p id="bce9" class="pw-post-body-paragraph ko kp in kq b kr mf jo kt ku mg jr kw kx mh kz la lb mi ld le lf mj lh li lj ig bi translated">现在运行它们，这里我有一个坏消息。您会注意到，允许您直接从文件运行测试的常见绿色按钮目前不被<strong class="kq io"> Kotest 多平台支持。</strong></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi og"><img src="../Images/a1614a501d3e986f17b5b917f4458523.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*A3b5dAfJCoQaJpCN.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk translated">预期行为</figcaption></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oh"><img src="../Images/6a46703ba8f638d253fbd70ad068b9e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NogYgdpMSVl1_UtaIVG60Q.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk translated">Kotest 的实际行为</figcaption></figure><p id="4417" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">那么，我们如何进行测试呢？</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oi"><img src="../Images/ae25b7208b56856b58efd4fad2f2e87b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-rX2BuTKuwyq11fJ-WF9yw.png"/></div></div></figure><p id="37f5" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">您可以正常运行它们，只需右键单击<code class="fe nj nk nl nm b">src</code>目录。</p><p id="4480" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">但是这将只运行<strong class="kq io">通用</strong>和<strong class="kq io"> JVM </strong>测试，正如你将从下面的测试结果中看到的👇</p><p id="4c64" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><em class="lk">*您可以通过右键单击特定于平台的测试目录</em>来运行特定于平台的测试</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oj"><img src="../Images/f847e812566e3e2629219db968e5ef2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0jEJ5IIYM75nxHFMYksHdA.png"/></div></div></figure><p id="3c33" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">运行所有测试的最佳方式实际上就是在终端中运行这个<strong class="kq io"> Gradle </strong>命令:</p><pre class="kd ke kf kg gt nq nm nr ns aw nt bi"><span id="cb3c" class="lm ln in nm b gy nu nv l nw nx">./gradlew check</span></pre><h2 id="c6ae" class="lm ln in bd lo lp lq dn lr ls lt dp lu kx lv lw lx lb ly lz ma lf mb mc md me bi translated">检查生成的测试报告</h2><p id="cf23" class="pw-post-body-paragraph ko kp in kq b kr mf jo kt ku mg jr kw kx mh kz la lb mi ld le lf mj lh li lj ig bi translated">我们还可以通过一些静态网页获得一个不错的可探索的 GUI，其中包含测试报告，但是首先，让我们添加一个新的失败测试来增加我们报告的趣味🌶</p><p id="f818" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在<strong class="kq io">本地测试中:</strong></p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oa ob l"/></div><figcaption class="oc od gj gh gi oe of bd b be z dk translated">测试失败的 nativeTest</figcaption></figure><p id="31b4" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果您现在运行<code class="fe nj nk nl nm b">./gradlew check</code>，您应该会得到一个错误和一个带有生成报告的链接，链接应该类似于*:</p><pre class="kd ke kf kg gt nq nm nr ns aw nt bi"><span id="26df" class="lm ln in nm b gy nu nv l nw nx">file:///Users/lucianeduardghimpu/Documents/GitHub/kotest-multiplatform-medium-demo/build/reports/tests/allTests/index.html</span></pre><p id="6678" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><em class="lk">*路径的第一部分将根据您的设置进行相应的更改。</em></p><p id="5619" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果我们去浏览生成的页面，我们会发现这个漂亮的交互式报告:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ok"><img src="../Images/0a058373ad57d39c1efb85a7994eed38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ee7f3I1lRdhBy3ch2QoC0A.png"/></div></div></figure><p id="d801" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在你有了它，一切都按预期工作，你现在准备添加一些真正的代码，并把<strong class="kq io"> Kotest </strong>投入测试。</p><p id="13f9" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><em class="lk">如果你面临额外的问题，尝试或者</em> <strong class="kq io"> <em class="lk">使&amp;无效</em> </strong> <em class="lk">或者删除</em><strong class="kq io"><em class="lk">/build</em></strong><em class="lk">目录中的所有内容。这帮助了我 2-3 次。</em></p><h1 id="11f3" class="my ln in bd lo mz na nb lr nc nd ne lu jt nf ju lx jw ng jx ma jz nh ka md ni bi translated">结论</h1><p id="cfeb" class="pw-post-body-paragraph ko kp in kq b kr mf jo kt ku mg jr kw kx mh kz la lb mi ld le lf mj lh li lj ig bi translated">这看起来很酷，但是我们从来没有列出这个设置的好处，你为什么不坚持你得到的默认项目呢？</p><h2 id="71aa" class="lm ln in bd lo lp lq dn lr ls lt dp lu kx lv lw lx lb ly lz ma lf mb mc md me bi translated">⬆️优势</h2><p id="0e9b" class="pw-post-body-paragraph ko kp in kq b kr mf jo kt ku mg jr kw kx mh kz la lb mi ld le lf mj lh li lj ig bi translated">这种设置的主要优点如下:</p><ol class=""><li id="13d7" class="mk ml in kq b kr ks ku kv kx mm lb mn lf mo lj mp mq mr ms bi translated">您的依赖项都通过<strong class="kq io">目录</strong>整齐地组织起来</li><li id="db7d" class="mk ml in kq b kr mt ku mu kx mv lb mw lf mx lj mp mq mr ms bi translated">在主<strong class="kq io"> build.gradle.kts </strong>中有类型安全的自动生成代码来处理依赖关系</li><li id="53e8" class="mk ml in kq b kr mt ku mu kx mv lb mw lf mx lj mp mq mr ms bi translated">你得到了<strong class="kq io"> Kotest </strong>的灵活性，我发现运行测试<em class="lk">更加容易和快速(并且有趣</em>🎉<em class="lk"> ) </em></li><li id="14dc" class="mk ml in kq b kr mt ku mu kx mv lb mw lf mx lj mp mq mr ms bi translated">所有这些都是同时针对<strong class="kq io"> JVM </strong>、<strong class="kq io"> js </strong>和<strong class="kq io">原生</strong>！</li></ol><h2 id="5e11" class="lm ln in bd lo lp lq dn lr ls lt dp lu kx lv lw lx lb ly lz ma lf mb mc md me bi translated">⬇️的劣势</h2><ol class=""><li id="3eba" class="mk ml in kq b kr mf ku mg kx ol lb om lf on lj mp mq mr ms bi translated">与<strong class="kq io"> Kotlin 多平台</strong>相关的一切都还很新，所以请期待一些奇怪的问题或错误<em class="lk">(正如我们在设置过程中看到的)</em></li><li id="b6d5" class="mk ml in kq b kr mt ku mu kx mv lb mw lf mx lj mp mq mr ms bi translated">将 Kotest 与多平台<em class="lk">一起使用时有一些限制(同样，其中一些我们已经在本文中看到过)</em>。有关更多信息，请查看其他资源👇</li></ol><h2 id="f091" class="lm ln in bd lo lp lq dn lr ls lt dp lu kx lv lw lx lb ly lz ma lf mb mc md me bi translated">额外资源</h2><ol class=""><li id="28f5" class="mk ml in kq b kr mf ku mg kx ol lb om lf on lj mp mq mr ms bi translated"><a class="ae ll" href="https://kotlinlang.org/docs/multiplatform.html" rel="noopener ugc nofollow" target="_blank">科特林多平台</a></li><li id="f6bc" class="mk ml in kq b kr mt ku mu kx mv lb mw lf mx lj mp mq mr ms bi translated"><a class="ae ll" href="https://kotest.io/docs/quickstart#test-framework" rel="noopener ugc nofollow" target="_blank"> Kotest 设置&amp;限制</a></li><li id="c140" class="mk ml in kq b kr mt ku mu kx mv lb mw lf mx lj mp mq mr ms bi translated"><a class="ae ll" href="https://docs.gradle.org/current/userguide/platforms.html" rel="noopener ugc nofollow" target="_blank"> Gradle 版本目录</a></li><li id="e55d" class="mk ml in kq b kr mt ku mu kx mv lb mw lf mx lj mp mq mr ms bi translated"><a class="ae ll" href="https://github.com/GhimpuLucianEduard/kotest-multiplatform-medium-demo" rel="noopener ugc nofollow" target="_blank"> GitHub 回购与项目👨‍💻</a></li></ol></div></div>    
</body>
</html>