<html>
<head>
<title>Interviewer: What are the ways to inject beans into Spring container?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面试官:弹簧容器注入豆子的方法有哪些？</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/interviewer-what-are-the-ways-to-inject-beans-into-spring-container-5c0984b2493d?source=collection_archive---------2-----------------------#2022-11-16">https://blog.devgenius.io/interviewer-what-are-the-ways-to-inject-beans-into-spring-container-5c0984b2493d?source=collection_archive---------2-----------------------#2022-11-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/323c71c7802fad6dcc08a88dceba4ed0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JO9AEi-uFrKYJ083RoEGLw.png"/></div></div></figure><p id="671b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi kw translated">你是否一直在使用@Service、@Component、@ Contoller 或@ Bean 来添加你的 Spring beans？</p><p id="0989" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你见过其他人的一些代码在注入 beans 时看起来很花哨，但不知道它是如何达到同样的目的的吗？</p><p id="b0ca" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下面我们来看看一些常见的将春豆注入容器的方法。</p><h1 id="142d" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">1.@Configuration + @Bean</h1><p id="8dec" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">这可能是最常见的一种。</p><p id="d92d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">@ Configuration 声明了一个配置类，我们可以使用@ Bean 将 Bean 添加到容器中。</p><pre class="mi mj mk ml gt mm mn mo bn mp mq bi"><span id="b892" class="mr lg iq mn b be ms mt l mu mv">@Configuration<br/>public class MyConfiguration {<br/>    @Bean<br/>    public Person person() {<br/>        Person person = new Person();<br/>        person.setName("spring");<br/>        return person;<br/>    }<br/>}</span></pre><h1 id="aca5" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">2.@Component + @ComponentScan</h1><p id="c997" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">对于同一个示例，我们可以将 Person 对象声明为一个组件。然后我们将使用@ components can“base packages”来声明组件的路径。</p><pre class="mi mj mk ml gt mm mn mo bn mp mq bi"><span id="5d8f" class="mr lg iq mn b be ms mt l mu mv">@Component<br/>public class Person {<br/>    private String name;<br/> <br/>    public String getName() {<br/> <br/>        return name;<br/>    }<br/>    public void setName(String name) {<br/>        this.name = name;<br/>    }<br/>    @Override<br/>    public String toString() {<br/>        return "Person{" +<br/>                "name='" + name + '\'' +<br/>                '}';<br/>    }<br/>}<br/> <br/>@ComponentScan(basePackages = "com.springboot.initbean.*")<br/>public class Demo1 {<br/>    public static void main(String[] args) {<br/>        AnnotationConfigApplicationContext applicationContext = new AnnotationConfigApplicationContext(Demo1.class);<br/>        Person bean = applicationContext.getBean(Person.class);<br/>        System.out.println(bean);<br/>    }<br/>}</span></pre><p id="17c4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">结果:</p><blockquote class="mw mx my"><p id="485b" class="jy jz mz ka b kb kc kd ke kf kg kh ki na kk kl km nb ko kp kq nc ks kt ku kv ij bi translated">人员{name='null'}</p></blockquote><p id="a696" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们已经成功地将 Person bean 注入到 Spring 容器中。</p><h1 id="5a87" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">3.@导入</h1><p id="fa2a" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">有各种灵活的方式来使用这个注释。</p><h2 id="e83b" class="nd lg iq bd lh ne nf dn ll ng nh dp lp kj ni nj lt kn nk nl lx kr nm nn mb no bi translated">@导入</h2><p id="7884" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">直接进口豆。一旦我们完成了 Person 类的构造，我们就可以将该类导入到 Spring 容器中。</p><pre class="mi mj mk ml gt mm mn mo bn mp mq bi"><span id="4219" class="mr lg iq mn b be ms mt l mu mv">public class Person {<br/>    private String name;<br/> <br/>    public String getName() {<br/> <br/>        return name;<br/>    }<br/> <br/>    public void setName(String name) {<br/>        this.name = name;<br/>    }<br/> <br/>    @Override<br/>    public String toString() {<br/>        return "Person{" +<br/>                "name='" + name + '\'' +<br/>                '}';<br/>    }<br/>}<br/><br/>@Import(Person.class)<br/>public class Demo1 {<br/> <br/>    public static void main(String[] args) {<br/>        AnnotationConfigApplicationContext applicationContext = new AnnotationConfigApplicationContext(Demo1.class);<br/>        Person bean = applicationContext.getBean(Person.class);<br/>        System.out.println(bean);<br/>    }<br/>}</span></pre><h2 id="9cfb" class="nd lg iq bd lh ne nf dn ll ng nh dp lp kj ni nj lt kn nk nl lx kr nm nn mb no bi translated">@导入+导入选择器</h2><p id="179c" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">我们还可以定义一个<em class="mz"> MyImportSelector </em>来实现<em class="mz"> ImportSelector </em>接口，并覆盖<em class="mz"> selectImports </em>方法，在其中我们将指定我们需要的 beans。</p><p id="cb19" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们只需要导入<em class="mz"> MyImportSelector </em>类<em class="mz">。</em></p><pre class="mi mj mk ml gt mm mn mo bn mp mq bi"><span id="ae2f" class="mr lg iq mn b be ms mt l mu mv">@Import(MyImportSelector.class)<br/>public class Demo1 {<br/> <br/>    public static void main(String[] args) {<br/>        AnnotationConfigApplicationContext applicationContext = new AnnotationConfigApplicationContext(Demo1.class);<br/>        Person bean = applicationContext.getBean(Person.class);<br/>        System.out.println(bean);<br/>    }<br/>}<br/> <br/>class MyImportSelector implements ImportSelector {<br/>    @Override<br/>    public String[] selectImports(AnnotationMetadata importingClassMetadata) {<br/>        return new String[]{"com.springboot.pojo.Person"};<br/>    }<br/>}</span></pre><h2 id="aea9" class="nd lg iq bd lh ne nf dn ll ng nh dp lp kj ni nj lt kn nk nl lx kr nm nn mb no bi translated">@ Import+importbean definitionregistrar</h2><p id="3695" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">对于这种方法，我们还需要实现一个接口<em class="mz">importbeanditionregistrar</em>。</p><pre class="mi mj mk ml gt mm mn mo bn mp mq bi"><span id="6a85" class="mr lg iq mn b be ms mt l mu mv">@Import(MyImportBeanDefinitionRegistrar.class)<br/>public class Demo1 {<br/> <br/>    public static void main(String[] args) {<br/>        AnnotationConfigApplicationContext applicationContext = new AnnotationConfigApplicationContext(Demo1.class);<br/>        Person bean = applicationContext.getBean(Person.class);<br/>        System.out.println(bean);<br/>    }<br/>}<br/> <br/>class MyImportBeanDefinitionRegistrar implements ImportBeanDefinitionRegistrar {<br/> <br/>    @Override<br/>    public void registerBeanDefinitions(AnnotationMetadata importingClassMetadata, BeanDefinitionRegistry registry) {<br/>        // construct beanDefinition<br/>        AbstractBeanDefinition beanDefinition = BeanDefinitionBuilder.rootBeanDefinition(Person.class).getBeanDefinition();<br/>        // register the bean into the  container<br/>        registry.registerBeanDefinition("person", beanDefinition);<br/>    }<br/>}</span></pre><p id="10e8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这种方法与前一种方法的区别在于额外声明了“bean definition”——bean 的元数据。</p><h1 id="c0cc" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">4.@FactoryBean</h1><p id="99f8" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated"><em class="mz"> FactoryBean </em>本身就是一个 Bean，顺便说一下，不要与管理 bean 的<em class="mz"> BeanFactory </em>混淆。</p><pre class="mi mj mk ml gt mm mn mo bn mp mq bi"><span id="3b55" class="mr lg iq mn b be ms mt l mu mv">@Configuration<br/>public class Demo1 {<br/>    @Bean<br/>    public PersonFactoryBean personFactoryBean() {<br/>        return new PersonFactoryBean();<br/>    }<br/> <br/>    public static void main(String[] args) {<br/>        AnnotationConfigApplicationContext applicationContext = new AnnotationConfigApplicationContext(Demo1.class);<br/>        Person bean = applicationContext.getBean(Person.class);<br/>        System.out.println(bean);<br/>    }<br/>}<br/> <br/>class PersonFactoryBean implements FactoryBean&lt;Person&gt; {<br/><br/>    @Override<br/>    public Person getObject() throws Exception {<br/>        return new Person();<br/>    }<br/><br/>    @Override<br/>    public Class&lt;?&gt; getObjectType() {<br/>        return Person.class;<br/>    }<br/>}</span></pre><p id="0191" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里我们使用方法 1 — @ Configuration + @ Bean 将<em class="mz"> PersonFactoryBean </em>添加到 Spring 容器中。但是，请注意，我没有在@ Bean 中直接注入 Person bean。相反，<em class="mz"> PersonFactoryBean </em>被注入。然后，Spring 容器从工厂 bean 中获取 Person bean。</p><h1 id="279e" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">5.bean definitionregistrypostprocessor</h1><p id="e52d" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">当 Spring 容器执行<em class="mz">beanDefinitionregistrypostprocesso，</em>中的<em class="mz">postprocessbeanDefinition registry</em>方法<em class="mz"> </em>时，它将单独处理 bean definition，我们可以用它来调整 bean definition。</p><pre class="mi mj mk ml gt mm mn mo bn mp mq bi"><span id="bcc7" class="mr lg iq mn b be ms mt l mu mv">public class Demo1 {<br/>    public static void main(String[] args) {<br/>        AnnotationConfigApplicationContext applicationContext = new AnnotationConfigApplicationContext();<br/>        MyBeanDefinitionRegistryPostProcessor beanDefinitionRegistryPostProcessor = new MyBeanDefinitionRegistryPostProcessor();<br/>        applicationContext.addBeanFactoryPostProcessor(beanDefinitionRegistryPostProcessor);<br/>        applicationContext.refresh();<br/>        Person bean = applicationContext.getBean(Person.class);<br/>        System.out.println(bean);<br/>    }<br/>}<br/> <br/>class MyBeanDefinitionRegistryPostProcessor implements BeanDefinitionRegistryPostProcessor {<br/> <br/>    @Override<br/>    public void postProcessBeanDefinitionRegistry(BeanDefinitionRegistry registry) throws BeansException {<br/>        AbstractBeanDefinition beanDefinition = BeanDefinitionBuilder.rootBeanDefinition(Person.class).getBeanDefinition();<br/>        registry.registerBeanDefinition("person", beanDefinition);<br/>    }<br/>    @Override<br/>    public void postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory) throws BeansException {<br/> <br/>    }<br/>}</span></pre></div><div class="ab cl np nq hu nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ij ik il im in"><p id="1b64" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我希望这篇文章对你有所帮助。</p><p id="a7ab" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我是后端软件工程师。如果你渴望了解技术，请关注我的频道，了解我在日常工作和生活中获得的灵感。</p><blockquote class="mw mx my"><p id="3193" class="jy jz mz ka b kb kc kd ke kf kg kh ki na kk kl km nb ko kp kq nc ks kt ku kv ij bi translated"><strong class="ka ir">获取连接:</strong> <br/> <a class="ae nw" href="https://www.linkedin.com/in/daini-wang-5127b2182" rel="noopener ugc nofollow" target="_blank">我的 LinkedIn </a></p><p id="3259" class="jy jz mz ka b kb kc kd ke kf kg kh ki na kk kl km nb ko kp kq nc ks kt ku kv ij bi translated"><strong class="ka ir">阅读更多:</strong></p></blockquote><div class="nx ny gp gr nz oa"><a href="https://medium.com/@wdn0612/10-best-software-engineering-practices-for-java-f438906c0211" rel="noopener follow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd ir gy z fp of fr fs og fu fw ip bi translated">Java 的 10 个最佳软件工程实践</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">1.编写有意义的 Java-doc/注释</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">medium.com</p></div></div><div class="oj l"><div class="ok l ol om on oj oo jw oa"/></div></div></a></div><div class="nx ny gp gr nz oa"><a rel="noopener  ugc nofollow" target="_blank" href="/my-favorite-5-intellij-plugins-that-can-boost-your-productivity-b30ac73389ce"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd ir gy z fp of fr fs og fu fw ip bi translated">我最喜欢的 5 个 IntelliJ 插件可以提高你的工作效率</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">IntelliJ 已经成为 2022 年 Java 开发中使用最多的 IDE。</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">blog.devgenius.io</p></div></div><div class="oj l"><div class="op l ol om on oj oo jw oa"/></div></div></a></div><div class="nx ny gp gr nz oa"><a rel="noopener  ugc nofollow" target="_blank" href="/10-java-shortcuts-in-intellij-idea-5ee3a8caa02d"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd ir gy z fp of fr fs og fu fw ip bi translated">IntelliJ IDEA 中的 10 个 Java 快捷方式</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">我上一篇关于我最喜欢的 5 个 IntelliJ 插件的文章得到了很好的反馈。</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">blog.devgenius.io</p></div></div><div class="oj l"><div class="oq l ol om on oj oo jw oa"/></div></div></a></div></div></div>    
</body>
</html>