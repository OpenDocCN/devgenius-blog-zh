<html>
<head>
<title>How To Implement UIContextMenuInteraction in Swift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Swift中实现UIContextMenuInteraction</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-implement-uicontextmenuinteraction-in-swift-b4508a0f2917?source=collection_archive---------0-----------------------#2019-11-14">https://blog.devgenius.io/how-to-implement-uicontextmenuinteraction-in-swift-b4508a0f2917?source=collection_archive---------0-----------------------#2019-11-14</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="66fe" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">了解如何在应用中使用UIContextMenuInteraction以及如何添加操作</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/4a3ca51455c95ffe32296b8745adf84e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PvlUz2MUUX9itQdG"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk translated">照片由<a class="ae kw" href="https://unsplash.com/@jantined?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Jantine Doornbos </a>在<a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="0109" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在iOS 13中，3D Touch Peek和Pop已经被替换为<code class="fe lt lu lv lw b"><a class="ae kw" href="https://developer.apple.com/documentation/uikit/uicontextmenuinteraction" rel="noopener ugc nofollow" target="_blank">UIContextMenuInteraction</a></code>。这项功能现在可以在所有设备(iPhone和iPad)上运行，并允许开发人员通过长时间点击操作和快捷方式来定制他们的应用程序。</p><p id="0e2e" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">今天，我将向您展示如何实现一个简单的菜单。</p></div><div class="ab cl lx ly hv lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ik il im in io"><h1 id="201c" class="me mf ir bd mg mh mi mj mk ml mm mn mo jx mp jy mq ka mr kb ms kd mt ke mu mv bi translated">入门指南</h1><p id="5712" class="pw-post-body-paragraph kx ky ir kz b la mw js lc ld mx jv lf lg my li lj lk mz lm ln lo na lq lr ls ik bi translated">首先，打开<a class="ae kw" href="https://developer.apple.com/xcode/" rel="noopener ugc nofollow" target="_blank"> Xcode，</a>创建一个新项目。选择<em class="nb">单视图应用</em>。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nc"><img src="../Images/035338624502a21ef0c411531ff1313b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9GVZBZC33JeVtc0lpK4J5g.png"/></div></div></figure><p id="0872" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">现在，创建一个带有故事板的<em class="nb">集合视图</em>，或者通过编程来完成(在本教程中，我们将使用第一个选项)。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nd"><img src="../Images/a149ded296f608115ee8be87a1864a4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hn_OzC1Uv9-DbxhkuJsNpQ.png"/></div></div></figure><p id="5556" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">现在，我们需要一个数据源文件来填充我们的<code class="fe lt lu lv lw b">collectionView</code>！首先，创建一个名为<code class="fe lt lu lv lw b">Data.swift</code>的新文件，并在上面放入以下代码:</p><pre class="kh ki kj kk gu ne lw nf ng aw nh bi"><span id="4b35" class="ni mf ir lw b gz nj nk l nl nm">import UIKit<br/><br/>enum Data {<br/><br/>    static let colors: [UIColor] = {<br/>           return [<br/>            .systemGray, .systemRed, .systemBlue,<br/>            .systemPink, .systemGreen, .systemIndigo,<br/>            .systemTeal, .systemYellow, .systemPurple,<br/>            .systemGray, .systemRed, .systemBlue,<br/>            .systemPink, .systemGreen, .systemIndigo,<br/>            .systemTeal, .systemYellow, .systemPurple<br/>            ].shuffled()<br/>       }()<br/>    <br/>}</span></pre><p id="4f60" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">创建一个名为<code class="fe lt lu lv lw b">CollectionViewController.swift</code>的新文件，并粘贴以下代码:</p><pre class="kh ki kj kk gu ne lw nf ng aw nh bi"><span id="ba69" class="ni mf ir lw b gz nj nk l nl nm">class CollectionViewController: UICollectionViewController {<br/><br/>    override func viewDidLoad() {<br/>        super.viewDidLoad()<br/>    <br/>        collectionView.register(UICollectionViewCell.self, forCellWithReuseIdentifier: "cell")<br/>        collectionView.collectionViewLayout = CollectionViewController.makeCollectionViewLayout()<br/>    }<br/>    <br/>    private static func makeCollectionViewLayout() -&gt; UICollectionViewLayout {<br/>           let itemSize = NSCollectionLayoutSize(widthDimension: .fractionalWidth(1.0 / 3),<br/>                                                 heightDimension: .fractionalHeight(1))<br/>           let item = NSCollectionLayoutItem(layoutSize: itemSize)<br/><br/>           let groupSize = NSCollectionLayoutSize(widthDimension: .fractionalWidth(1),<br/>                                                  heightDimension: .fractionalWidth(1.0 / 3))<br/>           let group = NSCollectionLayoutGroup.horizontal(layoutSize: groupSize,<br/>                                                          subitem: item,<br/>                                                          count: 3)<br/>           group.interItemSpacing = .fixed(10)<br/><br/>           let section = NSCollectionLayoutSection(group: group)<br/>           section.interGroupSpacing = 10<br/><br/>           return UICollectionViewCompositionalLayout(section: section)<br/>       }<br/><br/><br/>    override func collectionView(_ collectionView: UICollectionView, numberOfItemsInSection section: Int) -&gt; Int {<br/>        return Data.colors.count<br/>    }<br/><br/>    override func collectionView(_ collectionView: UICollectionView, cellForItemAt indexPath: IndexPath) -&gt; UICollectionViewCell {<br/>        let cell = collectionView.dequeueReusableCell(withReuseIdentifier: "cell", for: indexPath)<br/>        cell.contentView.backgroundColor = Data.colors[indexPath.row]<br/>        cell.backgroundColor = Data.colors[indexPath.row]<br/>        return cell<br/>    }<br/><br/>}</span></pre><p id="dec9" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">这里，我们在<code class="fe lt lu lv lw b">collectionView</code>中注册<code class="fe lt lu lv lw b">collectionViewCell</code>，用<code class="fe lt lu lv lw b">makeCollectionViewLayout</code>方法设置单元格布局，并用随机颜色填充数据源。</p><p id="7cdf" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">进入故事板，选择<code class="fe lt lu lv lw b">collectionView</code>，显示<em class="nb">身份检查器</em>，设置<code class="fe lt lu lv lw b">CollectionViewController</code>为类属性。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nn"><img src="../Images/ea0088b55f7bd5a477ee3212c9ce015c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9gzz89MbwYJF1kW-z8MWUA.png"/></div></div></figure><p id="f37f" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">运行该应用程序，您会看到类似以下内容:</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div class="gi gj no"><img src="../Images/d53606d2ce7f765d5094783047ee580d.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*-RDrhGhFxKmLcMmTPiooAg.png"/></div></figure></div><div class="ab cl lx ly hv lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ik il im in io"><h1 id="aa19" class="me mf ir bd mg mh mi mj mk ml mm mn mo jx mp jy mq ka mr kb ms kd mt ke mu mv bi translated">履行</h1><p id="bade" class="pw-post-body-paragraph kx ky ir kz b la mw js lc ld mx jv lf lg my li lj lk mz lm ln lo na lq lr ls ik bi translated">好了，现在我们的<code class="fe lt lu lv lw b">collectionView</code>准备好了，但是现在我们需要实现什么<code class="fe lt lu lv lw b">UIContextMenuInteraction</code>？我们只需要几行代码！</p><p id="2180" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">进入<code class="fe lt lu lv lw b">CollectionViewController.swift</code>文件并添加以下方法:</p><pre class="kh ki kj kk gu ne lw nf ng aw nh bi"><span id="fef0" class="ni mf ir lw b gz nj nk l nl nm">override func collectionView(_ collectionView: UICollectionView, contextMenuConfigurationForItemAt indexPath: IndexPath, point: CGPoint) -&gt; UIContextMenuConfiguration? {<br/>        return UIContextMenuConfiguration(identifier: nil, previewProvider: nil) { suggestedActions in<br/>            // Create an action for sharing<br/>            let share = UIAction(title: "Share", image: UIImage(systemName: "square.and.arrow.up")) { action in<br/>                // Show share sheet<br/>            }<br/><br/>            // Create an action for copy<br/>            let rename = UIAction(title: "Copy", image: UIImage(systemName: "doc.on.doc")) { action in<br/>                // Perform copy<br/>            }<br/><br/>            // Create an action for delete with destructive attributes (highligh in red)<br/>            let delete = UIAction(title: "Delete", image: UIImage(systemName: "trash"), attributes: .destructive) { action in<br/>                // Perform delete<br/>            }<br/><br/>            // Create a UIMenu with all the actions as children<br/>            return UIMenu(title: "", children: [share, rename, delete])<br/>        }<br/>    }</span></pre><p id="a8b9" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">这将添加三个带有图标的操作:带有破坏性属性的共享、复制和删除，一个将操作的字体设置为红色的参数。</p><p id="3521" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">现在运行代码并尝试长时间点击一个项目。这将是结果:</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div class="gi gj no"><img src="../Images/507af6f43a87b4f689db8d41be2b764e.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*PcNTYy155f7ISAtisT2IQQ.png"/></div></figure></div><div class="ab cl lx ly hv lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ik il im in io"><figure class="kh ki kj kk gu kl gi gj paragraph-image"><a href="https://www.buymeacoffee.com/nicolidomenico"><div class="gi gj np"><img src="../Images/2a5f4681ef2bdba5652dc9b023b668a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D-JJemrcn63kKj3lPBwZ5w.png"/></div></a></figure><h1 id="aa76" class="me mf ir bd mg mh nq mj mk ml nr mn mo jx ns jy mq ka nt kb ms kd nu ke mu mv bi translated">完整代码</h1><p id="f45a" class="pw-post-body-paragraph kx ky ir kz b la mw js lc ld mx jv lf lg my li lj lk mz lm ln lo na lq lr ls ik bi translated">你可以在<a class="ae kw" href="https://github.com/domeniconicoli/UIContextMenuInteractionExample" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到完整的代码。</p><p id="fd2d" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">感谢您的阅读。如果你有任何问题或建议，请在评论中告诉我。</p></div></div>    
</body>
</html>