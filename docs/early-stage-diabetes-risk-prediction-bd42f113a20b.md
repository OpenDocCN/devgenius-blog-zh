# 早期糖尿病风险预测

> 原文：<https://blog.devgenius.io/early-stage-diabetes-risk-prediction-bd42f113a20b?source=collection_archive---------1----------------------->

使用机器学习

![](img/086b711214601abf546517b84292396b.png)

在本帖中，我们将预测并执行早期糖尿病风险预测数据集的评估指标。数据集可以在 [UCI 机器学习库](https://archive.ics.uci.edu/ml/datasets/Early+stage+diabetes+risk+prediction+dataset.#)上找到。糖尿病是一种慢性代谢性疾病，其特征是血糖(或血糖)水平升高，随着时间的推移，会对心脏、血管、眼睛、肾脏和神经造成严重损害。

全世界约有 4.22 亿人患有糖尿病，其中大多数生活在中低收入国家，每年有 160 万人直接死于糖尿病。在过去的几十年里，糖尿病的病例数和患病率一直在稳步上升。

数据集有 17 列和 520 行，我们将使用以下分类模型及其指标得分:

*   逻辑回归
*   决策图表
*   随机森林分类器
*   XGBoost 分类器

我们开始吧！！！

# 处理数据

![](img/07f103b7dff796ddbe67c1452d1904cd.png)![](img/2d02f2eb0cbee4f021b64847f009c9e4.png)

我需要将数据分割两次，这是训练/验证/测试随机分割的简单方法

![](img/478029b4a7823aee3248368f2a706448.png)

# 从基线开始

![](img/f8153f2a5b14490cad4028268ac1ac8b.png)

“类”是我们要预测的特征，它有正负两个值。

![](img/9bbc5e7e0e4dcc483f25be596119a3c8.png)![](img/551f4dea97ff302343b36014e39203dd.png)

这是基线准确性分数，让我们使用分类模型来提高分数。

![](img/b822326f4b70eb5502e9ffddb2183955.png)

# 逻辑回归模型

逻辑回归是最常见的分类算法之一。

![](img/f43e4b15e0fef62a9272efa8da660055.png)

让我们继续尝试用更多的模型来提高分数

验证准确度:0.91%

测试 ROC AUC : 0.98%

# 逻辑回归模型的混淆矩阵图

![](img/a1061081f4691597f7183369140d2e53.png)

这就是混乱矩阵的样子

![](img/2de8043361ec7b708ec2730a335dd61f.png)

现在，让我们理解 TP、TN、FP、FN 在这个矩阵中表示什么:

*   **真阳性(TP):** 这些是我们预测是的病例(他们有疾病)，他们确实有疾病。
*   **真阴性(TN):** 我们预测没有，他们没有这种病。
*   假阳性(FP): 我们预测是的，但他们实际上并没有患病。(也称为“第一类错误”)
*   **假阴性(FN):** 我们预测没有，但他们确实有疾病。(也称为“第二类错误”)

# 使用逻辑回归模型的分类报告

![](img/a47a6898c7c6f6a02deb3845ea9e4219.png)

让我们看看分类报告是如何工作的

**精度:**定义为真阳性数(TP)除以真阳性数加上假阳性数(FP)。

![](img/0e135412f243e6ab032b2ed5b47195ed.png)

**召回:**定义为真阳性数(TP)除以真阳性数加上假阴性数(FN)。

![](img/e73640bfa2740e8ed2c984297b8b1240.png)

**F1-score:** 是精度和召回率的调和平均值。

![](img/ed40da1cd95d1f5c63d6d42fd2fe04cd.png)

# 排列重要性

![](img/f9a7c6ab5c2d5243e01c4ac03ea57888.png)![](img/89b235c778dba4c3b9847f99fa190661.png)

****排列** **特征** **重要性:**定义为单个特征值被随机打乱 1 时模型得分的减少。该过程打破了特征和目标之间的关系，因此模型分数的下降指示了模型对特征的依赖程度。**

# **决策树模型**

**![](img/51b311fc4239183b929be2d500e4afac.png)**

****分类** **准确率** **评分:**是我们的起点。它是做出正确预测的次数除以做出预测的总次数，再乘以 100 得到一个百分比。**

**在这个模型中，验证准确度分数增加了 0.06%**

**但是测试 ROC AUC 分数降低:0.012**

# **基于决策树模型的混淆矩阵图**

**![](img/858674805091036ba4639fd7cd1ccad2.png)**

# **决策树模型分类报告**

**![](img/2e88e9d52830c7fae2fc1ae50f1832f3.png)**

# **可视化决策树模型**

**![](img/8267d2240795ed93939c18879f980239.png)****![](img/aed4c9d011acd201b4444d28d152c9fd.png)**

# **用决策树模型可视化特征重要性**

**![](img/91806eb291d689a540fd69f40a57c95b.png)****![](img/8663c1ecbdbfb8dc93f6496233798328.png)**

# **随机森林模型**

**![](img/a1d1c5914204b5fafe2c7170a00a9796.png)**

****AUC** 为 **ROC 曲线**下的面积。这个**分数**给了我们一个模型表现如何的好主意。**

**AUC ROC 是任何分类模型性能的最重要的评价指标之一。**

**在这种情况下，准确率下降了 0.0087%**

**但 ROC AUC 得分更高:0.027%**

# **随机森林分类器的混淆矩阵图**

**![](img/2e1f01f6ecefa43499a28daf6906321a.png)**

# **随机森林分类器分类报告**

**![](img/34e37232ef789c78e12c6e859a9da761.png)**

# **部分相关图，1 使用随机森林分类器的特征隔离**

**![](img/f4792c21e7521aa67048da1fcb2d7175.png)****![](img/f561bccae8df7dc05fc93ace55697333.png)****![](img/875aece5e7ad11d68f5206b11cb1325d.png)**

****部分依赖图:**(简称 **PDP** **图**)显示了一个或两个特征对机器学习模型的预测结果的边际效应。部分相关性图可以显示目标和特征之间的关系是线性的、单调的还是更复杂的。**

# **部分相关图，使用随机森林分类器的两个特征交互**

**![](img/03c757e0d5b482a269e462dcd03d41dd.png)**

**看起来一种性别患糖尿病的几率比另一种高得多**

**![](img/df6ef7b8526612d8a61ba42aa08684e5.png)**

# **XGBoost 分类器模型**

# **Shapley 图解释使用其索引号或使用 XgBoost 的行号预测倍数**

**![](img/f0d83e4b8d734260e63872381e9a359a.png)****![](img/68f22e4bf9830501c939af880c585a83.png)****![](img/327884ba9fddefc979f7d2753d5092d4.png)**

**该图的记录是 103 名患者，看起来预测值为 0.43%，患糖尿病的概率为 0.57%。**

**![](img/1babb80a8854f4b660762df0308903aa.png)**

**还有更多的东西需要分析，但我会就此打住。这个帖子的代码可以在 [Github](https://github.com/YinmiAlas/early-stage-diabetes-prediction) 上找到。感谢您的阅读！**