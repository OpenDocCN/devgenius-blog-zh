<html>
<head>
<title>Make Your PowerShell 7 Truly Powerful</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让您的PowerShell 7真正强大</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/make-your-powershell-7-truly-powerful-eb56b3fbe37f?source=collection_archive---------0-----------------------#2020-03-07">https://blog.devgenius.io/make-your-powershell-7-truly-powerful-eb56b3fbe37f?source=collection_archive---------0-----------------------#2020-03-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="a1d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意:本文讨论的是“哦，我的天哪”的一个过时版本。最新版本请参考https://ohmyposh.dev/docs/upgrading<a class="ae kl" href="https://ohmyposh.dev/docs/upgrading" rel="noopener ugc nofollow" target="_blank"/>。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/255eee0010eb3c8f681931b4982e9923.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QyuJnb1ct2-FZVgbHDuRiw.jpeg"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated"><a class="ae kl" href="https://twitter.com/PowerShellHero/status/1166871786782371841" rel="noopener ugc nofollow" target="_blank">https://Twitter . com/powershell hero/status/1166871786782371841</a></figcaption></figure><p id="5484" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi lc translated">终于，在PowerShell Core 6发布三年后，PowerShell的新版本发布了。很多PowerShell粉丝一直在等最新版本，包括我。新的PowerShell 7最大限度地缩小了Windows PowerShell 5和跨平台版本PowerShell Core 6之间的差距。此外，最新版本增加了更强大的功能。</p><p id="5a77" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我想分享一些希望将PowerShell环境配置得更强大但更友好的技巧。</p><h1 id="cb26" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">哦，我的豪华</h1><p id="a630" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">受oh-my-zsh的启发，oh-my-posh为您的PowerShell会话带来了强大的控制台指示器和功能。</p><p id="92e6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在PowerShell Core 6中，PSReadLine不是内置模块。所以在你安装oh-my-posh之前，你应该先安装PSReadLine模块。这个额外的步骤有点麻烦。但是在PowerShell 7中，PSReadLine包含了默认分发，所以你可以直接设置oh-my-posh。</p><p id="7fb5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以运行这些命令来为PowerShell配置oh-my-posh。</p><pre class="kn ko kp kq gt mo mp mq mr aw ms bi"><span id="03db" class="mt lm iq mp b gy mu mv l mw mx">Install-Module posh-git -Scope CurrentUser<br/>Install-Module oh-my-posh -Scope CurrentUser</span></pre><p id="4a5e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，启用您的提示并更改主题。</p><pre class="kn ko kp kq gt mo mp mq mr aw ms bi"><span id="ae04" class="mt lm iq mp b gy mu mv l mw mx">Set-Prompt<br/>Set-Theme Paradox</span></pre><blockquote class="my mz na"><p id="ab52" class="jn jo nb jp b jq jr js jt ju jv jw jx nc jz ka kb nd kd ke kf ne kh ki kj kk ij bi translated">注意:您的默认终端字体第一次可能无法正确显示电力线字符。请查找<a class="ae kl" href="https://github.com/ryanoasis/nerd-fonts" rel="noopener ugc nofollow" target="_blank">https://github.com/ryanoasis/nerd-fonts</a>库并选择你最喜欢的电力线补丁字体。另外，如果你在寻找CJK平衡字体，请考虑使用Naver的D2Coding字体(<a class="ae kl" href="https://github.com/naver/d2codingfont" rel="noopener ugc nofollow" target="_blank">https://github.com/naver/d2codingfont</a>)。</p></blockquote><p id="ac66" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，使用<code class="fe nf ng nh mp b">vim $PROFILE</code>命令打开PowerShell配置文件脚本，并粘贴以下代码。</p><pre class="kn ko kp kq gt mo mp mq mr aw ms bi"><span id="88d4" class="mt lm iq mp b gy mu mv l mw mx">Import-Module posh-git</span><span id="f0dc" class="mt lm iq mp b gy ni mv l mw mx">Import-Module oh-my-posh<br/>Set-Theme Paradox</span></pre><p id="18ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些代码使您的默认PowerShell看起来和感觉上有了更大的改进。你可以改变你想要的主题。</p><h1 id="de30" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">PSFzf模块</h1><p id="84bd" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">如你所知，fzf为你提供了强大的搜索功能。尤其是当fzf与历史搜索和使用<code class="fe nf ng nh mp b">Ctrl + R</code>组合键的键绑定相结合时，它大放异彩。</p><p id="61fc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">PSFzf正好解决了这个问题。另外，fzf已经用Golang写了。所以你可以在macOS，Linux，甚至Windows中使用fzf。</p><p id="f24d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要使用PSFzf模块，您应该首先在机器上安装Fzf。</p><ul class=""><li id="ebc4" class="nj nk iq jp b jq jr ju jv jy nl kc nm kg nn kk no np nq nr bi translated">在Windows上，您可以选择Chocolatey软件包管理器或Scoop软件包管理器。</li><li id="4891" class="nj nk iq jp b jq ns ju nt jy nu kc nv kg nw kk no np nq nr bi translated">在Linux上，大多数包管理器都提供了fzf包。(除了Ubuntu不提供该包。您也可以使用Git安装方法。)</li><li id="b5e2" class="nj nk iq jp b jq ns ju nt jy nu kc nv kg nw kk no np nq nr bi translated">在macOS上，家酿是你最好的朋友。</li></ul><p id="cd89" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">安装fzf二进制文件后，只需将PSFzf模块安装到PowerShell中。</p><pre class="kn ko kp kq gt mo mp mq mr aw ms bi"><span id="d984" class="mt lm iq mp b gy mu mv l mw mx">Install-Module PSFzf -Scope CurrentUser</span></pre><p id="effc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，让PSFzf在启动时覆盖默认的键绑定。粘贴下面的代码。</p><pre class="kn ko kp kq gt mo mp mq mr aw ms bi"><span id="82e1" class="mt lm iq mp b gy mu mv l mw mx">Remove-PSReadlineKeyHandler 'Ctrl+r'<br/>Remove-PSReadlineKeyHandler 'Ctrl+t'<br/>Import-Module PSFzf</span></pre><h1 id="f61c" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">k、kubectx和kubens的PowerShell版本</h1><p id="9f0d" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">如果你每天都坚持使用Kubernetes，你可能会知道或考虑kubectl的速记表达。</p><p id="989e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我每天都在用化名<code class="fe nf ng nh mp b">K</code>、<code class="fe nf ng nh mp b">kubectx</code>和<code class="fe nf ng nh mp b">kubens</code>。但是这些脚本不是为PowerShell设计的。所以我试着为每一个速记惯例制作自己的版本。当然，您可以将下面的代码片段用于您的其他环境，包括Windows。</p><h2 id="1022" class="mt lm iq bd ln nx ny dn lr nz oa dp lv jy ob oc lz kc od oe md kg of og mh oh bi translated">“K”的别名</h2><pre class="kn ko kp kq gt mo mp mq mr aw ms bi"><span id="1a46" class="mt lm iq mp b gy mu mv l mw mx">Set-Alias k kubectl</span></pre><h2 id="d831" class="mt lm iq bd ln nx ny dn lr nz oa dp lv jy ob oc lz kc od oe md kg of og mh oh bi translated">“选择-库贝克文本”(又名库贝克文本)</h2><pre class="kn ko kp kq gt mo mp mq mr aw ms bi"><span id="ecb6" class="mt lm iq mp b gy mu mv l mw mx">function global:Select-KubeContext {<br/>  [CmdletBinding()]<br/>  [Alias('kubectx')]<br/>  param (<br/>    [parameter(Mandatory=$False,Position=0,ValueFromRemainingArguments=$True)]<br/>    [Object[]] $Arguments<br/>  )<br/>  begin {<br/>    if ($Arguments.Length -gt 0) {<br/>      $ctx = &amp; kubectl config get-contexts -o=name | fzf -q <a class="ae kl" href="http://twitter.com/Arguments" rel="noopener ugc nofollow" target="_blank">@Arguments</a><br/>    } else {<br/>      $ctx = &amp; kubectl config get-contexts -o=name | fzf<br/>    }<br/>  }<br/>  process {<br/>    if ($ctx -ne '') {<br/>      &amp; kubectl config use-context $ctx<br/>    }<br/>  }<br/>}</span></pre><h2 id="d370" class="mt lm iq bd ln nx ny dn lr nz oa dp lv jy ob oc lz kc od oe md kg of og mh oh bi translated">“精选库贝纳斯空间”(又名库本斯)</h2><pre class="kn ko kp kq gt mo mp mq mr aw ms bi"><span id="253b" class="mt lm iq mp b gy mu mv l mw mx">function global:Select-KubeNamespace {<br/>  [CmdletBinding()]<br/>  [Alias('kubens')]<br/>  param (<br/>    [parameter(Mandatory=$False,Position=0,ValueFromRemainingArguments=$True)]<br/>    [Object[]] $Arguments<br/>  )<br/>  begin {<br/>    if ($Arguments.Length -gt 0) {<br/>      $ns = &amp; kubectl get namespace -o=name | fzf -q <a class="ae kl" href="http://twitter.com/Arguments" rel="noopener ugc nofollow" target="_blank">@Arguments</a><br/>    } else {<br/>      $ns = &amp; kubectl get namespace -o=name | fzf<br/>    }<br/>  }<br/>  process {<br/>    if ($ns -ne '') {<br/>      $ns = $ns -replace '^namespace/'<br/>      &amp; kubectl config set-context --current --namespace=$ns<br/>    }<br/>  }<br/>}</span></pre><p id="7a3e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将这些代码粘贴到您的<code class="fe nf ng nh mp b">$PROFILE</code>脚本代码中，您将获得更舒适的PowerShell devo PS工作空间。</p><h1 id="b946" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">结论</h1><p id="e8f8" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">我认为PowerShell的真正强大之处在于，您可以为包括Windows在内的所有操作系统编写可读性更强、更易管理且可重用的Shell自动化代码。这意味着不再需要考虑更多的极端情况。您只需编写一次PowerShell代码片段，就可以在任何地方共享代码。</p><p id="8688" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">PowerShell的下一个版本将会提供越来越多的功能。我等不及了！</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><a href="https://www.buymeacoffee.com/rkttu"><div class="gh gi oi"><img src="../Images/6d60b235fcc46a4bd696b90e886419ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:340/format:webp/1*Dpw8-hNGI2fDmosV4E8DVQ.png"/></div></a></figure></div></div>    
</body>
</html>