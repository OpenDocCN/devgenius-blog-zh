<html>
<head>
<title>How to Setup a Local GitLab Source Code Management — Part II</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何建立本地GitLab源代码管理—第二部分</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-setup-a-local-gitlab-source-code-management-part-ii-2f034ce5a004?source=collection_archive---------4-----------------------#2020-12-01">https://blog.devgenius.io/how-to-setup-a-local-gitlab-source-code-management-part-ii-2f034ce5a004?source=collection_archive---------4-----------------------#2020-12-01</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="4c11" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">GitLab源代码管理简介</p><p id="7b7b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，我们已经设置好CentOS 8.2模板并准备就绪。让我们继续创建虚拟机，通过克隆模板虚拟机来托管GitLab源代码管理:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8aa35f01bd7e0d525ea7da7ba61f27bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*LbdwoRByetjQU9dTzE395A.gif"/></div></div></figure><blockquote class="ku kv kw"><p id="3307" class="jk jl kx jm b jn jo jp jq jr js jt ju ky jw jx jy kz ka kb kc la ke kf kg kh ig bi translated"><strong class="jm io">要仔细检查的东西:</strong></p><p id="4434" class="jk jl kx jm b jn jo jp jq jr js jt ju ky jw jx jy kz ka kb kc la ke kf kg kh ig bi translated"><strong class="jm io"> *适配器1被设置为NAT </strong></p><p id="5256" class="jk jl kx jm b jn jo jp jq jr js jt ju ky jw jx jy kz ka kb kc la ke kf kg kh ig bi translated"><strong class="jm io"> *适配器2设置为主机专用适配器:vboxnet1 </strong></p></blockquote><h1 id="f791" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">网络配置</h1><p id="1cd7" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">在Gitlab VM上电之后，我们需要为互联网访问做所有的网络配置，并在第二个适配器上设置静态IP地址。</p><p id="27cd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为此，关闭虚拟机上的两个适配器，并验证IP地址分配:</p><pre class="kj kk kl km gt me mf mg mh aw mi bi"><span id="9122" class="mj lc in mf b gy mk ml l mm mn">$ ifconfig</span></pre><p id="c347" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">NAT适配器是<strong class="jm io"> enp0s3 </strong>，主机专用适配器是<strong class="jm io"> enp0s8 </strong>。</p><p id="a978" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">您会注意到仅主机适配器无法连接，并显示以下错误:<strong class="jm io"> <em class="kx">【网络连接激活失败】</em> </strong>和<strong class="jm io"> enp0s8 </strong>没有分配给它的IP。因此，让我们继续解决这个问题吧！</p><h2 id="5bf5" class="mj lc in bd ld mo mp dn lh mq mr dp ll jv ms mt lp jz mu mv lt kd mw mx lx my bi translated">为主机专用适配器设置静态IP地址:<strong class="ak"> enp0s8 </strong></h2><p id="4ffd" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">要在CentOS 7中的网络接口上设置静态IP地址，有几种不同的方法，具体取决于您是否希望使用<code class="fe mz na nb mf b">Network Manager</code>来设置。</p><p id="6c9a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">网络管理器是一个动态的网络控制和配置系统，当网络设备和连接可用时，它试图保持它们的运行和活动。默认情况下，CentOS 8.2会安装并启用网络管理器服务。</p><p id="cd89" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要验证网络管理器服务的状态:</p><pre class="kj kk kl km gt me mf mg mh aw mi bi"><span id="3dcc" class="mj lc in mf b gy mk ml l mm mn">$ systemctl status NetworkManager.service</span></pre><p id="5914" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要检查哪个网络接口由网络管理器管理，请运行:</p><pre class="kj kk kl km gt me mf mg mh aw mi bi"><span id="5b96" class="mj lc in mf b gy mk ml l mm mn">$ nmcli dev status<br/>$ nmcli con show</span></pre><p id="d3ef" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果<code class="fe mz na nb mf b">nmcli</code>的输出显示某个特定接口的<code class="fe mz na nb mf b">connected</code>(如本例中的<code class="fe mz na nb mf b">enp0s3</code>)，则意味着该接口由网络管理器管理。您可以轻松地禁用特定接口的网络管理器，这样您就可以自己为静态IP地址配置它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6945679793ac7605f4a239931e6cebe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Lx0_aqEnLJ93HCiSz45mSQ.gif"/></div></div></figure><p id="4a30" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在我们可以看到主机专用:<strong class="jm io"> enp0s8 </strong>在名称“<strong class="jm io"> <em class="kx">接线1 </em> </strong>”下出现故障。在CentOS 8.2上，为网络接口分配静态IP地址有两种不同的方式。我们将<strong class="jm io">配置一个没有网络管理器的静态IP地址。</strong></p><p id="24aa" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们转到<code class="fe mz na nb mf b">/etc/sysconfig/network-scripts</code>目录，找到接口的配置文件(<code class="fe mz na nb mf b">ifcfg-enp0s3</code>)。</p><pre class="kj kk kl km gt me mf mg mh aw mi bi"><span id="f522" class="mj lc in mf b gy mk ml l mm mn">$ cd <!-- -->/etc/sysconfig/network-scripts<br/>$ sudo nano <!-- -->ifcfg-enp0s3</span></pre><p id="82b8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">复制以下接口配置，并以<code class="fe mz na nb mf b">ifcfg-enp0s8</code>的名称保存您的文件</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">这是我的<code class="fe mz na nb mf b">ifcfg-enp0s8 interface configuration</code></figcaption></figure><p id="dcc6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">接下来，重新启动网络管理器服务，检查主机专用:<strong class="jm io"> enp0s8 </strong>是否有分配的IP地址，并且现在<strong class="jm io"> </strong>是否由网络管理器管理:</p><pre class="kj kk kl km gt me mf mg mh aw mi bi"><span id="8e77" class="mj lc in mf b gy mk ml l mm mn">$ systemctl restart NetworkManager.service<br/>$ systemctl status NetworkManager.service<br/>$ nmcli dev status<br/>$ nmcli con show<br/>$ ifconfig</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f0554fc4d7df8f2ae23c10536ad4a978.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*xTJiFKAcIlEyz7kt8monVg.gif"/></div></div></figure><p id="a4b7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们准备好了。😃😉—现在，您可以从can ssh到您的虚拟机，并安装将在虚拟机上运行的Gitlab实例！</p><p id="764f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> <em class="kx">密码相同→osboxes.org</em></strong></p><pre class="kj kk kl km gt me mf mg mh aw mi bi"><span id="1883" class="mj lc in mf b gy mk ml l mm mn">ssh root@192.168.56.155</span></pre></div><div class="ab cl ni nj hr nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ig ih ii ij ik"><h1 id="923d" class="lb lc in bd ld le np lg lh li nq lk ll lm nr lo lp lq ns ls lt lu nt lw lx ly bi translated">安装GitLab实例</h1><p id="75a4" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">因此，我们有几种方法可以在CentOS 8.2上安装Gitlab。请点击这里:<a class="ae nu" href="https://about.gitlab.com/install/" rel="noopener ugc nofollow" target="_blank">https://about.gitlab.com/install/</a>了解这些不同的选项。你可以随意选择你觉得舒服的选项。因此，让我们从在虚拟机中安装docker开始。</p><blockquote class="ku kv kw"><p id="d574" class="jk jl kx jm b jn jo jp jq jr js jt ju ky jw jx jy kz ka kb kc la ke kf kg kh ig bi translated"><strong class="jm io"> <em class="in">在CentOS 8.2中安装Docker</em></strong></p></blockquote><p id="682f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">关于如何在CentOS上安装docker的说明可以在这里找到<a class="ae nu" href="https://docs.docker.com/engine/install/centos/" rel="noopener ugc nofollow" target="_blank">。但是首先，我们需要手动安装containerd.io包，否则我们会得到这个包丢失的错误。我们可以在这里找到最新版本</a><a class="ae nu" href="https://download.docker.com/linux/centos/8/x86_64/stable/Packages/" rel="noopener ugc nofollow" target="_blank">https://download . docker . com/Linux/centos/8/x86 _ 64/stable/Packages/</a>:</p><pre class="kj kk kl km gt me mf mg mh aw mi bi"><span id="b314" class="mj lc in mf b gy mk ml l mm mn">$ sudo yum install --allowerasing -y <a class="ae nu" href="https://download.docker.com/linux/centos/8/x86_64/stable/Packages/" rel="noopener ugc nofollow" target="_blank">https://download.docker.com/linux/centos/8/x86_64/stable/Packages/</a><a class="ae nu" href="https://download.docker.com/linux/centos/8/x86_64/stable/Packages/containerd.io-1.3.9-3.1.el8.x86_64.rpm" rel="noopener ugc nofollow" target="_blank">containerd.io-1.3.9-3.1.el8.x86_64.rpm</a></span></pre><p id="76c4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">接下来，我们将使用位于<a class="ae nu" href="https://get.docker.com/" rel="noopener ugc nofollow" target="_blank">get.docker.com</a>的脚本，通过运行以下命令来安装最新版本的Docker引擎:</p><pre class="kj kk kl km gt me mf mg mh aw mi bi"><span id="0e66" class="mj lc in mf b gy mk ml l mm mn">$ curl -fsSL https://get.docker.com -o get-docker.sh<br/>$ sudo sh get-docker.sh<br/>$ service docker start</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9796668e9c42fbc852b0971094987166.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*oya794aokV_7Pv0CRbtoyA.gif"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">在CentOS 8.2上安装docker截图</figcaption></figure><blockquote class="ku kv kw"><p id="fa7e" class="jk jl kx jm b jn jo jp jq jr js jt ju ky jw jx jy kz ka kb kc la ke kf kg kh ig bi translated"><strong class="jm io"> <em class="in">安装GitLab </em> </strong></p></blockquote><p id="180d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将使用GitLab Docker映像在我们的虚拟机中安装GitLab。GitLab Docker映像是GitLab在一个容器中运行所有必要服务的整体映像。</p><p id="4421" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在设置所有其他内容之前，配置一个新的环境变量<code class="fe mz na nb mf b">$GITLAB_HOME</code>,指向配置、日志和数据文件将驻留的目录。请确保该目录存在，并且已授予适当的权限。将路径设置为<code class="fe mz na nb mf b">/srv/gitlab</code>:</p><pre class="kj kk kl km gt me mf mg mh aw mi bi"><span id="d8d5" class="mj lc in mf b gy mk ml l mm mn">$ export GITLAB_HOME=/srv/gitlab</span></pre><p id="4803" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一旦你设置了<code class="fe mz na nb mf b">GITLAB_HOME</code>变量，你就可以运行图像了。主机名将是我们仅在主机上设置的静态IP地址:<strong class="jm io"> enp0s8 </strong>:</p><pre class="kj kk kl km gt me mf mg mh aw mi bi"><span id="fab9" class="mj lc in mf b gy mk ml l mm mn">sudo docker run --detach \<br/>  --hostname <!-- -->192.168.56.155<!-- --> \<br/>  --publish 443:443 --publish 80:80 --publish 9222:22 \<br/>  --name mygitlab \<br/>  --restart always \<br/>  --volume $GITLAB_HOME/config:/etc/mygitlab \<br/>  --volume $GITLAB_HOME/logs:/var/log/mygitlab \<br/>  --volume $GITLAB_HOME/data:/var/opt/mygitlab \<br/>  gitlab/gitlab-ee:latest</span></pre><blockquote class="ku kv kw"><p id="331b" class="jk jl kx jm b jn jo jp jq jr js jt ju ky jw jx jy kz ka kb kc la ke kf kg kh ig bi translated">确保用作主机名的IP地址不会改变，这一点非常重要。</p></blockquote><p id="e4b1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">部署后，等待它初始化。这可能需要几分钟时间。您可以使用docker log: <code class="fe mz na nb mf b">docker log containerID -f</code>命令对其进行监控:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/83465ec4e842f9921754aa5080f02e8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*_fvFMDwHmEmxIsJZFwcVKg.gif"/></div></div></figure><blockquote class="ku kv kw"><p id="fb03" class="jk jl kx jm b jn jo jp jq jr js jt ju ky jw jx jy kz ka kb kc la ke kf kg kh ig bi translated">现在你进入浏览器，导航到你本地的Gitlad源代码管理实例<strong class="jm io"/><a class="ae nu" href="http://HTTP://192.168.56.155" rel="noopener ugc nofollow" target="_blank"><strong class="jm io">http://192 . 168 . 56 . 155</strong></a><strong class="jm io">/</strong></p></blockquote><p id="8429" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">您将被要求设置密码，然后使用:</p><ul class=""><li id="84b6" class="nv nw in jm b jn jo jr js jv nx jz ny kd nz kh oa ob oc od bi translated">用户名→ root</li><li id="e921" class="nv nw in jm b jn oe jr of jv og jz oh kd oi kh oa ob oc od bi translated">密码→“您设置的新密码”</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/dd1786a2548c8d5f1a3f9ec979185a5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*R0QVMunIEk5xZALwyLuPag.gif"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated"><a class="ae nu" href="http://HTTP://192.168.56.155" rel="noopener ugc nofollow" target="_blank"><strong class="bd ld">http://192 . 168 . 56 . 155</strong></a><strong class="bd ld">/—截图</strong></figcaption></figure><p id="28ef" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">搞定了。现在您有了自己的源代码管理，可以使用本地托管的私有项目或其他任何东西🤷🏾‍♂️ 😉👌</p><blockquote class="ku kv kw"><p id="15bb" class="jk jl kx jm b jn jo jp jq jr js jt ju ky jw jx jy kz ka kb kc la ke kf kg kh ig bi translated"><em class="in">如果你喜欢这个故事，你可能也会喜欢“</em> <a class="ae nu" href="https://medium.com/swlh/how-to-setup-openshift-locally-on-mac-os-a3b7eb5a5151" rel="noopener"> <strong class="jm io">如何在Mac OS上本地设置open shift</strong></a><em class="in">”</em></p></blockquote><blockquote class="oj"><p id="773d" class="ok ol in bd om on oo op oq or os kh dk translated"><em class="ot">干杯！！！</em></p></blockquote></div></div>    
</body>
</html>