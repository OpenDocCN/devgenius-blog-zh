<html>
<head>
<title>React Native state management with Context API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用上下文 API 反应本机状态管理</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/react-native-state-management-with-context-api-61f63f5b099?source=collection_archive---------0-----------------------#2020-06-05">https://blog.devgenius.io/react-native-state-management-with-context-api-61f63f5b099?source=collection_archive---------0-----------------------#2020-06-05</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="e2b5" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">使用上下文 API 进行状态管理的快速指南。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/9e8f81a5bddff52fb58c573b75df085e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gpdN6Hz6LEtVu2luH9J5ZA.jpeg"/></div></div></figure><p id="4f81" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">Context API 是 React 中分离不连接组件的最佳状态管理解决方案之一。它解决了在多层组件之间通过 props 传递数据的复杂性。本文讨论了 Context API 并实现了一个使用 Context API 做移动应用的例子。完整的代码可以从<a class="ae lk" href="https://github.com/KuWathsala/ToDoContextAPI/" rel="noopener ugc nofollow" target="_blank">这里</a>取。</p><p id="05d8" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">当我们讨论状态管理时，我们可以说 Redux 是一个很好的解决方案。你对 Redux 感兴趣吗？那么，我之前的帖子会有帮助。你可以从<a class="ae lk" href="https://medium.com/@dkwathsala/getting-started-with-react-native-redux-479fb6e37be4" rel="noopener">这里</a>读到。</p><p id="5d1c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">但是现在的开发者转向了上下文 API，因为它有很多好处。需要 Redux 作为状态管理工具来安装' react-redux '、' redux '和' redux-thunk '库。上下文 API 是“反应”的一部分。因此，您不希望为了状态管理过程而安装任何库。它缩小了你的包裹尺寸。</p><p id="4ae1" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io"> 1。什么是上下文 API？</strong></p><p id="3b44" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><em class="ll">上下文提供了一种通过组件树传递数据的方法，而不必在每一层手动向下传递属性。</em> <strong class="kq io"> <em class="ll"> </em> </strong>由<a class="ae lk" href="https://reactjs.org/docs/context.html" rel="noopener ugc nofollow" target="_blank">来源</a></p><p id="3a8f" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">Context API 提供了一种简单明了的方法来在组件之间共享状态，而不需要 React 本身传递属性。</p><p id="abaa" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">例如，您必须将数据从顶层组件传递到第 n 层组件。如果不使用全局状态，就必须将数据作为道具传递给每个组件，直到第 n 级组件。使用上下文 API，您可以简单地覆盖所有来自顶层组件的底层组件。</p><p id="c5c5" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io"> 2。上下文 API 的构建块</strong></p><p id="2e15" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们可以将上下文 API 分为三个部分。</p><p id="21f5" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><em class="ll">上下文<br/>提供者<br/>消费者</em></p><p id="b0ee" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io"> 2.1 上下文</strong> <br/>首先从‘React’导入 React。然后，<em class="ll"> createContext() </em>函数来自 React，它将默认值作为第一个参数。在这里可选传递一个 Java 脚本对象。单个应用程序中可以有多个上下文。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi lm"><img src="../Images/55a639207016e36fd79cb93e0847703b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*404xgpKOc82NrTqCD3z3_A.jpeg"/></div></figure><p id="88fd" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io"> 2.2 提供者</strong> <br/>创建上下文后，提供者提供访问从其包装的上下文的能力。它提供了向下传递给所有组件的数据和函数。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/284dd53935b553e76666b9be3fef3520.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*-JNxMS3OiTF3K_RN8X9ooA.jpeg"/></div></figure><p id="a0ac" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io"> 2.3 消费者</strong> <br/>消费者允许访问由提供者包装的父组件的子组件的值。它有两种类型。</p><p id="f9d4" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">1.<context.consumer/></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi lo"><img src="../Images/38fbe8844f30cec2db02e974ae16f3f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jzJzXpyQdYHAJHH8XoHMbA.jpeg"/></div></div></figure><p id="db79" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">语境。消费者既可以使用基于类的组件，也可以使用功能组件。然而，这种方法只能在渲染中访问上下文。</p><p id="2eb7" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">2.静态上下文类型</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi lp"><img src="../Images/ec314ba1ee72cd38ae09c34541ed782a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rHyynrAKggo-SXZUkBUozA.jpeg"/></div></div></figure><p id="7e47" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">静态<em class="ll">上下文类型</em>只能用于基于类的组件。</p><p id="d26b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在，我们用上下文 API 实现我们的示例 React 本地项目“ToDo”。项目的文件夹结构如下。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/7f26fb93a10009a94b96a81b251cc08b.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/format:webp/1*9k5580mSDkcQdrhyMSH6Kw.jpeg"/></div></figure><p id="5f49" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">任务列表包括作为列表和删除任务的当前任务。页脚包括添加新任务功能。</p><p id="586b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io"> context.js </strong></p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="lr ls l"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">上下文. js</figcaption></figure><p id="6096" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io"> GlobalState.js </strong></p><p id="7cb2" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">GlobalState 将应用程序的逻辑分开保存。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="lr ls l"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">全球状态. js</figcaption></figure><p id="5577" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io"> TasksList.js </strong></p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="lr ls l"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">TasksList.js</figcaption></figure><p id="2a30" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io"> Footer.js </strong></p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="lr ls l"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">页脚. js</figcaption></figure><p id="f540" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io"> App.js </strong></p><p id="98d7" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">App.js 被 GlobalState 组件包装后，TaskList 和 Footer 就可以访问上下文了。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="lr ls l"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">App.js</figcaption></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi lx"><img src="../Images/c286365189acac1120bdaa922a5148d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:464/1*Ivr8w7dA2flWSA2Rd9pzqg.gif"/></div></div></figure></div><div class="ab cl ly lz hr ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ig ih ii ij ik"><p id="9993" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io">参考文献</strong></p><div class="mf mg gp gr mh mi"><a href="https://reactjs.org/docs/context.html" rel="noopener  ugc nofollow" target="_blank"><div class="mj ab fo"><div class="mk ab ml cl cj mm"><h2 class="bd io gy z fp mn fr fs mo fu fw im bi translated">上下文反应</h2><div class="mp l"><h3 class="bd b gy z fp mn fr fs mo fu fw dk translated">上下文提供了一种通过组件树传递数据的方法，而不必每次都手动传递属性</h3></div><div class="mq l"><p class="bd b dl z fp mn fr fs mo fu fw dk translated">reactjs.org</p></div></div><div class="mr l"><div class="ms l mt mu mv mr mw km mi"/></div></div></a></div><p id="6e61" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><a class="ae lk" href="https://academind.com/learn/react/redux-vs-context-api/" rel="noopener ugc nofollow" target="_blank">https://academind.com/learn/react/redux-vs-context-api</a></p><p id="c5c6" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><a class="ae lk" href="https://blog.logrocket.com/use-hooks-and-context-not-react-and-redux/" rel="noopener ugc nofollow" target="_blank">https://blog . log rocket . com/use-hooks-and-context-not-react-and-redu</a>x</p></div></div>    
</body>
</html>