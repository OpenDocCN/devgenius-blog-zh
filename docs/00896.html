<html>
<head>
<title>All about DNS Hierarchy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于DNS层次结构的所有信息</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/all-about-dns-hierarchy-36fabfcdc1f1?source=collection_archive---------2-----------------------#2020-06-19">https://blog.devgenius.io/all-about-dns-hierarchy-36fabfcdc1f1?source=collection_archive---------2-----------------------#2020-06-19</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/21d438de160dc1cd4105697bd570fd4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cj1sOiA8p1aUXeac"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">照片由<a class="ae jz" href="https://unsplash.com/@jordanharrison?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">乔丹·哈里森</a>在<a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="f45c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">可能我们都知道这样一个事实:每当我们试图访问something.com时，这个“something . com”必须被转换成一个类似“103.217.135.125”的IP地址，这样我们的浏览器，比如Chrome，才能知道要联系哪个服务器。</p><p id="af43" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在本帖中，我们将讨论从“something.com”到“103.217.135.125”的转换是如何发生的。</p><h1 id="204e" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">DNS缓存</h1><p id="6526" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">所以，你打开任何一个网络浏览器，比如Chrome，搜索“docs.google.com”。众所周知，要显示“docs.google.com”上的内容，您的浏览器需要知道服务于“docs.google.com”域名的服务器的IP地址。在第一步，你的电脑在本地(你自己的电脑)的DNS缓存中查找是否已经存储了“docs.google.com”的IP地址。每当你试图访问一个域名时，比如“docs.google.com ”,你的电脑就会通过我们将要讨论的DNS查询找到相应的IP地址，并将该IP地址存储在它的<strong class="kc io">本地DNS缓存</strong>中一段预定义的时间，之后它就会被删除。您可能在不久前访问过“docs.google.com ”,其IP地址在本地缓存中可用，在这种情况下，您的浏览器将简单地从您的本地DNS缓存中获取IP地址，我们就完成了。</p><p id="ce27" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">但是，假设本地缓存没有存储“docs.google.com”的IP地址，现在怎么办？在这种情况下，你的电脑会联系你的<a class="ae jz" href="https://whatismyipaddress.com/isp" rel="noopener ugc nofollow" target="_blank"> ISP </a>的<strong class="kc io">递归DNS解析器</strong>。这个DNS解析器的目的是给你任何域名的IP地址，比如“docs.google.com”。如果DNS解析器已经知道它自己的本地缓存中的答案(在过去为您的ISP的另一个用户或您服务时存储的)，它将简单地返回您想要的IP地址。然而，在另一种情况下，它将执行一个<strong class="kc io"> DNS查询</strong>并获取您想要的IP地址。</p><blockquote class="mb mc md"><p id="81fa" class="ka kb me kc b kd ke kf kg kh ki kj kk mf km kn ko mg kq kr ks mh ku kv kw kx ig bi translated">使用ISP的DNS解析器是可选的，你可以随时使用任何公开可用的DNS。通过在网络设置中将DNS设置为“8.8.8.8”并将二级DNS设置为“8.8.4.4”，可以使用谷歌的DNS解析器。</p></blockquote><h1 id="96c7" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">DNS查询</h1><p id="c33a" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">当您的ISP的DNS解析器不知道与某个域相关联的IP地址时，它会向<strong class="kc io">权威DNS服务器层级</strong>发出<strong class="kc io"> DNS查询</strong>。这个DNS层次结构肯定会知道与互联网上任何可用域相关联的IP地址，因为任何组织(比如Google)使用的每个域都必须向互联网注册商之一注册。互联网注册服务商(如<a class="ae jz" href="https://clarivate.com/markmonitor" rel="noopener ugc nofollow" target="_blank"> MarkMonitor </a>)可以被视为ICANN认可的域名批发商，他们与感兴趣的组织(如本案例中的谷歌)进行沟通，并通过注册管理执行机构(如<a class="ae jz" href="https://en.wikipedia.org/wiki/Verisign" rel="noopener ugc nofollow" target="_blank"> Verisign </a>)将适当的<strong class="kc io"> DNS记录</strong>输入所需的<strong class="kc io"> TLD注册管理机构</strong>。现在，当google.com的DNS记录就绪时，可以进行DNS查询来获得所需的IP地址。在这篇文章的其余部分，我们将理解这个DNS查询是如何工作的。</p><h2 id="92ed" class="mi kz in bd la mj mk dn le ml mm dp li kl mn mo lm kp mp mq lq kt mr ms lu mt bi translated">顶级域名</h2><p id="a314" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">任何像“docs.google.com”这样的域名都是由称为域的不同组件组成的，例如，“com”、“google”和“docs”是“docs.google.com”的组成域。最右边的域名(com)是<strong class="kc io">顶级</strong>域名，之后是<strong class="kc io">二级域名</strong> (google)，然后是<strong class="kc io">域名</strong> (docs)。这种结构可以用二级子域名、三级子域名等等无限扩展，但是由于大型域名难以记忆，它们失去了意义，因为在这种情况下记忆IP地址可能实际上更容易。</p><p id="2b33" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">顶级域名(或TLD)可分为两组，<strong class="kc io">国家代码TLD</strong>(或ccTLDs)和<strong class="kc io">通用TLD</strong>(或gTLDs)。ccTLDs是为特定国家保留的顶级域名，例如。在(印度)。英国(uk)或。jp(日本)。另一方面，gTLDs是通用顶级域名，如。com，。edu。org，或者。net，任何人都可以使用。</p><p id="06e3" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这些顶级域名由<strong class="kc io">互联网名称与数字地址分配机构</strong> <strong class="kc io"> (ICANN) </strong>进行全球维护。每个顶级域名都有自己的一套域名服务器，有助于DNS解析。例如，有一组域名服务器需要解决”。com”域名<strong class="kc io">只有</strong>，而另一组域名服务器将解析<strong class="kc io">只有</strong>。org”域名。</p><blockquote class="mb mc md"><p id="b036" class="ka kb me kc b kd ke kf kg kh ki kj kk mf km kn ko mg kq kr ks mh ku kv kw kx ig bi translated">可用顶级域名的设置不是静态的，ICANN定期注册新的名称空间。在这里，您可以找到所有可用顶级域名的<a class="ae jz" href="https://data.iana.org/TLD/tlds-alpha-by-domain.txt" rel="noopener ugc nofollow" target="_blank">列表。</a></p></blockquote><h2 id="dd04" class="mi kz in bd la mj mk dn le ml mm dp li kl mn mo lm kp mp mq lq kt mr ms lu mt bi translated">根名称服务器</h2><p id="4aec" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">这些“顶级域名服务器”之上的一级是<strong class="kc io">根域名服务器</strong>。这些根域名服务器的唯一目的是了解哪些顶级域名服务器可以解析特定的TLD。因此，如果有人联系这些根域名服务器来解析“google.com”或“amazon.in”，根域名服务器可以将他们引向”。com”和”。在“名称服务器”中。因此，为了解析任何域名，DNS解析器将联系最近的根域名服务器之一，并且将发生以下过程。</p><figure class="mv mw mx my gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mu"><img src="../Images/546a534a3e1bc05a650ce1f55f9a5c91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xC5nV5mVQup70VJOlYCPvA.png"/></div></div></figure><blockquote class="mb mc md"><p id="d166" class="ka kb me kc b kd ke kf kg kh ki kj kk mf km kn ko mg kq kr ks mh ku kv kw kx ig bi translated">有1000多个根域名服务器，仅使用13个地址标签，分布在全球不同的位置。每个地址标签可以被认为是一对IPv4和IPv6地址，并且指向共享该标签的根名称服务器的集群。这些根域名服务器由各种组织管理，如美国国家航空航天局、美国陆军(研究实验室)和互联网系统联盟等。以下是<a class="ae jz" href="https://www.iana.org/domains/root/servers" rel="noopener ugc nofollow" target="_blank"> 13个根域名服务器IP</a>的列表。</p></blockquote><h2 id="5084" class="mi kz in bd la mj mk dn le ml mm dp li kl mn mo lm kp mp mq lq kt mr ms lu mt bi translated">DNS解析</h2><p id="b5b4" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">现在，我们可以说，我们已经解决了顶级域名，我们知道该向哪个服务器请求所有的”。请注意，这个过程到目前为止对所有的域名都是一样的。com”域名，如“google.com”、“amazon.com”等。现在我们将看到如何进一步解决二级域名，在我们的示例“docs.google.com”中是“google”。虽然ICANN管理顶级域名，但二级域名由拥有它们的组织管理，例如，谷歌管理“google.com”，而亚马逊管理“amazon.com”和“amazon.in”。如今，大多数组织都有自己的二级域名，不像顶级域名在不同组织之间共享。此外，所有的组织都需要有一个私有或共享的DNS，为什么？我们一会儿再讨论。</p><p id="6a28" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">每当一个组织，例如谷歌，想要使用一个域名提供服务，比如“google.com ”,它必须向ICANN注册该域名。我们可以说，经过一个法律程序，ICANN将注册谷歌名称服务器的IP地址与所有"。com "名称服务器。本次注册后，所有的”。名称服务器将知道谷歌的DNS的IP地址(不是“8.8.8.8 ”,它是一个DNS解析器),因此可以解析域“google.com”或子域“docs.google.com”。二级域名将像这样解析，</p><figure class="mv mw mx my gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mz"><img src="../Images/ac82c66d32a7baba4453a478bd0cc97f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-CTP31aC4GDl2GN3bd0rxA.png"/></div></div></figure><blockquote class="mb mc md"><p id="0b5c" class="ka kb me kc b kd ke kf kg kh ki kj kk mf km kn ko mg kq kr ks mh ku kv kw kx ig bi translated">要使用“google.in”，谷歌必须向ICANN注册为”。在“名称服务器。</p></blockquote><p id="e62b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">太好了！！所以，在寻找“docs.google.com”的同时，我们终于到达了谷歌自己的域名服务器(或DNS)。如今，大多数组织在其生态系统中管理单个根域(“google.com”)和多个子域(“docs.google.com”或“mail.google.com”)。组织的DNS将知道与所有这些子域相关联的IP地址，因此我们的DNS解析之旅的最后一步将是，</p><figure class="mv mw mx my gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi na"><img src="../Images/7174b33785a1faf3a41cb97139a07806.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w_d-chWvHik99KzlFuIJaw.png"/></div></div></figure><p id="e698" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在，当DNS解析器知道“docs.google.com”的IP地址时，它会在本地内存中缓存相同的地址一段预定义的时间，称为TTL(生存时间)，然后将IP地址返回到您的计算机。注意，这个TTL周期是由域名所有者指定的(在“docs.google.com”的情况下是Google)。您的计算机还会在相同的TTL期间将IP地址保存在自己的本地缓存中。这样，如果你经常访问同一个域名，它的加载速度会比其他用户很少访问的域名快一些。</p><p id="dabd" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我将在这里结束这个已经很大的帖子，感谢您的阅读。别忘了给点掌声(出自<strong class="kc io"> 50 </strong>)。</p></div></div>    
</body>
</html>