# ç©å¼„æ•°æ®æ¡†æ¶. jl ç¬¬äºŒéƒ¨åˆ†

> åŸæ–‡ï¼š<https://blog.devgenius.io/playing-with-dataframes-jl-part-ii-260748a49dc6?source=collection_archive---------2----------------------->

![](img/edb0617e3d486acebb77baf40a156588.png)

è€ƒç‰¹å°¼Â·åº“å…‹åœ¨ [Unsplash](https://unsplash.com/s/photos/ice-cream?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) ä¸Šçš„ç…§ç‰‡

**ç®€ä»‹**

æœ¬æ–‡æ—¨åœ¨å±•ç¤º Julia ä¸­çš„ [DataFrames.jl](https://dataframes.juliadata.org/stable/#DataFrames.jl) åŒ…ä¸ºæ‚¨å¸¦æ¥çš„ä¸€äº›å¯èƒ½æ€§(ä¸€äº›å…³äº DataFrames çš„é‡è¦çŸ¥è¯†)ã€‚å½“ç„¶è¿˜æœ‰æ›´å¤šã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ç¬¬ä¸€éƒ¨åˆ†ã€‚

**å†…å®¹**

*   é€åˆ—åˆ›å»ºæ•°æ®å¸§
*   é€è¡Œåˆ›å»ºæ•°æ®å¸§
*   åˆ›å»ºæ•°æ®æ¡†æ¶çš„å¦ä¸€ç§æ–¹æ³•(å¸¦æœ‰è¶£çš„ç»ƒä¹ ğŸ§)
*   è·å–å€¼çš„ç‰¹å®šå­é›†
*   åŸºäºæ¡ä»¶é€‰æ‹©è¡Œ
*   é€è¡Œè½¬æ¢åˆ—
*   ä½¿ç”¨ç°æœ‰åˆ—çš„è½¬æ¢åˆ›å»ºæ–°åˆ—
*   å°†å‡½æ•°åº”ç”¨äºåˆ—
*   æ’åºåˆ—
*   æ›´æ”¹ç‰¹å®šç´¢å¼•
*   æ›¿æ¢ç‰¹å®šç´¢å¼•
*   åˆ é™¤ç¼ºå°‘çš„å€¼
*   è¿æ¥

**ä¸è¦å¿˜è®°ä½¿ç”¨æ‚¨æƒ³è¦çš„åŒ…(åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯:DataFrames)**

```
using DataFrames
```

**é€åˆ—åˆ›å»ºæ•°æ®å¸§**

è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç©ºçš„æ•°æ®å¸§

```
df1=DataFrame()
```

![](img/125c30c18dd0d61d24a53cbab8b3ac0a.png)

åˆ›å»ºç¬¬ä¸€åˆ—

```
df1.Favourite_ice_cream = ["banana","pistachio","chocolate","strawberry","chocolate","chocolate","mint","caramel","vanilla","vanilla"]
```

![](img/b915e7252253f7eb92761287af0242bd.png)

åˆ›å»ºç¬¬äºŒåˆ—

```
df1.Student_name = ["Nick","Maria","Jo","Lola","Maria","John","Helen","Mike","Steve","Harry"]
```

![](img/d8ddcdf639bc44865db4b75f32bb187a.png)

å‡†å¤‡å¥½äº†ã€‚

**é€è¡Œåˆ›å»ºæ•°æ®å¸§**

æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªåŒ…å«ç©ºåˆ—çš„æ•°æ®å¸§ã€‚

```
df2 = DataFrame(Favourite_ice_cream = String[], Student_age = Int[])
```

![](img/2afe678a516623f18d5a110dbe1b4079.png)

ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä¸€è¡Œä¸€è¡Œåœ°å¡«ã€‚

```
push!(df2, ("banana", 15))
```

![](img/d1c84575f493be2d5a9ba73ea0630d8b.png)

æˆ‘ä»¬è¿˜å¯ä»¥æ·»åŠ è¡Œï¼Œå¦‚ä¸‹æ‰€ç¤º:

```
push!(df2, Dict(:Favourite_ice_cream => "pistachio", :Student_age => 13)) #Attention needs => not =
```

![](img/a098341548fbc684d9e7d12f1cc98a6a.png)

**åˆ›å»ºæ•°æ®æ¡†æ¶çš„å¦ä¸€ç§æ–¹æ³•**

æˆ‘æƒ³åˆ›å»ºä»¥ä¸‹åˆ—(å˜é‡):

*   æˆ‘æ¯å¤©åƒçš„å¼€å¿ƒæœå†°æ·‡æ·‹(æŒç»­ 20 å¤©)ã€‚

åˆ—å:å¼€å¿ƒæœ

*   æˆ‘æ¯å¤©åƒçš„é¦™è•‰å†°æ·‡æ·‹(æŒç»­ 20 å¤©)ã€‚

åˆ—å:BananaPD

*   æˆ‘æ¯å¤©åƒçš„æŸ æª¬å†°æ·‡æ·‹(æŒç»­ 20 å¤©)ã€‚

åˆ—å:LemonPD

ğŸ§å¼€å¿ƒæœå†°æ·‡æ·‹çš„ä¸€äº›ä¿¡æ¯

æˆ‘æ¯å¤©åƒçš„å¼€å¿ƒæœå†°æ·‡æ·‹æœ€å°‘æ˜¯ 1 å‹ºã€‚

æˆ‘æ¯å¤©æœ€å¤šåƒ 39 å‹ºå¼€å¿ƒæœå†°æ·‡æ·‹ã€‚

æ¯å¤©éƒ½æ˜¯ä»ä¸Šä¸€ä¸ªå¤šåƒä¸¤ä¸ª(ä» 1 å¼€å§‹ï¼Œä»¥ 39 ç»“å°¾)ã€‚

ğŸ§é¦™è•‰å†°æ·‡æ·‹çš„ä¸€äº›ä¿¡æ¯

è¿ç»­ä¸¤å¤©ï¼Œæˆ‘åƒåŒæ ·æ•°é‡çš„å†°æ·‡æ·‹å‹ºã€‚

ä» 1 å¼€å§‹ï¼Œä»¥ 10 ç»“æŸã€‚

ğŸ§æŸ æª¬å†°æ·‡æ·‹çš„ä¸€äº›ä¿¡æ¯

æ¯å¤©æˆ‘éƒ½ä¼šå¤šåƒä¸€å‹ºå‰ä¸€å¤©çš„æŸ æª¬å†°æ·‡æ·‹ã€‚

ä» 1 å¼€å§‹ï¼Œä»¥ 20 ç»“æŸã€‚

è¯·è€ƒè™‘ä¸€ä¸‹å¦‚ä½•åˆ›å»ºè¿™ä¸ªæ•°æ®æ¡†æ¶ã€‚

å½“ä½ å‡†å¤‡å¥½äº†ï¼Œé˜…è¯»è§£å†³æ–¹æ¡ˆã€‚

è§£å†³æ–¹æ¡ˆ:

```
df3 = DataFrame(PistachioPD = 1:2:39, BananaPD = repeat(1:10, inner = 2), LemonPD = 1:20)
```

![](img/4788a19579690b5a7be7664765e9c6ba.png)

ä»ç°åœ¨å¼€å§‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸‹é¢çš„æ•°æ®æ¡†æ¶:

```
df = DataFrame(
Favourite_ice_cream = ["banana","pistachio","chocolate","strawberry","chocolate","chocolate","mint","caramel","vanilla","vanilla"],
Age = [23,28,35,33,23,25,20,32,32,17],
Name = ["Nick","Maria","Jo","Lola","Maria","John","Helen","Mike","Steve","Harry"],
Gender = ["Male","Female","Female","Female","Female","Male","Tansgender","Male","Male","Male"],
Height = [1.88,1.73,missing,1.68,1.79,1.58,1.70,missing,1.90,"None"],
Daily_expenses = [125.6,58.7,13.2,45.8,12,6.7,87.4,55.6,63.8,34.7])
```

![](img/8aedf40b38c02e64e03d4cbcfa51f7b3.png)

**è·å–ç‰¹å®šçš„å€¼å­é›†**

æˆ‘æƒ³å¾—åˆ°æˆ‘çš„æ•°æ®æ¡†æ¶çš„ä¸€ä¸ªå­é›†ï¼Œå…¶ä¸­åªæœ‰æˆ‘é€‰æ‹©çš„å¹´é¾„çš„äººå‚ä¸ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘æƒ³è¦ 17 å²ã€23 å²æˆ– 33 å²çš„äººçš„ä¿¡æ¯ã€‚

```
df[in.(df.Age, Ref([17,23,33])), :]
```

![](img/3425fa03635939437f3ec947303980eb.png)

**æ ¹æ®æ¡ä»¶é€‰æ‹©è¡Œ**

æˆ‘æƒ³åœ¨æˆ‘çš„æ•°æ®æ¡†æ¶ä¸­ç ”ç©¶ 23 å²ä»¥ä¸Šçš„äººã€‚

```
df[df.Age .> 23, :]
```

![](img/4ff3e8a2f5080743f1fc54e40e815005.png)

ç°åœ¨ï¼Œæˆ‘æƒ³è¦çš„æ˜¯é‚£äº›è¶…è¿‡ 25 å²ï¼Œä½†æ˜¯æ—¥å¸¸å¼€é”€åœ¨ 30 ç¾å…ƒåˆ° 46 ç¾å…ƒä¹‹é—´çš„äººã€‚

```
df[(df.Age .> 25) .& (30 .< df.Daily_expenses .< 46), :]
```

![](img/de4bbaab918eb939a4373f2e9c49dbcf.png)

**é€è¡Œå˜æ¢åˆ—**

æˆ‘æƒ³å¾—åˆ°æ‰€æœ‰æ—¥å¸¸å¼€é”€çš„å¹³æ–¹æ ¹ã€‚

```
select(df, :Daily_expenses => ByRow(sqrt))
```

![](img/2f6d5674b08a6b0ae63cc8777fc622b5.png)

**ç”¨ç°æœ‰åˆ—çš„è½¬æ¢åˆ›å»ºä¸€ä¸ªæ–°åˆ—**

è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåä¸º x çš„æ•°æ®å¸§ï¼Œå®ƒåŒ…å«æ¥è‡ªç°æœ‰æ•°æ®å¸§çš„åˆ—â€œAgeâ€å’Œâ€œDaily_expensesâ€ã€‚

```
x = select(df, :Age, :Daily_expenses)
```

![](img/ebfa8c3ae4310e2725789a587719952a.png)

æˆ‘æƒ³åˆ›å»ºä¸€ä¸ªæ–°åˆ—ï¼Œåœ¨åŒä¸€è¡Œä¸­åŒ…å« Age å’Œ Daily_expenses çš„æ€»å’Œã€‚

ä¸¾ä¸ªä¾‹å­ï¼Œ

23+125.6

28+58.7

ç­‰ç­‰ã€‚

```
transform(x, All() => +)
```

![](img/1ce15b220daa51a8c1e0e40229294346.png)

**å¯¹åˆ—åº”ç”¨å‡½æ•°**

å‡è®¾æˆ‘ä»¬æƒ³è¦åˆè®¡æ‰€æœ‰çš„æ—¥å¸¸å¼€æ”¯ã€‚

```
combine(df, :Daily_expenses .=> sum)
```

![](img/413acc2987bf38ea51fbb9e51d847a0a.png)

**å¯¹åˆ—è¿›è¡Œæ’åº**

æ˜¯æ—¶å€™å¯¹å¹´é¾„å˜é‡è¿›è¡Œæ’åºäº†ã€‚ä»æœ€å°å¹´é¾„åˆ°æœ€å¤§å¹´é¾„ã€‚

```
sort!(df, :Age)
```

![](img/7461260906a900ee4eb330067bd84a14.png)

è¿™å°†è‡ªåŠ¨åº”ç”¨äºæˆ‘ä»¬çš„æ•°æ®æ¡†æ¶ã€‚æ‰€ä»¥ï¼Œä»ç°åœ¨å¼€å§‹ï¼Œæˆ‘ä»¬è¦å¤„ç†å·²æ’åºçš„å¹´é¾„å˜é‡ã€‚

**æ”¹å˜å…·ä½“æŒ‡æ ‡**

æˆ‘æƒ³ç”¨å€¼ 12 æ¥æ›´æ”¹å¹´é¾„åˆ—çš„ç¬¬äºŒè¡Œã€‚

```
df.Age[2] = 12
```

![](img/6626e2c239578b3c4da4317cd327da59.png)

**æ›´æ¢ç‰¹å®šæŒ‡æ ‡**

è®©æˆ‘ä»¬ç”¨ JoJo è¿™ä¸ªåå­—ä»£æ›¿ Jo è¿™ä¸ªåå­—ã€‚

```
replace!(df.Name, "Jo" => "JoJo")
```

![](img/8574cc39aa6148436662cd80aa761912.png)

è¿™å°†è‡ªåŠ¨åº”ç”¨äºæˆ‘ä»¬çš„æ•°æ®æ¡†æ¶ã€‚

ä»ç°åœ¨å¼€å§‹ï¼Œæˆ‘ä»¬å°†åœ¨åˆ—åçš„æœ€åä¸€è¡Œä½¿ç”¨ JoJo è¿™ä¸ªåç§°ã€‚

æˆ‘è¿˜æƒ³ç”¨ missing æ›¿æ¢â€œNoneâ€å€¼ã€‚

```
replace!(df.Height, "None" => missing)
```

![](img/79b13824181a56c7f09d6ed0e8cadbca.png)

**åˆ é™¤ç¼ºå¤±å€¼**

åˆ é™¤æ‰€æœ‰ä¸¢å¤±çš„å€¼ï¼

```
dropmissing(df, :Height)
```

![](img/59e025db2bea18fab0b82251a02cb532.png)

ä½†æ˜¯å¦‚æœä½ åƒä¸‹é¢è¿™æ ·å†™(df ),ä½ ä¼šå¾—åˆ°ç¼ºå°‘å€¼çš„æ•°æ®å¸§ã€‚

```
df
```

å¦‚æœæ‚¨å¸Œæœ›æ›´æ”¹(dropmissing)è‡ªåŠ¨åº”ç”¨åˆ°æˆ‘ä»¬å·²æœ‰çš„æ•°æ®å¸§ï¼Œè¯·è¾“å…¥**ï¼**åœ¨ dropmissing çš„è¯­æ³•ä¸­ã€‚

```
dropmissing!(df, :Height)
```

**åŠ å…¥**

æœ€åä½†åŒæ ·é‡è¦çš„æ˜¯ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨è¿æ¥ã€‚

æˆ‘å°†åˆ›å»ºä¸¤ä¸ªç›¸äº’ç‹¬ç«‹çš„æ•°æ®å¸§ã€‚

é¦–å…ˆ:

```
IceCream = DataFrame(ID=[1, 2], FavIceCream=["mint", "banana"])
```

![](img/61e834d09d1990fc162ff389b9452031.png)

ç¬¬äºŒ:

```
Names = DataFrame(ID=[1, 2], Name=["Helen", "Nick"])
```

![](img/53cdd735cdaf15cfa20bc0f4d94faf05.png)

è®©æˆ‘ä»¬åŠ å…¥ä»–ä»¬ã€‚

```
innerjoin(IceCream, Names, on = :ID)
```

![](img/72295fb6339a1e4de7f9758be2688f18.png)

æˆ‘ä¼šå†åˆ›é€ ä¸€ä¸ªã€‚

ç¬¬ä¸‰:

```
Names = DataFrame(ID=[1, 4], Name=["Helen", "John"])
```

![](img/63a87cec004bbbfd47710dd0dbd60c18.png)

æˆ‘ä»¬å°†è°ƒæŸ¥ä»¥ä¸‹å„é¡¹ä¹‹é—´çš„å·®å¼‚:

å·¦è¿æ¥()

rightjoin()

å¤–éƒ¨è”æ¥()

å†…éƒ¨è”æ¥()

åŠè¿æ¥()

åè”æ¥()

äº¤å‰è¿æ¥()

```
#leftjoin()
leftjoin(IceCream, Names, on = :ID)
```

![](img/a9aa19c55825aef1d4ad253e90d94661.png)

åŒ…å«å·¦å‚æ•°(å†°æ·‡æ·‹)çš„è¡Œå’Œå€¼ã€‚æˆ‘ä»¬ä¸å…³å¿ƒè¯¥å€¼æ˜¯å¦å­˜åœ¨äºæ­£ç¡®çš„å‚æ•°(åç§°)ä¸­ã€‚æ­£å¦‚æˆ‘ä»¬åœ¨åˆ›å»ºçš„ç¬¬ä¸‰ä¸ªæ•°æ®å¸§(åç§°)ä¸­çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬åªæœ‰ ID = 1 å’Œ ID = 4 çš„åç§°ã€‚

```
#rightjoin()
rightjoin(IceCream, Names, on = :ID)
```

![](img/2b04c0136c752ae189906f3c3ff6d655.png)

åŒ…å«å³å‚æ•°çš„è¡Œå’Œå€¼(åç§°)ã€‚æˆ‘ä»¬ä¸å…³å¿ƒè¿™ä¸ªå€¼æ˜¯å¦å­˜åœ¨äºå·¦è¾¹çš„å‚æ•°(å†°æ·‡æ·‹)ä¸­ã€‚æ­£å¦‚æˆ‘ä»¬åœ¨åˆ›å»ºçš„ç¬¬ä¸€ä¸ªæ•°æ®å¸§(å†°æ·‡æ·‹)ä¸­çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬åªæœ‰ ID = 1 å’Œ ID = 2 çš„å€¼ã€‚

```
#outerjoin()
outerjoin(IceCream, Names, on = :ID)
```

![](img/9326833586d04efffed7e04b9dd4818a.png)

åŒ…å«ä¸¤ä¸ªå‚æ•°(æ•°æ®å¸§)å€¼çš„è¡Œï¼Œå³ä½¿å®ƒä»¬ç¼ºå¤±ã€‚

```
#innerjoin()
innerjoin(IceCream, Names, on = :ID)
```

![](img/6a820a608a986c4a66e215c7df2113a0.png)

åŒ…å«ä¸¤ä¸ªå‚æ•°(æ•°æ®å¸§)å€¼çš„è¡Œï¼Œå‰ææ˜¯å®ƒä»¬å­˜åœ¨ã€‚

```
#semijoin()
semijoin(IceCream, Names, on = :ID)
```

![](img/2a5aba4fa073cd1dde215fd322c334ef.png)

ç±»ä¼¼äº inner joinï¼Œä½†æ˜¯è¾“å‡ºåªåŒ…å« left (IceCream)å‚æ•°ã€‚

```
#antijoin()
antijoin(IceCream, Names, on = :ID)
```

![](img/399cfd20154454451877f6f7d1f88cd5.png)

åŒ…å«å­˜åœ¨äºå·¦ä¾§(å†°æ·‡æ·‹)è€Œéå³ä¾§(åç§°)å‚æ•°ä¸­çš„å€¼è¡Œã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰å†°æ·‡æ·‹(æ¥è‡ªå·¦è¾¹çš„è®ºè¯),ä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“åƒå†°æ·‡æ·‹çš„äººçš„åå­—ã€‚å’Œä¸Šé¢ä¸€æ ·(åŠè¿æ¥)ï¼Œè¾“å‡ºè¢«é™åˆ¶åœ¨å·¦è¾¹å‚æ•°çš„åˆ—(å†°æ·‡æ·‹)ã€‚

```
#crossjoin()
crossjoin(IceCream, Names, makeunique = true)
```

![](img/11ad92c25fd7dcd97b8b412a6a0055e6.png)

å·¦å‚æ•°ä¸­çš„æ¯ä¸€è¡Œéƒ½ä¸å³å‚æ•°ä¸­çš„æ‰€æœ‰è¡Œæˆå¯¹(*è¡Œ*çš„ç¬›å¡å°”ç§¯)ã€‚

**ç»“è®º**

æœ¬æ–‡æ˜¯ DataFrames.jl çš„ç¬¬äºŒéƒ¨åˆ†ï¼Œä¹Ÿæ˜¯æœ€åä¸€éƒ¨åˆ†ã€‚

æ„Ÿè°¢æ‚¨çš„é˜…è¯»ï¼ğŸ¤—