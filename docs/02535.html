<html>
<head>
<title>Have you ever wondered what is in your CRA webpack bundle ?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你有没有想过你的CRA网络包里有什么？</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/have-you-ever-wondered-what-is-in-your-cra-webpack-bundle-76d38ba4317a?source=collection_archive---------5-----------------------#2020-08-10">https://blog.devgenius.io/have-you-ever-wondered-what-is-in-your-cra-webpack-bundle-76d38ba4317a?source=collection_archive---------5-----------------------#2020-08-10</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/52539997c2336f2ea9e8a4ae2e191e02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fH2bw2atPUS5fQoO"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">多梅尼科·洛亚在<a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="57a5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在我的一个单页面应用程序项目中，我注意到<strong class="kc io"> webpack包</strong>的大小显著增加。我坚信每个人时不时都会经历同样的情况。在<em class="ky">紧张的</em>开发条件下，你的产品代码达到5兆字节或更多只是时间问题。</p><p id="e1f7" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">你开始开发一个小项目，然而仅仅几个月，它已经成长为超级大的包。你知道，这总是同一个故事。:)</p><p id="f19d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">每当我为自己设置一个新的单页面应用程序时，我都会定期使用一个名为<em class="ky"> create-react-app(CRA) </em>的引导工具来为我的项目建立基础。这是一项可爱的技术——光是名字就让我觉得有点误导和困惑。然而，在软件行业，尤其是在JS领域，我们很难正确命名。任何一个名为—<em class="ky">hold yourself please</em>—<em class="ky">NIGHTMARE</em>的高级浏览器自动化库的普通用户都可以连续谈论它几个小时。</p><p id="18eb" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">幸运的是，有一个<strong class="kc io">简单明了的解决方案</strong>可以发现您的捆绑包包含了什么。</p><p id="e9bf" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">经典的创建-反应-应用程序</p><p id="171d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">使用经典的create-react-app，很容易获得关于包大小的详细信息。</p><p id="3265" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">简单地说，按照这里的指示:</p><p id="68f9" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><a class="ae jz" href="https://create-react-app.dev/docs/analyzing-the-bundle-size/" rel="noopener ugc nofollow" target="_blank"><em class="ky">https://create-react-app . dev/docs/analyzing-the-bundle-size/</em></a></p><p id="0c78" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">简而言之:</p><p id="3d06" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">只需在<em class="ky"> node_modules </em>中添加一个名为<em class="ky"> source-map-explorer </em>的新工具即可。然后运行脚本来生成并可视化结果。</p><p id="1b29" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">然后通过查看图表进行检查，找出问题所在。</p><p id="6935" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">例如，这是我的小项目:</p><figure class="la lb lc ld gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi kz"><img src="../Images/4a6bd99523855713058c07bb16ee3c16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dSXljEMFbced6eVaZF6iiA.png"/></div></div></figure><p id="b7ae" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">关于这些发现最酷的一点是，您可以将它们作为独立文件<strong class="kc io">接收。你只需<em class="ky">抓取</em>生成的文件，并通过<em class="ky">电子邮件/slack/随便什么</em>发送给你的同事。然后，他很容易地在浏览器中打开它，以便获得一个关于这个包有什么问题的<strong class="kc io">极好的概述</strong>。</strong></p><p id="ac3d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">当然，像往常一样，它起初并不适合我的项目:)在我的产品构建中，源地图的生成已经被关闭。启用它之后，我终于获得了一个结果，它清楚地显示了包的内容，我可以很快地<strong class="kc io">识别出罪魁祸首</strong>。</p><p id="7085" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">被弹出的app </strong></p><p id="b7d6" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在我的一个应用程序中，我退出了这个应用程序，以支持Typescript的惊人的、当时还是实验性的特性。事后看来，我并不认为这是一个好的举动，但伤害已经造成了。</p><p id="fd73" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">事实上，“<em class="ky"> create-react-app </em>”工具<strong class="kc io">几乎完美地保护了你远离webpack、babel和许多其他工具的混乱，这些工具在现代客户端开发中使用起来很愉快。我一直想知道CRA的内心世界是什么样的，于是我把实验性特征的开启作为满足我求知欲的借口。如你所料，这也让我的生活变得更加艰难。:)</strong></p><p id="e4dc" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">因此，如果你像我一样做出了大胆的举动，你可能会在检索webpack统计数据时遇到问题。我已经尝试了几种方法来解决这个问题，但是唯一有效的方法是使用webpack-visualizer-plugin。</p><p id="6500" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><a class="ae jz" href="https://www.npmjs.com/package/webpack-visualizer-plugin" rel="noopener ugc nofollow" target="_blank"><em class="ky">https://www.npmjs.com/package/webpack-visualizer-plugin</em></a></p><p id="8c4c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="ky">" web pack-visualizer-plugin ":" ⁰.1.11 "，</em></p><p id="b109" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为了打开它，你必须将包添加到<em class="ky"> package.json </em>中，然后运行你最喜欢的包管理器(npm或yarn)。然后，修改web pack config—path "<em class="ky">your app \ config \ web pack . config . js</em>"</p><p id="2d81" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">将以下代码附加到文件的开头:</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="9469" class="lj lk in lf b gy ll lm l ln lo"><em class="ky">var Visualizer = require(‘webpack-visualizer-plugin’);</em></span></pre><p id="2491" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">并将下面的代码添加到部分插件(代码)</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="785c" class="lj lk in lf b gy ll lm l ln lo"><em class="ky">new Visualizer(),</em></span></pre><p id="617f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这是一个网络包的经典插件。不过请注意，文件<em class="ky"> webpack.config.js </em>有点乱。因此，将代码添加到<em class="ky">模块的plugin属性中。</em></p><p id="3744" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">正如您在这里看到的:</p><figure class="la lb lc ld gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lp"><img src="../Images/61c29bdc8f4dc4ccd47c80a3bad6bc46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8XkdJxteWpR5Kz4UrA07Mg.png"/></div></div></figure><p id="bf01" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">从现在开始，没有什么能阻止你拿到报告。从运行你的<strong class="kc io">生产版本</strong>开始。构建完成后，你会注意到一个名为<em class="ky">stats.html</em>的新文件。要检查的是一个<strong class="kc io">独立的HTML文件</strong>。只需在您的浏览器中打开它，瞧，您的包的内容将以一种非常简洁明了的方式展现出来。</p><figure class="la lb lc ld gt jo gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/c703e4cebbd532ba9a7b26295f549cc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*VKso4JXYSvuI_-Ns-Vqbwg.png"/></div></figure><p id="ef37" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">补充说明:这是您在没有<em class="ky"> create-react-app </em>的情况下为设置所做的工作(您只需运行):</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="ea60" class="lj lk in lf b gy ll lm l ln lo"><em class="ky">webpack — profile — JSON &gt; compilation-stats.json</em></span></pre><p id="224c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">然后将生成的文件上传到此站点:</p><div class="lr ls gp gr lt lu"><a href="https://chrisbateman.github.io/webpack-visualizer/" rel="noopener  ugc nofollow" target="_blank"><div class="lv ab fo"><div class="lw ab lx cl cj ly"><h2 class="bd io gy z fp lz fr fs ma fu fw im bi translated">Webpack可视化工具</h2><div class="mb l"><h3 class="bd b gy z fp lz fr fs ma fu fw dk translated">如果你正在定制你的stats输出或者使用webpack-stats-plugin，一定要设置…</h3></div><div class="mc l"><p class="bd b dl z fp lz fr fs ma fu fw dk translated">chrisbateman.github.io</p></div></div></div></a></div><p id="b534" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">渴望了解更多关于webpack stats的信息？请点击此链接:</p><p id="34b2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><a class="ae jz" href="https://webpack.js.org/api/stats/." rel="noopener ugc nofollow" target="_blank">https://webpack.js.org/api/stats/.</a></p><p id="4b84" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">对于输出文件<em class="ky"> stats.json </em>中包含的内容有一个很好的解释。我强烈建议您阅读它，以获得更多的见解。在调试和调整你的包时，它肯定会<strong class="kc io">得到回报</strong>。</p><p id="2adc" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">综上所述，获取和阅读分析是一项容易完成的任务。当然，删除臃肿的代码不再是小菜一碟。我将在下一篇博文中分享我所有的关于如何减小包大小的技巧和提示。</p></div></div>    
</body>
</html>