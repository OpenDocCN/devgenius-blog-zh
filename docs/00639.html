<html>
<head>
<title>Level Up Your Programming Skills by Investing in Dependency Injection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过投资依赖注入来提升你的编程技能</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/level-up-your-programming-skills-by-investing-in-dependency-injection-5c8c626e0344?source=collection_archive---------3-----------------------#2020-06-13">https://blog.devgenius.io/level-up-your-programming-skills-by-investing-in-dependency-injection-5c8c626e0344?source=collection_archive---------3-----------------------#2020-06-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0215" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">这里是你学习它的起点</h2></div><p id="d1e9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">作为一名来自企业应用程序世界的开发人员，我不被允许使用<strong class="kh ir"> new </strong>关键字。多亏了一个<strong class="kh ir">依赖注入(DI) </strong>框架，我们可以成功地做到这一点。因此，我将对该模式及其优势进行基本的解释。除此之外，我将向您介绍一个精心设计的 DI 框架—<a class="ae lb" href="https://github.com/modesttree/Zenject" rel="noopener ugc nofollow" target="_blank">zenjet</a>—目标是 C#编程语言。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lc"><img src="../Images/e1886242366e69dd94f78afa15e27b23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wfQen58fJp_9Tl3-o7l1pA.jpeg"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated"><a class="ae lb" href="https://unsplash.com/@fatosi?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Fatos Bytyqi </a>在<a class="ae lb" href="https://unsplash.com/s/photos/coding?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="9d6e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">依赖注入 101</h1><p id="d87f" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">我们有一个设计原则叫做<strong class="kh ir">控制反转(IoC) </strong>。DI 背后的思想是 IoC，因此在讨论 DI 之前，有必要先了解 IoC。一个简单的介绍应该给我们背后的 DI 想法的推理。</p><h2 id="d511" class="mp lt iq bd lu mq mr dn ly ms mt dp mc ko mu mv me ks mw mx mg kw my mz mi na bi translated">控制反转(IoC)</h2><p id="5b65" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">顾名思义，其原理是反转控制。这里的<strong class="kh ir">控件</strong>是指应用或<strong class="kh ir">对象创建</strong>的<strong class="kh ir">流程。我不打算触及应用程序流。但是，如果你感兴趣，你可以很容易地找到它的例子。我的重点将是在一个类中创建依赖对象。</strong></p><p id="4029" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们来看一个非常简单的例子；</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="3dfb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你在上面看到的是<code class="fe nd ne nf ng b">ScoreManager </code>对<code class="fe nd ne nf ng b">ScoreBoard</code>的纯粹依赖。你可以问为什么这不好。嗯，这是一种不好的做法，因为<code class="fe nd ne nf ng b">ScoreBoard<strong class="kh ir"> </strong></code> <strong class="kh ir">可以无声无息地改变</strong>。因此，这一变化可能会对<code class="fe nd ne nf ng b">ScoreManager</code>产生影响。此外，想象一下<code class="fe nd ne nf ng b">ScoreBoard </code>也用在其他类中。在那之后，所有这些都需要更多的修改。</p><p id="c75e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们创造一个更好的<code class="fe nd ne nf ng b">ScoreManager</code>版本；</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="4253" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的版本中，没有<code class="fe nd ne nf ng b">new </code>关键字。除此之外，<code class="fe nd ne nf ng b">ScoreManager </code>依赖于抽象而不是具体的实现。它甚至不再关心它的实现。它只是从外面得到它。正如你所看到的，我们已经将创建对象的控制从 T8 转换到了更高的级别。</p><p id="9f66" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">IoC 在这里给了我们很大的灵活性来修改所有的<code class="fe nd ne nf ng b">IScoreBoard </code>接口的具体实现。</p><h2 id="5f8e" class="mp lt iq bd lu mq mr dn ly ms mt dp mc ko mu mv me ks mw mx mg kw my mz mi na bi translated">依赖注入与 IoC 到底有什么关系？</h2><p id="3d76" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">我相信你已经了解了国际奥委会的概念。因此，依赖注入只不过是 IoC 的一个应用。所有的依赖项都是在一个容器中创建的。我们称之为<strong class="kh ir"> DI 容器</strong>。之后，注入器在需要的地方注入这些依赖项。今天，我们几乎为每一种编程语言都提供了非常强大的 DI 框架。在举例之前，我想先想象一下我们在这里取得的成就。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi nh"><img src="../Images/7b109bf73b9b29245b5212b192a55191.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vSq4IdGtHkEacqOUsxYOUg.png"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated"><em class="ni">传统的依赖管理方式</em></figcaption></figure><p id="cf7b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上图中，您可以看到传统的依赖性管理方式。想象一下在一个有数百个类的项目上的依赖图。几乎每一个班级的变化都会有很大的影响。</p><p id="d3bf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在让我们看看使用阿迪框架如何改变这个图表；</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi nh"><img src="../Images/d51a7f95c3bcefb619aa07b69b347bd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oMM4WXE8Ucmus3Af59AFZA.png"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated"><em class="ni">依赖注入式依赖管理方式</em></figcaption></figure><p id="2a51" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">甚至从视觉上解释，看起来更清晰。DI 容器包含所有实例或创建新实例的信息。它将这些实例分发给需要的类。</p><p id="cf83" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，你得到了阿迪集装箱的基本概念。你可以马上坐下来写你的注射器。这取决于你，但我宁愿不从零开始创建阿迪框架。因为有很棒的免费工具，比如:</p><ul class=""><li id="4ae4" class="nj nk iq kh b ki kj kl km ko nl ks nm kw nn la no np nq nr bi translated">Zenject，因此可以在 Unity 中使用)</li><li id="3803" class="nj nk iq kh b ki ns kl nt ko nu ks nv kw nw la no np nq nr bi translated">Google Guice (Java)</li><li id="7cb8" class="nj nk iq kh b ki ns kl nt ko nu ks nv kw nw la no np nq nr bi translated"><a class="ae lb" href="http://inversify.io/" rel="noopener ugc nofollow" target="_blank"> Inversify </a>(类型脚本，因此可以在 nodeJS 应用程序中使用)</li></ul><p id="65d9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">还有很多你喜欢的语言。我将很快介绍 Zenject，给出使用阿迪容器的基本概念。</p><h1 id="6bae" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">Zenject DI 框架</h1><p id="0bfb" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">Zenject 是主要为 Unity 游戏引擎编写的阿迪框架。但是，因为它是用 C#编写的，所以你也可以在 Unity 之外的 C#项目中使用它。它是完全免费的。支持所有主要的软件平台。它是开源的，非常容易使用，并且有多种配置。</p><p id="352c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使您的项目适应 DI 可能会花费大量的时间，但是这绝对是值得的。因此，我认为这是一项投资，并强烈建议这样做。</p><h2 id="5085" class="mp lt iq bd lu mq mr dn ly ms mt dp mc ko mu mv me ks mw mx mg kw my mz mi na bi translated">它是如何工作的？</h2><p id="9835" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">在此之前，您应该访问<a class="ae lb" href="https://github.com/svermeulen/Zenject" rel="noopener ugc nofollow" target="_blank">项目的主页</a>以获取初始设置和文档。我已经说过框架将注入依赖项，但是如何注入呢？</p><h2 id="a3c4" class="mp lt iq bd lu mq mr dn ly ms mt dp mc ko mu mv me ks mw mx mg kw my mz mi na bi translated">配置</h2><p id="e1e1" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">每个 DI 框架都希望用户提供某种配置。换句话说，您应该提供实例绑定信息。比如说；</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="c31b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的配置中，我们将具体的类<code class="fe nd ne nf ng b">ScoreBoard</code>绑定到接口<code class="fe nd ne nf ng b">IScoreBoard</code>。然而，绑定的配置不限于此。我们可以决定；</p><ul class=""><li id="28e8" class="nj nk iq kh b ki kj kl km ko nl ks nm kw nn la no np nq nr bi translated"><strong class="kh ir">是否应该有单个实例:</strong>是的，这可以让你不用使用单例设计模式。因为如果将绑定设置为 Single，容器将只创建一个实例，并将它分发到任何需要的地方。</li><li id="5530" class="nj nk iq kh b ki ns kl nt ko nu ks nv kw nw la no np nq nr bi translated"><strong class="kh ir">如果应该延迟创建实例:</strong>因此，如果您将要创建的对象很重，并且您不想在应用程序开始时实例化它，您可以推迟创建该对象。</li></ul><p id="ab0f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些是所有 DI 容器都必须具备的非常简单的配置。您可以检查该框架的所有其他特性。它们给人的印象太深刻了，给你很大的灵活性。</p><h2 id="6277" class="mp lt iq bd lu mq mr dn ly ms mt dp mc ko mu mv me ks mw mx mg kw my mz mi na bi translated">注射</h2><p id="13f8" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">让我们看看我们的记分牌例子，注入；</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="b035" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以，用法就像使用一个<code class="fe nd ne nf ng b">Inject</code>标签一样简单。当<code class="fe nd ne nf ng b">ScoreManager </code>被创建时，Zenject 将检测这个标签，并注入给定的<code class="fe nd ne nf ng b">IScoreBoard</code>的具体绑定。</p><p id="e681" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上面的例子叫做<strong class="kh ir">场注入</strong>。每个 DI 框架都能够做到这一点，但是这里有一个问题。<code class="fe nd ne nf ng b">ScoreManager </code>的依赖关系在外部是不明确的。让我们解决这个问题；</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="24a1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我总是在构造函数中暴露所有的依赖关系。这是一个很好的做法。为什么？</p><ul class=""><li id="cb87" class="nj nk iq kh b ki kj kl km ko nl ks nm kw nn la no np nq nr bi translated">构造函数清楚地显示了类的依赖关系。</li><li id="125a" class="nj nk iq kh b ki ns kl nt ko nu ks nv kw nw la no np nq nr bi translated">您可以更有效地使用 IDE，而不必直接进入类中。</li><li id="7a1e" class="nj nk iq kh b ki ns kl nt ko nu ks nv kw nw la no np nq nr bi translated">这也是一个警告。如果你有 3 个以上的依赖项，你应该停止。这是一个明显的迹象，表明这个班有许多职责。所以，你可能想把它分成两个或更多的类。</li></ul><p id="625e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">即使 Zenject 不需要接口来创建对象，我还是建议您创建定义良好的接口。一旦你有了一个好的界面，管理变化的影响就相当容易了。</p><h1 id="b366" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">最后的话</h1><p id="e7e7" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">我恳求你投入一些时间来学习阿迪框架。我保证你会为你的项目结构感到骄傲。它将比以往任何时候都更加清晰和易于管理。您将看到低耦合类是如何提高您的生产率的。此外，您的代码将更具可读性和可测试性。</p><p id="184d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您可以为您的单元测试提供不同的配置。您可以编写 A/B 测试、性能测试，除了您的 DI 配置类之外，不涉及任何类。</p><p id="43e2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">希望对于那些从未使用过 DI 的人来说，这个解释简单明了。非常感谢你的时间。如果你有任何问题，我很乐意回答你。</p><h1 id="0c85" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">资源</h1><p id="12da" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated"><a class="ae lb" href="https://github.com/modesttree/Zenject/blob/master/README.md" rel="noopener ugc nofollow" target="_blank">zenjet 文档</a><br/><a class="ae lb" href="https://www.youtube.com/watch?v=IS2YUIb_w_M&amp;list=PLKERDLXpXl_jNJPY2czQcfPXW4BJaGZc_" rel="noopener ugc nofollow" target="_blank">zenjet 视频教程(主要针对 Unity 游戏引擎)</a></p></div></div>    
</body>
</html>