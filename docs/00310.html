<html>
<head>
<title>On the power of Hooks: Part 3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">钩子的力量:第三部分</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/on-the-power-of-hooks-part-3-78d79cc2a110?source=collection_archive---------1-----------------------#2020-06-01">https://blog.devgenius.io/on-the-power-of-hooks-part-3-78d79cc2a110?source=collection_archive---------1-----------------------#2020-06-01</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><figure class="im in gp gr io ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/ad64972cc1e1ba7ec19e61f251ce4f7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eFS-ThVamLlKsta3OpItxA.jpeg"/></div></div><figcaption class="iw ix gj gh gi iy iz bd b be z dk translated">由<a class="ae ja" href="https://unsplash.com/@vishu_2star?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Vishal Jadhav </a>在<a class="ae ja" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><div class=""/><p id="5b75" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们来到了 React Hooks 系列文章的最后一部分。在第 1 部分中，我们已经学习了如何使用钩子让我们的组件播放音频文件。在<a class="ae ja" href="https://medium.com/@accounts_32070/on-the-power-of-hooks-part-2-8de86630648c" rel="noopener">第 2 部分</a>中，我们已经学习了如何增强一个组件，使其始终知道当前时间。现在是时候将所有这些拼凑在一起，并探索我们如何在现实生活中利用我们所学到的东西。</p></div><div class="ab cl ky kz hr la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ig ih ii ij ik"><h1 id="0fb0" class="lf lg jd bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">上船啦</h1><p id="63a1" class="pw-post-body-paragraph ka kb jd kc b kd md kf kg kh me kj kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">因此，让我们想象一下，一家公司希望鼓励其员工在轮班时定期洗手。高管们已经决定推出一款非常简单的应用程序，该程序会提醒员工每隔一段时间洗一次手。我们现在被指派开发这样的应用程序，在开发的第一天，这些用户故事就摆在了我们的桌子上:</p><ul class=""><li id="76d7" class="mi mj jd kc b kd ke kh ki kl mk kp ml kt mm kx mn mo mp mq bi translated">作为一个用户，我想在我轮班开始时签到。</li><li id="577c" class="mi mj jd kc b kd mr kh ms kl mt kp mu kt mv kx mn mo mp mq bi translated">作为一名用户，我希望看到一个提醒，提醒我当前正在值班</li><li id="bee8" class="mi mj jd kc b kd mr kh ms kl mt kp mu kt mv kx mn mo mp mq bi translated">作为一名用户，我想手动下班</li></ul><p id="b164" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们看看如何利用钩子来完成这项工作。</p></div><div class="ab cl ky kz hr la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ig ih ii ij ik"><h1 id="0273" class="lf lg jd bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">周一忧郁…</h1><p id="4c17" class="pw-post-body-paragraph ka kb jd kc b kd md kf kg kh me kj kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">我们想做的第一件事就是为我们的轮班数据建立一个模型。我们将利用<a class="ae ja" href="https://redux-toolkit.js.org/" rel="noopener ugc nofollow" target="_blank"> redux-toolkit </a>创建所有必要的代码来存储和操作我们的用户转换状态。</p><figure class="mw mx my mz gt ip"><div class="bz fp l di"><div class="na nb l"/></div><figcaption class="iw ix gj gh gi iy iz bd b be z dk translated">一个简单的切片，可以在轮班时检查和离开。</figcaption></figure><p id="b0a6" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果你不熟悉<a class="ae ja" href="https://redux-toolkit.js.org/api/createSlice" rel="noopener ugc nofollow" target="_blank">切片</a>，它们可以非常方便地声明状态，而且是从一个地方的突变。上面的代码让我们分别通过<code class="fe nc nd ne nf b">shiftSlice.reducer</code>和<code class="fe nc nd ne nf b">shiftSlice.action</code>来访问一个缩减器及其动作。</p><p id="dd7d" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们将它应用到第一个组件中，一个类似按钮的视图，它允许用户在相应地改变颜色的同时进出班次。</p><figure class="mw mx my mz gt ip"><div class="bz fp l di"><div class="na nb l"/></div><figcaption class="iw ix gj gh gi iy iz bd b be z dk translated">良好的第一步。</figcaption></figure><p id="3f6c" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们来分解一下。</p><p id="cda0" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们利用前一篇文章中的<code class="fe nc nd ne nf b">useCurrentTime</code>来引用当前每秒更新的内容。然后我们通过 redux 的<code class="fe nc nd ne nf b">useSelector</code>使用<code class="fe nc nd ne nf b">lastShiftSelector</code>来获得最新的内存转移。</p><p id="ad01" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这个有趣的位在<code class="fe nc nd ne nf b">useEffect</code>中，每次<code class="fe nc nd ne nf b">currentTime</code>改变时都会被调用，然后检查<code class="fe nc nd ne nf b">currentTime</code>是否在最后一个班次的<code class="fe nc nd ne nf b">endTime</code>之前。如果是，我们在轮班中，状态通过<code class="fe nc nd ne nf b">setIsOnShift</code>相应地更新。</p><p id="2227" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">然后，我们的<code class="fe nc nd ne nf b">TouchableOpacity</code>负责根据用户输入更新换档状态。检查我们是否正在值班，或者检查我们是否外出。这是通过由<code class="fe nc nd ne nf b">useDispatch</code>分派的片的动作来完成的。</p></div><div class="ab cl ky kz hr la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ig ih ii ij ik"><p id="b4a4" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">到目前为止，我们已经处理了故事 1 和 3，现在我们希望有一个单独的文本提醒来显示用户是否在轮班。可以想象，我们必须将上面的大部分代码复制到另一个组件中，以检查用户是否在值班。那么我们为什么不利用我们所学的知识，从上面的组件中提取一个自定义钩子呢？让我们试试。</p><figure class="mw mx my mz gt ip"><div class="bz fp l di"><div class="na nb l"/></div><figcaption class="iw ix gj gh gi iy iz bd b be z dk translated">不错！</figcaption></figure><p id="5555" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">好了，我们已经抽象出了<code class="fe nc nd ne nf b">useIsOnShift</code>，现在我们可以在我们的代码库中使用我们的定制钩子了。我们现在可以重构<code class="fe nc nd ne nf b">ShiftButton</code>来使用我们的钩子。</p><figure class="mw mx my mz gt ip"><div class="bz fp l di"><div class="na nb l"/></div><figcaption class="iw ix gj gh gi iy iz bd b be z dk translated">我们还设法节省了整整 10 行代码。</figcaption></figure><p id="7c18" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">然后，我们可以利用<code class="fe nc nd ne nf b">useIsOnShift</code>来完成我们的第二个任务。</p><figure class="mw mx my mz gt ip"><div class="bz fp l di"><div class="na nb l"/></div><figcaption class="iw ix gj gh gi iy iz bd b be z dk translated">我们的徽章现在只有在用户轮班时才会出现。</figcaption></figure><p id="1811" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们现在已经完成了分配给我们的所有用户情景。</p><p id="3391" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc je">去庆祝！</strong></p></div><div class="ab cl ky kz hr la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ig ih ii ij ik"><p id="dc0d" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这是我穿越 React Hooks 之旅的第三部分。你可以在这里找到<a class="ae ja" href="https://medium.com/@accounts_32070/on-the-power-of-react-hooks-49094e76709c" rel="noopener">第一部分</a>和在那里找到<a class="ae ja" href="https://medium.com/@accounts_32070/on-the-power-of-hooks-part-2-8de86630648c" rel="noopener">第二部分</a>。</p></div></div>    
</body>
</html>