<html>
<head>
<title>Growth modelling in piglets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">小猪的生长模型</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/growth-modeling-in-piglets-534766dcad1f?source=collection_archive---------13-----------------------#2022-01-20">https://blog.devgenius.io/growth-modeling-in-piglets-534766dcad1f?source=collection_archive---------13-----------------------#2022-01-20</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="565c" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">在R中使用混合模型</h2></div><p id="bdad" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这是我多年前在一个商业数据集上做的一个项目的帖子。因为它是商业的，我不能与你分享，但我可以展示我如何处理这个小猪试验模型的请求。</p><p id="2e32" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">从我的许多帖子中，你已经可以看出我将使用统计模型对这个数据集进行建模，最好是<a class="ae ky" href="https://medium.com/mlearning-ai/introduction-to-mixed-models-in-r-9c017fd83a63" rel="noopener">混合模型</a>，因为它允许我对固定和随机效应进行建模，后者可以通过方差-协方差矩阵进行最佳处理。</p><p id="b89b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们开始吧，我将带您了解整个过程。</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="e97d" class="li lj in le b gy lk ll l lm ln">rm(list = ls())</span><span id="93fb" class="li lj in le b gy lo ll l lm ln">#### LIBRARIES ####<br/>library(lme4)<br/>library(ggplot2)<br/>library(rms)<br/>library(plyr)<br/>library(reshape2)<br/>library(boot)<br/>library(sjPlot)<br/>library(sjstats)<br/>library(sjmisc)<br/>library(interval)<br/>library(AICcmodavg)<br/>require(parallel)  <br/>library(gridExtra)<br/>library(coefplot) <br/>library(coda)      <br/>library(aods3)     <br/>library(plotMCMC) <br/>library(bbmle)     <br/>library(nlme)<br/>library(merTools)<br/>library(RLRsim) <br/>library(pbkrtest)<br/>library(multcomp)<br/>library(lsmeans)<br/>library(multcompView)<br/>library(lattice)<br/>library(splines)<br/>library(lmtest)<br/>library(car)<br/>library(corrplot)<br/>library(PerformanceAnalytics)<br/>library(eqs2lavaan)<br/>library(mgcv)<br/>library(gamm4)<br/>library(robustlmm)<br/>library(influence.ME)<br/>library(readxl)<br/>library(sfsmisc)</span><span id="dfe0" class="li lj in le b gy lo ll l lm ln">#### DATA IMPORT &amp; MANAGEMENT ####<br/>Marc &lt;- read_excel("")<br/>colnames(Marc)[2]&lt;-"Trt"<br/>colnames(Marc)[3]&lt;-"Number"<br/>colnames(Marc)[4]&lt;-"D7"<br/>colnames(Marc)[5]&lt;-"D21"<br/>colnames(Marc)[6]&lt;-"D34"<br/>colnames(Marc)[7]&lt;-"D42"<br/>colnames(Marc)[8]&lt;-"FCR7"<br/>colnames(Marc)[9]&lt;-"FCR21"<br/>colnames(Marc)[10]&lt;-"FCR34"<br/>colnames(Marc)[11]&lt;-"FCR42"<br/>GUISSONA&lt;-Marc<br/>Marc<br/>GUISSONA&lt;-as.data.frame(GUISSONA)<br/>GUISSONA&lt;- reshape(GUISSONA,<br/>                    varying  = list(c("D7", "D21", "D34", "D42"),c("FCR7","FCR21","FCR34","FCR42")),<br/>                    v.names = c("Weight","FCR"),<br/>                    timevar = "Time",<br/>                    times = as.numeric(c("7", "21", "34", "42")),<br/>                    direction = "long")<br/>GUISSONA$id&lt;-NULL<br/>GUISSONA&lt;-GUISSONA[order(GUISSONA$Pen),]<br/>row.names(GUISSONA)&lt;-NULL<br/>GUISSONA&lt;-GUISSONA[!is.na(GUISSONA$Weight)|!is.na(GUISSONA$FCR),]<br/>dim(GUISSONA)<br/>GUISSONA$Trt&lt;-as.factor(GUISSONA$Trt)<br/>GUISSONA&lt;-as.data.frame(GUISSONA)<br/>class(GUISSONA)<br/>GUISSONA$Time_center&lt;-scale(GUISSONA$Time, center=TRUE, scale=FALSE)<br/>GUISSONA$Time_fact&lt;-as.factor(GUISSONA$Time)<br/>head(GUISSONA)</span></pre><figure class="kz la lb lc gt lq gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/160c8ce27c5a569c5b29c250fb95fcc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*MAxPbRXtmBhy5VyXNho6Ow.png"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">分层数据—纵向。</figcaption></figure><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="92c6" class="li lj in le b gy lk ll l lm ln">theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks=c(7,21,34,42))<br/>myy&lt;-scale_y_continuous(breaks = seq(0, 3, by = 0.25))<br/>ggplot(GUISSONA, aes(x=Time, y=Weight, colour=Trt, shape=Trt))+<br/>  myx+<br/>  myy+<br/>  stat_summary(fun.y=mean, geom="point", lwd=2)+<br/>  stat_summary(fun.y=mean, geom="line", lwd=1)</span><span id="3cb0" class="li lj in le b gy lo ll l lm ln">myy&lt;-scale_y_continuous(breaks = seq(0, 3, by = 0.25))<br/>ggplot(GUISSONA, aes(x=as.factor(GUISSONA$Time), y=Weight, colour=Trt)) +<br/>  geom_boxplot() +<br/>  theme_bw() +<br/>  myy+<br/>  labs(title = "BW over time", y="BW", x="Time")</span></pre><div class="kz la lb lc gt ab cb"><figure class="lx lq ly lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/d6d04be74c9e9a3f2de9ceee7d7a1983.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*Xf_YnG9ExX_gMOyXBwXvJA.png"/></div></figure><figure class="lx lq mh lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/9683c385947f6d0e023238a304c85f54.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*4OU-9wF7IPse4oBXAusXzA.png"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk mi di mj mk translated">哇，在这个数据集中寻找治疗差异将是一个相当大的挑战。有时候，建模在你开始之前就已经完成了。</figcaption></figure></div><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="9082" class="li lj in le b gy lk ll l lm ln">sjp.poly(GUISSONA$Weight,GUISSONA$Time, 1)<br/>sjp.poly(GUISSONA$Weight,GUISSONA$Time, 2) <br/>sjp.poly(GUISSONA$Weight,GUISSONA$Time, 3)<br/>sjp.poly(GUISSONA$Weight,GUISSONA$Time, 4)</span></pre><div class="kz la lb lc gt ab cb"><figure class="lx lq ml lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/c61584381db42237152e1dc9a33378fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*8Nf9ZhujwjHaddQZHMYvnA.png"/></div></figure><figure class="lx lq ml lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/c9fbb12d73c0d76abc4aecbecdab5d9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*eoN3wHyWiUDF0AoIUEgoPw.png"/></div></figure></div><div class="ab cb"><figure class="lx lq ml lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/bd5328ad48f1e06daf4bb737eca5957c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*66HYm76UNZfOMgWvBzrT0A.png"/></div></figure><figure class="lx lq ml lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/1bcd01c4ffadc39b4d5e93571c8820eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*oqRg8G4j4XEARBm7GnmnWw.png"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk mm di mn mk translated">老实说，线性拟合看起来足够了。</figcaption></figure></div><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="be6f" class="li lj in le b gy lk ll l lm ln">xyplot(GUISSONA$Weight~GUISSONA$Time|GUISSONA$Trt,<br/>       panel = function(x, y, ...) {<br/>         panel.grid()<br/>         panel.xyplot(x, y)<br/>         panel.lmline(x, y, lty = 2, col="black")<br/>         panel.loess(x, y, lty = 2, col="red")<br/>         panel.abline(0, 0)<br/>       } )</span></pre><figure class="kz la lb lc gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi mo"><img src="../Images/f0f43404568437ee175717db8e415017.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VW4IjxXwjxZJ8UeOkt5X0g.png"/></div></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">治疗方法看起来非常相似。</figcaption></figure><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="73ff" class="li lj in le b gy lk ll l lm ln">xyplot(GUISSONA$Weight~GUISSONA$Time|GUISSONA$Pen,<br/>       panel = function(x, y, ...) {<br/>         panel.grid()<br/>         panel.xyplot(x, y)<br/>         panel.lmline(x, y, lty = 2, col="black")<br/>         panel.abline(0, 0)<br/>       } )</span></pre><figure class="kz la lb lc gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi mo"><img src="../Images/4d89f77f18e8a2be6a3323656e59606b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iIQ1y87KR1tciVVX-678aQ.png"/></div></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">所有的笔似乎都有相同的反应。也许测量日应该有不同的位置？</figcaption></figure><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="7aee" class="li lj in le b gy lk ll l lm ln">bwplot(GUISSONA$Weight~GUISSONA$Trt)<br/>bwplot(GUISSONA$Weight~as.factor(GUISSONA$Pen)) <br/>bwplot(GUISSONA$Time~GUISSONA$Weight)<br/>bwplot(GUISSONA$Weight~as.factor(GUISSONA$Time)) <br/>bwplot(GUISSONA$FCR~as.factor(GUISSONA$Trt)|GUISSONA$Time_fact)</span></pre><div class="kz la lb lc gt ab cb"><figure class="lx lq ml lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/24fea566bd250d62075d720a4e2fc7b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*LQj1OzAgqc8v5BWro8IR0w.png"/></div></figure><figure class="lx lq ml lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/3d78fdc98939de57860a5c129255782c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*UZnpYwl_HSM4LzXSspChow.png"/></div></figure></div><div class="ab cb"><figure class="lx lq ml lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/adbc2eae2fc0a5a0f7cb4b31eca3e8e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*b3oYTEAwvzMwpMDmm3_nbQ.png"/></div></figure><figure class="lx lq ml lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/480e5446a5e73dc9b2b962006972063d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*69stvpu0gz4BDluWjN6AIQ.png"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk mm di mn mk translated">随着时间的推移和重量的增加，差异也会增加。一个普通的故事。</figcaption></figure></div><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="e3b8" class="li lj in le b gy lk ll l lm ln">qqp(GUISSONA$Weight)</span><span id="e9c0" class="li lj in le b gy lo ll l lm ln">densityplot(~GUISSONA$Weight|GUISSONA$Time,scales=list(relation="free"))</span><span id="9194" class="li lj in le b gy lo ll l lm ln">scatterplotMatrix(~ Time + Weight + Trt,<br/>                  span=0.7, id.n=0, data=GUISSONA)</span></pre><div class="kz la lb lc gt ab cb"><figure class="lx lq mp lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/c42428d847b57ef3ed8e35f437473067.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*bmJ_ejebfp8wlqrH_AWEgg.png"/></div></figure><figure class="lx lq mp lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/6748e9fdd81939ce59ed82055fbf1ff2.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*O2-iutoC29X84Og6SGcJvg.png"/></div></figure><figure class="lx lq mp lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/8acc33fe638760f976c29dd2c904fef8.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*beusWYukQSQxaH8RNcNeWg.png"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk mq di mr mk translated">重量看起来正常，时间肯定有一些峰值，需要使用数据中包含的变量来处理。除了已经知道的，其余的并没有显示出令人印象深刻的相关性</figcaption></figure></div><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="1cac" class="li lj in le b gy lk ll l lm ln">theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks=c(7,21,34,42))<br/>myy&lt;-scale_y_continuous(breaks = seq(0, 3, by = 0.25))<br/>ggplot(GUISSONA, aes(x=Time, y=FCR, colour=Trt, shape=Trt))+<br/>  myx+<br/>  myy+<br/>  stat_summary(fun.data=mean_se, geom="pointrange", lwd=0.75)+<br/>  stat_summary(fun.y=mean, geom="line")</span><span id="0668" class="li lj in le b gy lo ll l lm ln">myy&lt;-scale_y_continuous(breaks = seq(0, 3, by = 0.25))<br/>ggplot(GUISSONA, aes(x=as.factor(GUISSONA$Time), y=FCR, colour=Trt)) +<br/>  geom_boxplot() +<br/>  theme_bw() +<br/>  myy+<br/>  labs(title = "FCR over time", y="BW", x="Time")</span></pre><div class="kz la lb lc gt ab cb"><figure class="lx lq ml lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/9f9c09a100702a6567455c43e7ea2314.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*Ra0ycfsYWgRL6Wa_OmBcrg.png"/></div></figure><figure class="lx lq ml lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/0d6f066e2fdfb7b152e160ab1d127699.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*M2QDryJUPY3X1fR5tvTXHg.png"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk mm di mn mk translated">FRC在不同的治疗中表现更好。</figcaption></figure></div><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="1de3" class="li lj in le b gy lk ll l lm ln">histogram(~GUISSONA$FCR|GUISSONA$Trt, breaks=10)<br/>histogram(~GUISSONA$FCR|GUISSONA$Time, breaks=10)</span></pre><div class="kz la lb lc gt ab cb"><figure class="lx lq ml lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/048e29caa8cf81867110c03ef65281ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*ESTd0An6VWOX0boEQz1SKw.png"/></div></figure><figure class="lx lq ml lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/ee4050e9e382fd0dda5a2de11c8c2f4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*3xYsCsQHJzx35-EyZGvA3A.png"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk mm di mn mk translated">不是很有帮助的情节。</figcaption></figure></div><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="8410" class="li lj in le b gy lk ll l lm ln">xyplot(GUISSONA$FCR~GUISSONA$Time|GUISSONA$Trt,<br/>       panel = function(x, y, ...) {<br/>         panel.grid()<br/>         panel.xyplot(x, y)<br/>         panel.lmline(x, y, lty = 2, col="black")<br/>         panel.loess(x, y, lty = 2, col="red")<br/>         panel.abline(0, 0)<br/>       } )</span><span id="5ddd" class="li lj in le b gy lo ll l lm ln">xyplot(GUISSONA$FCR~GUISSONA$Pen|GUISSONA$Trt, # no relationship between pen &amp; FCR<br/>       panel = function(x, y, ...) {<br/>         panel.grid()<br/>         panel.xyplot(x, y)<br/>         panel.lmline(x, y, lty = 2, col="black")<br/>         panel.loess(x, y, lty = 2, col="red")<br/>         panel.abline(0, 0)<br/>       } )</span><span id="f772" class="li lj in le b gy lo ll l lm ln">xyplot(GUISSONA$FCR~GUISSONA$Number|GUISSONA$Trt, # no relationship between FCR and number of chicks in a pen<br/>       panel = function(x, y, ...) {<br/>         panel.grid()<br/>         panel.xyplot(x, y)<br/>         panel.lmline(x, y, lty = 2, col="black")<br/>         panel.loess(x, y, lty = 2, col="red")<br/>         panel.abline(0, 0)<br/>       } )</span></pre><div class="kz la lb lc gt ab cb"><figure class="lx lq mp lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/41ef4f8ed7ca2fe2b1252432b7b853a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*BrcPmmARJ9bDTLXzxCWddA.png"/></div></figure><figure class="lx lq mp lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/3fd4c935c3325b9e2bf0dc91c687ca65.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*H1HkuM0uLKr3y8GbfbotAg.png"/></div></figure><figure class="lx lq mp lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/5069b0cf177e63fe80dfcafdb0c185a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*msauilekzE-gNJspmyhZrw.png"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk mq di mr mk translated">将很难发现治疗差异，或包括方差成分。</figcaption></figure></div><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="ec5e" class="li lj in le b gy lk ll l lm ln">qqp(GUISSONA$FCR)<br/>densityplot(~GUISSONA$FCR|GUISSONA$Time, scales=list(relation="free"))<br/>bwplot(GUISSONA$FCR~as.factor(GUISSONA$Time)) # equal variance<br/>bwplot(GUISSONA$FCR~as.factor(GUISSONA$Trt)|GUISSONA$Time_fact) # equal variance over time, not big differences</span></pre><div class="kz la lb lc gt ab cb"><figure class="lx lq ml lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/a6c316f3f6830ac9563521a89b49edd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*rRB1QJfJ9rF40lvV_PIlPg.png"/></div></figure><figure class="lx lq ml lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/b685952c797b1ad7646e4ab25d3f4488.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*sl3DYfcJ-7zR6FmH43ghaA.png"/></div></figure></div><div class="ab cb"><figure class="lx lq ml lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/740d42f5bf2d58919b78de8a0de6259c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*jj3mpvJtWntV4aCvglmtJA.png"/></div></figure><figure class="lx lq ml lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/9435523e46de4309c98fa3d1408d41be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*F3TWwEOxc5m8twlDcHDB7w.png"/></div></figure></div><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="cebb" class="li lj in le b gy lk ll l lm ln">fitlm&lt;-lm(Weight~ns(Time,2)*Trt, data=GUISSONA)<br/>boxcox(fitlm,lambda=seq(-2,2,by=0.1),plotit=T)<br/>bc1&lt;-boxcox(fitlm,lambda=seq(-2,2,by=0.1),plotit=T)<br/>which.max(bc1$y)<br/>LV&lt;-bc1[1]$x[as.numeric(which.max(bc1$y))]<br/>LV</span></pre><figure class="kz la lb lc gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi ms"><img src="../Images/dc7f9f670cfa3e814c376fa63b8ac0fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DSGwEuWeJrW4RkNsgayYeQ.png"/></div></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">Box-Cox变换暗示了对数变换。</figcaption></figure><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="d0ca" class="li lj in le b gy lk ll l lm ln">densityplot(~(GUISSONA$Weight^LV-1/LV)|GUISSONA$Time, scales=list(relation="free"))</span></pre><figure class="kz la lb lc gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi mo"><img src="../Images/ddfded5464a507a5098cb67b36f49d87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C462yfTuZClZqMLzTDSXeA.png"/></div></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">看起来很好，但不能全部正常化。对于右下角的时间空间，转换并没有消除添加预测值的需要。或者使用一种<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/mixture-component-zero-inflated-and-hurdle-models-44c5e6fe5d7f">混合</a>型号。</figcaption></figure><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="f015" class="li lj in le b gy lk ll l lm ln">fitbc&lt;-lm((Weight^LV-1/LV)~ns(Time,2)*Trt, data=GUISSONA)<br/>par(mfrow=c(1,2))<br/>plot(fitlm, which=2)<br/>plot(fitbc, which=2) # not much of an improvement, but improved</span></pre><figure class="kz la lb lc gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi ms"><img src="../Images/acd09b99b675d7c90a827281aee9e852.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tTNJ8GgEGTC4BB5qu2FLcw.png"/></div></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">毫无疑问，Box-Cox变换确实有所帮助。</figcaption></figure><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="724c" class="li lj in le b gy lk ll l lm ln">summary(fitbc)</span></pre><figure class="kz la lb lc gt lq gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/0a5cd9ad1bda1a83e7717210ce8d2555.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/1*K4ypgqz4YLSOHHOi40wstQ.png"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">这就是使用Box-Cox回归模型的样子。治疗对体重没有任何作用，但我们已经从图表中知道了这一点。老实说，这个模型甚至没有必要。</figcaption></figure><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="035b" class="li lj in le b gy lk ll l lm ln">summary(fitlm)</span><span id="9b3c" class="li lj in le b gy lo ll l lm ln">fit.0&lt;-lmer(Weight~1+<br/>            (1|Pen),<br/>          data=GUISSONA)<br/>summary(fit.0) </span><span id="626d" class="li lj in le b gy lo ll l lm ln">fit&lt;-lmer(Weight~Time_center*Trt+<br/>            (Time_center|Pen),<br/>          data=GUISSONA) # almost no variance in slope <br/>summary(fit)<br/>plot(fit)<br/>Anova(fit, type=3, test.static="F")</span></pre><figure class="kz la lb lc gt lq gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/b15a192ce529103b85c1fe510d9f848d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*9XqthBSIwWme-95sIfTHsA.png"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">混动车型表现出奇的差。</figcaption></figure><figure class="kz la lb lc gt lq gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/e23cc765f7c8dbf1d1843ce0b1a2c29f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*49tnIR6UmK8HmH7E7bS-6A.png"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">还是那句话，治疗不增加任何东西。</figcaption></figure><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="750a" class="li lj in le b gy lk ll l lm ln">fit2&lt;-lmer(Weight~Time_center*Trt+<br/>            (1|Pen),<br/>          data=GUISSONA)<br/>anova(fit2, fit) # no random slope needed<br/>Anova(fit2, type=3, test.statistic="F")</span></pre><figure class="kz la lb lc gt lq gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/3fdee4216f1046fe8f67506d02974fa6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1166/format:webp/1*PdzH0k52QaWZUezq_JyavQ.png"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">我也是。</figcaption></figure><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="35c1" class="li lj in le b gy lk ll l lm ln">fit3&lt;-lmer(Weight~Time_center+Trt+<br/>             (1|Pen),<br/>           data=GUISSONA) <br/>summary(fit3)<br/>anova(fit3, fit2, fit) </span></pre><figure class="kz la lb lc gt lq gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/3c5ae17a273480791bfde060113f6387.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/format:webp/1*AhZaAJXmzpszcKLModSSMA.png"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">我也是。没有一种新型号是真正的改进。它只是在一个可以很好地模拟数据的模型中添加预测因子，但在没有治疗差异的情况下不会产生治疗差异。</figcaption></figure><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="f76c" class="li lj in le b gy lk ll l lm ln">qqp(resid(fit3))<br/>qqp(resid(fit2))</span></pre><figure class="kz la lb lc gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi my"><img src="../Images/c37ffcb7cd8ca08665ed52f764ca4fa6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9kBYUZEXSlT-fRH6n8vPQw.png"/></div></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">两个模型的残差几乎没有区别。</figcaption></figure><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="593b" class="li lj in le b gy lk ll l lm ln">xyplot(Weight ~ Time_center|Pen, data = GUISSONA, <br/>       strip = FALSE, aspect = "xy", pch = 16, cex=0.5, grid = TRUE,<br/>       panel = function(x, y, ..., subscripts) {<br/>         panel.xyplot(x, y, ...)<br/>         ypred &lt;- fitted(fit)[subscripts]<br/>         panel.lines(x, ypred, col = "black")<br/>         ypred2 &lt;- fitted(fit2)[subscripts]<br/>         panel.lines(x, ypred2, col = "blue")<br/>         ypred3 &lt;- fitted(fit3)[subscripts]<br/>         panel.lines(x, ypred3, col = "red")<br/>        },<br/>       xlab = "Time (centered)", ylab = "BW (kg)")</span></pre><figure class="kz la lb lc gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi my"><img src="../Images/0339d2791e3c07417e58888f2decf982.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tifLjBStu706k_aCwVtktQ.png"/></div></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">可以使用线性回归对数据进行建模</figcaption></figure><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="7932" class="li lj in le b gy lk ll l lm ln">influence.weight&lt;-influence(fit3, "Pen")<br/>plot(influence.weight, <br/>     which="cook", <br/>     cutoff=4/length(unique(GUISSONA$Pen))) # No influential pens</span></pre><figure class="kz la lb lc gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi my"><img src="../Images/d0cd17017cc6f837e1001af8add8d949.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uGBRXj8C-rpHbgi_TObxkQ.png"/></div></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">没有影响力的小猪。</figcaption></figure><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="450f" class="li lj in le b gy lk ll l lm ln">t.test(GUISSONA$Weight[GUISSONA$Time==7&amp;GUISSONA$Trt=="1"], <br/>       GUISSONA$Weight[GUISSONA$Time==7&amp;GUISSONA$Trt=="2"])<br/>t.test(GUISSONA$Weight[GUISSONA$Time==21&amp;GUISSONA$Trt=="1"], <br/>       GUISSONA$Weight[GUISSONA$Time==21&amp;GUISSONA$Trt=="2"])<br/>t.test(GUISSONA$Weight[GUISSONA$Time==34&amp;GUISSONA$Trt=="1"], <br/>       GUISSONA$Weight[GUISSONA$Time==34&amp;GUISSONA$Trt=="2"])<br/>t.test(GUISSONA$Weight[GUISSONA$Time==42&amp;GUISSONA$Trt=="1"], <br/>       GUISSONA$Weight[GUISSONA$Time==42&amp;GUISSONA$Trt=="2"])</span></pre><figure class="kz la lb lc gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi mz"><img src="../Images/d2ec1c245d4f3f358e892eb89759b19f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b7iTq4UYcjGY64zdj5vsgw.png"/></div></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">没有显著的t检验。顺便说一下，像这样在嵌套数据集上进行t-test是一个大禁忌。我只是想看看我是否能找到任何差异，并测试过程本身，但当然完全是胡说八道。</figcaption></figure><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="415b" class="li lj in le b gy lk ll l lm ln">wilcox.test(GUISSONA$Weight[GUISSONA$Time==7&amp;GUISSONA$Trt=="1"], <br/>            GUISSONA$Weight[GUISSONA$Time==7&amp;GUISSONA$Trt=="2"], conf.int=TRUE)</span><span id="865e" class="li lj in le b gy lo ll l lm ln">wilcox.test(GUISSONA$Weight[GUISSONA$Time==21&amp;GUISSONA$Trt=="1"],           GUISSONA$Weight[GUISSONA$Time==21&amp;GUISSONA$Trt=="2"],conf.int=TRUE) </span><span id="262d" class="li lj in le b gy lo ll l lm ln">wilcox.test(GUISSONA$Weight[GUISSONA$Time==34&amp;GUISSONA$Trt=="1"],            GUISSONA$Weight[GUISSONA$Time==34&amp;GUISSONA$Trt=="2"],conf.int=TRUE) </span><span id="d3d5" class="li lj in le b gy lo ll l lm ln">wilcox.test(GUISSONA$Weight[GUISSONA$Time==42&amp;GUISSONA$Trt=="1"],            GUISSONA$Weight[GUISSONA$Time==42&amp;GUISSONA$Trt=="2"],conf.int=TRUE)</span></pre><figure class="kz la lb lc gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi na"><img src="../Images/c0e6cca463963f5a0fa7c165a3bc2598.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BIKKOk7My34iquAnJws0SQ.png"/></div></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">T检验的非参数版本。往往非常不必要，甚至听起来相当不可行。</figcaption></figure><p id="80c3" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们做一个基线变化分析。我知道，可能是一个失败的原因，但无论如何让我们多做一点。</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="ff14" class="li lj in le b gy lk ll l lm ln">Marc$D21_7&lt;-Marc$D21-Marc$D7<br/>Marc$D34_7&lt;-Marc$D34-Marc$D7<br/>Marc$D42_7&lt;-Marc$D42-Marc$D7<br/># Day 21 - Day 7 <br/>fit_D21_D7&lt;-lm(D21_7~D7*Trt, weights = Number, data=Marc)<br/>summary(fit_D21_D7)<br/>par(mfrow = c(3, 2))<br/>plot(fit_D21_D7)<br/>influencePlot(fit_D21_D7)<br/>avPlots(lm(D21_7~D7*Trt, data=Marc))<br/>crPlots(lm(D21_7~D7+Trt, data=Marc))</span></pre><figure class="kz la lb lc gt lq gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/ec11d7ec7fdb01fcaf08c6963f8d5c79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*wLmDiBmceyoBPwI4YGi3UQ.png"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">一个试图用第7天治疗预测第21天的模型。</figcaption></figure><figure class="kz la lb lc gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi nc"><img src="../Images/2aa2751d3b92bc50a0c78548f97f2817.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D9DeRzWHd7o15pPu-4t1QA.png"/></div></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">残差看起来不错，一个大的x级异常值。</figcaption></figure><figure class="kz la lb lc gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi nc"><img src="../Images/18d196e6afead5f9c4c90a5f20fbf554.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xzSH9hD7bA1BcaMoB0149Q.png"/></div></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">现在，这是一个附加变量图或部分回归图。它显示了一个变量保持所有其他变量不变的影响。这显示了当试图预测D21_7时治疗*D7之间的关系。</figcaption></figure><figure class="kz la lb lc gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi nc"><img src="../Images/07920cd22d8aec704436aa17c1d08cb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CoBym0FW06nBK-RywKVMxA.png"/></div></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">component_residual图是部分残差图。就像附加变量图是分量残差图一样，这是一种显示两个变量之间关系的方法，同时保持其余变量不变。残差好看！</figcaption></figure><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="7c52" class="li lj in le b gy lk ll l lm ln"># Day 34 - Day 7 <br/>fit_D34_D7&lt;-lm(D34_7~D7*Trt, weights = Number, data=Marc)<br/>summary(fit_D34_D7)<br/>plot(fit_D34_D7)<br/>influencePlot(fit_D34_D7)<br/>avPlots(lm(D34_7~D7*Trt, data=Marc))<br/>crPlots(lm(D34_7~D7+Trt, data=Marc))</span></pre><div class="kz la lb lc gt ab cb"><figure class="lx lq mp lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/218c460074c687328964e164b6f75ea8.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*8rYvfzxPP0LB_RKZsvO21A.png"/></div></figure><figure class="lx lq mp lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/702c259c4bb8d4ec4a00e2ff29457fb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0F6RU0xu3bf144ZLMmxAHw.png"/></div></figure><figure class="lx lq mp lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/34fe9aa07977e14c5fa238ce603c71a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*R_8K5xZg6BrCgnbtv11b_g.png"/></div></figure></div><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="775a" class="li lj in le b gy lk ll l lm ln"># Day 42 - Day 7 <br/>fit_D42_D7&lt;-lm(D42_7~D7*Trt,weights = Number, data=Marc)<br/>summary(fit_D42_D7)<br/>plot(fit_D42_D7)<br/>influencePlot(fit_D42_D7)<br/>avPlots(lm(D42_7~D7*Trt, data=Marc))<br/>crPlots(lm(D42_7~D7+Trt, data=Marc))</span></pre><div class="kz la lb lc gt ab cb"><figure class="lx lq nd lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/cae9fdb6652c0262ba1c5f5174e6f8c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*tbxeE4tnhgPSdzcH1e9Miw.png"/></div></figure><figure class="lx lq ne lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/e575dd3b001694ac8d3afffbc2531320.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*3K5HSR3cXUyqwIKgioftxg.png"/></div></figure><figure class="lx lq nf lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/d4f81870be15cb2403af78b77b1789a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*iqIWUqHAvAtdhb8PQYf2dQ.png"/></div></figure></div><p id="b32c" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">好的，所以我们从基线分析做了一个改变，这似乎暗示了治疗的差异(强调暗示)。让我们回到box-cox变换，并尝试找到一种方法来复制我们在上面看到的。</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="5133" class="li lj in le b gy lk ll l lm ln">par(mfrow=c(2,1))<br/>fitlm&lt;-lm(FCR~ns(Time_center,2)*Trt, data=GUISSONA)<br/>boxcox(fitlm,lambda=seq(-2,2,by=0.1),plotit=T)<br/>bc1&lt;-boxcox(fitlm,lambda=seq(-2,2,by=0.1),plotit=T)<br/>which.max(bc1$y)<br/>LV&lt;-bc1[1]$x[as.numeric(which.max(bc1$y))];LV<br/>fitbc&lt;-lm((FCR^LV-1/LV)~ns(Time,2)*Trt, data=GUISSONA)<br/>fitlog&lt;-lm(log(FCR)~ns(Time,2)*Trt, data=GUISSONA)<br/>par(mfrow=c(1,3))<br/>plot(fitlm, which=2)<br/>plot(fitbc, which=2) <br/>plot(fitlog, which=2)<br/>summary(fitbc)<br/>summary(fitlm)</span></pre><div class="kz la lb lc gt ab cb"><figure class="lx lq ml lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/0b7fe7444f55657772a01e1fdd09b5a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*GUJ8f4ouYr4wUdQZSowBhQ.png"/></div></figure><figure class="lx lq ml lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/4980799c17a6306dedee048aa639fa07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*JE6T1a1zL5kAuAPjl4Odzw.png"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk mm di mn mk translated">转变似乎是必要的，而且一旦实施，似乎会有所帮助。不过，这真的没有那么令人信服。但是当你看到治疗之间完全没有区别时，你还能指望什么呢？</figcaption></figure></div><p id="0ba5" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们转到FCR。在最早的情节中就有差异的暗示。我要去看看是否真的是这样。</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="96b3" class="li lj in le b gy lk ll l lm ln">## LMER<br/>fitlmer&lt;-lmer(log(FCR)~ns(Time_center)*Trt+(Time_center|Pen), data=GUISSONA)<br/>plot(fitlmer) # bad fit <br/>summary(fitlmer) # absolutely no variance in the data<br/>plot_model(fitlmer)<br/>bwplot(resid(fitlmer)~GUISSONA$Trt)<br/>bwplot(resid(fitlmer)~GUISSONA$Pen)<br/>bwplot(resid(fitlmer)~GUISSONA$Time_fact)</span></pre><div class="kz la lb lc gt ab cb"><figure class="lx lq ml lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/87027efda0d5579dbda5dba30bf94ac1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*AHd0RdoCnwXPQwHt-kQYag.png"/></div></figure><figure class="lx lq ml lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/04a944a14fc17a4ed447748a6ad01187.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*06itKObivKK43GCBH5OaOw.png"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk mm di mn mk translated">治疗差异的暗示确实存在。</figcaption></figure></div><div class="ab cb"><figure class="lx lq ng lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/3e7354d0a8b57827c565cd9f045d0ed6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*zpkeVJj8FoZNCp7vFfTgpw.png"/></div></figure><figure class="lx lq nh lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/b5c0000eb543cf6f2883fbf93c569a49.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*x_94AV0pA-tMwNNsAiAWiQ.png"/></div></figure></div><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="a6df" class="li lj in le b gy lk ll l lm ln">## LM<br/>fitlog&lt;-lm(log(FCR)~ns(Time_center,2)*Trt, weights=Number, data=GUISSONA)<br/>summary(fitlog)<br/>par(mfrow=c(3,2))<br/>plot(fitlog)<br/>Anova(fitlog, type=3)<br/>influencePlot(fitlog)</span></pre><figure class="kz la lb lc gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi ni"><img src="../Images/57ee98260a92a278cbef972c8a29a379.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K83p4p65oSfP7NSEWUQ9gw.png"/></div></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk translated">尽管模型还有许多不足之处。</figcaption></figure><p id="ce27" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这里我们也要改变基线。也许这将创造一个更稳定的模式。然而，如果混合模型不运行，我也不会真的赌基线变化模型，但还是让我们做这个练习。</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="08cd" class="li lj in le b gy lk ll l lm ln">Marc$FCR21_7&lt;-Marc$FCR21-Marc$FCR7<br/>Marc$FCR34_7&lt;-Marc$FCR34-Marc$FCR7<br/>Marc$FCR42_7&lt;-Marc$FCR42-Marc$FCR7<br/><br/>fit_FCR21_FCR7&lt;-lm(FCR21_7~FCR7*Trt, weights = Number, data=Marc)<br/>summary(fit_FCR21_FCR7)<br/>par(mfrow=c(3,2))<br/>plot(fit_FCR21_FCR7)<br/>influencePlot(fit_FCR21_FCR7)<br/>par(mfrow=c(3,1))<br/>avPlots(lm(FCR21_7~FCR7*Trt, data=Marc,id.n=3, id.cex=0.75))<br/>par(mfrow=c(3,1))<br/>crPlots(lm(FCR21_7~FCR7+Trt, data=Marc,span=0.7))<br/>dev.off()<br/>qqPlot(fit_FCR21_FCR7, labels=row.names(Marc), id.n=3)<br/>influenceIndexPlot(fit_FCR21_FCR7, vars=c("Cook", "hat"), id.n=3)<br/>spreadLevelPlot(fit_FCR21_FCR7)<br/>ncvTest(fit_FCR21_FCR7)<br/>summary(powerTransform(fit_FCR21_FCR7))</span></pre><div class="kz la lb lc gt ab cb"><figure class="lx lq nj lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/9874cf707056742ed81fbc19d526da7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/1*aPMbZh28aqQR9drfeg_GrA.png"/></div></figure><figure class="lx lq nk lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/150aedb3e97de23dbcbfa17a9e7bc5dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*DuEWVxDkGz0VeOB-wKgc5Q.png"/></div></figure><figure class="lx lq nl lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/4f5b0978a7af4073f9f34ae798350dab.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/format:webp/1*Ez5yIhORapvrfawGzUJPZQ.png"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk nm di nn mk translated">看起来更好，但没有治疗差异。</figcaption></figure></div><div class="ab cb"><figure class="lx lq mp lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/025e5823b766fdb302f76e987edddcdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*K8aRmmXEmh5SNXHgAEWcPQ.png"/></div></figure><figure class="lx lq mp lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/5253155511d6d3a41168b3422e2a1c54.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*62JdEGdnuL3XsJNxoUHA0w.png"/></div></figure><figure class="lx lq mp lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/51029028ca494e41352cba5a01c147dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*OSQAOWOQNXS2GfVZnUZGww.png"/></div></figure></div><figure class="kz la lb lc gt lq gh gi paragraph-image"><div class="gh gi no"><img src="../Images/e3760cb21cc6222be02a1428fd5e5b83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*nPLh6nk04Rp0FEo734BWTg.png"/></div></figure><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="91c2" class="li lj in le b gy lk ll l lm ln"># Day 34 - Day 7 <br/>fit_FCR34_FCR7&lt;-lm(FCR34_7~FCR7*Trt, weights = Number, data=Marc)<br/>summary(fit_FCR34_FCR7)<br/>par(mfrow=c(3,2))<br/>plot(fit_FCR34_FCR7)<br/>influencePlot(fit_FCR34_FCR7)<br/>par(mfrow=c(3,1))<br/>avPlots(lm(FCR34_7~FCR7*Trt, data=Marc,id.n=3, id.cex=0.75))<br/>par(mfrow=c(3,1))<br/>crPlots(lm(FCR34_7~FCR7+Trt, data=Marc, span=0.7))<br/>dev.off()<br/>qqPlot(fit_FCR34_FCR7, labels=row.names(Marc), id.n=3)<br/>influenceIndexPlot(fit_FCR34_FCR7, vars=c("Cook", "hat"), id.n=3)<br/>spreadLevelPlot(fit_FCR34_FCR7)<br/>ncvTest(fit_FCR34_FCR7)<br/>summary(powerTransform(fit_FCR34_FCR7))</span></pre><div class="kz la lb lc gt ab cb"><figure class="lx lq mp lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/30325bf8339dacdeca1a6679601988b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*OH_ZlEGP6sVDa0LxNahQkQ.png"/></div></figure><figure class="lx lq mp lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/4756e51e4d3ea0456762abc23bc5a091.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*-3_qc_xBgoI1FEqtwnEQyQ.png"/></div></figure><figure class="lx lq mp lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/f8419e7f5037a488714543fc235f586d.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*DKmDEmC9TMjBzLIJUq54mg.png"/></div></figure></div><div class="ab cb"><figure class="lx lq mp lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/ba8cb4fa5940ba943dafc8099c88e231.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*DGcOFnsO_KpTPR51iW0pEQ.png"/></div></figure><figure class="lx lq mp lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/db020b9e582134ab59af2510f5873074.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*w1GQBo8KSxZtNV6I-KA9oQ.png"/></div></figure><figure class="lx lq mp lz ma mb mc paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/f0018f401be7a7c44bbdc8b11b4f77e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*1B_-KnUFWPV7mYZkd9uUzQ.png"/></div></figure></div><figure class="kz la lb lc gt lq gh gi paragraph-image"><div class="gh gi np"><img src="../Images/4c50d47a8e4f45b8fd15bb8d7882d4c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1118/format:webp/1*YX2lK-lbc8QrujSNhVG1-Q.png"/></div></figure><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="ea45" class="li lj in le b gy lk ll l lm ln"># Day 42 - Day 7 <br/>fit_FCR42_FCR7&lt;-lm(FCR42_7~FCR7*Trt, weights = Number, data=Marc)<br/>summary(fit_FCR42_FCR7)<br/>plot(fit_FCR42_FCR7)<br/>influencePlot(fit_FCR42_FCR7)<br/>avPlots(lm(FCR34_7~FCR7*Trt, data=Marc,id.n=3, id.cex=0.75))<br/>crPlots(lm(FCR34_7~FCR7+Trt, data=Marc, span=0.7))<br/>qqPlot(fit_FCR42_FCR7, labels=row.names(Marc), id.n=3)<br/>influenceIndexPlot(fit_FCR42_FCR7, vars=c("Cook", "hat"), id.n=3)<br/>spreadLevelPlot(fit_FCR42_FCR7)<br/>ncvTest(fit_FCR42_FCR7)</span><span id="afd8" class="li lj in le b gy lo ll l lm ln"># ROBUST REGRESSION<br/># Day 21 - Day 7 <br/>fit_RR_FCR21_FCR7&lt;-rlm(FCR21_7~FCR7*Trt, weights = Number, data=Marc)<br/>summary(fit_RR_FCR21_FCR7)<br/>f.robftest(fit_RR_FCR21_FCR7, var = "Trt2")<br/>plot(fit_RR_FCR21_FCR7)<br/>influencePlot(fit_RR_FCR21_FCR7)<br/>avPlots(lm(FCR21_7~FCR7*Trt, data=Marc))<br/>crPlots(lm(FCR21_7~FCR7+Trt, data=Marc))</span><span id="7deb" class="li lj in le b gy lo ll l lm ln"># Day 34 - Day 7 <br/>fit_RR_FCR34_FCR7&lt;-rlm(FCR34_7~FCR7*Trt, weights = Number, data=Marc)<br/>summary(fit_RR_FCR34_FCR7)<br/>f.robftest(fit_RR_FCR34_FCR7, var = "Trt2")<br/>plot(fit_RR_FCR34_FCR7)<br/>influencePlot(fit_RR_FCR34_FCR7)<br/>avPlots(lm(FCR34_7~FCR7*Trt, data=Marc))<br/>crPlots(lm(FCR34_7~FCR7+Trt, data=Marc))</span><span id="c5d2" class="li lj in le b gy lo ll l lm ln"># Day 42 - Day 7 <br/>fit_RR_FCR42_FCR7&lt;-rlm(FCR42_7~FCR7*Trt, weights = Number, data=Marc)<br/>summary(fit_RR_FCR42_FCR7)<br/>f.robftest(fit_RR_FCR42_FCR7, var = "Trt2")<br/>plot(fit_RR_FCR42_FCR7)<br/>influencePlot(fit_RR_FCR42_FCR7)<br/>avPlots(lm(D42_7~FCR7*Trt, data=Marc))<br/>crPlots(lm(D42_7~FCR7+Trt, data=Marc))<br/>summary(rlm(FCR42_7~FCR7*Trt, data=Marc)) # difference in value at day 42 between treatments, setting level at day 7 at mean</span></pre><p id="ba15" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">其余的也什么都没显示。因此，尽管我们从最初的情节中知道了结果，我们还是做了大量的工作。有时候，作为一名研究人员，你必须抵制住诱惑，提前收工。</p><p id="cc1d" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我希望你喜欢这篇文章！</p></div></div>    
</body>
</html>