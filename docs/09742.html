<html>
<head>
<title>Building a backbone for a full-stack web app with a single config file</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用单个配置文件构建全栈 web 应用的主干</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/building-a-backbone-for-a-full-stack-web-app-with-a-single-config-file-aab27b866a5e?source=collection_archive---------4-----------------------#2022-09-09">https://blog.devgenius.io/building-a-backbone-for-a-full-stack-web-app-with-a-single-config-file-aab27b866a5e?source=collection_archive---------4-----------------------#2022-09-09</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="045a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将构建一个 web 应用程序来解决每个开发人员最常见的问题——为我们混乱的工作寻找借口！并将使用一个包含全栈应用架构的配置文件和几十行代码来实现。以最快的方式，所以我们不能原谅自己建造它！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/2a960561d4897608cbbd12597c58688c.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/0*GInRAUp-Os9jxE1i.png"/></div></figure><h1 id="6ad4" class="kq kr in bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">要求不明确。</h1><p id="ce30" class="pw-post-body-paragraph jk jl in jm b jn lo jp jq jr lp jt ju jv lq jx jy jz lr kb kc kd ls kf kg kh ig bi translated">我们将使用 Michele Gerarduzzi 的<a class="ae lt" href="https://github.com/michelegera/devexcuses-api" rel="noopener ugc nofollow" target="_blank">开源项目</a>。它提供了一个简单的 API 和大量预定义的借口。完全符合我们的需求。让我们定义项目的需求:</p><ul class=""><li id="d95a" class="lu lv in jm b jn jo jr js jv lw jz lx kd ly kh lz ma mb mc bi translated">该应用程序应该能够从公共 API 拉借口数据。</li><li id="4a54" class="lu lv in jm b jn md jr me jv mf jz mg kd mh kh lz ma mb mc bi translated">把你喜欢的(你老板不喜欢的)保存到数据库里，以备将来参考。</li><li id="7843" class="lu lv in jm b jn md jr me jv mf jz mg kd mh kh lz ma mb mc bi translated">开发一个应用不应该超过 15 分钟。</li><li id="9d38" class="lu lv in jm b jn md jr me jv mf jz mg kd mh kh lz ma mb mc bi translated">使用现代 web 开发技术(NodeJS + React)</li></ul><p id="9184" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因此，我们将得到一个简单而有趣的宠物项目。你可以在这里找到完整的代码库<a class="ae lt" href="https://github.com/wasp-lang/wasp/tree/main/examples/tutorials/ItWaspsOnMyMachine" rel="noopener ugc nofollow" target="_blank"/>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi mi"><img src="../Images/34999b6c9c435a34f8e50ea10412bb1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*OOA8XQW_Zs2N5H3J6CLzIA.gif"/></div></div></figure><h1 id="da3a" class="kq kr in bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">第三方库有问题。</h1><p id="5d01" class="pw-post-body-paragraph jk jl in jm b jn lo jp jq jr lp jt ju jv lq jx jy jz lr kb kc kd ls kf kg kh ig bi translated">为项目建立主干是构建任何应用程序最令人沮丧的部分。</p><p id="b210" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们正在安装依赖项，绑定后端和前端，建立数据库，管理连接字符串，等等。避免这一部分将节省我们大量的时间和精力。因此，让我们为自己找一个借口，跳过最初的项目设置。</p><p id="66ca" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">理想情况下——使用一个框架，该框架将使用最佳默认值快速创建项目基础设施，这样我们就可以专注于业务逻辑。一个完美的候选人是<a class="ae lt" href="https://wasp-lang.dev/" rel="noopener ugc nofollow" target="_blank">黄蜂</a>。它是一个开源的声明式 DSL，用于在 React 和 Node.js 中构建 web 应用程序，没有样板文件</p><p id="4326" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">工作原理:开发者从一个指定应用架构的配置文件开始。路由、CRUD API、auth 等等。然后为特定的业务逻辑添加 React/Node.js 代码。在幕后，Wasp 编译器将生成应用程序的完整源代码——后端、前端、部署模板、数据库迁移，以及您在任何其他全栈应用程序中曾经拥有的一切。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi mn"><img src="../Images/89c107c08c51c627d98c8a78f6d9eae1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gMRGmezoleMqFOe7.png"/></div></div></figure><p id="ef8c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">所以让我们直接开始吧。</p><h1 id="0b59" class="kq kr in bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">也许是环境出了问题。</h1><p id="4b01" class="pw-post-body-paragraph jk jl in jm b jn lo jp jq jr lp jt ju jv lq jx jy jz lr kb kc kd ls kf kg kh ig bi translated">Wasp 有意使用 LTS Node.js 版本，因为它保证了稳定性和主动维护。至于现在，它是节点 16 和 NPM 8。如果你需要其他项目的另一个节点版本——有可能使用 NVM 同时管理你计算机上的多个节点版本。</p><p id="fa00" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在 Linux 上安装 Wasp(对于 Mac/Windows，请<a class="ae lt" href="https://wasp-lang.dev/docs#2-installation" rel="noopener ugc nofollow" target="_blank">查看文档</a>):</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="8db8" class="mt kr in mp b gy mu mv l mw mx">curl -sSL https://get.wasp-lang.dev/installer.sh | sh</span></pre><p id="f80c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在让我们创建一个名为 ItWaspsOnMyMachine 的新 web 应用程序。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="a932" class="mt kr in mp b gy mu mv l mw mx">wasp new ItWaspsOnMyMachine</span></pre><p id="b371" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">更改工作目录:</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="3704" class="mt kr in mp b gy mu mv l mw mx">cd ItWaspsOnMyMachine</span></pre><p id="9635" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">启动应用程序:</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="fdca" class="mt kr in mp b gy mu mv l mw mx">wasp start</span></pre><p id="7aae" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，您的默认浏览器应该会打开，并显示一条简单的预定义文本消息。就是这样！🥳:我们已经构建并运行了一个 NodeJS + React 应用程序。目前——代码库只包含两个文件！<code class="fe my mz na mp b">main.wasp</code>是定义应用程序功能的配置文件。而<code class="fe my mz na mp b">MainPage.js</code>是前端。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi nb"><img src="../Images/e26ee242a795e9d93fdedc876152089d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JXVKbHSQsrjiB23b.png"/></div></div></figure><h1 id="766e" class="kq kr in bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">当我开发它的时候，它运行得非常好。</h1><ol class=""><li id="2a91" class="lu lv in jm b jn lo jr lp jv nc jz nd kd ne kh nf ma mb mc bi translated"><strong class="jm io">让我们给</strong> <code class="fe my mz na mp b"><strong class="jm io">main.wasp</strong></code> <strong class="jm io">文件添加一些额外的配置。所以看起来会是这样:</strong></li></ol><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="47b8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们添加了 Tailwind 来使我们的 UI 更漂亮，还添加了 Axios 来进行 API 请求。</p><p id="90db" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">此外，我们还声明了一个名为<code class="fe my mz na mp b">Excuse</code>、查询和动作的数据库实体。<code class="fe my mz na mp b">Excuse</code>实体由实体的 ID 和文本组成。</p><p id="79d8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe my mz na mp b">Queries</code>在我们需要获取/读取数据时出现，而<code class="fe my mz na mp b">actions</code>在我们需要更改/更新数据时出现。查询和动作声明都由两行组成——对包含实现的文件的引用和要操作的数据模型。你可以在的文档中找到更多信息。因此，让我们继续进行查询/操作。</p><p id="4445" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">2.<strong class="jm io">在</strong> <code class="fe my mz na mp b"><strong class="jm io">ext</strong></code> <strong class="jm io">文件夹中创建两个文件:“actions.js”和“queries.js”。</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="7ad4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们将<code class="fe my mz na mp b">saveExcuse()</code>动作添加到我们的<code class="fe my mz na mp b">actions.js</code>文件中。此操作会将我们的理由文本保存到数据库中。然后让我们在<code class="fe my mz na mp b">queries.js</code>文件中创建两个查询。首先，一个<code class="fe my mz na mp b">getExcuse</code>将调用外部 API 并获取新的借口。第二个名为<code class="fe my mz na mp b">getAllSavedExcuses</code>的程序将把我们保存到数据库中的所有借口拉出来。</p><p id="2989" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">就是这样！我们完成了后端。🎉现在，让我们在 UI 上使用这些查询/操作。</p><p id="84f6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">3.<strong class="jm io">让我们删除</strong> <code class="fe my mz na mp b"><strong class="jm io">MainPage.js</strong></code> <strong class="jm io">文件中的所有内容，并用新的用户界面替换它。</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="6dd4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们的页面由三部分组成。<code class="fe my mz na mp b">MainPage</code>、<code class="fe my mz na mp b">ExcuseList</code>和<code class="fe my mz na mp b">Excuse</code>。乍一看，这个文件似乎相当复杂。它不是，所以让我们靠近一点看。</p><p id="5240" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe my mz na mp b">Excuse</code>只是一个带有借口文本的 div，<code class="fe my mz na mp b">ExcuseList</code>检查是否有任何借口。如果列表为空–显示一条消息<code class="fe my mz na mp b">No saved excuses</code>。在其他情况下，将显示借口。</p><p id="44f1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe my mz na mp b">MainPage</code>包含当前借口的信息和已经保存的借口列表。两个按钮点击处理程序<code class="fe my mz na mp b">handleGetExcuse</code>和<code class="fe my mz na mp b">handleSaveExcuse</code>。另外，标记本身带有一些顺风的味道。</p><p id="84dc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> 4)在启动应用程序之前，我们需要执行数据库迁移，因为我们通过添加新实体更改了数据库模式。</strong></p><p id="9954" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果您在终端中运行了某个程序，请停止它并运行:</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="0164" class="mt kr in mp b gy mu mv l mw mx">wasp db migrate-dev</span></pre><p id="76db" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">系统将提示您输入迁移名称。类似<code class="fe my mz na mp b">init</code>的就可以了。现在我们可以开始应用程序了！</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="1891" class="mt kr in mp b gy mu mv l mw mx">wasp start</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi ni"><img src="../Images/e8cbf1eadbe2de0c28b6a624f1b04bdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FRR3ptulPZdK0UMS.png"/></div></div></figure><p id="beb7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，您可以点击“获取借口”按钮接收借口。并通过“保存借口”按钮将您喜欢的保存到数据库中。我们的最终项目应该是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi ni"><img src="../Images/2c6409f8bd50b3090674e821288334a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jCfFLTUE-Ge4GuI1.png"/></div></div></figure><h1 id="9a0e" class="kq kr in bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">要建造好它需要两倍的时间。</h1><p id="8265" class="pw-post-body-paragraph jk jl in jm b jn lo jp jq jr lp jt ju jv lq jx jy jz lr kb kc kd ls kf kg kh ig bi translated">现在我们可以考虑一些额外的改进。例如:</p><ul class=""><li id="2219" class="lu lv in jm b jn jo jr js jv lw jz lx kd ly kh lz ma mb mc bi translated">向实体 ID 添加唯一约束，这样我们就无法保存重复的借口。</li><li id="ef58" class="lu lv in jm b jn md jr me jv mf jz mg kd mh kh lz ma mb mc bi translated">添加异常和边缘情况处理。</li><li id="8702" class="lu lv in jm b jn md jr me jv mf jz mg kd mh kh lz ma mb mc bi translated">让标记更漂亮。</li><li id="b070" class="lu lv in jm b jn md jr me jv mf jz mg kd mh kh lz ma mb mc bi translated">优化和润色代码</li></ul><p id="1b87" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因此，我们已经能够在几分钟内构建一个带有数据库和外部 API 调用的全栈应用程序。现在我们有了一个装满所有发展需求借口的盒子。</p><p id="f9c6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你喜欢这个教程，请关注我们。更多即将推出！</p><p id="d93a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae lt" href="https://e44cy1h4s0q.typeform.com/to/ycUzQa5A" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io">我们在 Alpha(试用)！</strong> </a> → <a class="ae lt" href="https://discord.gg/rzdnErX" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io">加入我们的社区</strong> </a> → <a class="ae lt" href="https://wasp-lang.notion.site/Founding-Engineer-at-Wasp-402274568afa4d7eb7f428f8fa2c0816" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io">与我们一起工作</strong> </a></p></div></div>    
</body>
</html>