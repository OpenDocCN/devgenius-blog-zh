<html>
<head>
<title>Predicting House Prices with Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用机器学习预测房价</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/prediction-of-house-price-using-machine-learning-and-host-a-django-website-on-heroku-52d47e0425ca?source=collection_archive---------5-----------------------#2022-04-08">https://blog.devgenius.io/prediction-of-house-price-using-machine-learning-and-host-a-django-website-on-heroku-52d47e0425ca?source=collection_archive---------5-----------------------#2022-04-08</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/0b97bc38cd8506d1e7a15197f2937628.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Z8M50uE7gvleJmD0"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">在<a class="ae jz" href="https://unsplash.com/?utm_source=Hashnode&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae jz" href="https://unsplash.com/@leekos?utm_source=Hashnode&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Kostiantyn Li </a>拍摄</figcaption></figure><p id="f54d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">你将学习如何使用机器学习来预测房价，并主持一个 Django 网站。</p><p id="f7ac" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">对于模型，我们将使用 sklearn 的线性回归来创建一个基本模型，我们不会专注于提高模型的准确性，因为这篇文章主要是为了展示一个简单的端到端项目，从构建模型到部署。</p><p id="fb0b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">该数据集包含由美国人口普查局收集的有关马萨诸塞州波士顿地区住房的信息。它是从 StatLib 档案(【lib.stat.cmu.edu/datasets/boston】T4)中获得的，并在整个文献中被广泛用于基准算法。然而，这些比较主要是在 Delve 之外进行的，因此有些可疑。数据集很小，只有 506 个案例。</p><p id="60e5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">该数据最初由 Harrison d .和 Rubin feld d . l .发表于《享乐价格和对清洁空气的需求》，J. Environ。经济学与管理学，第 5 卷，81–102 页，1978 年。</p><p id="1bb0" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">变量</strong></p><p id="37a7" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在数据集的每个案例中有 14 个属性。它们是:</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="f44c" class="lh li in ld b gy lj lk l ll lm">CRIM - per capita crime rate by town<br/><br/>ZN - proportion of residential land zoned for lots over 25,000 sq.ft.<br/><br/>INDUS - proportion of non-retail business acres per town.<br/><br/>CHAS - Charles River dummy variable (1 if tract bounds river; 0 otherwise)<br/><br/>NOX - nitric oxides concentration (parts per 10 million)<br/><br/>RM - average number of rooms per dwelling<br/><br/>AGE - proportion of owner-occupied units built prior to 1940<br/><br/>DIS - weighted distances to five Boston employment centres<br/><br/>RAD - index of accessibility to radial highways<br/><br/>TAX - full-value property-tax rate per $10,000<br/><br/>PTRATIO - pupil-teacher ratio by town<br/><br/>B - 1000(Bk - 0.63)^2 where Bk is the proportion of blacks by town<br/><br/>LSTAT - % lower status of the population<br/><br/>MEDV - Median value of owner-occupied homes in $1000's (TARGET)</span></pre><ol class=""><li id="f38f" class="ln lo in kc b kd ke kh ki kl lp kp lq kt lr kx ls lt lu lv bi translated"><strong class="kc io">型号</strong></li></ol><p id="c1fe" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">导入库</strong></p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="f40c" class="lh li in ld b gy lj lk l ll lm">import numpy as np <br/>import matplotlib.pyplot as plt <br/>import pandas as pd <br/>from sklearn.linear_model import LinearRegression <br/>from sklearn.datasets import load_boston</span></pre><p id="a3a9" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">用熊猫加载和清理数据</strong></p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="97cd" class="lh li in ld b gy lj lk l ll lm">data = load_boston()<br/>for keys in data:<br/>    print(keys)</span></pre><figure class="ky kz la lb gt jo gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/df0c54018cf0744f6c8774c1974653c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/0*M-csKj8wiAJlqLiR"/></div></figure><p id="3f12" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">查看数据集的完整描述</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="4c05" class="lh li in ld b gy lj lk l ll lm">print(data.DESCR)</span></pre><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lx"><img src="../Images/eacde94861518d4522c157f9e67f12a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qfjG9VFSay_7Vf62"/></div></div></figure><p id="5403" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为了看到这些数据</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="ada9" class="lh li in ld b gy lj lk l ll lm">data</span></pre><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ly"><img src="../Images/f24a71e52edca047184c0e4cdbc80db6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*afMz7wd8diyjt__d"/></div></div></figure><p id="bd22" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">将数据转换成 pandas 数据框架，以便我们更容易理解并使用该数据框架进行数据操作</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="a170" class="lh li in ld b gy lj lk l ll lm">df = pd.DataFrame(data.data,columns = data.feature_names)<br/>df.head()</span></pre><p id="c0c8" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">来检查我们数据的形状</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="e944" class="lh li in ld b gy lj lk l ll lm">df.shape</span></pre><p id="25c9" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在为我们的数据添加目标列</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="1112" class="lh li in ld b gy lj lk l ll lm">df['MEDV'] = data.target<br/>df.head()</span></pre><p id="11a0" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io"> EDA </strong></p><p id="76ba" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">选择任何特征来探索与目标变量的关系。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="473c" class="lh li in ld b gy lj lk l ll lm">import seaborn as sns<br/>sns.set(rc={'figure.figsize':(15.7,8.27)})<br/>sns.scatterplot(data = df,x = 'RM',y = 'MEDV')<br/>plt.xlabel("Number of rooms")<br/>plt.ylabel("Median Value in $1000's")<br/>plt.show()</span></pre><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lz"><img src="../Images/6f1491c1ff71262f19527b761c701e72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Wp3oP9bDhEjtRrmv"/></div></div></figure><p id="7f07" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">创建模型</strong></p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="6a20" class="lh li in ld b gy lj lk l ll lm">model = LinearRegression() model<br/>model</span></pre><p id="1fd6" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">训练我们的模型</strong></p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="6697" class="lh li in ld b gy lj lk l ll lm">model.fit(np.array(df.RM).reshape(-1,1),df.MEDV)<br/><br/>model</span></pre><p id="3f9a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">来看看我们的线性函数的系数</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="523c" class="lh li in ld b gy lj lk l ll lm">model.coef_</span></pre><p id="a5f9" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">打印函数的截距</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="e9b5" class="lh li in ld b gy lj lk l ll lm">model.intercept_</span></pre><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ma"><img src="../Images/3971dc47084406f24c768db5dc3b20f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CmZ16g0g1NpJmj-ilf5Qbw.png"/></div></div></figure><p id="1653" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">预测</strong></p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="2fe5" class="lh li in ld b gy lj lk l ll lm">x = np.array([6.25]).reshape(-1,1)<br/><br/>model.predict(x)</span></pre><p id="608c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">检查 MSE </strong></p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="8fd5" class="lh li in ld b gy lj lk l ll lm">x = np.array(df.RM).reshape(-1,1)<br/><br/>from sklearn.metrics import mean_squared_error<br/><br/>y_pred = model.predict(x)<br/><br/>y_pred</span></pre><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mb"><img src="../Images/13337a6c70bdb1a16dd6e1901d0b24dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OjxBVbhoryVnNbQZ"/></div></div></figure><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="82b6" class="lh li in ld b gy lj lk l ll lm">MSE = mean_squared_error(df.MEDV,y_pred) MSE</span></pre><p id="c0b0" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">尝试绘制拟合线</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="8f21" class="lh li in ld b gy lj lk l ll lm">sns.set(rc={'figure.figsize':(15.7,8.27)})<br/>sns.scatterplot(data = df,x = 'RM',y = 'MEDV')<br/>plt.plot(x, y_pred,color='red')<br/>plt.xlabel("Number of rooms")<br/>plt.ylabel("Median Value in $1000's")<br/>plt.show()</span></pre><p id="2c6d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">预测精度</strong></p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="a285" class="lh li in ld b gy lj lk l ll lm">#accuracy score for fitted line <br/>model.score(df.MEDV,y_pred)</span></pre><p id="7f84" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">使用 pickle 作为 houseprice.pkl 保存模型</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="896d" class="lh li in ld b gy lj lk l ll lm">import joblib<br/><br/># Save the model as a pickle in a file<br/>joblib.dump(model, 'houseprice.pkl')<br/><br/># Load the model from the file<br/>model_from_joblib = joblib.load('houseprice.pkl')<br/><br/># Use the loaded model to make predictions<br/>model_from_joblib.predict(x)</span></pre><p id="25d3" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io"> 2。网站</strong></p><p id="da61" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在我们已经保存了我们的模型，我们可以在我们的网站中使用这个模型来预测房子的价格。我们将使用 Django，简单的 HTML，CSS 和 bootstrap 创建一个简单的网站。</p><p id="b628" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们需要创建一个虚拟环境，以便我们可以在这个特定的环境中安装和存储软件包。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="2297" class="lh li in ld b gy lj lk l ll lm">py -3 -m venv env</span></pre><p id="d20d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">激活环境并安装软件包</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="c776" class="lh li in ld b gy lj lk l ll lm">.\env\Scripts\activate</span><span id="a684" class="lh li in ld b gy mc lk l ll lm">pip install django</span><span id="9f9b" class="lh li in ld b gy mc lk l ll lm">pip install sklearn</span><span id="cfb7" class="lh li in ld b gy mc lk l ll lm">pip install joblib</span></pre><p id="50aa" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们将首先使用以下代码在 django 中创建我们的项目。在下文中，我们将项目名称保留为“房价预测”</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="ca5c" class="lh li in ld b gy lj lk l ll lm">django-admin startproject housepriceprediction</span></pre><p id="3418" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">cd 到项目目录中</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="b300" class="lh li in ld b gy lj lk l ll lm">cd housepriceprediction</span></pre><p id="4d71" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在，在这个项目中，我们将创建一个名为“核心”的应用程序</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="3859" class="lh li in ld b gy lj lk l ll lm">python manage.py startapp core</span></pre><p id="8339" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">将应用添加到<a class="ae jz" href="http://settings.py" rel="noopener ugc nofollow" target="_blank"> settings.py </a>文件的 INSTALLED_APPS 列表中:</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="2874" class="lh li in ld b gy lj lk l ll lm">INSTALLED_APPS = [ <br/>'django.contrib.admin', <br/>'django.contrib.auth', <br/>'django.contrib.contenttypes', <br/>'django.contrib.sessions', <br/>'django.contrib.messages', <br/>'django.contrib.staticfiles', <br/>'core', <br/>]</span></pre><p id="1066" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">创建模板</strong></p><p id="d470" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在项目目录(根目录)中创建 templates 文件夹，并创建两个 html 文件:</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div class="gh gi md"><img src="../Images/76367f948afa22c86e5bb2bbc467ea27.png" data-original-src="https://miro.medium.com/v2/resize:fit:576/0*85NORD_oCQcrebB4"/></div></figure><p id="04dc" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">index.html ':</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="241a" class="lh li in ld b gy lj lk l ll lm">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;</span><span id="4e80" class="lh li in ld b gy mc lk l ll lm">&lt;head&gt;<br/>    &lt;meta charset="UTF-8"&gt;<br/>    &lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&gt;<br/>    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;<br/>    &lt;title&gt;Home&lt;/title&gt;<br/>    &lt;link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous"&gt;<br/>&lt;/head&gt;</span><span id="11e4" class="lh li in ld b gy mc lk l ll lm">&lt;body&gt;<br/>    &lt;div class="card text-center" style="padding: 2rem; width: 60%; margin: 20%;background-color: #D9AFD9;<br/>    background-image: linear-gradient(0deg, #D9AFD9 0%, #97D9E1 100%);<br/>    "&gt;</span><span id="285c" class="lh li in ld b gy mc lk l ll lm">        &lt;h2 style="font-weight: 700;"&gt;Prediction of Boston House Prices&lt;/h2&gt;</span><span id="22a8" class="lh li in ld b gy mc lk l ll lm">        &lt;div class="card-body"&gt;<br/>            {% if error %}<br/>            &lt;p&gt;{{ error }}&lt;/p&gt;<br/>            {% endif %}<br/>            &lt;form action="{% url 'core:predict' %}" class="rmForm" method="POST"&gt;<br/>                {% csrf_token %}<br/>                &lt;label for="rminput"&gt;Number of Rooms: &lt;/label&gt;<br/>                &lt;input type="text" id="rminput" name="rminput"&gt;<br/>                &lt;input type="submit" class="btn btn-primary" value="Predict"&gt;<br/>            &lt;/form&gt;</span><span id="3f1c" class="lh li in ld b gy mc lk l ll lm">        &lt;/div&gt;<br/></span><span id="917f" class="lh li in ld b gy mc lk l ll lm">    &lt;/div&gt;<br/></span><span id="37a3" class="lh li in ld b gy mc lk l ll lm">&lt;/body&gt;</span><span id="87da" class="lh li in ld b gy mc lk l ll lm">&lt;/html&gt;</span></pre><p id="fb42" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">result.html ':</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="e814" class="lh li in ld b gy lj lk l ll lm">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;</span><span id="7bf1" class="lh li in ld b gy mc lk l ll lm">&lt;head&gt;<br/>    &lt;meta charset="UTF-8"&gt;<br/>    &lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&gt;<br/>    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;<br/>    &lt;title&gt;Result&lt;/title&gt;<br/>    &lt;link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous"&gt;</span><span id="51e8" class="lh li in ld b gy mc lk l ll lm">&lt;/head&gt;</span><span id="98eb" class="lh li in ld b gy mc lk l ll lm">&lt;body&gt;</span><span id="ceda" class="lh li in ld b gy mc lk l ll lm">    &lt;div class="card text-center" style="padding: 22.2%; background-color: #8EC5FC;<br/>    background-image: linear-gradient(62deg, #8EC5FC 0%, #E0C3FC 100%);<br/>    "&gt;</span><span id="b88f" class="lh li in ld b gy mc lk l ll lm">        &lt;h2 style="font-weight: 800;"&gt;Result: ${{result}} thousands&lt;/h2&gt;</span><span id="3c58" class="lh li in ld b gy mc lk l ll lm">        &lt;span&gt;&lt;a href="{% url 'core:index' %}" class="btn"&gt;Go back&lt;/a&gt;&lt;/span&gt;</span><span id="baa9" class="lh li in ld b gy mc lk l ll lm">    &lt;/div&gt;<br/></span><span id="12cf" class="lh li in ld b gy mc lk l ll lm">&lt;/body&gt;</span><span id="64cc" class="lh li in ld b gy mc lk l ll lm">&lt;/html&gt;</span></pre><p id="bdfd" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">接下来，通过在模板列表中添加“TEMPLATE_DIR ”,在<a class="ae jz" href="http://settings.py" rel="noopener ugc nofollow" target="_blank"> settings.py </a>中添加模板的路径:</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="029c" class="lh li in ld b gy lj lk l ll lm">TEMPLATES = [<br/>    {<br/>        'BACKEND': 'django.template.backends.django.DjangoTemplates',<br/>        'DIRS': [TEMPLATE_DIR],<br/>        'APP_DIRS': True,<br/>        'OPTIONS': {<br/>            'context_processors': [<br/>                'django.template.context_processors.debug',<br/>                'django.template.context_processors.request',<br/>                'django.contrib.auth.context_processors.auth',<br/>                'django.contrib.messages.context_processors.messages',<br/>            ],<br/>        },<br/>    },<br/>]</span></pre><p id="daf5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">加载模型并将其用于预测</strong></p><p id="25f5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如下所示，在项目根文件夹中创建一个“模型”目录，并将您在上述步骤中保存的模型放入该文件夹中:</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div class="gh gi me"><img src="../Images/72cdc36a542bfadfa79c1159c7299766.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/0*zfCaCZG4SUYRNH4J"/></div></figure><p id="e079" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在'<a class="ae jz" href="http://views.py" rel="noopener ugc nofollow" target="_blank"> views.py </a>'文件中创建视图。在这里，我们使用 joblib 加载我们的模型，然后使用该模型进行预测:</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="6433" class="lh li in ld b gy lj lk l ll lm">from django.shortcuts import render</span><span id="9e9b" class="lh li in ld b gy mc lk l ll lm"># Create your views here.<br/>import joblib<br/>import numpy as np<br/></span><span id="77f4" class="lh li in ld b gy mc lk l ll lm">model_from_joblib = joblib.load('model/houseprice.pkl')<br/></span><span id="be79" class="lh li in ld b gy mc lk l ll lm">def index(request):<br/>    return render(request,'index.html')</span><span id="e244" class="lh li in ld b gy mc lk l ll lm">def predict(request):<br/>    try:<br/>        nosrm = [request.POST.get('rminput')]<br/>        # print(nosrm)<br/>        # print(type(nosrm))                  #get the sentence <br/>        x = np.array([nosrm], dtype=float).reshape(-1,1)  #convert the number of rooms to float</span><span id="4dc5" class="lh li in ld b gy mc lk l ll lm">        # Use the loaded model to make predictions<br/>        prediction = model_from_joblib.predict(x)<br/>        prediction = format(prediction[0], '.3f')  # format to 3 decimals</span><span id="8a39" class="lh li in ld b gy mc lk l ll lm">        context = {'result': prediction, 'rooms': x}<br/>    except:<br/>        context = {'error': 'Please enter the number of rooms'}<br/>        return render(request, 'index.html', context)</span><span id="8e65" class="lh li in ld b gy mc lk l ll lm">    return render(request,'result.html',context)</span></pre><p id="f9bb" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在应用程序目录内，即我们示例中的“核心”文件夹，创建一个名为“<a class="ae jz" href="http://urls.py" rel="noopener ugc nofollow" target="_blank"> urls.py </a>”的文件，并粘贴以下代码以创建预测视图的 url:</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/f7b11a75645da6c7966afef40488b338.png" data-original-src="https://miro.medium.com/v2/resize:fit:484/0*W2HhyIqHv0vv9GtQ"/></div></figure><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="bd05" class="lh li in ld b gy lj lk l ll lm">from django.urls import path<br/>from .views import index, predict</span><span id="33e0" class="lh li in ld b gy mc lk l ll lm">app_name = 'core'</span><span id="4287" class="lh li in ld b gy mc lk l ll lm">urlpatterns = [<br/>    path('',index,name='index'),<br/>    path('predict/', predict, name='predict'),<br/>]</span></pre><p id="8a91" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">转到项目目录的'<a class="ae jz" href="http://urls.py" rel="noopener ugc nofollow" target="_blank"> urls.py </a>'文件，并包含我们在核心中创建的 url:</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="7118" class="lh li in ld b gy lj lk l ll lm">from django.contrib import admin<br/>from django.urls import path, include</span><span id="4660" class="lh li in ld b gy mc lk l ll lm">urlpatterns = [<br/>    path('admin/', admin.site.urls),<br/>    path('', include('core.urls')),<br/>]</span></pre><p id="cf71" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">部署在 Heroku </strong></p><p id="717d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">首先安装以下模块</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="5eca" class="lh li in ld b gy lj lk l ll lm">pip install gunicorn</span><span id="7166" class="lh li in ld b gy mc lk l ll lm">pip install whitenoise</span><span id="751a" class="lh li in ld b gy mc lk l ll lm">pip install dj-database-url</span><span id="c163" class="lh li in ld b gy mc lk l ll lm">pip install psycopg2</span></pre><p id="a5fb" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">将 env 中安装的所有依赖项添加到 requirements.txt 中，</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="249e" class="lh li in ld b gy lj lk l ll lm">pip freeze &gt; requirements.txt</span></pre><p id="b3ab" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">创建 Procfile</p><p id="7bf2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在 Procfile 中:housepriceprediction 是一个项目名称</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="2815" class="lh li in ld b gy lj lk l ll lm">web: gunicorn housepriceprediction.wsgi —log-file -</span></pre><p id="c99e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Make runtime.txt，所有这些文件(requirements.txt、Procfile 和 runtime.txt)应该在根目录中(在 housepriceprediction 中)</p><p id="619c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">runtime.txt:</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="4b5f" class="lh li in ld b gy lj lk l ll lm">python-3.9.11</span></pre><p id="3c2a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在<a class="ae jz" href="https://devcenter.heroku.com/" rel="noopener ugc nofollow" target="_blank">devcenter.heroku.com</a>中检查支持的版本</p><p id="8b8a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为了在 heroku 上托管一个网站，我们需要在 heroku 上创建一个帐户，并下载和设置 heroku CLI</p><p id="a545" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">做一个 heroku 账户。下载 Heroku CLI iii。配置 Django Heroku:</p><p id="d660" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们将使用 git 在 heroku 上添加文件</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="18ba" class="lh li in ld b gy lj lk l ll lm">git init</span><span id="8de5" class="lh li in ld b gy mc lk l ll lm">git add .</span><span id="59a2" class="lh li in ld b gy mc lk l ll lm">git commit -m "First commit"</span></pre><p id="cf2d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">通过输入命令行登录 heroku</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="f365" class="lh li in ld b gy lj lk l ll lm">heroku login</span></pre><p id="732c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">创建网站名称</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="4d0f" class="lh li in ld b gy lj lk l ll lm">heroku create housepprediction</span><span id="1191" class="lh li in ld b gy mc lk l ll lm">heroku config:set DISABLE_COLLECTSTATIC=1</span></pre><p id="99d2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在<a class="ae jz" href="http://settings.py" rel="noopener ugc nofollow" target="_blank"> settings.py </a>中:</p><p id="ac5b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">添加到中间件的<a class="ae jz" href="http://settings.py" rel="noopener ugc nofollow" target="_blank"> settings.py </a>文件中</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="ab45" class="lh li in ld b gy lj lk l ll lm">DEBUG = False<br/>ALLOWED_HOSTS = ['housepprediction.herokuapp.com', 'localhost', '127.0.0.1'] <br/><br/><br/>MIDDLEWARE = [<br/>  # 'django.middleware.security.SecurityMiddleware',<br/>  'whitenoise.middleware.WhiteNoiseMiddleware',<br/><br/>]</span></pre><p id="f1a7" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果用户想要使用 heroku 中的数据库，在<a class="ae jz" href="http://settings.py" rel="noopener ugc nofollow" target="_blank"> settings.py </a>中指定以下内容，表示您将使用默认的 heroku 数据库。</p><p id="869d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">heroku 的数据库更新</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="e5f8" class="lh li in ld b gy lj lk l ll lm">import dj_database_url<br/><br/>db_from_env = dj_database_url.config(conn_max_age=600)<br/>DATABASES['default'].update(db_from_env)</span></pre><p id="1a97" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">使用以下命令在 heroku 上进行迁移(如果我们不想在我们的网站上进行更改或使用数据库，这是不必要的)</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="c9e2" class="lh li in ld b gy lj lk l ll lm">heroku run python manage.py makemigrations</span><span id="62c1" class="lh li in ld b gy mc lk l ll lm">heroku run python manage.py migrate</span></pre><p id="1ff4" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在最后把文件推给 heroku</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="2a94" class="lh li in ld b gy lj lk l ll lm">git push heroku master</span></pre><p id="1460" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">从终端打开网站如下，你也可以直接从你的 heroku 帐户仪表板打开。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="c4fc" class="lh li in ld b gy lj lk l ll lm">heroku open</span></pre><p id="6889" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们的机器学习项目终于完成了。</p><p id="4d05" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果你想更新你的网站或者改进你的模型，你可以先修改本地文件，然后再推送到 heroku。这将更新 heroku 上的文件，并显示更新的网站。</p><p id="3f8e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为此，我们将再次使用 git 来推送我们编辑过的文件:</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="84db" class="lh li in ld b gy lj lk l ll lm">git add .</span><span id="a65a" class="lh li in ld b gy mc lk l ll lm">git commit -m "edited "</span><span id="2b35" class="lh li in ld b gy mc lk l ll lm">git push heroku master</span></pre><p id="314e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">点击这里查看我在 heroku 上的最终结果。</p><p id="1840" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我的 github <a class="ae jz" href="https://github.com/Ugyenwangdi/BostonHousePredicton" rel="noopener ugc nofollow" target="_blank">链接</a></p></div><div class="ab cl mg mh hr mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ig ih ii ij ik"><p id="854c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="mn">原发布于</em><a class="ae jz" href="https://wulfi.hashnode.dev/prediction-of-house-price-using-machine-learning-and-host-a-django-website-on-heroku" rel="noopener ugc nofollow" target="_blank"><em class="mn">https://wulfi . hash node . dev</em></a><em class="mn">。</em></p></div></div>    
</body>
</html>