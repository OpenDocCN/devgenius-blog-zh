<html>
<head>
<title>Send Emails without Backend in Flutter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">发送没有后端的电子邮件</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/send-emails-without-backend-in-flutter-48d0c506ab4c?source=collection_archive---------0-----------------------#2021-12-25">https://blog.devgenius.io/send-emails-without-backend-in-flutter-48d0c506ab4c?source=collection_archive---------0-----------------------#2021-12-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="7494" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我试图建立一个与旋舞的联系形式，我正在寻找一个自由和简单的方式，通知发送者和接收者都通过电子邮件的联系信息。虽然有两种方法可以实现这一点，但我发现这是最简单的一种，它也适用于Android、iOS和Web，因此我想把它分享给大家。</p></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><p id="4dc5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我准备了这个基本的<code class="fe ks kt ku kv b"><strong class="jp ir">Form</strong></code> UI，其中有三个<code class="fe ks kt ku kv b"><strong class="jp ir">TextFormField</strong></code> s，分别是Name、Email和Message，后面跟一个<code class="fe ks kt ku kv b"><strong class="jp ir">TextButton</strong></code>。</p><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi kw"><img src="../Images/464cdecc13d291c9fc59dd7eb3551550.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wK3LoJCI3f2JiV_wxMv4og.png"/></div></div></figure><pre class="kx ky kz la gt li kv lj lk aw ll bi"><span id="d80e" class="lm ln iq kv b gy lo lp l lq lr">class MyHomePage extends StatelessWidget {<br/>  MyHomePage({Key? key}) : super(key: key);</span><span id="f36a" class="lm ln iq kv b gy ls lp l lq lr">final _formKey = GlobalKey&lt;FormState&gt;();<br/>  final nameController = TextEditingController();<br/>  final emailController = TextEditingController();<br/>  final messageController = TextEditingController();<br/>  <a class="ae lt" href="http://twitter.com/override" rel="noopener ugc nofollow" target="_blank">@override</a><br/>  Widget build(BuildContext context) {<br/>    return Scaffold(<br/>      backgroundColor: const Color(0xfff5f5fd),<br/>      body: Center(<br/>        child: Container(<br/>          height: 450,<br/>          width: 400,<br/>          margin: const EdgeInsets.symmetric(<br/>            horizontal: 40,<br/>            vertical: 20,<br/>          ),<br/>          padding: const EdgeInsets.symmetric(<br/>            horizontal: 40,<br/>            vertical: 20,<br/>          ),<br/>          decoration: BoxDecoration(<br/>              color: Colors.white,<br/>              borderRadius: BorderRadius.circular(10),<br/>              boxShadow: [<br/>                BoxShadow(<br/>                    offset: const Offset(0, 5),<br/>                    blurRadius: 10,<br/>                    spreadRadius: 1,<br/>                    color: Colors.grey[300]!)<br/>              ]),<br/>          child: Form(<br/>            key: _formKey,<br/>            child: Column(<br/>              mainAxisAlignment: MainAxisAlignment.spaceEvenly,<br/>              children: [<br/>                const Text('Contact Us',<br/>                    style:<br/>                        TextStyle(fontSize: 20, fontWeight: FontWeight.bold)),<br/>                TextFormField(<br/>                  controller: nameController,<br/>                  decoration: const InputDecoration(hintText: 'Name'),<br/>                  validator: (value) {<br/>                    if (value == null || value.isEmpty) {<br/>                      return '*Required';<br/>                    }<br/>                    return null;<br/>                  },<br/>                ),<br/>                TextFormField(<br/>                  controller: emailController,<br/>                  decoration: const InputDecoration(hintText: 'Email'),<br/>                  validator: (email) {<br/>                    if (email == null || email.isEmpty) {<br/>                      return 'Required*';<br/>                    } else if (!EmailValidator.validate(email)) {<br/>                      return 'Please enter a valid Email';<br/>                    }<br/>                    return null;<br/>                  },<br/>                ),<br/>                TextFormField(<br/>                  controller: messageController,<br/>                  decoration: const InputDecoration(hintText: 'Message'),<br/>                  maxLines: 5,<br/>                  validator: (value) {<br/>                    if (value == null || value.isEmpty) {<br/>                      return '*Required';<br/>                    }<br/>                    return null;<br/>                  },<br/>                ),<br/>                SizedBox(<br/>                  height: 45,<br/>                  width: 110,<br/>                  child: TextButton(<br/>                    style: TextButton.styleFrom(<br/>                        primary: Colors.white,<br/>                        backgroundColor: const Color(0xff151534),<br/>                        shape: RoundedRectangleBorder(<br/>                            borderRadius: BorderRadius.circular(40))),<br/>                    onPressed: () {<br/>                      if (_formKey.currentState!.validate()) {<br/>                        //TODO: send email<br/>                        nameController.clear();<br/>                        emailController.clear();<br/>                        messageController.clear();<br/>                      }<br/>                    },<br/>                    child: const Text('Send', style: TextStyle(fontSize: 16)),<br/>                  ),<br/>                ),<br/>              ],<br/>            ),<br/>          ),<br/>        ),<br/>      ),<br/>    );<br/>  }<br/>}</span></pre><p id="3e73" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们有三个<code class="fe ks kt ku kv b">TextEditingControllers</code>即<code class="fe ks kt ku kv b">nameController</code>、<code class="fe ks kt ku kv b">emailController</code>和<code class="fe ks kt ku kv b">messageController</code>来处理对各自TextFormFields的更改。此外，我们还有一个名为<code class="fe ks kt ku kv b">_formkey</code>的<code class="fe ks kt ku kv b">GlobalKey</code>，它唯一标识表单并将帮助验证表单。</p><p id="2409" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以参考这本烹饪书来了解更多关于在旋舞中构建一个具有验证的表单。</p><div class="lu lv gp gr lw lx"><a href="https://docs.flutter.dev/cookbook/forms/validation" rel="noopener  ugc nofollow" target="_blank"><div class="ly ab fo"><div class="lz ab ma cl cj mb"><h2 class="bd ir gy z fp mc fr fs md fu fw ip bi translated">生成具有验证的表单</h2><div class="me l"><h3 class="bd b gy z fp mc fr fs md fu fw dk translated">应用程序通常要求用户在文本字段中输入信息。例如，您可能要求用户使用…</h3></div><div class="mf l"><p class="bd b dl z fp mc fr fs md fu fw dk translated">docs . vout . dev</p></div></div><div class="mg l"><div class="mh l mi mj mk mg ml lg lx"/></div></div></a></div><p id="fa0c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意:为了验证电子邮件字段，为了简单起见，我使用了<a class="ae lt" href="https://pub.dev/packages/email_validator" rel="noopener ugc nofollow" target="_blank"><em class="mm">email _ validator</em></a>。</p></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><p id="ff30" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在发送电子邮件方面，我们将使用名为EmailJS的服务，该服务每月向<a class="ae lt" href="https://www.emailjs.com/pricing/" rel="noopener ugc nofollow" target="_blank"> <em class="mm">提供200个免费的</em> </a>请求。</p><h2 id="d39c" class="lm ln iq bd mn mo mp dn mq mr ms dp mt jy mu mv mw kc mx my mz kg na nb nc nd bi translated">设置EmailJS</h2><ol class=""><li id="d59d" class="ne nf iq jp b jq ng ju nh jy ni kc nj kg nk kk nl nm nn no bi translated">首先，你必须前往<a class="ae lt" href="https://www.emailjs.com/" rel="noopener ugc nofollow" target="_blank"><em class="mm">emailjs.com</em></a>T21并创建一个免费账户。</li></ol><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi kw"><img src="../Images/62d3c5cd3218784efbe9ecfeef6e7c37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7V69MGYVK8wiJ-rcc0d2Zw.png"/></div></div><figcaption class="np nq gj gh gi nr ns bd b be z dk translated">填写您的详细信息，然后点击“注册”</figcaption></figure><p id="7e59" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这样做之后，你会在仪表板上着陆。</p><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi kw"><img src="../Images/414d94df43147a594391c53e7ccca581.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pLCfb_TRIAFt2toZCfHadw.png"/></div></div></figure><p id="56aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.点击<strong class="jp ir">新增服务</strong>选择服务提供商，我会选择Gmail <strong class="jp ir">。</strong></p><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi kw"><img src="../Images/0e82bedb76af1268b232eac925ebe6d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jQ4994bcvLJfUYLYcZ6bLg.png"/></div></div></figure><p id="6c03" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.然后点击<strong class="jp ir">连接账户</strong>，选择你的账户，勾选“代发邮件”框，点击【继续】。然后单击“创建服务”。</p><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi kw"><img src="../Images/f89573cbf156706759d710ea887de17d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mapFtlVLdI7P42GswLOsbQ.png"/></div></div><figcaption class="np nq gj gh gi nr ns bd b be z dk translated">点击<strong class="bd mn">连接账户</strong></figcaption></figure><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi nt"><img src="../Images/5088877bcae5ce64a4ad570e9f272425.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Lc2rt2lptCJibyVHtwyYA.png"/></div></div></figure><p id="79b0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.接下来，转到电子邮件模板标签，然后<strong class="jp ir">创建新模板</strong>。</p><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi kw"><img src="../Images/842c7f4285db9b67aebac384b3b2025c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gLrJSH1qie4-An5Iv7o6Nw.png"/></div></div></figure><p id="2e47" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">5.自定义此电子邮件模板的方式，你想。例如，我在“答复”部分中添加了发件人的电子邮件。然后点击<strong class="jp ir">保存。</strong></p><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi kw"><img src="../Images/f776691249f19753597acc9a82ee4d66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hjzR0jFsDIqS1fQGM6r06g.png"/></div></div></figure><h2 id="261f" class="lm ln iq bd mn mo mp dn mq mr ms dp mt jy mu mv mw kc mx my mz kg na nb nc nd bi translated">回归准则</h2><p id="fb32" class="pw-post-body-paragraph jn jo iq jp b jq ng js jt ju nh jw jx jy nu ka kb kc nv ke kf kg nw ki kj kk ij bi translated">现在我们将创建一个名为<code class="fe ks kt ku kv b">sendEmail()</code>的新函数，它将返回一个<code class="fe ks kt ku kv b">Future</code>，我们将调用发送按钮的<code class="fe ks kt ku kv b">onPressed</code>内部。</p><pre class="kx ky kz la gt li kv lj lk aw ll bi"><span id="db63" class="lm ln iq kv b gy lo lp l lq lr">Future sendEmail(String name, String email, String message) async {<br/>  final url = Uri.parse('<a class="ae lt" href="https://api.emailjs.com/api/v1.0/email/send'" rel="noopener ugc nofollow" target="_blank">https://api.emailjs.com/api/v1.0/email/send'</a>);<br/>  const serviceId = 'YOUR_SERVICE_ID';<br/>  const templateId = 'YOUR_TEMPLATE_ID';<br/>  const userId = 'YOUR_USER_ID';<br/>  final response = await http.post(url,<br/>      headers: {'Content-Type': 'application/json'},//This line makes sure it works for all platforms.<br/>      body: json.encode({<br/>        'service_id': serviceId,<br/>        'template_id': templateId,<br/>        'user_id': userId,<br/>        'template_params': {<br/>          'from_name': name,<br/>          'from_email': email,<br/>          'message': message<br/>        }<br/>      }));<br/>  return response.statusCode;<br/>}</span></pre><p id="6481" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在template_params中，请确保指定模板中包含的所有参数。我的情况是<code class="fe ks kt ku kv b">from_name</code>、<code class="fe ks kt ku kv b">from_email</code>和<code class="fe ks kt ku kv b">message</code>。</p><p id="3b92" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">用各自的id替换<code class="fe ks kt ku kv b">serviceId</code>、<code class="fe ks kt ku kv b">templateId</code>和<code class="fe ks kt ku kv b">userId</code>。你可以在这里找到它们:</p><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi nx"><img src="../Images/4c11e1f783119fe1e62d6246751b9bb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kzgd7vTbfE4PJ9B3vl3Ucg.png"/></div></div></figure><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi ny"><img src="../Images/c90a3144bc56e4fec192e44d35f3e58d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TtSybnGssZCfgKlX2mlhog.png"/></div></div></figure><blockquote class="nz oa ob"><p id="37ac" class="jn jo mm jp b jq jr js jt ju jv jw jx oc jz ka kb od kd ke kf oe kh ki kj kk ij bi translated"><strong class="jp ir">更新</strong>:‘整合’页面已从仪表板中移除。API键移至“帐户”页面。“用户ID”重命名为“公钥”。已将“访问令牌”重命名为“私钥”。</p></blockquote><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi of"><img src="../Images/326b02ac6fe849d9a7032d6c1e107cc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eHX_t_W5FX9i7G6_jIKVZg.png"/></div></div><figcaption class="np nq gj gh gi nr ns bd b be z dk translated">更新了查找用户ID的SS</figcaption></figure><p id="6132" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mm">为了增加安全性，您可以将域列入白名单，这将限制API调用到指定的域，然而，这碰巧是一个付费功能。</em></p><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi kw"><img src="../Images/8b70e09970a1a4840441ba9340947592.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qwfUPiWg4NySRo2JZO0JAw.png"/></div></div></figure><p id="2380" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不要忘记在<code class="fe ks kt ku kv b">pubspec.yaml</code>文件的依赖项下添加<code class="fe ks kt ku kv b">http</code>，我们将需要它来发出post请求。</p><p id="80fe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在在<code class="fe ks kt ku kv b">onPressed</code>中，如果所有的字段都被验证，我们将调用<code class="fe ks kt ku kv b">sendEmail()</code>函数，该函数将发出post请求并返回<code class="fe ks kt ku kv b">statusCode</code>。我们将检查请求是否成功，即<code class="fe ks kt ku kv b">statusCode==200</code>，并显示一个带有成功消息的SnackBar，否则，显示一个带有失败消息的SnackBar。</p><pre class="kx ky kz la gt li kv lj lk aw ll bi"><span id="badc" class="lm ln iq kv b gy lo lp l lq lr">onPressed: () async {<br/>                      if (_formKey.currentState!.validate()) {<br/>                        final response = await sendEmail(<br/>                            nameController.value.text,<br/>                            emailController.value.text,<br/>                            messageController.value.text);<br/>                        ScaffoldMessenger.of(context).showSnackBar(<br/>                          response == 200<br/>                              ? const SnackBar(<br/>                                  content: Text('Message Sent!'),<br/>                                  backgroundColor: Colors.green)<br/>                              : const SnackBar(<br/>                                  content: Text('Failed to send message!'),<br/>                                  backgroundColor: Colors.red),<br/>                        );<br/>                        nameController.clear();<br/>                        emailController.clear();<br/>                        messageController.clear();<br/>                      }<br/>                    },</span></pre><figure class="kx ky kz la gt lb gh gi paragraph-image"><div class="gh gi og"><img src="../Images/4c55512cc7c519b2e2a75a226bfadd77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*8MG7w7nsZG-S8SWnCFBsrQ.gif"/></div></figure><p id="9ff7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们完事了。本教程到此为止。你可以在我的GitHub上找到完整的代码。</p><div class="lu lv gp gr lw lx"><a href="https://github.com/Aaliya-Ali/contact_form_flutter" rel="noopener  ugc nofollow" target="_blank"><div class="ly ab fo"><div class="lz ab ma cl cj mb"><h2 class="bd ir gy z fp mc fr fs md fu fw ip bi translated">GitHub-aa liya-Ali/contact _ form _ flutter</h2><div class="me l"><h3 class="bd b gy z fp mc fr fs md fu fw dk translated">一个新的颤振项目。这个项目是颤振应用的起点。一些帮助您入门的资源…</h3></div><div class="mf l"><p class="bd b dl z fp mc fr fs md fu fw dk translated">github.com</p></div></div><div class="mg l"><div class="oh l mi mj mk mg ml lg lx"/></div></div></a></div><p id="a35e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">详细解释参考约翰内斯·米尔克的惊艳视频。</p><figure class="kx ky kz la gt lb"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="c75a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我希望这篇文章能帮助你学到一些新东西，如果有的话，别忘了留下一些掌声，它激励我继续写作。有建议？请在评论中告诉我。快乐学习！</p></div></div>    
</body>
</html>