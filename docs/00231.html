<html>
<head>
<title>Learn Angular 9 by building a fintech application with Tailwind CSS — 2. Login form</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过使用 Tailwind CSS-2 构建 fintech 应用程序来学习 Angular 9。登录表单</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/learn-angular-9-by-building-a-fintech-application-with-tailwind-css-2-login-form-b5269f9c1d51?source=collection_archive---------1-----------------------#2020-05-25">https://blog.devgenius.io/learn-angular-9-by-building-a-fintech-application-with-tailwind-css-2-login-form-b5269f9c1d51?source=collection_archive---------1-----------------------#2020-05-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/a89b2582d2e1e143880a1a9bb33ec367.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KdOd8RqA9Sgse6a8IUxcDw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://www.duomly.com" rel="noopener ugc nofollow" target="_blank"> Duomly —编程在线课程</a></figcaption></figure><p id="eeb3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本文原载于<a class="ae kc" href="https://www.blog.duomly.com/angular-course-building-a-banking-application-with-tailwind-css-lesson-2-login-form/" rel="noopener ugc nofollow" target="_blank">https://www . blog . duomly . com/angular-course-building-a-banking-application-with-tailwind-CSS-lesson-2-log in-form/</a></p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><p id="314b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">几天前，我们发布了 Angular 课程的第一课，我们正在为银行应用程序构建前端，你可以在<a class="ae kc" href="https://www.blog.duomly.com/sql-injection-attack-tutorial-for-beginners/" rel="noopener ugc nofollow" target="_blank"> SQL 注入教程</a>中看到。</p><p id="212c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在第一课中，我们开始使用<a class="ae kc" href="https://cli.angular.io/" rel="noopener ugc nofollow" target="_blank"> Angular CLI </a>设置项目，实现<a class="ae kc" href="https://tailwindcss.com/" rel="noopener ugc nofollow" target="_blank"> TailwindCSS </a>，并为登录表单创建 UI。</p><p id="39bf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">今天，我想更进一步，为我们已经创建的组件创建逻辑。因此，如果您在上一部分中与我一起创建应用程序，那么让我们打开代码并启动应用程序。如果没有，请查看<a class="ae kc" href="https://www.blog.duomly.com/angular-course-building-a-banking-application-with-tailwind-css-lesson-1-start-the-project/" rel="noopener ugc nofollow" target="_blank">角度课程—第 1 课:启动项目</a>或查看我们的<a class="ae kc" href="https://github.com/Duomly/angular9-tailwind-bank-frontend/tree/Angular9-TailwindCSS-Course-Lesson1" rel="noopener ugc nofollow" target="_blank"> GitHub </a>并从那里获取代码。</p><p id="efae" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当然，和往常一样，如果你更喜欢看教程而不仅仅是阅读，我们会在我们的 Youtube 频道上为你准备一段视频。</p><figure class="li lj lk ll gt jr"><div class="bz fp l di"><div class="lm ln l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">双向角航向</figcaption></figure><p id="9254" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在播放列表中，您还可以找到我们为您准备的本课程的第一课和其他课。</p><p id="5f34" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">还有一件事，在后端，我将使用你可以在我们的<a class="ae kc" href="https://www.blog.duomly.com/golang-course-with-building-a-fintech-banking-app-lesson-1-start-the-project/" rel="noopener ugc nofollow" target="_blank"> Golang 课程</a>中找到的应用程序，所以你也可以创建和使用它。</p><p id="6d55" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们粉碎棱角！</p><h1 id="33a4" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">1.为登录组件创建逻辑—处理输入和验证</h1><p id="b967" class="pw-post-body-paragraph kd ke iq kf b kg mm ki kj kk mn km kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated">让我们使用<code class="fe mr ms mt mu b">ng serve</code>启动现有项目，并打开<code class="fe mr ms mt mu b">login.component.ts</code>文件。我想从创建一个函数开始，该函数将从输入中获取并保存值，以便能够在提交函数中使用它们。</p><p id="0071" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们首先定义两个值 username 和 password，并为这两个值分配一个空字符串。</p><pre class="li lj lk ll gt mv mu mw mx aw my bi"><span id="936f" class="mz lp iq mu b gy na nb l nc nd">username: string = '';<br/>password: string = '';</span></pre><p id="37f9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们将创建一个<code class="fe mr ms mt mu b">onKey()</code>函数:</p><pre class="li lj lk ll gt mv mu mw mx aw my bi"><span id="80b5" class="mz lp iq mu b gy na nb l nc nd">onKey(event: any, type: string) {<br/>    if (type === 'username') {<br/>        this.username = event.target.value;<br/>    } else if (type === 'password') {<br/>        this.password = event.target.value;<br/>    }<br/>}</span></pre><p id="dd9c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们需要为用户名字段创建一个验证来防止 SQL 注入。我的朋友向你展示了如何将 SQL 命令输入到应用程序中，我们希望避免这种情况，所以，如果用户名不仅仅是字母和数字，我们将不允许发送用户名。</p><p id="740c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们在<code class="fe mr ms mt mu b">password: string = '';</code>下创造另一个价值<code class="fe mr ms mt mu b">isUsernameValid: boolean = true;</code>。</p><pre class="li lj lk ll gt mv mu mw mx aw my bi"><span id="4969" class="mz lp iq mu b gy na nb l nc nd">isUsernameValid: boolean = true;</span></pre><p id="6517" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，让我们创建一个 validateUsername()函数。</p><pre class="li lj lk ll gt mv mu mw mx aw my bi"><span id="3970" class="mz lp iq mu b gy na nb l nc nd">validateUsername(): void {<br/>    const pattern = RegExp(/^[\w-.]*$/);<br/>    if (pattern.test(this.username)) {<br/>        this.isUsernameValid = true;    <br/>    } else {<br/>        this.isUsernameValid = false;<br/>    }<br/>}</span></pre><p id="8ed4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了让它工作，我们将这个函数放在<code class="fe mr ms mt mu b">onKey()</code>函数中。</p><pre class="li lj lk ll gt mv mu mw mx aw my bi"><span id="0617" class="mz lp iq mu b gy na nb l nc nd">onKey(event: any, type: string) {<br/>    if (type === 'username') {<br/>        this.username = event.target.value;<br/>        this.validateUsername();<br/>    } else if (type === 'password') {<br/>        this.password = event.target.value;<br/>    }<br/>}</span></pre><p id="ea90" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这一步的最后一点是在模板中实现 onKey 函数，并在用户名无效时显示错误消息。让我们打开<code class="fe mr ms mt mu b">login.component.html</code>，找到输入。</p><pre class="li lj lk ll gt mv mu mw mx aw my bi"><span id="bd54" class="mz lp iq mu b gy na nb l nc nd">&lt;form class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4"&gt;<br/>  &lt;img class="logo" src="../../assets/logo.png" /&gt;<br/>  &lt;div class="mb-4"&gt;<br/>    &lt;label class="block text-gray-700 text-sm font-bold mb-2" for="username"&gt;<br/>      Username<br/>    &lt;/label&gt;<br/>    &lt;input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="username" type="text" placeholder="Username" (keyup)="onKey($event, 'username')" required&gt;<br/>    &lt;p *ngIf="!isUsernameValid" class="text-red-500 text-xs italic"&gt;Your username can consist of letters and numbers only!&lt;/p&gt;<br/>  &lt;/div&gt;<br/>  &lt;div class="mb-6"&gt;<br/>    &lt;label class="block text-gray-700 text-sm font-bold mb-2" for="password"&gt;<br/>      Password<br/>    &lt;/label&gt;<br/>    &lt;input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline" id="password" type="password" placeholder="******************" (keyup)="onKey($event, 'password')" required minlength="6"&gt;<br/>  &lt;/div&gt;<br/>  &lt;div class="flex items-center justify-between"&gt;<br/>    &lt;button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" type="button" (click)="onSubmit()"&gt;<br/>      Sign In<br/>    &lt;/button&gt;<br/>    &lt;a class="inline-block align-baseline font-bold text-sm text-blue-500 hover:text-blue-800" href="#"&gt;<br/>      Forgot Password?<br/>    &lt;/a&gt;<br/>  &lt;/div&gt;<br/>&lt;/form&gt;</span></pre><p id="b4a6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">太好了，现在我们准备好创建服务并进行 API 调用了！</p><h1 id="2dad" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">2.如何在 Angular 中创建服务？</h1><p id="28ed" class="pw-post-body-paragraph kd ke iq kf b kg mm ki kj kk mn km kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated">让我们用 Angular CLI 来创建<code class="fe mr ms mt mu b">login.service.ts</code>。为此，我们需要以下命令:</p><p id="7105" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mr ms mt mu b">ng generate service services/login/login</code></p><p id="951e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们打开创建的服务，从导入所需的包开始。</p><pre class="li lj lk ll gt mv mu mw mx aw my bi"><span id="8385" class="mz lp iq mu b gy na nb l nc nd">import { HttpClient, HttpHeaders } from '@angular/common/http';<br/>import { BehaviorSubject } from 'rxjs';</span></pre><p id="6083" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，让我们定义一个名为 httpOptions 的常量，它将是我们的 API 请求的一部分。</p><pre class="li lj lk ll gt mv mu mw mx aw my bi"><span id="e79e" class="mz lp iq mu b gy na nb l nc nd">const httpOptions = {<br/>  headers: new HttpHeaders({<br/>    'Access-Control-Allow-Origin': '*',<br/>  })<br/>};</span></pre><p id="4de5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下一步是定义我们的 URL 并将<code class="fe mr ms mt mu b">HttpClient</code>传递给构造函数。</p><pre class="li lj lk ll gt mv mu mw mx aw my bi"><span id="e93d" class="mz lp iq mu b gy na nb l nc nd">url: any = &lt;your_api_url&gt;;</span><span id="0205" class="mz lp iq mu b gy ne nb l nc nd">  constructor(<br/>    private http: HttpClient,<br/>  ) { }</span></pre><p id="7b43" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">很好，现在我们可以开始创建登录功能了。在函数内部，我们需要处理响应。如果我们将获得一个令牌，这意味着用户已登录。我们将这些数据保存到会话存储中，以保持用户仅在会话期间登录。</p><pre class="li lj lk ll gt mv mu mw mx aw my bi"><span id="3d35" class="mz lp iq mu b gy na nb l nc nd">login(Username: string, Password: string): any {<br/>    this.http.post(this.url, { Username, Password }, httpOptions).toPromise().then((res: any) =&gt; {<br/>      if (res &amp;&amp; res.jwt) {<br/>        sessionStorage.setItem('jwt', res.jwt);<br/>      }<br/>    });<br/>  }</span></pre><p id="8c8e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">除此之外，如果登录调用将返回一个错误消息，我们需要处理它。为此，我们将使用来自<code class="fe mr ms mt mu b">rxjs</code>的<code class="fe mr ms mt mu b">behaviorSubject</code>。来实施吧！</p><pre class="li lj lk ll gt mv mu mw mx aw my bi"><span id="9ff0" class="mz lp iq mu b gy na nb l nc nd">errorSubject: any = new BehaviorSubject&lt;any&gt;(null);<br/>errorMessage: any = this.errorSubject.asObservable();</span><span id="4a14" class="mz lp iq mu b gy ne nb l nc nd">...</span><span id="e015" class="mz lp iq mu b gy ne nb l nc nd">login(Username: string, Password: string): any {<br/>    this.http.post(this.url, { Username, Password }, httpOptions).toPromise().then((res: any) =&gt; {<br/>      if (res &amp;&amp; res.jwt) {<br/>        sessionStorage.setItem('jwt', res.jwt);<br/>        this.errorSubject.next(null);<br/>      } else if (res.Message) {<br/>        this.errorSubject.next(res.Message);<br/>      }<br/>    });<br/>  }</span></pre><p id="5ec5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们从<code class="fe mr ms mt mu b">@angular/router</code>导入<code class="fe mr ms mt mu b">Router</code>，在登录到仪表板视图后重定向用户。</p><pre class="li lj lk ll gt mv mu mw mx aw my bi"><span id="aecc" class="mz lp iq mu b gy na nb l nc nd">import { Router } from '@angular/router';<br/>...<br/>constructor(<br/>  private http: HttpClient,<br/>  private router: Router,<br/>) { }</span><span id="b1a1" class="mz lp iq mu b gy ne nb l nc nd">...<br/>login(Username: string, Password: string): any {<br/>  this.http.post(this.ulr, { Username, Password }, httpOptions).toPromise().then((res: any) =&gt; {<br/>    if (res &amp;&amp; res.jwt) {<br/>      sessionStorage.setItem('jwt', res.jwt);<br/>      this.errorSubject.next(null);<br/>      this.router.navigateByUrl('dashboard');<br/>    } else if (res.Message) {<br/>      this.errorSubject.next(res.Message);<br/>    }<br/>  });<br/>}</span></pre><p id="1ae2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们让它一起工作之前，我们不能忘记将<code class="fe mr ms mt mu b">HttpClientModule</code>添加到<code class="fe mr ms mt mu b">app.module.ts</code>文件中。因此，让我们打开它，并确保您的代码看起来像下面的一个。</p><pre class="li lj lk ll gt mv mu mw mx aw my bi"><span id="fc86" class="mz lp iq mu b gy na nb l nc nd">import { BrowserModule } from '@angular/platform-browser';<br/>import { NgModule } from '@angular/core';<br/>import { HttpClientModule } from '@angular/common/http';</span><span id="3703" class="mz lp iq mu b gy ne nb l nc nd">import { AppRoutingModule } from './app-routing.module';<br/>import { AppComponent } from './app.component';<br/>import { LoginComponent } from './login/login.component';<br/>import { DashboardComponent } from './dashboard/dashboard.component';</span><span id="4b1a" class="mz lp iq mu b gy ne nb l nc nd">@NgModule({<br/>  declarations: [<br/>    AppComponent,<br/>    LoginComponent,<br/>    DashboardComponent<br/>  ],<br/>  imports: [<br/>    BrowserModule,<br/>    AppRoutingModule,<br/>    HttpClientModule<br/>  ],<br/>  providers: [],<br/>  bootstrap: [AppComponent]<br/>})<br/>export class AppModule { }</span></pre><p id="ee90" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">好了，现在我们可以回到<code class="fe mr ms mt mu b">login.component.ts</code>文件，让我们使用 LoginService 创建一个<code class="fe mr ms mt mu b">onSubmit()</code>函数。当然，我们必须导入服务并将其设置在构造函数中。</p><pre class="li lj lk ll gt mv mu mw mx aw my bi"><span id="7216" class="mz lp iq mu b gy na nb l nc nd">import { LoginService } from './../services/login/login.service';</span><span id="80f2" class="mz lp iq mu b gy ne nb l nc nd">...</span><span id="9620" class="mz lp iq mu b gy ne nb l nc nd">constructor(<br/>  private loginService: LoginService,<br/>) { }</span><span id="aa92" class="mz lp iq mu b gy ne nb l nc nd">onSubmit() {<br/>  if (this.isUsernameValid) {<br/>    this.loginService<br/>      .login(this.username, this.password);<br/>  }<br/>}</span></pre><p id="787d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来我们要添加的是错误值，如果错误没有出现，我们将在这里监听。我们将在<code class="fe mr ms mt mu b">ngOnInit()</code>方法中订阅来自 LoginService 的错误消息。</p><pre class="li lj lk ll gt mv mu mw mx aw my bi"><span id="e0e6" class="mz lp iq mu b gy na nb l nc nd">error: any = null;<br/>...</span><span id="eb28" class="mz lp iq mu b gy ne nb l nc nd">  ngOnInit(): void {<br/>    this.loginService<br/>      .errorMessage<br/>      .subscribe(errorMessage =&gt; {<br/>        this.error = errorMessage;<br/>      });<br/>  }</span></pre><p id="e50c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们就快成功了，我们只需要切换到<code class="fe mr ms mt mu b">login.component.html</code>文件并向我们的模板添加值。</p><p id="875d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，让我们将<code class="fe mr ms mt mu b">onSubmit()</code>功能分配给我们的登录按钮。</p><pre class="li lj lk ll gt mv mu mw mx aw my bi"><span id="effc" class="mz lp iq mu b gy na nb l nc nd">&lt;button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" type="button" (click)="onSubmit()"&gt;<br/>  Sign In<br/>&lt;/button&gt;</span></pre><p id="3db1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来让我们填充通知元素中缺少的值。同样，让我们定义元素何时可见。</p><pre class="li lj lk ll gt mv mu mw mx aw my bi"><span id="0907" class="mz lp iq mu b gy na nb l nc nd">&lt;div *ngIf="error" class="notification bg-indigo-900 text-center py-4 lg:px-4"&gt;<br/>    &lt;div class="p-2 bg-indigo-800 items-center text-indigo-100 leading-none lg:rounded-full flex lg:inline-flex" role="alert"&gt;<br/>      &lt;span class="flex rounded-full bg-indigo-500 uppercase px-2 py-1 text-xs font-bold mr-3"&gt;ERROR&lt;/span&gt;<br/>      &lt;span class="font-semibold mr-2 text-left flex-auto"&gt;{{error}}&lt;/span&gt;<br/>    &lt;/div&gt;<br/>&lt;/div&gt;</span></pre><p id="f05d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">瞧啊。登录差不多了！现在是时候采取防范措施，防止未登录的用户进入应用程序。</p><h1 id="e524" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">3.如何在角路由中创建守卫？</h1><p id="3319" class="pw-post-body-paragraph kd ke iq kf b kg mm ki kj kk mn km kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated">因此，首先让我们使用 Angular CLI 创建一个保护文件。</p><p id="8cee" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mr ms mt mu b">ng generate guard services/guards/auth-guard</code></p><p id="1b83" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，让我们来看看我们的<code class="fe mr ms mt mu b">login.service.ts</code>文件，我们将在这里再创建一个函数<code class="fe mr ms mt mu b">isAuthenticated()</code>。</p><pre class="li lj lk ll gt mv mu mw mx aw my bi"><span id="2bea" class="mz lp iq mu b gy na nb l nc nd">isAuthenticated() {<br/>    if (sessionStorage.getItem('jwt')) {<br/>      return true;<br/>    } else {<br/>      return false;<br/>    }<br/>  }</span></pre><p id="3bec" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">好了，我们可以切换到我们的<code class="fe mr ms mt mu b">auth-guard.service.ts</code>文件了。首先，让我们导入登录服务、路由器和激活。</p><pre class="li lj lk ll gt mv mu mw mx aw my bi"><span id="bc25" class="mz lp iq mu b gy na nb l nc nd">import { Router, CanActivate } from '@angular/router';<br/>import { LoginService } from './login/login.service';</span></pre><p id="41ab" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们可以在构造函数中设置 LoginService 和 Router，然后创建 canActiveate()函数，如果用户通过身份验证，该函数将返回 true，如果用户未通过身份验证，该函数将把我们重定向到仪表板组件，并返回 false。</p><pre class="li lj lk ll gt mv mu mw mx aw my bi"><span id="9896" class="mz lp iq mu b gy na nb l nc nd">@Injectable()<br/>export class AuthGuardService implements CanActivate {<br/>  constructor(<br/>    public login: LoginService,<br/>    public router: Router) { }</span><span id="0c36" class="mz lp iq mu b gy ne nb l nc nd">  canActivate(): boolean {<br/>    if (!this.login.isAuthenticated()) {<br/>      this.router.navigateByUrl('/');<br/>      return false;<br/>    }<br/>    return true;<br/>  }<br/>}</span></pre><h1 id="c80b" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">4.创建仪表板组件</h1><p id="897d" class="pw-post-body-paragraph kd ke iq kf b kg mm ki kj kk mn km kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated">让我们使用 Angular CLI 创建一个仪表板组件。</p><p id="a75e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mr ms mt mu b">ng generate component dashboard</code></p><p id="70c5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，让我们打开<code class="fe mr ms mt mu b">dashboard.component.ts</code>文件，我们将在那里创建一个简单的标题。</p><pre class="li lj lk ll gt mv mu mw mx aw my bi"><span id="a321" class="mz lp iq mu b gy na nb l nc nd">&lt;div id="dashboard-component" class="container mx-auto grid"&gt;<br/>  &lt;div class="flex mb-4 mt-24"&gt;<br/>    &lt;div class="mx-auto"&gt;<br/>      &lt;h3 class="text-gray-700 font-normal mx-auto"&gt;<br/>        Hi User, here is your dashboard:<br/>      &lt;/h3&gt;<br/>    &lt;/div&gt;<br/>  &lt;/div&gt;<br/>&lt;/div&gt;</span></pre><p id="d8b2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，让我们在 dashboard.component.scss 文件中添加一行自定义样式。</p><pre class="li lj lk ll gt mv mu mw mx aw my bi"><span id="fe35" class="mz lp iq mu b gy na nb l nc nd">#dashboard-component {<br/>  h3 {<br/>    font-size: 24px;<br/>  }<br/>}</span></pre><p id="9c32" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后一步，让我们为仪表板组件添加一个路由。请打开<code class="fe mr ms mt mu b">app-routing.module.ts</code>文件并创建一条新路线。在这条路线中，我们将使用 AuthGuard，因此我们也需要导入它。</p><pre class="li lj lk ll gt mv mu mw mx aw my bi"><span id="dab9" class="mz lp iq mu b gy na nb l nc nd">import { DashboardComponent } from './dashboard/dashboard.component';<br/>import { AuthGuardService as AuthGuard } from './services/auth-guard.service';</span><span id="8485" class="mz lp iq mu b gy ne nb l nc nd">const routes: Routes = [<br/>  { path: '', component: LoginComponent },<br/>  { path: 'dashboard', component: DashboardComponent, canActivate: [AuthGuard] },<br/>];</span></pre><p id="7f40" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，是时候测试它了！</p><h1 id="9dcc" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">结论</h1><p id="1165" class="pw-post-body-paragraph kd ke iq kf b kg mm ki kj kk mn km kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated">我希望你能够为第一课和第二课创建代码，并为我们的应用程序运行登录。</p><p id="eda3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">记得看一下 Golang 课程，在那里你可以为这个应用程序构建一个后端，这样你就有了一个完全运行的项目。如果你没有后端，你可以很容易地模仿数据。</p><p id="8e37" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在接下来的课程中，我们将让用户数据显示在仪表板上，并创建其他有趣的功能。</p><p id="e7ee" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请继续关注，如果你喜欢这门课程，请在评论中告诉我们！<br/>如果你迷失在代码中，这里有一个 GitHub 库，包含第二课，这样你就可以比较代码并找到错误。</p><p id="876c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae kc" href="https://github.com/Duomly/angular9-tailwind-bank-frontend/tree/Angular9-TailwindCSS-Course-Lesson2" rel="noopener ugc nofollow" target="_blank">角度航向—第二课— Github 代码</a></p><p id="a3f2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢您的阅读，<br/>来自 Duomly 的安娜</p><figure class="li lj lk ll gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nf"><img src="../Images/da0dbcf44b16aceb7cca413a6d9a5ef7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LJmZtnXM9S7lwHQJTEQngg.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://www.duomly.com" rel="noopener ugc nofollow" target="_blank"> Duomly —编程在线课程</a></figcaption></figure></div></div>    
</body>
</html>