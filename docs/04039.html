<html>
<head>
<title>We don’t develop software this way anymore!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我们不再这样开发软件了！</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/we-dont-develop-software-this-way-anymore-c8aadf7d14a7?source=collection_archive---------7-----------------------#2021-01-18">https://blog.devgenius.io/we-dont-develop-software-this-way-anymore-c8aadf7d14a7?source=collection_archive---------7-----------------------#2021-01-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/fb855009c7258d8608b682a6b93e80f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UV6lmYquXIyAYfszxXuS4A.jpeg"/></div></div></figure><p id="b337" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们今天开发软件的方式与本世纪初开发软件的方式不同。例如，就Java开发而言，那时，我们非常习惯于以一种特定的方式创建Java应用程序。</p><p id="bf41" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在第一阶段，我们会使用一个像Maven这样的依赖管理系统来帮助我们管理我们的应用程序所依赖的外部库，这些库也是我们的构建工具。</p><p id="62c0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们可以使用core Java(只是Java，即JavaSE)进行开发，但通常我们最终会使用像Spring或JavaEE这样的应用程序框架，因为您的应用程序需要像“企业”应用程序一样。</p><p id="1da2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">总之，我们将所需的Spring依赖项放入pom.xml文件中。如下图所示:</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="la lb l"/></div></figure><p id="83b0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你也可以混合一些“JavaEE”特有的特性，这样你也可以包含那些依赖项。(混合Spring和JavaEE是很常见的)</p><p id="85d8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后，为了让我们的企业应用程序“生产就绪”,我们需要的几样东西之一是某种形式的日志记录作为起点。因此，我们为应用程序设置了日志记录。</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="la lb l"/></div></figure><p id="5ad1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们通常需要根据您的日志记录要求来配置它:</p><p id="181a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">例如</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="la lb l"/></div></figure><p id="86be" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">好了，现在可以上线了。我们需要将它部署到我们的环境服务器上。它最终会投入生产，但首先它需要先进入测试服务器进行测试。</p><p id="83f1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们正在做CI(这总是一个好主意)，您将让您的构建服务器构建您的工件——jar、war、ear或sar文件。构建作业会将构建好工件推到像Nexus这样的集中式工件存储库中。如今，像JFrog的Artifactory这样的其他工具将是更常见的选择，甚至可以使用云提供商提供的工件库(如果您将应用程序托管在云上)，如AWS的CodeArtifact。</p><p id="e3c5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您运行您的部署步骤(无论是手动进入linux裸机服务器或虚拟机并执行unix命令，通过部署服务工具如RunDeck，还是使用配置管理工具如Puppet、Chef、Salt或目前更流行和更现代的选择— Ansible)来自动将工件部署到环境中的服务器。</p><p id="c0b7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您的应用程序通常运行在成熟的企业应用服务器上，例如:Red Hat的<strong class="ka ir"> JBoss(现在是wildly)</strong>、IBM的<strong class="ka ir"> WebSphere </strong>、Oracle的<strong class="ka ir"> WebLogic、</strong>或其他不太知名的开源应用服务器(<strong class="ka ir"> Geronimo、TomEE、Resin、JOnAS </strong>)</p><p id="a5b7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">或者…</p><p id="7090" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你的应用完全基于网络，也就是说，只使用JavaEE的网络特性(Servlets，JSP，JSTL，JAX-RS，JAX-WS等等),你的应用可以存在于一个网络服务器容器中。).这些通常也被称为Servlet容器。例子包括:<strong class="ka ir">阿帕奇的Tomcat，Jetty，under flow</strong>，还有更多…</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h2 id="41f8" class="lj lk iq bd ll lm ln dn lo lp lq dp lr kj ls lt lu kn lv lw lx kr ly lz ma mb bi translated">快进20年。</h2><p id="0b49" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">我们很少再构建“应用程序”了。相反，我们构建微服务(在Java世界中通常使用Spring Boot ),它作为独立和隔离的web服务，公开一组RESTful(或非RESTful)端点供其他客户端使用(通常是JSON数据格式)。</p><p id="f9a2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要创建一个Spring Boot项目，您可以通过访问Spring Initializer项目生成器来轻松设置它:</p><p id="6f2f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">https://start.spring.io/<a class="ae mh" href="https://start.spring.io/" rel="noopener ugc nofollow" target="_blank"/></p><p id="6724" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您可以填写如下所示的表格，然后点击您想要的依赖项。您可以选择是使用Java、Kotlin还是Groovy应用程序，还可以选择使用哪种构建工具(Maven或Gradle)。</p><figure class="kw kx ky kz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mi"><img src="../Images/b384309dd68a4b816ce453839bbce5e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hf3jUITRK7gM1FiAxwNAYA.png"/></div></div></figure><p id="db6c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">就是这样！单击屏幕底部的绿色大按钮“Generate Project ”(生成项目)后，就会为您创建一个示例模板Spring Boot项目。</p><p id="a2c0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您不再在应用服务器/web容器中运行您的应用程序，而是可能在容器中运行以进行部署。Docker是显而易见的选择。为此，您可以在项目文件夹的根目录中放入一个<code class="fe mj mk ml mm b">Dockerfile</code>。一个非常简单的例子<code class="fe mj mk ml mm b">Dockerfile</code>如下所示:</p><pre class="kw kx ky kz gt mn mm mo mp aw mq bi"><span id="f340" class="lj lk iq mm b gy mr ms l mt mu">FROM openjdk:8 </span><span id="8270" class="lj lk iq mm b gy mv ms l mt mu">LABEL maintainer=Colin But</span><span id="15f9" class="lj lk iq mm b gy mv ms l mt mu">EXPOSE 8090 # Install artifact</span><span id="1760" class="lj lk iq mm b gy mv ms l mt mu">VOLUME /tmp</span><span id="a11b" class="lj lk iq mm b gy mv ms l mt mu">ADD user-service-1.0-SNAPSHOT-with-dependencies.jar user-service.jar</span><span id="1c2d" class="lj lk iq mm b gy mv ms l mt mu">RUN sh -c 'touch /user-service.jar'</span><span id="95b8" class="lj lk iq mm b gy mv ms l mt mu">ENTRYPOINT ["java","-jar","/user-service.jar"]</span></pre><h1 id="1cb9" class="mw lk iq bd ll mx my mz lo na nb nc lr nd ne nf lu ng nh ni lx nj nk nl ma nm bi translated">摘要</h1><p id="ba99" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">本世纪初，我们开发了现在所谓的“单片”应用程序(作为一个大的单一代码库),并可能连接到关系数据库进行数据管理。我们要么使用原始JDBC，要么使用ORM解决方案进行数据访问。为了提高性能，我们通常在里面的某个地方放一个缓存机制。因为我们在制作“应用程序”，所以我们通常使用服务器端页面技术(JSP)进行服务器端页面渲染，它提供了一个“视图”(html)。</p><p id="76c6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是现在，我们不是为您的代码库创建一个工件，而是构建一个容器映像(Docker)。我们没有部署到大型应用服务器/Web服务器容器上，而是从这些Docker映像运行容器，并让容器编排框架(Kubernetes)为我们管理这些容器。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h2 id="5f87" class="lj lk iq bd ll lm ln dn lo lp lq dp lr kj ls lt lu kn lv lw lx kr ly lz ma mb bi translated">最后的想法</h2><p id="a213" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">因为我们这些天的发展与过去完全不同，我们真的不能用和那时一样的心态和思维方式。我们需要以“微服务方式”开发微服务。如果你想开发微服务(这是开发软件的现代方式…)，你不能真的使用和你构建‘单片’应用程序时一样的方法。事情肯定不一样了！首先，我们正在使用的技术是完全不同的。</p><p id="5b7b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一个更具体的例子是；构建Docker容器映像并不等同于创建jar或war工件。</p><p id="83e6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您的工件代表可以部署到服务器上的代码或应用程序本身，而容器映像是创建您的应用程序需要运行的一切的蓝图，即您的应用程序+与之配套的整个基础架构(运行时+二进制文件+操作系统)。</p><p id="6dd2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">总而言之，以上论证了<strong class="ka ir">两种不可比拟的哲学</strong>因此，开发每一种方式都需要完全不同的方式/方法。</p><p id="cfd3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">世界在变化和移动..软件也需要移动</p><p id="5225" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">行业期待下一次革命！</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h2 id="ed4b" class="lj lk iq bd ll lm ln dn lo lp lq dp lr kj ls lt lu kn lv lw lx kr ly lz ma mb bi translated">哦，还有最后一个外卖</h2><p id="76bc" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">当从JBoss/Tomcat迁移到Docker/Kubernetes时，我不建议进行“对等”转换。</p><p id="62d7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">运行在JBoss/Tomcat上的应用和运行在Docker/Kubernetes内部的应用并不是直接等价的。</p><p id="53e6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以…</p><p id="264f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您将需要您的旧的单片遗留应用程序来适应新的生活方式，这些生活方式需要驻留在Kubernetes pod中运行的Docker容器中…</p></div></div>    
</body>
</html>