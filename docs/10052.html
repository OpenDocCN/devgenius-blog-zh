<html>
<head>
<title>Evolutionary from Batching to Streaming</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从批处理到流处理的演变</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/evolutionary-from-batching-to-streaming-7a9a7942922?source=collection_archive---------9-----------------------#2022-10-03">https://blog.devgenius.io/evolutionary-from-batching-to-streaming-7a9a7942922?source=collection_archive---------9-----------------------#2022-10-03</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="8aa3" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">从一小步开始</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/66de1698bd9bad9213901db1b0a77109.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*iQy2PLCpXZfqodgR"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">Jukan Tateisi 在<a class="ae ks" href="https://unsplash.com/photos/bJhT_8nbUA0" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="4a6a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">上次我们谈到了数据基础设施的<a class="ae ks" href="https://lazypro.medium.com/evolutionary-data-infrastructure-4ddce2ec8a7e" rel="noopener">演进，整个演进过程如下。</a></p><ul class=""><li id="2773" class="lp lq in kv b kw kx kz la lc lr lg ls lk lt lo lu lv lw lx bi translated">阶段 0:无</li><li id="3349" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">阶段 1:配料</li><li id="1856" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">第二阶段:流式传输</li><li id="e778" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">第三阶段:整合</li><li id="46e1" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">第四阶段:自动化</li><li id="8161" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">第五阶段:权力下放</li></ul><p id="379e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">但是记得吗？从阶段 1 到阶段 2 的演变有点奇怪，因为我们只是放弃了正在使用的批处理，并构建了一个新的流处理。</p><p id="f98b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">事实上，已经在生产环境中的产品不会做出如此剧烈的改变，而是会选择增量迁移过程。</p><p id="a1fe" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">因此，在本文中，我们将详细解释从阶段 1 到阶段 2 的迁移在实践中是如何工作的。</p><h1 id="7061" class="md me in bd mf mg mh mi mj mk ml mm mn jt mo ju mp jw mq jx mr jz ms ka mt mu bi translated">阶段 1:配料</h1><p id="3a9d" class="pw-post-body-paragraph kt ku in kv b kw mv jo ky kz mw jr lb lc mx le lf lg my li lj lk mz lm ln lo ig bi translated">让我们再次回顾一下批处理架构。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi na"><img src="../Images/3ad6d297593e51f37e794ea569e4d7ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VFCOm1n2s2IvBz_LI95seg.png"/></div></div></figure><p id="6ef3" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在这个架构下，我们有一个批处理角色，负责将来自各种服务的数据归档到数据仓库。批处理还执行数据预处理，以生成用于加速分析目的的结构化数据。</p><p id="6a67" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">然而，为了支持实时分析，我们从上一篇文章中了解到，我们必须引入一个流架构，但同时我们希望保留原有的分析功能。</p><p id="4b6f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">换句话说，在保持现有架构和功能的同时，有必要添加额外的实时分析功能。</p><p id="8c04" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">所以，让我们开始尝试添加流架构。</p><h1 id="9beb" class="md me in bd mf mg mh mi mj mk ml mm mn jt mo ju mp jw mq jx mr jz ms ka mt mu bi translated">阶段 1.5:分批+分流</h1><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi na"><img src="../Images/20ec328769ec18db9301f68dbf2ad48b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-44jMZyW1Fb-yWb6q_Ihdw.png"/></div></div></figure><p id="f1a2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在上一篇文章中，我们采取了一种激进的方法，简单地放弃批处理，代之以流式处理。这将使体系结构变得简单，但代价是要完全重写所有的分析，因为来自流的数据与来自批处理的数据格式不同。</p><p id="eec1" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">因此，我们添加了一个额外的 1.5 阶段，以允许批处理和流式处理共存一段时间，直到我们可以更改分析框架，将流式数据源用于所有后续分析。</p><p id="cada" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这样做的好处当然是我们不需要做大爆炸。</p><blockquote class="nb nc nd"><p id="f921" class="kt ku ne kv b kw kx jo ky kz la jr lb nf ld le lf ng lh li lj nh ll lm ln lo ig bi translated">据报道，正如马丁·福勒所说，“生活大爆炸重写唯一能保证的就是生活大爆炸！”。</p></blockquote><p id="c0e0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">然而，缺点是显而易见的，当有任何修改需求时，我们必须同时实现批处理和流处理，这大大增加了维护的难度。</p><p id="4342" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">因此，虽然有 1.5 阶段，但重要的是要认识到这只是一个过渡期，不应被视为解决方案。</p><h1 id="fc8e" class="md me in bd mf mg mh mi mj mk ml mm mn jt mo ju mp jw mq jx mr jz ms ka mt mu bi translated">第二阶段:流式传输</h1><p id="6442" class="pw-post-body-paragraph kt ku in kv b kw mv jo ky kz mw jr lb lc mx le lf lg my li lj lk mz lm ln lo ig bi translated">一旦我们有了一个过渡期，我们就可以更顺利地从批处理发展到流处理。在前一阶段，我们将逐步将所有功能从批处理转移到流处理。</p><p id="d26f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">最后，去掉批处理就更容易了。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi na"><img src="../Images/ec4c2a8526fef31278347842a715b9ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZIln13MG_xNyiLiT10GurA.png"/></div></div></figure><p id="439a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">但是正如我在<a class="ae ks" href="https://lazypro.medium.com/evolutionary-data-infrastructure-4ddce2ec8a7e" rel="noopener">我的上一篇文章</a>中所说的，批处理仍然有它的价值，所以即使它被从主数据管道中取出，我们仍然会在那里进行批处理。</p><p id="b684" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">它只是从主要的数据生产者转变为次要的生产者，定期重组数据仓库中的数据以提高数据利用率。当然，批处理也可以用于将过时的数据从数据仓库转移到冷存储，从而进一步节省存储成本。</p><h1 id="d165" class="md me in bd mf mg mh mi mj mk ml mm mn jt mo ju mp jw mq jx mr jz ms ka mt mu bi translated">结论</h1><p id="62ca" class="pw-post-body-paragraph kt ku in kv b kw mv jo ky kz mw jr lb lc mx le lf lg my li lj lk mz lm ln lo ig bi translated">整个进化过程应该是平稳渐进的。</p><p id="a2d0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">为了避免大爆炸，从一种架构转移到另一种架构是一个艰难的选择。每次迁移的影响要尽可能小，但同时也不能太小，使阵痛期太长。</p><p id="7588" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">总的来说，每个组织都有不同的节奏。对于一个拥有充足人力资源的组织来说，这种前进可以是积极的和快速的，或者相反，是有节制的。</p><p id="9536" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">但无论如何，重要的是要了解困境，并提出一个足够合理的方法，更重要的是，一个完整的迁移计划。</p><p id="7d54" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这个规划过程实际上与架构变更一样重要。</p></div></div>    
</body>
</html>