# 锉具的 API 底漆

> 原文：<https://blog.devgenius.io/api-primer-for-filemaker-72ff4198e73b?source=collection_archive---------19----------------------->

什么是 API，为什么要关注它？API 是 FileMaker 解决方案访问各种服务和与其他数据存储接口的方法。当你对此有了一点了解，系统集成的世界真的为你打开了。

API 代表**应用程序接口**。它是应用程序访问服务的接口。它本质上提供了一个解释器服务，将请求翻译成服务可以理解的语言，并返回请求的结果。这意味着服务可以被视为一个 [**黑盒**](https://en.wikipedia.org/wiki/Black_box)——请求进去，看不见的魔法发生，结果出来。

## 餐馆类比

打个比方可能有用。你是一个坐在餐馆里的顾客(*应用程序*)。你饿了，想吃东西，所以你仔细阅读菜单，决定要一份牛排。

![](img/ec66c9e3071147d32570033dc9786652.png)

服务员接受订单(API 接收请求)

你不能进厨房自己做或者指挥厨师给你做。取而代之的是，一个服务员( *API* )帮你点菜。他或她会解释你的具体要求，比如要三分熟的，还要把调味汁放在旁边。服务员用你可能不懂的速记写下订单。然后，他们以自己理解的方式将订单发送到厨房(*服务*)。厨房工作人员准备饭菜，准备好了就摇铃。

你和服务员都不知道这是怎么做的。你点的饭已经送到你的桌子上了。

当支付餐费时，可能会发生相反的情况——餐厅变成了向您请求结果(付款)的应用程序。

## API 服务

在我们的例子中，我们对从 FileMaker 解决方案中访问外部服务感兴趣。这可能是简单地推或拉数据，或者为我们操纵数据。

我们可能使用的服务示例:

*   通过 SMS 发送文本消息
*   将发票数据提交给会计应用程序
*   检索一些外语文本的英文版本
*   提交一个 ISBN 来获取一本书的所有数据
*   验证信用卡进行处理

许多服务都属于“不要重新发明轮子”的范畴——访问一个专门设计的服务，然后尝试自己构建和维护它，这要容易得多，也更健壮。

## 发出 API 请求

任何 API 事务的基础都是相似的:

1.  建立身份和权限以提出请求
2.  提出以所需格式提供数据的请求
3.  收到结果

有时候结果就是‘OK’这么简单。有时候是数据流。

## 示例—发送手机短信

在本例中，我们将使用名为 [ClickSend](https://www.clicksend.com/au/) 的服务，从 FileMaker 数据库向给定的手机号码发送 SMS 文本消息。ClickSend 有许多 API——我们将使用的是他们的[REST API](https://developers.clicksend.com/docs/rest/v3/)——根据他们的描述，这是“最新最强大的 JSON 请求和响应 API”

## 1.授权

要使用 API，您需要创建一个免费帐户。这将为您设置一个 API 用户名和 API 密钥。这些用于验证您使用服务的身份。它还授权该服务使用您帐户中的点数发送短信。

我的用户名是*大卫·海德*，我的 API 密匙的形式是*5af 333 BF-0d 51–617d-4586-a1b 1188006 xx*(不是我真正的密匙)。

授权头是通过将用户名和密码组合成一个字符串来构建的— *用户名:密码。*使用 Base64 编码和授权方法对其进行编码，并在编码字符串前添加一个空格。使用上述用户名和密钥，您将获得:

```
Authorization: Basic ZGF2aWRoZWFkOjVBRjMzM0JGLTBENTEtNjE3RC00NTg2LUExQjExODgwMDZYWA==
```

*补充说明:如果您对编码文本使用 FileMaker 函数 Base64Decode，您将看到用冒号分隔的原始用户名和密钥。*

## 2.提出请求

“发送短信”的 ClickSend API 文档详细说明了请求的结构，包括需要哪些数据以及数据的格式。

HTTP 请求是一个 **POST** —数据被发送到服务。另一种常见的方法是 GET——从资源请求数据。

内容以 [**JSON**](http://www.json.org/) 格式提供。单个消息有许多可能的属性:

*   来源—发送方法，例如 php
*   发件人—将显示为发件人的手机号码
*   正文—要发送的文本消息
*   收件人—收件人的手机号码
*   schedule —用于安排消息发送的可选时间代码
*   自定义字符串—您对消息的引用

在 FileMaker Pro 中，请求是通过脚本步骤**从 URL** 插入来完成的。在脚本步骤中，我们可以指定要调用 URL、要随调用一起发送的任何选项以及结果的目标(字段或变量)。

我们调用的 URL 被称为**端点**。API 文档告诉我们每个服务的基本 URL 和端点。对于当前的点击发送 API，基本 URL 是[*https://rest.clicksend.com/v3/*](https://rest.clicksend.com/v3/)*，发送短信服务的端点是*短信/发送*。*

*所以我们发送的网址是[*https://rest.clicksend.com/v3/sms/send*](https://rest.clicksend.com/v3/sms/send)*

*随请求发送的选项是**卷曲选项**。它们是请求类型(POST)、授权头(如上所述以 Base64 编码)、内容头(假定内容是 JSON 格式的)和以 JSON 构造的消息属性。*

## *3.收到结果*

*结果被接收回在从 URL 脚本插入步骤中定义的目标。这可能是一个字段或变量。对于 ClickSend API，结果以 JSON 格式返回。它包含所提供的所有数据的副本，以及 message_price (0.077)、status(成功)、http_code (200)等发送信息。*

*可以将结果解析到 FileMaker 记录中，以保存消息发送操作的结果。*

## *结论*

*这是一篇关于在 FileMaker 解决方案中使用 API 的简要介绍。在本文中，我们只考虑了一个来自 FileMaker 的 API 请求的例子。FileMaker 服务器还提供了一个数据 API。外部服务可以访问它，将数据推入由 FileMaker 服务器托管的 FileMaker 解决方案，或者从该解决方案中提取数据。*