<html>
<head>
<title>How to Dockerize a simple Django Application — Mac Edition</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何对一个简单的 Django 应用程序进行 Dockerize—Mac Edition</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-dockerize-a-simple-django-application-mac-edition-5008fd9c3875?source=collection_archive---------4-----------------------#2022-09-01">https://blog.devgenius.io/how-to-dockerize-a-simple-django-application-mac-edition-5008fd9c3875?source=collection_archive---------4-----------------------#2022-09-01</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="e009" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在深入 docker 化之前，让我们了解一下 docker 是什么以及为什么需要它。</p><p id="2813" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">Docker 是什么？</strong></p><p id="21b9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Docker 是一个开源平台，它可以帮助您将应用程序打包成称为容器的包，其中包含软件运行所需的一切，包括库、系统工具、代码和运行时。</p><p id="ca9c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">使用 Docker 的优势:</strong></p><p id="ccb4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">使用 docker 最重要的优点是，它是没有麻烦的。通常，当您想要在实例中部署应用程序时，您总是必须安装需求、依赖库，并且需要手动设置一切，这对于开发人员或 DevOps 工程师来说太麻烦了。感谢 Docker 将您的应用程序与其代码和依赖项捆绑在一起，让事情变得更简单。你只需要安装 docker，它可以让你在任何环境下用很少的命令部署你的应用程序。其他优势包括:</p><ul class=""><li id="08ab" class="ki kj in jm b jn jo jr js jv kk jz kl kd km kh kn ko kp kq bi translated">灵活的资源共享——在一个主机中，所有 docker 容器都使用相同的内核，这意味着容器在它们之间共享 CPU 和内存资源。与传统虚拟机不同，容器不需要单独的操作系统和硬件资源</li><li id="b748" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kn ko kp kq bi translated">可伸缩性——您的应用程序和相关的微服务可以是独立的容器，放在单个服务器/实例中。</li><li id="d02c" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kn ko kp kq bi translated">快速部署和高度可移植性——因为您的应用程序被打包成一个包，所以可以轻松地部署在任何环境中(独立于底层操作系统)。</li><li id="9dc2" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kn ko kp kq bi translated">优化成本——几个容器可以在一台主机上运行，这可以降低总体基础设施成本。</li></ul><h1 id="60c8" class="kw kx in bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated"><strong class="ak">将 Django 应用程序归档的步骤:</strong></h1><blockquote class="lu lv lw"><p id="7c66" class="jk jl lx jm b jn jo jp jq jr js jt ju ly jw jx jy lz ka kb kc ma ke kf kg kh ig bi translated">注意:这个博客的范围是在 mac 上安装 docker 并 dockerize 你的 Django 应用程序。但是，docker 的安装和设置会根据您的操作系统或实例而变化。</p></blockquote><h2 id="f686" class="mb kx in bd ky mc md dn lc me mf dp lg jv mg mh lk jz mi mj lo kd mk ml ls mm bi translated">安装 Docker</h2><ol class=""><li id="67f8" class="ki kj in jm b jn mn jr mo jv mp jz mq kd mr kh ms ko kp kq bi translated">导航到<a class="ae mt" href="https://docs.docker.com/desktop/install/mac-install/" rel="noopener ugc nofollow" target="_blank"><em class="lx">https://docs.docker.com/desktop/install/mac-install/</em></a>。根据您的系统配置下载 docker 应用程序。</li><li id="c333" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh ms ko kp kq bi translated">安装应用程序并启动 Docker。在启动屏幕上使用您的 Docker 凭据登录。</li></ol><figure class="mv mw mx my gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi mu"><img src="../Images/3ff0bcfcf72c91e6f682118ad352e1db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C-5h2Ji_DiM_j6vC5hJftw.png"/></div></div></figure><p id="b219" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">3.docker 安装后，从您的终端执行以下命令，并检查 Docker 是否安装正确。</p><pre class="mv mw mx my gt ng nh ni nj aw nk bi"><span id="dd87" class="mb kx in nh b gy nl nm l nn no">docker --version</span><span id="b9ee" class="mb kx in nh b gy np nm l nn no">#This command displays system wide information regarding the Docker installation.<br/>docker info</span></pre><p id="ea6b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">设置 Django 应用</strong></p><p id="77f2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Django 是一个开源的高级 Python 框架，主要用于 web 应用程序开发。</p><ol class=""><li id="daf4" class="ki kj in jm b jn jo jr js jv kk jz kl kd km kh ms ko kp kq bi translated">创建一个虚拟环境并安装 Django(确保您的系统中安装了 python)</li></ol><pre class="mv mw mx my gt ng nh ni nj aw nk bi"><span id="2b59" class="mb kx in nh b gy nl nm l nn no">python3 -m venv myvenv<br/>source myvenv/bin/activate<br/>pip install django</span></pre><p id="4d31" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">2.创建 Django 项目，应用并运行它</p><pre class="mv mw mx my gt ng nh ni nj aw nk bi"><span id="9154" class="mb kx in nh b gy nl nm l nn no">#creating django project<br/>django-admin startproject &lt;project_name&gt; </span><span id="3f11" class="mb kx in nh b gy np nm l nn no">cd &lt;project_name&gt;</span><span id="c6d0" class="mb kx in nh b gy np nm l nn no">#creating django app<br/>python manage.py startapp &lt;appname&gt;</span><span id="3034" class="mb kx in nh b gy np nm l nn no">#run the django server locally<br/>python manage.py runserver</span></pre><p id="574e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">您可以在 http://127.0.0.1:8000/ 看到您的 Django 应用程序在本地运行</p><blockquote class="lu lv lw"><p id="0d77" class="jk jl lx jm b jn jo jp jq jr js jt ju ly jw jx jy lz ka kb kc ma ke kf kg kh ig bi translated">注意:测试完应用程序后，退出 Django 服务器</p></blockquote><p id="df4f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在您的项目中创建一个<strong class="jm io"> requirements.txt </strong>，并添加以下包</p><pre class="mv mw mx my gt ng nh ni nj aw nk bi"><span id="9545" class="mb kx in nh b gy nl nm l nn no">Django==4.1<br/>psycopg2</span></pre><p id="17eb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">3.项目中的 Docker 设置</p><p id="3d48" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在项目中创建 Dockerfile 和 docker-compose.yml 文件，并将内容添加到下面提到的文件中:</p><blockquote class="lu lv lw"><p id="9a54" class="jk jl lx jm b jn jo jp jq jr js jt ju ly jw jx jy lz ka kb kc ma ke kf kg kh ig bi translated">参考:<a class="ae mt" href="https://docs.docker.com/samples/django/" rel="noopener ugc nofollow" target="_blank">https://docs.docker.com/samples/django/</a></p></blockquote><p id="8393" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Dockerfile - A <code class="fe nq nr ns nh b">Dockerfile</code>是一个文本文档，包含用户可以在命令行上调用的所有命令来组合一个图像。这个<code class="fe nq nr ns nh b">Dockerfile</code>开始于</p><ul class=""><li id="49fb" class="ki kj in jm b jn jo jr js jv kk jz kl kd km kh kn ko kp kq bi translated">来自 python 3 的基本图像。</li><li id="68c2" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kn ko kp kq bi translated">然后我们创建一个名为 code 的目录。</li><li id="60a7" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kn ko kp kq bi translated">复制 requirements.txt 内部代码并安装需求</li><li id="fa36" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kn ko kp kq bi translated">将应用程序代码(Django 代码)复制到工作目录中</li></ul><p id="adbb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> Dockerfile </strong></p><pre class="mv mw mx my gt ng nh ni nj aw nk bi"><span id="d44d" class="mb kx in nh b gy nl nm l nn no">#syntax=docker/dockerfile:1<br/>FROM python:3<br/>ENV PYTHONDONTWRITEBYTECODE=1<br/>ENV PYTHONUNBUFFERED=1<br/>WORKDIR /code<br/>COPY requirements.txt /code/<br/>RUN pip install -r requirements.txt<br/>COPY . /code/</span></pre><p id="3cf3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">docker-compose . YAML-<code class="fe nq nr ns nh b">docker-compose.yml</code>文件描述了制作你的应用程序的服务。在这个例子中，我们有两个服务，一个 DB 服务是基本的 Postgres 服务，一个 web 服务是 Django 应用程序。合成文件还描述了这些服务使用哪些 Docker 映像，它们如何链接在一起，以及它们可能需要装入容器中的任何卷。最后，<code class="fe nq nr ns nh b">docker-compose.yml</code>文件描述了这些服务公开哪些端口。</p><p id="2dc1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> docker-compose.yaml </strong></p><pre class="mv mw mx my gt ng nh ni nj aw nk bi"><span id="ccfc" class="mb kx in nh b gy nl nm l nn no">version: "3.9"<br/>   <br/>services:<br/>  db:<br/>    image: postgres<br/>    volumes:<br/>      - ./data/db:/var/lib/postgresql/data<br/>    environment:<br/>      - POSTGRES_DB=postgres<br/>      - POSTGRES_USER=postgres<br/>      - POSTGRES_PASSWORD=postgres<br/>  web:<br/>    build: .<br/>    command: python manage.py runserver 0.0.0.0:8000<br/>    volumes:<br/>      - .:/code<br/>    ports:<br/>      - "8000:8000"<br/>    environment:<br/>      - POSTGRES_NAME=postgres<br/>      - POSTGRES_USER=postgres<br/>      - POSTGRES_PASSWORD=postgres<br/>    depends_on:<br/>      - db</span></pre><p id="8ac3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">添加上述文件后，您的文件夹结构如下所示</p><pre class="mv mw mx my gt ng nh ni nj aw nk bi"><span id="f87d" class="mb kx in nh b gy nl nm l nn no">sample_project/<br/>│<br/>├── sample_app/<br/>│   │<br/>│   ├── migrations/<br/>│   │   └── __init__.py<br/>│   │<br/>│   ├── __init__.py<br/>│   ├── admin.py<br/>│   ├── apps.py<br/>│   ├── models.py<br/>│   ├── tests.py<br/>│   └── views.py<br/>│<br/>├── sample_project/<br/>│   ├── __init__.py<br/>│   ├── asgi.py<br/>│   ├── settings.py<br/>│   ├── urls.py<br/>│   └── wsgi.py<br/>│<br/>└── manage.py<br/>|__ docker-compose.yml<br/>|__ Dockerfile<br/>|__ requirements.txt</span></pre><p id="bccb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在您的设置中，py 将数据库=替换为以下内容:</p><pre class="mv mw mx my gt ng nh ni nj aw nk bi"><span id="7d5c" class="mb kx in nh b gy nl nm l nn no"># settings.py<br/>   <br/>import os<br/>   <br/>[...]<br/>   <br/>DATABASES = {<br/>    'default': {<br/>        'ENGINE': 'django.db.backends.postgresql',<br/>        'NAME': os.environ.get('POSTGRES_NAME'),<br/>        'USER': os.environ.get('POSTGRES_USER'),<br/>        'PASSWORD': os.environ.get('POSTGRES_PASSWORD'),<br/>        'HOST': 'db',<br/>        'PORT': 5432,<br/>    }<br/>}</span></pre><p id="e69d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">4.Docker 构建和 Docker Up:</p><p id="dc79" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在您的终端中执行以下命令:</p><ul class=""><li id="b2d1" class="ki kj in jm b jn jo jr js jv kk jz kl kd km kh kn ko kp kq bi translated">这个命令在 docker-compose 中构建图像。yml 文件。</li><li id="de96" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kn ko kp kq bi translated">docker-compose up - Docker 命令在 mac 上启动并运行整个应用程序。</li></ul><pre class="mv mw mx my gt ng nh ni nj aw nk bi"><span id="06a2" class="mb kx in nh b gy nl nm l nn no">docker-compose build --no-cache<br/>docker-compose up</span></pre><p id="570a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">5.验证应用程序:</p><p id="70b3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">docker 启动后，您可以在 docker 桌面应用程序中查看 docker 容器。当您单击容器时，实际上会看到一个 DB 容器和一个 web 容器。</p><figure class="mv mw mx my gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi nt"><img src="../Images/2e8c8a040365d9b973d7b0d41d8b4d35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*38ohC14hAHg8m1Z4_OcnnA.png"/></div></div></figure><p id="eb30" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">当您使用<a class="ae mt" href="http://127.0.0.1:8000/" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:8000/ </a>再次点击浏览器时，您将实际看到从 docker 运行的应用程序，并在您的终端中看到 docker 日志</p><p id="7894" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">参考:</strong></p><div class="nu nv gp gr nw nx"><a href="https://docs.docker.com/samples/django/" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd io gy z fp oc fr fs od fu fw im bi translated">快速入门:作曲和 Django</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">预计阅读时间:9 分钟本快速入门指南演示了如何使用 Docker Compose 来设置和运行一个</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">docs.docker.com</p></div></div><div class="og l"><div class="oh l oi oj ok og ol ne nx"/></div></div></a></div></div></div>    
</body>
</html>