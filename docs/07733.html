<html>
<head>
<title>Kafka on Kubernetes: Using Strimzi — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">库伯内特斯上的卡夫卡:使用斯特里姆齐——第一部分</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/kafka-on-kubernetes-using-strimzi-part-1-83d74564135e?source=collection_archive---------3-----------------------#2022-04-19">https://blog.devgenius.io/kafka-on-kubernetes-using-strimzi-part-1-83d74564135e?source=collection_archive---------3-----------------------#2022-04-19</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/2a49794781a5a6956bd591030830c4d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nh4qtW0FVLTSVd2dAJOqnA.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">来自-<a class="ae jz" href="https://www.slideshare.net/paolopat/strimzi-how-apache-kafka-has-fallen-in-love-with-kubernetes" rel="noopener ugc nofollow" target="_blank">https://www . slide share . net/Paolo pat/strim zi-how-Apache-Kafka-has-fall-in-love-with-kubernetes</a></figcaption></figure><p id="4f62" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这是博客系列的第一部分，<strong class="kc io"> Kafka on Kubernetes:使用</strong> <a class="ae jz" href="https://strimzi.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io"> Strimzi </strong> </a>。在这个系列中，我们将讨论以下主题-</p><ol class=""><li id="3094" class="ky kz in kc b kd ke kh ki kl la kp lb kt lc kx ld le lf lg bi translated"><strong class="kc io"><em class="lh">【Kubernetes 上的 Kafka:使用 Strimzi —第 1 部分</em> </strong>:这讲的是 Strimzi 提供了哪些操作符来部署和管理 Kubernetes 上的 Kafka 集群。</li><li id="288a" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx ld le lf lg bi translated"><a class="ae jz" href="https://medium.com/@singh.amarendra/kafka-on-kubernetes-using-strimzi-part-2-71a8ba8e9605" rel="noopener"><strong class="kc io"><em class="lh">Kafka on Kubernetes:使用 Strimzi —第 2 部分</em></strong></a><strong class="kc io"><em class="lh">:</em></strong>本博客讨论 Kafka 自定义资源的设置和部署选项。</li><li id="cda3" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx ld le lf lg bi translated"><a class="ae jz" href="https://medium.com/@singh.amarendra/kafka-on-kubernetes-using-strimzi-part-3-configuration-options-f8aa027e9ba0" rel="noopener"><strong class="kc io"><em class="lh">Kubernetes 上的 Kafka:使用 Strimzi —第 3 部分</em></strong></a><strong class="kc io"><em class="lh">:</em></strong>在本文中，我们将讨论如何配置生产就绪的 Kafka 集群以及 Kafka 的高可用性。</li><li id="db71" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx ld le lf lg bi translated"><a class="ae jz" href="https://medium.com/@singh.amarendra/kafka-on-kubernetes-using-strimzi-part-4-scalability-59da50575fec" rel="noopener"><strong class="kc io"><em class="lh">Kafka on Kubernetes:使用 Strimzi —第 4 部分</em></strong></a><strong class="kc io"><em class="lh">:</em></strong>这篇文章讨论 Kafka 的可伸缩性以及我们如何使用<a class="ae jz" href="https://keda.sh/docs/2.6/concepts/#architecture" rel="noopener ugc nofollow" target="_blank"> KEDA </a>(基于 Kubernetes 的事件驱动自动缩放器)进行自动缩放</li><li id="b728" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx ld le lf lg bi translated"><a class="ae jz" href="https://medium.com/@singh.amarendra/kafka-on-kubernetes-using-strimzi-part-5-security-fc878178cd04" rel="noopener"><strong class="kc io"><em class="lh">Kafka on Kubernetes:使用 Strimzi —第 5 部分</em></strong></a><strong class="kc io"><em class="lh">:</em></strong>在这一部分中，我们将讨论 Kafka 集群的安全方面，以及如何向资源添加 ACL。</li><li id="36a9" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx ld le lf lg bi translated"><a class="ae jz" href="https://medium.com/@singh.amarendra/kafka-on-kubernetes-using-strimzi-part-6-monitoring-709a43198bf5" rel="noopener"><strong class="kc io"><em class="lh">【Kafka on Kubernetes:使用 Strimzi —第 6 部分</em></strong></a><strong class="kc io"><em class="lh">:</em></strong>这是系列的最后一部分，它讨论了非常重要的 Kafka 监控部分。</li></ol><p id="51af" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们先了解卡夫卡作品的组成部分，以及它们是如何相互作用的-</p><figure class="lo lp lq lr gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ln"><img src="../Images/15c1143a178e60288410bc321399c836.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*faGg76elatSmDFobxYuG-w.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated"><strong class="bd ls">卡夫卡组件交互</strong>，来源——<a class="ae jz" href="https://strimzi.io/docs/operators/latest/overview.html" rel="noopener ugc nofollow" target="_blank">https://strim zi . io</a></figcaption></figure><p id="7d09" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">组件简介-</p><p id="bb28" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io"> Zookeeper </strong> — Zookeeper 本质上是一个为<a class="ae jz" href="https://en.wikipedia.org/wiki/Distributed_computing" rel="noopener ugc nofollow" target="_blank">分布式系统</a>提供分层<a class="ae jz" href="https://en.wikipedia.org/wiki/Key-value_database" rel="noopener ugc nofollow" target="_blank">键值存储</a>的服务，用于为大型分布式系统提供分布式<a class="ae jz" href="https://en.wikipedia.org/wiki/Configuration_management" rel="noopener ugc nofollow" target="_blank">配置服务</a>、<a class="ae jz" href="https://en.wikipedia.org/wiki/Synchronization_(computer_science)" rel="noopener ugc nofollow" target="_blank">同步服务</a>和<a class="ae jz" href="https://en.wikipedia.org/wiki/Directory_service" rel="noopener ugc nofollow" target="_blank">命名注册表</a>。</p><p id="753d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">卡夫卡中动物园管理员的角色——</strong></p><ol class=""><li id="3674" class="ky kz in kc b kd ke kh ki kl la kp lb kt lc kx ld le lf lg bi translated">经纪人注册，心跳机制，以保持经纪人名单更新</li><li id="81af" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx ld le lf lg bi translated">维护主题列表</li></ol><ul class=""><li id="598a" class="ky kz in kc b kd ke kh ki kl la kp lb kt lc kx lt le lf lg bi translated">主题配置(分区、复制因子、附加配置等。)</li><li id="3572" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx lt le lf lg bi translated">分区的同步副本列表</li></ul><p id="09d2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">3.在任何代理关闭的情况下执行领导者选举</p><p id="b9ea" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">4.如果启用了安全性，则存储访问控制列表</p><ul class=""><li id="bc03" class="ky kz in kc b kd ke kh ki kl la kp lb kt lc kx lt le lf lg bi translated">主题</li><li id="491c" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx lt le lf lg bi translated">消费者群体</li><li id="6b3c" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx lt le lf lg bi translated">用户</li></ul><p id="a8c4" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">5-存储 Kafka 集群 id(第一次代理注册时随机生成)</p><p id="2118" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">Kafka Connect</strong>—Kafka Connect<strong class="kc io"/>允许您从外部系统向 Kafka 持续摄取数据，反之亦然。因此，将现有系统与 Kafka 整合起来非常容易。</p><ul class=""><li id="5180" class="ky kz in kc b kd ke kh ki kl la kp lb kt lc kx lt le lf lg bi translated">一个<em class="lh">源</em>连接器将外部数据推入 Kafka。</li><li id="fab5" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx lt le lf lg bi translated">一个<em class="lh">接收器</em>连接器从 Kafka 中提取数据</li></ul><figure class="lo lp lq lr gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lu"><img src="../Images/84746c9f14413700d8cf9ec59510b3de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DYKUxXNkcO--ueC7InKBDw.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated">卡夫卡连接</figcaption></figure><p id="416e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">Kafka Exporter—</strong>Kafka Exporter 提取数据作为普罗米修斯指标进行分析，主要是与补偿、消费者群体、消费者滞后和主题相关的数据。</p><p id="9333" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">Kafka mirror maker—</strong>mirror maker<strong class="kc io"/>旨在更容易地将主题从一个 Kafka 集群镜像或复制到另一个集群。它使用 Kafka Connect 框架来简化配置和扩展。</p><p id="a89a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">MirrorMaker 的主要组件实际上是 Kafka 连接器，如下所示。</p><ul class=""><li id="19a9" class="ky kz in kc b kd ke kh ki kl la kp lb kt lc kx lt le lf lg bi translated"><strong class="kc io"><em class="lh">MirrorSourceConnector</em></strong>将记录从源集群复制到目标集群，并启用偏移同步。</li><li id="5105" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx lt le lf lg bi translated"><strong class="kc io"><em class="lh">MirrorCheckpointConnector</em></strong>管理消费者偏移同步，发出检查点，并启用故障转移。</li><li id="2a5a" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx lt le lf lg bi translated">最后，<strong class="kc io"><em class="lh">MirrorHeartbeatConnector</em></strong>提供心跳、复制流监控和复制拓扑的客户端发现。</li></ul><p id="4c8d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们现在可以讨论 Strimzi 提供了什么。从 Strimzi 医生那里-</p><p id="2da1" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Strimzi 简化了在 Kubernetes 集群中运行 Apache Kafka 的过程。它支持 Kafka 使用<a class="ae jz" href="https://kubernetes.io/docs/concepts/extend-kubernetes/operator/" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io"> <em class="lh">操作符</em> </strong> </a>来部署和管理 Kafka 到 Kubernetes 的组件和依赖关系。Strimzi 操作符扩展了 Kubernetes 的功能，自动化了与 Kafka 部署和可维护性相关的常见和复杂任务。</p><figure class="lo lp lq lr gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lv"><img src="../Images/3ac84160634b79642c36be9ce968e606.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cOR9cUpbdpIzzcncnpjlxg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk translated"><strong class="bd ls"> Strimzi 运算符</strong>，来源—<a class="ae jz" href="https://strimzi.io/" rel="noopener ugc nofollow" target="_blank">https://strimzi.io/</a></figcaption></figure><p id="1e40" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">集群操作符— </strong> Strimzi 集群操作符部署和管理集群，用于:</p><ul class=""><li id="7f35" class="ky kz in kc b kd ke kh ki kl la kp lb kt lc kx lt le lf lg bi translated">Kafka(包括 ZooKeeper、话题运营、用户运营、Kafka 导出器、巡航控制)</li><li id="a3e4" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx lt le lf lg bi translated">卡夫卡连接</li><li id="7f5a" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx lt le lf lg bi translated">卡夫卡镜子制造商</li><li id="c4c9" class="ky kz in kc b kd li kh lj kl lk kp ll kt lm kx lt le lf lg bi translated">卡夫卡桥</li></ul><p id="0d84" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><a class="ae jz" href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/" rel="noopener ugc nofollow" target="_blank">定制资源</a>用于部署集群。</p><p id="a227" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">主题操作符</strong> —主题操作符提供了一种通过 Kubernetes 资源管理 Kafka 集群中的主题的方法，反之亦然。</p><p id="e241" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">具体来说，如果一个<code class="fe lw lx ly lz b">KafkaTopic</code>是:</p><ul class=""><li id="50d4" class="ky kz in kc b kd ke kh ki kl la kp lb kt lc kx lt le lf lg bi translated">在 Kafka 集群中，<strong class="kc io">创建了</strong>、<strong class="kc io">删除了</strong>或<strong class="kc io">更新了</strong>，主题操作者对 Kubernetes KafkaTopic 资源做同样的操作，使其与实际的 Kafka 主题保持同步。</li></ul><p id="ab20" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">同样，如果一个主题是:</p><ul class=""><li id="2e02" class="ky kz in kc b kd ke kh ki kl la kp lb kt lc kx lt le lf lg bi translated"><strong class="kc io">在 Kafka 集群内创建、删除或更新</strong>，操作员对<code class="fe lw lx ly lz b">KafkaTopic</code>进行相同的操作</li></ul><p id="5710" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这允许您声明一个<code class="fe lw lx ly lz b">KafkaTopic</code>作为应用程序部署的一部分，主题操作者将负责创建和协调主题。</p><p id="31e5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">用户操作员— </strong>用户操作员通过监视描述 Kafka 用户的<code class="fe lw lx ly lz b">KafkaUser</code>资源来管理 Kafka 集群的 Kafka 用户。</p><p id="697c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">例如，如果一个<code class="fe lw lx ly lz b">KafkaUser</code>是:</p><ul class=""><li id="dc62" class="ky kz in kc b kd ke kh ki kl la kp lb kt lc kx lt le lf lg bi translated">创建、删除或更新用户操作员创建、删除或更新其描述的用户</li></ul><p id="47c0" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">与主题操作符不同，用户操作符不会将 Kafka 集群中的任何更改与 Kubernetes 资源同步。</p><p id="bcfa" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">结论</strong> —在博客系列<strong class="kc io"> Kafka on Kubernetes 的第 1 部分中—使用 Strimzi，</strong>我们讨论了各种 Kafka 组件及其交互，然后讨论了 Strimzi operators 如何管理 Kubernetes 上的 Kafka 集群。在下一部分中，我们将看到如何使用 Strimzi 在 Kubernetes 上设置 Kafka。我们将用默认配置设置一个 Kafka 集群和 Zookeeper。</p></div></div>    
</body>
</html>