<html>
<head>
<title>How to implement Bing’s Wallpaper of the day functionality using a simple Python script &amp; Unsplash API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用简单的Python脚本和Unsplash API实现Bing的每日壁纸功能</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/how-to-implement-bings-wallpaper-of-the-day-functionality-using-a-simple-python-script-a50620942385?source=collection_archive---------6-----------------------#2020-05-28">https://blog.devgenius.io/how-to-implement-bings-wallpaper-of-the-day-functionality-using-a-simple-python-script-a50620942385?source=collection_archive---------6-----------------------#2020-05-28</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="6f51" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">使用python自动从unsplash.com获取新壁纸，并将其设置为桌面壁纸</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/89c617fd956125bffae411ea212bda12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JoMQn3EyM7aU3K8e"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk translated">由<a class="ae ks" href="https://unsplash.com/@sannisahil?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">萨尼·萨希尔</a>在<a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><p id="31ed" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">有没有想过打造自己版本的必应每日壁纸？嗯，使用python，你几乎可以自动化任何任务，包括获取新的壁纸，并将其设置为你的桌面背景。在本教程中，我们将使用Unsplash公共API来获取漂亮的壁纸，保存到您的文件系统中，并将其设置为您的桌面背景。</p><p id="e1fe" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">那么，我们现在就开始吧。</p><p id="0440" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">要求:</strong></p><ul class=""><li id="d310" class="lp lq in kv b kw kx kz la lc lr lg ls lk lt lo lu lv lw lx bi translated">python-3.8</li><li id="358b" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">Pip — 19.0</li><li id="b11c" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">要求</li><li id="4b1d" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">枕头</li></ul><blockquote class="md me mf"><p id="c397" class="kt ku mg kv b kw kx jo ky kz la jr lb mh ld le lf mi lh li lj mj ll lm ln lo ig bi translated">注:枕头和PIL不能共存。您必须卸载其中一个，并且只安装一个。</p></blockquote><p id="2db5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">让我们先安装我们的需求- </strong></p><p id="6cdc" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在这里获得Python <a class="ae ks" href="https://www.python.org/downloads/" rel="noopener ugc nofollow" target="_blank">的最新版本。</a></p><p id="f597" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Pip与python发行版打包在一起。</p><pre class="kd ke kf kg gt mk ml mm mn aw mo bi"><span id="0f6a" class="mp mq in ml b gy mr ms l mt mu">python3 -m pip install requests</span><span id="48b4" class="mp mq in ml b gy mv ms l mt mu">python3 -m pip install --upgrade pip<br/>python3 -m pip install --upgrade Pillow</span></pre><h2 id="4b67" class="mp mq in bd mw mx my dn mz na nb dp nc lc nd ne nf lg ng nh ni lk nj nk nl nm bi translated">UNSPLASH API</h2><p id="0c05" class="pw-post-body-paragraph kt ku in kv b kw nn jo ky kz no jr lb lc np le lf lg nq li lj lk nr lm ln lo ig bi translated"><strong class="kv io">基础API URL</strong>—<a class="ae ks" href="https://api.unsplash.com/" rel="noopener ugc nofollow" target="_blank">https://api.unsplash.com/</a></p><p id="5d1e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io"> API终点- </strong></p><pre class="kd ke kf kg gt mk ml mm mn aw mo bi"><span id="9354" class="mp mq in ml b gy mr ms l mt mu">GET /photos/random</span></pre><p id="3ca0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">参数</strong> -</p><pre class="kd ke kf kg gt mk ml mm mn aw mo bi"><span id="3df8" class="mp mq in ml b gy mr ms l mt mu">query = wallpaper<br/>orientation = landscape</span></pre><p id="8773" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们将使用Unsplash API来获取壁纸图像。</p><ul class=""><li id="57ce" class="lp lq in kv b kw kx kz la lc lr lg ls lk lt lo lu lv lw lx bi translated">去<a class="ae ks" href="https://unsplash.com/join" rel="noopener ugc nofollow" target="_blank">这个</a>链接，注册成为开发者。</li><li id="e186" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">创建新的应用程序。</li><li id="0d65" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">复制访问和密钥。让他们准备好。</li></ul><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/77c52676dd7eb9a76db1f16560542a57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/0*8Vc-MXLfPb9ZMOvo.png"/></div></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/8084a4d350526ac245867ba1eabc535a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/0*L9AQ4htxc1VMs_tA.png"/></div></figure><p id="a68e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在，我们准备向Unsplash请求图像。</p><p id="f91b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们运行下面的代码，并检查unsplash的响应。</p><pre class="kd ke kf kg gt mk ml mm mn aw mo bi"><span id="59f9" class="mp mq in ml b gy mr ms l mt mu">import ctypes</span><span id="b982" class="mp mq in ml b gy mv ms l mt mu">from PIL import Image</span><span id="4a7a" class="mp mq in ml b gy mv ms l mt mu">from io import BytesIO</span><span id="83e2" class="mp mq in ml b gy mv ms l mt mu">import requests</span><span id="4e58" class="mp mq in ml b gy mv ms l mt mu">r = requests.get('https://api.unsplash.com/photos/random/?client_id=&lt;YOUR_CLIENT_ID&gt;&amp;query=wallpaper&amp;orientation=landscape')</span><span id="f1c8" class="mp mq in ml b gy mv ms l mt mu">r = r.json()</span><span id="4966" class="mp mq in ml b gy mv ms l mt mu">print(r)</span></pre><p id="c4ce" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">复制并粘贴您之前获得的访问密钥来代替<your class="mg">客户端 ID &gt;。</your></p><p id="ff3a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这里，我们向<code class="fe nt nu nv ml b">/photos/random</code>端点发送一个GET请求，响应存储在r中。然后，我们使用方法<code class="fe nt nu nv ml b">.json()</code>将响应解析为一个JSON对象。接下来，让我们打印出我们的响应来检查它的结构。我们看到以下结果:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nw"><img src="../Images/68a004d1eb6db80fce7e96ba91200acc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_UUvXRwqgucLZkrFPoSsJQ.png"/></div></div></figure><p id="9b00" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果您仔细观察，我们会发现一个包含子节点<strong class="kv io">‘download’</strong>的<code class="fe nt nu nv ml b">links</code>属性。该字段包含下载图像的链接，这正是我们所需要的。</p><p id="18c4" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">所以，让我们从链接中获取图像-</p><pre class="kd ke kf kg gt mk ml mm mn aw mo bi"><span id="0aed" class="mp mq in ml b gy mr ms l mt mu">img_link = r["links"]["download"] <br/>r2 = requests.get(img_link)</span></pre><p id="b849" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在，我们得到的是二进制数据，存储在r2.content属性中。我们将使用来自<strong class="kv io"> io </strong>模块的<code class="fe nt nu nv ml b">BytesIO()</code>方法读取我们的二进制数据，并使用来自<strong class="kv io"> PIL </strong>库的<code class="fe nt nu nv ml b">Image.open()</code>打开映像。</p><p id="9f0e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">最后，把图片保存在你想存放壁纸的地方。</p><pre class="kd ke kf kg gt mk ml mm mn aw mo bi"><span id="6b2a" class="mp mq in ml b gy mr ms l mt mu">i = Image.open(BytesIO(r2.content))</span><span id="dfa2" class="mp mq in ml b gy mv ms l mt mu">save_path = <strong class="ml io">r</strong>"C:\Users\ipras\Pictures\Saved Pictures\image" + r["id"] + ".jpg"</span><span id="7485" class="mp mq in ml b gy mv ms l mt mu">i.save(save_path)</span></pre><p id="4080" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">记得将</strong> <code class="fe nt nu nv ml b"><strong class="kv io">save_path</strong></code> <strong class="kv io">更改为您想要存储图像的目录。</strong></p><p id="1b85" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们已经走了一半了。现在，我们只需要将下载的图像设置为我们的桌面壁纸。</p><p id="d119" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">为此，我们必须以某种方式访问<em class="mg">user32.dll</em>文件，这是windows附带的标准DLL，包含帮助应用程序创建和实现标准windows GUI的API。</p><blockquote class="md me mf"><p id="87fc" class="kt ku mg kv b kw kx jo ky kz la jr lb mh ld le lf mi lh li lj mj ll lm ln lo ig bi translated"><em class="in">注:DLL代表动态链接库。正如Windows Dev Docs上所说的，</em> <strong class="kv io">动态链接库(DLL)是一个模块，它包含可以被另一个模块(应用程序或DLL)使用的函数和数据。Windows应用程序编程接口(API)是作为一组dll实现的，因此任何使用Windows API的进程都使用动态链接。</strong></p></blockquote><p id="a951" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="mg">user32.dll</em>包含方法<code class="fe nt nu nv ml b">SystemParametersInfoW</code>，它允许您访问和设置系统范围的参数，如SPI_SETDESKTOPWALLPAPERS。</p><p id="15cf" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">幸运的是，在python中，有一个<code class="fe nt nu nv ml b">ctypes</code>库，它是Python的外来函数库。它提供了与C兼容的数据类型，并允许您访问共享库或dll中的函数。</p><p id="8c6d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在同一个文件中编写以下代码。</p><pre class="kd ke kf kg gt mk ml mm mn aw mo bi"><span id="65d5" class="mp mq in ml b gy mr ms l mt mu">SPI_SETDESKWALLPAPER = 20 ctypes.windll.user32.SystemParametersInfoW(SPI_SETDESKWALLPAPER, 0, save_path , 0)</span></pre><p id="d60a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">运行脚本，你应该会看到桌面壁纸的变化。</p><p id="f251" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">一切都结束了。答对了。！！</p><p id="8f4a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们有python脚本，可以从Unsplash获取漂亮的壁纸，并将其设置为桌面背景。</p><p id="d414" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">以下是完整的代码:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="76b7" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">剩下的唯一一件事就是安排python脚本每天自动运行。借助windows上的<strong class="kv io">任务调度器</strong>应用程序，这可以轻松完成。</p><ul class=""><li id="4c08" class="lp lq in kv b kw kx kz la lc lr lg ls lk lt lo lu lv lw lx bi translated">打开任务计划程序</li><li id="137e" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">点击<strong class="kv io">创建基本任务… </strong></li></ul><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/2083648252316685434d8c7437026df6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/0*nk8wqs6J6MVb85oV.png"/></div></figure><ul class=""><li id="1734" class="lp lq in kv b kw kx kz la lc lr lg ls lk lt lo lu lv lw lx bi translated">输入任务的名称和描述。</li></ul><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/00f271d054671b7a302b45b58026702d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/0*FeihxQq5uRAmClXi.png"/></div></figure><ul class=""><li id="13ac" class="lp lq in kv b kw kx kz la lc lr lg ls lk lt lo lu lv lw lx bi translated">选择触发器-</li></ul><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/b7f56522cad135d8fa5def0560fbef25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/0*P3FVEW8SqVTZWHX4.png"/></div></figure><ul class=""><li id="412c" class="lp lq in kv b kw kx kz la lc lr lg ls lk lt lo lu lv lw lx bi translated">现在，选择<strong class="kv io">启动程序</strong>作为动作。</li></ul><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/44e68012cf5ce2020d08fa89bed52ace.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/0*I2xUoa6_2LRbCutA.png"/></div></figure><ul class=""><li id="2cfb" class="lp lq in kv b kw kx kz la lc lr lg ls lk lt lo lu lv lw lx bi translated">选择您的脚本作为动作脚本。</li></ul><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/ca3f1794e6e0b4376c1d3d5e01f91ea0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/0*LMjhdg0c0q-7BRpJ.png"/></div></figure><ul class=""><li id="378c" class="lp lq in kv b kw kx kz la lc lr lg ls lk lt lo lu lv lw lx bi translated">最后，在“完成”选项卡中查看您的任务详细信息，然后单击<em class="mg">完成</em>。</li></ul><p id="7168" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">结束了。现在你的python壁纸更换器脚本将在每天的指定时间运行，并因此更新你的桌面壁纸。</p><p id="6dc3" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果你想了解更多关于Unsplash API的信息，请访问他们的官方文档。有很多事情你可以尝试和实验。如果您想了解更多关于dll、user32.dll及其提供的方法，您也可以查阅Windows开发人员文档。</p><p id="c7c5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">感谢阅读，我希望你觉得这篇文章有趣。</p></div><div class="ab cl nz oa hr ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="ig ih ii ij ik"><p id="9e42" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="mg">如果你觉得这篇文章有帮助，请点赞并分享。在</em> <a class="ae ks" href="https://medium.com/@iprashant2402" rel="noopener"> <em class="mg"> Medium </em> </a> <em class="mg">上关注我，以便在我发布新文章时定期获得更新。也可以在</em><a class="ae ks" href="https://www.linkedin.com/in/prashant-singh-a51574123" rel="noopener ugc nofollow" target="_blank"><em class="mg">LinkedIn</em></a><em class="mg">上联系我，查看我的</em><a class="ae ks" href="https://www.github.com/iprashant2402" rel="noopener ugc nofollow" target="_blank"><em class="mg">Github</em></a><em class="mg">。</em></p><p id="3192" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">另外，我会很感激你们的任何反馈。</p></div><div class="ab cl nz oa hr ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="ig ih ii ij ik"><p id="86c5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="mg">最初发表于</em><a class="ae ks" href="http://prashantsingh.me/wallpaper-changer/" rel="noopener ugc nofollow" target="_blank"><em class="mg">prashantsingh . me</em></a></p></div></div>    
</body>
</html>