<html>
<head>
<title>4 Tips To Make Production Debugging Easier</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">简化生产调试的 4 个技巧</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/4-tips-to-make-production-debugging-easier-484d07a19afe?source=collection_archive---------8-----------------------#2021-12-20">https://blog.devgenius.io/4-tips-to-make-production-debugging-easier-484d07a19afe?source=collection_archive---------8-----------------------#2021-12-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="4ef3" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">当用户尖叫的时候，你的老板的粗重的呼吸压在你的脖子上，你不想被吓到。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/1096ac03d1d5fdc742c0c0d5be21af5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nKLNAghVaNr435N6JM02JA.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">在<a class="ae kv" href="https://unsplash.com/photos/JpTY4gUviJM" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae kv" href="https://unsplash.com/@visuals" rel="noopener ugc nofollow" target="_blank"> @visuals </a>拍照</figcaption></figure><p id="7c4f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls">本文是调试系列文章的一部分。你可以在下面看到更早的文章。</em></p><div class="lt lu gp gr lv lw"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-find-a-bug-1ca218be3666"><div class="lx ab fo"><div class="ly ab lz cl cj ma"><h2 class="bd ir gy z fp mb fr fs mc fu fw ip bi translated">如何找到 Bug</h2><div class="md l"><h3 class="bd b gy z fp mb fr fs mc fu fw dk translated">使用你不了解的代码就像趟过沼泽。你应该努力让自己过上稳定的生活…</h3></div><div class="me l"><p class="bd b dl z fp mb fr fs mc fu fw dk translated">blog.devgenius.io</p></div></div><div class="mf l"><div class="mg l mh mi mj mf mk kp lw"/></div></div></a></div></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><p id="c161" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">很容易让紧急 bug 的压力压垮你。</p><p id="d17d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">调试很难。试图在真实环境中修复一个紧急的 bug 是不可能的。为了避免让一个小裂缝变成一个巨大的弹坑，你必须小心行事。</p><p id="a01c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你不想剪错线，把整个应用程序搞砸。</p><p id="544a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当用这些提示来消除一个产品缺陷时，要保持冷静。</p><h1 id="800e" class="ms mt iq bd mu mv mw mx my mz na nb nc jw nd jx ne jz nf ka ng kc nh kd ni nj bi translated">在较低的环境中重建生产。</h1><p id="04f8" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">如果你不用做，生产调试总是很容易的。</p><p id="628e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你知道你可以在调试时安全地做任何事情，你会更放松。在您的计算机上或开发环境中进行调试可以打开我们在生产中无法使用的各种工具和技术。您拥有的选项越多，调试就越容易。</p><h2 id="0e95" class="np mt iq bd mu nq nr dn my ns nt dp nc lf nu nv ne lj nw nx ng ln ny nz ni oa bi translated">按照以下步骤在较低的环境中重新创建生产。</h2><ul class=""><li id="8869" class="ob oc iq ky b kz nk lc nl lf od lj oe ln of lr og oh oi oj bi translated">将生产数据复制到另一个环境。或者如果需要保护敏感数据，至少复制类似的数据。</li><li id="9e89" class="ob oc iq ky b kz ok lc ol lf om lj on ln oo lr og oh oi oj bi translated">通过签出相同的分支、标记或版本，验证相同的代码正在运行。</li><li id="cd08" class="ob oc iq ky b kz ok lc ol lf om lj on ln oo lr og oh oi oj bi translated">跨环境保持所有软件、软件包和框架版本同步。</li><li id="8d71" class="ob oc iq ky b kz ok lc ol lf om lj on ln oo lr og oh oi oj bi translated">对所有外部系统和硬件使用相似的版本和硬件。</li></ul><p id="c62a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用任何工具，如 Docker 和 git，自动设置和配置系统，以保持较低的环境与生产同步。可以通过定期将备份复制到较低的环境来同步数据。</p><h2 id="fd99" class="np mt iq bd mu nq nr dn my ns nt dp nc lf nu nv ne lj nw nx ng ln ny nz ni oa bi translated">最好的选择是不要在生产中调试。</h2><p id="ef99" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">在较低的环境中在生产环境中重新创建可以让您在大多数时候避免在生产环境中进行调试。</p><p id="b81a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您必须调试产品，剩下的技巧将有助于使它变得更容易。</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="5dee" class="ms mt iq bd mu mv op mx my mz oq nb nc jw or jx ne jz os ka ng kc ot kd ni nj bi translated">利用远程调试。</h1><p id="03bf" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">部署随机更改并像老鹰祈祷错误停止一样观察错误日志，并不是调试生产问题的唯一方法。</p><p id="cfd1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在远程机器上调试并不简单。我们也没有太多的生产调试选项。但是可以远程调试。</p><p id="593c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以在远程计算机上使用各种工具和技术。</p><h2 id="dae4" class="np mt iq bd mu nq nr dn my ns nt dp nc lf nu nv ne lj nw nx ng ln ny nz ni oa bi translated">在某些平台上，您可以将调试器连接到生产服务器。</h2><p id="06d6" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">远程调试的工作方式类似于本地调试，但是它连接到生产代码和数据，而不是我们的本地机器。远程调试有一些限制，但它比仅仅依靠监控工具要好。</p><p id="8ce5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">只要你小心，远程调试器可以减少调试时间。</p><h2 id="04e2" class="np mt iq bd mu nq nr dn my ns nt dp nc lf nu nv ne lj nw nx ng ln ny nz ni oa bi translated">当我们不能使用调试器时，我们仍然有其他的工具和技术供我们使用。</h2><p id="06ac" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">在你忙着修复一个 bug 之前，先了解一下有什么可用的资源。正在调试的软件和设备的类型将改变可用的工具。你会感谢你现在所做的任何准备。</p><p id="f263" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">无论您如何调试产品，您总是只需要观察状态和数据。</p><h2 id="32cc" class="np mt iq bd mu nq nr dn my ns nt dp nc lf nu nv ne lj nw nx ng ln ny nz ni oa bi translated">您希望在生产中限制更改数据或代码。</h2><p id="a7f9" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">在生产中做任何事情都要谨慎。在你准备好修复之前，你不应该在生产中做任何改变。没有人想成为在仓促变更中删除客户数据或使整个网站离线的开发人员。</p><p id="f49a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">星星之火引发森林大火只会让你更加紧张。</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="12d1" class="ms mt iq bd mu mv op mx my mz oq nb nc jw or jx ne jz os ka ng kc ot kd ni nj bi translated">使用额外的日志记录来帮助调试。</h1><p id="af4e" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">追踪 bug 的诀窍通常是掌握正确的信息。您可能已经有了可以查看的日志，但是如果记录没有帮助，可以添加更多的日志语句。尤其是当您不能使用远程调试器时，日志记录可能是跟踪生产中发生的事情的唯一选项之一。</p><p id="9b2d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">记录更多信息几乎没有任何意义。</p><h2 id="22c5" class="np mt iq bd mu nq nr dn my ns nt dp nc lf nu nv ne lj nw nx ng ln ny nz ni oa bi translated">当添加日志来帮助调试时，请尝试只记录您知道错误在哪里的日志。</h2><p id="7d32" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">额外的日志记录只有在与 bug 相关时才有帮助。将日志记录的重点放在正在运行的代码、变量值和其他有助于找出 bug 原因的数据上。记录任何可能有助于找到错误原因的信息，仅此而已。</p><p id="0b27" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以认为这种日志记录代替了您的调试器来查看代码在做什么。</p><h2 id="826b" class="np mt iq bd mu nq nr dn my ns nt dp nc lf nu nv ne lj nw nx ng ln ny nz ni oa bi translated">在添加了用于调试目的的日志语句之后，您必须决定是清除它还是永久保留它。</h2><p id="3309" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">为了确定要做什么，请考虑这些日志记录语句如何帮助监视您的系统，以及您可能需要它们的频率。注意不要在日志文件中添加太多的信息，以免很难找到特定的日志记录语句。您也不应该需要在每次出现新的 bug 时都添加日志语句。</p><p id="a1cc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">随着时间的推移，你应该学会适当的伐木量。</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="85e3" class="ms mt iq bd mu mv op mx my mz oq nb nc jw or jx ne jz os ka ng kc ot kd ni nj bi translated">隔离调试以限制影响。</h1><p id="081d" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">您可以将调试隔离到产品的一小部分，以限制任何连锁反应。如果您可以将调试限制在单个网络、服务器、设备等。，做吧。如果可能，针对数据备份而不是实际生产数据运行。</p><p id="9fec" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您需要生产配置或数据来重现 bug，请限制您需要接触多少生产环境。</p><h1 id="e348" class="ms mt iq bd mu mv mw mx my mz na nb nc jw nd jx ne jz nf ka ng kc nh kd ni nj bi translated">添加调试代码以帮助查看发生了什么。</h1><p id="d4d7" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">添加代码应该是最后的手段。</p><p id="5edb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在生产中调试时更改代码是小问题如何演变成公司范围的灾难的。这应该是最后的手段，我怎么强调都不为过。然而有些时候，你完全被卡住了，没有其他选择。</p><p id="1037" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不要盲目地放弃随机更改，而是添加战略性的调试代码来帮助您找到问题。</p><h2 id="8180" class="np mt iq bd mu nq nr dn my ns nt dp nc lf nu nv ne lj nw nx ng ln ny nz ni oa bi translated">尝试将代码限制为仅针对特定用户或当请求中有特定参数时运行。</h2><p id="ccbe" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">我们希望修改调试代码的运行方式，就像我们限制调试的生产设备一样。调试代码不应该为每个用户或请求运行。限制调试代码可以显示的内容，以防用户意外触发它。</p><p id="52c9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以格外小心，将调试代码限制为添加用户永远看不到的测试场景。</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><p id="12e1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这些建议不会让你觉得修复一个紧急的 bug 就像在沙滩上放松一样，但是它们会让你在下一次发生火灾时更加自信。</p><p id="152b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于调试，您还有其他的提示或建议吗？我很想在评论中听到他们。</p><p id="7148" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您觉得这有帮助，请关注我以获得更多的开发人员建议、提示和技巧。</p></div></div>    
</body>
</html>