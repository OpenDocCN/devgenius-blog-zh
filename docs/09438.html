<html>
<head>
<title>ETL with Glue and other AWS services on [Amazon reviews dataset] — PART- II</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在[Amazon reviews dataset]上使用 Glue 和其他 AWS 服务的 ETL 第二部分</h1>
<blockquote>原文：<a href="https://blog.devgenius.io/etl-with-glue-and-other-aws-services-on-amazon-reviews-dataset-part-ii-be824e83dae7?source=collection_archive---------13-----------------------#2022-08-20">https://blog.devgenius.io/etl-with-glue-and-other-aws-services-on-amazon-reviews-dataset-part-ii-be824e83dae7?source=collection_archive---------13-----------------------#2022-08-20</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><h1 id="fc90" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">在本文中，我们将继续这个 ETL 实验的第 2 部分。</h1><p id="d962" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">源代码</p><p id="7e14" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">【https://github.com/ramthulsi/glue-etl T4】</p><h1 id="95fa" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">04-分析:</h1><h2 id="f135" class="lm jl in bd jm ln lo dn jq lp lq dp ju kt lr ls jy kx lt lu kc lb lv lw kg lx bi translated">a.雅典娜:</h2><h1 id="92a6" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">在本实验中，您将完成以下任务:</h1><ul class=""><li id="c75c" class="ly lz in kk b kl km kp kq kt ma kx mb lb mc lf md me mf mg bi translated">使用 Amazon Athena 查询数据并创建视图</li><li id="3418" class="ly lz in kk b kl mh kp mi kt mj kx mk lb ml lf md me mf mg bi translated">Athena 工作组控制查询访问和成本</li><li id="7ddd" class="ly lz in kk b kl mh kp mi kt mj kx mk lb ml lf md me mf mg bi translated">使用 Amazon QuickSight 构建仪表板</li></ul><p id="2759" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">注意:本实验部分将演示 Athena 如何拥有 Glue 的数据存储。如何使用 Athena 对 Glue 数据存储进行按需查询？创建视图并进行分析，用简单的示例查询进行解释。您可以根据自己的需求和数据执行复杂的查询。</p><h1 id="c5b9" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">使用 Amazon Athena 查询数据</h1><h2 id="49a2" class="lm jl in bd jm ln lo dn jq lp lq dp ju kt lr ls jy kx lt lu kc lb lv lw kg lx bi translated">在 AWS 服务控制台中，搜索 Athena。</h2><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/fcff51467fb23f23d55515ada826bd54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BM9tvph3-RCDBIhVf3ahCg.png"/></div></div></figure><ul class=""><li id="5218" class="ly lz in kk b kl lg kp lh kt my kx mz lb na lf md me mf mg bi translated">在查询编辑器中，选择从 Glue Catalog 创建的数据库<code class="fe nb nc nd ne b">glue-etl</code>。</li><li id="179a" class="ly lz in kk b kl mh kp mi kt mj kx mk lb ml lf md me mf mg bi translated">单击名为<code class="fe nb nc nd ne b">analysis</code>的表格来检查字段。注意:字段 id、sporting_event_id 和 ticketholder_id 的类型应为(double)。</li></ul><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/df9af36cf56e209f75a5d4e6462cdc1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FRq6NMLkOsNGsUtp1tPWtA.png"/></div></div></figure><h1 id="6076" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">将查询结果记录到 S3</h1><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/8659acaaaa749121ffbecdfeee49aaba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3J2w5uLem3cqsr5J73hi4Q.png"/></div></div></figure><h1 id="2e1c" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">基于投票的前 10 本书</h1><ul class=""><li id="7b1d" class="ly lz in kk b kl km kp kq kt ma kx mb lb mc lf md me mf mg bi translated">运行以下查询，根据投票结果获得前 10 本书</li></ul><p id="3cb4" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">select product_title，total _ votes from analysis order by total _ votes desc 限制 10；</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/dbf6f4d2852f13725a4cc841dba37ff4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3D0l65begbANn1NsE6B_Fg.png"/></div></div></figure><h1 id="557d" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">创建具有最高评价的视图</h1><ul class=""><li id="19c6" class="ly lz in kk b kl km kp kq kt ma kx mb lb mc lf md me mf mg bi translated">运行以下查询以获得星级&gt; =4 的最佳评级书</li></ul><p id="4b4b" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">select * from 分析，其中星级&gt; = 4；</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/d0d7e884a57b93b5a98daff27f5758b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9KBzlZTeuVGmrhGYSV_SEw.png"/></div></div></figure><p id="7159" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">如上所示，单击创建，然后选择从查询创建视图</p><p id="bd61" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">将视图命名为<code class="fe nb nc nd ne b">toprated-books</code>,然后单击 Create</p><ul class=""><li id="b963" class="ly lz in kk b kl lg kp lh kt my kx mz lb na lf md me mf mg bi translated">查看在左窗格中创建的视图</li></ul><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/1a1df8a910bb55d3bbf6a394d1b73c5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*snKJRQnIYYcJUo1u4LgI3Q.png"/></div></div></figure><ul class=""><li id="f134" class="ly lz in kk b kl lg kp lh kt my kx mz lb na lf md me mf mg bi translated">请随时探索雅典娜按需查询</li></ul><h1 id="afa2" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">05-SageMaker:</h1><h1 id="84ac" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">介绍</h1><ul class=""><li id="0a92" class="ly lz in kk b kl km kp kq kt ma kx mb lb mc lf md me mf mg bi translated">Amazon SageMaker 是一个端到端的机器学习平台，允许您在 AWS 中构建、训练和部署机器学习模型。这是一个高度模块化的服务，允许您独立使用这些组件。</li></ul><h1 id="f94f" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">您将了解到:</h1><ul class=""><li id="ebf3" class="ly lz in kk b kl km kp kq kt ma kx mb lb mc lf md me mf mg bi translated">如何使用 Sagemaker 的 Jupyter notebook 组件集成数据湖，使用 Athena 填充数据框进行数据操作。</li></ul><h1 id="ef84" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">创建 Amazon SageMaker 笔记本实例</h1><ul class=""><li id="3d15" class="ly lz in kk b kl km kp kq kt ma kx mb lb mc lf md me mf mg bi translated">从 AWS 控制台转到 Amazon Sagemaker</li></ul><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/58c3a30821525f44b54bdffa3320360d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*INZLT1J-AgB7lcIExk-t6w.png"/></div></div></figure><p id="2ed6" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">在 Amazon SageMaker 导航窗格中，单击笔记本实例，然后单击创建笔记本实例</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/73390cca048a32b94290ff7ace60cd78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RShXjSxrRmfwGL0wx61STw.png"/></div></div></figure><h1 id="cc74" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">输入以下值以创建实例:</h1><ul class=""><li id="7391" class="ly lz in kk b kl km kp kq kt ma kx mb lb mc lf md me mf mg bi translated">给出您选择的笔记本实例名称，例如<code class="fe nb nc nd ne b">glue-etl-notebook</code></li><li id="eeec" class="ly lz in kk b kl mh kp mi kt mj kx mk lb ml lf md me mf mg bi translated">对于本实验，您可以将笔记本实例类型保留为默认值 ml.t2.medium</li><li id="cddf" class="ly lz in kk b kl mh kp mi kt mj kx mk lb ml lf md me mf mg bi translated">将弹性推理保留为空。这是为了增加额外的资源。</li><li id="3756" class="ly lz in kk b kl mh kp mi kt mj kx mk lb ml lf md me mf mg bi translated">为 Amazon SageMaker 中的笔记本实例选择一个角色，以便与 Amazon S3 进行交互。由于角色不存在，请选择“创建新角色”选项。</li><li id="810d" class="ly lz in kk b kl mh kp mi kt mj kx mk lb ml lf md me mf mg bi translated">在“创建 IAM 职责”弹出窗口中，选择您将授予访问权限的特定 S3 时段。在本实验中，选择如下所示的任意 S3 时段，然后单击“创建角色”:</li></ul><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/e26131c47da64b6f5d63753aff4c2b76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lG8G75dS5lYtTZU385AwPg.png"/></div></div></figure><ul class=""><li id="b80a" class="ly lz in kk b kl lg kp lh kt my kx mz lb na lf md me mf mg bi translated">单击创建笔记本实例。</li><li id="74a2" class="ly lz in kk b kl mh kp mi kt mj kx mk lb ml lf md me mf mg bi translated">您将看到一个角色被创建，因为您将从 SageMaker 访问 Athena，所以 SageMaker 执行角色必须具有访问 Athena 的必要权限。为此，请在新窗口中单击新创建的 IAM 角色的链接</li></ul><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/5db7f22b9b4017a37f3bf69a884bc68a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*flve0SuLd0fGQFWKVufNfQ.png"/></div></div></figure><ul class=""><li id="e114" class="ly lz in kk b kl lg kp lh kt my kx mz lb na lf md me mf mg bi translated">您的 SageMaker 执行角色中没有可用的 Athena 权限。本例中为“AmazonSageMaker-execution role-20210927t 014192”。</li></ul><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/d11637227bc61f45e0b20255360467f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fbsiz49C3Y4TRLkU1HYMNQ.png"/></div></div></figure><p id="e62b" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">单击权限选项卡中的附加策略按钮。</p><ul class=""><li id="6929" class="ly lz in kk b kl lg kp lh kt my kx mz lb na lf md me mf mg bi translated">通过“Athena”过滤策略，选中 AmazonAthenaFullAccess 托管策略，然后单击屏幕底部的附加策略按钮。关闭新窗口/选项卡。</li></ul><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/6d2a36a907f274b1c157716ef39d9784.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lbA6puqUjfYU2KloN0opiQ.png"/></div></div></figure><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/f148a8b0b87b0e22844709161029b12b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yoWnCUl6sLZqlQZX0lH3lQ.png"/></div></div></figure><ul class=""><li id="43e8" class="ly lz in kk b kl lg kp lh kt my kx mz lb na lf md me mf mg bi translated">等待笔记本实例被创建，状态变为 Inservice，然后在“Actions”列中单击 Open Jupyter。</li></ul><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/8bc08161d931f30c23808c2e8095a941.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wP7XISx9CqgQlKYkCuW6Gg.png"/></div></div></figure><p id="0490" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">笔记本界面在单独的浏览器窗口中打开。</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/3f573c28f57cdb3831c98e5e50516e9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*krZu1P6a8ykAzMAoGUao9Q.png"/></div></div></figure><h1 id="638a" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">将 SageMaker Jupyter 笔记本连接到 Athena</h1><p id="3b56" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">在 Jupyter 笔记本界面中，单击新建。对于内核，选择 conda_python3</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/bc2c67eec9368a36c327288138d6b058.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iluShKMiFvKFJbR5VghD2w.png"/></div></div></figure><ul class=""><li id="bba5" class="ly lz in kk b kl lg kp lh kt my kx mz lb na lf md me mf mg bi translated">在笔记本中，执行以下命令来安装雅典娜 JDBC 驱动程序，并在顶部工具栏中，单击运行。(PyAthena 是亚马逊雅典娜 JDBC 驱动程序的 Python DB API 2.0 (PEP 249)兼容客户端。)</li></ul><pre class="mn mo mp mq gt nf ne ng nh aw ni bi"><span id="0760" class="lm jl in ne b gy nj nk l nl nm">import sys<br/>!{sys.executable} -m pip install PyAthena</span></pre><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/cfe2bf91eda272cdcfca7ad49c9c9433.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GwHEdqTplRgRvVbEPcKk4g.png"/></div></div></figure><p id="addc" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">您可以将 Athena 表数据从数据湖加载到 Pandas 数据框，并应用机器学习。</p><p id="8126" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">您的 Athena 数据库名称，这是您在之前的实验中创建的 Glue 数据库名称，例如<code class="fe nb nc nd ne b">glue-etl</code>。更新 S3 桶的位置，使其看起来像<code class="fe nb nc nd ne b">s3://amazon-dataset-reviews-thulasi/athenaquery/</code>。</p><pre class="mn mo mp mq gt nf ne ng nh aw ni bi"><span id="e742" class="lm jl in ne b gy nj nk l nl nm">from pyathena import connect<br/>import pandas as pd<br/>conn = connect(s3_staging_dir='s3://amazon-dataset-reviews-thulasi/athenaquery/',<br/>region_name='us-west-2')<br/><br/>df = pd.read_sql('SELECT * FROM "glue-etl"."analysis" order by total_votes limit 10;', conn)<br/>df</span></pre><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/253748c6e5364f2142f785bc77f6f91d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zL-ZxyQc8hFNOJkpXSckfw.png"/></div></div></figure><h1 id="a987" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">你也可以用 matplotlib 做一些分析和绘图</h1><pre class="mn mo mp mq gt nf ne ng nh aw ni bi"><span id="bef5" class="lm jl in ne b gy nj nk l nl nm">df = pd.read_sql('SELECT total_votes, \<br/>       review_date, \<br/>       count(*) as ratings, \<br/>       avg(star_rating) as avg_star_rating \<br/>       FROM "glue-etl"."analysis" \<br/>       group by 1,2 \<br/>       order by 1,2 limit 500;', conn)<br/>df</span></pre><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/591b48995b8249fbc233b3a284098abb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zyq90IRsHaoBgGZBVw7Dag.png"/></div></div></figure><pre class="mn mo mp mq gt nf ne ng nh aw ni bi"><span id="81b6" class="lm jl in ne b gy nj nk l nl nm">import matplotlib.pyplot as plt <br/>df.plot(x='review_date',y='avg_star_raging')</span></pre><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/e83ef470c82b9343f3027d05f6e398e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*co7ySsX-BcaTU931qaMI8A.png"/></div></div></figure><h1 id="541e" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">清理:</h1><ul class=""><li id="73f6" class="ly lz in kk b kl km kp kq kt ma kx mb lb mc lf md me mf mg bi translated">转到 SageMaker 笔记本实例控制台</li><li id="5b70" class="ly lz in kk b kl mh kp mi kt mj kx mk lb ml lf md me mf mg bi translated">选择您创建的笔记本实例，例如<code class="fe nb nc nd ne b">glue-etl-notebook</code></li><li id="6eef" class="ly lz in kk b kl mh kp mi kt mj kx mk lb ml lf md me mf mg bi translated">选择操作→停止，笔记本实例将需要几分钟时间停止。</li><li id="23d7" class="ly lz in kk b kl mh kp mi kt mj kx mk lb ml lf md me mf mg bi translated">笔记本实例停止后，选择操作→删除，然后在确认弹出窗口中选择删除以删除该实例。</li></ul><h1 id="1b5a" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">06-数据 Brew:</h1><h1 id="af95" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">数据布鲁实验室</h1><ul class=""><li id="e555" class="ly lz in kk b kl km kp kq kt ma kx mb lb mc lf md me mf mg bi translated">在本实验中，我们将使用 AWS Glue DataBrew 探索 S3 的数据集，并清理和准备数据。</li><li id="434b" class="ly lz in kk b kl mh kp mi kt mj kx mk lb ml lf md me mf mg bi translated">为此，我们将首先设置一个在 DataBrew 中使用的 IAM 角色，并为 DataBrew 作业的结果设置一个 S3 存储桶。</li></ul><p id="de3e" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">CloudFormation Stack Deployment 在您的 S3 桶所在的区域部署以下模板。</p><pre class="mn mo mp mq gt nf ne ng nh aw ni bi"><span id="5121" class="lm jl in ne b gy nj nk l nl nm">File Location:<br/><br/>cloudformation/databrewlab.yaml<br/><br/>Enter Parameters: (Below are mine, please enter yours accordingly)<br/><br/>SourceBucket: "amazon-dataset-reviews-thulasi"<br/>SourceKey: "analysis/amazon_reviews_us_Books_v1_02.tsv.gz"<br/></span></pre><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/44c8fc9454444dedb25fc4ca18076183.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s3A4sY-1BJ0tMBCatWiNkQ.png"/></div></div></figure><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/91742bdd24cd80b6e97923ce2c5f84ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aYYMNqGG8vC-1vrw9DThfg.png"/></div></div></figure><ul class=""><li id="644b" class="ly lz in kk b kl lg kp lh kt my kx mz lb na lf md me mf mg bi translated">选中“我承认…”复选框，然后单击“创建堆栈”来创建堆栈</li><li id="6e96" class="ly lz in kk b kl mh kp mi kt mj kx mk lb ml lf md me mf mg bi translated">部署堆栈后，单击 Outputs 选项卡查看更多信息</li><li id="7015" class="ly lz in kk b kl mh kp mi kt mj kx mk lb ml lf md me mf mg bi translated">记下将在实验中使用的 DatasetS3Path、DataBrewLabRole 和 DataBrewOutputS3Bucket 的值</li></ul><h1 id="9694" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">创建项目</h1><h2 id="1e8d" class="lm jl in bd jm ln lo dn jq lp lq dp ju kt lr ls jy kx lt lu kc lb lv lw kg lx bi translated">导航到 AWS Glue DataBrew 服务</h2><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/f694f5bb991c76fb9369bd6bdf0b3e0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wAP0oPfJ91Tr904LQ-xVtg.png"/></div></div></figure><ul class=""><li id="7dcf" class="ly lz in kk b kl lg kp lh kt my kx mz lb na lf md me mf mg bi translated">在 DataBrew 控制台上，选择项目</li></ul><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/2339dd61f879ac8ecf8e8487f84fee36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3YXqN-hahPiv9eOBF5ooyw.png"/></div></div></figure><ul class=""><li id="1927" class="ly lz in kk b kl lg kp lh kt my kx mz lb na lf md me mf mg bi translated">单击创建项目</li><li id="d4cb" class="ly lz in kk b kl mh kp mi kt mj kx mk lb ml lf md me mf mg bi translated">在项目详细信息部分，输入<code class="fe nb nc nd ne b">glue-etl-databrew</code>作为项目名称</li></ul><p id="aa83" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">在选择数据集部分，选择新数据集并输入<code class="fe nb nc nd ne b">glue-etl-databrew-amazonbooksreview</code></p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/496456c0ad04e5c193688c059a633023.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_JMNX8JWfECK2DIibw0_lA.png"/></div></div></figure><p id="5a67" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">在“连接到新数据集”部分，选择“数据湖/数据存储”下的亚马逊 S3</p><p id="7c74" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">输入 DatasetS3Path，该路径可在事件引擎团队仪表盘或 CloudFormation 堆栈的输出部分获得</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/886c4dd293d5ef29eac051297ecac9fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YLgKK2Mx0KIVL9Ohzc16ag.png"/></div></div></figure><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/b84061711fe6ccd26956cf25d2c479e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8rjQQ96fRt1MWYX9nu5zcA.png"/></div></div></figure><p id="b367" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">在采样部分，保留默认配置值</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/02d6d47027dde40d88d8d2de21a56b7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aaWoa1wBY2Jjozk6BDgBTw.png"/></div></div></figure><p id="98e0" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">在“权限”部分，从下拉列表中选择角色 data brew-lab-DataBrewLabRole-xxxxx</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/e35e87ffde1981cfdb6784a5a3af1d7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tudzbcgVwbAZsD6IhEoQLg.png"/></div></div></figure><p id="c4bc" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">单击创建项目粘附数据 Brew 将创建项目，这可能需要几分钟时间。</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/6a7f0a62f7ac3a2c5f76339ac085c178.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e1NGJZn5Zo15og_uirYgDA.png"/></div></div></figure><h1 id="b0c5" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">浏览数据集。</h1><ul class=""><li id="f628" class="ly lz in kk b kl km kp kq kt ma kx mb lb mc lf md me mf mg bi translated">创建项目后，您将看到网格视图。这是默认视图，其中数据样本以表格格式显示。</li></ul><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/69fad834418634c2b5b196c55767d21b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ueed5QEpD1-VaotN_TfkEg.png"/></div></div></figure><h2 id="ce67" class="lm jl in bd jm ln lo dn jq lp lq dp ju kt lr ls jy kx lt lu kc lb lv lw kg lx bi translated">网格视图显示</h2><ul class=""><li id="2c2b" class="ly lz in kk b kl km kp kq kt ma kx mb lb mc lf md me mf mg bi translated">数据集中的列</li><li id="266a" class="ly lz in kk b kl mh kp mi kt mj kx mk lb ml lf md me mf mg bi translated">每列的数据类型</li><li id="773b" class="ly lz in kk b kl mh kp mi kt mj kx mk lb ml lf md me mf mg bi translated">已找到的值范围的摘要</li><li id="51d5" class="ly lz in kk b kl mh kp mi kt mj kx mk lb ml lf md me mf mg bi translated">数字列的统计分布</li></ul><p id="dd0e" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">单击模式选项卡</p><p id="ddde" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">架构视图显示从数据集推断出的架构。在“架构”视图中，可以看到每一列中数据值的统计信息。</p><h2 id="598f" class="lm jl in bd jm ln lo dn jq lp lq dp ju kt lr ls jy kx lt lu kc lb lv lw kg lx bi translated">在模式视图中，您可以</h2><ul class=""><li id="6583" class="ly lz in kk b kl km kp kq kt ma kx mb lb mc lf md me mf mg bi translated">选中列旁边的复选框以查看列值的统计信息摘要</li><li id="46de" class="ly lz in kk b kl mh kp mi kt mj kx mk lb ml lf md me mf mg bi translated">显示/隐藏列</li><li id="0f86" class="ly lz in kk b kl mh kp mi kt mj kx mk lb ml lf md me mf mg bi translated">重命名列</li><li id="16c5" class="ly lz in kk b kl mh kp mi kt mj kx mk lb ml lf md me mf mg bi translated">更改列的数据类型</li><li id="87ee" class="ly lz in kk b kl mh kp mi kt mj kx mk lb ml lf md me mf mg bi translated">通过拖放列来重新排列列顺序</li></ul><p id="fbad" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">单击配置文件选项卡</p><p id="5212" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">在配置文件视图中，您可以运行数据配置文件作业来检查和收集有关数据的统计摘要。数据概要是对结构、内容、关系和派生的评估。</p><p id="7e91" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">点击运行数据配置文件</p><p id="7532" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">在“作业详细信息”和“作业运行示例”面板中，保留默认值。</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/5ad6fbbafd36e4521c420e135b4110a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KAbYSaalULq-w89nrUxoOg.png"/></div></div></figure><ul class=""><li id="4b7d" class="ly lz in kk b kl lg kp lh kt my kx mz lb na lf md me mf mg bi translated">在作业输出设置部分，选择名为 data brew-lab-databrewoutputs 3 bucket-xxxxx 的 S3 存储桶和一个文件夹名称(如 data-profile)</li></ul><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/84c8ed588378a513f4ececd64fb5f062.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z4WQeKqmaQsRIh6B-BX5SQ.png"/></div></div></figure><ul class=""><li id="f50a" class="ly lz in kk b kl lg kp lh kt my kx mz lb na lf md me mf mg bi translated">在“权限”部分，选择名为 data brew-lab-data brew lab role-xxxxx 的 IAM 角色</li><li id="43e4" class="ly lz in kk b kl mh kp mi kt mj kx mk lb ml lf md me mf mg bi translated">将所有其他设置保留为默认值</li><li id="4e9c" class="ly lz in kk b kl mh kp mi kt mj kx mk lb ml lf md me mf mg bi translated">单击创建并运行作业</li><li id="0e92" class="ly lz in kk b kl mh kp mi kt mj kx mk lb ml lf md me mf mg bi translated">数据配置文件作业大约需要 5 分钟完成。您可以在等待时继续下面步骤 15 的其余实验，然后返回到以下步骤来检查数据集的配置文件。</li></ul><h2 id="7710" class="lm jl in bd jm ln lo dn jq lp lq dp ju kt lr ls jy kx lt lu kc lb lv lw kg lx bi translated">从 DataBrew 控制台左侧的菜单中单击 Jobs。</h2><ul class=""><li id="e877" class="ly lz in kk b kl km kp kq kt ma kx mb lb mc lf md me mf mg bi translated">单击配置文件作业选项卡查看配置文件作业列表。</li><li id="dc36" class="ly lz in kk b kl mh kp mi kt mj kx mk lb ml lf md me mf mg bi translated">您可以在此屏幕上看到您的个人资料作业的状态。</li></ul><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/696417e3f8af1bbfaf96224b63d72b3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EdliB1QcUHxe0S-FoDdPxw.png"/></div></div></figure><ul class=""><li id="446b" class="ly lz in kk b kl lg kp lh kt my kx mz lb na lf md me mf mg bi translated">配置文件作业成功完成后，单击查看数据配置文件</li></ul><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/efe0e97db371f1dbbfb32196727538a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fYflzIh8yFrIijFCcovAuA.png"/></div></div></figure><ul class=""><li id="eff4" class="ly lz in kk b kl lg kp lh kt my kx mz lb na lf md me mf mg bi translated">您也可以从项目中的“概要文件”选项卡访问数据概要文件。</li><li id="fb51" class="ly lz in kk b kl mh kp mi kt mj kx mk lb ml lf md me mf mg bi translated">数据配置文件显示了数据集中的行和列的摘要、有效的列和行的数量以及列之间的相关性。</li></ul><h2 id="3d3e" class="lm jl in bd jm ln lo dn jq lp lq dp ju kt lr ls jy kx lt lu kc lb lv lw kg lx bi translated">单击“列统计”选项卡，查看数据值的逐列细分。</h2><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/cc023bdb496f931ef759f7cf2f12579d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QVdxlm9buFCHsNi05Nw9Tw.png"/></div></div></figure><h1 id="e657" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">准备数据集</h1><p id="e9fd" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">在本节中，我们将对数据集应用以下转换。</p><ul class=""><li id="c48f" class="ly lz in kk b kl lg kp lh kt my kx mz lb na lf md me mf mg bi translated">将 review_date 列的日期格式从 YYYY-MM-dd 转换为 month*ddd，*yyyy</li><li id="1550" class="ly lz in kk b kl mh kp mi kt mj kx mk lb ml lf md me mf mg bi translated">将 review_date 列拆分为三个新列(年、月、日),以便按这些列对数据进行分区</li></ul><p id="6e5a" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">单击 review_date 列名称旁边的#图标</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/bdc63818a7e6e9f9201d0498ce62ae09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wy293eMM3ghrzPyLT4A6cA.png"/></div></div></figure><ul class=""><li id="c43f" class="ly lz in kk b kl lg kp lh kt my kx mz lb na lf md me mf mg bi translated">选择日期时间格式，选择格式<code class="fe nb nc nd ne b">month*ddd, *yyyy</code>并应用。</li></ul><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/d980c6373833d6cc6c53eb45a56e19fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WAHE1pOlGOiWAkQCauuR3w.png"/></div></div></figure><ul class=""><li id="40d0" class="ly lz in kk b kl lg kp lh kt my kx mz lb na lf md me mf mg bi translated">更多转换</li><li id="71dc" class="ly lz in kk b kl mh kp mi kt mj kx mk lb ml lf md me mf mg bi translated">我们将 review_date 细分为三列，即年、日、月</li></ul><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/103965f7fcc7338ef1a9ce0801eb5ac3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jbSBhkFf3ZTsaCEKWDnsJw.png"/></div></div></figure><ul class=""><li id="05d9" class="ly lz in kk b kl lg kp lh kt my kx mz lb na lf md me mf mg bi translated">应用后</li></ul><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/d89e363d7538bc27caf9befaeadfcda2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7p8UmDTsVRqexJAL-i0acg.png"/></div></div></figure><ul class=""><li id="c206" class="ly lz in kk b kl lg kp lh kt my kx mz lb na lf md me mf mg bi translated">请随意探索 Databrew 中的选项，让您的双手变脏。使用这个神奇的工具可以做更多的事情。</li></ul><p id="013c" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">在“作业详细信息”和“作业运行示例”面板中，保留默认值。</p></div></div>    
</body>
</html>